[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1554337664, "post_id": 55505468, "comment_id": 97718098, "body": "Your userform code would be pretty much the same except you&#39;d reference your textbox controls instead of <code>InputBox</code>  You&#39;d probably also want to check the return value from <code>Login</code> to see whether or not it was successful."}], "answers": [{"tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": true, "score": 0, "last_activity_date": 1554349688, "last_edit_date": 1554349688, "creation_date": 1554349337, "answer_id": 55507490, "question_id": 55505468, "link": "https://stackoverflow.com/questions/55505468/how-can-i-change-this-function-from-an-inputbox-to-a-userform/55507490#55507490", "title": "How can I change this function from an InputBox to a UserForm?", "body": "<p>So your Login Button will be a <code>CommandButton</code> which you can drag over from the <code>Toolbox</code>. </p>\n\n<p><a href=\"https://i.stack.imgur.com/r54GC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r54GC.png\" alt=\"enter image description here\"></a></p>\n\n<p>You said you already made the User/Pass Input box so the <code>CommandButton</code> code would be something like this.</p>\n\n<pre><code>Public Sub Testing()\n    Dim User As String\n    Dim Pass As String\n    User = TextBox1.Value 'Changed from Application.InputBox(\"Enter Your Username\")\n    Pass = TextBox2.Value\n    Const AccountID = \"Cerberus\"\n    Dim Cerberus As New Class_Cerberus\n    Call Cerberus.Login(AccountID, User, Pass)\n\n    Range(\"A1\") = Cerberus.GUID\n\n    Set Cerberus = Nothing\n\n    Unload Me 'This closes the Userform, perhaps add a check If Login = True then Unload Me\n\nEnd Sub\n</code></pre>\n\n<p>Note: You can hide PWD via the Property of the Input Field via <code>PasswordChar = *</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2W2Wp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2W2Wp.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 69, "user_id": 9541763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba85fb010bff1476c64f2d57fc27db4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dracius", "link": "https://stackoverflow.com/users/9541763/dracius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 55507490, "answer_count": 1, "score": 1, "last_activity_date": 1554358713, "creation_date": 1554331892, "last_edit_date": 1554358713, "question_id": 55505468, "link": "https://stackoverflow.com/questions/55505468/how-can-i-change-this-function-from-an-inputbox-to-a-userform", "title": "How can I change this function from an InputBox to a UserForm?", "body": "<p>I'm trying to change the Testing() function to utilize a UserForm instead of an application inputbox. I've already made the UserForm with a Username and Password input, and a \"Login\" button, but I'm not sure what the code for Login button on the form needs to look like.</p>\n\n<p>I've included the Login function that it references and the relevant declarations.</p>\n\n<pre><code>Public Sub Testing()\n    Dim User As String\n    Dim Pass As String\n    User = Application.InputBox(\"Enter Your Username\")\n    Pass = Application.InputBox(\"Enter Your Password\")\n    Const AccountID = \"Cerberus\"\n    Dim Cerberus As New Class_Cerberus\n    Call Cerberus.Login(AccountID, User, Pass)\n\n    Range(\"A1\") = Cerberus.GUID\n\n    Set Cerberus = Nothing\n\nEnd Sub\n</code></pre>\n\n<pre><code>Private Online_ As Boolean\nPrivate Username_ As String\nPrivate Password_ As String\nPrivate AccountID_ As String\nPrivate GUID_ As String\nPrivate GUID_Timestamp As Date\n\nPublic Function Login(Optional ByRef AccountID As String, Optional ByRef Username As String, Optional ByRef Password As String) As Boolean\n    If Not Online_ Then 'Verify connectivity before proceeding\n        If Not CheckOnline Then Exit Function\n    End If\n    'If any credentials are given at this time, store them for later use and proceed with login\n    If Not IsMissing(AccountID) Then AccountID_ = AccountID\n    If Not IsMissing(Username) Then Username_ = Username\n    If Not IsMissing(Password) Then Password_ = Password\n\n    If Not (Len(GUID_) = 0 Or GUID_Timestamp &lt; (Now() - TimeSerial(8, 0, 0))) Then Login = True\n    Dim RawJSON As String: RawJSON = GetHTTP(BASE_URL &amp; \"?fct=login&amp;accountid=\" &amp; AccountID_ &amp; \"&amp;username=\" &amp; Username_ &amp; \"&amp;password=\" &amp; Password_ &amp; \"&amp;browserinfo=NULL&amp;format=JSON\")\n    Dim JSON As Object: Set JSON = JsonConverter.ParseJson(RawJSON)\n\n    Login = JSON(\"status\") = \"ok\"\n    GUID_ = JSON(\"results\")(1)(\"GUID\")\n    GUID_Timestamp = GetDateTime(JSON(\"results\")(1)(\"DATE_ALIVE\"))\n    Set JSON = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 1, "user_id": 11308041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bf809df3b1fca578ed9c80a7678fe1?s=128&d=identicon&r=PG&f=1", "display_name": "dale", "link": "https://stackoverflow.com/users/11308041/dale"}, "edited": false, "score": 0, "creation_date": 1554328029, "post_id": 55504674, "comment_id": 97715541, "body": "Scott, thanks for editing and properly formatting my code. Much appreciated!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11308041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bf809df3b1fca578ed9c80a7678fe1?s=128&d=identicon&r=PG&f=1", "display_name": "dale", "link": "https://stackoverflow.com/users/11308041/dale"}, "edited": false, "score": 0, "creation_date": 1554835114, "post_id": 55506808, "comment_id": 97894820, "body": "Macropod, thank you very much!  I was able to get it to work with your suggestions.  However, I had to change something small and was wondering why?  When I incorporated you code, it produced a &quot;Runtime error 438 Object doesn&#39;t support this property or method&quot; at the {.text=.cells(i,l+1).value}.  To get around this, I added this code {NameOfHeading = .Cells(i, l + 1).Value} under GEBIssue and then changed your code to {.Text = NameOfHeading}.  Does this have something to do with my object libraries or versions of Word/Excel?  Again, many thanks.  You saved me days of research and confusion!"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 1, "user_id": 11308041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bf809df3b1fca578ed9c80a7678fe1?s=128&d=identicon&r=PG&f=1", "display_name": "dale", "link": "https://stackoverflow.com/users/11308041/dale"}, "edited": false, "score": 0, "creation_date": 1554852294, "post_id": 55506808, "comment_id": 97900884, "body": "Code revised - I&#39;d omitted a necessary worksheet reference."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1554852255, "last_edit_date": 1554852255, "creation_date": 1554343436, "answer_id": 55506808, "question_id": 55504674, "link": "https://stackoverflow.com/questions/55504674/is-there-a-way-to-use-excel-vba-to-open-a-word-document-copy-a-word-table-and/55506808#55506808", "title": "Is there a way to use excel vba to open a word document, copy a word table, and paste it to another word document", "body": "<p>Assuming your 'heading' employs a Word heading Style, you could use code like:</p>\n\n<pre><code>Set WordApp = CreateObject(\"word.application\")\nSet RoundUp = WordApp.Documents.Add(\"\\\\ecnoffice05\\ilab\\ZZ OELR\\2. OELR Research\\6. Global Economic Briefing\\\" &amp; forum &amp; \" template.docx\")\n'Rows 2 to 21 contain information on each of the G7 and G20 countries\nWith ThisWorkbook.Sheets(\"4 - Add entries to roundup\")\n  For i = 2 To 21\n    'Columns 4,6,8 contain the name of the word document and columns 5,7,9 contain the name of the word document heading that needs to be copied\n    'Issue, columns 8 and 9 pertain to trade entries that contain either a 1x3 or 2x3 table which doesn't seem to copy\n    For l = 4 To 8 Step 2\n      If .Cells(i, column).Value = \"X\" Then\n        If IsError(.Cells(i, l).Value) = False Then\n          GEBIssue = .Cells(i, l).Value\n          Set GEB = WordApp.Documents.Open(\"O:\\ZZ OELR\\2. OELR Research\\6. Global Economic Briefing\\Final Briefings Distributed\\\" &amp; GEBIssue &amp; \".docx\")\n          With GEB\n            With .Range\n              With .Find\n                .ClearFormatting\n                .Text = ThisWorkbook.Sheets(\"4 - Add entries to roundup\").Cells(i, l + 1).Value\n                .Execute\n              End With\n              If .Find.Found = True Then\n                Set myrange = .Duplicate\n                Set myrange = myrange.GoTo(What:=-1, Name:=\"\\HeadingLevel\") ' -1 = wdGoToBookmark\n                RoundUp.Characters.Last.FormattedText = myrange.FormattedText\n              End If\n            End With\n            .Close False\n          End With\n        End If\n      End If\n    Next l\n  Next i\nEnd With\nRoundUp.SaveAs (\"\\\\ecnoffice05\\ilab\\ZZ OELR\\2. OELR Research\\6. Global Economic Briefing\\\" &amp; forum &amp; \" draft 1.docx\")\nRoundUp.Close False\nWordApp.Quit\n</code></pre>\n\n<p><strong>Note:</strong> You should use a true Word template (i.e. a dotx file) as a template, not a document.</p>\n"}], "owner": {"reputation": 1, "user_id": 11308041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bf809df3b1fca578ed9c80a7678fe1?s=128&d=identicon&r=PG&f=1", "display_name": "dale", "link": "https://stackoverflow.com/users/11308041/dale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554852255, "creation_date": 1554327422, "last_edit_date": 1554328278, "question_id": 55504674, "link": "https://stackoverflow.com/questions/55504674/is-there-a-way-to-use-excel-vba-to-open-a-word-document-copy-a-word-table-and", "title": "Is there a way to use excel vba to open a word document, copy a word table, and paste it to another word document", "body": "<p>I am trying to use a reference table in excel that contains word document filenames and headings to open the referenced document, find the referenced heading, and then copy the heading (with content) and paste it into another word document.</p>\n\n<p>The word documents normally contain three headings. Within each heading, there is normally 5 paragraphs. In the second paragraph of each heading, there is normally a picture (enhanced metafile). My current code, although ugly, seems to do the job. For some of the word documents, however, the second paragraph contains either a 1x3 word table or a 2x3 word table. There is a title in the first row, a picture (enhanced metafile) in the second row, and source notes in the third row. For the 2x3 tables, the second column contains the same type of information as the first column.  </p>\n\n<p>I have made some feeble attempts at using .Selection and table objects, but my brain doesn't really understand how to use them. I have now been stumped for several days and need some help.</p>\n\n<p>Since I'm new to VBA, I copied in the entire code.  My apologies for that, but I didn't want to leave out anything relevant.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim WordApp As Object\nDim GEB As Object\nDim RoundUp As Object\nDim myrange As Object\nDim forum As String\nDim column As String\nDim GEBIssue As String\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim l As Integer\nDim parg As Integer\n\n'References a drop down box that contains either G7 Economic Observer or G20 Economic Roundup\nforum = ThisWorkbook.Sheets(\"4 - Add entries to roundup\").Cells(24, \"A\").Value\n'Column B contains an X if the country is part of the G7 and column C contains an X if the country is part of the G20\nIf forum = \"G7 Economic Observer\" Then column = \"B\" Else column = \"C\"\nSet WordApp = CreateObject(\"word.application\")\nSet RoundUp = WordApp.documents.Open(\"\\\\ecnoffice05\\ilab\\ZZ OELR\\2. OELR Research\\6. Global Economic Briefing\\\" &amp; forum &amp; \" template.docx\")\n\n'Rows 2 to 21 contain information on each of the G7 and G20 countries\nFor i = 2 To 21\n  'Columns 4,6,8 contain the name of the word document and columns 5,7,9 contain the name of the word document heading that needs to be copied\n  'Issue, columns 8 and 9 pertain to trade entries that contain either a 1x3 or 2x3 table which doesn't seem to copy\n  For l = 4 To 8 Step 2\n    If ThisWorkbook.Sheets(\"4 - Add entries to roundup\").Cells(i, column).Value = \"X\" Then\n        If IsError(ThisWorkbook.Sheets(\"4 - Add entries to roundup\").Cells(i, l).Value) = False Then\n        GEBIssue = ThisWorkbook.Sheets(\"4 - Add entries to roundup\").Cells(i, l).Value\n        Set GEB = WordApp.documents.Open(\"O:\\ZZ OELR\\2. OELR Research\\6. Global Economic Briefing\\Final Briefings Distributed\\\" &amp; GEBIssue &amp; \".docx\")\n            parg = GEB.Paragraphs.Count\n                For j = 1 To parg\n                    If GEB.Paragraphs(j).Range.Text = ThisWorkbook.Sheets(\"4 - Add entries to roundup\").Cells(i, l + 1).Value Then\n                    'Rudimentary way to copy/paste the heading and content.  Ideally, I'd like to simply select the heading plus content and copy/paste as one unit\n                    For k = 0 To 5\n                        GEB.Paragraphs(j + k).Range.Copy\n                        'Locates the end of the document so the copied content can be pasted at end\n                        Set myrange = RoundUp.Range(Start:=RoundUp.Content.End - 1, End:=RoundUp.Content.End - 1)\n                        myrange.Paste\n                    Next k\n                    End If\n                Next j\n                GEB.Close (False)\n        End If\n    End If\n  Next l\nNext i\nRoundUp.SaveAs (\"\\\\ecnoffice05\\ilab\\ZZ OELR\\2. OELR Research\\6. Global Economic Briefing\\\" &amp; forum &amp; \" draft 1.docx\")\nRoundUp.Close (True)\nWordApp.Quit\n\nEnd Sub\n</code></pre>\n\n<p>Ideally, I would like to be able to search and find a specific heading, select that heading and its contents (however many paragraphs and pictures it might contain), copy it, and then paste it at the end of another word document.</p>\n\n<p>However, when my program runs into one of these tables, I get a Run-time error '4605' - Application-defined or object-defined error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1554327546, "post_id": 55504558, "comment_id": 97715365, "body": "Sounds great! What&#39;s the question? Are you getting any specific error? Where? Note that Stack Overflow is for getting answers to specific questions, not for general troubleshooting and help implementing features."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554328822, "post_id": 55504558, "comment_id": 97715810, "body": "Wouldnt you just want to set a new <code>targ</code> and <code>rg</code> based on the new criteria and then run a loop through those as you did with the original code?"}, {"owner": {"reputation": 11, "user_id": 11308111, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RkuKfv6N1n4/AAAAAAAAAAI/AAAAAAAARtU/RcccXm-Fh9k/photo.jpg?sz=128", "display_name": "Luis Puerta", "link": "https://stackoverflow.com/users/11308111/luis-puerta"}, "edited": false, "score": 0, "creation_date": 1554389321, "post_id": 55504558, "comment_id": 97742430, "body": "Not getting an error it works fine but I have not been able to get it to autocomplete on a second column  I actually have multiple tabs that contain data that my user copies and pastes manually to the load sheet, autocomplete from the other tabs data would be an incredible time saver"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11308111, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RkuKfv6N1n4/AAAAAAAAAAI/AAAAAAAARtU/RcccXm-Fh9k/photo.jpg?sz=128", "display_name": "Luis Puerta", "link": "https://stackoverflow.com/users/11308111/luis-puerta"}, "edited": false, "score": 0, "creation_date": 1554389806, "post_id": 55505158, "comment_id": 97742771, "body": "There is a syntax error on the else if, it needs straight quotes but anyhow, the solution does not work for column C anymore, I would love to be able to get it done faster and easier but I&#39;m a newbie with VBA."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1554329947, "creation_date": 1554329947, "answer_id": 55505158, "question_id": 55504558, "link": "https://stackoverflow.com/questions/55504558/autocomplete-from-another-sheet/55505158#55505158", "title": "Autocomplete from another sheet", "body": "<p>I think there might be an easier or faster way to proceed but with your current code you can go this way:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim cel As Range, match1 As Range, match2 As Range, rg As Range, targ As Range\n\n\nFor i = 1 to 2\n\nIf i = 1 then\n    Set targ = Intersect(Target, Range(\"C:C\"))\n    Set rg = Worksheets(\"Client list\").Range(\"A:A\")\nElseif i = 2 then\n   Set targ = Intersect(Target,Range(\u201cD:D\u201d))\n   Set rg = Worksheets(\u201cClient list\u201d).Range(\u201cB:B\u201d)\nEnd If\n\n    If targ Is Nothing Then Exit Sub\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    On Error GoTo errhandler 'If code encounters an error, turn events back on\n\n    For Each cel In targ\n        If Not IsError(cel) Then\n            If cel &lt;&gt; \"\" And Right(cel, 1) &lt;&gt; Chr(10) Then\n                Set match1 = Nothing\n                Set match1 = rg.Find(cel &amp; \"*\", lookat:=xlWhole, MatchCase:=False) 'Match is case insensitive\n                If Not match1 Is Nothing Then\n                    Set match2 = rg.FindNext(after:=match1)\n                    If match2.Address = match1.Address Then 'Code is fooled by identical strings in two cells\n                        cel = match1 'Only one match found. Use it to \"autocomplete\" the cell\n                    Else 'More than one match found. User must enter more data. Return to \"Edit\" mode\n                        cel.Activate\n                        Application.SendKeys (\"{F2}\") 'Begin editing after last character entered\n                    End If\n                Else 'No matches found. Do not change entered text\n                End If\n            Else 'Strip the line feed from the end of the text string\n                If cel &lt;&gt; \"\" And Right(cel, 1) = Chr(10) Then cel = Left(cel, Len(cel) - 1)\n            End If\n        End If\n    Next cel\n\n  Next  \nerrhandler:     Application.EnableEvents = True\n\n    On Error GoTo 0\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11308111, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RkuKfv6N1n4/AAAAAAAAAAI/AAAAAAAARtU/RcccXm-Fh9k/photo.jpg?sz=128", "display_name": "Luis Puerta", "link": "https://stackoverflow.com/users/11308111/luis-puerta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554329947, "creation_date": 1554326870, "last_edit_date": 1554326905, "question_id": 55504558, "link": "https://stackoverflow.com/questions/55504558/autocomplete-from-another-sheet", "title": "Autocomplete from another sheet", "body": "<p>I'm trying to get autocomplete to work on a second column</p>\n\n<p>I have code that works to autocomplete from a source sheet column A into another sheet column C , I need this to be replicated to autocomplete a second column from a second column in the same source sheet, from column B to column D.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n     'Sub \"autocompletes\" data entered into column C using a source table on a different worksheet. If more than one match is\n     '    found, the user is allowed to continue entering characters until a unique match is found. If no matches are found, the\n     '    data is accepted as entered. ALT + Enter, Enter to force the macro to accept data as entered. The sub is triggered by\n     '    the Enter key.\n    Dim cel As Range, match1 As Range, match2 As Range, rg As Range, targ As Range\n\n     '***Please adjust the next two statements before using this code!***\n    Set targ = Intersect(Target, Range(\"C:C\")) 'Watch the cells in column C\n    Set rg = Worksheets(\"Client list\").Range(\"A:A\") 'Use named range AutoCompleteText for \"autocomplete\" info\n\n    If targ Is Nothing Then Exit Sub\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    On Error GoTo errhandler 'If code encounters an error, turn events back on\n\n    For Each cel In targ\n        If Not IsError(cel) Then\n            If cel &lt;&gt; \"\" And Right(cel, 1) &lt;&gt; Chr(10) Then\n                Set match1 = Nothing\n                Set match1 = rg.Find(cel &amp; \"*\", lookat:=xlWhole, MatchCase:=False) 'Match is case insensitive\n                If Not match1 Is Nothing Then\n                    Set match2 = rg.FindNext(after:=match1)\n                    If match2.Address = match1.Address Then 'Code is fooled by identical strings in two cells\n                        cel = match1 'Only one match found. Use it to \"autocomplete\" the cell\n                    Else 'More than one match found. User must enter more data. Return to \"Edit\" mode\n                        cel.Activate\n                        Application.SendKeys (\"{F2}\") 'Begin editing after last character entered\n                    End If\n                Else 'No matches found. Do not change entered text\n                End If\n            Else 'Strip the line feed from the end of the text string\n                If cel &lt;&gt; \"\" And Right(cel, 1) = Chr(10) Then cel = Left(cel, Len(cel) - 1)\n            End If\n        End If\n    Next cel\n\n\nerrhandler:     Application.EnableEvents = True\n\n    On Error GoTo 0\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 6, "creation_date": 1554326069, "post_id": 55504352, "comment_id": 97714870, "body": "use <code>COUNTIFS()</code>"}, {"owner": {"reputation": 159, "user_id": 10424139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eeb868d5e4cdb706af4433d310a5834?s=128&d=identicon&r=PG&f=1", "display_name": "ana bel", "link": "https://stackoverflow.com/users/10424139/ana-bel"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1554326275, "post_id": 55504352, "comment_id": 97714939, "body": "sometimes we just need the right direction , thank you so much"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554350292, "post_id": 55504352, "comment_id": 97720669, "body": "If you solve your own question, and the commenter @ScottCraner doesn&#39;t want to write and answer, you should post an answer. Also, please read --&gt; <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "owner": {"reputation": 159, "user_id": 10424139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eeb868d5e4cdb706af4433d310a5834?s=128&d=identicon&r=PG&f=1", "display_name": "ana bel", "link": "https://stackoverflow.com/users/10424139/ana-bel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554325922, "creation_date": 1554325922, "question_id": 55504352, "link": "https://stackoverflow.com/questions/55504352/match-two-cells-from-two-table-and-check-if-the-criteria-is-true", "title": "match two cells from two table and check if the criteria is true", "body": "<p>so i'm working on a code in vba i have two tables the first one is</p>\n\n<pre><code>    Work\nA   \nB   \nC   \nD   \n</code></pre>\n\n<p>and the second one is </p>\n\n<pre><code>Names   Situation\nA   Pending\nA   Pending\nA   Verified\nA   Pending\nA   Pending\nA   Verified\nB   Pending\nB   Pending\nB   Verified\nC   Pending\nC   Pending\nC   Verified\nC   Pending\nC   Pending\nC   Verified\nC   Pending\n</code></pre>\n\n<p>what to do is when the situation is verified lets suppose of the person A is to count the number of the verified and type it in the cell of work and everytime the situation changing to verified i need to increment it</p>\n"}, {"tags": ["excel", "vba", "multiple-columns"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 3, "creation_date": 1554325489, "post_id": 55504226, "comment_id": 97714659, "body": "<b><i>OR</i></b> does not work that way."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1554325502, "post_id": 55504226, "comment_id": 97714668, "body": "You just need <code>If .Cells(2, j).Value &lt;&gt; &quot;Name&quot; Or .Cells(2, j).Value &lt;&gt; &quot;F&#47;N&quot; etc</code>. <code>ws</code> is already defined as a sheet variable. But I agree with BigBen about SC."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554325570, "post_id": 55504226, "comment_id": 97714685, "body": "<code>Select Case</code> might be a cleaner option."}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1554408877, "post_id": 55505546, "comment_id": 97752670, "body": "Theres roughly 25 columns, I only want to keep&#39; &quot;Name&quot; &quot;F/N&quot; &quot;Ref Des&quot; &quot;Component Location&quot; &quot;Qty&quot; &#39; are the columns I&#39;d like to keep, I wasn&#39;t sure of how to have the loop scan for any of these values and delete the columns that aren&#39;t on that list. sorry if that wasn&#39;t clear"}], "tags": [], "owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "is_accepted": true, "score": 1, "last_activity_date": 1554332579, "creation_date": 1554332579, "answer_id": 55505546, "question_id": 55504226, "link": "https://stackoverflow.com/questions/55504226/excel-vba-scan-col-z-to-col-a-delete-if-col-header-doesnt-match-set-of-values/55505546#55505546", "title": "excel vba scan col z to col a, delete if col header doesn&#39;t match set of values delete column", "body": "<p>The way you are trying to use the <strong>OR</strong> statement is wrong.</p>\n\n<p><strong>OR</strong> -  Signifies that only one condition must be met.</p>\n\n<p><strong>AND</strong> - Signifies that both conditions are required. </p>\n\n<p>Give it a try to this...</p>\n\n<pre><code>\n '~~&gt; Set this to the relevant worksheet\n    Set ws = ActiveSheet\n    With ws\n        '~~&gt; Loop through relevant columns\n        For j = 26 To 1 Step -1\n            '~~&gt; Check if the value is equal to YY\n            If .Cells(2, j) &lt;&gt; \"Name\" And .Cells(2, j) &lt;&gt; \"F/N\" And .Cells(2, j) &lt;&gt; \"Ref Des\" And .Cells(2, j) &lt;&gt; \"Component Location\" And .Cells(2, j) &lt;&gt; \"Qty\" Then\n                Columns(j).Select\n            Selection.Delete Shift:=xlLeft\n            End If\n        Next j\n    End With\n\n\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55505546, "answer_count": 1, "score": 0, "last_activity_date": 1554332579, "creation_date": 1554325405, "last_edit_date": 1554325877, "question_id": 55504226, "link": "https://stackoverflow.com/questions/55504226/excel-vba-scan-col-z-to-col-a-delete-if-col-header-doesnt-match-set-of-values", "title": "excel vba scan col z to col a, delete if col header doesn&#39;t match set of values delete column", "body": "<p>I'm trying to scan Columns Z to A, if the column header (in row 2) doesn't match a set list of values then delete the column or range (\"Z2:Z\"&amp; last_row, etc etc). </p>\n\n<p>here is my code so far ( the column section I found online but it's not working)</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nWBPath = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\")\n\n'scan for the line to delete row 2 , row 3, row 4 depending\nFor i = 6 To 2 Step -1\n    If Range(\"A\" &amp; i) = \"\" Then\n        Rows(i).Select\n            Selection.Delete Shift:=xlUp\n                End If\n                    Next i\n\n'scan columns for matching names\n    Dim ws As Worksheet\n    Dim j As Long\n    Dim delRange As Range\n\n    '~~&gt; Set this to the relevant worksheet\n    Set ws = ActiveSheet\n\n    With ws\n        '~~&gt; Loop through relevant columns\n        For j = 26 To 1 Step -1\n            '~~&gt; Check if the value is equal to YY\n            If Worksheets(ws).Cells(2, j).Value &lt;&gt; \"Name\" Or \"F/N\" Or \"Ref Des\" Or \"Component Location\" Or \"Qty\" Then\n                Columns(i).Select\n            Selection.Delete Shift:=xlLeft\n            End If\n        Next j\n    End With\n</code></pre>\n\n<p>Failing on this line with type 13 mismatch</p>\n\n<pre><code>If Worksheets(ws).Cells(2, j).Value &lt;&gt; \"Name\" Or \"F/N\" Or \"Ref Des\" Or \"Component Location\" Or \"Qty\" Then\n</code></pre>\n\n<p>I think that my code for the rows is much cleaner, is there a similar method for columns, or a better method to scan and kill the columns?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1554326081, "post_id": 55504141, "comment_id": 97714875, "body": "You have a textbox bound to a Date/Time field? You want this field in a new record to have a default value of Today + 1 month? Use DefaultValue property with a calculation using DateAdd() function. Lock the textbox so users can&#39;t edit."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1554329729, "post_id": 55504141, "comment_id": 97716116, "body": "There is <code>Change</code> where you could monitor <code>myTextbox.Text</code> for special syntax and edit the text if matched. Would be a weird user experience, though."}], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 0, "last_activity_date": 1554350773, "creation_date": 1554350773, "answer_id": 55507680, "question_id": 55504141, "link": "https://stackoverflow.com/questions/55504141/is-there-an-event-to-change-the-value-of-a-control-in-ms-access-before-sending-i/55507680#55507680", "title": "Is there an event to change the value of a control in MS Access before sending it off to validation in the table", "body": "<p>You can use the keypress event of the control. And to blow out (to kill the keypress from access control NOT seeing the key, then set keycode = 0.</p>\n\n<p>This routine will thus allow the user to hit\nY or y   = add or subtract a year\nD or d   = add or subtract a day\nM or m   - add or subtract a month.</p>\n\n<p>Note that you have to use the shift key - caps lock is ignored.</p>\n\n<pre><code>Private Sub IvDate_KeyDown(KeyCode As Integer, Shift As Integer)\n\n  Dim strMyKeys     As String\n  strMyKeys = \"mdy\"       ' key check ignores caps\n  If InStr(strMyKeys, Chr(KeyCode)) &gt; 0 Then\n\n     If IsNull(Me.IvDate) Then Me.IvDate = Date\n\n     Select Case KeyCode\n\n        Case Asc(\"M\") And (Shift = 1)\n\n           ' Move ahead one month\n           Me.IvDate = DateAdd(\"m\", 1, Me.IvDate)\n        Case Asc(\"M\")\n           ' move bck one month\n           Me.IvDate = DateAdd(\"m\", -1, Me.IvDate)\n        Case Asc(\"D\") And (Shift = 1)\n           Me.IvDate = DateAdd(\"d\", 1, Me.IvDate)\n        Case Asc(\"D\")\n           Me.IvDate = DateAdd(\"d\", -1, Me.IvDate)\n        Case Asc(\"Y\") And (Shift = 1)\n           Me.IvDate = DateAdd(\"yyyy\", 1, Me.IvDate)\n        Case Asc(\"Y\")\n           Me.IvDate = DateAdd(\"yyyy\", -1, Me.IvDate)\n     End Select\n\n     KeyCode = 0   ' sends current key to black hole\n\n  End If\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7811058, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eWvfckllOCo/AAAAAAAAAAI/AAAAAAAAACA/2PmAlInU2Lk/photo.jpg?sz=128", "display_name": "zrice03", "link": "https://stackoverflow.com/users/7811058/zrice03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554350773, "creation_date": 1554325035, "last_edit_date": 1554329435, "question_id": 55504141, "link": "https://stackoverflow.com/questions/55504141/is-there-an-event-to-change-the-value-of-a-control-in-ms-access-before-sending-i", "title": "Is there an event to change the value of a control in MS Access before sending it off to validation in the table", "body": "<p>I have a date field with an associated datetime column, and I want to be able to enter relative date string like, say, \"m+1\" to enter a date exactly one month from today. Is there an event to hook into where I can write <strong>VBA</strong> code that will interpret that and change the field value to an actual date that the validation will understand, before it gets sent off to validation?</p>\n\n<p>I can't seem to find such an event, even <code>BeforeUpdate</code> fires too late. I get the <code>\"The value you entered isn't valid for this field.\"</code> error message before <code>BeforeUpdate</code> fires.</p>\n"}, {"tags": ["vba", "powershell", "publisher", "ms-publisher"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554327829, "post_id": 55503921, "comment_id": 97715469, "body": "This is an interesting question - it looks like only certain Office applications have a <code>Run</code> method - e.g. Excel, Word, Access, Powerpoint, and Project - but others don&#39;t, such as Outlook and Publisher. I&#39;m not sure what the workaround is or if any exists."}, {"owner": {"reputation": 11, "user_id": 11307904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1e51725e593b8e76e14a2c4eb29ca3?s=128&d=identicon&r=PG&f=1", "display_name": "coderkid420", "link": "https://stackoverflow.com/users/11307904/coderkid420"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554328499, "post_id": 55503921, "comment_id": 97715715, "body": "It may have only been in previous versions of vba, but I can&#39;t find any documentation on it for earlier versions. It&#39;s interesting because there are other responses on here indicating that the method existed for Publisher in the past."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554328625, "post_id": 55503921, "comment_id": 97715757, "body": "Hmmm out of curiosity, can you share any of those responses? didn&#39;t find anything."}, {"owner": {"reputation": 11, "user_id": 11307904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1e51725e593b8e76e14a2c4eb29ca3?s=128&d=identicon&r=PG&f=1", "display_name": "coderkid420", "link": "https://stackoverflow.com/users/11307904/coderkid420"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554329561, "post_id": 55503921, "comment_id": 97716059, "body": "It seems what I was looking at was Excel examples actually. I guess the method has never existed. It&#39;s a shame really, cause publisher does support macros."}], "owner": {"reputation": 11, "user_id": 11307904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1e51725e593b8e76e14a2c4eb29ca3?s=128&d=identicon&r=PG&f=1", "display_name": "coderkid420", "link": "https://stackoverflow.com/users/11307904/coderkid420"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554324338, "creation_date": 1554324083, "last_edit_date": 1554324338, "question_id": 55503921, "link": "https://stackoverflow.com/questions/55503921/running-publisher-macros-from-powershell-script", "title": "Running Publisher macros from Powershell script", "body": "<p>I am trying to run a Publisher macro from Powershell, but I am getting an error when trying to run the macro. Here is the error: </p>\n\n<blockquote>\n  <p>Method invocation failed because [Microsoft.Office.Interop.Publisher.ApplicationClass] does not contain a method named 'Run'</p>\n</blockquote>\n\n<p>I've seen code with the <code>.run</code> method on a publisher object in powershell around. So, has this method been removed? I can't seem to find it in the VBA documentation. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/publisher.application\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/publisher.application</a></p>\n\n<p>The method appears when I use an Excel COM object. </p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>$publisher = New-Object -ComObject Publisher.Application\n$document = $publisher.Open($labelPath)\n\n$publisher.Run('macro', $arg1, $arg2) #method not found\n\n$document.Close()\n$publisher.Quit()\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554323896, "post_id": 55503696, "comment_id": 97713987, "body": "<code>target = target + 1</code> is implicitly doing <code>target.Value = target.Value + 1</code>, which is right if that&#39;s what you mean to be doing. Is it?"}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1554323924, "post_id": 55503696, "comment_id": 97713999, "body": "Use a counter. counter = 1 If cell.Value &gt; 0 Then     targetSheet.Range(&quot;A&quot; &amp; counter).Value = cell.Value     counter = counter + 1 End If"}, {"owner": {"reputation": 1, "user_id": 11307871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45311dbc513ec2f65e6a5d93c048eaea?s=128&d=identicon&r=PG&f=1", "display_name": "SibSib1903", "link": "https://stackoverflow.com/users/11307871/sibsib1903"}, "edited": false, "score": 0, "creation_date": 1554367818, "post_id": 55503696, "comment_id": 97728328, "body": "i used a counter and now it copys all the values over  but it skips cells ? for example A2 is filled and then blank cells till A21 and bunch of copied values and again blank cells ?"}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1554386555, "post_id": 55503696, "comment_id": 97740459, "body": "@SibSib1903, I have provided an example to help you."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11307871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45311dbc513ec2f65e6a5d93c048eaea?s=128&d=identicon&r=PG&f=1", "display_name": "SibSib1903", "link": "https://stackoverflow.com/users/11307871/sibsib1903"}, "edited": false, "score": 0, "creation_date": 1554367998, "post_id": 55503839, "comment_id": 97728465, "body": "looks like i needed a counter  this solution lead to an runtimeerror"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 1, "user_id": 11307871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45311dbc513ec2f65e6a5d93c048eaea?s=128&d=identicon&r=PG&f=1", "display_name": "SibSib1903", "link": "https://stackoverflow.com/users/11307871/sibsib1903"}, "edited": false, "score": 0, "creation_date": 1554382073, "post_id": 55503839, "comment_id": 97737376, "body": "What line throw the error? Or are there any error details? You don&#39;t specifically need a counter, I don&#39;t think. The <code>For Each cell in rngTemp</code> should limit the range upon which you are searching."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1554323725, "creation_date": 1554323725, "answer_id": 55503839, "question_id": 55503696, "link": "https://stackoverflow.com/questions/55503696/loop-throug-column-and-paste-values-to-an-existing-workbook/55503839#55503839", "title": "Loop throug column and paste values to an existing workbook", "body": "<p>You can't add the number one to a Range object.</p>\n\n<p>Try replacing <code>target = target+1  '// is this right?</code> with:</p>\n\n<pre><code>Set target = target.Offset(1)\n</code></pre>\n\n<p>Does this resolve the problem?</p>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "is_accepted": false, "score": 0, "last_activity_date": 1554388704, "last_edit_date": 1554388704, "creation_date": 1554386372, "answer_id": 55517851, "question_id": 55503696, "link": "https://stackoverflow.com/questions/55503696/loop-throug-column-and-paste-values-to-an-existing-workbook/55517851#55517851", "title": "Loop throug column and paste values to an existing workbook", "body": "<p>SibSib1903, I have added below a simple example that you can easily adapt to your own requirements. It looks at all cell values in column A and any numeric value greater than zero is copied to column C starting in row 1. For example, if column A contains 45 rows with data, and only three of these rows have a numeric value greater than zero, these three values will copied in column C in the first three rows.</p>\n\n<pre><code>Public Sub copieTest()\nDim ws As Worksheet, cell As Range, rngX As Range\nDim tmpVal As Variant, counter As Long\n\nSet ws = ThisWorkbook.Worksheets(\"cop1\")\nSet rngX = ws.Range(\"A1:A\" &amp; ws.Cells(ws.Rows.count, 1).End(xlUp).Row)\n\ncounter = 1\nFor Each cell In rngX\n    tmpVal = Val(Trim(cell.Value))\n    If tmpVal &gt; 0 Then\n        ws.Range(\"C\" &amp; counter).Value = tmpVal\n        counter = counter + 1\n    End If\nNext cell\nSet rngX = Nothing: Set ws = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11307871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45311dbc513ec2f65e6a5d93c048eaea?s=128&d=identicon&r=PG&f=1", "display_name": "SibSib1903", "link": "https://stackoverflow.com/users/11307871/sibsib1903"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554388704, "creation_date": 1554323018, "question_id": 55503696, "link": "https://stackoverflow.com/questions/55503696/loop-throug-column-and-paste-values-to-an-existing-workbook", "title": "Loop throug column and paste values to an existing workbook", "body": "<p>Hi this is my first post and i am newbie when it comes to VBA.\nSo i tried the last 6 hours to accomplish  one task. </p>\n\n<p>I already managed to get the code for the For each loop and it works and copies the value to the existing workbook. But i couldnt find out why it always copies the value to A2 and not further to A3/A4/A5 and so on .</p>\n\n<p>I tried these piece of code  \" range = range + 1 \" but i keep getting runtime errors and it still copies the values to A2 and overwrites it when it gets a new value from the loop.</p>\n\n<p>I think its only a litte change needed but i cant figure it out. :(</p>\n\n<pre><code>Sub copie1()\n\nDim ws As Worksheet\nDim cell As Range\nDim targetsheet As Worksheet\nDim target As Range\nDim rngTemp As Range\n\nSet wkba = ActiveWorkbook\n\nWorksheets(\"cop1\").Activate\nLR = Cells(Rows.Count, \"A\").End(xlUp).Row\nLT = Cells(Rows.Count, \"X\").End(xlUp).Row\n\n    Set rngTemp = Range(\"X2:X\" &amp; LT)\n\n   Workbooks.Open Filename:=\"C:\\Users\\path.......\"\n        Set targetsheet = Worksheets(\"Data\")\n     Set target= targetsheet.Range(\"A1\")\n\nFor Each cell In rngTemp\nIf cell &gt; 0 Then\n\ntarget.Offset(1, 0) = cell.Value\n\n        End If\n\n\n      target = target+1  '// is this right? \n\nNext cell\n\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>my goal is the loop through column X in a Workbook and copy every single data that is bigger than 0 ( because there are empty cells &amp; cells with value 0)\nand paste it in an existing workbook in range A2/A3/A4 and so on</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1554322306, "post_id": 55503496, "comment_id": 97713301, "body": "When you say the code does work, do you mean it only works when you don&#39;t get the error, or that it works whether or not you get the error?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1554322324, "post_id": 55503496, "comment_id": 97713314, "body": "Also, on which line is the error occurring?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1554322423, "post_id": 55503496, "comment_id": 97713357, "body": "Does this code, specifically <code>FundDateCalc</code>, trigger a change in the worksheet? To be safe, events should be disabled and then enabled at the end."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1554322543, "post_id": 55503496, "comment_id": 97713422, "body": "@Mistella,  I added the line of code that the debugger highlighted, and it works unless i get the error then Excel just crashes."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554322639, "post_id": 55503496, "comment_id": 97713466, "body": "@BigBen The <code>FundDateCalc</code> does change a cell value in that specific worksheet.  Im not sure how to enable/disable events in the <code>Worksheet_Change</code> event, so I will do some research on that as well."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1554322656, "post_id": 55503496, "comment_id": 97713478, "body": "See the posted answer :)"}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554323028, "post_id": 55503595, "comment_id": 97713629, "body": "Thank you!  Whats sad is that i have used <code>Application.EnableEvents</code> so many times before."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 4, "creation_date": 1554323099, "post_id": 55503595, "comment_id": 97713655, "body": "@ZackE on the bright side, you&#39;ve contributed a &quot;stack overflow&quot; question to Stack Overflow, pretty legit if you ask me."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1554322544, "creation_date": 1554322544, "answer_id": 55503595, "question_id": 55503496, "link": "https://stackoverflow.com/questions/55503496/why-am-i-running-into-stack-overflow-error/55503595#55503595", "title": "Why am I running into Stack Overflow Error", "body": "<p>This procedure handles the <code>Worksheet.Change</code> event, which Excel fires whenever a cell changes on that worksheet.</p>\n\n<p>The handler changes cells on that sheet (or invokes code that makes changes on that sheet), and is therefore re-entrant. Disable events at the start of the procedure, and re-enable them before the end of it, to avoid recursing until the call stack can't take it anymore (i.e. until you get a \"stack overflow\" error).</p>\n\n<pre><code>Dim wasEnabled As Boolean\nwasEnabled = Application.EnableEvents\n\nApplication.EnableEvents = False\n\n'...code...\n\nApplication.EnableEvents = wasEnabled\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 55503595, "answer_count": 1, "score": 3, "last_activity_date": 1554322544, "creation_date": 1554322092, "last_edit_date": 1554322441, "question_id": 55503496, "link": "https://stackoverflow.com/questions/55503496/why-am-i-running-into-stack-overflow-error", "title": "Why am I running into Stack Overflow Error", "body": "<p>I've run into a Stack Overflow issue with the below code.  The error happened on <code>Set rngToCheck = Range(\"GenLoanAmount\")</code> and I'm not really sure why since there doesn't seem to be enough happening that would cause that issue.  This code does work, so if deemed necessary by the community I will post it on Code Review.  Thank you for taking a look.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rngToCheck As Range\n    Set rngToCheck = Range(\"GenLoanAmount\")\n\n\n    If Not Intersect(Target, Me.Range(\"FloodIns\")) Is Nothing Then\n        If Intersect(Target, Me.Range(\"FloodIns\")) = \"Y\" Or Intersect(Target, Me.Range(\"FloodIns\")) = \"y\" Then FloodEmail.Show\n    End If\n\n    If Not Intersect(Target, Me.Range(\"FloodInsAct\")) Is Nothing Then\n        If Intersect(Target, Me.Range(\"FloodInsAct\")) = \"Y\" Or Intersect(Target, Me.Range(\"FloodInsAct\")) = \"y\" Then FloodActEmail.Show\n    End If\n\n    If Not Intersect(Target, rngToCheck) Is Nothing Then\n        If Intersect(Target, rngToCheck) Then\n            rngToCheck.NumberFormat = \"$#,##0.00\"\n        End If\n    End If\n\n    If Not Intersect(Target, Me.Range(\"genCloseDate\")) Is Nothing Then\n        If Intersect(Target, Me.Range(\"genCloseDate\")) &lt;&gt; vbNullString Then FundDateCalc\n    End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1554324327, "post_id": 55502621, "comment_id": 97714177, "body": "Why don&#39;t you 1. set a dummy sheet then 2. set the open event to select that sheet and 3. show the userform? 4. Finally, when userform is closed, close the WB"}, {"owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1554325170, "post_id": 55502621, "comment_id": 97714541, "body": "@Sgdva Because I don&#39;t want to see any sheets at all. I don&#39;t want to see Excel"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1554327854, "post_id": 55502621, "comment_id": 97715480, "body": "I don&#39;t see why you couldn&#39;t set a dummy sheet in the WB that contains the Userform. By default, you cannot use a workbook with all sheets hidden. The only solutions are: use a dummy sheet which would contain nothing; use the personal workbook; or use a <a href=\"https://superuser.com/questions/543315/use-excel-2010-macro-in-some-not-all-xlsx-workbooks\">workspace approach</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1554386668, "last_edit_date": 1554386668, "creation_date": 1554331727, "answer_id": 55505450, "question_id": 55502621, "link": "https://stackoverflow.com/questions/55502621/how-to-show-a-userform-an-hide-only-the-excel-instance-that-contains-the-userfor/55505450#55505450", "title": "How to show a userform an hide ONLY the Excel instance that contains the userform", "body": "<p>Edit: The combined code below, isolates the instance of Excel that has the UserForm, forcing other files to open on another instance, and forcing you to open this file on its own instance. Allowing you to use <code>Application.Visible = False</code></p>\n\n<p>First you have to make sure that this instance of excel is only for the UserForm file.</p>\n\n<p>When you open the workbook, make sure it's the only one on the instance.</p>\n\n<p>ThisWorkbook Module:</p>\n\n<pre><code>'I'll explain why you need the App variable below\nPrivate WithEvents App As Application\nPrivate Sub Workbook_Open()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Set Wb = ThisWorkbook\n    If Application.Workbooks.Count &gt; 1 Then\n        'Not on its own instance\n        Wb.Close False\n    Else\n        'Alright, it's the only workbook, lets open the form\n        Set App = Application\n        Application.Visible = False\n        UserFormName.Show vbModeless\n    End If\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>You may be thinking \"Well this means I have to make sure I open this file before any other files or it wont work\". This is true but you work around this by creating a shortcut to Excel, specify the \"/X\" parameter to open on a new instance, and the file. This way it will open on a new instance even if other files are open. In other words, find the EXCEL.exe, create a shortcut for it, and edit the target to <code>\"C:\\Program Files (x86)\\Microsoft Office\\Office15\\EXCEL.EXE\" /X \"FilePath\\FileName.xlsm\"</code> The EXCEL Path may be different depending on your Excel version.</p>\n\n<p>Now what happens if I try to open another excel file and it tries to open it on this instance? This is where the <code>App</code> variable comes into play. These next two subscripts are Event Handlers for whenever you try to open a file or a new workbook.</p>\n\n<pre><code>'On new blank Workbook Open\nPrivate Sub App_NewWorkbook(ByVal Wb As Workbook)\n    Set cwb = ThisWorkbook\n    If Wb.Name &lt;&gt; cwb.Name Then\n        Dim opFile As Variant\n        Application.DisplayAlerts = False\n        Wb.Close False\n        opFile = Shell(\"EXCEL /X \", vbNormalFocus)\n        Application.DisplayAlerts = True\n    End If\nEnd Sub\n'On File Workbook Open\nPrivate Sub App_WorkbookOpen(ByVal Wb As Workbook)\n    Set cwb = ThisWorkbook\n    If Wb.Name &lt;&gt; cwb.Name Then\n        Dim fDir As String, opFile As Variant\n        fDir = Wb.Path &amp; \"\\\" &amp; Wb.Name\n        Application.DisplayAlerts = False\n        Wb.Close False\n        opFile = Shell(\"EXCEL /X \"\"\" &amp; fDir &amp; \"\"\"\", vbNormalFocus)\n        Application.DisplayAlerts = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>The new instance of excel becomes the \"Windows preferred\" so any new workbooks you open will try to open in the new instance, leaving the UserForm one alone. And done, this file should always be on its own instance, if you try to open another file or a new workbook, they should open in a new instance with those handlers.</p>\n\n<p>Note: Some event handlers get activated when you open the file, if you make any changes to the code you may need to Save and reopen the file for them to work properly.</p>\n"}], "owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1579644809, "creation_date": 1554318623, "last_edit_date": 1554358706, "question_id": 55502621, "link": "https://stackoverflow.com/questions/55502621/how-to-show-a-userform-an-hide-only-the-excel-instance-that-contains-the-userfor", "title": "How to show a userform an hide ONLY the Excel instance that contains the userform", "body": "<p>I'd like to open a workbook and have only a particular userform show (and hide the workbook that contains the userform). I know how to open the form when the workbook opens, however my attempts at hiding ONLY this particular workbook has failed. I need the users to be able to work and/or open other Excel windows while using the userform. Any suggestions?\nThank you,\nJP</p>\n\n<p>I have tried the following methods:</p>\n\n<pre><code>myUserform.show vbModeless\nApplication.WindowState = xlMinimized\n</code></pre>\n\n<p>The above method doesn't seem to be consistand and acts funny if other Excel windows are currently open. I have also tried:</p>\n\n<pre><code>myUserform.show vbModeless\nApplication.Visible = False\n</code></pre>\n\n<p>This second method doesn't allow users to continue working on other Excel windows (which I need)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1554316746, "post_id": 55501921, "comment_id": 97710561, "body": "in regards to the error you are receiving:  Avoid using ActiveWorkbook and specifically name the workbook.  Also, i dont see that you defined <code>myDestinationBook</code> anywhere."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1554317068, "post_id": 55501921, "comment_id": 97710740, "body": "What is <code>mySourceBook</code> there? You don&#39;t it to anything anywhere, hence the <code>Object variable not set</code> error. What are you trying to accomplish, only copying cells with data? If you have 200 cells and only 5 of them contain data, how should it be pasted on your destination sheet?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11247368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5601408c5f1bf2fd3f8c98aebd06142d?s=128&d=identicon&r=PG&f=1", "display_name": "mattman1968", "link": "https://stackoverflow.com/users/11247368/mattman1968"}, "edited": false, "score": 0, "creation_date": 1554320271, "post_id": 55502443, "comment_id": 97712277, "body": "Tim, your code worked with a minor tweak! It leaves formulas in the destination cells. Now that it does exactly what I thought I wanted, I find it is not what I really need. There are instances when the destination formula may need to be over-written with a data value from the source. Is it possible to scan the source for blank cells instead and only paste cells with a value to the destination range?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11247368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5601408c5f1bf2fd3f8c98aebd06142d?s=128&d=identicon&r=PG&f=1", "display_name": "mattman1968", "link": "https://stackoverflow.com/users/11247368/mattman1968"}, "edited": false, "score": 0, "creation_date": 1554323805, "post_id": 55502443, "comment_id": 97713948, "body": "It already only pastes non-blank cells.  If you want it to overwrite formulas then remove the <code>And Not cD.HasFormula</code> check"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1554317853, "creation_date": 1554317853, "answer_id": 55502443, "question_id": 55501921, "link": "https://stackoverflow.com/questions/55501921/import-data-range-values-but-not-blank-cells-and-or-keep-formulas-in-destinat/55502443#55502443", "title": "Import data range values - but not blank cells, and/or keep formulas in destination workbook", "body": "<p>You can do it like this:</p>\n\n<pre><code>Sub MoveIt()\n\n    Dim rngSrc As Range, rngDest As Range, i As Long, cS As Range, cD As Range\n\n    Set rngSrc = Workbooks(\"Source.xlsx\").Worksheets(\"Sheet1\").Range(\"D13:F293\")\n    Set rngDest = Workbooks(\"Target.xlsx\").Worksheets(\"Sheet4\").Range(\"D13:F293\")\n\n    For i = 1 To rngSrc.Cells.Count\n        Set cS = rngSrc.Cells(i)\n        Set cD = rngDest.Cells(i)\n        If Len(cS.Value) &gt; 0 And Not cD.HasFormula Then\n            cS.Copy cD\n            'or\n            cD.Value = cS.Value\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11247368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5601408c5f1bf2fd3f8c98aebd06142d?s=128&d=identicon&r=PG&f=1", "display_name": "mattman1968", "link": "https://stackoverflow.com/users/11247368/mattman1968"}, "is_accepted": false, "score": 0, "last_activity_date": 1554324933, "last_edit_date": 1554324933, "creation_date": 1554324632, "answer_id": 55504047, "question_id": 55501921, "link": "https://stackoverflow.com/questions/55501921/import-data-range-values-but-not-blank-cells-and-or-keep-formulas-in-destinat/55504047#55504047", "title": "Import data range values - but not blank cells, and/or keep formulas in destination workbook", "body": "<p>I got it to work how I want! Thank you very much for your help, Tim! </p>\n\n<p>Now to figure out how to import and keep the format.  </p>\n\n<pre><code>Sub TransferData()\n\nDim rngSrc As Range, rngDest As Range, i As Long, cS As Range, cD As Range\n\nSet rngSrc = Workbooks(\"Exported AMP Data.xlsx\").Worksheets(\"HELOC\").Range(\"D13:F293\")\nSet rngDest = Workbooks(1).Worksheets(\"HELOC\").Range(\"D13:F293\")\n\nFor i = 1 To rngSrc.Cells.Count\n    Set cS = rngSrc.Cells(i)\n    Set cD = rngDest.Cells(i)\n    If Len(cS.Value) &gt; 0 Then\n        cS.Copy cD\n        'or\n        cD.Value = cD.Value\n    End If\nNext i\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11247368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5601408c5f1bf2fd3f8c98aebd06142d?s=128&d=identicon&r=PG&f=1", "display_name": "mattman1968", "link": "https://stackoverflow.com/users/11247368/mattman1968"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554324933, "creation_date": 1554316052, "last_edit_date": 1554322989, "question_id": 55501921, "link": "https://stackoverflow.com/questions/55501921/import-data-range-values-but-not-blank-cells-and-or-keep-formulas-in-destinat", "title": "Import data range values - but not blank cells, and/or keep formulas in destination workbook", "body": "<p>I have a source workbook and a destination workbook. The source book has a range (<code>D13:F293</code>) that contains data values, as well as blank cells. The destination book contains the same range and various cells contain formulas.</p>\n\n<p>I want to import data from the source book to the destination book, but ONLY cells that contain a value. Furthermore, if the destination book/cell contains a formula, I want to <strong>KEEP</strong> the formula in the cell.</p>\n\n<p>My options are: </p>\n\n<ol>\n<li>Scan the source for blank cells and only import cells with data.</li>\n<li>Scan the destination for formulas, and if a formulas exists, don't import data to that cell.</li>\n</ol>\n\n<p>I don't know how to do this. I am very new to VBA and don't fully understand the syntax. I have tried 3 times with code that either replaces formulas with blank cells, or gives an error.  </p>\n\n<p>This code copies blank cells to destination book:</p>\n\n<pre><code>Sub TransferData()\n   If Workbooks.Count &gt; 1 Then\n      Workbooks(2).Sheets(\"HELOC\").Range(\"D13:F293\").Copy\n      Workbooks(1).Sheets(\"HELOC\").Range(\"D13:F293\").PasteSpecial xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n      Workbooks(2).Close savechanges:=False\n   Else\n      MsgBox \"The data hasn't been transferred.\", vbExclamation, \"Error\"\n   End If\nEnd Sub\n</code></pre>\n\n<p>This code also copies blank cells to destination book:</p>\n\n<pre><code>Sub TransferData()\n   If Workbooks.Count &gt; 1 Then\n      For Each cl In ActiveSheet.UsedRange\n         If cl.HasFormula() = True Then\n            Workbooks(1).Sheets(\"HELOC\").Range(\"D13:F293\") = Workbooks(1).Sheets(\"HELOC\").Range(\"D13:F293\")\n         Else\n            Workbooks(1).Sheets(\"HELOC\").Range(\"D13:F293\").Value = Workbooks(2).Sheets(\"HELOC\").Range(\"D13:F293\").Value\n         End If\n      Next cl\n      Workbooks(2).Close savechanges:=False\n   Else\n      MsgBox \"The data hasn\u2019t been transferred.\", vbExclamation, \"Error\"\n   End If\nEnd Sub\n</code></pre>\n\n<p>This code (modified from <a href=\"https://stackoverflow.com/questions/14495769/excel-macro-paste-only-non-empty-cells-from-one-sheet-to-another\">here</a>) results in:</p>\n\n<p>Runtime error 91\nObject variable or With block variable not set on line: </p>\n\n<p>\"If mySourceBook.Cells(i, 1).Value &lt;> \"\" Then\"</p>\n\n<pre><code>Sub TransferData()\n   Dim mySourceBook As Worksheet, myDestinationBook As Worksheet, myBook As Workbook\n   Set myBook = Excel.ActiveWorkbook\n   Set mySource = myBook.Sheets(\"HELOC\")\n   Set myImportData = Excel.ActiveWorkbook.Sheets(\"HELOC\")\n\n   Dim i As Integer, j As Integer 'Define a couple integer variables for counting\n\n   j = 13\n   For i = 13 To 293\n      If mySourceBook.Cells(i, 1).Value &lt;&gt; \"\" Then\n         myDestinationBook.Cells(j, 2).Value = mySourceBook.Cells(i, 1).Value\n         j = j + 1\n      End If\n   Next i 'This triggers the end of the loop and moves on to the next value of \"i\".\n\n   Workbooks(2).Close savechanges:=False\n\n   MsgBox \"The data hasn\u2019t been transferred.\", vbExclamation, \"Error\"\n\nEnd Sub\n</code></pre>\n\n<p>I appreciate any advice given. But please, explain it to me like I'm a child as I don't fully comprehend VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 1, "creation_date": 1554317319, "post_id": 55501619, "comment_id": 97710869, "body": "I&#39;m having trouble understanding exactly what you&#39;re trying to accomplish and how your given code works toward what you&#39;re describing. Your i loop is adding 1 each loop but that&#39;s being reset when your code reaches &quot;next&quot;, is that intentional? Also your variables are adding more confusion for me, I can&#39;t tell where some are coming from or what they&#39;re for."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 1, "creation_date": 1554317410, "post_id": 55501619, "comment_id": 97710912, "body": "I agree with @MichaelMurphy - I can&#39;t figure out <b>what you&#39;re trying do</b> - can you please provide a before/after example, maybe some screenshots of your data? Even your sample data is confusing, as well as the verbiage you&#39;re using."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1554317896, "creation_date": 1554317896, "answer_id": 55502455, "question_id": 55501619, "link": "https://stackoverflow.com/questions/55501619/having-issues-creating-a-list-of-unique-values-on-one-sheet-and-outputting-on-wo/55502455#55502455", "title": "Having issues creating a list of unique values on one sheet and outputting on worksheet", "body": "<p>Looks like some issues with qualifications and possibly just overcomplicated.  I think you can make this a little simpler on yourself by using row.value = row.value (or finding last column per row which is the more complicated way that it appears you are trying), once it meets your criteria.  Ensure you're using Option Explicit.</p>\n\n<p>using row.value = row.value:</p>\n\n<pre><code>dim i as long, lrs as long, lrd as long\nwith sheets(\"source\") \n    lrs = .cells(.rows.count,6).end(xlup).row 'find last row on source sheet\nend with\nwith sheets(\"destination\") 'claim_report?\n    for i = 1 to lrs 'loop through source sheet\n        if sheets(\"source\").cells(i,6).value = .cells(2,2).value then\n            lrd = .cells(.rows.count,6).end(xlup).row+1  'find last row +1 on destination sheet, where you will add output\n            .rows(lrd).value = sheets(\"source\").rows(i).value\n        end if\n    next i\nend with\n</code></pre>\n\n<p>using defined ranges, still value=value:</p>\n\n<pre><code>dim i as long, lrs as long, lcs as long, lrd as long\nwith sheets(\"source\") \n    lrs = .cells(.rows.count,6).end(xlup).row\nend with\nwith sheets(\"destination\") 'claim_report?\n    for i = 1 to lrs\n        if sheets(\"source\").cells(i,6).value = .cells(2,2).value then\n            lcs = sheets(\"source\").cells(i,sheets(\"source\").columns.count).end(xltoleft).column\n            lrd = .cells(.rows.count,6).end(xlup).row+1\n            .range(.cells(lrd,1).cells(lrd,lcs)).value = sheets(\"source\").range(sheets(\"source\").cells(i,1)sheets(\"source\").cells(i,lcs)).value\n        end if\n    next i\nend with\n</code></pre>\n"}], "owner": {"reputation": 76, "user_id": 10979471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c4d74d422956f24691fe886b5c7e7d?s=128&d=identicon&r=PG&f=1", "display_name": "JMeyer Data Science", "link": "https://stackoverflow.com/users/10979471/jmeyer-data-science"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554318883, "creation_date": 1554314960, "last_edit_date": 1554318883, "question_id": 55501619, "link": "https://stackoverflow.com/questions/55501619/having-issues-creating-a-list-of-unique-values-on-one-sheet-and-outputting-on-wo", "title": "Having issues creating a list of unique values on one sheet and outputting on worksheet", "body": "<p>I have a spreadsheet at the moment with a decent size dataset of 55k rows and say 15 columns that are not all full.  What I would like to do is set up a macro on another tab, where you can select a product code from a dropdown menu.  Once you select you would click the button and the program would iterate through the dataset, adding any cell values to the array before spitting out the results.  </p>\n\n<p>The dataset looks something like this:  </p>\n\n<pre><code> prod1    code    garbage   info1   info2 ... info10    \n\n1     23       1       k         a        b    ...      j  \n\n2     27       1       k         a2       b    \n\n3     57       2       k         a        b      c  \n\n4     ...  \n\n5  \n\n6  \n\n7  \n\n8  \n\n9  \n\n10  \n</code></pre>\n\n<p>I am trying to set the value for conditions to the value of the dropdown in claim_report sheet and iterate through column F where the ing code matches and if it finds a match, iterate horizontally over the info# columns until it hits an empty one.  At this point it would start going vertically downwards again until either it hits the last value in the table or finds another match and records the new info values.  </p>\n\n<p>Ideally each info value is sent to an array and printed out in cell C5:CX in the spreadsheet.  would be even better if this could remove duplicates as it goes but I am afraid I don't know enough about VBA to make it work. </p>\n\n<p>So far I have tried changing values, changing classes, changing order and just can't figure out what I am doing.  Everything I have been able to find was specific and I could not get it to work.</p>\n\n<pre><code>    Sub refresh()\n    Let ing = ThisWorkbook.Sheets(\"claim_report\").Range(\"B2\").Value\n    Dim Claims\n    Dim i As Integer, j As Integer\n    j = 0\n    For Each cell In ThisWorkbook.Sheets(\"fulldb\").Range(\"F2:F56000\")\n        If cell.Value = ing Then\n            For i = 6 To 15\n                While cell.Offset(columnOffset:=i) &lt;&gt; \"\"\n                    Claims(j) = cell.Value\n                    i = i + 1\n                    Wend\n            Next\n        End If\n    Next\n    Range(\"C4:C100\") = Claims\nEnd Sub\n\n</code></pre>\n\n<p>The reason I have the i 6->15 is because the rows are offset from the F column by 6 columns so the thought was that it was iterating through cells M2, N2, O2 ... V2  until I found a blank cell.  </p>\n\n<p>In some of the rows some of the info columns are blank so you could have 1,2,3,4 filled with the rest blank or 1-10 filled in which was why I chose to use a blank cell to break the function.  </p>\n\n<p>What I would want, using my dataset as an example is to enter code 1, have the macro create the Claims array, append the values of the columns where the code matches the input code in the other spreadsheet, [a, b,..., j,a2].  This would then be entered in the other sheet in cell C4 as a transposed list.</p>\n\n<p>For instance  </p>\n\n<pre><code>C4 : a\nC5 : b\nC6 : ...\nC14 : j\nC15 : a2\n</code></pre>\n"}, {"tags": ["excel", "vba", "dynamic", "filenames"], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 11303234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVPQi.jpg?s=128&g=1", "display_name": "Courtland9777", "link": "https://stackoverflow.com/users/11303234/courtland9777"}, "is_accepted": false, "score": 0, "last_activity_date": 1554352314, "creation_date": 1554352314, "answer_id": 55507889, "question_id": 55501440, "link": "https://stackoverflow.com/questions/55501440/how-can-i-get-the-value-from-a-cell-in-other-workbooks-based-on-dynamic-file-pat/55507889#55507889", "title": "How can I get the value from a cell in other workbooks based on dynamic file path", "body": "<p>This is a solution that can be run from Excel VBA. I admit it might be overkill to solving your issue but it will check column A for values and fill column B if it is blank from J55 of the selected workbooks without opening any of them. \nIt assumes you have Microsoft Access as part of your office suite, are running on a 64 bit version of Windows, the files your are retrieving data from have a .xlsx extension and the data you want from J55 is on \"Sheet1\". If any of these assumptions are incorrect please let me know as the code can be easily adjust to accommodate.</p>\n\n<p>From the information you have provided it seems that the file path for all the files you would like to access are static (G:\\Data\\xxx\\yyy) and only the file name is dynamic (file name = Customer ID # from column A). You will need to make a reference to Microsoft XML v6.0 and Microsoft ActiveX Data Objects x.x Library.</p>\n\n<p>The code below is mostly cut and pasted from another project I wrote. It does still need to be tested. I would advise adding some error handling and the normal performance enhancing vba code like turning off screen updating.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n\n    'Folder where Wb live\n    Const FilePath As String = \"G:\\Data\\xxx\\yyy\\\"\n\n    'Command string\n    Const request_SQL As String = \"SELECT * FROM [Sheet1$]\"\n\n    'Get last row\n    Dim LastRow As Long\n    With ActiveWorkbook.ActiveSheet\n        LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    End With\n\n    'Create Array from Main worksheet\n    Dim MainWsArray As Variant\n    MainWsArray = ActiveWorkbook.ActiveSheet.Range(Cells(1, 1), Cells(LastRow, 2))\n\n\n    Dim FullFileName As String\n\n    'Create a connection to be used throughout the loop\n    Dim Cnx As ADODB.Connection\n    Set Cnx = New ADODB.Connection\n\n    Dim CustomerId As Long\n    Dim RowCounter As Long\n    Dim Rst As ADODB.Recordset\n    Set Rst = New ADODB.Recordset\n\n    'Loop through Array to get values\n    For RowCounter = 1 To LastRow\n        If MainWsArray(2, RowCounter) = vbNullString Then\n            CustomerId = MainWsArray(1, RowCounter).Value\n            FullFileName = FilePath &amp; CustomerId\n            AssignCnx Cnx, FullFileName\n\n            'Create RecordSet\n\n            If OpenRecordset(Rst, request_SQL, Cnx) Then\n                MsgBox \"Unable to open Recordset. \" &amp; CustomerId\n            End If\n\n            'Use recordset to get data from file.\n            Rst.Move 54\n            MainWsArray(2, RowCounter) = Rst.Fields(10)\n        End If\n        Rst.Close\n        Cnx.Close\n    Next RowCounter\n\n    ActiveWorkbook.ActiveSheet.Range(Cells(1, 2), Cells(LastRow, 2)) = MainWsArray()\n\n    If Not Rst Is Nothing Then Set Rst = Nothing\n    If Not Cnx Is Nothing Then Set Cnx = Nothing\nEnd Sub\n\nPublic Sub AssignCnx(ByRef Cnx As ADODB.Connection, ByVal FullFileName As String)\n\n    'Connection\n    With Cnx\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\" 'or \"Microsoft.Jet.OLEDB.4.0\" for 32bit\n        .ConnectionString = \"Data Source=\" &amp; FullFileName &amp; _\n           \";Extended Properties='Excel 12.0 xml;HDR=NO;IMEX=1;Readonly=False'\"\n        .Open\n    End With\n\nEnd Sub\n\nPrivate Function OpenRecordset(ByRef Rst As ADODB.Recordset, ByVal request_SQL As String, ByRef Cnx As ADODB.Connection) As Boolean\n    'Error Trapping for the RecordSet\n\n    Dim backupRequestString As String\n    On Error Resume Next\n    Rst.Open request_SQL, Cnx, adOpenForwardOnly, adLockReadOnly, adCmdText\n    If Err.Number = 0 Then\n        OpenRecordset = False\n        Exit Function\n    Else\n        Rst.Close\n        OpenRecordset = True\n        Exit Function\n    End If\nEnd Function\n</code></pre>\n\n<p>I hope you find this helpful. If it is a bit much there are other ways to link workbooks to the master file from within Excel w/o VBA. It's been a long time since I have done it that way though. Best of luck. </p>\n"}], "owner": {"reputation": 1, "user_id": 11307270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/031b783dd22519e5a39c6689a6d20eba?s=128&d=identicon&r=PG&f=1", "display_name": "Tat", "link": "https://stackoverflow.com/users/11307270/tat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554352314, "creation_date": 1554314232, "last_edit_date": 1554325432, "question_id": 55501440, "link": "https://stackoverflow.com/questions/55501440/how-can-i-get-the-value-from-a-cell-in-other-workbooks-based-on-dynamic-file-pat", "title": "How can I get the value from a cell in other workbooks based on dynamic file path", "body": "<p>I would like to get the cell value from other workbooks to my master file.</p>\n\n<p>Those files are in the same folder <code>G:\\Data\\xxx\\yyy</code> while the file name is customer ID.</p>\n\n<p>I.e. the file path could be <code>G:\\Data\\xxx\\yyy\\123</code> or <code>G:\\Data\\xxx\\yyy\\234</code>\nAnd the value I would like to extract from those workbooks is in <code>Sheet ABC</code> cell <code>J55</code>.</p>\n\n<p>So the formula I input in the cell is = <code>G:\\Data\\xxx\\yyy [123.xlsm]'!$J$55</code></p>\n\n<p>In the master file, I have a list of customer ID in Column A and I would like to get the value from cell J55 in other workbooks. i.e. create a dynamic file path to get the numbers and paste it to column B.</p>\n\n<p>However, I tried to combine the link with the \u201cCONCATENATE\u201d and \u201cG\u201d but didn\u2019t work out.</p>\n\n<p>I tried the indirect function but it requires me to open the referencing workbooks that is not ideal.</p>\n\n<p>Is that a way for me to get the numbers?</p>\n\n<p>VBA coding is welcome.</p>\n"}, {"tags": ["excel", "vba", "image", "pdf", "graph"], "comments": [{"owner": {"reputation": 370, "user_id": 4279200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/20501e5969d1e1d0fcaa74fef1fa1634?s=128&d=identicon&r=PG&f=1", "display_name": "ELW", "link": "https://stackoverflow.com/users/4279200/elw"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554314064, "post_id": 55501321, "comment_id": 97709184, "body": "Print Object is checked, I should have mentioned that in my question."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554314233, "post_id": 55501321, "comment_id": 97709265, "body": "Hmmm this is strange..."}], "owner": {"reputation": 370, "user_id": 4279200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/20501e5969d1e1d0fcaa74fef1fa1634?s=128&d=identicon&r=PG&f=1", "display_name": "ELW", "link": "https://stackoverflow.com/users/4279200/elw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554313833, "creation_date": 1554313833, "question_id": 55501321, "link": "https://stackoverflow.com/questions/55501321/vba-exportasfixedformat-to-pdf-doesnt-print-certain-images", "title": "VBA ExportAsFixedFormat to PDF doesn&#39;t print certain images", "body": "<p>I have a macro that saves a PDF of a certain worksheet.  The macro works as expected sometimes, but other times will exclude pictures and graphs from the resulting PDF, while the text and formatting shows up fine.  The same worksheet will PDF correctly if I go through the File / Print menu and print to PDF.</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\" &amp; \"\\\" &amp; thisTitle &amp; \".pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n</code></pre>\n\n<p>What might cause this?  It's interesting since it seems to be intermittent for the same workbook, and not an issue for just saving to PDF.  </p>\n"}, {"tags": ["excel", "vba", "checkbox", "dropdown"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1554313068, "post_id": 55500982, "comment_id": 97708723, "body": "Sounds good - let us know if you run into any problems implementing this.  Post the code you&#39;re having problems with, and describe what happens when you run it.  If there are errors, make sure to include the error message and which line triggers it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1554313531, "post_id": 55500982, "comment_id": 97708924, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>"}, {"owner": {"reputation": 5, "user_id": 10514037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf3642a6a3cce0151b76687c33087e3?s=128&d=identicon&r=PG&f=1", "display_name": "Vin", "link": "https://stackoverflow.com/users/10514037/vin"}, "edited": false, "score": 0, "creation_date": 1554403772, "post_id": 55500982, "comment_id": 97750299, "body": "Sorry for not adding the sample code. The wizard does not take you to post sample code while creating the question."}], "owner": {"reputation": 5, "user_id": 10514037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf3642a6a3cce0151b76687c33087e3?s=128&d=identicon&r=PG&f=1", "display_name": "Vin", "link": "https://stackoverflow.com/users/10514037/vin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554405638, "creation_date": 1554312616, "last_edit_date": 1554405638, "question_id": 55500982, "link": "https://stackoverflow.com/questions/55500982/dynamically-update-the-list-based-on-another-cell-excel", "title": "Dynamically update the list based on another cell, Excel", "body": "<p>The master spreadsheet has 700 entries which has categories associated with each of them. The user gets to choose the categories (checkbox) which is of his interest. Based on the selection, the summary sheet should contain the entry details from the master sheet. Each entry has fixed columns. Entire row of each entry is to be copied to summary sheet and not just once cell. </p>\n\n<p>It will be nice to have this dynamically changeable (i.e, user can change his selection and the summary sheet should get automatically updated).</p>\n\n<p>Any help would be appreciated.. With the below code I am not able to append to the existing data. Below statement does not accept lastRow as parameter.</p>\n\n<pre><code>Sheets(\"Sheet4\").Cells.Copy Destination:=Sheets(\"Dest\").Cells(lastRow, 1) \n</code></pre>\n\n<p>Code: This needs a lot of cleaning. I am yet to get this working</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Src As Worksheet, Dest As Worksheet\nDim lastRow As Long, j As Long\nDim CellValue As String\nDim SrcSheets As String\nSet Src = ThisWorkbook.Sheets(\"Sheet3\") ' Needs to run through all the sheets. Change the sheet number using a for loop?\nSet Dest = ThisWorkbook.Sheets(\"Dest\")\n\n'Clear the entire dest sheet before running the logic\nDest.Cells.ClearContents\n\n'h24 is cell where the total rows are filled\nWorksheets(\"Selection\").Range(\"h24\").Value = 0\nlastRow = 1 ' this always makes the destination to start from first line, overwriting the existing rows\n\n    If (Worksheets(\"Selection\").Cells(1, 5).Value = True) Then\n\n        Sheets(\"Sheet3\").Cells.Copy Destination:=Sheets(\"Dest\").Cells(1, 1)\n        lastRow = Sheets(\"Sheet3\").Cells.SpecialCells(xlLastCell).Row\n\n        Worksheets(\"Selection\").Range(\"h24\").Value = lastRow\n    End If\n\n    ' Check if second checkbox is selected\n    If (Worksheets(\"Selection\").Cells(2, 5).Value = True) Then\n        Sheets(\"Sheet4\").Cells.Copy Destination:=Sheets(\"Dest\").Cells(lastRow, 1)\n\n        lastRow = ThisWorkbook.Sheets(\"Dest\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n        Worksheets(\"Selection\").Range(\"h24\").Value = lastRow\n    End If\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1554315518, "post_id": 55500572, "comment_id": 97709912, "body": "Your code should work just fine, my guess is that <code>&quot;F:\\Export.pdf&quot;</code> is your culprit. Do you have access to this location?"}, {"owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1554316269, "post_id": 55500572, "comment_id": 97710319, "body": "Actually the culprit seems to be that when I plug my laptop into my dock the runtime error occurs, when I run the code without the dock, it works fine"}], "owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554313485, "creation_date": 1554311037, "last_edit_date": 1554313485, "question_id": 55500572, "link": "https://stackoverflow.com/questions/55500572/runtime-error-1004-for-code-that-worked-fine", "title": "Runtime error 1004 for code that worked fine", "body": "<p>I have the following code in a spreadsheet that's been used for months in the office:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    With Sheets(\"Summary\").Range(\"B2:H83\")\n        .ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=\"F:\\Export.pdf\", _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Today, when I try to execute I get a Runtime error 1004.</p>\n\n<p>We did a recent Office 365 update, could that be the culprit?</p>\n"}, {"tags": ["vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1554310896, "post_id": 55500108, "comment_id": 97707694, "body": "Does Outlook open and is it visible when you run this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 3, "creation_date": 1554311947, "post_id": 55500108, "comment_id": 97708233, "body": "Basic rule when it is not working as expected: <b>Single Step</b>. Did you try that? Also you need to eliminate all code that is not relevant: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1554314806, "post_id": 55500108, "comment_id": 97709560, "body": "Outlook does not open and nothing occurs if it is already open."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 1, "creation_date": 1554315796, "post_id": 55500108, "comment_id": 97710048, "body": "Do you have <code>On Error Resume Next</code> anywhere in your code which could be masking an error?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1554316034, "post_id": 55500108, "comment_id": 97710182, "body": "Doesn&#39;t look like DestFile contains a full file path. Code will error if filepath is not valid and file not found. You must have an error handler trapping the error. Step debug. Disable the error handler while debugging."}, {"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1554321104, "post_id": 55500108, "comment_id": 97712708, "body": "@June7 is right that my DestFile does not seem to be a full path. In testing I&#39;ve called the EmailInvoice sub with the DestFile appended to the filepath in that sub (where the invoices get stored). I get a compilation error once the sub runs of &quot;user-defined type not defined&quot; related to my Dim(s) of the outlook objects such as <code>Dim objApp As Outlook.Application</code> and     <code>Dim objEmail As Outlook.MailItem</code>"}, {"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1554322053, "post_id": 55500108, "comment_id": 97713181, "body": "Seems I had to go to Tools &gt; References and enable <code>Microsoft Outlook 16.0 Object Library</code> as answered on <a href=\"https://stackoverflow.com/a/30648573/5619176\">stackoverflow.com/a/30648573/5619176</a> . Now I only need to sort out passing a proper full file path."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1554339629, "post_id": 55500108, "comment_id": 97718513, "body": "is <code>DestFile</code> the full path with file name?"}, {"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1554386028, "post_id": 55500108, "comment_id": 97740088, "body": "I have sorted out the issue with <code>DestFile</code>. At first it was only the filename, then once I fixed that it turned out I was sending the filepath without the <code>.PDF</code> file extension. Now I have <code>strTestFile = &quot;c:\\OneDrive\\Invoices\\&quot; &amp; strNewFileName &amp; &quot;.pdf&quot;</code>."}, {"owner": {"reputation": 753, "user_id": 7526564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K9yKl.jpg?s=128&g=1", "display_name": "Vlado", "link": "https://stackoverflow.com/users/7526564/vlado"}, "edited": false, "score": 0, "creation_date": 1580485936, "post_id": 55500108, "comment_id": 106124862, "body": "Here is my function I use in my applications to send emails from Access using Outlook: <a href=\"https://stackoverflow.com/a/59975664/7526564\">stackoverflow.com/a/59975664/7526564</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1554320727, "post_id": 55502702, "comment_id": 97712511, "body": "While this is appreciated, it doesn&#39;t seem to be the issue. I have tried with Outlook open with a profile and email loaded, and nothing happens. I do not get a email window or error of any kind."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 1, "creation_date": 1554323513, "post_id": 55502702, "comment_id": 97713841, "body": "Look into it anyway. They may have done with the warning but not with the security policy. I know that I have spent many hours in the past wondering why my email sending was silently failing until I stumbled on an article about how Outlook requires special permissions to send email programmatically."}, {"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1554323967, "post_id": 55502702, "comment_id": 97714014, "body": "After ironing out some issues with the file path, I&#39;ve got it loading now, and I see the message/warning you speak of. I will look into this topic however to suppress this warning, as it will be frustrating for the user. <a href=\"https://support.office.com/en-us/article/i-get-warnings-about-a-program-accessing-email-address-information-or-sending-email-on-my-behalf-86cc5ece-379e-45e3-b8eb-3fefba09946b?NS=MSACCESS&amp;Version=16&amp;SysLcid=1033&amp;UiLcid=1033&amp;AppVer=ZAC160&amp;HelpId=olmain11.chm553714172&amp;ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a> provides decent info. You also mention having OL open..this is the only way it now works."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 1, "creation_date": 1554324241, "post_id": 55502702, "comment_id": 97714140, "body": "I have it working on customer sites in an Active directory environment with access to group policies. Without that it may be a per-workstation and/or per-user one time setting."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 1, "last_activity_date": 1554318929, "creation_date": 1554318929, "answer_id": 55502702, "question_id": 55500108, "link": "https://stackoverflow.com/questions/55500108/how-to-send-an-email-with-a-pdf-attached-with-outlook-using-ms-access-vba/55502702#55502702", "title": "How to Send an Email with a PDF attached with Outlook using MS Access VBA?", "body": "<p>Your issue is with probably Outlook security. Normally Outlook would show a popup that says that a 3rd party application is attempting to send email through it. Would you like to allow it or not. However since you are doing this programmatically that popup never appears. There used to be a way to bypass this.</p>\n\n<p>Test your program while the user is logged on and has Outlook open. See if there will be any difference in behavior. If that popup does come up, google the exact message and you will probably find a way to bypass it.</p>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 1, "creation_date": 1554386177, "post_id": 55506622, "comment_id": 97740189, "body": "Yes, adding <code>PathFile = strEstFolder &amp; strNewFileName &amp; &quot;.pdf&quot;</code> was the fix for my issues with file path. At first I was passing the filename, and then I was passing the path without <code>.pdf</code> appended."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1554341787, "creation_date": 1554341787, "answer_id": 55506622, "question_id": 55500108, "link": "https://stackoverflow.com/questions/55500108/how-to-send-an-email-with-a-pdf-attached-with-outlook-using-ms-access-vba/55506622#55506622", "title": "How to Send an Email with a PDF attached with Outlook using MS Access VBA?", "body": "<p><em>To pass full path try using <code>Function EmailInvoice</code></em></p>\n\n<p><em>Example</em></p>\n\n<pre><code>Option Explicit\n#Const LateBind = True\nConst olFolderInbox As Long = 6\n\nPublic Sub ExportToPDF( _\n           ByVal strSrcFileName As String, _\n           ByVal strNewFileName As String, _\n           ByVal strReportType As String _\n                )\n\n    Dim PathFile As String\n\n    Dim strEstFolder As String\n        strEstFolder = \"c:\\OneDrive\\Estimates\\\"\n    Dim strInvFolder As String\n        strInvFolder = \"c:\\OneDrive\\Invoices\\\"\n\n    ' Export to Estimates or Invoices Folder based on passed parameter\n    If strReportType = \"EST\" Then\n        DoCmd.OutputTo acOutputForm, strSrcFileName, acFormatPDF, _\n                       strEstFolder &amp; strNewFileName &amp; \".pdf\", False, \"\"\n\n\n        PathFile = strEstFolder &amp; strNewFileName &amp; \".pdf\"\n\n\n    ElseIf strReportType = \"INV\" Then\n        DoCmd.OutputTo acOutputForm, strSrcFileName, acFormatPDF, _\n                       strInvFolder &amp; strNewFileName &amp; \".pdf\", False, \"\"\n\n\n        PathFile = strEstFolder &amp; strNewFileName &amp; \".pdf\"\n\n\n    End If\n\n    EmailInvoice PathFile ' call function\n\nEnd Sub\n\nPublic Function EmailInvoice(FldrFilePath As String)\n\n    Dim objApp As Object\n    Set objApp = CreateObject(\"Outlook.Application\")\n\n    Dim objNS As Object\n    Set objNS = olApp.GetNamespace(\"MAPI\")\n\n    Dim olFolder As Object\n    Set olFolder = objNS.GetDefaultFolder(olFolderInbox)\n        'Open inbox to prevent errors with security prompts\n        olFolder.Display\n\n    Dim objEmail As Outlook.MailItem\n    Set objEmail = oApp.CreateItem(olMailItem)\n\n    With objEmail\n        .Recipients.Add \"email@domain.com\"\n        .Subject = \"Invoice\"\n        .Body = \"See Attached\"\n        .Attachments.Add FldrFilePath\n        .Display\n    End With\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 0, "creation_date": 1554386413, "post_id": 55507866, "comment_id": 97740347, "body": "Honestly, I simply did not use <code>sendObject</code> because I was not fully aware of it, and I had a bit of familiarity with building an email the way I have done it in the post. As for being limited to Outlook with my method, that is not a concern, as the user is highly entrenched in Outlook and the MS ecosystem. As for the separate write out, that is because I need the PDFs to also be preserved in the directory, not just email them out. The directory is a One Drive folder that syncs. Though, I may have misunderstood what you have said."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "edited": false, "score": 1, "creation_date": 1554419523, "post_id": 55507866, "comment_id": 97756396, "body": "No problem. It just a possible suggest. And it only lets you have &quot;one go&quot; at this and thus is limited to one attachment. It also a great way to just launch say a blank email with the send to email - the rest of the params can be left blank, so it can save some coding (a nice quick way to launch a email ready for the user to fill out).  However, I will admit that I have a great routine I call for most emails, and I also thus create a instance of outlook. So, just keep this option in your bag of tricks - it can still be useful."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1554352157, "creation_date": 1554352157, "answer_id": 55507866, "question_id": 55500108, "link": "https://stackoverflow.com/questions/55500108/how-to-send-an-email-with-a-pdf-attached-with-outlook-using-ms-access-vba/55507866#55507866", "title": "How to Send an Email with a PDF attached with Outlook using MS Access VBA?", "body": "<p>Any reason why you not using sendOject?</p>\n\n<p>The advantage of sendobject, is that you not restriced to Outlook, and any email client should work.</p>\n\n<p>So, this code can be used:</p>\n\n<pre><code>  Dim strTo   As String\n  Dim strMessage    As String\n  Dim strSubject    As String\n\n  strTo = \"abc@abc.com;def@def.com\"\n\n  strSubject = \"Your invoice\"\n  strMessage = \"Please find the invoice attached\"\n\n  DoCmd.SendObject acSendReport, \"rptInvoice\", acFormatPDF, _\n        strTo, , , strSubject, strMessage\n</code></pre>\n\n<p>Note that if you need to filter the report, then open it first before you run send object. And of course  you close the report after (only required if you had to filter, and open the report before - if no filter is to be supplied, then above code will suffice without having to open the report first). </p>\n\n<p>There is no need to separate write out the pdf file, and no need to write code to attach the resulting pdf. The above does everything in one step, and is effectively one line of code.</p>\n"}], "owner": {"reputation": 153, "user_id": 5619176, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7pVCq.jpg?s=128&g=1", "display_name": "DevonRyder", "link": "https://stackoverflow.com/users/5619176/devonryder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2770, "favorite_count": 0, "accepted_answer_id": 55506622, "answer_count": 3, "score": 2, "last_activity_date": 1616323137, "creation_date": 1554309222, "last_edit_date": 1592683488, "question_id": 55500108, "link": "https://stackoverflow.com/questions/55500108/how-to-send-an-email-with-a-pdf-attached-with-outlook-using-ms-access-vba", "title": "How to Send an Email with a PDF attached with Outlook using MS Access VBA?", "body": "<p>I am working with an Access application within Access 2016. The application outputs to a PDF file via the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.docmd.outputto\" rel=\"nofollow noreferrer\">DoCmd.OutputTo</a> method.</p>\n\n<p>I want to either send this PDF attached to an email I build in code, or open a new Outlook email with the file attached.</p>\n\n<p>When I click the button in the form which triggers the code that includes my sub(s) (which are located in separate modules), the email window is never displayed nor is an email sent (depending on the use of <code>.Display</code> vs <code>.Send</code>). I also do not receive any errors.</p>\n\n<p>I think it may also be worth noting that the Call to the sub inside of a module that creates the PDF works as expected.</p>\n\n<p>I am running Access 2016 and Outlook 2016 installed as part of Office 2016 Pro Plus on a Windows 7 64-bit machine. The Office suite is 32-bit.</p>\n\n<p><strong>The Module &amp; Sub</strong>\n<em>(Email Address Redacted</em>)</p>\n\n<pre><code>Dim objEmail As Outlook.MailItem\nDim objApp As Outlook.Application\n\nSet objApp = CreateObject(\"Outlook.Application\")\n\nSet objEmail = oApp.CreateItem(olMailItem)\nWith objEmail\n    .Recipients.Add \"email@domain.com\"\n    .Subject = \"Invoice\"\n    .Body = \"See Attached\"\n    .Attachments.Add DestFile\n    .Display        \nEnd With\n</code></pre>\n\n<p><strong>The Sub Call</strong></p>\n\n<pre><code>MsgBox \"Now saving the Invoice as a PDF\"\nstrInvoiceNbr = Int(InvoiceNbr)\nstrWhere = \"[InvoiceNbr]=\" &amp; Me!InvoiceNbr\nstrDocName = \"Invoice Print One\"\nScrFile = \"Invoice Print One\"\nDestFile = \"Inv\" + strInvoiceNbr + \" - \" + Me.GetLastname + \" - \" + GetLocation\nMsgBox DestFile, vbOKOnly\n\nDoCmd.OpenForm strDocName, , , strWhere\nCall ExportToPDF(SrcFile, DestFile, \"INV\")\nCall EmailInvoice(DestFile)\n</code></pre>\n\n<p>Based on the fact that the PDF is being output within a sub in a Module file, should I be creating the email (or calling the sub) within the sub that creates the PDF?</p>\n\n<p><strong>NOTE</strong>: I have looked over <a href=\"https://stackoverflow.com/a/33922764/5619176\">this accepted answer</a> here on Stack Overflow, as well as many others. My question differs due to the fact that I am asking why the message is not being displayed or sent, not how to build and send a message as the others are.</p>\n\n<p><strong>EDIT</strong>:\nOutlook does not open and nothing occurs if Outlook is already open.</p>\n\n<p><strong>Final Note</strong>:\nTo add to the accepted answer, in the VBA editor for Access, you will likely have to go to <code>Tools &gt; References</code> and enable <code>Microsoft Outlook 16.0 Object Library</code> or similar based on your version of Office/Outlook.</p>\n"}, {"tags": ["vba", "class"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1554309874, "post_id": 55499935, "comment_id": 97707187, "body": "In the <code>test</code> method you haven&#39;t set <code>test</code> (try not to use the same name as your method...) to an instance of <code>cRoles</code> - when you try to access it it&#39;s still <code>Nothing</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554310644, "post_id": 55499935, "comment_id": 97707581, "body": "Side note, that <code>SetUser</code> property should probably be a method (<code>Sub</code>). Write-only properties are a design smell in OOP."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "edited": false, "score": 0, "creation_date": 1554313146, "post_id": 55500448, "comment_id": 97708758, "body": "This is a great overview of classes, thank you. Setting the global variable accomplished what I wanted! thanks again."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1554310559, "creation_date": 1554310559, "answer_id": 55500448, "question_id": 55499935, "link": "https://stackoverflow.com/questions/55499935/how-to-make-class-variables-persist-between-modules-in-vba/55500448#55500448", "title": "How to make class variables persist between modules in VBA", "body": "<p>Class modules define the public interface for objects: they are <em>blueprints</em> that mean nothing until they are <em>instantiated</em> with the <code>New</code> keyword.</p>\n\n<p>When you do this:</p>\n\n<pre><code>Dim test As cRoles\n</code></pre>\n\n<p>You allocate memory for an object pointer, and telling the compiler that this object implements the <code>cRoles</code> interface; that's how you can type <code>test.</code> and get a list of all the public members on that interface.</p>\n\n<p>However that object pointer points to no object: it's <code>Nothing</code> (literally). You need to create a new instance of that class in order to access the object <code>test</code> is pointing to:</p>\n\n<pre><code>Set test = New cRoles\n</code></pre>\n\n<p>And now accessing <code>test</code> members will no longer throw error 91.</p>\n\n<p>Now, each instance encapsulates its own state: think of each worksheet in your workbook as a <code>Worksheet</code> instance: each sheet has its own separate content, but all sheets can be manipulated through the same <code>Worksheet</code> interface, regardless of whether you're looking at <code>Sheet1</code> or <code>Sheet42</code>.</p>\n\n<p>The same is true for all instances of your <code>cRoles</code> class:</p>\n\n<pre><code>Dim test1 As cRoles\nSet test1 = New cRoles\ntest1.SetUser = user1\n\nDim test2 As cRoles\nSet test2 = New cRoles\ntest2.SetUser = user2\n\nDebug.Print test1.LoggedEmpId, test2.LoggedEmpId\n</code></pre>\n\n<p>The two instances are completely distinct, and each hold their own internal state. If that's what you want, then in order to create an instance in one place and consume it in another place, you'll need to pass the object reference as a parameter:</p>\n\n<pre><code>Public Sub Test()\n    Dim thing As cRoles\n    Set thing = New cRoles\n    thing.SetUser = Environ(\"username\")\n    DoSomething thing\nEnd Sub\n\nPrivate Sub DoSomething(ByVal auth As cRoles)\n    Debug.Print auth.LoggedEmpId\nEnd Sub\n</code></pre>\n\n<p>Note:</p>\n\n<ul>\n<li>You typically want to pass parameters <code>ByVal</code></li>\n<li>Avoid <code>As New</code> since that makes an auto-instantiated object, and that comes with behavior that may or may not be expected.</li>\n<li>You could have a global-scope <code>Public AuthInfo As cRoles</code> variable declared in a standard module, then a procedure responsible for creating the object and setting this global-scope reference. Then you can access <code>AuthInfo</code> everywhere in your VBA project - the caveat being, that global variable can now be <em>written to</em> by any code in your VBA project. Prefer using local variables and parameters if possible.</li>\n</ul>\n"}], "owner": {"reputation": 97, "user_id": 5498919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a70fc0443dacc8da61e410bc622407?s=128&d=identicon&r=PG&f=1", "display_name": "JP1", "link": "https://stackoverflow.com/users/5498919/jp1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 55500448, "answer_count": 1, "score": 2, "last_activity_date": 1554310559, "creation_date": 1554308648, "last_edit_date": 1554309707, "question_id": 55499935, "link": "https://stackoverflow.com/questions/55499935/how-to-make-class-variables-persist-between-modules-in-vba", "title": "How to make class variables persist between modules in VBA", "body": "<p>I am trying to find a way for class variables to persist between modules.\nI have a use class that stores typical user data: Name, domain, manager, etc.</p>\n\n<p>I'd like to store this information throughout the life of the session (while the user is using the tool), but it looks like I can't do that. Below is an example and thank for your help/advice!\nJP</p>\n\n<p>Here is the class module:</p>\n\n<pre><code>Private cLoggedDomain As String\nPrivate cLoggedRole As String\nPrivate cDepartment As String\nPrivate cEmployeeName As String\nPrivate cManagerName As String\nPrivate cEmp_ID As Long\nPrivate cEmployeeInfo As Collection\n\nPublic Property Let SetUser(value As String)\n    'RECIEVES THE LOGGED DOMAIN AS STRING\n    'GETS THE DB ATTRIBUTES FROM SQL\n    Set cEmployeeInfo = GetInfoFromSearch(\"Employee, manager, department, ety_type, emp_ID\", _\n                                         \"domainID = '\" &amp; value &amp; \"'\", _\n                                         \"Employee\", \"v_roster_empViewALL\")\n\n    cLoggedDomain = value\n    cEmployeeName = cEmployeeInfo(1)(1)\n    cManagerName = cEmployeeInfo(1)(2)\n    cDepartment = cEmployeeInfo(1)(3)\n    cLoggedRole = cEmployeeInfo(1)(4)\n    cEmp_ID = cEmployeeInfo(1)(5)\nEnd Property\n\nPublic Property Get LoggedDomain() As String\n    LoggedDomain = cLoggedDomain\nEnd Property\n\nPublic Property Let LoggedDomain(value As String)\n    cLoggedDomain = value\nEnd Property\n\nPublic Property Get LoggedRole() As String\n    LoggedRole = cLoggedRole\nEnd Property\n\nPublic Property Get LoggedDepartment() As String\n    LoggedDepartment = cDepartment\nEnd Property\n\nPublic Property Get LoggedEmployeeName() As String\n    LoggedEmployeeName = cEmployeeName\nEnd Property\n\nPublic Property Get LoggedManagerName() As String\n    LoggedManagerName = cManagerName\nEnd Property\n\nPublic Property Get LoggedEmpId() As String\n    LoggedEmpId = cEmp_ID\nEnd Property\n</code></pre>\n\n<p>And the module that uses it, which works fine:</p>\n\n<pre><code>Public Sub New_LoadMain()\nDim s As Worksheet\nDim loggedUser As New cRoles\n\n    'CHECK TO SEE IF USER IS LOGGED IN\n    If loggedUser.LoggedDomain = \"\" Then\n        'Set loggedUser = New cRoles\n         loggedUser.SetUser = Environ(\"username\")\n\n    Else\n\n    End If\n\n    Call test\n</code></pre>\n\n<p>However, when I try to use the test module, I get a with block error?</p>\n\n<pre><code>Sub test()\nDim test As cRoles\nDim t As String\n\nt = test.LoggedDepartment\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "offset"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 2, "creation_date": 1554311551, "post_id": 55499892, "comment_id": 97708026, "body": "You received the error because <code>lastRow3</code> is an integer not a range, so you can&#39;t use <code>Offset</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554311983, "post_id": 55499892, "comment_id": 97708248, "body": "^^ that. Now with that said, row numbers/counts should be <code>As Long</code> (32-bit), not <code>As Integer</code> (16-bit). Any value greater than 32,767 will overflow an <code>Integer</code> (runtime error 6)."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1554317820, "post_id": 55499892, "comment_id": 97711098, "body": "In essence, that line should just be <code>lastRow4 = lastRow3 - 1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "edited": false, "score": 0, "creation_date": 1554365574, "post_id": 55500031, "comment_id": 97726990, "body": "Thanks a lot to all of you for your help! The reply which helps me the most to fix my issue was the one of Error 1004, I modified the code he provided (please see below) and it works perfectly now:  Sub test () Dim LastRow As Long            LastRow = ActiveSheet.Range(&quot;F&quot; &amp; Rows.Count).End(xlUp).Row &#39;&lt;- Get the last row of column F           &#39;In order to refer to line before Lastrow you can use:          Range(&quot;A3:F&quot; &amp; LastRow - 1).Select       End Sub"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 3, "last_activity_date": 1554308941, "creation_date": 1554308941, "answer_id": 55500031, "question_id": 55499892, "link": "https://stackoverflow.com/questions/55499892/issue-to-offset-lastrow/55500031#55500031", "title": "Issue to offset lastrow", "body": "<p>The below is not the code. it is an example. modify and try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRow As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row '&lt;- Get the last row of column A sheet1\n\n        'In order to refer to line before Lastrow you can use:\n\n        .Range (\"A\" &amp; LastRow - 1)\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1554311905, "creation_date": 1554311905, "answer_id": 55500807, "question_id": 55499892, "link": "https://stackoverflow.com/questions/55499892/issue-to-offset-lastrow/55500807#55500807", "title": "Issue to offset lastrow", "body": "<p>Try the code below, explanation inside the Code's comments:</p>\n\n<pre><code>Option Explicit\n\nSub gdfgdhgf()\n\nDim sourceCol As Long, rowCount As Long, currentRow As Long, lastRow3 As Long, lastRow4 As Long\nDim CurrentRng As Range\nDim currentRowValue As String\nDim Sht As Worksheet\n\nSet Sht = ThisWorkbook.Sheets(\"Sheet1\") '&lt;-- modify \"Sheet1\" to your sheet's name\n\nsourceCol = 5 'column F has a value of 5\n\nWith Sht\n    rowCount = .Cells(.Rows.Count, sourceCol).End(xlUp).Row ' for every row, find the first blank cell and select it\n\n    For currentRow = 1 To rowCount\n        ' I think you are trying to set it as a range\n        Set CurrentRng = .Cells(currentRow, sourceCol)\n\n        If IsEmpty(CurrentRng) Or CurrentRng.Value2 = \"\" Then\n            lastRow3 = CurrentRng.Row ' get the row of the CurrentRng.Row\n        End If\n    Next\n\n    lastRow4 = lastRow3 - 1 ' just subtract 1, no need to use Offset\n    .Range(\"A3:F\" &amp; lastRow4).Select ' &lt;-- Not sure why you need to Select\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 55500031, "answer_count": 2, "score": 0, "last_activity_date": 1554358697, "creation_date": 1554308476, "last_edit_date": 1554358697, "question_id": 55499892, "link": "https://stackoverflow.com/questions/55499892/issue-to-offset-lastrow", "title": "Issue to offset lastrow", "body": "<p>I have a problem to offset from the previous row my last row. Indeed I try to run my code below, I have the error message which appears </p>\n\n<blockquote>\n  <p>compile error: invalid qualifier\u2026</p>\n</blockquote>\n\n<p>The problem apparently comes from my variable <code>lastRow4 = lastRow3.Offset(-1, 0)</code></p>\n\n<p>When I remove this line of my code and I replaced in my VBA code the penultimate line <code>Range(\"A3:F\" &amp; lastRow4).Select</code> by <code>Range(\"A3:F\" &amp; lastRow3).Select</code>, my code works but the selection selects my range until <code>lastrow</code> (in my code, it is <code>lastRow3</code>) and it is not what I want.</p>\n\n<p>If someone knows the solution how to fix the issue in order that my variable lastRow4 does not return me any error message, that would be great.</p>\n\n<p>Many thanks in advance.\nXavi</p>\n\n<pre><code>Sub gdfgdhgf()\n\n\nDim sourceCol As Integer, rowCount As Integer, currentRow As Integer, lastRow3 As Integer, lastRow4 As Integer\nDim currentRowValue As String\n\nsourceCol = 5 'column F has a value of 5\nrowCount = Cells(Rows.Count, sourceCol).End(xlUp).Row 'for every row, find the first blank cell and select it\nFor currentRow = 1 To rowCount\n    currentRowValue = Cells(currentRow, sourceCol).Value\n    If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n        lastRow3 = currentRow\n    End If\nNext\nlastRow4 = lastRow3.Offset(-1, 0)\nRange(\"A3:F\" &amp; lastRow4).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-office"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554308774, "post_id": 55499819, "comment_id": 97706638, "body": "Welcome to SO! Please include all the necessary information in the post itself, including any relevant code. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for ideas. Cheers!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554308953, "post_id": 55499819, "comment_id": 97706738, "body": "Note that the VBE is very en-US centric and only supports ANSI encoding; designer &amp; properties toolwindow might not be able to display Unicode correctly; it&#39;s possible the properties can be assigned to a Unicode string at run-time though. Have you tried setting the captions programmatically?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1554309865, "post_id": 55499819, "comment_id": 97707182, "body": "Can you also mention what language/region you&#39;re trying to see?"}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 10701298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1d562bf0bd0ae52302d92ce5dc7987?s=128&d=identicon&r=PG&f=1", "display_name": "RaphX", "link": "https://stackoverflow.com/users/10701298/raphx"}, "is_accepted": true, "score": 1, "last_activity_date": 1554312309, "last_edit_date": 1554312309, "creation_date": 1554311879, "answer_id": 55500794, "question_id": 55499819, "link": "https://stackoverflow.com/questions/55499819/i-cant-change-my-caption-in-my-region-language-in-vba-excel/55500794#55500794", "title": "I can&#39;t change my caption in my region language in VBA excel", "body": "<p>You can try the following steps:</p>\n\n<ol>\n<li>Open Control Panel</li>\n<li>Click Region</li>\n<li>Click the Administrative tab</li>\n<li>Click the Change system locale button</li>\n<li>Select which language to use when displaying text in programs, such as VBE, that do not support Unicode. The setting will affect all user accounts on your computer.</li>\n</ol>\n\n<p>This should give the desired output.</p>\n"}], "owner": {"reputation": 3, "user_id": 11306787, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-C4p4fsozfp0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-UHIHUShnwm8q-sFW9LaHk4ToQA/mo/photo.jpg?sz=128", "display_name": "hajaJa", "link": "https://stackoverflow.com/users/11306787/hajaja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 55500794, "answer_count": 1, "score": 0, "last_activity_date": 1554312309, "creation_date": 1554308255, "last_edit_date": 1554310948, "question_id": 55499819, "link": "https://stackoverflow.com/questions/55499819/i-cant-change-my-caption-in-my-region-language-in-vba-excel", "title": "I can&#39;t change my caption in my region language in VBA excel", "body": "<p>I try to change my caption in my region language but it does not work. I already changed my font to support my region font and it still not works. The message it showed me \"??????\" when I wrote my region language. \nHere's <a href=\"https://i.stack.imgur.com/jekia.jpg\" rel=\"nofollow noreferrer\">a link</a>. </p>\n\n<p><a href=\"https://i.stack.imgur.com/jekia.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jekia.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "edited": false, "score": 0, "creation_date": 1554308346, "post_id": 55499769, "comment_id": 97706420, "body": "What do you qualify as &quot;duplicate&quot; workbooks? Your condition should check for that. Do you mean if they have everything the same, except the filename? In this case, one way to do that would be to check if they have the same hash value."}, {"owner": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "reply_to_user": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "edited": false, "score": 0, "creation_date": 1554312907, "post_id": 55499769, "comment_id": 97708656, "body": "So each file is an invoice with an invoice number in range A1, so it can be checked that way, but I haven&#39;t been able to get it to work...So if the invoice# in Range A1 is found on the existing workbook (each tab on the master file is named after the invoice#) then it should not import that file and move on to the next one."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 10549143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-F47DqudLy80/AAAAAAAAAAI/AAAAAAAAAMU/YrtO88AVsp8/photo.jpg?sz=128", "display_name": "Blob X", "link": "https://stackoverflow.com/users/10549143/blob-x"}, "is_accepted": false, "score": 0, "last_activity_date": 1554320864, "last_edit_date": 1554320864, "creation_date": 1554315938, "answer_id": 55501880, "question_id": 55499769, "link": "https://stackoverflow.com/questions/55499769/merge-workbooks-w-validation-of-duplicates/55501880#55501880", "title": "Merge Workbooks w/ validation of duplicates", "body": "<p>If I understand correctly, you're looking to merge the worksheets from X number of other workbooks (wbkSrcBook) into your main workbook (wbkCurBook) but disregard any duplicate worksheets? </p>\n\n<p>My first question would be then to figure out what's unique about each sheet and or otherwise generate some unique/pseudo-hash/concatenated value one could use to differentiate them - easiest being worksheet name if unique obviously, but if not then a column with an account number or even a concatenation of various strings within each sheet.  </p>\n\n<p>Once you figure that out, then I'd imagine it would be reasonably straightforward - Creating a list/array to keep track of your unique IDs/sheet names, and then checking each new source workbook sheet name/ID against the array - Adding to main workbook if False, doing nothing if True.</p>\n\n<p><strong>Function to check whether something exists in an array (to be used with SheetList array)</strong></p>\n\n<pre><code>Private Function CheckArray(value, arr) As Boolean\n\nDim x As Variant\n\nOn Error GoTo CAExit:\n\nFor Each x In arr:\n    If x = value Then\n        CheckArray = True\n        On Error GoTo 0\n        Exit Function\n    End If\nNext\n\nCAExit:\nOn Error GoTo 0\nCheckArray = False\n\nEnd Function\n</code></pre>\n\n<p><strong>Add the initial main book worksheet names(wbkCurBook) to the Array</strong></p>\n\n<pre><code>Dim SheetList As Variant\n\nFor Each wksCurSheet In wbkCurBook.Sheets\n    If IsEmpty(SheetList) Then\n        SheetList = Array(wksCurSheet.Name)\n    Else\n        ReDim Preserve SheetList(UBound(SheetList) + 1)\n        SheetList(UBound(SheetList)) = wksCurSheet.Name\n    End If\nNext\n</code></pre>\n\n<p><strong>After opening the source books to copy data from (wbkSrcBook), compare those sheet names/values to the array. \nIf new value is found in array, discard - If not, copy sheet to main book (wbkCurBook) and then add new value to array</strong></p>\n\n<pre><code>For Each wksCurSheet In wbkSrcBook.Sheets\n    If CheckArray(\"LookUp\", SheetList) = False Then\n        countSheets = countSheets + 1\n        wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n        If IsEmpty(SheetList) Then\n            SheetList = Array(wksCurSheet.Name)\n        Else\n            ReDim Preserve SheetList(UBound(SheetList) + 1)\n            SheetList(UBound(SheetList)) = wksCurSheet.Name\n        End If\n    End If \nNext\n</code></pre>\n\n<p>I tested out most of this code in segments but haven't tried it out all together - so it may require some tweaking before you throw it back into the module! I used sheet names as an easy differentiator but if you have to use a different one the logic shouldn't change much. </p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "edited": false, "score": 0, "creation_date": 1554406745, "post_id": 55502495, "comment_id": 97751656, "body": "Hi Charles I haven&#39;t had a chance to test the code but you&#39;re on the right track with the idea I&#39;m working with. Each invoice is its own spreadsheet and I&#39;m making a master file with all invoices, to make sourcing data from them easier. Thanks and I will provide my check once I implement the code."}, {"owner": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "edited": false, "score": 0, "creation_date": 1554492507, "post_id": 55502495, "comment_id": 97787596, "body": "Can you provide more guidance on the CreateObject(&quot;Scripting.Dictionary&quot;) how does this capture all the names of the tabs in the workbook? My issue is, it&#39;s still importing the worksheets as duplicates. I don&#39;t think this is capturing what&#39;s already on the master file ahead of time...therefore it&#39;s continuing to add duplicates."}, {"owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "reply_to_user": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "edited": false, "score": 0, "creation_date": 1554681122, "post_id": 55502495, "comment_id": 97828951, "body": "@iLL-Army, As I mentioned, this code only looks through the A1 cell of the first sheet to determinate if the complet set of sheets contained in this workbook should be imported or not. This follows the same behavior as your original code. Now, it is your role to modify the code to accommodate your particular problem."}], "tags": [], "owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "is_accepted": false, "score": 0, "last_activity_date": 1554318050, "creation_date": 1554318050, "answer_id": 55502495, "question_id": 55499769, "link": "https://stackoverflow.com/questions/55499769/merge-workbooks-w-validation-of-duplicates/55502495#55502495", "title": "Merge Workbooks w/ validation of duplicates", "body": "<p>Based on what you want your comparaison to be, I would suggest you use this code.</p>\n\n<p>It uses a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dictionary-object\" rel=\"nofollow noreferrer\">Dictionary</a> to create a list of invoice # that are already in the merged file. The advantage of using a dictionary is that you can directly check if an entry exists for your value, without bothering about the type of its contents.</p>\n\n<p>I haven't tested it, but don't expect much problems. Yet, I still question why you need to loop through the sheets of your invoice file. I supposed you have a single invoice per file, and the number of the invoice is always on the first sheet in range A1. As usual, don't hesitate to adapt the code to your needs.</p>\n\n<pre><code>Option Explicit\n\nSub MergeExcelFiles()\n\n    Dim fnameList As Variant\n    Dim fnameCurFile As Variant\n    Dim countFiles As Long\n    Dim countSheets As Long\n    Dim wksCurSheet As Worksheet\n    Dim wbkCurBook As Workbook\n    Dim wbkSrcBook As Workbook\n\n    Dim Invoices As Object\n    Set Invoices = CreateObject(\"Scripting.Dictionary\")\n\n\n    Dim Invoice As String\n\n    fnameList = Application.GetOpenFilename(FileFilter:=\"Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm\", Title:=\"Choose Excel files to merge\", MultiSelect:=True)\n\n    If (vbBoolean &lt;&gt; VarType(fnameList)) Then\n\n        If (UBound(fnameList) &gt; 0) Then\n            countFiles = 0\n            countSheets = 0\n\n            Application.ScreenUpdating = False\n            Application.Calculation = xlCalculationManual\n\n            Set wbkCurBook = ActiveWorkbook\n\n\n            For Each fnameCurFile In fnameList\n                countFiles = countFiles + 1\n\n                'Open the file in Readonly and get the Invoice # store in Cell A1\n                Set wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile, ReadOnly:=True)\n                Invoice = wbkSrcBook.Worksheets(1).Range(\"A1\").Value\n\n\n                If Invoices.Exists(Invoice) Then\n                    'This Invoice is already in the Workbook\n                    'We can skip it\n\n                Else\n                    'This invoice is not in the Merged Workbook\n                    Dim i As Long\n                    For i = 1 To wbkSrcBook.Sheets.Count\n                        countSheets = countSheets + 1\n                        wbkSrcBook.Sheets(i).Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n                    Next\n                    Invoices.Add Invoice, vbNullString\n\n                End If\n\n                'We can close the workbook\n                wbkSrcBook.Close SaveChanges:=False\n\n\n\n            Next\n\n            Application.ScreenUpdating = True\n            Application.Calculation = xlCalculationAutomatic\n\n            MsgBox \"Processed \" &amp; countFiles &amp; \" files\" &amp; vbCrLf &amp; \"Merged \" &amp; countSheets &amp; \" worksheets\", Title:=\"Merge Excel files\"\n        End If\n\n    Else\n        MsgBox \"No files selected\", Title:=\"Merge Excel files\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1554320864, "creation_date": 1554308126, "question_id": 55499769, "link": "https://stackoverflow.com/questions/55499769/merge-workbooks-w-validation-of-duplicates", "title": "Merge Workbooks w/ validation of duplicates", "body": "<p>I am trying to add the functionality to identify duplicate workbooks so they do not get imported. I am having trouble writing the If stmt that will capture if the tab/sheet has already been imported into the master file.</p>\n\n<pre><code>    Sub MergeExcelFiles()\n\n    Dim fnameList, fnameCurFile As Variant\n    Dim countFiles, countSheets As Integer\n    Dim wksCurSheet As Worksheet\n    Dim wbkCurBook, wbkSrcBook As Workbook\n    Dim WS As Worksheet\n    Dim Z As Integer\n    fnameList = Application.GetOpenFilename(FileFilter:=\"Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm\", Title:=\"Choose Excel files to merge\", MultiSelect:=True)\n\nIf (vbBoolean &lt;&gt; VarType(fnameList)) Then\n\n    If (UBound(fnameList) &gt; 0) Then\n        countFiles = 0\n        countSheets = 0\n\n        Application.ScreenUpdating = False\n        Application.Calculation = xlCalculationManual\n\n        Set wbkCurBook = ActiveWorkbook\n\n        For Each fnameCurFile In fnameList\n            countFiles = countFiles + 1\n\n            Set wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)\n\n            'If stmt'***\n\n            For Each wksCurSheet In wbkSrcBook.Sheets\n                countSheets = countSheets + 1\n                wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n\n            Next\n\n            wbkSrcBook.Close SaveChanges:=False\n\n        Next\n\n        Application.ScreenUpdating = True\n        Application.Calculation = xlCalculationAutomatic\n\n        MsgBox \"Processed \" &amp; countFiles &amp; \" files\" &amp; vbCrLf &amp; \"Merged \" &amp; countSheets &amp; \" worksheets\", Title:=\"Merge Excel files\"\n    End If\n\nElse\n    MsgBox \"No files selected\", Title:=\"Merge Excel files\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "printing"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11293149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f83df899f73b35dea08b51091c7ed04?s=128&d=identicon&r=PG&f=1", "display_name": "Ema189", "link": "https://stackoverflow.com/users/11293149/ema189"}, "edited": false, "score": 0, "creation_date": 1554744988, "post_id": 55499862, "comment_id": 97856253, "body": "Thank you for your reply, but that is not the ideal solution to my problem. Each of the sheet I&#39;m trying to print contain charts and all charts need to be printed on separate sheets. The code I have now, prints them separately whereas I want them to print them all together, one file."}], "tags": [], "owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "is_accepted": false, "score": 0, "last_activity_date": 1554308399, "creation_date": 1554308399, "answer_id": 55499862, "question_id": 55499687, "link": "https://stackoverflow.com/questions/55499687/print-multiple-sheet-from-user-input-using-excel-vba/55499862#55499862", "title": "Print Multiple Sheet from User Input Using Excel VBA", "body": "<p>You can copy all the sheets in another sheet just for print , For exemple \nif he select sheet1 and sheet2</p>\n\n<p>You can use a sheet called PRINTSHEET</p>\n\n<p>and them Copy  the Sheet1.usedrange and Sheet2.usedrange to PrintSheet</p>\n\n<p>after that u can just print the PrintSheet</p>\n"}], "owner": {"reputation": 1, "user_id": 11293149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f83df899f73b35dea08b51091c7ed04?s=128&d=identicon&r=PG&f=1", "display_name": "Ema189", "link": "https://stackoverflow.com/users/11293149/ema189"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554358602, "creation_date": 1554307797, "last_edit_date": 1554358602, "question_id": 55499687, "link": "https://stackoverflow.com/questions/55499687/print-multiple-sheet-from-user-input-using-excel-vba", "title": "Print Multiple Sheet from User Input Using Excel VBA", "body": "<p>I have a code which will take user input from a list box, which is the name of all the tabs I have in the workbook, selected name will be moved to another listbox, say Listbox2. This list box 2 items are being converted to an array to go to the print preview page. but the problem is, I'm doing it in a loop, so I can't print them in one go. If I select 5 tabs, I'm having to print 5 tabs separately. I want to print them together. I've tried putting the print preview command out of the loop, but then I get an error saying application not found or something similar. Here's the code below:</p>\n\n<pre><code>Private Sub Printout1_Click()\nDim Size As Integer\n\n    Size = Me.ListBox2.ListCount - 1\nReDim ListBoxContents(0 To Size) As String\n\n    Dim i As Integer\n\n  For i = 0 To Size\n      ListBoxContents(i) = Me.ListBox2.List(i)\n\nNext i\n\nFor i = 0 To Size\nSheets(ListBoxContents(i)).Visible = True\nSheets(ListBoxContents(i)).Select\n    ActiveWindow.SelectedSheets.PrintPreview\n    Sheets(ListBoxContents(i)).Visible = False\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1554379826, "post_id": 55499495, "comment_id": 97735931, "body": "Delete the leading . In &#39;.\\source.xlsx&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "is_accepted": true, "score": 0, "last_activity_date": 1554307930, "creation_date": 1554307930, "answer_id": 55499724, "question_id": 55499495, "link": "https://stackoverflow.com/questions/55499495/open-excel-workbook-from-word-in-same-folder-and-copy-paste-some-cells/55499724#55499724", "title": "Open Excel workbook from Word in same folder and copy paste some cells", "body": "<p>You need to instance the excel , them open it , and them copy the range you want , after that u can paste on your selection</p>\n\n<p>The code below will help you to understand how to do it , but you will need to change some values from Range and Locations to place the Paste.</p>\n\n<pre><code>Sub Code()\n    Dim exc As Object\n    Dim wb As Object\n\n    Set exc = CreateObject(\"excel.application\")\n    Set wb = exc.workbooks.Open(ActiveDocument.Path &amp; \".\\source.xlsx\")\n    With wb\n        .sheets(1).Range(\"A1:B3\").Copy\n    End With\n\n    Application.Selection.Paste\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 55499724, "answer_count": 1, "score": 0, "last_activity_date": 1582888096, "creation_date": 1554307234, "last_edit_date": 1582888096, "question_id": 55499495, "link": "https://stackoverflow.com/questions/55499495/open-excel-workbook-from-word-in-same-folder-and-copy-paste-some-cells", "title": "Open Excel workbook from Word in same folder and copy paste some cells", "body": "<p>I want to open an Excel Workbook from a macro in Word. The Excel Workbook and the Word Document are placed in the same folder.</p>\n\n<p>After opening the workbook it should copy a range and special paste it at the cursor in the word document and do some editing on the table.</p>\n\n<p>The latter part I think I can do, but the first part says \"Run-time error '424': Object recquired</p>\n\n<p>I am not expert and cannot get this to work.</p>\n\n<p>Thanks in advance!</p>\n\n<p>I have searched and found the below code, which people have been upvoting, but for some reason it does not work for me.</p>\n\n<pre><code>    Sub Code()\n\n    Workbooks.Open (ActiveDocument.Path &amp; \".\\source.xlsx\")\n\n    'Copy some cells and paste them into Selected place in word\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11306732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vsV9DrJ-b3w/AAAAAAAAAAI/AAAAAAAAABo/zKo4Kpv5-Aw/photo.jpg?sz=128", "display_name": "Full Throttle", "link": "https://stackoverflow.com/users/11306732/full-throttle"}, "edited": false, "score": 0, "creation_date": 1554308879, "post_id": 55499803, "comment_id": 97706699, "body": "thanks it works, but following this default exit message popup window also comes and after doing the same thing it closes the file, that because of Cancel = true in Before save function"}], "tags": [], "owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "is_accepted": true, "score": 0, "last_activity_date": 1554308213, "creation_date": 1554308213, "answer_id": 55499803, "question_id": 55499456, "link": "https://stackoverflow.com/questions/55499456/vba-before-close-event/55499803#55499803", "title": "VBA Before close event", "body": "<p>I think i misunderstood what u tried to describe , but take a look if my code below can help you.</p>\n\n<pre><code>Public Sub Workbook_BeforeClose(Cancel As Boolean)\n\n        Select Case MsgBox(\"Select what do you want\", vbYesNoCancel + vbExclamation, \"Atention\")\n            Case vbYes\n                Call Workbook_BeforeSave(True, False)\n            Case vbNo\n                Application.Quit\n            Case vbCancel\n                Cancel = True\n        End Select\n\n Exit Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11306732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vsV9DrJ-b3w/AAAAAAAAAAI/AAAAAAAAABo/zKo4Kpv5-Aw/photo.jpg?sz=128", "display_name": "Full Throttle", "link": "https://stackoverflow.com/users/11306732/full-throttle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 55499803, "answer_count": 1, "score": 0, "last_activity_date": 1554384421, "creation_date": 1554307113, "last_edit_date": 1554384421, "question_id": 55499456, "link": "https://stackoverflow.com/questions/55499456/vba-before-close-event", "title": "VBA Before close event", "body": "<p>there is 2 events in my code i.e Before close,before save. in before save condition there are conditions to be filled before saving, else it wont allow to save. now while triggering before close, it will popup for save, dontsave, cancel message box. when selecting save, it will call before save function and it throws error message as like before save function. but after that file is closed.</p>\n\n<pre><code>    Public Sub Workbook_BeforeClose(Cancel As Boolean)\n\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 4, "creation_date": 1554306971, "post_id": 55499372, "comment_id": 97705689, "body": "What code have you tried so far?  Stack Overflow isn&#39;t a code writing service."}, {"owner": {"reputation": 1, "user_id": 11306722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_HULmDg1ZiA/AAAAAAAAAAI/AAAAAAAAABs/90srkwzx5cE/photo.jpg?sz=128", "display_name": "Sachin Murugan", "link": "https://stackoverflow.com/users/11306722/sachin-murugan"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1554307685, "post_id": 55499372, "comment_id": 97706047, "body": "unfortunately haven&#39;t had any code written as yet. I&#39;m new to VBA, so still trying to wrap my head around what VBA functions I could use to perform this operation?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1554307978, "post_id": 55499372, "comment_id": 97706214, "body": "You will need a For loop and  Application.Match() to find if it exist already and then simply find the last row in A and append those that return an error in the match."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11306722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_HULmDg1ZiA/AAAAAAAAAAI/AAAAAAAAABs/90srkwzx5cE/photo.jpg?sz=128", "display_name": "Sachin Murugan", "link": "https://stackoverflow.com/users/11306722/sachin-murugan"}, "edited": false, "score": 0, "creation_date": 1554365416, "post_id": 55510770, "comment_id": 97726884, "body": "Thanks so much! that was really well explained. I will try this today and let you know how it goes :)"}], "tags": [], "owner": {"reputation": 55, "user_id": 11303234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVPQi.jpg?s=128&g=1", "display_name": "Courtland9777", "link": "https://stackoverflow.com/users/11303234/courtland9777"}, "is_accepted": false, "score": 0, "last_activity_date": 1554364951, "creation_date": 1554364951, "answer_id": 55510770, "question_id": 55499372, "link": "https://stackoverflow.com/questions/55499372/how-do-i-append-items-from-list-b-to-list-a-that-are-in-list-b-but-not-in-list/55510770#55510770", "title": "How Do I append items from list B to list A, that are in list B but not in list A?", "body": "<p>I am a big fan of Dictionaries for situations like this. Taking advantage of their unique keys and the Exists method make life a lot easier than constantly looping for each item you would like to check. Just make sure you add the reference to your project so you can access the Scripting.Dictionary from Windows. </p>\n\n<p>The code below is like a framework that will get you heading in the right direction. I did make some assumptions that I tried to point out in the code like list A is column A and I didn't account for headers.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CreateDictToCompare()\n\n    Dim LastRow As Long\n    Dim i As Long\n    Dim Dict As Scripting.Dictionary\n\n    'Get's the last row of column A\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    End With\n\n    Set Dict = New Scripting.Dictionary\n\n    For i = 1 To LastRow\n        'Assuming List A is unique values and in Column A\n        Dict.Add Key:=ActiveSheet.Range(i, 1).value, Item:=vbNullString\n    Next i\n\n    'Gets the last row of column B\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, 2).End(xlUp).Row\n    End With\n\n    For i = 1 To LastRow\n            'Assuming the Values you want to compare are in column B\n        If Not Dict.Exists(ActiveSheet.Range(i, 2).value) Then\n            'You will only get here if the Value is not in list A.\n            'You can use this space to append this value to list B\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Hopefully this gets you moving in the right direction and best of luck!</p>\n"}], "owner": {"reputation": 1, "user_id": 11306722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_HULmDg1ZiA/AAAAAAAAAAI/AAAAAAAAABs/90srkwzx5cE/photo.jpg?sz=128", "display_name": "Sachin Murugan", "link": "https://stackoverflow.com/users/11306722/sachin-murugan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554473952, "creation_date": 1554306831, "last_edit_date": 1554473952, "question_id": 55499372, "link": "https://stackoverflow.com/questions/55499372/how-do-i-append-items-from-list-b-to-list-a-that-are-in-list-b-but-not-in-list", "title": "How Do I append items from list B to list A, that are in list B but not in list A?", "body": "<p>I have the following problem:\nI have two lists, A &amp; B. list B updates regularly and may include new values. List A stays static. How do I go about appending new items in list B, that are not currently in list A, to list A? </p>\n\n<p>I could probably do a vlookup and return missing values but then I don't know how to append those missing items to list A. </p>\n\n<p>Struggling to understand if theres a simple VBA code to perform this operation?</p>\n\n<p>*****UPDATE:******</p>\n\n<p>So using the Answer below, I attempted to script a macro, but I am getting a runtime error saying object not defined when I attempt to Add items to the Dictionary?: </p>\n\n<pre><code>Option Explicit\nSub AppendProfitCentres()\n\nDim LastRowRecon As Long\nDim LastRowSAP As Long\nDim Dict As Object\nDim MissingPC As Long\nDim i As Integer\n\n\nWorksheets(\"Recon\").Range(\"K6\").Select\nWorksheets(\"Recon\").Range(\"K6\", Selection.End(xlDown)).Select\nLastRowRecon = Cells(Rows.Count, 11).End(xlUp).Row\nCells(LastRowRecon, 11).Select\n'\n''create dictionary to hold profit centres\n'\n'\nSet Dict = CreateObject(\"Scripting.Dictionary\")\nWorksheets(\"Recon\").Range(\"K6\").Select\nFor i = 6 To LastRowRecon\n'\n    Dict.Add Key:=Worksheets(\"Recon\").Range(i, 11).Value, Item:=vbNullString\n\nNext i\n\n'check SAP and TCM profit centres against Dictionary PC\nWorksheets(\"SAP Data\").Range(\"A7\").Select\nWorksheets(\"SAP Data\").Range(\"A7\", Selection.End(xlDown)).Select\nLastRowSAP = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 7 To LastRowSAP\n\n    If Not PC.Exists(Worksheets(\"SAP Data\").Range(i, 1).Value) Then\n     'if item doesnt exist, append to profit centres in recon tab\n        MissingPC = Empty\n        MissingPC = Worksheets(\"SAP Data\").Range(i, 1).Value\n        Cells(LastRowRecon, 11).Select\n        ActiveCell.Offset(1).EntireRow.Insert\n        ActiveCell.Value = MissingPC\n    End If\n\n Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "grouping"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1554306654, "post_id": 55499213, "comment_id": 97705497, "body": "Unfortunately, Stack Overflow isn&#39;t a code writing service.  You&#39;ll have to make an attempt first and show us your code so we can help debug issues rather than asking someone to write the code for you."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1554306675, "post_id": 55499213, "comment_id": 97705510, "body": "Try filtering the <code>Project</code> column and use that range to build your sheet. Also, have a read of <a href=\"https://stackoverflow.com/questions/how-to-ask\">this</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554309212, "post_id": 55499213, "comment_id": 97706863, "body": "Look into <code>Range.Group</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11300319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlxJtBAx-tA/AAAAAAAAAAI/AAAAAAAAAik/xHzw9sR8Kwo/photo.jpg?sz=128", "display_name": "Ines Lopes", "link": "https://stackoverflow.com/users/11300319/ines-lopes"}, "edited": false, "score": 0, "creation_date": 1554316523, "post_id": 55501329, "comment_id": 97710465, "body": "Thank you soooo so much!! It&#39;s exactly what I needed"}], "tags": [], "owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "is_accepted": true, "score": 0, "last_activity_date": 1554313866, "creation_date": 1554313866, "answer_id": 55501329, "question_id": 55499213, "link": "https://stackoverflow.com/questions/55499213/how-to-group-same-topics-under-the-first-one-using-vba/55501329#55501329", "title": "How to group same topics under the first one using vba", "body": "<p>Give it a try to this... </p>\n\n<pre><code>Option Explicit\nPublic Sub Group()\n\nDim rng As Range\nDim LastRow As Long\nDim RowsInRange As Long\nDim i As Long\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nFor i = 4 To LastRow\n\nDo While ThisWorkbook.Sheets(\"Sheet1\").Cells(i, 1) = ThisWorkbook.Sheets(\"Sheet1\").Cells(i + 1, 1)\nRowsInRange = RowsInRange + 1\ni = i + 1\nLoop\n\nThisWorkbook.Sheets(\"Sheet1\").Cells(i - RowsInRange, 1).Font.Bold = True\nSet rng = Range(Cells(i - RowsInRange + 1, 1), Cells(i, 1))\nrng.Select\nSelection.Rows.Group\n\nRowsInRange = 0\n\nNext\n\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11300319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlxJtBAx-tA/AAAAAAAAAAI/AAAAAAAAAik/xHzw9sR8Kwo/photo.jpg?sz=128", "display_name": "Ines Lopes", "link": "https://stackoverflow.com/users/11300319/ines-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 2, "accepted_answer_id": 55501329, "answer_count": 1, "score": -1, "last_activity_date": 1554313866, "creation_date": 1554306340, "last_edit_date": 1554307132, "question_id": 55499213, "link": "https://stackoverflow.com/questions/55499213/how-to-group-same-topics-under-the-first-one-using-vba", "title": "How to group same topics under the first one using vba", "body": "<p>I'm making a sheet that's supposed to automatically update using information on another tab.</p>\n\n<p>The last step that I've still got to figure out how to do is automatically grouping cells with same value under the first time that value appears using vba.</p>\n\n<p>Here's an image of what I'd like to achieve using vba:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YOWmi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YOWmi.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1554306411, "post_id": 55499196, "comment_id": 97705345, "body": "It&#39;s <code>nm.Name</code> not <code>nm.Names</code> but you should use <code>nm.Referstorange</code> instead, after making sure it actually refers to a range."}, {"owner": {"reputation": 23, "user_id": 8156425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab0a1afc0408f59850df92d0f4613b1?s=128&d=identicon&r=PG&f=1", "display_name": "Indie", "link": "https://stackoverflow.com/users/8156425/indie"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1554307341, "post_id": 55499196, "comment_id": 97705878, "body": "Thanks, typo on my end when putting the code in the post (edited).  It is nm.Name in the sub.  Can you elaborate on how to implement? <code>Set rng = nm.RefersToRange</code>?  If I try it in the loop I still get error &#39;1004&#39;"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1554308431, "post_id": 55499196, "comment_id": 97706466, "body": "As I said, you need to ensure that the name actually refers to a range. It might not."}, {"owner": {"reputation": 23, "user_id": 8156425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab0a1afc0408f59850df92d0f4613b1?s=128&d=identicon&r=PG&f=1", "display_name": "Indie", "link": "https://stackoverflow.com/users/8156425/indie"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1554314023, "post_id": 55499196, "comment_id": 97709167, "body": "Thanks Rory.  Turns out the error was being thrown by a hidden &quot;_xlfn.IFERROR&quot; range.  There was an IFERROR buried in the workbook; deleting that, unhiding and deleting the named range fixed it.  Updated to <code>Set rng = ThisWorkbook.Names(nm.Name).RefersToRange</code> and everything works as expected.  Thanks!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1554322033, "post_id": 55499196, "comment_id": 97713170, "body": "That&#39;s a very roundabout way to get to <code>Set rng = nm.RefersToRange</code> :)"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 8156425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab0a1afc0408f59850df92d0f4613b1?s=128&d=identicon&r=PG&f=1", "display_name": "Indie", "link": "https://stackoverflow.com/users/8156425/indie"}, "is_accepted": false, "score": 0, "last_activity_date": 1554314583, "creation_date": 1554314583, "answer_id": 55501522, "question_id": 55499196, "link": "https://stackoverflow.com/questions/55499196/how-to-loop-through-names-collection-and-return-size-of-objects/55501522#55501522", "title": "How to loop through Names collection and return size of objects?", "body": "<pre><code>Sub colCounts()\n\n    Dim wb As Workbook\n    Dim nm As Name\n    Dim rng As range\n\n    Set wb = ActiveWorkbook\n\n   For Each nm In wb.Names\n\n       Set rng = ThisWorkbook.Names(nm.Name).RefersToRange\n       Debug.Print nm.Name &amp; \" \" &amp; rng.Columns.Count\n\n    Next nm\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8156425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab0a1afc0408f59850df92d0f4613b1?s=128&d=identicon&r=PG&f=1", "display_name": "Indie", "link": "https://stackoverflow.com/users/8156425/indie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554314583, "creation_date": 1554306285, "last_edit_date": 1554306687, "question_id": 55499196, "link": "https://stackoverflow.com/questions/55499196/how-to-loop-through-names-collection-and-return-size-of-objects", "title": "How to loop through Names collection and return size of objects?", "body": "<p>I'm trying to loop through the Names collection, and each Name that fits a certain size (column) requirement gets resized (called in a different sub).</p>\n\n<p>When I try to pass the names returned to a Range I get below error.</p>\n\n<blockquote>\n  <p>\"Run-time error '1004': Method 'Range' of object'_Global' failed.</p>\n</blockquote>\n\n<pre><code>Sub colCounts()\n    Dim wb as Workbook\n    Dim nm as Name\n    Dim rng as Range\n    Set wb = ActiveWorkbook\n\n    For Each nm in wb.Names\n        debug.print nm.Name ' verify loop returning as expected\n        Set rng = Range(nm.Name) 'this line throws the error when added\n        debug.print nm.Name &amp; \" \" &amp; rng.Columns.Count\n    Next nm\nEnd Sub\n</code></pre>\n\n<p>I also tried passing the Name to a string first:</p>\n\n<pre><code>Dim str as String\n.....\nstr = nm.Name\nSet rng = Range(str)\n</code></pre>\n"}, {"tags": ["sql", ".net", "vba", "vb.net", "basic"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554308420, "post_id": 55499150, "comment_id": 97706458, "body": "<code>SqlConnection</code> and <code>SqlCommand</code> implement <code>IDisposable</code> and should be wrapped in <code>Using</code> blocks; <code>conn.Close</code> doesn&#39;t need to be spelled out, disposing the connection (exiting the <code>Using</code> scope) takes care of that."}, {"owner": {"reputation": 1670, "user_id": 2116350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3312d97415dd6087903f8a43e3c2f9b0?s=128&d=identicon&r=PG", "display_name": "Charles May", "link": "https://stackoverflow.com/users/2116350/charles-may"}, "edited": false, "score": 0, "creation_date": 1554319600, "post_id": 55499150, "comment_id": 97711922, "body": "You can also create a WHERE clause in your SQL statement to only pull the row(s) with the sJob value. This will greatly reduce your code and may even not require the do while loop depending on whether there are multiple rows in your table with the same sJob value."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 5646739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-u01N7A9ozBc/AAAAAAAAAAI/AAAAAAAAAZ4/-rbRKjDJVls/photo.jpg?sz=128", "display_name": "sergidb", "link": "https://stackoverflow.com/users/5646739/sergidb"}, "is_accepted": false, "score": 0, "last_activity_date": 1554307488, "creation_date": 1554307488, "answer_id": 55499580, "question_id": 55499150, "link": "https://stackoverflow.com/questions/55499150/converting-vba-function-to-vb-net-to-get-sql-data/55499580#55499580", "title": "Converting VBA function to VB.net to get sql data", "body": "<p>It seems that you're not filling your DataSet. So, when you try to loop through it, it's uninitialized or empty.</p>\n\n<p>Check this answer to see an example: <a href=\"https://stackoverflow.com/a/6584858/5646739\">Get Dataset from DataBase</a></p>\n"}, {"tags": [], "owner": {"reputation": 1670, "user_id": 2116350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3312d97415dd6087903f8a43e3c2f9b0?s=128&d=identicon&r=PG", "display_name": "Charles May", "link": "https://stackoverflow.com/users/2116350/charles-may"}, "is_accepted": true, "score": 1, "last_activity_date": 1554395386, "last_edit_date": 1554395386, "creation_date": 1554322006, "answer_id": 55503473, "question_id": 55499150, "link": "https://stackoverflow.com/questions/55499150/converting-vba-function-to-vb-net-to-get-sql-data/55503473#55503473", "title": "Converting VBA function to VB.net to get sql data", "body": "<p>Based on my understanding and some guesswork, here is what I came up with for what I think you're wanting. </p>\n\n<p>As I stated in my comment above, it appears you can just use a WHERE clause to get the exact record you want (assuming a single instance of sJob appears in the name column). </p>\n\n<p>Build the connectionstring off the input arguments, not controls on your form. That is after all why you allow for arguments to be passed along. Also note that there is a SqlCommandBuilder object that may be of interest. But for now</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function GetG(sDB As String, sServ As String, sJob As String) As String\n    'we'll pretend your connectionstring is correct based off of the sDB and sServ arguments\n    Dim conStr As String = (\"driver={SQL Server};server = \" &amp; sServ &amp; \" ; uid = username;pwd=password:database = \" &amp; sDB)\n    'Create a connection and pass it your conStr\n    Using con As New SqlConnection(conStr)\n        con.Open() 'open the connection\n        'create your sql statement and add the WHERE clause with a parameter for the input argument 'sJob'\n        Dim sql As String = \"SELECT [ID], [Name] FROM dbo.PropertyTypes WHERE [Name] = @job\"\n        'create the sqlCommand (cmd) and pass it your sql statement and connection\n        Using cmd As New SqlCommand(sql, con)\n            'add a parameter so the command knows what @job holds\n            cmd.Parameters.Add(New SqlParameter(\"@job\", SqlDbType.VarChar)).Value = sJob\n            'Now that have the command built, we can pass it to a reader object \n            Using rdr As SqlDataReader = cmd.ExecuteReader\n                rdr.Read()\n                'i admin i'm a little confused here on what you are\n                'trying to achieve so ID may not be what you are\n                'really wanting to get a substring of.\n                Return rdr(\"ID\").ToString.Substring(2, 36)\n            End Using\n        End Using\n    End Using\nEnd Function\n</code></pre>\n\n<p>An example to see if this is working could be to call a messagebox do display the result. For this example, I'm going to pretend that TextBox3 holds the sJob you're wanting. With that knowledge, you could simply do:</p>\n\n<pre><code>MessageBox.Show(GetG(TextBox2.Text, TextBox1.Text, TextBox3.Text))\n</code></pre>\n\n<p>This should then produce the result in a messagebox.</p>\n"}], "owner": {"reputation": 3, "user_id": 11306591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eb62a1ced1946d7f092d443007a44f6?s=128&d=identicon&r=PG&f=1", "display_name": "OmegaChase", "link": "https://stackoverflow.com/users/11306591/omegachase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 55503473, "answer_count": 2, "score": 0, "last_activity_date": 1554395386, "creation_date": 1554306143, "last_edit_date": 1554308526, "question_id": 55499150, "link": "https://stackoverflow.com/questions/55499150/converting-vba-function-to-vb-net-to-get-sql-data", "title": "Converting VBA function to VB.net to get sql data", "body": "<p>I am trying to convert VBA code into VB.net and I have made it to a point but I can't convert resultset into vb.net. RS was 'dim as resultset' in VBA, thought i could just change it to dataset but am getting errors with the '.fields' and other options?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Function GetG(sDB As String, sServ As String, sJob As String) As String\n\n        'sDB = Database name, sServ = Server\\Instance, path = job.path\n        Dim conString As String = (\"driver={SQL Server};server = \" &amp; \n         TextBox1.Text &amp; \" ; uid = username;pwd=password:database = \" &amp; \n         TextBox2.Text)\n        Dim RS As DataSet\n        Dim conn As SqlConnection = New SqlConnection(conString)\n        Dim cmd As SqlCommand\n\n\n        conn.Open()\n\n'This is where my problems are occuring\n\n        cmd = New SqlCommand(\"SELECT [ID],[Name] FROM dbo.PropertyTypes\")\n\n           Do While Not RS.Tables(0).Rows.Count = 0\n            If RS.Fields(1).Value = sJob Then\n                GetG = RS.Fields(0).Value\n                GetG = Mid(GetG, 2, 36)\n                Exit Do\n            End If\n            DataSet.MoveNext\n\n        Loop\n        conn.Close\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "edited": false, "score": 0, "creation_date": 1554309253, "post_id": 55499074, "comment_id": 97706876, "body": "Do you have some data that can put this code into perspective?"}, {"owner": {"reputation": 31, "user_id": 11205104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6d338c7491ff28a7d39e7e2b50b7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Typicalusername", "link": "https://stackoverflow.com/users/11205104/typicalusername"}, "reply_to_user": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "edited": false, "score": 0, "creation_date": 1554309724, "post_id": 55499074, "comment_id": 97707103, "body": "I have this spreadsheet i made from 130 sheets.  I normalized all the data and now i need to put the data back into 130 separate sheets.  The second column in my sheet with the header &quot;Business Unit&quot; has the names of the units and that is what i need the sheets to be. there are 130 Business Units so i needs their data put into sheets with their name.  Example the entire row for all cells that contain ACH in the second column need to be placed into a new sheet called ACH.  Right now it is making sheets with the names unique in column 1 and it is only giving me the header and random data"}], "owner": {"reputation": 31, "user_id": 11205104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6d338c7491ff28a7d39e7e2b50b7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Typicalusername", "link": "https://stackoverflow.com/users/11205104/typicalusername"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554317346, "creation_date": 1554305900, "last_edit_date": 1554317346, "question_id": 55499074, "link": "https://stackoverflow.com/questions/55499074/how-to-split-one-worksheet-into-multiple-workbooks-based-on-column", "title": "How to split one worksheet into multiple workbooks based on column", "body": "<p>I am trying to take one master document and split it into seperate excel files based on the values in my column \"Business Unit\".  The new sheets will be named after their business unit and they should contain only the data in the rows containing that particular business unit.  IE all ACH labeled rows need to be in the new ach folder.  This code is currently making the sheets based on segment \"column A\".  It is also only giving me the data in those rows that match the segment name IE instead of getting ACH ACH and ACH ACH 1 ACH ACH2 I am just getting ACH ACH.So I either set up my filtering wrong or i set up my copying wrong.  I just can't tell.</p>\n\n<pre><code>Sub ExtractToNewWorkbook()\n\n    Dim ws     As Worksheet\n    Dim wsNew  As Workbook\n    Dim rData  As Range\n    Dim rfl    As Range\n    Dim Business_Unit  As String\n    Dim sfilename As String\n\n    Set ws = ThisWorkbook.Sheets(\"All Functions Final\")\n\n    'Apply advance filter in sheet\n\n    With ws\n\n        Set rData = .Range(.Cells(1, 1), .Cells(.Rows.Count, 10).End(xlUp))\n        .Columns(.Columns.Count).Clear\n        .Range(.Cells(2, 1), .Cells(.Rows.Count, 1).End(xlUp)).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=.Cells(1, .Columns.Count), Unique:=True\n\n\n        For Each rfl In .Range(.Cells(1, .Columns.Count), .Cells(.Rows.Count, .Columns.Count).End(xlUp))\n\n            Business_Unit = rfl.Text\n\n            Set wsNew = Workbooks.Add\n\n            sfilename = Business_Unit &amp; \".xlsx\"\n\n            'Set the Location\n\n            ActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; sfilename\n            Application.DisplayAlerts = False\n            ws.Activate\n            rData.AutoFilter Field:=2, Criteria1:=Business_Unit\n            rData.Copy\n            Windows(Business_Unit).Activate\n            ActiveSheet.Paste\n            ActiveWorkbook.Close SaveChanges:=True\n\n        Next rfl\n\n        Application.DisplayAlerts = True\n\n    End With\n\n    ws.Columns(Columns.Count).ClearContents\n    rData.AutoFilter\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554306365, "post_id": 55499065, "comment_id": 97705311, "body": "see here for a different function that should work better: <a href=\"https://stackoverflow.com/questions/54582741/excel-return-range-of-values-based-on-criteria\" title=\"excel return range of values based on criteria\">stackoverflow.com/questions/54582741/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554306712, "post_id": 55499065, "comment_id": 97705539, "body": "Oh, the error probably comes when you have hidden rows.  You cannot bulk load an array with disjointed ranges."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554308315, "post_id": 55499065, "comment_id": 97706400, "body": "@ScottCraner. Thank you for your reply. I do have TEXTJOIN() availble in my function library, but I am not sure if it can be used here because my colA list is variable and may have thousands of unique values."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554308396, "post_id": 55499065, "comment_id": 97706443, "body": "@ScottCraner Since the array cannot be loaded with disjointed ranges, then I will copy the disjointed range to another sheet. Then load that continuous range into the array. Hopefully that will work."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554308428, "post_id": 55499065, "comment_id": 97706464, "body": "Did you try my answer below?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "edited": false, "score": 0, "creation_date": 1554309691, "post_id": 55499588, "comment_id": 97707078, "body": "I did, but unfortunately got a run-time 5 error &quot;invalid procedure or call argument&quot; on the line"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "edited": false, "score": 0, "creation_date": 1554309705, "post_id": 55499588, "comment_id": 97707090, "body": "TEXTJOINIFS = Left(TEXTJOINIFS, Len(TEXTJOINIFS) - Len(delim))"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554309878, "post_id": 55499588, "comment_id": 97707192, "body": "What is the value of <code>lstrow</code> when it errors?  And does that make sense to be the last row of data in column F?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "edited": false, "score": 0, "creation_date": 1554309925, "post_id": 55499588, "comment_id": 97707213, "body": "My list in colF starts in row 8 and there are some text headers above, if that makes any difference. The colI TEXTJOINS then start in I8."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554310116, "post_id": 55499588, "comment_id": 97707305, "body": "I made the TEXTJOINIFS a little more robust, see edit.  Make sure you change the start of the loop in the sub to start at the first row of data.  I used 2 because that is where my data starts, yours will probably be 8 then: <code>For i = 8 To lstrow</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "edited": false, "score": 0, "creation_date": 1554310565, "post_id": 55499588, "comment_id": 97707541, "body": "I printed the value to a cell and it is 11, and yes this makes sense because the last entry in colF is in row 11."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "edited": false, "score": 0, "creation_date": 1554310952, "post_id": 55499588, "comment_id": 97707726, "body": "Works like magic now! Is there anyway to keep the leading zero from the colC values?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554312559, "post_id": 55499588, "comment_id": 97708522, "body": "It depends, are your numbers using a custom format or are they text that includes the <code>0</code>?  If the prior then you will need to add the formatting, replace <code>TEXTJOINIFS = TEXTJOINIFS &amp; rngarr(i, 1) &amp; delim</code> with <code>TEXTJOINIFS = TEXTJOINIFS &amp; format(rngarr(i, 1),&quot;00000&quot;) &amp; delim</code> if the later then it should keep the 0 automatically."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "edited": false, "score": 0, "creation_date": 1554317335, "post_id": 55499588, "comment_id": 97710876, "body": "Thanks again, I had the numbers in the &quot;00000&quot; format so your edit worked well. I appreciate your help!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "edited": false, "score": 0, "creation_date": 1554321604, "post_id": 55499588, "comment_id": 97712959, "body": "What would need to be changed in the code to keep the leading zero on a where there is only one number in the cell after the sub runs (i.e. cell I4 in your output picute)?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554321797, "post_id": 55499588, "comment_id": 97713067, "body": "You would need to change the number format of the cells.  select column I and do the same format you have on column C."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "edited": false, "score": 0, "creation_date": 1554321839, "post_id": 55499588, "comment_id": 97713087, "body": "Thanks very much!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1554310027, "last_edit_date": 1554310027, "creation_date": 1554307517, "answer_id": 55499588, "question_id": 55499065, "link": "https://stackoverflow.com/questions/55499065/how-to-sort-and-concatenate-a-column-range-with-vba/55499588#55499588", "title": "How to sort and concatenate a column range with VBA", "body": "<p>Using the function on the link change your code to:</p>\n\n<pre><code>Sub WOSorter()\n\n    Dim seperator As String\n    seperator = \", \"\n\n    With Worksheets(\"Selector\")\n        Dim lstrow As Long\n        lstrow = .Cells(.Rows.Count, \"F\").End(xlUp).Row\n\n\n        Dim i As Long\n        For i = 2 To lstrow\n            .Range(\"I\" &amp; i).Value = TEXTJOINIFS(.Range(\"C:C\"), seperator, .Range(\"A:A\"), .Range(\"F\" &amp; i).Value)\n        Next i\n\n     End With\n\n\nEnd Sub\n</code></pre>\n\n<p>This does not rely on filter which will not allow the bulk load of arrays.</p>\n\n<p>Here is the textjoinifs function:</p>\n\n<pre><code>Function TEXTJOINIFS(rng As Range, delim As String, ParamArray arr() As Variant) As String\n    Dim rngarr As Variant\n    rngarr = Intersect(rng, rng.Parent.UsedRange).Value\n\n    Dim condArr() As Boolean\n    ReDim condArr(1 To Intersect(rng, rng.Parent.UsedRange).Rows.Count) As Boolean\n\n    TEXTJOINIFS = \"\"\n\n    Dim i As Long\n    For i = LBound(arr) To UBound(arr) Step 2\n        Dim colArr() As Variant\n        colArr = Intersect(arr(i), arr(i).Parent.UsedRange).Value\n        Dim j As Long\n        For j = LBound(colArr, 1) To UBound(colArr, 1)\n\n            If Not condArr(j) Then\n                Dim charind As Long\n                charind = Application.Max(InStr(arr(i + 1), \"&gt;\"), InStr(arr(i + 1), \"&lt;\"), InStr(arr(i + 1), \"=\"))\n                Dim opprnd As String\n                If charind = 0 Then\n                    opprnd = \"=\"\n                Else\n                    opprnd = Left(arr(i + 1), charind)\n                End If\n                Dim t As String\n                t = \"\"\"\" &amp; colArr(j, 1) &amp; \"\"\"\" &amp; opprnd &amp; \"\"\"\" &amp; Mid(arr(i + 1), charind + 1) &amp; \"\"\"\"\n                If Not Application.Evaluate(t) Then condArr(j) = True\n            End If\n        Next j\n    Next i\n\n    For i = LBound(rngarr, 1) To UBound(rngarr, 1)\n        If Not condArr(i) Then\n            TEXTJOINIFS = TEXTJOINIFS &amp; rngarr(i, 1) &amp; delim\n        End If\n    Next i\n    If TEXTJOINIFS &lt;&gt; \"\" Then\n        TEXTJOINIFS = Left(TEXTJOINIFS, Len(TEXTJOINIFS) - Len(delim))\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Here is the ouput:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1bOIr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1bOIr.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9620642"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55499588, "answer_count": 1, "score": 0, "last_activity_date": 1554310027, "creation_date": 1554305885, "question_id": 55499065, "link": "https://stackoverflow.com/questions/55499065/how-to-sort-and-concatenate-a-column-range-with-vba", "title": "How to sort and concatenate a column range with VBA", "body": "<p>I have a generated list of part numbers (A2:A100), and their quantities (B2:B100), for a particular order number (C2:C100). I am writing a sub which will filter the list of part numbers for each unique part number and then create a new list with the total quantity of each part and every order where it will be used. </p>\n\n<p>I have a sub that successfully creates a list of unique part numbers (F8:F100), then another sub auto-filters the main list (A2:A100) of part numbers for each unique part number and creates a range for the order numbers (C2:C100) for that particular part. I have tried to concatenate the range of order numbers, but my function is failing. </p>\n\n<pre><code>Sub WOSorter()\n    Dim rng As Range\n    Dim WOrng As Range\n    Dim i As Long\n    Dim Limit As Long\n    Dim seperator As String\n\n    seperator = \", \"\n\n    Limit = Worksheets(\"Selector\").Range(\"F8:F100\").Cells.SpecialCells(xlCellTypeConstants).Count - 1\n\n    For i = 0 To Limit\n    Set rng = Worksheets(\"Selector\").Cells(8 + i, 6)\n        With Worksheets(\"Selector\").Range(\"A1\")\n        .AutoFilter Field:=1, Criteria1:=rng\n            Set WOrng = Worksheets(\"Selector\").Range(\"C2:C100\").Cells.SpecialCells(xlCellTypeVisible)\n            Worksheets(\"Selector\").Cells(8 + i, 9).Value = ConcatenateRange(WOrng, seperator)\n        End With\n    Next\n\n    If Worksheets(\"Selector\").AutoFilterMode Then Worksheets(\"Selector\").AutoFilter.ShowAllData\n\nEnd Sub\n\n-----------------------------------------------------------------------------\n\nFunction ConcatenateRange(ByVal WOrng As Range, Optional ByVal seperator As String) As String\n\nDim newString As String\nDim cellArray As Variant\nDim i As Long, j As Long\n\ncellArray = WOrng.Value\n\nFor i = 1 To UBound(cellArray, 1)\n    For j = 1 To UBound(cellArray, 2)\n        If Len(cellArray(i, j)) &lt;&gt; 0 Then\n            newString = newString &amp; (seperator &amp; cellArray(i, j))\n        End If\n    Next\nNext\n\nIf Len(newString) &lt;&gt; 0 Then\n    newString = Right$(newString, (Len(newString) - Len(seperator)))\nEnd If\n\nConcatenateRange = newString\n\nEnd Function\n</code></pre>\n\n<p>I am currently getting a type mismatch error on the line:</p>\n\n<pre><code>For i = 1 To UBound(cellArray, 1)\n</code></pre>\n\n<p>If the original list is in colA, B, C with unique part numbers in colF:</p>\n\n<pre><code>colA      colB     colC               colF\n123-4     1        01111              123-4\n456-7     2        02222              456-7\n123-4     1        03333              789-0 \n789-0     1        04444\n456-7     3        05555\n</code></pre>\n\n<p>Then the result should be:</p>\n\n<pre><code>colA      colB     colC               colF         colI\n123-4     1        01111              123-4        01111, 03333\n456-7     2        02222              456-7        02222, 05555 \n123-4     1        03333              789-0        04444\n789-0     1        04444\n456-7     3        05555\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 1, "creation_date": 1554308500, "post_id": 55498936, "comment_id": 97706506, "body": "I would not go through the headache of doing this in VBA.  Add a sort order column.  =SWITCH(LEFT($B14,3), &quot;BMC&quot;,1, &quot;CSR&quot;,2, &quot;MC-&quot;,3, &quot;LC-&quot;,4,99) -- and then sort on it and column C."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 9986773, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f83PYMm2FpY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2KWqRx2jAXH8FckYpLHHwJtwD0_g/mo/photo.jpg?sz=128", "display_name": "RawrRawr7", "link": "https://stackoverflow.com/users/9986773/rawrrawr7"}, "edited": false, "score": 0, "creation_date": 1554317237, "post_id": 55501819, "comment_id": 97710817, "body": "Just tried. Except, the MC-XXXXX stuff still falls after the LC-XXXXX stuff. Is there a work around?"}, {"owner": {"reputation": 197, "user_id": 9986773, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f83PYMm2FpY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2KWqRx2jAXH8FckYpLHHwJtwD0_g/mo/photo.jpg?sz=128", "display_name": "RawrRawr7", "link": "https://stackoverflow.com/users/9986773/rawrrawr7"}, "edited": false, "score": 0, "creation_date": 1554317252, "post_id": 55501819, "comment_id": 97710831, "body": "Thanks for answering"}, {"owner": {"reputation": 197, "user_id": 9986773, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f83PYMm2FpY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2KWqRx2jAXH8FckYpLHHwJtwD0_g/mo/photo.jpg?sz=128", "display_name": "RawrRawr7", "link": "https://stackoverflow.com/users/9986773/rawrrawr7"}, "edited": false, "score": 0, "creation_date": 1554342167, "post_id": 55501819, "comment_id": 97718988, "body": "That&#39;s it! Thanks for answering. I can&#39;t vote this up since I don&#39;t have enough reputation points, but I appreciate what you&#39;ve done."}, {"owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "reply_to_user": {"reputation": 197, "user_id": 9986773, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f83PYMm2FpY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2KWqRx2jAXH8FckYpLHHwJtwD0_g/mo/photo.jpg?sz=128", "display_name": "RawrRawr7", "link": "https://stackoverflow.com/users/9986773/rawrrawr7"}, "edited": false, "score": 0, "creation_date": 1554342602, "post_id": 55501819, "comment_id": 97719082, "body": "No worries, happy to help ;) @ChristopherLee"}], "tags": [], "owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "is_accepted": true, "score": 0, "last_activity_date": 1554329884, "last_edit_date": 1554329884, "creation_date": 1554315726, "answer_id": 55501819, "question_id": 55498936, "link": "https://stackoverflow.com/questions/55498936/trying-to-sort-by-custom-order/55501819#55501819", "title": "Trying to sort by custom order", "body": "<p>Give it a try to this... I removed the array and add the sorting values directly to the Sort properties.</p>\n\n<pre><code>CustomOrder:=\"BMC-,CSR-,MC-,LC-,\" &amp; Chr(42) &amp; \"\"  \n</code></pre>\n\n<pre><code>Option Explicit\nSub telecomsorter()\n\nDim LastRow As Long\n\nWith Worksheets(\"TELECOM\")\n\nLastRow = .Cells(Rows.Count, \"B\").End(xlUp).Row\nRange(\"B13:C\" &amp; LastRow).Select\n\nActiveWorkbook.Worksheets(\"TELECOM\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"TELECOM\").Sort.SortFields.Add2 Key:=Range( _\n        \"B14:B\" &amp; LastRow &amp; \"\"), SortOn:=xlSortOnValues, Order:=xlAscending, CustomOrder:= _\n        \"BMC-,CSR-,MC-,LC-,\" &amp; Chr(42) &amp; \"\", DataOption:=xlSortNormal\n\nActiveWorkbook.Worksheets(\"TELECOM\").Sort.SortFields.Add2 Key:=Range( _\n        \"C14:C\" &amp; LastRow &amp; \"\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n\nWith ActiveWorkbook.Worksheets(\"TELECOM\").Sort\n    .SetRange Range(\"B13:C\" &amp; LastRow)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nEnd With\n\nEnd Sub\n\n</code></pre>\n\n<p><strong>EDIT:</strong> I couldn't figure it out why the LC- always comes before the MC-, so I made a small function to do the workaround... it may not be the ideal solution but it works.</p>\n\n<pre><code>\nOption Explicit\nSub telecomsorter()\n\nDim LastRow As Long\nDim First As Long\nDim Last As Long\n\nWith Worksheets(\"TELECOM\")\n\nLastRow = .Cells(Rows.Count, \"B\").End(xlUp).Row\nRange(\"B13:C\" &amp; LastRow).Select\n\nActiveWorkbook.Worksheets(\"TELECOM\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"TELECOM\").Sort.SortFields.Add Key:=Range( _\n        \"B14:B\" &amp; LastRow &amp; \"\"), SortOn:=xlSortOnValues, Order:=xlAscending, CustomOrder:= _\n        \"BMC-*,CSR-*,MC-*,LC-*,\" &amp; Chr(42) &amp; \"\", DataOption:=xlSortNormal\n\n  With ActiveSheet.Sort\n      .SetRange Range(\"B14:C\" &amp; LastRow)\n      .Header = xlNo\n      .Orientation = xlTopToBottom\n      .Apply\n  End With\n\n Call SortSpecial(\"LC-*\", xlDescending)\n Call SortSpecial(\"MC-*\", xlAscending)\n Call SortSpecial(\"LC-*\", xlAscending)\n\nEnd With\n\nEnd Sub\n\n</code></pre>\n\n<pre><code>Public Function SortSpecial(ByVal StrVal As String, ByVal SortOrder As XlSortOrder)\n\n  Dim First As Long\n  Dim Last As Long\n\n  First = Columns(\"B\").Find(StrVal, , xlValues, , xlRows, xlNext, , , False).Row\n  Last = Columns(\"B\").Find(StrVal, , xlValues, , xlRows, xlPrevious, , , False).Row\n\n  ActiveSheet.Sort.SortFields.Clear\n  ActiveSheet.Sort.SortFields.Add Key:=Range(\"B\" &amp; First &amp; \":B\" &amp; Last), SortOn:=xlSortOnValues, Order:=SortOrder, DataOption:=xlSortNormal\n\n  With ActiveSheet.Sort\n\n  If SortOrder = xlAscending Then\n    .SetRange Range(\"B\" &amp; First &amp; \":C\" &amp; Last)\n  Else\n  Last = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row\n  .SetRange Range(\"B\" &amp; First &amp; \":C\" &amp; Last)\n  End If\n\n    .Header = xlNo\n    .Orientation = xlTopToBottom\n    .Apply\n\n  End With\n\nEnd Function\n\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 9986773, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f83PYMm2FpY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2KWqRx2jAXH8FckYpLHHwJtwD0_g/mo/photo.jpg?sz=128", "display_name": "RawrRawr7", "link": "https://stackoverflow.com/users/9986773/rawrrawr7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55501819, "answer_count": 1, "score": 0, "last_activity_date": 1554329884, "creation_date": 1554305472, "last_edit_date": 1554306869, "question_id": 55498936, "link": "https://stackoverflow.com/questions/55498936/trying-to-sort-by-custom-order", "title": "Trying to sort by custom order", "body": "<p>I am trying to sort a list order to the order of BMC-, CSR-, MC- and CSR-. This list exist on column B and has data on column C.</p>\n\n<pre><code>Sub telecomsorter()\nDim vCustom_Sort As Variant, rr As Long\n\nvCustom_Sort = Array(\"BMC-\", \"CSR-\", \"MC-\", \"LC-\", Chr(42))\nApplication.AddCustomList ListArray:=vCustom_Sort\n\nWith Worksheets(\"TELECOM\")\n  LastRow = .Cells(Rows.Count, \"B\").End(xlUp).Row 'Find the last row for the given table\nRange(\"B13:C\" &amp; LastRow).Select\nActiveWorkbook.Worksheets(\"TELECOM\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"TELECOM\").Sort.SortFields.Add2 Key:=Range(\"B13:B47\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\nWith ActiveWorkbook.Worksheets(\"TELECOM\").Sort\n    .SetRange Range(\"B13:C\" &amp; LastRow)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I want the list to be in the order of:</p>\n\n<ul>\n<li>BMC-</li>\n<li>CSR-</li>\n<li>MC-</li>\n<li>LC-</li>\n</ul>\n\n<p><img src=\"https://i.stack.imgur.com/IN7XK.png\" alt=\"Table\"></p>\n\n<p>If there are multiple strings that are the same, then I want to sort according to the order of column C.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 1, "creation_date": 1554306563, "post_id": 55498823, "comment_id": 97705446, "body": "How about adding <code>Else msgbox(&quot;job code exists but not under this ec member&quot;)</code> after <code>rw = rw + 1 </code>?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1554306888, "post_id": 55498823, "comment_id": 97705642, "body": "@shahkalpesh I tried that before, but displays the msgbox every loop through. Say I have 5 rows, and the job code I type in the first input satisfies the if statement, but the second input value doesn&#39;t exist, it will populate the msg box for every one of the five loops before exiting and displaying no data. I want it to loop through all times before displaying the message (&quot;job code exists but not under this ec member&quot;)"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1554307054, "post_id": 55498823, "comment_id": 97705731, "body": "@shahkalpesh Im thinking it needs to go after the <code>loop while rFound...</code> and before the <code>Else job code not eligible...</code> statement below"}, {"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1554307358, "post_id": 55498823, "comment_id": 97705884, "body": "I have added an answer and you may have to build up on it. I am using a variable that counts if it find 1 lob. If it does not find a single lob, it will show the dialog. If the answer helps you, you can mark it &quot;accepted&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1554307444, "post_id": 55499481, "comment_id": 97705929, "body": "Thank you so much!! Shahkalpesh&#39;s answer works too, can I grant both answers correct?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 1, "creation_date": 1554307562, "post_id": 55499481, "comment_id": 97705980, "body": "@nicklanta hi, I&#39;m Mat - Shahkalpesh&#39;s solution is very similar, but will blow up if there are more than 32,767 search results (because they&#39;re declaring the counter <code>As Integer</code> rather than <code>As Long</code>) -- you don&#39;t really need to count anything, just a <code>Boolean</code> flag is enough."}, {"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1554307755, "post_id": 55499481, "comment_id": 97706093, "body": "Agree. I dont know how many instances does the sheet have. The integer can be changed to long, if that is the case."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1554307809, "post_id": 55499481, "comment_id": 97706123, "body": "@shahkalpesh If I change the integer to long, will this satisfy any scenario that Boolean may have hiccups?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1554307852, "post_id": 55499481, "comment_id": 97706153, "body": "@nicklanta if the count is meaningful, keep it; if the only meaningful information is whether the count is 0 or not, I&#39;d go with a Boolean."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1554307974, "post_id": 55499481, "comment_id": 97706212, "body": "@MathieuGuindon Correct, It&#39;s either the value typed/cell selected exists in column 5 of the raw data, or it doesn&#39;t. Will Boolean satisfy this?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1554308028, "post_id": 55499481, "comment_id": 97706244, "body": "@MathieuGuindon I know it should because its either true/false, I wasn&#39;t sure what shahkalpesh was mentioning with instances where it&#39;s Boolean might not work?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1554308262, "post_id": 55499481, "comment_id": 97706375, "body": "@nicklanta you can make the counter a <code>Long</code> (there&#39;s no need to use the 16-bit <code>Integer</code> type in VBA anymore anyway) if you need the actual count, or use a <code>Boolean</code> flag if you don&#39;t. There&#39;s not much more to it ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1554307165, "creation_date": 1554307165, "answer_id": 55499481, "question_id": 55498823, "link": "https://stackoverflow.com/questions/55498823/how-to-implement-this-else-if-line/55499481#55499481", "title": "How to implement this else if line?", "body": "<p>You want to introduce a flag to capture a state meaning \"Found lJobCode, but no match for lJob\", then set that flag to <code>True</code> when the inner condition is met, and after you've gone through all search results, pop a <code>MsgBox</code> if the flag is still <code>False</code>.</p>\n\n<pre><code>Dim matched As Boolean\nIf Not rFound Is Nothing Then\n    sFirst = rFound.Address\n\n    Do\n        If ThisWorkbook.Worksheets(\"Sheet2\").Cells(rFound.Row, 5).Value = lLob Then\n            matched = True\n            '...\n        End If\n    Loop While ...\n\n    If Not matched Then MsgBox \"Your new message here\"\n\n Else\n    MsgBox \"Job Code [\" &amp; lJobCode &amp; \"] not eligible.\", , \"Error\"\n End If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1554307317, "creation_date": 1554307317, "answer_id": 55499523, "question_id": 55498823, "link": "https://stackoverflow.com/questions/55498823/how-to-implement-this-else-if-line/55499523#55499523", "title": "How to implement this else if line?", "body": "<pre><code>With ThisWorkbook.Worksheets(\"Sheet2\").Columns(\"A\")\n    Set rFound = .Find(lJobCode, .Cells(.Cells.Count), xlValues, xlWhole)\n\n    If Not rFound Is Nothing Then\n        sFirst = rFound.Address\n\n        dim lobFoundCount as integer\n        lobFoundCount = 0\n\n        Do\n            If ThisWorkbook.Worksheets(\"Sheet2\").Cells(rFound.Row, 5).Value = lLob Then\n                lobFoundCount = lobFoundCount + 1\n\n                sh.Cells(rw, 4) = rFound.Offset(, 0).Value\n                sh.Cells(rw, 5) = rFound.Offset(, 1).Value\n                sh.Cells(rw, 6) = rFound.Offset(, 3).Value\n                sh.Cells(rw, 7) = rFound.Offset(, 5).Value\n                sh.Cells(rw, 8) = rFound.Offset(, 6).Value\n                sh.Cells(rw, 9) = rFound.Offset(, 7).Value\n\n                rw = rw + 1\n            End If\n            Set rFound = .FindNext(rFound)\n\n        Loop While rFound.Address &lt;&gt; sFirst\n\n        If lobFoundCount = 0 Then 'No rows have matching lob\n            Msgbox(\"job code exists but not under this ec member\")\n        End If\n    Else\n        MsgBox \"Job Code [\" &amp; lJobCode &amp; \"] not eligible.\", , \"Error\"\n    End If\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55499481, "answer_count": 2, "score": 1, "last_activity_date": 1554307317, "creation_date": 1554305133, "last_edit_date": 1554305859, "question_id": 55498823, "link": "https://stackoverflow.com/questions/55498823/how-to-implement-this-else-if-line", "title": "How to implement this else if line?", "body": "<p>I can't figure out for the life of me where to put this Else or Else If statement in this IF statement block. Quick rundown: if I find the value I type in my input box within the designated rows, populate select data from that row in the sheet I designate. The other if statement after that relies on another value (to further filter the results). </p>\n\n<p>It works great, but I just want a msg box populated if the job code I put in exists, but not based on the second IF statement value. Right now it just doesn't populate data, but that may give the illusion something is broken rather than it didn't meet all criteria. </p>\n\n<p>I want to add something like <code>Else if .... msg box \"Job code exists, but not under this EC member</code> in between the second indented if statement (after the Do/while loop) here:</p>\n\n<pre><code>    If Not rFound Is Nothing Then\n        sFirst = rFound.Address\n\n        Do\n            If ThisWorkbook.Worksheets(\"Sheet2\").Cells(rFound.Row, 5).Value = lLob Then\n                sh.Cells(rw, 4) = rFound.Offset(, 0).Value\n                sh.Cells(rw, 5) = rFound.Offset(, 1).Value\n                sh.Cells(rw, 6) = rFound.Offset(, 3).Value\n                sh.Cells(rw, 7) = rFound.Offset(, 5).Value\n                sh.Cells(rw, 8) = rFound.Offset(, 6).Value\n                sh.Cells(rw, 9) = rFound.Offset(, 7).Value\n\n                rw = rw + 1\n\n            End If\n            Set rFound = .FindNext(rFound)\n\n        Loop While rFound.Address &lt;&gt; sFirst\n\n    Else\n        MsgBox \"Job Code [\" &amp; lJobCode &amp; \"] not eligible.\", , \"Error\"\n    End If\n</code></pre>\n\n<p>whole code: </p>\n\n<pre><code>Sub tgr()\n\nDim rFound As Range\nDim lJobCode As String\nDim lLob As String\nDim sFirst As String\nDim sResults As String\nDim sh As Worksheet\nDim rw As Long\n\nlJobCode = Application.InputBox(\"Please provide a job code\", \"Job Code\", Type:=2)\nlLob = Application.InputBox(\"Please select EC Member\", \"EC Member\", Type:=2)\nIf lJobCode = \"False\" Or lLob = \"False\" Then Exit Sub   'Pressed cancel\n\nSet sh = Sheets(\"Sheet1\")\nrw = 8\nWith ThisWorkbook.Worksheets(\"Sheet2\").Columns(\"A\")\n    Set rFound = .Find(lJobCode, .Cells(.Cells.Count), xlValues, xlWhole)\n\n    If Not rFound Is Nothing Then\n        sFirst = rFound.Address\n\n        Do\n            If ThisWorkbook.Worksheets(\"Sheet2\").Cells(rFound.Row, 5).Value = lLob Then\n                sh.Cells(rw, 4) = rFound.Offset(, 0).Value\n                sh.Cells(rw, 5) = rFound.Offset(, 1).Value\n                sh.Cells(rw, 6) = rFound.Offset(, 3).Value\n                sh.Cells(rw, 7) = rFound.Offset(, 5).Value\n                sh.Cells(rw, 8) = rFound.Offset(, 6).Value\n                sh.Cells(rw, 9) = rFound.Offset(, 7).Value\n\n                rw = rw + 1\n\n            End If\n            Set rFound = .FindNext(rFound)\n\n        Loop While rFound.Address &lt;&gt; sFirst\n\n    Else\n        MsgBox \"Job Code [\" &amp; lJobCode &amp; \"] not eligible.\", , \"Error\"\n    End If\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1554305285, "post_id": 55498722, "comment_id": 97704641, "body": "Please clarify, what is the pattern you are looking for?"}, {"owner": {"reputation": 825, "user_id": 3719940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bd2798bbb5bd797bd4eaafe8c1ea994c?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3719940/rahul"}, "reply_to_user": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1554305348, "post_id": 55498722, "comment_id": 97704679, "body": "@MrDogme I am comparing values in both the sheets for the first column and pulling in any values that are not available in the first column in either of the 2 sheets. The second column has values from the first sheet"}, {"owner": {"reputation": 825, "user_id": 3719940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bd2798bbb5bd797bd4eaafe8c1ea994c?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3719940/rahul"}, "reply_to_user": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1554316752, "post_id": 55498722, "comment_id": 97710564, "body": "@MrDogme Any idea how to go about this?"}], "answers": [{"tags": [], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "is_accepted": false, "score": 1, "last_activity_date": 1554373548, "creation_date": 1554373548, "answer_id": 55513601, "question_id": 55498722, "link": "https://stackoverflow.com/questions/55498722/insert-rows-not-matching-to-existing-rows/55513601#55513601", "title": "insert rows not matching to existing rows", "body": "<p>A quick and dirty version (no dims, subs, etc.) would be as follows:</p>\n\n<pre><code>aRow = 1\ncRow = 1\n\nWhile Worksheets(\"Sheet 1\").Cells(cRow, 1) &lt;&gt; vbNullString\n    bCol = 1\n    DVar = vbNullString\n\n    While bCol &lt; 3\n        DVar = Worksheets(\"Sheet 1\").Cells(cRow, bCol)\n        If WorksheetFunction.CountIf(Worksheets(\"Output\").Range(\"A:B\"), DVar) = 0 Then\n            Worksheets(\"Output\").Cells(aRow, bCol) = DVar\n        End If\n\n        bCol = bCol + 1\n        DVar = vbNullString\n    Wend\n\n    If Worksheets(\"Output\").Cells(aRow, 1) &lt;&gt; vbNullString Then\n        aRow = aRow + 1\n    End If\n\n    cRow = cRow + 1\n\nWend\n\ncRow = 1\n\nWhile Worksheets(\"Sheet 2\").Cells(cRow, 1) &lt;&gt; vbNullString\n    bCol = 1\n    DVar = vbNullString\n\n    While bCol &lt; 3\n        DVar = Worksheets(\"Sheet 2\").Cells(cRow, bCol)\n        If WorksheetFunction.CountIf(Worksheets(\"Output\").Range(\"A:B\"), DVar) = 0 Then\n            Worksheets(\"Output\").Cells(aRow, bCol) = DVar\n        End If\n\n        bCol = bCol + 1\n        DVar = vbNullString\n    Wend\n\n    If Worksheets(\"Output\").Cells(aRow, 1) &lt;&gt; vbNullString Then\n        aRow = aRow + 1\n    End If\n\n    cRow = cRow + 1\n\nWend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 825, "user_id": 3719940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bd2798bbb5bd797bd4eaafe8c1ea994c?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3719940/rahul"}, "is_accepted": true, "score": 1, "last_activity_date": 1556196925, "creation_date": 1556196925, "answer_id": 55849809, "question_id": 55498722, "link": "https://stackoverflow.com/questions/55498722/insert-rows-not-matching-to-existing-rows/55849809#55849809", "title": "insert rows not matching to existing rows", "body": "<p>This is how i did it.</p>\n\n<pre><code>Sub OneCell()\n\n\n\nSheets(\"DOCCS File\").Columns(1).Copy Destination:=Sheets(\"Sheet3\").Columns(1)\nSheets(\"IG Numbers\").Select\nDim sh4 As Worksheet, sh5 As Worksheet, lr As Long, rng As Range, sh3 As Worksheet\nSet sh4 = Sheets(\"IG Numbers\")\nSet sh5 = Sheets(\"Sheet3\")\nlr = sh4.Cells(Rows.Count, 1).End(xlUp).Row\nSet rng = sh4.Range(\"A2:A\" &amp; lr)\nrng.EntireRow.Copy sh5.Cells(Rows.Count, 1).End(xlUp)(2)\nsh5.Columns(2).EntireColumn.Delete\nsh5.Columns(1).EntireColumn.Interior.ColorIndex = 4\nDim i As Long, f As Variant\n\nWith Worksheets(\"Sheet3\")\n    For i = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        f = Application.Match(.Cells(i, \"A\").Value2, Worksheets(\"DOCCS File\").Columns(\"A\"), 0)\n        If Not IsError(f) Then\n            Else\n            Worksheets(\"DOCCS File\").Cells(i, \"A\").Copy\n            .Cells(i, \"A\").Interior.ColorIndex = 6\n        End If\n    Next i\nEnd With\n\na = Worksheets(\"Sheet3\").Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 2 To a\nIf Worksheets(\"Sheet3\").Cells(i, 1).Interior.ColorIndex = 6 Then\nWorksheets(\"Sheet3\").Rows(i).Copy\nWorksheets(\"DOCCS File\").Activate\n\nb = Worksheets(\"DOCCS File\").Cells(Rows.Count, 1).End(xlUp).Row\nWorksheets(\"DOCCS File\").Cells(b + 1, 1).Select\nActiveSheet.Paste\nEnd If\nNext\n\nApplication.CutCopyMode = False\nsh5.Columns(1).EntireColumn.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 3719940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bd2798bbb5bd797bd4eaafe8c1ea994c?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3719940/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 55849809, "answer_count": 2, "score": 2, "last_activity_date": 1556196925, "creation_date": 1554304847, "last_edit_date": 1554321285, "question_id": 55498722, "link": "https://stackoverflow.com/questions/55498722/insert-rows-not-matching-to-existing-rows", "title": "insert rows not matching to existing rows", "body": "<p>I have 2 sheets:</p>\n\n<pre><code>Sheet 1 :\n\nQWE   |  ZXC\nA     1 \nB     2\nC     3\n\nSheet 2: \n\nWER   |  EWQ\nA      1 \nG     2\nH     3\n</code></pre>\n\n<p>I want the output to look like what is given below. Is there a formula that can achieve this, or a macro since i am looking to automate this task.</p>\n\n<pre><code>Output:\nCol 1 | Col 2\nA       1\nB       2\nC       3\nG    \nH\n</code></pre>\n\n<p>Another Solution could be to compare the Columns QWE and WER and paste the differences on another sheet which could be appended onto the first sheet</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1554305007, "creation_date": 1554305007, "answer_id": 55498775, "question_id": 55498460, "link": "https://stackoverflow.com/questions/55498460/copying-values-from-a-specified-cell-in-sheet1-into-a-specified-range-of-the-sel/55498775#55498775", "title": "Copying values from a specified cell in Sheet1 into a specified range of the selected sheets", "body": "<p>You dim'd the wb but never set the workbook.</p>\n\n<p>You have two \"End With\"'s but have no starting  \"With\"'s\n.</p>\n\n<p>You have Activesheet.paste but have not selected a sheet</p>\n\n<pre><code>Sub Button1_Click()\n\n\n    Dim Wb As Workbook\n    Dim Sht As Worksheet\n    Dim mySelectedSheets As Sheets\n\n    Set Wb = ThisWorkbook\n\n    Wb.Sheets(\"Global\").Range(\"B1\", \"Q39\").Copy\n\n    Set mySelectedSheets = ActiveWindow.SelectedSheets\n\n\n    For Each Sht In mySelectedSheets\n        Sht.Range(\"B1\").PasteSpecial xlPasteValues\n    Next\n\n    Application.CutCopyMode = False\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554305007, "creation_date": 1554304080, "last_edit_date": 1554304936, "question_id": 55498460, "link": "https://stackoverflow.com/questions/55498460/copying-values-from-a-specified-cell-in-sheet1-into-a-specified-range-of-the-sel", "title": "Copying values from a specified cell in Sheet1 into a specified range of the selected sheets", "body": "<p>I would like to paste values from a range of cells in sheet1 into a specific range set in previously selected/activated sheets. Thus I want it to paste in let say only range B1 onwards but only for the sheets Sheet2, Sheet3 and NOT for Sheet4 since I have not selected it on my workbook.</p>\n\n<pre><code>Sub CopyFirstRow()\nDim Wb As Workbook\nDim Sht As Worksheet\nDim mySelectedSheets As Sheets\n\nWb.Sheets(\"Global\").Range(\"B1\", \"Q39\").Copy\n\nSet mySelectedSheets = ActiveWindow.SelectedSheets\n\n\nFor Each Sht In mySelectedSheets\n            ActiveSheet.Paste\nSht.Range(\"B1\").PasteSpecial xlPasteValues\nNext\nApplication.CutCopyMode = False\nEnd With\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Please explain what I am doing wrong, as I am trying to understand more and more VBA and specifically the SET, FOR, WITH functions.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554304068, "post_id": 55498416, "comment_id": 97703855, "body": "Double each quote inside the string <code>&quot;&quot;X&quot;&quot;</code> and <code>&quot;&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 3224930, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/08fa1600c31cf91abde504e6461af80c?s=128&d=identicon&r=PG&f=1", "display_name": "user3224930", "link": "https://stackoverflow.com/users/3224930/user3224930"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554310511, "post_id": 55498416, "comment_id": 97707516, "body": "It worked and thank you, but the background is green similar to the shade in AC11, but I want the shading to be &quot;no color&quot;."}, {"owner": {"reputation": 11, "user_id": 3224930, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/08fa1600c31cf91abde504e6461af80c?s=128&d=identicon&r=PG&f=1", "display_name": "user3224930", "link": "https://stackoverflow.com/users/3224930/user3224930"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554310879, "post_id": 55498416, "comment_id": 97707683, "body": "It worked and thank you, but the background is green similar to the shade in AC11, but I want the shading to be &quot;no color&quot;.    And the formatting are the same.    I would send you a sample but I don&#39;t how to in stackoverflow..."}, {"owner": {"reputation": 11, "user_id": 3224930, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/08fa1600c31cf91abde504e6461af80c?s=128&d=identicon&r=PG&f=1", "display_name": "user3224930", "link": "https://stackoverflow.com/users/3224930/user3224930"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554312342, "post_id": 55498416, "comment_id": 97708424, "body": "I figured the second part out.  Thank you for all of your help..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3224930, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/08fa1600c31cf91abde504e6461af80c?s=128&d=identicon&r=PG&f=1", "display_name": "user3224930", "link": "https://stackoverflow.com/users/3224930/user3224930"}, "edited": false, "score": 0, "creation_date": 1554310930, "post_id": 55498466, "comment_id": 97707713, "body": "It worked and thank you, but the background is green similar to the shade in AC11, but I want the shading to be &quot;no color&quot;. And the formatting are the same. I would send you a sample but I don&#39;t how to in stackoverflow..."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1554304105, "creation_date": 1554304105, "answer_id": 55498466, "question_id": 55498416, "link": "https://stackoverflow.com/questions/55498416/activecell-formula-ifac12-x-1/55498466#55498466", "title": "ActiveCell.Formula = &quot;=IF(AC12=&quot;X&quot;,1,&quot;&quot;)&quot;", "body": "<p>You need to double up any quotation marks in the formula string:</p>\n\n<pre><code>ActiveCell.Formula = \"=IF(AC12=\"\"X\"\",1,\"\"\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3224930, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/08fa1600c31cf91abde504e6461af80c?s=128&d=identicon&r=PG&f=1", "display_name": "user3224930", "link": "https://stackoverflow.com/users/3224930/user3224930"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554317301, "creation_date": 1554303954, "last_edit_date": 1554317301, "question_id": 55498416, "link": "https://stackoverflow.com/questions/55498416/activecell-formula-ifac12-x-1", "title": "ActiveCell.Formula = &quot;=IF(AC12=&quot;X&quot;,1,&quot;&quot;)&quot;", "body": "<p>I'm getting a Compile error: Syntax error for the following line of code:    </p>\n\n<pre><code>ActiveCell.Formula = \"=IF(AC12=\"X\",1,\"\")\"\n</code></pre>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1554303881, "post_id": 55498270, "comment_id": 97703738, "body": "Why needs 200 to be <code>4</code> if it is included in <code>[200,Inf)</code> which should be 5?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1554303953, "post_id": 55498270, "comment_id": 97703785, "body": "Would be much easier to follow if you used the standard <code>&gt;</code>, <code>&lt;</code> , <code>&gt;=</code>, <code>&lt;=</code> notation.  However, if you want a VBA solution it&#39;s typically a good idea to post what you already tried an explain the problem you had with that code."}, {"owner": {"reputation": 867, "user_id": 6072684, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/58ad4c350f42af956ca1630749389ab4?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe.", "link": "https://stackoverflow.com/users/6072684/j-doe"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1554304321, "post_id": 55498270, "comment_id": 97704018, "body": "@P\u1d07\u029c you are right. But the problem I have remains the same in that ranges <code>**are not monotonically increasing or decreasing**</code>. The solution would be the same"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554304440, "post_id": 55498270, "comment_id": 97704085, "body": "Why is the (non)regularity of the buckets a problem?"}, {"owner": {"reputation": 867, "user_id": 6072684, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/58ad4c350f42af956ca1630749389ab4?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe.", "link": "https://stackoverflow.com/users/6072684/j-doe"}, "edited": false, "score": 0, "creation_date": 1554304730, "post_id": 55498270, "comment_id": 97704282, "body": "Because I cannot use <code>index(lookup_range,MATCH)</code> and it&#39;s impossible to do this for 30 ranges with serial if statements."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1554358273, "post_id": 55498270, "comment_id": 97723157, "body": "@J.Doe. Then you chose a bad example. Please show an example data that shows the actual issue. Because the example data you show can be handled correctly with the shown formula. Please see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1554386895, "last_edit_date": 1554386895, "creation_date": 1554386505, "answer_id": 55517909, "question_id": 55498270, "link": "https://stackoverflow.com/questions/55498270/complex-lookup-with-matching-with-inclusive-exclusive/55517909#55517909", "title": "Complex Lookup With Matching With Inclusive/Exclusive", "body": "<p>You just need to recalculate the borders where you lookup with match (Column G). And add a tiny number eg <code>+0.000000000001</code> if there is a <code>&lt;</code> sign instead of a <code>&lt;=</code>. The green values can be changed by the user the rest is calculated by formulas.</p>\n\n<p>Note that if you change the <code>&lt;=</code> or <code>&lt;</code> signs it automatically changes the buckets <code>(</code> and <code>[</code> too.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZBElV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZBElV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Use these formulas and pull them down.</p>\n\n<ul>\n<li>C2 <code>=INDEX($E$2:$E$7,MATCH(B2,$G$2:$G$7,1),1)</code></li>\n<li>E2 <code>=IF(I2=\"&lt;\",\"(\",\"[\") &amp; H2 &amp; \",\" &amp; L2 &amp; IF(K2=\"&lt;\",\")\",\"]\")</code></li>\n<li>G2 <code>=IF(I2=\"&lt;\",H2+0.000000000001,H2)</code></li>\n<li>K2 <code>=IF(I3=\"&lt;\",\"&lt;=\",\"&lt;\")</code></li>\n<li>L2 <code>=H3</code></li>\n</ul>\n"}], "owner": {"reputation": 867, "user_id": 6072684, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/58ad4c350f42af956ca1630749389ab4?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe.", "link": "https://stackoverflow.com/users/6072684/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554386895, "creation_date": 1554303551, "last_edit_date": 1554371793, "question_id": 55498270, "link": "https://stackoverflow.com/questions/55498270/complex-lookup-with-matching-with-inclusive-exclusive", "title": "Complex Lookup With Matching With Inclusive/Exclusive", "body": "<p><strong>EDITED</strong></p>\n\n<p>After being asked for a more specific example, I created the example below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VgT1x.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VgT1x.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I need a way to correctly assign values (<strong>particularly those on the boundaries</strong>) without building repeated if statements. My goal is to allow my users to change the ranges on excel and a user defined formula in vba would allocate the correct category. </p>\n\n<p><strong>EDITED Dropped original question</strong></p>\n"}, {"tags": ["arrays", "vba", "loops", "tagging"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554302438, "post_id": 55497780, "comment_id": 97702633, "body": "There is no reason to read in the elements cell by cell, just use <code>arTesting = rng.Value</code>. This will yield a 2-dimensional array (even for a single column, in which case the second index is always 1) but this is <i>much</i> faster than 1500 + <code>ReDim Preserves</code> (especially because the <code>ReDim Preserve</code> isn&#39;t required in this case since you could just <code>Dim</code> the array once before you start)."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554302853, "post_id": 55497780, "comment_id": 97702931, "body": "Also, <code>If arTesting(i) = 182 Or 160 Or 250 Or 258 Or 180</code> doesn&#39;t mean what you think it means. That isn&#39;t shorthand for <code>If arTesting(i) = 182 Or arTesting(i) =160 Or arTesting(i) =250 Or arTesting(i) =258 Or arTesting(i) =180</code> (which is what I suspect you meant)."}, {"owner": {"reputation": 60, "user_id": 11306118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2UaiV.jpg?s=128&g=1", "display_name": "Mithrandir", "link": "https://stackoverflow.com/users/11306118/mithrandir"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554321056, "post_id": 55497780, "comment_id": 97712673, "body": "@JohnColeman That feeling when the mistake was as elementary as forgetting that <code>If arTesting(i) = 182 Or 160 Or 250 Or 258 Or 180</code> isn&#39;t the same as <code>If arTesting(i) = 182 Or arTesting(i) =160</code> etc.   Your solution worked great - thanks so much for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1554304086, "last_edit_date": 1554304086, "creation_date": 1554303546, "answer_id": 55498268, "question_id": 55497780, "link": "https://stackoverflow.com/questions/55497780/when-assigning-a-variable-to-an-array-why-am-i-getting-an-array-subscript-out-o/55498268#55498268", "title": "When assigning a variable to an array, why am I getting an array subscript out of range error?", "body": "<p>The following should do what you seem to be trying to do. It makes several changes:</p>\n\n<ol>\n<li>It properly declares 3 string variables rather than 2 variants and 1 string</li>\n<li>It reads in the values in 1 line of code</li>\n<li>It uses <code>Select Case</code> rather than an <code>If</code> statement with a condition that doesn't mean what you probably thing. <code>x = 1 Or 2 Or 3</code> means <code>(x = 1) Or 2 Or 3</code> (which is almost never what you want) rather than the intended <code>x = 1 Or x = 2 Or x = 3</code></li>\n</ol>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub arrayTest()\n    Dim arTesting() As Variant\n    Dim arTag1(1 To 1550, 1 To 1) As Variant 'this is just a test range\n    Dim arTag2(1 To 1550, 1 To 1) As Variant 'this is just a test range\n    Dim rng As Range, cell As Range\n    Dim HWSWTag As String, miscTag As String, notExpenseTag As String\n    Dim i As Long\n\n    Set rng = Range(\"G2:G1551\")\n\n    miscTag = \"Misc\"\n    HWSWTag = \"HW/SW\"\n    notExpenseTag = \"Not Expense\"\n\n    arTesting = rng.Value\n\n    For i = LBound(arTesting,1) To UBound(arTesting,1)\n        Select Case arTesting(i,1)\n            Case 716:\n                arTag1(i, 1) = miscTag\n                arTag2(i, 1) = HWSWTag\n            Case 182, 160, 250, 258, 180:\n                arTag1(i, 1) = notExpenseTag\n        End Select\n    Next i\n\n    Range(\"AL2:AL1551\").Value = arTag1\n    Range(\"AM2:AM1551\").Value = arTag2\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 11306118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2UaiV.jpg?s=128&g=1", "display_name": "Mithrandir", "link": "https://stackoverflow.com/users/11306118/mithrandir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 55498268, "answer_count": 1, "score": 2, "last_activity_date": 1554304086, "creation_date": 1554302206, "question_id": 55497780, "link": "https://stackoverflow.com/questions/55497780/when-assigning-a-variable-to-an-array-why-am-i-getting-an-array-subscript-out-o", "title": "When assigning a variable to an array, why am I getting an array subscript out of range error?", "body": "<p>I am trying to loop through a ledger of transactions and tag costs that correlate to certain account codes. For example, account code 123 would be tagged as a 'Hardware/Software' cost. I first produced code that combed through the ledger via reading each cell (a very lazy solution). This process took ~12-17 minutes to tag all costs in the ledger. I'm now trying to implement an array solution to tag all costs by reading the account codes through one array and then tag the costs in another array if it meets the requirements of an If/Then Statement. </p>\n\n<p>The code below is looping through account codes and tagging  'misc' costs, 'hardware' costs, and 'not expense' costs. </p>\n\n<p>How can I make the code work so that I can go through a series of If/Then statements with the account code to specify the tagging based on what the account code is? I keep getting an error (\"array subscript out of range\") when I try to assign the 'Not Expense' tag in the second If/Then statement in the code below:</p>\n\n<pre><code>Sub arrayTest()\nDim arTesting() As Variant\nDim arTag1(1 To 1550) As Variant 'this is just a test range\nDim arTag2(1 To 1550) As Variant 'this is just a test range\nDim rng, cell As Range\nDim HWSWTag, miscTag, notExpenseTag As String\nDim x As Integer\nSet rng = Range(\"G2:G1551\")\n\nmiscTag = \"Misc\"\nHWSWTag = \"HW/SW\"\nnotExpenseTag = \"Not Expense\"\n\nx = 1\n'Read in the range of account codes\nFor Each cell In rng\n    ReDim Preserve arTesting(x)\n    arTesting(x) = cell.Value\n    x = x + 1\n    Next cell\n\n'Now tag the costs to arTag1 and arTag2    \nDim i As Long\ni = 1\nFor i = LBound(arTesting) To UBound(arTesting)\n    If arTesting(i) = 716 Then\n                arTag1(i) = miscTag\n                arTag2(i) = HWSWTag\n    End If\n\n    If arTesting(i) = 182 Or 160 Or 250 Or 258 Or 180 Then\n        arTag1(i) = notExpenseTag 'This is where I get the error \n    End If\n\n'Debug.Print arTesting(i)\n\nNext i\n\n'Now paste the tags into the worksheet\n\nRange(\"AL2:AL1551\").Value = WorksheetFunction.Transpose(arTag1)\nRange(\"AM2:AM1551\").Value = WorksheetFunction.Transpose(arTag2)\n\nEnd Sub\n</code></pre>\n\n<p>I expect the output to tag all costs with account code '716' as 'misc' and 'HW/SW', and tag costs with account code '182', '160', '250', '258', '180' as 'Not Expense'</p>\n\n<p>I hope this code helps as it is a small part of the overall code that combs through a bunch of other account codes.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1554301982, "post_id": 55497657, "comment_id": 97702326, "body": "And what is your code doing wrong?  Where is the error? For that matter, where is the question?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554302055, "post_id": 55497657, "comment_id": 97702367, "body": "And to add to @ScottCraner, why am I procrastinating on my own project by helping other people&#39;s projects?"}, {"owner": {"reputation": 19, "user_id": 11164553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d653a749abf365db92cc2a84d4c22c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperMan", "link": "https://stackoverflow.com/users/11164553/superman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1554303198, "post_id": 55497657, "comment_id": 97703216, "body": "@ScottCraner , The code dosen&#39;t works, the problem is CriteriaRange:=, it dosen&#39;t extract unique value based on this criteria"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11164553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d653a749abf365db92cc2a84d4c22c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperMan", "link": "https://stackoverflow.com/users/11164553/superman"}, "edited": false, "score": 0, "creation_date": 1554734635, "post_id": 55498167, "comment_id": 97850888, "body": "It did works. The OutputRange is set for Range(&quot;B2&quot;)  but when I execute th code, the result appear on Range K2."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1554303269, "creation_date": 1554303269, "answer_id": 55498167, "question_id": 55497657, "link": "https://stackoverflow.com/questions/55497657/vba-extract-unique-values-based-on-criteria/55498167#55498167", "title": "VBA extract unique values based on criteria", "body": "<p>If you are trying to get a unique range that contains a keyword, something like this should work.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub OutputUniqueRange(SearchRange As Range, Keyword As String, OutputRange As Range)\n    Dim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n    Dim cell As Range\n\n    For Each cell In SearchRange\n        With cell\n            If InStr(1, .Value2, Keyword, vbTextCompare) &gt; 0 And Not dict.exists(.Value2) Then dict.Add .Value2, .Value2\n        End With\n    Next\n\n    If dict.Count = 0 Then Exit Sub\n    OutputRange.Range(OutputRange.Cells(1, 1).Address).Resize(dict.Count, 1) = Application.Transpose(dict.items())\nEnd Sub\n\nPublic Sub TestSub()\n    Dim SearchRange         As Range\n    Dim Keyword             As String\n    Dim OutputRange         As Range\n\n    Keyword = \"Boulanger\"\n    Set SearchRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2:A34\")\n    Set OutputRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B2\")\n\n    OutputUniqueRange SearchRange, Keyword, OutputRange\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1554320898, "creation_date": 1554320898, "answer_id": 55503197, "question_id": 55497657, "link": "https://stackoverflow.com/questions/55497657/vba-extract-unique-values-based-on-criteria/55503197#55503197", "title": "VBA extract unique values based on criteria", "body": "<p>I suspect your Criteria Range is not properly set up and/or named on your worksheet.</p>\n\n<p>In the <code>.AdvancedFilter</code>, you have:</p>\n\n<pre><code>Range(Crit1)\n</code></pre>\n\n<p>which, according to your code, will be interpreted as:</p>\n\n<pre><code>Range(\"BOULANGER\")\n</code></pre>\n\n<p>This presumes you have a Named Range somewhere on your Test Worksheet that is named <code>BOULANGER</code> and refers to two cells in a column, the first of which contains <code>Store</code> and the second contains <code>BOULANGER</code></p>\n\n<p>If you have that set up properly, then your code works.</p>\n\n<p>Note that in your screen shot showing the criteria, the first cell contains <code>Criteria</code> and not <code>Store</code>.  So even if you had the defined range setup to encompass those two cells, it would not work since the first row has to have an identical name to the column being filtered.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 11164553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d653a749abf365db92cc2a84d4c22c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperMan", "link": "https://stackoverflow.com/users/11164553/superman"}, "edited": false, "score": 0, "creation_date": 1554735264, "post_id": 55541160, "comment_id": 97851270, "body": "It&#39;s partially what I am looking for but with a condition. Of course I want to extract distinct value according to the retailer&#39;s condition. Example : If the condition is &quot;BOULANGER&quot; then I want only distinct stores named &quot;BOULANGER&quot;."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 0, "last_activity_date": 1554488561, "last_edit_date": 1554488561, "creation_date": 1554487758, "answer_id": 55541160, "question_id": 55497657, "link": "https://stackoverflow.com/questions/55497657/vba-extract-unique-values-based-on-criteria/55541160#55541160", "title": "VBA extract unique values based on criteria", "body": "<p>This should accomplish what you are trying to do; see comments in the code.</p>\n\n<pre><code>Sub ListUniqueValues()\nDim ws1 As Worksheet, ws2 As Worksheet\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\") 'change as needed\nSet ws2 = ThisWorkbook.Sheets(\"Sheet2\") 'change as needed\n\n    ws1.Range(\"B1\", ws1.Cells(Rows.Count, \"B\").End(xlUp)).Copy ws2.Range(\"C1\") 'copy the full range from sheet1\n    ws2.Range(\"C1\", ws2.Cells(Rows.Count, \"C\").End(xlUp)).RemoveDuplicates Columns:=Array(1), Header:=xlNo 'remove duplicates\n\n    Dim lRow As Long\n    lRow = ws2.Cells(Rows.Count, 3).End(xlUp).Row 'set lastrow variable\n\n        For i = lRow To 1 Step -1 'Da Loop, from bottom to top\n            'change the cell address after \"Like\" to the cell address where you put your store criteria\n            'the line will delete any store name that is not like your store criteria\n            'the (&amp; \"*\") inserts the wildcard after your store criteria you type in your designated cell, e.g. \"BOULANGER*\"\n            If Not ws2.Cells(i, 3).Value Like ws2.Cells(1, 1).Value &amp; \"*\" Then  '\n                ws2.Cells(i, 3).Delete 'delete the cells that do not match your store criteria\n            End If\n        Next i\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11164553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d653a749abf365db92cc2a84d4c22c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperMan", "link": "https://stackoverflow.com/users/11164553/superman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1702, "favorite_count": 0, "accepted_answer_id": 55541160, "answer_count": 3, "score": -1, "last_activity_date": 1554735365, "creation_date": 1554301877, "last_edit_date": 1554735365, "question_id": 55497657, "link": "https://stackoverflow.com/questions/55497657/vba-extract-unique-values-based-on-criteria", "title": "VBA extract unique values based on criteria", "body": "<p>I want to get a list of distinct value based on a criteria, example : I have a list of stores, and i want to get only distinct value based on retailer criteria \"BOULANGER\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Viv6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Viv6.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub distinctValues()\n\nDim LastRow As Long\nDim Crit1 As String\n\nLastRow = Sheets(\"SOURCE\").Cells(Rows.Count, \"B\").End(xlUp).Row\n\nSheets(\"SOURCE\").Range(\"B1:B\" &amp; LastRow).AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Sheets(\"TEST\").Range(\"E2\"), CopyToRange:=Sheets(\"TEST\").Range(\"A12\"), Unique:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "combobox", "automation"], "comments": [{"owner": {"reputation": 41, "user_id": 2010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ea14b41624574b7f37afdc7d5830b2?s=128&d=identicon&r=PG", "display_name": "user2010028", "link": "https://stackoverflow.com/users/2010028/user2010028"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1554301896, "post_id": 55497092, "comment_id": 97702269, "body": "tried this, but get an error 91 block not set."}, {"owner": {"reputation": 41, "user_id": 2010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ea14b41624574b7f37afdc7d5830b2?s=128&d=identicon&r=PG", "display_name": "user2010028", "link": "https://stackoverflow.com/users/2010028/user2010028"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1554306786, "post_id": 55497092, "comment_id": 97705585, "body": "also tried with &quot;AUT&quot; and again, nothing happens."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554306922, "post_id": 55497092, "comment_id": 97705663, "body": "Can you manually select all?"}, {"owner": {"reputation": 41, "user_id": 2010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ea14b41624574b7f37afdc7d5830b2?s=128&d=identicon&r=PG", "display_name": "user2010028", "link": "https://stackoverflow.com/users/2010028/user2010028"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554310123, "post_id": 55497092, "comment_id": 97707309, "body": "yes on the page, you can &quot;ctl&quot; click each option in the combobox manually.  I just want my automation code to select all :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554312112, "post_id": 55497092, "comment_id": 97708316, "body": "you might try selenuim. Is the url private?"}], "answers": [{"comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1554340709, "post_id": 55500906, "comment_id": 97718748, "body": "Thanks for posting the solution for this issue. I suggest you to try to mark your own answer as an accepted answer for this question after 48 hrs, when it is available to mark. It can help other community members in future in similar kind of issues. Thanks for your understanding."}], "tags": [], "owner": {"reputation": 41, "user_id": 2010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ea14b41624574b7f37afdc7d5830b2?s=128&d=identicon&r=PG", "display_name": "user2010028", "link": "https://stackoverflow.com/users/2010028/user2010028"}, "is_accepted": false, "score": 0, "last_activity_date": 1554312305, "creation_date": 1554312305, "answer_id": 55500906, "question_id": 55497092, "link": "https://stackoverflow.com/questions/55497092/need-help-selecting-multiple-items-in-combobox-in-ie-using-vba/55500906#55500906", "title": "Need help selecting multiple items in combobox in IE, using VBA", "body": "<pre><code>With HTMLDoc.getElementsByName(\"UFG.USER_TYPES\")(0)\n    .Children(0).Selected = True\n    .Children(1).Selected = True\n    .Children(2).Selected = True\nEnd With\n</code></pre>\n\n<p>The above code fixed it... whoopie!</p>\n"}], "owner": {"reputation": 41, "user_id": 2010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ea14b41624574b7f37afdc7d5830b2?s=128&d=identicon&r=PG", "display_name": "user2010028", "link": "https://stackoverflow.com/users/2010028/user2010028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 399, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554312305, "creation_date": 1554300308, "last_edit_date": 1554311683, "question_id": 55497092, "link": "https://stackoverflow.com/questions/55497092/need-help-selecting-multiple-items-in-combobox-in-ie-using-vba", "title": "Need help selecting multiple items in combobox in IE, using VBA", "body": "<p>I am having an issue with one part of my automation job, and that is selecting ALL the options in a combobox, on a webpage, using VBA and IE.</p>\n\n<p>This code selects ONE item in the combo box</p>\n\n<pre><code>Set frm = HTMLDoc.getElementsByName(\"UFG.USER_TYPES\")(0)\n   frm.Value = \"AUT\"\n</code></pre>\n\n<p>However, when I try to select multiple items, it just selects the last one, not all of them.</p>\n\n<p>Here is the code from the web page</p>\n\n<pre><code>\n    &lt;p  id=\"DispFormCollapsible.Rc10\"class=\"formrow\" &gt;\n    &lt;span  id=\"DispFormCollapsible.Rc10.C1\"  class=\"querytextleft\"&gt;\n    &lt;label for=\"UFG.USER_TYPES\" id=\"LabelForContro123\"class = \"simpletext\" &gt;\n    Accessible Types:&lt;span class=\"redstar\"&gt;*&lt;/span&gt;&lt;/label&gt;&lt;/span&gt;\n    &lt;span  id=\"DispFormCollapsible.Rc10.C2\"  class=\"querytextright\"&gt;\n    &lt;span class=\"labelColumn_combo\"&gt;\n    &lt;span class=\"labelColumn_combi_brdr\"&gt; \n    &lt;select  name= \"UFG.USER_TYPES\" multiple= \"true\" class = \"dropdownexpandalbe\"\n     id=\"UFG.USER_TYPES\" title = \"Accessible Financial Transaction Types\"&gt; \n    &lt;option value=\"AUT\"   title=\"ACTIVE USER TYPE1\" &gt;TYPE1&lt;/option&gt; \n    &lt;option value=\"SET\"   title=\"Selective User Type\" &gt;TYPE2&lt;/option&gt; \n    &lt;option value=\"TST\"   title=\"Test User Type\" &gt;TEST3&lt;/option&gt;\n    &lt;/select&gt;&lt;/span&gt;&lt;/span&gt;\n    &lt;input type =\"hidden\" name= \"UFG.USER_TYPES\" value=\"NULL\" &gt;\n    &lt;/span&gt;&lt;/p&gt;\n\n</code></pre>\n\n<p>Here is my VBA line to select an item</p>\n\n<pre><code>Set frm = HTMLDoc.getElementsByName(\"UFG.USER_TYPES\")(0)\n   frm.Value = \"AUT\"\n</code></pre>\n\n<p>What I need it to do, is select all the \"option values\" in the combobox.  I think it needs to be an array maybe, or some other way.  I've tried searching, but I'm getting nowhere.  Any help appreciated. Thx</p>\n\n<p>Tried the following, but get an error 91 Block not set.  I've also tried using the Values \"AUT\" in the children, and when doing that I don't get an error, but it doesn not select anything.</p>\n\n<pre><code>With HTMLDoc.getElementsByName(\"Select\")(0)\n    .Children(1).Selected = True\n    .Children(2).Selected = True\n    .Children(3).Selected = True\nEnd With\n</code></pre>\n\n<p>Also tried the following, this doesn't give an error, but only selects the first option in the list.</p>\n\n<pre><code>With HTMLDoc.getElementsByName(\"UFG.USER_TYPES\")(0)\n    .Children(AUT).Selected = True\n    .Children(SET).Selected = True\n    .Children(TST).Selected = True\nEnd With\n</code></pre>\n\n<p>This is strange, when I use this code, it selects the first two in the list, but not the third.</p>\n\n<pre><code>With HTMLDoc.getElementsByName(\"UFG.USER_TYPES\")(0)\n    .Children(all).Selected = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554300783, "post_id": 55496687, "comment_id": 97701522, "body": "For starters, you will have a hard time catching errors with <code>On Error Resume Next</code>. I would comment that before running any code that you are trying to debug. In this specific case, it might have something to do with the fact that you have inconsistent spacing between the &quot;NAME&quot; and &quot;For Upload&quot; in the different parts of your code. E.g., <code>NAME - ForUpload.txt</code> is not the same as <code>NAME-ForUpload.txt</code>, so <code>StrComp</code> will find that they are not the same."}, {"owner": {"reputation": 17, "user_id": 5574373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180d1747dfc7fb63d233d912838ce9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rashmi Patel", "link": "https://stackoverflow.com/users/5574373/rashmi-patel"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554302076, "post_id": 55496687, "comment_id": 97702384, "body": "@SmrtGrunt Sorry it was supposed to be like that, I fixed that issue but still seems to get kicked out into the msg box.  The weird thing is that even when the msg box is displayed, export of the file still completes."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554303552, "post_id": 55496687, "comment_id": 97703501, "body": "Does your working code include <code>vbDirectory</code> as a parameter? <a href=\"https://support.office.com/en-gb/article/dir-function-1a1a4275-f92f-4ae4-8b87-41e4513bba2e\" rel=\"nofollow noreferrer\">The Microsoft documentation</a> indicates that your <code>Dir</code> function call should be returning a directory name, which will fail when you feed it a file-specific path, resulting in an empty string. You should be able to confirm this by stepping through the code to see what is being stored in the <code>xpLoc</code> and <code>xFile</code> variables."}, {"owner": {"reputation": 17, "user_id": 5574373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180d1747dfc7fb63d233d912838ce9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rashmi Patel", "link": "https://stackoverflow.com/users/5574373/rashmi-patel"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554305868, "post_id": 55496687, "comment_id": 97704996, "body": "@SmrtGrunt Yes I have vbDirectory attribute in the Dir function.  Checking the ExpLoc variable shows &quot;I:\\Investigative Names&quot; and myFile shows NAME-ForUpload.txt.  The line xFile = Dir(expLoc &amp; &quot;Name-ForUpload.txt&quot;, vbDirectory) shows empty string for xFile, that&#39;s where the issue is, because the check for myFlag results in -1 which gets kicked out the loop."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554308530, "post_id": 55496687, "comment_id": 97706523, "body": "Out of curiosity, what happens if you change <code>vbDirectory</code> to <code>vbNormal</code>?"}, {"owner": {"reputation": 17, "user_id": 5574373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180d1747dfc7fb63d233d912838ce9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rashmi Patel", "link": "https://stackoverflow.com/users/5574373/rashmi-patel"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554310159, "post_id": 55496687, "comment_id": 97707328, "body": "@SmrtGrunt It still produces the same error."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554310441, "post_id": 55496687, "comment_id": 97707490, "body": "Are <code>TNAME</code> and <code>NAME</code> the same? <code>Dir</code> can be used in a loop, returning new file names until exhausted (at which point it returns an empty string). So calling <code>Dir</code> twice for the same name will return an empty string the second time."}, {"owner": {"reputation": 17, "user_id": 5574373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180d1747dfc7fb63d233d912838ce9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rashmi Patel", "link": "https://stackoverflow.com/users/5574373/rashmi-patel"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554310986, "post_id": 55496687, "comment_id": 97707748, "body": "@SmrtGrunt So currently this application looks in I:\\Investigative Names for the text files but I just copied those files on my local pc and did the test and successfully completed without any errors.  Do you think its like some sort of permissions issue? The weird thing is this program works on windows 7 pc and now that I upgraded to windows 10, this message shows up."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554311994, "post_id": 55496687, "comment_id": 97708252, "body": "I think it&#39;s more likely to be an issue with the pathname to the I: drive, but I can&#39;t see any differences in the documentation for the <code>Dir</code> function between Windows 7 and 10."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554312118, "post_id": 55496687, "comment_id": 97708319, "body": "Can you confirm that the code works the same on your local directory both with and without an existing file? My guess is still that if it executes the <code>Kill</code> call, that causes the second <code>Dir</code> call to return an empty string."}, {"owner": {"reputation": 17, "user_id": 5574373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180d1747dfc7fb63d233d912838ce9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rashmi Patel", "link": "https://stackoverflow.com/users/5574373/rashmi-patel"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554313936, "post_id": 55496687, "comment_id": 97709137, "body": "Seems like changing the path to local and then back to I:\\, fixed the issue.  Thanks for your suggestions"}], "owner": {"reputation": 17, "user_id": 5574373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180d1747dfc7fb63d233d912838ce9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rashmi Patel", "link": "https://stackoverflow.com/users/5574373/rashmi-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594621064, "creation_date": 1554299013, "last_edit_date": 1594621064, "question_id": 55496687, "link": "https://stackoverflow.com/questions/55496687/vba-access-2010-dir-results-in-empty-string", "title": "VBA Access 2010 DIR results in empty string", "body": "<p>I have the following code:</p>\n\n<pre><code>Private Sub cmdExportTERNAME_Click()\n\nOn Error Resume Next\n\nMe.MsgFld = \"Please wait... exporting TERNAME file.\"\n\nDim expLoc As String\nDim xFile As String, myFile As String\nDim myFlag As Integer\n\nexpLoc = \"I:\\Investigative Names\\\"           ' PRD\n\nxFile = Dir(expLoc &amp; \"NAME - ForUpload.txt\", vbDirectory)\nmyFile = \"NAME-ForUpload.txt\"\nmyFlag = StrComp(xFile, myFile)\nIf myFlag &lt;&gt; -1 Then\n   Kill expLoc &amp; \"NAME-ForUpload.txt\"\nEnd If\n\n' Export text files for upload\nDoCmd.TransferText acExportFixed, \"SpecTERNAME\", \"qry_TERNAME\", expLoc &amp; \"NAME-ForUpload.txt\"\n\nxFile = Dir(expLoc &amp; \"TNAME-ForUpload.txt\")\nmyFile = \"NAME-ForUpload.txt\"\nmyFlag = StrComp(xFile, myFile)\nIf myFlag &lt;&gt; -1 Then\n   GoTo ContinueProcessing1\nElse\n   MsgBox \"The program was not able to export the NAME file for upload.\" &amp; Chr(13) &amp; Chr(13) &amp; \"Please notify IS Department.\", vbCritical, \"ERROR MESSAGE BOX\"\n   GoTo exitRTN\nEnd If\n\nContinueProcessing1:\n\nexitRTN:\n\nEnd Sub\n</code></pre>\n\n<p>So I have 2 more of these subroutines with different text files which work fine but this block of code doesn't find xFile, it return a empty string which causes the program to display the message box error.  I can't figure out why the same code with different text file works before it reaches this code.  The weird thing is it sometimes finds the correct xFile name in debug mode but not when run normally.  Can someone help me figure this out?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "qnamaker"], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1554367194, "post_id": 55504970, "comment_id": 97727938, "body": "Thank you very much! this worked perfect :) Would you know whether its possible to have the query return the confidence as well? Ideally, if an answer confidence is low, I would know which ones I need to examine in detail. Thank again!"}, {"owner": {"reputation": 6627, "user_id": 12248433, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i6pUDQ6UiYA/AAAAAAAAAAI/AAAAAAAB9Vo/HeFe6tNR68A/photo.jpg?sz=128", "display_name": "mdrichardson", "link": "https://stackoverflow.com/users/12248433/mdrichardson"}, "reply_to_user": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 1, "creation_date": 1554390289, "post_id": 55504970, "comment_id": 97743095, "body": "You sure can. Towards the end of the code is the line <code>GetAnswer = answer(&quot;answer&quot;)</code>. If you change it to <code>GetAnswer = answer(&quot;score&quot;)</code> you get the confidence level/score instead of the actual answer. Personally, I&#39;d use <code>GetAnswer = answer</code> and then in <code>GetReplies</code>, use <code>cell.Offset(0, 1).Value = answer(&quot;answer&quot;)</code> and <code>cell.Offset(0, 2).Value = answer(&quot;score&quot;)</code>. You may need to change the return type on <code>GetAnswer</code>. Let me know if you need help doing that."}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1554727616, "post_id": 55504970, "comment_id": 97846277, "body": "Hihi, I have tried to adapt your solution to a word document as well but I am struggling. I am trying to feed the GetAnswer method a single question (the text selected in word) but I get the following error at the line:   For Each answer In json(&quot;answers&quot;) Compile error: Wrong number of arguments or invalid property assignment. I think it has to do with the number of return objects? I tried using the enclosed to solve but you are already implemented the suggested solution so I am a bit lost. Would you have any ideas? <a href=\"https://stackoverflow.com/questions/50244611/extract-json-in-excel-vba\" title=\"extract json in excel vba\">stackoverflow.com/questions/50244611/extract-json-in-excel-v&zwnj;&#8203;ba</a>"}, {"owner": {"reputation": 6627, "user_id": 12248433, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i6pUDQ6UiYA/AAAAAAAAAAI/AAAAAAAB9Vo/HeFe6tNR68A/photo.jpg?sz=128", "display_name": "mdrichardson", "link": "https://stackoverflow.com/users/12248433/mdrichardson"}, "reply_to_user": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1554735897, "post_id": 55504970, "comment_id": 97851692, "body": "See <a href=\"https://github.com/VBA-tools/VBA-JSON/issues/68\" rel=\"nofollow noreferrer\">this issue</a>. To fix: 1) Open Tools &gt; References and move &quot;Microsoft Scripting Runtime&quot; above &quot;Microsoft Word 16.0 Object Library&quot;. 2) In the VBA code, change &quot;As Dictionary&quot; to &quot;As Scripting.Dictionary&quot;"}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1554884555, "post_id": 55504970, "comment_id": 97910424, "body": "Thank you for the reference. I have implemented the fixes suggested and I believe it has been resolved, but the error moves to another section of the code. In the function, GetAnswer - xmlhttp send data line, I get an error stating: This method cannot be called after the send method has been called (it is the only &#39;send&#39; method I see). Would you have any ideas?"}, {"owner": {"reputation": 6627, "user_id": 12248433, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i6pUDQ6UiYA/AAAAAAAAAAI/AAAAAAAB9Vo/HeFe6tNR68A/photo.jpg?sz=128", "display_name": "mdrichardson", "link": "https://stackoverflow.com/users/12248433/mdrichardson"}, "reply_to_user": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1554908478, "post_id": 55504970, "comment_id": 97924913, "body": "@Freelancer If you can open a new StackOverflow question, include the code, and point me to it, I can help you out. I&#39;m actually a support engineer for the Bot Framework, although we handle some QnAMaker stuff, so this is a little beyond the scope of my job. I&#39;m willing to help out, though; just need to see your code to troubleshoot better."}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "edited": false, "score": 0, "creation_date": 1554972585, "post_id": 55504970, "comment_id": 97948330, "body": "Sorry to bother, I am grateful for your help :)  I have opened another question with the error code if you wouldnt mind taking a look: <a href=\"https://stackoverflow.com/q/55628303/6820783\">stackoverflow.com/q/55628303/6820783</a>"}], "tags": [], "owner": {"reputation": 6627, "user_id": 12248433, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i6pUDQ6UiYA/AAAAAAAAAAI/AAAAAAAB9Vo/HeFe6tNR68A/photo.jpg?sz=128", "display_name": "mdrichardson", "link": "https://stackoverflow.com/users/12248433/mdrichardson"}, "is_accepted": true, "score": 2, "last_activity_date": 1554333397, "last_edit_date": 1554333397, "creation_date": 1554328805, "answer_id": 55504970, "question_id": 55496567, "link": "https://stackoverflow.com/questions/55496567/how-to-connect-excel-to-microsofts-qna-maker-vba/55504970#55504970", "title": "How to connect excel to microsoft&#39;s QnA Maker (VBA)", "body": "<p>I found two ways to do this. First is with VBA. Second is with Power Queries.</p>\n\n<h1>VBA</h1>\n\n<h3>Optional Setup</h3>\n\n<p><a href=\"https://i.stack.imgur.com/f469w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f469w.png\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li><p>Add the Developer tab to the ribbon by going to File > Options > Customize Ribbon > Check Developer</p></li>\n<li><p>Go to the Developer tab, then Insert > Button</p></li>\n<li><p>Name the macro \"GetReplies\"</p></li>\n<li><p>Click New</p></li>\n</ol>\n\n<p><strong>Notes:</strong></p>\n\n<ul>\n<li>My QnAKB is based off of <a href=\"https://docs.microsoft.com/en-us/azure/bot-service/bot-service-resources-bot-framework-faq?view=azure-bot-service-4.0\" rel=\"nofollow noreferrer\">this FAQ</a>, mostly.</li>\n</ul>\n\n<h3>VBA Setup</h3>\n\n<ol>\n<li><p>From the Developer tab, click the Visual Basic button (if it didn't open automatically)</p></li>\n<li><p>Go to Tools > References and enable the following libraries:\n<a href=\"https://i.stack.imgur.com/FrkAQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FrkAQ.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Import <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">this JSON library</a> following <a href=\"https://github.com/VBA-tools/VBA-JSON#installation\" rel=\"nofollow noreferrer\">the installation instructions</a></p></li>\n<li><p>Copy/paste this:</p></li>\n</ol>\n\n<p>VBA code:</p>\n\n<pre><code>Sub GetReplies()\n\n    'User Settings\n    Dim questionWorksheetName As String, questionsColumn As String, firstQuestionRow As String, kbHost As String, kbId As String, endpointKey As String\n\n        questionWorksheetName = \"Sheet1\"\n        questionsColumn = \"A\"\n        firstQuestionRow = \"2\"\n\n        kbHost = \"https://**********.azurewebsites.net/qnamaker\"\n        kbId = \"*******-****-****-****-**********\"\n        endpointKey = \"*********-****-****-****-***********\"\n\n    'Non-User Settings\n    Dim questionWorksheet As Worksheet\n        Set questionWorksheet = Sheets(questionWorksheetName)\n    Dim startCell As String\n        startCell = questionsColumn &amp; firstQuestionRow\n    Dim questionsRange As Range\n        Set questionsRange = questionWorksheet.Range(startCell, questionWorksheet.Range(startCell).End(xlDown))\n\n    'Loop through all non-blank cells\n    Dim answer As String\n    For Each cell In questionsRange\n        If Not IsEmpty(cell) Then\n            answer = GetAnswer(cell.Value, kbHost, kbId, endpointKey)\n            'Add answer to cell\n            cell.Offset(0, 1).Value = answer\n        End If\n    Next\n\nEnd Sub\n\nFunction GetAnswer(question, kbHost, kbId, endpointKey) As String\n    'HTTP Request Settings\n    Dim qnaUrl As String\n        qnaUrl = kbHost &amp; \"/knowledgebases/\" &amp; kbId &amp; \"/generateAnswer\"\n    Dim contentType As String\n        contentType = \"application/json\"\n    Dim data As String\n        data = \"{\"\"question\"\":\"\"\" &amp; question &amp; \"\"\"}\"\n\n    'Send Request\n    Dim xmlhttp As New MSXML2.XMLHTTP60\n\n    xmlhttp.Open \"POST\", qnaUrl, False\n        xmlhttp.SetRequestHeader \"Content-Type\", contentType\n        xmlhttp.SetRequestHeader \"Authorization\", \"EndpointKey \" &amp; endpointKey\n    xmlhttp.Send data\n\n    'Convert response to JSON\n    Dim json As Dictionary\n    Set json = JsonConverter.ParseJson(xmlhttp.ResponseText)\n\n    Dim answer As Dictionary\n\n    For Each answer In json(\"answers\")\n    'Return response\n        GetAnswer = answer(\"answer\")\n    Next\n\nEnd Function\n</code></pre>\n\n<ol start=\"5\">\n<li>Edit the \"User Settings\" at the top, appropriately</li>\n</ol>\n\n<p>After running, I get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/V3isi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V3isi.png\" alt=\"enter image description here\"></a></p>\n\n<h1>Power Queries</h1>\n\n<h3>Create HTTP Connection Query</h3>\n\n<ol>\n<li><p>Data Tab > Get Data > From Other Sources > Blank Query</p></li>\n<li><p>Click Advanced Editor and copy paste</p></li>\n</ol>\n\n<p>Code:</p>\n\n<pre><code>(Question as text) =&gt;\nlet\n    url = \"https://***host****.azurewebsites.net/qnamaker/knowledgebases/****kbId******/generateAnswer\",\n    endpointKey = \"****endpointKey*****\",\n    table = Excel.CurrentWorkbook(){[Name=\"Answers\"]}[Content],\n    row = Table.SelectRows(table, each ([Answer] = Question)),\n    body = \"{\"\"question\"\":\"\"\" &amp; Question &amp; \"\"\"}\",\n    Parsed_JSON = Json.Document(body),\n    BuildQueryString = Uri.BuildQueryString(Parsed_JSON),\n    headers = [#\"Content-Type\"=\"application/json\", #\"Authorization\"=\"EndpointKey \" &amp; endpointKey],\n    content = Text.ToBinary(body),\n    Source = Json.Document(Web.Contents(url, [Headers = headers, Content = content])),\n    answers = Source[answers],\n    answers1 = answers{0},\n    answer = answers1[answer]\nin\n    answer\n</code></pre>\n\n<ol start=\"3\">\n<li><p>Replace variables as necessary</p></li>\n<li><p>Rename the Query to \"GetAnswer\"</p></li>\n<li><p>Exit from Power Query, saving changes</p></li>\n</ol>\n\n<h3>Create the Table</h3>\n\n<ol>\n<li>Create a table with your questions</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/REQ6j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/REQ6j.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"2\">\n<li><p>Select the table. Table Design Tab > Rename the table to Answers</p></li>\n<li><p>With whole table selected, Data tab > From Table/Range</p></li>\n<li><p>Add Column > Invoke Custom Function</p></li>\n<li><p>Column name = Answers, Function query = GetAnswer, Question: ColumnName = Question</p></li>\n<li><p>Ok. Ok/Exit/Save</p></li>\n</ol>\n\n<p>You can then add a question to the table, go to the sheet where the Question/Answer table was created and click Refresh to get new answers.</p>\n"}], "owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 2, "accepted_answer_id": 55504970, "answer_count": 1, "score": 1, "last_activity_date": 1554333397, "creation_date": 1554298640, "last_edit_date": 1554303013, "question_id": 55496567, "link": "https://stackoverflow.com/questions/55496567/how-to-connect-excel-to-microsofts-qna-maker-vba", "title": "How to connect excel to microsoft&#39;s QnA Maker (VBA)", "body": "<p>I receive excel files with questions on a regular basis (I have the answers from previous iterations. the questions are always similar) and I would like to automate the replies. I have created a Knowledge Base in Microsofts QnAMaker with all the question/answer pairs.</p>\n\n<p>How can I call Microsofts QnAMaker to answer my questions from excel. I have been looking for a vba examples but I havent found anything so far.\nI believe I need to make a HTTP request with authorization from excel using vba and then process the response.\nWould someone have an idea on how I can make a request and process it?</p>\n\n<p>Any help appreciated. Thank you!</p>\n\n<p>These are the sample details QnAMaker provides to make the call:</p>\n\n<pre><code> POST /knowledgebases/d02d1d7e-1bc0-461a-8074-37749cae41b9/generateAnswer\n Host: https://rfp1.azurewebsites.net/qnamaker\n Authorization: EndpointKey cec4b630-9e77-474f-8df4-e6430a5678c8\n Content-Type: application/json\n {\"question\":\"&lt;Your question&gt;\"}\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1554300616, "post_id": 55496431, "comment_id": 97701410, "body": "Yes probably...Try querying <code>Envrion</code> to see what you can get"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1554300985, "post_id": 55496431, "comment_id": 97701651, "body": "See <a href=\"https://stackoverflow.com/a/7831157/3219613\">stackoverflow.com/a/7831157/3219613</a> if you want to read the LDAP User Properties. Note that the function provided there can read more than only the users <code>displayName</code> if you feed it with the correct parameters."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1554301133, "post_id": 55496431, "comment_id": 97701759, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21110232/getting-ad-details-based-on-username\">Getting AD Details based on username</a>."}, {"owner": {"reputation": 13, "user_id": 11305884, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JvzwOFgvJHA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBnzfNU7K5M7oPFfU5IiWSjmuEcQ/mo/photo.jpg?sz=128", "display_name": "JCart15", "link": "https://stackoverflow.com/users/11305884/jcart15"}, "edited": false, "score": 0, "creation_date": 1554390500, "post_id": 55496431, "comment_id": 97743238, "body": "So I found wscript essentially pulls the same data as environ. However looked in to LDAP after sifting through stack and have managed to get this to work after creating a function that works with a cells value as the variable! Thanks everyone for your comments :)"}], "owner": {"reputation": 13, "user_id": 11305884, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JvzwOFgvJHA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBnzfNU7K5M7oPFfU5IiWSjmuEcQ/mo/photo.jpg?sz=128", "display_name": "JCart15", "link": "https://stackoverflow.com/users/11305884/jcart15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554300010, "creation_date": 1554298246, "last_edit_date": 1554300010, "question_id": 55496431, "link": "https://stackoverflow.com/questions/55496431/using-cell-vlaue-with-wscript-network-to-pull-domain-data", "title": "Using cell vlaue with WScript.Network to pull domain data", "body": "<p>I am building something that requires details associated with a user in the company to be pre-populated when the username is submitted.</p>\n\n<p>I am working with 'CreateObject(\"WScript.Network\")'. I essentially want to put user A's login name in to cell A1, then using that number return the details in the company network relating to that username. </p>\n\n<p>Can it be done?</p>\n"}, {"tags": ["excel", "vba", "border", "cell"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1554297119, "post_id": 55495956, "comment_id": 97699166, "body": "What is the error message? Not able to reproduce the error."}, {"owner": {"reputation": 1, "user_id": 10295476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59eb9e9ffc211db96a9cdba7cafdaa0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea D", "link": "https://stackoverflow.com/users/10295476/andrea-d"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554298795, "post_id": 55495956, "comment_id": 97700249, "body": "the error is &quot;Error 1004&quot;"}, {"owner": {"reputation": 1, "user_id": 10295476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59eb9e9ffc211db96a9cdba7cafdaa0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea D", "link": "https://stackoverflow.com/users/10295476/andrea-d"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1554298901, "post_id": 55495956, "comment_id": 97700326, "body": "The problem is that the same macro works fine with Excel 2013."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1554298944, "post_id": 55495956, "comment_id": 97700359, "body": "Macro works fine with Excel 2019 too."}, {"owner": {"reputation": 1, "user_id": 10295476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59eb9e9ffc211db96a9cdba7cafdaa0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea D", "link": "https://stackoverflow.com/users/10295476/andrea-d"}, "edited": false, "score": 0, "creation_date": 1554299454, "post_id": 55495956, "comment_id": 97700658, "body": "Do you test it with Excel 2016 ?"}], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 1, "user_id": 10295476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59eb9e9ffc211db96a9cdba7cafdaa0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea D", "link": "https://stackoverflow.com/users/10295476/andrea-d"}, "edited": false, "score": 0, "creation_date": 1554299107, "post_id": 55496073, "comment_id": 97700440, "body": "The above code is tested and works perfectly. In my opinion you code gives an error because you dont refer to specific sheet, instead you are using .Select"}, {"owner": {"reputation": 1, "user_id": 10295476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59eb9e9ffc211db96a9cdba7cafdaa0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea D", "link": "https://stackoverflow.com/users/10295476/andrea-d"}, "edited": false, "score": 0, "creation_date": 1554299402, "post_id": 55496073, "comment_id": 97700625, "body": "It works with Excel 2013, so refefence to Sheet(1) doesn&#39;t change the result. (I testd it just now)"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1554297166, "creation_date": 1554297166, "answer_id": 55496073, "question_id": 55495956, "link": "https://stackoverflow.com/questions/55495956/excel-2016-vba-macro-to-set-borders-to-a-cell-range-with-filtered-cells-inside-g/55496073#55496073", "title": "Excel 2016 vba macro to set borders to a cell range with filtered cells inside gives error (with Excel 2013 everything is fine)", "body": "<p>Change range and try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    With ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A6\").Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10295476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59eb9e9ffc211db96a9cdba7cafdaa0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea D", "link": "https://stackoverflow.com/users/10295476/andrea-d"}, "edited": false, "score": 0, "creation_date": 1554359778, "post_id": 55497381, "comment_id": 97723821, "body": "sorry, but not ;-("}], "tags": [], "owner": {"reputation": 51, "user_id": 9222146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43bd052206497a54f7549b4768af84f5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Montano", "link": "https://stackoverflow.com/users/9222146/jeremiah-montano"}, "is_accepted": false, "score": 0, "last_activity_date": 1554301151, "creation_date": 1554301151, "answer_id": 55497381, "question_id": 55495956, "link": "https://stackoverflow.com/questions/55495956/excel-2016-vba-macro-to-set-borders-to-a-cell-range-with-filtered-cells-inside-g/55497381#55497381", "title": "Excel 2016 vba macro to set borders to a cell range with filtered cells inside gives error (with Excel 2013 everything is fine)", "body": "<p>I've been reading Microsoft documentation and it seems the selection is unneccesary. Try this: </p>\n\n<pre><code>sub test()\n\nRange(\"A1:A6\").Borders.LineStyle = xlNone\n\nWith Range(\"A1:A6\").Borders(xlEdgeLeft)\n\n.LineStyle = xlContinuous\n\n.ColorIndex = 0\n\n.TintAndShade = 0\n\n.Weight = xlThin   ' ==&gt;&gt;ERROR HERE\n\nEnd With\n\nEnd sub\n</code></pre>\n\n<p>You may have to throw ActiveWorksheet before the range or a Sheet( \"Sheet1\") depending on what sheet you are on when the macro runs. Hope this helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 10295476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b59eb9e9ffc211db96a9cdba7cafdaa0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea D", "link": "https://stackoverflow.com/users/10295476/andrea-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554907643, "creation_date": 1554296788, "last_edit_date": 1554907643, "question_id": 55495956, "link": "https://stackoverflow.com/questions/55495956/excel-2016-vba-macro-to-set-borders-to-a-cell-range-with-filtered-cells-inside-g", "title": "Excel 2016 vba macro to set borders to a cell range with filtered cells inside gives error (with Excel 2013 everything is fine)", "body": "<p>---- updated with more details ---</p>\n\n<p>I have made a vba macro that works fine with Excel 2013, but have error with Excel 2016. The macro is very simple and is taken from \"recorded macro\": it set borders to some cells.</p>\n\n<p>The problem (I suppose) is that cells included also filtered rows:</p>\n\n<pre><code>column_1 \ncells(1;1) = \"aa\"\ncells(2;1) = 2\ncells(3;1) = 1\ncells(4;1) = 2\ncells(5;1) = 1\ncells(6;1) = 1\n</code></pre>\n\n<p>filtered with \"1\" on the first row</p>\n\n<p><a href=\"https://i.stack.imgur.com/XHUdO.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>So running the following macro,\nyou have error '1004' on \".weight \" row</p>\n\n<p><a href=\"https://i.stack.imgur.com/qmi2w.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Giving OK you have:\n<a href=\"https://i.stack.imgur.com/vRpxv.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>and if you stop the macro now and try to save the file,\nyou'll get an error:\n<a href=\"https://i.stack.imgur.com/o8WdB.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><strong>Please note that this happens only with Excel 2016, Excel 2013 has no problems</strong> </p>\n\n<p>This is the complete macro:\n              Option Explicit</p>\n\n<pre><code>        Sub test()\n            Sheets(1).Select\n            Range(\"A1:A6\").Select\n            Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n            Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n            With Selection.Borders(xlEdgeLeft)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin   ' ==&gt;&gt;&gt;&gt;ERROR HERE\n            End With\n            With Selection.Borders(xlEdgeTop)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlEdgeBottom)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlEdgeRight)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlInsideVertical)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlInsideHorizontal)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n</code></pre>\n\n<p>Please help\nThx</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1956, "user_id": 4429015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqxqf.png?s=128&g=1", "display_name": "B001\u16e6", "link": "https://stackoverflow.com/users/4429015/b001%e1%9b%a6"}, "edited": false, "score": 0, "creation_date": 1554296361, "post_id": 55495780, "comment_id": 97698672, "body": "Seems <code>Val</code> is always 0.,. Maybe <code>average</code> and <code>value</code> have the same value"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 1, "creation_date": 1554296878, "post_id": 55495780, "comment_id": 97698995, "body": "Will the division always return an integer?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1554296900, "post_id": 55495780, "comment_id": 97699006, "body": "Have you checked your input? Is it numeric? Are there cases where <code>average  &gt; Value</code> at all?"}, {"owner": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1554296920, "post_id": 55495780, "comment_id": 97699020, "body": "What value have you processed ?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1554297038, "post_id": 55495780, "comment_id": 97699113, "body": "MiguelH points to the the problem: You are doing a division and return an integer. As your division is probanbly a value between 0 and 1 and the result is converted to an int, you see 0 as result"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11305429, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ERCqJ48VEhs/AAAAAAAAAAI/AAAAAAAABfY/tW6mO4ASLJ0/photo.jpg?sz=128", "display_name": "Friso Koopman", "link": "https://stackoverflow.com/users/11305429/friso-koopman"}, "is_accepted": false, "score": 1, "last_activity_date": 1554297219, "creation_date": 1554297219, "answer_id": 55496094, "question_id": 55495780, "link": "https://stackoverflow.com/questions/55495780/my-code-in-vba-is-only-producing-0-as-result-despite-numerous-value-changes/55496094#55496094", "title": "My code in vba is only producing 0 as result despite numerous value changes", "body": "<p>Without knowing exactly what you number and average can hold, you didn't define them as integers or doubles or longs</p>\n\n<p>also, if you value is larger than the average, you val will be negative.</p>\n\n<p>if you rewrite your code as a sub and run through it using F8 you can see step by step what happens.</p>\n\n<pre><code>Sub test()\nDim value As Integer\nDim average As Integer\nDim NDAB As Integer\n\nvalue = 2\naverage = 5\n\n    Dim Val As Integer\n    Val = average - value\n    If Val &gt; 0 Then\n        NDAB = Val / average\n    Else\n        NDAB = 0\n    End If\n\n    MsgBox NDAB \nEnd Sub\n</code></pre>\n\n<p>result in 1\nso to me the code is fine, the input is just resulting in 0.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1554297653, "creation_date": 1554297653, "answer_id": 55496241, "question_id": 55495780, "link": "https://stackoverflow.com/questions/55495780/my-code-in-vba-is-only-producing-0-as-result-despite-numerous-value-changes/55496241#55496241", "title": "My code in vba is only producing 0 as result despite numerous value changes", "body": "<p>I have try the below and looks to work perfectly:</p>\n\n<pre><code>Option Explicit\n\nFunction NDAB(ByVal value As Double, ByVal average As Double)\n\n    Dim Val As Double\n\n    Val = average - value\n\n    If Val &gt; 0 Then\n        NDAB = Val / average\n    Else\n        NDAB = 0\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Call Function from sub test:</p>\n\n<pre><code>Sub test()\n\n    Call Module1.NDAB(2.5, 10.5)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11305724, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9XxiiwXuBWo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reXL9N6riO9m8mIH-z_QOx2_KNDZg/mo/photo.jpg?sz=128", "display_name": "Umang Singhal", "link": "https://stackoverflow.com/users/11305724/umang-singhal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554297653, "creation_date": 1554296267, "last_edit_date": 1554296519, "question_id": 55495780, "link": "https://stackoverflow.com/questions/55495780/my-code-in-vba-is-only-producing-0-as-result-despite-numerous-value-changes", "title": "My code in vba is only producing 0 as result despite numerous value changes", "body": "<p>I wrote a code in excel vba but it is only producing result as 0.</p>\n\n<pre><code>Function NDAB(value, average) As Integer\n    Dim Val As Integer\n    Val = average - value\n    If Val &gt; 0 Then\n        NDAB = Val / average\n    Else\n        NDAB = 0\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8993464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2e0967dd8db026203e37836bc3c6b3?s=128&d=identicon&r=PG&f=1", "display_name": "InterestedGuy", "link": "https://stackoverflow.com/users/8993464/interestedguy"}, "edited": false, "score": 0, "creation_date": 1554295925, "post_id": 55495493, "comment_id": 97698380, "body": "this makes sense, however, I feel this is a long way of solving this as you have to covert each number then sum the row. Would it not be possible to do this in one single cell. i.e some type of long formula"}], "tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": false, "score": 0, "last_activity_date": 1554296137, "last_edit_date": 1554296137, "creation_date": 1554295315, "answer_id": 55495493, "question_id": 55495385, "link": "https://stackoverflow.com/questions/55495385/summing-the-scores-of-a-test/55495493#55495493", "title": "Summing the scores of a test", "body": "<p>Use this formula on all responses adjusting A1 to the cell needed.</p>\n\n<pre><code>=CODE(UPPER(A1))-64\n</code></pre>\n\n<p>This converts a or A to 1, b or B to 2 etc. This works because the ASCII value of upper case A is 65. Then you can add the values.</p>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1554296501, "last_edit_date": 1554296501, "creation_date": 1554295931, "answer_id": 55495673, "question_id": 55495385, "link": "https://stackoverflow.com/questions/55495385/summing-the-scores-of-a-test/55495673#55495673", "title": "Summing the scores of a test", "body": "<p>You can use:</p>\n\n<pre><code>=SUMPRODUCT(CODE(UPPER(B2:K21))-64)\n</code></pre>\n\n<p>In VBA:</p>\n\n<pre><code>Total = Evaluate(\"=SUM(CODE(UPPER(B2:K21))-64)\")\n</code></pre>\n\n<p>This is an array formula, and that's why <code>SUMPRODUCT()</code> is better on a sheet, but VBA can work with array without entering as array, hence why the <code>SUM()</code> works through VBA. It's sheet equivalent would be: <code>{=SUM(CODE(UPPER(B2:K21))-64)}</code></p>\n"}], "owner": {"reputation": 15, "user_id": 8993464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e2e0967dd8db026203e37836bc3c6b3?s=128&d=identicon&r=PG&f=1", "display_name": "InterestedGuy", "link": "https://stackoverflow.com/users/8993464/interestedguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 55495673, "answer_count": 2, "score": 1, "last_activity_date": 1554296501, "creation_date": 1554295006, "question_id": 55495385, "link": "https://stackoverflow.com/questions/55495385/summing-the-scores-of-a-test", "title": "Summing the scores of a test", "body": "<p>I have a table, the left hand column consisting of questionnaire participants say 1-20. Followed by 10 columns with answers to 10 possible questions.</p>\n\n<p>Lets say question answers range from a-e where a = 1 point and e = 5 points.</p>\n\n<p>What is the easiest and quickest way to sum up everyones score.</p>\n\n<p>I have attempted to use Sumifs, giving a score to each letter (a=1,b=2...), however, can't figure out how I would formulate the sumif.</p>\n\n<p>I have considered VBA to score each question one by one and them sum the total - however I feel this is very long winded.</p>\n\n<p>Example table (You may use '=CHAR(RANDBETWEEN(97,101))' in order to randomise the letters for each question)</p>\n\n<pre><code>Questionnaire / Question 1 / Question 2/ ... / Question 10\n1                 a            c                d\n2                 d            e                b\n...               ...          ...              ...\n20\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1554321082, "post_id": 55495093, "comment_id": 97712694, "body": "What do you want to happen if there are rows like 1/Dinner/OPA and a similar 1/Dinner/CLO -- where you have to figure out what do with the collision between OPA and CLO? \u2013 Ryan B. 1 min ago   Edit"}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1554321561, "post_id": 55495093, "comment_id": 97712934, "body": "And what version of excel are you using?"}, {"owner": {"reputation": 79, "user_id": 8012480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6405c239030dbdbc5ac0761f6e309452?s=128&d=identicon&r=PG&f=1", "display_name": "Karu3103", "link": "https://stackoverflow.com/users/8012480/karu3103"}, "reply_to_user": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1554338011, "post_id": 55495093, "comment_id": 97718172, "body": "The rate column can either be number or just text. There won&#39;t be any special characters in it. And I am using office 365"}], "answers": [{"tags": [], "owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1554394883, "creation_date": 1554394883, "answer_id": 55520783, "question_id": 55495093, "link": "https://stackoverflow.com/questions/55495093/use-pivot-table-so-that-i-can-still-get-the-text-values-and-a-way-to-split-the/55520783#55520783", "title": "Use pivot table so that I can still get the text values, and a way to split the data into multiple worksheets", "body": "<p>In Office 365, I'd take advantage of the pivot capabilities in Power Query rather than try to write VBA code.  If you're not familiar with power query, it will create set of reusable transformations, a lot like a macro.  But it's very much tuned for manipulating data sets and does this kind of work more effectively than macro scripts do.</p>\n\n<p>The one thing that this won't like work if you have more than one row with the same Id, Type, and department.  It won't do any aggregating and will just report an error on those rows. </p>\n\n<p>Assuming that many users aren't super familiar with Power query, I've made a step-by-step guide.  No offense intended if you're already used to this stuff.</p>\n\n<p>1) Convert the area where your raw data is to a data table by selecting the range and then clicking 'Format as Table' on the Styles group in the Home ribbon.</p>\n\n<p>[<img src=\"https://i.stack.imgur.com/aiuqw.png\" alt=\"1]\"></p>\n\n<p>2) Open the table in Power Query by having a cell in the table selected and then going to the Data ribbon, clicking 'From Table/Range' in the 'Get &amp; Transform Data' group.</p>\n\n<p>[<img src=\"https://i.stack.imgur.com/WerMK.png\" alt=\"2]\"></p>\n\n<p>3) Filter Department.  I'll be using 'Maint' for the examples.  Click on the black triangle filter just like you would for filters in regular worksheets.  </p>\n\n<p>4) Once we've done the filtering, we don't need the department column - it won't be in our final result.  So right click the column header and choose 'Remove.'</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ywmek.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ywmek.png\" alt=\"enter image description here\"></a></p>\n\n<p>5) Now the fun stuff.  First select the 'Type' column by clicking on the column header.  Then, navigate to the Transform Ribbon.  Find and click the 'Pivot column' button in the 'Any column' button group.  In the pop up, you will see the phrase \"Use the names in column \"Type\" to create new columns.\"  If some other column is specified, cancel, make sure you have Type highlighted, and click on pivot columns again.  Set the value columns to Rate, and under advanced options choose \"Don't aggregate\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/LOgPN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LOgPN.png\" alt=\"enter image description here\"></a></p>\n\n<p>and you should see the transformation!</p>\n\n<p><a href=\"https://i.stack.imgur.com/e6v2e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e6v2e.png\" alt=\"enter image description here\"></a></p>\n\n<p>Go back to the home tab, click 'Close and load' and the result will be added into a new worksheet.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/B2lKt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B2lKt.png\" alt=\"enter image description here\"></a></p>\n\n<p>So you can repeat this process for each department and get the tables you need.</p>\n\n<p>As you enter new rows into your raw data, the three dependent tables will be all updated with the new information when you click Refresh All on the data tab, when you open the spreadsheet, or you can select refresh from the right click context menu on each table.</p>\n"}], "owner": {"reputation": 79, "user_id": 8012480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6405c239030dbdbc5ac0761f6e309452?s=128&d=identicon&r=PG&f=1", "display_name": "Karu3103", "link": "https://stackoverflow.com/users/8012480/karu3103"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567642735, "creation_date": 1554294137, "last_edit_date": 1567642735, "question_id": 55495093, "link": "https://stackoverflow.com/questions/55495093/use-pivot-table-so-that-i-can-still-get-the-text-values-and-a-way-to-split-the", "title": "Use pivot table so that I can still get the text values, and a way to split the data into multiple worksheets", "body": "<p>I have data in Excel that needs to be pivoted, but it should retain text values in the pivot. The values should capture the text data in the Excel data set. Not sure if this can be achieved using pivot table or if I have to use any other method</p>\n\n<p>I have tried using pivot and use a slicer instead for department, but the column I am trying to bring under values, doesn't capture data that has text in it.</p>\n\n<p>Source Data:</p>\n\n<p><img src=\"https://i.stack.imgur.com/d2klH.png\" alt=\"Sample Input\"></p>\n\n<p>I need to separate this table into 3 tables (in different worksheets) based on the Department.</p>\n\n<p>1st worksheet should be for finance and expected output is:</p>\n\n<p><img src=\"https://i.stack.imgur.com/TF68r.png\" alt=\"Finance\"></p>\n\n<p>2nd worksheet should be for HR and expected output is:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1ClAl.png\" alt=\"HR\"></p>\n\n<p>3rd worksheet should be for Maint and expected output is:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Rqvmm.png\" alt=\"MAINT\"></p>\n\n<p>Can someone suggest what is the best way?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1554295324, "post_id": 55495080, "comment_id": 97697979, "body": "If someone would actually use a xlam file to troyan horse me with an executable I would kill him. I would stay away from that. If Microsoft isn&#39;t that stupid they would consider any files that include something irregular as not valid. Anyway here is the documentation: <a href=\"https://docs.microsoft.com/en-us/office/open-xml/understanding-the-open-xml-file-formats\" rel=\"nofollow noreferrer\">Understanding the Open XML file formats)</a>"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1554303489, "post_id": 55495080, "comment_id": 97703449, "body": "While it may not be useful in your case, it is possible to unhide a worksheet in an .xlam file, store information on it, hide it again and then use this information with vb."}], "owner": {"reputation": 2741, "user_id": 1697361, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/eRsV6.jpg?s=128&g=1", "display_name": "Bongo", "link": "https://stackoverflow.com/users/1697361/bongo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554294738, "creation_date": 1554294087, "last_edit_date": 1554294738, "question_id": 55495080, "link": "https://stackoverflow.com/questions/55495080/access-files-inside-xlam-addin", "title": "Access Files inside xlam Addin", "body": "<p>I have seen that xlam files contain directories etc. (I have unpacked it via 7Zip)\nIs it possible to store files inside of a xlam file and access those from vba?\nI was thinking to store a somewhat larger PowerShell script or an executable inside of the xlam file and then access it from vba. Is this possible and how can I define the path to the script/file?</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1554307670, "last_edit_date": 1554307670, "creation_date": 1554293112, "answer_id": 55494738, "question_id": 55494621, "link": "https://stackoverflow.com/questions/55494621/run-time-error-424-object-required-ie-document-getelementbyid/55494738#55494738", "title": "Run-time error &#39;424&#39;: Object Required IE.Document.GetElementById", "body": "<p>Use a timed loop for element to be present</p>\n\n<pre><code>Option Explicit\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\n'\nPublic Sub CommandButton1_Click()\n    Dim ie As New InternetExplorer, t As Date, ele As Object\n    Const MAX_WAIT_SEC As Long = 10\n\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.ryanair.com/be/nl/check-in\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        t = Timer\n        Do\n            On Error Resume Next\n            Set ele = .document.getElementById(\"username\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While ele Is Nothing\n\n        If ele Is Nothing Then Exit Sub\n\n        ele.Value = \"resa@connections.be\"\n\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554307766, "post_id": 55497432, "comment_id": 97706099, "body": "Hiya, What error did you receive? And on which line please?  I tested it and it ran fine. As far as I can see you have simply put this inside a click event which I admit I did miss (my bad!)  You need .Quit otherwise you will eventually run out of memory. Also, you need t = timer just before the Do. See my answer. In my answer you would remove the stop line."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1554315239, "post_id": 55497432, "comment_id": 97709775, "body": "Sounds good that you made a small change for that script to work @Merijn. But, which script you considered as a model to reach the conclusion? Try accepting the answer provided by QHarr. Thanks."}], "tags": [], "owner": {"reputation": 11, "user_id": 11305405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fac45875317c983b0ccdc46b3f1a813?s=128&d=identicon&r=PG&f=1", "display_name": "Merijn", "link": "https://stackoverflow.com/users/11305405/merijn"}, "is_accepted": false, "score": 0, "last_activity_date": 1554301307, "creation_date": 1554301307, "answer_id": 55497432, "question_id": 55494621, "link": "https://stackoverflow.com/questions/55494621/run-time-error-424-object-required-ie-document-getelementbyid/55497432#55497432", "title": "Run-time error &#39;424&#39;: Object Required IE.Document.GetElementById", "body": "<p>Thank you for the quick answer!  I just made small changes, as I received an error and I work with a button.  It works like a charm now!</p>\n\n<pre><code>Public Sub CommandButton1_Click()\n    Dim ie As New InternetExplorer, t As Date, ele As Object\n    Const MAX_WAIT_SEC As Long = 10\n    t = Timer\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.ryanair.com/be/nl/check-in\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Do\n            On Error Resume Next\n            Set ele = .document.getElementById(\"username\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While ele Is Nothing\n\n        If ele Is Nothing Then Exit Sub\n\n        ele.Value = \"resa@connections.be\"\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11305405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fac45875317c983b0ccdc46b3f1a813?s=128&d=identicon&r=PG&f=1", "display_name": "Merijn", "link": "https://stackoverflow.com/users/11305405/merijn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1554307670, "creation_date": 1554292731, "last_edit_date": 1554293125, "question_id": 55494621, "link": "https://stackoverflow.com/questions/55494621/run-time-error-424-object-required-ie-document-getelementbyid", "title": "Run-time error &#39;424&#39;: Object Required IE.Document.GetElementById", "body": "<p>I'm trying to auto-complete a form on a website with values of an excel file.</p>\n\n<pre><code>Sub CommandButton1_Click()\nDim IE As Object\nDim objElement As Object\nDim objCollection As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\nWith IE\n.Visible = True\n.navigate \"https://www.ryanair.com/be/nl/check-in\"\nEnd With\n\nDo Until IE.readyState = 4\nDoEvents\nLoop\n\n   IE.document.getElementbyid(\"username\").Value = \"resa@connections.be\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "oracle"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1554292301, "post_id": 55494383, "comment_id": 97696014, "body": "Check your database name, i.e. <code>sSource</code>. The drivers should be fine as you get an <b>Oracle</b> error, i.e. the DLL&#39;s have been loaded successfully. Do you use an <code>tnsnames.ora</code> file? Where is it located? Did you set <code>TNS_ADMIN</code> variable?"}, {"owner": {"reputation": 1, "user_id": 8729759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c47118d65626f969de31911cac3de0a?s=128&d=identicon&r=PG&f=1", "display_name": "user8729759", "link": "https://stackoverflow.com/users/8729759/user8729759"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1554623883, "post_id": 55494383, "comment_id": 97814351, "body": "@Wernfried Domscheit Thanks for your reply. i check the sSource again, which i confirm it&#39;s fine. Previously i use PROVIDER=msdaora with eSource and it was working fine for windows 7 + 32-bit. I was able to find tnsnames.ora file in C:\\app\\oracle &amp; C:\\app\\oracle_x86, but not sure how to use it. Not sure how to set tns_admin variable as well. Sorry think i am too noob in oracle."}, {"owner": {"reputation": 1, "user_id": 8729759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c47118d65626f969de31911cac3de0a?s=128&d=identicon&r=PG&f=1", "display_name": "user8729759", "link": "https://stackoverflow.com/users/8729759/user8729759"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1554624913, "post_id": 55494383, "comment_id": 97814630, "body": "I tried to add TNS_ADMIN in C:\\app\\oracle_x86\\product\\cl11gr2_std_x86\\network\\admin\\samp&zwnj;&#8203;le, but seems not working still...<a href=\"http://www-01.ibm.com/support/docview.wss?uid=swg21131629\" rel=\"nofollow noreferrer\">Setting the TNS_ADMIN environment variable</a>"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1554631024, "post_id": 55494383, "comment_id": 97815864, "body": "I doubt that the <b>sample</b> <code>tnsadmin.ora</code> file will work."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1554631399, "post_id": 55494383, "comment_id": 97815961, "body": "&quot;sSource&quot; is usually just an alias for the full database tns which is typically rather long and inconvenient, e.g. <code>(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.&zwnj;&#8203;168.1.0)(PORT=1521))&zwnj;&#8203;)(CONNECT_DATA=(SERV&zwnj;&#8203;ICE_NAME=ORA12)))</code>. These aliases are defined in your <code>tnsadmin.ora</code> file. When you say is was working with msdaora providers then it should be fine. Just point value of <code>TNS_ADMIN</code> variable to the location of your <code>tnsadmin.ora</code> file."}, {"owner": {"reputation": 1, "user_id": 8729759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c47118d65626f969de31911cac3de0a?s=128&d=identicon&r=PG&f=1", "display_name": "user8729759", "link": "https://stackoverflow.com/users/8729759/user8729759"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1554709447, "post_id": 55494383, "comment_id": 97835936, "body": "@Wernfried Domscheit I realised my system variable already set TNS_ADMIN in C:\\app\\oracle_x86. Is that for 64-Bit? Is there anyway i can skip tnsadmin.ora? Thanks a lot."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1554710964, "post_id": 55494383, "comment_id": 97836699, "body": "Well, if it is pointing to C:\\app\\oracle_<b>x86</b> then most likely it is 32-bit. However, <code>tnsnames.ora</code> is plain text file, it does not matter. Does this file contain the definition for <code>sSource</code>? Yes, you can skip the <code>tnsnames.ora</code> file, just put the full address (like <code>(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.&zwnj;&#8203;168.1.0)(PORT=1521))&zwnj;&#8203;)(CONNECT_DATA=(SERV&zwnj;&#8203;ICE_NAME=ORA12)))</code>) instead of the alias to your connection string."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8729759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c47118d65626f969de31911cac3de0a?s=128&d=identicon&r=PG&f=1", "display_name": "user8729759", "link": "https://stackoverflow.com/users/8729759/user8729759"}, "edited": false, "score": 0, "creation_date": 1554718568, "post_id": 55569192, "comment_id": 97840936, "body": "Thanks a lot, i am not sure why, but is really the sSource shall change. Not too sure why previously it works, changed to 64-bit the same name not working. Based on your detail explanation, I checked through tnsnames.ora and managed to find correct sSource. Really appreciated :)"}], "tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": false, "score": 0, "last_activity_date": 1554712299, "creation_date": 1554712299, "answer_id": 55569192, "question_id": 55494383, "link": "https://stackoverflow.com/questions/55494383/how-to-connect-oracle-database-using-64-bit-excel-in-windows-10/55569192#55569192", "title": "How to connect Oracle Database using 64-bit Excel in Windows 10", "body": "<p>Looks like you missed some basics, let's explain. When you want to connect to an Oracle database, no matter whether sqlplus or VBA or anything else then actually you would have to do it like this:</p>\n\n<pre><code>sqlplus MyUserName@(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.1.0)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=ORA12)))\n</code></pre>\n\n<p>However, nobody is willing or able to remember such a long and complex database name.\nSo, you would prefer to use an alias, i.e. a shortcut for <code>(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.1.0)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=ORA12)))</code></p>\n\n<p>There are different methods to define and resolve such aliases (see <a href=\"https://docs.oracle.com/cd/E11882_01/network.112/e41945/config_concepts.htm#NETAG003\" rel=\"nofollow noreferrer\">Managing Network Address Information</a>), the most common and easiest way is to use a local <code>tnsnames.ora</code> file.</p>\n\n<p>In your <code>tnsnames.ora</code> file you can add a line like this:</p>\n\n<pre><code>MY_DB=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.1.0)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=ORA12)))\n</code></pre>\n\n<p>Then you can connect to your database simply with</p>\n\n<pre><code>sqlplus MyUserName@MY_DB\n</code></pre>\n\n<p>Now the next question is: How does my application find the <code>tnsnames.ora</code> file on my system? The answer is not as trivial as you might assume, see <a href=\"https://stackoverflow.com/questions/28280883/determining-location-of-relevant-tnsnames-ora-file/28283924#28283924\">Determining location of relevant tnsnames.ora file</a></p>\n\n<p>The most secure solution is: Define an environment variable <code>TNS_ADMIN</code> and put as value the directory name where your <code>tnsnames.ora</code> file is located.</p>\n\n<p>Provider \"msdaora\" uses a different pattern to find the <code>tnsnames.ora</code> file than \"Oracle OLE DB\" provider does. msdaora finds your file, Oracle OLE DB does not. Settings an environment variables <code>TNS_ADMIN</code> makes it working for both.</p>\n"}], "owner": {"reputation": 1, "user_id": 8729759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c47118d65626f969de31911cac3de0a?s=128&d=identicon&r=PG&f=1", "display_name": "user8729759", "link": "https://stackoverflow.com/users/8729759/user8729759"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1950, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554712299, "creation_date": 1554291909, "last_edit_date": 1554292773, "question_id": 55494383, "link": "https://stackoverflow.com/questions/55494383/how-to-connect-oracle-database-using-64-bit-excel-in-windows-10", "title": "How to connect Oracle Database using 64-bit Excel in Windows 10", "body": "<p>I'm trying to connect my Excel to Oracle with this connection string in VBA:</p>\n\n<p>And I get error msg below:</p>\n\n<p>Run-time error '-2147467259 (800004005)':\nORA-12154: TNS:could not resolve the connect identifier specified</p>\n\n<p>Using:\n- Excel 2016 64-bit\n- Windows 10 64 bit\n- Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit\n- PL/SQL Release 12.1.0.2.0\n- CORE  12.1.0.2.0\n- TNS for Linux: Version 12.1.0.2.0\n- NLSRTL Version 12.1.0.2.0</p>\n\n<p>Excel 64-bit &amp; oracle is provided by company, hope can settle it without change excel to 32-bit. Any help will be appreciated. I actually already tried to settle it for two days and see no hope at all. Thanks for your time.</p>\n\n<p>Not sure if is the driver i used is 32-bit?\nMicrosoft ODBC for Oracle, MSORCL32.DLL\nOracle in Client_11_Std_x86_1, SQORA32.DLL</p>\n\n<pre><code>Dim cnPubs As ADODB.connection\nSet cnPubs = New ADODB.connection\nDim strConn As String\nWith cnPubs\n    strConn = \"Provider=OraOLEDB.Oracle;\" &amp; _\n    \"Data Source=\" &amp; sSource &amp; \";\" &amp; _\n    \"User ID=\" &amp; sAC &amp; \";Password=\" &amp; sPW &amp; \";\"\n\n    .Open strConn\n    .CommandTimeout = 0\nEnd With\n</code></pre>\n"}, {"tags": ["html", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1554372710, "post_id": 55494319, "comment_id": 97731394, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/191222/discussion-on-answer-by-qharr-select-given-value-from-dropdown-list-and-click-to\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1554363730, "last_edit_date": 1554363730, "creation_date": 1554291687, "answer_id": 55494319, "question_id": 55494217, "link": "https://stackoverflow.com/questions/55494217/select-given-value-from-dropdown-list-and-click-to-add-button/55494319#55494319", "title": "select given value from dropdown list and click to add button", "body": "<p>You can select a particular value by using attribute = value selector e.g.</p>\n\n<pre><code>ieApp.document.querySelector(\"[value='43.72.38.250&gt;11']\").Selected = True\n</code></pre>\n\n<p>You can also use index on the select element</p>\n\n<pre><code>ieApp.document.querySelector(\"#input_ifxlist_opts\").SelectedIndex = 2\n</code></pre>\n\n<p>You can click the button with an attribute = value selector using starts with ^ operator</p>\n\n<pre><code>ieApp.document.querySelector(\"[onclick^=addToList]\").click\n</code></pre>\n\n<hr>\n\n<p>You could use a more compact syntax for proper page waits:</p>\n\n<pre><code>While ieApp.Busy Or ieApp.readyState &lt; 4: DoEvents: Wend\n</code></pre>\n\n<hr>\n\n<p>You could also try:</p>\n\n<pre><code>ieApp.document.parentWindow.ExecScript \"document.forms ['queryform'].input_ifxlist.value='43.96.83.197&gt;11'\"\nieApp.document.querySelector(\"[onclick^=addToList]\").click\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11275824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081855225aa97bd88d9e9e2b56380005?s=128&d=identicon&r=PG&f=1", "display_name": "Ajinkya", "link": "https://stackoverflow.com/users/11275824/ajinkya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554363730, "creation_date": 1554291363, "last_edit_date": 1554291900, "question_id": 55494217, "link": "https://stackoverflow.com/questions/55494217/select-given-value-from-dropdown-list-and-click-to-add-button", "title": "select given value from dropdown list and click to add button", "body": "<p>I can login on my website then then navigate to a web page where I need to select a value from a drop down box then need to click on add button. (using <code>vba</code>). select given value from dropdown list and click to add button.</p>\n\n<p>I am not able to do that i have tried but unable to do that. </p>\n\n<p>my drop down list html code is:</p>\n\n<pre><code>&lt;select id=\"input_ifxlist_opts\"&gt;&lt;option value=\"43.66.18.70&gt;11\"&gt;SAL-EC-S1&amp;gt;sp_wan&lt;/option&gt;\n\n    &lt;option value=\"43.72.38.250&gt;11\"&gt;SDT-EC-S1&amp;gt;sp_wan&lt;/option&gt;\n    &lt;option value=\"43.95.88.9&gt;3\"&gt;SISC-CE2&amp;gt;Gi0/2&lt;/option&gt;\n    &lt;option value=\"43.95.88.5&gt;3\"&gt;SISC-CE1&amp;gt;Gi0/2&lt;/option&gt;\n    &lt;option value=\"43.88.32.237&gt;11\"&gt;SID-EC-S1&amp;gt;sp_wan&lt;/option&gt;\n    &lt;option value=\"43.95.74.54&gt;2\"&gt;SOEM_PG-CE1V.virtela.net&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.95.66.1&gt;2\"&gt;SAL-CE1&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.76.42.10&gt;2\"&gt;SEK-CE1V&amp;gt;Gi0/0&lt;/option&gt;\n    &lt;option value=\"43.95.94.5&gt;2\"&gt;SEV-CE2&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.95.78.9&gt;2\"&gt;SI-CE2&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.95.88.13&gt;3\"&gt;SID-CE1&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.95.76.5&gt;1\"&gt;SOK-CE1&amp;gt;Gi0/0&lt;/option&gt;\n    &lt;option value=\"43.95.86.9&gt;37\"&gt;SOMEA-CE1&amp;gt;Gi0/1.102&lt;/option&gt;\n    &lt;option value=\"43.95.92.9&gt;2\"&gt;SPH-CE1&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.95.70.2&gt;2\"&gt;STWN-CE1V&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.95.74.2&gt;3\"&gt;SOEM_KL-CE3&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.95.74.62&gt;2\"&gt;SOEM_KL-CE1V.virtela.net&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.95.74.46&gt;2\"&gt;SOMAS-CE1V&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.95.72.33&gt;2\"&gt;SDT-CE1.virtela.net&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.95.72.45&gt;2\"&gt;SOTHAI-CE&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.95.72.41&gt;2\"&gt;STT-CE1V.virtela.net&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.95.72.37&gt;2\"&gt;STTB-CE1.virtela.net&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.74.61.6&gt;11\"&gt;SOEM-PG-EC-S1&amp;gt;sp_wan&lt;/option&gt;\n    &lt;option value=\"43.95.92.2&gt;2\"&gt;SPHWNS-CE&amp;gt;Gi0/0/1&lt;/option&gt;\n    &lt;option value=\"43.95.65.1&gt;4\"&gt;GDC-CE1&amp;gt;Gi0/2&lt;/option&gt;\n    &lt;option value=\"43.72.61.5&gt;11\"&gt;SOTHAI-EC-S1&amp;gt;sp_wan&lt;/option&gt;\n    &lt;option value=\"146.215.74.110&gt;3\"&gt;IBP-CE1&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.95.86.9&gt;2\"&gt;SOMEA-CE1&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.95.88.5&gt;2\"&gt;SISC-CE1&amp;gt;Gi0/1&lt;/option&gt;\n    &lt;option value=\"43.95.88.9&gt;2\"&gt;SISC-CE2&amp;gt;Gi0/1&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>my add button html code is : </p>\n\n<pre><code>&lt;button type=\"button\" onclick=\"addToList(document.forms['queryform'].input_ifxlist,document.getElementById('input_ifxlist_opts'))\"&gt;Add&lt;/button&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>Sub login_page()\n    Dim ieApp As SHDocVw.InternetExplorer\n    Dim iedoc As MSHTML.HTMLDocument\n    'Dim ieApp As InternetExplorer\n    'Dim ieDoc As Object\n    'Dim ieTable As Object\n    'Dim clip As DataObject\n\n    Set ieApp = New SHDocVw.InternetExplorer\n\n    ieApp.Visible = True\n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop\n    Do Until ieApp.readyState = READYSTATE_COMPLETE: DoEvents: Loop\n\n    Set iedoc = ieApp.document\n\n    'fill in the login form \u2013 View Source from your browser to get the control names\n    With iedoc.forms(0)\n    .user.Value = \"id\"\n    .Password.Value = \"Pass\"\n    .submit\n\n    End With\n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop \n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop  \n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop\n\n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop\n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop \n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop\n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop\n\n    ieApp.navigate \"http:\"\n    Do While ieApp.Busy: DoEvents: Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31, "user_id": 11305000, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184478894955262/picture?type=large", "display_name": "Dasarathan Sampath", "link": "https://stackoverflow.com/users/11305000/dasarathan-sampath"}, "edited": false, "score": 0, "creation_date": 1554558831, "post_id": 55493837, "comment_id": 97800921, "body": "I found some programs in your website and other pages. I did some small changes and it worked well except some issues. I am unable to find a way to copy the Sheet header (First 5 lines) to new work book. Below the code I have used. can any one help me on this"}, {"owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "edited": false, "score": 0, "creation_date": 1556098127, "post_id": 55493837, "comment_id": 98318410, "body": "Hello Dasarathan Sampath, welcome to SO. Your code is very long, can&#39;t you simplify it and show us exactly where is the problem?"}, {"owner": {"reputation": 31, "user_id": 11305000, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184478894955262/picture?type=large", "display_name": "Dasarathan Sampath", "link": "https://stackoverflow.com/users/11305000/dasarathan-sampath"}, "reply_to_user": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "edited": false, "score": 0, "creation_date": 1558345744, "post_id": 55493837, "comment_id": 99057202, "body": "Hello Panda, I missed your message, Sorry. My issue got resolved. Thanks for your time."}], "owner": {"reputation": 31, "user_id": 11305000, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184478894955262/picture?type=large", "display_name": "Dasarathan Sampath", "link": "https://stackoverflow.com/users/11305000/dasarathan-sampath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556101663, "creation_date": 1554290101, "last_edit_date": 1556101663, "question_id": 55493837, "link": "https://stackoverflow.com/questions/55493837/excel-extract-data-into-new-workbook-based-on-a-column-values-and-the-new-work", "title": "Excel - Extract data into new workbook based on a column values and the new work books should have various sheets based on the another column values", "body": "<p>In my Work book, </p>\n\n<p>The first 5 rows are my sheet header.\n6th row is my table header having 10 columns. I have to create a new workbook based on the unique values in column D.</p>\n\n<p>The new work books should have Sheet header and Table values based on the filter from column D.</p>\n\n<p>Column D has \"Kitchen\", \"Living Room\", \"Bed Room\" &amp; \"Toilet\"\nColumn B has \"Panel Type A\", \"Panel Type B\", \"Panel Type c\" &amp; \"Panel Type D\"</p>\n\n<p>I need new work books named \"Kitchen\", \"Living Room\", \"Bed Room\" &amp; \"Toilet\"</p>\n\n<p>Each work book \nfirst sheet should have \"Sheet Header\" &amp; Visible Table Values filtered by column D and sort by Column B. \nSecond Sheet should have \"Sheet header\" &amp; visible table values filter by column B\nThird sheet should have Sheet headed &amp; visible table values filtered by column C</p>\n\n<p>And so on....</p>\n\n<p>Is there a Excel macro to do this?</p>\n\n<p>I used some codes from website and did some small changes. It works well, but I am unable to copy the Sheet header (First 5 lines) to my new works. can any one please help.</p>\n\n<p>Below is my code</p>\n\n<pre><code>Sub Copy_To_Workbooks()\n    Dim My_Range As Range\n    Dim copyRange As Range\n    Dim FieldNum As Long\n    Dim FileExtStr As String\n    Dim FileFormatNum As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n    Dim ws2 As Worksheet\n    Dim MyPath As String\n    Dim foldername As String\n    Dim Lrow As Long\n    Dim cell As Range\n    Dim CCount As Long\n    Dim WSNew As Worksheet\n    Dim ErrNum As Long\n\n    'Set filter range on ActiveSheet: A1 is the top left cell of your filter range\n    'and the header of the first column, D is the last column in the filter range.\n    'You can also add the sheet name to the code like this :\n    'Worksheets(\"Sheet1\").Range(\"A1:D\" &amp; LastRow(Worksheets(\"Sheet1\")))\n    'No need that the sheet is active then when you run the macro when you use this.\n    'Set My_Range = Range(\"A1:D\" &amp; LastRow(ActiveSheet))\n    Set My_Range = Range(\"A6:J\" &amp; LastRow(ActiveSheet))\n    My_Range.Parent.Select\n\n    If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new workbook\"\n        Exit Sub\n    End If\n\n    'This example filters on the first column in the range(change the field if needed)\n    'In this case the range starts in A so Field:=1 is column A, 2 = column B, ......\n    FieldNum = 4\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    'Set the file extension/format\n    If Val(Application.Version) &lt; 12 Then\n        'You use Excel 97-2003\n        FileExtStr = \".xls\": FileFormatNum = -4143\n    Else\n        'You use Excel 2007-2013\n        If ActiveWorkbook.FileFormat = 56 Then\n            FileExtStr = \".xls\": FileFormatNum = 56\n        Else\n            FileExtStr = \".xlsx\": FileFormatNum = 51\n        End If\n    End If\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n    'Delete the sheet RDBLogSheet if it exists\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Sheets(\"RDBLogSheet\").Delete\n    Application.DisplayAlerts = True\n    On Error GoTo 0\n\n    ' Add worksheet to copy/Paste the unique list\n    Set ws2 = Worksheets.Add(After:=Sheets(Sheets.Count))\n    ws2.Name = \"RDBLogSheet\"\n\n    'Fill in the path\\folder where you want the new folder with the files\n    'you can use also this \"C:\\Users\\Ron\\test\"\n    MyPath = Application.DefaultFilePath\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'Create folder for the new files\n    foldername = MyPath &amp; Format(Now, \"yyyy-mm-dd hh-mm-ss\") &amp; \"\\\"\n    MkDir foldername\n\n    With ws2\n        'first we copy the Unique data from the filter field to ws2\n        My_Range.Columns(FieldNum).AdvancedFilter _\n                Action:=xlFilterCopy, _\n                CopyToRange:=.Range(\"A3\"), Unique:=True\n        'My_Range.Columns(FieldNum).AdvancedFilter _\n                Action:=xlFilterCopy, _\n                CopyToRange:=.Range(\"F6\"), Unique:=True\n\n        'loop through the unique list in ws2 and filter/copy to a new sheet\n        Lrow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        For Each cell In .Range(\"A4:A\" &amp; Lrow)\n\n            'Filter the range\n            My_Range.AutoFilter field:=FieldNum, Criteria1:=\"=\" &amp; _\n             Replace(Replace(Replace(cell.Value, \"~\", \"~~\"), \"*\", \"~*\"), \"?\", \"~?\")\n\n            'Check if there are no more then 8192 areas(limit of areas)\n            CCount = 0\n            On Error Resume Next\n            CCount = My_Range.Columns(1).SpecialCells(xlCellTypeVisible) _\n                     .Areas(1).Cells.Count\n            On Error GoTo 0\n            If CCount = 0 Then\n                MsgBox \"There are more than 8192 areas for the value : \" &amp; cell.Value _\n                     &amp; vbNewLine &amp; \"It is not possible to copy the visible data.\" _\n                     &amp; vbNewLine &amp; \"Tip: Sort your data before you use this macro.\", _\n                       vbOKOnly, \"Split in worksheets\"\n            Else\n                'Add new workbook with one sheet\n                Set WSNew = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\n                'Copy/paste the visible data to the new workbook\n                'copyRange.SpecialCells(xlCellTypeVisible).Copy\n                My_Range.SpecialCells(xlCellTypeVisible).Copy\n                With WSNew.Range(\"A6\")\n                    ' Paste:=8 will copy the columnwidth in Excel 2000 and higher\n                    ' Remove this line if you use Excel 97\n                    .PasteSpecial Paste:=8\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                    .Select\n                    Click\n                End With\n\n                'Save the file in the new folder and close it\n                On Error Resume Next\n                WSNew.Parent.SaveAs foldername &amp; _\n                                    cell.Value &amp; FileExtStr, FileFormatNum\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    ErrNum = ErrNum + 1\n\n                    WSNew.Parent.SaveAs foldername &amp; _\n                     \"Error_\" &amp; Format(ErrNum, \"0000\") &amp; FileExtStr, FileFormatNum\n\n                    .Cells(cell.Row, \"B\").Formula = \"=Hyperlink(\"\"\" &amp; foldername &amp; _\n                      \"Error_\" &amp; Format(ErrNum, \"0000\") &amp; FileExtStr &amp; \"\"\")\"\n\n                    .Cells(cell.Row, \"A\").Interior.Color = vbRed\n                Else\n                    .Cells(cell.Row, \"B\").Formula = _\n                    \"=Hyperlink(\"\"\" &amp; foldername &amp; cell.Value &amp; FileExtStr &amp; \"\"\")\"\n                End If\n\n                WSNew.Parent.Close False\n                On Error GoTo 0\n            End If\n\n            'Show all the data in the range\n            My_Range.AutoFilter field:=FieldNum\n\n        Next cell\n        .Cells(1, \"A\").Value = \"Red cell: can't use the Unique name as file name\"\n        .Cells(1, \"B\").Value = \"Created Files (Click on the link to open a file)\"\n        .Cells(3, \"A\").Value = \"Unique Values\"\n        .Cells(3, \"B\").Value = \"Full Path and File name\"\n        .Cells(3, \"A\").Font.Bold = True\n        .Cells(3, \"B\").Font.Bold = True\n        .Columns(\"A:B\").AutoFit\n\n    End With\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    If ErrNum &gt; 0 Then\n        MsgBox \"Rename every WorkSheet name that start with \"\"Error_\"\" manually\" _\n             &amp; vbNewLine &amp; \"There are characters in the name that are not allowed\" _\n             &amp; vbNewLine &amp; \"in a sheet name or the worksheet already exist.\"\n    End If\n\n    'Restore ScreenUpdating, Calculation, EnableEvents, ....\n    My_Range.Parent.Select\n    ActiveWindow.View = ViewMode\n    ws2.Select\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlValues, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\nFunction Click()\n    Dim lr As Long\n    Dim ws As Worksheet\n    Dim vcol, i As Integer\n    Dim icol As Long\n    Dim myarr As Variant\n    Dim title As String\n    Dim copystart As Integer\n    Dim x As Long\n    vcol = 2 ' based on which column the split sheet to be created\n    Set ws = Sheets(\"Sheet1\")\n    ' Delet all sheet except sheet name BOM\n    Dim xWs As Worksheet\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    For Each xWs In Application.ActiveWorkbook.Worksheets\n        If xWs.Name &lt;&gt; \"Sheet1\" And xWs.Name &lt;&gt; \"ESTIMATION SUMMARY\" And xWs.Name &lt;&gt; \"Sheet Metal Std\" Then\n            xWs.Delete\n        End If\n    Next\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n    ' End of delete sheet\n\n    lr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row 'Returns last row\n    title = \"A6:O6\" ' Sets the title range\n    copystart = 1 ' in BOM sheet from where  to copy\n    icol = ws.Columns.Count ' End last column in BOM sheet 16384\n    ws.Cells(1, icol) = \"Unique\" ' Set text \"Unique at 16384th column\n    ' Find number of varient on column 5\n    For i = 7 To lr\n        On Error Resume Next\n                If ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\n         ws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\n        End If\n    Next\n    'End of \"Find number of varient on column 5\"\n    myarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\n    ws.Columns(icol).Clear\n\n    'Creating new Sheet based on column 5 and copy those values in that sheet\n    For i = 2 To UBound(myarr)\n        ws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\n        If Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\n         Sheets.Add(After:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\n        Else\n            Sheets(myarr(i) &amp; \"\").Move After:=Worksheets(Worksheets.Count)\n        End If\n        ws.Range(\"A\" &amp; copystart &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A1\")\n        Sheets(myarr(i) &amp; \"\").Columns.AutoFit\n        'x = Sheets(myarr(i) &amp; \"\").Cells(ws.Rows.Count, vcol).End(xlUp).Row 'Returns last row\n    Next\n    ws.AutoFilterMode = False\n    ws.Activate\n    ' End\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554292212, "post_id": 55493807, "comment_id": 97695951, "body": "Can you share the url? Or more of the html? Looks like jquery"}, {"owner": {"reputation": 1, "user_id": 11305122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bO94lDi-IAA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSWs2W8Of1nq8474-dy2JmOaGuSw/mo/photo.jpg?sz=128", "display_name": "Mouhsene Fri", "link": "https://stackoverflow.com/users/11305122/mouhsene-fri"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554364514, "post_id": 55493807, "comment_id": 97726379, "body": "Think you for help. I edit the question to give more explination."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11305122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bO94lDi-IAA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSWs2W8Of1nq8474-dy2JmOaGuSw/mo/photo.jpg?sz=128", "display_name": "Mouhsene Fri", "link": "https://stackoverflow.com/users/11305122/mouhsene-fri"}, "edited": false, "score": 0, "creation_date": 1554364408, "post_id": 55500092, "comment_id": 97726315, "body": "Think you for help.  I edit the question to give more explination,  when I use call:   Call webdriver.ExecuteScript(&quot;$(&#39;#form-classe&#39;).select2().val($(&#39;&zwnj;&#8203;#form-classe option:contains(&#39;texte)&#39;).val()).trigger(&#39;change&#39;);&quot;) I have the error bellow (&#39; Run Time &#39;17&#39; JavaScriptError missing ) after argument list)"}, {"owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "reply_to_user": {"reputation": 1, "user_id": 11305122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bO94lDi-IAA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSWs2W8Of1nq8474-dy2JmOaGuSw/mo/photo.jpg?sz=128", "display_name": "Mouhsene Fri", "link": "https://stackoverflow.com/users/11305122/mouhsene-fri"}, "edited": false, "score": 0, "creation_date": 1554382197, "post_id": 55500092, "comment_id": 97737449, "body": "the function .executeScript(Script,Arguments)  , webdriver is not understanding the Jquery , he is thinking that arguments is necessary to replace in some variable in the function. You can try to do it , with Original JS   document.getElementById(&#39;form-classe&#39;) and them run each options for each opt in  document.getElementById(&#39;form-classe&#39;).options    opt.selected = true &#39;and them after that  document.getElementById(&#39;form-classe&#39;).trigger(&#39;onchange&#39;)"}], "tags": [], "owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "is_accepted": false, "score": 0, "last_activity_date": 1554309152, "creation_date": 1554309152, "answer_id": 55500092, "question_id": 55493807, "link": "https://stackoverflow.com/questions/55493807/execute-script-in-vba-excel-selenium/55500092#55500092", "title": "Execute script in VBA Excel (selenium)", "body": "<p>What is the error ?\nWhere is the rest of code ? \nI can help you with more informations </p>\n\n<p>With Ie object should work..</p>\n\n<pre><code>dim ie as object\nset ie =createObject(\"InternetExplorer.Application\")\n'...ie.navigate ...\ncall ie.Document.parentWindow.execScript (\"$('#form-classe').select2().val($('#form-classe option:contains('texte)').val()).trigger('change');\")\n</code></pre>\n\n<p>Try calling it with CALL\ncall webdriver.ExecuteScript ()</p>\n"}], "owner": {"reputation": 1, "user_id": 11305122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bO94lDi-IAA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reSWs2W8Of1nq8474-dy2JmOaGuSw/mo/photo.jpg?sz=128", "display_name": "Mouhsene Fri", "link": "https://stackoverflow.com/users/11305122/mouhsene-fri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554331358, "creation_date": 1554290017, "last_edit_date": 1554331358, "question_id": 55493807, "link": "https://stackoverflow.com/questions/55493807/execute-script-in-vba-excel-selenium", "title": "Execute script in VBA Excel (selenium)", "body": "<p>I thank you infinitely</p>\n\n<p>the problem that the web application in which I want to run the script uses the form bootstrap, the latter is not compatible with the Internet Explore.\nthat's why I want to use selenium to excute the script \nthe code fonctionne perfectly when i execute code below in console element (inspect) </p>\n\n<pre><code>$('#form-classe').select2().val($('#form-classe option:contains(\"texte)\").val()).trigger('change');\n</code></pre>\n\n<p>the code allows to select the value \"text\" in the bootstrap form</p>\n\n<p>But the problem that i want to excute the code by VBA excel, I try to use the bellow selenium methode </p>\n\n<pre><code> Dim webdriver As New WebDriver  \nwebdriver.ExecuteScript \"$('#form-classe').select2().val($('#form-classe option:contains('texte)').val()).trigger('change');\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3564, "user_id": 3284713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f96b0e18df436dfccd3a204868942a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3284713/gio"}, "edited": false, "score": 0, "creation_date": 1554288918, "post_id": 55493361, "comment_id": 97693945, "body": "What have you tried so far? Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> and <a href=\"https://stackoverflow.com/help/mcve\">how to create a minimal, complete and verifiable example</a> and then improve your question =)"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1554289332, "post_id": 55493361, "comment_id": 97694194, "body": "First of all, this can easily be done with formulas. VBA is not required. Second,  you say <code>this is for Excel 365</code>, but what does that mean? Office 365 is a licensing contract you enter with Microsoft. Depending on what subscription you purchase you will be able to use Excel for Desktop and/or Excel Online. VBA will never run in Excel Online. Reading that you use the macro recorder means that you use Excel for desktop. So now you know that the macro recorder records literally,  .... see part 2"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1554289612, "post_id": 55493361, "comment_id": 97694352, "body": "part 2 .... And now you need to learn how to adjust that code to be applied dynamically in your context. There are many sources on the web that deal with that. You have not provided sufficient information to answer your question.   Step back from your coding dilemma and state what you want to achieve. Code may not be the best answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1554289654, "post_id": 55493361, "comment_id": 97694370, "body": "@teylyn i believe Excel 365 has extra formulas, e.g. <code>TEXTJOIN</code> or <code>CONCAT</code> or is that &quot;Excel 2016&quot; ?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1554290493, "post_id": 55493361, "comment_id": 97694885, "body": "@reportgunner I know that Office 365 has more features than boxed licenses but the question is not clear. Sometimes people think that Office 365 means Excel online only because their company has purchased an O365 license without desktop products. So &quot;we use Office 365&quot; does not tell me at all what product the questioner is using."}], "answers": [{"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1554290690, "post_id": 55493815, "comment_id": 97695005, "body": "why would you use VBA for that if it can be done with a formula?"}, {"owner": {"reputation": 186, "user_id": 11227098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0697934a5bacd3241d6ee5a815611a72?s=128&d=identicon&r=PG&f=1", "display_name": "brno", "link": "https://stackoverflow.com/users/11227098/brno"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1554290891, "post_id": 55493815, "comment_id": 97695126, "body": "@teylyn Whatever OP needs ... so I mentioned both :)"}], "tags": [], "owner": {"reputation": 186, "user_id": 11227098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0697934a5bacd3241d6ee5a815611a72?s=128&d=identicon&r=PG&f=1", "display_name": "brno", "link": "https://stackoverflow.com/users/11227098/brno"}, "is_accepted": false, "score": 3, "last_activity_date": 1554290418, "last_edit_date": 1554290418, "creation_date": 1554290035, "answer_id": 55493815, "question_id": 55493361, "link": "https://stackoverflow.com/questions/55493361/is-it-possible-to-create-a-macro-that-pulls-the-text-in-a-selected-cell-adds-it/55493815#55493815", "title": "Is it possible to create a macro that pulls the text in a selected cell, adds it to a file path, then makes cell a hyperlink to the specified file?", "body": "<p>If you put e. g. \"F003910\" in cell B4, then a manually entered formula beneath your cell could look like this:</p>\n\n<pre><code>=HYPERLINK(\"L:\\Docs\\Expenditure\\Purchase Orders\\\" &amp; LEFT(B4,5) &amp; \"XX\";\"link\")\n</code></pre>\n\n<p>And the result looks like this (in German Excel):\n<a href=\"https://i.stack.imgur.com/5GpcP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5GpcP.png\" alt=\"Screenshot2\"></a></p>\n\n<p>Example in VBA:</p>\n\n<pre><code>Private Sub TestMyHyperlink\n    Dim ws as Worksheet\n    Dim myCell as Range\n\n    Set ws = ActiveSheet\n    For each myCell in ws.Range(\"B4:B100\")\n        myCell.FormulaR1C1 = _\n        \"=HYPERLINK(\"\"L:\\Docs\\Expenditure\\Purchase Orders\\\"\" &amp; _\n        LEFT(RC[-1],5) &amp; \"\"XX\"\", _\n        \"\"link\"\")\"\n    Next myCell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1554290683, "post_id": 55493961, "comment_id": 97694998, "body": "why would you use VBA for that if it can be done with a formula?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1554290772, "post_id": 55493961, "comment_id": 97695055, "body": "Because the OP ask for a VBA code. <i>I&#39;m currently trying to create a macro</i>"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1554291117, "post_id": 55493961, "comment_id": 97695279, "body": "@teylyn i have also import an excel formula for  solution too."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1554291083, "last_edit_date": 1554291083, "creation_date": 1554290492, "answer_id": 55493961, "question_id": 55493361, "link": "https://stackoverflow.com/questions/55493361/is-it-possible-to-create-a-macro-that-pulls-the-text-in-a-selected-cell-adds-it/55493961#55493961", "title": "Is it possible to create a macro that pulls the text in a selected cell, adds it to a file path, then makes cell a hyperlink to the specified file?", "body": "<p>The below code get the value from Sheet1.range(\"A1\") create the path and import a hyperlink in Sheet1.range(\"B1\"). In both methods dont forget to change file extension. </p>\n\n<p><strong>VBA Code:</strong></p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim cValue As String, path As String\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        cValue = .Range(\"A1\").Value\n        path = \"L:\\Docs\\Expenditure\\Purchase Orders\\F0039XX\\\" &amp; cValue &amp; \".xls\" '\n\n        .Hyperlinks.Add Anchor:=.Range(\"B1\"), Address:=path, TextToDisplay:=path\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Excel Formula:</strong></p>\n\n<pre><code>=HYPERLINK(\"L:\\Docs\\Expenditure\\Purchase Orders\\F0039XX\\\" &amp; A1 &amp; \".xls\",A1 &amp; \" Location\")\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11304967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/576ec93b95f3be29d53bb801df976825?s=128&d=identicon&r=PG&f=1", "display_name": "benignByproduct", "link": "https://stackoverflow.com/users/11304967/benignbyproduct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 55493961, "answer_count": 2, "score": 0, "last_activity_date": 1554291083, "creation_date": 1554288592, "question_id": 55493361, "link": "https://stackoverflow.com/questions/55493361/is-it-possible-to-create-a-macro-that-pulls-the-text-in-a-selected-cell-adds-it", "title": "Is it possible to create a macro that pulls the text in a selected cell, adds it to a file path, then makes cell a hyperlink to the specified file?", "body": "<p>I'm completely new to using VBA in Excel apart from simple recorded macros. I'm currently trying to create a macro to automatically link a cell to a corresponding file based on its contents, for example: a cell contains an order number 'F003910', and the order form is located in 'L:\\Docs\\Expenditure\\Purchase Orders\\F0039XX'.</p>\n\n<p>I was hoping to set it up to copy the contents of the cell and create a hyperlink to the file path with the cell's text pasted on the end, which will match the file name.</p>\n\n<p>This is for Excel 365. I've attempted to record the macro and copy and paste as part of that, but it simply saves the text from when the macro was first made rather than pulling from the selected cell.</p>\n\n<p>I realise this might not even be possible, but any advice would be massively appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1554288470, "post_id": 55493268, "comment_id": 97693635, "body": "Related: <a href=\"https://stackoverflow.com/a/55381841/10540017\">stackoverflow.com/a/55381841/10540017</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1554289099, "post_id": 55493268, "comment_id": 97694055, "body": "Put everything in an array, do the processing there, and write back to the sheet when done."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1554290026, "post_id": 55493268, "comment_id": 97694574, "body": "I don&#39;t know if it would be faster, but have you tried an <code>Advanced Filter</code>? One of the output options is to write the results to a different location. And if it is fastest, you could code it in VBA if you want to."}], "answers": [{"comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1554293417, "post_id": 55493607, "comment_id": 97696725, "body": "WOW dude, this is great. Thank you!"}], "tags": [], "owner": {"reputation": 2371, "user_id": 221166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c960c48d6b9b46b82635839ed4ef5814?s=128&d=identicon&r=PG", "display_name": "Torben Klein", "link": "https://stackoverflow.com/users/221166/torben-klein"}, "is_accepted": true, "score": 4, "last_activity_date": 1554289348, "creation_date": 1554289348, "answer_id": 55493607, "question_id": 55493268, "link": "https://stackoverflow.com/questions/55493268/fastest-way-to-transfer-large-amounts-of-data-between-worksheets/55493607#55493607", "title": "Fastest way to transfer large amounts of data between worksheets", "body": "<p>Accessing a range is abysmally slow, and the cause for your long runtime. If you already know that you are going to read 1000 rows, do not read them one at a time. Instead, pull the whole range in a buffer, then work only with that buffer. Same goes for writing. If you do not know in advance how much you will write, make chunks of e.g. 100 rows length.</p>\n\n<p>(<s>Untested</s>) example:</p>\n\n<pre><code>Sub PleaseWork()\n\n    Dim i As Long, j as long\n    Dim lRow1 As Long, lRow2 As Long\n    Dim myCol As New Collection\n    Dim column_p() as variant\n    dim inbuffer() as Variant\n    dim outbuffer() as variant\n\n    lRow1 = wsOTS.Range(\"E\" &amp; wsOTS.Rows.Count).End(xlUp).Row\n    ' Get whole Column P at once\n    column_p = wsOTS.Range(\"P1\").Resize(lRow1, 1).Value\n\n    'build collection of row numbers\n    For i = 1 To lRow1\n        If column_p(i, 1) = \"Y\" Then\n            myCol.Add i\n        End If\n    Next i\n\n    'now go through collection and build TTS\n    lRow2 = myCol.Count 'Number of required rows\n    ' get whole input range\n    inbuffer = wsOTS.Range(\"E1\").Resize(lRow1, 10).Value\n    ' prepare output\n    ReDim outbuffer(1 to lRow2, 1 to 10)\n    For i = 1 To myCol.Count\n        ' write into outbuffer\n        for j = 1 to 10\n            outbuffer(i, j) = inbuffer(myCol(i), j)\n        Next\n    Next i\n\n    ' Set whole output at once\n    wsTTS.Range(\"E1\").Resize(lRow2, 10).Value = outbuffer\n\n    Set myCol = New Collection\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554290695, "post_id": 55493987, "comment_id": 97695011, "body": "In his code you can see clearly he is trying to get some rows which contain certain criteria on a given cell. Your answer won&#39;t help in any way to the OP&#39;s question."}, {"owner": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554291050, "post_id": 55493987, "comment_id": 97695236, "body": "in his explanation in the first para, he didn&#39;t mention it. excuse my oversight."}], "tags": [], "owner": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "is_accepted": false, "score": -1, "last_activity_date": 1554290601, "creation_date": 1554290601, "answer_id": 55493987, "question_id": 55493268, "link": "https://stackoverflow.com/questions/55493268/fastest-way-to-transfer-large-amounts-of-data-between-worksheets/55493987#55493987", "title": "Fastest way to transfer large amounts of data between worksheets", "body": "<p>did you consider using <strong>Remove Duplicates</strong>.</p>\n\n<p>Steps:</p>\n\n<ul>\n<li>Copy entire data to a new sheet </li>\n<li>On Data tab, choose Remove duplicates</li>\n</ul>\n\n<p>You can record this as a macro as well.\n<a href=\"https://i.stack.imgur.com/wDDf7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wDDf7.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55493607, "answer_count": 2, "score": 0, "last_activity_date": 1554291324, "creation_date": 1554288305, "last_edit_date": 1554291324, "question_id": 55493268, "link": "https://stackoverflow.com/questions/55493268/fastest-way-to-transfer-large-amounts-of-data-between-worksheets", "title": "Fastest way to transfer large amounts of data between worksheets", "body": "<p>I currently have 2 worksheets, for simplicity sake let's call them <code>Sheet1</code> and <code>Sheet2</code> in the explanations. In <code>Sheet1</code> I have around 50k rows of data. I am trying to go through <code>Sheet1</code> and find unique occurrences in the data set to then transfer across to <code>Sheet2</code>. </p>\n\n<p>Below are the methods I have used so far and their rough estimates for time taken. </p>\n\n<p>Method A - Iterate through <code>Sheet1</code> with a <code>For</code> loop with the conditional check programmed in VBA, if condition is met - transfer a range of 8 cells on that row to <code>Sheet2</code>. This method completes 60% in 60 minutes.</p>\n\n<p>Method B - I thought that removing the condition check in VBA could speed things up so I created a new column in <code>Sheet1</code> with an <code>IF</code> statement that returns \"Y\" if the condition is met. I then iterate through this column and if there is a \"Y\" - transfer the occurrence across to <code>Sheet2</code>. This weirdly takes longer than method A, namely 50% in 60 mins. </p>\n\n<pre><code>Sub NewTTS()\n\nDim lRow1 As Long, lRow2 As Long\nDim i As Long\n\nWith wsOTS\n\n    lRow1 = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row\n\n    For i = lRow1 To 2 Step -1\n        If .Range(\"P\" &amp; i).Text = \"Y\" Then\n            lRow2 = wsTTS.Range(\"E\" &amp; wsTTS.Rows.Count).End(xlUp).Row + 1\n\n            wsTTS.Range(\"E\" &amp; lRow2, \"AA\" &amp; lRow2).Value = .Range(\"E\" &amp; i, \"AA\" &amp; i).Value\n        End If\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Method C - I then read on another post that the <code>.Find()</code> method is quicker than using <code>For</code> loop method. As such I used a <code>.Find()</code> in the column that returns the \"Y\" and then transfer event across to <code>Sheet2</code>. This is the fastest method so far but still only completes 75% in 60 mins. </p>\n\n<pre><code>Sub SearchOTS()\n\nApplication.ScreenUpdating = False\n\nDim startNumber As Long\nDim lRow1 As Long, lRow2 As Long\nDim i As Long\nDim startTime As Double\n\nstartTime = Time\n\nlRow1 = wsOTS.Range(\"E\" &amp; wsOTS.Rows.Count).End(xlUp).Row\n\nColumns(\"P:P\").Select\n\nSelection.Find(What:=\"Y\", After:=ActiveCell, LookIn:=xlValues, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False).Activate\n\nstartNumber = ActiveCell.Row\n\nlRow2 = wsTTS.Range(\"E\" &amp; wsTTS.Rows.Count).End(xlUp).Row + 1\n\nwsTTS.Range(\"E\" &amp; lRow2, \"AA\" &amp; lRow2).Value = wsOTS.Range(\"E\" &amp; ActiveCell.Row, \"AA\" &amp; ActiveCell.Row).Value\n\nFor i = 1 To lRow1\n    Selection.FindNext(After:=ActiveCell).Activate\n\n    If ActiveCell.Row = startNumber Then GoTo ProcessComplete\n\n    lRow2 = wsTTS.Range(\"E\" &amp; wsTTS.Rows.Count).End(xlUp).Row + 1\n\n    wsTTS.Range(\"E\" &amp; lRow2, \"AA\" &amp; lRow2).Value = wsOTS.Range(\"E\" &amp; ActiveCell.Row, \"AA\" &amp; ActiveCell.Row).Value\n\n    wsOTS.Range(\"B18\").Value = i / lRow1\nNext i\n\nProcessComplete:\n\nApplication.ScreenUpdating = True\nMsgBox \"Complete! Time taken: \" &amp; Format(Time - startTime, \"hh:mm:ss\")\n\nEnd Sub\n</code></pre>\n\n<p>Method D - I then read another post saying that the fastest way would be to build an array and then loop through the array. Instead of an array I used a collection (dynamic), and I iterate through <code>Sheet1</code> and store the row numbers for the occurences. I then loop through the collection and transfer the events across to <code>Sheet2</code>. This method returns 50% in 60 mins. </p>\n\n<pre><code>Sub PleaseWork()\n\nDim i As Long\nDim lRow1 As Long, lRow2 As Long\nDim myCol As New Collection\n\nlRow1 = wsOTS.Range(\"E\" &amp; wsOTS.Rows.Count).End(xlUp).Row\n\n'build collection of row numbers\nFor i = 1 To lRow1\n    If wsOTS.Range(\"P\" &amp; i).Text = \"Y\" Then\n        myCol.Add i\n    End If\nNext i\n\n'now go through collection and build TTS\nFor i = 1 To myCol.Count\n    lRow2 = wsTTS.Range(\"E\" &amp; wsTTS.Rows.Count).End(xlUp).Row + 1\n    wsTTS.Range(\"E\" &amp; lRow2, \"N\" &amp; lRow2).Value = wsOTS.Range(\"E\" &amp; myCol(i), \"N\" &amp; myCol(i)).Value\nNext i\n\nSet myCol = New Collection\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to find the fastest way to complete this task but all the methods I have tried are yielding greater than an hour to complete. </p>\n\n<p>Is there anything I am missing here? Is there a faster method?</p>\n"}, {"tags": ["c#", "excel", "vba", "vsto"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1554288000, "post_id": 55493022, "comment_id": 97693375, "body": "OleDbConnection is a common way to do this, what specific issues does that code have? (What&#39;s the reason for not wanting to read directly via interop+Excel.Application?)"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1554288206, "post_id": 55493022, "comment_id": 97693487, "body": "Doublechecked that <code>fileName</code> is correct? Especially the backslash?"}, {"owner": {"reputation": 55, "user_id": 11303234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVPQi.jpg?s=128&g=1", "display_name": "Courtland9777", "link": "https://stackoverflow.com/users/11303234/courtland9777"}, "edited": false, "score": 0, "creation_date": 1554289175, "post_id": 55493022, "comment_id": 97694099, "body": "The exception I receive is &quot;System.Data.OleDb.OleDbException: &#39;The Microsoft Access database engine could not find the object &#39;Newborns_3$&#39;.&quot; The worksheet is there. The reason for not using the interop is it takes quite a long time to open up multiple workbooks."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 11303234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVPQi.jpg?s=128&g=1", "display_name": "Courtland9777", "link": "https://stackoverflow.com/users/11303234/courtland9777"}, "edited": false, "score": 0, "creation_date": 1554294250, "post_id": 55493294, "comment_id": 97697309, "body": "I gave this a try. When creating the new OleDbDataAdapter I keep getting an exception that the Microsoft Access database engine could not find the object &#39;Newborns_3$&#39;. this is the correct name of the worksheet I am looking for."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 55, "user_id": 11303234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVPQi.jpg?s=128&g=1", "display_name": "Courtland9777", "link": "https://stackoverflow.com/users/11303234/courtland9777"}, "edited": false, "score": 0, "creation_date": 1554297266, "post_id": 55493294, "comment_id": 97699272, "body": "I tried it and it is working fine for me. See the above post. I updated it with the code that I tried."}, {"owner": {"reputation": 55, "user_id": 11303234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVPQi.jpg?s=128&g=1", "display_name": "Courtland9777", "link": "https://stackoverflow.com/users/11303234/courtland9777"}, "edited": false, "score": 0, "creation_date": 1554301969, "post_id": 55493294, "comment_id": 97702315, "body": "Thank you very much for your assistance. Your code is correct. I was getting the error because there are no space allowed anywhere in the file path. Once I changed the folder name that contained the space the issue was resolved."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1554297212, "last_edit_date": 1554297212, "creation_date": 1554288369, "answer_id": 55493294, "question_id": 55493022, "link": "https://stackoverflow.com/questions/55493022/assistance-opening-a-connection-from-c-vsto-excel-project-to-a-closed-xlsx-fil/55493294#55493294", "title": "Assistance opening a connection from C# VSTO Excel project to a closed .xlsx file (w/o opening the .xlsx file)", "body": "<blockquote>\n  <p>The workbooks that are being read from need to remain closed.</p>\n</blockquote>\n\n<p>Try this basic function that I quickly wrote.  This is in VB.Net.</p>\n\n<p><code>xlsFile</code> is the closed excel file name with path and <code>ShName</code> is the sheet name.</p>\n\n<pre><code>Private Function LoadFromFile(xlsFile As String, ShName As String) As DataTable\n    Dim dt As DataTable = Nothing\n\n    '~~&gt; Get the file data in the datatable\n    Try\n        '~~&gt; Get data from file\n        Using MyConnection As New System.Data.OleDb.OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp;\n                                                          xlsFile &amp;\n                                                          \";Extended Properties=\"\"Excel 12.0;HDR=No;IMEX=1\"\"\")\n            MyConnection.Open()\n\n            Dim SheetName As String = ShName &amp; \"$\"\n\n            Using MyCommand As New OleDb.OleDbDataAdapter(\"select * from [\" &amp; SheetName &amp; \"]\", MyConnection)\n                dt = New DataTable\n                MyCommand.Fill(dt)\n            End Using\n        End Using\n    Catch ex As Exception\n        MessageBox.Show(ex.Message, \"System Error\", MessageBoxButtons.OK, MessageBoxIcon.Error)\n    End Try\n\n    Return dt\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>Access database engine could not find the object 'Newborns_3$'. this is the correct name of the worksheet I am looking for. \u2013 Courtland9777 48 mins ago</p>\n</blockquote>\n\n<p><strong>Tried and Tested</strong></p>\n\n<pre><code>Public Class Form1\n\n    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n        Dim tmpdt As DataTable\n\n        tmpdt = LoadFromFile(\"C:\\Users\\routs\\Desktop\\book1.xlsx\", \"Newborns_3\")\n\n        MessageBox.Show (tmpdt.Rows.Count)\n    End Sub\n\n    Private Function LoadFromFile(xlsFile As String, ShName As String) As DataTable\n        Dim dt As DataTable = Nothing\n\n        '~~&gt; Get the file data in the datatable\n        Try\n            '~~&gt; Get data from file\n            Using MyConnection As New System.Data.OleDb.OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp;\n                                                              xlsFile &amp;\n                                                              \";Extended Properties=\"\"Excel 12.0;HDR=No;IMEX=1\"\"\")\n                MyConnection.Open()\n\n                Dim SheetName As String = ShName &amp; \"$\"\n\n                Using MyCommand As New OleDb.OleDbDataAdapter(\"select * from [\" &amp; SheetName &amp; \"]\", MyConnection)\n                    dt = New DataTable\n                    MyCommand.Fill (dt)\n                End Using\n            End Using\n        Catch ex As Exception\n            MessageBox.Show(ex.Message, \"System Error\", MessageBoxButtons.OK, MessageBoxIcon.Error)\n        End Try\n\n        Return dt\n    End Function\nEnd Class\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11303234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVPQi.jpg?s=128&g=1", "display_name": "Courtland9777", "link": "https://stackoverflow.com/users/11303234/courtland9777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 55493294, "answer_count": 1, "score": 4, "last_activity_date": 1554297212, "creation_date": 1554287567, "last_edit_date": 1554287853, "question_id": 55493022, "link": "https://stackoverflow.com/questions/55493022/assistance-opening-a-connection-from-c-vsto-excel-project-to-a-closed-xlsx-fil", "title": "Assistance opening a connection from C# VSTO Excel project to a closed .xlsx file (w/o opening the .xlsx file)", "body": "<p>I am trying to convert an Excel AddIn I wrote in VBA into a C# VSTO. Being fairly new to C# and VS this seemed like a good way to expand my skills without having to come up with a new project idea.</p>\n\n<p>One of the features of the original AddIn is it can read multiple closed .xlsx workbooks into memory, do some basic math and output the new data into a new workbook. Originally, this was achieved utilizing an Adodb.Connection.  Currently, I am unable to replicate the connection to the workbooks in the VSTO AddIn.</p>\n\n<p>The workbooks that are being read from need to remain closed. Each workbook has three to five worksheets but I only require data from one of them that has a static name. The columns have headers but they are not very friendly headers like, \"Exclusive?  (1=Yes, 0=No)\" or \"Discharge Date|Time Display\". The column names are static but the columns numbers are not. Also, I am only dealing with small amounts of data in each workbook.</p>\n\n<p>So far I have looked at a few different options. LinqToExcel looked promising but fell short because of the horrible column names I am working with. I have also attempted to use an OleDbConnection as well as an Adodb.connection with little success. </p>\n\n<p>This is the code that is successful in VBA.</p>\n\n<pre><code>    'Connection\n    Dim Cnx As ADODB.Connection: Set Cnx = New ADODB.Connection\n    With Cnx\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n        .ConnectionString = \"Data Source=\" &amp; fileToCopy &amp; _\n           \";Extended Properties='Excel 12.0 xml;HDR=Yes;IMEX=1;Readonly=False'\"\n        .Open\n    End With\n\n    'Command String\n    Dim headerString As String, request_SQL As String\n    headerString = \"[\" &amp; FullName &amp; \"],\" &amp; \"[\" &amp; MRN &amp; \"],\" &amp; \"[\" &amp; OHFColumnName &amp; \"],\" &amp; \"[\" &amp; STSColumnName &amp; \"],\" &amp; \"[\" &amp; IRColumnName &amp; \"],\" &amp; \"[\" &amp; ERColumnName &amp; \"]\"\n    request_SQL = \"SELECT \" &amp; headerString &amp; \" FROM [\" &amp; NewbornsWS &amp; \"$] WHERE [\" &amp; FullName &amp; \"] IS NOT NULL OR [\" &amp; OHFColumnName &amp; \"] IS NOT NULL;\"\n\n    'Create RecordSet\n    Dim Rst As ADODB.Recordset: Set Rst = New ADODB.Recordset\n    If OpenRecordset(Rst, request_SQL, Cnx) Then\n        Err.Raise vbObjectError + 518, Description:=Error518\n    End If\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Private Function OpenRecordset(ByRef Rst As ADODB.Recordset, ByVal request_SQL As String, ByRef Cnx As ADODB.Connection) As Boolean\n    'Error Trapping for the RecordSet\n    myCallStack.Push \"MonthStats.OpenRecordset\"\n    Dim backupRequestString As String\n    On Error Resume Next\n    Rst.Open request_SQL, Cnx, adOpenStatic, adLockReadOnly, adCmdText\n    If Err.Number = 0 Then\n        OpenRecordset = False\n        myCallStack.Pop\n        Exit Function\n    Else\n        Rst.Close\n        OpenRecordset = True\n        myCallStack.Pop\n        Exit Function\n    End If\n    myCallStack.Pop\nEnd Function\n</code></pre>\n\n<p>Failed Attempts:</p>\n\n<p>My attempt to utilize Adodb in C#. This fails @ cnx.Open(connectionString);. </p>\n\n<pre><code>using ADODB;\n\n internal static BreastFeedingData GetXlFileData(string fileName)\n        {\n            try\n            {\n                string connectionString = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" + fileName +\n                    \";Extended Properties='Excel 12.0 xml;HDR=Yes;IMEX=1;Readonly=False'\";\n                Connection cnx = new Connection();\n                cnx.Open(connectionString);\n\n                Recordset rst = new Recordset();\n\n                string headerString = $\"[{MFullName}], [{MMRN}], [{MDDColumName}], [{MOHFColumnName}], [{MSTSColumnNameV}], [{MSTSColumnNameC}], [{MIRColumnName}], [{MERColumnName}]\";\n                string request_SQL = $\"SELECT {headerString} FROM [{MNewbornsWS}$] WHERE [{MFullName}] IS NOT NULL OR [{MOHFColumnName}] IS NOT NULL;\";\n\n                rst.Open(request_SQL, cnx, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly, 1);\n                BreastFeedingData breastFeedingData = ReadFromData(rst);\n                rst.Close();\n                return breastFeedingData;\n            }\n            catch (System.Runtime.InteropServices.COMException)\n            {\n                throw;\n            }\n        }\n</code></pre>\n\n<p>I also attempted this as well and ran into issues @ cmd.Fill(excelDataSet);</p>\n\n<pre><code>private static TStats GetOpenXlFileData(DateTime dateTime, string fileName)\n        {\n            string connectionString = string.\n                Format(\"Provider=Microsoft.ACE.OLEDB.12.0; data source={0}; \" +\n                \"Extended Properties='Excel 12.0; HDR = Yes; IMEX = 1; Readonly = False'\", fileName);\n\n            OleDbConnection con = new System.Data.OleDb.OleDbConnection(connectionString);\n\n            string headerString = $\"[{MFullName}], [{MMRN}], [{MOHFColumnName}], [{MSTSColumnNameV}], [{MSTSColumnNameC}], [{MIRColumnName}], [{MERColumnName}]\";\n            string request_SQL = string.Format(\"SELECT {0} FROM [{1}$] WHERE [{2}] IS NOT NULL OR [{3}] IS NOT NULL;\",\n                headerString, MNewbornsWS, MFullName, MOHFColumnName);\n\n            OleDbDataAdapter cmd = new System.Data.OleDb.OleDbDataAdapter(request_SQL, con);\n\n            con.Open();\n            System.Data.DataSet excelDataSet = new DataSet();\n            cmd.Fill(excelDataSet);\n            DataTable data = excelDataSet.Tables[0];\n            TStats stats = ReadFromData(data, dateTime);\n            con.Close();\n            return stats;\n        }\n</code></pre>\n\n<p>I am not sure if my issue is in my code itself or in my VS setup. Please let me know if more information is required. Thank you in advance for any assistance you might have in helping me resolve this issue.</p>\n"}, {"tags": ["excel", "vba", "outlook", "reminders"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554289566, "post_id": 55492952, "comment_id": 97694317, "body": "Which column has the date?"}, {"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554292417, "post_id": 55492952, "comment_id": 97696093, "body": "Hi, the column where I would like to check if there is a date is column 12, if there is a date (must be an actual date, not a header etc.) in that cell then the reminder would be created for that date."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554292581, "post_id": 55492952, "comment_id": 97696187, "body": "Simply put your code between <code>If IsDate(.Cells(i, 12).Value) Then</code> and <code>End If</code>"}, {"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554298102, "post_id": 55492952, "comment_id": 97699787, "body": "At the moment I have the macro inserting &quot;added&quot; into column 13, i then uses this to determine if the reminder has already been set, and stops duplication. How would I also incorporate that? Thanks so much in advance"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554298467, "post_id": 55492952, "comment_id": 97700029, "body": "<code>If IsDate(.Cells(i, 12).Value) And Ucase(Trim(.Cells(i, 13).Value)) &lt;&gt; &quot;ADDED&quot; Then</code>"}, {"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554300025, "post_id": 55492952, "comment_id": 97701040, "body": "Hi Siddarth, thanks for the assistance, but that doesn&#39;t seem to work. It causes issues with the rest of the code... such as the &#39;Loop&#39; and &#39;DoUntil&#39; etc. Perhaps I need to completely re-write the code?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554300431, "post_id": 55492952, "comment_id": 97701305, "body": "Yes. <b>1.</b> Find the last row in Column 12. See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">This</a>  <b>2.</b> Use a For Loop to loop though Col 12 and use the <code>IF</code> condition that I gave above."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1554710617, "post_id": 55499097, "comment_id": 97836528, "body": "Hi reFractil, thanks for the help. Is there anyway I could have it not run Do Until Trim(Cells(i, 1).Value) = &quot;&quot;, and just look in column 12 and 13 - if there is a date in there, and no &quot;added&quot; in column 13 then it runs the macro?  At the moment I have to have &#39;dummy&#39; text in column 1 to make the macro work. Thanks in advance!"}, {"owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "reply_to_user": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1554728783, "post_id": 55499097, "comment_id": 97847085, "body": "@Mr_Col, I have edited my answer, hope it helps if not let me know and I&#39;ll look into other options. ;)"}, {"owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "edited": false, "score": 0, "creation_date": 1554803095, "post_id": 55499097, "comment_id": 97876399, "body": "that works an absolute treat - thank you so much for your help!!"}], "tags": [], "owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "is_accepted": true, "score": 0, "last_activity_date": 1554728675, "last_edit_date": 1554728675, "creation_date": 1554306002, "answer_id": 55499097, "question_id": 55492952, "link": "https://stackoverflow.com/questions/55492952/creating-reminders-in-outlook-from-an-excel-sheet-ignoring-blank-cells/55499097#55499097", "title": "Creating reminders in Outlook from an Excel sheet ignoring blank cells", "body": "<p>Like Siddharth suggested, and If stament in the right place should do the trick... </p>\n\n<p>Give it a try to this...</p>\n\n<pre><code>Option Explicit\nPublic Sub CreateOutlookApptz()\n\n   Sheets(\"Invoicing Schedule\").Select\n    On Error GoTo Err_Execute\n\n    Dim olApp As Outlook.Application\n    Dim olAppt As Outlook.AppointmentItem\n    Dim blnCreated As Boolean\n    Dim olNs As Outlook.Namespace\n    Dim CalFolder As Outlook.MAPIFolder\n    Dim arrCal As String\n\n    Dim i As Long\n\n    On Error Resume Next\n    Set olApp = Outlook.Application\n\n    If olApp Is Nothing Then\n        Set olApp = Outlook.Application\n         blnCreated = True\n        Err.Clear\n    Else\n        blnCreated = False\n    End If\n\n    On Error GoTo 0\n\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n    Set CalFolder = olNs.GetDefaultFolder(olFolderCalendar)\n\n    i = 1\nDo Until Trim(Cells(i, 1).Value) = \"\"\n\n'IF Validation for Col 12 and 13    \nIf IsDate(Cells(i, 12)) And Ucase(Trim(Cells(i, 13))) &lt;&gt; \"ADDED\" Then\n\n    arrCal = Cells(i, 1)\n\n    Set olAppt = CalFolder.Items.Add(olAppointmentItem)\n\n    'MsgBox subFolder, vbOKCancel, \"Folder Name\"\n\n    With olAppt\n\n    'Define calendar item properties\n        .Start = Cells(i, 12) + TimeValue(\"9:00:00\")\n        .End = Cells(i, 12) + TimeValue(\"10:00:00\")\n\n\n        .Subject = \"Invoice Reminder\"\n        .Location = \"Office\"\n        .Body = Cells(i, 4)\n        .BusyStatus = olFree\n        .ReminderMinutesBeforeStart = 7200\n        .ReminderSet = True\n        .Categories = \"Finance\"\n        .Save\n\n    End With\n    Cells(i, 13) = \"Added\"\n\n\nEnd If\n\n        i = i + 1\nLoop\n    Set olAppt = Nothing\n    Set olApp = Nothing\n\n    Exit Sub\n\nErr_Execute:\n    MsgBox \"An error occurred - Exporting items to Calendar.\"\n\nEnd Sub\n\n\n</code></pre>\n\n<p><strong>EDIT:</strong> Based on your comments, you could determine the total cells used in Column 12, like this <code>LastRow = Cells(Rows.Count, 12).End(xlUp).Row</code> and then loop through it using a <code>For Next</code> loop.</p>\n\n<p>Replace your <code>Do Until</code> block with this.</p>\n\n<pre><code>Dim LastRow As Long\nLastRow = Cells(Rows.Count, 12).End(xlUp).Row\n\nFor i = 2 To LastRow\n\nIf IsDate(Cells(i, 12)) And UCase(Trim(Cells(i, 13))) &lt;&gt; \"ADDED\" Then\n\n    arrCal = Cells(i, 1)\n\n    Set olAppt = CalFolder.Items.Add(olAppointmentItem)\n\n    'MsgBox subFolder, vbOKCancel, \"Folder Name\"\n\n    With olAppt\n\n    'Define calendar item properties\n        .Start = Cells(i, 12) + TimeValue(\"9:00:00\")\n        .End = Cells(i, 12) + TimeValue(\"10:00:00\")\n\n\n        .Subject = \"Invoice Reminder\"\n        .Location = \"Office\"\n        .Body = Cells(i, 4)\n        .BusyStatus = olFree\n        .ReminderMinutesBeforeStart = 7200\n        .ReminderSet = True\n        .Categories = \"Finance\"\n        .Save\n\n    End With\n    Cells(i, 13) = \"Added\"\n\n\nEnd If\n\nNext\n\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10698414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a578e9a665d013d4eb186188692f4a13?s=128&d=identicon&r=PG&f=1", "display_name": "Mr_Col", "link": "https://stackoverflow.com/users/10698414/mr-col"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 55499097, "answer_count": 1, "score": 0, "last_activity_date": 1577526353, "creation_date": 1554287388, "last_edit_date": 1577526353, "question_id": 55492952, "link": "https://stackoverflow.com/questions/55492952/creating-reminders-in-outlook-from-an-excel-sheet-ignoring-blank-cells", "title": "Creating reminders in Outlook from an Excel sheet ignoring blank cells", "body": "<p>I am looking to set reminders in my Outlook calendar, based on a date in a cell in Excel.</p>\n\n<p>I have this running. When you save the workbook it auto populates the reminders in Outlook.</p>\n\n<p>I want to ignore blanks in the column where I have the dates.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CreateOutlookApptz()\n    Sheets(\"Invoicing Schedule\").Select\n    On Error GoTo Err_Execute\n\n    Dim olApp As Outlook.Application\n    Dim olAppt As Outlook.AppointmentItem\n    Dim blnCreated As Boolean\n    Dim olNs As Outlook.Namespace\n    Dim CalFolder As Outlook.MAPIFolder\n    Dim arrCal As String\n\n    Dim i As Long\n\n    On Error Resume Next\n    Set olApp = Outlook.Application\n\n    If olApp Is Nothing Then\n        Set olApp = Outlook.Application\n        blnCreated = True\n        Err.Clear\n    Else\n        blnCreated = False\n    End If\n\n    On Error GoTo 0\n\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n    Set CalFolder = olNs.GetDefaultFolder(olFolderCalendar)\n\n    i = 1\n    Do Until Trim(Cells(i, 1).Value) = \"\"\n        arrCal = Cells(i, 1).Value\n        If Trim(Cells(i, 13).Value) = \"\" Then\n            Set olAppt = CalFolder.Items.Add(olAppointmentItem)\n\n            'MsgBox subFolder, vbOKCancel, \"Folder Name\"\n\n            With olAppt\n\n                'Define calendar item properties\n                .Start = Cells(i, 12) + TimeValue(\"9:00:00\")\n                .End = Cells(i, 12) + TimeValue(\"10:00:00\")\n\n                .Subject = \"Invoice Reminder\"\n                .Location = \"Office\"\n                .Body = Cells(i, 4)\n                .BusyStatus = olFree\n                .ReminderMinutesBeforeStart = 7200\n                .ReminderSet = True\n                .Categories = \"Finance\"\n                .Save\n\n            End With\n        Cells(i, 13) = \"Added\"\n\n        End If\n\n        i = i + 1\n    Loop\n\n    Set olAppt = Nothing\n    Set olApp = Nothing\n\n    Exit Sub\n\nErr_Execute:\n    MsgBox \"An error occurred - Exporting items to Calendar.\"\n\nEnd Sub\n</code></pre>\n\n<p>I want to look in a column, if that column contains a date, then set the reminder based on another cell value.</p>\n"}, {"tags": ["vba", "loops", "for-loop"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1554287365, "post_id": 55492821, "comment_id": 97692995, "body": "First concept you need to look into is <code>lastrow</code>, to determine to where your code needs to run. Then you need to loop <code>from 1 to lastrow</code> replacing numbers with a counter value, which you increment by one if the cell value you encounter is not a number. Be carefull with the representation of number, look out for differences between integers and other sort of numbers."}], "answers": [{"comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1554287616, "post_id": 55493007, "comment_id": 97693146, "body": "Is it the <code>.Areas</code> part that keeps the segmentation between strings in place?"}, {"owner": {"reputation": 794, "user_id": 4469565, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-QtInUewVqDU/AAAAAAAAAAI/AAAAAAAAASY/JELdhXXcbOA/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/4469565/joey"}, "edited": false, "score": 1, "creation_date": 1554287815, "post_id": 55493007, "comment_id": 97693260, "body": "Yes, this worked! I will look into the documentation to understand SpecialCells. Thanks a bunch."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1554288044, "post_id": 55493007, "comment_id": 97693391, "body": "@Luuklag - yes, there are quite a few SC options."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1554288200, "post_id": 55493007, "comment_id": 97693483, "body": "Note to self, use SC more often ;)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1554287538, "creation_date": 1554287538, "answer_id": 55493007, "question_id": 55492821, "link": "https://stackoverflow.com/questions/55492821/looping-through-column-data-and-applying-different-numerical-values-inbetween-st/55493007#55493007", "title": "Looping through column data and applying different numerical values inbetween strings VBA", "body": "<p>Try this, assuming the numbers are not the result of formulae.</p>\n\n<pre><code>Sub x()\n\nDim r As Range, n As Long\n\nFor Each r In Columns(1).SpecialCells(xlCellTypeConstants, xlNumbers).Areas\n    n = n + 1\n    r.Value = n\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 10867189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gV_nfI5zrLQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYzWv5emqCz9bfWiaFYLBB7rVHMcg/mo/photo.jpg?sz=128", "display_name": "Mehmet Canbulat", "link": "https://stackoverflow.com/users/10867189/mehmet-canbulat"}, "is_accepted": false, "score": 0, "last_activity_date": 1554288538, "creation_date": 1554288538, "answer_id": 55493339, "question_id": 55492821, "link": "https://stackoverflow.com/questions/55492821/looping-through-column-data-and-applying-different-numerical-values-inbetween-st/55493339#55493339", "title": "Looping through column data and applying different numerical values inbetween strings VBA", "body": "<p>I created a function instead of sub which is little bit messy but it works. Tested at my pc</p>\n\n<pre><code>Public Function Test(checkrange As Range, checkcell As Range)\n\nDim cll As Range\nDim arr() As Variant\n\nReDim Preserve arr(1 To checkrange.Cells.Count)\n\nIf IsNumeric(checkcell.Value) = False Then\n    Test = checkcell.Value\n    Exit Function\nEnd If\n\ny = 1\nFor Each cll In checkrange\n    If IsNumeric(cll.Value) Then\n        arr(y) = 1\n    Else\n        arr(y) = 0\n    End If\n    y = y + 1\nNext cll\n\nm = 1\nFor Each cll In checkrange\n    If cll.Address = checkcell.Address Then\n        rownumber = m\n        Exit For\n    End If\n    m = m + 1\nNext cll\n\nm = 0\nFor i = LBound(arr) To UBound(arr)\n    If arr(i) = 0 Then\n        m = m + 1\n    End If\n    If i = rownumber Then Exit For\nNext i\n\nTest = m\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 794, "user_id": 4469565, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-QtInUewVqDU/AAAAAAAAAAI/AAAAAAAAASY/JELdhXXcbOA/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/4469565/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 55493007, "answer_count": 2, "score": 1, "last_activity_date": 1554288538, "creation_date": 1554286929, "question_id": 55492821, "link": "https://stackoverflow.com/questions/55492821/looping-through-column-data-and-applying-different-numerical-values-inbetween-st", "title": "Looping through column data and applying different numerical values inbetween strings VBA", "body": "<p>I am trying to write a function that loops through column values and applies numbers 1,2,3...n in between cells with strings. for example: </p>\n\n<p>data: </p>\n\n<pre><code>hefew\n1\n3\n2\n6\nbkifew\n3\n4\n2\n1\n3\n</code></pre>\n\n<p>I want the function to change the values to:</p>\n\n<pre><code>hefew\n  1\n  1\n  1\n  1\nbkifew\n  2\n  2\n  2\n  2\n  2\n</code></pre>\n\n<p>There could be multiple strings, so the end value could end up being 15 or so. </p>\n\n<p>I have started a basic function but I am not familiar enough with VBA to work the logic. I program in Python and would normally do stuff like this in that language. However, I'm forced to keep this within excel. </p>\n\n<p>current working: </p>\n\n<pre><code>Sub Button2_Click()\n\n    Dim rng As Range, cell As Range\n\n    cellcount = CountA(\"A1:A1000\")\n\n    Set rng = Range(\"A1:A10\")\n\n    For Each cell In rng\n        a = cell.Value\n        If IsNumeric(a) = True Then\n            cell.Value = 1\n        Else\n            cell.Value = 0\n        End If\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>I don't think this is possible with a for loop. Is there some sort of search and replace function that I could use?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1554290177, "post_id": 55492713, "comment_id": 97694671, "body": "In instances where that has happened to me, it has frequently been due to some previously unaccounted for change in the data."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1554290817, "post_id": 55492713, "comment_id": 97695087, "body": "@RonRosenfeld but despite having no changes in data, it worked fine after all instances of excel was closed. So I think it shouldn&#39;t be a wrongly encoded data point"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1554291770, "post_id": 55492713, "comment_id": 97695683, "body": "That&#39;s true, too. So far, the only thing you have to work with is the change in the environment, possibly with the multiple books being open, but maybe something else.  Unless/until you can reproduce the error, it&#39;s going to be tough to find. Nothing jumps out at me with your code.  Maybe try posting on the Code Review group."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1554318481, "post_id": 55492713, "comment_id": 97711416, "body": "Hint: rewrite your logic without using <code>GoTo</code>. None of them are necessary."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1554340497, "post_id": 55492713, "comment_id": 97718698, "body": "@AJD You mean the <code>GoTo</code> is causing the glitch?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1554340962, "post_id": 55492713, "comment_id": 97718790, "body": "@RonRosenfeld Yeah it&#39;s hard to reproduce this error but maybe it&#39;ll appear again next time"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1554402789, "post_id": 55492713, "comment_id": 97749848, "body": "The <code>GoTo</code> creates spaghetti code that makes it hard to follow branches. Strongly controlled loops with clear logic will help you identify any logic/termination faults."}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1554288700, "creation_date": 1554286620, "last_edit_date": 1554288700, "question_id": 55492713, "link": "https://stackoverflow.com/questions/55492713/why-does-my-vba-code-terminate-after-a-copy-method-is-performed-on-unpredictabl", "title": "Why does my VBA Code Terminate after a .Copy method is performed on unpredictable instances?", "body": "<p>The code below has been running for no problems for several months already, but for some reason, it suddenly glitched up. When I step through the code, it terminates instantly after running a <code>.Copy</code> method to copy data from a sheet to another. I do not see any reason why this should happen. Also, the destination worksheet is actually a <code>Very Hidden</code> worksheet and when I try to set it to <code>Visible</code>, it errors with something like: <code>Cannot set to the Visible property</code>. But if I change it from <code>Very Hidden</code> to <code>Hidden</code> then to <code>Visible</code>, I was able to change the worksheet to visible. I do not know if it has anything to do why the code abruptly ends, but I am guessing it might have.</p>\n\n<pre><code>Option Explicit\nSub Delete_Voucher()\n\nDim Total_rows_Entries As Long\nDim Delete_row As Variant\nDim Total_rows_Deleted As Long\nDim i As Long\n\nThisWorkbook.Worksheets(\"Entries\").Unprotect Password:=\"test\"\n\nWith ThisWorkbook.Worksheets(\"Entries\").ListObjects(\"Entries\").ListColumns(3).Range\nTotal_rows_Entries = .Find(What:=\"*\", _\n    After:=.Cells(1), _\n    Lookat:=xlPart, _\n    LookIn:=xlFormulas, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious, _\n    MatchCase:=False).Row\nEnd With\n\nInputDelete:\nDelete_row = InputBox(\"Input the voucher number you want to delete.\")\nIf StrPtr(Delete_row) = 0 Then\n    GoTo CancelInputDelete\nElseIf Delete_row = \"\" Then\n    MsgBox \" Cannot be blank. Please enter a voucher number to delete.\"\n    GoTo InputDelete\nElseIf IsError(Application.Match(Val(Delete_row), ThisWorkbook.Worksheets(\"Entries\").Range(\"A2:A\" &amp; Total_rows_Entries), 0)) = True Then\n    MsgBox \"No such voucher number. Please Input the correct voucher number.\"\n    GoTo InputDelete\nEnd If\n\nEntriesStart:\nWith ThisWorkbook.Worksheets(\"Entries\").ListObjects(\"Entries\").ListColumns(3).Range\nTotal_rows_Entries = .Find(What:=\"*\", _\n    After:=.Cells(1), _\n    Lookat:=xlPart, _\n    LookIn:=xlFormulas, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious, _\n    MatchCase:=False).Row\nEnd With\n\nTotal_rows_Deleted = ThisWorkbook.Worksheets(\"Deleted Vouchers\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To Total_rows_Entries\n    If ThisWorkbook.Worksheets(\"Entries\").Cells(i, 1) = Val(Delete_row) Then\n'The code between this line is executed successfully, but then immediately ends running the program afterwards\n        ThisWorkbook.Worksheets(\"Entries\").Rows(i).EntireRow.Copy _\n            Destination:=ThisWorkbook.Worksheets(\"Deleted Vouchers\").Cells(Total_rows_Deleted + 1, 1)\n'The code between this line is executed successfully, but then immediately ends running the program afterwards\n        ThisWorkbook.Worksheets(\"Deleted Vouchers\").Cells(Total_rows_Deleted + 1, 9) = Now()\n        ThisWorkbook.Worksheets(\"Entries\").Rows(i).EntireRow.Delete Shift:=xlUp\n        GoTo EntriesStart\n    End If\nNext i\n\nMsgBox (\"Voucher number: \" &amp; Delete_row &amp; \" has been successfully deleted.\")\n\nCancelInputDelete:\nThisWorkbook.Worksheets(\"Entries\").Protect _\n    DrawingObjects:=True, Contents:=True, Scenarios:=True, _\n    AllowFormattingCells:=True, AllowFormattingColumns:=True, _\n    AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, Password:=\"test\"\nEnd Sub\n</code></pre>\n\n<p>Why do excel codes glitch up despite the fact that the code is unchanging? I noticed the employee had about 10 workbooks open, but I believe the code should be robust as I used <code>ThisWorkbook</code> in declaring the objects. I closed the workbook and re-opened it, but same problem occurs. However, on another computer the code works fine with no change in code. </p>\n\n<p>After she closed all excel workbooks, I wanted to test whether it'll work if the whole instance of Excel was reset, the code worked fine and no traces of the problem was seen. I am confused why this would happen.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554285244, "post_id": 55492188, "comment_id": 97691626, "body": "What do you mean by sometimes the delete doesn&#39;t work - what exactly happens (or doesn&#39;t happen)?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1554285326, "post_id": 55492188, "comment_id": 97691699, "body": "<b>...and always builds up the range object correctly.</b> Change the line <code>If Not rngRowsToDelete Is Nothing Then rngRowsToDelete.Delete</code> to <code>If Not rngRowsToDelete Is Nothing Then rngRowsToDelete.Delete Else Msgbox &quot;This time no range was found&quot;</code> Now everytime it doesn&#39;t delete anything, do you see the messagebox?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1554285348, "post_id": 55492188, "comment_id": 97691705, "body": "Yes @SJR ... my constant vicious horizontal reading..."}, {"owner": {"reputation": 11, "user_id": 10754358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee8de126ee01d25531d23b8e79cfacbc?s=128&d=identicon&r=PG&f=1", "display_name": "User0612", "link": "https://stackoverflow.com/users/10754358/user0612"}, "edited": false, "score": 0, "creation_date": 1554285681, "post_id": 55492188, "comment_id": 97691925, "body": "SJR: I mean that the row does not get deleted. There are no errors generated.  SiddharthRout: this code runs as a silent process (no feedback to user)  This sub that contains this code is being run multiple times in a loop in order to delete rows on multiple different sheets that are marked as TRUE in the specified column of each sheet. As I say the deletion works from some sheets in the some workbooks and not others. If the master process is re-executed against those same &#39;input&#39; workbooks and sheets you may get different results (i.e. the rows may now be deleted),"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554285828, "post_id": 55492188, "comment_id": 97692020, "body": "That suggests that <code>rngRowsToDelete</code> is Nothing - have you stepped through, or tried Siddharth Rout&#39;s suggestion?"}, {"owner": {"reputation": 11, "user_id": 10754358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee8de126ee01d25531d23b8e79cfacbc?s=128&d=identicon&r=PG&f=1", "display_name": "User0612", "link": "https://stackoverflow.com/users/10754358/user0612"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1554286013, "post_id": 55492188, "comment_id": 97692147, "body": "@SJR: As I said in the OP I have already run debugging and can guarantee that the rows are correctly detected and where there are valid rows to be deleted &#39;rngRowsToDelete is not nothing - hence my confusion. Also the entire row is added to the range of a valid row - not just one cell."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1554286253, "post_id": 55492188, "comment_id": 97692315, "body": "<b>1.</b> Please try what I suggested <b>2.</b> Also do you have <code>On Error Resume Next</code> anywhere above in the code?"}, {"owner": {"reputation": 11, "user_id": 10754358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee8de126ee01d25531d23b8e79cfacbc?s=128&d=identicon&r=PG&f=1", "display_name": "User0612", "link": "https://stackoverflow.com/users/10754358/user0612"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554286995, "post_id": 55492188, "comment_id": 97692758, "body": "@SiddharthRout I will have to wait to test until I can arrange testing time with the client who has this issue and the input workbooks. I wanted to collect everyone&#39;s thoughts and possible experience with this issue before going back to the client and using testing time.   I don&#39;t use &#39;on error resume next&#39; as that is bad practice (except for specific circumstances) and certainly would be wrong here.   The procedure does have a complete error handler (using &#39;on error goto subErrorHandler&#39;) to capture any error and record it but this does not record an error."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554287122, "post_id": 55492188, "comment_id": 97692843, "body": "If you try what I suggested and if you do not see a message box and also the row(s) are not deleted then there is a problem and then we will investigate it further. Till then I do not know what else to suggest."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554287233, "post_id": 55492188, "comment_id": 97692920, "body": "Also quick check. Do you have <code>Dim rngRowsToDelete As Range</code> outside the procedure or inside the procedure? If it is outside the procedure then Add this line <code>Set rngRowsToDelete = Nothing</code> right after <code>If Not rngRowsToDelete Is Nothing Then rngRowsToDelete.Delete</code>"}, {"owner": {"reputation": 11, "user_id": 10754358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee8de126ee01d25531d23b8e79cfacbc?s=128&d=identicon&r=PG&f=1", "display_name": "User0612", "link": "https://stackoverflow.com/users/10754358/user0612"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554287401, "post_id": 55492188, "comment_id": 97693018, "body": "@SiddharthRout Well I have previously added debug code and outputted the &#39;rngRowsToDelete.address&#39; just before the &#39;deletion line&#39; and the address is correct (i.e. not Nothing) and shows only the entire rows of those rows which are marked as True - so I know that the range is not nothing when it attempts to delete. This is why I have posted because I have uses the same code solution in numerous different projects for about 20 years and this has never failed me - until now."}], "owner": {"reputation": 11, "user_id": 10754358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee8de126ee01d25531d23b8e79cfacbc?s=128&d=identicon&r=PG&f=1", "display_name": "User0612", "link": "https://stackoverflow.com/users/10754358/user0612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554285624, "creation_date": 1554285126, "last_edit_date": 1554285624, "question_id": 55492188, "link": "https://stackoverflow.com/questions/55492188/excel-vba-range-delete-method-randomly-fails", "title": "Excel VBA Range &#39;Delete&#39; method randomly fails", "body": "<p><strong>Background</strong> </p>\n\n<p>I have a piece of VBA code which deletes multiple rows on a worksheet depending on if the values on each row are TRUE or FALSE in a specific column (a 'control range'). The worksheets as switched as a master loop (above the level of this function) that cycles through multiple sheets and workbooks.</p>\n\n<p>This is used in the Excel 2013 and 2016 </p>\n\n<p>Naturally the code searches for matching rows and builds up a range object and only once the loop has ended is that rage deleted.</p>\n\n<p><strong>Code extract</strong></p>\n\n<p>I can't send a copy of the actual workbook because it is too large, too complicated and I don't have time to explain how it works - besides it is confidential.</p>\n\n<p>I have listed below an extract of the key code that is failing (with the command that fails in bold).</p>\n\n<pre><code>    ' Build up a list of rows which are valid\n    For Each rngCurControlCell In rngSheetControlRange.Cells\n\n        If rngCurControlCell.Value = True Then\n\n            If rngRowsToDelete Is Nothing Then\n                Set rngRowsToDelete = rngCurControlCell.EntireRow\n            Else\n                Set rngRowsToDelete = Union(rngCurControlCell.EntireRow, rngRowsToDelete)\n            End If\n\n        End If 'rngCurControlCell.Value = True\n\n    Next rngCurControlCell\n\n    ' Delete the rows\n   If Not rngRowsToDelete Is Nothing Then rngRowsToDelete.Delete\n</code></pre>\n\n<p><strong>Problem / Issue</strong></p>\n\n<p>Sometimes this code works and sometimes it does not.</p>\n\n<p>I have put various debugging in the code and can confirm that the code always finds the target rows ('rngRowsToDelete' in the extract above) and <strong>always</strong> builds up the range object correctly.</p>\n\n<p>HOWEVER ... sometimes the delete works and sometimes it does not - even though it it run against the same worksheet. No error is generated.</p>\n\n<p><strong><em>Has anyone come across a similar situation / have any thoughts ?</em></strong></p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11299701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b798a4884c67afe64c2ec47a49909963?s=128&d=identicon&r=PG&f=1", "display_name": "kds", "link": "https://stackoverflow.com/users/11299701/kds"}, "edited": false, "score": 0, "creation_date": 1554369837, "post_id": 55491750, "comment_id": 97729537, "body": "thanks for your quick solution, it does exactly what i want and very fast!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11304668"}, "is_accepted": false, "score": 1, "last_activity_date": 1554283871, "creation_date": 1554283871, "answer_id": 55491750, "question_id": 55491482, "link": "https://stackoverflow.com/questions/55491482/sort-multiples-ranges-with-loop-vba/55491750#55491750", "title": "sort multiples ranges with loop vba", "body": "<p>Use Offset to loop through the columns and the worksheet's COUNTA function to make sure there is something to sort. Blank cell will simply be pushed to the bottom.</p>\n\n<pre><code>Option Explicit\n\nSub sort65()\n    Dim i As Long\n\n    'define the worksheet\n    With Worksheets(\"sheet1\")\n\n        'loop through 65 columns\n        For i = 0 To 64\n\n            'offset original by the loop increment\n            With .Range(\"D39:D122\").Offset(0, i)\n\n                'make sure there is something to sort\n                If Application.CountA(.Cells) &gt; 0 Then\n\n                    'sort ascending with no header\n                    .Sort key1:=.Cells(1), order1:=xlAscending, Header:=xlNo\n\n                End If\n\n            End With\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11299701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b798a4884c67afe64c2ec47a49909963?s=128&d=identicon&r=PG&f=1", "display_name": "kds", "link": "https://stackoverflow.com/users/11299701/kds"}, "edited": false, "score": 0, "creation_date": 1554369954, "post_id": 55491947, "comment_id": 97729609, "body": "this doesn&#39;t seem to work for me, i changed de two REF&#39;s into the name of the workbook en worksheet, but even then... it says that there aren&#39;t variables declared... am i doing something wrong here? Thank you anyways for looking into it!"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 11, "user_id": 11299701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b798a4884c67afe64c2ec47a49909963?s=128&d=identicon&r=PG&f=1", "display_name": "kds", "link": "https://stackoverflow.com/users/11299701/kds"}, "edited": false, "score": 0, "creation_date": 1554370789, "post_id": 55491947, "comment_id": 97730160, "body": "Are you using Option Explicit? I have edited my code. On what line is the code breaking? If you are using the wb/ws name, have you quoted them (<code>Sheets(&quot;Name&quot;)</code>)?"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 1, "last_activity_date": 1554370761, "last_edit_date": 1554370761, "creation_date": 1554284445, "answer_id": 55491947, "question_id": 55491482, "link": "https://stackoverflow.com/questions/55491482/sort-multiples-ranges-with-loop-vba/55491947#55491947", "title": "sort multiples ranges with loop vba", "body": "<p>The following sub sorts every column starting from the <strong>4th</strong> column (\"D\"), stored in variable <code>FCol</code> until the last column found in the specified worksheet, <code>LCol</code>.</p>\n\n<p>It determines the last filled row in the column, and then sorts the cells starting from the first row (39) until the last row.</p>\n\n<p>If the first row is dynamic, or if you need to change it in the future, you just have to change the <code>FRow</code> variable.</p>\n\n<pre><code>Sub sortcols()\n\nDim FRow as Long, FCol as Long, LRow as Long, LCol as Long, i As Long\n\nWith Workbooks(REF).Sheets(REF)\n\n    FRow = 39\n    FCol = 4 'column \"D\"\n    LCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n    For i = FCol to LCol\n\n        'Determine the last filled row in the column (starting from the top)\n        LRow = .Cells(.Rows.Count, i).End(xlDown).Row\n\n        'Sort the cells on the condition that there is data present  \n        With .Range(.Cells(FRow, i), .Cells(LRow, i))\n            If Not LRow = 1 Then .Sort key1:=.Cells(1), order1:=xlAscending, Header:=xlYes\n        End With  \n\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11299701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b798a4884c67afe64c2ec47a49909963?s=128&d=identicon&r=PG&f=1", "display_name": "kds", "link": "https://stackoverflow.com/users/11299701/kds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1554839385, "creation_date": 1554283065, "last_edit_date": 1554839385, "question_id": 55491482, "link": "https://stackoverflow.com/questions/55491482/sort-multiples-ranges-with-loop-vba", "title": "sort multiples ranges with loop vba", "body": "<p>I have 65 ranges in colums next to each other. The first range is \"D39:D122\", the next range is \"E39:E122\"... the last range is \"BP39:BP122\". </p>\n\n<p>It's possible that all 65 ranges are filed with data, but it is also possible that only 10 ranges are filled with data.I already managed that if there are 10 ranges filled with data, that it is the first 10 ranges that are filled.</p>\n\n<p>The data: it is a list of maximum 84 different cells (from D39 to D122), sometimes only 15 cells are filled with data, sometimes 24, sometimes nothing.</p>\n\n<p>The question: how can a sort each range in ascending order using a loop. </p>\n\n<p>Example</p>\n\n<pre><code>        D           E           F       etc... BP\n39    ID0077      ID0325     ID0037\n40    ID0134      ID0704     ID0206\n41    ID0001      ID0011     ID0042\n42    ID3481      ID2005     ID0215\n43    ID0280      etc..      ID0005\n      etc...                 ID0015\n                             ID0328\n                             ID0712\n                             ID0332\n                             ID0713\n                             etc...\n</code></pre>\n\n<p>Second question: there is a second and a third range like this:the second range from (D126:D209) till (BP126:BP209), the third range from (D299:D303) till (BP299:303). How can I loop through this? </p>\n\n<p><a href=\"https://i.stack.imgur.com/zwm1M.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zwm1M.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1554283325, "post_id": 55491354, "comment_id": 97690452, "body": "The code to transpose without losing dateness is at the bottom of the <a href=\"https://stackoverflow.com/a/53350351/11683\">answer</a> (you need to transpose manually)."}, {"owner": {"reputation": 501, "user_id": 7204030, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-Nw__Kd4Q4g4/AAAAAAAAAAI/AAAAAAAAGqk/fk2sKIXn4J4/photo.jpg?sz=128", "display_name": "dsugasa", "link": "https://stackoverflow.com/users/7204030/dsugasa"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1554284303, "post_id": 55491354, "comment_id": 97691044, "body": "Thank you, forgive the rookie questions. So if I want to maintain the date format, I need to transpose manually. If I wanted to convert the range of string dates after the fact, what would be the syntax? I have tried using CDate, but I am not getting it to work."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1554285213, "post_id": 55491354, "comment_id": 97691609, "body": "<a href=\"https://superuser.com/q/299437/52365\">superuser.com/q/299437/52365</a>"}, {"owner": {"reputation": 501, "user_id": 7204030, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-Nw__Kd4Q4g4/AAAAAAAAAAI/AAAAAAAAGqk/fk2sKIXn4J4/photo.jpg?sz=128", "display_name": "dsugasa", "link": "https://stackoverflow.com/users/7204030/dsugasa"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1554285600, "post_id": 55491354, "comment_id": 97691876, "body": "<a href=\"https://stackoverflow.com/q/20375233/7204030\">stackoverflow.com/q/20375233/7204030</a> this did the trick for me. Thank you"}], "owner": {"reputation": 501, "user_id": 7204030, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-Nw__Kd4Q4g4/AAAAAAAAAAI/AAAAAAAAGqk/fk2sKIXn4J4/photo.jpg?sz=128", "display_name": "dsugasa", "link": "https://stackoverflow.com/users/7204030/dsugasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 1, "closed_date": 1554283298, "answer_count": 0, "score": 1, "last_activity_date": 1554285587, "creation_date": 1554282719, "last_edit_date": 1554285587, "question_id": 55491354, "link": "https://stackoverflow.com/questions/55491354/vba-array-of-dates-transposes-as-strings", "closed_reason": "Duplicate", "title": "VBA Array of Dates Transposes as Strings", "body": "<p>I have an array of dates that I am transposing to a range. However they are not transposed as dates, they are transposed as strings.</p>\n\n<pre><code>Dim termdates As Variant\ntermdates = Array(DateSerial(2020,6,20), DateSerial(2021,6,20), DateSerial(2022,6,20))\n\nRange(\"C1:C3\").Formula = Application.Transpose(termdates)\n</code></pre>\n\n<p>How do I convert <code>range(\"C1:C3\")</code>to dates? Alternatively is there a better way to copy the dates from <code>termdates</code> that does not require an additional conversion?</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "is_accepted": true, "score": 0, "last_activity_date": 1554284721, "creation_date": 1554284721, "answer_id": 55492048, "question_id": 55491125, "link": "https://stackoverflow.com/questions/55491125/copied-range-from-excel-to-word-font-settings-set-as-hidden/55492048#55492048", "title": "Copied range from Excel to Word (Font settings set as hidden?)", "body": "<p>I solved this problem by adding <code>.Font.Hidden = 0</code></p>\n\n<pre><code>Case \"table2\"\n  ThisWorkbook.Sheets(\"Prices\").Range(\"Q17:V26\").Copy\n  With wdRng\n    Set rngPara = .Paragraphs.Last.Range\n    rngPara.Style = wdStyleNormal\n    rngPara.PasteExcelTable False, False, False\n    .Tables(.Tables.Count).AutoFitBehavior wdAutoFitWindow\n    .Font.Hidden = 0\n    Set rngPara = Nothing\n    End With\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55492048, "answer_count": 1, "score": 0, "last_activity_date": 1582888105, "creation_date": 1554282040, "last_edit_date": 1582888105, "question_id": 55491125, "link": "https://stackoverflow.com/questions/55491125/copied-range-from-excel-to-word-font-settings-set-as-hidden", "title": "Copied range from Excel to Word (Font settings set as hidden?)", "body": "<p>I have a code for copying range of data from Excel to Word. Process works but I have just noticed that copied table is not visible in printing mode, in MS Word. After investigations I have found that Font settings are set to \"hidden\". This should be coming while copy - pasting process. How it can be fixed? I would like to have it visible <code>.Font.Hidden = False</code></p>\n\n<p>Problem has to be somewhere here <code>rngPara.PasteExcelTable False, False, False</code>?</p>\n\n<p>My code from Excel for copy - paste:</p>\n\n<pre><code>Case \"table2\"\n  ThisWorkbook.Sheets(\"Prices\").Range(\"Q17:V26\").Copy\n  With wdRng\n    Set rngPara = .Paragraphs.Last.Range\n    rngPara.Style = wdStyleNormal\n    rngPara.PasteExcelTable False, False, False\n    .Tables(.Tables.Count).AutoFitBehavior wdAutoFitWindow\n    Set rngPara = Nothing\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1554282404, "creation_date": 1554282404, "answer_id": 55491248, "question_id": 55490180, "link": "https://stackoverflow.com/questions/55490180/how-to-modify-powerpoint-chart-chartdata-by-excel-vba/55491248#55491248", "title": "How to modify Powerpoint Chart ChartData by Excel VBA", "body": "<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jHgXp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jHgXp.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>Set pptApp = GetObject(, \"PowerPoint.Application\")\nSet pptPres = pptApp.ActivePresentation\npptPres.Slides(1).Shapes(1).Chart.ChartTitle.Text = \"Sales Overview\"\npptPres.Slides(1).Shapes(1).Chart.ChartData.Activate\npptPres.Slides(1).Shapes(1).Chart.ChartData.Workbook.Worksheets(\"Blad1\").Range(\"B2:B5\").Value = 50\n</code></pre>\n\n<p>Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fJAkv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fJAkv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 10548169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b40598223ef72bc1d51aabac4228b3?s=128&d=identicon&r=PG&f=1", "display_name": "xapp", "link": "https://stackoverflow.com/users/10548169/xapp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "accepted_answer_id": 55491248, "answer_count": 1, "score": 0, "last_activity_date": 1554287067, "creation_date": 1554279221, "last_edit_date": 1554287067, "question_id": 55490180, "link": "https://stackoverflow.com/questions/55490180/how-to-modify-powerpoint-chart-chartdata-by-excel-vba", "title": "How to modify Powerpoint Chart ChartData by Excel VBA", "body": "<p>I\u00b4m trying to modify ChartData (values) in Powerpoint by using Excel-VBA.\nThe ChartData is not linked to the other Excel Workbook.</p>\n\n<p>Checks:\n- PowerPoint is open\n- required Presentation is open\n- The Chart is on Slide 4</p>\n\n<p>Behavior:\n- Chart Title Changes \n- Workbook with ChartData opens \n- Runtime Error '424' : Objeckt Required\n- Debugging marks the following line:</p>\n\n<pre><code>Chart.ChartData.Workbook.Worksheets(\"Tabelle1\").Range(\"B2:B5\").Value = 50\n</code></pre>\n\n<p>Hope somebody can help me out... :-)</p>\n\n<pre><code>Sub ModifyChartData()\n\nDim pptApp As Object\nDim pptPres As Presentation\n\nSet pptApp = GetObject(, \"PowerPoint.Application\")\nSet pptPres = pptApp.ActivePresentation\n\n\npptPres.Slides(4).Shapes(\"Diagramm1\").Chart.ChartTitle.Text = \"Sales Overview\"\npptPres.Slides(4).Shapes(\"Diagramm1\").Chart.ChartData.Activate\nChart.ChartData.Workbook.Worksheets(\"Tabelle1\").Range(\"B2:B5\").Value = 50\nWorkbooks.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1554280754, "post_id": 55490609, "comment_id": 97688895, "body": "this event trigger each time i activate a sheet. Is there any other solution to avoid running the code each time?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1554281735, "post_id": 55490609, "comment_id": 97689494, "body": "@Error1004 instead of <code>Workbook_SheetDeactivate(ByVal sh As Object)</code> in the above code use <code>Workbook_SheetBeforeDelete(ByVal Sh As Object)</code>"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1554282632, "post_id": 55490609, "comment_id": 97690053, "body": "@Zsmaster to avoid trigger the code each time i activated a sheet u use <b>Workbook_SheetBeforeDelete(ByVal Sh As Object)</b> as per Siddharth Rout comment."}], "tags": [], "owner": {"reputation": 1540, "user_id": 5829910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHFX.jpg?s=128&g=1", "display_name": "Zsmaster", "link": "https://stackoverflow.com/users/5829910/zsmaster"}, "is_accepted": false, "score": 2, "last_activity_date": 1554280490, "creation_date": 1554280490, "answer_id": 55490609, "question_id": 55490023, "link": "https://stackoverflow.com/questions/55490023/delete-add-sheets-event-vba/55490609#55490609", "title": "Delete/Add sheets event - VBA", "body": "<p>Here you are a delete sheet event.</p>\n\n<p>Put this code in a standard code module</p>\n\n<pre><code>Public shName As String\n\nSub Deletesheet()\n    Dim oWS As Object\n    On Error Resume Next\n    Set oWS = Sheets(shName)\n    If oWS Is Nothing Then\n        MsgBox shName &amp; \" has been deleted\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Put this in ThisWorkbook</p>\n\n<pre><code>Private Sub Workbook_SheetDeactivate(ByVal sh As Object)\n    shName = sh.Name\n    Application.OnTime Now + TimeSerial(0, 0, 1), \"DeleteSheet\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 1, "last_activity_date": 1554280916, "creation_date": 1554280916, "answer_id": 55490740, "question_id": 55490023, "link": "https://stackoverflow.com/questions/55490023/delete-add-sheets-event-vba/55490740#55490740", "title": "Delete/Add sheets event - VBA", "body": "<p>There is no single event that captures either addition (<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.newsheet\" rel=\"nofollow noreferrer\">Workbook.NewSheet</a>) or deletion (<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetbeforedelete\" rel=\"nofollow noreferrer\">Workbook.SheetBeforeDelete</a>). But you could detect both events separately, and run the same piece of code for both events.</p>\n\n<p>To be able to run code <em>after</em> sheet deletion, you may use a timer to allow for deletion to take place.\nEven better, you may set up a waiting loop that counts the number of sheets in the workbook, and which is only exited when the number of sheets is the expected number after deletion is completed. Then you execute your intended code.</p>\n\n<p>Note that there is an issue when the deleted sheet is a <code>Chart</code>.\nFor those cases, you can use the suggestion <a href=\"https://stackoverflow.com/a/42160664/2707864\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1554301128, "post_id": 55491583, "comment_id": 97701754, "body": "No @sancho.s You suggested a timer like Zsmaster. My code does not use a timer object :)"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1554302518, "post_id": 55491583, "comment_id": 97702682, "body": "I suggested both, a timer, and a counter of Sheets as a better option: &quot;...Even better, you may set up a waiting loop that counts the number of sheets in the workbook...&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1554306821, "post_id": 55491583, "comment_id": 97705607, "body": "@sancho.s: Honestly, I did not even read your post. I hardly read posts which do not have VBA code in it. I did read Zsmaster&#39;s code and also commented on it. But if you think my post &quot;stole&quot; your idea then please feel free to downvote it. I will not mind :)"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1554313337, "post_id": 55491583, "comment_id": 97708841, "body": "I don&#39;t think it &quot;steals&quot; the idea, and I would not downvote... In the end, the objective is that votes reflect usefulness. On the contrary, if you think the code you posted embodies the idea in my answer, it would perhaps be good that you start your post with a suitable reference and related text."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1554313710, "post_id": 55491583, "comment_id": 97709025, "body": "@sancho.s <code>On the contrary, if you think the code you posted embodies the idea in my answer, it would perhaps be good that you start your post with a suitable reference</code> If I had read your post before I posted and if my answer was based on your post., I would have definitely (gladly) given the reference. Since that is not the case, I can&#39;t give that reference..."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1554470017, "post_id": 55491583, "comment_id": 97775799, "body": "You did not have that information at the time of posting, but you do have it now, and you are always free to edit, so I guess <code>you can give that reference</code>. Edits for good (whenever there is new info available) are always welcome..."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1554283385, "creation_date": 1554283385, "answer_id": 55491583, "question_id": 55490023, "link": "https://stackoverflow.com/questions/55490023/delete-add-sheets-event-vba/55491583#55491583", "title": "Delete/Add sheets event - VBA", "body": "<p>Here is another way</p>\n\n<p><strong>Logic</strong>:</p>\n\n<ol>\n<li>Before the sheet is deleted, count the number of sheets in the workbook</li>\n<li>When a sheet is activated, check the number of sheets in the workbook</li>\n</ol>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>Dim PreviousWorksheetCount As Integer\n\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\n    Dim CurrentWorksheetCount As Integer\n\n    CurrentWorksheetCount = ThisWorkbook.Sheets.Count\n\n    If CurrentWorksheetCount &lt; PreviousWorksheetCount Then\n        MsgBox \"Sheet was deleted\"\n    End If\nEnd Sub\n\nPrivate Sub Workbook_SheetBeforeDelete(ByVal Sh As Object)\n    PreviousWorksheetCount = ThisWorkbook.Sheets.Count\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 2, "accepted_answer_id": 55491583, "answer_count": 3, "score": 2, "last_activity_date": 1554283385, "creation_date": 1554278706, "last_edit_date": 1554280070, "question_id": 55490023, "link": "https://stackoverflow.com/questions/55490023/delete-add-sheets-event-vba", "title": "Delete/Add sheets event - VBA", "body": "<p>Is there any event which triggered on sheet deletion AND addition? i have try </p>\n\n<pre><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\nEnd Sub\n</code></pre>\n\n<p>but this event works only when i add a sheet. In my case i need something to works in both Add &amp; Delete.</p>\n\n<p>Any help will appreciate.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1554278747, "post_id": 55489971, "comment_id": 97687746, "body": "Hardly a fix, but can&#39;t you try to import your data into a new wb and see if the problem remains?"}, {"owner": {"reputation": 65, "user_id": 9380923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37f3232e241f5118304f50100fa013a?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9380923/peter"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1554279271, "post_id": 55489971, "comment_id": 97688054, "body": "Thanks for the reply, but unfortunately that doesn&#39;t seem to work."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1554279445, "post_id": 55489971, "comment_id": 97688158, "body": "When it fails at the very first of the macro must be a syntax error or lack of references. Go check your references to see if there are some missing."}, {"owner": {"reputation": 65, "user_id": 9380923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37f3232e241f5118304f50100fa013a?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9380923/peter"}, "edited": false, "score": 0, "creation_date": 1554279651, "post_id": 55489971, "comment_id": 97688276, "body": "That did seem to do the trick, I&#39;m not quite sure why the was no problem in the past.. Thanks anyway!"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1554279843, "post_id": 55489971, "comment_id": 97688394, "body": "This happens when you change your version of some software.. Maybe the last person who used it had 16 and you have the older one, 15. When moving from 15 to 16 in my experience nothing happens but going backwards always give errors (for MS software). Other libraries from different software could be causing the problem when trying different versions. You must uncheck the missing ones and find your current version for the ones you just unchecked."}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 8958130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agOGc.png?s=128&g=1", "display_name": "MonkeyFace", "link": "https://stackoverflow.com/users/8958130/monkeyface"}, "is_accepted": false, "score": 2, "last_activity_date": 1582906962, "last_edit_date": 1592644375, "creation_date": 1582828711, "answer_id": 60439740, "question_id": 55489971, "link": "https://stackoverflow.com/questions/55489971/error-accessing-file-network-connection-may-have-been-lost/60439740#60439740", "title": "Error accessing file. Network connection may have been lost", "body": "<h1>&quot;Error accessing file. Network connection may have been lost&quot;</h1>\n<p>This (and other generic error messages) can be thrown when the VB Editor detects a discrepancy between the source code (the text you see in the editor) and the compiled binary 'p' code also saved in the workbook.  This discrepancy situation is commonly referred to as a &quot;corrupt&quot; workbook.</p>\n<p>A <em>temporary</em> fix is to export the modules, forms, and classes one by one, create a new workbook and import them back in.  At this point you can now at least edit your source code in order to address the root cause.</p>\n<p>However, if the root cause of the corruption is not dealt with in your source code, then whenever the VB Editor next runs/compiles the troublesome portion of your code the corruption in the compiled binary 'p' code will be reintroduced.</p>\n<p>This corruption will become apparent only once you have saved and reopened the workbook, at which point the VB Editor will detect the discrepancy between the source code and the binary 'p'code saved in the workbook and throw the error once again.</p>\n<p>My solution on the following post gives insight into one such cause of this error due to inadvertently creating a circular dependency in classes that use the <code>IMPLEMENTS</code> statement:</p>\n<p><a href=\"https://stackoverflow.com/a/60440654/8958130\">IMPLEMENTS circular dependency issue</a></p>\n"}], "owner": {"reputation": 65, "user_id": 9380923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37f3232e241f5118304f50100fa013a?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9380923/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1582965412, "creation_date": 1554278454, "last_edit_date": 1582965412, "question_id": 55489971, "link": "https://stackoverflow.com/questions/55489971/error-accessing-file-network-connection-may-have-been-lost", "title": "Error accessing file. Network connection may have been lost", "body": "<p>So I am using VBA code to open a Excel file, and download data into the worksheet that contains the code. </p>\n\n<p>It worked, now I get the error:</p>\n\n<blockquote>\n  <p>Error accessing file. Network connection may have been lost.</p>\n</blockquote>\n\n<p>I opened the code to see where it is falling. (I thought maybe the file has changed location or the name has been changed.) When I go through the code (using F8), I immediately get the error on the first line of code (SUB TITLE) and it is marked yellow.</p>\n"}, {"tags": ["excel", "vba", "ibm-watson"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1554281282, "post_id": 55489440, "comment_id": 97689217, "body": "This is kind of unrelated but a question and answer component to Watson, is it built in or is it a &quot;built from the ground up&quot; AI model that you need to work on yourself?  I ask because if you want an AI based Q&amp;A service, you should look at Microsoft&#39;s QnAMaker.  The doco is sound and the usage is easy and amazing!  Just a thought.  Maybe you&#39;re bound to Watson, I don&#39;t know."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1554281995, "post_id": 55489440, "comment_id": 97689660, "body": "... better yet, create a chat bot. :-)"}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 1, "creation_date": 1554284824, "post_id": 55489440, "comment_id": 97691373, "body": "Hi Skin, its actually a series of external questionnaires I receive on a regular basis (mostly in word or pdf). I need to reply the questions and send them back in word/pdf back. I have a very large library of responses and the questions (100+) are almost always similar) so I just need to identify the questions and match it with a previous answer. I will look at the QnAMaker as it would be great to be integrated in the MS Office sweet but I want to explore options. IBM Watson looks to have the functionality needed so I would like to have a running version. Thanks for your comments"}, {"owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1554294651, "post_id": 55489440, "comment_id": 97697545, "body": "The QnAMaker looks great but I cannot find any excel/vba examples similar to watson on how to connect. Would you have any ideas?"}], "owner": {"reputation": 154, "user_id": 6820783, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/45aaf803e8a4c9eff9e9a82600149531?s=128&d=identicon&r=PG&f=1", "display_name": "Freelancer", "link": "https://stackoverflow.com/users/6820783/freelancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570539945, "creation_date": 1554276676, "last_edit_date": 1554284576, "question_id": 55489440, "link": "https://stackoverflow.com/questions/55489440/how-to-connect-excel-with-ibm-watson", "title": "How to connect excel with IBM Watson", "body": "<p>I receive a document with questions on a regular basis (I have the answers from previous iterations. the questions are always similar) and I would like to automate the replies.\nI am trying to connect an excel sheet to IBM watson so that I can try to teach it to answer the questions.\nI am using the code below to connect to watson but I receive the following error and I am not sure why: \n\"#ERROR: 401 - {\"code\":401, \"error\": \"Unauthorized\"}\"</p>\n\n<p>I think it has to do with the syntax of my credentials but I cannot find any support examples.</p>\n\n<p>Any help is appreciated.An example would be ideal. Thank you!</p>\n\n<pre><code>Function INTENT(query As String) As String\n' IBM WATSON conversation service\n\nIf Len(query) &gt; 0 Then 'If query is not empty\n    Dim xmlhttp As New MSXML2.XMLHTTP60, workspaceID As String, workspaceURL As String, authUsername As String, authPassword As String, response As String, body As String\n\n    ' WATSON Conversation Credentials\n    **workspaceID = \"a53a2519-30c5-47d5-a98b-cac2bf22fc5c\"**\n    'The API key from the first page of the project\n\n    workspaceURL = \"https://gateway.watsonplatform.net/assistant/api/v1/workspaces/\" + workspaceID + \"/message?version=2018\u201307\u201310\" 'API requests require a version parameter\n    **authUsername = \"apikey\"\n    authPassword = \"luVydRf_mxwAxvLHu0kFvTnIQMJttDLGnoMYSDkhpCrx\"**\n\n\n    body = \"{\"\"input\"\":{\"\"text\"\":\"\" \" + Replace(query, Chr(34), \"\") + \" \"\"}}\" 'The user input in JSON format. Also removed double quotes from input\n\n    xmlhttp.Open \"POST\", workspaceURL, False, authUsername, authPassword\n    xmlhttp.setRequestHeader \"Content-Type\", \"application/json\"\n\n    xmlhttp.Send body\n\n    If xmlhttp.Status = 200 Then 'Request success\n        response = xmlhttp.responseText\n        INTENT = parseINTENT(response)\n    Else 'Request fail\n        INTENT = \"#ERROR: \" &amp; xmlhttp.Status &amp; \" - \" &amp; xmlhttp.responseText\n    End If\nEnd If\nEnd Function\n\nFunction parseINTENT(text As String) As String\n'Parse intent and confidence from JSON response\n\nDim p1 As Integer, p2 As Integer\n\np1 = InStr(text, \"[{\" + Chr(34) + \"intent\")\np2 = InStr(p1, text, \"}]\")\nparseINTENT = Mid(text, p1, (p2 - p1) + 2)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554276838, "post_id": 55489327, "comment_id": 97686665, "body": "Why would you need to filter? I believe that you could drive your code by the lines of... Get everything you need to sum on the sheet and just a <code>SUMIF</code>. Am I getting something wrong where you need the filters?"}, {"owner": {"reputation": 63, "user_id": 11300112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf51e6d0d2925072734a66c6ed73657?s=128&d=identicon&r=PG&f=1", "display_name": "ronald1993", "link": "https://stackoverflow.com/users/11300112/ronald1993"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554279960, "post_id": 55489327, "comment_id": 97688458, "body": "Hello, sorry for the late respond, and thankyou for writing that code down there! It just felt like I had to do this with VBA instead of an Excel formula. Due to my Excel being in my native language (Dutch) I often forget the easiest formulas."}, {"owner": {"reputation": 63, "user_id": 11300112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf51e6d0d2925072734a66c6ed73657?s=128&d=identicon&r=PG&f=1", "display_name": "ronald1993", "link": "https://stackoverflow.com/users/11300112/ronald1993"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554280095, "post_id": 55489327, "comment_id": 97688538, "body": "I do think SUMIFS will do the job for me though, if not I will defenitly come back and figure my way out with your code. Thanks alot for the fast reply though!"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1554280853, "post_id": 55489327, "comment_id": 97688958, "body": "If you think SUMIF won&#39;t do it, just try the code below. But I guess you need to do some ammend to the code regarding columns and so."}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1554279294, "last_edit_date": 1554279294, "creation_date": 1554278204, "answer_id": 55489896, "question_id": 55489327, "link": "https://stackoverflow.com/questions/55489327/a-double-looped-autofilter-does-that-work-in-excel-vba/55489896#55489896", "title": "A double looped autofilter, does that work in Excel VBA?", "body": "<p>Couldn't test this, but I think it should work, at least until the splitting part (if something goes wrong you could find another way, or just use the interface option for texto to columns):</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim wsData  As Worksheet, wsOutput As Worksheet, arrData As Variant, SplitRange As Range, i As Long\n    'You will need to check Microsoft Scripting Dictionary from your references for this to work:\n    Dim DictColD As New Scripting.Dictionary, DictColE As New Scripting.Dictionary\n\n    'Set the worksheets where we will work\n    With ThisWorkbook\n        Set wsData = .Sheets(\"InformatieData\")\n        Set wsOutput = .Sheets(\"InformatieMMFilterResultaat\")\n    End With\n\n    'Fill an array with the source data\n    arrData = wsData.UsedRange.Value 'this will get everything on the worksheet till the last used cell\n\n    'Lets assume, as you said that the order and position of the columns is A to E\n    For i = 2 To UBound(arrData) '2 because 1 is headers\n        'if the material with the thickness doesn't exist yet, add it along with its time on column D\n        If Not DictColD.Exists(arrData(i, 1) &amp; \"-\" &amp; arrData(i, 2)) Then\n            DictColD.Add arrData(i, 1) &amp; \"-\" &amp; arrData(i, 2), arrData(i, 4) 'Column D value\n        Else\n        'If the material with the thickness already exists, then sum its time on column D\n            DictColD(arrData(i, 1) &amp; \"-\" &amp; arrData(i, 2)) = DictColD(arrData(i, 1) &amp; \"-\" &amp; arrData(i, 2)) + arrData(i, 4)\n        End If\n\n        'Now the same for column E\n        'if the material with the thickness doesn't exist yet, add it along with its time on column E\n        If Not DictColE.Exists(arrData(i, 1) &amp; \"-\" &amp; arrData(i, 2)) Then\n            DictColE.Add arrData(i, 1) &amp; \"-\" &amp; arrData(i, 2), arrData(i, 5) 'Column E value\n        Else\n        'If the material with the thickness already exists, then sum its time on column E\n            DictColE(arrData(i, 1) &amp; \"-\" &amp; arrData(i, 2)) = DictColE(arrData(i, 1) &amp; \"-\" &amp; arrData(i, 2)) + arrData(i, 5)\n        End If\n    Next i\n\n    Erase arrData\n\n    'Now you've got 2 dictionaries along with all the data you need, you only need to throw it back to your sheet\n    With wsOutput 'I'm going to assume you already have the headers there so only the data will be pasted\n        .Cells(2, 1).Resize(DictColD.Count) = Application.Transpose(DictColD.Keys) 'Material &amp; Thickness\n        .Cells(2, 4).Resize(DictColD.Count) = Application.Transpose(DictColD.Items) 'Col D Times\n        .Cells(2, 5).Resize(DictColE.Count) = Application.Transpose(DictColE.Items) 'Col E Times\n        'Now we need to separate material &amp; thickness into 2 columns\n        Set SplitRange = .Range(\"A2\", .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, 1))\n        SplitRange.TextToColumns Destination:=SplitRange, DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n        :=\"-\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This should be fairly faster than your actual code since it's working everything on memory.</p>\n"}], "owner": {"reputation": 63, "user_id": 11300112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf51e6d0d2925072734a66c6ed73657?s=128&d=identicon&r=PG&f=1", "display_name": "ronald1993", "link": "https://stackoverflow.com/users/11300112/ronald1993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556898312, "creation_date": 1554276296, "last_edit_date": 1556898312, "question_id": 55489327, "link": "https://stackoverflow.com/questions/55489327/a-double-looped-autofilter-does-that-work-in-excel-vba", "title": "A double looped autofilter, does that work in Excel VBA?", "body": "<p>I've got a set of data from a database imported into an Excel file. This data is from a laser cutter machine for metal. The data I have includes material name, plate thickness and 2 different times (There's more data but those 4 are the ones I need).</p>\n\n<p>The result I want:\nI want to filter my data on material name first, after that I want to filter my data on plate thickness. In the results of this second filter I want to SUM the time of both timefields and then post the outcome of this in another sheet. So the result in the second sheet should be: Material name, plate thickness, total time of the results in column D, total time of the results in Column E (There is some data in other columns which is irrelevant for this) </p>\n\n<p>Here's a small example of what the data looks like (Data starts on row 3):</p>\n\n<pre><code>Material name(col A)Plate Thickness(col B)Time1(col D)Time2(col E)\nRVS 304             25mm                  00:18:14    00:21:48\nRVS 304             25mm                  00:30:28    00:39:19\nRVS 304             10mm                  00:12:10    00:14:25\nS235                10mm                  00:48:32    00:13:33\nS235                3mm                   00:10:31    00:02:22\n</code></pre>\n\n<p>Some other useful information:\nThe Material name my loop is based on is based on my results and filtered on duplicates, so the material name always exists. Plate thickness has a standard amount of items the amount of items in this range is 19 different sizes in millimeters. My lists of filter criteria start on Cell 2, that's why the integer starts from 2 aswell. The result of both autofilters can result in nothing, as not every material name has done every plate thickness.</p>\n\n<p>Something to add on my current code:\nIt almost does the job, alltho it skips some items in the loop through the list of material names and it can't sum up the time. It is also extremely slow so I would like to know if I could make it run faster.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub TestSub()\nOn Error Resume Next\n    Worksheets(\"InformatieData\").ShowAllData\nOn Error GoTo 0\nDim iLoop As Integer\n\nFor iLoop = 1 To 20\n\nWorksheets(\"InformatieData\").Range(\"A2\").AutoFilter Field:=1, Criteria1:=Worksheets(\"InformatieFormules\").Cells(iLoop, 1).Value\nIf Worksheets(\"InformatieData\").AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n    Dim mmLoop As Integer\n\n    For mmLoop = 2 To 20\n        Worksheets(\"InformatieData\").Range(\"A2\").AutoFilter Field:=2, Criteria1:=Worksheets(\"InformatieFormules\").Cells(mmLoop, 2).Value\n        If Worksheets(\"InformatieData\").AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n            Worksheets(\"InformatieData\").Range(\"A3:A10000,B3:B10000,D3:D10000,E3:E10000\").Copy\n            Worksheets(\"InformatieMMFilterResultaat\").Cells(Cells.Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteValues)\n        End If\n    Next mmLoop\nEnd If\nNext iLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554298440, "post_id": 55488149, "comment_id": 97700010, "body": "Do you really mean a regular expression (RegEx) or do you mean Word&#39;s built-in wildcard search? The two are <i>not</i> the same and usually it makes no sense to use RegEx in Word since it can only be applied to strings and not Word&#39;s document content."}, {"owner": {"reputation": 97, "user_id": 10022212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8709c0918da0357d08633c2c238bf?s=128&d=identicon&r=PG&f=1", "display_name": "AsiB", "link": "https://stackoverflow.com/users/10022212/asib"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554324715, "post_id": 55488149, "comment_id": 97714355, "body": "you right! I need it to Word&#39;s built-in wildcard search"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1554324745, "post_id": 55488149, "comment_id": 97714370, "body": "@AsiB This site is not a free coding service. You are expected to invest some meaningful effort of your own. I&#39;ve already given you most of the code you need for this task in another answer: <a href=\"https://stackoverflow.com/questions/55455086/word-find-and-replace-text-via-text-in-quotation-marks\" title=\"word find and replace text via text in quotation marks\">stackoverflow.com/questions/55455086/&hellip;</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1554325600, "post_id": 55488149, "comment_id": 97714690, "body": "You can use the <a href=\"https://stackoverflow.com/posts/55488149/edit\">edit</a> link below a question to add or correct information in the question, itself. Information in comments tends to get overlooked..."}, {"owner": {"reputation": 97, "user_id": 10022212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8709c0918da0357d08633c2c238bf?s=128&d=identicon&r=PG&f=1", "display_name": "AsiB", "link": "https://stackoverflow.com/users/10022212/asib"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1554361564, "post_id": 55488149, "comment_id": 97724761, "body": "@macropod I did invest without success"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1554420639, "post_id": 55488149, "comment_id": 97756687, "body": "So show us what you <i>tried</i>. It&#39;s a trivial change to the code I posted in the other thread..."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 10022212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8709c0918da0357d08633c2c238bf?s=128&d=identicon&r=PG&f=1", "display_name": "AsiB", "link": "https://stackoverflow.com/users/10022212/asib"}, "edited": false, "score": 0, "creation_date": 1554323338, "post_id": 55488237, "comment_id": 97713762, "body": "almost... for example in the following string sample: X&#39;dfgdfgd &#39;abcd &#39;X fgt&#39;asdsw&#39;   the result should be &#39;abcd &#39;X fgt&#39; and not &#39;&#39;abcd &#39;X fgt&#39;asdsw&#39;&#39;"}, {"owner": {"reputation": 97, "user_id": 10022212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8709c0918da0357d08633c2c238bf?s=128&d=identicon&r=PG&f=1", "display_name": "AsiB", "link": "https://stackoverflow.com/users/10022212/asib"}, "edited": false, "score": 0, "creation_date": 1554324633, "post_id": 55488237, "comment_id": 97714316, "body": "BTW: another problem is that I need it to work in VB macro and not  RegEx (sorry if i mislead in advance)"}], "tags": [], "owner": {"reputation": 2382, "user_id": 1921115, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/97299e35c8578b544c419bcd0e999fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Jobelle", "link": "https://stackoverflow.com/users/1921115/jobelle"}, "is_accepted": false, "score": 0, "last_activity_date": 1554272032, "creation_date": 1554272032, "answer_id": 55488237, "question_id": 55488149, "link": "https://stackoverflow.com/questions/55488149/regular-expression-text-in-quotation-marks/55488237#55488237", "title": "regular expression Text in quotation marks", "body": "<p>Try this regExp</p>\n\n<pre><code>[^X]('[\\w\\s']*')\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/Vl1poF/1\" rel=\"nofollow noreferrer\">Test here</a></p>\n"}], "owner": {"reputation": 97, "user_id": 10022212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8709c0918da0357d08633c2c238bf?s=128&d=identicon&r=PG&f=1", "display_name": "AsiB", "link": "https://stackoverflow.com/users/10022212/asib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554358934, "creation_date": 1554271658, "last_edit_date": 1554358934, "question_id": 55488149, "link": "https://stackoverflow.com/questions/55488149/regular-expression-text-in-quotation-marks", "title": "regular expression Text in quotation marks", "body": "<p>I need a  built-in wildcard search (Ms-word) that collects the text between quotation mark, BUT the beginning of the quotation mark should not start with X letter (before the quotation) and the end should not end with X letter (before the quotation).\nfor example:</p>\n\n<blockquote>\n  <p><strong>X'dfgdfgd 'abcd 'X fgt'1234'5</strong></p>\n</blockquote>\n\n<p>should return the string: </p>\n\n<blockquote>\n  <p><strong>abcd 'X fgt</strong>\n  i.e this first shortest string that matches the criteria</p>\n</blockquote>\n\n<p>I have the following reg expression</p>\n\n<blockquote>\n  <p>\"[\u2018'][!^13^l^t]@['\u2019]\"</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>\"(\\'*?\\')\"</p>\n</blockquote>\n\n<p>but from here I could not succeed in progress to my goal.</p>\n\n<p>Thank you in advance!\nAsi</p>\n"}, {"tags": ["excel", "vba", "text", "format"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1554268769, "post_id": 55487448, "comment_id": 97683494, "body": "ASCII art often relies on a mono-spaced (non-proportional) font, which is not what Msgbox uses..."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1554268939, "post_id": 55487448, "comment_id": 97683535, "body": "@SiddharthRout to be clear, I&#39;m copying to the NOTE or yellow tab in the cell, which seems more text friendly than the cell."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554268974, "post_id": 55487448, "comment_id": 97683542, "body": "Thanks @TimWilliams. I wasn&#39;t familiar with the term &quot;Mono-spaced&quot; but I suspect that may be the issue. I&#39;ll do some searches using that term and see if I find anything."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1554269059, "post_id": 55487448, "comment_id": 97683560, "body": "What you want from Msgbox (to change the default font) is not straightforward - <a href=\"https://www.google.com/search?q=vba+change+msgbox+font+site:stackoverflow.com\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554269685, "post_id": 55487448, "comment_id": 97683767, "body": "Thanks @TimWilliams. I know the best solution is just to use a form, but I was hoping there might be a way to drop it into the standard msgbox. It does look like the comment note is messing with the spacing FIRST, but even if I play around with basic text lines in VBA, it seems to scew them... If you want to post this as an answer, I&#39;ll accept it in a day or two unless someone finds something that works."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1554273339, "post_id": 55487448, "comment_id": 97685030, "body": "Storing text in a comment doesn&#39;t affect the content - if you switch the comment font to (eg) Courier it will look &quot;correct&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1554329736, "last_edit_date": 1554329736, "creation_date": 1554282609, "answer_id": 55491316, "question_id": 55487448, "link": "https://stackoverflow.com/questions/55487448/how-to-get-ascii-text-art-formatted-properly-for-excel-msgbox/55491316#55491316", "title": "How to get Ascii Text Art Formatted Properly For Excel MsgBox", "body": "<p>As stated in comments: ASCII art often relies on a mono-spaced (non-proportional) font, which is not what the out-of-the-box <code>Msgbox</code> uses. So it's very difficult, if not impossible to do strictly with <code>MsgBox</code> tool.</p>\n\n<p>However, create your own <code>MsgBox</code> instead and call it whenever needed. Using <code>Courier</code> as the font for <code>Label1</code> (Courier IS mono-spaced).</p>\n\n<p><a href=\"https://i.stack.imgur.com/jLXFr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jLXFr.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\nPrivate Sub UserForm_Initialize()\n    Dim DispStr() As String\n\n    ReDim DispStr(1 To 26)\n\nDispStr(1) = \"                 uuuuuuu\"\nDispStr(2) = \"             uu$$$$$$$$$$$uu\"\nDispStr(3) = \"          uu$$$$$$$$$$$$$$$$$uu\"\nDispStr(4) = \"         u$$$$$$$$$$$$$$$$$$$$$u\"\nDispStr(5) = \"        u$$$$$$$$$$$$$$$$$$$$$$$u\"\nDispStr(6) = \"       u$$$$$$$$$$$$$$$$$$$$$$$$$u\"\nDispStr(7) = \"       u$$$$$$$$$$$$$$$$$$$$$$$$$u\"\nDispStr(8) = \"       u$$$$$$\"\"   \"\"$$$\"\"   \"\"$$$$$$u\"\nDispStr(9) = \"       \"\"$$$$\"\"      u$u       $$$$\"\"\"\nDispStr(10) = \"        $$$u       u$u       u$$$\"\nDispStr(11) = \"        $$$u      u$$$u      u$$$\"\nDispStr(12) = \"         \"\"$$$$uu$$$   $$$uu$$$$\"\"\"\nDispStr(13) = \"          \"\"$$$$$$$\"\"   \"\"$$$$$$$\"\"\"\nDispStr(14) = \"            u$$$$$$$u$$$$$$$u\"\nDispStr(15) = \"             u$\"\"$\"\"$\"\"$\"\"$\"\"$\"\"$u\"\nDispStr(16) = \"  uuu        $$u$ $ $ $ $u$$       uuu\"\nDispStr(17) = \" u$$$$        $$$$$u$u$u$$$       u$$$$\"\nDispStr(18) = \"  $$$$$uu      \"\"$$$$$$$$$\"\"     uu$$$$$$\"\nDispStr(19) = \"u$$$$$$$$$$$uu    \"\"\"\"\"\"\"\"\"\"    uuuu$$$$$$$$$$\"\nDispStr(20) = \"$$$$\"\"\"\"\"\"$$$$$$$$$$uuu   uu$$$$$$$$$\"\"\"\"\"\"$$$\"\"\"\nDispStr(21) = \"\"\"\"\"\"\"      \"\"\"\"$$$$$$$$$$$uu \"\"\"\"$\"\"\"\"\"\"\"\nDispStr(22) = \"           uuuu \"\"\"\"$$$$$$$$$$uuu\"\nDispStr(23) = \"  u$$$uuu$$$$$$$$$uu \"\"\"\"$$$$$$$$$$$uuu$$$\"\nDispStr(24) = \"  $$$$$$$$$$\"\"\"\"\"\"\"\"           \"\"\"\"$$$$$$$$$$$\"\"\"\nDispStr(25) = \"   \"\"$$$$$\"\"                      \"\"\"\"$$$$\"\"\"\"\"\nDispStr(26) = \"     $$$\"\"                         $$$$\"\"\"\n\nMe.Label1.Caption = Join(DispStr, vbNewLine)\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qyIUf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qyIUf.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can obviously play around with the formatting yourself to get the end result that you want</p>\n"}], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1370, "favorite_count": 1, "accepted_answer_id": 55491316, "answer_count": 1, "score": 1, "last_activity_date": 1554388243, "creation_date": 1554268007, "last_edit_date": 1554388243, "question_id": 55487448, "link": "https://stackoverflow.com/questions/55487448/how-to-get-ascii-text-art-formatted-properly-for-excel-msgbox", "title": "How to get Ascii Text Art Formatted Properly For Excel MsgBox", "body": "<p>A belated happy April 1st friends. Like most of you, I have always felt Excel lacked a Skull and Bones graphical image as part of the <code>vba</code> <code>MsgBox</code> routine. Frankly the red <code>vbCritical</code> just doesn't go far enough to alarm users when they've really done something horrible.</p>\n\n<p>So I thought, <em>enough is enough</em>, I need a SKULL! Many of my customers have a standard of professionalism that prevents me from making custom FORMS. Thus, not wanting to violate any codes of conduct, I considered graphical text options of ASCII SKULLS. A quick <a href=\"https://duckduckgo.com/?q=Skull+Art+Text+ASCII&amp;t=h_&amp;ia=web\" rel=\"nofollow noreferrer\">DuckDuck</a> search <a href=\"http://ascii.co.uk/art/skulls\" rel=\"nofollow noreferrer\">brought me some of the finest skull compilation art</a> on the web.</p>\n\n<p>At this point, I figured I was going to be in business but as you can see below, the <code>MsgBox</code> version of my <a href=\"https://pastebin.com/raw/nbnGLnNR\" rel=\"nofollow noreferrer\">favorite masterpiece</a> leaves much to be desired! Clearly, this won't alarm anyone... \ud83d\ude41</p>\n\n<p>I suspect the issue is the method I'm using to store the art (as <code>Comment.Text</code>) is formatting in some undesirable way. Is there a way to control this, or is there a better method to store text in Excel to preserve the text art format?</p>\n\n<p>My vba code is basic: <code>MsgBox Range(\"A1\").Comment.Text</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/Uv67s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uv67s.png\" alt=\"Not Scary Enough!\"></a></p>\n\n<p>Also.... it works great on SO!</p>\n\n<pre><code>                 uuuuuuu\n             uu$$$$$$$$$$$uu\n          uu$$$$$$$$$$$$$$$$$uu\n         u$$$$$$$$$$$$$$$$$$$$$u\n        u$$$$$$$$$$$$$$$$$$$$$$$u\n       u$$$$$$$$$$$$$$$$$$$$$$$$$u\n       u$$$$$$$$$$$$$$$$$$$$$$$$$u\n       u$$$$$$\"   \"$$$\"   \"$$$$$$u\n       \"$$$$\"      u$u       $$$$\"\n        $$$u       u$u       u$$$\n        $$$u      u$$$u      u$$$\n         \"$$$$uu$$$   $$$uu$$$$\"\n          \"$$$$$$$\"   \"$$$$$$$\"\n            u$$$$$$$u$$$$$$$u\n             u$\"$\"$\"$\"$\"$\"$u\n  uuu        $$u$ $ $ $ $u$$       uuu\n u$$$$        $$$$$u$u$u$$$       u$$$$\n  $$$$$uu      \"$$$$$$$$$\"     uu$$$$$$\nu$$$$$$$$$$$uu    \"\"\"\"\"    uuuu$$$$$$$$$$\n$$$$\"\"\"$$$$$$$$$$uuu   uu$$$$$$$$$\"\"\"$$$\"\n \"\"\"      \"\"$$$$$$$$$$$uu \"\"$\"\"\"\n           uuuu \"\"$$$$$$$$$$uuu\n  u$$$uuu$$$$$$$$$uu \"\"$$$$$$$$$$$uuu$$$\n  $$$$$$$$$$\"\"\"\"           \"\"$$$$$$$$$$$\"\n   \"$$$$$\"                      \"\"$$$$\"\"\n     $$$\"                         $$$$\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554268988, "post_id": 55487081, "comment_id": 97683545, "body": "A note on declaring variables in VBA - <code>Dim i, j, k, l As Integer</code> here only <code>l</code> is an Integer, and all the others are Variant.  You need to use <code>As [Type]</code> for every variable."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1554268233, "creation_date": 1554268233, "answer_id": 55487473, "question_id": 55487081, "link": "https://stackoverflow.com/questions/55487081/how-to-filter-multiple-columns-in-a-database-based-on-all-items-from-multiple-fo/55487473#55487473", "title": "How to filter multiple columns in a database based on all items from multiple form listboxes?", "body": "<p>You can do something like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim Db As ListObject\n    Dim n As Long\n    Dim arr, lb As MSForms.ListBox\n\n    Set Db = Sheets(6).ListObjects(\"Table1\")\n\n    Db.DataBodyRange.AutoFilter '&lt;&lt; clear filter\n\n    For n = 5 To 8\n        Set lb = Me.Controls(\"ListBox\" &amp; n) '&lt;&lt; get the list from its name\n        If lb.ListCount &gt; 0 Then            '&lt;&lt; ignore empty lists\n            arr = ListArray(lb)\n            Db.DataBodyRange.AutoFilter Field:=(n - 4), Criteria1:=arr, _\n                                        Operator:=xlFilterValues\n        End If\n    Next n\nEnd Sub\n\n'get list content as an array\nFunction ListArray(lst As Object) As Variant\n    Dim i As Long, arr()\n    If lst.ListCount &gt; 0 Then\n        ReDim arr(0 To lst.ListCount - 1)\n        For i = 0 To lst.ListCount - 1\n            arr(i) = lst.list(i)\n        Next i\n    End If\n    ListArray = arr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11303174, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3etNtlol7Ro/AAAAAAAAAAI/AAAAAAAABBo/7AAIVsvePdc/photo.jpg?sz=128", "display_name": "Mariapaudn", "link": "https://stackoverflow.com/users/11303174/mariapaudn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554268233, "creation_date": 1554265678, "question_id": 55487081, "link": "https://stackoverflow.com/questions/55487081/how-to-filter-multiple-columns-in-a-database-based-on-all-items-from-multiple-fo", "title": "How to filter multiple columns in a database based on all items from multiple form listboxes?", "body": "<p>I have a form with multiple listboxes. Listboxes 1 to 4 have a large items list. Listboxes 5 to 8 display the selected items from Listboxes 1 to 4 as follows: Listbox 5 shows the selected items from Listbox 1, Listbox 6 shows those selected from Listbox 2 and so on. </p>\n\n<p>I want to filter a database based on items on Listboxes 5 to 8. Listbox 5 is the critera to filter the first database column, listbox 6 is the critera for second column and so on.</p>\n\n<p>The below code is working but just if all Listboxes 5 to 8 have items on it. That means that if I left one or more of the Listboxes 5 to 8 empty the filter simply does not work and I got 0 records found. And thats not the idea.</p>\n\n<p>In other words: I want to get the database filtered even if I don't choose data from all the Listboxes 1 to 4. I have tried multiple things but nothing worked. Any ideas? Thanks in advance!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim Db As ListObject\nSet Db = Sheets(6).ListObjects(\"Database\")\n\nDim i, j, k, l As Integer\nDim x, y, z, s As Variant\n\n\n'Listbox 5 to column 1\n\n    ReDim x(0)\n    Application.ScreenUpdating = False\n\n    'For all items in the listbox\n    For i = 0 To ListBox5.ListCount - 1\n\n        x(UBound(x)) = Me.ListBox5.List(i)\n        ReDim Preserve x(UBound(x) + 1)\n    Next i\n\n    'Filter first column by the selected item\n    Db.DataBodyRange.AutoFilter Field:=1, Criteria1:=x, Operator:=xlFilterValues\n    Application.ScreenUpdating = True\n\n''''''''''''''''''''''''''''''''''''\n'Listbox 6 to column 2\n\n    ReDim y(0)\n    Application.ScreenUpdating = False\n\n    For j = 0 To ListBox6.ListCount - 1\n       y(UBound(y)) = Me.ListBox6.List(j)\n       ReDim Preserve y(UBound(y) + 1)\n\n    Next j\n\n    'Filter second column by the selected item\n    Db.DataBodyRange.AutoFilter Field:=2, Criteria1:=y, Operator:=xlFilterValues\n    Application.ScreenUpdating = True\n''''''''''''''''''''''''''''''''''''\n 'Listbox 7 to column 3\n\n    ReDim z(0)\n    Application.ScreenUpdating = False\n\n    For k = 0 To ListBox7.ListCount - 1\n       z(UBound(z)) = Me.ListBox7.List(k)\n       ReDim Preserve z(UBound(z) + 1)\n\n    Next k\n\n    'Filter second column by the selected item\n    Db.DataBodyRange.AutoFilter Field:=3, Criteria1:=z, Operator:=xlFilterValues\n    Application.ScreenUpdating = True\n\n''''''''''''''''''''''''''''''''''''\n 'Listbox 8 to column 4\n\n    ReDim s(0)\n    Application.ScreenUpdating = False\n\n    For l = 0 To ListBox8.ListCount - 1\n       s(UBound(s)) = Me.ListBox8.List(l)\n       ReDim Preserve s(UBound(s) + 1)\n\n    Next l\n\n    'Filter second column by the selected item\n    Db.DataBodyRange.AutoFilter Field:=4, Criteria1:=s, Operator:=xlFilterValues\n    Application.ScreenUpdating = True    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10560874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21541b02bbf7ce0b31ebb9e32fa2b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Speeece", "link": "https://stackoverflow.com/users/10560874/speeece"}, "edited": false, "score": 0, "creation_date": 1554308704, "post_id": 55487218, "comment_id": 97706601, "body": "I dont think formulas will work because i want changes to be reflected regardless of page. Eg. I edit something on sheet1, cell A2 and the change is shown on sheet2, cell A2. It should also work in reverse. If i change something on sheet2, cell A2, the change is shown on sheet1, cell A2."}], "tags": [], "owner": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "is_accepted": false, "score": 1, "last_activity_date": 1554266572, "creation_date": 1554266572, "answer_id": 55487218, "question_id": 55486934, "link": "https://stackoverflow.com/questions/55486934/how-to-mirror-columns-on-different-sheets-with-one-sheet-having-additional-text/55487218#55487218", "title": "How to mirror columns on different sheets with one sheet having additional text in front", "body": "<p>you can achieve it without a macro. On Sheet2, apply formula corresponding to Sheet1 cells.</p>\n\n<pre><code>=MID(Sheet1!A1,FIND(\".\",Sheet1!A1)+1,LEN(Sheet1!A1)-1)\n</code></pre>\n\n<p>i have taken the first example (Vehicle.Silverado --> Silverado)</p>\n\n<p>Just copy the formulas to the entire range as required.</p>\n\n<p>Incase you want to achieve it at the click of a button or running a macro, try applying the above formula inside the code.</p>\n\n<p>Hope this helps !</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10560874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21541b02bbf7ce0b31ebb9e32fa2b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Speeece", "link": "https://stackoverflow.com/users/10560874/speeece"}, "edited": false, "score": 0, "creation_date": 1554308700, "post_id": 55487349, "comment_id": 97706596, "body": "I dont think formulas will work because i want changes to be reflected regardless of page. Eg. I edit something on sheet1, cell A2 and the change is shown on sheet2, cell A2. It should also work in reverse. If i change something on sheet2, cell A2, the change is shown on sheet1, cell A2."}], "tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": false, "score": 1, "last_activity_date": 1554267330, "creation_date": 1554267330, "answer_id": 55487349, "question_id": 55486934, "link": "https://stackoverflow.com/questions/55486934/how-to-mirror-columns-on-different-sheets-with-one-sheet-having-additional-text/55487349#55487349", "title": "How to mirror columns on different sheets with one sheet having additional text in front", "body": "<p>I've just done it on the same sheet for demonstration purposes but maybe the <strong>SUBSTITUTE</strong> formula will help you out?</p>\n\n<p><a href=\"https://i.stack.imgur.com/9hAcY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9hAcY.png\" alt=\"enter image description here\"></a></p>\n\n<p>It assumes that you always want to replace the text of <code>Vehicle.</code> but maybe that works for you?</p>\n"}], "owner": {"reputation": 1, "user_id": 10560874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21541b02bbf7ce0b31ebb9e32fa2b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Speeece", "link": "https://stackoverflow.com/users/10560874/speeece"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554324499, "creation_date": 1554264502, "last_edit_date": 1554324499, "question_id": 55486934, "link": "https://stackoverflow.com/questions/55486934/how-to-mirror-columns-on-different-sheets-with-one-sheet-having-additional-text", "title": "How to mirror columns on different sheets with one sheet having additional text in front", "body": "<p>I have one sheet (Sheet1) that requires an identifier in front of the value. I have another sheet (Sheet2) that I want to show without the identifier. I would like columns to mirror each other with Sheet1 showing the identifier and Sheet2 not.</p>\n\n<p>I currently have data validation for Sheet2 that allows for multiple values separated by \"|\". These values are mirroring to Sheet1 but no identifier is being added. Im not sure at what point i should add the identifier. I have tried adding/removing the identifier in the mirroring subs but i keep getting errors. Im not too good at debugging either.  </p>\n\n<p>The problem with using formulas is that I need to be able to edit either sheet with the change showing on the other.</p>\n\n<pre><code>Sub Sheet2_to_Sheet1(ByVal Target As Range, rng As String, rngTo As String)\n\nDim r1 As Range, r2 As Range\nDim iden As String\niden = \"Vehicle\"\nSet r1 = Range(rng)\nSet r2 = Sheets(\"Sheet1\").Range(rngTo)\nIf Intersect(Target, r1) Is Nothing Then Exit Sub\nApplication.EnableEvents = False\n    r2.value = r1.value\nApplication.EnableEvents = True\n\nEnd Sub\n\n\nSub Sheet1_to_Sheet2(ByVal Target As Range, rng As String, rngTo As String, Optional identifier As String)\n\nDim r1 As Range, r2 As Range\nSet r1 = Range(rng)\nSet r2 = Sheets(\"Sheet2\").Range(rngTo)\nIf Intersect(Target, r1) Is Nothing Then Exit Sub\nApplication.EnableEvents = False\n    r2.value = r1.value\nApplication.EnableEvents = True\n\n\nEnd Sub\n</code></pre>\n\n<p>I would like to have for example:</p>\n\n<p>Sheet1, Row 1, Column A = Vehicle.Silverado</p>\n\n<p>Sheet2, Row 1, Column A = Silverado</p>\n\n<p>or </p>\n\n<p>Sheet1, Row 1, Column A = Vehicle.Silverado|Vehicle.Camaro</p>\n\n<p>Sheet2, Row 1, Column A = Silverado|Camaro</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554263163, "post_id": 55486723, "comment_id": 97682166, "body": "Without seeing what <code>RDB_Create_PDF</code> does it&#39;s hard to debug further."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554269586, "post_id": 55486723, "comment_id": 97683737, "body": "<a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/officetalk2010/ee834871(v%3Doffice.11)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/developer/&zwnj;&#8203;&hellip;</a>   Try debugging that function and find out why the return value is an empty string.  Doesn&#39;t look like the issue is with the code you posted."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1554270071, "post_id": 55486723, "comment_id": 97683864, "body": "Something that strikes me is the <code>Environ(&quot;Username&quot;)</code> or perhaps the complete line <code>FixedFilePathName:=&quot;C:\\Users\\&quot; &amp; Environ(&quot;Username&quot;) &amp; &quot;\\Documents\\Container Shipment Reports\\&quot; &amp; (Range(&quot;G4&quot;).Value) &amp; &quot;.pdf&quot;</code> is that a valid path? <code>deubg.print FixedFilePathName:=&quot;C:\\Users\\&quot; &amp; Environ(&quot;Username&quot;) &amp; &quot;\\Documents\\Container Shipment Reports\\&quot;</code> and see if you can paste it in explorer without problems? Why is <code>... &amp; (Range(&quot;G4&quot;).Value) &amp; &quot;.pdf&quot;</code> enclosed in <code>()</code>?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1554275533, "post_id": 55486723, "comment_id": 97686019, "body": "Have you tried running the code with VBA Error Trapping set to &quot;Break on All Errors&quot; so that you see where the code fails? Finding out where it isn&#39;t working is key to solving the problem."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1554281029, "post_id": 55486723, "comment_id": 97689078, "body": "Do not use <code>&quot;C:\\Users\\&quot; &amp; Environ(&quot;Username&quot;)</code>. Use <code>Environ(&quot;UserProfile&quot;)</code>. The user folder is not always on C:, and its name is not always identically to the username."}, {"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1554334552, "post_id": 55486723, "comment_id": 97717383, "body": "Thanks for the feedback. As I said, I&#39;m not having trouble with the code on other machines and it used to work fine on my PC. I just don&#39;t know what could have changed to make this stop working. I will try running the debugger and maybe it will let me know what&#39;s happening."}, {"owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "edited": false, "score": 0, "creation_date": 1559801465, "post_id": 55486723, "comment_id": 99534217, "body": "I am having no luck with this at all. The form works on other people&#39;s PCs but not mine where it was created. My computer died and was replaced and the new pc worked fine. Now the new PC is doing the same thing."}], "owner": {"reputation": 31, "user_id": 4101530, "user_type": "registered", "profile_image": "https://graph.facebook.com/552234776/picture?type=large", "display_name": "Peter Peazy Littlefield", "link": "https://stackoverflow.com/users/4101530/peter-peazy-littlefield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554263056, "creation_date": 1554262936, "last_edit_date": 1554263056, "question_id": 55486723, "link": "https://stackoverflow.com/questions/55486723/is-there-any-reason-a-vba-sub-would-stop-working-only-on-my-pc", "title": "Is there any reason a VBA sub would stop working only on my PC?", "body": "<p>I have a function (bastardised from Ron DeBruin's Website) that saves the active or selected sheet as a pdf and sends it as an attachment in outlook. It still works for everyone I've given it to but lately, it is not working on my PC. I keep getting the error message as if VBA cannot save the file (due to the path being invalid or the name being used already and not wanting to overwrite)</p>\n\n<p>Running on various PCs that are either running on Windows 10 or 7 (I'm on Win10) I've tried changing the save file path &amp; the filename in the code to something more simple and I still have the same issues. I tried the file on another machine running windows 10 and had no issues. I've also tried checking Microsoft Add-Ins and everything is fine.</p>\n\n<p>''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''</p>\n\n<pre><code>Sub RDB_Worksheet_Or_Worksheets_To_PDF_And_Create_Mail()\n    Dim FileName As String\n\n    If ActiveWindow.SelectedSheets.Count &gt; 1 Then\n        MsgBox \"There is more than one sheet selected,\" &amp; vbNewLine &amp; _\n               \"be aware that every selected sheet will be published\"\n    End If\n\n    'Call the function with the correct arguments\n    'Tip: You can also use Sheets(\"YourSheetName\") instead of ActiveSheet in the code(sheet does not have to be active then)\n\n    FileName = RDB_Create_PDF(Source:=ActiveSheet, _\n                              FixedFilePathName:=\"C:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\Documents\\Container Shipment Reports\\\" &amp; (Range(\"G4\").Value) &amp; \".pdf\", _\n                              OverwriteIfFileExist:=True, _\n                              OpenPDFAfterPublish:=False)\n\n    'For a fixed file name use this in the FixedFilePathName argument\n    'FixedFilePathName:=\"C:\\Users\\Ron\\Test\\YourPdfFile.pdf\"\n\n\n    If FileName &lt;&gt; \"\" Then\n        RDB_Mail_PDF_Outlook FileNamePDF:=FileName, _\n                             StrTo:=\"XXXXXX.XXXXXXX@XXXXX.com.au\", _\n                             StrCC:=\"XXXXXX.XXXXXXX@XXXXX.com.au; XXXXXX.XXXXXXX@XXXXX.com.au\", _\n                             StrBCC:=\"\", _\n                             StrSubject:=\"Container Shipment Report \" &amp; (Range(\"G4\").Value) &amp; \".\", _\n                             Signature:=True, _\n                             Send:=False, _\n                             StrBody:=\"&lt;body&gt;Hello,&lt;/body&gt;&lt;br&gt;\" &amp; _\n                                      \"&lt;body&gt;Please see the attached Container Shipment Report# \" &amp; (Range(\"G4\").Value) &amp; \" from \" &amp; (Range(\"E4\").Value) &amp; \".\" &amp; _\n                                      \"&lt;br&gt;&lt;br&gt;\" &amp; \"Thank you.&lt;/body&gt;\"\n    Else\n        MsgBox \"Not possible to create the PDF, possible reasons:\" &amp; vbNewLine &amp; _\n               \"Microsoft Add-in is not installed\" &amp; vbNewLine &amp; _\n               \"You Canceled the GetSaveAsFilename dialog\" &amp; vbNewLine &amp; _\n               \"The path to Save the file in arg 2 is not correct\" &amp; vbNewLine &amp; _\n               \"You didn't want to overwrite the existing PDF if it exists\"\n\nEnd If\n\nApplication.Quit\n\nEnd Sub\n</code></pre>\n\n<p>''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''</p>\n\n<p>This should convert to PDF, attach to an email, send the email and then close Excel. At the moment I am just getting the MsgBox response from the code, \"Not possible to create PDF, possible reasons: etc\".\n(there is also a function to stop the excel file saving as it is meant to be a blank template.) As I said this seems to be an issue only on my machine but as it works on other computers I'm thinking there's no issue with the code.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "is_accepted": false, "score": 1, "last_activity_date": 1554266056, "creation_date": 1554266056, "answer_id": 55487135, "question_id": 55486479, "link": "https://stackoverflow.com/questions/55486479/how-to-merge-filled-row-until-find-the-blank-cell-repeatedly/55487135#55487135", "title": "How to merge filled row until find the blank cell repeatedly", "body": "<p>Based on your image something like this should work...</p>\n\n<pre><code>Option Explicit\nSub merge()\n\nDim arr() As Variant\nDim i As Long\nDim a As Integer\nDim ColALastRow As Long\nDim FRow As Long\n\nColALastRow = ThisWorkbook.Sheets(\"Sheet1\").UsedRange.Rows.Count\nFRow = 0\na = 0\n\nFor i = 1 To ColALastRow\n\nDo While ThisWorkbook.Sheets(\"Sheet1\").Cells(i, 1) &lt;&gt; vbNullString\nReDim Preserve arr(0 To a) As Variant\nFRow = FRow + 1\narr(a) = ThisWorkbook.Sheets(\"Sheet1\").Cells(i, 1)\ni = i + 1\na = a + 1\nLoop\n\nIf Len(Join(arr, \"\")) &lt;&gt; 0 Then\nThisWorkbook.Sheets(\"Sheet1\").Cells(i - FRow, 2) = Join(arr, \";\")\nFRow = 0\na = 0\nErase arr\nEnd If\n\nNext\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1554274230, "last_edit_date": 1554274230, "creation_date": 1554273481, "answer_id": 55488576, "question_id": 55486479, "link": "https://stackoverflow.com/questions/55486479/how-to-merge-filled-row-until-find-the-blank-cell-repeatedly/55488576#55488576", "title": "How to merge filled row until find the blank cell repeatedly", "body": "<p>Here is another technique that should be faster than looping throug all rows.</p>\n\n<p>First of all this starst at the end of the sheet and loops backwards.\nThis technique uses the <code>.End(xlUp)</code> method to jump over the empty rows to the next data and then uses <code>.CurrentRegion</code> to find all data until the next empty cell to then join it.</p>\n\n<p>Because it jumps over the empty areas it should be faster that looping through all of the cells.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub MergeConinousCells()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim RangeToJoin As Range\n    Set RangeToJoin = ws.Cells(ws.Rows.Count, \"A\") 'initialize with very last cell\n\n    Do Until RangeToJoin.Row &lt;= 1 'loop until we reach the first row\n        Set RangeToJoin = RangeToJoin.Offset(RowOffset:=-1).Resize(RowSize:=1).End(xlUp).CurrentRegion.Resize(ColumnSize:=1)\n        If RangeToJoin.Rows.Count &gt; 1 Then 'if more than one cell in this area then join them\n            ws.Cells(RangeToJoin.Row, \"C\").Value = Join(WorksheetFunction.Transpose(RangeToJoin), \";\")\n        Else 'only one cell so transfer value only\n            ws.Cells(RangeToJoin.Row, \"C\").Value = RangeToJoin.Value\n        End If\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10481462, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8Dpx7K_ldUA/AAAAAAAAAAI/AAAAAAAABJA/WQ6Ox-rKZhA/photo.jpg?sz=128", "display_name": "Biyamin Razak", "link": "https://stackoverflow.com/users/10481462/biyamin-razak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55488576, "answer_count": 2, "score": -2, "last_activity_date": 1554274230, "creation_date": 1554261140, "last_edit_date": 1554271112, "question_id": 55486479, "link": "https://stackoverflow.com/questions/55486479/how-to-merge-filled-row-until-find-the-blank-cell-repeatedly", "title": "How to merge filled row until find the blank cell repeatedly", "body": "<p>I want to merge multiple filled row until found the blank row/cell. I guess you have to see the picture in order to understand my problem.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4uhY7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4uhY7.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554260394, "post_id": 55486123, "comment_id": 97681599, "body": "Your table names <code>Table4</code> and <code>Table6</code> are hard-coded too. Won&#39;t that be an issue as well?"}, {"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554262319, "post_id": 55486123, "comment_id": 97681979, "body": "I have not tested that part yet but the pages are going to be identical and it seems like table names are unique to that page so hoping I will not have a problem with that part."}, {"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554275360, "post_id": 55486123, "comment_id": 97685940, "body": "Yes after I tried it, It got an out of range or undifined error so good observation, any solution would be helpful."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554272892, "post_id": 55486253, "comment_id": 97684851, "body": "I guess it was just a partial answer the table numbers are unique and cannot be changed to the same name on a different page, Any way to find and assign a variable to that also."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554273739, "post_id": 55486253, "comment_id": 97685210, "body": "@Inoverhishead what if you prefix the table name on each sheet with the sheet name? If you do that, adjusting the logic is easy."}, {"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554275700, "post_id": 55486253, "comment_id": 97686104, "body": "Can I conacate or whatever that is called inside of the &quot; Table6 &quot; so it would be something like &quot;  &quot;table6&quot;  &amp; &quot;pagename&quot; &quot; as a varaible"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554275908, "post_id": 55486253, "comment_id": 97686201, "body": "@Inoverhishead yeah, as long g as you update each table on each sheet, you would then change your code to be instead of \u201cTable4\u201d, it be ActiveSheet.Name &amp; \u201cTable4\u201d"}, {"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554282333, "post_id": 55486253, "comment_id": 97689871, "body": "ActiveSheet.ListObjects(&quot;Table&quot; &amp; ActiveSheet.Name).Sort.SortFields.Add _             Key:=Range(&quot;Table &amp; ActiveSheet.Name[[#All],[Column2]]&quot;), SortOn:=xlSortOnValues, Order:= _             xlAscending, DataOption:=xlSortNormal"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554282442, "post_id": 55486253, "comment_id": 97689942, "body": "@Inoverhishead ... you&#39;re getting there.  You need to close a quote though on that.  So something like this ... ActiveSheet.ListObjects(&quot;Table&quot; &amp; ActiveSheet.Name).Sort.SortFields.Add _ Key:=Range(&quot;Table&quot; &amp; ActiveSheet.Name &amp; &quot;[[#All],[Column2]]&quot;), SortOn:=xlSortOnValues, Order:= _ xlAscending, DataOption:=xlSortNormal ... whenever you inject variables into a string, it should be like this ... &quot;This is the &quot; &amp; ActiveSheet.Name &amp; &quot; worksheet&quot;"}, {"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554282485, "post_id": 55486253, "comment_id": 97689969, "body": "That part of the code is saying&quot;&quot;  method  range of object ,,,   global failed"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554282631, "post_id": 55486253, "comment_id": 97690052, "body": "@Inoverhishead I made a typo and changed it, refresh and try again. If it still fails, send me the error."}, {"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554282653, "post_id": 55486253, "comment_id": 97690063, "body": "Only in front of the Key:= range part of the code  it expected a list seperater or )"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554282866, "post_id": 55486253, "comment_id": 97690184, "body": "@Inoverhishead can you paste your code in here again?"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 0, "creation_date": 1554284334, "post_id": 55486253, "comment_id": 97691067, "body": "@Inoverhishead I thought you might&#39;ve been getting there cos you went quiet.  Well done, you&#39;re officially a VBA programmer.  :-)"}, {"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 1, "creation_date": 1554284338, "post_id": 55486253, "comment_id": 97691070, "body": "Sub Macro6() &#39; &#39; Macro6 Macro &#39;  &#39;         ActiveSheet.ListObjects(&quot;Table&quot; &amp; ActiveSheet.Name).Sort.SortFields.Clear         ActiveSheet.ListObjects(&quot;Table&quot; &amp; ActiveSheet.Name).Sort.SortFields.Add _             Key:=Range(&quot;Table&quot; &amp; ActiveSheet.Name &amp; &quot;[[#All],[Column2]]&quot;), SortOn:=xlSortOnValues, Order:= _             xlAscending, DataOption:=xlSortNormal         With ActiveSheet.ListObjects(&quot;Table&quot; &amp; ActiveSheet.Name).Sort             .Header = xlYes             .MatchCase = False             .Orientation = xlTopToBottom             .SortMethod = xlPinYin             .Apply"}, {"owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "edited": false, "score": 1, "creation_date": 1554801476, "post_id": 55486253, "comment_id": 97875362, "body": "Not sure if it will help anyone but it was hard to go thru the name manger and pick out 6 tables for each sheet but started renaming them after the column they were in plus page name and made it a lot quicker to keep track of and name Column &amp; page name"}], "tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": true, "score": 1, "last_activity_date": 1554259845, "last_edit_date": 1554259845, "creation_date": 1554259543, "answer_id": 55486253, "question_id": 55486123, "link": "https://stackoverflow.com/questions/55486123/calling-identical-tables-on-different-pages/55486253#55486253", "title": "Calling identical tables on different pages", "body": "<p>This is untested but replace this ...</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"TRADE\")\n</code></pre>\n\n<p>... with this ...</p>\n\n<pre><code>ActiveSheet\n</code></pre>\n\n<p>(When I say \"untested\", I mean ActiveSheet should exist within the context whether it works holistcally across all code you change is another story, it's just a caveat to my answer.)</p>\n"}, {"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 1, "last_activity_date": 1554275901, "creation_date": 1554275901, "answer_id": 55489212, "question_id": 55486123, "link": "https://stackoverflow.com/questions/55486123/calling-identical-tables-on-different-pages/55489212#55489212", "title": "Calling identical tables on different pages", "body": "<p>The answer that Skin gave you is probably the best way to go, but here is an alternative one: replace the hard coded name with a variable, like so...</p>\n\n<pre><code>Dim wks As Worksheet\nSet wks = ActiveSheet\n</code></pre>\n\n<p>You would then need to replace each instant of the worksheet name with <code>wks.Name</code>. Your code would look something like this:</p>\n\n<pre><code>Dim wks As Worksheet\nSet wks = ActiveSheet\n\n    ActiveWorkbook.Worksheets(wks.Name).ListObjects(\"Table4\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(wks.Name).ListObjects(\"Table4\").Sort.SortFields.Add _\n        Key:=Range(\"Table4[[#All],[Column2]]\"), SortOn:=xlSortOnValues, Order:= _\n        xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(wks.Name).ListObjects(\"Table4\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    ActiveWorkbook.Worksheets(wks.Name).ListObjects(\"Table6\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(wks.Name).ListObjects(\"Table6\").Sort.SortFields.Add _\n        Key:=Range(\"Table6[[#All],[Column2]]\"), SortOn:=xlSortOnValues, Order:= _\n        xlDescending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(wks.Name).ListObjects(\"Table6\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11252512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c5a106d4bc29d8ffaeda05a22d90cb?s=128&d=identicon&r=PG&f=1", "display_name": "In over his head", "link": "https://stackoverflow.com/users/11252512/in-over-his-head"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55486253, "answer_count": 2, "score": 0, "last_activity_date": 1554275901, "creation_date": 1554258212, "last_edit_date": 1554274659, "question_id": 55486123, "link": "https://stackoverflow.com/questions/55486123/calling-identical-tables-on-different-pages", "title": "Calling identical tables on different pages", "body": "<p>I recorded a macro and to sort a table on one page it assigns a page name, I would like to set it as a variable so it would do the same thing on what ever active page it is on.</p>\n\n<p>I have a named cell that reflects the page name and tried putting that in but kept getting errors.</p>\n\n<p>Just trying to replace (\"TRADE\") with a variable that represents the active page </p>\n\n<pre><code>    ActiveWorkbook.Worksheets(\"TRADE\").ListObjects(\"Table4\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"TRADE\").ListObjects(\"Table4\").Sort.SortFields.Add _\n        Key:=Range(\"Table4[[#All],[Column2]]\"), SortOn:=xlSortOnValues, Order:= _\n        xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"TRADE\").ListObjects(\"Table4\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    ActiveWorkbook.Worksheets(\"TRADE\").ListObjects(\"Table6\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"TRADE\").ListObjects(\"Table6\").Sort.SortFields.Add _\n        Key:=Range(\"Table6[[#All],[Column2]]\"), SortOn:=xlSortOnValues, Order:= _\n        xlDescending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"TRADE\").ListObjects(\"Table6\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    End Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554261194, "post_id": 55485985, "comment_id": 97681761, "body": "Exactly how does it fail?"}, {"owner": {"reputation": 1, "user_id": 11302862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0003e96d581c207b7ead1e5b9ea082a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ong", "link": "https://stackoverflow.com/users/11302862/nicholas-ong"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554261809, "post_id": 55485985, "comment_id": 97681879, "body": "It doesn&#39;t input the user name and password. It is just a simple program whereby user can click the macro and it will login and bring user into the site."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554261999, "post_id": 55485985, "comment_id": 97681919, "body": "Have you tried disabling the error handling?"}, {"owner": {"reputation": 1, "user_id": 11302862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0003e96d581c207b7ead1e5b9ea082a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ong", "link": "https://stackoverflow.com/users/11302862/nicholas-ong"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554262291, "post_id": 55485985, "comment_id": 97681968, "body": "Yes sir, it still doesn&#39;t work."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554265243, "post_id": 55485985, "comment_id": 97682552, "body": "And no error messages?"}, {"owner": {"reputation": 1, "user_id": 11302862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0003e96d581c207b7ead1e5b9ea082a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ong", "link": "https://stackoverflow.com/users/11302862/nicholas-ong"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554265756, "post_id": 55485985, "comment_id": 97682662, "body": "There were no error messages. When i ran the code, it only manages to open up the web page. It doesn&#39;t input any information like user name and password that is required to access"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1554265937, "post_id": 55485985, "comment_id": 97682716, "body": "And no debug output?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554283560, "post_id": 55485985, "comment_id": 97690580, "body": "I get redirected to <a href=\"https://fed.erau.edu/oamfed/idp/samlv20\" rel=\"nofollow noreferrer\">fed.erau.edu/oamfed/idp/samlv20</a>   . Can that url be used also?"}, {"owner": {"reputation": 1, "user_id": 11302862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0003e96d581c207b7ead1e5b9ea082a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ong", "link": "https://stackoverflow.com/users/11302862/nicholas-ong"}, "edited": false, "score": 0, "creation_date": 1554782038, "post_id": 55485985, "comment_id": 97867185, "body": "No Sir, i&#39;ve tried a few methods and it brought me to the same page as well."}], "owner": {"reputation": 1, "user_id": 11302862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0003e96d581c207b7ead1e5b9ea082a7?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ong", "link": "https://stackoverflow.com/users/11302862/nicholas-ong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554256983, "creation_date": 1554256983, "question_id": 55485985, "link": "https://stackoverflow.com/questions/55485985/vba-web-navigation-and-authentication", "title": "Vba Web Navigation and authentication", "body": "<pre><code>Sub HTML_Element_Printer()\n\nOn Error GoTo Err_Clear\nsURL = \"https://ernie.erau.edu/\"\nSet oBrowser = New InternetExplorer\noBrowser.Silent = True\noBrowser.timeout = 60\noBrowser.navigate sURL\noBrowser.Visible = True\n\nDo\n' Wait till the Browser is loaded\nLoop Until oBrowser.readyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = oBrowser.document\n\nHTMLDoc.all.loginID.Value = \"User123\"\nHTMLDoc.all.Password.Value = \"Pass123\"\n\nFor Each oHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\nDebug.Print oHTML_Element.Name\nNext\n\n' oBrowser.Refresh ' Refresh If Needed\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nErr.Clear\nResume Next\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to use vba to navigate through multiple websites and login to it respectively, thus, i am using my school portal as a trial for now. The code seems to work successfully in navigating to the site, but i can't input the user and password i want. It is the first time i am using vba to do web navigation and user authentication, i was hoping to find some help and advice here. Thanks.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1554283760, "post_id": 55485748, "comment_id": 97690708, "body": "What is the exact problem? googeling for the exact T-SQL sintax will yeald tons of answars..."}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1554323381, "post_id": 55485748, "comment_id": 97713787, "body": "Just to clarify: Are you trying to insert the file name (<code>C:\\temp\\1.pdf</code>) into the database, or the actual file contents? Your title makes it seem like the former, but your actual code seems like you&#39;re trying to do the latter."}, {"owner": {"reputation": 1, "user_id": 6113903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc96827cb91ac28cd27ef5969612b67?s=128&d=identicon&r=PG&f=1", "display_name": "N.N", "link": "https://stackoverflow.com/users/6113903/n-n"}, "edited": false, "score": 0, "creation_date": 1554349771, "post_id": 55485748, "comment_id": 97720565, "body": "Thanks for the response. I am trying to insert the file as oledb object into the database. I can do this thru GUI but I am attempting programatically."}], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1555456196, "creation_date": 1555456196, "answer_id": 55717752, "question_id": 55485748, "link": "https://stackoverflow.com/questions/55485748/insert-pdf-file-into-sql-server-linked-database/55717752#55717752", "title": "Insert pdf file into SQL Server linked database", "body": "<p>Use this function to retrieve byte data for a specified file:</p>\n\n<pre><code>' fPath is the path to the file\nFunction FileToBlob(fPath As String) As Variant\n    Dim fileNum As Long\n    Dim b() As Byte\n\n    fileNum = FreeFile\n    Open fPath For Binary As fileNum\n        ReDim b(LOF(fileNum))\n        Get fileNum, , b()\n    Close fileNum\n\n    FileToBlob = b\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6113903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc96827cb91ac28cd27ef5969612b67?s=128&d=identicon&r=PG&f=1", "display_name": "N.N", "link": "https://stackoverflow.com/users/6113903/n-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594621369, "creation_date": 1554254993, "last_edit_date": 1594621369, "question_id": 55485748, "link": "https://stackoverflow.com/questions/55485748/insert-pdf-file-into-sql-server-linked-database", "title": "Insert pdf file into SQL Server linked database", "body": "<p>I am new to Access programming and trying to insert <code>.pdf</code> and Word documents into SQL Server linked database and having issues. I need some hints to start on this. Could some help.</p>\n\n<pre><code>Dim f As Object\nDim sFile As String\nDim fld_path As String\nDim fld_file As String\n\nDim dbs As DAO.Database\nDim rst As DAO.Recordset\nDim Sql As String\nDim Code As String\n\n\n FileToBlob = \"C:\\temp\\1.pdf\"\n\nSql = \"INSERT INTO dbo_Doc (Doc) VALUES (FileToBlob)\"\n\nDoCmd.RunSQL Sql\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts", "format"], "comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1554576919, "post_id": 55485703, "comment_id": 97806055, "body": "It&#39;s not uncommon for pivot charts to change formatting when the data is refreshed. Specifically, custom formatting is likely to be lost. If SeriesCollection(1) is xlLineMarkers (i.e., if the whole chart is xlLineMarkers), then when you openi the workbook and the pivot table is refreshed, the customized SeriesCollection(2) reverts to the default xlLineMarkers. If this is the case, you could try making the chart xlLine, and changing SeriesCollection(1) to xlLineMarkers."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11302699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051cb4539a75f8ff33f63240ce821186?s=128&d=identicon&r=PG&f=1", "display_name": "Allan Lewis", "link": "https://stackoverflow.com/users/11302699/allan-lewis"}, "is_accepted": false, "score": 0, "last_activity_date": 1556693156, "creation_date": 1556693156, "answer_id": 55932551, "question_id": 55485703, "link": "https://stackoverflow.com/questions/55485703/excel-2010-changing-pivot-chart-line-format-on-workbook-saveas/55932551#55932551", "title": "Excel 2010 Changing Pivot Chart Line Format On Workbook.SaveAs", "body": "<p>OK, this is silly, but I've gotten around it by <em>drum roll</em> formatting-and-saving twice. This will do for now, but I'll try Jon Peltier's suggestions at some point and report back.</p>\n"}], "owner": {"reputation": 1, "user_id": 11302699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051cb4539a75f8ff33f63240ce821186?s=128&d=identicon&r=PG&f=1", "display_name": "Allan Lewis", "link": "https://stackoverflow.com/users/11302699/allan-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556693156, "creation_date": 1554254556, "last_edit_date": 1554259684, "question_id": 55485703, "link": "https://stackoverflow.com/questions/55485703/excel-2010-changing-pivot-chart-line-format-on-workbook-saveas", "title": "Excel 2010 Changing Pivot Chart Line Format On Workbook.SaveAs", "body": "<p>I've written a bunch of VBA for Excel 2010 to retrieve data from an Access database, place the pivot table into a new workbook and create a pivot chart based on that pivot table with two data series. One series is a bar and the second series is a line on which I have set the .MarkerStyle to xlMarkerStyleNone. The macro also saves the new workbook.</p>\n\n<p>When I open that saved workbook, I find that the line now has markers on it.</p>\n\n<p>In trying to find out what's going on here, I have hit [CTRL]-[BREAK] to stop the macro after the chart is formatted and before it's saved, so I can see what's in the chart format. I can see that the marker style has been set to none when I right-click the series and see the properties, and also by verifying that by seeing that .MarkerStyle on the relevant series is still set to xlMarkerStyleNone.</p>\n\n<p>When I go to save the new workbook manually with [CTRL]-[S], it saves just fine and loads up without the line markers. But when I save the file with save-as ([ALT]-[F], [A]), I see the markers appear after the file is saved.</p>\n\n<p>So I don't think it's code that's doing this, but the Workbook.SaveAs method. But I'll show relevant code just in case.</p>\n\n<p>I have used both xlExcel12 and 50 as the FileFormat when saving as a .xlsb file, and both xlOpenXMLWorkbook and 51 when saving as a regular .xlsx file. This has made no difference, either.</p>\n\n<p>Update: I have also tried the Workbook.Save method, which just saves the new workbook I create as Book1.xlsx, and it has the same problem.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    ' Chart Formatting\n    reportSheet.Shapes(10).Chart.SeriesCollection(2).ChartType = xlLine\n    reportSheet.Shapes(10).Chart.SeriesCollection(2).Format.Line.Visible = msoTrue\n    reportSheet.Shapes(10).Chart.SeriesCollection(2).Format.Line.ForeColor.RGB = RGB(186, 7, 67)\n    reportSheet.Shapes(10).Chart.SeriesCollection(2).Format.Line.Transparency = 0\n    reportSheet.Shapes(10).Chart.SeriesCollection(2).Format.Line.Weight = 1.5\n    reportSheet.Shapes(10).Chart.SeriesCollection(2).MarkerStyle = xlMarkerStyleNone\n\n    ' Saving the chart\n    reportbook.SaveAs fileName:=saveFileSpec, FileFormat:=xlOpenXMLWorkbook\n</code></pre>\n\n<p>I'm expecting the workbook to save without any changes being made in the save process when using the Workbook.SaveAs method.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1554254519, "post_id": 55485618, "comment_id": 97680516, "body": "&quot;After all macros are done in the file&quot; - what are the other macros doing?  There doesn&#39;t seem to be any problem with the code you posted, so something else is going on..."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1554260102, "post_id": 55485618, "comment_id": 97681536, "body": "Have you checked the value of that cell down to the nth decimal?  It may be that the cell is formatted with no decimals but the value very much has decimals.  Something to check anyway."}, {"owner": {"reputation": 276, "user_id": 9903850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ece9df0b43c989f387899ee248e309?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/9903850/john-f"}, "edited": false, "score": 1, "creation_date": 1554260546, "post_id": 55485618, "comment_id": 97681637, "body": "Have you tried stepping through the code and seeing what the line Worksheets(sheet1).Range(&quot;Spend&quot;).Offset(s, 15).Value shows when you think it should hide it?"}], "owner": {"reputation": 1, "user_id": 11302726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5909c4db86f7cbaebcb6b44bd6ab383?s=128&d=identicon&r=PG&f=1", "display_name": "swzy", "link": "https://stackoverflow.com/users/11302726/swzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554274653, "creation_date": 1554253955, "last_edit_date": 1554274653, "question_id": 55485618, "link": "https://stackoverflow.com/questions/55485618/macro-is-not-reading-the-correct-value-from-a-cell-which-contains-a-math-formula", "title": "Macro is not reading the correct value from a cell which contains a math formula", "body": "<p>I have a Excel Workbook that is a template and is populated using macros. \nIn a several cells, I have a formula <code>=abs(sum(H20:P20))</code>. </p>\n\n<p>In my macro, I am trying to hide the row based on the value in that cell. </p>\n\n<p>I reference those cells from a named range using an offset that does not change and then iterate over 8 lines to decide whether to hide them or not. </p>\n\n<p>I have tried various 'Evaluate' and 'Calculate' functions on the cells in question thinking that maybe it was not evaluating the formula in the cell. </p>\n\n<pre><code>For s = 1 To 8\n  If Worksheets(sheet1).Range(\"Spend\").Offset(s, 15).Value = 0 Then \n    Worksheets(sheet1).Range(\"Spend\").Offset(s, 15).EntireRow.Hidden = True\n  End If\nNext s\n</code></pre>\n\n<p>I expect it to hide several of the rows but it does not do anything. After all macros are done in the file; and the rows have not been hidden, I run that same macro again. On this second run, it hides the rows correctly.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1554254384, "creation_date": 1554254384, "answer_id": 55485674, "question_id": 55485408, "link": "https://stackoverflow.com/questions/55485408/how-do-you-delete-everything-after-the-second-instance-of-a-word-in-a-cell-delet/55485674#55485674", "title": "How do you delete everything after the second instance of a word in a cell/delete duplicate in a string?", "body": "<p>If your text is really just the same thing repeated twice you can use something like:</p>\n\n<pre><code>=LEFT(A1, LEN(A1)/2)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9174523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d50839cf0362cfb81fffa4aedcefdf1?s=128&d=identicon&r=PG&f=1", "display_name": "novel", "link": "https://stackoverflow.com/users/9174523/novel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 55485674, "answer_count": 1, "score": 0, "last_activity_date": 1554274602, "creation_date": 1554252053, "last_edit_date": 1554274602, "question_id": 55485408, "link": "https://stackoverflow.com/questions/55485408/how-do-you-delete-everything-after-the-second-instance-of-a-word-in-a-cell-delet", "title": "How do you delete everything after the second instance of a word in a cell/delete duplicate in a string?", "body": "<p>My data in one column looks like this: </p>\n\n<pre><code>101 Hello 2, New York, NY 10002101 Hello 2, New York, NY 10002\n</code></pre>\n\n<p>Basically, the same string is repeated into the cell twice. </p>\n\n<p>How do I delete the second instance of the same string in the cell (or how do I delete everything after the second instance of the first number in the string -- I tried to make a column extracting the first number of the string, so a column that has just \"101\", and I'm trying to reference it to delete everything after the second time it appears in the first string, if that makes sense)?</p>\n\n<p>I'm trying to convert </p>\n\n<p><code>101 Hello 2, New York, NY 10002101 Hello 2, New York, NY 10002</code> </p>\n\n<p>to: </p>\n\n<pre><code>101 Hello 2, New York, NY 10002\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "batch-file"], "comments": [{"owner": {"reputation": 300, "user_id": 4128576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJsPA.jpg?s=128&g=1", "display_name": "Dhamo", "link": "https://stackoverflow.com/users/4128576/dhamo"}, "edited": false, "score": 0, "creation_date": 1554249086, "post_id": 55484909, "comment_id": 97679573, "body": "Have you added &#39;Windows Script Host Object Model&#39; reference ? if not already please add it and try [? == VBA window, click Tools &gt; References]"}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 300, "user_id": 4128576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJsPA.jpg?s=128&g=1", "display_name": "Dhamo", "link": "https://stackoverflow.com/users/4128576/dhamo"}, "edited": false, "score": 0, "creation_date": 1554249199, "post_id": 55484909, "comment_id": 97679595, "body": "@Dhamo: Yes, I have."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 300, "user_id": 4128576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJsPA.jpg?s=128&g=1", "display_name": "Dhamo", "link": "https://stackoverflow.com/users/4128576/dhamo"}, "edited": false, "score": 0, "creation_date": 1554249331, "post_id": 55484909, "comment_id": 97679618, "body": "@Dhamo: I&#39;m sorry, I don&#39;t understand what you mean by &quot;try [? == VBA window...&quot;."}, {"owner": {"reputation": 300, "user_id": 4128576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJsPA.jpg?s=128&g=1", "display_name": "Dhamo", "link": "https://stackoverflow.com/users/4128576/dhamo"}, "edited": false, "score": 0, "creation_date": 1554249389, "post_id": 55484909, "comment_id": 97679626, "body": "Add option explicit in the first line and also enable error handler [on error goto EH:] and also define the EH [EH: msgbox err.description]. At least you will get to know the actual issue to some extent. The above code is working fine for me [I use v2016]"}, {"owner": {"reputation": 300, "user_id": 4128576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJsPA.jpg?s=128&g=1", "display_name": "Dhamo", "link": "https://stackoverflow.com/users/4128576/dhamo"}, "edited": false, "score": 0, "creation_date": 1554249432, "post_id": 55484909, "comment_id": 97679638, "body": "If you&#39;ve already added the reference, you can ignore further comment"}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 300, "user_id": 4128576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJsPA.jpg?s=128&g=1", "display_name": "Dhamo", "link": "https://stackoverflow.com/users/4128576/dhamo"}, "edited": false, "score": 0, "creation_date": 1554249457, "post_id": 55484909, "comment_id": 97679645, "body": "@Dhamo, Sure, let me implement the error handler.  Give me a bit..."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 300, "user_id": 4128576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJsPA.jpg?s=128&g=1", "display_name": "Dhamo", "link": "https://stackoverflow.com/users/4128576/dhamo"}, "edited": false, "score": 0, "creation_date": 1554250074, "post_id": 55484909, "comment_id": 97679772, "body": "@Dhamo: It&#39;s done.  See the update above."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554250076, "post_id": 55484909, "comment_id": 97679773, "body": "You didn&#39;t implement the error handler properly. You need <code>Exit Sub</code> right before <code>EH</code>, otherwise you execute <code>EH</code> regardless of what happens."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554250140, "post_id": 55484909, "comment_id": 97679783, "body": "@JohnColeman: Sorry, I&#39;m inexperienced in the use of error handlers.  I&#39;ll fix that.  One moment..."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554250420, "post_id": 55484909, "comment_id": 97679830, "body": "@JohnColeman: I&#39;ve fixed the error handler.  See the update above."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554250830, "post_id": 55484909, "comment_id": 97679888, "body": "Your code works for me (with the path details changed). It also works for me without the <code>Chr(34)</code>. Maybe drop those and see what happens. How are you invoking this sub?"}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554250925, "post_id": 55484909, "comment_id": 97679902, "body": "@JohnColeman: I&#39;m invoking the subroutine by clicking in the text and pressing the F5 key.  But I get the same result if I call it from the Immediate window."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554251022, "post_id": 55484909, "comment_id": 97679922, "body": "@JohnColeman: Removing chr(34) from the beginning and end of the string makes no difference for me."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554251031, "post_id": 55484909, "comment_id": 97679924, "body": "What happens if you turn your VBA code into pure VBScript? Get Excel out of the loop."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554251038, "post_id": 55484909, "comment_id": 97679927, "body": "Have you tried using just <code>Shell</code> ? as in <code>batFile = Shell(&quot;FilePath\\filename.bat&quot;, 1)</code>"}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554251227, "post_id": 55484909, "comment_id": 97679950, "body": "@RicardoA: I need the &quot;waitonreturn&quot; feature, so Shell is not an option for me.  That being said, I just tried it for the sake of debugging.  No difference in behavior."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1554251319, "post_id": 55484909, "comment_id": 97679962, "body": "@JohnColeman: Forgive my ignorance, but I don&#39;t know how to turn my VBA code into VBScript.  Would I need Visual Studio for this?"}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554251719, "post_id": 55484909, "comment_id": 97680027, "body": "@RicardoA: To elaborate on my previous comment, when I use the Shell function, it returns a nonzero Double, which, according to this source (<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/shell-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>) indicates success.  However, the .bat file is still not popping up and waiting for me to press any key.  So, again, I&#39;d say it&#39;s essentially the same behavior."}, {"owner": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "edited": false, "score": 0, "creation_date": 1554266180, "post_id": 55484909, "comment_id": 97682769, "body": "upload the workbook for us take a look"}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "reply_to_user": {"reputation": 132, "user_id": 2648008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e578798cd12f1fcb707924031d19b7f0?s=128&d=identicon&r=PG", "display_name": "user2648008", "link": "https://stackoverflow.com/users/2648008/user2648008"}, "edited": false, "score": 0, "creation_date": 1554315375, "post_id": 55484909, "comment_id": 97709848, "body": "@user2648008: Here&#39;s a link to a copy of the workbook: <a href=\"https://drive.google.com/open?id=1He05Aa7gA4X5G89EHUTBxd4FewVdCfVx\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1He05Aa7gA4X5G89EHUTBxd4FewVdCfVx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "edited": false, "score": 0, "creation_date": 1554252039, "post_id": 55485367, "comment_id": 97680085, "body": "So I suppose that means that Excel is the problem?  Any thoughts on how to fix it?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "edited": false, "score": 0, "creation_date": 1554252212, "post_id": 55485367, "comment_id": 97680124, "body": "Your guess is as good as mine. I&#39;ve never encountered something like that. It is almost like Excel is sending a keystroke to the command window before you can see it."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "edited": false, "score": 0, "creation_date": 1554256114, "post_id": 55485367, "comment_id": 97680819, "body": "I&#39;ve changed the .bat file so that it instead of waiting for a keystroke, it creates a separate .txt file.  This .txt file is not created when I try to call the .bat script from VBA.  So it&#39;s not that Excel is sending a keystroke before I can see the window."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1554309451, "post_id": 55485367, "comment_id": 97706971, "body": "It could be a windows security &quot;feature&quot;. It may not like doing Excel -&gt; VBA -&gt; Bat file, but it likes just doing VBS -&gt; Bat file. Also did you try removing these: <code>, waitonreturn:=True, windowstyle:=1</code> and just doing <code>1, True</code> in Excel like the VBS?"}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "edited": false, "score": 0, "creation_date": 1554314175, "post_id": 55485367, "comment_id": 97709231, "body": "Yes, I&#39;m afraid it might be a security thing... But, if so, why does it seem to only affect me?"}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "edited": false, "score": 0, "creation_date": 1554314396, "post_id": 55485367, "comment_id": 97709351, "body": "Also, I just tried <code>1, True</code> as the arguments.  No difference."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "edited": false, "score": 0, "creation_date": 1554314781, "post_id": 55485367, "comment_id": 97709543, "body": "UPDATE2 above suggests that it is indeed a security issue.  Any ideas on how to fix it?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "edited": false, "score": 0, "creation_date": 1554315119, "post_id": 55485367, "comment_id": 97709716, "body": "@Garrett &quot;Permission denied&quot; sounds more like administrative privileges question than a security question, although I guess it could have been the latter. If this is a work computer and you have an IT department -- perhaps they introduced some change? Also, perhaps some anti-malware product is preventing it from running? If that is the case, there should be some log files that you can look at (e.g. the Malwarebytes control panel has a log tab)."}, {"owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "edited": false, "score": 0, "creation_date": 1554315739, "post_id": 55485367, "comment_id": 97710023, "body": "@JohnColeman: Your intuition was correct again, John!  It looks like Bitdefender is blocking the activity, based on the program&#39;s log.  Now I just need to figure out how to make Bitdefender allow this particular action without becoming too permissive..."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1554251651, "creation_date": 1554251651, "answer_id": 55485367, "question_id": 55484909, "link": "https://stackoverflow.com/questions/55484909/attempt-to-run-bat-script-from-vba-fails-without-error-code/55485367#55485367", "title": "Attempt to run .bat script from VBA fails without error code", "body": "<p>Not an answer, but too long for a comment:</p>\n\n<p>If you put the following into a file, save it as test.vbs (not as a text document: notepad will create test.vbs.txt if you are not careful):</p>\n\n<pre><code>Dim wsh, fullPath, ecode\nSet wsh = WScript.CreateObject(\"WScript.Shell\")\nfullPath = \"C:\\programs\\test.bat\"\necode = wsh.Run(fullPath, 1, True)\nmsgbox(ecode)\n</code></pre>\n\n<p>(with the full path adjusted to your situation). Save it to e.g. the desktop and click the icon. What happens?</p>\n"}], "owner": {"reputation": 161, "user_id": 7417352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827d503533f5a0bddda5899de5a2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/7417352/garrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1554314460, "creation_date": 1554247859, "last_edit_date": 1554314460, "question_id": 55484909, "link": "https://stackoverflow.com/questions/55484909/attempt-to-run-bat-script-from-vba-fails-without-error-code", "title": "Attempt to run .bat script from VBA fails without error code", "body": "<p>SUMMARY:\nI am trying to run a .bat script on a Windows machine using Excel VBA.  I have found references online describing how to do this, and I have followed the instructions contained therein.  However, my .bat file is not running.</p>\n\n<p>DETAILS:\nMy .bat file (\"test.bat\") contains the following code:</p>\n\n<pre><code>echo off\necho This is a test...\npause\nexit\n</code></pre>\n\n<p>It is located on my desktop, with the following path: \"C:\\Users\\User1\\Desktop\".  When I double-click this .bat file or call it from the command line, it exhibits the desired behavior.  Namely, it pauses and waits for me to press any key.</p>\n\n<p>I am trying to run this same .bat file from Excel VBA using the following code:</p>\n\n<pre><code>Sub testBatchScript()\n\n    'Print a message to the immediate window to confirm subroutine execution\n    Debug.Print \"The subroutine is running.\"\n\n    'Initialize a windows shell object\n    Dim wsh As WshShell\n    Set wsh = New WshShell\n\n    'Construct the full path to the .bat file\n    Dim fullPath As String\n    fullPath = Chr(34) + \"C:\\Users\\User1\\Desktop\\test.bat\" + Chr(34)\n\n    'Run the .bat file\n    Dim eCode As Long\n    eCode = wsh.Run(fullPath, waitonreturn:=True, windowstyle:=1)\n\n    If eCode &lt;&gt; 0 Then\n        MsgBox (\"An error occurred.\")\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>When I run this subroutine, nothing happens.  No CMD window pops up, and no message box indicating an error pops up.  However, I do know that the subroutine is running, due to the message that appears in the immediate window.</p>\n\n<p>I'm stumped as to why this isn't working.  What's even more perplexing is that I was able to successfully call .bat scripts from VBA as recently as a few weeks ago..</p>\n\n<p>Anyone have any explanation or suggestions?</p>\n\n<p>UPDATE1:\nFollowing @Dhamo's suggestion in the comments below, I have updated the VBA code with error handling:</p>\n\n<pre><code>Option Explicit\n\nSub testBatchScript()\n\n    On Error GoTo EH:\n\n    'Print a message to the immediate window to confirm subroutine execution\n    Debug.Print \"The subroutine is running.\"\n\n    'Initialize a windows shell object\n    Dim wsh As WshShell\n    Set wsh = New WshShell\n\n    'Construct the full path to the .bat file\n    Dim fullPath As String\n    fullPath = Chr(34) + \"C:\\Users\\User1\\Desktop\\test.bat\" + Chr(34)\n\n    'Run the .bat file\n    Dim eCode As Long\n    eCode = wsh.Run(fullPath, waitonreturn:=True, windowstyle:=1)\n\n    If eCode &lt;&gt; 0 Then\n        MsgBox (\"An error occurred.\")\n    End If\n\n    Exit Sub\n\nEH:\n    MsgBox (\"The error description is: \" &amp; Err.Description)\n\nEnd Sub\n</code></pre>\n\n<p>When I run <em>this</em> code, still nothing happens.</p>\n\n<p>UPDATE2:\nI ran the test code again this morning, after restarting my computer, and <em>this</em> time I got a pop-up message saying: \"The error description is: Permission denied\".  I then ran the code again to see if I could replicate this error message, and there was no pop-up!  Furthermore, I can't get the error message to reappear no matter how many times I run the code.  So restarting seems to have done something...</p>\n\n<p>The \"Permission denied\" message suggests that it's a security issue.  Anyone have any ideas for solving it?</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1554259356, "post_id": 55484561, "comment_id": 97681403, "body": "You can try to set the value using it&#39;s class name like IE.document.getElementByClassName(&quot;ng-valid&quot;).Value = &quot;CBs current&quot; If your dropdown has ID than you can try like this IE.document.getElementById(&quot;cb1&quot;).Value = &quot;CBs current&quot; Ref: <a href=\"https://www.automateexcel.com/vba/automate-internet-explorer-ie-using/\" rel=\"nofollow noreferrer\">automateexcel.com/vba/automate-internet-explorer-ie-using</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554269982, "post_id": 55484561, "comment_id": 97683840, "body": "Can you explain a little more about the <i>not loaded</i>? Do you mean that the option tags have no values until you have clicked on the select tag? Can you share what the html looks like in the node loaded state?"}, {"owner": {"reputation": 670, "user_id": 6117998, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5059c6edaf635d2e64006e9d49d2e6de?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro de S&#225;", "link": "https://stackoverflow.com/users/6117998/pedro-de-s%c3%a1"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554304634, "post_id": 55484561, "comment_id": 97704221, "body": "@Qharr of course, my friend! Sorry about that, I was in a rush yesterday and I forgot to do so! Thank you for the help on that one! I&#39;ll see your answer to this one and in a few minutes I&#39;ll update this post!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554306838, "post_id": 55484561, "comment_id": 97705617, "body": "Is the url private? Or login based?"}, {"owner": {"reputation": 670, "user_id": 6117998, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5059c6edaf635d2e64006e9d49d2e6de?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro de S&#225;", "link": "https://stackoverflow.com/users/6117998/pedro-de-s%c3%a1"}, "edited": false, "score": 0, "creation_date": 1554309229, "post_id": 55484561, "comment_id": 97706866, "body": "It&#39;s login based. I updated the HTML snippet because I realized it was missing an element. I think I have to set the property <i>ng-if=&quot;$ctrl.selectedScratchPad === null&quot;</i> somehow... I tried to access the VALUE of the class &quot;ng-binding ng-scope&quot; but it didn&#39;t work."}, {"owner": {"reputation": 670, "user_id": 6117998, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5059c6edaf635d2e64006e9d49d2e6de?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro de S&#225;", "link": "https://stackoverflow.com/users/6117998/pedro-de-s%c3%a1"}, "edited": false, "score": 0, "creation_date": 1554312988, "post_id": 55484561, "comment_id": 97708698, "body": "I also noticed that it <i>never</i> enters in this if block <code>If objCollection(j).getAttribute(&quot;class&quot;) = &quot;ng-valid ng-touched ng-not-empty ng-dirty ng-valid-parse&quot; Then</code>, probably because the code isn&#39;t finding  this particular class of the <code>select</code> tag"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1554369696, "post_id": 55484561, "comment_id": 97729457, "body": "For testing purpose,Try to check for the first class only using get attribute like If objCollection(j).getAttribute(&quot;class&quot;) = &quot;ng-valid&quot; then"}], "owner": {"reputation": 670, "user_id": 6117998, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5059c6edaf635d2e64006e9d49d2e6de?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro de S&#225;", "link": "https://stackoverflow.com/users/6117998/pedro-de-s%c3%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554310004, "creation_date": 1554245135, "last_edit_date": 1554310004, "question_id": 55484561, "link": "https://stackoverflow.com/questions/55484561/how-to-select-drop-down-vba-and-click-it", "title": "How to select drop down VBA and click it", "body": "<p>I have a few items in a drop down menu and I want to choose one of them. Searching through the <code>options</code> tag in HTML, I was able to select it in the drop down, but the pre-settings that each one of the items have <strong>is not loaded</strong>. I think it's because I'm not \"choosing\" the item with the <code>select</code> tag. Does anyone knows how to solve that?</p>\n\n<pre><code>    Set objCollection = IE.Document.getElementsByTagName(\"select\")\n\n    For Each opt In IE.Document.getElementsByTagName(\"option\")\n        If opt.innerText = \"Tracker Availability\" Then\n            Debug.Print \"found it\"\n            opt.Selected = True\n            Exit For\n        End If\n    Next opt\n</code></pre>\n\n<p>HTML:</p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;select style=\"width: 100px; height: 33px; margin-left: 5px; border-radius: 2px;\" ng-model=\"$ctrl.selectedScratchPad\" ng-options=\"s.name for s in $ctrl.scratchPads track by s.name\" ng-change=\"$ctrl.scratchPadSelected($ctrl.selectedScratchPad)\" class=\"ng-pristine ng-valid ng-empty ng-touched\"&gt;&lt;!-- ngIf: $ctrl.selectedScratchPad === null --&gt;&lt;option ng-if=\"$ctrl.selectedScratchPad === null\" value=\"\" disabled=\"disabled\" selected=\"selected\" class=\"ng-binding ng-scope\"&gt;Select Export&lt;/option&gt;&lt;!-- end ngIf: $ctrl.selectedScratchPad === null --&gt;&lt;option label=\"G&amp;amp;T\" value=\"G&amp;amp;T\"&gt;G&amp;amp;T&lt;/option&gt;&lt;option label=\"Relat\u00f3rio semanal\" value=\"Relat\u00f3rio semanal\"&gt;Relat\u00f3rio semanal&lt;/option&gt;&lt;option label=\"CBs current\" value=\"CBs current\"&gt;CBs current&lt;/option&gt;&lt;option label=\"Tracker Availability\" value=\"Tracker Availability\"&gt;Tracker Availability&lt;/option&gt;&lt;option label=\"INV 5-1 Trackers target\" value=\"INV 5-1 Trackers target\"&gt;INV 5-1 Trackers target&lt;/option&gt;&lt;option label=\"INV 5-1 Trackers current\" value=\"INV 5-1 Trackers current\"&gt;INV 5-1 Trackers current&lt;/option&gt;&lt;option label=\"INV 5-1 Trackers availability\" value=\"INV 5-1 Trackers availability\"&gt;INV 5-1 Trackers availability&lt;/option&gt;&lt;option label=\"PVSyst Input\" value=\"PVSyst Input\"&gt;PVSyst Input&lt;/option&gt;&lt;/select&gt;\n</code></pre>\n\n<p>Edit1: Here it is a couple of pictures that demonstrates what I meant with the pre-settings not loaded:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7VDMF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7VDMF.png\" alt=\"when opt.Selected = True\"></a>\n<a href=\"https://i.stack.imgur.com/QQqXO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QQqXO.png\" alt=\"When I manually change the drop down menu value by selecting what I want\"></a></p>\n\n<p>Pic-1: when opt.Selected = True\nPic-2: When I manually change the drop down menu value by selecting what I want</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1554244682, "post_id": 55484345, "comment_id": 97678609, "body": "By reset a table do you mean delete all rows but maintain the headers?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1554244779, "post_id": 55484345, "comment_id": 97678635, "body": "Previously: <a href=\"https://stackoverflow.com/questions/20663491/delete-all-data-rows-from-an-excel-table-apart-from-the-first\" title=\"delete all data rows from an excel table apart from the first\">stackoverflow.com/questions/20663491/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 10381896, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjQ7l2wt3Z4/AAAAAAAAAAI/AAAAAAAAAAc/tuKX-yM66Qg/photo.jpg?sz=128", "display_name": "Darren Allen", "link": "https://stackoverflow.com/users/10381896/darren-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1554245275, "answer_count": 0, "score": 1, "last_activity_date": 1554278834, "creation_date": 1554243662, "last_edit_date": 1554278834, "question_id": 55484345, "link": "https://stackoverflow.com/questions/55484345/reset-data-rows-from-an-excel-table-apart-from-the-first-without-breaking-tabl", "closed_reason": "Duplicate", "title": "Reset data rows from an Excel table (apart from the first) without breaking table", "body": "<p>I found this VBA code From a JackMcKoy post, It works great for resetting an excel table (Excel16) but it breaks the table in that when I press TAB to add row it no longer adds a new row. Please advise. Thanks in advance.</p>\n\n<pre><code>Sub Clear_Table()\n    Range(\"Table1\").Select\n    Application.DisplayAlerts = False\n    Selection.Delete\n    Application.DisplayAlerts = True\n    Range(\"A1:G1\").Select\n    Selection.ClearContents\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1554243306, "post_id": 55483813, "comment_id": 97678216, "body": "The <code>FollowHyperlink</code> event doesn&#39;t fire with hyperlinks created using a hyperlink formula."}, {"owner": {"reputation": 13, "user_id": 8773889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df372001a37a4612115da1028cdf5aed?s=128&d=identicon&r=PG&f=1", "display_name": "J Oney", "link": "https://stackoverflow.com/users/8773889/j-oney"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554243562, "post_id": 55483813, "comment_id": 97678291, "body": "Is there a way to make the hyperlink dynamic (e.g., move location in sheet if a user adds/deletes a column) without using the hyperlink formula?"}, {"owner": {"reputation": 13, "user_id": 8773889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df372001a37a4612115da1028cdf5aed?s=128&d=identicon&r=PG&f=1", "display_name": "J Oney", "link": "https://stackoverflow.com/users/8773889/j-oney"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554243844, "post_id": 55483813, "comment_id": 97678391, "body": ".... using named range to make hyperlink dynamic. Thanks for the help! Thought the macro wasn&#39;t working for me."}], "owner": {"reputation": 13, "user_id": 8773889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df372001a37a4612115da1028cdf5aed?s=128&d=identicon&r=PG&f=1", "display_name": "J Oney", "link": "https://stackoverflow.com/users/8773889/j-oney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554274578, "creation_date": 1554240431, "last_edit_date": 1554274578, "question_id": 55483813, "link": "https://stackoverflow.com/questions/55483813/jump-to-active-cell-with-hyperlink-formula", "title": "Jump to Active Cell with Hyperlink Formula", "body": "<p>I've got a very horizontally long worksheet and I've created hyperlinks using the hyperlink formula and a match formula that matches to section headings. I've found some VBA code that jumps the window to the active cell but I can only get this to work if hyperlink cells using the (ctrl+k) method. Is there a way to jump the window to the active cell following a link from the hyperlink formula? </p>\n\n<p>Original reference I've been using. <a href=\"https://stackoverflow.com/questions/19127549/excel-hyperlink-jump-to-cell-and-scroll-window#comment28286721_19127669\">Excel Hyperlink - jump to cell and scroll window</a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1554240006, "post_id": 55483632, "comment_id": 97677091, "body": "Is your ComboBox on the worksheet an ActiveX Control?  That will make a difference."}, {"owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554240133, "post_id": 55483632, "comment_id": 97677125, "body": "@ZackE, Yes, I&#39;m using ActiveX."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554240301, "post_id": 55483632, "comment_id": 97677182, "body": "Wouldn&#39;t that be much simpler to implement with data validation?"}, {"owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554240409, "post_id": 55483632, "comment_id": 97677231, "body": "@MathieuGuindon, you&#39;re right, this is easily solved with data validation, but I&#39;m trying to learn some more VBA in my free time so that&#39;s why I&#39;m trying to figure this out."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554240492, "post_id": 55483632, "comment_id": 97677256, "body": "I personally use data validation in my combo box as @MathieuGuindon suggested, since its a heck of a lot easier to maintain."}, {"owner": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 0, "creation_date": 1554240507, "post_id": 55483632, "comment_id": 97677266, "body": "If you are using the Workbook_Open Event (as in your second link) to populate the Combo Box, then macros must be enabled for it to actually do anything. Make the document trusted to have this happen automatically."}, {"owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "reply_to_user": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 0, "creation_date": 1554240564, "post_id": 55483632, "comment_id": 97677289, "body": "@Stax I already have a bunch of other VBA codes running in my file, so that is all set."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554240798, "post_id": 55483632, "comment_id": 97677381, "body": "Side note, <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> code inspections can help you avoid several &quot;beginner traps&quot; (I contribute to that open-source project) you&#39;ll encounter in your journey to VBA mastery ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554240528, "post_id": 55483797, "comment_id": 97677272, "body": "Better load the content <i>once</i>. Doing this in <code>Worksheet.Activate</code> will re-populate the items every time the sheet is activated, and without first clearing the list, quickly shifting between Sheet1 and Sheet2 a few times will result in as many duplicate entries in the dropdown. Best place for this (IMO) is some <code>LoadCombo</code> method like you&#39;ve got, invoked from the <code>Workbook_Open</code> handler."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554240716, "post_id": 55483797, "comment_id": 97677346, "body": "I completely agree @MathieuGuindon.  I was just showing the OP a couple of options since they wanted to learn a little more, and that way they can play around with it to see the different behavior.  I will edit my answer to show that information as well."}, {"owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "edited": false, "score": 0, "creation_date": 1554240775, "post_id": 55483797, "comment_id": 97677373, "body": "I can&#39;t quite get this to work. I&#39;ve tried to add your first part in both my Sheet1 page and the ThisWorkbook page in the VBA editor, but it doesn&#39;t seem to add &quot;Paris&quot; to the object."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "edited": false, "score": 0, "creation_date": 1554240906, "post_id": 55483797, "comment_id": 97677424, "body": "@WoeIs if you double-click the combobox on the actual worksheet, does it bring up the VBE in the worksheet&#39;s code-behind, inside a <code>_Change</code> handler for it? If yes, the identifier before the underscore is the name of the combobox you need to use to refer to it. If not, ...then you&#39;re not using an ActiveX control and the way to go about it is ...different."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554240912, "post_id": 55483797, "comment_id": 97677427, "body": "create it in a standard module, make sure that you qualify the Sheet before the ComboBox, then call the Sub in the Workbook.Open event.  See if that works."}, {"owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554241287, "post_id": 55483797, "comment_id": 97677582, "body": "@MathieuGuindon, yes, when I double click on the combo box, it takes me to the &quot;ComboBox1_Change()&quot; handler. It seems like I&#39;m using the correct name. Would a screenshot help?"}, {"owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "edited": false, "score": 0, "creation_date": 1554241419, "post_id": 55483797, "comment_id": 97677629, "body": "@ZackE, I tried creating a module and put in the code there, but that also did not seem to work. What do you mean by qualifying the sheet?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554241510, "post_id": 55483797, "comment_id": 97677662, "body": "try this <code>ThisWorkbook.Sheet1.ComboBox1</code> after the <code>With</code>.  Provided that the codename of the Sheet is actually Sheet1"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "edited": false, "score": 0, "creation_date": 1554242227, "post_id": 55483797, "comment_id": 97677881, "body": "@WoeIs.  Quick question:  You arent trying to load the <code>ComboBox</code> with data on the <code>ComboBox_Change</code> event are you?  I ask because of one of the examples in your question."}, {"owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "edited": false, "score": 0, "creation_date": 1554242703, "post_id": 55483797, "comment_id": 97678032, "body": "@ZackE, this is what I currently have in my handles and where I have put them in the VBE: <a href=\"https://i.imgur.com/v9L2AQn.jpg\" rel=\"nofollow noreferrer\">i.imgur.com/v9L2AQn.jpg</a> and <a href=\"https://i.imgur.com/B4o4ISs.jpg\" rel=\"nofollow noreferrer\">i.imgur.com/B4o4ISs.jpg</a>"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1554244622, "post_id": 55483797, "comment_id": 97678602, "body": "I would move loading the data into the ComboBox into a standard module then call the sub on the <code>Worksheet_Activate</code> event and see if that works.  Im not sure why it isnt loading as i cannot duplicate that issue."}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": false, "score": 1, "last_activity_date": 1554240824, "last_edit_date": 1554240824, "creation_date": 1554240374, "answer_id": 55483797, "question_id": 55483632, "link": "https://stackoverflow.com/questions/55483632/a-simple-way-to-add-a-combo-box-and-a-few-options-in-vba-without-a-userform/55483797#55483797", "title": "A simple way to add a combo box and a few options in VBA without a Userform?", "body": "<p>If you want the ComboBox to load when the worksheet activates use this in the Worksheet Object in VBA:  (this may cause the ComboBox to load dupicate entries when switching back and forth between sheets.)</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    With ComboBox1\n        .AddItem \"Paris\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>Or you can place it in a standard module and call it when ever you need to:  (this is my preferred method except I would use data validation, since its easier to maintain.)</p>\n\n<pre><code>Sub LoadCombo()\n    With Sheet1.ComboBox1\n        .AddItem \"Paris\"\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1013, "user_id": 9518071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f124532a5dc801b3fffb30e99cfe33?s=128&d=identicon&r=PG&f=1", "display_name": "WoeIs", "link": "https://stackoverflow.com/users/9518071/woeis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554240824, "creation_date": 1554239468, "last_edit_date": 1554240154, "question_id": 55483632, "link": "https://stackoverflow.com/questions/55483632/a-simple-way-to-add-a-combo-box-and-a-few-options-in-vba-without-a-userform", "title": "A simple way to add a combo box and a few options in VBA without a Userform?", "body": "<p>EDIT: I'm using the ActiveX combo box.</p>\n\n<p>I have been trying for a while to use different solutions that I've found here <a href=\"https://stackoverflow.com/questions/17946317/how-to-add-items-to-a-combobox-in-a-form-in-excel-vba\">here</a> and <a href=\"https://www.excel-easy.com/vba/examples/combo-box.html\" rel=\"nofollow noreferrer\">here</a> but none of the examples seem to work to me. They don't explicitly make it clear where exactly to put</p>\n\n<pre><code>With Sheet1.ComboBox1\n    .AddItem \"Paris\"\n    .AddItem \"New York\"\n    .AddItem \"London\"\nEnd With\n</code></pre>\n\n<p>and anywhere I try to put them, nothing gets added to my combo box.</p>\n\n<p>Furthermore, many of these tutorials seem to be using Userforms. I'm not interested in having a userform, I simply want a combo box with a few options in my Excel spreadsheet, which depending on which value a user chooses in the combo box, a cell changes its value. All that I want to do is to write something like this:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    .AddItem \"Yes\"\n    .AddItem \"Average\"\n    .AddItem \"No\"\nEnd Sub\n</code></pre>\n\n<p>And then something along the lines of:</p>\n\n<pre><code>if ComboBox1 = \"Yes\"\nthen Range(\"D2\").Value = 1\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "is_accepted": false, "score": 0, "last_activity_date": 1554239962, "creation_date": 1554239962, "answer_id": 55483726, "question_id": 55483434, "link": "https://stackoverflow.com/questions/55483434/how-to-make-a-variable-array-based-on-information-inside-of-cells/55483726#55483726", "title": "How to make a variable array based on information inside of cells?", "body": "<pre><code>Dim shet\nFor Each shet In arraylist\n    Worksheets(shet).Visible = CheckBox1.Value\nNext shet\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11302097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3a77641374d776b678aa5e6ada2032?s=128&d=identicon&r=PG&f=1", "display_name": "RandoGuy", "link": "https://stackoverflow.com/users/11302097/randoguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554239962, "creation_date": 1554238531, "question_id": 55483434, "link": "https://stackoverflow.com/questions/55483434/how-to-make-a-variable-array-based-on-information-inside-of-cells", "title": "How to make a variable array based on information inside of cells?", "body": "<p>I am trying to make a list of sheets to hide or unhide based on whether a checkbox is clicked. I want to have a list of the sheets over a range of cells, but my function isn't working. I assume it's because it is considered a string and I am calling it as something.</p>\n\n<pre><code>With Worksheets(\"Home Page\").Cells\n    Set findSheets = .Find(What:=\"Sheets\", LookIn:=xlValues)\nEnd With\n\nfindSheets.Select\nSelection.Offset(2, 0).Select\nnum = 1\n\nArrayList = Chr(34) &amp; Selection.Value &amp; Chr(34)\nSelection.Offset(1, 0).Select\n\nFor Each MyCell In Range(Selection, Selection.End(xlDown))\n    ArrayList = ArrayList &amp; \", \" &amp; Chr(34) &amp; Selection.Value &amp; Chr(34)\n    Selection.Offset(1, 0).Select\nNext\nArrayList = ArrayList &amp; \")\"\nArrayList = Array(ArrayList)\n\nIf CheckBox1.Value = True Then\n    Worksheets(Array(ArrayList)).Visible = True\nElse\n    Worksheets(Array(ArrayList)).Visible = False\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2016"], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "edited": false, "score": 0, "creation_date": 1554244027, "post_id": 55484130, "comment_id": 97678443, "body": "Hi Dmitry Streblechenko.  Thanks for looking at this.  I had no PST (No Personal Folders).  I have four eMail accounts on this Office 2016 device, and ran SCANPST on all four files a few times.  I ran the Outlook VBA again and got the same message.  I&#39;m not sure if it matters, but the Outlook 2013 is 32 bit and the Outlook 2016 is 64 bit."}, {"owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "edited": false, "score": 0, "creation_date": 1554384154, "post_id": 55484130, "comment_id": 97738767, "body": "Hi Dmitry.  I thought everything was fine because SCANPST found a few problems with the OST files and fixed them.  I have 4 OST files and one of them indicated something like &quot;Only minor discrepancies remain&quot;.  There was no option to &quot;repair&quot; that OST file when I ran SCANPST again. Anyway, I renamed all the OST files and let Outlook recreate them.  The macro runs fine.  Thanks for the suggestion. I assume that the &quot;repair&quot; feature of SCANPST isn&#39;t all that thorough. Thanks again."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "edited": false, "score": 0, "creation_date": 1554388277, "post_id": 55484130, "comment_id": 97741694, "body": "Scanpst.exe can be used against OST files, but only if rebuilding them is not an option (e.g. a very large mailbox and offline / slow connection). Recreating OST files is the preferred solution."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1554242202, "creation_date": 1554242202, "answer_id": 55484130, "question_id": 55483225, "link": "https://stackoverflow.com/questions/55483225/how-do-i-resolve-runtime-error-2147219712-80040600-the-operation-failed/55484130#55484130", "title": "How do I resolve Runtime Error -2147219712 (80040600):` The operation failed", "body": "<p><code>0x80040600</code> is <code>MAPI_E_CORRUPT_STORE</code>. In case of a PST store, that most likely means the PST file is corrupted - try to run scanpst.exe. In case of a cached Exchange store, try to delete the OST file and restart Outlook - it will rebuild the OST file.</p>\n\n<p>MAPI error codes can be looked up in <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow noreferrer\">OutlookSpy</a> (click \"Error Code Lookup\" on the OutlookSpy ribbon).</p>\n"}], "owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 55484130, "answer_count": 1, "score": 1, "last_activity_date": 1592683509, "creation_date": 1554237571, "last_edit_date": 1592644375, "question_id": 55483225, "link": "https://stackoverflow.com/questions/55483225/how-do-i-resolve-runtime-error-2147219712-80040600-the-operation-failed", "title": "How do I resolve Runtime Error -2147219712 (80040600):` The operation failed", "body": "<p>The following code snippet works in Windows 10 / Outlook 2013.</p>\n<p>In Windows 10 / Outlook 2016 I get an error at the <code>.send</code> line:</p>\n<blockquote>\n<p>Run-time error -2147219712 (80040600):` The operation failed.</p>\n<p>The messaging interfaces have returned an unknown error.  If the problem persists, restart Outlook.  Cannot resolve recipient.</p>\n</blockquote>\n<pre><code>Option Explicit\nSub email_test()\nDim objOutlookApp               As Outlook.Application\nDim objOriginalItem             As Outlook.MailItem\nDim objNewItem                  As Outlook.MailItem\nDim objInspector                As Outlook.Inspector\nDim objRecipient                As Outlook.Recipient\nDim strEmailAddress             As String\nDim strSubject                  As String\n\nSet objOutlookApp = GetObject(, &quot;Outlook.Application&quot;)\nSet objInspector = objOutlookApp.ActiveInspector\n'Set objOriginalItem so that it can be referenced\nSet objOriginalItem = objInspector.CurrentItem\n'Set objNewItem to create the new message.\nSet objNewItem = objOutlookApp.CreateItem(0)\n'Store the original body into the new item body\n'Note:  objNewItemBody was altered by code not shown here\nobjNewItem.Body = objOriginalItem.Body\n'Note: strEmailAddress was altered by code not shown here\nstrEmailAddress = &quot;unique_ name@hotmail.com&quot;\nSet objRecipient = objOutlookApp.Session.CreateRecipient(strEmailAddress)\nobjRecipient.Resolve\nMsgBox (&quot;The objrecipient.resolved status is: &quot; &amp; objRecipient.Resolved)\n'Set the fields of the MailItem.  Note:  objNewItem.Body was previously set\nWith objNewItem\n    .Display\n    .Subject = objOriginalItem.Subject\n    .To = objRecipient\n        'Loop through the attachments in objOriginalItem\n        'Save them to the user's temp folder.\n        'Attach them to objNewItem.\n    .Send\nEnd With\n\nEXUNT:\nSet objOutlookApp = Nothing\nSet objOriginalItem = Nothing\nSet objNewItem = Nothing\nSet objInspector = Nothing\n\nEnd Sub\n</code></pre>\n<p>In Outlook 2016 the <code>MsgBox</code> indicates &quot;True&quot;,  The User Interface has a window open for the new mail object and the properly-formatted Email address is there.</p>\n<p>When I click on the &quot;To&quot; field and then click &quot;Send&quot;, the Email is sent.</p>\n<p>Outlook 2013 yields a <code>MsgBox</code> indicating &quot;False&quot;, but it sends the eMail with user intervention anyway.</p>\n<p>How do I resolve this in Outlook 2016 to send the Email without user intervention?</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 1, "creation_date": 1554237270, "post_id": 55483041, "comment_id": 97675957, "body": "It looks like you&#39;re not setting <code>myPath</code> or <code>myFile</code> to anything"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1554237848, "post_id": 55483041, "comment_id": 97676213, "body": "IDK, nothing in that line (<code>Set aSMOnly = ...)</code>should raise a 91 error. If the filename is not valid, you&#39;ll get a 1004 error on the <code>Set wb</code> line. If the sheet named &quot;Assembly Daily Tracker&quot; doesn&#39;t exist, you&#39;ll get a 9 error. If the range B5:J6 or worksheet is protected, you might get 1004. But nothing on that line can raise a 91"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1554238111, "post_id": 55483041, "comment_id": 97676317, "body": "Error 91 means you&#39;re making a member call against an object reference that&#39;s <code>Nothing</code>. From the code you posted, that would mean <code>wb</code> is <code>Nothing</code>, and the only reason this could happen is if you have <code>On Error Resume Next</code> swallowing a prior error with opening the <code>myPath &amp; myFile</code> workbook, leaving <code>wb</code> unassigned... and then <code>On Error GoTo 0</code> to clear the current error and restore error handling somewhere before that <code>Set aSMOnly</code> assigment. Do you have <code>On Error Resume Next</code> anywhere in your actual code? If so, remove it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1554238204, "post_id": 55483041, "comment_id": 97676364, "body": "@DavidZemens if OP is swallowing the 1004 from an invalid filename, then restoring error handling before the <code>Set aSMOnly</code> assignment, the claimed errorring line could conceivably throw error 91, with <code>wb</code> being <code>Nothing</code>. But that&#39;s a stretch, indeed. Needs a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554258342, "post_id": 55483041, "comment_id": 97681229, "body": "@MathieuGuindon yep that&#39;s definitely possible. Hard to say with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> though. Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10707962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g_UzHmb_2fU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i74n-gS4027JRQ6R69RaDdIVoudA/mo/photo.jpg?sz=128", "display_name": "Ryland Moyar", "link": "https://stackoverflow.com/users/10707962/ryland-moyar"}, "edited": false, "score": 0, "creation_date": 1554295350, "post_id": 55486393, "comment_id": 97697994, "body": "Thank you all for your support and help through this. It works great. Only remaining issue is that, the .PasteSpecial copies formulas, instead of the values. Easy fix with .PasteSpecial xlPasteValues. I am more than happy to post the code entirely if it helps anyone else in the future..."}], "tags": [], "owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "is_accepted": true, "score": 0, "last_activity_date": 1554260503, "creation_date": 1554260503, "answer_id": 55486393, "question_id": 55483041, "link": "https://stackoverflow.com/questions/55483041/is-there-a-way-to-loop-through-multiple-workbooks-to-copy-ranges-into-one-active/55486393#55486393", "title": "Is there a way to loop through multiple workbooks to copy ranges into one active workbook?", "body": "<p>Give it a try to this...</p>\n\n<pre><code>Option Explicit\nSub main()\n\nDim wb As Workbook\nDim wb1 As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim aSMOnly As Range\nDim myRow As Integer\n\nSet FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\nNextCode:\nmyPath = myPath\nmyExtension = \"*.xlsx\"\nmyFile = Dir(myPath &amp; myExtension)\n\nmyRow = 2\nSet wb1 = ActiveWorkbook\n\nWith wb1\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Assembly\"\nEnd With\n\nDo While myFile &lt;&gt; \"\"\n\nSet wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\nSet aSMOnly = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B5:J6\")\naSMOnly.Copy\nwb1.Sheets(1).Range(\"D2:E5\").PasteSpecial\n\nwb.Close SaveChanges:=True\n\nmyFile = Dir\nLoop\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 10707962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g_UzHmb_2fU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i74n-gS4027JRQ6R69RaDdIVoudA/mo/photo.jpg?sz=128", "display_name": "Ryland Moyar", "link": "https://stackoverflow.com/users/10707962/ryland-moyar"}, "is_accepted": false, "score": 0, "last_activity_date": 1554295894, "creation_date": 1554295894, "answer_id": 55495664, "question_id": 55483041, "link": "https://stackoverflow.com/questions/55483041/is-there-a-way-to-loop-through-multiple-workbooks-to-copy-ranges-into-one-active/55495664#55495664", "title": "Is there a way to loop through multiple workbooks to copy ranges into one active workbook?", "body": "<p>I am quite a novice, and did not come up with blocks of this code on my own. I am also more than happy to hear any advice moving forward so that I may learn and develop more usable/better code. I will say that a concern of mine is processing time. I ran the test on 3 workbooks opening and copying/pasting their values, but ultimately I may be performing this task on 1000's, and in different folders (I would just go in and rerun it twice, and change the myrow initialization to the last open one - intentionally manually, instead of using the x1down approach, so that no one is more or less messing with it, or improperly using it, or duplicating values by selecting the same folder over and over). Again, this does not have the xlPasteValues after the .PasteSpecial yet (needed for me, might not be needed for all).</p>\n\n<p>Thank you Stack Overflow Community!!! Especially thank you to the posters that helped me to get to this point!</p>\n\n<pre><code>Sub DataExtractMultiFiles()\n    'PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n\n    Dim wb As Workbook\n    Dim wb1 As Workbook\n    Dim myPath As String\n    Dim myFile As String\n    Dim myExtension As String\n    Dim FldrPicker As FileDialog\n    Dim myRow As Integer\n    Dim aSMOnly As Range\n    Dim team1a As Range\n    Dim team2a As Range\n    Dim team3a As Range\n    Dim team4a As Range\n    Dim team5a As Range\n    Dim team6a As Range\n    Dim team7a As Range\n    Dim teamEa As Range\n    Dim firstShiftASM As Range\n    Dim team1b As Range\n    Dim team2b As Range\n    Dim team3b As Range\n    Dim team4b As Range\n    Dim team5b As Range\n    Dim team6b As Range\n    Dim team7b As Range\n    Dim teamEb As Range\n    Dim secondShiftASM As Range\n    Dim team1c As Range\n    Dim teamEc As Range\n    Dim thirdShiftASM As Range\n\n    'Initialize myRow variable\n    myRow = 2\n    Set wb1 = ActiveWorkbook\n\n    With wb1\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Assembly\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 1a\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 2a\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 3a\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 4a\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 5a\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 6a\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 7a\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team Ea\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"1st Assembly\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 1b\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 2b\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 3b\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 4b\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 5b\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 6b\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 7b\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team Eb\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"2nd Assembly\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team 1c\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Team Ec\"\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"3rd Assembly\"\n    End With\n\n    'Optimize Macro Speed\n      Application.ScreenUpdating = False\n      Application.EnableEvents = False\n      Application.Calculation = xlCalculationManual\n      Application.AskToUpdateLinks = False\n      Application.DisplayAlerts = False\n\n    'Retrieve Target Folder Path From User\n      Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n        With FldrPicker\n          .Title = \"Select A Target Folder\"\n          .AllowMultiSelect = False\n            If .Show &lt;&gt; -1 Then GoTo NextCode\n            myPath = .SelectedItems(1) &amp; \"\\\"\n        End With\n\n    'In Case of Cancel\n    NextCode:\n      myPath = myPath\n      If myPath = \"\" Then GoTo ResetSettings\n\n    'Target File Extension (must include wildcard \"*\")\n      myExtension = \"*.xls*\"\n\n    'Target Path with Ending Extention\n      myFile = Dir(myPath &amp; myExtension)\n\n    'Loop through each Excel file in folder\n      Do While myFile &lt;&gt; \"\"\n        Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n        ' Copy data from source\n\n            'Values for Total Summary\n        Set aSMOnly = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B5:J6\")\n        aSMOnly.Copy\n        wb1.Sheets(\"Assembly\").Range(\"B\" + CStr(myRow) + \":J\" +         CStr(myRow)).PasteSpecial\n        wb1.Sheets(\"Assembly\").Cells(myRow, \"A\").Value = wb.FullName\n\n            'Values for First Shift\n        Set team1a = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B7:J7\")\n        team1a.Copy\n        wb1.Sheets(\"Team 1a\").Range(\"B\" + CStr(myRow) + \":J\" +         CStr(myRow)).PasteSpecial\n        wb1.Sheets(\"Team 1a\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team2a = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B8:J8\")\nteam2a.Copy\nwb1.Sheets(\"Team 2a\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 2a\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team3a = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B9:J9\")\nteam3a.Copy\nwb1.Sheets(\"Team 3a\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 3a\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team4a = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B10:J10\")\nteam4a.Copy\nwb1.Sheets(\"Team 4a\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 4a\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team5a = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B11:J11\")\nteam5a.Copy\nwb1.Sheets(\"Team 5a\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 5a\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team6a = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B12:J12\")\nteam6a.Copy\nwb1.Sheets(\"Team 6a\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 6a\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team7a = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B13:J13\")\nteam7a.Copy\nwb1.Sheets(\"Team 7a\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 7a\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet teamEa = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B14:J14\")\nteamEa.Copy\nwb1.Sheets(\"Team Ea\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team Ea\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet firstShiftASM = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B15:J15\")\nfirstShiftASM.Copy\nwb1.Sheets(\"1st Assembly\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"1st Assembly\").Cells(myRow, \"A\").Value = wb.FullName\n\n\n    'Values for Second Shift\nSet team1b = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B16:J16\")\nteam1b.Copy\nwb1.Sheets(\"Team 1b\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 1b\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team2b = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B17:J17\")\nteam2b.Copy\nwb1.Sheets(\"Team 2b\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 2b\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team3b = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B18:J18\")\nteam3b.Copy\nwb1.Sheets(\"Team 3b\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 3b\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team4b = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B19:J19\")\nteam4b.Copy\nwb1.Sheets(\"Team 4b\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 4b\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team5b = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B20:J20\")\nteam5b.Copy\nwb1.Sheets(\"Team 5b\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 5b\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team6b = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B21:J21\")\nteam6b.Copy\nwb1.Sheets(\"Team 6b\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 6b\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet team7b = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B22:J22\")\nteam7b.Copy\nwb1.Sheets(\"Team 7b\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 7b\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet teamEb = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B23:J23\")\nteamEb.Copy\nwb1.Sheets(\"Team Eb\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team Eb\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet secondShiftASM = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B24:J24\")\nsecondShiftASM.Copy\nwb1.Sheets(\"2nd Assembly\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"2nd Assembly\").Cells(myRow, \"A\").Value = wb.FullName\n\n\n    'Values for Third Shift\nSet team1c = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B25:J25\")\nteam1c.Copy\nwb1.Sheets(\"Team 1c\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team 1c\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet teamEc = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B26:J26\")\nteamEc.Copy\nwb1.Sheets(\"Team Ec\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"Team Ec\").Cells(myRow, \"A\").Value = wb.FullName\n\nSet thirdShiftASM = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B27:J27\")\nthirdShiftASM.Copy\nwb1.Sheets(\"3rd Assembly\").Range(\"B\" + CStr(myRow) + \":J\" + CStr(myRow)).PasteSpecial\nwb1.Sheets(\"3rd Assembly\").Cells(myRow, \"A\").Value = wb.FullName\n\nmyRow = myRow + 1\n\n'Close Workbook\n  wb.Close SaveChanges:=False\n\n'Get next file name\n  myFile = Dir\n     Loop\n\n    ResetSettings:\n      'Reset Macro Optimization Settings\n        Application.EnableEvents = True\n        Application.Calculation = xlCalculationAutomatic\n        Application.ScreenUpdating = True\n        Application.DisplayAlerts = True\n        Application.AskToUpdateLinks = True\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10707962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g_UzHmb_2fU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i74n-gS4027JRQ6R69RaDdIVoudA/mo/photo.jpg?sz=128", "display_name": "Ryland Moyar", "link": "https://stackoverflow.com/users/10707962/ryland-moyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 55486393, "answer_count": 2, "score": 0, "last_activity_date": 1554295894, "creation_date": 1554236771, "last_edit_date": 1554238227, "question_id": 55483041, "link": "https://stackoverflow.com/questions/55483041/is-there-a-way-to-loop-through-multiple-workbooks-to-copy-ranges-into-one-active", "title": "Is there a way to loop through multiple workbooks to copy ranges into one active workbook?", "body": "<p>I am at the end of my knowledge, and would greatly appreciate the help with some debugging.</p>\n\n<p>I have already tried to just make the <code>wb.sheet.range.value = wb1.sheet.range.value</code></p>\n\n<pre><code>'''vba\n\nDim wb As Workbook\nDim wb1 As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim myRow As Integer\nDim aSMOnly As Range\n\n\n'Initialize myRow variable\nmyRow = 2\nSet wb1 = ActiveWorkbook\n\nWith wb1\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Assembly\"\n\n'theres a bunch of other sheets added\nEnd With\n  Do While myFile &lt;&gt; \"\"\n    Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    ' Copy data from source\n    Set aSMOnly = wb.Sheets(\"Assembly Daily Tracker\").Range(\"B5:J6\")\n\n'''\n</code></pre>\n\n<p>so the last line shown produced a <code>runtime 91 error</code>. I am not sure what I am doing wrong, but I can't get past this.</p>\n\n<p>Does this for a bunch of different ranges within the same sheet, I should also mention that these are merged cells, but multiple merged cells within the range - assuming that is the problem.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1554242475, "post_id": 55483014, "comment_id": 97677970, "body": "Your question is too broad. For example, you don&#39;t say how all the required content is to be identified, which table(s), or how many tables, from each document are involved."}, {"owner": {"reputation": 1, "user_id": 11301936, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DQkOxlIiHJA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdyANpwoZ9UIgHq0fwkTlBnf0IX-w/mo/photo.jpg?sz=128", "display_name": "Sean McDonough", "link": "https://stackoverflow.com/users/11301936/sean-mcdonough"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1554295852, "post_id": 55483014, "comment_id": 97698329, "body": "The form is one continuous table. I don&#39;t know how Word treats its tables, but all the data is in the same place on every document. If it were in Excel it&#39;d be (for example) Cell D3, B12, and D25."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1554324395, "creation_date": 1554324395, "answer_id": 55504001, "question_id": 55483014, "link": "https://stackoverflow.com/questions/55483014/extracting-specific-cells-from-a-folder-full-of-identical-word-tables/55504001#55504001", "title": "Extracting specific cells from a folder full of identical Word tables", "body": "<p>Try the following <em>Excel</em> macro, which extracts the Word data from cells D3, B12, and D25 in the first table of each Word document in the selected folder. The document name is output to column A and the remaining data are output to columns B-D. That's only 3 items from each file, but your reference to \"A name, a number, a date, and the contents of a single cell\" implies there are 4.</p>\n\n<pre><code>Sub GetTableData()\n'Note: this code requires a reference to the Word object model.\n'See under the VBE's Tools|References.\nApplication.ScreenUpdating = False\nDim wdApp As New Word.Application, wdDoc As Word.Document\nDim strFolder As String, strFile As String, WkSht As Worksheet, r As Long\nstrFolder = GetFolder: If strFolder = \"\" Then GoTo ErrExit\nSet WkSht = ActiveSheet: r = WkSht.Cells(WkSht.Rows.Count, 1).End(xlUp).Row\nstrFile = Dir(strFolder &amp; \"\\*.doc\", vbNormal)\nWith wdApp\n  'Hide our Word session\n  .Visible = False\n  'Disable any auto macros in the documents being processed\n  .WordBasic.DisableAutoMacros\n  While strFile &lt;&gt; \"\"\n    Set wdDoc = .Documents.Open(Filename:=strFolder &amp; \"\\\" &amp; strFile, AddToRecentFiles:=False, Visible:=False)\n    r = r + 1: WkSht.Range(\"A\" &amp; r) = Split(strFile, \".doc\")(0)\n    With wdDoc\n      If .Tables.Count &gt; 0 Then\n        With .Tables(1)\n          WkSht.Range(\"B\" &amp; r) = Split(.Cell(3, 4), vbCr)(0)\n          WkSht.Range(\"C\" &amp; r) = Split(.Cell(12, 2), vbCr)(0)\n          WkSht.Range(\"D\" &amp; r) = Split(.Cell(25, 4), vbCr)(0)\n        End With\n      End If\n      .Close SaveChanges:=False\n    End With\n    strFile = Dir()\n  Wend\n  .Quit\nEnd With\nSet wdDoc = Nothing: Set wdApp = Nothing: Set WkSht = Nothing    Application.ScreenUpdating = True\nEnd Sub\n\nFunction GetFolder() As String\n    Dim oFolder As Object\n    GetFolder = \"\"\n    Set oFolder = CreateObject(\"Shell.Application\").BrowseForFolder(0, \"Choose a folder\", 0)\n    If (Not oFolder Is Nothing) Then GetFolder = oFolder.Items.Item.Path\n    Set oFolder = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11301936, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DQkOxlIiHJA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdyANpwoZ9UIgHq0fwkTlBnf0IX-w/mo/photo.jpg?sz=128", "display_name": "Sean McDonough", "link": "https://stackoverflow.com/users/11301936/sean-mcdonough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554324395, "creation_date": 1554236639, "question_id": 55483014, "link": "https://stackoverflow.com/questions/55483014/extracting-specific-cells-from-a-folder-full-of-identical-word-tables", "title": "Extracting specific cells from a folder full of identical Word tables", "body": "<p>I have a folder full of Word forms that I want to extract a few key pieces of information from: A name, a number, a date, and the contents of a single cell. I've seen solutions for importing entire Word tables, but I don't need most of the information on the tables.</p>\n\n<p>All the forms in word are the same, save for the data in the cells, as people have used the template to make these forms. All the cells are labeled to the right of the cells I actually want. I have a folder full of these Word document forms.</p>\n\n<p>I've tried modifying this script (<a href=\"https://stackoverflow.com/questions/3567441/extract-data-from-word-document-to-an-excel-spreadsheet\">Extract Data from Word Document to an Excel SpreadSheet</a>) but my VBA skills are terrible and I can't get more than a line of data before it crashes out.</p>\n\n<p>How do I extract the specific cells containing the data I want from these word documents? I'd even be happy just to get the entire line that data is on.</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11264831, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8HXGKTCR77c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddFbtVpB9xIqg7tlamwcWDfFKkwQ/mo/photo.jpg?sz=128", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/11264831/manoj-kumar"}, "edited": false, "score": 0, "creation_date": 1554283827, "post_id": 55483186, "comment_id": 97690746, "body": "Hi Charles. Thanks for reply. I tried your suggestion and it comes with &quot;Invalid Redim&quot; error. Unfortunately my coding skills are way too low to understand or fix this."}, {"owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "reply_to_user": {"reputation": 5, "user_id": 11264831, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8HXGKTCR77c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddFbtVpB9xIqg7tlamwcWDfFKkwQ/mo/photo.jpg?sz=128", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/11264831/manoj-kumar"}, "edited": false, "score": 0, "creation_date": 1554308177, "post_id": 55483186, "comment_id": 97706324, "body": "@ManojKumar, I&#39;ve corrected my code, now it should work. Keep me posted!"}, {"owner": {"reputation": 5, "user_id": 11264831, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8HXGKTCR77c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddFbtVpB9xIqg7tlamwcWDfFKkwQ/mo/photo.jpg?sz=128", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/11264831/manoj-kumar"}, "edited": false, "score": 0, "creation_date": 1554319968, "post_id": 55483186, "comment_id": 97712112, "body": "Hi Charles. This worked perfectly. Thank you so much for taking time to help me."}, {"owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "reply_to_user": {"reputation": 5, "user_id": 11264831, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8HXGKTCR77c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddFbtVpB9xIqg7tlamwcWDfFKkwQ/mo/photo.jpg?sz=128", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/11264831/manoj-kumar"}, "edited": false, "score": 0, "creation_date": 1554320050, "post_id": 55483186, "comment_id": 97712160, "body": "No problem. Thanks for specifying that my answer solved your problem."}], "tags": [], "owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "is_accepted": true, "score": 2, "last_activity_date": 1554308139, "last_edit_date": 1554308139, "creation_date": 1554237400, "answer_id": 55483186, "question_id": 55482915, "link": "https://stackoverflow.com/questions/55482915/excel-udf-sort-numbers-and-text-separated-by-comma-within-a-cell/55483186#55483186", "title": "Excel UDF - sort numbers and text separated by comma within a cell", "body": "<p>Your code is treating the contents of your arrays as text, therefore that's why values are sorted like they are.  </p>\n\n<p>Unfortunately considering only changing the type of your arrays from <code>String</code> to <code>Long</code> or <code>Double</code> is not as simple, because of your <code>NA</code> (or any other <code>String</code>) value...</p>\n\n<p>This solution is not very elegant and I don't like to see Function that are that long, but it works.</p>\n\n<pre><code>Public Function StrSort(ByVal sInp As String, _\n                  Optional bDescending As Boolean = False) As String\n    ' sorts a comma-delimited string\n    Dim asSS()  As String    ' substring array\n    Dim sSS     As String    ' temp string for exchange\n    Dim n       As Long\n    Dim i       As Long\n    Dim j       As Long\n\n    asSS = Split(sInp, \",\")\n    n = UBound(asSS)\n\n    'First, we are gonna sort Numeric values from every other type of value.\n    'The numeric values are going to be stored in an array containing only numeric values\n    Dim TemporaryNumberArray() As Double\n    For i = 0 To n\n        If IsNumeric(Trim(asSS(i))) Then\n            On Error Resume Next\n            If IsError(UBound(TemporaryNumberArray)) Then\n                ReDim TemporaryNumberArray(0 To 0)\n            Else\n                ReDim Preserve TemporaryNumberArray(0 To UBound(TemporaryNumberArray) + 1)\n            End If\n            On Error GoTo 0\n            TemporaryNumberArray(UBound(TemporaryNumberArray)) = asSS(i)\n        End If\n\n    Next\n\n\n    n = UBound(TemporaryNumberArray)\n\n    'Now, we are going to sort the numbers array.\n    If n &lt; 1 Then\n        StrSort = sInp\n    Else\n        For i = 0 To n - 1\n            For j = i + 1 To n\n                If (TemporaryNumberArray(j) &lt; TemporaryNumberArray(i)) Xor bDescending Then\n                    sSS = TemporaryNumberArray(i)\n                    TemporaryNumberArray(i) = TemporaryNumberArray(j)\n                    TemporaryNumberArray(j) = sSS\n                End If\n            Next j\n        Next i\n\n        'Now, we are building the return string that contains the numbers in order\n        StrSort = CStr(TemporaryNumberArray(0))\n        For i = 1 To n\n            StrSort = StrSort &amp; \", \" &amp; CStr(TemporaryNumberArray(i))\n        Next\n    End If\n\n    'Finally, we are going to append the non-numeric values at the end, in the same order as they appear in the input string\n    If n &lt; UBound(asSS) Then\n        For i = 0 To UBound(asSS)\n            If Not IsNumeric(asSS(i)) Then\n                StrSort = StrSort &amp; \", \" &amp; asSS(i)\n            End If\n        Next\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11264831, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8HXGKTCR77c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddFbtVpB9xIqg7tlamwcWDfFKkwQ/mo/photo.jpg?sz=128", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/11264831/manoj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 55483186, "answer_count": 1, "score": 0, "last_activity_date": 1554308139, "creation_date": 1554236229, "last_edit_date": 1554237393, "question_id": 55482915, "link": "https://stackoverflow.com/questions/55482915/excel-udf-sort-numbers-and-text-separated-by-comma-within-a-cell", "title": "Excel UDF - sort numbers and text separated by comma within a cell", "body": "<p>I have a column of data which has numbers and text in each cell, separated by a comma. I found a UDF in another forum (see code below) which sort of does the job but not quite. For example:</p>\n\n<p>Original cell:  </p>\n\n<blockquote>\n  <p>84,86,NA,268,277,400,411,42,120,244,346</p>\n</blockquote>\n\n<p>UDF result:</p>\n\n<blockquote>\n  <p>120, 244, 268, 277, 346, 400, 411, 42, 84, 86, NA</p>\n</blockquote>\n\n<p>Desired result: </p>\n\n<blockquote>\n  <p>42, 84, 86, 120, 244, 268, 277, 346, 400, 411, NA</p>\n</blockquote>\n\n<p>I was wondering if someone could help me fix this code.\nThank you much.\nBest Wishes\nManoj</p>\n\n<p>See the code for the UDF i found in another forum</p>\n\n<pre><code>Function StrSort(ByVal sInp As String, _\n                  Optional bDescending As Boolean = False) As String\n    ' sorts a comma-delimited string\n    Dim asSS()  As String    ' substring array\n    Dim sSS     As String    ' temp string for exchange\n    Dim n       As Long\n    Dim i       As Long\n    Dim j       As Long\n\n    asSS = Split(sInp, \",\")\n    n = UBound(asSS)\n\n    For i = 0 To n\n        asSS(i) = Trim(asSS(i))\n    Next\n\n    If n &lt; 1 Then\n        StrSort = sInp\n    Else\n        For i = 0 To n - 1\n            For j = i + 1 To n\n                If (asSS(j) &lt; asSS(i)) Xor bDescending Then\n                    sSS = asSS(i)\n                    asSS(i) = asSS(j)\n                    asSS(j) = sSS\n                End If\n            Next j\n        Next i\n        StrSort = Join(asSS, \", \")\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "json", "vba", "parsing"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554238967, "post_id": 55482912, "comment_id": 97676664, "body": "Are you <i>sure</i> <code>J</code> is an array? <code>Set</code> assigns object references, not arrays, and <code>CallByName</code> works with an object instance, not an array - that said <code>0</code> is an illegal member name, so that <code>&quot;0&quot;</code> call is guaranteed to fail. What does <code>setJSON</code> actually do/return? What is the specific error you&#39;re getting exactly?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554239146, "post_id": 55482912, "comment_id": 97676731, "body": "Are you using VBA-Tools/JSON? Then <code>J</code> would be a <code>Dictionary</code> object, and <code>J(&quot;expectedRateSetList&quot;)</code> should get you another <code>Dictionary</code>; objects are never <code>Null</code> in VB, but they can be <code>Nothing</code> - that said you shouldn&#39;t be changing the type and meaning of <code>J</code> like this. Variables are cheap - declare them with an explicit data type, and give them meaningful names!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554239198, "post_id": 55482912, "comment_id": 97676746, "body": "Assuming <code>J</code> (well the first one anyway) is a <code>Dictionary</code>, then <code>If J.Count &gt; 0 Then</code> should rid you of that <code>GoTo</code> jump."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1554241573, "post_id": 55482912, "comment_id": 97677684, "body": "@MathieuGuindon Is correct. I wonder sometimes if this confusion about array comes from the fact the JSON itself has object {} ( unordered set of name/value pairs) and array [] (ordered collection of values)  - <a href=\"http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf\" rel=\"nofollow noreferrer\">ecma-international.org/publications/files/ECMA-ST/ECMA-404.p&zwnj;&#8203;df</a>   These terms are not applied in the same way in VBA implementations where {} is dict and [] is collection."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8790803, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tQOaUUIpdI4/AAAAAAAAAAI/AAAAAAAAAKM/IePyoM_K-9k/photo.jpg?sz=128", "display_name": "Sergio Martinez", "link": "https://stackoverflow.com/users/8790803/sergio-martinez"}, "edited": false, "score": 0, "creation_date": 1554329651, "post_id": 55483758, "comment_id": 97716089, "body": "This makes sense.  I will definitely try this.  Right now they put me on a couple different projects so it may be a bit before I try this."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 51, "user_id": 8790803, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tQOaUUIpdI4/AAAAAAAAAAI/AAAAAAAAAKM/IePyoM_K-9k/photo.jpg?sz=128", "display_name": "Sergio Martinez", "link": "https://stackoverflow.com/users/8790803/sergio-martinez"}, "edited": false, "score": 0, "creation_date": 1554331979, "post_id": 55483758, "comment_id": 97716782, "body": "You can use the <i>locals</i> toolwindow to inspect the object structure. Good luck!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1554240169, "creation_date": 1554240169, "answer_id": 55483758, "question_id": 55482912, "link": "https://stackoverflow.com/questions/55482912/need-help-skipping-an-empty-json-array-with-vba/55483758#55483758", "title": "Need help skipping an empty json array with VBA", "body": "<p><code>J</code> is definitely not an array. <code>J</code> is an object, likely a <code>Dictionary</code>. You can check if a dictionary contains any items by querying its <code>Count</code> property - that removes the need for the line label and <code>GoTo</code> jump, at the cost of increased nesting (but then, the loop body should probably be refactored into its own procedure anyway):</p>\n\n<pre><code>    If J.Count &gt; 0 Then\n        ' there are items\n    End If\nNext\n</code></pre>\n\n<p>Note that <code>CallByName(J, \"MemberName\", vbGet)</code> can be replaced by late-bound <code>J.MemberName</code> calls - but then again assuming your parsing isn't hand-crafted and you <em>are</em> getting nested dictionaries, that would be <code>J(\"MemberName\")</code>; the property you're actually invoking is the (default) <code>Items</code> property: <code>J.Items(\"MemberName\")</code> is equivalent.</p>\n"}], "owner": {"reputation": 51, "user_id": 8790803, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tQOaUUIpdI4/AAAAAAAAAAI/AAAAAAAAAKM/IePyoM_K-9k/photo.jpg?sz=128", "display_name": "Sergio Martinez", "link": "https://stackoverflow.com/users/8790803/sergio-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554240169, "creation_date": 1554236224, "question_id": 55482912, "link": "https://stackoverflow.com/questions/55482912/need-help-skipping-an-empty-json-array-with-vba", "title": "Need help skipping an empty json array with VBA", "body": "<p>I am looping through different process ids to access the data within the json and copy it to my spreadsheet. However, some of the process id contain no data and every time my code gets to these empty arrays I get an error.  I have tried different variations of if statements to skip this but still get an error.  The empty array is at \"expectedRateSetList\"</p>\n\n<p>I have tried different variations of if statements to skip this but still get an error.  I've tried 'If J is null, if J is nothing, If J is empty\" etc but I still can't get it to work. I've also tried \"On error go to\" but this hasn't worked.</p>\n\n<pre><code>    `````````````\n    For l = 2 To last_row(tb, 2)\n\n    Set J = setJSON(url)\n    Set J = CallByName(J, \"expectedRateSetList\", VbGet)  &lt;---This is the array that is empty        \n    If J Is Null Then GoTo next_log\n    On Error GoTo next_log\n    Set J = CallByName(J, \"0\", VbGet)   \n    Set J = CallByName(J, \"expectedRateList\", VbGet)\n    next_log:\n    Next l\n</code></pre>\n\n<pre><code>'json array looks like this:\n{\"processId\":X,\"expectedRateSetList\":[],\"warehouseId\":\"warehouseX\"}\n</code></pre>\n"}, {"tags": ["excel", "vba", "countif"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1554236279, "post_id": 55482863, "comment_id": 97675518, "body": "What have you written thusfar as your starter macro?  If you are asking if this is possible, then yes, it is possible... but you need to show what you&#39;ve done so we can provide <i>objective</i> answers, typically related to specific errors you are receiving or questions about the output not being correct."}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1554238555, "creation_date": 1554238555, "answer_id": 55483438, "question_id": 55482863, "link": "https://stackoverflow.com/questions/55482863/how-to-loop-over-conditions-in-countifs-formula-vba/55483438#55483438", "title": "How to loop over conditions in countifs formula VBA", "body": "<p>Perhaps something like this will work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim rFormula As Range\n    Dim hArguments As Object\n    Dim sArguments As String\n    Dim sMessage As String\n    Dim sTemp As String\n    Dim sChar As String\n    Dim lFunctionStart As Long\n    Dim lParensPairs As Long\n    Dim lQuotePairs As Long\n    Dim bArgumentEnd As Boolean\n    Dim i As Long, j As Long\n\n    Set hArguments = CreateObject(\"Scripting.Dictionary\")\n\n    For Each rFormula In Selection.Cells\n        lFunctionStart = InStr(1, rFormula.Formula, \"COUNTIFS(\", vbTextCompare)\n        If lFunctionStart &gt; 0 Then\n            lFunctionStart = lFunctionStart + 9\n            lParensPairs = 1\n            lQuotePairs = 0\n            j = 0\n            bArgumentEnd = False\n            For i = lFunctionStart To Len(rFormula.Formula)\n                sChar = Mid(rFormula.Formula, i, 1)\n                Select Case sChar\n                    Case \"'\", \"\"\"\"\n                        If lQuotePairs = 0 Then\n                            lQuotePairs = lQuotePairs + 1\n                        Else\n                            lQuotePairs = lQuotePairs - 1\n                        End If\n                        sTemp = sTemp &amp; sChar\n\n                    Case \"(\"\n                        If lQuotePairs = 0 Then\n                            lParensPairs = lParensPairs + 1\n                        End If\n                        sTemp = sTemp &amp; sChar\n\n                    Case \")\"\n                        If lQuotePairs = 0 Then\n                            lParensPairs = lParensPairs - 1\n                            If lParensPairs = 0 Then\n                                j = j + 1\n                                hArguments(j) = sTemp\n                                sTemp = vbNullString\n                                Exit For\n                            Else\n                                sTemp = sTemp &amp; sChar\n                            End If\n                        Else\n                            sTemp = sTemp &amp; sChar\n                        End If\n\n                    Case \",\"\n                        If lQuotePairs = 0 And lParensPairs = 1 Then\n                            bArgumentEnd = True\n                            j = j + 1\n                            hArguments(j) = sTemp\n                            sTemp = vbNullString\n                        Else\n                            sTemp = sTemp &amp; sChar\n                        End If\n\n                    Case Else\n                        sTemp = sTemp &amp; sChar\n\n                End Select\n            Next i\n            For i = 1 To hArguments.Count Step 2\n                If Len(sArguments) = 0 Then\n                    sArguments = hArguments(i) &amp; \",\" &amp; hArguments(i + 1)\n                Else\n                    sArguments = sArguments &amp; \",\" &amp; hArguments(i) &amp; \",\" &amp; hArguments(i + 1)\n                End If\n                If Evaluate(\"COUNTIFS(\" &amp; sArguments &amp; \")\") = 0 Then\n                    MsgBox \"Search Range: \" &amp; hArguments(i) &amp; Chr(10) &amp; _\n                           \"Search String: \" &amp; hArguments(i + 1) &amp; Chr(10) &amp; _\n                           \"Countif condition position: \" &amp; Int(i / 2) + 1\n                    Exit For\n                End If\n            Next i\n        End If\n    Next rFormula\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1554240797, "creation_date": 1554240797, "answer_id": 55483869, "question_id": 55482863, "link": "https://stackoverflow.com/questions/55482863/how-to-loop-over-conditions-in-countifs-formula-vba/55483869#55483869", "title": "How to loop over conditions in countifs formula VBA", "body": "<p>Posting just as an alternative method to get at the arguments (which I found in another answer elsewhere by Peter Thornton)</p>\n\n\n\n<pre><code>Private args()\n\nSub Tester()\n    Debug.Print GetZeroStep(Range(\"M1\"))\nEnd Sub\n\n\nFunction GetZeroStep(c As Range)\n\n    Dim f, arr, i, r, s, n, rng, v\n    f = Replace(c.Formula, \"=COUNTIFS(\", \"=MyUDFTmp(\")\n\n    Debug.Print f\n    r = Application.Evaluate(f)\n\n\n    For i = 0 To UBound(args) Step 2\n        n = n + 1\n        Set rng = args(i)\n        v = args(i + 1)\n        If Not IsNumeric(v) Then v = \"\"\"\" &amp; v &amp; \"\"\"\"\n        s = s &amp; IIf(s &lt;&gt; \"\", \",\", \"\") &amp; \"'\" &amp; rng.Parent.Name &amp; \"'!\" &amp; _\n                                         rng.Address() &amp; \",\" &amp; v\n        Debug.Print \"=COUNTIFS(\" &amp; s &amp; \")\"\n        r = Application.Evaluate(\"=COUNTIFS(\" &amp; s &amp; \")\")\n        If r = 0 Then\n            GetZeroStep = n\n            Exit Function\n        End If\n    Next i\n    GetZeroStep = 0 '&lt;&lt; didn't return zero on any step...\nEnd Function\n\n'https://social.msdn.microsoft.com/Forums/Lync/en-US/8c52aee1-5168-4909-9c6a-9ea790c2baca/get-formula-arguments-in-vba?forum=exceldev\nPublic Function MyUDFTmp(ParamArray arr())\n   args() = arr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 8335101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSqoL.jpg?s=128&g=1", "display_name": "Cody Mayers", "link": "https://stackoverflow.com/users/8335101/cody-mayers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1554240797, "creation_date": 1554235977, "last_edit_date": 1554236739, "question_id": 55482863, "link": "https://stackoverflow.com/questions/55482863/how-to-loop-over-conditions-in-countifs-formula-vba", "title": "How to loop over conditions in countifs formula VBA", "body": "<p>I have an Excel worksheet with a column full of COUNTIFS() formulas. For each one that evaluates to zero, I have to manually apply filters on the appropriate columns to find out at which step in the formula the result reached zero. What I want to do is write a macro to automate this a bit. For instance:</p>\n\n<pre><code> =COUNTIFS('Data'!A:A,\"Yes\",'Data'!B:B,\"Yes\",'Data'!C:C,\"Yes\")\n</code></pre>\n\n<p>If the count becomes zero as soon as the first condition is evaluated, I want it to <code>MsgBox</code> a value of 1. If it becomes zero upon evaluating the second condition, return a 2 instead. If it doesn't hit zero until adding the third condition, I want it to return a 3 instead, and so on.</p>\n\n<p>For the sake of simplicity, assume it only has to work for <strong>one cell</strong>, rather than looping through each cell in my column.</p>\n\n<p>EDIT: Here is the code I've written so far. It will take a COUNTIFS() formula and run the <strong>first</strong> condition as a COUNTIF(), but I haven't been able to think of how to extend this to also do the later conditions.</p>\n\n<pre><code>            'Find Indexes\n            countifsStart = InStr(1, cell.Formula, \"COUNTIFS(\")\n            sheetNameStart = InStr(countifsStart, cell.Formula, \"(\") + 2\n            sheetNameEnd = InStr(sheetNameStart, cell.Formula, \"'\")\n            searchRangeStart = InStr(sheetNameEnd, cell.Formula, \"!\") + 1\n            searchRangeSemicolon = InStr(searchRangeStart, cell.Formula, \":\")\n            searchStringStart = InStr(searchRangeSemicolon, cell.Formula, \",\") + 2\n            searchStringEnd = InStr(searchStringStart, cell.Formula, \",\") - 1\n\n            'Parse formula components\n            sheetName = Mid(cell.Formula, sheetNameStart, sheetNameEnd - sheetNameStart)\n            searchColumn = Mid(cell.Formula, searchRangeStart, 1)\n            Set searchRange = Range(searchColumn &amp; \":\" &amp; searchColumn)\n            searchString = Mid(cell.Formula, searchStringStart, searchStringEnd - searchStringStart)\n\n            'Run the countif\n            countIf = Application.WorksheetFunction.countIf(Sheets(sheetName).Range(searchColumn &amp; \":\" &amp; searchColumn), searchString)\n\n            'Point out the culprit\n            MsgBox \"Sheet Name: \" &amp; sheetName &amp; vbNewLine &amp; _\n                   \"Search Range: \" &amp; searchColumn &amp; \":\" &amp; searchColumn &amp; vbNewLine &amp; _\n                   \"Search String: \" &amp; searchString &amp; vbNewLine &amp; _\n                   \"CountIf: \" &amp; countIf\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11301928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qj3Bs1QUX8A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf-zzdbJCEo0KfDJyF8DlG0StSqHg/mo/photo.jpg?sz=128", "display_name": "Mr.B", "link": "https://stackoverflow.com/users/11301928/mr-b"}, "edited": false, "score": 0, "creation_date": 1554464410, "post_id": 55507446, "comment_id": 97772220, "body": "hey Anthony. thank you very much. exactly what i needed. i am reading up on vba so i don\u2019t have to ask these basic questions. thank you again for your help!"}, {"owner": {"reputation": 44, "user_id": 10954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f5df8e44ea9b98956fa8619f7e91fea?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony White", "link": "https://stackoverflow.com/users/10954825/anthony-white"}, "reply_to_user": {"reputation": 3, "user_id": 11301928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qj3Bs1QUX8A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf-zzdbJCEo0KfDJyF8DlG0StSqHg/mo/photo.jpg?sz=128", "display_name": "Mr.B", "link": "https://stackoverflow.com/users/11301928/mr-b"}, "edited": false, "score": 0, "creation_date": 1554690372, "post_id": 55507446, "comment_id": 97830406, "body": "@Mr.B Hey, glad I was able to help, could you kindly click on the accept button since the problem is solved :D"}], "tags": [], "owner": {"reputation": 44, "user_id": 10954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f5df8e44ea9b98956fa8619f7e91fea?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony White", "link": "https://stackoverflow.com/users/10954825/anthony-white"}, "is_accepted": true, "score": 0, "last_activity_date": 1554350810, "last_edit_date": 1554350810, "creation_date": 1554348935, "answer_id": 55507446, "question_id": 55482842, "link": "https://stackoverflow.com/questions/55482842/copy-row-by-row-from-sheet1-to-sheet2-with-empty-rows-between/55507446#55507446", "title": "Copy row by row from sheet1 to sheet2 with empty rows between", "body": "<p>Here you go, not sure if this is what you want. Column A are String only, column B to D contain Formula. You mentioned to leave five empty rows in between but I saw your description also mentioned to start at row 17 then the next should start at row 22, which is four empty rows. You can change the number of empty rows by changing the offset from 4 to 5.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wsXbF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wsXbF.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/W9QOE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W9QOE.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub copy_to_sheet2()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim i As Long\nDim count_1 As Integer\nDim count_2 As Integer\nDim offset As Integer\nDim last_row As Long\n\n'your workbook / sheets name\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet ws2 = ThisWorkbook.Sheets(\"Sheet2\")\n\n'get total rows of sheet 1\nlast_row = ws1.Range(\"A\" &amp; ws1.Rows.count).End(xlUp).Row\ncount_1 = 1 'sheet 1 counter\ncount_2 = 17 'sheet 2 counter\noffset = 0 'offset / empty rows default value\n\n    'loop sheet 1 from 1st row to last row\n    For i = 1 To last_row\n\n        If i = 2 Then\n            offset = 4 '2nd loop change offset to 4\n        ElseIf i &gt; 2 Then\n            offset = offset + 4 'subsequent loop offset + 4\n        End If\n\n        'copy sheet 1 column A to D row by row &amp; paste values to sheet 2 with offset row by row\n        ws1.Range(\"A\" &amp; count_1 &amp; \":\" &amp; \"D\" &amp; count_1).SpecialCells(xlCellTypeVisible).Copy\n        ws2.Range(\"A\" &amp; count_2 + offset).PasteSpecial xlPasteValues\n\n        'add counter\n        count_1 = count_1 + 1\n        count_2 = count_2 + 1\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11301928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qj3Bs1QUX8A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf-zzdbJCEo0KfDJyF8DlG0StSqHg/mo/photo.jpg?sz=128", "display_name": "Mr.B", "link": "https://stackoverflow.com/users/11301928/mr-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 55507446, "answer_count": 1, "score": 0, "last_activity_date": 1607984696, "creation_date": 1554235926, "last_edit_date": 1607984696, "question_id": 55482842, "link": "https://stackoverflow.com/questions/55482842/copy-row-by-row-from-sheet1-to-sheet2-with-empty-rows-between", "title": "Copy row by row from sheet1 to sheet2 with empty rows between", "body": "<p>I am trying to copy rows from sheet1 (number of rows can vary up to 700) to sheet2.</p>\n<p>Sheet1 column A is text, B, C and D have formulas.</p>\n<p>On sheet2 each row should have five empty rows in between. The paste should start at row 17 (next 22, etc.).</p>\n<p>I checked Google but did not know how to amend the code I found.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1554236095, "post_id": 55482828, "comment_id": 97675435, "body": "the variable &quot;cell&quot; is a range variable, so you can [Dim cell As Range] or [Dim cell As Variant]"}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "reply_to_user": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1554236406, "post_id": 55482828, "comment_id": 97675583, "body": "Thanks @KacireeSoftware - however this moved to error 1004, action won&#39;t work on multiples selections on the following line <code>Union(Range(&quot;D1:AE&quot; &amp; lRow), Range(cells(1, cells.Column), cells(lRow, cells.Column))).CopyPicture</code>"}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1554236501, "post_id": 55482828, "comment_id": 97675618, "body": "Let me plug your code in and run it on my machine. I will be back"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1554236964, "post_id": 55482828, "comment_id": 97675820, "body": "Looks like <code>Range.CopyPicture</code> can&#39;t be used with a <code>Union</code> of multiple selections - you might need a workaround."}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1554237160, "post_id": 55482828, "comment_id": 97675906, "body": "I see your point - is there an alternative in code that could select directly a range from &quot;D1:AE40&quot; and avoid then the Union ?"}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554237338, "post_id": 55482828, "comment_id": 97675986, "body": "@BigBen I concur."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554237638, "post_id": 55482828, "comment_id": 97676110, "body": "Can you explain what range needs to be copied, or maybe add a sample screenshot?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1554237652, "post_id": 55482828, "comment_id": 97676116, "body": "Side note, consider using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> to keep the indentation style consistent (the body of that <code>For Each</code> loop wants to be indented one level, among other code-formatting issues)."}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1554238059, "post_id": 55482828, "comment_id": 97676290, "body": "I need to capture all the contents from cell D1:AE40 from the worksheet &quot;B&quot; in the example and paste it as a picture in the slide number 9."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554238151, "post_id": 55482828, "comment_id": 97676337, "body": "What are <code>lCol</code> and <code>lRow</code> equal to in this case - are you trying to find the last row/column within <code>D1:AE40</code>?"}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1554238328, "post_id": 55482828, "comment_id": 97676418, "body": "correct - I thought to define the selection D1:AE40 to reflect it as a Lcol and Lrow for the shape but maybe I over complicated it"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554238373, "post_id": 55482828, "comment_id": 97676444, "body": "Yeah, it doesn&#39;t sound like you need <code>Union</code> at all."}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1554239765, "post_id": 55482828, "comment_id": 97676996, "body": "I get an object required when I removed the union and code instead the following <code>For Each cell In Range(&quot;D1:AE40&quot;).CopyPicture</code>"}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1554393000, "post_id": 55482828, "comment_id": 97744813, "body": "I was able to fix the code myself based on your comments - I will upload the correction in the above code for future reference if anyone has the same question - thanks all for your help @BigBen ;-)"}], "owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1554393205, "creation_date": 1554235889, "last_edit_date": 1554393205, "question_id": 55482828, "link": "https://stackoverflow.com/questions/55482828/vba-to-copy-paste-excel-into-a-powerpoint", "title": "VBA to copy paste excel into a powerpoint", "body": "<p>Thanks to BigBen - the below code is an example corrected that show how to clear slides in an existing powerpoint, and then copy paste a range from excel to powerpoint as picture. The initial error was about the cells be not defined, then working around the line to define the shape in powerpoint. The code should be working.</p>\n\n<pre><code>Option Explicit\n    Sub ExportToPPT()\n\n    Dim ppApp As PowerPoint.Application\n    Set ppApp = New PowerPoint.Application\n\n    Dim ppFileName As String\n    ppFileName = \"C:\\Users\\Desktop\\Financial Summary.pptx\"\n\n    Dim ppPres As PowerPoint.Presentation\n    Set ppPres = ppApp.Presentations.Open(filename:=ppFileName)\n\n    Dim ppSlide As PowerPoint.Slide\n\n    Dim i As Integer\n    For i = 2 To 9\n        Set ppSlide = ppPres.Slides(i)\n\n        Dim j As Integer\n        For j = ppSlide.Shapes.Count To 1 Step -1\n            If ppSlide.Shapes(j).Type = msoPicture Then\n                ppSlide.Shapes(j).Delete\n            End If\n        Next j\n    Next i\n\n'preparation of the export\n\n    Dim lastrow As Long\n    Dim lRow As Long\n    Dim lCol As Long\n\n    Workbooks(\"A.xlsm\").Activate\n    Sheets(\"Graph Data\").Select\n    Range(\"E4\").Value = \"8\"\n    Application.Calculate\n\n   `Set Sel = Selection\nSet source = ActiveWorkbook.Sheets(\"waterfall\").Range(\"B1\")\nActiveWorkbook.Sheets(\"waterfall\").Range(\"D1:AE40\").Copy\n\nSet ppSlide = ppPres.Slides(9)\nppSlide.Shapes.PasteSpecial ppPasteBitmap\n\n   End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1554236590, "post_id": 55482669, "comment_id": 97675659, "body": "Does it work if you late-bind instead? i.e. remove the reference to MS Project object library, then change all MS Project object declarations to <code>As Object</code>, replace any/all Project constants inline with their underlying value (or re-declare them and leave usages alone). FWIW <code>Dim</code> statements aren&#39;t executable, the error would be at compile-time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1554236663, "post_id": 55482669, "comment_id": 97675688, "body": "Early-bound references have a tendency to be flaky when used across versions. You can try early-binding by referencing the earliest version you need to support (2010), and not using any features that exist in the later versions. Late-bound code that uses features that exist in 365 but not in 2010, will blow up at run-time either way."}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1554236707, "post_id": 55482669, "comment_id": 97675703, "body": "<code>t</code> should be declared as <code>MSProject.Task</code>. Additionally, are you able to set a reference to the MS Project Object model in your excel vba code? It should be listed as &quot;Microsoft Project 14.0 Object Library&quot; (or something very similar)."}, {"owner": {"reputation": 1, "user_id": 11301910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53ca0b66351e0f918c5fb590dd266f20?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/11301910/jim"}, "edited": false, "score": 0, "creation_date": 1554319133, "post_id": 55482669, "comment_id": 97711703, "body": "Thank you all, the late binding solved the issue."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 2030591, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218535301438779/picture?type=large", "display_name": "Brian Kennemer", "link": "https://stackoverflow.com/users/2030591/brian-kennemer"}, "is_accepted": false, "score": 0, "last_activity_date": 1555016045, "creation_date": 1555016045, "answer_id": 55641012, "question_id": 55482669, "link": "https://stackoverflow.com/questions/55482669/backward-compatibility-for-vba-between-2010-and-365/55641012#55641012", "title": "Backward Compatibility for VBA between 2010 and 365", "body": "<p>If you are just doing it in VBA then I would just do this:</p>\n\n<pre><code>Dim PrjApp      As Application\nDim aProg       As Project\nDim PrjFullName As String\nDim t           As Task\n</code></pre>\n\n<p>I have written a ton of VBA in Project across versions going back to almost the beginning and have never had this issue.</p>\n"}], "owner": {"reputation": 1, "user_id": 11301910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53ca0b66351e0f918c5fb590dd266f20?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/11301910/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555016045, "creation_date": 1554235232, "last_edit_date": 1554236408, "question_id": 55482669, "link": "https://stackoverflow.com/questions/55482669/backward-compatibility-for-vba-between-2010-and-365", "title": "Backward Compatibility for VBA between 2010 and 365", "body": "<p>I have an issue where I utilize the Microsoft Project object library in VBA on my machine that has Project 365 installed. When I try to run the macro on a machine that has project 2010 on it this library is not available. I have gone through the tools reference to find the appropriate library unsuccessfully. Does anyone have an idea?</p>\n\n<p>I have tried recoding some of the code (which is run in Excel) that attempts to open the Microsoft project item. However when I go to the other machine when I attempt to run the code it dies immediately when i try to <code>Dim t task</code></p>\n\n<pre><code>Dim PrjApp      As MSProject.Application\nDim aProg       As MSProject.Project\nDim PrjFullName As String\nDim t           As Task\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1554235853, "post_id": 55482667, "comment_id": 97675336, "body": "Try iterating this collection <code>ie.Document.getElementsByClassName(&quot;btn-group&quot;).getElementsB&zwnj;&#8203;yTagName(&quot;a&quot;)</code> and look for InnerText or InnerHTML being equal to <code>ScratchPad</code>"}, {"owner": {"reputation": 670, "user_id": 6117998, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5059c6edaf635d2e64006e9d49d2e6de?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro de S&#225;", "link": "https://stackoverflow.com/users/6117998/pedro-de-s%c3%a1"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1554238347, "post_id": 55482667, "comment_id": 97676427, "body": "@RyanWildry thanks for your repy! Tried to do so on the objCollection line but this error pops up: &quot;object does not accept this property or method&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1554242003, "creation_date": 1554242003, "answer_id": 55484088, "question_id": 55482667, "link": "https://stackoverflow.com/questions/55482667/vba-click-at-element-in-ie/55484088#55484088", "title": "VBA click at element in IE", "body": "<p>It's an Angular JS directive. Try either of the following 2</p>\n\n<pre><code>ie.document.querySelector(\"[ng-click*=toggleScratchPad]\").click\n\nie.document.parentWindow.execScript \"document.querySelector('[ng-click*=toggleScratchPad]').click();\"\n</code></pre>\n"}], "owner": {"reputation": 670, "user_id": 6117998, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5059c6edaf635d2e64006e9d49d2e6de?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro de S&#225;", "link": "https://stackoverflow.com/users/6117998/pedro-de-s%c3%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 55484088, "answer_count": 1, "score": 2, "last_activity_date": 1554274567, "creation_date": 1554235231, "last_edit_date": 1554274567, "question_id": 55482667, "link": "https://stackoverflow.com/questions/55482667/vba-click-at-element-in-ie", "title": "VBA click at element in IE", "body": "<p>I can't click on an element in the screen, it's not a button but works like one. I have successfully located it through the web inspector (I think) but I can't figure out the reason of why isn't working... Previously in my code I used the same code for clicking in a \"Log in\" button and it worked perfectly. Here it is the code:</p>\n\n<pre><code>    Set objCollection = IE.document.getelementsbytagname(\"div\")\n    For Each elem In objCollection\n        If IsObject(IE.document.getElementsByClassName(\"btn-group\")) Then 'Scratchpad button clicking\n            If IsObject(IE.document.getElementsByClassName(\"pull-left fang-button fang-button-subtle no-margin ng-binding\")) Then\n                Debug.Print \"found it\"\n                elem.Click\n                Exit For\n            End If\n        End If\n    Next elem\n</code></pre>\n\n<p>I'm trying to click in the element \"Scratchpad\" at the top of the page, <a href=\"https://i.stack.imgur.com/wUwSt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wUwSt.png\" alt=\"as the image shows.\"></a> Thanks in advance!</p>\n\n<p>HTML:</p>\n\n<pre><code>&lt;div class=\"btn-group\" role=\"group\" style=\"border:1px solid #ccc\"&gt; &lt;a ng-class=\"{'active': !CrossSegmentConfig.showScratchPad &amp;amp;&amp;amp; !CrossSegmentConfig.showGraph}\" class=\"pull-left fang-button fang-button-subtle no-margin ng-binding active\" ng-click=\"CrossSegmentConfig.showScratchPad=false; CrossSegmentConfig.showGraph=false;\" style=\"\"&gt; &lt;i class=\"fa fa-align-left\"&gt;&lt;/i&gt; Parameters &lt;/a&gt; &lt;a ng-class=\"{'active': CrossSegmentConfig.showScratchPad}\" class=\"pull-left fang-button fang-button-subtle no-margin ng-binding\" ng-click=\"CrossSegmentConfig.toggleScratchPad()\" style=\"\"&gt; &lt;i class=\"fa fa fa-columns\"&gt;&lt;/i&gt; Scratchpad &lt;/a&gt; &lt;a ng-class=\"{'active': CrossSegmentConfig.showGraph}\" class=\"pull-left fang-button fang-button-subtle no-margin ng-binding\" ng-click=\"CrossSegmentConfig.toggleGraph()\"&gt; &lt;i class=\"fa fa-line-chart\"&gt;&lt;/i&gt; Plot &lt;/a&gt; &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1, "user_id": 11301836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929985ed264d757d6bb2b2058f2987f3?s=128&d=identicon&r=PG&f=1", "display_name": "Macroless in Montana", "link": "https://stackoverflow.com/users/11301836/macroless-in-montana"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1554306249, "post_id": 55482484, "comment_id": 97705234, "body": "@0m3r Thank you for the suggested edits to the question. Hopefully that will make it easier for someone to assist with a solution."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11301836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929985ed264d757d6bb2b2058f2987f3?s=128&d=identicon&r=PG&f=1", "display_name": "Macroless in Montana", "link": "https://stackoverflow.com/users/11301836/macroless-in-montana"}, "edited": false, "score": 0, "creation_date": 1554404480, "post_id": 55522223, "comment_id": 97750611, "body": "Hi Tony, Thank you for your detailed response. I was able to find a code that is working after our IT dept updated the server prepend to remove iterations of [EXTERNAL].<a href=\"https://techniclee.wordpress.com/2013/01/04/stripping-re-fw-and-fwd-from-the-subject-line/\" rel=\"nofollow noreferrer\">techniclee.wordpress.com/2013/01/04/&hellip;</a>      - I was able to find and replace FW: with [EXTERNAL] Thank you again for your help!"}, {"owner": {"reputation": 1, "user_id": 11301836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929985ed264d757d6bb2b2058f2987f3?s=128&d=identicon&r=PG&f=1", "display_name": "Macroless in Montana", "link": "https://stackoverflow.com/users/11301836/macroless-in-montana"}, "edited": false, "score": 0, "creation_date": 1554404692, "post_id": 55522223, "comment_id": 97750705, "body": "Thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score. - I hope you get the credit you earned with your thoughtful response! Cheers!"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 11301836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929985ed264d757d6bb2b2058f2987f3?s=128&d=identicon&r=PG&f=1", "display_name": "Macroless in Montana", "link": "https://stackoverflow.com/users/11301836/macroless-in-montana"}, "edited": false, "score": 0, "creation_date": 1554409143, "post_id": 55522223, "comment_id": 97752807, "body": "@MacrolessinMontana  I am pleased you found what you needed.  I said I would explain the code I posted.  Would it be helpful if I added that explanation?"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1554400394, "creation_date": 1554400394, "answer_id": 55522223, "question_id": 55482484, "link": "https://stackoverflow.com/questions/55482484/remove-external-from-subject-line-and-caution-box-from-e-mail-body-when-e-mail/55522223#55522223", "title": "Remove [EXTERNAL] from subject line and caution box from e-mail body when e-mail arrives", "body": "<p>This is not a complete answer.  I need you to discover some information and this answer gets you to do the discover while I code the next bit of the answer.</p>\n\n<p><strong>Some comments on your existing code</strong></p>\n\n<p><em>Issue 1</em></p>\n\n<p>You say you do not know how to remove the prompts.  The relevant code is;</p>\n\n<pre><code>'If you don't want the prompt,\n'You can remove the MsgBox line and its correspoding \"Else \u2026 End If\" lines.\nIf MsgBox(\"Do you want to remove the prefix '[EXTERNAL]'?\", vbYesNo) = vbYes Then\n  strSubject = Replace(Item.Subject, \"[EXTERNAL]\", \"\", vbTextCompare)\nElse\n  strSubject = Item.Subject\nEnd If\n</code></pre>\n\n<p>The comment is not very helpful.  If you have a moderate understanding of VBA (or of any language with an If...Then\u2026Else\u2026End If construct), you would know how to remove the prompt.  If you do not have a moderate understanding, the comment is unclear.  The author means, do this:</p>\n\n<pre><code>Remove If MsgBox(\"Do you want to remove the prefix '[EXTERNAL]'?\", vbYesNo) = vbYes Then\nKeep     strSubject = Replace(Item.Subject, \"[EXTERNAL]\", \"\", vbTextCompare)\nRemove Else\nRemove   strSubject = Item.Subject\nRemove End If\n</code></pre>\n\n<p>That is, remove the <code>MsgBox</code> line, remove the <code>Else\u2026End If</code> lines and keep all lines between <code>Then</code> and <code>Else</code>.</p>\n\n<p><em>Issue 2</em></p>\n\n<p>You have a second block that removes \u201c[EXTERNAL]Re:\u201d.  This will not work properly.</p>\n\n<p>The first block has placed the edited or non-edited subject in variable <code>strSubject</code>.  The second block checks <code>Item.Subject</code> so anything the first block did will be lost.</p>\n\n<p>If you amended the second block to check variable <code>strSubject</code>, it still would not work because you have removed all the \u201c[EXTERNAL]\u201ds so there will be no \u201c[EXTERNAL]Re:\u201ds to find.   If you want to remove all \u201cXxxx\u201ds and all \u201cXxxxYyyy\u201ds from a string, you must remove the longer substring first.</p>\n\n<p><em>Issue 3</em></p>\n\n<p>I do not think the second block could have the effect you seek.  Most (All?) email packages add \u201cRe: \u201d or \u201cRE: \u201d something similar to the subject for a reply.  Why only remove \u201cRe:\u201d from external emails.  I would remove all or none.  I suspect you are trying to handle this situation:</p>\n\n<ul>\n<li>Outsider John sends you an email with subject \u201cxxxxxxx\u201d</li>\n<li>This subject is changed by your system to \u201c[EXTERNAL]xxxxxxx\u201d.</li>\n<li>You reply and Outlook adds \u201cRE: \u201d to give \u201cRE: [EXTERNAL]xxxxxxx\u201d</li>\n<li>John replies and your system changes the subject to \u201c[EXTERNAL]RE: [EXTERNAL]xxxxxxx\u201d.</li>\n<li>You reply and Outlook adds \u201cRE: \u201d to give \u201cRE: [EXTERNAL]RE: [EXTERNAL]xxxxxxx\u201d.</li>\n</ul>\n\n<p>If you add code to remove \u201c[EXTERNAL]\u201d, you will have subjects such as \u201cRe: Re: xxxxxxx\u201d and \u201cRe: Re: Re: xxxxxxx\u201d and \u201cRe: Re: Re: Re: xxxxxxx\u201d depending on how long the email rally has lasted before the \u201c[EXTERNAL]\u201ds were removed.  Perhaps removing all the \u201c[EXTERNAL]Re: \u201ds before removing the \u201c[EXTERNAL]\u201ds would help.  </p>\n\n<p><em>Issue 4</em></p>\n\n<p>Do not save an email unless you have changed it.  Your code saves the email even if it is unchanged.  I do not know everything that happens when you save an email but I do know Outlook saves the time the email was amended and clearly has to find space for the amended email and to discard the original version.</p>\n\n<p>You need something like:</p>\n\n<pre><code>strSubject = Item.Subject\n\nCode to perform Edit 1 if appropriate.\nCode to perform Edit 2 if appropriate.\nCode to perform Edit 3 if appropriate.\n    :    :    :    :    :    :    :\n\nIf strSubject &lt;&gt; Item.Subject Then\n  Item.Subject = strSubject\n  Item.Save\nEnd If\n</code></pre>\n\n<p><strong>Designing your new code</strong></p>\n\n<p>To my mind you have three requirements:</p>\n\n<ol>\n<li>Remove \u201c[EXTERNAL]\u201d from the subject and \u201cCaution ...\u201d from the body of new emails.</li>\n<li>Tidy any existing emails in your Inbox, Sent Items or other folders.</li>\n<li>Tidy any new replies from Outsiders to your replies.</li>\n</ol>\n\n<p>I am hopeful that code for requirement 2 will also handles requirement 3 but this is not certain.  Requirement 1 is the urgent requirement since, once this requirement is met, the situation is not going to get worse.  Tidying emails to which you wish to reply will come next.  Tidying old conversations can be handled when you have a spare moment. </p>\n\n<p>To be able to test the code I think will help, I needed some test emails.</p>\n\n<p>Within a secondary account I created a simple email.  I then added \u201c[EXTERNAL]\u201d to the subject and \u201cCaution email from external source\u201d to the body in an attempt to match what your system does.  I sent that email to my main account where I replied to it.  Back at my secondary account I created a reply and again added \u201c[EXTERNAL]\u201d and \u201cCaution email from external source\u201d.  After a couple or repeats, I had this email:</p>\n\n<pre><code>Subject: [EXTERNAL]RE: [EXTERNAL]RE: [EXTERNAL]Test\n\nCaution email from external source\n\nReply 4\n\nFrom: Tony@AcmeProducts.com\nSent: 04 April 2019 13:33\nTo: John@SomeOtherCompany.com\nSubject: RE: [EXTERNAL]RE: [EXTERNAL]Test\n\nReply 3\n\nFrom: John@SomeOtherCompany.com\nSent: 04 April 2019 13:30\nTo: Tony@AcmeProducts.com\nSubject: [EXTERNAL]RE: [EXTERNAL]Test\n\nCaution email from external source\n\nReply 2\n\nFrom: Tony@AcmeProducts.com\nSent: 04 April 2019 13:20\nTo: John@SomeOtherCompany.com\nSubject: RE: [EXTERNAL]Test\n\nReply 1\n\nFrom: John@SomeOtherCompany.com\nSent: 04 April 2019 12:04\nTo: Tony@AcmeProducts.com\nSubject: [EXTERNAL]Test\n\nCaution email from external source\n\nTest text. Test text. Test text. Test text. Test text.\n</code></pre>\n\n<p>The above is what I see when I open the email except that I have amended the \u201cTo\u201d and \u201cFrom\u201d values to conceal my email addresses.</p>\n\n<p>Your caution text will be different from mine.  You can probably just delete the string you see but it is possible you cannot so you must identify what exactly is within the Html body.</p>\n\n<p>Copy the following to an Outlook module:</p>\n\n<pre><code>Public Sub CallSubForSelectedEmails()\n\n  Dim Exp As Explorer\n  Dim InxA As Long\n  Dim ItemCrnt As MailItem\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  If Exp.Selection.Count = 0 Then\n    Call MsgBox(\"Please select one or more emails then try again\", vbOKOnly)\n    Exit Sub\n  Else\n    For Each ItemCrnt In Exp.Selection\n      If ItemCrnt.Class = olMail Then\n        Call DsplCautionText(ItemCrnt)\n      End If\n    Next\n  End If\n\nEnd Sub\nSub DsplCautionText(ItemCrnt As Outlook.MailItem)\n\n  Dim LcHtmlBody\n  Dim PosCaution As Long\n  Dim PosDsplStart As Long\n\n  With ItemCrnt\n\n    LcHtmlBody = LCase(.HtmlBody)\n    PosCaution = 1\n\n    Debug.Print \"-----\" &amp; .ReceivedTime &amp; \" \" &amp; .Subject\n\n    Do While True\n      PosCaution = InStr(PosCaution, LcHtmlBody, \"caution\")\n      If PosCaution = 0 Then\n        ' No [more] cautions\n        Exit Do\n      End If\n      If PosCaution &lt;= 20 Then\n        PosDsplStart = 1\n      Else\n        PosDsplStart = PosCaution - 20\n      End If\n      Debug.Print PadL(PosDsplStart, 5) &amp; \" \" &amp; TidyTextForDspl(Mid$(.HtmlBody, PosDsplStart, 200))\n      PosCaution = PosCaution + 1\n    Loop\n\n  End With\n\nEnd Sub\nPublic Function TidyTextForDspl(ByVal Text As String) As String\n\n  ' Tidy Text for dsplay by replacing white space with visible strings:\n  '   Leave single space unchanged\n  '   Replace single LF by                  \u2039lf\u203a\n  '   Replace single CR by                  \u2039cr\u203a\n  '   Replace single TB by                  \u2039tb\u203a\n  '   Replace single non-break space by     \u2039nbs\u203a\n  '   Replace single CRLF by                \u2039crlf\u203a\n  '   Replace multiple spaces by            \u2039# s\u203a       where # is number of repeats\n  '   Replace multiple LFs by               \u2039# lf\u203a      of white space character\n  '   Replace multiple CRs by               \u2039# cr\u203a\n  '   Replace multiple TBs by               \u2039# tb\u203a\n  '   Replace multiple non-break spaces by  \u2039# nbs\u203a\n  '   Replace multiple CRLFs by             \u2039# crlf\u203a\n\n  ' 15Mar16  Coded\n  '  3Feb19  Replaced \"{\" (\\x7B) and \"}\" (\\x7D) by \"\u2039\" (\\u2039) and \"\u203a\" (\\u203A)\n  '          on the grounds that the angle quotation marks were not likely to\n  '          appear in text to be displayed.\n  '  5Feb19  Add code to treat CRLF as unit\n  ' 28Mar19  Code to calculate PosWsChar after \"&lt;x&gt;...&lt;x&gt;\" converted to \"&lt;# x&gt;\"\n  '          incorrect if \"&lt;x&gt;...&lt;x&gt;\" at the start of the string.  Unlikely it\n  '          was correct in other situations but this did not matter since the\n  '          calculated value would be before the next occurrence of \"&lt;x&gt;...&lt;x&gt;\".\n  '          But, if the string was near the beginning of the string, the\n  '          calculated value was negative and the code crashed.\n\n  Dim InsStr As String\n  Dim InxWsChar As Long\n  Dim NumWsChar As Long\n  Dim PosWsChar As Long\n  Dim RetnVal As String\n  Dim WsCharCrnt As Variant\n  Dim WsCharValue As Variant\n  Dim WsCharDspl As Variant\n\n  WsCharValue = VBA.Array(\" \", vbCr &amp; vbLf, vbLf, vbCr, vbTab, Chr(160))\n  WsCharDspl = VBA.Array(\"s\", \"crlf\", \"lf\", \"cr\", \"tb\", \"nbs\")\n\n  RetnVal = Text\n\n  ' Replace each whitespace individually\n  For InxWsChar = 0 To UBound(WsCharValue)\n    RetnVal = Replace(RetnVal, WsCharValue(InxWsChar), \"\u2039\" &amp; WsCharDspl(InxWsChar) &amp; \"\u203a\")\n  Next\n\n  ' Look for repeats. If found replace &lt;x&gt;&lt;x&gt;&lt;x&gt;&lt;x&gt;... by &lt;# x&gt;\n  For InxWsChar = 0 To UBound(WsCharValue)\n    'Debug.Assert InxWsChar &lt;&gt; 1\n    PosWsChar = 1\n    Do While True\n      InsStr = \"\u2039\" &amp; WsCharDspl(InxWsChar) &amp; \"\u203a\"\n      PosWsChar = InStr(PosWsChar, RetnVal, InsStr &amp; InsStr)\n      If PosWsChar = 0 Then\n        ' No [more] repeats of this &lt;x&gt;\n        Exit Do\n      End If\n      ' Have &lt;x&gt;&lt;x&gt;.  Count number of extra &lt;x&gt;s\n      NumWsChar = 2\n      Do While Mid(RetnVal, PosWsChar + NumWsChar * Len(InsStr), Len(InsStr)) = InsStr\n        NumWsChar = NumWsChar + 1\n      Loop\n      RetnVal = Mid(RetnVal, 1, PosWsChar - 1) &amp; _\n                \"\u2039\" &amp; NumWsChar &amp; \" \" &amp; WsCharDspl(InxWsChar) &amp; \"\u203a\" &amp; _\n                Mid(RetnVal, PosWsChar + NumWsChar * Len(InsStr))\n      PosWsChar = PosWsChar + Len(InsStr) + Len(NumWsChar)\n\n    Loop\n  Next\n\n  ' Restore any single spaces\n  RetnVal = Replace(RetnVal, \"\u2039\" &amp; WsCharDspl(0) &amp; \"\u203a\", \" \")\n\n  TidyTextForDspl = RetnVal\n\nEnd Function\n</code></pre>\n\n<p>I will explain the above code later.  For the moment, I just want you to select a number of these external emails and run macro <code>CallSubForSelectedEmails()</code>.  With my emails, I get Immediate Window output of:</p>\n\n<pre><code>-----04/04/2019 13:34:24 [EXTERNAL]RE: [EXTERNAL]RE: [EXTERNAL]Test\n 2161 &gt;&lt;p class=MsoNormal&gt;Caution email from external source&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp; \u2026 \n 3551 &gt;&lt;p class=MsoNormal&gt;Caution email from external source&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp; \u2026\n 4986 &gt;&lt;p class=MsoNormal&gt;Caution email from external source&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp; \u2026\n-----04/04/2019 13:30:10 [EXTERNAL]RE: [EXTERNAL]Test\n 1953 &gt;&lt;p class=MsoNormal&gt;Caution email from external source&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp; \u2026\n 3290 &gt;&lt;p class=MsoNormal&gt;Caution email from external source&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp; \u2026\n-----04/04/2019 12:04:09 [EXTERNAL]Test\n 1563 &gt;&lt;p class=MsoNormal&gt;Caution email from external source&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp; \u2026\n</code></pre>\n\n<p>Note 1: the ... indicates I have truncated the lines.  Note 2: the first caution text is at character position 1953 within the Html body since there are a lot of characters in the header.  Note3: for each line I have searched for \u201cCaution\u201d and then displayed 200 characters starting 20 characters back.  I have truncated the lines because, in this case, I did not need all this information.  I am hoping you do not either.</p>\n\n<p>Anything in angle brackets is an Html tag.  \u201c&lt;p class=MsoNormal&gt;\u201d is a start tag.  \u201c&lt;/p&gt;\u201d is an end tag.  For my emails, the caution text does not contain any tags.  This means I can replace \u201cCaution email from external source\u201d by \u201c\u201d without interfering with the Html.  I expect your caution text is similar but it might not be. </p>\n\n<p>Please run macro <code>CallSubForSelectedEmails()</code> as I asked.  Is your caution text simple?  Is every example the same? </p>\n"}], "owner": {"reputation": 1, "user_id": 11301836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929985ed264d757d6bb2b2058f2987f3?s=128&d=identicon&r=PG&f=1", "display_name": "Macroless in Montana", "link": "https://stackoverflow.com/users/11301836/macroless-in-montana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3208, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592683521, "creation_date": 1554234459, "last_edit_date": 1592683521, "question_id": 55482484, "link": "https://stackoverflow.com/questions/55482484/remove-external-from-subject-line-and-caution-box-from-e-mail-body-when-e-mail", "title": "Remove [EXTERNAL] from subject line and caution box from e-mail body when e-mail arrives", "body": "<p>Our organization added <code>[EXTERNAL]</code> to the subject line of external e-mails, and also added a \"Caution:\" verbiage in the body of the e-mail. They also did not fix iterations, so every time it is replied to it adds another <code>[EXTERNAL]</code> and \"Caution:\" verbiage. </p>\n\n<p>I have cobbled together two different scripts from the internet to remove this verbiage when I send an e-mail, but would like it to run when an e-mail arrives. The current script prompts for <code>MsgBox</code>, basically because I don't know how to remove them.</p>\n\n<pre><code>Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n    Item.HTMLBody = Replace(Item.HTMLBody, \"CAUTION: This email originated from outside of the organization. Do not reply, click links, or open attachments unless you recognize the sender and know the content is safe.\", \"\")\n    Dim strSubject As String\n\n    If InStr(Item.Subject, \"[EXTERNAL]\") &gt; 0 Then\n       'If you don't want the prompt,\n       'You can remove the MsgBox line and its correspoding \"Else \u2026 End If\" lines.\n       If MsgBox(\"Do you want to remove the prefix '[EXTERNAL]'?\", vbYesNo) = vbYes Then\n          strSubject = Replace(Item.Subject, \"[EXTERNAL]\", \"\", vbTextCompare)\n       Else\n          strSubject = Item.Subject\n       End If\n    End If\n\n    If InStr(Item.Subject, \"[EXTERNAL]RE:\") &gt; 0 Then\n       If MsgBox(\"Do you want to remove the prefix '[EXTERNAL]RE:'?\", vbYesNo) = vbYes Then\n          strSubject = Replace(Item.Subject, \"[EXTERNAL]RE:\", \"\", vbTextCompare)\n       Else\n          strSubject = Item.Subject\n       End If\n    End If\n\n    Item.Subject = Trim(strSubject)\n    Item.Save\nEnd Sub\n</code></pre>\n\n<p>When a message arrives, the script will run removing all iterations of <code>[EXTERNAL]</code>, leave the remaining words in the subject line, and remove the caution verbiage</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1554234277, "post_id": 55482345, "comment_id": 97674653, "body": "Thanks but I am not a real programmer and I don&#39;t know how to incorporate, can you help?"}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1554238078, "post_id": 55482345, "comment_id": 97676301, "body": "I am getting runtime error 438 object does not support this property or method. The debugger stops at  &quot;If oRem.Subject = reminderText Then&quot;"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1554297727, "post_id": 55482345, "comment_id": 97699583, "body": "@MEC Sorry. I wrote the code without actually testing. I assumed you were working with outlook reminders (which don&#39;t have subjects), but you are actually working with appointment objects. I will amend the code"}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1554425118, "post_id": 55482345, "comment_id": 97757630, "body": "do you think you can help me with that code please?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1554431347, "post_id": 55482345, "comment_id": 97758693, "body": "@MEC I updated my post yesterday. I added Edit 2 at the top of my post with the latest revision. Does that work for you?"}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1554581401, "post_id": 55482345, "comment_id": 97807274, "body": "thank you that worked perfectly, I appreciate your help :-)"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1554298829, "last_edit_date": 1554298829, "creation_date": 1554233891, "answer_id": 55482345, "question_id": 55482100, "link": "https://stackoverflow.com/questions/55482100/check-for-duplicate-reminder-from-excel/55482345#55482345", "title": "Check for duplicate reminder from excel", "body": "<p>EDIT (2):\nHopefully this resolves the issue. Instead of checking for reminder text, we will be checking the Subject of Calendar items to see if the subject exists. If not, we add it.</p>\n\n<pre><code>Function AppointmentTextExists(ByRef oOtlk As Object, appointmentSubjectText As String) As Boolean\n    Dim oAppt As Object\n    Dim oAppts As Object\n    Dim output As Boolean\n\n    output = False\n\n    'Get all items from the calendar\n    Set oAppts = oOtlk.Session.GetDefaultFolder(9).Items\n\n    For Each oAppt In oAppts\n        If oAppt.Subject = appointmentSubjectText Then\n            output = True\n            Exit For\n        End If\n    Next oAppt\n\n    AppointmentTextExists = output\nEnd Function\n\nSub D_Reminders()\n    Dim appOL As Object\n    Dim objReminder As Object\n    Dim reminderText As String\n\n    Set appOL = GetObject(, \"Outlook.application\")\n\n    'The subject text for the reminder\n    reminderText = \"Rate Expires for \" &amp; ActiveSheet.Range(\"A\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"B\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"AC\" &amp; ActiveCell.Row).Value\n\n    'Test if this reminder text is already in a subject line\n    If AppointmentTextExists(appOL, reminderText) Then\n        'Do whatever you want if the subject already exists\n        'You can leave this blank if you don't want to do anything\n    Else 'Subject does not exist\n        Set objReminder = appOL.CreateItem(1)\n        objReminder.Start = ActiveSheet.Range(\"AC\" &amp; ActiveCell.Row).Value\n        objReminder.Duration = 1\n        objReminder.Subject = \"Rate Expires for \" &amp; ActiveSheet.Range(\"A\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"B\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"AC\" &amp; ActiveCell.Row).Value\n        objReminder.ReminderSet = True\n        objReminder.Location = \"N/A\"\n        objReminder.BusyStatus = olFree\n        objReminder.Body = \"Loan Type = \" &amp; ActiveSheet.Range(\"I\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" Status = \" &amp; ActiveSheet.Range(\"BK\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" UW = \" &amp; ActiveSheet.Range(\"D\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" Proc = \" &amp; ActiveSheet.Range(\"C\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" MLO = \" &amp; ActiveSheet.Range(\"E\" &amp; ActiveCell.Row).Value\n        objReminder.Display\n    End If\nEnd Sub\n</code></pre>\n\n<p>EDIT:\nI've made some changes to incorporate the solution into your code. I created a separate function to contain the logic for testing whether or not a subject line already exists. See if you can piece it together from this code, or write back with more specific questions.</p>\n\n<pre><code>'Function that checks to see if a reminder text already exists in Outlook\n'Parameters: objOutlook     - A reference to an Outlook Objet\n'            reminderText   - The lookup text\n'Returns:    True/False if text exists\nFunction DoesReminderExist(ByRef objOutlook As Object, reminderText As String) As Boolean\n    Dim oRem As Object\n    Dim output As Boolean\n\n    'Initially set output to false (in case reminder text isn't found)\n    output = False\n\n    'Loop through all reminders in Outlook, and test for equality\n    For Each oRem In objOutlook.Reminders\n        'Reminder text matches in outlook\n        If oRem.Subject = reminderText Then\n            output = True\n            Exit For\n        End If\n    Next oRem\n\n    'Return T/F output\n    DoesReminderExist = output\nEnd Function\n\nSub D_Reminders()\n    Dim appOL As Object\n    Dim objReminder As Object\n    Dim reminderText As String\n\n    Set appOL = GetObject(, \"Outlook.application\")\n\n    'The subject text for the reminder\n    reminderText = \"Rate Expires for \" &amp; ActiveSheet.Range(\"A\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"B\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"AC\" &amp; ActiveCell.Row).Value\n\n    'Test if this reminder text is already in a subject line\n    If DoesReminderExist(appOL, reminderText) Then\n        'Do whatever you want if the subject already exists\n        'You can leave this blank if you don't want to do anything\n    Else 'Subject does not exist\n        Set objReminder = appOL.CreateItem(1)\n        objReminder.Start = ActiveSheet.Range(\"AC\" &amp; ActiveCell.Row).Value\n        objReminder.Duration = 1\n        objReminder.Subject = \"Rate Expires for \" &amp; ActiveSheet.Range(\"A\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"B\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"AC\" &amp; ActiveCell.Row).Value\n        objReminder.ReminderSet = True\n        objReminder.Location = \"N/A\"\n        objReminder.BusyStatus = olFree\n        objReminder.Body = \"Loan Type = \" &amp; ActiveSheet.Range(\"I\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" Status = \" &amp; ActiveSheet.Range(\"BK\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" UW = \" &amp; ActiveSheet.Range(\"D\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" Proc = \" &amp; ActiveSheet.Range(\"C\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" MLO = \" &amp; ActiveSheet.Range(\"E\" &amp; ActiveCell.Row).Value\n        objReminder.Display\n    End If\nEnd Sub\n</code></pre>\n\n<p>The code below will get the list of reminders and their corresponding texts. You can compare work it into your code to test for equality, and then ignore/update as necessary.</p>\n\n<pre><code>Sub GetReminders()\n    Dim appOl As Object\n    Dim oRem As Object\n\n    Set appOl = GetObject(, \"Outlook.Application\")\n\n    For Each oRem In appOl.Reminders\n        Debug.Print \"Caption: \" &amp; oRem.Caption\n    Next oRem\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 55482345, "answer_count": 1, "score": 0, "last_activity_date": 1592683538, "creation_date": 1554232848, "last_edit_date": 1592683538, "question_id": 55482100, "link": "https://stackoverflow.com/questions/55482100/check-for-duplicate-reminder-from-excel", "title": "Check for duplicate reminder from excel", "body": "<p>I have some vba code that creates a reminder in my outlook calendar from data in excel. But I don't have a way of knowing if i already have the reminder in excel. I want to know if someone can help me tweak my code to show me if I already have this reminder set in outlook. The reminder will have the same exact text in the subject line.</p>\n\n<pre><code>Sub D_Reminders()\n\n    Dim appOL As Object\n    Dim objReminder As Object\n\n    Set appOL = GetObject(, \"Outlook.application\")\n    Set objReminder = appOL.CreateItem(1)\n    objReminder.Start = ActiveSheet.Range(\"AC\" &amp; ActiveCell.Row).Value\n    objReminder.Duration = 1\n    objReminder.Subject = \"Rate Expires for \" &amp; ActiveSheet.Range(\"A\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"B\" &amp; ActiveCell.Row).Value &amp; \" \" &amp; ActiveSheet.Range(\"AC\" &amp; ActiveCell.Row).Value\n    objReminder.ReminderSet = True\n    objReminder.Location = \"N/A\"\n    objReminder.busystatus = olfree\n    objReminder.body = \"Loan Type = \" &amp; ActiveSheet.Range(\"I\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" Status = \" &amp; ActiveSheet.Range(\"BK\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" UW = \" &amp; ActiveSheet.Range(\"D\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" Proc = \" &amp; ActiveSheet.Range(\"C\" &amp; ActiveCell.Row).Value &amp; \",\" &amp; \" MLO = \" &amp; ActiveSheet.Range(\"E\" &amp; ActiveCell.Row).Value\n    objReminder.display\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1554233338, "post_id": 55481936, "comment_id": 97674248, "body": "I agree with Freeflow, except I&#39;ll add that <code>Dim</code> inside a procedure declares a variable that is <i>local</i> to that procedure (can&#39;t be used elsewhere). If you need another procedure to use these variables, either pass them as parameters to that procedure, or declare the variables at module-level, using the <code>Private</code> keyword (<code>Public</code> makes them globally-scoped). A <i>lot</i> of the issues in this code can be fixed by simply reviewing the code inspection results with <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> (free &amp; open-source, I contribute to that project)."}], "answers": [{"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1554232674, "creation_date": 1554232674, "answer_id": 55482052, "question_id": 55481936, "link": "https://stackoverflow.com/questions/55481936/create-an-array-then-fill-it-up-one-place-at-the-time-with-a-key-command/55482052#55482052", "title": "Create an array then fill it up one place at the time with a key command?", "body": "<p>There are many, many errors in your code. Too many to address here.The extent of errors suggests you should work your way through a tutorial on VBA. In the meantime, put 'Option explicit' at the start of your code to more clearly show up errors. Use MS help for VBA/excel by placing the cursor on a keyword and pressing 'F1' to bring up help pages.</p>\n"}], "owner": {"reputation": 123, "user_id": 11301508, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157606605643465/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/11301508/jens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554233088, "creation_date": 1554232116, "last_edit_date": 1554233088, "question_id": 55481936, "link": "https://stackoverflow.com/questions/55481936/create-an-array-then-fill-it-up-one-place-at-the-time-with-a-key-command", "title": "Create an array then fill it up one place at the time with a key command?", "body": "<p>Beginner here! :)</p>\n\n<p>I want to take the value from a cell and put in an array using a key command.</p>\n\n<p>I work in a warehouse and there a big screen on the wall that shows the number of orders left to deliver. It's an excel file I made. I want to take that number and put it in an array every minute. Then, once it reach 60 minutes I want to compare the value now with the value an hour ago and display it in a cell. Effectively showing how many orders that were delivered during the last 60 minutes.</p>\n\n<p>I'm trying to create one sub routine that creates the array then another sub routine that fills the array up. Start the first subroutine manually, then start the second sub routine with a key command, pressed by a AutoHotKey script every 60 second. I'm a bit of a beginner at VBA, I'm not sure if I'm doing it right.</p>\n\n<p>First sub:    </p>\n\n<pre><code>sub createarray() 'this sub is started once to create the array and variables\n\ndim CellStatus(1 to 121)\ndim c as long = 1\ndim WorkSpeed as long\nend sub\n</code></pre>\n\n<p>The second sub:</p>\n\n<pre><code>sub AddToArray()      'this sub is started once every 60 seconds via a key command\nCellStatus(c)=ThisWorkbook.Sheets(\"searchresult\").cells(a1).Value 'puts the cellvalue in the array\n\nif c&gt;60\nWorkSpeed = Cellstatus(c-60)-Cellstatus(c)  'compare the value 60 minutes ago\n\nelse if c&lt;61\nWorkspeed = Cellstatus(c+60)-Cellstatus(c)  'compare the value 60 minutes ago\nend if\n\nThisWorkbook.Sheets(\"showresult\").cells(d6).value=Workspeed 'puts whats inside the variable WorkSpeed in cell d6 in the sheet \"showresults\"\nc = c + 1\n\nif c=121\nCellStatus(1)=ThisWorkbook.Sheets(\"searchresult\").cells(a1).Value 'copies the value of Cell A1 in both place 121 and 1 in the array.\nc=2\nelse\nc=c+1\nend if\n\n\n\nend sub\n\n</code></pre>\n\n<p>Am I doing it right? See any errors in the code?\n/Jens</p>\n"}, {"tags": ["excel", "vba", "code-signing", "code-signing-certificate"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6137256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac2bbd1a8d076e1d5e725f56c5a697c?s=128&d=identicon&r=PG&f=1", "display_name": "dlptoo", "link": "https://stackoverflow.com/users/6137256/dlptoo"}, "edited": false, "score": 0, "creation_date": 1554514730, "post_id": 55483444, "comment_id": 97793061, "body": "Nzall, thanks for your quick and thorough answer! I suspected I&#39;d need to resign the files. We didn&#39;t timestamp them last time around (didn&#39;t know about doing that), but will do so this time. Thanks, again!"}], "tags": [], "owner": {"reputation": 3169, "user_id": 1770430, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/n7Ycz.jpg?s=128&g=1", "display_name": "Nzall", "link": "https://stackoverflow.com/users/1770430/nzall"}, "is_accepted": true, "score": 4, "last_activity_date": 1554238589, "creation_date": 1554238589, "answer_id": 55483444, "question_id": 55481835, "link": "https://stackoverflow.com/questions/55481835/do-i-need-to-re-code-sign-excel-macros-after-renewing-the-certificate/55483444#55483444", "title": "Do I need to re-code sign Excel macros after renewing the certificate", "body": "<p>You will most likely have to resign all files, since signing is essentially saying \"This code is approved by the creator tied to the accompanying certificate, as attested by this trustworthy company\". And since certificates expire, you can't keep using the same one. This is to prevent someone from finding an old certificate somewhere on a discarded hard drive or whatever and signing code under a false name.</p>\n\n<p>However, what you should be doing is \"Timestamping\" your code signing request. Timestamping your code effectively says \"This code is approved by the creator at this moment in time and hasn't changed since\". However, in order to timestamp a VBA project, you need to manually enable the use of the relevant external service, so you will need internet.</p>\n\n<p>The process is explained in this article from Godaddy:</p>\n\n<p><a href=\"https://www.godaddy.com/help/code-signing-microsoft-office-macros-and-visual-basic-for-applications-4779\" rel=\"nofollow noreferrer\">https://www.godaddy.com/help/code-signing-microsoft-office-macros-and-visual-basic-for-applications-4779</a></p>\n\n<blockquote>\n  <p>If you would like to allow people to continue using your signed Visual Basic\u00ae for Applicaions (VBA) code after the certificate expires, modify the registry on your code-signing computer to add a time stamp at the time of signing using the following keys:</p>\n  \n  <ul>\n  <li>Create Key: HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Security</li>\n  <li>Create String: HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Security\\TimeStampURL</li>\n  <li>Create DWORD: HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Security\\TimeStampRetryCount</li>\n  <li>Create DWORD: HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Security\\TimeStampRetryDelay</li>\n  </ul>\n  \n  <p>Set the new fields to these values:</p>\n  \n  <ul>\n  <li>TimeStampURL = <a href=\"http://tsa.starfieldtech.com\" rel=\"nofollow noreferrer\">http://tsa.starfieldtech.com</a></li>\n  <li>TimeStampRetryCount = 3</li>\n  <li>TimeStampRetryDelay = 2</li>\n  </ul>\n</blockquote>\n\n<p>After that:</p>\n\n<blockquote>\n  <p>To Code Sign Documents  </p>\n  \n  <ol>\n  <li>Open the file you want to sign.</li>\n  <li>Click the Tools menu, highlight Macro and click Visual Basic Editor.</li>\n  <li>In the Project Explorer window, select the VBA macro project that you want to sign.</li>\n  <li>From the Tools menu, select Digital Signature.</li>\n  <li>Click Choose and select your Code Signing Certificate.0</li>\n  <li>Click OK to close.</li>\n  </ol>\n</blockquote>\n\n<p>This procedure should allow you to to keep using the VBA macros after the certificate expired.</p>\n"}], "owner": {"reputation": 53, "user_id": 6137256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac2bbd1a8d076e1d5e725f56c5a697c?s=128&d=identicon&r=PG&f=1", "display_name": "dlptoo", "link": "https://stackoverflow.com/users/6137256/dlptoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 55483444, "answer_count": 1, "score": 3, "last_activity_date": 1554274511, "creation_date": 1554231678, "last_edit_date": 1554274511, "question_id": 55481835, "link": "https://stackoverflow.com/questions/55481835/do-i-need-to-re-code-sign-excel-macros-after-renewing-the-certificate", "title": "Do I need to re-code sign Excel macros after renewing the certificate", "body": "<p>I created 20 to 30 forms in Excel plus an Excel add-in to work with the forms a couple of years ago. The forms and the add-in contain VBA code that we code signed with a certificate from Go Daddy. The certificate expires this month, and the company has asked me to help them with anything that needs to be done to ensure the forms will still work and not prompt corporate users about trusting macros.</p>\n\n<p>The certificate will be renewed with Go Daddy, the original provider.</p>\n\n<p>Do I need to re-code sign the VBA project in each file or is the code signing smart enough to realize that the certificate has been renewed and just use it anyway? It seems that, worst=case, I'll have to open each VBA project and re-sign the code, save the files, and then re-deploy them to the server from which users open the forms when using them.</p>\n\n<p>I could probably figure this out by trial and error, but I no longer work at the company and won't have access to the forms and certificate until I go into the office next week. I want to be prepared, though, so any re-signing/re-deploying takes as little time as possible.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1554230631, "post_id": 55481402, "comment_id": 97672979, "body": "Create a LastRow variable for sheet2 and the use <code>LastRow +8</code>"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1554230784, "post_id": 55481402, "comment_id": 97673055, "body": "You can remove <code>Select</code>, do a Google search on <code>how not to use Select</code>"}], "owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1554231678, "creation_date": 1554229858, "last_edit_date": 1554230133, "question_id": 55481402, "link": "https://stackoverflow.com/questions/55481402/copy-sheet1-range-paste-eight-rows-down-on-sheet2", "title": "Copy Sheet1 range paste eight rows down on Sheet2", "body": "<p>My script copies, paste from sheet1. How would I let me script set the ongoing data on the 2nd next page, \"8\" rows down within Sheet2?</p>\n\n<pre><code>Sub Macro()\n\n    Sheets(\"Sheet1\").Select\n    Cells.Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Cells.Select\n    ActiveSheet.Paste\n    Range(\"A1\").Select\n    Cells.Select\n    Cells.EntireColumn.AutoFit\n    Range(\"A1\").Select\n    Columns(\"F:F\").ColumnWidth = 10\n\n\n For Each ws In Sheets\n On Error Resume Next\n For Each r In ws.UsedRange.SpecialCells(xlCellTypeConstants)\n If IsNumeric(r) Then r.Value = Val(r.Value)\n Next\n Next\n\n    Sheets(\"Sheet1\").Select\n    Range(\"A18:A50\").Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"B122\").Select\n    ActiveSheet.Paste\n    Range(\"B122\").Select\n    Application.CutCopyMode = False\n\n    Sheets(\"Sheet1\").Select\n    Range(\"B18:B50\").Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"A122\").Select\n    ActiveSheet.Paste\n    Range(\"A122\").Select\n    Application.CutCopyMode = False\n\n     Sheets(\"Sheet1\").Select\n    Range(\"J18:J50\").Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"C122\").Select\n    ActiveSheet.Paste\n    Range(\"C122\").Select\n    Application.CutCopyMode = False\n\n       Sheets(\"Sheet1\").Select\n    Range(\"R18:R50\").Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"D122\").Select\n    ActiveSheet.Paste\n    Range(\"D122\").Select\n    Application.CutCopyMode = False\n\n      Range(\"C122:C200\").Select\n    With Selection\n        .HorizontalAlignment = xlRight\n        .VerticalAlignment = xlTop\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\nEnd Sub\n</code></pre>\n"}]