[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 208, "user_id": 10887067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ck1y.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/10887067/brian"}, "edited": false, "score": 1, "creation_date": 1551312866, "post_id": 54916276, "comment_id": 96599080, "body": "You could setup a 2nd sheet for printing with references to 1st sheet.  =Sheet1!A1 for rows 1-40, then 6 columns over, =indirect(&quot;Sheet1!A&quot;&amp;row()+40)  if you were getting 40 rows on your print sheet."}], "answers": [{"tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": true, "score": 0, "last_activity_date": 1571277470, "creation_date": 1571277470, "answer_id": 58423853, "question_id": 54916276, "link": "https://stackoverflow.com/questions/54916276/print-two-pages-on-one-page/58423853#58423853", "title": "Print Two Pages on One Page", "body": "<p>This is the most complete yet simplified version of getting a print job to work. This is a fairly simple code in that it expects data to be in Columns A:D and Rows 1:80, but can be tailored to suite more complicated needs.</p>\n\n<p>It creates a <code>Temp</code> sheet, copies the data, prints and then deletes the <code>Temp</code> sheet.</p>\n\n<pre><code>Sub Print_Test()\n\nWith ThisWorkbook\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"Temp\"\n        Set tempsh = Sheets(\"Temp\")\nEnd With\n\nSheets(\"Sheet1\").Range(\"A1:D40\").Copy Destination:=tempsh.Range(\"A1\")\nSheets(\"Sheet1\").Range(\"A41:D80\").Copy Destination:=tempsh.Range(\"F1\")\n\nWith Application\n With .ActiveSheet\n With .PageSetup\n End With\n End With\n  .Dialogs(xlDialogPrint).Show\nEnd With\n\n\nApplication.DisplayAlerts = False\n Worksheets(\"Temp\").Delete\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58423853, "answer_count": 1, "score": 1, "last_activity_date": 1581822443, "creation_date": 1551311188, "last_edit_date": 1581822443, "question_id": 54916276, "link": "https://stackoverflow.com/questions/54916276/print-two-pages-on-one-page", "title": "Print Two Pages on One Page", "body": "<p>I have a workbook which has around three pages of information and four columns per page.</p>\n\n<p>To save printing I would like to print the second page of four columns on the first page of four columns with say one column of \"blank whitespace\" to separate the two.</p>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551313263, "post_id": 54916258, "comment_id": 96599174, "body": "See: <a href=\"https://social.msdn.microsoft.com/Forums/silverlight/en-US/f0171590-a9e0-4174-a3ab-c51db08f2b0f/importing-xml-into-excel-data-formatting-help?forum=exceldev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/silverlight/en-US/&hellip;</a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1551314504, "post_id": 54916258, "comment_id": 96599452, "body": "Search this site for the exact phrase <code>[excel] import zero</code>. This question has been asked (and answered) many times before here."}], "owner": {"reputation": 11, "user_id": 6804127, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209433083557573/picture?type=large", "display_name": "Saurabh Kumar", "link": "https://stackoverflow.com/users/6804127/saurabh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551311344, "creation_date": 1551311117, "last_edit_date": 1551311344, "question_id": 54916258, "link": "https://stackoverflow.com/questions/54916258/convertin-xml-to-excel-but-leading-zeroes-are-getting-removed", "title": "Convertin XML to excel but leading zeroes are getting removed", "body": "<p>I am converting XML to excel. I have ID whose values are 00003233 but after conversion to excel it is 3233. I have multiples XML files so I am using code to combine all different XML files. Below is the code.</p>\n\n<pre><code>Sub From_XML_To_XL()\n\n    Dim xWb As Workbook\n    Dim xSWb As Workbook\n    Dim xStrPath As String\n    Dim xFileDialog As FileDialog\n    Dim xFile As String\n    Dim xCount As Long\n    On Error GoTo ErrHandler\n    Set xFileDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    xFileDialog.AllowMultiSelect = False\n    xFileDialog.Title = \"Select a folder [Kutools for Excel]\"\n    If xFileDialog.Show = -1 Then\n        xStrPath = xFileDialog.SelectedItems(1)\n    End If\n    If xStrPath = \"\" Then Exit Sub\n    Application.ScreenUpdating = False\n    Set xSWb = ThisWorkbook\n    xCount = 1\n    xFile = Dir(xStrPath &amp; \"\\*.xml\")\n    Do While xFile &lt;&gt; \"\"\n        Set xWb = Workbooks.OpenXML(xStrPath &amp; \"\\\" &amp; xFile)\n        xWb.Sheets(1).UsedRange.Copy xSWb.Sheets(1).Cells(xCount, 1)\n        xWb.Close False\n        xCount = xSWb.Sheets(1).UsedRange.Rows.Count + 2\n        xFile = Dir()\n    Loop\n    Application.ScreenUpdating = True\n    xSWb.Save\n    Exit Sub\nErrHandler:\n    MsgBox \"no files xml\", , \"Error\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551311148, "post_id": 54916053, "comment_id": 96598667, "body": "Are you sure the <code>Sheets(&quot;Project viewer&quot;).activate</code> line is actually running?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551311498, "post_id": 54916053, "comment_id": 96598749, "body": "What&#39;s your setting under <i>Tools &gt;&gt; Options &gt;&gt; General &gt;&gt; Error Trapping</i> ?"}, {"owner": {"reputation": 1, "user_id": 11127832, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-h63p5OdgGms/AAAAAAAAAAI/AAAAAAAABQU/QPGDdz8E62E/photo.jpg?sz=128", "display_name": "Adrian Borg", "link": "https://stackoverflow.com/users/11127832/adrian-borg"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551313361, "post_id": 54916053, "comment_id": 96599207, "body": "Hi Tim, when I set break points over that line and the ones that follow and save the sheet, I can see the break enter the Workbook_BeforeSave sub and step over those lines. It doesn&#39;t throw any errors so I assume that means it runs. Is this what you mean?   I also have &#39;Break on Unhandled Errors&#39; set in the Error Trapping settings."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551313464, "post_id": 54916053, "comment_id": 96599229, "body": "Try &quot;break in class module&quot; and see if that changes anything."}, {"owner": {"reputation": 1, "user_id": 11127832, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-h63p5OdgGms/AAAAAAAAAAI/AAAAAAAABQU/QPGDdz8E62E/photo.jpg?sz=128", "display_name": "Adrian Borg", "link": "https://stackoverflow.com/users/11127832/adrian-borg"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551314043, "post_id": 54916053, "comment_id": 96599367, "body": "Thanks for the suggestion. Unfortunately no, that didn&#39;t change anything. The execution still steps over those methods throwing no errors, but doesn&#39;t seem to do anything."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1551314852, "post_id": 54916053, "comment_id": 96599546, "body": "OK, well...   Your code works fine for me (with stubs in place of whatever is in the subroutines called from the Save event).  I don&#39;t have any other suggestions."}, {"owner": {"reputation": 1, "user_id": 11127832, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-h63p5OdgGms/AAAAAAAAAAI/AAAAAAAABQU/QPGDdz8E62E/photo.jpg?sz=128", "display_name": "Adrian Borg", "link": "https://stackoverflow.com/users/11127832/adrian-borg"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551319493, "post_id": 54916053, "comment_id": 96600536, "body": "Thanks for confirming Tim. I have a feeling that this might be caused by some settings on my administrated network. It is unfortunate for me but at least I can stop pulling my hair out now."}], "owner": {"reputation": 1, "user_id": 11127832, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-h63p5OdgGms/AAAAAAAAAAI/AAAAAAAABQU/QPGDdz8E62E/photo.jpg?sz=128", "display_name": "Adrian Borg", "link": "https://stackoverflow.com/users/11127832/adrian-borg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551309725, "creation_date": 1551309725, "question_id": 54916053, "link": "https://stackoverflow.com/questions/54916053/workbook-beforesave-not-triggering-some-events", "title": "Workbook_BeforeSave not triggering some events", "body": "<p>I'm having an issue with Workbook_BeforeSave where the event is called, but most of the code doesn't do anything.</p>\n\n<p>What I want to do is password protect some sheets, hide another sheet and activate a third. Strangely, some items such as debug.print and MsgBox within the sub work. I also have sheets activated from within Workbook_Open, but most of the code that I try to execute within the Workbook_BeforeSave sub simply does not fire. Here's the code that I am trying to run:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    If AdministratorAccess Then     '   A boolean that is marked true when admin logs in\n        If MsgBox(\"For security, sheets must be locked and Admin logged out before saving. \" &amp; _\n            \"Do you want to Save the workbook?\", _\n                vbYesNo, \"Changes not saved\") = 6 Then\n            Call protectReadiness   '   A sub that protects the 'Project Readiness' sheet\n            Call protectViewer      '   A sub that protects the 'Project viewer' sheet\n            Call veryHideUsers      '   A sub that xlVeryHides the 'Users' sheet\n            Sheets(\"Project viewer\").Activate\n            MsgBox (\"To continue editing as Admin, simply log back in.\")\n        Else\n            Cancel = True\n        End If\n    Else\n        Call protectReadiness   '   A sub that protects the 'Project Readiness' sheet\n        Call protectViewer      '   A sub that protects the 'Project viewer' sheet\n        Call veryHideUsers      '   A sub that xlVeryHides the 'Users' sheet\n    End If\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>In the above code snippet, the calls for 'protectReadiness' and Sheets(\"Project viewer\").activate simply do not run. When I add them to the immediate window, they work fine. Also the MsgBox activates and displays correctly. </p>\n\n<p>I've spent a couple of hours looking for a solution online and can't find anything. I've tried removing everything from the sub except for the sheet.activate, and found that it does nothing. I've tried moving the helper methods protect- and veryhide- to the ThisWorkbook section of the VBA editor. I'm really at a loss for what to do.</p>\n\n<p>Does anyone have an idea on what I might be doing wrong, or what could be causing this strange behavior? Any suggestions would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "pdf", "adobe"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1551308402, "post_id": 54915782, "comment_id": 96597918, "body": "My first suspicion here is scaling. If the paper size differs the expected, you can get this effect."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1551340342, "post_id": 54915782, "comment_id": 96606743, "body": "It might only be a workaround, but did you try &quot;Hairline&quot; also? <code>Border.Weight</code> can be <code>xlHairline, xlThin, xlMedium, xlThick</code>"}], "owner": {"reputation": 1, "user_id": 10904099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76efcd11587ebf4cc1853eb227a22210?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Brue", "link": "https://stackoverflow.com/users/10904099/ken-brue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 602, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551308227, "creation_date": 1551307909, "last_edit_date": 1551308227, "question_id": 54915782, "link": "https://stackoverflow.com/questions/54915782/how-can-i-save-an-excel-as-a-pdf-without-adobe-messing-up-the-borders", "title": "how can I save an excel as a PDF without adobe messing up the borders?", "body": "<p>I have been trying with no success to get my spreadsheets to print automatically. I have done quite a bit of research and a lot of people say that the drivers for printing to PDF vs exporting as PDF are different enough to affect the quality. The only thing that gets affected in my case is the borders. They are supposed to be thin borders around all cells but some get changed to medium after EXPORT but not after PRINT.</p>\n\n<p>I can't get the PrintOut function to work because of issues with postscript and font. I have changed the settings for the Adobe printer to not rely only of system fonts but this didn't work in the end (I still get the post script error). I have found that some of my sheets will EXPORT with the correct thin borders if I first change all the borders to medium before I export while other sheets actually export with medium.</p>\n\n<p><img src=\"https://i.stack.imgur.com/6290p.png\" alt=\"exported with desired thin borders\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/GcMWR.png\" alt=\"exported with medium borders\"></p>\n\n<p>I don't know why they export differantly when the code is just a loop that does the same thing for each sheet. It basically selects the range and changes the borders to medium, exports the sheet to PDF, changes the borders back to thin and goes to the next sheet to repeat.</p>\n\n<p>Out of six sheets the first three export in the desired way. Can anyone tell me why the first three are exporting with thin borders so I can get the rest to aswell. Or if you know a better way to get PrintOut to work or any other ideas that would be fancy!</p>\n\n<p>Cheers,</p>\n"}, {"tags": ["excel", "vba", "range", "union"], "answers": [{"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1551331653, "post_id": 54916231, "comment_id": 96603328, "body": "Thanks so much. It works. Nice trick about <code>Union</code> and  <code>Address(0,0)</code>  I have the issue to Union() the separated rows or ranges in a single joined range. I&#39;ll see."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "is_accepted": true, "score": 2, "last_activity_date": 1551311388, "last_edit_date": 1551311388, "creation_date": 1551310977, "answer_id": 54916231, "question_id": 54915754, "link": "https://stackoverflow.com/questions/54915754/macro-to-get-ranges-for-each-unique-value-in-column/54916231#54916231", "title": "Macro to get ranges for each unique value in column", "body": "<p>If you change the row numbers to ranges the perform a little text processing, Union can group your row numbers together.</p>\n\n<pre><code>Option Explicit\n\nSub GetRanges()\n\n    Dim str As String, d As Object, lr As Long, arr As Variant, i As Long, key As Variant\n\n    lr = ActiveSheet.UsedRange.Rows.Count\n    arr = Application.Transpose(Range(\"B1:B\" &amp; lr).Value)\n\n    Set d = CreateObject(\"Scripting.Dictionary\")\n\n    For i = LBound(arr) To UBound(arr)\n        'collect items as range references\n        d(arr(i)) = d(arr(i)) &amp; \",Z\" &amp; i\n    Next i\n\n\n    'process row numbers as range\n    For Each key In d.Keys\n        'collect key's item\n        str = Mid(d(key), 2)\n        'union the range address back to str\n        str = Union(Range(str), Range(str)).Address(0, 0)\n        'remove column and swap colons for hyphens\n        str = Replace(Replace(str, \"Z\", vbNullString), \":\", \"-\")\n        'replace key's item with processed str\n        d(key) = str\n    Next key\n\n    For Each key In d.Keys\n        Debug.Print key, d(key)\n    Next key\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 54916231, "answer_count": 1, "score": 2, "last_activity_date": 1551339186, "creation_date": 1551307746, "last_edit_date": 1551339186, "question_id": 54915754, "link": "https://stackoverflow.com/questions/54915754/macro-to-get-ranges-for-each-unique-value-in-column", "title": "Macro to get ranges for each unique value in column", "body": "<p>I have the following code that displays unique values in column B and the row numbers where each value appears. It works, but my final goal\nis to print the ranges where each unique value appears.</p>\n\n<pre><code>Sub GetRanges()\n\nSet aw = Application.WorksheetFunction\nLastRow = ActiveSheet.UsedRange.Rows.Count\narr = Application.Transpose(Range(\"B1:B\" &amp; LastRow).Value)\n\n    Set d = CreateObject(\"Scripting.Dictionary\")\n\n    For i = LBound(arr) To UBound(arr)\n            d(arr(i)) = d(arr(i)) &amp; \",\" &amp; i\n    Next i\n\nFor Each Key In d.Keys\n    Debug.Print Key, Mid(d(Key), 2)\nNext Key\n\nEnd Sub\n</code></pre>\n\n<p>The input data from A1:B19 is:</p>\n\n<pre><code>    A           B\n1   BLOCK ABC    \n2   Code        Number\n3   RRU         91\n4   OCJS        103\n5   IE          43\n6   UHDI        109\n7   IJCD        109\n8   EIE         109\n9   BLOCK DEF    \n10  Code        Number\n11  UUTY        109\n12  EER         109\n13  BLOCK GHI    \n14  Code        Number\n15  RUO         223\n16  YUH         223\n17  JKKPW       223\n18  OOOI        223\n19  JSDDF       82\n</code></pre>\n\n<p>The current output that shows rows where each unique value in Column B appears is:</p>\n\n<pre><code>Value     |  Rows \n--------------------------\n          |  1,9,13\nNumber    |  2,10,14\n91        |  3\n103       |  4\n43        |  5\n109       |  6,7,8,11,12\n223       |  15,16,17,18\n82        |  19\n</code></pre>\n\n<p>I would like to get the ranges for each unique value like this:</p>\n\n<pre><code>Value    |    Range \n--------------------------\n         |    1,9,13\nNumber   |    2,10,14\n91       |    3\n103      |    4\n43       |    5\n109      |    6-8,11-12\n223      |    15-18\n82       |    19\n         |\n</code></pre>\n\n<p>This means that </p>\n\n<ul>\n<li><p>For <code>empty</code> value there are 3 ranges, Range(\"A1:B1\"), Range(\"A9:B9\") and Range(\"A13:B13\")</p></li>\n<li><p>For <code>109</code> there are 2 ranges, Range(\"A6:B8\") and Range(\"A11:B12\")</p></li>\n</ul>\n\n<p>My final goal is join in a single Range using <code>Union()</code> to colorize with different colors the rows related with each unique value but I don't want to use Autofilter method since is slow.</p>\n\n<p>Maybe someone could help with this. Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1551307532, "post_id": 54915624, "comment_id": 96597637, "body": "I don&#39;t think you can prevent specific methods of resizing"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1551307904, "post_id": 54915624, "comment_id": 96597754, "body": "There is no in-built method. You need to preserve the original position, angle and size and then continuously monitor and reset it whenever needed."}, {"owner": {"reputation": 45, "user_id": 7349678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e86ac0dae18f2e1dfd384f8f4be715f9?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas", "link": "https://stackoverflow.com/users/7349678/niklas"}, "edited": false, "score": 0, "creation_date": 1551308601, "post_id": 54915624, "comment_id": 96597963, "body": "it&#39;s not worth to monitor this, but its a nice idea, thank you"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1551339159, "post_id": 54915624, "comment_id": 96606262, "body": "@Niklas May I ask what the overall purpose of this is? Maybe it is a <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a> and there is a solution for Y while you asked X."}], "owner": {"reputation": 45, "user_id": 7349678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e86ac0dae18f2e1dfd384f8f4be715f9?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas", "link": "https://stackoverflow.com/users/7349678/niklas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1551338566, "creation_date": 1551307050, "last_edit_date": 1551338566, "question_id": 54915624, "link": "https://stackoverflow.com/questions/54915624/lock-picture-movement", "title": "Lock picture movement", "body": "<p>I'm adding some pictures in excel. \nIt would be nice to lock the resizing with mouse vertical and horizontal. So it should be just the diagonal movement allowed.</p>\n\n<p>the rotation should also be locked. Is that possible in vba? do you know anything? i was searching a lot, but just find the <code>.locked</code> function, that locks my whole picture/shape.</p>\n\n<p>in this picture there are the movements which should be locked/not possible.\n<a href=\"https://i.stack.imgur.com/5LztB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5LztB.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "excel", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1551308161, "last_edit_date": 1551308161, "creation_date": 1551307833, "answer_id": 54915767, "question_id": 54915619, "link": "https://stackoverflow.com/questions/54915619/in-vba-ado-creating-a-rs-field-based-on-concatenating-field-values-from-many-rec/54915767#54915767", "title": "In VBA/ADO creating a rs field based on concatenating field values from many records", "body": "<p>To my knowledge, this cannot be achieved using SQL alone. You'll need to use a VBA function to iterate over the records and construct the delimited string. </p>\n\n<p>Allen Browne has created an existing example which may be found <a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>For your particular task, you might call the function in the following manner:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select\n    [0TargetTemplate].SalesPerson, \n    ConcatRelated\n    (\n        \"[0TargetTemplate].Transaction_Date\", \n        \"[0TargetTemplate]\", \n        \"[0TargetTemplate].SalesPerson = '\" &amp; [0TargetTemplate].SalesPerson &amp; \"'\",\n        \"[0TargetTemplate].Transaction_Date\",\n        \"-\"\n    ) as Transaction_Date_Concatenated\nfrom\n    [0TargetTemplate];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "is_accepted": false, "score": 0, "last_activity_date": 1551358917, "creation_date": 1551358917, "answer_id": 54926382, "question_id": 54915619, "link": "https://stackoverflow.com/questions/54915619/in-vba-ado-creating-a-rs-field-based-on-concatenating-field-values-from-many-rec/54926382#54926382", "title": "In VBA/ADO creating a rs field based on concatenating field values from many records", "body": "<p>Using the suggested code and function from the <a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow noreferrer\">link</a> I wrote a procedure in VBA Access but get an error \"Too few parameters\" in the <em>Set rs=</em> statement. I've tried in VBA EXCEL with proper connections but get an error about \"<strong>ConcatRelated</strong>\" function not recognized, although properly referenced in a VBA module</p>\n\n<pre><code>Sub test()\nSQL = \"SELECT [tblOrders].CompanyName, ConcatRelated ('[tblOrders].Transaction_Date',[tblOrders], [tblOrders].SalesPerson =' [tblOrders].SalesPerson', [tblOrders].Transaction_Date) AS Transaction_Date_Concatenated FROM tblOrders;\"\nSet rs = CurrentDb.OpenRecordset(SQL)\n On Error GoTo resultsetError\n dbValue = rs!Variable\n MsgBox dbValue, vbOKOnly, \"RS VALUE\"\nresultsetError:\n MsgBox \"Error Retrieving value from database\", vbOKOnly, \"Database Error\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1551358917, "creation_date": 1551307041, "last_edit_date": 1551338532, "question_id": 54915619, "link": "https://stackoverflow.com/questions/54915619/in-vba-ado-creating-a-rs-field-based-on-concatenating-field-values-from-many-rec", "title": "In VBA/ADO creating a rs field based on concatenating field values from many records", "body": "<p>I have an MDB table with 2 fields:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+-------------+------------------+\n| salesperson | Transaction_Date |\n+-------------+------------------+\n| John        | 12/11/2018       |\n| John        | 13/11/2018       |\n| John        | 18/11/2018       |\n| Steeve      | 23/12/2018       |\n| Steeve      | 29/12/2018       |\n+-------------+------------------+\n</code></pre>\n\n<p>In VBA (in Excel) I want through ADO to create the  following format:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+-------------+----------------------------------+\n| salesperson |  Transaction_Date_Concatenated   |\n+-------------+----------------------------------+\n| John        | 12/11/2018-13/11/2018-18/11/2018 |\n| Steeve      | 23/12/2018-29/12/2018            |\n+-------------+----------------------------------+\n</code></pre>\n\n<p>The number of <code>Transaction_Dates</code> for each salesperson may vary from 1 to 30.</p>\n\n<p>The following SQL creates a record for each salesperson but it doesn't, of course, produces the concatenated field although it looks as in the direction of what I want</p>\n\n<pre><code>SQL = \" SELECT SalesPerson, max(Date)  as value1  FROM 0TargetTemplate   GROUP BY SalesPerson\"\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "edited": false, "score": 0, "creation_date": 1551306927, "post_id": 54915564, "comment_id": 96597408, "body": "Those &#39;Calls&#39; are to sub procedures, not functions."}, {"owner": {"reputation": 1, "user_id": 11127631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8YApBly0gm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdCTGBtbGdWhe4JDA3xLrS57iBDpg/mo/photo.jpg?sz=128", "display_name": "Julia Kincaid", "link": "https://stackoverflow.com/users/11127631/julia-kincaid"}, "edited": false, "score": 0, "creation_date": 1551380381, "post_id": 54915564, "comment_id": 96629444, "body": "I generally default to writing functions because most of what I need then to do is to return a value, but I suppose sub procedure/subroutine is probably more common."}, {"owner": {"reputation": 1, "user_id": 11127631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8YApBly0gm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdCTGBtbGdWhe4JDA3xLrS57iBDpg/mo/photo.jpg?sz=128", "display_name": "Julia Kincaid", "link": "https://stackoverflow.com/users/11127631/julia-kincaid"}, "edited": false, "score": 0, "creation_date": 1551383280, "post_id": 54915564, "comment_id": 96630774, "body": "Ah! Call! This negates the return on a function... Thank you, I had been working under the wrong assumption for all this time."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11127631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8YApBly0gm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdCTGBtbGdWhe4JDA3xLrS57iBDpg/mo/photo.jpg?sz=128", "display_name": "Julia Kincaid", "link": "https://stackoverflow.com/users/11127631/julia-kincaid"}, "edited": false, "score": 0, "creation_date": 1551380595, "post_id": 54916301, "comment_id": 96629567, "body": "Interesting idea, but I agree it&#39;s not really quite what I was hoping I could do. It&#39;s almost like I want a VBA function that can search text within the literal VBA code. I doubt if it exists."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 1, "user_id": 11127631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8YApBly0gm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdCTGBtbGdWhe4JDA3xLrS57iBDpg/mo/photo.jpg?sz=128", "display_name": "Julia Kincaid", "link": "https://stackoverflow.com/users/11127631/julia-kincaid"}, "edited": false, "score": 0, "creation_date": 1551384748, "post_id": 54916301, "comment_id": 96631481, "body": "See my other answer"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1551311315, "creation_date": 1551311315, "answer_id": 54916301, "question_id": 54915564, "link": "https://stackoverflow.com/questions/54915564/vba-can-i-count-the-number-of-times-i-call-a-function-in-my-script/54916301#54916301", "title": "VBA Can I count the number of times I call a function in my Script", "body": "<p>It is possible, but it's not pretty.<br>\nI would consider the solution below bad practice in most cases. Anyway - here it goes:</p>\n\n<pre><code>Sub Test()\n    Dim StepCount As Integer\n    Dim TotalSteps As Integer\n    Steps = Array(\"Abc\", \"Def\", \"Ghi\")\n    TotalSteps = UBound(Steps) + 1\n    For Each Step In Steps\n        StepCount = StepCount + 1\n        ActiveSheet.Evaluate Step &amp; \"()+0\" '+0 is workaround to handle a bug in VBA. Without it, the method is called twice\n        Progress StepCount, TotalSteps\n    Next\nEnd Sub\n\nSub Progress(StepCount As Integer, TotalSteps As Integer)\n    Debug.Print StepCount &amp; \"(\" &amp; TotalSteps &amp; \")\"\nEnd Sub\n\nSub Abc()\n    Debug.Print \"Abc\"\nEnd Sub\n\nSub Def()\n    Debug.Print \"def\"\nEnd Sub\n\nSub Ghi()\n    Debug.Print \"ghi\"\nEnd Sub\n</code></pre>\n\n<p>The base for this is the Evaluate function, that allows you to evaluate expressions in strings. The Test method calls the methods in the Steps array, using Evaluate.</p>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1551384737, "creation_date": 1551384737, "answer_id": 54933538, "question_id": 54915564, "link": "https://stackoverflow.com/questions/54915564/vba-can-i-count-the-number-of-times-i-call-a-function-in-my-script/54933538#54933538", "title": "VBA Can I count the number of times I call a function in my Script", "body": "<p>Here's a different approach. Not a good way to write code, but again, there are situations where it is warranted.  </p>\n\n<p>Start by adding a reference to <em>Microsoft Visual Basic for Applications Extensibility</em>, then add this code:</p>\n\n<pre><code>Sub Test()\n    Dim CodeMod As VBIDE.CodeModule\n    Set CodeMod = ActiveWorkbook.VBProject.VBComponents(\"Module1\").CodeModule\n\n    Debug.Print CountOccurrences(\"Call fnProgress\", CodeMod.Lines(1, CodeMod.CountOfLines)) - 1 'Remove 1 to ignore this line\nEnd Sub\n\nFunction CountOccurrences(SoughtString As String, InString As String) As Long\n    CountOccurrences = (Len(InString) - (Len(Replace(InString, SoughtString, \"\")))) / Len(SoughtString)\n\nEnd Function\n</code></pre>\n\n<p>The module name is hardcoded. It reads the code, counts the number of occurences of <code>Call  fnProgress</code> and subtracts one (so that the count it self isn't counted). Adjust as needed.</p>\n"}], "owner": {"reputation": 1, "user_id": 11127631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8YApBly0gm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdCTGBtbGdWhe4JDA3xLrS57iBDpg/mo/photo.jpg?sz=128", "display_name": "Julia Kincaid", "link": "https://stackoverflow.com/users/11127631/julia-kincaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551384737, "creation_date": 1551306725, "question_id": 54915564, "link": "https://stackoverflow.com/questions/54915564/vba-can-i-count-the-number-of-times-i-call-a-function-in-my-script", "title": "VBA Can I count the number of times I call a function in my Script", "body": "<p>I'm trying to build a dynamic progress bar in Excel, and the way I'm currently doing this is by hard-coding a number of steps into my script as the \"total number of steps\"... the Application.StatusBar code gets updated with a counter that is divided by this total. </p>\n\n<p>What I'd like to do is to have \"TotalSteps\" pre-populate with 3 (using the example below) by searching ahead through the code to identify the number of times \"Call fnProgress\" appears in the subroutine.</p>\n\n<pre><code>Public Sub Example()\n    TotalSteps = 3     'Enter a value here equal to the number of times \"Call fnProgress\" appears below\n\n    Call ABC\n    Call fnProgress\n\n    Call 123\n    Call fnProgress\n\n    Call DoReMi\n    Call fnProgress\nEnd Sub\n</code></pre>\n\n<p>I don't get the impression this is possible in VBA, but I figured someone here would know how to do it if it was! Or perhaps someone could offer a better solution to my simple progress bar... Being able to search ahead in the actual code is also an interesting problem, to me, and I'd imagine it's got further application beyond my status bar.\nThanks so much!\n-Julia :)</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1551318689, "creation_date": 1551318689, "answer_id": 54917202, "question_id": 54915537, "link": "https://stackoverflow.com/questions/54915537/change-content-control-properties-text-style-based-on-drop-down-value-selection/54917202#54917202", "title": "Change Content Control Properties Text Style based on drop-down value selection", "body": "<p>Perhaps:</p>\n\n<pre><code>Private Sub Document_ContentControlOnExit(ByVal CCtrl As ContentControl, Cancel As Boolean)\nWith CCtrl\n  If .Title = \"Status\" Then\n    With .Range\n      Select Case .Text\n        Case \"RED\"\n          .Shading.BackgroundPatternColorIndex = wdRed\n          .Font.ColorIndex = wdWhite\n        Case \"AMBER\"\n          .Shading.BackgroundPatternColorIndex = wdDarkYellow\n          .Font.ColorIndex = wdColorBlack\n        Case \"GREEN\"\n          .Shading.BackgroundPatternColorIndex = wdBrightGreen\n          .Font.ColorIndex = wdWhite\n        Case Else\n          .Shading.BackgroundPatternColorIndex = wdAuto\n      End Select\n    End With\n  End If\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 860, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551429741, "creation_date": 1551306595, "last_edit_date": 1551429741, "question_id": 54915537, "link": "https://stackoverflow.com/questions/54915537/change-content-control-properties-text-style-based-on-drop-down-value-selection", "title": "Change Content Control Properties Text Style based on drop-down value selection", "body": "<p>Currently I have a macro that change the <code>.BackgroundPatternColor</code> based on the Drop-Down List Content Control value selected. It applies to the entire table cell.</p>\n\n<p>Code below + screenshot how it looks.</p>\n\n<pre><code>Private Sub Document_ContentControlOnExit(ByVal ContentControl As ContentControl, Cancel As Boolean)\nWith ContentControl.Range\n    If ContentControl.Title = \"Status\" Then\n        Select Case .Text\n            Case \"RED\"\n                .Cells(1).Shading.BackgroundPatternColor = RGB(227, 36, 27)\n                .Cells(1).Range.Font.TextColor = wdColorWhite\n            Case \"AMBER\"\n                .Cells(1).Shading.BackgroundPatternColor = RGB(251, 171, 24)\n                .Cells(1).Range.Font.TextColor = wdColorBlack\n            Case \"GREEN\"\n                .Cells(1).Shading.BackgroundPatternColor = RGB(110, 190, 74)\n                .Cells(1).Range.Font.TextColor = wdColorWhite\n            Case Else\n                .Cells(1).Shading.BackgroundPatternColor = wdColorAutomatic\n        End Select\n    End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Tasps.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tasps.png\" alt=\"enter image description here\"></a></p>\n\n<p>Since you can't change the Text Highlight Color in MS Word via VBA I have discovered I can achieve desired look by changing Style format of Content Control in Properties.</p>\n\n<p>Properties -> +NewStyle -> Format -> Border...</p>\n\n<p><a href=\"https://i.stack.imgur.com/naCad.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/naCad.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/tK4D0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tK4D0.png\" alt=\"enter image description here\"></a></p>\n\n<p>Only then I get my desired \"highlighting text\" look with custom coluors, instead of changing the entire background of the table cell.</p>\n\n<p>What I want is something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DctSO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DctSO.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have created separate style for each selection type.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9nKU4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9nKU4.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, I can't figure out the way to change the Content Control Properties Text Style's based on the current drop-down value selection in MS Word.</p>\n\n<p>Please help. Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 4, "creation_date": 1551303987, "post_id": 54914940, "comment_id": 96596301, "body": "Instead of looping to row <code>1500</code>, <a href=\"https://stackoverflow.com/questions/38882321/excel-vba-better-way-to-find-last-row\">find the last row</a> in your sheet"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1551304287, "post_id": 54914940, "comment_id": 96596434, "body": "You also need to add an <code>End if</code> to close out your <code>If</code> statement"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1551304485, "post_id": 54914940, "comment_id": 96596517, "body": "@DarrellH No, that&#39;s a single line <code>If</code> statement. It&#39;s syntactically correct."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1551304949, "post_id": 54914940, "comment_id": 96596685, "body": "Should that also be the string &quot;OK&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1551306094, "creation_date": 1551306094, "answer_id": 54915439, "question_id": 54914940, "link": "https://stackoverflow.com/questions/54914940/have-excel-macro-populate-only-desired-cells/54915439#54915439", "title": "Have Excel macro populate only desired cells", "body": "<p>Change</p>\n\n<p><code>Set r = Range(Range(\"C2\"), Range(\"C1500\"))</code></p>\n\n<p>to</p>\n\n<p><code>Set r = Range(Range(\"C2\"), Range(\"C\" &amp; Cells(Rows.Count, \"C\").End(xlUp).Row))</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11127528, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3PXkVugWilo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP3xaTbkA-PrF5cTriOMCaHjwrhBA/mo/photo.jpg?sz=128", "display_name": "Keith Brown", "link": "https://stackoverflow.com/users/11127528/keith-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568966836, "creation_date": 1551303734, "last_edit_date": 1568966836, "question_id": 54914940, "link": "https://stackoverflow.com/questions/54914940/have-excel-macro-populate-only-desired-cells", "title": "Have Excel macro populate only desired cells", "body": "<p>I am currently using a piece of VBA code to auto-populate blank cells in column C of my report.  The only thing is it will autopopulate past the end of my data set. (There are several columns of data in this report.) In order to stop the VBA code, I have set the range up to C1500.  I would prefer it if that macro would just automatically stop once it reached rows with no data in them.  Does any one know how to change my code to accomplish this?</p>\n\n<pre><code>Sub Macro1()\n    mynumber = 1\n    Dim r As Range, cell As Range\n    Set r = Range(Range(\"C2\"), Range(\"C1500\"))\n    For Each cell In r\n        If cell.Value = OK Then cell.Value = mynumber\n        mynumber = mynumber + 1\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1551337260, "post_id": 54914898, "comment_id": 96605419, "body": "why change the datatype? you can use <code>CInt(Me.ID)</code> it will remove the leading zero so even if the user enter <code>00123456</code> still you get the desired result."}, {"owner": {"reputation": 29, "user_id": 10963152, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mHNRgvP-qr4/AAAAAAAAAAI/AAAAAAAAuOw/4Tl9Hsa5Mh4/photo.jpg?sz=128", "display_name": "Stan S", "link": "https://stackoverflow.com/users/10963152/stan-s"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1551370890, "post_id": 54914898, "comment_id": 96624597, "body": "Thank you, but I am not familiar with &quot;CInt&quot; where and how would I use that? With the &quot;me.&quot; I am assuming in the form or subform I tried adding it to the on click event of the record ID:  <code>DoCmd.OpenForm &quot;FormToOpen&quot;, , , &quot;ID = &quot; &amp; CInt(Me.ID), acFormEdit, acWindowNormal</code>  and it didn&#39;t work... TYIA! \u2013"}, {"owner": {"reputation": 29, "user_id": 10963152, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mHNRgvP-qr4/AAAAAAAAAAI/AAAAAAAAuOw/4Tl9Hsa5Mh4/photo.jpg?sz=128", "display_name": "Stan S", "link": "https://stackoverflow.com/users/10963152/stan-s"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1551466443, "post_id": 54914898, "comment_id": 96664104, "body": "This works great if it is a text data type: <code>DoCmd.OpenForm &quot;SecondFormName&quot;, , , &quot;FieldName = &#39;&quot; &amp; Me.ControlName &amp; &quot;&#39;&quot;  &#39;(note, that&#39;s a double quote, single quote and double quote at the end)</code> I found it here: <a href=\"http://www.baldyweb.com/wherecondition.htm\" rel=\"nofollow noreferrer\">baldyweb.com/wherecondition.htm</a>"}], "owner": {"reputation": 29, "user_id": 10963152, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mHNRgvP-qr4/AAAAAAAAAAI/AAAAAAAAuOw/4Tl9Hsa5Mh4/photo.jpg?sz=128", "display_name": "Stan S", "link": "https://stackoverflow.com/users/10963152/stan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551467681, "creation_date": 1551303554, "last_edit_date": 1551467681, "question_id": 54914898, "link": "https://stackoverflow.com/questions/54914898/sort-form-when-opening-based-on-previous-form-criteria", "title": "Sort form when opening based on previous form criteria", "body": "<p>I have a search form that runs a query and populates a subform within the search form. After querying and populating the subform you can click on a specific record ID to open a subsequent form specific and filtered to the record KEY (\"ID\") that was clicked on in the previous subform.  </p>\n\n<p>This code works great when the \"ID\" key field is a Number type format:</p>\n\n<pre><code>DoCmd.OpenForm \"FormToOpen\", , , \"ID = \" &amp; Me.ID, acFormEdit, acWindowNormal\n</code></pre>\n\n<p>However, when querying to build the subform it does not consider the leading zero i.e. if a record ID is \"0123456\" and the user enters \"0123456\" the query returns no results. If you enter \"123456\" it WILL return the record. </p>\n\n<p>So I switched to the ShortText datatype and the query works great! You can enter  \"0123456\" or  \"123456\" and return the record...problem is that the open subsequent form code then breaks with the short text type. </p>\n\n<p>This is my query criteria:</p>\n\n<pre><code>Like \"*\" &amp; [Forms]![FORMNAME]![txtID] &amp; \"*\"\n</code></pre>\n\n<p>I believe I can change the form open code so that it recognizes a text type instead of a number type--something like:</p>\n\n<pre><code> ID = \" &amp; \"Me.ID\"\n</code></pre>\n\n<p>Or, would it be better to change my query criteria? TYIA!</p>\n\n<p><em>Update</em>\nThis works great if it is a text data type: DoCmd.OpenForm \"SecondFormName\", , , \"FieldName = '\" &amp; Me.ControlName &amp; \"'\" '(note, that's a double quote, single quote and double quote at the end) I found it here: baldyweb.com/wherecondition.htm \u2013</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1551303482, "post_id": 54914797, "comment_id": 96596066, "body": "If you can click the button manually, then you can click it via the code. Given the information you are providing, the code you posted looks correct. The only way you have to get more help here is to share the URL of your website and the full code you&#39;re using."}, {"owner": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1551304033, "post_id": 54914797, "comment_id": 96596322, "body": "@Matteo NNZ Thanks for the reply. My script is clicking the button but its not redirecting to the page it is supposed to redirect, it is loading the same page after that click."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1551304445, "post_id": 54914797, "comment_id": 96596502, "body": "If you don&#39;t share the link of the webpage, we can&#39;t do much, sorry."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551306222, "post_id": 54914797, "comment_id": 96597165, "body": "An image-type input acting as a submit button also sends the x and y coordinates of the click  - don&#39;t think that happens if you click the button via code, and it&#39;s possible the server may be checking for the x/y parameters."}, {"owner": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551368473, "post_id": 54914797, "comment_id": 96623138, "body": "@TimWilliams I will try to request access to the actual Javascript code for this button and figure out if coordinates are the issue or some timeout issue. Thanks for the reply."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 0, "creation_date": 1551305133, "post_id": 54915088, "comment_id": 96596762, "body": "@QHarr I tried running your script and I am getting error on Set event_onClick = .document.createEvent(&quot;HTMLEvents&quot;). VBA is not recognizing the function."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551305295, "post_id": 54915088, "comment_id": 96596825, "body": "Try the other lines first then and comment out the those for #1 for now"}, {"owner": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 0, "creation_date": 1551366337, "post_id": 54915088, "comment_id": 96621797, "body": "Is there any reference to add in the library or something else before execution of the querySelector method. I tried running the #2 option too but no luck."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 0, "creation_date": 1551366459, "post_id": 54915088, "comment_id": 96621879, "body": "No. What error message did you get with #2?  Have you already got Microsoft Internet Control and Microsoft HTML Object library added? (Don&#39;t think you should need the second). And I guess there is always number 3."}, {"owner": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 0, "creation_date": 1551366922, "post_id": 54915088, "comment_id": 96622174, "body": "I am getting this error &quot;Could not complete the operation due to error 80020101&quot;. Looks like this is some time out error. Do you have any idea what this error says?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 0, "creation_date": 1551367019, "post_id": 54915088, "comment_id": 96622237, "body": "Try ie.Document.parentWindow.execScript &quot;document.getElementById(&#39;btnAddUserid&#39;).click();&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 0, "creation_date": 1551367054, "post_id": 54915088, "comment_id": 96622266, "body": "And what number where you trying when you got that message?"}, {"owner": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 0, "creation_date": 1551367541, "post_id": 54915088, "comment_id": 96622571, "body": "So this line didn&#39;t give me any error and clicked the button but did not redirect to a new page just loaded the same page. I was trying #2 and I already have the references added."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 0, "creation_date": 1551367621, "post_id": 54915088, "comment_id": 96622625, "body": "I\u2019m not sure what to suggest. I would try to get the adding events version to work. Also, verify that this is the correct element to select for the fire off the new page."}, {"owner": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "edited": false, "score": 1, "creation_date": 1551368355, "post_id": 54915088, "comment_id": 96623064, "body": "Thanks for you effort. Will update you once I get around this."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1551688160, "post_id": 54915088, "comment_id": 96716728, "body": "If possible for you than I suggest you to share the link of that page may help us to test the code with it to check for the result and the cause for the issue. it can help to narrow down the issue. Thanks for your understanding."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1551304556, "last_edit_date": 1551304556, "creation_date": 1551304440, "answer_id": 54915088, "question_id": 54914797, "link": "https://stackoverflow.com/questions/54914797/clicking-a-button-with-vba-is-not-redirecting-to-a-new-page-but-redirecting-when/54915088#54915088", "title": "Clicking a button with VBA is not redirecting to a new page but redirecting when clicked manually", "body": "<p>You could try</p>\n\n<p>1) Adding a click event and firing that</p>\n\n<p>2) Using javascript to simulate clicking</p>\n\n<p>3) Using FireEvent \"onclick\"</p>\n\n<pre><code>Option Explicit   \nPublic Sub PerformClick()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"url\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        '#1\n        Dim event_onClick As Object\n        Set event_onClick = .document.createEvent(\"HTMLEvents\")\n        event_onClick.initEvent \"click\", True, False\n\n        With .document.querySelector(\"#btnAddUserid\")\n             '#3\n            .FireEvent \"onclick\"\n             '#1\n            .dispatchEvent event_onClick\n        End With\n\n        'Or #2\n        ie.Document.parentWindow.execScript \"document.querySelector('#btnAddUserid').click();\"\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10652679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891fa5ff819e534c32ccba03a77d2f8?s=128&d=identicon&r=PG&f=1", "display_name": "Manisha B", "link": "https://stackoverflow.com/users/10652679/manisha-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1551338470, "creation_date": 1551303048, "last_edit_date": 1551338470, "question_id": 54914797, "link": "https://stackoverflow.com/questions/54914797/clicking-a-button-with-vba-is-not-redirecting-to-a-new-page-but-redirecting-when", "title": "Clicking a button with VBA is not redirecting to a new page but redirecting when clicked manually", "body": "<p>I am working with VBA to automate routines for repetetive tasks. My application has a page with lot of data(this page has atleast 1000 records) and few buttons.\nOne of the button clicks should redirect to a new page. My script waits until the page with the records load completely to click the button and when the button is clicked it should load new page but it just loads the same page instead of redirecting to a new page. But when the button when clicked manually, new page is loaded.</p>\n\n<p>Button html:</p>\n\n<pre><code>&lt;input type=\"image\" name=\"btnadduser\" id=\"btnAddUserid\" src=\"../images/buttons/btn_add.gif\" alt=\"Add New User\" style=\"border-width:0px;\" border=\"0\"&gt;\n</code></pre>\n\n<p>To click this button from VBA:</p>\n\n<pre><code>Application.Wait (Now + TimeValue(\"00:00:03\"))\nWhile IE.readyState &lt;&gt; 4 Or IE.Busy: DoEvents: Wend    \nIE.document.getElementById(\"btnAddUserid\").Click //this is the button which is not redirecting.\n</code></pre>\n\n<p>I don't have access to the actual functions of the code. So I don't know what is going on in the background. But the other buttons except this one work fine. How should I handle this issue?</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1551302107, "post_id": 54914523, "comment_id": 96595477, "body": "You might have a length limit of 5 character as <a href=\"https://support.office.com/en-us/article/set-the-field-size-ba65e5a7-2e6f-4737-8e72-36b93f966a33\" rel=\"nofollow noreferrer\">field size</a>. Try changing to 10 or remove any number. Does an error table output after Excel import?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "edited": false, "score": 0, "creation_date": 1551302109, "post_id": 54914523, "comment_id": 96595478, "body": "You can store <code>12345-1245</code> as <code>123451245</code> (number) and use zip+4 formatting to display the zip properly. This also corrects 4 digit zips with leading zeroes."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551302510, "post_id": 54914523, "comment_id": 96595673, "body": "@user11121185 Storing postal codes as numbers is generally a horrible idea - works (kind of) in the U.S., but not in Canada, the U.K., etc., etc..  ;-)"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551302602, "post_id": 54914523, "comment_id": 96595702, "body": "@Comintern.............I have separate tables for the US and Canada.  This issue only impacts the US import process"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551302786, "post_id": 54914523, "comment_id": 96595778, "body": "@Parfait.........I just checked and the field size is 255.  I didn&#39;t change the default when I set up these fields.  Yes......an error table is created after the import is finished.  It says (1) Type Conversion, (2) field name, and (3) row number.  There are 9 lines on this table and when I checked the source data, there are 9 zip codes that are longer than 5 characters."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551302909, "post_id": 54914523, "comment_id": 96595835, "body": "@user11121185......I&#39;m going to give this a try.  I have another similar process and the longer zip codes don&#39;t have an issue with that process / database.  In fact, this process was built off of that one since it works so well.  Not sure what the difference is.  The only thing I can think of is that the source data is from different applications........"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1551302962, "post_id": 54914523, "comment_id": 96595858, "body": "Can you edit the question to include the import code? I suspect you need a schema file for the csvs."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1551303078, "post_id": 54914523, "comment_id": 96595904, "body": "That&#39;s what I was thinking as well, look <a href=\"https://docs.microsoft.com/en-us/sql/odbc/microsoft/schema-ini-file-text-file-driver?view=sql-server-2017\" rel=\"nofollow noreferrer\">here</a> resp. <a href=\"https://stackoverflow.com/a/52519647/6600940\">here</a>"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551303370, "post_id": 54914523, "comment_id": 96596017, "body": "@Comintern...This is the line of code that does the import process:  .DoCmd.TransferText acImportDelim, &quot;&quot;, &quot;US_Before&quot;, &quot;R:\\ProB\\Before_Data.csv&quot;, True"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1551303546, "post_id": 54914523, "comment_id": 96596095, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.docmd.transfertext\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a> . I&#39;d suggest to use <i>SpecificationName</i> with a schema.ini"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1551303666, "post_id": 54914523, "comment_id": 96596148, "body": "@Storax.............Thanks..........I&#39;ll look at adding a specification name as you suggest"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 785, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551302005, "creation_date": 1551301712, "last_edit_date": 1551302005, "question_id": 54914523, "link": "https://stackoverflow.com/questions/54914523/access-2016-type-conversion-errors-when-importing-csv-files", "title": "Access 2016 Type Conversion Errors when importing csv files", "body": "<p>I have a macro that imports 2 csv files into an Access 2016 database.  1 file goes to a <em>BEFORE</em> table and the other goes to an <em>AFTER</em> table.  All of the data imports just like I expect it to with the exception of zip codes longer than 5 characters.  Anything less than 5 is not an issue.  Any zip code like 12345-1245 doesn't import into the database.  I'm guess it has to do with the hypen in the middle of it but I don't know how to correct it.  The zip code field in both tables is defined as 'short text'.  </p>\n\n<p>I really need the zip codes to appear as they are (12345-1245) because the macro runs a number of queries against all of the fields to identify differences in the 2 tables.  </p>\n\n<p>So if 1 table has 12345 and the other has 12345-1245, it should appear on the differences.  I don't really want to modify the zip code because this could cause issues for the reviewer if they have to look at all of the modified zip codes.</p>\n\n<p>Is there a way to import the longer zip codes without creating Type Conversion issues?  Thanks in advance for your help with this issue....</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1551298931, "post_id": 54913839, "comment_id": 96594087, "body": "You can&#39;t set a formula from inside a UDF."}, {"owner": {"reputation": 571, "user_id": 4700944, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/61dbc102175a65fcd7a9b433b5722987?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Lowe", "link": "https://stackoverflow.com/users/4700944/alex-lowe"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551299147, "post_id": 54913839, "comment_id": 96594172, "body": "@Comintern When I take this out...<code>sh.Range(&quot;B&quot; &amp; i).Formula = &quot;=A&quot; &amp; i &amp; &quot;*&quot; &amp; rate &amp; &quot;*24&quot;</code> from the function at the very top of my question it works fine. Why&#39;s that?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1551299258, "post_id": 54913839, "comment_id": 96594211, "body": "A UDF can only return a value to the calling cell (or cells if the UDF returns an array).  See here for an overview: <a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/170787/&hellip;</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1551299317, "post_id": 54913839, "comment_id": 96594232, "body": "Well, when you take out that line, you&#39;re no longer setting a formula from inside a UDF."}, {"owner": {"reputation": 571, "user_id": 4700944, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/61dbc102175a65fcd7a9b433b5722987?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Lowe", "link": "https://stackoverflow.com/users/4700944/alex-lowe"}, "edited": false, "score": 0, "creation_date": 1551299445, "post_id": 54913839, "comment_id": 96594294, "body": "OK, I very much appreciate the help. I&#39;ve been banging my head against the wall for some time wondering what I&#39;ve been doing wrong."}], "owner": {"reputation": 571, "user_id": 4700944, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/61dbc102175a65fcd7a9b433b5722987?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Lowe", "link": "https://stackoverflow.com/users/4700944/alex-lowe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1551299465, "answer_count": 0, "score": 0, "last_activity_date": 1551302713, "creation_date": 1551298797, "last_edit_date": 1551302713, "question_id": 54913839, "link": "https://stackoverflow.com/questions/54913839/program-doesnt-run-as-function-only-as-sub", "closed_reason": "Duplicate", "title": "Program doesn&#39;t run as function only as sub", "body": "<p>The code below is is supposed to set an hourly rate per client as well as go down the length of the spreadsheet and calculate the total amount that each client owes me and then return that value to the cell, as I work as a freelancer. The code that I have currently doesn't run since I added the \"rate\" feature into the program. In the excel spreadsheet the error that I'm getting looks like this <code>#VALUE!</code>. I have no explanation for why it's that way.</p>\n\n<pre><code>Function clientCalc(client As String, rate As Integer)\n    Dim tbl As ListObject\n    Dim tableLen As Double\n    Dim sh As Worksheet\n    Dim tally As Double\n    Set sh = ThisWorkbook.Sheets(\"Hours\")\n    Set tbl = sh.ListObjects(\"Main\")\n    tableLen = tbl.Range.Rows.Count\n    tally = 0\n    For i = 2 To tableLen\n        If Range(\"H\" &amp; i).Value = client Then\n            sh.Range(\"B\" &amp; i).Formula = \"=A\" &amp; i &amp; \"*\" &amp; rate &amp; \"*24\"\n            tally = tally + Range(\"D\" &amp; i).Value\n        End If\n    Next i\n    clientCalc = Format(tally, \"Currency\")\nEnd Function\n</code></pre>\n\n<p>In order for me to make this work in some way I have to make the program above and turn it into a <code>Sub</code> rather than a <code>Function</code>. In that case I've found that this works pretty well...</p>\n\n<pre><code>Sub setRate(client As String, rate As Double)\n    Dim tbl As ListObject\n    Dim tableLen As Double\n    Dim sh As Worksheet\n    Dim tally As Double\n    Set sh = ThisWorkbook.Sheets(\"Sheet1\")\n    Set tbl = sh.ListObjects(\"Table3\")\n    tableLen = tbl.Range.Rows.Count\n    tally = 0\n    For i = 2 To tableLen\n        If Range(\"C\" &amp; i).Value = client Then\n            sh.Range(\"B\" &amp; i).Formula = \"=A\" &amp; i &amp; \"*\" &amp; rate &amp; \"*24\"\n        End If\n    Next i\nEnd Sub\n\nSub main()\n    Call setRate(\"Client_One\", 30)\n    Call setRate(\"Client_Two\", 40)\nEnd Sub\n\nFunction clientCalc(client As String)\n    Dim tbl As ListObject\n    Dim tableLen As Double\n    Dim sh As Worksheet\n    Dim tally As Double\n    Set sh = ThisWorkbook.Sheets(\"Hours\")\n    Set tbl = sh.ListObjects(\"Main\")\n    tableLen = tbl.Range.Rows.Count\n    tally = 0\n    For i = 2 To tableLen\n        If Range(\"H\" &amp; i).Value = client Then\n            tally = tally + Range(\"D\" &amp; i).Value\n        End If\n    Next i\n    clientCalc = Format(tally, \"Currency\")\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551297808, "post_id": 54913554, "comment_id": 96593552, "body": "You&#39;re returning the <code>Value</code> implicitly in <code>ActiveSheet.Range(&quot;B&quot; &amp; itemnamerow &amp; &quot;:Z&quot; &amp; itemnamerow)</code>.  You need to make sure it can be cast to a <code>String</code> (or use the <code>.Text</code> instead).  You also need to test to see if <code>FindRow3 Is Nothing</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "edited": false, "score": 1, "creation_date": 1551297872, "post_id": 54913554, "comment_id": 96593583, "body": "Shouldn&#39;t that be <code>Like &quot;*PROFILE*&quot;</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551298534, "post_id": 54913678, "comment_id": 96593885, "body": "I should also mention that I am trying to check if it has &quot;PROFILE&quot; in it so I can use it to do something if so. In the code you posted, does it return a value for finding it etc. or how does it determine if its found."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551299019, "post_id": 54913678, "comment_id": 96594120, "body": "@A.Jones - if &quot;PROFILE&quot; is found, then <code>profileFound</code> will be the range object (cell) where it was first found. If not found <code>profileFound</code> will be <code>Nothing</code>"}, {"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551301520, "post_id": 54913678, "comment_id": 96595211, "body": "This is kind of a side question. Now that it found it profileFound returns the string of what it found, is there a way to also determine what column so i can hide the data so it does not show up?"}, {"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551360644, "post_id": 54913678, "comment_id": 96618257, "body": "Thanks again! The hide didn&#39;t work like i wanted so I had to modify my code to fit in the if loop above so that I could use the column.delete if the profile was found."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1551298915, "last_edit_date": 1551298915, "creation_date": 1551298070, "answer_id": 54913678, "question_id": 54913554, "link": "https://stackoverflow.com/questions/54913554/finding-partial-text-in-full-row/54913678#54913678", "title": "Finding Partial Text In Full Row", "body": "<p>You need to use the <code>Find</code> method, with <code>MatchCase</code> and <code>LookIn</code> arguments set. And probably <code>LookAt</code> for to ensure it checks actual values and not formula syntax.</p>\n\n<pre><code>Dim profileFound as Range\nSet profileFound = ActiveSheet.Range(\"B\" &amp; itemnamerow &amp; \":Z\" &amp; itemnamerow).Find(\"PROFILE\",lookIn:=xlValues,MatchCase:=True,lookAt:=xlPart)\n\nIf Not profileFound is nothing Then\n    debug.print profileFound.Value\n    Range(\"C1\").Value = \"it worked\"\nelse\n    debug.print \"no profile found\"\nEnd If\n</code></pre>\n\n<p>The reason your original code is failing is because Excel will not allow you to evaluate a multi-cell range against a single value. You could loop through each cell in the range and check each cell individually, but since <code>Find</code> is available, that is superfluous.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551298745, "post_id": 54913739, "comment_id": 96593986, "body": "The &quot;Item name&quot; search is running fine without any issues. It is just when I go to search for the partial string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "reply_to_user": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551298853, "post_id": 54913739, "comment_id": 96594045, "body": "It may work now but there is no guarantee that it will continue to work. If someone changes the options of a Find on the worksheet your Range.Find inherits those changes. If you insist on using Find then provide enough options that it couldn&#39;t be wrong. Besides, Match is just as fast and you don&#39;t have to memorize a dozen optional arguments."}, {"owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "edited": false, "score": 0, "creation_date": 1551299574, "post_id": 54913739, "comment_id": 96594357, "body": "I will also try this in the near future, but I have not seen that syntax before so it is unfamiliar with me. I started learning VBA 2 days ago so I am fairly new to this, my only prior experience is 2+ years of MatLab."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "is_accepted": false, "score": 3, "last_activity_date": 1551298382, "creation_date": 1551298382, "answer_id": 54913739, "question_id": 54913554, "link": "https://stackoverflow.com/questions/54913554/finding-partial-text-in-full-row/54913739#54913739", "title": "Finding Partial Text In Full Row", "body": "<p>You don't provide enough parameters for the Range.Find operation. Switch to the worksheet's Match to locate <em>Item name</em> then again as a wildcard search to locate <em>profile</em>.</p>\n\n<pre><code>dim m as variant, n as variant\n\nm = application.match(\"Item Name\", range(\"A1:A100\"), 0)\n\nIf not iserror(m) then\n\n    n = application.match(\"*profile*\", cells(m, \"B\").resize(1, 25), 0)\n\n    If not iserror(n) then\n\n        Range(\"C1\").Value = \"it worked \" &amp; cells(m, n+1).value\n\n    end if\n\nend if\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11127155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9247ef6aa2b92d298c79a045e68a2c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Jones", "link": "https://stackoverflow.com/users/11127155/a-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 54913678, "answer_count": 2, "score": 0, "last_activity_date": 1551338453, "creation_date": 1551297514, "last_edit_date": 1551338453, "question_id": 54913554, "link": "https://stackoverflow.com/questions/54913554/finding-partial-text-in-full-row", "title": "Finding Partial Text In Full Row", "body": "<p>I am trying to search an entire row for a string that contains \"PROFILE\". It will always be capitalized, but the format will be, for example \"[9]PROFILE001\". </p>\n\n<p>Some extra information: I have used the Find command to locate the row that I am searching in for the string. It has its own variable that I am trying to incorporate into the range I am using.</p>\n\n<p>I have searched multiple partial string articles on here, and have not been able to implement it into my code. I have tried using the Like command and the IntStr command to no avail. I believe my issue may be with how im referencing the search range or how i am searching.</p>\n\n<p>Here is a snippet of my current code:</p>\n\n<pre><code>'finding item name row\nSet FindRow3 = Range(\"A1:A100\").Find(\"Item Name\", LookIn:=xlValues)\nitemnamerow = FindRow3.Row\n'The section above is working as intended\n\n'searching for the word profile, the section below is the one I am having issues with\nRange(\"B8:Z100\").Style = \"Normal\"\nIf ActiveSheet.Range(\"B\" &amp; itemnamerow &amp; \":Z\" &amp; itemnamerow) Like \"*PROFILE\" Then\n    Range(\"C1\").Value = \"it worked\"\nEnd If\n</code></pre>\n\n<p>I am currently experiencing a run time error 13, type mismatch in the \"If ActiveSheet...\" line. I have not been able to get the correct index to make this correct.</p>\n\n<p>I am trying to use that if the partial string is found, I want do something.</p>\n\n<p>TIA</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1551294673, "post_id": 54912740, "comment_id": 96592151, "body": "You can condense all of this into 1 loop. When you see repeating code, think loop. Looks like you will want to step the <code>check_value</code> by 1 and the sheet name <code>Report</code> by 1. Then you just need 1 macro"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 6, "creation_date": 1551294813, "post_id": 54912740, "comment_id": 96592227, "body": "Also, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">try to avoid Select/Activate</a>."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1551294991, "post_id": 54912740, "comment_id": 96592309, "body": "Also, nothing wrong with multiple macros as limiting scopes can go a long way in departmentalizing code. However, this is the same task, so I would suggest a merge"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1551295236, "post_id": 54912740, "comment_id": 96592404, "body": "@urdearboy - Absolutely I think OP should look in to this.  If they even want to change the column they&#39;re looking in for, say <code>RowCount</code>, they&#39;ll have to edit 10 separate macros.  OP, I highly suggest you look in to Passing a Parameter to a Subroutine."}, {"owner": {"reputation": 305, "user_id": 8160293, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-4aHbnOr08ws/AAAAAAAAAAI/AAAAAAAAAX8/oSyRmcB__gk/photo.jpg?sz=128", "display_name": "Prof. Falken", "link": "https://stackoverflow.com/users/8160293/prof-falken"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1551295764, "post_id": 54912740, "comment_id": 96592647, "body": "@brucewayne This was my bad. I will edit and remove my question."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1551298441, "post_id": 54912740, "comment_id": 96593840, "body": "<code>Call</code> is deprecated. Basically, don&#39;t use <code>Call</code> anymore!"}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 8160293, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-4aHbnOr08ws/AAAAAAAAAAI/AAAAAAAAAX8/oSyRmcB__gk/photo.jpg?sz=128", "display_name": "Prof. Falken", "link": "https://stackoverflow.com/users/8160293/prof-falken"}, "edited": false, "score": 0, "creation_date": 1551446918, "post_id": 54913113, "comment_id": 96654093, "body": "This example code did the help me clean up the code and I wanted to thank you for that. While testing your code to see if it fixed the over all problem I noticed something about the data that your code pointed me to. <code>.Range(&quot;A&quot; &amp; Rows.Count)</code> line needs to have data in cell <code>A1</code> which, once it try to check value for 10, 11, and 12, there is no data in that cell thus terminating the code after it copied one line. I change this to <code>.Range(&quot;I&quot; &amp; Rows.Count)</code> since this is the checked value and will always have data in the cell."}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 2, "last_activity_date": 1551449218, "last_edit_date": 1551449218, "creation_date": 1551295755, "answer_id": 54913113, "question_id": 54912740, "link": "https://stackoverflow.com/questions/54912740/why-does-my-macro-stop-copying-all-row-data-after-a-certain-point/54913113#54913113", "title": "Why does my macro stop copying all row data after a certain point?", "body": "<p>I would bet that the code returning undesirable results has something to do with resetting the <code>To RowCount</code> parameter of your <code>For-Next</code> loop to a different, potentially smaller, value in the middle of the loop. For instance, if <code>Column A</code> of <code>Sheets(\"Report 10\")</code> is empty, then <code>RowCount</code> will be reset to <code>1</code>, thus exiting the loop after the first iteration. Additionally, as @urdearboy mentioned, you could consolidate this into one dynamic loop. I would try something like</p>\n\n<pre><code>Sub Data_Parse_All()\n    Dim i As Long\n    Dim Rowcount As Long\n    Dim PasteRow As Long\n\n    With Sheets(\"Imported_Data\")\n        Rowcount = .Cells(.Cells.Rows.Count, \"I\").End(xlUp).Row\n        For i = 1 To Rowcount\n            If .Range(\"I\" &amp; i) &gt;= 1 And .Range(\"I\" &amp; i) &lt;= 12 Then\n                PasteRow = Sheets(\"Report \" &amp; .Range(\"I\" &amp; i)).Range(\"I\" &amp; Rows.Count).End(xlUp).Row + 1\n                .Range(\"I\" &amp; i).EntireRow.Cut Sheets(\"Report \" &amp; .Range(\"I\" &amp; i)).Range(\"A\" &amp; PasteRow)\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1551298525, "post_id": 54913118, "comment_id": 96593879, "body": "Alternate is to add a parameter to the <code>Sub</code> call, and put the loop in the main code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1551300368, "post_id": 54913118, "comment_id": 96594709, "body": "@AJD - Yeah, that&#39;s what I was also working on but kept the part for OP where it&#39;s a separate self-contained sub. But that&#39;s a great suggestion for OP to work on and learn about passing parameters. :)"}, {"owner": {"reputation": 305, "user_id": 8160293, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-4aHbnOr08ws/AAAAAAAAAAI/AAAAAAAAAX8/oSyRmcB__gk/photo.jpg?sz=128", "display_name": "Prof. Falken", "link": "https://stackoverflow.com/users/8160293/prof-falken"}, "edited": false, "score": 0, "creation_date": 1551446530, "post_id": 54913118, "comment_id": 96653876, "body": "@BruceWayne I was able to consolidate the code as suggested and I wanted to thank for the example code. This helped a lot!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1551296710, "last_edit_date": 1551296710, "creation_date": 1551295775, "answer_id": 54913118, "question_id": 54912740, "link": "https://stackoverflow.com/questions/54912740/why-does-my-macro-stop-copying-all-row-data-after-a-certain-point/54913118#54913118", "title": "Why does my macro stop copying all row data after a certain point?", "body": "<p>I <em>think</em> you can collapse all your <code>Data_Parse_#</code> subs in to a single sub.  This will take the <code>check_value</code> and use that to get the destination worksheet.</p>\n\n<pre><code>Sub data_Parse()\nDim rowCount As Long, i As Long, newRowCount As Long\nDim check_value As String\nDim destSheet As Worksheet\n\n\nWith ThisWorkbook.Sheets(\"Imported_Data\")\n    rowCount = .Cells(Rows.Count, \"I\").End(xlUp).row\n    For i = 1 To rowCount\n        check_value = .Cells(i, \"I\").Value\n        Set destSheet = ThisWorkbook.Sheets(\"Report \" &amp; check_value)\n        newRowCount = destSheet.Cells(Rows.Count, \"A\").End(xlUp).row\n        .Rows(i).EntireRow.Cut\n        destSheet.Range(\"A\" &amp; newRowCount + 1).Paste\n        Application.CutCopyMode = False\n    Next i\nEnd With ' .Sheets(\"Imported_Data\")\nEnd Sub\n</code></pre>\n\n<p>(Edit: I know with <code>.Delete</code>, you should go backwards when looping (<code>For i = rowCount to 1 Step -1</code>), but I'm not sure if that's required with <code>.Cut</code>, so just make sure all rows are accounted for.)</p>\n"}], "owner": {"reputation": 305, "user_id": 8160293, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-4aHbnOr08ws/AAAAAAAAAAI/AAAAAAAAAX8/oSyRmcB__gk/photo.jpg?sz=128", "display_name": "Prof. Falken", "link": "https://stackoverflow.com/users/8160293/prof-falken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 54913113, "answer_count": 2, "score": 0, "last_activity_date": 1551449218, "creation_date": 1551294241, "last_edit_date": 1551296605, "question_id": 54912740, "link": "https://stackoverflow.com/questions/54912740/why-does-my-macro-stop-copying-all-row-data-after-a-certain-point", "title": "Why does my macro stop copying all row data after a certain point?", "body": "<p>I have coded an Excel macro that imports data from a csv file and then copies rows based on a checked value and places the parsed data into separate sheets. I am checking for 12 values and the first 9 work, but once it gets to 10, 11, and 12 the macro only copies 1 row. Is this a problem with my code or is this a limitation of excel? If it is my code, what should I adjust?</p>\n\n<p>Top module:</p>\n\n<pre><code>Sub Import_Parse_Refresh()\n'Import Data CSV\n    Call GetCSVList\n\n'Parse Data Based on Report ID\n    Call Data_Parse_All\n\n'Refresh Each Pivot Table\n    Call TableRefresh\n\n'Delete Imported_Data that was created during the import\n    Sheets(\"Imported_Data\").Delete\n    Sheets(\"Begin\").Delete\n\n'Save File As\n    Call SaveFile\n\nEnd Sub\n</code></pre>\n\n<p>Data_Parse_All module:</p>\n\n<pre><code>Sub Data_Parse_All()\n\n    Call Data_Parse_1\n    Call Data_Parse_2\n    Call Data_Parse_3\n    Call Data_Parse_4\n    Call Data_Parse_5\n    Call Data_Parse_6\n    Call Data_Parse_7\n    Call Data_Parse_8\n    Call Data_Parse_9\n    Call Data_Parse_10\n    Call Data_Parse_11\n    Call Data_Parse_12\n\nEnd Sub\n</code></pre>\n\n<p>Data_Parse_9-this code is used for all 12 Data_Parse_# modules but only 1 through 9 work correctly:</p>\n\n<pre><code>Sub Data_Parse_9()\n'\n    Sheets(\"Imported_Data\").Select\n    RowCount = Cells(Cells.Rows.Count, \"I\").End(xlUp).Row\n    For i = 1 To RowCount\n        Range(\"I\" &amp; i).Select\n        check_value = ActiveCell\n        If check_value = \"9\" Then\n            ActiveCell.EntireRow.Cut\n            Sheets(\"Report 9\").Select\n            RowCount = Cells(Cells.Rows.Count, \"A\").End(xlUp).Row\n            Range(\"A\" &amp; RowCount + 1).Select\n            ActiveSheet.Paste\n            Sheets(\"Imported_Data\").Select\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Data_Parse_10 -The code is the same but this is when only one row is copied</p>\n\n<pre><code>Sub Data_Parse_10()\n'\n' Macro1_Data Macro\n'\n'assuming the data is in sheet1\n    Sheets(\"Imported_Data\").Select\n    RowCount = Cells(Cells.Rows.Count, \"I\").End(xlUp).Row\n    For i = 1 To RowCount\n        Range(\"I\" &amp; i).Select\n        check_value = ActiveCell\n        If check_value = \"10\" Then\n            ActiveCell.EntireRow.Cut\n            Sheets(\"Report 10\").Select\n            RowCount = Cells(Cells.Rows.Count, \"A\").End(xlUp).Row\n            Range(\"A\" &amp; RowCount + 1).Select\n            ActiveSheet.Paste\n            Sheets(\"Imported_Data\").Select\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11019220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e83f2bc7295461dc1f8c791e3353?s=128&d=identicon&r=PG&f=1", "display_name": "Wyntile", "link": "https://stackoverflow.com/users/11019220/wyntile"}, "edited": false, "score": 0, "creation_date": 1551302020, "post_id": 54913179, "comment_id": 96595442, "body": "The VB code itself was making the differentiation even on the mdb version. DAO was only used for database linking, while ActiveX was used for a control only. This error was recieved when someone used it on the mdb file one time, so I was wondering if the outdated form elements/references were the cause of all this. Otherwise updating data via regular textboxes work fine."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 1, "last_activity_date": 1551296045, "creation_date": 1551296045, "answer_id": 54913179, "question_id": 54912629, "link": "https://stackoverflow.com/questions/54912629/does-outdated-references-cause-errors-in-querying-data/54913179#54913179", "title": "Does outdated references cause errors in querying data?", "body": "<p>Since you have both DAO and ADO, your code should always disambiguate, without exceptions. Don't rely on the reference priority to do the right thing for you.</p>\n\n<p>Instead of <code>Dim rs As Recordset</code>, do either <code>Dim rs As DAO.Recordset</code> or <code>Dim rs As ADODB.Recordset</code>.</p>\n\n<p>Also, the fact that MDB is locked and you mention a <code>security.mdw</code>, it sounds like it is using old workgroup security. I would get rid of that (it has no security value nowadays) and update the references. Both DAO and ADO has been updated since; you should be using the latest DAO (now named \"Microsoft Office Access Database Engine Library\") and ADO 6.1.</p>\n"}], "owner": {"reputation": 5, "user_id": 11019220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e83f2bc7295461dc1f8c791e3353?s=128&d=identicon&r=PG&f=1", "display_name": "Wyntile", "link": "https://stackoverflow.com/users/11019220/wyntile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551296045, "creation_date": 1551293822, "question_id": 54912629, "link": "https://stackoverflow.com/questions/54912629/does-outdated-references-cause-errors-in-querying-data", "title": "Does outdated references cause errors in querying data?", "body": "<p>I have a case where there are errors in updating data to tables in MS Access. </p>\n\n<p>On the server file at work, there is a locked database file in MDB format, that cannot be accessed at all unless a shortcut is created adding the security.mdw in its properties path. On that database file holds the form which adds jobs, updates it, and deletes it from both a local table and a table stored through MySQL ODBC Ansi driver. How it does it is not the problem, for whenever I test the functions on both a Windows 10 (which doesn't show error on form open) and a slow Windows 7 computer that's causing \"There is no object in this control\" on form open, they run correctly.</p>\n\n<p>But currently I have a problem stating that using that same locked MDB file, when someone else updated a status of a job, something with updating job data went wrong, as on the website (that shows mysql table data) wrong data shows. On another version of the form function, which is saved as .ACCDB (and editable), I have the following references:</p>\n\n<p>1/ Visual Basic For Applications<br>\n2/ Microsoft Access 16.0 Object Library<br>\n3/ OLE Automation<br>\n4/ Microsoft ActiveX Data Objects 6.1 Library<br>\n5/ Microsoft DAO 3.6 Object Library<br>\n6/ Microsoft Windows Common Controls-2 6.0  <br></p>\n\n<p>While on the locked mdb file the references are...</p>\n\n<p>1/ Visual Basic For Applications<br>\n2/ Microsoft Access 16.0 Object Library <br>\n3/ OLE Automation<br>\n4/ <strong>Microsoft ActiveX Data Objects 2.1 Library</strong><br>\n5/ Microsoft DAO 3.6 Object Library<br> \n6/ Microsoft Excel 16.0 Object Library <br>\n7/ Microsoft Word 16.0 Object Library <br>\n8/ Microsoft Forms 2.0 Object Library<br></p>\n\n<p>Since the mdb file is locked, it cannot even save any changes made to the references list everytime the file is opened. So even when I added the dreaded MSCONCTL.OCX file that is causing the \"There is no object in this control\" on Windows 7 systems, but it's still causing that error.</p>\n\n<p>So my question is as the title states. Would having outdated references cause error in querying data at times?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1551293146, "post_id": 54912322, "comment_id": 96591463, "body": "Workbook doesn&#39;t have a <code>canvasWidth</code> member.  You also need to remove the parens around <code>(Me)</code> - that&#39;s forcing it to be passed <code>ByVal</code>. Finally, <code>customizeCurrentUserForm</code> has to be in a standard module - it can&#39;t be in a document or class module."}, {"owner": {"reputation": 3, "user_id": 2074059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbe2a978efdf936cba5bf067e8047f7?s=128&d=identicon&r=PG", "display_name": "Mustafa Sinasi Erol", "link": "https://stackoverflow.com/users/2074059/mustafa-sinasi-erol"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551293501, "post_id": 54912322, "comment_id": 96591613, "body": "I just removed the paranthesis between ME and it worked. Thanks for the advice. -----------  canvasWidth is a variable I have defined in my main module (Thiswortkbook) and I am using its full name to identify it clearly. It is not meant to be a proterty or method of the workbook. customizeCurrentUserForm is a asub in module2. there is no problem with activating the right module but width can not be assigned."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1551293998, "post_id": 54912322, "comment_id": 96591833, "body": "&quot;canvasWidth is a variable I have defined in my main module (Thiswortkbook)&quot; -- <i>how</i> is it declared then? Use <code>Dim</code> for local variables, <code>Private</code> for private module-scope variables, and <code>Public</code> for public ones. Side note, <code>ByRef userFormName_Send As Object</code> would probably be better off as <code>ByVal form As UserForm</code> -- &quot;userFormName&quot; looks like it&#39;s a <i>name</i> (string), and the underscore-send &quot;_send&quot; makes it look like an event handler; avoid underscores in class names and public members, they will cause compile errors at one point or another. And there is no need to pass it <code>ByRef</code>."}, {"owner": {"reputation": 3, "user_id": 2074059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbe2a978efdf936cba5bf067e8047f7?s=128&d=identicon&r=PG", "display_name": "Mustafa Sinasi Erol", "link": "https://stackoverflow.com/users/2074059/mustafa-sinasi-erol"}, "edited": false, "score": 0, "creation_date": 1551297543, "post_id": 54912322, "comment_id": 96593441, "body": "\u0130t was defined &quot;Public&quot;. Problem was solved by removing () around Me. Now works fine."}], "owner": {"reputation": 3, "user_id": 2074059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbe2a978efdf936cba5bf067e8047f7?s=128&d=identicon&r=PG", "display_name": "Mustafa Sinasi Erol", "link": "https://stackoverflow.com/users/2074059/mustafa-sinasi-erol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551292805, "creation_date": 1551292502, "last_edit_date": 1551292805, "question_id": 54912322, "link": "https://stackoverflow.com/questions/54912322/in-excel-vba-customize-all-userforms-from-a-single-procedure", "title": "In Excel VBA customize all userforms from a single procedure", "body": "<p>I have userforms grouped by similiar properties, which user can change. rather than doing this change in each userform's initialization sub, I want to do this in a sub to shorten the code.</p>\n\n<p>I am getting a 438 error </p>\n\n<p>The called sub and the caller are below. I am getting a run time error 438 and could not resolve it.</p>\n\n<pre><code>Public Sub customizeCurrentUserForm(ByRef userFormName_Send As Object)\n            With userFormName_Send\n                .Width = ThisWorkbook.canvasWidth\n                ...\n                ...\n            End With\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    customizeCurrentUserForm (Me)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551298293, "post_id": 54912288, "comment_id": 96593775, "body": "Please discard <code>On Error GoTo ErrorHandler</code> and all the error handling code.  This type of code is never helpful during development and would require substantial modification to be appropriate for a live system."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551298621, "post_id": 54912288, "comment_id": 96593935, "body": "You are not checking emails on startup.  You are creating an event handler at startup.  That event handler (<code>inboxItems_ItemAdd</code>) is activated whenever a new email arrives in your default Inbox.  This may seem picky but code to check existing emails on startup would be very different."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1551298716, "post_id": 54912288, "comment_id": 96593974, "body": "Your question implies something is not working as you wish but you do not tell us what is going wrong."}, {"owner": {"reputation": 71, "user_id": 5191630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f673fcc8f409eb26f10c5dc8ab207f79?s=128&d=identicon&r=PG&f=1", "display_name": "YASPLS", "link": "https://stackoverflow.com/users/5191630/yaspls"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551307090, "post_id": 54912288, "comment_id": 96597471, "body": "@TonyDallimore At the time that I open up Outlook, would the system not recognize any emails received since my last session as &quot;new emails&quot; and run the macro? If not I guess I&#39;ll have to look into that as well. As far as what the problem is with the code right now. I&#39;m not really sure and don&#39;t really know how to test it either. The only thing I really know at this point is that the code is not placing the attachments into the network folder as it should be."}, {"owner": {"reputation": 71, "user_id": 5191630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f673fcc8f409eb26f10c5dc8ab207f79?s=128&d=identicon&r=PG&f=1", "display_name": "YASPLS", "link": "https://stackoverflow.com/users/5191630/yaspls"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551307571, "post_id": 54912288, "comment_id": 96597653, "body": "@TonyDallimore Thanks for the note about the error handling, I&#39;ve removed all the relevant code."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551307947, "post_id": 54912288, "comment_id": 96597765, "body": "My concern was the expression &quot;... check all my emails on startup ...&quot; rather than &quot;... check all my <b>new emails</b> on startup ...&quot;.  There are four distinct ways of selecting emails for processing.  (1) Process emails selected by user. (2) Check every email in a folder and process as appropriate. (3) Process emails selected by a rule.  (4) Use an event to select every new email and process as appropriate.  Yes, emails which reached the server since you last closed Outlook are new.  I have encountered people who think they can mixed (2) and (4) and was concerned that was what you thought."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551308035, "post_id": 54912288, "comment_id": 96597797, "body": "I am please you have removed the error handling.  Do you understand why I think it is bad practice?"}, {"owner": {"reputation": 71, "user_id": 5191630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f673fcc8f409eb26f10c5dc8ab207f79?s=128&d=identicon&r=PG&f=1", "display_name": "YASPLS", "link": "https://stackoverflow.com/users/5191630/yaspls"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551373873, "post_id": 54912288, "comment_id": 96626214, "body": "@TonyDallimore Thank you for the clarification. As long as it checks all the new emails I&#39;m happy :)"}, {"owner": {"reputation": 71, "user_id": 5191630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f673fcc8f409eb26f10c5dc8ab207f79?s=128&d=identicon&r=PG&f=1", "display_name": "YASPLS", "link": "https://stackoverflow.com/users/5191630/yaspls"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1551373904, "post_id": 54912288, "comment_id": 96626230, "body": "@TonyDallimore To be honest I don&#39;t understand why, as of right now I&#39;m just trying to figure out why the macros does not work as expected."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5191630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f673fcc8f409eb26f10c5dc8ab207f79?s=128&d=identicon&r=PG&f=1", "display_name": "YASPLS", "link": "https://stackoverflow.com/users/5191630/yaspls"}, "edited": false, "score": 0, "creation_date": 1560880884, "post_id": 54933532, "comment_id": 99879292, "body": "Thank you Tony! You guesses right that the error was coming from the fact that my Outlook store was not the default one. I learned a lot from this post, thanks again!"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 2, "last_activity_date": 1551400804, "last_edit_date": 1551400804, "creation_date": 1551384713, "answer_id": 54933532, "question_id": 54912288, "link": "https://stackoverflow.com/questions/54912288/save-attachments-from-new-email/54933532#54933532", "title": "Save Attachments From New Email", "body": "<p>Your code does not work for me because of:</p>\n\n<p><code>Set inboxItems = objectNS.GetDefaultFolder(olFolderInbox).Items</code></p>\n\n<p>Outlook saves mail items, calendar items, tasks and other such information in files it calls <strong>Stores</strong>.  You can have several stores each of which will have an Inbox.  I am a home user with two email accounts.  I did a default installation of Outlook then used a wizard to add an account for each of my email addresses.  The result is I had three stores:</p>\n\n<ul>\n<li>Outlook Data File</li>\n<li>MyName@myisp.com</li>\n<li>MyName@gmail.com</li>\n</ul>\n\n<p>\u201cOutlook Data File\u201d is the default store and contains the default Inbox but new emails are placed in the Inboxes in the other two stores.  To test if you have the same problem, open Outlook, open the VBA Editor, type the following into your Immediate Window and press [Return].</p>\n\n<pre><code>    ? Session.GetDefaultFolder(olFolderInbox).Parent.Name\n</code></pre>\n\n<p>On my system, this statement outputs \u201cOutlook Data File\u201d because that store contains the default Inbox.  If I want to have an event handler for new emails I need to have:</p>\n\n<pre><code>Private Sub Application_Startup()\n  Set InboxItems = Session.Folders(\"MyName@myisp.com\").Folders(\"Inbox\").Items\nEnd Sub\n</code></pre>\n\n<p>This is someone shorter than your macro, which I will explain later, but the key difference is I am naming the Inbox I wish to monitor.  If the Inbox that receives your new emails is not Outlook\u2019s default Inbox, you will have to name the folder containing the Inbox you wish to monitor.</p>\n\n<p>Why is my macro so much shorter than yours?</p>\n\n<pre><code> Dim outlookApp As Outlook.Application\n Set outlookApp = Outlook.Application\n</code></pre>\n\n<p>You are already within Outlook so these statements are redundant.</p>\n\n<p>You could replace:</p>\n\n<pre><code>Set objectNS = outlookApp.GetNamespace(\"MAPI\")\n</code></pre>\n\n<p>by </p>\n\n<pre><code>Set objectNS = Application.GetNamespace(\"MAPI\")\n</code></pre>\n\n<p>But you do not have to.  The only <code>GetNamespace</code> is under <code>Application</code> so the qualification is optional.  The only qualification that I know to be non-optional is <code>Outlook.Folder</code> and <code>Scripting.Folder</code>.  If you write <code>Folder</code> within Outlook it assumes you want one of its folders.  If you want to refer to a disk folder you must say so.</p>\n\n<p>You have:</p>\n\n<pre><code>Dim objectNS As Outlook.NameSpace\nSet objectNS = outlookApp.GetNamespace(\"MAPI\")\n</code></pre>\n\n<p>I have used <code>Session</code>.  The documentation states that <code>Namespace</code> and <code>Session</code> are identical.  I prefer <code>Session</code> but most people seem to prefer <code>Namespace</code>.  Your choice.</p>\n\n<p>If you are references the correct Inbox, we need to look further for the cause of your problem.</p>\n\n<p>The next possible issue is <code>If Item.Subject = \"Sample Daily Data Pull\"</code>.  This requires <code>Item.Subject</code> be exactly equal to <code>\"Sample Daily Data Pull\"</code>.  An extra space or a lower case letter and they are not equal.</p>\n\n<p>Next, I suggest adding a statement at the top of each of procedure to give:</p>\n\n<pre><code>Private Sub Application_Startup()\nDebug.Assert False\n  :    :    :\nPrivate Sub inboxItems_ItemAdd(ByVal Item As Object)\nDebug.Assert False\n  :    :    :\nPublic Sub SaveAttachmentsToDisk(MItem As Outlook.MailItem)\nDebug.Assert False\n  :    :    :\n</code></pre>\n\n<p>Many programming languages have an <strong>Assertion statement</strong>; this is VBA\u2019s version.  It allows the programmer to assert that something will be true.  Execution will stop if the assertion is false.  I find <code>Debug.Assert False</code> invaluable during testing.  <code>Debug.Assert False</code> will always be false so execution will always stop.  This is an easy way to test that <code>Application_Startup</code>, <code>inboxItems_ItemAdd</code> and <code>SaveAttachmentsToDisk</code> are being executed.</p>\n\n<p>Try the above suggestions.  If they fail to find a problem, we will have to try something else.</p>\n\n<p><strong>Error Handling</strong></p>\n\n<p>In your original posting, you had: </p>\n\n<pre><code>On Error GoTo ErrorHandler\n     :        :       :\n\n     :        :       :\n\nExitNewItem:\n    Exit Sub\nErrorHandler:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n</code></pre>\n\n<p>You will often see code like this but I have never seen a justification for it.</p>\n\n<p>If an error occurs during development, this code will result in the error number and description being displayed and the routine exited.  How is this helpful?  It leaves you to guess from the error description which statement failed.  If you omit all the error code, execution stops on the faulty statement.  There is no guessing as to which statement was in error.  If you can fix the error, you can click F5 and restart with the previously faulty statement.  Even if you cannot fix and restart, you have a better understanding of the situation.</p>\n\n<p>For a live system, I have difficulty in imagining anything less user friendly than an error resulting in display of a cryptic error message and the macro terminating.</p>\n\n<p>For a live system, you want something like:</p>\n\n<pre><code>Dim ErrNum As Long\nDim ErrDesc As String\n\nOn Error Resume Next\nStatement that might fail\nErrNum = Err.Num\nErrDesc = Err.Description\nOn Error GoTo 0\nIf ErrNum &gt; 0 Then\n  ' For each possible value for ErrNum, code to provide user friendly\n  ' description of what has gone wrong and how to fix it.\nEnd If\n</code></pre>\n\n<p>VBA is not the ideal language for writing code that fails gracefully but with care you can create some very acceptable error handling code.</p>\n"}], "owner": {"reputation": 71, "user_id": 5191630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f673fcc8f409eb26f10c5dc8ab207f79?s=128&d=identicon&r=PG&f=1", "display_name": "YASPLS", "link": "https://stackoverflow.com/users/5191630/yaspls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 54933532, "answer_count": 1, "score": 1, "last_activity_date": 1592689176, "creation_date": 1551292367, "last_edit_date": 1592689176, "question_id": 54912288, "link": "https://stackoverflow.com/questions/54912288/save-attachments-from-new-email", "title": "Save Attachments From New Email", "body": "<p>I'm trying to use Outlook VBA to check all my emails on startup, and whenever I receive a new email, to see if the email subject is \"Sample Daily Data Pull\". If the email subject matches, I want outlook to save the attachment to a specified network drive folder. Here is the code I have:</p>\n\n<p>In \"ThisOutlookSession\"</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents inboxItems As Outlook.Items\nPrivate Sub Application_Startup()\n  Dim outlookApp As Outlook.Application\n  Dim objectNS As Outlook.NameSpace\n  Set outlookApp = Outlook.Application\n  Set objectNS = outlookApp.GetNamespace(\"MAPI\")\n  Set inboxItems = objectNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub inboxItems_ItemAdd(ByVal Item As Object)\nDim Msg As Outlook.MailItem\nIf TypeName(Item) = \"MailItem\" Then\n    If Item.Subject = \"Sample Daily Data Pull\" Then\n    Call SaveAttachmentsToDisk\n    Else\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I also have the following code in a module:</p>\n\n<pre><code>Public Sub SaveAttachmentsToDisk(MItem As Outlook.MailItem)\nDim oAttachment As Outlook.Attachment\nDim sSaveFolder As String\n\nsSaveFolder = \"N:\\SampleFilePath\\\"\nFor Each oAttachment In MItem.Attachments\noAttachment.SaveAsFile sSaveFolder &amp; oAttachment.DisplayName\nNext\nEnd Sub\n</code></pre>\n\n<p>This is my first time working in Outlook VBA, so my apologies if it's something very basic and obvious. Not really sure what is going wrong as I'm not getting any error messages. All I know is that the the macro is not saving attachments on my network drive as it should be.</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1551292546, "post_id": 54911911, "comment_id": 96591174, "body": "@Tim Williams i m totally agree with your answer but i have to suggest something which will make the code more structure - stable. Is it better to declare both workbook &amp; worksheet? For example: <b>Left(Thisworkbook.Worksheets(&quot;Sheet1&quot;).Cells(i, 16).Value, 3))</b>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1551292779, "post_id": 54911911, "comment_id": 96591277, "body": "@Error1004 - yes it would be better, but I&#39;m not always going to cover &quot;best practices&quot;.  Sometimes I just answer the specific question."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1551293743, "post_id": 54911911, "comment_id": 96591715, "body": "@TimWilliams thanks for the clarification. You absolutely cover me."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1551292650, "last_edit_date": 1551292650, "creation_date": 1551290923, "answer_id": 54911911, "question_id": 54911874, "link": "https://stackoverflow.com/questions/54911874/using-left-function-as-part-of-a-loop-vba/54911911#54911911", "title": "Using Left Function as part of a loop - VBA", "body": "<pre><code>Left(Cells(i, 16), 3).Value\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Left(Cells(i, 16).Value, 3)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 54911911, "answer_count": 1, "score": -2, "last_activity_date": 1551292650, "creation_date": 1551290785, "question_id": 54911874, "link": "https://stackoverflow.com/questions/54911874/using-left-function-as-part-of-a-loop-vba", "title": "Using Left Function as part of a loop - VBA", "body": "<p>I have a functioning loop and needed to use the LEFT function as part of the conditions set. </p>\n\n<pre><code>If Cells(i, 4).Value = \"Active\" And (Cells(i, 16).Value = \"\" Or Left(Cells(i, 16), 3).Value = \"TBD\") Then\n</code></pre>\n\n<p>I hit an error with the above line stating \"OBJECT REQUIRED.\"</p>\n\n<p>This is the full loop: </p>\n\n<pre><code>i = 2\n\nFor i = 2 To lastrow\n\n'(Left(cellVal, 4) = \"Name\")\n\nIf Cells(i, 4).Value = \"Active\" And (Cells(i, 16).Value = \"\" Or Left(Cells(i, 16), 3).Value = \"TBD\") Then\n    Cells(i, 17).Interior.ColorIndex = 12\nEnd If\n\nNext i\n</code></pre>\n\n<p>Not sure what I'm doing wrong?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 3, "creation_date": 1551290764, "post_id": 54911775, "comment_id": 96590315, "body": "Remove <code>On Error Resume Next</code> which is suppressing your errors and rerun. I anticipate you will get an error then that should help debug this."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1551296922, "post_id": 54911775, "comment_id": 96593176, "body": "Almost gaurantee that once you remove <code>On Error Resume Next</code> you are going to find the error on this line: <code>.Attachments.Add ActiveWorkbook.FullName</code>. You are asking vba to attachment the same workbook its running code in, which is probably causing it to trip up. You may need to save a copy of the workbook and attach that file instead."}], "answers": [{"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1551298237, "last_edit_date": 1551298237, "creation_date": 1551297429, "answer_id": 54913522, "question_id": 54911775, "link": "https://stackoverflow.com/questions/54911775/sending-an-email-through-a-vba-macro-excel/54913522#54913522", "title": "Sending an Email through a VBA macro (Excel)", "body": "<p>Please remove <code>.From = \"example@email.com\"</code>\nMail will go with attachment from outlook default mail address.\nIn Microsoft Documentation <code>From</code> is not listed while <code>To, cc, BCC</code> etc are included . So syntax wise it is wrong. It works for me after removing <code>.From</code></p>\n\n<blockquote>\n  <p>You can see from list below</p>\n</blockquote>\n\n<pre><code>Methods\nProperties\nActions\nAlternateRecipientAllowed\nApplication\nAttachments\nAutoForwarded\nAutoResolvedWinner\nBCC\nBillingInformation\nBody\nBodyFormat\nCategories\nCC\nClass\nCompanies\nConflicts\nConversationID\nConversationIndex\nConversationTopic\nCreationTime\nDeferredDeliveryTime\nDeleteAfterSubmit\nDownloadState\nEntryID\nExpiryTime\nFlagRequest\nFormDescription\nGetInspector\nHTMLBody\nImportance\nInternetCodepage\nIsConflict\nIsMarkedAsTask\nItemProperties\nLastModificationTime\nMarkForDownload\nMessageClass\nMileage\nNoAging\nOriginatorDeliveryReportRequested\nOutlookInternalVersion\nOutlookVersion\nParent\nPermission\nPermissionService\nPermissionTemplateGuid\nPropertyAccessor\nReadReceiptRequested\nReceivedByEntryID\nReceivedByName\nReceivedOnBehalfOfEntryID\nReceivedOnBehalfOfName\nReceivedTime\nRecipientReassignmentProhibited\nRecipients\nReminderOverrideDefault\nReminderPlaySound\nReminderSet\nReminderSoundFile\nReminderTime\nRemoteStatus\nReplyRecipientNames\nReplyRecipients\nRetentionExpirationDate\nRetentionPolicyName\nRTFBody\nSaved\nSaveSentMessageFolder\nSender\nSenderEmailAddress\nSenderEmailType\nSenderName\nSendUsingAccount\nSensitivity\nSent\nSentOn\nSentOnBehalfOfName\nSession\nSize\nSubject\nSubmitted\nTaskCompletedDate\nTaskDueDate\nTaskStartDate\nTaskSubject\nTo\nToDoTaskOrdinal\nUnRead\nUserProperties\nVotingOptions\nVotingResponse\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7585886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d0f98734ca0097645a83d6532fd3969?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; Sim&#245;es", "link": "https://stackoverflow.com/users/7585886/andr%c3%a9-sim%c3%b5es"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592690633, "creation_date": 1551290453, "last_edit_date": 1592690633, "question_id": 54911775, "link": "https://stackoverflow.com/questions/54911775/sending-an-email-through-a-vba-macro-excel", "title": "Sending an Email through a VBA macro (Excel)", "body": "<p>I've spent the last couple days trying to figure this out, I've managed to stop all the errors, however the email doesn't show up in my inbox. I've tried to change everything up and still it doesn't show up.\nThe main purpose is to send an entire workbook to an email with a button (I've binded the button to the macro)\nAnyways, here's the code I have already</p>\n\n<pre><code>Sub Send_mail()\nDim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .To = \"example@email.com\"\n        .From = \"example@email.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Assunto\"\n        .Body = \"Corpo\"\n        .Attachments.Add ActiveWorkbook.FullName\n        .Send\n\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>(ps I did change the email to post this, it's not what I have in the code)</p>\n"}, {"tags": ["excel", "vba", "random"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1551290590, "post_id": 54911735, "comment_id": 96590234, "body": "What happens if you try moving the <code>Randomize</code> call outside the loops? After you declare your variables, and before the first loop."}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1551291097, "post_id": 54911735, "comment_id": 96590499, "body": "Thanks for your reply, just tried now only get about 300 duplicates, why was that?"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1551291531, "post_id": 54911735, "comment_id": 96590663, "body": "No problem! Easy mistake to make when working with random values. I added the &#39;why&#39; as an answer."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1551298865, "post_id": 54911735, "comment_id": 96594051, "body": "Thinking object oriented: Put your numbers in a collection, instead of an array. Then you can set your random pick from <code>Collection.Count</code> and remove the item without having to <code>ReDim</code> etc. Nor will you have to do complicated checks because you know that each pick will be unique. This is not an answer to your OP question, so just added as a comment."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1551327366, "post_id": 54912060, "comment_id": 96602260, "body": "So if seed value is omitted, what format is the system time? For example, if it is 2019-02-27 10:55:28 PM returned by the VBA function Now, if I were to input a time as seed manually, what format would it be? Also other than time, what can be used as seed? Numbers only? And in order to best mimic True random number generator, how to use Randomize with Rnd? Should I assign some seed to Randomize, or just use system time by default?"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1551360083, "post_id": 54912060, "comment_id": 96617927, "body": "@Passer-by Calling Randomize doesn&#39;t make your values any more random in the sense that you&#39;re thinking. It makes your values more or less <i>repeatable</i>. If you got rid of it entirely, your program would behave exactly the same way it does now. The difference being, because Rnd uses the last value generated as its input seed, if someone knew one of your random values, they would be able to generate the same list of every random value after that one. Use Randomize with a given seed if you want to be able to repeat your random sequence, and use it with the default system time if you don&#39;t."}], "tags": [], "owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "is_accepted": false, "score": 1, "last_activity_date": 1551291488, "creation_date": 1551291488, "answer_id": 54912060, "question_id": 54911735, "link": "https://stackoverflow.com/questions/54911735/questions-when-trying-to-simulate-lottery-draws-draw-numbers-without-putting-ba/54912060#54912060", "title": "Questions when trying to simulate lottery draws (draw numbers without putting back) using Excel VBA", "body": "<p>Random numbers in VBA (and in pretty much every language) aren't actually random; they're pseudo-random. Software can't pull random numbers from thin air, they have to come from some algorithm; that algorithm needs some input value. The input value to a random number generator is called a seed. A random number algorithm will always generate the same 'random' value for a given input seed.</p>\n\n<p>If you look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/randomize-statement\" rel=\"nofollow noreferrer\">documentation for Randomize</a>, if you don't supply a seed value, it gets it from the system time. Since the loops are happening very quickly, the system time ends up being the same for some iterations, and Randomize just sets the seed exactly the same as it did in the last loop.</p>\n\n<p>So, you just want to call the Randomize function once, at the start of your program, instead of during every loop. This ensures that your overall outcome is random (if the Randomize function is not called, <code>Rnd</code> uses the value last returned from <code>Rnd</code> as its input seed.)</p>\n"}], "owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551338336, "creation_date": 1551290268, "last_edit_date": 1551338336, "question_id": 54911735, "link": "https://stackoverflow.com/questions/54911735/questions-when-trying-to-simulate-lottery-draws-draw-numbers-without-putting-ba", "title": "Questions when trying to simulate lottery draws (draw numbers without putting back) using Excel VBA", "body": "<p>I was trying to simulate the 649 lottery draw using VBA subroutine.\nFor the lottery draw, six balls will be selected by ball machine, in the beginning there are 49 balls, each with a 1/49 probability of being selected, and after the first ball was selected, the rest 48 balls will then each have a 1/48 probability of being selected, and so on.</p>\n\n<p>There is no direct VBA function to generate random numbers such that the interval is not consecutive; for instance, the first number selected is 3, and for the second number selection, 3 will not be available! So computer has to choose from 1, 2, 4, ..., 49.</p>\n\n<p>Below is a subroutine I wrote, basically I used Int((UBound(array) - 1 + 1) * Rnd + 1) to first generate random number between integer intervals, but I treat the random number only as index; for example, for the second number selection where I have the above 48 number left: 1, 2, 4, ..., 49,  now if the random number is 3 (chosen from between 1 to 48), I actually get 4 for the second number selection because it's the 3rd in the list. And Rnd() provides draw from uniform distribution, so each number is equally likely. This is the method I use to get around.</p>\n\n<p>Then I record all previous selected numbers into s1 to s6, and then make them non-repetitive in the subsequent number selection.</p>\n\n<p>At last I sort using a quicksort algorithm found at <a href=\"https://stackoverflow.com/questions/152319/vba-array-sort-function\">VBA array sort function?</a> with slight modification to the input array. And output results on an empty worksheet.</p>\n\n<p>I also used Randomize to increase randomness. So everything seems good, I'm mimicking exactly the ball machine does: select the first number, then the second... and at last the sixth, without putting back (non-repetitive), the only difference I think would be ball machine is True random number, whereas VBA is Pseudo random number.</p>\n\n<p>To my surprise, for 100,000 simulations, I used the Remove Duplicates and then 79994 duplicate values found and removed; 20006 unique values remain. Now I feel it is not reliable. How could most draws have duplicates? Tried many time but same thing, lots of duplicates. I'm not sure where has gone wrong, if something wrong with this design and logic, or it's just because Pseudo random number? Thank you all!</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Public k As Long\n\nSub RNG()\n\nDim NUMBER(), SELECTION(1 To 100000, 1 To 6)\nDim i As Integer, j As Integer, n As Integer\nDim s1 As Integer, s2 As Integer, s3 As Integer, s4 As Integer, s5 As Integer, s6 As Integer\n\nFor k = 1 To 100000\n    Erase NUMBER\n    ReDim NUMBER(1 To 49)\n    For i = 1 To 49\n        NUMBER(i) = i\n    Next i\n\n    For j = 1 To 6\n        'generate random number as index and select number based on index\n        Randomize\n        random_number = Int((UBound(NUMBER) - 1 + 1) * Rnd + 1)\n        SELECTION(k, j) = NUMBER(random_number)\n        'record each selection\n        Select Case j\n            Case Is = 1\n                s1 = SELECTION(k, j)\n            Case Is = 2\n                s2 = SELECTION(k, j)\n            Case Is = 3\n                s3 = SELECTION(k, j)\n            Case Is = 4\n                s4 = SELECTION(k, j)\n            Case Is = 5\n                s5 = SELECTION(k, j)\n            Case Is = 6\n                s6 = SELECTION(k, j)\n        End Select\n\n        'recreate number 1 to 49 by excluding already-selected numbers\n        Erase NUMBER\n        ReDim NUMBER(1 To 49 - j)\n\n        n = 0\n        For i = 1 To 49\n            Select Case j\n                Case Is = 1\n                    If i &lt;&gt; s1 Then\n                        n = n + 1\n                        NUMBER(n) = i\n                    End If\n\n                Case Is = 2\n                    If i &lt;&gt; s1 And i &lt;&gt; s2 Then\n                        n = n + 1\n                        NUMBER(n) = i\n                    End If\n\n                Case Is = 3\n                    If i &lt;&gt; s1 And i &lt;&gt; s2 And i &lt;&gt; s3 Then\n                        n = n + 1\n                        NUMBER(n) = i\n                    End If\n\n                Case Is = 4\n                    If i &lt;&gt; s1 And i &lt;&gt; s2 And i &lt;&gt; s3 And i &lt;&gt; s4 Then\n                        n = n + 1\n                        NUMBER(n) = i\n                    End If\n\n                Case Is = 5\n                    If i &lt;&gt; s1 And i &lt;&gt; s2 And i &lt;&gt; s3 And i &lt;&gt; s4 And i &lt;&gt; s5 Then\n                        n = n + 1\n                        NUMBER(n) = i\n                    End If\n\n            End Select\n        Next i\n    Next j\n\n    Call QuickSort(SELECTION, 1, 6)\n\nNext k\n\nRange(\"A1:F\" &amp; k - 1).Value = SELECTION\n\nEnd Sub\n\n\nPublic Sub QuickSort(vArray As Variant, inLow As Long, inHi As Long)\n'https://stackoverflow.com/questions/152319/vba-array-sort-function\n\n  Dim pivot   As Variant\n  Dim tmpSwap As Variant\n  Dim tmpLow  As Long\n  Dim tmpHi   As Long\n\n  tmpLow = inLow\n  tmpHi = inHi\n\n  pivot = vArray(k, (inLow + inHi) \\ 2)\n\n  While (tmpLow &lt;= tmpHi)\n  While (vArray(k, tmpLow) &lt; pivot And tmpLow &lt; inHi)\n    tmpLow = tmpLow + 1\n  Wend\n\n  While (pivot &lt; vArray(k, tmpHi) And tmpHi &gt; inLow)\n    tmpHi = tmpHi - 1\n  Wend\n\n  If (tmpLow &lt;= tmpHi) Then\n    tmpSwap = vArray(k, tmpLow)\n    vArray(k, tmpLow) = vArray(k, tmpHi)\n    vArray(k, tmpHi) = tmpSwap\n    tmpLow = tmpLow + 1\n    tmpHi = tmpHi - 1\n End If\nWend\n\nIf (inLow &lt; tmpHi) Then QuickSort vArray, inLow, tmpHi\nIf (tmpLow &lt; inHi) Then QuickSort vArray, tmpLow, inHi\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 405, "user_id": 1596512, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3a8feb162c8a1c11797be45b89e73abb?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1596512/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1551299279, "creation_date": 1551299279, "answer_id": 54913956, "question_id": 54911729, "link": "https://stackoverflow.com/questions/54911729/excel-queries-vba-refresh-and-wait/54913956#54913956", "title": "Excel Queries - VBA Refresh and Wait", "body": "<p>I changed all of my queries to NOT run in the background.  That made them all synchronous. problem solved.</p>\n"}], "owner": {"reputation": 405, "user_id": 1596512, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3a8feb162c8a1c11797be45b89e73abb?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1596512/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551338319, "creation_date": 1551290249, "last_edit_date": 1551338319, "question_id": 54911729, "link": "https://stackoverflow.com/questions/54911729/excel-queries-vba-refresh-and-wait", "title": "Excel Queries - VBA Refresh and Wait", "body": "<p>I have a workbook with about 10 queries in it.  I am refreshing multiple queries through VBA no problem.</p>\n\n<p>One query (really more of a transform) - takes the data from one of the above queries [Let's say Query A] and transforms/calculates.  Which means I need to do the following:</p>\n\n<ol>\n<li>Run Query A</li>\n<li>Wait for Query A to Complete</li>\n<li>Run Transform Query</li>\n</ol>\n\n<p>I can't seem to get them to time properly... is there a way to create an event to trigger the completion of Query A?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551289093, "post_id": 54911251, "comment_id": 96589509, "body": "Why aren&#39;t you using the Range.Autofilter method?"}, {"owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551291554, "post_id": 54911251, "comment_id": 96590676, "body": "@SJR Using the Range.Autofilter method would require devoting code to figuring out what the range is every time. It seems redundant since the filter already exists. Excel must have it&#39;s range stored in memory somewhere. I&#39;m trying to manipulate the existing filter rather than create a new one in the same place every time."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551293855, "post_id": 54911251, "comment_id": 96591770, "body": "Another approach <a href=\"https://stackoverflow.com/questions/35695901/auto-filter-sort-in-vba\" title=\"auto filter sort in vba\">stackoverflow.com/questions/35695901/auto-filter-sort-in-vba</a>"}, {"owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551299829, "post_id": 54911251, "comment_id": 96594472, "body": "Yes, I know how to turn off the current filter and apply a new one. I don&#39;t want to do that unless absolutely necessary. I&#39;m trying to find a more elegant, less redundant solution."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1551349321, "post_id": 54911251, "comment_id": 96611495, "body": "Turn your range into a List. Much easier"}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "edited": false, "score": 0, "creation_date": 1551448585, "post_id": 54923274, "comment_id": 96655050, "body": "Perfect. Thank you!"}], "tags": [], "owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "is_accepted": true, "score": 1, "last_activity_date": 1551349613, "last_edit_date": 1551349613, "creation_date": 1551349081, "answer_id": 54923274, "question_id": 54911251, "link": "https://stackoverflow.com/questions/54911251/vba-filtering-and-sorting-a-pre-existing-autofilter-range/54923274#54923274", "title": "VBA: Filtering and Sorting a pre-existing Autofilter range", "body": "<p><strong>You may use any cellrange, even one without the range of the already defined autofilter.</strong></p>\n\n<pre><code>Option Explicit\n\nSub add_filter_2_existing_autofilter()\nDim FilterRange As Range\n\n    ThisWorkbook.Sheets(\"Music\").Select\n\n    'ShowAllData - error if no filter is set\n    On Error Resume Next\n    ActiveSheet.ShowAllData\n    On Error GoTo 0\n\n    'These do not work\n    'ThisWorkbook.Sheets(\"Music\").AutoFilter Field:=5, Criteria1:=\"Rock\"\n    'ThisWorkbook.Sheets(\"Music\").FilterRange.AutoFilter Field:=5, Criteria1:=\"Rock\", Operator:=xlFilterValues\n\n    Set FilterRange = Sheets(\"Music\").AutoFilter.Range\n    FilterRange.AutoFilter Field:=5, Criteria1:=\"Rock\", Operator:=xlFilterValues\n\n    'OR one of the following equivalents, which also work:\n    'ThisWorkbook.Sheets(\"Music\").Range(FilterRange.Address).AutoFilter Field:=3, Criteria1:=\"Rock\", Operator:=xlFilterValues\n    'ThisWorkbook.Sheets(\"Music\").Range(\"A1\").AutoFilter Field:=5, Criteria1:=\"Rock\", Operator:=xlFilterValues\n    'ThisWorkbook.Sheets(\"Music\").Range(\"A1000\").AutoFilter Field:=5, Criteria1:=\"Rock\", Operator:=xlFilterValues\n    'ThisWorkbook.Sheets(\"Music\").Range(\"XFD1\").AutoFilter Field:=5, Criteria1:=\"Rock\", Operator:=xlFilterValues\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 2840125, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2bde837f305389bacba59d4c777a3197?s=128&d=identicon&r=PG&f=1", "display_name": "Kes Perron", "link": "https://stackoverflow.com/users/2840125/kes-perron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 769, "favorite_count": 0, "accepted_answer_id": 54923274, "answer_count": 1, "score": 0, "last_activity_date": 1551349613, "creation_date": 1551288571, "question_id": 54911251, "link": "https://stackoverflow.com/questions/54911251/vba-filtering-and-sorting-a-pre-existing-autofilter-range", "title": "VBA: Filtering and Sorting a pre-existing Autofilter range", "body": "<p>Say I have an Excel worksheet which contains information about my music collection. I've written 2 macros: the first sorts the list by artist, album, and track number, and the second sorts the list by genre and song title. Here's what the macros look like:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Music\").ShowAllData\nWith ThisWorkbook.Sheets(\"Music\").AutoFilter.Sort\n    .SortFields.Clear\n    .SortFields.Add Range(\"A:A\"), xlSortOnValues, xlAscending, , xlSortNormal\n    .SortFields.Add Range(\"B:B\"), xlSortOnValues, xlAscending, , xlSortNormal\n    .SortFields.Add Range(\"C:C\"), xlSortOnValues, xlAscending, , xlSortNormal\n    .Header = xlYes\n    .MatchCase = False\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>I want to add a line which filters a specific genre, like this:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Music\").AutoFilter Field:=5, Criteria1:=\"Rock\"\n</code></pre>\n\n<p>This line doesn't work because the Worksheet.AutoFilter method doesn't accept the same arguments as the Range.Autofilter method. Does anyone know a way around this that doesn't involve turning the filter off, figuring out the data range, applying a new filter, and then sorting that?</p>\n"}, {"tags": ["excel", "vba", "save-as"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1551287514, "post_id": 54910785, "comment_id": 96588718, "body": "First, I would start by getting rid of every instance of <code>.Select</code> &amp; .<code>Activate</code>. These are middle man operators here and should be, <i>as they say</i>, cut out"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 3, "creation_date": 1551287523, "post_id": 54910785, "comment_id": 96588723, "body": "I would very highly recommend getting rid of <code>On Error Resume Next</code> in all of your code and handling your errors appropriately with an error handler. This will be an absolute nightmare for you (and anyone else) to troubleshoot if you can&#39;t pinpoint what is causing the error."}, {"owner": {"reputation": 1, "user_id": 9479467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c759463a1d45e274c09b93fd55647e04?s=128&d=identicon&r=PG&f=1", "display_name": "DrewBerg", "link": "https://stackoverflow.com/users/9479467/drewberg"}, "reply_to_user": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1551296624, "post_id": 54910785, "comment_id": 96593016, "body": "@TateGarringer thanks man, I did not take that out when I had turned the alerts to true... I will troubleshoot with that in mind. @ urdearboy could you elaborate on what I should do instead? I&#39;m capable of googing to figure it out but would like to hear what command you would utilize"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1551296902, "post_id": 54910785, "comment_id": 96593162, "body": "I imagine @urdearboy would&#39;ve linked <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\">this</a> for the purpose of avoiding <code>Select</code> and <code>Activate</code>. Let us know what you find after you run it without suppressing the errors and we&#39;ll be able to be more helpful to you."}, {"owner": {"reputation": 1, "user_id": 9479467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c759463a1d45e274c09b93fd55647e04?s=128&d=identicon&r=PG&f=1", "display_name": "DrewBerg", "link": "https://stackoverflow.com/users/9479467/drewberg"}, "reply_to_user": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1551297733, "post_id": 54910785, "comment_id": 96593510, "body": "@TateGarringer thanks a ton dude! This is something my team is going to be relying on me heavily for an I want to get it as efficient as possible"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551338022, "post_id": 54910785, "comment_id": 96605742, "body": "Regarding error handling and after you removed <code>On Error Resume Next</code> you might be interested in reading <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a> to see how to do error handling the right way."}, {"owner": {"reputation": 1, "user_id": 9479467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c759463a1d45e274c09b93fd55647e04?s=128&d=identicon&r=PG&f=1", "display_name": "DrewBerg", "link": "https://stackoverflow.com/users/9479467/drewberg"}, "reply_to_user": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1551796127, "post_id": 54910785, "comment_id": 96765247, "body": "@TateGarringer do you think i could use VBS to script &quot;Script #3&quot; and put that inside of &quot;Script #2&quot; in replacement of xlApp.Run &quot;RunCopyPaste&quot;?"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1551800166, "post_id": 54910785, "comment_id": 96767912, "body": "Yes, that&#39;s entirely possible, but whether or not that would actually fix your problem or just relocate it remains to be determined."}, {"owner": {"reputation": 1, "user_id": 9479467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c759463a1d45e274c09b93fd55647e04?s=128&d=identicon&r=PG&f=1", "display_name": "DrewBerg", "link": "https://stackoverflow.com/users/9479467/drewberg"}, "reply_to_user": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1551990701, "post_id": 54910785, "comment_id": 96854550, "body": "@TateGarringer I appreciate the help... I&#39;ve been working on this and have rescripted this to work much more efficiently (in my opinion).... any chance you could give this a once over to let me know if there&#39;s anything that can be more efficient or better scripted? I still have the PERSONAL.XLSB running the VBS script &quot;scripts2&quot; every 120 seconds but now I&#39;ve coded all the copy/pasting in VBS instead of having VBS run a macro inside excel and all that stuff that was going on.."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1551992676, "post_id": 54910785, "comment_id": 96855373, "body": "You say <i>any further efficiencies I can make?</i>  well, the biggest improvement I can see would be to not use VBS at all.  I see nothing in the code posted that can&#39;t be done in VBA directly."}], "owner": {"reputation": 1, "user_id": 9479467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c759463a1d45e274c09b93fd55647e04?s=128&d=identicon&r=PG&f=1", "display_name": "DrewBerg", "link": "https://stackoverflow.com/users/9479467/drewberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551991227, "creation_date": 1551286881, "last_edit_date": 1551991227, "question_id": 54910785, "link": "https://stackoverflow.com/questions/54910785/activeworkbook-saveas-randomly-shows-saving-loading-popup-but-doesnt-actually-s", "title": "ActiveWorkbook.SaveAs randomly shows saving loading popup but doesn&#39;t actually save", "body": "<p>I have a random issue I'm running into about once or twice a day, on a script that runs every 2 minutes from 7am to 5pm daily, and am hoping somebody here might be able to determine what could be causing it.</p>\n\n<p>I'm going to try and keep this post as organized and to the point as possible, as the process utilizes 3 separate scripts. </p>\n\n<p><strong>Script #1</strong> is housed in the PERSONAL.XLSB workbook &amp; is the timer to begin the process @ 7am and repeat every 120 seconds. Code below:</p>\n\n<pre><code>**ThisWorkbook:\nPrivate Sub Workbook_Open()\nApplication.OnTime TimeValue(\"07:00:00\"), \"'RunScripts2'\"\nEnd Sub\n\n**Module1:\nSub RunScripts2()\nOn Error Resume Next\nShell \"wscript \"\"R:\\xxxx\\xxxx\\xxxx\\scripts2.vbs\"\"\", vbNormalFocus\nDim scr As ScriptControl: Set scr = New ScriptControl\nscr.Language = \"VBScript\"\nApplication.OnTime DateAdd(\"s\", 120, Now), \"RunScripts2\"\nEnd Sub\n</code></pre>\n\n<p><strong>Script #2</strong> is the scripts2.VBS script that Script #1 calls every 120 seconds. This opens an excel workbook and runs the macro \"RunCopyPaste.\" Code below:</p>\n\n<pre><code>**scripts2.vbs:\nOption Explicit\nOn Error Resume Next\nExcelMacroExample\nSub ExcelMacroExample() \n\n  Dim xlApp \n  Dim xlBook \n  Set xlApp = GetObject(,\"Excel.Application\") \n  xlApp.Visible = True\n  xlApp.DisplayAlerts = False\n\n  Set xlBook = xlApp.Workbooks.Open(\"\\\\xxxx\\xxxx\\xxxx\\Model.xlsm\",3,True) \n\n  Dim dteWait\n  dteWait = DateAdd(\"s\", 8, Now())\n  Do Until (Now() &gt; dteWait)\n  Loop\n\n  xlApp.Run \"RunCopyPaste\"\n\n  Set xlApp = GetObject(,\"Excel.Application\") \n\nEnd Sub\n</code></pre>\n\n<p><strong>Script #3</strong> is housed in the Model.xlsm workbook that Script #2 calls. Code below: </p>\n\n<pre><code>**ThisWorkbook:\nPrivate Sub Workbook_Open()\n    Application.Run \"BloombergUI.xla!RefreshAllWorkbooks\"\n    Application.Run \"BloombergUI.xla!RefreshAllStaticData\"\nEnd Sub\n\n**Module2:\nSub RunCopyPaste()\n    On Error Resume Next\n    Application.DisplayAlerts = False\n\n    ChDir _\n        \"R:\\xxxx\\xxxx\\xxxx\\xxxx\\\"\n    Workbooks.Open Filename:= _\n        \"R:\\xxxx\\xxxx\\xxxx\\xxxx\\Data.xlsx\" _\n        , UpdateLinks:=3, ReadOnly:=True\n    Application.Run \"ConnectChartEvents\"\n    Windows(\"Model.xlsm\").Activate\n    Sheets(\"Sheet1\").Select\n    Range(\"B5:J94\").Select\n    Selection.Copy\n    Windows(\"Data.xlsx\").Activate\n    Sheets(\"Sheet1\").Select\n    Range(\"B5\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Windows(\"Model.xlsm\").Activate\n    Sheets(\"Sheet2\").Select\n    Range(\"C5:D73\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Data.xlsx\").Activate\n    Sheets(\"Sheet2\").Select\n    Range(\"C5\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Windows(\"Model.xlsm\").Activate\n    Sheets(\"Sheet3\").Select\n    Range(\"B6:C7\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Data.xlsx\").Activate\n    Sheets(\"Sheet3\").Select\n    Range(\"B6\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n\n\nFN = Replace(ActiveWorkbook.Name, \"temp_\", \"\")\nFN = \"temp_\" + FN\n\nActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path + Application.PathSeparator + FN\n\n    ActiveWindow.Close False\n    ActiveWindow.ScrollWorkbookTabs Position:=xlFirst\n    Sheets(\"Sheet1\").Select\n    ActiveWorkbook.Close\nDim wb As Workbook\nSet wb = Workbooks.Add\n\nEnd Sub\n</code></pre>\n\n<p><strong>Issue I am currently facing</strong></p>\n\n<p>This process works great; however, once it breaks during the SaveAs \"temp_Data.xlsx\" process it wont save correctly unless I kill excel and restart the \"RunScripts2\" macro. The break usually occurs in the middle of the day, somewhere between 12-2pm. It's completely random. Here's exactly what happens: the process will run as expected but when it gets to the SaveAs \"temp_Data.xlsx\" it will show the loading bar displaying the saving progress much quicker than usual (~.2 seconds) and then close all workbooks, open a blank one just as it should and then repeat the process 120 seconds later. However, I noticed that the \"temp_Data.xlsx\" shows a Date Modified reflective of a previous run. And every subsequent run once it \"breaks\" will look like it runs as normal but the file will not be fully saved down and the file Date Modified will not reflect an updated run. My remedy has been to close excel and reopen it and manually kick off the \"RunScripts2\" macro to get the timer &amp; process going again. I've had days where it goes the entire day without \"breaking\" and I've had some where it breaks multiple times in a day; however, most recently it breaks once mid-day and I restart it and it's fine until EOD. </p>\n\n<p><strong>Solutions I've Attempted Unsuccessfully</strong>\nI've tried keeping the alerts set to True but even that doesn't show any issues with the saving process. It's like it acts like it's saving but it doesn't really save. It's bizarre. I've done quite a bit of research on it and haven't found any solutions. I'm hoping somebody here has encountered something similar. </p>\n\n<p>Many thanks in advance for any help!</p>\n\n<p><strong><em>UPDATED CODE BELOW</em></strong></p>\n\n<p>Seems to be working as of now... any further efficiencies I can make? Much appreciated.</p>\n\n<pre><code>scripts2 NEW.vbs:\n\nOption Explicit\nExcelMacroExample\nSub ExcelMacroExample() \n\nDim xlApp\nDim CopyFrom\n\nSet xlApp = GetObject(,\"Excel.Application\") \nxlApp.Visible = True\n\nSet CopyFrom = xlApp.Workbooks.Open(\"\\\\xxxx\\xxxx\\xxxx\\Model NEW.xlsm\",3,True) \n\nDim dteWait\ndteWait = DateAdd(\"s\", 5, Now())\nDo Until (Now() &gt; dteWait)\nLoop\n\nCopyFrom.WorkSheets(\"Data\").Activate()\nCopyFrom.Worksheets(\"Data\").Range(\"B1:K275\").Copy\nCopyFrom.Worksheets(\"Data\").Range(\"B1\").PasteSpecial -4163, -4142, False, False\nxlApp.CutCopyMode = False\n\nxlApp.DisplayAlerts = False\nCopyFrom.SaveAs \"\\\\xxxx\\xxxx\\xxxx\\Model NEW.xlsx\", 51\nxlApp.DisplayAlerts = True\n\nCopyFrom.Close False\n\nDim xlAppp\nSet xlAppp = GetObject(,\"Excel.Application\") \nxlAppp.Visible = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551286863, "post_id": 54910710, "comment_id": 96588381, "body": "<code>Field</code> is relative to your AF range, so you need to include column F for starters and then use <code>Field:=1</code>."}, {"owner": {"reputation": 11, "user_id": 11126343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T3e6VDwDph0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcx9x7e2NnfFgrTlv8vZ_9RmFHTig/mo/photo.jpg?sz=128", "display_name": "Christopher Allen", "link": "https://stackoverflow.com/users/11126343/christopher-allen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551287071, "post_id": 54910710, "comment_id": 96588480, "body": "@SJR Sorry, I am filtering by column L. I updated the post to reflect this."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551287341, "post_id": 54910710, "comment_id": 96588614, "body": "Have you stepped through? I would guess that you don&#39;t have any Yes&#39;s in column L. Type &#39;Yes&#39; in one cell in L and then try it."}, {"owner": {"reputation": 11, "user_id": 11126343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T3e6VDwDph0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcx9x7e2NnfFgrTlv8vZ_9RmFHTig/mo/photo.jpg?sz=128", "display_name": "Christopher Allen", "link": "https://stackoverflow.com/users/11126343/christopher-allen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1551293718, "post_id": 54910710, "comment_id": 96591705, "body": "@SJR everything works well until the line to copy the ranges."}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1551350263, "post_id": 54910710, "comment_id": 96612110, "body": "Your code selects all filtered data (Column L with &quot;Yes&quot; + header) from the source worksheet (Range(&quot;G7 to lastrow&quot;) and copies these values successfully to the target worksheet. I did not find any problem! Your code works correctly!"}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1551350762, "post_id": 54910710, "comment_id": 96612405, "body": "<a href=\"https://i.stack.imgur.com/YpI4D.jpg\" rel=\"nofollow noreferrer\">i.stack.imgur.com/YpI4D.jpg</a>"}, {"owner": {"reputation": 11, "user_id": 11126343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T3e6VDwDph0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcx9x7e2NnfFgrTlv8vZ_9RmFHTig/mo/photo.jpg?sz=128", "display_name": "Christopher Allen", "link": "https://stackoverflow.com/users/11126343/christopher-allen"}, "reply_to_user": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1551466565, "post_id": 54910710, "comment_id": 96664159, "body": "Thanks @simple-solution. It&#39;s working now. I have no idea what the issue was before."}], "owner": {"reputation": 11, "user_id": 11126343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T3e6VDwDph0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcx9x7e2NnfFgrTlv8vZ_9RmFHTig/mo/photo.jpg?sz=128", "display_name": "Christopher Allen", "link": "https://stackoverflow.com/users/11126343/christopher-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 512, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1551287028, "creation_date": 1551286664, "last_edit_date": 1551287028, "question_id": 54910710, "link": "https://stackoverflow.com/questions/54910710/copying-filtered-range-of-cells-from-1-worksheet-to-last-row-of-another", "title": "Copying filtered range of cells from 1 worksheet to last row of another", "body": "<p>I am trying to filter a range of data (by using \"Yes\" from column L) on 1 worksheet (\"2. Select Study-Specific Forms\") and copy the data to the last row of another worksheet (\"3. Worksheet\"). I am using the code below. So far the code filters the data on the first worksheet but the data does not copy to the second worksheet.</p>\n\n<p>Thanks in advance for any assistance.</p>\n\n<pre><code> Sub FilterAndCopy2()\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n\n    Dim LastRow As Long, LastRow2 As Long\n    Dim TARGetSheet As Worksheet, TKSheet As Worksheet\n\n    Set TARGetSheet = Sheets(\"2. Select Study-Specific Forms\") 'Set sheet where filtered data is\n    Set TKSheet = Sheets(\"3. Worksheet\") ' Set Sheet name to copy data to\n\n    LastRow = TARGetSheet.Range(\"L\" &amp; Rows.Count).End(xlUp).Row ' Determine the lastrow of the data to copy\n    LastRow2 = TKSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1 ' Determine the next empty row in order to paste the data\n\n\n    With TARGetSheet\n        .AutoFilterMode = False\n\n        With .Range(\"G7\", \"L\" &amp; LastRow)\n        .AutoFilter\n        .AutoFilter Field:=6, Criteria1:=\"Yes\"\n        End With\n    End With\n\n     TARGetSheet.Range(\"G7\", \"L\" &amp; LastRow).Copy\n     TKSheet.Range(\"A\" &amp; LastRow2).PasteSpecial (xlPasteAll)\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1551285102, "post_id": 54910076, "comment_id": 96587260, "body": "<code>Workbooks.Add</code> - here you&#39;re creating a new (empty workbook) then saving it with the new name. Get rid of this line."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551285429, "post_id": 54910076, "comment_id": 96587479, "body": "You may also want to look into <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoiding activate and select</a> in your code"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1551285652, "post_id": 54910076, "comment_id": 96587619, "body": "Some things to consider: Try and avoid using things like <code>.Select</code> or <code>Activate</code> or <code>ActiveWorkbook</code>. You don&#39;t need any of these. Always qualify your workbooks or worksheets: <code>Set thisWb = ThisWorkbook</code> or <code>Set thisWs = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)</code>. Now you can reference any range with <code>thisWs</code> (where <code>thisWs</code> is of type <code>Worksheet</code>). You don&#39;t need to <code>Select</code> or <code>Activate</code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551285704, "post_id": 54910076, "comment_id": 96587654, "body": "@cybernetic.nomad: great minds and all of that :)"}, {"owner": {"reputation": 17, "user_id": 11121342, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cNn3q2JBMhM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rca4PV5TnZm6xeCdcjNrv4s8-vtug/mo/photo.jpg?sz=128", "display_name": "Michael Gallagher", "link": "https://stackoverflow.com/users/11121342/michael-gallagher"}, "edited": false, "score": 0, "creation_date": 1551286032, "post_id": 54910076, "comment_id": 96587881, "body": "Thank you all for the help and I will read up on the information you mentioned!"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 5, "last_activity_date": 1551285423, "last_edit_date": 1551285423, "creation_date": 1551285115, "answer_id": 54910157, "question_id": 54910076, "link": "https://stackoverflow.com/questions/54910076/why-does-my-saveas-file-save-a-file-with-the-correct-name-but-has-no-contents/54910157#54910157", "title": "Why does my SaveAs file save a file with the correct name, but has no contents?", "body": "<p>Your line <code>Workbooks.Add</code> makes a new workbook which is an empty file. This then becomes the <code>ActiveWorkbook</code> and as such your next line saves the new <code>Workbook</code> which is empty.</p>\n\n<p>By looking at your code I'm guessing you're trying to save a copy of your source file. If so you don't need the <code>Workbooks.Add</code> line - Remove it and it should solve your issue. If you're trying to add a workbook though as well as saving a copy:- Use proper references instead of <code>Active</code> ones i.e. </p>\n\n<pre><code>ActiveWorkbook.SaveCopyAs Filename:=Left(thisWb.FullName, d - 1) &amp; \"-Prelims\" &amp; Mid(thisWb.FullName, d)\n</code></pre>\n\n<p>Becomes</p>\n\n<pre><code>thisWb.SaveCopyAs Filename:=Left(thisWb.FullName, d - 1) &amp; \"-Prelims\" &amp; Mid(thisWb.FullName, d)\n</code></pre>\n\n<p>You should try to avoid using <code>Select</code> or <code>Active</code> statements as much as possible (this would have avoided your issue entirely). For further reading take a look here: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> </p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1551285229, "creation_date": 1551285229, "answer_id": 54910204, "question_id": 54910076, "link": "https://stackoverflow.com/questions/54910076/why-does-my-saveas-file-save-a-file-with-the-correct-name-but-has-no-contents/54910204#54910204", "title": "Why does my SaveAs file save a file with the correct name, but has no contents?", "body": "<p>Let's look at the last bit of your code:</p>\n\n<pre><code>Workbooks.Add 'Creates a new Blank Workbook, and makes it the ActiveWorkbook\nd = InStrRev(thisWb.FullName, \".\")\nActiveWorkbook.SaveCopyAs Filename:=Left(thisWb.FullName, d - 1) &amp; \"-Prelims\" &amp; Mid(thisWb.FullName, d)\n'Saves your new Blank ActiveWorkbook\n</code></pre>\n\n<p>You need to either add something to your new workbook, or do the SaveAs on a different workbook (e.g. <code>thisWb.SaveCopyAs</code>?)</p>\n"}], "owner": {"reputation": 17, "user_id": 11121342, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cNn3q2JBMhM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rca4PV5TnZm6xeCdcjNrv4s8-vtug/mo/photo.jpg?sz=128", "display_name": "Michael Gallagher", "link": "https://stackoverflow.com/users/11121342/michael-gallagher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 54910157, "answer_count": 2, "score": 0, "last_activity_date": 1551285694, "creation_date": 1551284887, "last_edit_date": 1551285694, "question_id": 54910076, "link": "https://stackoverflow.com/questions/54910076/why-does-my-saveas-file-save-a-file-with-the-correct-name-but-has-no-contents", "title": "Why does my SaveAs file save a file with the correct name, but has no contents?", "body": "<p>I have been able to hard code my file and then saveas in the same folder. However, the new file that is created with the correct name has no content at all. I found out how to save in the current directory with all of the help on SO but haven't been able to solve this issue.\nAnything helps since I am very new to VBA!</p>\n\n<pre><code>     Sheets.Select\n    Cells.Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n\n    Dim thisWb As Workbook, d As Integer\n\n    Set thisWb = ActiveWorkbook\n    Workbooks.Add\n    d = InStrRev(thisWb.FullName, \".\")\n    'ActiveWorkbook.SaveAs Filename:=Left(thisWb.FullName, d - 1) &amp; \"-Prelims\" &amp; Mid(thisWb.FullName, d)\n    ActiveWorkbook.SaveCopyAs Filename:=Left(thisWb.FullName, d - 1) &amp; \"-Prelims\" &amp; Mid(thisWb.FullName, d)\n\n    ActiveWorkbook.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "format"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1551284815, "post_id": 54909943, "comment_id": 96587065, "body": "Hi @SAMROX I would use a <code>Date</code> variable and the function <code>DateSerial</code> to input the date that way you can manually tell excel what is day, month and year and later it will be formated as you want because it will be holded into a Date variable.,"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551284847, "post_id": 54909943, "comment_id": 96587083, "body": "I doubt <code>.</code> is recognized as a date delimiter, so you&#39;re just getting a string. Just parse the date and use <code>DateSerial</code>."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1551285667, "post_id": 54909943, "comment_id": 96587629, "body": "This is very similar to a question that was asked yesterday take a look at <a href=\"https://stackoverflow.com/a/54883460/3042759\">link</a>"}, {"owner": {"reputation": 21, "user_id": 9623099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37528bf9dd14b75284481d202ac2c4b9?s=128&d=identicon&r=PG&f=1", "display_name": "SAMROX", "link": "https://stackoverflow.com/users/9623099/samrox"}, "edited": false, "score": 0, "creation_date": 1551799744, "post_id": 54909943, "comment_id": 96767634, "body": "Thank you all. It helped me to capture the date as the way I want. But I still have issue when I try to write the same data row to a text file."}, {"owner": {"reputation": 21, "user_id": 9623099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37528bf9dd14b75284481d202ac2c4b9?s=128&d=identicon&r=PG&f=1", "display_name": "SAMROX", "link": "https://stackoverflow.com/users/9623099/samrox"}, "edited": false, "score": 0, "creation_date": 1552555337, "post_id": 54909943, "comment_id": 97056870, "body": "Thanks for sharing the link. I did updated my code to capture the data as mentioned. It does not work when you saved it as a text file and it automatically gets converted to the PC format."}], "owner": {"reputation": 21, "user_id": 9623099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37528bf9dd14b75284481d202ac2c4b9?s=128&d=identicon&r=PG&f=1", "display_name": "SAMROX", "link": "https://stackoverflow.com/users/9623099/samrox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551799875, "creation_date": 1551284455, "last_edit_date": 1551799875, "question_id": 54909943, "link": "https://stackoverflow.com/questions/54909943/changing-format-of-the-date-that-has-been-already-captured-to-the-excel", "title": "Changing Format of The Date That Has been Already Captured to the Excel", "body": "<blockquote>\n  <p><em>Update 05/03/2019</em></p>\n  \n  <p>I used the following from the URL given below by Tom.</p>\n\n<pre><code>Function ConvertDate(InputStr As String) As Date\n\n    Dim InputYear As Integer\n    Dim InputMonth As Integer\n    Dim InputDay As Integer\n\n    'extract year, month and day\n    InputYear = Right(InputStr, 4)\n    InputMonth = Mid(InputStr, 4, 2)\n    InputDay = Left(InputStr, 2)\n\n    'put it together to a real date\n    ConvertDate = DateSerial(InputYear, InputMonth, InputDay)\nEnd Function\n</code></pre>\n  \n  <p>It gives me the date in the way I want. But when I write the same date\n  to a text file, the date changes back to the PC format which is\n  MM/DD/YYYY. Is there a way to get this solved?.</p>\n</blockquote>\n\n<p>****I have this excel VBA code which captures the date from another mainframe application which has the format of DD.MM.YYYY Once its captured I'm trying to change it back to the following format YYYY/MM/DD. I have applied the following format to the date_value column of my excel. Sheet1.Range(\"A2\", \"A50000\").NumberFormat = \"yyyy/mm/dd\" This is how I captured the date value from the mainframe program. Cells(noRow, 9).Value = Trim(MyHost.TextRC(5, 68, 12)) When I run the program it does not change the date format the way I want. My PC date format is set to the following, MM/DD/YYYY. Any hint or guidance is highly appreciated.****</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1551284713, "post_id": 54909884, "comment_id": 96587007, "body": "Right now it looks like you are applying first one format and then the other format to the <i>same</i> range, overwriting the first one."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1551292611, "post_id": 54909884, "comment_id": 96591204, "body": "Posting an answer as an edit/update to a question is frowned upon on Stack Overflow.The site&#39;s concept is Q&amp;A, which means the question box should contain only a question and any answer belongs in the Answer box. You are allowed to answer your own question, here."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10274903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9iQ2h.jpg?s=128&g=1", "display_name": "Tooky", "link": "https://stackoverflow.com/users/10274903/tooky"}, "edited": false, "score": 0, "creation_date": 1551294302, "post_id": 54912317, "comment_id": 96591975, "body": "Cindy, thanks so much! My original solution was using the Collapse method but I didn&#39;t specify the direction/constant. Now I see that if not specified, it defaults to wdCollapseStart which was causing me unexpected output. All makes sense now. Thanks again."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1551292488, "creation_date": 1551292488, "answer_id": 54912317, "question_id": 54909884, "link": "https://stackoverflow.com/questions/54909884/problem-using-two-font-formats-in-word-header/54912317#54912317", "title": "Problem using two font formats in Word header", "body": "<p>This can be done a bit more efficiently / elegantly than the code posted in the \"update\". Relying on <code>Start</code> and <code>End</code> <em>values</em> is always a bit chancy with Word since Word can stick \"hidden\" content into the text flow. To get to the beginning or end of a <code>Range</code> it's more reliable to use <code>Collapse</code>. This will also be faster than doing calculations with values.</p>\n\n<pre><code>Dim rng as Word.Range\nSet rng = myDoc.Sections(1).Headers(wdHeaderFooterPrimary).Range\nWith \n    '.Start = 0 'Not necessary as this will be the default position\n    .text = \"TEXT LINE 1\" &amp; vbLf\n    '.End = Len(.text) 'Also not necessary, see further down...\n    .Font.Name = \"Courier New\"\n    .Font.Size = 10\n    .Font.Bold = True\n    .Font.Color = wdColorGreen\n    .ParagraphFormat.Alignment = wdAlignParagraphCenter\n\n    .Collapse wdCollapseEnd 'put focus at end of range\n\n    '.Start = Len(.text) + 1 'calculation not necessary as range has been collapsed\n    .text = \"TEXT LINE 2\"\n    '.End = Len(.text) + .Start 'not necessary\n    .Font.Name = \"Calibri Light\"\n    .Font.Size = 16\n    .Font.Bold = False\n    .Font.Color = wdColorBlack\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10274903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9iQ2h.jpg?s=128&g=1", "display_name": "Tooky", "link": "https://stackoverflow.com/users/10274903/tooky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 54912317, "answer_count": 1, "score": 0, "last_activity_date": 1551680821, "creation_date": 1551284277, "last_edit_date": 1551680821, "question_id": 54909884, "link": "https://stackoverflow.com/questions/54909884/problem-using-two-font-formats-in-word-header", "title": "Problem using two font formats in Word header", "body": "<p>From an subroutine in Excel, I am trying to create a header in a Word document with two words each with different font formatting however the last font formatting wins. Any help would be appreciated! Below is my current code snippet. </p>\n\n<pre><code>With myDoc.Sections(1).Headers(wdHeaderFooterPrimary).Range\n    .Font.Name = \"Courier New\"\n    .Font.Size = 10\n    .Font.Bold = True\n    .Font.Color = wdColorGreen\n    .text = \"TEXT LINE 1\" &amp; vbLf\n\n    .Font.Name = \"Calibri Light\"\n    .Font.Size = 16\n    .Font.Bold = False\n    .Font.Color = wdColorBlack\n    .text = .text &amp; \"TEXT LINE 2\"\n    ....the rest of the code....\n</code></pre>\n\n<p><strong>UPDATE:</strong> I solved the issue by explicitly setting the range. See code snippet below.</p>\n\n<pre><code>With myDoc.Sections(1).Headers(wdHeaderFooterPrimary).Range\n    .Start = 0\n    .text = \"TEXT LINE 1\" &amp; vbLf\n    .End = Len(.text)\n    .Font.Name = \"Courier New\"\n    .Font.Size = 10\n    .Font.Bold = True\n    .Font.Color = wdColorGreen\n    .ParagraphFormat.Alignment = wdAlignParagraphCenter\n\n    .Start = Len(.text) + 1\n    .text = \"TEXT LINE 2\"\n    .End = Len(.text) + .Start\n    .Font.Name = \"Calibri Light\"\n    .Font.Size = 16\n    .Font.Bold = False\n    .Font.Color = wdColorBlack\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1551283311, "post_id": 54909555, "comment_id": 96586081, "body": "Try to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using activate and select</a> in your code. It will make it easier to get what you want"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551283783, "post_id": 54909555, "comment_id": 96586420, "body": "It&#39;s something to do with the adding then, did you do any investigation on <code>buttons.add</code> ?  As you are using <code>ActiveSheet.Buttons.Add(0.75, 145.5, 42, 24.75).Select</code> to add, i.e. the same place each time :o).  You need to change these numbers, so use <code>cells(1,2).top</code> etc to sort it all out."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551284085, "post_id": 54909555, "comment_id": 96586626, "body": "<a href=\"https://stackoverflow.com/questions/4559094/how-to-add-a-button-programmatically-in-vba-next-to-some-sheet-cell-data\" title=\"how to add a button programmatically in vba next to some sheet cell data\">stackoverflow.com/questions/4559094/&hellip;</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551284100, "post_id": 54909555, "comment_id": 96586637, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4559094/how-to-add-a-button-programmatically-in-vba-next-to-some-sheet-cell-data\">How to add a button programmatically in VBA next to some sheet cell data?</a>"}, {"owner": {"reputation": 1, "user_id": 11121844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15e62ddbb77ccc30047490f4ae60b55?s=128&d=identicon&r=PG&f=1", "display_name": "JMSC", "link": "https://stackoverflow.com/users/11121844/jmsc"}, "edited": false, "score": 0, "creation_date": 1551286991, "post_id": 54909555, "comment_id": 96588437, "body": "Nathan- your suggestion for &quot;How to add a button programmatically in VBA next to some sheet cell data?&quot; spot on.  Thank you for linking."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1551286729, "creation_date": 1551286729, "answer_id": 54910737, "question_id": 54909555, "link": "https://stackoverflow.com/questions/54909555/repeatedly-adding-a-macro-enabled-button-through-vba/54910737#54910737", "title": "Repeatedly adding a macro enabled button through VBA", "body": "<p>Something like this:</p>\n\n<pre><code>Sub VBA_Input_Idea_inputbox()\n    Dim MyInp As String\n    Dim NextRow As Range, btn\n\n    MyInp = VBA.Interaction.InputBox(\"Please input idea\", \"LEARNING REQUEST \")\n    If MyInp = \"\" Then Exit Sub\n    With ActiveSheet.Cells(Rows.Count, 3).End(xlUp).Offset(1, 0).EntireRow\n       .Cells(3).Value = Application.Proper(MyInp)\n       Set btn = ActiveSheet.Buttons.Add(.Cells(1).Left, .Cells(1).Top, _\n                                         .Cells(1).Width, .Cells(1).Height)\n       btn.OnAction = \"Addcount\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11121844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15e62ddbb77ccc30047490f4ae60b55?s=128&d=identicon&r=PG&f=1", "display_name": "JMSC", "link": "https://stackoverflow.com/users/11121844/jmsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551337836, "creation_date": 1551283159, "last_edit_date": 1551337836, "question_id": 54909555, "link": "https://stackoverflow.com/questions/54909555/repeatedly-adding-a-macro-enabled-button-through-vba", "title": "Repeatedly adding a macro enabled button through VBA", "body": "<p>Trying to create an inputbox that a user can type notes into, those notes will be input onto the same document and simultaneously create a macro enables \u201cthumbs up icon\u201d that will hold a macro that other members can \u201cthumbs up\u201d ideas they want to promote.  The code below is causing the button to duplicate itself on the same cell.  I need  it to instead apply to the next available cell.  </p>\n\n<pre><code>Sub VBA_Input_Idea_inputbox() \n Dim MyInp As String\n Dim NextRow As Long\n\n MyInp = VBA.Interaction.InputBox(\"Please input idea\", \"LEARNING \n    REQUEST\")\n  If MyInp = \"\" Then Exit Sub\n NextRow = Cells(Rows.Count, 3).End(xlUp).Row + 1\n Range(\"C\" &amp; NextRow).Value = \n Excel.WorksheetFunction.Proper(MyInp)\n Range(\"A\" &amp; NextRow).Select\n ActiveSheet.Buttons.Add(0.75, 145.5, 42, 24.75).Select\n Selection.OnAction = \"Addcount\"\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "screenshot"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 5, "creation_date": 1551282982, "post_id": 54909402, "comment_id": 96585847, "body": "Make use of the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.Find\" rel=\"nofollow noreferrer\">Range.Find method</a> method instead of using <code>.SendKeys</code> (which is a bad approach). And you might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 5, "creation_date": 1551282988, "post_id": 54909402, "comment_id": 96585853, "body": "Wow.  Why are you using <code>SendKeys</code> for this at all? Is <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\"><code>Range.Find</code></a> not working for some reason?"}, {"owner": {"reputation": 1, "user_id": 11126004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1740a44512657661155eda510f5584f?s=128&d=identicon&r=PG&f=1", "display_name": "Htnasarp", "link": "https://stackoverflow.com/users/11126004/htnasarp"}, "edited": false, "score": 0, "creation_date": 1551325491, "post_id": 54909402, "comment_id": 96601828, "body": "Thank you guys. I know send keys are tricky. Just that the internal auditors want a screenshot with the find and replace dialog clearly showing the search string and the resultant &quot;we could not find...&quot;. This will be saved to evidence that the item was not in the excel sheet as of that date."}, {"owner": {"reputation": 1, "user_id": 11126004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1740a44512657661155eda510f5584f?s=128&d=identicon&r=PG&f=1", "display_name": "Htnasarp", "link": "https://stackoverflow.com/users/11126004/htnasarp"}, "edited": false, "score": 0, "creation_date": 1551380102, "post_id": 54909402, "comment_id": 96629298, "body": "My specific problem is that when the Find and replace returns no result, I am not able to take a screenshot with the We couldn&#39;t find what you were looking for. Click Options for more ways to search.&quot; dialog box. When I run the code above, I get a screenshot without the dialog box."}], "owner": {"reputation": 1, "user_id": 11126004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1740a44512657661155eda510f5584f?s=128&d=identicon&r=PG&f=1", "display_name": "Htnasarp", "link": "https://stackoverflow.com/users/11126004/htnasarp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551282735, "creation_date": 1551282735, "question_id": 54909402, "link": "https://stackoverflow.com/questions/54909402/taking-screenshot-of-excel-find-and-replace-results-along-with-clock", "title": "Taking Screenshot of Excel Find and Replace results along with clock", "body": "<p>I am using sendkeys to manipulate the options in Find and Replace. However, when it comes to taking screenshots, it captures the screenshot without the results. Most of my searches (99%) return no result. I just have to take a screenshot of the entire active screen (I use a dual monitor) and save the file as a jpg or pdf.</p>\n\n<p>The code I have so far is</p>\n\n<pre><code>Sub Seachpdfer()\n Dim searchquery As Range\n Dim mystring As String\n Dim mypic As Shape\n\n Set searchquery = Worksheets(\"Query\").Range(\"AA2:AA10001\")\n\n For Each cell In searchquery\n\n    mystring = cell.Value\n\n    If cell.Value = \"\" Then\n        Exit For\n    End If\n\n  Worksheets(\"Restricted List\").Select\n  Worksheets(\"Restricted List\").Range(\"A1\").Activate\n  Worksheets(\"Restricted List\").Range(\"I1\").Activate\n\n  Application.CommandBars(\"Edit\").Controls(\"Find...\").Execute\n\n\n\n  Application.SendKeys (\"%n\" &amp; mystring)\n  Application.SendKeys (\"{TAB}{TAB}\")\n  Application.SendKeys (\"Sheet\")\n  Application.SendKeys (\"{ENTER}\")\n  'Application.SendKeys (\"{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}\")\n  Application.SendKeys (\"{TAB}{TAB}\")\n  Application.SendKeys \"%i\", True  ' This clicks the Find button on the Find and Replace dialog\n\n' This is where it all breaks. I tried using doevents and tried using application wait. But the screenshot I get does not show\n'The search result We could not find what.....\"\n\n  Application.SendKeys \"({1068})\", True\n  DoEvents\n  ThisWorkbook.Worksheets(\"Staging\").Activate\n  ActiveSheet.Paste\n  sFileName = ThisWorkbook.Path &amp; \"\\\" &amp; mystring &amp; \".jpg\"\n\n  For Each mypic In ActiveSheet.Shapes\n\n        mypic.Select\n\n       Call PictureExport ' This function converts it to a chart and prints out the pdf\n\n\n   Next\n\n Next\nEnd Sub\n</code></pre>\n\n<p>Any help will be much appreciated. Thank you. </p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 23, "user_id": 11126067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/623bb69c37ee64ff2470631fb40a90da?s=128&d=identicon&r=PG&f=1", "display_name": "RebaCat", "link": "https://stackoverflow.com/users/11126067/rebacat"}, "edited": false, "score": 0, "creation_date": 1551376378, "post_id": 54911689, "comment_id": 96627446, "body": "<i>&quot;I tried the Rnd[(number)] as you suggested, and it does not work.&quot;</i> What code did you use and what error did you receive?"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 23, "user_id": 11126067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/623bb69c37ee64ff2470631fb40a90da?s=128&d=identicon&r=PG&f=1", "display_name": "RebaCat", "link": "https://stackoverflow.com/users/11126067/rebacat"}, "edited": false, "score": 0, "creation_date": 1551383579, "post_id": 54911689, "comment_id": 96630929, "body": "As suggested, you should negate the numerical argument you are supplying to the <code>Rnd</code> function to cause the same random number to be returned for the given seed. Hence your code would become something along the lines of: <code>Rnd(-[Names])</code> (assuming that <code>[Names]</code> is numerical data)."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 23, "user_id": 11126067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/623bb69c37ee64ff2470631fb40a90da?s=128&d=identicon&r=PG&f=1", "display_name": "RebaCat", "link": "https://stackoverflow.com/users/11126067/rebacat"}, "edited": false, "score": 0, "creation_date": 1551462326, "post_id": 54911689, "comment_id": 96662410, "body": "@RebaCat This is because <code>-[Names]+11111111</code> will likely yield a positive number (depending on how large/small your <code>Names</code> field is), and so you are no longer passing a negative number to the <code>Rnd</code> function. I have updated my answer above to help you."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 23, "user_id": 11126067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/623bb69c37ee64ff2470631fb40a90da?s=128&d=identicon&r=PG&f=1", "display_name": "RebaCat", "link": "https://stackoverflow.com/users/11126067/rebacat"}, "edited": false, "score": 0, "creation_date": 1551463459, "post_id": 54911689, "comment_id": 96662876, "body": "You&#39;re most welcome! If my answer sufficiently answered your question, please mark the answer as the solution (and also upvote if you feel appropriate), so that the question appears as resolved for others browsing the site. Refer to <a href=\"https://stackoverflow.com/help/someone-answers\">this article</a> if you are unsure how to do this. Thanks!"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1551462314, "last_edit_date": 1551462314, "creation_date": 1551290144, "answer_id": 54911689, "question_id": 54909397, "link": "https://stackoverflow.com/questions/54909397/static-random-number-in-ms-access/54911689#54911689", "title": "Static Random Number in MS Access", "body": "<p>You could negate the numerical argument supplied to the <a href=\"https://support.office.com/en-us/article/rnd-function-503cd2e4-3949-413f-980a-ed8fb35c1d80\" rel=\"nofollow noreferrer\"><code>Rnd</code></a> function to cause the <a href=\"https://support.office.com/en-us/article/rnd-function-503cd2e4-3949-413f-980a-ed8fb35c1d80\" rel=\"nofollow noreferrer\"><code>Rnd</code></a> function to return the same random number for the given seed value (that is, there would be a one-to-one mapping between the random numbers and the seed values):</p>\n\n<blockquote>\n  <p><strong>Syntax</strong></p>\n  \n  <p><code>Rnd[(number)]</code></p>\n  \n  <p><strong>Return Values</strong></p>\n  \n  <p>If <em>number</em> is    </p>\n  \n  <ul>\n  <li><p><strong>Less than zero: The same number every time, using number as the seed.</strong></p></li>\n  <li><p>Greater than zero: The next random number in the sequence.</p></li>\n  <li><p>Equal to zero: The most recently generated number.</p></li>\n  <li><p>Not supplied: The next random number in the sequence.</p></li>\n  </ul>\n</blockquote>\n\n<pre><code>?rnd(-2)\n 0.7133257 \n?rnd(-2)\n 0.7133257 \n?rnd(-3)\n 0.9633257 \n?rnd(-3)\n 0.9633257 \n</code></pre>\n\n<p>However, a better approach might be to either populate an additional field in your source table with the static random number, or construct a separate table containing the mapping between names &amp; random numbers.</p>\n\n<p>For your particular case, since you are looking to generate 8-digit random numbers, you would use:</p>\n\n<pre><code>10000000 + Int(90000000 * Rnd(-[Names]))\n</code></pre>\n\n<p>This will yield a random number in the range <code>10000000</code> to <code>99999999</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1551294616, "creation_date": 1551294616, "answer_id": 54912826, "question_id": 54909397, "link": "https://stackoverflow.com/questions/54909397/static-random-number-in-ms-access/54912826#54912826", "title": "Static Random Number in MS Access", "body": "<p>You can use the function RandomRowNumber from my article:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/33030/Random-Rows-in-Microsoft-Access.html\" rel=\"nofollow noreferrer\">Random Rows in Microsoft Access</a></p>\n\n<pre><code>' Builds random row numbers in a select, append, or create query\n' with the option of a initial automatic reset.\n'\n' 2018-09-11. Gustav Brock, Cactus Data ApS, CPH.\n'\nPublic Function RandomRowNumber( _\n    ByVal Key As String, _\n    Optional Reset As Boolean) _\n    As Single\n\n    ' Error codes.\n    ' This key is already associated with an element of this collection.\n    Const KeyIsInUse        As Long = 457\n\n    Static Keys             As New Collection\n\n    On Error GoTo Err_RandomRowNumber\n\n    If Reset = True Then\n        Set Keys = Nothing\n    Else\n        Keys.Add Rnd(-Timer * Keys.Count), Key\n    End If\n\n    RandomRowNumber = Keys(Key)\n\nExit_RandomRowNumber:\n    Exit Function\n\nErr_RandomRowNumber:\n    Select Case Err\n        Case KeyIsInUse\n            ' Key is present.\n            Resume Next\n        Case Else\n            ' Some other error.\n            Resume Exit_RandomRowNumber\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>A demo is included for download.</p>\n\n<p>Code may also be found on <strong>GitHub</strong>: <a href=\"https://github.com/GustavBrock/VBA.RowNumbers\" rel=\"nofollow noreferrer\">VBA.RowNumbers</a></p>\n"}], "owner": {"reputation": 23, "user_id": 11126067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/623bb69c37ee64ff2470631fb40a90da?s=128&d=identicon&r=PG&f=1", "display_name": "RebaCat", "link": "https://stackoverflow.com/users/11126067/rebacat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 54911689, "answer_count": 2, "score": 2, "last_activity_date": 1551792677, "creation_date": 1551282721, "last_edit_date": 1551792677, "question_id": 54909397, "link": "https://stackoverflow.com/questions/54909397/static-random-number-in-ms-access", "title": "Static Random Number in MS Access", "body": "<p>I am using the following formula in an attempt to create a static random number.</p>\n\n<pre><code>Random Number: Format(Int((99999999-11111111+1)*Rnd([Numbers]+11111111)))\n</code></pre>\n\n<p>Yet, it returns a different non-static random number.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1551282600, "post_id": 54909214, "comment_id": 96585581, "body": "When is the error each time it&#39;s used?  What does the SQL evaluate to, what is <code>strMakePaTablesSQL </code> just before the excecute?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1551282603, "post_id": 54909214, "comment_id": 96585583, "body": "Why are you stripping characters from what appears to be your primary key? <code>strSupplier</code> is quoted, so the only one that should matter is <code>&#39;</code>.  I&#39;d suggest using a parameterized statement so you don&#39;t have to worry about this. If you insist on the concat, escape it to <code>&#39;&#39;</code> instead of removing it."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551282761, "post_id": 54909214, "comment_id": 96585677, "body": "Also, no need to extract the vendor name is there as <code>[Vendor_Name] = &#39;&quot; &amp; strSupplier &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1551288694, "post_id": 54909214, "comment_id": 96589329, "body": "<a href=\"http://stackoverflow.com/a/1099570/3820271\">How to debug dynamic SQL in VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1551286091, "creation_date": 1551286091, "answer_id": 54910528, "question_id": 54909214, "link": "https://stackoverflow.com/questions/54909214/statement-includes-a-reserved-word-or-an-argument-name-that-is-misspelled-or-mis/54910528#54910528", "title": "Statement includes a reserved word or an argument name that is misspelled or missing or punctuation is incorrect", "body": "<p>Yet, again a classic need to use parameterization, the industry best practice when running SQL at the application layer, here being VBA, but concept is transferable to most other languages. Specifically, consider <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/querydefs-collection-dao\" rel=\"nofollow noreferrer\">MS Access' QueryDefs</a> for your make-table process which does not need to have a different tailored name and parameterize the value in <code>WHERE</code> clause.</p>\n\n<p>Below uses stored Access queries (more efficient than VBA string queries) that are referenced in VBA. </p>\n\n<p><strong>SQL</strong> <em>(save as query object: mySavedParamQuery)</em></p>\n\n<p><code>PARAMETERS</code> clause is compliant only in Access SQL dialect.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS paramSupplier TEXT(255);\nSELECT v.[Key_Code_Name] as [Supplier Name], v.[Vendor_Name],\n       v.[Contract_ID], v.[EXP_DATE],\n       v.[Contract_Status], v.[Price Book Priority] as [High Priority Customer],\n       v.[GPO Or biosite] as [GPO Indicator], \n       v.[LTM_Rebate_Dollars] as [LTM Rebate Dollars]\nINTO tmpVendorTable\nFROM [all vendor Rebates] v\nWHERE v.[Vendor_Name] = paramSupplier;\n</code></pre>\n\n<p><strong>SQL</strong>  <em>(save as query object: mySavedAggregateQuery)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT v.Vendor_Name\nFROM [all vendor rebates] v\nGROUP BY v,Vendor_Name\n</code></pre>\n\n<hr>\n\n<p><strong>VBA</strong> <em>(no SQL shows)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>...\nDim qdef As QueryDef\nDim strFile As String           \n\nSet rstIePa = dbPa.OpenRecordset(\"mySavedAggregateQuery\", dbOpenDynaset)\nWith rstIePa\n    If Not (.BOF And .EOF) Then\n        .MoveLast\n        lngTotRecCount = .RecordCount\n        .MoveFirst\n\n        Do While Not .EOF    \n          strSupplier = .Fields(\"Vendor_Name\")\n          strFile = \"C:\\Testing\\Expiring rebates\\Vendor_Files\\\" &amp; strSupplier &amp; \".xls\"\n\n          For Each tdf In dbPa.TableDefs\n             If tdf.Name = \"tmpVendorTable\" Then\n                 dbPa.TableDefs.Delete tdf.Name\n             End If\n          Next tdf   \n\n          Set qdef = dbPa.QueryDefs(\"mySavedParamQuery\")   ' INITIALIZE QUERYDEF\n          qdef!paramSupplier = strSupplier                 ' BIND PARAMETER\n          qdef.Execute dbFailOnError                       ' EXECUTE ACTION  \n\n          Debug.Print strFile\n          DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n                                    \"tmpVendorTable\", strFile, True    \n          .MoveNext\n       Loop\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6205921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d7319784139c391e0c63ee47c5f8f5f?s=128&d=identicon&r=PG&f=1", "display_name": "PNigb", "link": "https://stackoverflow.com/users/6205921/pnigb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551286091, "creation_date": 1551282181, "last_edit_date": 1551283167, "question_id": 54909214, "link": "https://stackoverflow.com/questions/54909214/statement-includes-a-reserved-word-or-an-argument-name-that-is-misspelled-or-mis", "title": "Statement includes a reserved word or an argument name that is misspelled or missing or punctuation is incorrect", "body": "<p>I am getting the following error for the code below : </p>\n\n<blockquote>\n  <p>Select statement includes a reserved word or an argument name that is\n  misspelled or missing or punctuation is incorrect.</p>\n</blockquote>\n\n<p>I can't find  misspellings or reserved words I used, so I am thinking some sort of punctuation is missing or incorrect.  Since I am new at this, I am having trouble figuring it out. Any help is greatly appreciated.</p>\n\n<p>The specific part of the code that I am getting the error on is </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>strMakePaTablesSQL = \"SELECT [all vendor Rebates].[Key_Code_Name] as [Supplier Name], [all vendor Rebates].[Vendor_Name], \" _\n                   &amp; \"       [all vendor Rebates].[Contract_ID], [all vendor Rebates].[EXP_DATE], \" _\n                   &amp; \"       [all vendor Rebates].[Contract_Status], [all vendor Rebates].[Price Book Priority] as [High Priority Customer], \" _\n                   &amp; \"       [all vendor Rebates].[GPO Or biosite] as [GPO Indicator],  \" _\n                   &amp; \"       [all vendor Rebates].[LTM_Rebate_Dollars] as [LTM Rebate Dollars] \" _\n                   &amp; \" into [\" &amp; strTableName &amp; \"] From [all vendor Rebates] \" _\n                   &amp; \" Where [Vendor_Name] = '\" &amp; strSupplier &amp; \"'\"\n\ndbPa.Execute strMakePaTablesSQL\n</code></pre>\n\n<hr>\n\n<p>Full code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nDim dbXL As DAO.Database\nDim strDate As String\nDim strGenl As String\nDim strTableName As String\nDim fld As DAO.Field\nDim strGroupPASQL As String\nDim strMakePaTablesSQL As String\nDim StrPaID As String\nDim strGenl2 As String\nDim strSupplier As String\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nPublic Function MakeTableVN()\nDoCmd.SetWarnings False\nDim dbPa As DAO.Database\nDim rstIePa As DAO.Recordset\nDim lngTotRecCount As Long\nDim tdf As DAO.TableDef\nDim strADR_Name As String\nDim VN_Length As Double\n\nDoCmd.OpenQuery \"qryCreate_Local_Supplier_Contact_table\"\nDoCmd.OpenQuery \"qryAdd_New_Vendors_to_tblSupplierContact\"\nDoCmd.OpenQuery \"qryUpdate_Supplier_Contact_List\"\n\n\nSet dbPa = CurrentDb\n\n\nstrGroupPASQL = \"SELECT [all vendor rebates].Vendor_Name FROM [all vendor rebates] GROUP BY [all vendor rebates].Vendor_Name \"\n\nSet rstIePa = dbPa.OpenRecordset(strGroupPASQL, dbOpenDynaset)\nWith rstIePa\n    If Not (.BOF And .EOF) Then\n        .MoveLast\n        lngTotRecCount = .RecordCount\n        .MoveFirst\n\n        Do While Not .EOF\n\n            strSupplier = .Fields(\"Vendor_Name\") &amp; \"\"\n\n            strSupplier = Replace(strSupplier, \".\", \" \")\n            strSupplier = Replace(strSupplier, \":\", \" \")\n            strSupplier = Replace(strSupplier, \"=\", \" \")\n            strSupplier = Replace(strSupplier, \"/\", \" \")\n            strSupplier = Replace(strSupplier, \"\\\", \" \")\n            strSupplier = Replace(strSupplier, \"'\", \"\")\n            strSupplier = Replace(strSupplier, \"*\", \" \")\n\n            strTableName = strSupplier\n\n            For Each tdf In dbPa.TableDefs\n                If tdf.Name = strTableName Then\n                    dbPa.TableDefs.Delete tdf.Name\n                End If\n            Next\n\n           strMakePaTablesSQL = \"SELECT [all vendor Rebates].[Key_Code_Name] as [Supplier Name], [all vendor Rebates].[Vendor_Name], \" _\n                                  &amp; \"[all vendor Rebates].[Contract_ID], [all vendor Rebates].[EXP_DATE], [all vendor Rebates].[Contract_Status], [all vendor Rebates].[Price Book Priority] as [High Priority Customer], [all vendor Rebates].[GPO Or biosite] as [GPO Indicator], [all vendor Rebates].[LTM_Rebate_Dollars] as [LTM Rebate Dollars] into [\" &amp; strTableName &amp; \"] From [all vendor Rebates] Where [Vendor_Name] = '\" &amp; strSupplier &amp; \"'\"\n\n            dbPa.Execute strMakePaTablesSQL\n\n           Debug.Print \"C:\\Testing\\Expiring rebates\\Vendor_Files\\\" &amp; strSupplier &amp; \".xls\"\n            DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, strTableName, \"C:\\Testing\\Expiring rebates\\Vendor_Files\\\" &amp; strSupplier &amp; \".xls\", True\n\n            DoCmd.DeleteObject acTable, strTableName\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 2, "creation_date": 1551281828, "post_id": 54908884, "comment_id": 96585037, "body": "You should alter your <code>Set rngWatch = Range(&quot;A1&quot;)</code> into something like <code>Set rngWatch = Range(&quot;A1:A8&quot;)</code> And then perform the actions on the intersect."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1551282992, "last_edit_date": 1551282992, "creation_date": 1551282181, "answer_id": 54909213, "question_id": 54908884, "link": "https://stackoverflow.com/questions/54908884/formatting-multiple-cells-with-letters-and-number-in-vba/54909213#54909213", "title": "Formatting Multiple cells with letters and number in VBA", "body": "<p>Expand your <code>rngWatch</code>:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rngWatch As Range, r As Range\n    Dim strOld As String\n    Dim strNew As String\n\n    'What cell is the invoice number in?\n    Set rngWatch = Range(\"A:A\")\n\n    'Did user change it?\n    If Intersect(rngWatch, Target) Is Nothing Then Exit Sub\n    For Each r In Intersect(Target, rngWatch)\n        strOld = r.Value\n\n        'Are there already hypens?\n        If Len(strOld) = Len(Replace(strOld, \"_\", \"\")) Then\n            strNew = Left(strOld, 3) &amp; \"_\" &amp; Mid(strOld, 4, 3) &amp; \"_\" &amp; Mid(strOld, 8)\n\n            'Turn this off for the momenet\n            Application.EnableEvents = False\n                r.Value = strNew\n            Application.EnableEvents = True\n        End If\n  Next r\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>We use a loop in case the user changes several cells in column <strong>A</strong> simultaneously via <em>Copy/Paste</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 237, "user_id": 10191075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRKid.png?s=128&g=1", "display_name": "MarkyMark1000", "link": "https://stackoverflow.com/users/10191075/markymark1000"}, "is_accepted": false, "score": 0, "last_activity_date": 1551283162, "creation_date": 1551283162, "answer_id": 54909556, "question_id": 54908884, "link": "https://stackoverflow.com/questions/54908884/formatting-multiple-cells-with-letters-and-number-in-vba/54909556#54909556", "title": "Formatting Multiple cells with letters and number in VBA", "body": "<p>This can depend upon how you want the code to run.   You could for example create a macro that processes all of the cells within a specific range once it has been run, which to me is a sensible way to do it.   You could get the macro to process only the selected cells, which is another option.   There are many ways to do this.</p>\n\n<p>I have taken your example code and adjusted it so that any adjustments to cells within the _MyNamedRange named range are processed.   Just incase you enter the same code into more than 1 cell, it scans through the intersect using a for loop, but you may want to get rid of this depending on how you see your worksheet functioning.   You will need to create a named range _MyNamedRange, where the macro will function.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rngWatch As Range\n    Dim strOld As String\n    Dim strNew As String\n    Dim rngCell As Range, rngInter As Range\n\n    'What cell is the invoice number in?\n    Set rngWatch = Range(\"_MyNamedRange\")\n\n    'Get intersect of the change\n    Set rngInter = Intersect(rngWatch, Target)\n\n    'Exit of the change does not intersect with the named range\n    If rngInter Is Nothing Then Exit Sub\n\n    'Scan through the intersect cells and adjust the cells\n    Application.EnableEvents = False\n    For Each rngCell In rngInter\n        strOld = rngCell.Value\n\n        'Are there already hypens?\n        strNew = \"\"\n        If Len(strOld) = Len(Replace(strOld, \"_\", \"\")) Then strNew = Left(strOld, 3) &amp; \"_\" &amp; Mid(strOld, 4, 3) &amp; \"_\" &amp; Mid(strOld, 8)\n\n        'Update the cell\n        rngCell.Value = strNew\n\n    Next rngCell\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11125880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f3dd86e9dafd9ac2595e758eef34241?s=128&d=identicon&r=PG&f=1", "display_name": "p_kovatchev", "link": "https://stackoverflow.com/users/11125880/p-kovatchev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551283162, "creation_date": 1551281160, "last_edit_date": 1551281913, "question_id": 54908884, "link": "https://stackoverflow.com/questions/54908884/formatting-multiple-cells-with-letters-and-number-in-vba", "title": "Formatting Multiple cells with letters and number in VBA", "body": "<p>I have been trying to figure this problem out for some time to no avail.</p>\n\n<p>I have a file that tracks different types of invoices. The invoices have both numbers and letters ex. ABC_1234_12345678. I want excel to format the invoice codes by adding the under scores after the user inputs the invoice code(without the underscores). I currently have a code that can do it for single cell but I was wondering how I could change it format a select number of cells ex. A1-A8. I will add my code in the comments.</p>\n\n<p>Thank you for the help, I will be very thankful. :)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)     \n    Dim rngWatch As Range     \n    Dim strOld As String     \n    Dim strNew As String\n\n    'What cell is the invoice number in?     \n    Set rngWatch = Range(\"A1\")      \n\n    'Did user change it?     \n    If Intersect(rngWatch, Target) Is Nothing Then Exit Sub      \n\n    strOld = rngWatch.Value      \n\n    'Are there already hypens?     \n    If Len(strOld) = Len(Replace(strOld, \"_\", \"\")) Then strNew = Left(strOld, 3) &amp; \"_\" &amp; Mid(strOld, 4, 3) &amp; \"_\" &amp; Mid(strOld, 8)          \n\n    'Turn this off for the momenet                                 \n    Application.EnableEvents = False                         \n    rngWatch.Value = strNew         \n    Application.EnableEvents = True     \n  End If \nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1551280561, "post_id": 54908574, "comment_id": 96584263, "body": "So to be clear... if you got 10 rows, you want 6 new workbooks. 1 for the first 5 rows and then copy the first 5 rows and each row below the 5 in a new workbook. right?"}, {"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1551280588, "post_id": 54908574, "comment_id": 96584279, "body": "Yes, exactly that! I mean the first 5 rows are like the headers, so I want them copied into every new workbook. And then the remaining 5 rows should be copied, one each, into new workbooks (with the headers rows 1-5). Workbook 1= Rows 1-6 ;  Workbook 2= Rows 1-5 + 7; Workbook 3 = Rows 1-5 + 8, etc."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1551286804, "post_id": 54909005, "comment_id": 96588343, "body": "This did 99% of the work, thank you! I just had to define the variable &#39;i&#39;, (Dim i as Long) for the loop to work."}, {"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1551286849, "post_id": 54909005, "comment_id": 96588367, "body": "Aside from that, the only thing it&#39;s not doing is pasting the rows with format/values only. It&#39;s still linking some embedded formulas to the original workbook (which when sent out to third parties, will not display the correct data). What would the workaround for that be? Thanks again."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 1, "creation_date": 1551339855, "post_id": 54909005, "comment_id": 96606554, "body": "Sorry @Tester_Y I had a brainfart there thinking it would only copy values. Now is sorted. Remember to mark it as an answer if it solves everything so someone else can find it."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 1, "last_activity_date": 1551339824, "last_edit_date": 1551339824, "creation_date": 1551281558, "answer_id": 54909005, "question_id": 54908574, "link": "https://stackoverflow.com/questions/54908574/copy-specific-rows-from-workbook-into-x-amount-of-new-workbooks-one-per-row-p/54909005#54909005", "title": "Copy Specific Rows from workbook into x amount of new workbooks (one per row), pasting as format/values only", "body": "<p>hope this helps,</p>\n\n<pre><code>Sub CommandButton1_Click()\n\n    Dim wb As Workbook, FileNm As String, LastRow As Long, Headers As Range, wbTemp As Workbook, i As Long\n\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n\n    Set wb = ThisWorkbook\n\n    'lets suppose your data is in the first worksheet of your book\n    With wb\n        LastRow = .Sheets(1).Cells(.Sheets(1).Rows.Count, 1).End(xlUp).Row - 5 'this is to count how many rows you've got\n        Set Headers = .Sheets(1).Rows(\"1:5\") 'set the headers to copy them every iteration\n    End With\n\n    'copy each row + headers in a new workbook\n    For i = 1 To LastRow\n        FileNm = wb.Path &amp; \"\\\" &amp; \"TEST-BOOK\" &amp; i &amp; \".xlsx\" 'add the i to number every workbook from 1 to extra rows you have\n        Set wbTemp = Workbooks.Add 'add a new workbook\n        Headers.Copy \n        wbTemp.Sheets(1).Rows(1).PasteSpecial xlPasteValues 'paste the headers\n        wb.Sheets(1).Rows(5 + i).Copy \n        wbTemp.Sheets(1).Rows(6).PasteSpecial xlPasteValues 'copy the next row in the iteration\n        wbTemp.SaveAs FileNm\n        wbTemp.Close\n        Set wbTemp = Nothing\n    Next i\n\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54909005, "answer_count": 1, "score": 0, "last_activity_date": 1551339824, "creation_date": 1551280206, "last_edit_date": 1551281919, "question_id": 54908574, "link": "https://stackoverflow.com/questions/54908574/copy-specific-rows-from-workbook-into-x-amount-of-new-workbooks-one-per-row-p", "title": "Copy Specific Rows from workbook into x amount of new workbooks (one per row), pasting as format/values only", "body": "<p>Beginner in VBA.\nWhat I'm attempting to do:</p>\n\n<ul>\n<li>Copy the first 5 rows _ row 'x' in current worksheet, and paste in a new workbook</li>\n<li>New workbooks should be saved in the same directory</li>\n<li>This should repeat for every row below the first 5, i.e. rows 1-5 + 6, rows 1-5 + 7, rows 1-5 + 8, etc.</li>\n<li>When pasting the rows into the new workbook, I don't want to copy formulas, just format and values</li>\n</ul>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Sub CommandButton1_Click()\n\n    Dim MyBook As Workbook, newBook As Workbook\n    Dim FileNm As String\n\n    Set MyBook = ThisWorkbook\n\n    FileNm = ThisWorkbook.Path &amp; \"\\\" &amp; \"TEST-BOOK.xlsx\"\n    Set newBook = Workbooks.Add\n\n    With newBook\n        MyBook.Sheets(\"Sheet1\").Rows(\"1:5\").Copy .Sheets(\"Sheet1\").Rows(\"1\")\n\n        'Save new wb\n        .SaveAs Filename:=FileNm, CreateBackup:=False\n\n        .Close Savechanges:=False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>It copies the rows 1-5, but I don't know how to add the dynamic extra row-- it also copies all the formulas and embeds them. Assuming the Filename would also have to be in some sort of loop?\nThank you.</p>\n"}, {"tags": ["excel", "vba", "timestamp"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551278972, "post_id": 54908060, "comment_id": 96583244, "body": "Your last if branch does nothing, you need <code>Patienttime = Format(Now, &quot;HH:MM&quot;)</code> in there, also there is no <code>end if</code>"}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1551279074, "post_id": 54908060, "comment_id": 96583301, "body": "Sorry! I don&#39;t understand your text and I don&#39;t understand your code!"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551279522, "post_id": 54908060, "comment_id": 96583590, "body": "Also, you have a function called <code>Patienttime</code> and a variable/range called the same??????/"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551284369, "post_id": 54908060, "comment_id": 96586808, "body": "Use Debug -&gt; Compile VBAProject in the editor. This will give you a the compile errors. In this case, the <code>End If</code> at the end of the first line is misplaced.  Also <code>IsEmpty(Patienttime)</code> is testing the <i>return value</i> of the <i>function itself</i>. That means <code>IsEmpty(Patienttime)</code> is always <code>True</code> until you assign to it."}, {"owner": {"reputation": 11, "user_id": 10696128, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9An-jxc5Bso/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hX5zduAt0itVgwVKp5hDbdeWCu_g/mo/photo.jpg?sz=128", "display_name": "Thomas Boden", "link": "https://stackoverflow.com/users/10696128/thomas-boden"}, "edited": false, "score": 0, "creation_date": 1551293461, "post_id": 54908060, "comment_id": 96591595, "body": "i feel I should explain a bit, it is meant to be a function that references a cell, if there is a name in that cell it will then populate the cell with the function patienttime with a time stamp.  If you have made a spelling mistake for example and change it, the time stamp is updated, I was trying to get the function to check if there is a name, and then to check if there is already a time, if there is already a time then to not change anything."}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1551345851, "post_id": 54908060, "comment_id": 96609335, "body": "Make this explanation a part of your question! Change your code that it shows what you want to achieve or add a second code parts which shows what you want to achieve e.g with pseudocode (<a href=\"https://en.wikipedia.org/wiki/Pseudocode\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Pseudocode</a>)! What are your inputs? Where should the output be?"}, {"owner": {"reputation": 11, "user_id": 10696128, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9An-jxc5Bso/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hX5zduAt0itVgwVKp5hDbdeWCu_g/mo/photo.jpg?sz=128", "display_name": "Thomas Boden", "link": "https://stackoverflow.com/users/10696128/thomas-boden"}, "edited": false, "score": 0, "creation_date": 1551358434, "post_id": 54908060, "comment_id": 96616987, "body": "The cell requiring a timestamp in this case A3 would have patienttime(C3)"}], "owner": {"reputation": 11, "user_id": 10696128, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9An-jxc5Bso/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hX5zduAt0itVgwVKp5hDbdeWCu_g/mo/photo.jpg?sz=128", "display_name": "Thomas Boden", "link": "https://stackoverflow.com/users/10696128/thomas-boden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551280112, "creation_date": 1551278840, "question_id": 54908060, "link": "https://stackoverflow.com/questions/54908060/vba-code-time-stamp-that-doesnt-change-in-excel", "title": "vba code time stamp that doesnt change in excel", "body": "<p>I know I have made an obvious mistake somewhere but I initially tried to make a code that would put a timestamp in but then not overwrite it,  I initially had the first line at the end and it all compilled but no matter what it would change the time.  I would like once there is data in both the timereference cell and the target that the timestamp would not update.  Only if both cells were subsequently cleared.  Any help provided would be gratefully received.</p>\n\n<pre><code>Function Patienttime(reference As Range)\nIf reference.Value &lt;&gt; \"\" And IsEmpty(Patienttime) = False Then End If\nElseIf reference.Value &lt;&gt; \"\" And IsEmpty(Patienttime) = True Then\nPatienttime = Format(Now, \"HH:MM\")\nElseIf IsEmpty(reference.Value) = True Then Patienttime = \"\"\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "ibm-doors"], "comments": [{"owner": {"reputation": 426, "user_id": 8534345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d762686d612f4fffe96eb9ac979286f9?s=128&d=identicon&r=PG&f=1", "display_name": "Russell Bregman", "link": "https://stackoverflow.com/users/8534345/russell-bregman"}, "edited": false, "score": 0, "creation_date": 1551282091, "post_id": 54907847, "comment_id": 96585235, "body": "Hey- just wondering, is there something you NEED from the built in exporter? Or are you just leveraging it because it is there? This will help inform my answer."}, {"owner": {"reputation": 111, "user_id": 7079722, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4076a3cf4d0a37710b6befe2d3f87fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ezor", "link": "https://stackoverflow.com/users/7079722/ezor"}, "reply_to_user": {"reputation": 426, "user_id": 8534345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d762686d612f4fffe96eb9ac979286f9?s=128&d=identicon&r=PG&f=1", "display_name": "Russell Bregman", "link": "https://stackoverflow.com/users/8534345/russell-bregman"}, "edited": false, "score": 0, "creation_date": 1551283853, "post_id": 54907847, "comment_id": 96586470, "body": "hi,  I&#39;m using the build in exporter cause it looks pretty easy to use (just <code>doExcel</code> and there it is).  As I say, I look into it to find how excel is called and so on but i cannot figure it out"}], "owner": {"reputation": 111, "user_id": 7079722, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4076a3cf4d0a37710b6befe2d3f87fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ezor", "link": "https://stackoverflow.com/users/7079722/ezor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 543, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1565778609, "creation_date": 1551278098, "last_edit_date": 1551278128, "question_id": 54907847, "link": "https://stackoverflow.com/questions/54907847/run-excel-macro-from-dxl-export", "title": "Run excel macro from DXL export", "body": "<p>I've found a piece of code to export a DOORS view to excel (using the built in function). However, it doesn't give acces to the OleObject from which I would be able to run a vba macro. </p>\n\n<p>So my question is : How can I make a export to Excel and then run a macro in one click? \nI took a look to the excel.dxl built-in function used to do the export but I'm not very good when it comes to DXL ann OleObject...</p>\n\n<p>Thanks in advance,</p>\n\n<p>PS : here is the code used to export from a given view</p>\n\n<pre><code>    //post by Jim(iron-man?) https://www.ibm.com/developerworks/community/forums/html/topic?id=77777777-0000-0000-0000-000014305335#77777777-0000-0000-0000-000014587301\n\nSkip selectedItems = getSelectedItems ()\nItem I = null\n\nfor I in selectedItems do\n{\n    if(isDeleted(I) || null I) {continue}\n        if (type (I) == \"Formal\")\n        {\n                Module m = read(fullName(I),true)\n                load view \"ExcelExport\"\n                //delete column 0//dont know why this was here to delete the first column after loading the view.\n                {\n                        // override some default message box functions, so they will only print the data but \n                        // not pause execution. Write to a log file here! \n\n                        bool confirm (string s) { print \"Confirmed: \" s \"\\n\"; return true }\n                        void ack (string s) {print \"Acknowledge: \" s \"\\n\" }\n                        void acknowledge (string s) {print \"Acknowledge: \" s \"\\n\"  }\n                        void infobox (string s) {print \"Info: \" s \"\\n\" }\n                        void info (string s) {print \"Info: \" s \"\\n\" }\n\n                        DB theDiag = null\n\n                        // Now override block and show, to only do realize\n                        void show  (DB x) { realize x; theDiag = x }\n                        void block (DB x) { realize x; theDiag = x }\n\n                        if (null current Module) {\n                                print \"You need to have a current Module set for the export.\"\n                                halt\n                        }\n\n                        // we need braces, since -D will be executed at top level and we will get name\n                        // clashes for variable defined in word.dxl and the other includes of it.\n                        {\n                                // now include the word.dxl -&gt; this will pop up the dialog, but not halt execution\n                                // due to the overrides above\n                                #include &lt;standard/export/office/excel.dxl&gt; //for the standard excel exporter\n\n                                // here we can change the dialog options. See itfui2.inc and word.dxl for all \n                                // the options\n                               // set(exportHeadingsToggle, false)   // turn off export of headings\n                               //set(exportWarnUnregOLE,false)   //turn off ole warning\n\n                                // now manually launch the export button callback\n                                doExcel theDiag //for the standard excel exporter\n\n                                // get rid of the dialog\n                                if (!null theDiag) destroy theDiag\n                                                                // close DOORS\n                                //exit_\n                        }\n                }\n                close(m)\n\n        }\n}\n\ndelete selectedItems\n</code></pre>\n"}, {"tags": ["excel", "vba", "startup", "userform"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551277570, "post_id": 54907589, "comment_id": 96582388, "body": "Can you post the code rather than screen shots please.  Thanks.  I think you&#39;ve put the form opening in the add-in opening."}, {"owner": {"reputation": 1, "user_id": 11099227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e9ba3798c78db140589a6212bd9968?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Moe", "link": "https://stackoverflow.com/users/11099227/mr-moe"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551278183, "post_id": 54907589, "comment_id": 96582751, "body": "Yes - i thought a picture is more easy to understand when code is in different windows. To your question: yes - the whole code is in the add-in(xlam) and the userform is called in the add-in under &quot;ThisWorkbook&quot;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551278409, "post_id": 54907589, "comment_id": 96582895, "body": "So this will only trigger on opening Excel, not each workbook."}, {"owner": {"reputation": 1, "user_id": 11099227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e9ba3798c78db140589a6212bd9968?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Moe", "link": "https://stackoverflow.com/users/11099227/mr-moe"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551281581, "post_id": 54907589, "comment_id": 96584892, "body": "sry but i am a bit puzzled. Maybe my aim is not clear: I have a toolbox with small programs for excel--&gt;the add-in. When I open excel, the add in is called and I can use the toolbox in all workbooks. So it&#39;s enough when the toolbox is called with the first workbook. While opening the toolbox he should check for an update and if an update is available open a userform. If you reject the update, close the userform and open the workbook which I intended to open. But this workbook is not opening. I have to open it a second time because then the toolbox is not called again.(which is okay)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551282008, "post_id": 54907589, "comment_id": 96585167, "body": "Sorry, I thought you wanted the form to show each time a workbook was opening.   I have the following in my userform <code>Private Sub CommandButton1_Click() Me.Hide Unload Me End Sub</code> and this in my addin&#39;s <code>workbook_open</code>  <code>Private Sub Workbook_Open() UserForm1.Show vbModeless End Sub</code>"}, {"owner": {"reputation": 1, "user_id": 11099227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e9ba3798c78db140589a6212bd9968?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Moe", "link": "https://stackoverflow.com/users/11099227/mr-moe"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551282574, "post_id": 54907589, "comment_id": 96585558, "body": "Yes - as I said vbmodeless is working but it would be interesting why it is not working with vbModal. And with vbModeless it is not necessary to open the workbook when you accept to update the toolbox and anyway the userform is finally behind the workbook. So its a question of &quot;user experience&quot; :-) - anyway: thanks for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11099227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e9ba3798c78db140589a6212bd9968?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Moe", "link": "https://stackoverflow.com/users/11099227/mr-moe"}, "edited": false, "score": 0, "creation_date": 1551283847, "post_id": 54907824, "comment_id": 96586465, "body": "Sry - does not solve my problem - I want the form open just before the first workbook is opening and the problem is, that after the UF is called and then closed the workbook is not opening. - Thanks for your effort"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1, "user_id": 11099227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e9ba3798c78db140589a6212bd9968?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Moe", "link": "https://stackoverflow.com/users/11099227/mr-moe"}, "edited": false, "score": 0, "creation_date": 1551284037, "post_id": 54907824, "comment_id": 96586597, "body": "No worries, misunderstood.  You could use this answer with a <code>if workbooks.count=0 then userform.show</code> ???"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1551278028, "creation_date": 1551278028, "answer_id": 54907824, "question_id": 54907589, "link": "https://stackoverflow.com/questions/54907589/workbook-does-not-open-when-add-in-calls-a-userform-at-start-up/54907824#54907824", "title": "workbook does not open when add in calls a userform at start up", "body": "<p>In your add-in you need to listen to Excel's events.  So you need to create a class, based on the Excel Application.</p>\n\n<p>So you would have a class called <code>clsCustomExcelHandlers</code> like so</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents ExcelApplication As Excel.Application\n\nPrivate Sub ExcelApplication_WorkbookOpen(ByVal Wb As Workbook)\n        '   Do something here\n        MsgBox \"You have opened \" &amp; Wb.FullName\nEnd Sub\n</code></pre>\n\n<p>and then in a standard module, have a public variable holding an instance of this class</p>\n\n<p><code>Public clsCustomExcel As clsCustomExcelHandlers</code></p>\n\n<p>and then in the add-in <code>Workbook_open</code> you set it up</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Set clsCustomExcel = New clsCustomExcelHandlers\n    Set clsCustomExcel.ExcelApplication = Application\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11099227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e9ba3798c78db140589a6212bd9968?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Moe", "link": "https://stackoverflow.com/users/11099227/mr-moe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551278028, "creation_date": 1551277325, "last_edit_date": 1551277473, "question_id": 54907589, "link": "https://stackoverflow.com/questions/54907589/workbook-does-not-open-when-add-in-calls-a-userform-at-start-up", "title": "workbook does not open when add in calls a userform at start up", "body": "<p>I have an excel add in(xlam) which calls a userform when excel is opening. </p>\n\n<p>When I now open an existing excel file, the userform show up as expected and I can click the \"OK\" button which closes the userform. Unfortunately afterwards, the workbook I intended to open <strong>does not show up.</strong>  </p>\n\n<ul>\n<li>it is working with vbmodeless, so it seems to be connected to \"hide\" or \"unload\" of the userform</li>\n<li>when I open a new excel workbook it is working fine</li>\n</ul>\n\n<p>Does anybody know why the workbook is not opening? Does excel forget the workbook he intended to open?</p>\n\n<p><a href=\"https://i.stack.imgur.com/kGcq1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kGcq1.png\" alt=\"code of the add in\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1551277464, "post_id": 54907507, "comment_id": 96582310, "body": "That&#39;s lots of requirements for 1 question. I would suggest you do this 1 at a time. Post a question with your first requirement that isn&#39;t working. Once resolved, post the next requirement"}, {"owner": {"reputation": 1, "user_id": 11125329, "user_type": "registered", "profile_image": "https://graph.facebook.com/2123230091280333/picture?type=large", "display_name": "Mariana Ferreira", "link": "https://stackoverflow.com/users/11125329/mariana-ferreira"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551277899, "post_id": 54907507, "comment_id": 96582566, "body": "Alright I&#39;ll edit the post, thanks!"}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1551278441, "post_id": 54907507, "comment_id": 96582924, "body": "Before you go too far change your exit procedure to check only the field you are exiting. As you have it coded I could not leave TextBox3 if there is something wrong with TextBox4 (so how could I ever fix TextBox4).  You should also work hard on getting indentation of code right, makes checking your IF&#39;s much easier"}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1551279040, "post_id": 54907507, "comment_id": 96583278, "body": "Also use an OK button or similar to run the overall validation of the form. So when the user clicks that button all fields are checked - you&#39;re mixing up 2 separate capabilities into a single Exit procedure that should only check that one field"}], "answers": [{"tags": [], "owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "is_accepted": false, "score": 0, "last_activity_date": 1551280249, "last_edit_date": 1551280249, "creation_date": 1551279636, "answer_id": 54908378, "question_id": 54907507, "link": "https://stackoverflow.com/questions/54907507/vba-user-form-that-returns-data-to-next-empty-row-in-excel-spreadsheet-and-limit/54908378#54908378", "title": "VBA user form that returns data to next empty row in excel spreadsheet and limit data type for date in specific textbox", "body": "<p>This is not an answer this is just to help you see it more clearly\nAll I've done is re-arrange your code and provide consistent indentation</p>\n\n<p>You had, no end sub for one procedure and code mixed up between the two, with an endif that belonged in one in the other</p>\n\n<p>Anyway - this is your code ... with only minor changes .... make exit procedure just check the 1 field</p>\n\n<pre><code>Private Sub TextBox3_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n  'Check if data in TextBox is date\n  If Not (IsDate(TextBox3.Text)) Then ' And (IsDate(TextBox4.Text)) And (IsDate(TextBox5.Text)) And (IsDate(TextBox6.Text))) Then\n    MsgBox \"Date Required\"\n    Cancel = True\n  Else\n  End If\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n  'Last ditch validation before committing input values to document.\n  Dim booConfirmation As Boolean\n  'Check for data\n\n  'Display name so user can check and confirm.\n  booConfirmation = MsgBox(\"Are the entries \" &amp; TextBox1 &amp; \" \" &amp; TextBox2 &amp; \" \" &amp; TextBox3 &amp; \" \" &amp; TextBox4 &amp; \" \" &amp; TextBox7 &amp; \" \" &amp; TextBox8 &amp; \" \" &amp; TextBox9 &amp; \" \" &amp; TextBox10 &amp; \" \" &amp; TextBox11 &amp; \"correct?\", vbYesNo)\n\n  'If booConfirmation Then\n  If booConfirmation = vbNo Then\n    MsgBox \"Please correct the entries\"\n\n    Set ws = Sheets(\"Inputs\")\n    LastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    ws.Range(\"B\" &amp; LastRow).Value = \"\" 'if entries are incorrect erase the data that should be entered into the sheet'\n    ws.Range(\"C\" &amp; LastRow).Value = \"\"\n    ws.Range(\"D\" &amp; LastRow).Value = \"\"\n    ws.Range(\"E\" &amp; LastRow).Value = \"\"\n    ws.Range(\"F\" &amp; LastRow).Value = \"\"\n    ws.Range(\"G\" &amp; LastRow).Value = \"\"\n    ws.Range(\"H\" &amp; LastRow).Value = \"\"\n    ws.Range(\"I\" &amp; LastRow).Value = \"\"\n    ws.Range(\"J\" &amp; LastRow).Value = \"\"\n    ws.Range(\"K\" &amp; LastRow).Value = \"\"\n    ws.Range(\"L\" &amp; LastRow).Value = \"\"\n\n    Exit Sub\n Else\n    Set ws = Sheets(\"Inputs\")\n    LastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n    ws.Range(\"B\" &amp; LastRow).Value = TextBox1.Text 'Adds the TextBox1 into Col B &amp; Last Blank Row\n    ws.Range(\"C\" &amp; LastRow).Value = TextBox2.Text 'Adds the TextBox2 into Col C &amp; Last Blank Row\n    ws.Range(\"D\" &amp; LastRow).Value = TextBox3.Text\n    ws.Range(\"E\" &amp; LastRow).Value = TextBox4.Text\n    ws.Range(\"F\" &amp; LastRow).Value = TextBox5.Text\n    ws.Range(\"G\" &amp; LastRow).Value = TextBox6.Text\n    ws.Range(\"H\" &amp; LastRow).Value = TextBox7.Text\n    ws.Range(\"I\" &amp; LastRow).Value = TextBox8.Text\n    ws.Range(\"J\" &amp; LastRow).Value = TextBox9.Text\n    ws.Range(\"K\" &amp; LastRow).Value = TextBox10.Text\n    ws.Range(\"L\" &amp; LastRow).Value = TextBox11.Text\nEnd If\n\nUnload Me\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11125329, "user_type": "registered", "profile_image": "https://graph.facebook.com/2123230091280333/picture?type=large", "display_name": "Mariana Ferreira", "link": "https://stackoverflow.com/users/11125329/mariana-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551280249, "creation_date": 1551277079, "question_id": 54907507, "link": "https://stackoverflow.com/questions/54907507/vba-user-form-that-returns-data-to-next-empty-row-in-excel-spreadsheet-and-limit", "title": "VBA user form that returns data to next empty row in excel spreadsheet and limit data type for date in specific textbox", "body": "<p>I am trying to make an excel user form through VBA. It should:</p>\n\n<ol>\n<li>Take the data entered in the textboxes and put it into the next empty row in a specific sheet </li>\n<li>In some textBoxes (specifically TextBox3, TextBox4, TextBox5 and TextBox6) should only be entered date data type. If the user enters any other data format an error message should appear and the form should close, not filling the next empty row that it was about to fill in the sheet.</li>\n<li>All textBoxes should have an input, except TextBox5 and TextBox6, these could be empty, if any other textbox is empty an error message should appear.</li>\n<li>After the proper inputs are made a confirmation msgbox should appear for the user to check any error, before the form closes </li>\n</ol>\n\n<p>Step 1 I've menaged to do but 2 and 3 are not working properly with what I have so far (I can me more specific with the errors if needed). I'm new to VBA and programming and think I've messed with the 'Ifs'. Thanks in advence for any help!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'Check if data in TextBox is date\nPrivate Sub TextBox3_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n    If Not ((IsDate(TextBox3.Text)) And (IsDate(TextBox4.Text)) And (IsDate(TextBox5.Text)) And (IsDate(TextBox6.Text))) Then\n        MsgBox \"Date Required\"\n        Cancel = True\n    Else\n\n'Last ditch validation before committing input values to document.\n    Dim booConfirmation As Boolean\n    'Check for data\n    If Len(TextBox1.Text) = 0 Or Len(TextBox2.Text) = 0 Or Len(TextBox3.Text) = 0 Or Len(TextBox4.Text) = 0 Or Len(TextBox7.Text) = 0 Or Len(TextBox8.Text) = 0 Or Len(TextBox9.Text) = 0 Or Len(TextBox10.Text) = 0 Or Len(TextBox11.Text) = 0 Then\n        MsgBox \"Empty entries\", vbOKOnly, \"Input Error\"    \n    End If\n\n    'Display name so user can check and confirm.\n    booConfirmation = MsgBox(\"Are the entries \" &amp; TextBox1 &amp; \" \" &amp; TextBox2 &amp; \" \" &amp; TextBox3 &amp; \" \" &amp; TextBox4 &amp; \" \" &amp; TextBox7 &amp; \" \" &amp; TextBox8 &amp; \" \" &amp; TextBox9 &amp; \" \" &amp; TextBox10 &amp; \" \" &amp; TextBox11 &amp; \"correct?\", vbYesNo)\n\n    'If booConfirmation Then\n    If booConfirmation = vbNo Then\n\nMsgBox \"Please correct the entries\"\n\nSet ws = Sheets(\"Inputs\")\nLastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\nws.Range(\"B\" &amp; LastRow).Value = \"\" 'if entries are incorrect erase the data that should be entered into the sheet'\nws.Range(\"C\" &amp; LastRow).Value = \"\"\nws.Range(\"D\" &amp; LastRow).Value = \"\"\nws.Range(\"E\" &amp; LastRow).Value = \"\"\nws.Range(\"F\" &amp; LastRow).Value = \"\"\nws.Range(\"G\" &amp; LastRow).Value = \"\"\nws.Range(\"H\" &amp; LastRow).Value = \"\"\nws.Range(\"I\" &amp; LastRow).Value = \"\"\nws.Range(\"J\" &amp; LastRow).Value = \"\"\nws.Range(\"K\" &amp; LastRow).Value = \"\"\nws.Range(\"L\" &amp; LastRow).Value = \"\"\n\nExit Sub\n\n\n\n Else\nSet ws = Sheets(\"Inputs\")\n    LastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n    ws.Range(\"B\" &amp; LastRow).Value = TextBox1.Text 'Adds the TextBox1 into Col B &amp; Last Blank Row\n    ws.Range(\"C\" &amp; LastRow).Value = TextBox2.Text 'Adds the TextBox2 into Col C &amp; Last Blank Row\n    ws.Range(\"D\" &amp; LastRow).Value = TextBox3.Text\n    ws.Range(\"E\" &amp; LastRow).Value = TextBox4.Text\n    ws.Range(\"F\" &amp; LastRow).Value = TextBox5.Text\n    ws.Range(\"G\" &amp; LastRow).Value = TextBox6.Text\n    ws.Range(\"H\" &amp; LastRow).Value = TextBox7.Text\n    ws.Range(\"I\" &amp; LastRow).Value = TextBox8.Text\n    ws.Range(\"J\" &amp; LastRow).Value = TextBox9.Text\n    ws.Range(\"K\" &amp; LastRow).Value = TextBox10.Text\n    ws.Range(\"L\" &amp; LastRow).Value = TextBox11.Text\n\n\n\nEnd If\nEnd If\n\nUnload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1551277200, "post_id": 54907449, "comment_id": 96582130, "body": "Did you select all the cells when applying the conditional format?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1551277335, "post_id": 54907449, "comment_id": 96582211, "body": "It can be very easy conditional formatting. Don&#39;t use VBA for this."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1551277749, "post_id": 54907449, "comment_id": 96582482, "body": "If you&#39;re after some VBA code then I&#39;m afraid this isn&#39;t the right place. If you want help with your conditional formatting please show us your rule and what you&#39;ve tried so far. Likewise if you want help with getting some VBA to work, show us what you&#39;ve tried so far."}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 3, "last_activity_date": 1551277658, "creation_date": 1551277658, "answer_id": 54907703, "question_id": 54907449, "link": "https://stackoverflow.com/questions/54907449/highlight-cells-using-vba/54907703#54907703", "title": "Highlight cells using VBA", "body": "<p>Few steps only:</p>\n\n<ul>\n<li>Create new conditional formatting rule: <code>=$A$1=\"test1\"</code></li>\n<li>Choose your formatting</li>\n<li>Choose range for conditional formatting rule and hold down <kbd>ctrl</kbd> to select multiple cells (see below)</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/lU1aL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lU1aL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 11125290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deed778dbad8400ee66cd792daa75b18?s=128&d=identicon&r=PG&f=1", "display_name": "Joris", "link": "https://stackoverflow.com/users/11125290/joris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1551277734, "creation_date": 1551276910, "last_edit_date": 1551277734, "question_id": 54907449, "link": "https://stackoverflow.com/questions/54907449/highlight-cells-using-vba", "title": "Highlight cells using VBA", "body": "<p>I want some cells to highlight when for example cell A1 is \"test1\".\nI tried to use conditional formatting but it only highlights that particular cell and nog a variety of other cells.\nI'm not a very experienced excel user but i think it is a simple VBA code to do this.</p>\n\n<p>I hope somebody can help me here.\nTx</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 2, "creation_date": 1551277200, "post_id": 54907392, "comment_id": 96582129, "body": "Press debug when error arises and paste the screenshot so we can understand better what\u2019s happening"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1551277323, "post_id": 54907392, "comment_id": 96582202, "body": "@RicardoDiaz No screenshots of code or errors please read <a href=\"http://idownvotedbecau.se/imageofcode\" rel=\"nofollow noreferrer\">An image of your code is not helpful</a>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551277375, "post_id": 54907392, "comment_id": 96582248, "body": "@Vijayakumar Please <a href=\"https://stackoverflow.com/posts/54907392/edit\">edit</a> your question and tell us in which line of code the error occurs (after you pressed the &quot;Debug&quot; button)."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1551277599, "post_id": 54907392, "comment_id": 96582407, "body": "Just checking you know it&#39;s <code>ByVal</code> - not <code>By Val</code> ?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551277876, "post_id": 54907392, "comment_id": 96582553, "body": "@P\u1d07\u029c You\u2019re right. Just to see what line. OP posted the code already."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1551278002, "post_id": 54907392, "comment_id": 96582641, "body": "@RicardoDiaz What I meant is we don&#39;t need an image to see which line it is, he just needs to tell us in which line the error occurs."}, {"owner": {"reputation": 379, "user_id": 10075965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378489c6e9def69bfa0c97601bc1958b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10075965/sai"}, "edited": false, "score": 0, "creation_date": 1551278357, "post_id": 54907392, "comment_id": 96582860, "body": "When i clcik the debug button i am getting the error in the below line If Target.Column = 2 And Target.Cells.Count = 1 And Target.Value = &quot;CreateAccount_Personal&quot; Then"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551278483, "post_id": 54907392, "comment_id": 96582953, "body": "@P\u1d07\u029c Thanks for pointing that out"}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 10075965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378489c6e9def69bfa0c97601bc1958b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10075965/sai"}, "edited": false, "score": 0, "creation_date": 1551280102, "post_id": 54908371, "comment_id": 96583953, "body": "I am getting  runtime error 13 in the below line If Err.Number &lt;&gt; 0 Then Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 379, "user_id": 10075965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378489c6e9def69bfa0c97601bc1958b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10075965/sai"}, "edited": false, "score": 0, "creation_date": 1551280496, "post_id": 54908371, "comment_id": 96584219, "body": "@Vijayakumarj See my edited answer. This will fix it."}, {"owner": {"reputation": 379, "user_id": 10075965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378489c6e9def69bfa0c97601bc1958b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10075965/sai"}, "edited": false, "score": 0, "creation_date": 1551281043, "post_id": 54908371, "comment_id": 96584580, "body": "Hi PEH ,Thank you so much. It is working  without showing any error. Thanks a lot again . May i know what is the issue with earlier code"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 379, "user_id": 10075965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378489c6e9def69bfa0c97601bc1958b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10075965/sai"}, "edited": false, "score": 1, "creation_date": 1551281171, "post_id": 54908371, "comment_id": 96584651, "body": "The issue is that if <code>Target</code> is more than one cell then <code>Target.Value</code> returns an array of values and <code>If Target.Cells.Count = 1 And Target.Value = &quot;Create Account_Personal&quot;</code> fails because the second part of the <code>And</code> is tested even if the first part is <code>false</code>."}, {"owner": {"reputation": 379, "user_id": 10075965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378489c6e9def69bfa0c97601bc1958b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10075965/sai"}, "edited": false, "score": 1, "creation_date": 1551281333, "post_id": 54908371, "comment_id": 96584763, "body": "Hi PEH, I got it . Thank you for clarifying and fixing the issue"}, {"owner": {"reputation": 379, "user_id": 10075965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378489c6e9def69bfa0c97601bc1958b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10075965/sai"}, "edited": false, "score": 0, "creation_date": 1551977523, "post_id": 54908371, "comment_id": 96848071, "body": "Hi PEH , I am having 3 columns A,B,C if column A and B is yes then I have to change column c is correct . could you please help me how we can check 2 columns at a time. when I am using below stmt i am not able to do it If Target.Row &gt; 2 And Target.Row &lt; 100 Then If Target.Column = 2 And Target.Cells.Count = 1 Then  if Target.value=&quot;YES&quot;then If Target.Column = 3 And Target.Cells.Count = 1 Then if Target.value=&quot;YES&quot; then Target.offset(0,1).value=&quot;c&quot; End if End if End if End if"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1551280472, "last_edit_date": 1551280472, "creation_date": 1551279621, "answer_id": 54908371, "question_id": 54907392, "link": "https://stackoverflow.com/questions/54907392/getting-run-time-error-13-vba-excel-macro/54908371#54908371", "title": "Getting Run time Error 13- VBA excel macro", "body": "<ol>\n<li>Disable events by using <code>Application.EnableEvents = False</code></li>\n<li><p>For consecutive cells use  \u2026</p>\n\n<pre><code>Target.Parent.Range(Target.Offset(0, 3), Target.Offset(0, 11)).Value = \"NA\"\n</code></pre>\n\n<p>\u2026 to write  <code>NA</code> between column 3 and 11. Which is much shorter and faster.</p></li>\n</ol>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    On Error GoTo ENABLE_EVENTS\n\n    If Target.Row &gt; 2 And Target.Row &lt; 100 Then\n        If Target.Column = 2 And Target.Cells.Count = 1 Then\n            If Target.Value = \"Create Account_Personal\" Then\n                Target.Parent.Range(Target.Offset(0, 3), Target.Offset(0, 11)).Value = \"NA\"\n                Target.Offset(0, 19).Value = \"NO\"\n                Target.Offset(0, 22).Value = \"NO THANKS\"\n            ElseIf Target.Value &lt;&gt; \"Create Account_Personal\" Then\n                Target.Offset(0, 3).Value = \"Select Country\"\n            End If\n        End If\n\n        If Target.Column = 5 And Target.Cells.Count = 1 Then\n            If Target.Value &lt;&gt; \"NA\" Then\n                Target.Offset(0, 1).Value = \"select State\"\n                Target.Parent.Range(Target.Offset(0, 2), Target.Offset(0, 7)).Value = \"\"\n                Target.Parent.Range(Target.Offset(0, 9), Target.Offset(0, 15)).Value = \"\"\n            End If\n        End If\n    End If\n\nENABLE_EVENTS:\n    Application.EnableEvents = True\n    If Err.Number &lt;&gt; 0 Then Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 10075965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378489c6e9def69bfa0c97601bc1958b?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/10075965/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 54908371, "answer_count": 1, "score": 0, "last_activity_date": 1551280472, "creation_date": 1551276735, "last_edit_date": 1551279254, "question_id": 54907392, "link": "https://stackoverflow.com/questions/54907392/getting-run-time-error-13-vba-excel-macro", "title": "Getting Run time Error 13- VBA excel macro", "body": "<p><a href=\"https://i.stack.imgur.com/8wZkI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8wZkI.png\" alt=\"enter image description here\"></a> Hi I am having a excel file. There is a macro in the excel file to clear the dependent drop down list . When we copy the value from one row to another row or one column to another column we are getting run time error 13. Could you please help us to resolve the issue </p>\n\n<p>Code :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n           If Target.Row &gt; 2 And Target.Row &lt; 100 Then\n\n   If Target.Column = 2 And Target.Cells.Count = 1 And Target.Value = \"Create Account_Personal\" Then   \n    Target.Offset(0, 3).Value = \"NA\"\n   Target.Offset(0, 4).Value = \"NA\"\n   Target.Offset(0, 5).Value = \"NA\"\n   Target.Offset(0, 6).Value = \"NA\"\n   Target.Offset(0, 7).Value = \"NA\"\n   Target.Offset(0, 8).Value = \"NA\"\n   Target.Offset(0, 9).Value = \"NA\"\n   Target.Offset(0, 10).Value = \"NA\"\n   Target.Offset(0, 11).Value = \"NA\"\n     Target.Offset(0, 19).Value = \"NO\"\n   Target.Offset(0, 22).Value = \"NO THANKS\"\n\n      ElseIf Target.Column = 2 And Target.Cells.Count = 1 And Target.Value &lt;&gt; \"Create Account_Personal\" Then\n      Target.Offset(0, 3).Value = \"Select Country\"\n\nEnd If\n   If Target.Column = 5 And Target.Cells.Count = 1 And Target.Value &lt;&gt; \"NA\" Then\n   Target.Offset(0, 1).Value = \"select State\"\n   Target.Offset(0, 2).Value = \"\"\n   Target.Offset(0, 3).Value = \"\"\n   Target.Offset(0, 4).Value = \"\"\n   Target.Offset(0, 5).Value = \"\"\n   Target.Offset(0, 6).Value = \"\"\n   Target.Offset(0, 7).Value = \"\"\n   Target.Offset(0, 9).Value = \"\"\n   Target.Offset(0, 10).Value = \"\"\n   Target.Offset(0, 11).Value = \"\"\n   Target.Offset(0, 12).Value = \"\"\n   Target.Offset(0, 13).Value = \"\"\n   Target.Offset(0, 14).Value = \"\"\n   Target.Offset(0, 15).Value = \"\"\n  End If\n\nEnd If\nEnd Sub`enter code here`\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/x8ZSb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x8ZSb.png\" alt=\"image\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551276629, "post_id": 54907277, "comment_id": 96581740, "body": "Note: the code I am using is: File = Application.DefaultFilePath &amp; &quot;\\Filename.txt&quot;"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1551276967, "post_id": 54907277, "comment_id": 96581967, "body": "It\u2019s better if you post all the relevant code"}, {"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1551277240, "post_id": 54907277, "comment_id": 96582156, "body": "Done that, see my answer"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1551278015, "post_id": 54907277, "comment_id": 96582646, "body": "You can edit your question and paste the code inside. Please delete the answer as others may get confused"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551278660, "post_id": 54907873, "comment_id": 96583078, "body": "&quot;Run time error 75: error in accessing path/file&quot;.    I checked and the path is correct, is it because i&#39;m on a network?"}, {"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551279542, "post_id": 54907873, "comment_id": 96583604, "body": "I corrected the runtime error, but now I have another problem whose source I can&#39;t trace: after a few clicks, some of the cells the text is written in (in the excel file) suddenly gain a red tinge. Any clues?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551279635, "post_id": 54907873, "comment_id": 96583665, "body": "Could you post a screenshot of the cells?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551280119, "post_id": 54907873, "comment_id": 96583964, "body": "That seems to be a conditional format. Please check"}, {"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551280326, "post_id": 54907873, "comment_id": 96584100, "body": "I&#39;m sorry but I&#39;m inexperienced in VB and VBA. What do you mean with conditional format?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551280526, "post_id": 54907873, "comment_id": 96584239, "body": "Not a vba issue, but check if cells have regular conditional format. See <a href=\"https://support.office.com/en-us/article/conditional-formatting-6b6f7c2a-5d62-45a1-8f67-584a76776d67\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551281178, "post_id": 54907873, "comment_id": 96584652, "body": "Thanks for the help, but this actually works in my favor, so I&#39;m going to pretend that &quot;it&#39;s not a bug, it&#39;s a feature&quot; :)"}], "tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1551278950, "last_edit_date": 1551278950, "creation_date": 1551278189, "answer_id": 54907873, "question_id": 54907277, "link": "https://stackoverflow.com/questions/54907277/how-do-i-change-the-file-path-when-writing-a-vba-excel-application-that-writes/54907873#54907873", "title": "How do I change the file path when writing a VBA (Excel) application that writes from an Excel file into a txt file?", "body": "<p>Replace this line: </p>\n\n<pre><code>File = Application.DefaultFilePath &amp; \"\\Filename.txt\"\n</code></pre>\n\n<p>With the full path where you want the file location. For example:</p>\n\n<pre><code>File = \"C:\\MyFolder\\Filename.txt\"\n</code></pre>\n\n<p>And correct this line:</p>\n\n<pre><code>Open myFile For Append As #1\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>Open File For Append As #1\n</code></pre>\n\n<p>I also suggest that you add option explicit at the beginning of the vba module so you prevent from having undeclared variables</p>\n"}], "owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 54907873, "answer_count": 1, "score": 0, "last_activity_date": 1551279780, "creation_date": 1551276351, "last_edit_date": 1551279780, "question_id": 54907277, "link": "https://stackoverflow.com/questions/54907277/how-do-i-change-the-file-path-when-writing-a-vba-excel-application-that-writes", "title": "How do I change the file path when writing a VBA (Excel) application that writes from an Excel file into a txt file?", "body": "<p>How do I change the file path when writing a VBA (Excel) application that writes from an Excel file into a text file? Whatever I do, it either just gives me an error or creates it in the same folder (Documents).</p>\n\n<p>Full relevant code:</p>\n\n<pre><code>Dim x As Integer\n\nDim tmp As String\n\n\nSub CommandButton1_Click()\nDim File As String, rng As Range, cellValue As Variant, i As Integer, j As Integer\n    File = Application.DefaultFilePath &amp; \"\\Viteria_mancante_o_in_esaurimento.txt\"\n    Set rng = Selection\n    Open myFile For Append As #1\n    cellValue = Range(\"C2\").Value\n    Write #1, cellValue\n    cellValue = Range(\"D2\").Value\n    Write #1, cellValue\n    Close #1\ntmp = \"C\" + CStr(12 + x) + \":\" + \"D\" + CStr(12 + x)\nWorksheets(\"Foglio2\").Range(tmp).Value2 = Worksheets(\"Foglio2\").Range(\"C2:D2\").Value2\nx = x + 1\nEnd Sub\n</code></pre>\n\n<p>EDIT:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aJDC6.png\" rel=\"nofollow noreferrer\">Added image of cells turning red.</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1551276043, "post_id": 54907051, "comment_id": 96581351, "body": "What Excel version? This works fine on Excel 2013. One thing you might want to check are the auto-save and auto-recover options."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551276070, "post_id": 54907051, "comment_id": 96581372, "body": "Please include the whole relevant code part or a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1551276104, "post_id": 54907051, "comment_id": 96581407, "body": "<code>Workbooks.Open(ThisWorkbook.FullName)</code> You need to close the workbook without saving and then reopen it...."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551276607, "post_id": 54907051, "comment_id": 96581724, "body": "@Comintern 2016"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551276665, "post_id": 54907051, "comment_id": 96581764, "body": "@P\u1d07\u029c I have. Workbooks.Open(ThisWorkbook.FullName) is all the code you need. Put that in a blank workbook and run it. Nothing happens."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551276811, "post_id": 54907051, "comment_id": 96581877, "body": "@SiddharthRout While you are right this not possible if the code is running in <code>ThisWorkbook</code> ^^ Because closing kills the code execution immediately."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551276845, "post_id": 54907051, "comment_id": 96581902, "body": "@SiddharthRout How would I do that exactly? If the code to re-open the workbook is in the workbook which has just been closed, is that going to work?"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551278386, "post_id": 54907051, "comment_id": 96582878, "body": "Why the down vote? And why the flag to close?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551278583, "post_id": 54907051, "comment_id": 96583023, "body": "No idea. I did not do it. Whoever voted it must have done it by mistake I guess... Anyways I have posted an answer. you may have to refresh the page to see it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551280426, "post_id": 54907051, "comment_id": 96584177, "body": "@P\u1d07\u029c The statement &quot;this not possible if the code is running in ThisWorkbook&quot; is not correct - the OP&#39;s code does exactly what is described in Excel 2013 - execution continues normally, as does the code in the linked question. Closing the workbook has no effect on code running in that workbook unless execution is stopped (or it tries to use the workbook object)."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551280750, "post_id": 54907051, "comment_id": 96584388, "body": "@Comintern Have you actually tried it? Code which comes after the workbook is closed does not run. Code which comes after <code>Workbooks.Open(ThisWorkbook.FullName)</code>, will run, but only because that line has no effect and the workbook is never closed. If you try to run code after changing the file access, as per @P\u1d07\u029c answer, it does not run."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551280779, "post_id": 54907051, "comment_id": 96584408, "body": "@Comintern In Excel 2016 it does nothing. It does not reload the file. Also closing a workbook <b>always</b> breaks code execution."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551280887, "post_id": 54907051, "comment_id": 96584474, "body": "@P\u1d07\u029c Did you try it? Gravitate - Yes. I tried both your code and the linked code. It worked fine in Excel 2013. See the very first comment."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551281235, "post_id": 54907051, "comment_id": 96584694, "body": "@Comintern We aren&#39;t talking about Excel 2013. We are talking about 2016. Although, <code>Workbooks.Open(ThisWorkbook.FullName)</code> may work in 2013, it does not in 2016."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551281322, "post_id": 54907051, "comment_id": 96584756, "body": "I know that. What I&#39;m pointing out is that the statement made in the comment is not <i>universally</i> true. If somebody finds this question later and reads the comments, that will be clear now."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551281413, "post_id": 54907051, "comment_id": 96584806, "body": "@Comintern Right, I see. Sorry, I miss understood."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551281838, "post_id": 54907051, "comment_id": 96585041, "body": "@Comintern But I still find it strange that it works in 2013 but not in 2016 (that means the feature is either broken or removed by purpose). \u2022 Can you confirm that any changes made the workbook get indeed reverted and disappear? \u2022 Because this code indeed does not break code excecution but also it does not revert any changes."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1551281999, "post_id": 54907051, "comment_id": 96585157, "body": "@P\u1d07\u029c Yep - the changes made to the workbook since the last save get reverted in 2013.  As for why, my best guess is that the <i>old</i> behavior was broken and it was fixed. Possibly to address Excel&#39;s nasty habit of leaving ghost processes hanging around?"}], "answers": [{"comments": [{"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551277584, "post_id": 54907460, "comment_id": 96582399, "body": "Thank you. That does work in a simple example, however, when I use it in a real world case where macros run on open/close, I get an &quot;Automation Error&quot;. Also, any code which is supposed to run AFTER the file is reverted, does not. Presumably because the file executing the code has been closed."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551277788, "post_id": 54907460, "comment_id": 96582505, "body": "The issues you describe are no issues specific to the code I posted, you would have them anyway I think. Try to add a <code>Application.EnableEvents = False</code> before file access is changed and <code>Application.EnableEvents = True</code> in the end. This should disable all the events."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551279257, "post_id": 54907460, "comment_id": 96583410, "body": "Yes... except one small thing to take into account... the <code>Application.EnableEvents = True</code> code will never run because the workbook will have already closed, terminating the execution. And you can&#39;t put it in the workbook open event because that won&#39;t run because events are disabled."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551279827, "post_id": 54907460, "comment_id": 96583793, "body": "@Gravitate Ah, you are right. Then you will need to use Siddharth Rout&#39;s workaround."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1551292458, "post_id": 54907460, "comment_id": 96591128, "body": "Code copied from another site should be properly atributed, otherwise it is plagiarism."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1551278097, "last_edit_date": 1551278097, "creation_date": 1551276942, "answer_id": 54907460, "question_id": 54907051, "link": "https://stackoverflow.com/questions/54907051/how-can-i-use-vba-to-revert-thisworkbook-to-a-previously-saved-state/54907460#54907460", "title": "How can I use VBA to revert ThisWorkbook to a previously saved state?", "body": "<p>Try this workaround:</p>\n\n<pre><code>Public Sub ReOpenWithoutSave()\n    Application.EnableEvents = False\n    ThisWorkbook.Saved = True\n    ThisWorkbook.ChangeFileAccess xlReadOnly, , False\n    Application.Wait Now + TimeValue(\"00:00:01\")\n    ThisWorkbook.ChangeFileAccess xlReadWrite, , True\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<ul>\n<li>It marks <code>ThisWorkbook</code> as already saved (but does not save it).</li>\n<li>It makes <code>ThisWorkbook</code> read only and waits 1 second to let it proceed</li>\n<li>It makes <code>ThisWorkbook</code> writeable again (which causes a re-open automatically)</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551279797, "post_id": 54907908, "comment_id": 96583776, "body": "Thank you. That seems utterly over engineered to do something which, to me, should be just a case of <code>Thisworkbook.Revert</code>. But at first try, it seems to work well. I will do a bit more testing and come back. Do you need the <code>Print #1, &quot;WScript.Sleep 300&quot;</code>? Removing it seems to have no adverse affects."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551279873, "post_id": 54907908, "comment_id": 96583825, "body": "@Gravitate just that there is no such <code>ThisWorkbook.Revert</code> :) So you have to go with one of the workarounds. Workarounds are ugly in many cases, but as long as there is no offical way that&#39;s what we have to live with."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551279985, "post_id": 54907908, "comment_id": 96583892, "body": "@P\u1d07\u029c No... I know... already tried that :). I just wish MS could have included it. Wasn&#39;t there a manual &quot;Revert&quot; option in the file menu as some point? Or am I thinking of something else?"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551282825, "post_id": 54907908, "comment_id": 96585725, "body": "@SiddharthRout You might want to change it to <code>Shell &quot;wscript &quot; &amp; Chr(34) &amp; file &amp; Chr(34), vbNormalFocus</code> in case of spaces in the path."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551291607, "post_id": 54907908, "comment_id": 96590701, "body": "@Gravitate: Utterly Overengineered :D ? This is a very basic workaround for what you want. Also it is good to include a wait period. and hence I would recommend <code>WScript.Sleep 300</code>. Also I have edited my post to incorporate your last suggestion. I had missed that..."}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551292333, "post_id": 54907908, "comment_id": 96591060, "body": "@SiddharthRout Yes, it is far more complex than it should have to be (a dig at MS, not you). Creating a separate file and then running it through the shell, then deleting it after seems like a lot of work to go through, just to undo a few changes. It does work and I am very grateful to you because I would never have thought of this solution. However, I do feel like there might be situations which could cause it to fall over, just because of the complexity."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551293393, "post_id": 54907908, "comment_id": 96591564, "body": "@Gravitate: In that case you have not seen attempts where actual &quot;over engineering&quot; happens to &quot;Undo the changes caused by macro&quot;... A far more complex code is written to store/record every change that happens becuase of a code and all that is reset to original state (step by step)... That is sheer madness :D"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1551293513, "post_id": 54907908, "comment_id": 96591620, "body": "One other way I can think of if creating a copy of the file before your code runs and then when you revert, it copies the content of the duplicate file into the existing sheets and then deletes the duplicate? @Gravitate (This again is more tedious than what i suggested above)"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 1, "creation_date": 1551296692, "post_id": 54907908, "comment_id": 96593049, "body": "@SiddharthRout No, I think that is even more complex... particularly because of how complex the workbook in question is. As I say, the solution above works, and I will fix any problems that crop up if/when they happen. Thanks again."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1551291438, "last_edit_date": 1551291438, "creation_date": 1551278320, "answer_id": 54907908, "question_id": 54907051, "link": "https://stackoverflow.com/questions/54907051/how-can-i-use-vba-to-revert-thisworkbook-to-a-previously-saved-state/54907908#54907908", "title": "How can I use VBA to revert ThisWorkbook to a previously saved state?", "body": "<p>Logic:</p>\n\n<p>Close the Excel file without saving and simply re-open it. But then how do I reopen it from the same file?</p>\n\n<ol>\n<li>Create a VBScript from your code</li>\n<li>Put a Delay of say 3 secs in that and the code to open the Excel file</li>\n<li>Call the vbscript and close the current file.</li>\n</ol>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Sub Sample()\n    Dim file As String\n    file = ThisWorkbook.Path &amp; \"\\DeletemeLater.vbs\"\n\n    Sheet1.Range(\"A2\").Value = \"Blah Blah\" '&lt;~~ This change will not be saved\n\n    '~~&gt; Create a vbscript file\n    Open file For Output As #1\n    Print #1, \"WScript.Sleep 300\"\n    Print #1, \"Set oExcelApp = GetObject(,\"\"Excel.Application\"\")\"\n    Print #1, \"oExcelApp.Visible=True\"\n    Print #1, \"Set oWB = oExcelApp.Workbooks.Open(\" &amp; Chr(34) &amp; ThisWorkbook.FullName &amp; Chr(34) &amp; \")\"\n    Close #1\n\n    Shell \"wscript \" &amp; Chr(34) &amp; file &amp; Chr(34), vbNormalFocus\n\n    ThisWorkbook.Close (False)\nEnd Sub\n</code></pre>\n\n<p>And one more thing. Add this in the workbook code area</p>\n\n<pre><code>Private Sub Workbook_Open()\n    On Error Resume Next\n    Kill ThisWorkbook.Path &amp; \"\\DeletemeLater.vbs\"\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 54907908, "answer_count": 2, "score": 0, "last_activity_date": 1551291438, "creation_date": 1551275625, "last_edit_date": 1551281276, "question_id": 54907051, "link": "https://stackoverflow.com/questions/54907051/how-can-i-use-vba-to-revert-thisworkbook-to-a-previously-saved-state", "title": "How can I use VBA to revert ThisWorkbook to a previously saved state?", "body": "<p>I would like a macro to undo ALL changes since the workbook was last opened/saved.</p>\n\n<p>I thought this would be as easy as re-opening the workbook, similar to this answer:\n<a href=\"https://stackoverflow.com/a/44244262/1473412\">https://stackoverflow.com/a/44244262/1473412</a></p>\n\n<p>However, when I use:</p>\n\n<pre><code>Workbooks.Open(ThisWorkbook.FullName)\n</code></pre>\n\n<p>Literally NOTHING happens. No alert, no error, no change. It is as though the command is just ignored. Has this behaviour changed in recent versions of Excel?</p>\n\n<p>What is the easiest way to revert a workbook to its previously saved state in the latest version of excel (2016)?</p>\n\n<p>Thanks, </p>\n"}, {"tags": ["ms-access", "vba", "office365", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9839217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53987b576e5a4fad4f9a6178607a6e22?s=128&d=identicon&r=PG&f=1", "display_name": "davethebrave", "link": "https://stackoverflow.com/users/9839217/davethebrave"}, "edited": false, "score": 0, "creation_date": 1551343051, "post_id": 54907522, "comment_id": 96607901, "body": "I read that too, but isn&#39;t that just to use in an access form? And how do I implement this property in my code?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3, "user_id": 9839217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53987b576e5a4fad4f9a6178607a6e22?s=128&d=identicon&r=PG&f=1", "display_name": "davethebrave", "link": "https://stackoverflow.com/users/9839217/davethebrave"}, "edited": false, "score": 0, "creation_date": 1551346350, "post_id": 54907522, "comment_id": 96609667, "body": "You have posted no code, so hard to tell, but just refer to the form and the property where you need it."}, {"owner": {"reputation": 3, "user_id": 9839217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53987b576e5a4fad4f9a6178607a6e22?s=128&d=identicon&r=PG&f=1", "display_name": "davethebrave", "link": "https://stackoverflow.com/users/9839217/davethebrave"}, "edited": false, "score": 0, "creation_date": 1554710189, "post_id": 54907522, "comment_id": 97836321, "body": "Thank you @Gustav - I didn&#39;t understand that a form can be a query or a table. I thought that by the term form it was literally meant a ms access form."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3, "user_id": 9839217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53987b576e5a4fad4f9a6178607a6e22?s=128&d=identicon&r=PG&f=1", "display_name": "davethebrave", "link": "https://stackoverflow.com/users/9839217/davethebrave"}, "edited": false, "score": 0, "creation_date": 1554715040, "post_id": 54907522, "comment_id": 97838945, "body": "True. However, a form may hold a recordset(clone), but that doesn&#39;t make it neither a table nor a query."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1551277127, "creation_date": 1551277127, "answer_id": 54907522, "question_id": 54906952, "link": "https://stackoverflow.com/questions/54906952/count-marked-selected-records-rows-in-access-table/54907522#54907522", "title": "Count marked/selected records/rows in access table", "body": "<p>The <em>Form property</em> <code>SelHeight</code> returns the count of selected records.</p>\n"}], "owner": {"reputation": 3, "user_id": 9839217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53987b576e5a4fad4f9a6178607a6e22?s=128&d=identicon&r=PG&f=1", "display_name": "davethebrave", "link": "https://stackoverflow.com/users/9839217/davethebrave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 54907522, "answer_count": 1, "score": 0, "last_activity_date": 1551277162, "creation_date": 1551275328, "last_edit_date": 1551277162, "question_id": 54906952, "link": "https://stackoverflow.com/questions/54906952/count-marked-selected-records-rows-in-access-table", "title": "Count marked/selected records/rows in access table", "body": "<p>I need an option where I can select a range of records or rows in an access table or access query <a href=\"https://i.stack.imgur.com/d8Xos.png\" rel=\"nofollow noreferrer\">(see this screenshot)</a> and then have something to tell me how many records I have actually selected.</p>\n\n<p>When working with copy &amp; paste, this is a very helpful feature, if you work with big data tables. I have searched long and hard but no-one seems to be providing a solution by manually selecting with your cursor.</p>\n\n<p>Does anyone know any solution to this? (maybe implementing a vba macro?)</p>\n\n<hr>\n\n<p><strong>A little bit of background information:</strong></p>\n\n<p>My co-worker used to work with an excel file and got very used to the functionalities of excel. As time went on the excel file became bigger and bigger -  by now it takes approximately two minutes to start up the excel file.</p>\n\n<p>He hit me up and asked me if I knew a clever solution for him - so I thought MS Access would be the perfect software for him.</p>\n\n<p>Since he's going to work with copy &amp; paste it's necessary to know how many records he has copied - so that he knows how many records he needs to select to paste the copied records (access isn't as flexible as excel when it comes to using copy &amp; paste).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551276137, "post_id": 54906773, "comment_id": 96581433, "body": "Where is <code>ShSummary</code> defined?"}, {"owner": {"reputation": 1, "user_id": 11125270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tCOf6Lkybuc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTrOZy8MjMRUl5jOtQBDBjHPTVhg/mo/photo.jpg?sz=128", "display_name": "Hannah", "link": "https://stackoverflow.com/users/11125270/hannah"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551276705, "post_id": 54906773, "comment_id": 96581790, "body": "ShSummary is the code name of the sheet (I.e. I renamed \u201cSheet 2\u201d in case another user renames the tab at any point)"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1551277204, "post_id": 54906773, "comment_id": 96582136, "body": "You might want to take a look <a href=\"https://stackoverflow.com/questions/41477794/refer-to-sheet-using-codename\">here</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551280212, "post_id": 54906773, "comment_id": 96584031, "body": "If <code>ShSummary</code> is the code name, you don&#39;t need to look it up in the <code>Worksheets</code> collection. <code>ShSummary.Range(&quot;B5&quot;)</code> instead of <code>ThisWorkbook.Worksheets(ShSummary).Range(&quot;B5&quot;)</code>."}], "owner": {"reputation": 1, "user_id": 11125270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tCOf6Lkybuc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTrOZy8MjMRUl5jOtQBDBjHPTVhg/mo/photo.jpg?sz=128", "display_name": "Hannah", "link": "https://stackoverflow.com/users/11125270/hannah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551275980, "creation_date": 1551274653, "last_edit_date": 1551275980, "question_id": 54906773, "link": "https://stackoverflow.com/questions/54906773/runtime-error-13-mismatch-error-pasting-in-vba", "title": "&quot;runtime error 13: mismatch&quot; error - Pasting in vba", "body": "<p>I am in the process of putting together a tool that collects data from several excel files and pastes values into a summary sheet (the same file as contains vba).</p>\n\n<p>For some reason I keep getting a \"runtime error 13: mismatch\" error for the last line of the code so far:</p>\n\n<pre><code> ThisWorkbook.Worksheets(ShSummary).Range(\"B5\")\n</code></pre>\n\n<p>I'm guessing that maybe it doesn't like the \"ThisWorkbook\" reference, but I haven't had this issue before. Any ideas?</p>\n\n<pre><code>Sub Import_Data()\n\n    Dim FilePth As String\n    Dim SourceBook As Workbook\n    Dim LastCell_Nbr As Integer\n\n'Open Follow Up file\n    FilePth = \"C:\\Users\\xxx\\Desktop\\xxx\\xxx\\Follow-up_File.xlsm\"\n    Set SourceBook = Application.Workbooks.Open(FilePth)\n    ActiveSheet.ShowAllData\n    LastCell_Nbr = Workbooks(\"Follow-up_File.xlsm\").Sheets(\"Follow up\").Cells(Rows.Count, \"C\").End(xlUp).Row\n\n'Copy and paste data values into summary sheet\n    SourceBook.Sheets(\"Follow up\").Range(\"A5:A\" &amp; LastCell_Nbr).Copy _\n        ThisWorkbook.Worksheets(ShSummary).Range(\"B5\")\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "interface", "mvp"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1551274141, "post_id": 54906457, "comment_id": 96580211, "body": "Did you declare the IView object in the form WithEvents?"}, {"owner": {"reputation": 1, "user_id": 11125215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc5d4f2b5a11f69c9524b680085b26d0?s=128&d=identicon&r=PG&f=1", "display_name": "Tipejn", "link": "https://stackoverflow.com/users/11125215/tipejn"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1551274366, "post_id": 54906457, "comment_id": 96580343, "body": "I want the form to be an implementation of the interface, so I don&#39;t have IView object. I use: Implements IView"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1551274980, "post_id": 54906457, "comment_id": 96580727, "body": "An <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> would be nice. I don&#39;t think you can directly have event handling and inteface (WithEvents and Implements). See <a href=\"https://stackoverflow.com/questions/41023670/can-we-use-interfaces-and-events-together-at-the-same-time\" title=\"can we use interfaces and events together at the same time\">stackoverflow.com/questions/41023670/&hellip;</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1551275426, "post_id": 54906457, "comment_id": 96581007, "body": "No, it isn&#39;t possible. The best way to verify this is by not implementing the <code>Event</code> along with the rest of the interface.  This still compiles - if the <code>Event</code> was considered part of the interface you&#39;d get a compile error."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": -1, "last_activity_date": 1551274226, "creation_date": 1551274226, "answer_id": 54906654, "question_id": 54906457, "link": "https://stackoverflow.com/questions/54906457/implementing-interfaces-event-in-vba/54906654#54906654", "title": "Implementing interface&#39;s event in VBA", "body": "<p>Did you use withevents?</p>\n\n<p>I've done the following, added a <code>test</code> function to your class</p>\n\n<pre><code>Private WithEvents iface As clsIface\n\nPrivate Sub UserForm_Initialize()\n    Set iface = New clsIface\nEnd Sub\n\nPrivate Sub iface_OnClientSelected()\n    '   Event subscription\nEnd Sub\n\nPrivate Sub UserForm_Click()\n    iface.test\nEnd Sub\n</code></pre>\n\n<p>Function added to class</p>\n\n<pre><code>Public Function test()\n    RaiseEvent OnClientSelected\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11125215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc5d4f2b5a11f69c9524b680085b26d0?s=128&d=identicon&r=PG&f=1", "display_name": "Tipejn", "link": "https://stackoverflow.com/users/11125215/tipejn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551274226, "creation_date": 1551273540, "question_id": 54906457, "link": "https://stackoverflow.com/questions/54906457/implementing-interfaces-event-in-vba", "title": "Implementing interface&#39;s event in VBA", "body": "<p>I have an interface IView:</p>\n\n<pre><code> Option Explicit\n\nPublic Event OnClientSelected()\n\nPublic Property Get ClientNames() As Variant\nEnd Property\n(...)\n</code></pre>\n\n<p>But I am not able to implement the event in my user form. Properties and subs are allowed to implement, but event not.</p>\n\n<p>Is it possible to make interface implementation with events?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1551329691, "creation_date": 1551329691, "answer_id": 54918647, "question_id": 54906445, "link": "https://stackoverflow.com/questions/54906445/cant-get-to-paste-in-values-only/54918647#54918647", "title": "Can&#39;t get to paste in values only", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub CommandButton5_Click()    \n    Dim shtSrc as worksheet, shtDest as worksheet, i as long\n\n    Set shtSrc = Worksheets(\"Lapas1\")\n    Set shtDest = Worksheets(\"S\u00e0skaita-Fakt\u00fbra\")\n\n    'Komanda rinkti duomenis\n    For i = 2 To shtSrc.Cells(Rows.Count, 1).End(xlUp).Row\n        If shtSrc.Cells(i, 3).Value = shtDest.Range(\"K5\").Value Then 'K5 sheet?\n\n            shtDest.Cells(rows.count, 1).end(xlup).offset(1, 0).Entirerow.value = _\n                   shtSrc.rows(i).value\n\n        End If\n    Next\n\n    shtDest.Activate\n    shtDest.Range(\"K5\").Activate\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6011732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/186b061fdf1d388877d4848256cda383?s=128&d=identicon&r=PG&f=1", "display_name": "Darius B.", "link": "https://stackoverflow.com/users/6011732/darius-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 1, "accepted_answer_id": 54918647, "answer_count": 1, "score": -1, "last_activity_date": 1551329691, "creation_date": 1551273508, "last_edit_date": 1551275467, "question_id": 54906445, "link": "https://stackoverflow.com/questions/54906445/cant-get-to-paste-in-values-only", "title": "Can&#39;t get to paste in values only", "body": "<p>I can't get to paste in values only.</p>\n\n<p>My Code:</p>\n\n<pre><code>Private Sub CommandButton5_Click()    \n    'Komanda rinkti duomenis\n    a = Worksheets(\"Lapas1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To a\n        If Worksheets(\"lapas1\").Cells(i, 3).Value = Range(\"K5\") Then\n            Worksheets(\"lapas1\").Rows(i).Copy\n            Worksheets(\"S\u00e0skaita-Fakt\u00fbra\").Activate\n            b = Worksheets(\"S\u00e0skaita-Fakt\u00fbra\").Cells(Rows.Count, 1).End(xlUp).Row\n            Worksheets(\"S\u00e0skaita-Fakt\u00fbra\").Cells(b + 1, 1).Select\n            ActiveSheet.Paste\n            Worksheets(\"lapas1\").Activate\n        End If\n    Next\n\n    Application.CutCopyMode = False\n    Worksheets(\"S\u00e0skaita-Fakt\u00fbra\").Activate\n    Range(\"K5\").Activate\nEnd Sub\n</code></pre>\n\n<p>Already tried:</p>\n\n<pre><code>Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 3, "creation_date": 1551274921, "post_id": 54906030, "comment_id": 96580696, "body": "So what have you tried?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551275213, "post_id": 54906030, "comment_id": 96580864, "body": "How would you do it in a workbook manually?"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1551275223, "creation_date": 1551275223, "answer_id": 54906931, "question_id": 54906030, "link": "https://stackoverflow.com/questions/54906030/reset-a-table-keeping-the-output-values/54906931#54906931", "title": "Reset a table keeping the output values", "body": "<p>You need to change your data into something like the following</p>\n\n<p><a href=\"https://i.stack.imgur.com/2gygA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2gygA.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then in the end of the week run a code to start the next week:<br>\nThe code copies the current week into the last week values and clears current week.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub StartNextWeek()\n    With ThisWorkbook.Worksheets(\"week\")\n        'copy current to last week\n        .Range(\"B2:B4\").Value = .Range(\"A2:A4\").Value\n\n        'clear current week\n        .Range(\"A2:A4\").Clear\n    End With\nEnd Sub\n</code></pre>\n\n<p>So in the next week you would start with</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uiomf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uiomf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 63, "user_id": 8513385, "user_type": "registered", "profile_image": "https://graph.facebook.com/1340832419348299/picture?type=large", "display_name": "Mateus Nogueira", "link": "https://stackoverflow.com/users/8513385/mateus-nogueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 54906931, "answer_count": 1, "score": 0, "last_activity_date": 1551275223, "creation_date": 1551272156, "last_edit_date": 1551274502, "question_id": 54906030, "link": "https://stackoverflow.com/questions/54906030/reset-a-table-keeping-the-output-values", "title": "Reset a table keeping the output values", "body": "<p>I have a table where cells C1 to C3 (for example) are programmed with \u2026</p>\n\n<ul>\n<li>C1: <code>=10-A1</code></li>\n<li>C2: <code>=10-A2</code></li>\n<li>C3: <code>=10-A3</code></li>\n</ul>\n\n<p>\u2026 respectively. </p>\n\n<p>Through the week I'll change the values of A1, A2 and A3, but in the end of the week I want the column A clear and the column C with the last output values of the week, for example, if the last value I put in A1 was <code>3</code>, the cell C1 will show me <code>7</code>, the next week the cell A1 will be clear and the cell C1 will still have the programation, but starting with the value <code>7</code>, not <code>10</code>.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1551272451, "creation_date": 1551272451, "answer_id": 54906128, "question_id": 54905513, "link": "https://stackoverflow.com/questions/54905513/how-do-i-check-if-i-have-a-data-that-fits-a-parameter-through-a-macro/54906128#54906128", "title": "How do I check if I have a data that fits a parameter through a macro", "body": "<p>You can use <em>DLookup</em>:</p>\n\n<pre><code>Dim DataExists As Boolean\n\nIf Not IsNull(DLookup(\"[SomeField]\", \"[YourTable]\", \"DateDiff('m', [YourDateField], DateSerial(\" &amp; year &amp; \", \" &amp; month &amp; \", 1)) = 0\") Then\n    DataExists = True\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11123466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561fe4b0d86d984a18bb126bc4a0c112?s=128&d=identicon&r=PG&f=1", "display_name": "yoni", "link": "https://stackoverflow.com/users/11123466/yoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10, "favorite_count": 0, "accepted_answer_id": 54906128, "answer_count": 1, "score": -1, "last_activity_date": 1551341327, "creation_date": 1551270509, "last_edit_date": 1551341327, "question_id": 54905513, "link": "https://stackoverflow.com/questions/54905513/how-do-i-check-if-i-have-a-data-that-fits-a-parameter-through-a-macro", "title": "How do I check if I have a data that fits a parameter through a macro", "body": "<p>I want to check if I have a data that fits the month and year the user inputed my macro so I could know to which query to go, how do I do that?\nmy code so far:</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Sub macro1()\n    Dim year As Integer\n    Dim month As Integer\n    year = InputBox(\"What year would you want to get data from?\")\n    month = InputBox(\"What month would you want to get data from\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts", "range", "row"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551269304, "post_id": 54904863, "comment_id": 96577310, "body": "Have you done any research on this?  MSDN/Google/Debugged the <code>srs</code> object?"}, {"owner": {"reputation": 3, "user_id": 11124771, "user_type": "registered", "profile_image": "https://graph.facebook.com/2017000131689236/picture?type=large", "display_name": "Jos&#233; Costa", "link": "https://stackoverflow.com/users/11124771/jos%c3%a9-costa"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551269911, "post_id": 54904863, "comment_id": 96577675, "body": "@Nathan_Sav As I said I&#39;m new in vba and I researched and found no solution for this problem...somethings I wrote may not be correct"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551273785, "post_id": 54904863, "comment_id": 96579998, "body": "as suggested by @Nathan_Sav attempting to manipulate  series and axis object with VBA require clear understanding of series (may be multiple) and Axis objects. If your data and chart placements not overlap why not try simple filter on the date,.chart will automatically adjust to visible data."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551273995, "post_id": 54904863, "comment_id": 96580123, "body": "You sure?  Googling <code>change series data source vba</code> gives lots of examples, the 1st being a) on this site and b) what you want :o)  Being new to VBA doesn&#39;t really cut it on this site. :o("}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551274642, "post_id": 54904863, "comment_id": 96580500, "body": "@Nathan_Sav: to be fair to OP, your search results on Google are based on few different factors so OP might not get the first answer from this site :). Saying that, this is not a new question. There will be answers for it on Google. You might not understand them.. being new to VBA. In which case it might be an idea to familiarise yourself with VBA"}, {"owner": {"reputation": 3, "user_id": 11124771, "user_type": "registered", "profile_image": "https://graph.facebook.com/2017000131689236/picture?type=large", "display_name": "Jos&#233; Costa", "link": "https://stackoverflow.com/users/11124771/jos%c3%a9-costa"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1551274812, "post_id": 54904863, "comment_id": 96580629, "body": "@AhmedAU the thing is that then a lot of info is filtered, because there are a lot of charts. Loading them into PPT causes a lot of Invisible Content which slows down a lot the file, for example."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551274867, "post_id": 54904863, "comment_id": 96580666, "body": "Also, a quick look at your code, <code>Dim YearI, YearF As Integer</code>: this statement will only declare <code>YearF</code> as integer. <code>Yearl</code> will be declared as a <code>Variant</code>. If you want to declare both as <code>Integer</code>, try something like: <code>Dim %Yearl, %YearF</code>"}, {"owner": {"reputation": 3, "user_id": 11124771, "user_type": "registered", "profile_image": "https://graph.facebook.com/2017000131689236/picture?type=large", "display_name": "Jos&#233; Costa", "link": "https://stackoverflow.com/users/11124771/jos%c3%a9-costa"}, "edited": false, "score": 0, "creation_date": 1551277695, "post_id": 54904863, "comment_id": 96582457, "body": "How can I load up columns of a range and maintain them, and change the rows?? That&#39;s what it&#39;s missing."}, {"owner": {"reputation": 3, "user_id": 11124771, "user_type": "registered", "profile_image": "https://graph.facebook.com/2017000131689236/picture?type=large", "display_name": "Jos&#233; Costa", "link": "https://stackoverflow.com/users/11124771/jos%c3%a9-costa"}, "edited": false, "score": 0, "creation_date": 1551278063, "post_id": 54904863, "comment_id": 96582676, "body": "Any links to help with this?"}, {"owner": {"reputation": 3, "user_id": 11124771, "user_type": "registered", "profile_image": "https://graph.facebook.com/2017000131689236/picture?type=large", "display_name": "Jos&#233; Costa", "link": "https://stackoverflow.com/users/11124771/jos%c3%a9-costa"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1551278832, "post_id": 54904863, "comment_id": 96583168, "body": "@Zac Thank you."}, {"owner": {"reputation": 3, "user_id": 11124771, "user_type": "registered", "profile_image": "https://graph.facebook.com/2017000131689236/picture?type=large", "display_name": "Jos&#233; Costa", "link": "https://stackoverflow.com/users/11124771/jos%c3%a9-costa"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551279333, "post_id": 54904863, "comment_id": 96583470, "body": "@Nathan_Sav I know the basics, usually from research...for this particular case I didn&#39;t find the answer"}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 9945747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a30fbc270b9c760609786f255e40d5e?s=128&d=identicon&r=PG&f=1", "display_name": "Python-0543", "link": "https://stackoverflow.com/users/9945747/python-0543"}, "is_accepted": true, "score": 0, "last_activity_date": 1551285701, "creation_date": 1551285701, "answer_id": 54910378, "question_id": 54904863, "link": "https://stackoverflow.com/questions/54904863/excel-vba-changing-number-of-rows-in-range-in-series-and-axis-label/54910378#54910378", "title": "Excel vba - changing number of rows in range in series and axis label", "body": "<p>I'm not sure I understood exactly what you want to do, but if you want to automate the entire process of updating charts in powerpoint rather than transfering the new charts manually from Excel, you can actually update ranges of the existing charts directly powerpoint.Try something like below. VBA takes the range from the active sheet. </p>\n\n<pre><code>Dim PPTApp As Object\nDim PPTPres As Object\nDim ppSlide As PowerPoint.Slide\n\nSet PPTApp = CreateObject(\"PowerPoint.Application\")\nPPTApp.Visible = True\n\n'This opens your powerpoint presentation\nSet PPTPres = PPTApp.Presentations.Open(\"file:///C:\\Users\\first.name\\Desktop\\pptest111.pptx\")\nPPTPres.Windows(1).Activate\n\n'This sets the range for x-axis labels\nPPTPres.Slides(2).Shapes(\"Diagram1\").Chart.SeriesCollection(1).XValues = \"Sheet2!$D$5:$D15\"\n'This sets the new range of values\nPPTPres.Slides(2).Shapes(\"Diagram1\").Chart.SeriesCollection(1).Values = \"Sheet2!$E$5:$E8\"\n\nPPTPres.Slides(2).Shapes(\"Diagram1\").LinkFormat.Update\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11124771, "user_type": "registered", "profile_image": "https://graph.facebook.com/2017000131689236/picture?type=large", "display_name": "Jos&#233; Costa", "link": "https://stackoverflow.com/users/11124771/jos%c3%a9-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 54910378, "answer_count": 1, "score": 0, "last_activity_date": 1551368915, "creation_date": 1551268285, "last_edit_date": 1551277628, "question_id": 54904863, "link": "https://stackoverflow.com/questions/54904863/excel-vba-changing-number-of-rows-in-range-in-series-and-axis-label", "title": "Excel vba - changing number of rows in range in series and axis label", "body": "<p>I'm new with vba and I need some assistance with something.\nFor a lot of charts I have a huge range and then I have the need to hide unused ranges and that's especially confusing when I transfer charts to ppt.\nWhat I need is a macro to change the rows' ranges...the columns stay the same. Something like:</p>\n\n<pre><code>Sub test()\n\nDim YearB As Integer\nDim YearE As Integer\nDim i As Long\nDim j As Long\nDim sht As Worksheet\nDim cht As ChartObject\nDim srs As Series\n\nYearB = InputBox(\"Beggining Year\")\n\nYearE = InputBox(\"Ending Year\")\n\n\n'define the rows corresponding to the year\ni = YearI - 1994\n\nj = YearF - 1994\n\n\nSet sht = ActiveSheet\n    With sht\n        For Each cht In .ChartObjects\n            For Each srs In cht.Chart.SeriesCollection\n                    'code to change rows in range and axis\n\n\n\n            Next srs\n        Next cht\n    End With\nEnd Sub\n</code></pre>\n\n<p>Can someone help me, please??!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1551264561, "post_id": 54903641, "comment_id": 96574549, "body": "Willl your formula work, if C logs out before B?  You can use VBA, the other alternative would be to use formula to build the table you want off a &quot;data&quot; sheet?"}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 1, "creation_date": 1551265662, "post_id": 54903641, "comment_id": 96575214, "body": "Why don&#39;t you have following column headers: <code>Id</code>, <code>Login date</code>, <code>Logout date</code>?"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 1, "creation_date": 1551265712, "post_id": 54903641, "comment_id": 96575248, "body": "I would recommend that you create a new table. In the old one you hold the new entries, and the new one uses Excel formulas that enumerate log in events in one column and looks up the next log out event after them into a second column, or 23:59:59 if none found. Then you can use the old table for input and the new table for output."}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551268385, "post_id": 54903641, "comment_id": 96576809, "body": "@Nathan_Sav Actually the data is sorted and C will never be before B."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551268953, "post_id": 54903641, "comment_id": 96577115, "body": "@CatalinVasilescu you may be thinking about it the wrong way, how is the data added?  Is it possible to add 2 rows instead of 1, the 2nd being the default log out time, then when adding the log out time, look for this line and change the value?"}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1551269745, "post_id": 54903641, "comment_id": 96577568, "body": "I thought about the variant to save the &quot;good data&quot; in another sheet. The &quot;wrong&quot; data, so only login, can be manipulated more easier, I just need to insert a logut after each login. For that I think I need vba. Do you think there is a simpler option?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551272116, "post_id": 54903641, "comment_id": 96578989, "body": "@CatalinVasilescu 2 questions: 1. Is the date and time in one column or are the s 2 seperate columns? 2. Are these date values or strings?"}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1551272482, "post_id": 54903641, "comment_id": 96579231, "body": "@PEH 1. Date and time are in one column. 2. Dates (I think there is not a problem to convert in strings and after again in date). I will edit the post, because it can be this case: if there is a log out after a log out for the same id, both log outs will be removed."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1551275473, "post_id": 54906673, "comment_id": 96581034, "body": "Works, however there can happen this: &quot;A&quot; starts with log out and for id &quot;A&quot; there is only this value. Or what if there is an id &quot;X&quot; that contains 3 log out consecutiv times? ( There will remove only 1 log out)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1551275802, "post_id": 54906673, "comment_id": 96581210, "body": "@CatalinVasilescu your example data didn&#39;t show these cases so these cases are not covered by my code. You can only get what you ask for, also this answer is already much more than what you could have expected (this is no free coding service). This is the answer to what was asked in your question, and should give you a good idea what the techniques are to do such data validation. \u2022 So instead of asking us to do all the work for you, start working yourself now that you&#39;ve got a good starting point."}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1551276014, "post_id": 54906673, "comment_id": 96581337, "body": "@PEH Thanks, sorry, it&#39;s more then enogh for a good starting point. Thx"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 1, "creation_date": 1551276418, "post_id": 54906673, "comment_id": 96581598, "body": "@CatalinVasilescu I&#39;ve made an edit. Have a look at the very last <code>Else</code> statment there is a comment. It will probably solve the issue already."}, {"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1551276989, "post_id": 54906673, "comment_id": 96581983, "body": "Thx, very helpful"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "reply_to_user": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 0, "creation_date": 1551280444, "post_id": 54906673, "comment_id": 96584185, "body": "@CatalinVasilescu: Please have a look at the update of my answer regarding the possible errors you mentioned (starts with log out, three consecutive log outs)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1551280613, "post_id": 54906673, "comment_id": 96584288, "body": "@z32a7ul my comment in the last <code>Else</code> statement already fixed that."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1551280680, "post_id": 54906673, "comment_id": 96584334, "body": "@P\u1d07\u029c: I think your code does not work in the following situation (while mine does): A logs in, B logs in, C logs in, C logs out, B logs out, A logs out. You would insert a log out after the first &quot;A logs in&quot; row because your code checks only the first row after the log in, and not the later ones. In a multi-user system, however, users can log in and out while others are logged in."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1551280871, "post_id": 54906673, "comment_id": 96584463, "body": "@P\u1d07\u029c: I don&#39;t agree with your solution. Log out before log in should be considered an overnight session needing a log in event at midnight, three consecutive log outs without a log in from the same user should be considered an error (not to be hidden by the program), three consecutive log outs from different users is, however business as usual, and is not handled correctly by your code."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 1, "creation_date": 1551280929, "post_id": 54906673, "comment_id": 96584510, "body": "@z32a7ul The OP said the data is sorted by ID first so this cannot happen. That&#39;s why I took the shortcut. Sorted data is much easier to handle and we don&#39;t need to care about this case."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1551281161, "post_id": 54906673, "comment_id": 96584642, "body": "@P\u1d07\u029c: Sorry, I didn&#39;t see that comment."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1551281266, "post_id": 54906673, "comment_id": 96584716, "body": "@z32a7ul No worries ;) it is in the comments below the question: <i>&quot;Actually the data is sorted and C will never be before B&quot;</i>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1551276371, "last_edit_date": 1551276371, "creation_date": 1551274304, "answer_id": 54906673, "question_id": 54903641, "link": "https://stackoverflow.com/questions/54903641/insert-a-new-value-if-there-is-a-duplicate/54906673#54906673", "title": "Insert a new value if there is a duplicate", "body": "<p>Imagine the following data. The blue column is what we would assume the code should do:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0LiH2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0LiH2.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddMissingLogoutLines()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Data\")\n\n    Dim iRow As Long\n    iRow = 2 'start in row 2\n\n    Do Until ws.Cells(iRow, \"A\").Value = vbNullString\n        If ws.Cells(iRow, \"B\").Value = \"Log in\" Then 'we are in a login line \u2026\n            If ws.Cells(iRow + 1, \"B\").Value = \"Log out\" And ws.Cells(iRow + 1, \"A\").Value = ws.Cells(iRow, \"A\").Value Then\n                'login line followed by its logout line\n                'this is what we want so we do nothing\n            Else 'login line followed by a login line or a mismatching logout line\n                'logout is missing add it\n                ws.Rows(iRow + 1).Insert Shift:=xlDown\n                ws.Cells(iRow + 1, \"A\").Value = ws.Cells(iRow, \"A\").Value\n                ws.Cells(iRow + 1, \"B\").Value = \"Log out\"\n                ws.Cells(iRow + 1, \"C\").Value = DateValue(ws.Cells(iRow, \"C\").Value) + (1 - (1 / 24 / 60 / 60))\n            End If\n            iRow = iRow + 2\n        Else  'we are in a logout line \u2026\n            If ws.Cells(iRow + 1, \"B\").Value = \"Log out\" Then 'logout line followed by a logout line\n                'logout after logout so delete both\n                ws.Range(iRow &amp; \":\" &amp; iRow + 1).Delete\n            Else 'everything is ok go to next line\n                iRow = iRow + 1\n                'if you want to remove single `log out` lines with no login line too, then replace the iRow = iRow + 1 above with ws.Rows(iRow).Delete here\n            End If\n        End If\n    Loop\nEnd Sub\n</code></pre>\n\n<p>After the code is run we see that 2 <code>Log out</code> lines were deleted and the 2 missing <code>Log out</code> lines that were missing for the <code>Log in</code> lines were created.</p>\n\n<p><a href=\"https://i.stack.imgur.com/A58Ym.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A58Ym.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "edited": false, "score": 1, "creation_date": 1551281383, "post_id": 54908134, "comment_id": 96584789, "body": "Thanks! Actually it is more than I need. Thx"}], "tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 2, "last_activity_date": 1551280247, "last_edit_date": 1551280247, "creation_date": 1551279020, "answer_id": 54908134, "question_id": 54903641, "link": "https://stackoverflow.com/questions/54903641/insert-a-new-value-if-there-is-a-duplicate/54908134#54908134", "title": "Insert a new value if there is a duplicate", "body": "<p>You can use VBA for this:</p>\n\n<pre><code>Option Explicit\n\n' Tools &gt; References &gt; Microsoft Scripting Runtime\n\n' dctIds\n'   Id =&gt; dctSessions\n'           LogIn =&gt; dctSession\n'                      \"Id\" =&gt; String\n'                      \"LogIn\" =&gt; Date\n'                      \"LogOut\" =&gt; Date\n\nPublic Sub ExtendData()\n    Dim dctIds As Dictionary: Set dctIds = New Dictionary\n    ReadData dctIds, ThisWorkbook.Worksheets(\"Input\")\n    WriteData_v1 dctIds, ThisWorkbook.Worksheets(\"Output_v1\")\n    WriteData_v2 dctIds, ThisWorkbook.Worksheets(\"Output_v2\")\nEnd Sub\n\nPrivate Sub ReadData(dctIds As Dictionary, ewsInput As Worksheet)\n    ' Assumption: header in first row, data starts in second row\n    Dim r As Long: For r = 2 To ewsInput.UsedRange.Row + ewsInput.UsedRange.Rows.Count - 1\n        ' Assumption: Id is in first column\n        Dim strId As String: strId = ewsInput.Cells(r, 1).Value\n        ' Assumption: Status is in second column\n        Dim strStatus As String: strStatus = ewsInput.Cells(r, 2).Value\n        ' Assumption: Date is in third column, and ms precision is enough, change data type to Double and use Value2 instead of Value otherwise\n        Dim datDate As Date: datDate = ewsInput.Cells(r, 3).Value\n\n        Dim dctSessions As Dictionary\n        If dctIds.Exists(strId) = False Then\n            Set dctSessions = New Dictionary\n            dctIds.Add strId, dctSessions\n        Else\n            Set dctSessions = dctIds(strId)\n        End If\n\n        If strStatus = \"Log in\" Then\n            Dim dctSessionNew As Dictionary: Set dctSessionNew = New Dictionary\n            dctSessionNew.Add \"Id\", strId\n            dctSessionNew.Add \"Status\", strStatus\n            dctSessionNew.Add \"LogIn\", datDate\n            dctSessions.Add datDate, dctSessionNew\n        ElseIf strStatus = \"Log out\" Then\n            Dim dctSessionLast As Dictionary: Set dctSessionLast = Nothing\n            Dim varSessionFound As Variant: For Each varSessionFound In dctSessions.Items\n                Dim dctSessionFound As Dictionary: Set dctSessionFound = varSessionFound\n                If dctSessionLast Is Nothing Then\n                    Set dctSessionLast = dctSessionFound\n                ElseIf dctSessionLast(\"LogIn\") &lt;= dctSessionFound(\"LogIn\") Then\n                    Set dctSessionLast = dctSessionFound\n                End If\n            Next varSessionFound\n            If Not dctSessionLast Is Nothing Then\n                dctSessionLast.Add \"LogOut\", datDate\n            Else\n'                Debug.Print \"No Log in before Log out in row \" &amp; r\n                Dim dctSessionOvernight As Dictionary: Set dctSessionOvernight = New Dictionary\n                dctSessionOvernight.Add \"Id\", strId\n                dctSessionOvernight.Add \"Status\", strStatus\n                dctSessionOvernight.Add \"LogIn\", DateValue(datDate) + TimeSerial(0, 0, 0)\n                dctSessionOvernight.Add \"LogOut\", datDate\n                dctSessions.Add dctSessionOvernight(\"LogIn\"), dctSessionOvernight\n\n            End If\n        Else\n            Debug.Print \"Invalid Status in row \" &amp; r\n        End If\n    Next r\nEnd Sub\n\nPrivate Sub WriteData_v1(dctIds As Dictionary, ewsOutput As Worksheet)\n    ' Assumption: header in first row, data starts in second row\n    Dim r As Long: r = 2\n    Dim varSessions As Variant: For Each varSessions In dctIds.Items\n        Dim dctSessions As Dictionary: Set dctSessions = varSessions\n        Dim varSession As Variant: For Each varSession In dctSessions.Items\n            Dim dctSession As Dictionary: Set dctSession = varSession\n            ' Assumption: Id is in first column\n            ewsOutput.Cells(r, 1).Value = dctSession(\"Id\")\n            ' Assumption: Status is in second column\n            ewsOutput.Cells(r, 2).Value = dctSession(\"Status\")\n            ' Assumption: Date is in third column, and ms precision is enough, change data type to Double and use Value2 instead of Value otherwise\n            ewsOutput.Cells(r, 3).Value = dctSession(\"LogIn\")\n            r = r + 1\n            ' Assumption: Id is in first column\n            ewsOutput.Cells(r, 1).Value = dctSession(\"Id\")\n            ' Assumption: Status is in second column\n            ewsOutput.Cells(r, 2).Value = dctSession(\"Status\")\n            ' Assumption: Date is in third column, and ms precision is enough, change data type to Double and use Value2 instead of Value otherwise\n            With ewsOutput.Cells(r, 3)\n                If dctSessions.Exists(\"LogOut\") Then\n                    .Value = dctSession(\"LogOut\")\n                Else\n                    .Value = DateValue(dctSession(\"LogIn\")) + TimeSerial(23, 59, 59)\n                End If\n            End With\n            r = r + 1\n        Next varSession\n    Next varSessions\nEnd Sub\n\n\nPrivate Sub WriteData_v2(dctIds As Dictionary, ewsOutput As Worksheet)\n    ' Assumption: header in first row, data starts in second row\n    Dim r As Long: r = 2\n    Dim varSessions As Variant: For Each varSessions In dctIds.Items\n        Dim dctSessions As Dictionary: Set dctSessions = varSessions\n        Dim varSession As Variant: For Each varSession In dctSessions.Items\n            Dim dctSession As Dictionary: Set dctSession = varSession\n            ' Assumption: Id is in first column\n            ewsOutput.Cells(r, 1).Value = dctSession(\"Id\")\n            ' Assumption: Status is in second column\n            ewsOutput.Cells(r, 2).Value = dctSession(\"Status\")\n            ' Assumption: LogIn is in third column, and ms precision is enough, change data type to Double and use Value2 instead of Value otherwise\n            ewsOutput.Cells(r, 3).Value = dctSession(\"LogIn\")\n            ' Assumption: LogOut is in fourth column, and ms precision is enough, change data type to Double and use Value2 instead of Value otherwise\n            With ewsOutput.Cells(r, 4)\n                If dctSessions.Exists(\"LogOut\") Then\n                    .Value = dctSession(\"LogOut\")\n                Else\n                    .Value = DateValue(dctSession(\"LogIn\")) + TimeSerial(23, 59, 59)\n                End If\n            End With\n            r = r + 1\n        Next varSession\n    Next varSessions\nEnd Sub\n</code></pre>\n\n<p>As you can see, my macro can create to outputs:</p>\n\n<p>v1: The way you asked for: the original rows + additional rows to close sessions at the end of the day</p>\n\n<p>v2: The table format recommended by me and others: each session is a row with two dates (log in and log out), where the second date is the end of the day, if missing from the original table</p>\n\n<p>It will look like this after running the macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bCpBS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bCpBS.png\" alt=\"Log In and Out Picture\"></a></p>\n\n<p>Note: The header (Id, Status, etc.) was not created by the macro but manually.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Having read the OP's comments to PEH's solution, I modified the error handling code (\"No Log in before Log out in row x\").</p>\n\n<p>This way, the code will also enter log in dates if it finds log out dates. This is useful because if you allow overnight sessions, it's not enough to close log in events that will end the next day but you should also open the sessions that were started the day before.</p>\n\n<p>Sessions that last several days are still not managed by this code (it would require to analyse the logs of all days).</p>\n\n<p>Regarding the three consecutive log outs: this should be considered an error, and should not be hidden by a program code because it requires further investigation (Why did it happen?).</p>\n"}], "owner": {"reputation": 51, "user_id": 11079830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uDU9ugnzX7Y/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPsYKNSUtzCvqqG0QbyepxwjuYfDw/mo/photo.jpg?sz=128", "display_name": "Catalin Vasilescu", "link": "https://stackoverflow.com/users/11079830/catalin-vasilescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 54906673, "answer_count": 2, "score": 1, "last_activity_date": 1551280247, "creation_date": 1551264292, "last_edit_date": 1551272518, "question_id": 54903641, "link": "https://stackoverflow.com/questions/54903641/insert-a-new-value-if-there-is-a-duplicate", "title": "Insert a new value if there is a duplicate", "body": "<p>I have a table with multiple duplicates (Log in) for an id. Normally after each \"log in\" there must be a \"log out\". If yes, then I do not have to do anything. If after a \"log in\" there is no \"log out\" then I have to create one at the and of the day (23:59:59).</p>\n\n<p>I have the following table:</p>\n\n<pre><code>  Id      Status     Date    \n  A      Log in      01.01.2018  01:44:03\n  A      Log out     01.01.2018  02:57:03\n  C      Log in      01.01.2018  01:55:03\n ser     Log in      01.01.2018  01:59:55\n ser     Log out     03.01.2018  01:59:55\n  M      Log in      04.01.2018  01:59:55\n</code></pre>\n\n<p>The table should look like this:</p>\n\n<pre><code> Id      Status     Date    \n A      Log in      01.01.2018  01:44:03\n A      Log out     01.01.2018  02:57:03\n C      Log in      01.01.2018  01:59:03\n C      Log out     01.01.2018  23:59:59  \nser     Log in      01.01.2018  01:59:55\nser     Log out     03.01.2018  01:59:55\n M      Log in      04.01.2018  01:59:55\n M      Log out     04.01.2018  23:59:59\n</code></pre>\n\n<p>A formula like this</p>\n\n<pre><code>=IF(OR(AND(A2=A3,B2=\"Log in\",B3=\"Log out\"),AND(A2=A1,B2=\"Log Out\",B1=\"Log in\")),\"Keep\",\"You need to insert a log out\")\n</code></pre>\n\n<p>could help me to see if afer a \"log in\" exists a \"log out\", however she does not help me to insert a a new line in sheet. Any idea how I can do this? Do you think I need vba?</p>\n\n<p>*if there is a \"log out\" after a \"log out\" for the same id, both \"log outs\" will be removed</p>\n"}, {"tags": ["excel", "vba", "charts", "powerpoint"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1551268155, "post_id": 54903546, "comment_id": 96576673, "body": "<code>pptPres.Slides(1).Shapes(1).Chart.SeriesCollection(1).Points&zwnj;&#8203;(1).Height</code> with pptPres being a set <code>PowerPoint.Presentation</code> variable."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1551320326, "post_id": 54903546, "comment_id": 96600702, "body": "Do you want the height, or the Y value? @JvdV gave you the height. To get the value, you need to get the array of all Y values, then get the one for the point youre interested in. So <code>Dim vYVals As Variant : vYVals = pptPres.Slides(1).Shapes(1).Chart.SeriesCollection(1).Values : MyValue = vYVals(PointIndex)</code>"}], "owner": {"reputation": 1, "user_id": 9280734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2070b006a8d13bd918bff243264b121?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKay", "link": "https://stackoverflow.com/users/9280734/alphakay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551263988, "creation_date": 1551263988, "question_id": 54903546, "link": "https://stackoverflow.com/questions/54903546/how-do-i-access-the-height-of-a-single-bar-from-a-chart-and-change-it", "title": "How do i access the height of a single bar from a chart and change it?", "body": "<p>I am working with a powerpoint bar chart.\nWithin this chart there is a bar which I need the height from.\nSomehow I dont find the right object/property to refer to.\nThe Microsoft Documentation was not helpful so far.\nKindest Regards,\nAlphaKay</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "edited": false, "score": 0, "creation_date": 1551262156, "post_id": 54902799, "comment_id": 96572929, "body": "C5:C25 is <b>21</b> rows."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1551265999, "post_id": 54902799, "comment_id": 96575407, "body": "You don&#39;t need VBA for this, you can use formulas."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1551266151, "post_id": 54902799, "comment_id": 96575501, "body": "Range(&quot;C5:C25&quot;).Value = I0 means that you write from the variable IO (value=0) to the Range. You cannot add and subtract vectors in VBA."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9545661, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0OekxKTJX54/AAAAAAAAAAI/AAAAAAAACbU/5-fhKHdqnvc/photo.jpg?sz=128", "display_name": "zih", "link": "https://stackoverflow.com/users/9545661/zih"}, "edited": false, "score": 0, "creation_date": 1551272382, "post_id": 54904018, "comment_id": 96579177, "body": "Thanks. Now, like this, if I set another variable b(y, w) then can I subtract a from b? I tried but couldn&#39;t do that."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 3, "user_id": 9545661, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0OekxKTJX54/AAAAAAAAAAI/AAAAAAAACbU/5-fhKHdqnvc/photo.jpg?sz=128", "display_name": "zih", "link": "https://stackoverflow.com/users/9545661/zih"}, "edited": false, "score": 0, "creation_date": 1551273816, "post_id": 54904018, "comment_id": 96580020, "body": "So row 1 column 4-row 1 column 3, would be <code>result=a(1, 4)-a(1, 3)</code>  you can use variables etc, for the numbers"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1551265492, "creation_date": 1551265492, "answer_id": 54904018, "question_id": 54902799, "link": "https://stackoverflow.com/questions/54902799/assigning-variables-to-columns-with-20-rows-and-subtracting-them-in-excel-vba/54904018#54904018", "title": "Assigning variables to columns with 20 rows and subtracting them in Excel VBA", "body": "<p>You already have this you can use the <code>rows</code> <code>row</code> and <code>columns</code> <code>column</code> from a range.</p>\n\n<p>A range can go straight into an array, which has indexed values, and \nUsing an array is a little quicker.</p>\n\n<pre><code>Sub aTest()\n\nDim r As Excel.Range\nDim a() As Variant\n\nSet r = Range(\"a1:d20\")\na = r.Value\n\nFor x = 1 To UBound(a)\n\n    For t = 1 To r.Columns.Count\n\n        Debug.Print \"Row \" &amp; x &amp; \" Value \" &amp; t &amp; \" \" &amp; a(x, t)\n\n    Next t\n\nNext x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9545661, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0OekxKTJX54/AAAAAAAAAAI/AAAAAAAACbU/5-fhKHdqnvc/photo.jpg?sz=128", "display_name": "zih", "link": "https://stackoverflow.com/users/9545661/zih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551265492, "creation_date": 1551261832, "last_edit_date": 1551264168, "question_id": 54902799, "link": "https://stackoverflow.com/questions/54902799/assigning-variables-to-columns-with-20-rows-and-subtracting-them-in-excel-vba", "title": "Assigning variables to columns with 20 rows and subtracting them in Excel VBA", "body": "<p>I am new in excel vba. I am writing a code where want to store the values of 20 rows on a column in a variable and similarly another set of values from 20 rows in another variable. Then I want to subtract one from the other and store in another variable (eg. A). This procedure I will repeat for 3 more times with different sets of data and will end up with 4 variables (eg. A, B, C, D).  Finally, I want to find the maximum of all the 4 variables and assign the values into a column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FhAiQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FhAiQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>(The maximum values I want to put in delE column) </p>\n\n<p>I have tried this as presented below. But it did not work. It erases the values of all the columns. I am attaching the code here. Can you please help me? </p>\n\n<pre><code>Sub span()\n    Dim I0 As Variant\n    Dim T1 As Variant\n    Dim I1 As Variant\n    Dim T2 As Variant\n    Dim I2 As Variant\n    Dim A  As Variant\n    Dim B  As Variant\n    Dim C  As Variant\n    Dim D  As Variant\n    Dim G  As Variant\n\n    G = Range(\"G5\").Value - Range(\"C5\").Value\n\n     Range(\"C5:C25\").Value = I0\n     Range(\"D5:D25\").Value = T1\n     Range(\"E5:E25\").Value = I1\n     Range(\"F5:F25\").Value = T2\n     Range(\"G5:G25\").Value = I2\n     A = I2 - I0\n     B = T2 - I0\n     C = T2 - I1\n     D = T1 - I1 + G\n\n    Range(\"H5:H25\").Value = Application.WorksheetFunction.Max(A, B, C, D)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11124341, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZO_mtbNt9EQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdqU1mPmm4nMRTPEGnEJ6ngTBuswQ/mo/photo.jpg?sz=128", "display_name": "Alex Da", "link": "https://stackoverflow.com/users/11124341/alex-da"}, "edited": false, "score": 0, "creation_date": 1551311495, "post_id": 54903606, "comment_id": 96598747, "body": "Hi Xabier, Thank you for your prompt response. In addition, how do I now show the Membership status in the textbox of my userform? Do I need to put &quot;me.membershipstatus.value=(define the value here)&quot;."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1551264183, "creation_date": 1551264183, "answer_id": 54903606, "question_id": 54902748, "link": "https://stackoverflow.com/questions/54902748/get-correct-status-in-a-text-box-based-on-date-from-another-text-box-in-a-userfo/54903606#54903606", "title": "Get correct status in a text box based on date from another text box in a userform", "body": "<p>How about the following, it will check the last row with data on Column A and then loop from row 2 to the last checking values on Column H (Paid On) and update Column G (Membership Status) to the appropriate value:</p>\n\n<pre><code>Sub UpdateStatus()\nDim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"DB\")\n'declare and set the worksheet you are working with, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'get the last row with data on Column A\n\nFor i = 2 To LastRow\n'loop from row 2 to last row\n    If ws.Cells(i, \"H\").Value = \"\" Then ws.Cells(i, \"G\").Value = \"No Payment Made\"\n    'if nothing under Paid On then \"No Payment Made\"\n    If ws.Cells(i, \"H\").Value &lt; Now() And ws.Cells(i, \"H\").Value &lt;&gt; \"\" Then ws.Cells(i, \"G\").Value = \"Active\"\n    'if Paid On &lt; Today then \"Active\"\n    If ws.Cells(i, \"H\").Value &gt; Now() Then ws.Cells(i, \"G\").Value = \"Expired\"\n    'if Paid On &gt; Today then \"Expired\"\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11124341, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZO_mtbNt9EQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdqU1mPmm4nMRTPEGnEJ6ngTBuswQ/mo/photo.jpg?sz=128", "display_name": "Alex Da", "link": "https://stackoverflow.com/users/11124341/alex-da"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 54903606, "answer_count": 1, "score": 0, "last_activity_date": 1551264183, "creation_date": 1551261685, "last_edit_date": 1551264109, "question_id": 54902748, "link": "https://stackoverflow.com/questions/54902748/get-correct-status-in-a-text-box-based-on-date-from-another-text-box-in-a-userfo", "title": "Get correct status in a text box based on date from another text box in a userform", "body": "<p>This is my first time posting here and I'm new to VBA.</p>\n\n<p>What I'm trying to achieve is to set the correct membership status from a list of 3 possibilities; Active, Expired or No Payment Made. This is based on the date entered in another text box named 'Paid On'. It's a 12 month membership so:</p>\n\n<p>If the 'Paid On' text box date value entered or showing is &lt; today's date then the 'membership status' text box registers/shows as \"active\".\nIf the 'Paid On' text box is > today's date then the 'membership status' text box registers/shows as \"expired\".\nIf the 'Paid On' text box is blank then the 'membership status' text box shows/registers \"No Payment Made\".</p>\n\n<p>The 2 text boxes are part of a DB worksheet in excel, whereby 'membership status' is in column G and 'Paid On' is in column H.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1551275045, "post_id": 54902538, "comment_id": 96580773, "body": "welcome. You came too close from your previous post. May try <code>instr</code> function to check occurrence of Keywords  within the text in the shapes. Also do not forget to use <code>Exit for</code> after deleting the slide to avoid error attempting to .find shapes in deleted slide. this will work with shapes without groups and nodes within it (refer the last example)"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "edited": false, "score": 0, "creation_date": 1551273353, "post_id": 54906005, "comment_id": 96579749, "body": "In my case when I use your code above PP.Slides(L).Delete its not work inside the loop.Inside the loop this line didn&#39;t execute"}, {"owner": {"reputation": 61, "user_id": 10962285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90dc739399ca749dc4fcc10d890e8e04?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/10962285/sergey"}, "reply_to_user": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "edited": false, "score": 0, "creation_date": 1551274579, "post_id": 54906005, "comment_id": 96580469, "body": "I changed listing above, you can try it one more time. Set your text to search into sText variable"}, {"owner": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "edited": false, "score": 0, "creation_date": 1551343261, "post_id": 54906005, "comment_id": 96607989, "body": "Thanks it works..But if I want to do the same for slide header,footer as well as notes  then how to do it? this code only delete the slide where the keywords are available only in the body of the silde."}, {"owner": {"reputation": 61, "user_id": 10962285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90dc739399ca749dc4fcc10d890e8e04?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/10962285/sergey"}, "reply_to_user": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "edited": false, "score": 0, "creation_date": 1551346062, "post_id": 54906005, "comment_id": 96609476, "body": "I think, you need to check them separatelly and if they contain specific text - delete slide. Here is a good example how to reach headers and footers: <a href=\"https://stackoverflow.com/questions/35739457/vba-powerpoint-2010-replacing-text-in-headers-and-footers\" title=\"vba powerpoint 2010 replacing text in headers and footers\">stackoverflow.com/questions/35739457/&hellip;</a>"}, {"owner": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "edited": false, "score": 0, "creation_date": 1551346451, "post_id": 54906005, "comment_id": 96609719, "body": "Thanks a lot for your help. But I need to know one thing how I can incorporate that code in your code above?"}, {"owner": {"reputation": 61, "user_id": 10962285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90dc739399ca749dc4fcc10d890e8e04?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/10962285/sergey"}, "reply_to_user": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "edited": false, "score": 0, "creation_date": 1551348221, "post_id": 54906005, "comment_id": 96610805, "body": "You can add block  Set ppMaster = PP.SlideMaster With ppMaster If UBound(Split(.HeadersFooters.Footer.Text, sText)) &gt; 0 Or UBound(Split(.HeadersFooters.Header.Text, sText)) &gt; 0 Then                 PP.Slides(L).Delete End If End With between &quot;Next L&quot; and PP.Save, i.e. process (check header and footer) every ppt file after removing slides with text in frames."}, {"owner": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "edited": false, "score": 0, "creation_date": 1551349845, "post_id": 54906005, "comment_id": 96611837, "body": "Thanks a ton but I am getting error for variable not defined for sText and also for ppMaster...Can you please modify the code above?"}, {"owner": {"reputation": 61, "user_id": 10962285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90dc739399ca749dc4fcc10d890e8e04?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/10962285/sergey"}, "reply_to_user": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "edited": false, "score": 0, "creation_date": 1551350448, "post_id": 54906005, "comment_id": 96612218, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189187/discussion-between-sergey-and-shaon\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 61, "user_id": 10962285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90dc739399ca749dc4fcc10d890e8e04?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/10962285/sergey"}, "is_accepted": true, "score": 1, "last_activity_date": 1551274473, "last_edit_date": 1551274473, "creation_date": 1551272064, "answer_id": 54906005, "question_id": 54902538, "link": "https://stackoverflow.com/questions/54902538/delete-powerpoint-slides-containing-keywords-using-vba/54906005#54906005", "title": "Delete Powerpoint Slides containing keywords using VBA", "body": "<p>I have slightly modified your listing and it works for me:</p>\n\n<pre><code>Option Explicit\nPublic Sub DoFiles()\n    Dim strFileName As String\n    Dim strFolderName As String\n    Dim PP As Presentation\n    Dim sText As String\n    strFolderName = \"D:\\111\\\"\n    strFileName = Dir(strFolderName &amp; \"\\*.pptx*\")\n    sText = \"TEST\"\n    Do While Len(strFileName) &gt; 0\n        Set PP = Presentations.Open(strFolderName &amp; \"\\\" &amp; strFileName)\n        Dim oSld As Slide\n        Dim oShp As Shape\n        Dim L As Long\n        For L = ActivePresentation.Slides.Count To 1 Step -1\n        Set oSld = ActivePresentation.Slides(L)\n             For Each oShp In oSld.Shapes\n             On Error Resume Next\n                If oShp.HasTextFrame Then\n                    If UBound(Split(oShp.TextFrame.TextRange, sText)) &gt; 0 Then\n                    PP.Slides(L).Delete\n                    End If\n                End If\n             Next oShp\n        Next L\n        PP.Save\n        PP.Close\n        strFileName = Dir\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 9329168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7cc8e9f295a7bd9569253e242a744638?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon", "link": "https://stackoverflow.com/users/9329168/shaon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 54906005, "answer_count": 1, "score": 1, "last_activity_date": 1555620553, "creation_date": 1551261202, "last_edit_date": 1555620553, "question_id": 54902538, "link": "https://stackoverflow.com/questions/54902538/delete-powerpoint-slides-containing-keywords-using-vba", "title": "Delete Powerpoint Slides containing keywords using VBA", "body": "<p>I have a folder with 10 PowerPoint presentations. Each presentation has 20-25 slides.</p>\n\n<p>Suppose I have a keyword \"CX404\",\"AR50\". The macro should delete all slides having that keyword in the 10 presentations.</p>\n\n<pre><code>Public Sub DoFiles()\n    Dim strFileName As String\n    Dim strFolderName As String\n    Dim PP As Presentation\n    'set default directory here if needed\n    strFolderName = \"D:\\Users\\Desktop\\Shaon\\pptss\"\n    strFileName = Dir(strFolderName &amp; \"\\*.pptx*\")\n    Do While Len(strFileName) &gt; 0\n        Set PP = Presentations.Open(strFolderName &amp; \"\\\" &amp; strFileName)\n        'your code\n        Dim oSld As Slide\n        Dim oShp As Shape\n        Dim L As Long\n        For L = ActivePresentation.Slides.Count To 1 Step -1\n            Set oSld = ActivePresentation.Slides(L)\n            For Each oShp In oSld.Shapes\n                If oShp.HasTextFrame Then\n                    Select Case UCase(oShp.TextFrame.TextRange)\n                    Case Is = \"CX400\", \"AR50\"\n                        oSld.Delete\n                    Case Else\n                       'not found\n                End Select\n                End If\n            Next oShp\n        Next L\n        PP.Close\n        strFileName = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>I can open all ppts in the folder. I am not be able to delete slides using my specific keywords.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551261797, "post_id": 54902506, "comment_id": 96572694, "body": "You need to resize Paste Cell, so <code>Set PasteCell=PasteCell.Resize(ubound(array),14)</code> something like that.  Or just use the anchor cell maybe, set paste cell to just be bottomrow2,1 ?"}, {"owner": {"reputation": 15, "user_id": 10984900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c0f043f65394d38f2d04de1a1b96c6?s=128&d=identicon&r=PG&f=1", "display_name": "PureMaths", "link": "https://stackoverflow.com/users/10984900/puremaths"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551262832, "post_id": 54902506, "comment_id": 96573365, "body": "Thanks, this worked. For some reason &#39;PasteCell&#39; was appearing as a variant/range in my Watch Window. I brought it&#39;s declaration into the sub() and along with your help it&#39;s worked. Thanks again."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551263383, "post_id": 54902506, "comment_id": 96573744, "body": "how did you declare <code>PasteCell</code> ?"}, {"owner": {"reputation": 15, "user_id": 10984900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c0f043f65394d38f2d04de1a1b96c6?s=128&d=identicon&r=PG&f=1", "display_name": "PureMaths", "link": "https://stackoverflow.com/users/10984900/puremaths"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551263558, "post_id": 54902506, "comment_id": 96573852, "body": "I originally declared it as Range, at the top, before the array was constructed. Quite confused as to why it would appear as Variant/Range as the <code>Set PasteCell = ClientBook.Sheets(&quot;Media Traded&quot;).Range(Cells(bottomrow2 + 1, 1), Cells(bottomrow2 + 1, 14))</code> call was the first time it&#39;s called in multiple subs"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551263759, "post_id": 54902506, "comment_id": 96573981, "body": "Is it a range still before populated? In the top of the sub or the top of the module?"}, {"owner": {"reputation": 15, "user_id": 10984900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c0f043f65394d38f2d04de1a1b96c6?s=128&d=identicon&r=PG&f=1", "display_name": "PureMaths", "link": "https://stackoverflow.com/users/10984900/puremaths"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551264110, "post_id": 54902506, "comment_id": 96574207, "body": "What&#39;s weirder is that I can&#39;t now recreate it. Perhaps some rogue lines of code at the bottom of the sub were confusing it. Thanks again for all of your help"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551264391, "post_id": 54902506, "comment_id": 96574415, "body": "no worries.  I&#39;ve added as an answer too, to help others.  Mark as solution if you can.  Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1551263354, "creation_date": 1551263354, "answer_id": 54903323, "question_id": 54902506, "link": "https://stackoverflow.com/questions/54902506/printing-array-to-variable-cell-range-vba/54903323#54903323", "title": "Printing array to variable cell range VBA", "body": "<p>You need to resize Paste Cell, so </p>\n\n<p><code>Set PasteCell=PasteCell.Resize(ubound(array),14)</code></p>\n\n<p>something like that. Or just use the anchor cell maybe, set paste cell to just be bottomrow2,1 ? </p>\n"}], "owner": {"reputation": 15, "user_id": 10984900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c0f043f65394d38f2d04de1a1b96c6?s=128&d=identicon&r=PG&f=1", "display_name": "PureMaths", "link": "https://stackoverflow.com/users/10984900/puremaths"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 54903323, "answer_count": 1, "score": 0, "last_activity_date": 1551264098, "creation_date": 1551261115, "last_edit_date": 1551264098, "question_id": 54902506, "link": "https://stackoverflow.com/questions/54902506/printing-array-to-variable-cell-range-vba", "title": "Printing array to variable cell range VBA", "body": "<p>I have a variable array which I want to print into another workbook range. As I loop through separate arrays and secondary workbooks, the cell I want to print to will change.</p>\n\n<p>Some sheets will need to array to be printed to A6:N, some will need the array printed to A300:N etc. I want to get to the bottom of the list of existing data and 'paste' the array below it.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>bottomrow2 = Range(\"A9999\").End(xlUp).Row\nSet PasteCell = ClientBook.Sheets(\"PasteSheet\").Range(Cells(bottomrow2 + 1,1),Cells(bottomrow2 + 1, 14))\nRange(PasteCell &amp; UBound(array)) = array\n</code></pre>\n\n<p><code>PasteCell</code> is effectively trying to be my A1:N. It's worth noting that if I hard-code where to <code>paste</code> the array to, it works fine.</p>\n\n<pre><code>Range(\"A1:N\" &amp; UBound(array)) = array\n'^This works fine.\n</code></pre>\n\n<p>Thanks for any help you can give.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1551261220, "post_id": 54902383, "comment_id": 96572345, "body": "Why not just use an <code>IF</code> formula, in Sheet1 A1?  You could look at using Sheet2&#39;s change events also"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551261577, "post_id": 54902383, "comment_id": 96572543, "body": "Also, IsNumeric exists as a function in VBA, so may be best to use a different name."}], "answers": [{"tags": [], "owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "is_accepted": false, "score": 0, "last_activity_date": 1551261234, "creation_date": 1551261234, "answer_id": 54902552, "question_id": 54902383, "link": "https://stackoverflow.com/questions/54902383/macro-only-runs-manually/54902552#54902552", "title": "macro only runs manually", "body": "<p>If you want macro's to work automatically, based on an event in the workbook, you can add a workbook event macro in ThisWorkbook. In this case you can use the Workbook_SheetChange event for instance, which runs everytime you make a change on a sheet: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetchange\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetchange</a></p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object,ByVal Source As Range) \n Application.EnableEvents = False 'Switch off events because otherwise it gets triggered again for the changes made in this macro\n 'First make sure that it only triggers when you change B2 of sheet 2\n If Source.Address = \"$B$2\" and Source.Parent.Name = \"Sheet2\" then\n     If Source.Value &gt; 0 Then\n         ThisWorkbook.sheets(\"Sheet1\").Range(\"A1\").Value = \"XX\"\n     End If\n end if\n Application.EnableEvents = True 'Turn the events back on again.\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1551261478, "creation_date": 1551261478, "answer_id": 54902654, "question_id": 54902383, "link": "https://stackoverflow.com/questions/54902383/macro-only-runs-manually/54902654#54902654", "title": "macro only runs manually", "body": "<p>You need to change your code a touch.  Have a proper UDF defined and called from Sheet1 A1, with a reference passed to Sheet2 A1, for example</p>\n\n<p>The function</p>\n\n<pre><code>Function IsNumeric2(rngCheck As Excel.Range)\n\nIf rngCheck.Value &gt; 0 Then\n    IsNumeric2 = \"XX\"\nElse\n    IsNumeric2 = \"\"\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>The call, in cell A1, <code>=IsNumeric2(Sheet2!A1)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11124210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dff972c73ead61fb2ee431368f29944?s=128&d=identicon&r=PG&f=1", "display_name": "M.S.", "link": "https://stackoverflow.com/users/11124210/m-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551263677, "creation_date": 1551260700, "last_edit_date": 1551263677, "question_id": 54902383, "link": "https://stackoverflow.com/questions/54902383/macro-only-runs-manually", "title": "macro only runs manually", "body": "<p>My knowledge with VBA is fairly basic so this may seem like a silly question.</p>\n\n<p>I have written a code so that cell A1 in sheet1 will read \"XX\" if cell B1 in sheet2 has a value in it. The code works but only if I select it and run it manually from VBA. if cell B1 in sheet2 has a value in it, cell A1 in sheet1 is not updating automatically. Here is the code</p>\n\n<pre><code>Sub IsNumeric()\nIf Sheets (\"Sheet2\").Range(\"B2) &gt; 0 Then\nSheets(\"Sheet1\").Range(\"A1\").Value = \"XX\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Cell B2 in sheet2 is a formula which will only generate a number if another cell is selected. i am not sure if this is relevant but as i mentioned the code is working just fine, just not automatically. </p>\n\n<p>Thanks! </p>\n"}, {"tags": ["javascript", "html", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551262084, "post_id": 54902310, "comment_id": 96572870, "body": "What are the values of <code>IE.document.getElementsByName(&quot;taxType&quot;).Value</code> at debug?  Is the value &quot;Select Tax Type&quot;?  Look at Microsoft Internet Controls and HTML library, you can then set the object properly so, you can put the drop down in an object and debug a little better."}, {"owner": {"reputation": 51, "user_id": 10450793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4ecbd167d821596dd2ab6f93b95615?s=128&d=identicon&r=PG&f=1", "display_name": "sgl", "link": "https://stackoverflow.com/users/10450793/sgl"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1551263940, "post_id": 54902310, "comment_id": 96574096, "body": "hi when I try : test = IE.document.getElementsByName(&quot;taxType&quot;)(0).Value then it will have then test = &quot;&quot; en with  test = IE.document.getElementsByName(&quot;taxType&quot;)(1).Value it has this error: object variable or with block variable not set"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10450793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4ecbd167d821596dd2ab6f93b95615?s=128&d=identicon&r=PG&f=1", "display_name": "sgl", "link": "https://stackoverflow.com/users/10450793/sgl"}, "edited": false, "score": 1, "creation_date": 1551265241, "post_id": 54903440, "comment_id": 96574971, "body": "wow I dont see the selected value in the dropdown box but it works!!!! Thank you very muchhh! I searched for this part for hours!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1551263699, "creation_date": 1551263699, "answer_id": 54903440, "question_id": 54902310, "link": "https://stackoverflow.com/questions/54902310/select-a-value-from-dropdown-on-ie-page-via-vba/54903440#54903440", "title": "Select a value from dropdown on IE page via VBA", "body": "<p>Try adding a change event and firing that</p>\n\n<pre><code>Option Explicit\n\nPublic Sub MakeSelection()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"url\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim event_onChange As Object\n        Set event_onChange = .document.createEvent(\"HTMLEvents\")\n        event_onChange.initEvent \"change\", True, False\n\n        With .document.querySelector(\"#fileOnlineReturnTaxType\")\n            .selectedIndex = 1\n            .FireEvent \"onchange\"\n            .dispatchEvent event_onChange\n        End With\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10450793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4ecbd167d821596dd2ab6f93b95615?s=128&d=identicon&r=PG&f=1", "display_name": "sgl", "link": "https://stackoverflow.com/users/10450793/sgl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 54903440, "answer_count": 1, "score": 1, "last_activity_date": 1555610694, "creation_date": 1551260496, "last_edit_date": 1555610694, "question_id": 54902310, "link": "https://stackoverflow.com/questions/54902310/select-a-value-from-dropdown-on-ie-page-via-vba", "title": "Select a value from dropdown on IE page via VBA", "body": "<p>I'm trying to select a value from a dropdown on a IE page.</p>\n\n<p>I have tried a lot of methods. It doesn't do anything.</p>\n\n<p>Source code of the drop down:<br>\n<a href=\"https://i.stack.imgur.com/uFe8a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uFe8a.png\" alt=\"source code of the drop down\"></a></p>\n\n<p>Codes I have tried, to select the value with \"EVR\" (there is only one value in the drop down):</p>\n\n<pre><code>Application.Wait Now + #12:00:06 AM#\n\nIE.Visible = True\n\n'IE.document.getElementById(\"fileOnlineReturnTaxType\").Value = \"EVR\"\n\n'IE.document.getElementsByName(\"taxType\").Value = \"84\"\n\n   'Set oSelect = IE.document.getElementById(\"fileOnlineReturnTaxType\")\n    '    oSelect.Focus\n     '   oSelect.selectedIndex = 1\n      '  oSelect.FireEvent \"onchange\"\n\n 'IE.document.getElementById(\"fileOnlineReturnTaxType\").Click\n\n\n  'Set Link3 = IE.document.getElementsByTagName(\"span\")\n\n   ' For Each t In Link3\n          ' If t.innerText = \"Select a tax type...\" Then\n          ' MsgBox (t.innerText)\n           '   t.Click\n            '  Exit For\n           'End If\n          'Next t\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1551260486, "post_id": 54902229, "comment_id": 96571840, "body": "You haven&#39;t said <i>what</i> is going wrong.  What happens with your code at the moment?"}, {"owner": {"reputation": 135, "user_id": 10985791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e70327220e7b1450d25957dc0366c5?s=128&d=identicon&r=PG&f=1", "display_name": "mat1986", "link": "https://stackoverflow.com/users/10985791/mat1986"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1551260966, "post_id": 54902229, "comment_id": 96572183, "body": "Ah my apologies. It&#39;s doing nothing to be exact. I save the VBA, then reload the sheet but it hasn&#39;t run today&#39;s Macro."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 4, "last_activity_date": 1551260937, "creation_date": 1551260937, "answer_id": 54902459, "question_id": 54902229, "link": "https://stackoverflow.com/questions/54902229/auto-running-a-macro-depending-on-day-of-the-week/54902459#54902459", "title": "Auto running a macro depending on day of the week", "body": "<p>The problem is with the way you have structured your code. If I indent your code, your code will look like this</p>\n\n<pre><code>If Weekday(sDate, vbSunday) = 1 Then\n    Call SundayEfficiency\nElse\n    If Weekday(sDate, vbMonday) = 2 Then\n        Call MondayEfficiency\n    Else\n        If Weekday(sDate, vbTuesday) = 3 Then\n            Call TuesdayEfficiency\n        Else\n            If Weekday(sDate, vbWednesday) = 4 Then\n                Call WednesdayEfficiency\n            Else\n                If Weekday(sDate, vbThursday) = 5 Then\n                    Call ThursdayEfficiency\n                Else\n                    If Weekday(sDate, vbFriday) = 6 Then\n                        Call FridayEfficiency\n                    Else\n                        If Weekday(sDate, vbSaturday) = 7 Then\n                            Call SaturdayEfficiency\n                        End If\n</code></pre>\n\n<p>The first problem you will experience with the above code is that you will have to add <code>End If</code> for each <code>If</code></p>\n\n<p>What you actually want is</p>\n\n<pre><code>If Weekday(sDate, vbSunday) = 1 Then\n    Call SundayEfficiency\nElseIf Weekday(sDate, vbMonday) = 2 Then\n    Call MondayEfficiency\nElseIf Weekday(sDate, vbTuesday) = 3 Then\n     Call TuesdayEfficiency\nElseIf Weekday(sDate, vbWednesday) = 4 Then\n   '\n   '~~&gt; And so on...\n   '\nEnd If\n</code></pre>\n\n<p>Alternatively you can use <code>Select Case</code></p>\n\n<pre><code>Select Case Weekday(Date, vbSunday)\n    Case 1: SundayEfficiency\n    Case 2: MondayEfficiency\n    Case 3: TuesdayEfficiency\n    '\n    '~~&gt; And So On\n'\nEnd Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 10985791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e70327220e7b1450d25957dc0366c5?s=128&d=identicon&r=PG&f=1", "display_name": "mat1986", "link": "https://stackoverflow.com/users/10985791/mat1986"}, "edited": false, "score": 0, "creation_date": 1551282951, "post_id": 54902517, "comment_id": 96585826, "body": "Ok that makes sense, it compiles fine but when I load the workbook up now it brings back an error &#39;Compile error in hidden module: Module 6. This error commonly occurs when code is incompatible with the version, platform, or architecture of this application&#39;. I&#39;m using Excel version 2016."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "reply_to_user": {"reputation": 135, "user_id": 10985791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e70327220e7b1450d25957dc0366c5?s=128&d=identicon&r=PG&f=1", "display_name": "mat1986", "link": "https://stackoverflow.com/users/10985791/mat1986"}, "edited": false, "score": 0, "creation_date": 1551285298, "post_id": 54902517, "comment_id": 96587393, "body": "You&#39;ll need to create a new question for that.  Googling the error message brings up a few hopeful-looking leads though."}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 1, "last_activity_date": 1551261831, "last_edit_date": 1551261831, "creation_date": 1551261145, "answer_id": 54902517, "question_id": 54902229, "link": "https://stackoverflow.com/questions/54902229/auto-running-a-macro-depending-on-day-of-the-week/54902517#54902517", "title": "Auto running a macro depending on day of the week", "body": "<p>If you look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/weekday-function\" rel=\"nofollow noreferrer\">documentation</a> for the <code>Weekday()</code> function, you will see that the second parameter sets which day of the week it should treat as the first day.  So calling <code>Weekday(sDate, vbTuesday)</code> will return 1 for Tuesday, 2 for Wednesday, etc.</p>\n\n<p>Therefore the only time your code will work properly is on a Sunday.  On a Tuesday it will run <code>MondayEfficiency</code>, as Tuesday is the second day of the week if you set the first day of the week as <code>vbMonday</code>.  On a Wednesday it will run <code>FridayEfficiency</code> as Wednesday is day 6 if you start on Friday.</p>\n\n<p>There are a few other things that could be improved while we're at it: <code>Weekday()</code> can take a date serial value so there is no need to convert to a string; and a case statement is more efficient and readable here.</p>\n\n<p>Putting it together:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Select Case Weekday(Date, vbSunday)\n        Case 1\n            Call SundayEfficiency\n        Case 2\n            Call MondayEfficiency\n        Case 3\n            Call TuesdayEfficiency\n        Case 4\n            Call WednesdayEfficiency\n        Case 5\n            Call ThursdayEfficiency\n        Case 6\n            Call FridayEfficiency\n        Case 7\n            Call SaturdayEfficiency\n    End Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 10985791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e70327220e7b1450d25957dc0366c5?s=128&d=identicon&r=PG&f=1", "display_name": "mat1986", "link": "https://stackoverflow.com/users/10985791/mat1986"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1551264015, "creation_date": 1551260227, "last_edit_date": 1551264015, "question_id": 54902229, "link": "https://stackoverflow.com/questions/54902229/auto-running-a-macro-depending-on-day-of-the-week", "title": "Auto running a macro depending on day of the week", "body": "<p>I'm trying to setup my workbook that will look at the day of the week and pull the appropriate macro for that day. For example I have 7 Macro's title by the day of the week, as it's a Wednesday, I want the wednesday macro to open when a user opens up the workbook.</p>\n\n<p>I've got the following code but not sure where I'm going wrong...</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim sDate As String\n\nsDate = Format(Date, \"ddmmyyyy\")\n\nIf Weekday(sDate, vbSunday) = 1 Then\nCall SundayEfficiency\nElse\n\nIf Weekday(sDate, vbMonday) = 2 Then\nCall MondayEfficiency\nElse\n\nIf Weekday(sDate, vbTuesday) = 3 Then\nCall TuesdayEfficiency\nElse\n\nIf Weekday(sDate, vbWednesday) = 4 Then\nCall WednesdayEfficiency\nElse\n\nIf Weekday(sDate, vbThursday) = 5 Then\nCall ThursdayEfficiency\nElse\n\nIf Weekday(sDate, vbFriday) = 6 Then\nCall FridayEfficiency\nElse\n\nIf Weekday(sDate, vbSaturday) = 7 Then\nCall SaturdayEfficiency\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "answers": [{"tags": [], "owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "is_accepted": true, "score": 0, "last_activity_date": 1551265270, "last_edit_date": 1551265270, "creation_date": 1551264407, "answer_id": 54903674, "question_id": 54902086, "link": "https://stackoverflow.com/questions/54902086/how-to-get-an-output-from-a-list-box-to-populate-some-cells/54903674#54903674", "title": "How to get an output from a list box to populate some cells", "body": "<p>Right now you are creating one string. It has linebreaks in it, but it\u00b4s still one text. If you are not using the <code>tmpmsg</code> for something else, you could use the for-loop to populate your sheet</p>\n\n<pre><code>For t = 1 To ListBox2.ListCount\n  Thisworkbook.sheets(\"Specialist Prices\").Range(\"A\" &amp; t).value = ListBox2.List(t - 1)\nNext\n</code></pre>\n\n<p>You can even do it faster by adding an array to the entire range. <code>ListBox2.List</code> is an array of values and you can paste that array into a range of cells:</p>\n\n<pre><code>ThisWorkbook.sheets(\"Specialist Prices\").Cells(1,1).Resize(ListBox2.ListCount,1) = ListBox2.List\n</code></pre>\n\n<p>The <code>Resize</code> method here makes sure that the range contains the same amount of cells as there are elements in <code>ListBox2</code>. It resizes the range from 1 cell to a range of <code>ListBox2.ListCount</code> amount of rows and 1 column.</p>\n"}], "owner": {"reputation": 3, "user_id": 11124133, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f8LNv3Lqjqk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rffxLzVXubp4z1ib8t5kbNteic85A/mo/photo.jpg?sz=128", "display_name": "Karlage", "link": "https://stackoverflow.com/users/11124133/karlage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 54903674, "answer_count": 1, "score": 0, "last_activity_date": 1551265270, "creation_date": 1551259761, "question_id": 54902086, "link": "https://stackoverflow.com/questions/54902086/how-to-get-an-output-from-a-list-box-to-populate-some-cells", "title": "How to get an output from a list box to populate some cells", "body": "<p>I've created a userform with a couple of list boxes in. Listbox1 has all items in it, the user can select multiple values to then move into Listbox2. once they are in listbox2 I need them to populate some cells. With 1 list item per cell. </p>\n\n<p>I'm having a pain trying to work out how to do it. So far all I've got is:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim tmpMsg As String\nDim t As Long\n\n tmpMsg = \"Selected categories:\"\n\nFor t = 1 To ListBox2.ListCount\n tmpMsg = tmpMsg &amp; vbNewLine &amp; ListBox2.List(t - 1)\nNext\n\n Worksheets(\"Specialist Prices\").Activate\n    Range(\"a1\").Select\n    ActiveCell.Value = tmpMsg\n\nEnd Sub\n</code></pre>\n\n<p>This populates cell A1 with the entire set of list items. but I don't know how to put 1 value in a1 then move down and put the next in A2 and so on until all items are accounted for.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "edited": false, "score": 0, "creation_date": 1551259610, "post_id": 54901804, "comment_id": 96571299, "body": "<a href=\"https://stackoverflow.com/questions/38105691/vba-write-data-from-excel-cell-to-text-batch-file\" title=\"vba write data from excel cell to text batch file\">stackoverflow.com/questions/38105691/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551259922, "post_id": 54902054, "comment_id": 96571484, "body": "Is there any way i can do it on two fixed cells instead of having to select them every time?"}, {"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551260172, "post_id": 54902054, "comment_id": 96571646, "body": "Also, the file is not saved in the same place as the excel file, but that&#39;s a minor issue."}], "tags": [], "owner": {"reputation": 28, "user_id": 9924942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ccbcb05e20ed2a2e6cf57b07c7a372?s=128&d=identicon&r=PG&f=1", "display_name": "M. Cahyna", "link": "https://stackoverflow.com/users/9924942/m-cahyna"}, "is_accepted": false, "score": 0, "last_activity_date": 1551259665, "creation_date": 1551259665, "answer_id": 54902054, "question_id": 54901804, "link": "https://stackoverflow.com/questions/54901804/how-do-i-write-a-visual-basic-application-excel-program-that-writes-text-from/54902054#54902054", "title": "How do I write a Visual Basic Application (Excel) program that writes text from two cells into a new text file?", "body": "<p>This Macro do it. Just select, which cells you want to write in file and run it.</p>\n\n<pre><code>Sub Makro1()\n'\n' Makro1 Makro\n'\n\n'\n    Dim myFile As String, rng As Range, cellValue As Variant, i As Integer, j As Integer\n    myFile = Application.DefaultFilePath &amp; \"\\text_file.txt\"\n    Set rng = Selection\n    Open myFile For Output As #1\n    For i = 1 To rng.Rows.Count\n        For j = 1 To rng.Columns.Count\n            cellValue = rng.Cells(i, j).Value\n            If j = rng.Columns.Count Then\n                Write #1, cellValue\n            Else\n                Write #1, cellValue,\n            End If\n        Next j\n    Next i\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>File text_file.txt is saved in place, where is saved Excel file.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551261314, "post_id": 54902294, "comment_id": 96572397, "body": "Thanks, but how do I stop it from overwriting the previous data and just add it in a new line?"}, {"owner": {"reputation": 28, "user_id": 9924942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ccbcb05e20ed2a2e6cf57b07c7a372?s=128&d=identicon&r=PG&f=1", "display_name": "M. Cahyna", "link": "https://stackoverflow.com/users/9924942/m-cahyna"}, "reply_to_user": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551261479, "post_id": 54902294, "comment_id": 96572495, "body": "In line Open myFile For Output As #1 change Output to Append"}, {"owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551261965, "post_id": 54902294, "comment_id": 96572799, "body": "Thanks, I think I can figure out the other issues myself"}, {"owner": {"reputation": 28, "user_id": 9924942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ccbcb05e20ed2a2e6cf57b07c7a372?s=128&d=identicon&r=PG&f=1", "display_name": "M. Cahyna", "link": "https://stackoverflow.com/users/9924942/m-cahyna"}, "reply_to_user": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551262035, "post_id": 54902294, "comment_id": 96572834, "body": "Great, so you can mark this answer as right? The place, where the txt is saved is defined in \\text_file.txt. You can use \\path\\to\\folder\\text_file.txt"}, {"owner": {"reputation": 28, "user_id": 9924942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ccbcb05e20ed2a2e6cf57b07c7a372?s=128&d=identicon&r=PG&f=1", "display_name": "M. Cahyna", "link": "https://stackoverflow.com/users/9924942/m-cahyna"}, "reply_to_user": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "edited": false, "score": 0, "creation_date": 1551262260, "post_id": 54902294, "comment_id": 96572997, "body": "Thanks :-). Happy coding."}], "tags": [], "owner": {"reputation": 28, "user_id": 9924942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ccbcb05e20ed2a2e6cf57b07c7a372?s=128&d=identicon&r=PG&f=1", "display_name": "M. Cahyna", "link": "https://stackoverflow.com/users/9924942/m-cahyna"}, "is_accepted": true, "score": 0, "last_activity_date": 1551260450, "creation_date": 1551260450, "answer_id": 54902294, "question_id": 54901804, "link": "https://stackoverflow.com/questions/54901804/how-do-i-write-a-visual-basic-application-excel-program-that-writes-text-from/54902294#54902294", "title": "How do I write a Visual Basic Application (Excel) program that writes text from two cells into a new text file?", "body": "<pre><code>Sub Makro1()\n'\n' Makro1 Makro\n'\n\n'\n    Dim myFile As String, rng As Range, cellValue As Variant, i As Integer, j As Integer\n    myFile = Application.DefaultFilePath &amp; \"\\text_file.txt\"\n    Set rng = Selection\n    Open myFile For Output As #1\n    cellValue = Range(\"A1\").Value\n    Write #1, cellValue\n    cellValue = Range(\"B1\").Value\n    Write #1, cellValue\n    Close #1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11123898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqsSn.jpg?s=128&g=1", "display_name": "Alex J.", "link": "https://stackoverflow.com/users/11123898/alex-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 54902294, "answer_count": 2, "score": 0, "last_activity_date": 1551260450, "creation_date": 1551258893, "question_id": 54901804, "link": "https://stackoverflow.com/questions/54901804/how-do-i-write-a-visual-basic-application-excel-program-that-writes-text-from", "title": "How do I write a Visual Basic Application (Excel) program that writes text from two cells into a new text file?", "body": "<p>How can I write a Visual Basic Application (Excel) program that writes text from two cells into a new text file when I click a button? I know very little, if anything at all, about Visual Basic, much less about Visual Basic Application.\nAll of the online resources have failed me as either they don't work the way I intend the program to or don't work at all, giving me errors I have no idea how to solve.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "is_accepted": true, "score": 0, "last_activity_date": 1551252671, "creation_date": 1551252671, "answer_id": 54900201, "question_id": 54899934, "link": "https://stackoverflow.com/questions/54899934/excel-vba-problem-when-item-already-registered-in-sheet-only-sum-the-quantity/54900201#54900201", "title": "excel vba problem when item already registered in sheet, only sum the quantity", "body": "<p>Generate your product string and look for it in column B. If found, add the quantity to column C; if not add a new row with all information.</p>\n\n<pre><code>Private Sub btnSubmit_Click()\n\n    Dim lastRow2 As Long, m as variant, str as string\n\n    with workSheets(\"Sheet2\")\n\n        .Activate\n\n        str = UCase(tbTipe.Text &amp; \" (\" &amp; tbColor.Text &amp; \") - \" &amp; tbProduct.Text)\n\n        m = application.match(str, .range(\"B:B\"), 0)\n\n        if not iserror(m) then\n            .Range(\"C\" &amp; m).Value = .Range(\"C\" &amp; m).Value + val(tbQty.Value)\n        else\n            lastRow2 = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n            .Range(\"A\" &amp; lastRow2).Value = CDate(tbDate)\n            .Range(\"B\" &amp; lastRow2).Value = str\n            .Range(\"C\" &amp; lastRow2).Value = val(tbQty.Value)\n            .Range(\"D\" &amp; lastRow2).Value = val(tbPrice.Value)\n        End If\n    Next cell2\n\nEnd Sub\n</code></pre>\n\n<p>VBA's string concatenation symbol is the ampersand (<strong>&amp;</strong>), not the plus sign (<strong>+</strong>).</p>\n"}], "owner": {"reputation": 61, "user_id": 10423457, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mtD25rFGJEo/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtutkOGjYTmuDiSXaiaq189l4h3g/mo/photo.jpg?sz=128", "display_name": "Jin Asterich", "link": "https://stackoverflow.com/users/10423457/jin-asterich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 54900201, "answer_count": 1, "score": 0, "last_activity_date": 1551252671, "creation_date": 1551251476, "question_id": 54899934, "link": "https://stackoverflow.com/questions/54899934/excel-vba-problem-when-item-already-registered-in-sheet-only-sum-the-quantity", "title": "excel vba problem when item already registered in sheet, only sum the quantity", "body": "<p>so what i want is when user add a product which is already registered in the sheet, the quantity of that product is added and not add new row. this is the code that i already make but the problem with this code is that the system doesnt enter the if loop and so it adds new rows again. </p>\n\n<p>this is the sample:\n<a href=\"https://i.stack.imgur.com/HV6qU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HV6qU.png\" alt=\"excel image\"></a></p>\n\n<p>code:</p>\n\n<pre><code>Private Sub btnSubmit_Click()\nSheet2.Activate\nDim lastRow2 As Long\nlastRow2 = Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nSet rng2 = Worksheets(\"Sheet2\").Range(\"B2:B\" &amp; lastRow2)\nFor Each cell2 In rng2\n    If cell2 = tbTipe.Text + \" \" + \"(\" + tbColor.Text + \")\" + \" \" + \"-\" + \" \" + tbProduct.Text Then\n         cell2.Offset(0, 1) = cell2.Offset(0, 1) + tbQty.Value\n    Else\n        Sheets(\"Sheet2\").Range(\"A\" &amp; lastRow2).Value = CDate(tbDate)\n        Sheets(\"Sheet2\").Range(\"B\" &amp; lastRow2).Value = UCase(tbTipe.Text + \" \" + \"(\" + tbColor.Text + \")\" + \" \" + \"-\" + \" \" + tbProduct.Text)\n        Sheets(\"Sheet2\").Range(\"C\" &amp; lastRow2).Value = tbQty.Value\n        Sheets(\"Sheet2\").Range(\"D\" &amp; lastRow2).Value = tbPrice.Value\n    End If\nNext cell2\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\ntbDate.Value = Date\ntbProduct.Value = \"\"\ntbQty.Value = \"\"\ntbPrice.Value = \"\"\ntbTipe.Value = \"\"\ntbColor.Value = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "tsql"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1551260905, "post_id": 54899544, "comment_id": 96572138, "body": "Yes, you can create a stored procedure that inserts rows into a table, and only give the user permission to read from the table and to execute the procedure. The requirement is that the owner of the procedure is also the owner of the table in question, in that case the permissions are not checked."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1551261244, "post_id": 54899544, "comment_id": 96572359, "body": "@GSerg I&#39;m a bit confused, maybe I just need a coffee, but if you are the owner of a table don&#39;t you have full access to that table anyway then? I find it strange to be the owner of a table but not having access to my own table."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551261494, "post_id": 54899544, "comment_id": 96572500, "body": "@P\u1d07\u029c If, as the owner of the table, you also create a stored procedure that inserts into that table, and grant <code>execute</code> on it to someone else, they will be able to call it and have it insert, even though they do not have a permission to insert directly. The procedure is executed in <i>their</i> security context, and the insert succeeds because the permission check is not performed (which is because you own the procedure and the table), not because they execute it &quot;as you&quot;."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1551261750, "post_id": 54899544, "comment_id": 96572669, "body": "@GSerg Ah, that&#39;s clear now. Thanks for that explanation."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1551261014, "post_id": 54902302, "comment_id": 96572208, "body": "You should have read a little bit further. <i>&quot;However, if the same user owns the calling module and the module being called, EXECUTE permission checking is not performed for the second module.&quot;</i> That is, if the same user owns the stored procedure and the table, the permission check is skipped."}, {"owner": {"reputation": 352, "user_id": 1103911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/98cbbeaf9ab6b15b11c5056bcca3e0ed?s=128&d=identicon&r=PG", "display_name": "Eliy Arlev", "link": "https://stackoverflow.com/users/1103911/eliy-arlev"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1551262543, "post_id": 54902302, "comment_id": 96573180, "body": "@GSerg What I understand from the second paragraph, in simple words is: If I wrote the procedure and I called to execute it, then EXECUTE permission checking is not performed. Am I correct?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1551262676, "post_id": 54902302, "comment_id": 96573267, "body": "No. If you wrote the procedure and you own the table, then <code>insert</code> permissions are not checked if someone else executes your procedure."}, {"owner": {"reputation": 127, "user_id": 6096348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e579605c2c44d6c41d4483f34ad0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6096348/mike"}, "edited": false, "score": 0, "creation_date": 1551274467, "post_id": 54902302, "comment_id": 96580395, "body": "@peh How would you suggest the data of excel cell is passed via execute statement. Any script example?"}], "tags": [], "owner": {"reputation": 352, "user_id": 1103911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/98cbbeaf9ab6b15b11c5056bcca3e0ed?s=128&d=identicon&r=PG", "display_name": "Eliy Arlev", "link": "https://stackoverflow.com/users/1103911/eliy-arlev"}, "is_accepted": false, "score": -1, "last_activity_date": 1551260470, "creation_date": 1551260470, "answer_id": 54902302, "question_id": 54899544, "link": "https://stackoverflow.com/questions/54899544/write-to-database-with-read-only-access-tsql-stored-procedure/54902302#54902302", "title": "Write to database with Read only access [TSQL Stored Procedure]", "body": "<p>I am sorry to be the bringer of bad news, however the work-around you want cannot be done on T-SQL. from official <a href=\"https://docs.microsoft.com/en-us/sql/t-sql/language-elements/execute-transact-sql?view=sql-server-2017#permissions\" rel=\"nofollow noreferrer\">Microsoft documentation</a></p>\n\n<blockquote>\n  <p>\" Permissions are not required to run the EXECUTE statement. However, permissions are required on the securables that are referenced within the EXECUTE string. For example, if the string contains an INSERT statement, the caller of the EXECUTE statement must have INSERT permission on the target table...\"</p>\n</blockquote>\n"}], "owner": {"reputation": 127, "user_id": 6096348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e579605c2c44d6c41d4483f34ad0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6096348/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "closed_date": 1551261845, "answer_count": 1, "score": -1, "last_activity_date": 1551261937, "creation_date": 1551249873, "last_edit_date": 1551257690, "question_id": 54899544, "link": "https://stackoverflow.com/questions/54899544/write-to-database-with-read-only-access-tsql-stored-procedure", "closed_reason": "Duplicate", "title": "Write to database with Read only access [TSQL Stored Procedure]", "body": "<p>Situation:<br>\nI have various users that has been allowed READ ONLY access to a database.\nIs it possible to INSERT rows to database via Stored Procedure using a range in Excel?</p>\n\n<p>If yes, Can anyone please assist me with a sample VBA or SQL script?</p>\n"}, {"tags": ["excel", "vba", "string-comparison"], "comments": [{"owner": {"reputation": 187, "user_id": 6304872, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1041e437eb37b26740296f440411dee4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexVB", "link": "https://stackoverflow.com/users/6304872/alexvb"}, "edited": false, "score": 0, "creation_date": 1551250504, "post_id": 54899521, "comment_id": 96567108, "body": "Cycling through cells is very slow. Copy entire column to array and cycle through array instead."}, {"owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "edited": false, "score": 0, "creation_date": 1551251582, "post_id": 54899521, "comment_id": 96567531, "body": "Instead of your inner ForNext why not consider Finding the value in the inital column. That way you don&#39;t need to cycle through each cell in the column. Your inner routine is basically a custom Find routine, the built-in find routines are much faster. In addition, are you setting screen updating off? Updating the screen can take a significant amount of time epescially in a nested ForNext."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1551258272, "post_id": 54899521, "comment_id": 96570515, "body": "Turn off events and screenupdating and see if that speeds it up. It ultimately will, just depends on how much."}, {"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1551260108, "post_id": 54899521, "comment_id": 96571601, "body": "I&#39;m fairly new to VBA so am unsure how I would use an array to accomplish the same task.  Would it be possible to show an example of what the array would need to look like?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1551311673, "post_id": 54899521, "comment_id": 96598788, "body": "How many columns do you have in Sheet(3)?"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1551260031, "creation_date": 1551260031, "answer_id": 54902170, "question_id": 54899521, "link": "https://stackoverflow.com/questions/54899521/excel-vba-compare-values-in-two-ddifferent-columns-and-keep-entire-line-for-com/54902170#54902170", "title": "Excel VBA, compare values in two ddifferent columns and keep entire line for common values", "body": "<p>I think you could modify &amp; use the below:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim Lastrow1 As Long, Lastrow2 As Long, Lastrow3 As Long, i As Long\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\n    Dim str As String\n    Dim rng As Range\n\n    'Set Worksheet' Variables\n    With ThisWorkbook\n        Set ws1 = .Worksheets(\"Sheet1\")\n        Set ws2 = .Worksheets(\"Sheet2\")\n        Set ws3 = .Worksheets(\"Sheet3\")\n    End With\n\n    'Clear Sheet3\n    ws3.UsedRange.Clear\n\n    'Find Lastrow of Sheet1 &amp; Sheet2\n    Lastrow1 = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\n    Lastrow2 = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row\n\n    'Loop Sheet1, Column A\n    For i = 1 To Lastrow1\n\n        'Set str. It's the value in Sheet1, Column A &amp; Row i\n        str = ws1.Range(\"A\" &amp; i).Value\n\n        'Use Find Method to check if str apperas in Sheet2, Column A\n        Set rng = ws2.Range(\"A1:A\" &amp; Lastrow2).Find(str)\n\n        'If rng in not nothing - Empty (means that str found in sheet2, column A\n        If Not rng Is Nothing Then\n            'Find lastrow of Sheet3, Column A\n            Lastrow3 = ws3.Cells(ws3.Rows.Count, \"A\").End(xlUp).Row\n            'Copy from Sheet1, Column A &amp; row rng.row to Sheet3, Column A Lastrow3 + 1\n            ws1.Cells(rng.Row, 1).Copy ws3.Cells(Lastrow3 + 1, 1)\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1551367121, "last_edit_date": 1551367121, "creation_date": 1551328088, "answer_id": 54918415, "question_id": 54899521, "link": "https://stackoverflow.com/questions/54899521/excel-vba-compare-values-in-two-ddifferent-columns-and-keep-entire-line-for-com/54918415#54918415", "title": "Excel VBA, compare values in two ddifferent columns and keep entire line for common values", "body": "<h1>Match Copy Paste</h1>\n\n<p>You will have to adjust the worksheet names to fit yours. They are now adjusted as you have the indexes in your code: <code>Sheet(1)</code> is <code>\"Sheet1\"</code> ...\nUsing the indexes is quite tricky, so I would recommend you stay away from it.</p>\n\n<h2>What</h2>\n\n<p>Compares the values of two columns on different worksheets, and when a match is found, copies the row from one (specified) of the worksheets to a third worksheet. </p>\n\n<h2>How (Not entirely true)</h2>\n\n<p>The columns to be matched are copied to two arrays. Then by looping through the arrays, the row numbers of the matches are written to a 3rd array. Then the 'used range' of the source worksheet is copied to a 4th array. Then by looping through the 3rd array (row numbers), each row in 4th array (range) is copied to a 5th array which is then copied to the target worksheet.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub MatchCopyPaste()\n\n    Const cTgt As String = \"Sheet1\"   ' Target Worksheet Name\n    Const cChk As String = \"Sheet2\"   ' Check Worksheet Name\n    Const cSrc As String = \"Sheet3\"   ' Source Worksheet Name\n\n    Const cFR As Long = 2             ' First Row\n    Const cLURC As Long = 1           ' Last-Used-Row Column\n    Const cCrit As Long = 3           ' Criteria Column\n\n    Dim rng As Range      ' Last Used Cell of Ranges, Ranges\n    Dim vntSC As Variant  ' Source-Column Array\n    Dim vntCC As Variant  ' Check-Column Array\n    Dim vntTR As Variant  ' Target-Rows Array\n    Dim vntS As Variant   ' Source Array\n    Dim vntT As Variant   ' Target Array\n    Dim SRC As Long       ' Source Rows Count\n    Dim CRC As Long       ' Check Rows Count\n    Dim TRC As Long       ' Target Rows Count\n    Dim STCC As Long      ' Source/Target Columns Count\n    Dim i As Long         ' Source-Column Array Row Counter\n                          ' Target-Rows Array Row (Element) Counter,\n                          ' Target Array Row Counter\n    Dim j As Long         ' Source/Target Array Column Counter\n    Dim k As Long         ' Check-Column Array Row Counter\n\n    ' Speed up.\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    ' Handle Errors.\n    'On Error GoTo ErrorHandler\n\n    ' In Last-Used-Row Column (cLURC) of Source Worksheet (cSrc)\n    With ThisWorkbook.Worksheets(cSrc).Columns(cLURC)\n        ' Create a reference to the Last Used Cell (rng).\n        Set rng = .Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious)\n        ' Calculate Source Rows Count (SRC).\n        SRC = rng.Row - cFR + 1\n        ' Create a reference to Source-Column Range (rng) calculated from First\n        ' Cell (.Cells(cFR, cCrit)), rows resized by Source Rows Count (SRC).\n        Set rng = .Parent.Cells(cFR, cCrit).Resize(SRC)\n        ' Copy Source-Column Range (rng) to 2D 1-based 1-column Source-Column\n        ' Array (vntSC).\n        vntSC = rng\n    End With\n    ' In Last-Used-Row Column (cLURC) of Check Worksheet (cChk)\n    With ThisWorkbook.Worksheets(cChk).Columns(cLURC)\n        ' Create a reference to the Last Used Cell (rng).\n        Set rng = .Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious)\n        ' Calculate Check Rows Count (CRC).\n        CRC = rng.Row - cFR + 1\n        ' Create a reference to Check-Column Range (rng) calculated from First\n        ' Cell (.Cells(cFR, cCrit)), rows resized by Check Rows Count (CRC).\n        Set rng = .Parent.Cells(cFR, cCrit).Resize(CRC)\n        ' Copy Check-Column Range (rng) to 2D 1-based 1-column Check-Column\n        ' Array (vntCC).\n        vntCC = rng\n    End With\n\n    ' Resize 1D 1-based Target-Rows Array (vntTR) to number of elements (rows)\n    ' equal to Source Rows Count (SRC), because it cannot have more elements\n    ' (rows). Later it will be down-sized (Redim).\n    ' Remarks:\n    '   In a 2D array, \"rows\" are the first dimension which cannot be resized.\n    '   Target-Rows Array is chosen to be 1D, because only the last dimension\n    '   of an array can be resized i.e. the first, last and only dimension\n    '   will be elements (rows).\n    '   Note: It can be done with a 2D array by writing to the 2nd dimension,\n    '     \"columns\", which would be acceptable even a \"must\" if it later had\n    '     to copied to a range (using Transpose).\n    ReDim vntTR(1 To SRC)\n\n'**********************************************************\n    ' Since you are writing data from Source-Column Range you wouldn't want\n    ' to check values in Check-Column Range that aren't in Source-Column Range\n    ' and you would probably want the order of found rows sorted by the\n    ' found rows in Source-Column Range, not in Check-Column Range.\n    ' If I'm wrong, outcomment these two lines and uncomment the corresponding\n    ' lines below, which represent you original loop.\n'**********************************************************\n    ' Loop through rows (i) of Source-Column Array.\n    For i = 1 To SRC\n        ' Loop through rows (k) of Check-Column Array.\n        For k = 1 To CRC\n'**********************************************************\n'    ' Loop through rows (k) of Check-Column Array.\n'    For k = 1 To CRC\n'        ' Loop through rows (i) of Source-Column Array.\n'        For i = 1 To SRC\n'**********************************************************\n            ' Check current value of Check-Column Array (vntCC) against\n            ' current value of Source-Columns Array (vntSC).\n            If vntSC(i, 1) = vntCC(k, 1) Then ' Matching found.\n                ' Increase Target Row Counter (TRC) by 1 i.e. count the number\n                ' of elements (rows) in Target-Rows Array (vntTR).\n                TRC = TRC + 1\n                ' Write current row number (i) of Source-Column Array (vntSC)\n                ' to current element (row) (TRC) of Target-Rows Array (vntTR).\n                vntTR(TRC) = i\n'**********************************************************\n                ' If you want to find only the first occurrence of a match,\n                ' even better, if you know there is only one occurrence (i.e.\n                ' Check-Column Range contains unique values), you\n                ' will want to stop looping to increase efficiency i.e.\n                ' you have to uncomment the following line.\n'**********************************************************\n'                ' Match found. Stop looping in rows (k) of Check-Column Array\n'                ' (vntCC). Go to next row (i) of Source-Column Array (vntSC).\n'                Exit For\n'**********************************************************\n            End If\n        Next\n    Next\n\n    ' Resize (down-size) Target-Rows Array (vntTR) to number of elements (rows)\n    ' equal to Target Rows Count (TRC).\n    ReDim Preserve vntTR(1 To TRC)\n\n    ' In Source Worksheet\n    With ThisWorkbook.Worksheets(cSrc)\n        ' Calculate Source/Target Columns Count (STCC) which in this case (not\n        ' always) is equal to the Last Used Column in Source Range, because the\n        ' copying later, is done from first column (1, because entire rows).\n        STCC = .Cells.Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious).Column\n        ' Create a reference to Source Range (rng) calculated from First Cell\n        ' (.Cells(cFR, cCrit)), rows resized by Source Rows Count (SRC),\n        ' and columns resized by Source/Target Columns Count (STCC).\n        Set rng = .Cells(cFR, 1).Resize(SRC, STCC)\n        ' Copy Source Range (rng) to 2D 1-based multi-column Source Array\n        ' (vntS).\n        vntS = rng\n    End With\n\n    ' Resize 2D 1-based multi-column Target Array (vntT) to Target Rows Count\n    ' (TRC) for the 1st dimension (rows), and to Source/Target Columns Count\n    ' (STCC) for the 2nd dimension (columns).\n    ReDim vntT(1 To TRC, 1 To STCC)\n\n    ' Loop through elements (rows) (i) of Target-Rows Array (vntTR)\n    For i = 1 To TRC\n        ' Loop through columns (j) of Source Array (vntS).\n        For j = 1 To STCC\n            ' Write from Source Array (vntS), the value in the row which number\n            ' is taken from current element (row) (i) of Target-Rows Array\n            ' (vntTR), to current row of Target Array (vntT), both in current\n            ' Source/Target Array Column (j).\n            ' Note: The current element (row) (i) Target-Rows Array (vntTR) is equal\n            ' to the current row (i) in Target Array (vntT).\n            vntT(i, j) = vntS(vntTR(i), j)\n        Next\n    Next\n\n    ' In Last-Used-Row Column (cLURC) of Target Worksheet(cTgt).\n    With ThisWorkbook.Worksheets(cTgt).Columns(cLURC)\n        ' Create a reference to the Last Used Cell.\n        Set rng = .Find(\"*\", , xlFormulas, , xlByColumns, xlPrevious)\n        ' Check if Last-Used-Row Column is not empty (Not ... Is Nothing).\n        If Not rng Is Nothing Then  ' NOT empty. DOES contain data.\n            ' Create a reference to Target Range (rng) calculated from the cell\n            ' below (rng.Row + 1) the Last Used Cell in first column (1, because\n            ' entire row) resized to the size (TRC, STCC)\n            ' of Target Array (vntT).\n            Set rng = .Parent.Cells(rng.Row + 1, 1).Resize(TRC, STCC)\n          Else                      ' EMPTY. Does NOT contain data.\n            ' Create a reference to Target Range (rng) calculated from the cell\n            ' in First Row (cFR) in first column (1, because entire row) resized\n            ' to the size (TRC, STCC) of Target Array (vntT).\n            Set rng = .Parent.Cells(cFR, 1).Resize(TRC, STCC)\n        End If\n    End With\n\n    ' Copy Target Array (vntT) to Target Range (rng).\n    rng = vntT\n\n    ' Apply formatting to Target Range (rng).\n    With rng\n        .NumberFormat = \"0\"\n        .Columns.AutoFit\n    End With\n\n    ' Inform user that it is done.\n    MsgBox \"The operation finished successfully.\", vbInformation, \"Success\"\n\nProcedureExit:\n\n    ' Speed down.\n    With Application\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n    End With\n\nExit Sub\n\nErrorHandler:\n\n    MsgBox \"An unexpected error has occurred. Error '\" &amp; Err.Number &amp; \"': '\" _\n            &amp; Err.Description &amp; \"'\", vbCritical, \"Error\"\n    GoTo ProcedureExit\n\nEnd Sub\n</code></pre>\n\n<h2>Remarks</h2>\n\n<p>The code technically doesn't copy entire rows, it just copies the data of cells from column A to the last column containing data (on the worksheet). If there are thousands of columns there might be a memory issue not to mention if there are tens of thousands of matches.</p>\n"}], "owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 54902170, "answer_count": 2, "score": 1, "last_activity_date": 1551367121, "creation_date": 1551249755, "last_edit_date": 1551250207, "question_id": 54899521, "link": "https://stackoverflow.com/questions/54899521/excel-vba-compare-values-in-two-ddifferent-columns-and-keep-entire-line-for-com", "title": "Excel VBA, compare values in two ddifferent columns and keep entire line for common values", "body": "<p>I have two worksheets with information and I want to compare values in a column from each worksheet and if the values are the same, then I want to copy that entire line that corresponds to a new worksheet.  I currently am using For Next loops but it is very time consuming to run.  Does anyone know a faster method for accomplishing this same task?</p>\n\n<pre><code>'compares results and copies entire row with like results to new page\nSheets(2).Select\nLR2 = 0\nLR2 = Cells(Rows.Count, 1).End(xlUp).Row\nSheets(3).Select\nLR3 = 0\nLR3 = Cells(Rows.Count, 1).End(xlUp).Row\nSheets(2).Select\nx = 2\nFor I = 2 To LR2\nCellVal = Cells(x,3).Value\n    Sheets(3).Select\n    xx = 2\n    For ii = 2 To LR3\n        CellVal2 = Cells(xx,3).Value\n        If CellVal = CellVal2 Then\n            Rows(xx).Copy\n            Sheets(1).Select\n            LR1 = 0\n            LR1 = Cells(Rows.Count, 1),End(xlUp).Row\n            Cells(LR1 + 1, 1).Select\n            Selection.PasteSpecial Paste:=xlPasteValues\n            Selection.NumberFormat = \"0\"\n            Selection.Columns.AutoFit\n        End If\n    xx = xx + 1\n    Next ii\nx = x + 1\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1551248158, "creation_date": 1551248158, "answer_id": 54899177, "question_id": 54898953, "link": "https://stackoverflow.com/questions/54898953/show-visible-sheets-in-combobox/54899177#54899177", "title": "Show visible sheets in combobox", "body": "<p>Is this what you are trying?</p>\n\n<pre><code>Private Sub Combobox1_DropbuttonClick()\n    Dim xSheet As Worksheet\n\n    '~~&gt; Clear the bocmbobox\n    ComboBox1.Clear\n\n    '~~&gt; Add the sheet again\n    For Each xSheet In ThisWorkbook.Sheets\n        '~~&gt; Check if they are visible\n        If xSheet.Visible = xlSheetVisible Then\n            ComboBox1.AddItem xSheet.Name\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11095574, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-55IjDlxgmkU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOF90KBVvop-USxiyOcFcCEXD2t_Q/mo/photo.jpg?sz=128", "display_name": "Sunghwan Park", "link": "https://stackoverflow.com/users/11095574/sunghwan-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 54899177, "answer_count": 1, "score": 2, "last_activity_date": 1551248254, "creation_date": 1551247107, "last_edit_date": 1551248254, "question_id": 54898953, "link": "https://stackoverflow.com/questions/54898953/show-visible-sheets-in-combobox", "title": "Show visible sheets in combobox", "body": "<p>Hi I have the following code to show worksheets in a combobox. Sheets are automatically added to the list when it's created.</p>\n\n<p>I do not want hidden sheet to be visible in the dropbox. How do I do that?</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub ComboBox1_Change()\n    If ComboBox1.ListIndex &gt; -1 Then Sheets(ComboBox1.Text).Select\nEnd Sub\n\nPrivate Sub Combobox1_DropbuttonClick()\n    Dim xSheet As Worksheet\n    On Error Resume Next\n    Application.screenupdateing = False\n    Application.EnableEvents = False\n    If ComboBox1.ListCount &lt;&gt; ThisWorkbook.Sheets.Count Then\n        ComboBox1.Clear\n        For Each xSheet In ThisWorkbook.Sheets\n            ComboBox1.AddItem xSheet.Name\n            Next xSheet\n    End If\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub Combobx1_Gotfocus()\n    If ComboBox1.ListCount &lt;&gt; 0 Then ComboBox1.DropDown\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551244389, "post_id": 54898395, "comment_id": 96565031, "body": "Always helps to specify which line it fails on.  What is <code>ssheet</code> here?  Should that be <code>Sheet2</code> ?"}, {"owner": {"reputation": 61, "user_id": 10423457, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mtD25rFGJEo/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtutkOGjYTmuDiSXaiaq189l4h3g/mo/photo.jpg?sz=128", "display_name": "Jin Asterich", "link": "https://stackoverflow.com/users/10423457/jin-asterich"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551244706, "post_id": 54898395, "comment_id": 96565112, "body": "@TimWilliams updated the code, yes its sheet2"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551244728, "post_id": 54898395, "comment_id": 96565118, "body": "OK but which line is the problem?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1551244930, "post_id": 54898395, "comment_id": 96565173, "body": "If you keep fixing your code it will no longer be a useful question..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1551245609, "post_id": 54898395, "comment_id": 96565364, "body": "I have changed <code>lastRow2</code> back to <code>lr4</code> else my answer looses it&#39;s meaning. I have also indented the code and made some minor changes."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10423457, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mtD25rFGJEo/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtutkOGjYTmuDiSXaiaq189l4h3g/mo/photo.jpg?sz=128", "display_name": "Jin Asterich", "link": "https://stackoverflow.com/users/10423457/jin-asterich"}, "edited": false, "score": 0, "creation_date": 1551244864, "post_id": 54898502, "comment_id": 96565154, "body": "ah yes thats it ! i forgot to change the lr4"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1551244968, "post_id": 54898502, "comment_id": 96565180, "body": "I thought it was the <code>.Value</code> part ...  CDate doesn&#39;t return an object"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551245105, "post_id": 54898502, "comment_id": 96565226, "body": "@TimWilliams: That will give a <code>Syntax Error</code>. <code>lrr=0</code> will give <code>Application defined..</code> error :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1551245180, "last_edit_date": 1551245180, "creation_date": 1551244786, "answer_id": 54898502, "question_id": 54898395, "link": "https://stackoverflow.com/questions/54898395/error-1004-application-defined-or-object-defined-error/54898502#54898502", "title": "Error 1004 &quot;Application-defined or Object-defined error", "body": "<p>You are getting that error because <code>lr4</code> is <code>0</code>.</p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A\" &amp; lr4).Value = CDate(Me.tbDate).Value\n</code></pre>\n\n<p>More Clarification</p>\n\n<p>Once you fix the value of <code>lr4</code>, you will not get the <code>Applicaiton Defined Error</code> as mentioned in your question. You will however get a syntax error becuase of <code>.Value</code> in <code>Cdate</code>. Remove that or change it to <code>CDate(Me.tbDate.Value)</code></p>\n"}], "owner": {"reputation": 61, "user_id": 10423457, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mtD25rFGJEo/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtutkOGjYTmuDiSXaiaq189l4h3g/mo/photo.jpg?sz=128", "display_name": "Jin Asterich", "link": "https://stackoverflow.com/users/10423457/jin-asterich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 54898502, "answer_count": 1, "score": 1, "last_activity_date": 1551245487, "creation_date": 1551244156, "last_edit_date": 1551245487, "question_id": 54898395, "link": "https://stackoverflow.com/questions/54898395/error-1004-application-defined-or-object-defined-error", "title": "Error 1004 &quot;Application-defined or Object-defined error", "body": "<p>I have a <code>Userform</code> with <code>Textboxes</code> in it.</p>\n\n<p>When I try to click the <code>Submit</code> button in the form, I get an error <code>Error 1004 \"Application-defined or Object-defined error\"</code>. Why am I getting that error?</p>\n\n<p>Here's the code</p>\n\n<pre><code>Private Sub btnSubmit_Click()\n    Sheet2.Activate\n    Dim lastRow2 As Long\n    lastRow2 = Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    Sheets(\"Sheet2\").Range(\"A\" &amp; lr4).Value = CDate(Me.tbDate).Value\n    Sheets(\"Sheet2\").Range(\"B\" &amp; lr4).Value = Me.tbProduct.Value\n    Sheets(\"Sheet2\").Range(\"C\" &amp; lr4).Value = Me.tbQty.Value\n    Sheets(\"Sheet2\").Range(\"D\" &amp; lr4).Value = Me.tbPrice.Value        \nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Me.tbDate.Value = Date\n    Me.tbProduct.Value = \"\"\n    Me.tbQty.Value = \"\"\n    Me.tbPrice.Value = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1576, "user_id": 7399478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c46d229383615d750a419dc8ebd578f?s=128&d=identicon&r=PG", "display_name": "Ahmet Emre K\u0131l\u0131n&#231;", "link": "https://stackoverflow.com/users/7399478/ahmet-emre-k%c4%b1l%c4%b1n%c3%a7"}, "edited": false, "score": 0, "creation_date": 1551245379, "post_id": 54898221, "comment_id": 96565301, "body": "Hello and welcome to StackOverflow. Please show us what you have tried so far by providing some code."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551245839, "post_id": 54898221, "comment_id": 96565445, "body": "User selects consecutive records? Have to loop through the set of selected records and run delete code. <a href=\"https://www.tek-tips.com/viewthread.cfm?qid=1669535\" rel=\"nofollow noreferrer\">tek-tips.com/viewthread.cfm?qid=1669535</a>. It gets a little complicated."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551247520, "post_id": 54898221, "comment_id": 96565979, "body": "Another reference <a href=\"http://www.accessforums.net/showthread.php?t=45046\" rel=\"nofollow noreferrer\">accessforums.net/showthread.php?t=45046</a>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 2, "creation_date": 1551251729, "post_id": 54898221, "comment_id": 96567584, "body": "That button is already there - on the keyboard: <code>Delete</code>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1551255759, "post_id": 54898221, "comment_id": 96569241, "body": "@Gustav, good point. I use custom delete because I have to manage deletion of related records. In case a user even thinks to use key Delete, I catch and cancel the key Delete event and invoke MsgBox to user to use the custom button. Button also allows mouse click for delete."}], "answers": [{"tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": true, "score": 1, "last_activity_date": 1553170870, "last_edit_date": 1553170870, "creation_date": 1552948775, "answer_id": 55231104, "question_id": 54898221, "link": "https://stackoverflow.com/questions/54898221/how-to-delete-multiple-selected-records-on-access/55231104#55231104", "title": "How to Delete multiple selected records on Access?", "body": "<p>The problem in Access is that the selection gets lost when the focus moves to the button. I solved the problem by placing a sub-form in datasheet view on the main form. The main form has either no data source or is bound to a parent record.</p>\n\n<p>Sub-form controls have an <code>Exit</code> event. During this event, the sub-form selection is still valid. Therefore I use this event to store the selection</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim top As Long, height As Long\n\n'Exit event of the sub-form control\nPrivate Sub frmSelect_Products_Exit(Cancel As Integer)\n    top = frmSelect_Products.Form.SelTop\n    height = frmSelect_Products.Form.SelHeight\nEnd Sub\n</code></pre>\n\n<p>In the delete event handler you can do something like this (just made some test outputs without actually deleting). Also you will have to adapt some names.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim N As Long, sql As String\n\n'Restore the selection so the user can see it during the delete dialog.\nfrmSelect_Products.Form.SelHeight = height\n\n'Test\nMsgBox \"top = \" &amp; top &amp; \",    height = \" &amp; height\n\nWith frmSelect_Products.Form.RecordsetClone\n    For N = top + height - 1 To top Step -1\n        .AbsolutePosition = N - 1 'Zero-based\n        sql = \"DELETE FROM [Feb Fleet] Where [ID]=\" &amp; .Fields!ProductID\n        MsgBox sql\n        'CurrentDb.Execute sql\n    Next\nEnd With\nMe.Form.Requery\n</code></pre>\n\n<p>Your code moves to the first selected item with <code>.AbsolutePosition = intTop - 1</code> and then moves to the first record with <code>.MoveFirst</code>, ignoring the position previously set through <code>AbsolutePosition</code>. I.e., the position given by the loop variable <code>N</code> is completely ignored.</p>\n"}], "owner": {"reputation": 15, "user_id": 11121780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fd89c1c1aeb1240203af503b2292dc?s=128&d=identicon&r=PG&f=1", "display_name": "F.Lost", "link": "https://stackoverflow.com/users/11121780/f-lost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 55231104, "answer_count": 1, "score": 1, "last_activity_date": 1556496635, "creation_date": 1551242900, "last_edit_date": 1556496635, "question_id": 54898221, "link": "https://stackoverflow.com/questions/54898221/how-to-delete-multiple-selected-records-on-access", "title": "How to Delete multiple selected records on Access?", "body": "<p>I'm tasked with making a form on Access to delete multiple selected records without a user control and a delete query.</p>\n\n<p>The user selects (by highlighting) the records with the record selector. I need to add VBA code to a delete button that will delete all the selected records. When I do that only the first record is deleted.</p>\n\n<p>How do I make the highlighted records the active records and delete them all at once? I assume I need a loop of some sort.</p>\n\n<p>I looked through some suggested links and this is what I have:</p>\n\n<pre><code>intHeight = Me.Form.SelHeight\nintTop = Me.Form.SelTop\n\nDim N As Integer\nWith Me.Form.RecordsetClone\n    If .RecordCount &lt; 1 Then\n        MsgBox \"Nothing saved, Delete canceled.\", , \"Remove Test Error\"\n    Else\n        Response = MsgBox(\"Are you sure you want to delete records?\", vbYesNo,   \"Duplicate?\", 0, 0)\n        If Response = vbYes Then\n            MsgBox (intHeight)\n            For N = 1 To intHeight\n                .AbsolutePosition = intTop - 1\n                .MoveFirst\n                sql = \"DELETE FROM [Feb Fleet] Where [ID]=&amp;Me.ID.Value\"\n                CurrentDb.Execute (sql)\n                Me.Form.Requery\n            Next\n        End If\n    End If\nEnd With\n</code></pre>\n\n<p>The code goes through but nothing is deleted. When I check the intHeight value, I get 0. I'm not sure if the .SelTop method works in my code.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 27, "user_id": 10397913, "user_type": "registered", "profile_image": "https://graph.facebook.com/571140736653853/picture?type=large", "display_name": "Min Ko Ko", "link": "https://stackoverflow.com/users/10397913/min-ko-ko"}, "edited": false, "score": 0, "creation_date": 1551251091, "post_id": 54897957, "comment_id": 96567347, "body": "I really need answers for this.Please help me if you can."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1551252418, "post_id": 54897957, "comment_id": 96567840, "body": "ercurrency vs concurrency"}, {"owner": {"reputation": 27, "user_id": 10397913, "user_type": "registered", "profile_image": "https://graph.facebook.com/571140736653853/picture?type=large", "display_name": "Min Ko Ko", "link": "https://stackoverflow.com/users/10397913/min-ko-ko"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1551255096, "post_id": 54897957, "comment_id": 96568970, "body": "sry bro.I&#39;ll fix that"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1551257652, "post_id": 54897957, "comment_id": 96570176, "body": "@MinKoKo have a look there: <a href=\"https://stackoverflow.com/a/54890036/3219613\">stackoverflow.com/a/54890036/3219613</a>"}, {"owner": {"reputation": 27, "user_id": 10397913, "user_type": "registered", "profile_image": "https://graph.facebook.com/571140736653853/picture?type=large", "display_name": "Min Ko Ko", "link": "https://stackoverflow.com/users/10397913/min-ko-ko"}, "edited": false, "score": 0, "creation_date": 1551259790, "post_id": 54897957, "comment_id": 96571408, "body": "It didn&#39;t work and show error like that value bro.Example : min@concurrency.com;thet@con.com"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10397913, "user_type": "registered", "profile_image": "https://graph.facebook.com/571140736653853/picture?type=large", "display_name": "Min Ko Ko", "link": "https://stackoverflow.com/users/10397913/min-ko-ko"}, "edited": false, "score": 0, "creation_date": 1551260026, "post_id": 54901104, "comment_id": 96571540, "body": "It didn&#39;t work bro.I got answer with this code  ^([-a-z0-9~!$%^&amp;*_=+}{\\&#39;?]+(\\.[-a-z0-9~!$%^&amp;*_=+}{\\&#39;?]+)*@(c&zwnj;&#8203;oncurrency.com)[;]?)&zwnj;&#8203;*$"}], "tags": [], "owner": {"reputation": 1, "user_id": 11123564, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U1HMekEnoRI/AAAAAAAAAAI/AAAAAAAAAJ8/DOvKwxblI30/photo.jpg?sz=128", "display_name": "Samuel Contamine", "link": "https://stackoverflow.com/users/11123564/samuel-contamine"}, "is_accepted": false, "score": 0, "last_activity_date": 1551256415, "creation_date": 1551256415, "answer_id": 54901104, "question_id": 54897957, "link": "https://stackoverflow.com/questions/54897957/how-to-format-many-emails-with-regex-using-vba/54901104#54901104", "title": "how to format many emails with regex using vba", "body": "<p>try this pattern :</p>\n\n<pre><code>\"^\\s?([_a-z0-9-]+(.[a-z0-9-]+)@customercurrency.com)+([;.]([_a-z0-9-]+(.[a-z0-9-]+)@customercurrency.com))*$\"\n</code></pre>\n\n<p>(mistake in the domain name and a paranthesis is missing)</p>\n"}], "owner": {"reputation": 27, "user_id": 10397913, "user_type": "registered", "profile_image": "https://graph.facebook.com/571140736653853/picture?type=large", "display_name": "Min Ko Ko", "link": "https://stackoverflow.com/users/10397913/min-ko-ko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551257588, "creation_date": 1551240908, "last_edit_date": 1551257588, "question_id": 54897957, "link": "https://stackoverflow.com/questions/54897957/how-to-format-many-emails-with-regex-using-vba", "title": "how to format many emails with regex using vba", "body": "<p>With vba, i want to validate many emails between then with semicolon,every mail must end with @customercurrency.com and user can put 2 or 3 or 4 or many emails as he want.\nExample :  aung@customercurrency.com;thet@customercurrency.com;htoo@customercurrency.com\nMy code is here.But it might be something wrong.</p>\n\n<pre><code>Public Function ValidateEmailAddressWithSemi(ByRef strEmailAddress As String) As Boolean\n    'Create Regular expression object\n    Dim objRegExp As New RegExp\n\n    'Set Case insensitive\n    objRegExp.IgnoreCase = True\n     objRegExp.pattern = \"^\\s?([_a-z0-9-]+(.[a-z0-9-]+)@customconcurrency.com)+([;.]([_a-z0-9-]+(.[a-z0-9-]+)@customconcurrency.com)*$\"\n    ValidateEmailAddress = objRegExp.Test(strEmailAddress)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 301, "user_id": 5855272, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/dfa390eb50e1ce670ce1d6b12c4d86e0?s=128&d=identicon&r=PG&f=1", "display_name": "AiRiFiEd", "link": "https://stackoverflow.com/users/5855272/airified"}, "edited": false, "score": 1, "creation_date": 1551237587, "post_id": 54897431, "comment_id": 96563595, "body": "can you provide a screenshot of your data?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 1, "creation_date": 1551238500, "post_id": 54897431, "comment_id": 96563783, "body": "Though could not clearly understand what do you want to achieve,  1st observation is that since you are usung <code>For i = 1 To 4</code> loop you are getting values of 4 columns only i.e. i+2 i.e. 3 to 6 . 2nd point is using of <code>compnum = Cells(k, 7).Value</code> within <code>For k = 1 To numcomps</code> it changes <code>compnum</code> for each value of k. compnum is taken from column G Row equal to k in each K loop."}], "answers": [{"tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1551238917, "creation_date": 1551238917, "answer_id": 54897680, "question_id": 54897431, "link": "https://stackoverflow.com/questions/54897431/vba-trying-to-make-an-array-with-4-rows-and-n-columns/54897680#54897680", "title": "(VBA) Trying to make an array with 4 rows and n columns", "body": "<p>Try this customizing where to begin gathering data</p>\n\n<pre><code>Sub MultiDArray()\n\n    ' Define variables\n    Dim arrayColumns As Integer\n    Dim arrayRows As Integer\n    Dim constants() As Integer\n    Dim initialRow As Integer\n    Dim initialColumn As Integer\n    Dim rowCounter As Integer\n    Dim columnCounter As Integer\n\n    ' Define how many rows\n    arrayRows = 4\n\n    ' Define how many columns\n    arrayColumns = Range(\"B3\").Value\n\n    ' Define row to begin gathering data\n    initialRow = 7\n\n    ' Define column to begin gathering data\n    initialColumn = 2\n\n    ' Redimension array to number of rows and columns\n    ReDim constants(1 To arrayRows, 1 To arrayColumns)\n\n\n    ' Loop through each row\n    For rowCounter = 1 To arrayRows\n\n        ' Loop through each column\n        For columnCounter = 1 To arrayColumns\n\n            ' Gather data into array\n            constants(rowCounter, columnCounter) = Cells(rowCounter + initialRow, columnCounter + initialColumn)\n\n            ' For debugging purposes\n            Debug.Print \"Cell: \" &amp; Cells(rowCounter + initialRow, columnCounter + initialColumn).Address, \"Row: \" &amp; rowCounter, \"Column: \" &amp; columnCounter, \"Value:\" &amp; constants(rowCounter, columnCounter)\n\n        Next columnCounter\n\n    Next rowCounter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8305620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d94d001ed1b1af05d49f6319751921a?s=128&d=identicon&r=PG&f=1", "display_name": "Luc Larson", "link": "https://stackoverflow.com/users/8305620/luc-larson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 54897680, "answer_count": 1, "score": 0, "last_activity_date": 1551238917, "creation_date": 1551237070, "question_id": 54897431, "link": "https://stackoverflow.com/questions/54897431/vba-trying-to-make-an-array-with-4-rows-and-n-columns", "title": "(VBA) Trying to make an array with 4 rows and n columns", "body": "<pre><code>Sub abcd()\n\nDim numcomps As Integer\nnumcomps = Range(\"B3\").Value\nDim constants() As Integer\nReDim constants(1 To 4, 1 To numcomps)\nDim i As Integer, j As Integer, k As Integer, compnum As Integer\n\nFor k = 1 To numcomps\ncompnum = Cells(k, 7).Value\n   For i = 1 To 4\n   constants(i, k) = Cells((compnum + 6), (i + 2)).Value\n\n   Next i\nNext k\n\nMsgBox (constants(1, 1))\nMsgBox (constants(2, 1))\nMsgBox (constants(3, 1))\n\n\nEnd Sub\n</code></pre>\n\n<p>Basically, I'm trying to make an array with 4 rows and n columns where n is given by the user as numcomps. Each column will consist of 4 constants gathered from a table in the spreadsheet. The code seems to be rewriting the values in the array each time it loops instead of creating a new column. What do I need to add/change?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1551238151, "post_id": 54897300, "comment_id": 96563707, "body": "this is most likely (as in 99.9%) where your issue is: <code>SummarySheet.Columns.AutoFit</code>. Adjust that to only AutoFit the columns where you actually have data. Asking excel to do work on the entire column set of a worksheet is asking too much. Even asking it to work on an one entire column at once sometimes is too much."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1551248638, "post_id": 54897300, "comment_id": 96566375, "body": "I&#39;ve had a weird issue where a macro used to fail all the time. I found that if I closed Outlook when running the macro, it works fine.. Try that maybe?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1551257486, "post_id": 54897300, "comment_id": 96570079, "body": "If Scott&#39;s comment doesn&#39;t help, please go through the code step by step using F8 to find out which line causes the crash. Then please <a href=\"https://stackoverflow.com/posts/54897300/edit\">edit</a> your question and include that information."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1551260687, "post_id": 54897300, "comment_id": 96571976, "body": "Maybe you&#39;ve just hit a wall on the number of excel files in the source folder. Try removing a few to see if that&#39;s the issue"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1551277134, "post_id": 54897300, "comment_id": 96582083, "body": "I think the message is very clear (which isn&#39;t always the case). You ran out of memory. @ScottHoltzman suggestion seems spot on. Try to <code>AutoFit</code> your range only and not the entire sheet"}, {"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "edited": false, "score": 0, "creation_date": 1551285236, "post_id": 54897300, "comment_id": 96587352, "body": "I commented the code with autofit, crashes again.  Closed Outlook and ran the macro, crashes again. Used F8, no errors in the code."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1551294277, "post_id": 54897300, "comment_id": 96591957, "body": "@Majid - Try turning calculations to manual before running the code and also set screenupdating to false. Furthermore, try the suggestion of Nick.McDermaid and keep increasing the number of files in the folder until it crashes. And perhaps maybe there is one offending file that is causing it crash, with some trial and error you can find that as well."}], "owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551257319, "creation_date": 1551236099, "last_edit_date": 1551257319, "question_id": 54897300, "link": "https://stackoverflow.com/questions/54897300/excel-keeps-crashing-combing-files", "title": "Excel keeps crashing - Combing files", "body": "<p>I am using the below script to combine files in a folder after capturing file name in cell. It used to work fine but excel keeps crashing when I ran this today. </p>\n\n<p>There are no syntax errors in the code. I am unable to figure out how to make this code run. </p>\n\n<p>code:</p>\n\n<pre><code>Sub Button_Click2()\n    Dim SummarySheet As Worksheet\n    Dim FolderPath As String\n    Dim NRow As Long\n    Dim FileName As String\n    Dim WorkBk As Workbook\n    Dim SourceRange As Range\n    Dim DestRange As Range\n\n    Dim TemplatePath As String\n    TemplatePath = Application.ActiveWorkbook.Path\n\n\n    ' Create a new workbook and set a variable to the first sheet.\n    Set SummarySheet = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\n    ' Modify this folder path to point to the files you want to use.\n    FolderPath = TemplatePath &amp; \"\\\"\n\n    ' NRow keeps track of where to insert new rows in the destination workbook.\n    NRow = 1\n\n    ' Call Dir the first time, pointing it to all Excel files in the folder path.\n    FileName = Dir(FolderPath &amp; \"*.xls*\")\n\n    ' Loop until Dir returns an empty string.\n    Do While FileName &lt;&gt; \"\"\n        ' Open a workbook in the folder\n        Set WorkBk = Workbooks.Open(FolderPath &amp; FileName)\n\n        ' Set the cell in column A to be the file name.\n        SummarySheet.Range(\"A\" &amp; NRow).Value = FileName\n\n        ' Set the source range to be A9 through C9.\n        ' Modify this range for your workbooks.\n        ' It can span multiple rows.\n           Dim LastRow As Long\n    LastRow = WorkBk.Worksheets(1).Cells.Find(What:=\"*\", _\n                 After:=WorkBk.Worksheets(1).Cells.Range(\"A1\"), _\n                 SearchDirection:=xlPrevious, _\n                 LookIn:=xlFormulas, _\n                 SearchOrder:=xlByRows).Row\n    Set SourceRange = WorkBk.Worksheets(1).Range(\"A1:AA\" &amp; LastRow)\n\n        ' Set the destination range to start at column B and\n        ' be the same size as the source range.\n        Set DestRange = SummarySheet.Range(\"B\" &amp; NRow)\n        Set DestRange = DestRange.Resize(SourceRange.Rows.Count, _\n           SourceRange.Columns.Count)\n\n        ' Copy over the values from the source to the destination.\n        DestRange.Value = SourceRange.Value\n\n        ' Increase NRow so that we know where to copy data next.\n        NRow = NRow + DestRange.Rows.Count\n\n        ' Close the source workbook without saving changes.\n        WorkBk.Close savechanges:=False\n\n        ' Use Dir to get the next file name.\n        FileName = Dir()\n    Loop\n\n    ' Call AutoFit on the destination sheet so that all\n    ' data is readable.\n    SummarySheet.Columns.AutoFit\nEnd Sub\n</code></pre>\n\n<p>Screenshot of crash: </p>\n\n<p><a href=\"https://i.stack.imgur.com/0YS0O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0YS0O.png\" alt=\"Pop up after the click on the crashed pop-up\"></a></p>\n"}, {"tags": ["vba", "selection", "bullet"], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1551235924, "creation_date": 1551235924, "answer_id": 54897275, "question_id": 54897219, "link": "https://stackoverflow.com/questions/54897219/deleting-bullet-paragraph-in-word-using-excel-vba/54897275#54897275", "title": "Deleting Bullet Paragraph in Word using Excel VBA", "body": "<p>May try</p>\n\n<pre><code>Sub test()\nDim Pg As Paragraph,PgTxt as String\n\n    For Each Pg In ActiveDocument.Paragraphs\n        If Not Pg.Range.ListFormat.List Is Nothing Then  'Process only bulleted list\n        PgTxt = Pg.Range.Text\n            If InStr(1, PgTxt, \"&lt;&lt;Mowing1&gt;&gt;\") &gt; 0 Then\n            Pg.Range.Delete\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9525711, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dustin Smith", "link": "https://stackoverflow.com/users/9525711/dustin-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 54897275, "answer_count": 1, "score": 1, "last_activity_date": 1551235924, "creation_date": 1551235282, "question_id": 54897219, "link": "https://stackoverflow.com/questions/54897219/deleting-bullet-paragraph-in-word-using-excel-vba", "title": "Deleting Bullet Paragraph in Word using Excel VBA", "body": "<p>I have the following text within a word document:</p>\n\n<pre><code>Total Amount Owed: &lt;&lt;Payment&gt;&gt;\nDates Mowed:\n\u2022   2/6/2019\n\u2022   2/14/2019\n\u2022   &lt;&lt;Mowing1&gt;&gt;\n</code></pre>\n\n<p>How do I complelely remove the text and bullet point for the line containing the string <code>&lt;&lt;Mowing1&gt;&gt;</code> using VBA?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "conditional", "concatenation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1551232868, "post_id": 54896624, "comment_id": 96562535, "body": "Which Excel version?  If you&#39;re right up-to-date you can use TEXTJOIN()  <a href=\"https://sfmagazine.com/post-entry/april-2018-excel-using-textjoin-with-an-array/\" rel=\"nofollow noreferrer\">sfmagazine.com/post-entry/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1551231261, "creation_date": 1551231261, "answer_id": 54896704, "question_id": 54896624, "link": "https://stackoverflow.com/questions/54896624/conditional-concatenation-in-excel/54896704#54896704", "title": "Conditional Concatenation in Excel", "body": "<p>You can do it all in one formula if you like:</p>\n\n<pre><code>=CONCATENATE(IF($A1=0,'A',''),IF($B1=0,'B',''), ...)\n</code></pre>\n\n<p>Or put the intermediate strings in a separate row and then concatenate them (to save wear and tear on your fingers).</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 7616989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90f47bf8b4514aa7069f519eaf235a7?s=128&d=identicon&r=PG&f=1", "display_name": "AVLZ", "link": "https://stackoverflow.com/users/7616989/avlz"}, "is_accepted": false, "score": 0, "last_activity_date": 1551231417, "creation_date": 1551231417, "answer_id": 54896729, "question_id": 54896624, "link": "https://stackoverflow.com/questions/54896624/conditional-concatenation-in-excel/54896729#54896729", "title": "Conditional Concatenation in Excel", "body": "<p>Are you going to this to many more columns, or just the ones you've mentioned? As long as the number of columns is relatively small, as in your picture, you can concatenate IF functions to achieve your result.</p>\n\n<p>Here's what I did:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LaGVZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LaGVZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Using that formula will get you a result like the one you have:</p>\n\n<p><a href=\"https://i.stack.imgur.com/U23YA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U23YA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Assuming also that you have the values in a worksheet like mine, just paste the formula <code>=IF(B3=1,\"\",B$1)&amp;IF(C3=1,\"\",C$1)&amp;IF(D3=1,\"\",D$1)&amp;IF(E3=1,\"\",E$1)&amp;IF(F3=1,\"\",F$1)&amp;IF(G3=1,\"\",G$1)&amp;IF(H3=1,\"\",H$1)&amp;IF(I3=1,\"\",I$1)&amp;IF(J3=1,\"\",J$1)</code>\nin B7 and then drag to B8 and B9 to get the rest of the results.</p>\n\n<p>Of course, if you are going to do this for many more columns, it's maybe best to use VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1551231880, "last_edit_date": 1551231880, "creation_date": 1551231577, "answer_id": 54896752, "question_id": 54896624, "link": "https://stackoverflow.com/questions/54896624/conditional-concatenation-in-excel/54896752#54896752", "title": "Conditional Concatenation in Excel", "body": "<p>Here is a VBA solution that can handle any number of columns (assuming that the letter associated with each column is the standard column label):</p>\n\n<pre><code>Function ZeroColumns(R As Range) As String\n    Dim n As Long\n    Dim count As Long\n    Dim cols As Variant\n    Dim cell As Range\n\n    n = R.Cells.count\n    ReDim cols(1 To n)\n    For Each cell In R.Cells\n        If cell.Value = 0 Then\n            count = count + 1\n            cols(count) = Split(cell.Address, \"$\")(1)\n        End If\n    Next cell\n    ReDim Preserve cols(1 To count)\n    ZeroColumns = Join(cols, \"\")\nEnd Function\n</code></pre>\n\n<p>The code shouldn't be too hard to tweak if the stated assumption doesn't hold.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 8933495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213822339488999/picture?type=large", "display_name": "Crist&#243;bal Andr&#233;s Ojeda Pinto", "link": "https://stackoverflow.com/users/8933495/crist%c3%b3bal-andr%c3%a9s-ojeda-pinto"}, "is_accepted": false, "score": 0, "last_activity_date": 1551232815, "creation_date": 1551232815, "answer_id": 54896901, "question_id": 54896624, "link": "https://stackoverflow.com/questions/54896624/conditional-concatenation-in-excel/54896901#54896901", "title": "Conditional Concatenation in Excel", "body": "<p>Here, add this function to a module.\nYou can then call it directly via excel. Nice one.</p>\n\n<pre><code>Function conc(ref As Range, Optional Separator As String) As String\nDim Cell As Range\nDim Result As String\n\nFor Each Cell In ref\n    If Cell.Value = 0 Then\n    Result = Result &amp; chr(64 + Cell.Column) &amp; Separator\n    End If\nNext Cell\nIf Separator &lt;&gt; \"\" Then conc = Left(Result, Len(Result) - 1) Else: conc = Result\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1551255175, "last_edit_date": 1551255175, "creation_date": 1551254408, "answer_id": 54900636, "question_id": 54896624, "link": "https://stackoverflow.com/questions/54896624/conditional-concatenation-in-excel/54900636#54900636", "title": "Conditional Concatenation in Excel", "body": "<h1>Conditionally Concatenate Row (UDF)</h1>\n\n<h2>Arguments</h2>\n\n<ul>\n<li><code>SourceRowRange</code>: The range containing the values that will be\nwritten to<code>CCROW</code> e.g. <code>A, B, C ...</code> Required.  </li>\n<li><code>CriteriaRowRange</code>: The range that will be checked for\n<code>CriteriaValue</code>. Required.</li>\n<li><code>CriteriaValue</code>: The value that the cells in <code>CriteriaRowRange</code> will\nbe checked against. Default is <code>0</code>. Optional.</li>\n<li><code>JoinString</code>: The value that will be put between the values that will\nbe written to <code>CCROW</code>. Default is <code>\"\"</code>. Optional.</li>\n</ul>\n\n<p>' Copy the following code to a standard module i.e. in <strong>VBE</strong> go to <code>Insert&gt;Module</code>.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Function CCROW(ByVal SourceRowRange As Range, ByVal CriteriaRowRange As Range, _\n        Optional ByVal CriteriaValue As Variant = 0, _\n        Optional ByVal JoinString As String) As String\n\n    Dim vntS As Variant   ' Source Array\n    Dim vntC As Variant   ' Criteria Array\n    Dim NoC As Long       ' Number of Columns\n    Dim j As Long         ' Arrays Column Counter\n    Dim strB As String    ' String Builder\n    Dim strC As String    ' Criteria String\n\n    ' Calculate number of columns of the narrower Range.\n    NoC = WorksheetFunction.Min(SourceRowRange.Columns.count, _\n            CriteriaRowRange.Columns.count)\n\n    ' Copy resized (adjust them to same size) Ranges to Arrays.\n    vntS = SourceRowRange.Resize(1, NoC)\n    vntC = CriteriaRowRange.Resize(1, NoC)\n\n    ' Loop through columns of either Array.\n    For j = 1 To NoC\n        ' Write current value of Criteria Array to Criteria String.\n        strC = vntC(1, j)\n        ' Check if Criteria String is NOT empty.\n        If strC &lt;&gt; \"\" Then\n            ' Check if Criteria String is equal to Criteria Value.\n            If strC = CriteriaValue Then\n                ' Check if String Builder is NOT empty.\n                If strB &lt;&gt; \"\" Then  ' NOT empty.\n                    strB = strB &amp; JoinString &amp; vntS(1, j)\n                  Else              ' IS empty (only once).\n                    strB = vntS(1, j)\n                End If\n            End If\n        End If\n    Next\n\n    ' Write String Builder to Conditionally Concatenate Row.\n    CCROW = strB\n\nEnd Function\n</code></pre>\n\n<h2>Usage in Excel</h2>\n\n<pre><code>=CCROW(A$1:I$1,A3:I3) ' Result: ADG\n=CCROW(A$1:I$1,A4:I4) ' Result: CFI\n=CCROW(A$1:I$1,A5:I5) ' Result: DG\n</code></pre>\n\n<p>If you add <code>JoinString</code>:</p>\n\n<pre><code>=CCROW(A$1:I$1,A3:I3,,\",\")   ' Result: A,D,G\n=CCROW(A$1:I$1,A3:I3,0,\",\")  ' Result: A,D,G\n=CCROW(A$1:I$1,A3:I3,0,\", \") ' Result: A, D, G\n</code></pre>\n\n<p>IF you change <code>CriteriaValue</code>:</p>\n\n<pre><code>=CCROW(A$1:I$1,A3:I3,1) ' Result: BCEFHI\n=CCROW(A$1:I$1,A4:I4,1) ' Result: ABDEGH\n=CCROW(A$1:I$1,A5:I5,1) ' Result: ABCEFHI\n</code></pre>\n\n<p><strong>Remarks</strong>\nLock (<code>$</code>) the row of <code>SourceRowRange</code> to keep it the same when the formula is copied down.</p>\n"}, {"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1551256306, "post_id": 54900910, "comment_id": 96569490, "body": "N.B. The <a href=\"https://support.office.com/en-us/article/concat-function-9b1a9a3f-94ff-41af-9736-694cbd6b4ca2\" rel=\"nofollow noreferrer\"><code>CONCAT</code> function</a>, like the <a href=\"https://support.office.com/en-us/article/textjoin-function-357b449a-ec91-49d0-80c3-0e8fc845691c\" rel=\"nofollow noreferrer\"><code>TEXTJOIN</code> function</a> mentioned <a href=\"https://stackoverflow.com/questions/54896624/conditional-concatenation-in-excel#comment96562535_54896624\">in the comments</a>, is only available from Office 365 onwards"}], "tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": false, "score": 0, "last_activity_date": 1551259770, "last_edit_date": 1551259770, "creation_date": 1551255559, "answer_id": 54900910, "question_id": 54896624, "link": "https://stackoverflow.com/questions/54896624/conditional-concatenation-in-excel/54900910#54900910", "title": "Conditional Concatenation in Excel", "body": "<p>The following array formula will do the job (enter it with Ctrl+Shift+Enter):</p>\n\n<pre><code>=CONCAT(IF($A1:$I1=0,UNICHAR(64+COLUMN($A1:$I1)),\"\"))\n</code></pre>\n\n<p>For older Excel versions, use the legacy functions <code>CONCATENATE()</code> and <code>CHAR()</code> in place of these functions.</p>\n"}], "owner": {"reputation": 21, "user_id": 11122381, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MQbtfnnzUrY/AAAAAAAAAAI/AAAAAAAADwI/dDo2ePL2YHU/photo.jpg?sz=128", "display_name": "Musabbir Ahmed", "link": "https://stackoverflow.com/users/11122381/musabbir-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "answer_count": 6, "score": 2, "last_activity_date": 1551259770, "creation_date": 1551230584, "last_edit_date": 1551257290, "question_id": 54896624, "link": "https://stackoverflow.com/questions/54896624/conditional-concatenation-in-excel", "title": "Conditional Concatenation in Excel", "body": "<p>As you can see in the image, there are some 1 and 0s rearranged in 3 rows and one English Alphabet for each column. What I need to do is concatenate the English Alphabets for each row when the respective column value is 0. How can I do it? </p>\n\n<p><a href=\"https://i.stack.imgur.com/7Shau.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Shau.png\" alt=\"image link\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1551230347, "post_id": 54896533, "comment_id": 96562006, "body": "ws.Range(&quot;B1&quot;) = &quot;1&quot;"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1551230656, "post_id": 54896533, "comment_id": 96562060, "body": "@ScottCraner it&#39;s work correctly ... Very Very Thank you my friend! :)"}], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551257261, "creation_date": 1551229920, "last_edit_date": 1551257261, "question_id": 54896533, "link": "https://stackoverflow.com/questions/54896533/set-a-value-for-specified-cell-in-all-sheets-by-vba", "title": "set a value for specified cell in All sheets by VBA", "body": "<p>I wanna set a value for specified cell (B1) in all sheets in my workbook by VBA.\nI used this code:</p>\n\n<pre><code>Sub Set_Value()\n\nDim ws As Worksheet\nFor Each ws In ActiveWorkbook.Worksheets\nRange(\"B1\") = \"1\"\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>but it's work for only active sheet, not all sheets that the workbook has.</p>\n\n<p>Any idea is welcome. Thank you guys. :)</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1551224120, "post_id": 54895526, "comment_id": 96560644, "body": "Your coding of the 12/24/36 etc in col D is inconsistent - presumably making that a consistent pattern is not a problem ?   Eg all numbrs separated by either - or / not either"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 1, "creation_date": 1551224614, "post_id": 54895526, "comment_id": 96560785, "body": "What have you tried so far? SO is not a free code writing service."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1551225661, "post_id": 54895526, "comment_id": 96561036, "body": "Similar: <a href=\"https://stackoverflow.com/questions/8560718/split-comma-separated-entries-to-new-rows\" title=\"split comma separated entries to new rows\">stackoverflow.com/questions/8560718/&hellip;</a>  and  <a href=\"https://stackoverflow.com/questions/50092648/split-cells-and-insert-in-a-new-row\" title=\"split cells and insert in a new row\">stackoverflow.com/questions/50092648/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 8532018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1053776978109338/picture?type=large", "display_name": "Maciej Mazurek", "link": "https://stackoverflow.com/users/8532018/maciej-mazurek"}, "edited": false, "score": 0, "creation_date": 1551255934, "post_id": 54895526, "comment_id": 96569321, "body": "I didn&#39;t look for a free code but just a tip how to start &#39;cause I&#39;m not familiar with loops and conditions yet. user1302114 and Tim Williams  answers are far enough for me:-) Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 8933495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213822339488999/picture?type=large", "display_name": "Crist&#243;bal Andr&#233;s Ojeda Pinto", "link": "https://stackoverflow.com/users/8933495/crist%c3%b3bal-andr%c3%a9s-ojeda-pinto"}, "is_accepted": false, "score": -1, "last_activity_date": 1551227374, "creation_date": 1551227374, "answer_id": 54896254, "question_id": 54895526, "link": "https://stackoverflow.com/questions/54895526/vba-copy-values-to-other-sheet-with-loop/54896254#54896254", "title": "VBA copy values to other sheet with loop", "body": "<p>Although Z32A7UL is right, this is not a free code writing service, here you are, i was bored, not very fancy, but sure works:</p>\n\n<p>Sheet1 = \"Input\"\nSheet2 = \"Output\"</p>\n\n<pre><code>Sub Macro1()\n    Dim LastRow As Long\n    On Error Resume Next\n    LastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    If LastRow = 0 Then LastRow = 1\n    On Error GoTo 0\n\n    ThisWorkbook.Sheets(\"Input\").Select\n    With ThisWorkbook.Sheets(\"Input\"):\n        .Range(\"E1\").FormulaR1C1 = \"Arreglo\"\n        .Range(\"F1\").FormulaR1C1 = \"Extracto 1\"\n        .Range(\"G1\").FormulaR1C1 = \"Extracto 2\"\n        .Range(\"H1\").FormulaR1C1 = \"Extracto 3\"\n        .Range(\"I1\").FormulaR1C1 = \"Total\"\n        .Range(\"E2\").FormulaR1C1 = \"=SUBSTITUTE((SUBSTITUTE(SUBSTITUTE(RC[-1],\"\"-\"\",\"\"\"\"),\"\"/\"\",\"\"\"\")),\"\" \"\",\"\"\"\")\"\n        .Range(\"F2\").FormulaR1C1 = \"=MID(RC[-1],1,2)&amp;\"\"/\"\"&amp;MID(RC[-1],3,2)\"\n        .Range(\"G2\").FormulaR1C1 = \"=MID(RC[-2],3,2)&amp;\"\"/\"\"&amp;MID(RC[-2],5,2)\"\n        .Range(\"H2\").FormulaR1C1 = \"=MID(RC[-3],5,2)&amp;\"\"/\"\"&amp;MID(RC[-3],7,2)\"\n        .Range(\"I2\").FormulaR1C1 = \"=COUNTA(RC[-3]:RC[-1])-COUNTBLANK(RC[-3]:RC[-1])\"\n        .Range(\"E2:I2\").AutoFill Destination:=Range(\"E2:I\" &amp; LastRow)\n    End With\n\n    ThisWorkbook.Sheets(\"Output\").Select\n    Cells.ClearContents\n    Range(\"A2\").Select\n\n    For i = 2 To LastRow\n        For j = 1 To Sheets(1).Range(\"I\" &amp; i).Value\n            ActiveCell.Value = Sheets(1).Range(\"A\" &amp; i).Value\n            ActiveCell.Offset(, 1).Value = Sheets(1).Range(\"B\" &amp; i).Value\n            ActiveCell.Offset(, 2).Value = Sheets(1).Range(\"C\" &amp; i).Value\n            If j = 1 Then ActiveCell.Offset(, 3).Value = Sheets(1).Range(\"F\" &amp; i).Value\n            If j = 2 Then ActiveCell.Offset(, 3).Value = Sheets(1).Range(\"G\" &amp; i).Value\n            If j = 3 Then ActiveCell.Offset(, 3).Value = Sheets(1).Range(\"H\" &amp; i).Value\n            ActiveCell.Offset(1, 0).Select\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "is_accepted": true, "score": 0, "last_activity_date": 1551232168, "creation_date": 1551232168, "answer_id": 54896819, "question_id": 54895526, "link": "https://stackoverflow.com/questions/54895526/vba-copy-values-to-other-sheet-with-loop/54896819#54896819", "title": "VBA copy values to other sheet with loop", "body": "<p>Try coding the following;</p>\n\n<pre><code>Loop through every row in the source data\n   for each of these rows - check you have firstname, lastname, occupation and array data\n   If You have then\n      breakup the array data into its parts and\n      for each part of the array data\n         write a row in the 2nd sheet\n         .. you may need a variable to keep track of which row you are at\n</code></pre>\n\n<p>That's about all there is to it\nMake a start and come back when you have coding questions</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "is_accepted": false, "score": 0, "last_activity_date": 1551297688, "creation_date": 1551297688, "answer_id": 54913596, "question_id": 54895526, "link": "https://stackoverflow.com/questions/54895526/vba-copy-values-to-other-sheet-with-loop/54913596#54913596", "title": "VBA copy values to other sheet with loop", "body": "<p>This builds an array of results from an array containing the source data. See code comments for explanation.</p>\n\n<pre><code>Sub Macro11()\n\n    Dim i As Long, j As Long, hdrs As Variant, arr1 As Variant, arr2 As Variant\n    Dim delim1 As String, delim2 As String, lwr As Long, upr As Long\n\n    'If 'results' worksheet exists, delete it\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Worksheets(\"results\").Delete\n    Application.DisplayAlerts = True\n    On Error GoTo -1\n\n    'Collect original data\n    With Worksheets(\"sheet4\")\n\n        hdrs = .Range(.Cells(1, \"A\"), .Cells(1, .Columns.Count).End(xlToLeft)).Value2\n        arr1 = .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"D\").End(xlUp)).Value2\n\n    End With\n\n    'Preliminary variable values\n    delim1 = \" - \"\n    delim2 = \"/\"\n    ReDim arr2(LBound(arr1, 2) To UBound(arr1, 2), 1 To 1)\n\n    'Process single rows into multiple rows\n    For i = LBound(arr1, 1) To UBound(arr1, 1)\n        'lowest value\n        lwr = Split(Split(arr1(i, 4), delim1)(0), delim2)(0)\n        'highest value\n        upr = Split(Split(arr1(i, 4), delim1)(1), delim2)(1)\n        'from lowest to highest value in 4th column\n        For j = lwr To upr - 1 Step 12\n            'transpose arr1 to arr2 with split 4th column values\n            arr2(1, UBound(arr2, 2)) = arr1(i, 1)\n            arr2(2, UBound(arr2, 2)) = arr1(i, 2)\n            arr2(3, UBound(arr2, 2)) = arr1(i, 3)\n            arr2(4, UBound(arr2, 2)) = Chr(39) &amp; j &amp; Chr(47) &amp; Application.Min(j + 12, upr)\n            'make room for next row\n            ReDim Preserve arr2(LBound(arr2, 1) To UBound(arr2, 1), _\n                                LBound(arr2, 2) To UBound(arr2, 2) + 1)\n        Next j\n    Next i\n\n    'Remove last empty row\n    ReDim Preserve arr2(LBound(arr2, 1) To UBound(arr2, 1), _\n                        LBound(arr2, 2) To UBound(arr2, 2) - 1)\n\n    'Put processed values into new worksheet\n    With Worksheets.Add(after:=Worksheets(\"sheet4\"))\n\n        .Name = \"results\"\n        .Cells(1, \"A\").Resize(UBound(hdrs, 1), UBound(hdrs, 2)) = hdrs\n        .Cells(2, \"A\").Resize(UBound(arr2, 2), UBound(arr2, 1)) = Application.Transpose(arr2)\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8532018, "user_type": "registered", "profile_image": "https://graph.facebook.com/1053776978109338/picture?type=large", "display_name": "Maciej Mazurek", "link": "https://stackoverflow.com/users/8532018/maciej-mazurek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 54896819, "answer_count": 3, "score": 0, "last_activity_date": 1551297688, "creation_date": 1551221888, "question_id": 54895526, "link": "https://stackoverflow.com/questions/54895526/vba-copy-values-to-other-sheet-with-loop", "title": "VBA copy values to other sheet with loop", "body": "<p>I'd like to speed my work using vba but have no idea how to achieve it.</p>\n\n<p>Let me explain problem:</p>\n\n<ol>\n<li>I have an array: 12/24, 24/36, 36/48, 48/52</li>\n<li>Data from excel looks like this</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/uIvT7.png\" rel=\"nofollow noreferrer\">First sheet</a></p>\n\n<ol start=\"3\">\n<li>vba has to create in another sheet something like this</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/7Wu04.png\" rel=\"nofollow noreferrer\">Second sheet</a></p>\n\n<p>Is it possible? :)</p>\n\n<p>Thank you in advance for any tips</p>\n\n<p>Best</p>\n\n<p>Maciej</p>\n"}, {"tags": ["excel", "vba", "algorithm", "math"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1551222356, "post_id": 54895433, "comment_id": 96560095, "body": "for those of us that are not familar with this, can you explain what you mean by gravity center?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1551222464, "post_id": 54895433, "comment_id": 96560117, "body": "@ScottCraner Presumably the center of gravity. A 1 at index (i,j) is a mass at that point. The center of gravity is the point at which the system would balance. The coordinate system is not 100% obvious, and should be specified."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 1, "creation_date": 1551222686, "post_id": 54895433, "comment_id": 96560179, "body": "Welcome to StackOverflow.  Please read and follow the posting guidelines in the help documentation, as suggested when you created this account.  <a href=\"http://stackoverflow.com/help/on-topic\">On topic</a>, <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>, and <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">... the perfect question</a> apply here.  Among other things, we expect your question to be self-contained; we generally don&#39;t accept links to off-site code."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1551222715, "post_id": 54895433, "comment_id": 96560184, "body": "I think you are missing some <code>()</code> to get the order correct."}], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "is_accepted": false, "score": 0, "last_activity_date": 1551224910, "last_edit_date": 1551224910, "creation_date": 1551223350, "answer_id": 54895730, "question_id": 54895433, "link": "https://stackoverflow.com/questions/54895433/get-gravity-center-in-table/54895730#54895730", "title": "Get gravity center in table", "body": "<h1>Minor corrections to your code</h1>\n\n<pre><code>Option Explicit\n\nSub calcGravity()\nDim i As Integer, j As Integer\nDim sum As Long\nDim x As double, y As double\n'get sum\nFor i = 1 To 5\n    For j = 1 To 5\n    sum = sum + Cells(i, j).Value\n    'Debug.Print Cells(i, j).Address\n    Next j\nNext i\n\nFor i = 1 To 5\n    For j = 1 To 5\n    x = x + (i) * Cells(i, j).Value / sum\n    y = y + (j) * Cells(i, j).Value / sum\n    'Debug.Print Cells(i, j).Address\nNext j\nNext i\nDebug.Print (\"Center x: \" &amp; x &amp; \" y: \" &amp; y)\nEnd Sub\n</code></pre>\n\n<h1>Tests to the above code</h1>\n\n<pre><code>Sub Test1()\n    Call Set_All_to_0\n    Range(\"A1\").Value = 1\n    Debug.Print \"Only A1 = 1\"\n    Call calcGravity\n    Debug.Print\n\n    Call Set_All_to_0\n    Range(\"E1\").Value = 1\n    Debug.Print \"Only E1 = 1\"\n    Call calcGravity\n    Debug.Print\n\n    Call Set_All_to_0\n    Range(\"A5\").Value = 1\n    Debug.Print \"Only A5 = 1\"\n    Call calcGravity\n    Debug.Print\n\n    Call Set_All_to_0\n    Range(\"E5\").Value = 1\n    Debug.Print \"Only A5 = 1\"\n    Call calcGravity\n    Debug.Print\n\n    Call Set_All_to_0\n    Range(\"A1:E1\").Value = 1\n    Debug.Print \"A1:E1 = 1\"\n    Call calcGravity\n    Debug.Print\n\n    Call Set_All_to_0\n    Range(\"A5:E5\").Value = 1\n    Debug.Print \"A5:E5 = 1\"\n    Call calcGravity\n    Debug.Print\n\n    Call Set_All_to_0\n    Range(\"A1:A5\").Value = 1\n    Debug.Print \"A1:A5 = 1\"\n    Call calcGravity\n    Debug.Print\n\nEnd Sub\n\nSub Set_All_to_0()\nDim i As Integer, j As Integer\n    For i = 1 To 5\n        For j = 1 To 5\n            Cells(i, j) = 0\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<h1>Immediate window</h1>\n\n<pre><code>Only A1 = 1\nCenter x: 1 y: 1\n\nOnly E1 = 1\nCenter x: 1 y: 5\n\nOnly A5 = 1\nCenter x: 5 y: 1\n\nOnly A5 = 1\nCenter x: 5 y: 5\n\nOnly A1 = 1\nCenter x: 1 y: 1\n\nOnly E1 = 1\nCenter x: 1 y: 5\n\nOnly A5 = 1\nCenter x: 5 y: 1\n\nOnly A5 = 1\nCenter x: 5 y: 5\n\nOnly A1 = 1\nCenter x: 1 y: 1\n\nOnly E1 = 1\nCenter x: 1 y: 5\n\nOnly A5 = 1\nCenter x: 5 y: 1\n\nOnly A5 = 1\nCenter x: 5 y: 5\n\nA1:E1 = 1\nCenter x: 1 y: 3\n\nOnly A1 = 1\nCenter x: 1 y: 1\n\nOnly E1 = 1\nCenter x: 1 y: 5\n\nOnly A5 = 1\nCenter x: 5 y: 1\n\nOnly A5 = 1\nCenter x: 5 y: 5\n\nA1:E1 = 1\nCenter x: 1 y: 3\n\nA1:E1 = 1\nCenter x: 5 y: 3\n\nOnly A1 = 1\nCenter x: 1 y: 1\n\nOnly E1 = 1\nCenter x: 1 y: 5\n\nOnly A5 = 1\nCenter x: 5 y: 1\n\nOnly A5 = 1\nCenter x: 5 y: 5\n\nA1:E1 = 1\nCenter x: 1 y: 3\n\nA5:E5 = 1\nCenter x: 5 y: 3\n\nA1:A5 = 1\nCenter x: 3 y: 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1551223867, "creation_date": 1551223867, "answer_id": 54895824, "question_id": 54895433, "link": "https://stackoverflow.com/questions/54895433/get-gravity-center-in-table/54895824#54895824", "title": "Get gravity center in table", "body": "<p>Here is a UDF which can computer the center of mass:</p>\n\n<pre><code>Function CenterOfGravity(Masses As Variant) As Variant\n    'Masses is a 2-dimensional array of weights\n    'calculates center of gravity, returning the answer as\n    'an array of 2 value\n\n    If TypeName(Masses) = \"Range\" Then Masses = Masses.Value\n\n    Dim mass As Double\n    Dim momentX As Double, momentY As Double\n    Dim i As Long, j As Long\n\n    For i = LBound(Masses, 1) To UBound(Masses, 1)\n        For j = LBound(Masses, 2) To UBound(Masses, 2)\n            mass = mass + Masses(i, j)\n            momentX = momentX + j * Masses(i, j)\n            momentY = momentY + i * Masses(i, j)\n        Next j\n    Next i\n    CenterOfGravity = Array(momentX / mass, momentY / mass)\nEnd Function\n</code></pre>\n\n<p>For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2Xj4X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Xj4X.png\" alt=\"enter image description here\"></a></p>\n\n<p>In the above, in cells A7:B7, I entered <code>=CenterOfGravity(A1:E5)</code> as an array formula (<code>Ctrl+Shift+Enter</code> to accept).</p>\n"}], "owner": {"reputation": 48, "user_id": 10316370, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o4BhPvwhJOk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOaVXjsCWKfg06IB_SFTkb8FQGuqw/mo/photo.jpg?sz=128", "display_name": "TadejP", "link": "https://stackoverflow.com/users/10316370/tadejp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 54895824, "answer_count": 2, "score": 1, "last_activity_date": 1551224910, "creation_date": 1551221345, "last_edit_date": 1551221745, "question_id": 54895433, "link": "https://stackoverflow.com/questions/54895433/get-gravity-center-in-table", "title": "Get gravity center in table", "body": "<p><img src=\"https://i.stack.imgur.com/C7NZL.jpg\" alt=\"Excel table \"></p>\n\n<p>I have 5x5 table and 25 random integers. I need to calculate the gravity of the table. </p>\n\n<p>I have spend few hours trying to figure out how <a href=\"https://stackoverflow.com/a/14658712/10316370\">this</a> code works, it is written in <a href=\"https://scalafiddle.io/sf/PbnJDsO/1\" rel=\"nofollow noreferrer\">scala</a> and I tried to change it into VBA, but without any luck. \nHere is my best try, which is still not correct, instead of generating numbers I manually entered then into excel which is enough for me. </p>\n\n<p><a href=\"https://i.stack.imgur.com/C7NZL.jpg\" rel=\"nofollow noreferrer\">Excel table </a></p>\n\n<pre><code>Sub calcGravity()\n'get sum\nFor i = 1 To 5\n    For j = 1 To 5\n    Sum = Sum + Cells(i, j).Value\n    Next j\nNext i\n\nFor i = 1 To 4\n    For j = 1 To 4\n    x = x + (i + i) * Cells(i, j).Value / Sum\n    y = y + (j + i) * Cells(i, j).Value / Sum\n    Next j\nNext i\nMsgbox(\"Center :\" &amp; x &amp; y)\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551219294, "post_id": 54894915, "comment_id": 96559034, "body": "Which is line 25? Why is code commented? Don&#39;t use .Text. In VBA you want .Value and since that is default for data controls, don&#39;t even need to reference it: <code>Me.txtUserName</code>. The <code>&amp;</code> instead of <code>+</code> is preferred for string concatenation. Run filter code only if username and password are valid."}, {"owner": {"reputation": 13, "user_id": 11063135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a762eb2d1480a3653549fb7ab73d600?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner", "link": "https://stackoverflow.com/users/11063135/beginner"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551281478, "post_id": 54894915, "comment_id": 96584842, "body": "thank you for your response! I actually just made a macro that filtered the data and then added a Docmd to run the macro at the end of the code"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 11063135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a762eb2d1480a3653549fb7ab73d600?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner", "link": "https://stackoverflow.com/users/11063135/beginner"}, "is_accepted": false, "score": 0, "last_activity_date": 1551281409, "creation_date": 1551281409, "answer_id": 54908974, "question_id": 54894915, "link": "https://stackoverflow.com/questions/54894915/can-a-button-check-password-and-filter/54908974#54908974", "title": "Can a button check password and filter?", "body": "<p>I decided to just make a macro and do a docmd to run the macro at the end of the code :) thank you all</p>\n"}], "owner": {"reputation": 13, "user_id": 11063135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a762eb2d1480a3653549fb7ab73d600?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner", "link": "https://stackoverflow.com/users/11063135/beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551281574, "creation_date": 1551218769, "last_edit_date": 1551281574, "question_id": 54894915, "link": "https://stackoverflow.com/questions/54894915/can-a-button-check-password-and-filter", "title": "Can a button check password and filter?", "body": "<p>Sorry to bother you all again...\nI am trying to create a login page where upon inputting the correct UserName AND password, it would filter a subform below so that they can see only their comments. I have it so that there are two buttons where one checks the Username and Password via VBA code and another button filters using a Macro... But I would like for one button to do everything so that if the password is incorrect, then they cannot see anything. The filter button currently works without a password and as long as there is a correct username it will filter that without looking at the password.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub btnLogin_Click()\n    Dim rs As Recordset\n\n        Set rs = CurrentDb.OpenRecordset(\"tbl1Employees\", dbOpenSnapshot, dbReadOnly)\n\n    rs.FindFirst \"UserName='\" &amp; Me.txtUserName &amp; \"'\"\n\n    If rs.NoMatch Then\n        Me.lblWrongUser.Visible = True\n        Me.txtUserName.SetFocus\n        Exit Sub\n    End If\n    Me.lblWrongUser.Visible = False\n\n    If rs!Password &lt;&gt; Nz(Me.txtPassword, \"\") Then\n        Me.lblWrongPass.Visible = True\n        Me.txtPassword.SetFocus\n        Exit Sub\n    End If\n    Me.lblWrongPass.Visible = False\n\n\n    Dim search_text As String\n    search_text = Me.txtUserName\n\n        If Nz(Me.txtUserName.Value, \"\") = \"\" Then\n    Me.FilterOn = False\n    Me.txtUserName.SetFocus\n    Exit Sub\nEnd If\nMe.Filter = \"UserName like '*\" &amp; Me.txtUserName.Value &amp; \"*' or userName like '*\"\nMe.FilterOn = True\nMe.txtUserName.SetFocus\nMe.txtUserName.Value = search_text\nMe.txtUserName.SelStart = Len(Nz(Me.txtUserName. Value, \"\")) &amp; 1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "indexing", "match", "sumproduct"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11121724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef6403aa1250c1bff1bbcbe1cff255c?s=128&d=identicon&r=PG&f=1", "display_name": "KeelySG", "link": "https://stackoverflow.com/users/11121724/keelysg"}, "edited": false, "score": 0, "creation_date": 1551259904, "post_id": 54894644, "comment_id": 96571474, "body": "Thanks for your reply, however this doesn&#39;t work for me as if I select width 1601 and height 1750 I want it to return a value of &#163;111, not &#163;96 :)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1551217622, "creation_date": 1551217622, "answer_id": 54894644, "question_id": 54894559, "link": "https://stackoverflow.com/questions/54894559/creating-a-two-way-lookup-price-matrix-in-excel-using-vba-index-match-sumproduc/54894644#54894644", "title": "Creating a two way lookup Price Matrix in Excel using VBA (Index/Match/SumProduct)", "body": "<p>Use:</p>\n\n<pre><code>=INDEX(B:J,MATCH(N3,A:A),MATCH(M3,B$3:J$3))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1551220448, "last_edit_date": 1551220448, "creation_date": 1551218858, "answer_id": 54894939, "question_id": 54894559, "link": "https://stackoverflow.com/questions/54894559/creating-a-two-way-lookup-price-matrix-in-excel-using-vba-index-match-sumproduc/54894939#54894939", "title": "Creating a two way lookup Price Matrix in Excel using VBA (Index/Match/SumProduct)", "body": "<p>You could make use of <code>=AGGREGATE()</code> like so:</p>\n\n<p><code>=INDEX(A:E,AGGREGATE(15,3,(($A$4:$A$11&gt;=N3)/($A$4:$A$11&gt;=N3))*ROW($A$4:$A$11),1),AGGREGATE(15,3,(($B$3:$J$3&gt;=M3)/($B$3:$J$3&gt;=M3))*COLUMN($B$3:$J$3),1))</code></p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11121724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef6403aa1250c1bff1bbcbe1cff255c?s=128&d=identicon&r=PG&f=1", "display_name": "KeelySG", "link": "https://stackoverflow.com/users/11121724/keelysg"}, "edited": false, "score": 0, "creation_date": 1551260051, "post_id": 54896630, "comment_id": 96571557, "body": "Thank you for your reply!"}], "tags": [], "owner": {"reputation": 19, "user_id": 8933495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213822339488999/picture?type=large", "display_name": "Crist&#243;bal Andr&#233;s Ojeda Pinto", "link": "https://stackoverflow.com/users/8933495/crist%c3%b3bal-andr%c3%a9s-ojeda-pinto"}, "is_accepted": false, "score": 0, "last_activity_date": 1551230647, "creation_date": 1551230647, "answer_id": 54896630, "question_id": 54894559, "link": "https://stackoverflow.com/questions/54894559/creating-a-two-way-lookup-price-matrix-in-excel-using-vba-index-match-sumproduc/54896630#54896630", "title": "Creating a two way lookup Price Matrix in Excel using VBA (Index/Match/SumProduct)", "body": "<p>You can use directly formulas just like both guys said above...\nMine here:</p>\n\n<pre><code>=INDEX($A:$J,MATCH($N3,$A:$A,0),MATCH($M3,B$3:J$3,0))\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11121724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aef6403aa1250c1bff1bbcbe1cff255c?s=128&d=identicon&r=PG&f=1", "display_name": "KeelySG", "link": "https://stackoverflow.com/users/11121724/keelysg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 54894939, "answer_count": 3, "score": 0, "last_activity_date": 1551230647, "creation_date": 1551217289, "last_edit_date": 1551217436, "question_id": 54894559, "link": "https://stackoverflow.com/questions/54894559/creating-a-two-way-lookup-price-matrix-in-excel-using-vba-index-match-sumproduc", "title": "Creating a two way lookup Price Matrix in Excel using VBA (Index/Match/SumProduct)", "body": "<p>I'm trying to create a pricing matrix for products but using Index/Match or SumProduct formulas are proving to be a nightmare for me, I'm wondering if VBA would be easier?</p>\n\n<p>Essentially if a product width or height is in between two figures, I need the price quoted to take on the next pricing bracket.  (NB: Rounding up or using Ceiling functions within the formula doesn't work for me either)</p>\n\n<p>Examples of the code I've tried using are:</p>\n\n<p><code>=SUMPRODUCT(--(HeightRange=CEILING(Height,1000))*--(WidthRange=CEILING(Width,10))*PriceRange)</code></p>\n\n<p><code>=INDEX(PriceRange,MATCH(MIN(ABS(HeightRange-Height)),ABS(HeightRange-Height),-1),MATCH(MIN(ABS(WidthRange-Width)),ABS(WidthRange-Width),-1))</code></p>\n\n<p>Example Table:\n<a href=\"https://i.stack.imgur.com/uYV5f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uYV5f.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "scatter-plot", "dynamically-generated"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551216975, "post_id": 54894390, "comment_id": 96558066, "body": "Can you provide a dataset with only one device? As well as the formula that you mention (the one with <code>OFFSET</code>)"}, {"owner": {"reputation": 3, "user_id": 11121729, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sPQHWAAVOOI/AAAAAAAAAAI/AAAAAAAAALs/__mjVVe7Hlw/photo.jpg?sz=128", "display_name": "Rohit Sinha", "link": "https://stackoverflow.com/users/11121729/rohit-sinha"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1551265532, "post_id": 54894390, "comment_id": 96575142, "body": "Thanks Peh. I&#39;ve replied to your query with a screenshot and formula below."}], "owner": {"reputation": 3, "user_id": 11121729, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sPQHWAAVOOI/AAAAAAAAAAI/AAAAAAAAALs/__mjVVe7Hlw/photo.jpg?sz=128", "display_name": "Rohit Sinha", "link": "https://stackoverflow.com/users/11121729/rohit-sinha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551276466, "creation_date": 1551216484, "last_edit_date": 1551276466, "question_id": 54894390, "link": "https://stackoverflow.com/questions/54894390/dynamic-number-of-series-in-excel-scatter-plot", "title": "Dynamic number of series in Excel Scatter Plot", "body": "<p>I have a data set (2 tables see first screenshot below) which dynamically update both by the rows and columns - and used that to plot XY Scatter, (x values are pulled by the table above, and y values from the table below). </p>\n\n<p>There are 18 series in all, i.e. devices starting from CPAP to X-Ray Machine.</p>\n\n<p><img src=\"https://i.stack.imgur.com/JCc0Q.jpg\" alt=\"First Screenshot - dataset\"></p>\n\n<p>Each series has a dynamic range using the OFFSET function and hence that updating does not give an error on the chart - BUT because the devices itself are dynamic, they can either be only 1 series or all 18 series. When that updates, it results an error on the scatter plot. (see 2nd screenshot).</p>\n\n<p><img src=\"https://i.stack.imgur.com/wqvIz.jpg\" alt=\"Blanks show up in series and that returns an error message\"></p>\n\n<p>As you can see from the 2nd screenshot, the series become blanks and returns an error. I want the chart to reflect only that series that are not blanks.</p>\n\n<p>I have a basic understanding of VBA, and so couldnt figure out how to code that functionality in the chart based on the searches I made to find a solution. Would appreciate if someone can help me figure this code!</p>\n\n<p>edit:</p>\n\n<p><img src=\"https://i.stack.imgur.com/vZ8nW.jpg\" alt=\"enter image description here\"></p>\n\n<p>Attached is a screenshot with just one device selection (i.e. Pulse Oximeter). </p>\n\n<p>The formula for X values is: </p>\n\n<pre><code>=OFFSET(TDI!$B$12,0,0,1,COUNT(TDI!$12:$12)-1)\n</code></pre>\n\n<p>and for Y values:</p>\n\n<pre><code>=OFFSET(TDI!$B$36,0,0,1,COUNT(TDI!$36:$36))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1551216002, "post_id": 54894247, "comment_id": 96557659, "body": "Unless I&#39;m missing something, the <code>Print_No_Interface</code> sub does nothing regarding printing...Also check that the printer&#39;s default properties aren&#39;t set to Black and White."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1551216427, "post_id": 54894247, "comment_id": 96557837, "body": "@BruceWayne ok on the sub - I&#39;m kind of grasping at straws at what might be affecting this.  And the printer&#39;s default property is set to color.  But I&#39;ll check again."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1551216451, "post_id": 54894247, "comment_id": 96557843, "body": "You should let them choose the color options manually with <code>Application.Dialogs(xlDialogPrint).Show</code> - otherwise, it&#39;s a huge pain. See <a href=\"https://www.mrexcel.com/forum/excel-questions/881346-printing-color-vba.html\" rel=\"nofollow noreferrer\">here</a> for more details."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551216728, "post_id": 54894247, "comment_id": 96557952, "body": "@dwirony The version that I&#39;m trying to debug runs without any &quot;them&quot; involved.  It&#39;s scheduled and runs and prints automatically, on a virtual machine, with no users."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551216858, "post_id": 54894247, "comment_id": 96558005, "body": "@thursdaysgeek Then like BruceWayne said, make sure the printer&#39;s default settings are to print with color, and as long as you keep <code>.BlackAndWhite = False</code> (as more of a safety measure) then you shouldn&#39;t have any issues."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551216925, "post_id": 54894247, "comment_id": 96558031, "body": "@dwirony The printer&#39;s default settings are color (I just checked again).  And I do have issues.  :("}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1551217051, "post_id": 54894247, "comment_id": 96558100, "body": "@thursdaysgeek Where are you checking your printer settings? Under Printer Properties in Excel? What do you see under Advanced - &gt; Printer Features there? Is &quot;Print All Text as Black&quot; enabled or disabled?"}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1551217069, "post_id": 54894247, "comment_id": 96558110, "body": "I printed a test page an hour or so back, and haven&#39;t heard from them - I guess there could be some problem with the communication between the printer and this particular machine."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551217127, "post_id": 54894247, "comment_id": 96558139, "body": "@dwirony I was checking under printer settings for the printer itself.  I&#39;ll go check in Excel."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551217657, "post_id": 54894247, "comment_id": 96558366, "body": "@dwirony - That was it!  If you turn that into an answer (printer settings from within Excel), I will accept it."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1551220436, "post_id": 54894247, "comment_id": 96559425, "body": "@thursdaysgeek Great - sure, I&#39;ll write an answer."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1551220551, "creation_date": 1551220551, "answer_id": 54895299, "question_id": 54894247, "link": "https://stackoverflow.com/questions/54894247/turn-on-printing-in-color-in-excel-vba/54895299#54895299", "title": "Turn on printing in color in Excel VBA", "body": "<p>You'll need to make sure that your printer settings are properly configured in Excel. You can change these by going to:</p>\n\n<blockquote>\n  <p>File -> Print -> Printer Properties.</p>\n</blockquote>\n"}], "owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1896, "favorite_count": 1, "accepted_answer_id": 54895299, "answer_count": 1, "score": 0, "last_activity_date": 1551220551, "creation_date": 1551215849, "question_id": 54894247, "link": "https://stackoverflow.com/questions/54894247/turn-on-printing-in-color-in-excel-vba", "title": "Turn on printing in color in Excel VBA", "body": "<p>I have an inherited Excel spreadsheet that does a lot of work using VBA and then prints a page.  Until now, it had color and printed in black and white, with the line in a sub:</p>\n\n<pre><code>.BlackAndWhite = True\n</code></pre>\n\n<p>Now the users want some highlighting in certain cases, and we have added colored conditional formatting. But I can't get the spreadsheet to print in color and show that highlighting.  </p>\n\n<p>I can see that the color is there because it pauses for me to print to PDF, but the saved PDF won't show the color.  The users are printing to a color printer, and the printer is set up to print in color on the machine that this Excel exists.  There is another version that must be run manually, and it prints in color.</p>\n\n<p>Here is the printing code (which matches the one that prints in color, but I'm pretty sure the one that prints in color bypasses this altogether):</p>\n\n<pre><code>Public Sub Print_No_Interface()\n\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .DisplayAlerts = False\n    .EnableEvents = False\n    .AutoRecover.Enabled = False\nEnd With\n</code></pre>\n\n<p>And, at the end, when it prints, it calls this:</p>\n\n<pre><code>Public Sub Print_Helper()\n\nWith Worksheets(\"Detail\").PageSetup\n .LeftMargin = Application.InchesToPoints(0.5)\n .RightMargin = Application.InchesToPoints(0.5)\n .TopMargin = Application.InchesToPoints(0.75)\n .BottomMargin = Application.InchesToPoints(1)\n .CenterHorizontally = True\n .Orientation = xlPortrait\n .FirstPageNumber = xlAutomatic\n .FitToPagesWide = 1\n .FitToPagesTall = 1\n .PrintArea = \"A1:M118\"\n .PaperSize = xlPaperLegal\n .PrintGridlines = True\n .Zoom = 50\n End With\n\nWorksheets(\"Detail\").PrintOut ActivePrinter:=\"OUR COLOR PRINTER\"\n\nEnd Sub\n</code></pre>\n\n<p>I tried with .BlackAndWhite = False, with commenting it out, and finally removing it.  But it still prints only in black and white.  How do I get it to print in color now?</p>\n\n<p>Where else should I look that might be telling the page to print in black and white?</p>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1551217024, "post_id": 54893889, "comment_id": 96558086, "body": "Which line is giving you the error?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1551217242, "post_id": 54893889, "comment_id": 96558201, "body": "@Cyril given the unqualified <code>Worksheets</code> call is implicitly referring to <code>ActiveSheet</code>, and that <code>n</code> list items might be checked, and that parameterless <code>Worksheet.Copy</code> creates &amp; activates a new workbook, I&#39;d assume any 2nd iteration breaks on <code>Worksheets(...).Copy</code>, since the active workbook has changed between iterations."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551217566, "post_id": 54893889, "comment_id": 96558325, "body": "@MathieuGuindon my apologies for the cryptic inquiry... i was digging towards if there was an error on use of the listbox (is this code in the UserForm or is this within a module), where qualifications would use Me or UserForm1.Listbox, etc.  For all i know this is accessed through the userform code (e.g., when command button is clicked) or could be from a function in a module."}, {"owner": {"reputation": 11, "user_id": 8709406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613877ad3bf0878791bade8e4fcdceaa?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8709406/erik"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551218628, "post_id": 54893889, "comment_id": 96558755, "body": "@MathieuGuindon Thank you for your help, however the code is giving me an compile error on this line <code>ws.Copy .Worksheets(After:=.Worksheets(.Worksheets.Count))</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551218726, "post_id": 54893889, "comment_id": 96558801, "body": "Right, untested air-code. Hopefully fixed now."}, {"owner": {"reputation": 11, "user_id": 8709406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613877ad3bf0878791bade8e4fcdceaa?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8709406/erik"}, "edited": false, "score": 0, "creation_date": 1551218733, "post_id": 54893889, "comment_id": 96558804, "body": "all the buttons / listboxes are in a userform"}, {"owner": {"reputation": 11, "user_id": 8709406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613877ad3bf0878791bade8e4fcdceaa?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8709406/erik"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551219144, "post_id": 54893889, "comment_id": 96558981, "body": "@MathieuGuindon Thank you so much, the code works flawless. And also thanks for the explanation of what the code does, really helps"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8709406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613877ad3bf0878791bade8e4fcdceaa?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8709406/erik"}, "edited": false, "score": 0, "creation_date": 1551370245, "post_id": 54894531, "comment_id": 96624265, "body": "I have a extra question for the code that was used. Would it also be possible to copy the selected sheets as values only. So that all the formula&#39;s and links are removed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 8709406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613877ad3bf0878791bade8e4fcdceaa?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8709406/erik"}, "edited": false, "score": 0, "creation_date": 1551370685, "post_id": 54894531, "comment_id": 96624505, "body": "@Erik not in the same step. <code>Worksheet.Copy</code> copies the sheet; dealing with formulas/values is the job of <code>Range.Copy</code>."}, {"owner": {"reputation": 11, "user_id": 8709406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613877ad3bf0878791bade8e4fcdceaa?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8709406/erik"}, "edited": false, "score": 0, "creation_date": 1551371830, "post_id": 54894531, "comment_id": 96625120, "body": "thanks, will have to dive into that to make that happen"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 8709406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613877ad3bf0878791bade8e4fcdceaa?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8709406/erik"}, "edited": false, "score": 0, "creation_date": 1551371969, "post_id": 54894531, "comment_id": 96625208, "body": "@Erik <code>Range.PasteSpecial</code> with <code>xlValues</code> would do it, But I&#39;d probably go with <code>theSheet.UsedRange.Value = theSheet.UsedRange.Value</code> (copies the values into a 2D array, then dumps that 2D array onto the source range, overwriting whatever formula provided the values)."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1551218714, "last_edit_date": 1551218714, "creation_date": 1551217125, "answer_id": 54894531, "question_id": 54893889, "link": "https://stackoverflow.com/questions/54893889/sheets-selected-in-listbox2-and-exporting-them-to-a-new-workbook/54894531#54894531", "title": "Sheets selected in listbox2 and exporting them to a new workbook", "body": "<blockquote>\n<pre><code>Worksheets(ListBox2.List(K, 0)).Copy\n</code></pre>\n</blockquote>\n\n<p>Doing too many things at once, making too many assumptions: it's assuming that <code>ActiveWorkbook</code> has a worksheet that's named after <code>ListBox2.List(K, 0)</code>. It's also assuming that <code>ListBox2.List(K, 0)</code> will succeed.</p>\n\n<p>Break it down.</p>\n\n<pre><code>Dim sheetName As String\nsheetName = ListBox2.List(K, 0)\n</code></pre>\n\n<p>If this succeeds, we can proceed to get the worksheet:</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ActiveWorkbook.Worksheets(sheetName)\n</code></pre>\n\n<p>If this succeeds, we can proceed to copy the sheet:</p>\n\n<pre><code>ws.Copy\n</code></pre>\n\n<p>But we're in a loop... and <code>ws.Copy</code> is going to change the <code>ActiveWorkbook</code> - so if the first iteration worked, the second is guaranteed to blow up.</p>\n\n<p>The first thing to do is therefore to capture the \"source\" workbook before we even begin:</p>\n\n<pre><code>Dim srcBook As Workbook\nSet srcBook = ActiveWorkbook\n</code></pre>\n\n<p>And then to use that object reference to qualify the <code>Worksheets</code> call:</p>\n\n<pre><code>...\nSet ws = srcBook.Worksheets(sheetName)\n...\n</code></pre>\n\n<p>Now, the next problem is, every selected sheet will be copied to a new workbook - meaning, every selected sheet gets <em>its own</em> new workbook.</p>\n\n<p>If that's intended, all is good. But that's not how I read \"<em>copy the sheets to a new workbook</em>\" - right?</p>\n\n<p>In order for all copies to end up in the same destination workbook, you need to keep a reference to that workbook. And since it's going to be created and activated on the fly by the first copy you make, I'd do something like this:</p>\n\n<pre><code>Dim dstBook As Workbook\n...\nIf dstBook Is Nothing Then\n'destination workbook doesn't exist yet\n    ws.Copy\n    Set dstBook = ActiveWorkbook\nElse\n'copy worksheet to destination workbook, after the last sheet\n    With dstBook\n        ws.Copy After:=.Worksheets(.Worksheets.Count)\n    End With\nEnd If\n...\n</code></pre>\n\n<p>So:</p>\n\n<pre><code>Dim srcBook As Workbook\nSet srcBook = ActiveWorkbook ' ThisWorkbook?\n\nDim dstBook As Workbook\nFor K = 0 To ListBox2.ListCount - 1\n    If ListBox2.Selected(K) Then\n\n        Dim sheetName As String\n        sheetName = ListBox2.List(K, 0)\n\n        Dim ws As Worksheet\n        Set ws = srcBook.Worksheets(sheetName)\n\n        If dstBook Is Nothing Then\n        'destination workbook doesn't exist yet\n            ws.Copy ' creates &amp; activates a new workbook\n            Set dstBook = ActiveWorkbook 'there's our destination\n        Else\n        'copy worksheet to destination workbook, after the last sheet\n            With dstBook\n                ws.Copy After:=.Worksheets(.Worksheets.Count)\n            End With\n        End If\n\n    End If\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8709406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613877ad3bf0878791bade8e4fcdceaa?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/8709406/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1551218714, "creation_date": 1551214305, "last_edit_date": 1551214559, "question_id": 54893889, "link": "https://stackoverflow.com/questions/54893889/sheets-selected-in-listbox2-and-exporting-them-to-a-new-workbook", "title": "Sheets selected in listbox2 and exporting them to a new workbook", "body": "<p>Hopefully somebody can help me.</p>\n\n<p>I have 2 Listboxes in a userform (Listbox1 &amp; Listbox2), in Listbox1 I get the names of all the visible sheets in the workbook. \nIn Listbox2 will be the sheets I select in Listbox1, to copy to a new workbook.</p>\n\n<p>The filling of Listbox1 works, the copying of the sheetnames to Listbox2 workt too.\nI select the sheetnames in Listbox2, and then use the following code to copy the sheets to a new workbook.</p>\n\n<pre><code>For K = 0 To ListBox2.ListCount - 1\n    If ListBox2.Selected(K) Then\n        Worksheets(ListBox2.List(K, 0)).Copy\n    End If\nNext K\n</code></pre>\n\n<p>But I get a runtime error-9 \"Subscript out of range error\"</p>\n\n<p>Question:\nWhat goes wrong here ? \nHow do I change the code so that all selected items/sheets in Listbox2 are nicely exported to a new workbook.</p>\n\n<p>Thanks for all the help</p>\n"}, {"tags": ["excel", "vba", "transpose"], "comments": [{"owner": {"reputation": 2370, "user_id": 5177045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qO1kp.png?s=128&g=1", "display_name": "amedina", "link": "https://stackoverflow.com/users/5177045/amedina"}, "edited": false, "score": 0, "creation_date": 1551213771, "post_id": 54893696, "comment_id": 96556669, "body": "Please, show us what you have tried so far."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9893673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anti R&#225;cz", "link": "https://stackoverflow.com/users/9893673/anti-r%c3%a1cz"}, "edited": false, "score": 0, "creation_date": 1551215836, "post_id": 54893825, "comment_id": 96557586, "body": "Thanks it&quot;s works fine but not copy in to the 2nd row after the loop."}, {"owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "reply_to_user": {"reputation": 3, "user_id": 9893673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anti R&#225;cz", "link": "https://stackoverflow.com/users/9893673/anti-r%c3%a1cz"}, "edited": false, "score": 0, "creation_date": 1551216270, "post_id": 54893825, "comment_id": 96557773, "body": "@AntiR&#225;cz made some changes to the code. Let me know how it works for you."}], "tags": [], "owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "is_accepted": true, "score": -1, "last_activity_date": 1551216204, "last_edit_date": 1551216204, "creation_date": 1551214031, "answer_id": 54893825, "question_id": 54893696, "link": "https://stackoverflow.com/questions/54893696/excel-transpose-column-with-macros-data-loop/54893825#54893825", "title": "Excel transpose column with macros data loop", "body": "<p>This code will copy loop through all the non-blank cells in column 1 of the ActiveSheet and transpose them to the adjacent cells starting at B1. You need to change <code>\"Condition Text\"</code> to a statement that matches when the end of each row is round. Because you haven't specified what makes the last cell unique to the rest, you'll need to write this part yourself.</p>\n\n<pre><code>Option Explicit\nPrivate Sub TransposeCol()\n    Dim sht As Worksheet\n    Set sht = ActiveSheet\n    Dim i As Long\n    i = 1\n    Dim n As Long\n    n = 2\n\n    While sht.Cells(i, 1) &lt;&gt; \"Condition Text\"\n        sht.Cells(1, n) = sht.Cells(i, 1)\n        i = i + 1\n        n = n + 1\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9893673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anti R&#225;cz", "link": "https://stackoverflow.com/users/9893673/anti-r%c3%a1cz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1609786832, "accepted_answer_id": 54893825, "answer_count": 1, "score": -2, "last_activity_date": 1587188240, "creation_date": 1551213467, "last_edit_date": 1551213560, "question_id": 54893696, "link": "https://stackoverflow.com/questions/54893696/excel-transpose-column-with-macros-data-loop", "closed_reason": "Needs more focus", "title": "Excel transpose column with macros data loop", "body": "<p>I have a problem , I have a column with some data.</p>\n\n<p>I want to transpose all of this data automatically with a macro. </p>\n\n<p>I have  cells in the column with some special text this is the end of the first row end the 2 row and 3.. how can i do this ? the cells range\"s are random.</p>\n\n<p>Thanks!</p>\n\n<p><img src=\"https://i.stack.imgur.com/DILgN.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["javascript", "vba", "adobe", "acrobat", "jsobject"], "comments": [{"owner": {"reputation": 1907, "user_id": 3426514, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O2Sj0.png?s=128&g=1", "display_name": "user230910", "link": "https://stackoverflow.com/users/3426514/user230910"}, "edited": false, "score": 0, "creation_date": 1551213724, "post_id": 54893663, "comment_id": 96556650, "body": "Hi Kyle, and welcome to stack overflow! Please can you show some of what you have already done, so the people here trying to help you don&#39;t need to go through the same steps you already tried?"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 11121578, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fAYaV27c8tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3L0O99XX0GZ3FFSCdqmD-pR92Zg/mo/photo.jpg?sz=128", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11121578/kyle"}, "is_accepted": true, "score": 0, "last_activity_date": 1551447008, "creation_date": 1551447008, "answer_id": 54945686, "question_id": 54893663, "link": "https://stackoverflow.com/questions/54893663/adding-textbox-in-whitespace-to-abobe-acrobat-pdf-using-js-and-vba/54945686#54945686", "title": "Adding textbox in whitespace to Abobe Acrobat PDF using JS and VBA", "body": "<p>I've Determined that this is not possible. Instead I'm using VBA ImageProcess and ImageFile objects along with the Img.ARGBData property (color of individual pixels) and analyzing this in order to find white space then when a white space that is big enough is found replacing those pixels with the pixels desired.</p>\n"}], "owner": {"reputation": 61, "user_id": 11121578, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fAYaV27c8tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3L0O99XX0GZ3FFSCdqmD-pR92Zg/mo/photo.jpg?sz=128", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11121578/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 54945686, "answer_count": 1, "score": -1, "last_activity_date": 1551447008, "creation_date": 1551213315, "last_edit_date": 1551214963, "question_id": 54893663, "link": "https://stackoverflow.com/questions/54893663/adding-textbox-in-whitespace-to-abobe-acrobat-pdf-using-js-and-vba", "title": "Adding textbox in whitespace to Abobe Acrobat PDF using JS and VBA", "body": "<p>I'm trying to add a textbox into an Adobe Acrobat pdf using jsObject (being called from vba script). It needs to be as close to the top right of the page as possible without overlapping with any previously added text/tables. \nAny suggestions on how to accomplish this?\nIs there a way to determine the \"hit box\" of each object on the pdf so I know where the textbox cannot be?</p>\n\n<p>Thanks!</p>\n\n<p>Its not letting me copy and paste so here is an image of my code so far that puts a textbox onto the desired pdf\n<a href=\"https://i.stack.imgur.com/qVtKK.jpg\" rel=\"nofollow noreferrer\">Image of code</a></p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1551213704, "post_id": 54893527, "comment_id": 96556636, "body": "If you set a breakpoint on the line <code>attr.Click</code>, do you hit it?"}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1551218535, "post_id": 54893527, "comment_id": 96558715, "body": "Instead of getting all element by tag name &quot;a&quot;, try a CSS selector <code>a[title=&#39;Documents&#39;]</code>. That should get you the one you need without the loop then just click on it"}, {"owner": {"reputation": 1, "user_id": 11121375, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T8By26rEgPU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfroDOgGBAnSutvF6CY1URVurO5dA/mo/photo.jpg?sz=128", "display_name": "Yogesh Warpe", "link": "https://stackoverflow.com/users/11121375/yogesh-warpe"}, "edited": false, "score": 0, "creation_date": 1551280673, "post_id": 54893527, "comment_id": 96584330, "body": "@ matteo NNZ - Yes in the break point mode when I debug it reaching to attr.Click but initialising with null value"}, {"owner": {"reputation": 1, "user_id": 11121375, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T8By26rEgPU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfroDOgGBAnSutvF6CY1URVurO5dA/mo/photo.jpg?sz=128", "display_name": "Yogesh Warpe", "link": "https://stackoverflow.com/users/11121375/yogesh-warpe"}, "edited": false, "score": 0, "creation_date": 1551280776, "post_id": 54893527, "comment_id": 96584406, "body": "@ JeffC - Thanks for the quick suggestion &amp; I&#39;ll surely give a try with a CSS selector today."}], "answers": [{"tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1551233035, "creation_date": 1551233035, "answer_id": 54896937, "question_id": 54893527, "link": "https://stackoverflow.com/questions/54893527/unable-to-click-on-documents-tab-from-div-class-tabcontent-titletabcontain/54896937#54896937", "title": "Unable to click on &quot;Documents&quot; tab from &lt;div class = &quot;TabContent TitleTabContainer&quot;&gt; through vba code", "body": "<p>I try to test your code which is giving Type mismatch error at 2 places.</p>\n\n<p>I suggest you to make a test with code below which is able to click that Documents tab.</p>\n\n<p>HTML code:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Page Title&lt;/title&gt;\n&lt;script&gt;\nfunction abc()\n{\nalert(\"hi....\");\n}\n&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;div class=\"TabContent TitleTabContainer\"&gt;\n&lt;a title=\"Documents\" class=\"TabTitle\" role=\"tab\" style=\"width:auto;\" onclick=\"abc()\" href=\"javascript:void(null);\"&gt;Documents&lt;/a&gt;\n&lt;/div&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>VBA code:</p>\n\n<pre><code>Sub demo()\nDim ie As Object\nDim form As Variant, button As Variant\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\n\nWith ie\n.Visible = True\n.Navigate (\"C:\\Users\\Administrator\\Desktop\\48.html\")\n\nWhile ie.readyState &lt;&gt; 4\nDoEvents\nWend\n\nFor Each l In ie.document.getElementsByTagName(\"a\")\n    If l.Title = \"Documents\" Then\n        l.Click\n        Exit For\n        End If\n\n    Next\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Output in IE 11:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5sWeW.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5sWeW.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Further, You can try to refer the code and try to modify it as per your requirements.</p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551383850, "post_id": 54902089, "comment_id": 96631059, "body": "Did the above meet with any success?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1551259769, "creation_date": 1551259769, "answer_id": 54902089, "question_id": 54893527, "link": "https://stackoverflow.com/questions/54893527/unable-to-click-on-documents-tab-from-div-class-tabcontent-titletabcontain/54902089#54902089", "title": "Unable to click on &quot;Documents&quot; tab from &lt;div class = &quot;TabContent TitleTabContainer&quot;&gt; through vba code", "body": "<p>You might try using a css attribute = value selector</p>\n\n<pre><code>ie.document.querySelector(\"[title=Documents]\").click\n</code></pre>\n\n<p>You could additionally add in the class:</p>\n\n<pre><code>ie.document.querySelector(\".TabTitle[title=Documents]\").click\n</code></pre>\n\n<hr>\n\n<p>Before the click make sure you have a proper page load wait:</p>\n\n<pre><code>While ie.Busy Or ie.readyState &lt; 4: DoEvents: Wend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11121375, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T8By26rEgPU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfroDOgGBAnSutvF6CY1URVurO5dA/mo/photo.jpg?sz=128", "display_name": "Yogesh Warpe", "link": "https://stackoverflow.com/users/11121375/yogesh-warpe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551260155, "creation_date": 1551212638, "last_edit_date": 1551260155, "question_id": 54893527, "link": "https://stackoverflow.com/questions/54893527/unable-to-click-on-documents-tab-from-div-class-tabcontent-titletabcontain", "title": "Unable to click on &quot;Documents&quot; tab from &lt;div class = &quot;TabContent TitleTabContainer&quot;&gt; through vba code", "body": "<pre><code>Private Declare PtrSafe Function ShowWindow Lib \"user32\" (ByVal hwnd As Long, ByVal nCmdSHow As Long) As Long\n\nSub Pulldata_BI_Launch()\nCreateObject(\"Shell.Application\").Windows\nDim IE As New SHDocVw.InternetExplorer    \nDim htmldoc As MSHTML.HTMLDocument    \nDim elems As MSHTML.IHTMLElementCollection    \nDim attr As MSHTML.IHTMLBodyElement    \n\n'Make internet explorer visible    \nIE.Visible = True    \nIE.Navigate \"https://*************** \"    \nShowWindow IE.hwnd, 3\n\n'Wait for page loads fully    \nDo While IE.readyState &lt;&gt; READYSTATE_COMPLETE    \nLoop\n\n'Collect webpage opened in variable    \nSet htmldoc = IE.document\n\n'Click on Documents tab from container    \nSet elems = htmldoc.getElementsByTagName(\"a\")    \n    Set attr = elems.Item    \n    For Each attr In elems    \n    If (attr.Item(\"title\") = \"Documents\") Then    \n    attr.Click    \n    Exit For    \n    End If    \n    Next attr    \nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I'm looking to click on <strong>Documents</strong> tab next to <strong>Home</strong> tab through code but unable to do so. Any help would be greatly appreciated. Following is screenprint for inspect element of Documents tab button:\n<a href=\"https://i.stack.imgur.com/BEC7A.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "string", "powerpoint", "wildcard"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1551212942, "post_id": 54893428, "comment_id": 96556266, "body": "Have you considered <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">regular expressions</a>?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1551226920, "post_id": 54893428, "comment_id": 96561361, "body": "Getting all the text from ppt may be a uphill task. Here is good <a href=\"http://www.pptfaq.com/FAQ00274_Export_Text_to_a_text_file-_extract_text_from_PowerPoint_-Mac_or_PC-.htm\" rel=\"nofollow noreferrer\">reading</a>. Even  the example does not cover all the type of shapes that may conatain text."}], "owner": {"reputation": 1, "user_id": 11121492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a3d13f21384656402db9133a8743416?s=128&d=identicon&r=PG&f=1", "display_name": "Chris S", "link": "https://stackoverflow.com/users/11121492/chris-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551212915, "creation_date": 1551212239, "last_edit_date": 1551212915, "question_id": 54893428, "link": "https://stackoverflow.com/questions/54893428/how-do-i-search-ppt-slides-for-a-string-of-indeterminate-length", "title": "How do I search PPT slides for a string of indeterminate length?", "body": "<p>I need to find and replace a string in PPT. But the length of the string will vary and PPT does not allow wildcard searches like Word. I need to find every string that begins with <code>&lt;REF</code> and end with <code>&gt;</code>. In Word I would search for <code>&lt;REF*&gt;</code>. How do I do this in PPT? Here is what I have so far, but this only finds some of the strings. Please help!</p>\n\n<pre><code>Function FindAndReplace(s As String, replacementText As String) As String\n  Const LEFT As String = \"&lt;REF\"\n  Const RIGHT As String = \"&gt;\"\n  Dim temp As String\n  temp = s\n  Dim iPos As Integer\n  iPos = 1\n  Dim iStart As Integer, iEnd As Integer\n  Do\n    iPos = InStr(iPos, temp, LEFT)\n    If iPos = 0 Then\n      FindAndReplace = temp\n      Exit Function\n    End If\n\n    iStart = iPos\n    iEnd = InStr(iStart, temp, RIGHT)\n    If iEnd = 0 Then\n      FindAndReplace = temp\n      Exit Function\n    End If\n\n    Dim targetText As String\n    iEnd = iEnd + 1\n    targetText = Mid(temp, iStart, iEnd - iStart)\n    temp = Replace(temp, targetText, replacementText)\n    iPos = iPos + Len(LEFT) + Len(targetText) + Len(RIGHT)\nIf iPos &gt;= Len(temp) Then Exit Do\n  Loop\n  FindAndReplace = temp\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1551212198, "post_id": 54893159, "comment_id": 96555883, "body": "You&#39;ll need to be a bit more specific. What do you mean by connection refresh? What database are you querying? Is it querying via a macro, or is it a linked data source (from the Data tab in Excel)? How do you want to output the date/time of the refresh? What have you tried so far?"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1551216549, "post_id": 54893159, "comment_id": 96557883, "body": "Googling <code>excel query connections last update timestamp</code> yielded this result, which should help you <code>https:&#47;&#47;answers.microsoft.com&#47;en-us&#47;msoffice&#47;forum&#47;all&#47;time-&zwnj;&#8203;stamp-when-query-is-&zwnj;&#8203;refreshed&#47;0987771f-7&zwnj;&#8203;2a8-4afb-9889-ea9891&zwnj;&#8203;e03624</code>"}, {"owner": {"reputation": 11, "user_id": 11121454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6a17541acbf9a234de835309f90674?s=128&d=identicon&r=PG&f=1", "display_name": "shadow", "link": "https://stackoverflow.com/users/11121454/shadow"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1551273630, "post_id": 54893159, "comment_id": 96579917, "body": "@JoshEller the connection is a linked data source.  a server based SQL connection.  It&#39;s set to refresh every 5 minutes.  I would like to just output to a cell for now.  And I have tried"}, {"owner": {"reputation": 11, "user_id": 11121454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6a17541acbf9a234de835309f90674?s=128&d=identicon&r=PG&f=1", "display_name": "shadow", "link": "https://stackoverflow.com/users/11121454/shadow"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1551276425, "post_id": 54893159, "comment_id": 96581602, "body": "@JoshEller      <code>Sub Macro1()           ActiveWorkbook.RefreshAll With Range(&quot;A1&quot;) .Value = Now()           .NumberFormat = &quot;mm&#47;dd&#47;yyyy hh:mm:ss&quot;       End With       End Sub \u2013</code>"}], "owner": {"reputation": 11, "user_id": 11121454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6a17541acbf9a234de835309f90674?s=128&d=identicon&r=PG&f=1", "display_name": "shadow", "link": "https://stackoverflow.com/users/11121454/shadow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1071, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551257138, "creation_date": 1551211090, "last_edit_date": 1551257138, "question_id": 54893159, "link": "https://stackoverflow.com/questions/54893159/excel-trying-to-display-most-recent-refresh-time-and-date-to-a-database-query-co", "title": "Excel trying to display most recent refresh time and date to a database query connection", "body": "<p>As the title suggests I'm just trying to find out how I can display the date and time of a connection refresh.  I haven't been able to find a direct answer to this question anywhere.  Please let me know, and I can clarify more as needed. Also, I have Excel 2013.  </p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1551210278, "post_id": 54981273, "comment_id": 96720474, "body": "There are also other restrictions. <a href=\"http://virtual.parkland.edu/kcouch/CIS122/Week2/Exercises/goodname%20badname%20answers.htm\" rel=\"nofollow noreferrer\">This</a> may prove useful reading"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1551210175, "creation_date": 1551210175, "answer_id": 54981273, "question_id": 54981272, "link": "https://stackoverflow.com/questions/54981272/why-is-the-variable-name-1stname-changed-to-1-stname/54981273#54981273", "title": "Why is the variable name &quot;1stName&quot; changed to &quot;1 stName&quot;?", "body": "<p>Identifiers in VBA must begin with a letter: You can't have a legal variable/object name that begins with a digit. Rename your variable to <code>FirstName</code> instead of <code>1stName</code>.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1551695232, "question_id": 1409672}, "owner": {"user_type": "does_not_exist", "display_name": "Redeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565338623, "creation_date": 1551209743, "last_edit_date": 1565338623, "question_id": 54981272, "link": "https://stackoverflow.com/questions/54981272/why-is-the-variable-name-1stname-changed-to-1-stname", "title": "Why is the variable name &quot;1stName&quot; changed to &quot;1 stName&quot;?", "body": "<p>When I try to enter this: <code>1stName.Additem ()</code>, a space is put between the <code>1</code> and <code>st</code>, so ends up like this: <code>1 stName.Additem()</code>.</p>\n"}, {"tags": ["python", "vba", "xlwings", "python-standalone"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1551209410, "post_id": 54892713, "comment_id": 96554681, "body": "Screenshots of code are not searchable, are difficult to read, and are generally difficult to deal with.  Can you <a href=\"https://stackoverflow.com/posts/54892713/edit\">edit your question</a> to include the actual code itself (in text, preferably formatted)?  Are you sure that the file has a <code>.txt</code> extension? Anything can be associated with &quot;Text Document&quot;, and I can&#39;t tell  from the screenshot if you have known extensions hidden."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1551209432, "post_id": 54892713, "comment_id": 96554691, "body": "No. The instructions say only fib lite doesn&#39;t require. <i>Note: Except for the Fibonacci Lite example, all examples require a Python installation with xlwings &gt;=v0.11.0 and the xlwings Excel add-in installed.</i>"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1551212853, "post_id": 54892713, "comment_id": 96556213, "body": "Have you unzipped the folder before running the Standalone command? The macro can&#39;t call the DLL if it&#39;s still zipped."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 10872604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rbJ2EJ2E77A/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaB_TgZ-O-I1BtmobZvRV1dty3zgA/mo/photo.jpg?sz=128", "display_name": "Paul Chilvers", "link": "https://stackoverflow.com/users/10872604/paul-chilvers"}, "is_accepted": true, "score": 0, "last_activity_date": 1551252437, "creation_date": 1551252437, "answer_id": 54900151, "question_id": 54892713, "link": "https://stackoverflow.com/questions/54892713/issue-when-running-xlwings-python-standalone-fibonacci-example/54900151#54900151", "title": "Issue when running xlwings python standalone fibonacci example", "body": "<p>Must of been something buggy on my PC and not with the programme, restarted and now it works. Thanks for the initial responses.</p>\n"}], "owner": {"reputation": 65, "user_id": 10872604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rbJ2EJ2E77A/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaB_TgZ-O-I1BtmobZvRV1dty3zgA/mo/photo.jpg?sz=128", "display_name": "Paul Chilvers", "link": "https://stackoverflow.com/users/10872604/paul-chilvers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 54900151, "answer_count": 1, "score": -1, "last_activity_date": 1551252437, "creation_date": 1551209152, "question_id": 54892713, "link": "https://stackoverflow.com/questions/54892713/issue-when-running-xlwings-python-standalone-fibonacci-example", "title": "Issue when running xlwings python standalone fibonacci example", "body": "<p>When running the standalone example from xlwings I am faced with the following error: <a href=\"https://i.stack.imgur.com/Ui2zA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ui2zA.png\" alt=\"runtime error\"></a>. </p>\n\n<p>When I debug I am faced with the code falling over on this line: <a href=\"https://i.stack.imgur.com/Lw3un.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lw3un.png\" alt=\"error line\"></a></p>\n\n<p>The log file its trying to open contains the following text:<a href=\"https://i.stack.imgur.com/elK13.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/elK13.png\" alt=\"The log file exists but fails on the open line\"></a>.</p>\n\n<p>As I have just taken it from the website I dont see why its not working? It say on the web-page that it doesn't require python or the excel wings addin? Has anyone else ran in to this?</p>\n\n<p>Website: <a href=\"https://www.xlwings.org/examples\" rel=\"nofollow noreferrer\">https://www.xlwings.org/examples</a> fib standalone example. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1551208884, "post_id": 54892603, "comment_id": 96554434, "body": "You need to <code>Set rng =</code>."}, {"owner": {"reputation": 19, "user_id": 4081556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100a38cf6954171466d3c5fa8ddf75f9?s=128&d=identicon&r=PG&f=1", "display_name": "Paige", "link": "https://stackoverflow.com/users/4081556/paige"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1551208978, "post_id": 54892603, "comment_id": 96554484, "body": "@BrianMStafford you&#39;re correct - I missed that! That being said, it still returns the &#39;Object Required&#39; error."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1551209096, "post_id": 54892603, "comment_id": 96554530, "body": "Where is <code>Worksheet</code> defined?  Is that supposed to be <code>ActiveSheet</code>? Same with <code>Sheet</code>.  I&#39;d suggest putting <code>Option Explicit</code> at the top of the module and correcting all the errors it flags."}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1551209160, "post_id": 54892603, "comment_id": 96554566, "body": "set rng = Worksheets(&quot;your worksheet name&quot;).Range(&quot;L2:L318&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4081556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100a38cf6954171466d3c5fa8ddf75f9?s=128&d=identicon&r=PG&f=1", "display_name": "Paige", "link": "https://stackoverflow.com/users/4081556/paige"}, "edited": false, "score": 0, "creation_date": 1551209613, "post_id": 54892712, "comment_id": 96554785, "body": "Oh my gosh it works. I&#39;ve been staring at this for an hour - you&#39;re a life saver. Correct me if I&#39;m wrong - doesn&#39;t this effectively render i pointless?"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 19, "user_id": 4081556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100a38cf6954171466d3c5fa8ddf75f9?s=128&d=identicon&r=PG&f=1", "display_name": "Paige", "link": "https://stackoverflow.com/users/4081556/paige"}, "edited": false, "score": 0, "creation_date": 1551209685, "post_id": 54892712, "comment_id": 96554831, "body": "@PaigeJaclyn yep, that&#39;s why I took it out :).  If it helped, feel free to up vote and /or accept it as a solution so others know that it worked."}], "tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": true, "score": 2, "last_activity_date": 1551209149, "creation_date": 1551209149, "answer_id": 54892712, "question_id": 54892603, "link": "https://stackoverflow.com/questions/54892603/excel-object-required-error-when-running-macro/54892712#54892712", "title": "Excel Object Required Error when Running Macro", "body": "<p>This is a great start!  You've got a few things off, but for the most part you weren't too far off.  Keep in mind there are a <em>ton</em> of different ways to approach this, but since you're learning, I took your approach and made it work.  See if this gets you close to what you're after:</p>\n\n<pre><code>Sub Macro2()\n\nDim rng As Range\nDim cell As Range\nSet rng = Range(\"L2:L318\")\n\nFor Each cell In rng\n    If cell.Value = 902.4 Then Cells(cell.Row, 8).Value = \"Text\"\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>Take a look at what I posted and see if you can make heads or tails of it.  As you can see, it's not too far off what you had, just cleaned up a little and fixed the syntax.  </p>\n\n<p>Keep in mind, this macro will run on the currently active sheet.  If you need it to run on a specific sheet, you'll have to qualify your range reference a bit better...something like: Worksheets(\"your worksheet name\").Range(\"L2:L318\")</p>\n"}], "owner": {"reputation": 19, "user_id": 4081556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100a38cf6954171466d3c5fa8ddf75f9?s=128&d=identicon&r=PG&f=1", "display_name": "Paige", "link": "https://stackoverflow.com/users/4081556/paige"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54892712, "answer_count": 1, "score": 1, "last_activity_date": 1551209531, "creation_date": 1551208693, "last_edit_date": 1551209531, "question_id": 54892603, "link": "https://stackoverflow.com/questions/54892603/excel-object-required-error-when-running-macro", "title": "Excel Object Required Error when Running Macro", "body": "<p>I am trying to create a macro such that if a given cell in the range L2:L318 contains a particular value, the cell in column H in the same row is modified to a new string. </p>\n\n<p>At this point, I have what appears to be something passable, but I get an 'Object Required' error when it runs. My code is as follows: </p>\n\n<pre><code>Sub Macro2()\n\nDim rng As Range\nDim cell As Range\nSet rng = Worksheet.Range(\"L2:L318\")\nDim i As Integer\n\n\nFor Each cell In rng\n    If cell.Value(\"902.4\") Then\n    i = i + 1\n    Sheet.Cells(8, i).Value = \"Text\"\n\n\n    Else\n    i = i + 1\n\n    End If\n\nNext cell\n\n\nEnd Sub\n</code></pre>\n\n<p>I'll admit I haven't the slightest idea what I'm doing, and there's at least a moderate chance my code is complete nonsense. Can anyone explain to me what I'm doing wrong? Any help would be appreciated - I've literally never touched Excel macros before today!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1551208902, "post_id": 54892408, "comment_id": 96554445, "body": "Consider adding <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/randomize-statement\" rel=\"nofollow noreferrer\"><code>Randomize</code></a> somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 3, "last_activity_date": 1551208797, "creation_date": 1551208797, "answer_id": 54892629, "question_id": 54892408, "link": "https://stackoverflow.com/questions/54892408/assign-new-objects-in-collection-random-number-for-property-vba/54892629#54892629", "title": "Assign new objects in collection random number for property - VBA", "body": "<p>This happens because you are adding every time the same object instance.\nWrite your code like this: </p>\n\n<pre><code>Sub Add_number()\n    Dim rand_num As Cnum \n    'Set rand_num = New Cnum '&lt;-- remove the unique initialization from here\n    Dim RandColl As New Collection \n\n    Dim numCount As Integer\n    numCount = 3\n    Randomize '&lt;-- also, add the call to the randomize module\n\n    Do\n        Set rand_num = New Cnum '&lt;-- move it in the loop to create a new instance of Cnum each time\n        RandColl.Add rand_num \n        rand_num.num = rnd()\n    Loop Until RandColl.Count = numCount\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 6301517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bae3b1b6120f28d727740eb0695836a2?s=128&d=identicon&r=PG&f=1", "display_name": "Yolo_chicken", "link": "https://stackoverflow.com/users/6301517/yolo-chicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 54892629, "answer_count": 1, "score": 0, "last_activity_date": 1551208797, "creation_date": 1551207808, "question_id": 54892408, "link": "https://stackoverflow.com/questions/54892408/assign-new-objects-in-collection-random-number-for-property-vba", "title": "Assign new objects in collection random number for property - VBA", "body": "<p>I created a new class module that looks like this:</p>\n\n<pre><code>Private pNum As Double\n\n\nPublic Property Get Num() As Double\n    Num = pNum \nEnd Property\nPublic Property Let Num(Value As Double)\n    pNum = Value\nEnd Property\n</code></pre>\n\n<p>I'm trying to add random numbers to a collection, as an object property.\nThis just provides me with 3 objects with the same random number. </p>\n\n<pre><code>Sub Add_number()\n    Dim rand_num As Cnum \n    Set rand_num = New Cnum\n\n    Dim RandColl As New Collection \n\n    Dim numCount As Integer\n    numCount = 3\n\n\n    Do\n        RandColl.Add rand_num \n        rand_num.num = rnd()\n    Loop Until RandColl.Count = numCount\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "string", "loops", "ms-access", "longtext"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1551207685, "post_id": 54892294, "comment_id": 96553881, "body": "Consider using <a href=\"https://stackoverflow.com/a/22542835/111794\">regular expressions</a>. Or, perhaps you could just use the VBA <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/split-function\" rel=\"nofollow noreferrer\"><code>Split</code></a> function, although I&#39;m not sure you can pass in more than one character as the delimiter (and I <a href=\"https://superuser.com/questions/1409396/vba-unavailable-from-office-programs\">can&#39;t test it</a> right now)."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551211293, "post_id": 54892294, "comment_id": 96555484, "body": "Don&#39;t put VBA variables within <code>[ ]</code>. Only Access object (field, table, query, form, report) names. Do you want to save the parts to separate records or as a single string?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551211933, "post_id": 54892294, "comment_id": 96555759, "body": "Is the new table <code>Notes</code> a dependent table? What is the identifier that will associate these records? If you create 3 new records out of those parts, how will they retain association with each other?"}, {"owner": {"reputation": 417, "user_id": 8543373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dbb98884e611625cd78052c8aece5a9?s=128&d=identicon&r=PG&f=1", "display_name": "tenebris silentio", "link": "https://stackoverflow.com/users/8543373/tenebris-silentio"}, "edited": false, "score": 0, "creation_date": 1551298138, "post_id": 54892294, "comment_id": 96593704, "body": "I&#39;m early in the stages, but I&#39;ll have an employee_ID field associated with each.  Adding that to my append query should be easy, but it&#39;s parsing and splitting the text that&#39;s been throwing me off.  I&#39;ll give the code below a try and hope for the best! Thanks!"}, {"owner": {"reputation": 417, "user_id": 8543373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dbb98884e611625cd78052c8aece5a9?s=128&d=identicon&r=PG&f=1", "display_name": "tenebris silentio", "link": "https://stackoverflow.com/users/8543373/tenebris-silentio"}, "edited": false, "score": 0, "creation_date": 1551305531, "post_id": 54892294, "comment_id": 96596910, "body": "I tried the Split() method and it worked beautifully.  THANK YOU!"}], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 3, "last_activity_date": 1551211669, "last_edit_date": 1551211669, "creation_date": 1551211353, "answer_id": 54893218, "question_id": 54892294, "link": "https://stackoverflow.com/questions/54892294/ms-access-capture-certain-group-of-text-append-and-loop-onto-next-section-in-a/54893218#54893218", "title": "MS Access capture certain group of text, append, and loop onto next section in a long text field", "body": "<p>@Zev Spitz is correct in that you could use <code>Split()</code> to accomplish this. You could use something like this</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nSub SplitLongTextField()\n    Dim rs As Recordset\n    Dim reportTextArr\n    Dim qString As String\n    Dim i As Long\n\n\n    qString = \"SELECT [reporttext] FROM [Table1]\" '&lt;- replace [Table1] with the name of your table with the Long Text field\n\n    Set rs = CurrentDb.OpenRecordset(qString)\n\n    If Not rs.EOF Then\n        reportTextArr = Split(rs.Fields(\"reporttext\"), \"[]\")\n    End If\n\n    For i = LBound(reportTextArr) To UBound(reportTextArr)\n        If Not reportTextArr(i) = \"\" Then\n            DoCmd.RunSQL \"INSERT INTO notes(reporttext) VALUES('\" &amp; reportTextArr(i) &amp; \"');\"\n        End If\n    Next i\n\n    rs.Close\n\nEnd Sub\n</code></pre>\n\n<p>If you needed to do this for multiple records from your initial table then you could loop through the entire table and loop the operation like</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nSub SplitLongTextField()\n    Dim rs As Recordset\n    Dim reportTextArr\n    Dim qString As String\n    Dim i As Long\n\n\n    qString = \"SELECT [reporttext] FROM [Table1]\" '&lt;- replace [Table1] with the name of your table with the Long Text field\n\n    Set rs = CurrentDb.OpenRecordset(qString)\n\n    Do Until rs.EOF\n        reportTextArr = Split(rs.Fields(\"reporttext\"), \"[]\")\n\n        For i = LBound(reportTextArr) To UBound(reportTextArr)\n            If Not reportTextArr(i) = \"\" Then\n                DoCmd.RunSQL \"INSERT INTO notes(reporttext) VALUES('\" &amp; reportTextArr(i) &amp; \"');\"\n            End If\n        Next i\n\n        rs.MoveNext\n    Loop\n\n    rs.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1551211771, "last_edit_date": 1551211771, "creation_date": 1551211374, "answer_id": 54893224, "question_id": 54892294, "link": "https://stackoverflow.com/questions/54892294/ms-access-capture-certain-group-of-text-append-and-loop-onto-next-section-in-a/54893224#54893224", "title": "MS Access capture certain group of text, append, and loop onto next section in a long text field", "body": "<p>Assuming the string always starts with <code>[]</code> and preference is to return a single string, consider:</p>\n\n<p><code>Replace(Mid(reporttext, 4), \"[] \", vbCrLf)</code></p>\n"}], "owner": {"reputation": 417, "user_id": 8543373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dbb98884e611625cd78052c8aece5a9?s=128&d=identicon&r=PG&f=1", "display_name": "tenebris silentio", "link": "https://stackoverflow.com/users/8543373/tenebris-silentio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 54893218, "answer_count": 2, "score": 0, "last_activity_date": 1551211771, "creation_date": 1551207294, "last_edit_date": 1551211605, "question_id": 54892294, "link": "https://stackoverflow.com/questions/54892294/ms-access-capture-certain-group-of-text-append-and-loop-onto-next-section-in-a", "title": "MS Access capture certain group of text, append, and loop onto next section in a long text field", "body": "<p>I have a long text field (called \"reporttext\") that someone is importing a bunch of text that needs to be separated and appended into another table. For each case, there's a \"[]\" character that is supposed to separate each case. I want my code to look for the first [] and second [], append the text to another table and then loop.  So the next case would be the text between the second [] and third []. </p>\n\n<p>Here's my string</p>\n\n<p><strong>Reporttext</strong>: [] ksfjjls [] 42244 [] @@@@</p>\n\n<p>I would want this to append to a new table called \"notes\" where it would be like this:</p>\n\n<p><strong>Reporttext</strong> <br>\n ksfjjls <br>\n 42244 <br>\n @@@@</p>\n\n<p>I used a macro to count the number of [] in the text file to know how many times to run the loop, but this, along with the rest of my code just isn't happening. I know my code is wrong, but I know with a few tweaks it'll get there. Any help is appreciated. </p>\n\n<pre><code>lengthofnote = Len([reporttext])\nstart = InStr([reporttext], \"[]\")\nstartplus3 = [start] + 3\n'find number of cases\nfirstcase = 1\nnumcases = StringCountOccurrences([reporttext], \"[]\")\nDim LCounter As Integer\n\n  For LCounter = [firstcase] To [numcases]\n    revisedreporttext = Mid([reporttext], [startplus3], [lengthofnote])\n    secondposition = InStr([revisedreporttext], \"[]\")\n    nextreporttext = Mid([reporttext], [startplus3], [secondposition])\n    Add_reporttext = \"INSERT INTO notes(reporttext) values ('\" &amp; nextreporttext &amp; \"');\"\n    DoCmd.RunSQL Add_reporttext  \n    firstcase = firstcase + 1\n    startplus3 = secondposition\n    secondposition = secondposition + 4\n  Next LCounter\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1551207364, "post_id": 54892234, "comment_id": 96553750, "body": "Just make one call to <code>Rnd()</code>, and then segment the number of heads based on the probability. See <a href=\"https://math.stackexchange.com/q/1791243/145578\">this answer on Math SE</a>."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 8353582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STZmO.jpg?s=128&g=1", "display_name": "Mark Polczynski", "link": "https://stackoverflow.com/users/8353582/mark-polczynski"}, "edited": false, "score": 0, "creation_date": 1551303771, "post_id": 54892391, "comment_id": 96596201, "body": "Thanks for this approach, too.  I will try both and check for execution time.  I&#39;m doing a million iterations on the game, so this could be something to check."}], "tags": [], "owner": {"reputation": 526, "user_id": 8445453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/541d7baffe90e3416f8f9de0fc93ca9b?s=128&d=identicon&r=PG&f=1", "display_name": "Harvey Ellis", "link": "https://stackoverflow.com/users/8445453/harvey-ellis"}, "is_accepted": false, "score": 0, "last_activity_date": 1551207725, "creation_date": 1551207725, "answer_id": 54892391, "question_id": 54892234, "link": "https://stackoverflow.com/questions/54892234/multiple-coin-toss-in-excel-vba/54892391#54892391", "title": "Multiple Coin Toss in Excel VBA", "body": "<p>If you wanted just to simplify your statements a little bit you could use <code>Int(2 * Rnd())</code> instead:</p>\n\n<pre><code>CoinHeads = Int(2 * Rnd()) + Int(2 * Rnd()) + Int(2 * Rnd()) + Int(2 * Rnd())\n</code></pre>\n\n<p>Other than that you can segment the number of heads like @Comintern says in their comment.</p>\n"}, {"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1551211358, "creation_date": 1551211358, "answer_id": 54893219, "question_id": 54892234, "link": "https://stackoverflow.com/questions/54892234/multiple-coin-toss-in-excel-vba/54893219#54893219", "title": "Multiple Coin Toss in Excel VBA", "body": "<p>You should write a little function and pass the number of heads as parameter to generalize your code (here tossing head if the random number is larger than or equal to 0.5):</p>\n\n<pre><code>Public Function getNumberOfHeads(ByVal nb As Integer) As Integer\n    Dim nbHeads As Integer: nbHeads = 0\n    Randomize \n    For j = 0 To nb \n        If Rnd() &gt;= 0.5 Then nbHeads = nbHeads + 1\n    Next j\n    getNumberOfHeads = nbHeads\nEnd Function\n</code></pre>\n\n<p>And then you use it like this in your code:</p>\n\n<pre><code>numberOfHeads = getNumberOfHeads(4)\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8353582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STZmO.jpg?s=128&g=1", "display_name": "Mark Polczynski", "link": "https://stackoverflow.com/users/8353582/mark-polczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 531, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551257129, "creation_date": 1551206994, "last_edit_date": 1551257129, "question_id": 54892234, "link": "https://stackoverflow.com/questions/54892234/multiple-coin-toss-in-excel-vba", "title": "Multiple Coin Toss in Excel VBA", "body": "<p>In Excel VBA, I am tossing four coins and counting the number of heads.  The code I am using is:</p>\n\n<pre><code>CoinHeads = Int(Round(Rnd(), 0)) + Int(Round(Rnd(), 0)) + Int(Round(Rnd(), 0)) + Int(Round(Rnd(), 0))\n</code></pre>\n\n<p>This works, but I am wondering if there is a simpler way to do this in Excel VBA code that would still give me the same distribution of head counts from 0 to 4.  Thanks for any advice!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1551251330, "post_id": 54892160, "comment_id": 96567437, "body": "And what is the question, please?"}, {"owner": {"reputation": 5, "user_id": 8666879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4374aec88c7fb40a1c118a88d7d0d20f?s=128&d=identicon&r=PG&f=1", "display_name": "scubydu671", "link": "https://stackoverflow.com/users/8666879/scubydu671"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1551384526, "post_id": 54892160, "comment_id": 96631362, "body": "My question is at the end of the 4th paragraph. How can I code to allow this?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1551429747, "post_id": 54892160, "comment_id": 96644736, "body": "There is no other way than updating the table(s) behind, then requery the form as needed."}], "owner": {"reputation": 5, "user_id": 8666879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4374aec88c7fb40a1c118a88d7d0d20f?s=128&d=identicon&r=PG&f=1", "display_name": "scubydu671", "link": "https://stackoverflow.com/users/8666879/scubydu671"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594620473, "creation_date": 1551206731, "last_edit_date": 1594620473, "question_id": 54892160, "link": "https://stackoverflow.com/questions/54892160/how-to-display-table-values-for-a-single-event-multiple-rows-for-a-single-attri", "title": "How to display table values for a single event, multiple rows for a single attribute, in text boxes, as if I were using a crosstab query", "body": "<p>I have a form that should display a slope value for different transects on a plot, all tied to a single event, using different text boxes. </p>\n\n<p>For example: \nThere is a monitoring event record. The StandTransectSlope table has 3 rows for one EventID: slope for the UP (upper, ID=1) transect, slope for the BL (bottom left, ID=2) transect, slope for the BR (bottom right, ID=3) transect.</p>\n\n<p>I have 3 text boxes: one box to display the slope value for each of the transects (1-3).</p>\n\n<p>I did have a crosstab query behind this form so that I could, easily, assign those different slope values from each row by the transect name. But then I found out the crosstab query is not updateable. Users need to be able to add new data, as well as view data already entered. How can I code to allow this? </p>\n\n<p>Currently, I have the following code on the Form_Load event (I'll have to also add code for AfterUpdate for the form):</p>\n\n<pre><code>Private Sub Form_Load()\n\nDim ID As Integer\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim strSQL As String\n\nSet db = CurrentDb\n\nstrSQL = \"SELECT * FROM xrefCOMN_StandEventTransectSlope WHERE EventID =\" &amp; Me.EventID\n\nSet rs = db.OpenRecordset(strSQL)\n\n'Set values for slope text boxes by ID\nSelect Case ID\n    Case 1\n        Me.txtSlopeUP.Value = DLookup(\"Slope\", \"xrefCOMN_StandEventTransectSlope\", \"EventID=\" &amp; Me.EventID)\n    Case 2\n        Me.txtSlopeBR.Value = DLookup(\"Slope\", \"xrefCOMN_StandEventTransectSlope\", \"EventID=\" &amp; Me.EventID)\n    Case 3\n        Me.txtSlopeBL.Value = DLookup(\"Slope\", \"xrefCOMN_StandEventTransectSlope\", \"EventID=\" &amp; Me.EventID)\n    Case Else\n        'Nothing\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551209841, "post_id": 54892020, "comment_id": 96554888, "body": "Why not use comboboxes instead of textboxes?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551210291, "post_id": 54892020, "comment_id": 96555079, "body": "Shouldn&#39;t txtCantidad be <code>&lt;=</code>  to CantidadDisponible?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8370154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39cbb85f3cf72709d928079d2b559be2?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Santiago", "link": "https://stackoverflow.com/users/8370154/miguel-santiago"}, "edited": false, "score": 0, "creation_date": 1551209770, "post_id": 54892580, "comment_id": 96554860, "body": "Thanks, turns out I was just editing in an old sub because I changed the name and forgot. Will take a look as to how yours work tho."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1551210404, "last_edit_date": 1551210404, "creation_date": 1551208620, "answer_id": 54892580, "question_id": 54892020, "link": "https://stackoverflow.com/questions/54892020/how-to-check-if-quantity-is-more-or-less-on-a-table/54892580#54892580", "title": "How to check if quantity is more or less on a table?", "body": "<p>The FindFirst code should do exactly what you want. However, probably more efficient to filter the recordset. </p>\n\n<pre><code>Private Sub Cantidad_LostFocus()\n    Dim cant As Integer\n    If Not IsNull(Me.txtIDProd) Then\n        Set myDatabase = CurrentDb()\n        Set myRs = myDatabase.OpenRecordset(\"SELECT CantidadDisponible FROM TblProductos WHERE IDProducto=\" &amp; Me.txtIdProd, dbOpenDynaset)\n        cant = rs!CantidadDisponible\n    End If\n    Me.Label27.Visible = Me.txtCantidad &lt;= cant\nEnd Sub\n</code></pre>\n\n<p>Another approach that doesn't use recordset:</p>\n\n<p><code>Me.Label27.Visible = Me.txtCantidad &lt;= Nz(DLookup(\"CantidadDisponible\", \"TblProductos\", \"IDproducto=\" &amp; Nz(Me.txtIDProd,0)), 0)</code></p>\n\n<p>Note use of <code>&lt;=</code> and assumes <code>txtCantidad</code> will not have 0.</p>\n"}], "owner": {"reputation": 5, "user_id": 8370154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39cbb85f3cf72709d928079d2b559be2?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Santiago", "link": "https://stackoverflow.com/users/8370154/miguel-santiago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 54892580, "answer_count": 1, "score": 0, "last_activity_date": 1551210404, "creation_date": 1551206184, "last_edit_date": 1551208228, "question_id": 54892020, "link": "https://stackoverflow.com/questions/54892020/how-to-check-if-quantity-is-more-or-less-on-a-table", "title": "How to check if quantity is more or less on a table?", "body": "<p>I need to check if I have enough quantity of a specific product. How do I make it so the quantity that it checks is the one of the product in a textbox(txtIdProd).</p>\n\n<p>This is my code:</p>\n\n<pre><code>Private Sub Cantidad_LostFocus()\nSet myDatabase = CurrentDb()\nSet myRs = myDatabase.OpenRecordset(\"TblProductos\", dbOpenDynaset)\nDim cant As Integer\ncant = txtCantidad\nmyRs.FindFirst \"IDProducto=\" &amp; Me.txtIdProd\nIf myRs.NoMatch = False Then\n    If cant &gt; myRs(\"CantidadDisponible\") Then\n        Me.Label27.Visible = True\n    End If\nEnd If\nExit Sub\nMe.Label27.Visible = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1551205877, "post_id": 54891878, "comment_id": 96552975, "body": "What is your question ??"}, {"owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1551206264, "post_id": 54891878, "comment_id": 96553188, "body": "Sorry about that, edited for clarity."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1551206369, "post_id": 54891878, "comment_id": 96553247, "body": "Perhaps instead of strings, set them to <code>Range</code>? (<code>Set tagRef = Worksheets(&quot;Vessels Template (EDS)&quot;).Range(&quot;$B$1:$C$1&quot;)</code>, or whatever  Edit: Hang on - how are you going to use the result of this UDF, please give an example of how you&#39;ll call the VLOOKUP after you get the string."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1551206565, "post_id": 54891878, "comment_id": 96553345, "body": "Show your <code>VLOOKUP</code> formula.  My guess is that you did not enclose your string within the <code>INDIRECT</code> function."}], "answers": [{"comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1551207387, "post_id": 54892205, "comment_id": 96553758, "body": "Nice answer. Just an error <code>Dim tagRef As range, catRef As range</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1551208643, "post_id": 54892205, "comment_id": 96554296, "body": "Thanks for catching that. I hadn&#39;t planned to build a full test bench and missed that typo."}, {"owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "edited": false, "score": 0, "creation_date": 1551290923, "post_id": 54892205, "comment_id": 96590390, "body": "Thank you this worked perfectly. Out of curiosity is there any way to make the returned string back into a valid reference? I understand Indirect() would work if it only returned an address local to the worksheet but what about referencing different worksheets in the workbook?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11121185"}, "is_accepted": true, "score": 2, "last_activity_date": 1551208593, "last_edit_date": 1551208593, "creation_date": 1551206868, "answer_id": 54892205, "question_id": 54891878, "link": "https://stackoverflow.com/questions/54891878/method-to-use-a-udf-to-return-a-range-as-string-to-be-used-in-lookup-functions/54892205#54892205", "title": "Method to use a UDF to return a Range as String to be used in Lookup Functions", "body": "<p>To use the UDF 'in-line' inside another worksheet function, you need to Set the UDF to the range.</p>\n\n<pre><code>Public Function EquipCatRNG(tag As String, tagOrCatRef As String) as range\n\n'Hardcoded Category Ranges for Matches\nDim tagRef As range, catRef As range\nDim subfix As String\nsubfix = Left(tag, 1)\nSelect Case subfix\n    Case \"E\"\n        'Range for heat exchanger info, 'Heat Exchangers Template (EDS)'!$B$1:$J$53\n        Set tagRef = worksheets(\"Heat Exchangers Template (EDS)\").Range(\"B1:J1\")\n        Set catRef = worksheets(\"Heat Exchangers Template (EDS)\").Range(\"B1:B53\")\n    Case \"P\"\n        If InStr(tag, \"Drive\") &gt; 0 Then\n          Set tagRef = worksheets(\"Pumps And Drives Template (EDS)\").Range(\"B44:G44\")\n          Set catRef = worksheets(\"Pumps And Drives Template (EDS)\").Range(\"B44:B68\")\n        Else\n          Set tagRef = worksheets(\"Pumps And Drives Template (EDS)\").Range(\"B1:G1\")\n          Set catRef = worksheets(\"Pumps And Drives Template (EDS)\").Range(\"B1:B42\")\n        End If\n    Case \"T\"\n        'etc, etc, etc\n         ...\n\nEnd Select\n\n    tagOrCatRef = LCase(tagOrCatRef)\n    If tagOrCatRef = \"tag\" Then\n        Set EquipCatRNG = tagRef\n    Else\n        Set EquipCatRNG = catRef\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Used on a worksheet, this would look like,</p>\n\n<pre><code>=MATCH(\"abc\", EquipCatRNG(\"E\", \"Tag\"), 0)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 54892205, "answer_count": 1, "score": 0, "last_activity_date": 1551208593, "creation_date": 1551205534, "last_edit_date": 1551206228, "question_id": 54891878, "link": "https://stackoverflow.com/questions/54891878/method-to-use-a-udf-to-return-a-range-as-string-to-be-used-in-lookup-functions", "title": "Method to use a UDF to return a Range as String to be used in Lookup Functions", "body": "<p>For my problem, I have a UDF which accepts a string and using select case it then returns the string reference to the specified array. The return string is a reference to a sheet and range array in the following form: </p>\n\n<blockquote>\n  <p>'WorksheetExample'!$B$1:$E$44</p>\n</blockquote>\n\n<p>This UDF is nested within the VLookup/Match in my table to give the correct reference for that case. </p>\n\n<pre><code>Public Function EquipCatRNG(tag As String, tagOrCatRef As String)\n\n'Hardcoded Category Ranges for Matches\nDim tagRef, catRef As String\nDim subfix As String\nsubfix = Left(tag, 1)\nSelect Case subfix\n    Case \"E\"\n    'Range for heat exchanger info, 'Heat Exchangers Template (EDS)'!$B$1:$J$53\n    tagRef = \"'Heat Exchangers Template (EDS)'!$B$1:$J$1\"\n    catRef = \"'Heat Exchangers Template (EDS)'!$B$1:$B$53\"\n    Case \"P\"\n        If InStr(tag, \"Drive\") &gt; 0 Then\n        tagRef = \"'Pumps And Drives Template (EDS)'!$B$44:$G$44\"\n        catRef = \"'Pumps And Drives Template (EDS)'!$B$44:$B$68\"\n        Else\n        tagRef = \"'Pumps And Drives Template (EDS)'!$B$1:$G$1\"\n        catRef = \"'Pumps And Drives Template (EDS)'!$B$1:$B$42\"\n        End If\n    Case \"T\"\n        If InStr(tag, \"Internals\") &gt; 0 Then\n        tagRef = \"'Towers Template (EDS)'!$B$46:$E$46\"\n        catRef = \"'Towers Template (EDS)'!$B$46:$B$68\"\n        Else\n        tagRef = \"'Towers Template (EDS)'!$B$1:$E$1\"\n        catRef = \"'Towers Template (EDS)'!$B$1:$B$44\"\n        End If\n    Case \"R\"\n        tagRef = \"'Reactors Template (EDS)'!$B$1:$C$1\"\n        catRef = \"'Reactors Template (EDS)'!$B$1:$B$61\"\n    Case \"H\"\n        tagRef = \"'Heaters Template (EDS)'!$B$1:$C$1\"\n        catRef = \"'Heaters Template (EDS)'!$B$1:$B$45\"\n    Case \"V\"\n        If InStr(tag, \"Internals\") &gt; 0 Then\n        tagRef = \"'Vessels Template (EDS)'!$B$45:$F$45\"\n        catRef = \"'Vessels Template (EDS)'!$B$45:$B$64\"\n        Else\n        tagRef = \"'Vessels Template (EDS)'!$B$1:$F$1\"\n        catRef = \"'Vessels Template (EDS)'!$B$1:$B$43\"\n        End If\nEnd Select\n    tagOrCatRef = LCase(tagOrCatRef)\n    If tagOrCatRef = \"tag\" Then\n        EquipCatRNG = tagRef\n    Else\n        EquipCatRNG = catRef\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Any help is appreciated, I would also be fine with passing the Range directly from the UDF instead of returning a string and then performing some operation to utilize it in the formula. Thank you.</p>\n\n<p>EDIT for Clarity:\nThis function passes the String successfully but it is not working as a valid reference in the Vlookup/Match functions in my table. I need to know how I either: \n1. Perform a formula operation on the returned string post-UDF so that the Vlookup accepts it as a valid reference?\n2. Pass it initially as a range?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551208122, "post_id": 54891859, "comment_id": 96554075, "body": "Looks efficient enough to me. Why would you want &#39;more elaborate&#39;? And no, I don&#39;t think there is a form event that could accommodate."}, {"owner": {"reputation": 33, "user_id": 9017382, "user_type": "registered", "profile_image": "https://graph.facebook.com/1753841144917062/picture?type=large", "display_name": "Jin Zhen", "link": "https://stackoverflow.com/users/9017382/jin-zhen"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551232356, "post_id": 54891859, "comment_id": 96562423, "body": "just out of curiosity. never know when there would be a case where one have to check for a lot more conditions. lol"}], "answers": [{"comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1551234595, "post_id": 54892742, "comment_id": 96562954, "body": "And I should have remembered it. Nice."}, {"owner": {"reputation": 33, "user_id": 9017382, "user_type": "registered", "profile_image": "https://graph.facebook.com/1753841144917062/picture?type=large", "display_name": "Jin Zhen", "link": "https://stackoverflow.com/users/9017382/jin-zhen"}, "edited": false, "score": 0, "creation_date": 1551269044, "post_id": 54892742, "comment_id": 96577167, "body": "Hmm. I tried this on my file, there is a type mismatch (I have numbers and texts). I&#39;m sure this works when everything is the same type. I will see if I can change the data type of those variables in the statement to make it work."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 0, "last_activity_date": 1551209291, "creation_date": 1551209291, "answer_id": 54892742, "question_id": 54891859, "link": "https://stackoverflow.com/questions/54891859/ms-access-vba-efficient-way-to-enable-a-button-only-after-all-required-textboxe/54892742#54892742", "title": "MS Access VBA, efficient way to enable a button only after all required textboxes contains valid data", "body": "<p>Add the values of those 5 fields. If any of them is Null, the sum will be Null. So you only need call <code>IsNull()</code> once.</p>\n\n<pre><code>If IsNull(txtBatteryID + cmbModelNumber + cmbChemistryType + txtSpecVoltage + txtSpecCapacity) = False Then\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9017382, "user_type": "registered", "profile_image": "https://graph.facebook.com/1753841144917062/picture?type=large", "display_name": "Jin Zhen", "link": "https://stackoverflow.com/users/9017382/jin-zhen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 54892742, "answer_count": 1, "score": 0, "last_activity_date": 1551209570, "creation_date": 1551205436, "last_edit_date": 1551209570, "question_id": 54891859, "link": "https://stackoverflow.com/questions/54891859/ms-access-vba-efficient-way-to-enable-a-button-only-after-all-required-textboxe", "title": "MS Access VBA, efficient way to enable a button only after all required textboxes contains valid data", "body": "<p>My code is working, but I just want to know if there is a more efficient way to achieve the same effect.</p>\n\n<p>I have this layout in a form:</p>\n\n<p><img src=\"https://i.stack.imgur.com/tFj95.png\" alt=\"Form Layout\"></p>\n\n<p>In my effort to foolproof the record creation process, I would like to have the \"Save and Clear fields\" button enabled only after all but the 'Comment' textbox/combobox contains some valid data.</p>\n\n<p>The text/combo boxes are called txtBatteryID, cmbModelNumber, cmbChemistryType, txtSpecVoltage, txtSpecCapacity.</p>\n\n<p>My code is as follow</p>\n\n<pre><code>Private Sub EnableSaveBtnCheck()\n'this checks if the required fields contains valid data, if so, enables the save button.\n    If Me.btnSaveAndCLear.Enabled = False Then\n        If IsNull(txtBatteryID) = False And IsNull(cmbModelNumber) = False And IsNull(cmbChemistryType) = False And IsNull(txtSpecVoltage) = False And IsNull(txtSpecCapacity) = False Then\n            Me.btnSaveAndCLear.Enabled = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>As you can see, I did the most straightforward way of using AND to combine all must-have conditions in an IF statement. This sub is called in After_Update() event of each text/combo box. Like this:</p>\n\n<pre><code>Private Sub cmbChemistryType_AfterUpdate()\n    Call EnableSaveBtnCheck\nEnd Sub\n</code></pre>\n\n<p>My question, in the end, is: Is there a more efficient way to setup the condition \"all text/combo box need to have something valid in them\"? And is there a more elaborate way to check if the condition is met (something  like a event on the form itself)?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1551205445, "post_id": 54891840, "comment_id": 96552774, "body": "Is that marco assigned to a button on  a sheet?"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1551218925, "post_id": 54891840, "comment_id": 96558881, "body": "Does the old connection to Tool_test.xlsm still exist in your list of connections (Data menu&gt;&gt;Connections&gt;&gt;Connections)? If so, delete it."}, {"owner": {"reputation": 23, "user_id": 11118221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13fafd55de3bbb7a26404a0988e9ed46?s=128&d=identicon&r=PG&f=1", "display_name": "HulkYoda", "link": "https://stackoverflow.com/users/11118221/hulkyoda"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1551257012, "post_id": 54891840, "comment_id": 96569827, "body": "@Gserg yes, the macro is assigned to a button on a sheet."}, {"owner": {"reputation": 23, "user_id": 11118221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13fafd55de3bbb7a26404a0988e9ed46?s=128&d=identicon&r=PG&f=1", "display_name": "HulkYoda", "link": "https://stackoverflow.com/users/11118221/hulkyoda"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1551257976, "post_id": 54891840, "comment_id": 96570341, "body": "@MBB70 There was nothing in Data &gt; connections. But thinking of your comment, I started checking every connectivity of all the objects within the workbook and figured out the issue! Thank you! (sorry my rep is too low to upvote comments!)"}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1551307523, "post_id": 54901484, "comment_id": 96597631, "body": "Mark your answer as the answer and give yourself some points...I think that&#39;s how it works anyway :)."}], "tags": [], "owner": {"reputation": 23, "user_id": 11118221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13fafd55de3bbb7a26404a0988e9ed46?s=128&d=identicon&r=PG&f=1", "display_name": "HulkYoda", "link": "https://stackoverflow.com/users/11118221/hulkyoda"}, "is_accepted": true, "score": 2, "last_activity_date": 1551259439, "last_edit_date": 1551259439, "creation_date": 1551257774, "answer_id": 54901484, "question_id": 54891840, "link": "https://stackoverflow.com/questions/54891840/thisworkbook-refreshall-referring-to-the-previous-file-name/54901484#54901484", "title": "ThisWorkbook.RefreshAll referring to the previous file name", "body": "<p>Update:</p>\n\n<p>The issue was not the code.</p>\n\n<p>The issue was that the pivot tables maintained its old reference even when the name of the file was changed. Solution was to select pivot > analyze > change data source >  re-assign the range. </p>\n\n<p>If you plan to change the name of the file often, I guess it's better to make a macro to reproduce the pivot table or to update the range reference manually.</p>\n\n<p>Please consider this issue resolved! And thank you for the comments!</p>\n"}], "owner": {"reputation": 23, "user_id": 11118221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13fafd55de3bbb7a26404a0988e9ed46?s=128&d=identicon&r=PG&f=1", "display_name": "HulkYoda", "link": "https://stackoverflow.com/users/11118221/hulkyoda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 54901484, "answer_count": 1, "score": 0, "last_activity_date": 1551259439, "creation_date": 1551205358, "question_id": 54891840, "link": "https://stackoverflow.com/questions/54891840/thisworkbook-refreshall-referring-to-the-previous-file-name", "title": "ThisWorkbook.RefreshAll referring to the previous file name", "body": "<p>I'm finalizing this macro, so I changed my file name from \"Tool_<strong>test</strong>.xlsm\" to \"Tool_<strong>Final</strong>.xlsm.\"</p>\n\n<p>Then I noticed something weird happening. Every module that has this code:</p>\n\n<pre><code>Thisworkbook.RefreshAll\n</code></pre>\n\n<p>opens a dialogue box \"Sorry, we couldn't find '...<em>filepath</em>...\\Tool_<strong>test</strong>.xlsm.' Which is the old file path/name.</p>\n\n<p>one of the modules is the following at its entirety:</p>\n\n<pre><code>Sub Clear_All()\n\nIf MsgBox(\"Erase all the data imported?\", vbYesNo) = vbNo Then Exit Sub\n\nSheets(\"Doc. Currency\").Range(\"C135:N200\").ClearContents\nSheets(\"Auto19\").Range(\"A3:H531\").ClearContents\nSheets(\"F08\").Range(\"A2:E201\").ClearContents\n\nThisWorkbook.RefreshAll\n\nEnd Sub\n</code></pre>\n\n<p>Nothing more. Why does it keep refer to the old file?\n\"Thisworkbook.\" works fine everywhere, including in this module when I tested it. It seems \"refreshall\" is what's causing the problem, but I can't seem to figure out why.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1551219394, "post_id": 54891801, "comment_id": 96559072, "body": "Try adding <code>AppActivate Title:=ThisWorkbook.Application.Caption</code> before your &#39;HideRibbon&#39; command"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1551261721, "post_id": 54891801, "comment_id": 96572649, "body": "Please see the comments to this answer: <a href=\"https://stackoverflow.com/a/39310260/10908769\">stackoverflow.com/a/39310260/10908769</a>"}], "owner": {"reputation": 1, "user_id": 11121004, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eXsnoxI0E9E/AAAAAAAAAAI/AAAAAAAAAAA/9IF7wTLv8es/photo.jpg?sz=128", "display_name": "nixa011", "link": "https://stackoverflow.com/users/11121004/nixa011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551205396, "creation_date": 1551205191, "last_edit_date": 1551205396, "question_id": 54891801, "link": "https://stackoverflow.com/questions/54891801/how-to-hide-ribbon-with-on-event-macro-in-excel", "title": "How to hide ribbon with on event macro in excel?", "body": "<p>I have been trying to hide a ribbon automatically when opening the workbook with this code</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Application.CommandBars.ExecuteMso \"HideRibbon\"\n\nEnd Sub\n</code></pre>\n\n<p>It is not working as on-event open workbook but it is working when i press F5, any advice? \n'</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1551202046, "post_id": 54890995, "comment_id": 96551028, "body": "Can you please <a href=\"https://stackoverflow.com/posts/54890995/edit\">edit your question</a> to provide us with the first image? What you have tried so far and how it failed to achieve the desired result would also be useful"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1551202823, "post_id": 54890995, "comment_id": 96551436, "body": "<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1551202964, "post_id": 54890995, "comment_id": 96551511, "body": "<a href=\"https://www.youtube.com/watch?v=rscXNUlRsH0\" rel=\"nofollow noreferrer\">Unstacking data in Excel</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1551202896, "creation_date": 1551202896, "answer_id": 54891265, "question_id": 54890995, "link": "https://stackoverflow.com/questions/54890995/move-cell-value-on-alternate-rows-to-next-row-and-delete-empty-row-using-vba-exc/54891265#54891265", "title": "Move cell value on alternate rows to next row and delete empty row using VBA/Excel", "body": "<p>Assuming Participants is column A, put this formula in A1 and drag down.</p>\n\n<pre><code> =IF(ISNUMBER(LEFT(B1,1)), OFFSET(B1,-1,0),\"\")\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8760422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63fa78fa3fbbff7873aba32ba4227925?s=128&d=identicon&r=PG&f=1", "display_name": "Buzoka", "link": "https://stackoverflow.com/users/8760422/buzoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1551210274, "creation_date": 1551201962, "last_edit_date": 1551210274, "question_id": 54890995, "link": "https://stackoverflow.com/questions/54890995/move-cell-value-on-alternate-rows-to-next-row-and-delete-empty-row-using-vba-exc", "title": "Move cell value on alternate rows to next row and delete empty row using VBA/Excel", "body": "<p><a href=\"https://i.stack.imgur.com/tTFXs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tTFXs.png\" alt=\"User Selection Before processing\"></a>\n<a href=\"https://i.stack.imgur.com/4jTdm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4jTdm.png\" alt=\"Selection After processing\"></a></p>\n\n<p>Based on the images above I want to be a to select a range that looks like the first image dynamically and process it into the layout of the second image.</p>\n\n<p>Below is some code i have tried to execute to do this dynamically.</p>\n\n<pre><code>Dim Myrange As Range\nDim Myrow As Range\nSet Myrange = Selection\nDim strVal As String\n\nFor Each Myrow In Myrange.Rows\nIf Myrow.Row Mod 2 = 0 Then\nstrVal = Myrow.Columns(1).Cells\nMyrow.Columns(1).Value = \"\"\nMyrow.Offset(1, -1).Value = strVal\nEnd If\nNext Myrow\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/06aBW.png\" rel=\"nofollow noreferrer\">Undesired result</a></p>\n\n<p>The last image is what i get when selection is processed.\nThree cells instead of one are replaced with the values on previous row. </p>\n"}, {"tags": ["vba", "ms-word", "shared", "drive"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "edited": false, "score": 0, "creation_date": 1551212320, "post_id": 54892056, "comment_id": 96555954, "body": "When I do that and they open up the dotm, the code I have in the document open event doesn&#39;t work, subsequently, the userform isn&#39;t called. This did fix the multiple hands in the cookie jar problem though. - Well, it&#39;s selectively calling. Weird. Sometimes it&#39;ll pop up the enable macros banner and when enabled, call it, but now it isn&#39;t. Very sporadic."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "edited": false, "score": 1, "creation_date": 1551220486, "post_id": 54892056, "comment_id": 96559438, "body": "@BrandonLewallen No one should <i>open</i> the dotm, they should be creating new documents from it. Any code you have that should run at that time needs to be in the &quot;New&quot; event (or AutoNew macro). Double-clicking on a dotm or selecting it in File/New will create a new document."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "edited": false, "score": 0, "creation_date": 1551292146, "post_id": 54892056, "comment_id": 96590967, "body": "@BrandonLewallen Has your original question now been answered?"}, {"owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "edited": false, "score": 0, "creation_date": 1551454191, "post_id": 54892056, "comment_id": 96658154, "body": "Partially it has, it allows them all to access it, but for whatever reason, when the file is then saved as a pdf, and subsequently closed, the vba project stays &quot;active&quot; so when they go to open/create new document again from the template, it has the old information stored in the userform or it won&#39;t execute the &quot;on document open event&quot;"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "edited": false, "score": 0, "creation_date": 1551456241, "post_id": 54892056, "comment_id": 96659369, "body": "The original question is about allowing multiple users to be able to save these documents. If that is answered, then it&#39;s time to mark this question as such and open a new one with the altered background information and code. From the current perspective there&#39;s not enough information to deal with the problems cropping up from the changes that have been made when moving to a template environment. We&#39;d need to see all the code involved."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "edited": false, "score": 0, "creation_date": 1551456268, "post_id": 54892056, "comment_id": 96659383, "body": "Also, make sure the documents (not the pdf) are actually being closed - probably without changes if you&#39;re only interested in the PDFs? And, again, when creating a new document an OPEN event will NOT fire. A NEW event is required."}, {"owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "edited": false, "score": 0, "creation_date": 1551470856, "post_id": 54892056, "comment_id": 96665946, "body": "I&#39;ve updated it to show that your response was the answer. I believe the New event helped fix the other issue I was experiencing. I appreciate your help."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1551206306, "creation_date": 1551206306, "answer_id": 54892056, "question_id": 54890320, "link": "https://stackoverflow.com/questions/54890320/local-copy-of-word-document-loaded-from-shared-drive-not-working-with-vba-saveas/54892056#54892056", "title": "Local copy of word document loaded from shared drive not working with VBA saveas PDF method. Doesn&#39;t save the document", "body": "<p>Use a template (dotm), not a document. Create new documents from the template, that way there will be no document \"lock\". </p>\n\n<p>Also, don't use <code>ThisDocument</code>as that means specifically the document in which the VBA code is located, use <code>ActiveDocument</code>, instead.</p>\n"}], "owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 54892056, "answer_count": 1, "score": 0, "last_activity_date": 1551206306, "creation_date": 1551199524, "last_edit_date": 1551206161, "question_id": 54890320, "link": "https://stackoverflow.com/questions/54890320/local-copy-of-word-document-loaded-from-shared-drive-not-working-with-vba-saveas", "title": "Local copy of word document loaded from shared drive not working with VBA saveas PDF method. Doesn&#39;t save the document", "body": "<p>I have a macro that works fine in the shared drive when it is only accessed by one/first person. When it is accessed by the second person while the first person still has it open, it says it's already open. When I click \"create a local copy and merge changes later\" the macro will work up until it saves the file.</p>\n\n<p>The macro basically invokes a userform to collect information, fill in the document, and then it should save the document as a PDF to the desktop. The PDF isn't saving in the local copy version for some reason. When the \"Follow hyperlink\" comes up, it says \"Error 4198, command failed\". I check my desktop and the file isn't there, leading me to believe that this error is in relation to the file not being created.... </p>\n\n<p>I just need the macro to allow the document to be saved to their desktop as a pdf, whether they're in the normal version, or the local copy created as a byproduct of the shared drive rules.</p>\n\n<pre><code>Main_Form.hide\nenviro = CStr(Environ(\"USERPROFILE\"))\nsName = Format(Date, \"mm-dd-yyyy\") &amp; \" Denial Letter - Invoice \" &amp; Invoice_Text.Value &amp; \".pdf\"\nsPath = enviro &amp; \"\\Desktop\\\"\nThisDocument.SaveAs2 FileName:=sPath &amp; sName, fileformat:=wdFormatPDF\nfullName = sPath &amp; sName\n\nThisDocument.FollowHyperlink fullName\nActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1551199415, "post_id": 54890179, "comment_id": 96549591, "body": "Have you tried <code>Redim Preserve arr(FileMissing)</code> ?"}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1551199484, "post_id": 54890179, "comment_id": 96549633, "body": "Secondly, edit your post to show the issues with the MsgBox. Great hint is to use Win+Shift+S to capture the area, and click the Add Image button in your post, and just paste!"}, {"owner": {"reputation": 35, "user_id": 11120396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e479c29ffa937e196823486e488079c?s=128&d=identicon&r=PG&f=1", "display_name": "cording12", "link": "https://stackoverflow.com/users/11120396/cording12"}, "reply_to_user": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 1, "creation_date": 1551199966, "post_id": 54890179, "comment_id": 96549906, "body": "Thanks for the tip Badja - have added screenshots now! Didn&#39;t realise I could do that. Will give you&#39;re suggestion a try now too"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11120396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e479c29ffa937e196823486e488079c?s=128&d=identicon&r=PG&f=1", "display_name": "cording12", "link": "https://stackoverflow.com/users/11120396/cording12"}, "edited": false, "score": 1, "creation_date": 1551200163, "post_id": 54890358, "comment_id": 96550025, "body": "This worked perfectly! Thank you SO much. Looks like I was just overcomplicating things once I had an idea in my head and honed in on it!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1551199651, "creation_date": 1551199651, "answer_id": 54890358, "question_id": 54890179, "link": "https://stackoverflow.com/questions/54890179/how-to-get-this-array-code-to-output-into-my-message-box-correctly/54890358#54890358", "title": "How to get this array code to output into my message box correctly?", "body": "<p>Since you just use that array to <code>Join</code> it later you could also just use a <code>String</code> variable <code>MyMissingFiles</code> instead of that array and append the file name.</p>\n\n<p>You even don't need to count the files in <code>File_Missing</code> if this number is not of your interest.</p>\n\n<pre><code>Dim MyMissingFiles As String\n\nIf Not Dir(i, vbDirectory) = vbNullString Then\n    Workbooks.Open (i)\n    Windows(j).Visible = False\nElse\n    MyMissingFiles = MyMissingFiles &amp; vbCrLf &amp; \"Lux file\"\nEnd If\n\n' \u2026 all the others accordingly here \u2026\n\nIf MyMissingFiles &lt;&gt; vbNullString Then\n    MsgBox (\"The following files could not be found. Please check the file paths and try again\" &amp; MyMissingFiles)\nElse\n    MsgBox \"Files opened successfully.\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11120396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e479c29ffa937e196823486e488079c?s=128&d=identicon&r=PG&f=1", "display_name": "cording12", "link": "https://stackoverflow.com/users/11120396/cording12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 54890358, "answer_count": 1, "score": 1, "last_activity_date": 1551200060, "creation_date": 1551199072, "last_edit_date": 1551200060, "question_id": 54890179, "link": "https://stackoverflow.com/questions/54890179/how-to-get-this-array-code-to-output-into-my-message-box-correctly", "title": "How to get this array code to output into my message box correctly?", "body": "<p>I have a spreadsheet that users can interact with to specify the file path to 4 different files needed to be opened to run some macros. The code includes a check to see if the file path they have entered is valid or not (works excellently). However, what I want to do is have a message box appear if anything doesn't work and then also tell the user which one didn't work.</p>\n\n<p>My code does do that perfectly (albeit in I think a quite convoluted way) however as the array is set to have 4 values it means if the final file isn't present, it starts the text 4 lines down in the message box instead of at the top. </p>\n\n<p>What I want to do, I believe, is <code>ReDim</code> the array to only the amount of files missing so that the <code>MsgBox</code> isn't 3 empty lines below the first sentence. I've kinda figured that bit out but I just could not get it working properly and now I am stumped. </p>\n\n<pre><code>Sub Open_month_0()\n\nOn Error GoTo ErrHand\n\nThisWorkbook.ActiveSheet.Calculate\n\n    Dim i As String\n    Dim j As String\n    Dim k As String\n    Dim l As String\n    Dim m As String\n    Dim n As String\n    Dim o As String\n    Dim p As String\n    Dim arr(4) As Variant\n    Dim File_Missing As Integer\n\n    'Used as a counter to prompt either an error or successful result\n    File_Missing = 0\n\n        i = Range(\"LUX_Full_file_path\")\n        j = Range(\"LUX_Full_file_name\")\n\n        k = Range(\"JUP_Full_file_path_M\")\n        l = Range(\"JUP_Full_file_name_M\")\n\n        m = Range(\"JUP_Full_file_path_Q\")\n        n = Range(\"JUP_Full_file_name_Q\")\n\n        o = Range(\"JUP_Full_file_path_A\")\n        p = Range(\"JUP_Full_file_name_A\")\n\n        'The if not's check to see if the file path is valid. If it isn't, gets added to array and File_missing begins\n        If Not Dir(i, vbDirectory) = vbNullString Then\n            Workbooks.Open (i)\n            Windows(j).Visible = False\n        Else\n            arr(1) = \"Lux file\"\n            File_Missing = File_Missing + 1\n        End If\n\n        If Not Dir(k, vbDirectory) = vbNullString Then\n            Workbooks.Open (k)\n            Windows(l).Visible = False\n        Else\n            arr(2) = \"Monthly file\"\n            File_Missing = File_Missing + 1\n        End If\n\n        If Not Dir(m, vbDirectory) = vbNullString Then\n            Workbooks.Open (m)\n            Windows(n).Visible = False\n        Else\n            arr(3) = \"Quarterly file\"\n            File_Missing = File_Missing + 1\n        End If\n\n        If Not Dir(o, vbDirectory) = vbNullString Then\n            Workbooks.Open (o)\n            Windows(p).Visible = False\n        Else\n            arr(4) = \"Annual file\"\n            File_Missing = File_Missing + 1\n        End If\n\n        'Basic error handling procedure that retains function.\n        If File_Missing &gt; 0 Then\n            MsgBox (\"The following files could not be found. Please check the file paths and try again\" &amp; vbCrLf &amp; Join(arr, vbCrLf))\n        Else\n            MsgBox \"Files opened successfully.\"\n        End If\n\nExit Sub\n\nErrHand: MsgBox \"There has been a critical error with opening the chosen workbooks. If the problem persists, please contact your administrator for assistance.\"\n\nEnd Sub\n</code></pre>\n\n<p>Edit with pictures:</p>\n\n<p><strong>A screenshot of the message box current output</strong><br>\n<a href=\"https://i.stack.imgur.com/j9RqL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j9RqL.png\" alt=\"A screenshot of the message box current output\"></a></p>\n\n<p><strong>How I'd like the message box to look</strong><br>\n<a href=\"https://i.stack.imgur.com/I5a7t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I5a7t.png\" alt=\"How I&#39;d like the message box to look\"></a></p>\n"}]