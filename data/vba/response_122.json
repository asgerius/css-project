[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1494486376, "post_id": 43904536, "comment_id": 74850565, "body": "David Zemens, I have not been able to test your solution yet. However, I failed to mention in my initial thread that it would be for a dual screen setup (thank you for reminding me). Hence, it would need to work when my excel sheet was in the right monitor and my desktop view would be in the left. Could you please advise?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1494491313, "post_id": 43904536, "comment_id": 74853712, "body": "use SendKeys for both monitors, instead of keybd_event. otherwise all code remains the same"}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495030775, "post_id": 43904536, "comment_id": 75081320, "body": "David Zemens,   I apologise for my late acknowledgement of your solution. If you have time: Every time I execute the above code (using sendkeys for the left monitor screenshot), the screenshot only refreshes the content on the left monitor after the button has been clicked twice. I.e the macro is not refreshing with the new left screen content until I do two clicks (I would like a single click for a new screenshot). It captures the old content. Is there a way to reset the macro&#39;s state every time the button is clicked so that I am always given the most current information on my screen?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495031703, "post_id": 43904536, "comment_id": 75082082, "body": "Not sure I understand the problem but try adding <code>Application.CutCopyMode = False</code> at the beginning of the macro, this should clear the clipboard in Excel. If that doesn&#39;t do it, which of the two monitors is <i>primary</i>? (There is not really a &quot;left&quot; or &quot;right&quot;, just a primary and secondary, which are oriented left &amp; right)"}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495032641, "post_id": 43904536, "comment_id": 75082845, "body": "David Zemens, &quot;Primary&quot; is the left monitor i.e the view which I want to capture screenshot info from. &quot;Secondary&quot; is right i.e the excel file view that I want the screenshot to be pasted into when I click the screenshot button. The contents of the clipboard does not refresh after each button click. It takes two button clicks for the new content in the Primary screen to be captured. I hope this is clearer. I tried your solution within the module sub at the top and also within the sheet sub I use to execute the module. Neither worked. Does this make sense? Thanks."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495032738, "post_id": 43904536, "comment_id": 75082930, "body": "Is there an application on the left monitor or are you just trying to screenshot an empty desktop?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495033269, "post_id": 43904536, "comment_id": 75083369, "body": "If you&#39;re trying to capture a specific application, it might be easy. If you need the entire desktop of that monitor, maybe more difficult."}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495034079, "post_id": 43904536, "comment_id": 75083969, "body": "It&#39;s information on the left monitor view i.e print screens of data from other applications that are not excel. The button is quicker than using the snipping tool. I want it instead of snipping tool. The above code works perfectly and crops the primary monitor to the view frame I need (i.e cropBottom). The only issue I am having is that the code currently requires me to click the excel button twice in order to get the latest primary monitor desktop view (it pastes the old, then I click again and it pastes the new correct one). I want it to refresh and capture a new screenshot with 1 click."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495034356, "post_id": 43904536, "comment_id": 75084190, "body": "ok yes I&#39;m sweing the same problem too. is it more than one application you&#39;re trying to copy?"}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495034554, "post_id": 43904536, "comment_id": 75084325, "body": "Yes. The excel file is going to be open throughout the whole process. I am going to constantly be pulling up new information onto my primary view which I will then repeatedly need to print screen into my excel file. So the macro needs to always refresh to capture the latest view when the button is clicked. If this thread is too long feel free to PM me."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495034743, "post_id": 43904536, "comment_id": 75084467, "body": "I&#39;m trying to understand whether you actually <i>need</i> to capture the ENTIRE monitor or only specific Application(s) from the monitor."}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495035052, "post_id": 43904536, "comment_id": 75084707, "body": "rather than APPLICATIONS I would use the term view. The macro is not interacting with any external application. It is only taking a print screen as one would do normally using snipping tool or MS paint. The crop function you suggested allowed me to scale and remove unnecessary info from the rest of the view such as taskbar etc. I only NEED to capture say a 1000x1000 view (because the info I need is encapsulated in that part of desktop view). I will manually alter the macro to suit the view needed. More pressing is the lack of screen refresh, not the view itself. Thanks."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495035766, "post_id": 43904536, "comment_id": 75085223, "body": "can you answer the question? doesn&#39;t matter if the macro doesn&#39;t interact with other apps. I want to know which app(s) you need to capture in the screenshot... sure, a 1000x1000 square might encapsulate these, but i think it might be stupid-easy to capture a specific app, and that&#39;s why I keep pressing you to answer this question... please assume I know what I&#39;m doing and I am asking questions with purpose :)"}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495035954, "post_id": 43904536, "comment_id": 75085354, "body": "Sure, the application is software called Olympic as well as some word document, other excel files and PDF&#39;s. Basically, a variation of applications. I want to be able to extend functionality to future apps and other items in view that I may not have necessarily covered in this list."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495036154, "post_id": 43904536, "comment_id": 75085526, "body": "ok sure so you&#39;re trying to get them all at once so a screenshot of the monitor is pronably better than trying to cap each app separately. I have an idea but not at computer to test it yet, it will involve using the other method, not SendKeys. otherwise I don&#39;t know why the clipboard isn&#39;t copying correctly, I tried 2 or 3 things you force it but none working correctly..."}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495036387, "post_id": 43904536, "comment_id": 75085704, "body": "Sorry, I may have miscommunicated. The view generated by the button will only be a specific segment from within a single chosen app. I will not have multiple applications in a view at one time. The views im capturing are evidence files for a report hence the snapshots are specific areas. I will be expanding my excel to include a button for each type of screenshot located in different areas of an excel file. i.e scaling up once I have a working screenshot button macro that properly refreshes the screen. It is nearly there, it just needs to refresh to the current view with each click. Thanks."}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495059741, "post_id": 43904536, "comment_id": 75098038, "body": "Thank you for updating the thread David. I will test this solution tomorrow and let you know."}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495098286, "post_id": 43904536, "comment_id": 75112282, "body": "This works. However, I attempted to use shp.TopLeftCell to position the screen capture and it failed. I&#39;d like the top left of the <i>screenshot</i> to be on whichever cell I click. Something like shp.ActiveCell.Paste or ActiveCell.Paste but with several attempts of syntax this has failed. I can begin this as a new thread if required since you technically answered my original question."}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495099112, "post_id": 43904536, "comment_id": 75112860, "body": "Example:   Dim MyCell As Range.  Set MyCell = ActiveCell.      This works but the active cell is a distance of h(?) away from the top left of the image because of the crop. So it pastes the image h distance away from whichever active cell is selected."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495104924, "post_id": 43904536, "comment_id": 75116872, "body": "crop the image BEFORE you set its position on the sheet. The shadow doesn&#39;t get &quot;locked&quot; to that location, so if you place it there and then crop it, it will naturally no longer align with that position... <code>Set shp.TopLeftCell = AcriveCell.</code>"}, {"owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495118981, "post_id": 43904536, "comment_id": 75127490, "body": "Set shp.TopLeftCell = ActiveCell brings up invalid use of property when compiling (at any location within my code). I removed MyCell as a variable and tested that statement alone."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "edited": false, "score": 0, "creation_date": 1495119691, "post_id": 43904536, "comment_id": 75128071, "body": "Get rid of <code>set</code> keyword in that case. I don&#39;t mean to be rude, but so much of this is stuff that you need to learn how to troubleshoot on your own and I simply can&#39;t keep answering every tiny one-off question you have pertaining to this implementation. Google is your friend. Find the object model reference, study it, start there, and look for similar Q&#39;s on this forum if you get stuck."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 12, "last_activity_date": 1495041041, "last_edit_date": 1495041041, "creation_date": 1494461801, "answer_id": 43904536, "question_id": 43904385, "link": "https://stackoverflow.com/questions/43904385/using-excel-vba-macro-to-capture-save-screenshot-of-specific-area-in-same-file/43904536#43904536", "title": "Using Excel VBA Macro To Capture + Save Screenshot of Specific Area In Same File", "body": "<h1><a href=\"http://wordmvp.com/FAQs/MacrosVBA/PrtSc.htm\" rel=\"noreferrer\">Without using <code>SendKeys</code></a></h1>\n\n<pre><code>Option Explicit\n\nPrivate Declare Sub keybd_event Lib \"user32\" (ByVal bVk As Byte, ByVal _\n  bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)\n\nPrivate Const VK_SNAPSHOT = &amp;H2C\n\nSub PrintScreen()\n    keybd_event VK_SNAPSHOT, 1, 0, 0\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>However, with this approach if you are using multiple monitors, it will only capture the <em>active</em> monitor, so further effort needs to be made if you need to capture the other monitor (this can probably be done with API calls but I haven't gotten that far).</p>\n\n<p>NB: The <code>AppActivate</code> statement can be used to activate another (non-Excel) application and if you do this, then the <code>keybd_event</code> function will <em>only</em> capture that application, e.g;</p>\n\n<pre><code>AppActivate \"Windows Command Processor\" 'Modify as needed\nkeybd_event VK_SNAPSHOT, 1, 0, 0\nActiveSheet.Paste\n</code></pre>\n\n<h1>Using <code>SendKeys</code>, Problem Solved:</h1>\n\n<p>While <code>SendKeys</code> is notoriously flaky, if you need to use this method due to limiations of the API method described above, you might have some problems. As we both observed, the call to <code>ActiveSheet.Paste</code> was not actually pasting the Print Screen, but rather it was pasting whatever was previously in the Clipboard queue, to the effect that you needed to click your button to call the macro <em>twice</em>, before it would actually paste the screenshot. </p>\n\n<p>I tried a few different things to no avail, but overlooked the obvious: While debugging, if I put a breakpoint on <code>ActiveSheet.Paste</code>, I was no longer seeing the problem described above!</p>\n\n<p><a href=\"https://i.stack.imgur.com/tERV9.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/tERV9.png\" alt=\"enter image description here\"></a></p>\n\n<p>This tells me that the <code>SendKeys</code> is not processed fast enough to put the data in the Clipboard before the next line of code executes, to solve that problem there are two possible solutions.</p>\n\n<ol>\n<li>You could try <code>Application.Wait</code>. This method seems to work when I test it, but I'd caution that it's also unreliable.</li>\n<li>A better option would be\n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg264522.aspx\" rel=\"noreferrer\"><code>DoEvents</code></a>,\nbecause it's explicitly designed to handle this sort of thing:</li>\n</ol>\n\n<blockquote>\n  <p><strong>DoEvents</strong> passes control to the operating system. Control is returned after the operating system has finished processing the events in its queue and all keys in the <strong>SendKeys</strong> queue have been sent.</p>\n</blockquote>\n\n<p>This works for me whether I run the macro manually from the IDE, from the Macros ribbon, or from a button <code>Click</code> event procedure:</p>\n\n<pre><code>Option Explicit\nSub CopyScreen()\n\nApplication.SendKeys \"({1068})\", True\nDoEvents\nActiveSheet.Paste\n\nDim shp As Shape\nWith ActiveSheet\n    Set shp = .Shapes(.Shapes.Count)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<h1>How To Position, Resize &amp; Crop the Image:</h1>\n\n<p>Regardless of which method you use, once the picture has been pasted using <code>ActiveSheet.Paste</code> it will be a Shape which you can manipulate.</p>\n\n<p><strong>To Resize:</strong> once you have a handle on the shape, just assign its <code>Height</code> and <code>Width</code> properties as needed:</p>\n\n<pre><code>Dim shp As Shape\nWith ActiveSheet\n    Set shp = .Shapes(.Shapes.Count)\nEnd With\nshp.Height = 600\nshp.Width = 800\n</code></pre>\n\n<p><strong>To Position It:</strong> use the shape's <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195021.aspx\" rel=\"noreferrer\"><code>TopLeftCell</code> property</a>.</p>\n\n<p><strong>To Crop It:</strong> use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff860761.aspx\" rel=\"noreferrer\"><code>shp.PictureFormat.Crop</code></a> (and/or <code>CropLeft</code>, <code>CropTop</code>, <code>CropBottom</code>, <code>CropRight</code> if you need to fine-tune what part of the screenshot is needed. For instance, this crops the pasted screenshot to 800x600:</p>\n\n<pre><code>Dim h As Single, w As Single\nh = -(600 - shp.Height)\nw = -(800 - shp.Width)\n\nshp.LockAspectRatio = False\nshp.PictureFormat.CropRight = w\nshp.PictureFormat.CropBottom = h\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8414, "user_id": 2249175, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XGc78.png?s=128&g=1", "display_name": "Paul Kertscher", "link": "https://stackoverflow.com/users/2249175/paul-kertscher"}, "edited": false, "score": 1, "creation_date": 1508762623, "post_id": 46889530, "comment_id": 80726480, "body": "Could you please elaborate <i>how</i> and <i>why</i> this solves the OPs issue?"}, {"owner": {"reputation": 11, "user_id": 8819254, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213588656488001/picture?type=large", "display_name": "Jon Kepa Uriarte", "link": "https://stackoverflow.com/users/8819254/jon-kepa-uriarte"}, "reply_to_user": {"reputation": 8414, "user_id": 2249175, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XGc78.png?s=128&g=1", "display_name": "Paul Kertscher", "link": "https://stackoverflow.com/users/2249175/paul-kertscher"}, "edited": false, "score": 0, "creation_date": 1508840444, "post_id": 46889530, "comment_id": 80762579, "body": "It should be modified, i just tried to offer another way to capture a screenshot of a selected range as a picture instead of using &quot;sendkeys&quot;."}], "tags": [], "owner": {"reputation": 11, "user_id": 8819254, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213588656488001/picture?type=large", "display_name": "Jon Kepa Uriarte", "link": "https://stackoverflow.com/users/8819254/jon-kepa-uriarte"}, "is_accepted": false, "score": 0, "last_activity_date": 1508762409, "last_edit_date": 1508762409, "creation_date": 1508762076, "answer_id": 46889530, "question_id": 43904385, "link": "https://stackoverflow.com/questions/43904385/using-excel-vba-macro-to-capture-save-screenshot-of-specific-area-in-same-file/46889530#46889530", "title": "Using Excel VBA Macro To Capture + Save Screenshot of Specific Area In Same File", "body": "<pre><code>Sub SavePicToFile(namefile)\n Selection.CopyPicture xlScreen, xlBitmap\n Application.DisplayAlerts = False\n Set tmp = Charts.Add\n On Error Resume Next\n With tmp\n    .SeriesCollection(1).Delete\n    .Width = Selection.Width\n    .Height = Selection.Height\n    .Paste\n    .Export filename:=namefile, Filtername:=\"jpeg\"\n    .Delete\n End With\nEnd Sub\nfoto = Application.ActiveWorkbook.Path &amp; \"\\Foto\" &amp; \".jpeg\"\nActiveWorkbook.Sheets(1).Range(\"A1:Z30\").Select\nSavePicToFile (foto)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8189, "user_id": 4342479, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ba8f7b5222688205d3047ef8093c2608?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ee9c Thanh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/4342479/%c4%90%e1%bb%a9c-thanh-nguy%e1%bb%85n"}, "is_accepted": false, "score": 4, "last_activity_date": 1553595653, "creation_date": 1553595653, "answer_id": 55354715, "question_id": 43904385, "link": "https://stackoverflow.com/questions/43904385/using-excel-vba-macro-to-capture-save-screenshot-of-specific-area-in-same-file/55354715#55354715", "title": "Using Excel VBA Macro To Capture + Save Screenshot of Specific Area In Same File", "body": "<p>You can try this code in a standard Module in Excel 32 Bit. </p>\n\n<ul>\n<li>Screenshots can be captured immediately by calling <strong>Sub\nprcSave_Picture_Screen</strong> and it will capture your whole screen and\nsave to the same path as your workbook (You can change the path and\nfile name if you want)</li>\n<li>Screenshots of an active window can also be captured after calling <strong>Sub \nprcSave_Picture_Active_Window</strong> 3 seconds (which is adjustable)</li>\n</ul>\n\n<p>Source: <a href=\"https://www.ms-office-forum.net/forum/showpost.php?s=3dd10b924bd5e1104cb3ac0747e2410f&amp;p=1129130&amp;postcount=2\" rel=\"nofollow noreferrer\">ms-office-forum.de</a></p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Sub Sleep Lib \"kernel32.dll\" ( _\n    ByVal dwMilliseconds As Long)\nPrivate Declare Function OleCreatePictureIndirect Lib \"olepro32.dll\" ( _\n    ByRef PicDesc As PicBmp, _\n    ByRef RefIID As GUID, _\n    ByVal fPictureOwnsHandle As Long, _\n    ByRef IPic As IPicture) As Long\nPrivate Declare Function CreateCompatibleDC Lib \"gdi32.dll\" ( _\n    ByVal hdc As Long) As Long\nPrivate Declare Function CreateCompatibleBitmap Lib \"gdi32.dll\" ( _\n    ByVal hdc As Long, _\n    ByVal nWidth As Long, _\n    ByVal nHeight As Long) As Long\nPrivate Declare Function SelectObject Lib \"gdi32.dll\" ( _\n    ByVal hdc As Long, _\n    ByVal hObject As Long) As Long\nPrivate Declare Function GetDeviceCaps Lib \"gdi32.dll\" ( _\n    ByVal hdc As Long, _\n    ByVal iCapabilitiy As Long) As Long\nPrivate Declare Function GetSystemPaletteEntries Lib \"gdi32.dll\" ( _\n    ByVal hdc As Long, _\n    ByVal wStartIndex As Long, _\n    ByVal wNumEntries As Long, _\n    ByRef lpPaletteEntries As PALETTEENTRY) As Long\nPrivate Declare Function CreatePalette Lib \"gdi32.dll\" ( _\n    ByRef lpLogPalette As LOGPALETTE) As Long\nPrivate Declare Function SelectPalette Lib \"gdi32.dll\" ( _\n    ByVal hdc As Long, _\n    ByVal hPalette As Long, _\n    ByVal bForceBackground As Long) As Long\nPrivate Declare Function RealizePalette Lib \"gdi32.dll\" ( _\n    ByVal hdc As Long) As Long\nPrivate Declare Function BitBlt Lib \"gdi32.dll\" ( _\n    ByVal hDestDC As Long, _\n    ByVal x As Long, _\n    ByVal y As Long, _\n    ByVal nWidth As Long, _\n    ByVal nHeight As Long, _\n    ByVal hSrcDC As Long, _\n    ByVal xSrc As Long, _\n    ByVal ySrc As Long, _\n    ByVal dwRop As Long) As Long\nPrivate Declare Function DeleteDC Lib \"gdi32.dll\" ( _\n    ByVal hdc As Long) As Long\nPrivate Declare Function GetDC Lib \"user32.dll\" ( _\n    ByVal hWnd As Long) As Long\nPrivate Declare Function GetWindowRect Lib \"user32.dll\" ( _\n    ByVal hWnd As Long, _\n    ByRef lpRect As RECT) As Long\nPrivate Declare Function GetSystemMetrics Lib \"user32.dll\" ( _\n    ByVal nIndex As Long) As Long\nPrivate Declare Function GetForegroundWindow Lib \"user32.dll\" () As Long\n\nPrivate Const SM_CXSCREEN = 0&amp;\nPrivate Const SM_CYSCREEN = 1&amp;\nPrivate Const RC_PALETTE As Long = &amp;H100\nPrivate Const SIZEPALETTE As Long = 104\nPrivate Const RASTERCAPS As Long = 38\n\nPrivate Type RECT\n    Left As Long\n    Top As Long\n    Right As Long\n    Bottom As Long\nEnd Type\n\nPrivate Type PALETTEENTRY\n    peRed As Byte\n    peGreen As Byte\n    peBlue As Byte\n    peFlags As Byte\nEnd Type\n\nPrivate Type LOGPALETTE\n    palVersion As Integer\n    palNumEntries As Integer\n    palPalEntry(255) As PALETTEENTRY\nEnd Type\n\nPrivate Type GUID\n    Data1 As Long\n    Data2 As Integer\n    Data3 As Integer\n    Data4(7) As Byte\nEnd Type\n\nPrivate Type PicBmp\n    Size As Long\n    Type As Long\n    hBmp As Long\n    hPal As Long\n    Reserved As Long\nEnd Type\n\nPublic Sub prcSave_Picture_Screen() 'ganzer bildschirm\n    stdole.SavePicture hDCToPicture(GetDC(0&amp;), 0&amp;, 0&amp;, _\n        GetSystemMetrics(SM_CXSCREEN), GetSystemMetrics(SM_CYSCREEN)), _\n        ThisWorkbook.Path &amp; \"\\Screenshot.bmp\" 'anpassen !!!\nEnd Sub\n\nPublic Sub prcSave_Picture_Active_Window() 'aktives Fenster\n    Dim hWnd As Long\n    Dim udtRect As RECT\n    Sleep 3000 '3 sekunden pause um ein anderes Fenster zu aktivieren\n    hWnd = GetForegroundWindow\n    GetWindowRect hWnd, udtRect\n    stdole.SavePicture hDCToPicture(GetDC(0&amp;), udtRect.Left, udtRect.Top, _\n        udtRect.Right - udtRect.Left, udtRect.Bottom - udtRect.Top), _\n        ThisWorkbook.Path &amp; \"\\Screenshot.bmp\" 'anpassen !!!\nEnd Sub\n\nPrivate Function CreateBitmapPicture(ByVal hBmp As Long, ByVal hPal As Long) As Object\n    Dim Pic As PicBmp, IPic As IPicture, IID_IDispatch As GUID\n    With IID_IDispatch\n        .Data1 = &amp;H20400\n        .Data4(0) = &amp;HC0\n        .Data4(7) = &amp;H46\n    End With\n    With Pic\n        .Size = Len(Pic)\n        .Type = 1\n        .hBmp = hBmp\n        .hPal = hPal\n    End With\n    Call OleCreatePictureIndirect(Pic, IID_IDispatch, 1, IPic)\n    Set CreateBitmapPicture = IPic\nEnd Function\n\nPrivate Function hDCToPicture(ByVal hDCSrc As Long, ByVal LeftSrc As Long, _\n    ByVal TopSrc As Long, ByVal WidthSrc As Long, ByVal HeightSrc As Long) As Object\n    Dim hDCMemory As Long, hBmp As Long, hBmpPrev As Long\n    Dim hPal As Long, hPalPrev As Long, RasterCapsScrn As Long, HasPaletteScrn As Long\n    Dim PaletteSizeScrn As Long, LogPal As LOGPALETTE\n    hDCMemory = CreateCompatibleDC(hDCSrc)\n    hBmp = CreateCompatibleBitmap(hDCSrc, WidthSrc, HeightSrc)\n    hBmpPrev = SelectObject(hDCMemory, hBmp)\n    RasterCapsScrn = GetDeviceCaps(hDCSrc, RASTERCAPS)\n    HasPaletteScrn = RasterCapsScrn And RC_PALETTE\n    PaletteSizeScrn = GetDeviceCaps(hDCSrc, SIZEPALETTE)\n    If HasPaletteScrn And (PaletteSizeScrn = 256) Then\n        LogPal.palVersion = &amp;H300\n        LogPal.palNumEntries = 256\n        Call GetSystemPaletteEntries(hDCSrc, 0, 256, LogPal.palPalEntry(0))\n        hPal = CreatePalette(LogPal)\n        hPalPrev = SelectPalette(hDCMemory, hPal, 0)\n        Call RealizePalette(hDCMemory)\n    End If\n    Call BitBlt(hDCMemory, 0, 0, WidthSrc, HeightSrc, hDCSrc, LeftSrc, TopSrc, 13369376)\n    hBmp = SelectObject(hDCMemory, hBmpPrev)\n    If HasPaletteScrn And (PaletteSizeScrn = 256) Then\n        hPal = SelectPalette(hDCMemory, hPalPrev, 0)\n    End If\n    Call DeleteDC(hDCMemory)\n    Set hDCToPicture = CreateBitmapPicture(hBmp, hPal)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 2133309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79c0233367e7ea2c18128ee30257d04d?s=128&d=identicon&r=PG", "display_name": "loco", "link": "https://stackoverflow.com/users/2133309/loco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64482, "favorite_count": 10, "accepted_answer_id": 43904536, "answer_count": 3, "score": 7, "last_activity_date": 1585030390, "creation_date": 1494460549, "last_edit_date": 1585030390, "question_id": 43904385, "link": "https://stackoverflow.com/questions/43904385/using-excel-vba-macro-to-capture-save-screenshot-of-specific-area-in-same-file", "title": "Using Excel VBA Macro To Capture + Save Screenshot of Specific Area In Same File", "body": "<p>I'm trying to create a macro which uses an ActiveX control button (click) to take a screenshot of my desktop screen and save it within the same excel sheet as the button. How can I create a screenshot 800x600 in size (not full desktop view) and then have it pasted into the left hand side of the same sheet as the button? I have tried this numerous ways including sendkeys (simplest). </p>\n\n<p>I saved the capture process in a module:</p>\n\n<pre><code>Sub PasteScreenShot()\nApplication.SendKeys \"({1068})\"\nActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>And then call the sub in the ActiveX button code. The capture works, but I cannot figure out a way to manipulate its area grab or its pasted location on the sheet. </p>\n\n<p>I am trying to automate with buttons rather than using the snipping tool.</p>\n"}, {"tags": ["excel", "vba", "powerquery"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494460329, "post_id": 43904268, "comment_id": 74842625, "body": "FWIW - I just tried following the link to <a href=\"https://finance.yahoo.com/quote/AAL/history?p=AAL\" rel=\"nofollow noreferrer\">finance.yahoo.com/quote/AAL/history?p=AAL</a> and it worked for me.  (But I guess it could have redirected somewhere and not told me, and not updated the address in the browser.)"}, {"owner": {"reputation": 31, "user_id": 5386525, "user_type": "registered", "profile_image": "https://graph.facebook.com/992355340809408/picture?type=large", "display_name": "Stephen Karas", "link": "https://stackoverflow.com/users/5386525/stephen-karas"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494462937, "post_id": 43904268, "comment_id": 74843140, "body": "Thanks for responding. Just to clarify you were able to get an Excel Power Query response to  <a href=\"https://finance.yahoo.com/quote/AAL/history?p=AAL\" rel=\"nofollow noreferrer\">finance.yahoo.com/quote/AAL/history?p=AAL</a>, or just get the table in a web browser?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494463091, "post_id": 43904268, "comment_id": 74843174, "body": "I just tried to follow the link in a browser - but that implies that the page hasn&#39;t been permanently redirected (which I think is what a 301 error means)"}, {"owner": {"reputation": 31, "user_id": 5386525, "user_type": "registered", "profile_image": "https://graph.facebook.com/992355340809408/picture?type=large", "display_name": "Stephen Karas", "link": "https://stackoverflow.com/users/5386525/stephen-karas"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494464976, "post_id": 43904268, "comment_id": 74843582, "body": "I can get to the table through a browser no problem.  It&#39;s when I try to automate with a power query that it returns a 301 response. I did stumble on the solution to my problem.  Stack overflow thread  discussing http vs https.  By switching my URL to Https my old code now works again.  Thanks again  for helping me out with my problem."}], "answers": [{"tags": [], "owner": {"reputation": 1270, "user_id": 4728144, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/782789381777029/picture?type=large", "display_name": "Sergey Lossev", "link": "https://stackoverflow.com/users/4728144/sergey-lossev"}, "is_accepted": false, "score": 0, "last_activity_date": 1497825415, "last_edit_date": 1497825415, "creation_date": 1497825112, "answer_id": 44620157, "question_id": 43904268, "link": "https://stackoverflow.com/questions/43904268/yahoo-finance-historical-stock-price-power-query-returns-301-response/44620157#44620157", "title": "Yahoo finance historical stock price power query returns 301 response", "body": "<h1>You should set header user-agent to emulate browser</h1>\n\n<p>For examble Google Chrome</p>\n\n<pre><code>let\n    Source = Web.Page(Web.Contents(\"https://finance.yahoo.com/quote/AAL/history?p=AAL\", [Headers=[#\"user-agent\"=\"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.86 Safari/537.36\"]])),\n    Data0 = Source{0}[Data]\nin\n    Data0\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7rr4s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7rr4s.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5386525, "user_type": "registered", "profile_image": "https://graph.facebook.com/992355340809408/picture?type=large", "display_name": "Stephen Karas", "link": "https://stackoverflow.com/users/5386525/stephen-karas"}, "edited": false, "score": 0, "creation_date": 1508684521, "post_id": 45255628, "comment_id": 80698045, "body": "Thanks for the info!  I will try it out."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1500733549, "creation_date": 1500733549, "answer_id": 45255628, "question_id": 43904268, "link": "https://stackoverflow.com/questions/43904268/yahoo-finance-historical-stock-price-power-query-returns-301-response/45255628#45255628", "title": "Yahoo finance historical stock price power query returns 301 response", "body": "<p>I think Yahoo changed it's API very recently.  Download the file from the link titled \"Get Excel Spreadsheet to Download Bulk Historical Stock Data from Google Finance\"</p>\n\n<p><a href=\"http://investexcel.net/multiple-stock-quote-downloader-for-excel/\" rel=\"nofollow noreferrer\">http://investexcel.net/multiple-stock-quote-downloader-for-excel/</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/cg6eP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cg6eP.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>'Samir Khan\n'simulationconsultant@gmail.com\n'The latest version of this spreadsheet can be downloaded from http://investexcel.net/multiple-stock-quote-downloader-for-excel/\n'Please link to http://investexcel.net if you like this spreadsheet\n\n\nSub DownloadStockQuotes(ByVal stockTicker As String, ByVal StartDate As Date, ByVal EndDate As Date, ByVal DestinationCell As String, ByVal freq As String)\n\nDim qurl As String\nDim StartMonth, StartDay, StartYear, EndMonth, EndDay, EndYear As String\n\nqurl = \"http://finance.google.com/finance/historical?q=\" &amp; stockTicker\nqurl = qurl &amp; \"&amp;startdate=\" &amp; MonthName(Month(StartDate), True) &amp; _\n       \"+\" &amp; Day(StartDate) &amp; \"+\" &amp; Year(StartDate) &amp; _\n       \"&amp;enddate=\" &amp; MonthName(Month(EndDate), True) &amp; _\n       \"+\" &amp; Day(EndDate) &amp; \"+\" &amp; Year(EndDate) &amp; \"&amp;output=csv\"\n\nOn Error GoTo ErrorHandler:\n\nQueryQuote:\nWith ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; qurl, Destination:=Range(DestinationCell))\n    .BackgroundQuery = True\n    .TablesOnlyFromHTML = False\n    .Refresh BackgroundQuery:=False\n    .SaveData = True\nEnd With\n\nErrorHandler:\n\nEnd Sub\n\nSub DownloadData()\n\nDim frequency As String\nDim numRows As Integer\nDim lastRow As Integer\nDim lastErrorRow As Integer\nDim lastSuccessRow As Integer\nDim stockTicker As String\nDim numStockErrors As Integer\nDim numStockSuccess As Integer\n\nnumStockErrors = 0\nnumStockSuccess = 0\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nlastErrorRow = ActiveSheet.Cells(Rows.Count, \"J\").End(xlUp).Row\nlastSuccessRow = ActiveSheet.Cells(Rows.Count, \"L\").End(xlUp).Row\n\nClearErrorList lastErrorRow\nClearSuccessList lastSuccessRow\n\nlastRow = ActiveSheet.Cells(Rows.Count, \"a\").End(xlUp).Row\nfrequency = Worksheets(\"Parameters\").Range(\"b7\")\n\n'Delete all sheets apart from Parameters sheet\nDim ws As Worksheet\nApplication.DisplayAlerts = False\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" Then ws.Delete\nNext\n\nApplication.DisplayAlerts = True\n\n'Loop through all tickers\nFor ticker = 12 To lastRow\n\n    stockTicker = Worksheets(\"Parameters\").Range(\"$a$\" &amp; ticker)\n\n    If stockTicker = \"\" Then\n        GoTo NextIteration\n    End If\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n\n    If InStr(stockTicker, \":\") &gt; 0 Then\n        ActiveSheet.Name = Replace(stockTicker, \":\", \"\")\n    Else\n        ActiveSheet.Name = stockTicker\n    End If\n\n    Cells(1, 1) = \"Stock Quotes for \" &amp; stockTicker\n    Call DownloadStockQuotes(stockTicker, Worksheets(\"Parameters\").Range(\"$b$5\"), Worksheets(\"Parameters\").Range(\"$b$6\"), \"$a$2\", frequency)\n    Columns(\"a:a\").TextToColumns Destination:=Range(\"a1\"), DataType:=xlDelimited, _\n                                 TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n                                 Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1))\n\n\n    If InStr(stockTicker, \":\") &gt; 0 Then\n        stockTicker = Replace(stockTicker, \":\", \"\")\n    End If\n\n    Sheets(stockTicker).Columns(\"A:G\").ColumnWidth = 10\n\n    lastRow = Sheets(stockTicker).UsedRange.Row - 2 + Sheets(stockTicker).UsedRange.Rows.Count\n\n    If lastRow &lt; 3 Then\n        Application.DisplayAlerts = False\n        Sheets(stockTicker).Delete\n        numStockErrors = numStockErrors + 1\n        ErrorList stockTicker, numStockErrors\n        GoTo NextIteration\n        Application.DisplayAlerts = True\n    Else\n        numStockSuccess = numStockSuccess + 1\n        If Left(stockTicker, 1) = \"^\" Then\n            SuccessList Replace(stockTicker, \"^\", \"\"), numStockSuccess\n        Else\n            SuccessList stockTicker, numStockSuccess\n        End If\n    End If\n\n    Sheets(stockTicker).Sort.SortFields.Add Key:=Range(\"A3:A\" &amp; lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With Sheets(stockTicker).Sort\n        .SetRange Range(\"A2:G\" &amp; lastRow)\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Range(\"a3:a\" &amp; lastRow).NumberFormat = \"yyyy-mm-dd;@\"\n\n    'Delete final blank row otherwise will get ,,,, at bottom of CSV\n    Sheets(stockTicker).Rows(lastRow + 1 &amp; \":\" &amp; Sheets(stockTicker).Rows.Count).Delete\n\n    'Remove initial ^ in ticker names from Sheets\n    If Left(stockTicker, 1) = \"^\" Then\n        ActiveSheet.Name = Replace(stockTicker, \"^\", \"\")\n    Else\n        ActiveSheet.Name = stockTicker\n    End If\n\n    'Remove hyphens in ticker names from Sheet names, otherwise error in collation\n    If InStr(stockTicker, \"-\") &gt; 0 Then\n        ActiveSheet.Name = Replace(stockTicker, \"-\", \"\")\n    End If\n\n\nNextIteration:\nNext ticker\n\nApplication.DisplayAlerts = False\n\nIf Sheets(\"Parameters\").Shapes(\"WriteToCSVCheckBox\").ControlFormat.Value = xlOn Then\n    On Error GoTo ErrorHandler:\n    Call CopyToCSV\nEnd If\n\nIf Sheets(\"Parameters\").Shapes(\"CollateDataCheckBox\").ControlFormat.Value = xlOn Then\n    On Error GoTo ErrorHandler:\n    Call CollateData\nEnd If\n\nErrorHandler:\n\nWorksheets(\"Parameters\").Select\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nWorksheets(\"Parameters\").Select\nFor Each C In ThisWorkbook.Connections\n    C.Delete\nNext\n\nEnd Sub\nSub CollateData()\n\nDim ws As Worksheet\nDim i As Integer, first As Integer\nDim maxRow As Integer\nDim maxTickerWS As Worksheet\n\nmaxRow = 0\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" Then\n        If ws.UsedRange.Rows.Count &gt; maxRow Then\n            maxRow = ws.UsedRange.Rows.Count\n            Set maxTickerWS = ws\n        End If\n    End If\nNext\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Open\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"High\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Low\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Close\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Volume\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Adjusted Close\"\n\ni = 1\nmaxTickerWS.Range(\"A2\", \"B\" &amp; maxRow).Copy Destination:=Sheets(\"Open\").Cells(1, i)\nSheets(\"Open\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"High\").Cells(1, i)\nmaxTickerWS.Range(\"c2\", \"c\" &amp; maxRow).Copy Destination:=Sheets(\"High\").Cells(1, i + 1)\nSheets(\"High\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Low\").Cells(1, i)\nmaxTickerWS.Range(\"d2\", \"d\" &amp; maxRow).Copy Destination:=Sheets(\"Low\").Cells(1, i + 1)\nSheets(\"Low\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Close\").Cells(1, i)\nmaxTickerWS.Range(\"e2\", \"e\" &amp; maxRow).Copy Destination:=Sheets(\"Close\").Cells(1, i + 1)\nSheets(\"Close\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Volume\").Cells(1, i)\nmaxTickerWS.Range(\"f2\", \"f\" &amp; maxRow).Copy Destination:=Sheets(\"Volume\").Cells(1, i + 1)\nSheets(\"Volume\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Adjusted Close\").Cells(1, i)\nmaxTickerWS.Range(\"g2\", \"g\" &amp; maxRow).Copy Destination:=Sheets(\"Adjusted Close\").Cells(1, i + 1)\nSheets(\"Adjusted Close\").Cells(1, i + 1) = maxTickerWS.Name\n\ni = i + 2\n\nFor Each ws In Worksheets\n\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" And ws.Name &lt;&gt; maxTickerWS.Name And ws.Name &lt;&gt; \"Open\" And ws.Name &lt;&gt; \"High\" And ws.Name &lt;&gt; \"Low\" And ws.Name &lt;&gt; \"Close\" And ws.Name &lt;&gt; \"Volume\" And ws.Name &lt;&gt; \"Adjusted Close\" Then\n\n        Sheets(\"Open\").Cells(1, i) = ws.Name\n        Sheets(\"Open\").Range(Sheets(\"Open\").Cells(2, i), Sheets(\"Open\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",2,0)\"\n\n        Sheets(\"High\").Cells(1, i) = ws.Name\n        Sheets(\"High\").Range(Sheets(\"High\").Cells(2, i), Sheets(\"High\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",3,0)\"\n\n        Sheets(\"Low\").Cells(1, i) = ws.Name\n        Sheets(\"Low\").Range(Sheets(\"Low\").Cells(2, i), Sheets(\"Low\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",4,0)\"\n\n        Sheets(\"Close\").Cells(1, i) = ws.Name\n        Sheets(\"Close\").Range(Sheets(\"Close\").Cells(2, i), Sheets(\"Close\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",5,0)\"\n\n        Sheets(\"Volume\").Cells(1, i) = ws.Name\n        Sheets(\"Volume\").Range(Sheets(\"Volume\").Cells(2, i), Sheets(\"Volume\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",6,0)\"\n\n        Sheets(\"Adjusted Close\").Cells(1, i) = ws.Name\n        Sheets(\"Adjusted Close\").Range(Sheets(\"Adjusted Close\").Cells(2, i), Sheets(\"Adjusted Close\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",7,0)\"\n\n        i = i + 1\n\n    End If\nNext\n\nOn Error Resume Next\n\nSheets(\"Open\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Close\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"High\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Low\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Volume\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Adjusted Close\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\n\nOn Error GoTo 0\n\nSheets(\"Open\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"High\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Low\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Close\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Volume\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Adjusted Close\").Columns(\"A:A\").EntireColumn.AutoFit\nEnd Sub\n\nSub SuccessList(ByVal stockTicker As String, ByVal numStockSuccess As Integer)\n\nSheets(\"Parameters\").Range(\"L\" &amp; 10 + numStockSuccess) = stockTicker\n\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalUp).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeLeft).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeTop).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeBottom).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeRight).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideHorizontal).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalUp).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\n\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideHorizontal).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\n\nEnd Sub\n\nSub ErrorList(ByVal stockTicker As String, ByVal numStockErrors As Integer)\n\nSheets(\"Parameters\").Range(\"J\" &amp; 10 + numStockErrors) = stockTicker\n\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalUp).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeLeft).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeTop).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeBottom).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeRight).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideHorizontal).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalUp).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\n\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideHorizontal).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\n\nEnd Sub\n\nSub ClearErrorList(ByVal lastErrorRow As Integer)\nIf lastErrorRow &gt; 10 Then\n    Worksheets(\"Parameters\").Range(\"J11:J\" &amp; lastErrorRow).Clear\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\nEnd If\nEnd Sub\n\nSub ClearSuccessList(ByVal lastSuccessRow As Integer)\nIf lastSuccessRow &gt; 10 Then\n    Worksheets(\"Parameters\").Range(\"L11:L\" &amp; lastSuccessRow).Clear\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\nEnd If\nEnd Sub\n\n\nSub CopyToCSV()\n\nDim MyPath As String\nDim MyFileName As String\n\ndateFrom = Worksheets(\"Parameters\").Range(\"$b$5\")\ndateTo = Worksheets(\"Parameters\").Range(\"$b$6\")\nfrequency = Worksheets(\"Parameters\").Range(\"$b$7\")\nMyPath = Worksheets(\"Parameters\").Range(\"$b$8\")\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" Then\n        ticker = ws.Name\n        MyFileName = ticker &amp; \" \" &amp; Format(dateFrom, \"dd-mm-yyyy\") &amp; \" - \" &amp; Format(dateTo, \"dd-mm-yyyy\") &amp; \" \" &amp; frequency\n        If Not Right(MyPath, 1) = \"\\\" Then MyPath = MyPath &amp; \"\\\"\n        If Not Right(MyFileName, 4) = \".csv\" Then MyFileName = MyFileName &amp; \".csv\"\n        Sheets(ticker).Copy\n        With ActiveWorkbook\n            .SaveAs Filename:= _\n                    MyPath &amp; MyFileName, _\n                    FileFormat:=xlCSV, _\n                    CreateBackup:=False\n            .Close False\n        End With\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5386525, "user_type": "registered", "profile_image": "https://graph.facebook.com/992355340809408/picture?type=large", "display_name": "Stephen Karas", "link": "https://stackoverflow.com/users/5386525/stephen-karas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2156, "favorite_count": 0, "protected_date": 1497653138, "answer_count": 2, "score": 2, "last_activity_date": 1500733549, "creation_date": 1494459645, "question_id": 43904268, "link": "https://stackoverflow.com/questions/43904268/yahoo-finance-historical-stock-price-power-query-returns-301-response", "title": "Yahoo finance historical stock price power query returns 301 response", "body": "<p>Until today my Excel 2016 power query was able to obtain historical stock pricing data from the following URL <a href=\"https://finance.yahoo.com/quote/AAL/history?p=AAL\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/AAL/history?p=AAL</a>.  The Credential type was anonymous and the privacy level was public.  I also tried using my username and password for my yahoo account in the Web Credential window with no luck. Excel returns a message that contains a 301 response.</p>\n\n<p>Power query does work with Google Finance but the URL <a href=\"https://www.google.com/finance/historical?q=NASDAQ%3AAAL&amp;ei=GqITWbGNIMvIebuQqXA\" rel=\"nofollow noreferrer\">https://www.google.com/finance/historical?q=NASDAQ%3AAAL&amp;ei=GqITWbGNIMvIebuQqXA</a> has a parameter \"ei\" that makes no sense to me and I don't think I would be able to automate this.</p>\n\n<p>Question; has yahoo recently changed so that this type of request is no longer viable?</p>\n\n<p>Question; does anyone have VBA example of Yahoo Query Language (YQL) requesting historical stock quotes from yahoo.api?</p>\n\n<p>Thanks for any help with this.</p>\n"}, {"tags": ["arrays", "vba", "excel", "charts"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494461459, "post_id": 43904254, "comment_id": 74842847, "body": "Try <code>Worksheets(&quot;WK_Report&quot;).Range(&quot;C3:C15&quot;).value = Application.Transpose(CItemArray(cnt1).CWeek)</code>"}, {"owner": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494461781, "post_id": 43904254, "comment_id": 74842915, "body": "I tried this.. This reduces the output to a single item of the cweek"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "edited": false, "score": 0, "creation_date": 1494462324, "post_id": 43904492, "comment_id": 74843021, "body": "&quot;From my point of view, the user defined type is only getting in the way but once you get it working it may be a &#39;set and forget&#39; type of thing. I used a 1-based array so you didn&#39;t have to add 1 to the ubounds.&quot;  Can you please clarify this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "edited": false, "score": 0, "creation_date": 1494462767, "post_id": 43904492, "comment_id": 74843105, "body": "1. You need a 2-D array to transfer values directly to the worksheet in row by columns. You used 4 1-D arrays. 2. It might be easier to populate the user defined structure but it isn&#39;t easier to get it back to the worksheet and you declined to offer how you were populating it in the first place so... I dunno. 3. If you have a zero-based array and use its ubound to resize the destination them you have to add 1 to the ubound cuz there is no range of cells on the worksheet that is zero rows by zero columns."}, {"owner": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "edited": false, "score": 0, "creation_date": 1494463459, "post_id": 43904492, "comment_id": 74843254, "body": "Super! Thanks for your help and suggestion on moving to the 2 D array."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1494461391, "creation_date": 1494461391, "answer_id": 43904492, "question_id": 43904254, "link": "https://stackoverflow.com/questions/43904254/vba-creating-an-excel-chart-using-values-in-an-array/43904492#43904492", "title": "VBA Creating an excel chart using values in an array", "body": "<p>You've left out how you are populating the user defined type arrays but you should move to a 2-D variant array.</p>\n\n<pre><code>Private Type CItem\n    CName As Variant\n    CStuff(1 to 13, 1 to 4) As Variant\nEnd Type\n\nDim CItemArray(100) As CItem, cnt1 as long\n\n//.. populate 100 CItemArray.CStuff with 13 rows by 4 columns each\n\nActiveWorkbook.Sheets.Add(After:=Sheets(\"MainSheet\")).Name = \"WK_Report\"\n\ncnt1 = 1\nwith Worksheets(\"WK_Report\").Range(\"C3\")\n    .resize(ubound(CItemArray(cnt1).CStuff, 1), ubound(CItemArray(cnt1).CStuff, 2)) = CItemArray(cnt1).CStuff\nend with\n</code></pre>\n\n<p>From my point of view, the user defined type is only getting in the way but once you get it working it may be a 'set and forget' type of thing. I used a 1-based array so you didn't have to add 1 to the ubounds.</p>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "edited": false, "score": 0, "creation_date": 1494462860, "post_id": 43904619, "comment_id": 74843120, "body": "Thanks.. I tried this.. it did not work   Worksheets(&quot;WK_Report&quot;).Range(&quot;C3:C15&quot;).value = Application.Transpose(CItemArray(cnt1).CWeek) The only difference is I am trying to refer to a particular CItemarray"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1494462966, "post_id": 43904619, "comment_id": 74843152, "body": "&#39;<i>it did not work&#39;</i> is neither a valid error code or an adequate description of the problem."}, {"owner": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "edited": false, "score": 0, "creation_date": 1494463094, "post_id": 43904619, "comment_id": 74843177, "body": "@jeeped unfortunately, enter = submit for the comment, I was trying to get to the new line.. I tried Alt + Enter as well. it did the same. I gave up.I just edited my comment.. I will learn how to enter on new line in a comment. Cool?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494463657, "post_id": 43904619, "comment_id": 74843298, "body": "Works fine for me, so something else is going on with your code...  BTW you cannot use newlines in comments."}, {"owner": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "edited": false, "score": 0, "creation_date": 1494463849, "post_id": 43904619, "comment_id": 74843342, "body": "Yep! I ran your code and it works. I am probably doing something wrong here.. given that I am trying to access a specific element of the citem array"}, {"owner": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "edited": false, "score": 0, "creation_date": 1494561888, "post_id": 43904619, "comment_id": 74891108, "body": "@jeeped it turned out that i had incorrectly assigned values to my array. I figured it out and changed it.  The Transpose solution worked."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1494462455, "creation_date": 1494462455, "answer_id": 43904619, "question_id": 43904254, "link": "https://stackoverflow.com/questions/43904254/vba-creating-an-excel-chart-using-values-in-an-array/43904619#43904619", "title": "VBA Creating an excel chart using values in an array", "body": "<p>You <em>can</em> use <code>Application.Transpose</code>: here's a simplified example</p>\n\n<pre><code>Option Explicit\n\nPrivate Type CItem\n    CWeek(13) As Variant\nEnd Type\n\nSub Tester()\n\n    Dim itm As CItem, x As Long\n\n    For x = 1 To 14\n        itm.CWeek(x - 1) = x\n    Next x\n\n    ActiveSheet.Range(\"C3:C15\").Value = itm.CWeek '&gt;&gt; all \"1\"\n\n    ActiveSheet.Range(\"D3:D15\").Value = Application.Transpose(itm.CWeek) '&gt;&gt; 1 to 13\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 2049783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8aed30d7cf7cee527a24c6e7adca60e?s=128&d=identicon&r=PG", "display_name": "Sam G", "link": "https://stackoverflow.com/users/2049783/sam-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1296, "favorite_count": 0, "accepted_answer_id": 43904492, "answer_count": 2, "score": 1, "last_activity_date": 1494462455, "creation_date": 1494459526, "question_id": 43904254, "link": "https://stackoverflow.com/questions/43904254/vba-creating-an-excel-chart-using-values-in-an-array", "title": "VBA Creating an excel chart using values in an array", "body": "<p>I have some data in a two dimensional array and I need to create a chart using excel charts. However, it seems that the charts setsourcedata accepts only range. This means that I have to store the array in a range on a spreadsheet somewhere and then pass the range to the chart as an input. So i created a temp sheet to store the data in a specific range and then plan to pass it to the create chart call. Here is a type that I created</p>\n\n<pre><code>Private Type CItem\n\nCName As Variant\nCWeek(13) As Variant\nCDisabled(13) As Variant\nCEmpty(13) As Variant\nCEnabled(13) As Variant\n\nEnd Type\n\nDim CItemArray(100) As CItem\ncnt1 = 0\n\n//.. do something\n\nActiveWorkbook.Sheets.Add(After:=Sheets(\"MainSheet\")).Name = \"WK_Report\"\n\nWorksheets(\"WK_Report\").Range(\"C3:C15\").value = CItemArray(cnt1).CWeek()\nWorksheets(\"WK_Report\").Range(\"D3:D15\").value = CItemArray(cnt1).CDisabled()\nWorksheets(\"WK_Report\").Range(\"E3:E15\").value = CItemArray(cnt1).CEnabled()\nWorksheets(\"WK_Report\").Range(\"F3:F15\").value = CItemArray(cnt1).CEmpty()\n</code></pre>\n\n<p>My goal is to assign the entire array of CWeek for the first CItem to the range of C3:C15 respectively. However, the syntax  I used above assigns the first element of Cweek, CDisabled, CEnabled, CEmpty to the entire range. I tried without the parentheses after CWeek and others, but the result is same. </p>\n\n<p>How can I assign the array values to the range? I know that the values are in the array because I did a debug.print after assigning to verify. </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1494464120, "post_id": 43904114, "comment_id": 74843410, "body": "Hi &amp; welcome to Stack Overflow, you&#39;re generally expected to show some effort towards solving the problem, and &quot;I&#39;m really new&quot; is usually code-word for &quot;I don&#39;t know jack, please give me the answer&quot;, which is really bad form, and also against the etiquette here.  You&#39;re expected to have a basic understanding of your problem (at least) and also to provide code that you&#39;ve attempted and if possible, an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> and explanation of your specific problem or error."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494464140, "post_id": 43904114, "comment_id": 74843416, "body": "If you don&#39;t know how to do something, please first <a href=\"https://www.google.com/search?q=outlook+vba+insert+table&amp;oq=Outlook+VBA+add+Table&amp;aqs=chrome.1.69i57j0.4744j0j4&amp;sourceid=chrome&amp;ie=UTF-8\" rel=\"nofollow noreferrer\">google it</a> and then if you get stuck or have errors with your code, that is a good time to ask questions for assistance and troubleshooting."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7643759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b263c2ba97079366d95fc6e65196bf19?s=128&d=identicon&r=PG&f=1", "display_name": "alii", "link": "https://stackoverflow.com/users/7643759/alii"}, "edited": false, "score": 0, "creation_date": 1494463763, "post_id": 43904662, "comment_id": 74843323, "body": "In order to refrence do i go to tools in word?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1494463862, "post_id": 43904662, "comment_id": 74843345, "body": "@alli No, you go to Tools &gt; References in the Visual Basic window from Outlook."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1515547182, "last_edit_date": 1592644375, "creation_date": 1494462765, "answer_id": 43904662, "question_id": 43904114, "link": "https://stackoverflow.com/questions/43904114/forward-email-with-a-table-in-the-body/43904662#43904662", "title": "Forward email with a table in the body", "body": "<p><em>Work with <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff845710.aspx\" rel=\"nofollow noreferrer\">Tables.Add Method (Word)</a></strong> which Returns a Table object that represents a new, blank table added to a document.</em></p>\n<p><em>Make sure the Email is HTML format</em></p>\n<p><em>Syntax<br></em></p>\n<pre><code>expression .Add(Range, NumRows, NumColumns, DefaultTableBehavior, AutoFitBehavior)\n</code></pre>\n<p><em>Your Outlook Code Example would be</em></p>\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim Item As Outlook.mailitem\n    Dim Forward As Outlook.mailitem\n    Dim Recip As Recipient\n    Dim Inspector As Outlook.Inspector\n    Dim wdDoc As Word.Document\n    Dim Selection As Word.Selection\n    \n'   // Select the Item you would like to forward    \n    Set Item = Application.ActiveExplorer.Selection.Item(1)\n    Set Forward = Item.Forward\n    Set Recip = Forward.Recipients.Add(&quot;0m3r@Email.com&quot;)\n        Recip.Type = olTo\n        Forward.Display\n        \n    Set Inspector = Application.ActiveInspector()\n    Set wdDoc = Inspector.WordEditor\n    Set Selection = wdDoc.Application.Selection\n    \n        Selection.Tables.Add Range:=Selection.Range, _\n                             NumRows:=4, NumColumns:=4, _\n                             DefaultTableBehavior:=wdWord9TableBehavior, _\n                             AutoFitBehavior:=wdAutoFitFixed\n    \n    \n'        // Uncomment to send\n'        Forward.Sent\n        \n    Set Inspector = Nothing\n    Set wdDoc = Nothing\n    Set Selection = Nothing\nEnd Sub\n</code></pre>\n<hr />\n<p><em>Email Body Example</em></p>\n<p><a href=\"https://i.stack.imgur.com/KJRcW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KJRcW.png\" alt=\"enter image description here\" /></a></p>\n<hr />\n<p><em><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264402.aspx\" rel=\"nofollow noreferrer\">Remember to add reference to word xx object library</a></strong></em></p>\n<blockquote>\n<p><em>1. From the Tools menu, choose References to display the References dialog box.</em></p>\n<p><em>2. The References dialog box shows all object libraries registered with the   operating system. Scroll through the list for the application whose object library you want to reference. If the application isn't listed, you can use the Browse button to search for object libraries (</em>.olb and <em>.tlb) or executable files (</em>.exe and <em>.dll on Windows). References whose check boxes are checked are used by your project; those that aren't checked are not used, but can be added.</em></p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 7643759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b263c2ba97079366d95fc6e65196bf19?s=128&d=identicon&r=PG&f=1", "display_name": "alii", "link": "https://stackoverflow.com/users/7643759/alii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1592873040, "creation_date": 1494458352, "last_edit_date": 1592873040, "question_id": 43904114, "link": "https://stackoverflow.com/questions/43904114/forward-email-with-a-table-in-the-body", "title": "Forward email with a table in the body", "body": "<p>I'm really new to using vba in Outlook.</p>\n\n<p>I was wondering if there is a way to write a script which can do the following\nWhen run, it can forward the email to a particular address and put a blank table in the body with 4 rows and 4 columns</p>\n\n<p>any help will be much appreciated\nThanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494458954, "post_id": 43904107, "comment_id": 74842339, "body": "So you want <code>rng.Offset(off,0)</code>?"}, {"owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494459785, "post_id": 43904107, "comment_id": 74842528, "body": "I only really put the rng part in there as a guide to the range I would be using. Essentially I would be putting in a set relationship of cell.offsets which would be able to rotate &quot;M&#246;bius strip style&quot; around the range(cells.rows(18), cells.rows(29))."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494461657, "post_id": 43904107, "comment_id": 74842899, "body": "What is REGCOL here ?  It would help if you could provide a specific concrete example of the behavior you want from this."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494461803, "post_id": 43904107, "comment_id": 74842922, "body": "For a rectangular range, <code>rng.cells(x)</code> will already work this way, since Excel counts cells across and then down (or &quot;row major&quot;)"}, {"owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "edited": false, "score": 0, "creation_date": 1494462129, "post_id": 43904107, "comment_id": 74842984, "body": "An example would be:  with      <code>range(cells.rows(18), cells.rows(29))</code> I want      <code>cells.rows(18).moboffset(-2, 0).select</code> ^where \u201d-2\u201d is \u201coff\u201d and \u201c0\u201d is \u201cregcol\u201d to select    <code>cells.rows(28)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494462657, "post_id": 43904107, "comment_id": 74843082, "body": "You need to explain <i>how</i> that happens...  Not in code but mechanistically how you arrive at that result."}, {"owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "edited": false, "score": 0, "creation_date": 1494462763, "post_id": 43904107, "comment_id": 74843103, "body": "It happens via the code in the function above.. where <code>if off &lt; 18 then res = 18 Mod off res2 = res - 1 off = 29 - res2 End If</code>   Mechanistically: 18 - 2 = 16, 18 mod 16 = 2, 2 - 1 = 1, 29 - 1 = 28"}], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1494461654, "creation_date": 1494461654, "answer_id": 43904518, "question_id": 43904107, "link": "https://stackoverflow.com/questions/43904107/creating-altered-version-of-offset-function-or-what-would-offset-function/43904518#43904518", "title": "Creating &quot;altered version of .Offset Function&quot; (or &quot;What would .Offset function look like if it were written in VBA?&quot;)", "body": "<p>The generic formula is </p>\n\n<pre><code>count = upper - lower + 1\n\nindex = (index - lower) % count + lower\n</code></pre>\n\n<p>so (Mod needs adjustment for negative numbers):</p>\n\n<pre><code>off = (off - 18) Mod 12 + 18\n\nIf off &lt; 18 Then off = off + 12\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494521038, "creation_date": 1494458311, "last_edit_date": 1494521038, "question_id": 43904107, "link": "https://stackoverflow.com/questions/43904107/creating-altered-version-of-offset-function-or-what-would-offset-function", "title": "Creating &quot;altered version of .Offset Function&quot; (or &quot;What would .Offset function look like if it were written in VBA?&quot;)", "body": "<p>I am trying to write an altered variant of VBA's Offset Function, which when a cell is offset by an amount which would ordinarily fall outside of a  specified range, instead takes the number of cells which exceed the range &amp; \"wraps\" them around from the start of the range again. </p>\n\n<p>I have scoured the net for someone who has written an example of what the .Offset Function would look like if it were written in VBA code, but nobody has done it.  </p>\n\n<p>Would anyone mind having a crack at what the .Offset Function would look like in VBA code?</p>\n\n<p>Incidentally, the type of alteration I would be making would be something like this:</p>\n\n<pre><code>Public Function MobOffset(off As Integer, REGCOL As Integer)\n\n\n'The code below is to be used with Range(Cells.Rows(18), Cells.Rows(29))\n\nRem insert .offset code here:\n\nIf off &gt; 29 Then\nres = off - 29\noff = res - 1 + 18\nEnd If\n\nIf off &lt; 18 Then\nres = 18 Mod off\nres2 = res - 1\noff = 29 - res2\nEnd If\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["javascript", "vba", "excel"], "comments": [{"owner": {"reputation": 1087, "user_id": 2484483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zQmyD.png?s=128&g=1", "display_name": "YetAnotherRandomUser", "link": "https://stackoverflow.com/users/2484483/yetanotherrandomuser"}, "edited": false, "score": 0, "creation_date": 1494465398, "post_id": 43904054, "comment_id": 74843672, "body": "Regarding your part about the <code>if</code> statement.  Are you trying to exit an <code>if</code> statement, or are you worried that if nothing happens, there will be a syntax failure?  For the former, you can use <code>Exit sub</code>, and for the latter, it will work just fine, though without an exit statement, the system will carry on to the next line of code outside of the <code>if</code>."}, {"owner": {"reputation": 11, "user_id": 7994359, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209217675972295/picture?type=large", "display_name": "lroyal", "link": "https://stackoverflow.com/users/7994359/lroyal"}, "reply_to_user": {"reputation": 1087, "user_id": 2484483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zQmyD.png?s=128&g=1", "display_name": "YetAnotherRandomUser", "link": "https://stackoverflow.com/users/2484483/yetanotherrandomuser"}, "edited": false, "score": 0, "creation_date": 1494595761, "post_id": 43904054, "comment_id": 74910053, "body": "At this point I think I am going to ditch VBA and go at this task with Python. VBA has to do it via browser manipulation and It will be scraping about 20k entries."}], "owner": {"reputation": 11, "user_id": 7994359, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209217675972295/picture?type=large", "display_name": "lroyal", "link": "https://stackoverflow.com/users/7994359/lroyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 973, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494482519, "creation_date": 1494457901, "last_edit_date": 1494482519, "question_id": 43904054, "link": "https://stackoverflow.com/questions/43904054/scraping-javascript-tables-with-vba", "title": "Scraping JavaScript tables with VBA", "body": "<p>After reading many many threads on here, I have decided I should join the community and hopefully gain some additional knowledge by getting some answers to questions I haven't seen answered. </p>\n\n<p>Currently, I am working on a VBA scraping macro that will cycle through different search request on a JavaScript rendered table. I can work the combo boxes and radio buttons to submit my request (thanks to this forum!), but I can not figure out how to pull the retrieved data out of the tables and place the data into an excel file. I am also trying to figure out how I can make an \"if\" statement if no results were found. Here is the code from the website when results are found. The picture also shows URL I am scraping. <a href=\"https://i.stack.imgur.com/McKxF.png\" rel=\"nofollow noreferrer\">Website code and URL</a></p>\n\n<p>My big issue is that I do not see ID elements anywhere to reference? </p>\n\n<p>When results show up, I need to follow the hyperlink of an individual and then scrape the data that is shown.</p>\n\n<p>My current code is:</p>\n\n<pre><code>Sub web_scraper()\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nmy_url = \"https://www.sircon.com/ComplianceExpress/Inquiry/consumerInquiry.do?nonSscrb=Y\"\n\nWith ie\n    .Visible = True\n    .navigate my_url\n    .Top = 50\n    .Left = 530\n    .Height = 800\n    .Width = 800\n\nDo Until Not ie.Busy And ie.readyState = 4\n    DoEvents\nLoop\n\nEnd With\n\nWith ie.document\n    .all.Item(\"state\").selectedindex = 2\n    .all.Item(\"state\").FireEvent (\"onchange\")\n    Application.Wait (Now + #12:00:02 AM#)\n    .all.Item(\"entityType\")(1).Click\n    Application.Wait (Now + #12:00:02 AM#)\n    .all.Item(\"AddressType\")(1).Click\n    .all.Item(\"maxRecords\").selectedindex = 4\n    .all.Item(\"qualificationType\").selectedindex = 16\nEnd With\n</code></pre>\n\n<p>Dim i As Long\nDim j As Long</p>\n\n<p>For i = 1 To 607</p>\n\n<pre><code>        ie.document.all.Item(\"city\").Value = Worksheets(\"Cycle\").Cells(i, 2).Value\n\n        For j = 1 To 676\n\n        ie.document.all.Item(\"lastName\").Value = Worksheets(\"Cycle\").Cells(j, 1)\n        ie.document.all.Item(\"submitButton\").Click\n</code></pre>\n\n<p>'click first link, scrape all data from page, return, go to next result, \n'follow hyperlink and scrape page, repeat until all results have been scraped. </p>\n\n<pre><code>        Next j\n\nNext i\n</code></pre>\n\n<p>The page can only pull 200 names at a time, so I am searching by city, and then by two letter combinations for last names (that are sourced from excel sheet). Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494456596, "post_id": 43903835, "comment_id": 74841728, "body": "Are you trying to insert a formula into the cell, or are you trying to place the actual value into the cell?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494457338, "post_id": 43903835, "comment_id": 74841942, "body": "And I assume the Excel formula you are trying to replace has a <code>,FALSE)</code> after the bit you showed (or, at least, a <code>)</code>) - is that correct?  Or are you trying to write a macro so that it leaves the current value in column T unchanged if column R does not contain a &quot;W&quot;?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494457947, "post_id": 43903835, "comment_id": 74842091, "body": "And which column are you trying to put the result into?  (Your current code doesn&#39;t line up with the formula in the question - e.g. you are looking to see whether column T contains &quot;W&quot; in your code but the question talks about column R containing &quot;W&quot;.  And your code is updating either column V or column Z, but your question says that column V is one of the inputs into the formula.  Etc.)"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494462346, "post_id": 43903971, "comment_id": 74843027, "body": "<code>ActiveCell</code> ?!?!  You should be ashamed of yourself ! ;)  (<code>myCel</code> perhaps?)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494476328, "post_id": 43903971, "comment_id": 74846214, "body": "@YowE3K - I know, I know! Ah, I was so focused on making the <code>mycel</code> reference, I didn&#39;t put it together that <code>Selection</code> <i>was</i> the <code>ActiveCell</code>. :O"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494476809, "post_id": 43903971, "comment_id": 74846366, "body": "A nice <code>With myCel</code> block wouldn&#39;t go astray either ;)  (I&#39;ll shut up now. :D)"}, {"owner": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494487220, "post_id": 43903971, "comment_id": 74851121, "body": "I made the changes and incorporated the edit as well. The code is not executing past the: ElseIf Abs(myCel.Offset(0, -8).Value) &lt; Abs(myCel.Offset(-1, 2).Value) Then"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494512469, "post_id": 43903971, "comment_id": 74869400, "body": "@user7994251 - (I edited the code, using <code>With</code> per YowE3K&#39;s note, it makes it a little easier to read I think) - Hm, I just tested the code and it&#39;s working for me.  If you step through the code with <code>F8</code>, does it skip that line, or just stop working, or...?  It may help to have a sample of the numbers you have to see if there&#39;s something else perhaps causing it to skip?"}, {"owner": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494523568, "post_id": 43903971, "comment_id": 74877119, "body": "@BruceWayne When I use F8 it just stops working. How can I send you the sample of data?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494523570, "post_id": 43903971, "comment_id": 74877120, "body": "@user7994251 - Just copy/paste some data into your original post (click &quot;Edit&quot;) and format it with <code>{}</code> so it looks okay. Or, at the very least, a screen shot of your info.  If it&#39;s sensitive info, just make up numbers or otherwise obfuscate the info."}, {"owner": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494524483, "post_id": 43903971, "comment_id": 74877655, "body": "@BruceWayne I made the edits. The data is in the link I provided at the end of the question."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494525930, "post_id": 43903971, "comment_id": 74878455, "body": "@user7994251 - Thanks. I duplicated some of the data, and it&#39;s looping properly through the code. See my edit, I tweaked it a little to (hopefully!) make sure it works.  Note that this part, <code>.FormulaR1C1 = &quot;=RC[-8]+R[-1]C[6]&quot;</code>, will look to Column <code>AB</code>. Is that the column you want? Or did you want to look at Col. <code>Z</code>? In which case, change it to <code>.FormulaR1C1 = &quot;=RC[-8]+R[-1]C[4]&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494529023, "post_id": 43903971, "comment_id": 74880141, "body": ".FormulaR1C1 = &quot;=RC[-8]+R[-1]C[6]&quot; is correct. The if statement should be returning the result in column T and not column V. &quot;Set myCel = Sheets(&quot;Personal&quot;).Range(&quot;T&quot; &amp; rw_cnt)&quot;. That was my mistake.                                               It&#39;s working! Thanks for your help this far.                                     Instead of having to specify the last row all the time, &quot;lastRow = .Cells(.Rows.Count, 22).End(xlUp).Row&#39;, how can I have the loop end when there is no more data in column L."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494529037, "post_id": 43903971, "comment_id": 74880150, "body": "@user7994251 - Do you mean you want <code>Set myCel = Sheets(&quot;Personal&quot;).Range(&quot;T&quot; &amp; rw_cnt)</code>? That would use the value in column T to determine all the <code>If</code> offsets are accurate...or if <code>myCel</code> is correct, then just adjust the <code>RC</code> value(s)...Edit: Just change <code>.Cells(.Rows.Count,22)...</code> to <code>.Cells(.Rows.Count,12)...</code> (the <code>12</code> refers to the column Number, which Col. L is..."}, {"owner": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494530716, "post_id": 43903971, "comment_id": 74881096, "body": "Makes sense. It works!! I will add the remaining part of the If statement to the macro using your updated statement and let you know if I have any questions. I really appreciate your help."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494531102, "post_id": 43903971, "comment_id": 74881276, "body": "@user7994251 - happy to help, glad it&#39;s working!  If you don&#39;t mind, you can mark the post as the answer by clicking the check mark left of the post itself (under the up/down arrows)."}, {"owner": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494872620, "post_id": 43903971, "comment_id": 75001941, "body": "For the line after the end with (.Range(&quot;X&quot; &amp; rw_cnt).FormulaR1C1 = &quot;=0&quot;) if the value is equal to zero, the macro is fine, if the value is not, the macro stops running. I tried changing the line to (.Range(&quot;x&quot; &amp; rw_cnt).FormulaR1C1 = &quot;=RC[-12]-RC[-4]&quot;) and got the error."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494880117, "post_id": 43903971, "comment_id": 75005692, "body": "@user7994251 - What do you mean? if the value you&#39;re trying  to set is 0, it&#39;s okay, but if you change to <code>.Range(&quot;Z&quot; &amp; rw_cnt).FormulaR1C1 = &quot;RC[-12]-RC[-4]&quot;</code> it gets an error?  What error does it throw?"}, {"owner": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494893159, "post_id": 43903971, "comment_id": 75010062, "body": "I mean that When I use F8 it just stops working at that line."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1494899950, "post_id": 43903971, "comment_id": 75011634, "body": "@user7994251 - &quot;it stops working&quot;, you mean it literally just ends the sub? or it throws an error, or it skips the line and goes to another one, etc.?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "edited": false, "score": 0, "creation_date": 1495740500, "post_id": 43903971, "comment_id": 75390559, "body": "@user7994251 I&#39;ll take another look, but his might be better as a new question...IIRC I couldn&#39;t duplicate the error."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1494525893, "last_edit_date": 1494525893, "creation_date": 1494457364, "answer_id": 43903971, "question_id": 43903835, "link": "https://stackoverflow.com/questions/43903835/excel-vba-if-elseif-else/43903971#43903971", "title": "Excel VBA If ElseIF else", "body": "<p>If I understand what you're trying to do correctly, it's take your <code>...Range(\"V\" &amp; rw_cnt)</code> cell and see if it's greater than 0, less than an absolute value of a cell left one col. and down 2 rows, or if two offset cells are less than 0...</p>\n\n<p>How does this work?</p>\n\n<pre><code>'I am having difficulties on this section.\nDim myCel As Range\nSet myCel = Sheets(\"Personal\").Range(\"V\" &amp; rw_cnt)\nWith myCel\n    If .Offset(0, -8).Value &gt; 0 Then\n        .FormulaR1C1 = \"=RC[-8]\"\n    ElseIf Abs(.Offset(0, -8).Value) &lt; Abs(.Offset(-1, 2).Value) Then\n        .FormulaR1C1 = \"=RC[-8]\"\n    ElseIf (.Offset(0, -6).Value + .Offset(0, -8).Value) &lt; 0 Then\n        .FormulaR1C1 = \"=RC[-8]+R[-1]C[6]\"\n    Else\n        .FormulaR1C1 = \"=-R[-1]C[7]\"\n    End If\nEnd with\n</code></pre>\n\n<p>Basically, where you have a formula, VBA is just interpreting that as a String.  Replace the R1C1 references with an Offset, and then it should work for you.  If the above doesn't do anything, or is incorrect, let me know...but see if you can understand what I'm trying, as I believe that's the crux of your main issue.</p>\n\n<p>edit: Instead of <code>ActiveCell</code>, use <code>myCell</code>.</p>\n\n<p>Edit2:\nEdit: Here's a \"tighter\" version of the code:</p>\n\n<pre><code>Private Sub looping()\nDim rw_cnt As Long, lastRow As Long\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nWith Sheets(\"Personal\")\n    lastRow = .Cells(.Rows.Count, 22).End(xlUp).Row\n    For rw_cnt = 8 To lastRow\n        If .Range(\"R\" &amp; rw_cnt).Value = \"W\" And .Range(\"R\" &amp; rw_cnt).Value &lt;&gt; \"\" Then\n            'I am having difficulties on this section.\n            Dim myCel As Range\n            Set myCel = Sheets(\"Personal\").Range(\"V\" &amp; rw_cnt)\n            With myCel\n                .Select\n                If .Offset(0, -8).Value &gt; 0 Then\n                    .FormulaR1C1 = \"=RC[-8]\"\n                ElseIf Abs(.Offset(0, -8).Value) &lt; Abs(.Offset(-1, 2).Value) Then\n                    .FormulaR1C1 = \"=RC[-8]\"\n                ElseIf (.Offset(0, -6).Value + .Offset(0, -8).Value) &lt; 0 Then\n                    .FormulaR1C1 = \"=RC[-8]+R[-1]C[6]\"\n                Else\n                    .FormulaR1C1 = \"=-R[-1]C[7]\"\n                End If\n            End With\n            .Range(\"Z\" &amp; rw_cnt).FormulaR1C1 = \"=0\"\n        End If\n    Next rw_cnt\nEnd With                     'Sheets(\"Personal\")\n\nMsgBox (\"Done!!!\")\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7994251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adcb9ba628d5dfa3707c85a7dee4942?s=128&d=identicon&r=PG&f=1", "display_name": "user7994251", "link": "https://stackoverflow.com/users/7994251/user7994251"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "accepted_answer_id": 43903971, "answer_count": 1, "score": 1, "last_activity_date": 1494525893, "creation_date": 1494456409, "last_edit_date": 1494524774, "question_id": 43903835, "link": "https://stackoverflow.com/questions/43903835/excel-vba-if-elseif-else", "title": "Excel VBA If ElseIF else", "body": "<p>Im having a little trouble with a code in excel vba. My goal is convert the following if statement to a VBA macro.</p>\n\n<p>The if Statement: </p>\n\n<pre><code>'=IF(R8=\"W\",\n'IF(L8&gt;0,L8,\n'IF(ABS(L8)&lt;ABS(V7),L8,\n'IF(N8+L8&lt;0,L8+Z7,-V7))),\n\n'IF(R8=\"A\",\n'IF(L8&gt;0,(V7/(V7+Z7)*L8),\n'IF(ABS(V7/(V7+Z7)*L8)&gt;V7,-V7,(V7/(V7+Z7)*L8))),\n\n'Added H not tested it yet\n'IF(AND(R9=\"H\",-L9&gt;Z8),Z8+L9,0)\n\n'IF(R8=\"C\",\n'IF(L8&gt;0,L8/2,\n'IF(AND((-L8/2)&lt;V7,(-L8/2&lt;Z7)),L8/2,\n'IF(AND(V7&lt;=0,Z7&lt;=0),L8/2,\n'IF(Z7+L8&gt;0,-V7,-V7+(L8+Z7+V7)/2)))),0)))\n</code></pre>\n\n<p>What I want to do is that If there is a W in column R, I want it to check if the amount in Column L is great that zero, if it true, return the amount in column L. If false check if the absolute value of the amount in column L is less than the absolute value of the amount in column V. If true, return the amount in column L otherwise sum the amount in column N and column L. If the sum is less than zero return the sum of the amount in column L and Z. If it's false return the amount in column v (make it negative).            </p>\n\n<p>My attempt to solve it.</p>\n\n<pre><code>   Private Sub looping()\n   Dim rw_cnt As Integer\n   Application.ScreenUpdating = False\n   Application.Calculation = xlCalculationManual\n   rw_cnt = 8\n   Do While Sheets(\"Personal\").Range(\"R\" &amp; rw_cnt).Value &lt;&gt; \"\"\n\n   If Sheets(\"Personal\").Range(\"R\" &amp; rw_cnt).Value = \"W\" Then\n\n        'I am having difficulties on this section. \n        Sheets(\"Personal\").Range(\"V\" &amp; rw_cnt).Select\n        If \"=RC[-8]\" &gt; 0 Then\n        ActiveCell.FormulaR1C1 = \"=RC[-8]\"\n        ElseIf Abs(\"=RC[-8]\") &lt; Abs(\"=R[-1]C[2\") Then\n        ActiveCell.FormulaR1C1 = \"=RC[-8]\"\n        ElseIf (\"=RC[-6]\" + \"=RC[-8]\") &lt; 0 Then\n        ActiveCell.FormulaR1C1 = \"=RC[-8]\" + \"=R[-1]C[6\"\n        Else\n        ActiveCell.FormulaR1C1 = \"=-R[-1]C[7\"\n        End If\n\n        Sheets(\"Personal\").Range(\"Z\" &amp; rw_cnt).Select\n        ActiveCell.FormulaR1C1 = \"=0\"\n  End If\n\n  rw_cnt = rw_cnt + 1\n  Loop\n  MsgBox (\"Done!!!\")\n\n  Application.ScreenUpdating = True\n  Application.Calculation = xlCalculationAutomatic\n  End Sub\n</code></pre>\n\n<p>Thanks in advance!! </p>\n\n<p><a href=\"https://i.stack.imgur.com/4KiVg.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/4KiVg.png</a></p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "edited": false, "score": 0, "creation_date": 1494866674, "post_id": 43903649, "comment_id": 74998662, "body": "I&#39;m sue that post has exactly what I need, but to be completely honest I need an interpreter to decipher the solution code for me.  I believe i&#39;m on the right path with my current code.  I am just not sure how to cycle through the &quot;rng&quot;.... can you help me with this last section?"}, {"owner": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "edited": false, "score": 0, "creation_date": 1494867618, "post_id": 43903649, "comment_id": 74999218, "body": "i&#39;m thinking the reason my code doesn&#39;t work is because I had the user input a range.  I now need to cycle through the values within the range.  I might be completely off base, and there may be an easier way to do this."}, {"owner": {"reputation": 956, "user_id": 3496240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e51d489805223fae1ef929503256e073?s=128&d=identicon&r=PG&f=1", "display_name": "gemmo", "link": "https://stackoverflow.com/users/3496240/gemmo"}, "reply_to_user": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "edited": false, "score": 0, "creation_date": 1495060599, "post_id": 43903649, "comment_id": 75098308, "body": "You need a variable to assign. So you have assigned &quot;rng&quot; as your variable. But you need to set your the value for rng. like ...   rng = cells(n+1,1).value    <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff196273.aspx</a>"}], "tags": [], "owner": {"reputation": 956, "user_id": 3496240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e51d489805223fae1ef929503256e073?s=128&d=identicon&r=PG&f=1", "display_name": "gemmo", "link": "https://stackoverflow.com/users/3496240/gemmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1494455174, "last_edit_date": 1495540971, "creation_date": 1494455174, "answer_id": 43903649, "question_id": 43903435, "link": "https://stackoverflow.com/questions/43903435/filter-a-pivot-table-based-on-values-from-a-user-defined-range/43903649#43903649", "title": "Filter a Pivot table based on values from a user defined range", "body": "<p>Try this\n<a href=\"https://stackoverflow.com/questions/11071662/filter-excel-pivot-table-using-vba\">Filter Excel pivot table using VBA</a></p>\n\n<p>You have to cycle through your range and make the pivot item visible, everything else hidden.</p>\n"}], "owner": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1494866729, "creation_date": 1494453833, "last_edit_date": 1494866729, "question_id": 43903435, "link": "https://stackoverflow.com/questions/43903435/filter-a-pivot-table-based-on-values-from-a-user-defined-range", "title": "Filter a Pivot table based on values from a user defined range", "body": "<p>I'm trying to set up a macro to filter a pivot table based on a user defined range. </p>\n\n<p>So far all I have is the prompt to get the range. Unfortunately, I have no idea how to take the values from the range and apply it to the filter.  Thanks for your help!</p>\n\n<pre><code>Sub foreachloop()\n\n  Dim wbmodel As Excel.Workbook\nSet wbmodel = ActiveWorkbook\n\nDim rng As Range\nDim Filter As String\n\n\n\n\n  With wbmodel.Sheets(\"Pivot_model\").PivotTables(\"Modelpivot\")\n\n    .ClearAllFilters\n\n     Set rng = Application.InputBox(\"select Range\", \"Inputs\", Type:=8)\n     Filter = Application.InputBox(\"select Filter\", \"Inputs\", Type:=8)\n\n     MsgBox rng.Address\n     MsgBox Filter\n\n\n    For Each PivotItem In .PivotFields(Filter).PivotItems\n    Select Case PivotItem.Name\n        Case rng\n            PivotItem.Visible = True\n        Case Else\n            PivotItem.Visible = False\n        End Select\n    Next PivotItem\n\n\n  End With\n\n  End Sub\n</code></pre>\n\n<p>Ok. so I made some (slight) updates.  I made my first \"For Each\" loop.  Now, I know I will need to do a similar \"for each\" loop to apply the filter.  I've been battling with the code for a few hours and I am unsure where to go next.</p>\n"}, {"tags": ["vba", "combobox", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": true, "score": 1, "last_activity_date": 1494454799, "creation_date": 1494454799, "answer_id": 43903587, "question_id": 43903400, "link": "https://stackoverflow.com/questions/43903400/vba-passing-a-parameter-to-represent-the-number-of-columns-to-be-added-to-combo/43903587#43903587", "title": "VBA: passing a parameter to represent the number of columns to be added to combobox", "body": "<p>Construct your string in a variable that then you pass to the <code>AddItem()</code> function. Start with empty string <code>\"\"</code> and then in the loop, add to the previous value. Use the counter as your index for the <code>avarRecords()</code> function:</p>\n\n<pre><code>Dim c As Integer\nDim s As String\n\nFor intRecord = 0 To UBound(avarRecords, 2)\n    s = \"\"\n    For c = 0 To pCols\n        s = s &amp; avarRecords(c, intRecord) &amp; \";\"\n    Next c\n\n    pCombo.AddItem (s)\nNext intRecord\n</code></pre>\n"}], "owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 43903587, "answer_count": 1, "score": 1, "last_activity_date": 1494454799, "creation_date": 1494453648, "question_id": 43903400, "link": "https://stackoverflow.com/questions/43903400/vba-passing-a-parameter-to-represent-the-number-of-columns-to-be-added-to-combo", "title": "VBA: passing a parameter to represent the number of columns to be added to combobox", "body": "<p>I am working on MS Access 2013/ VBA. function that initializes all the combo-boxes that are on a form. This function is called in the Load event of the form.</p>\n\n<p>I am adding an initialize function for each of the combo boxes on the form, and this is very redundant, no mentioning that there are over 35+ combo-boxes on the form and the multiple tabs that the form also has. </p>\n\n<p>My ideal is to have only one initialize function, and call it still from the load event, perhaps multiple times, but passing the necessary parameters to process each individual combo-box.</p>\n\n<p>What I have right now (each call is calling a function that does basically the same):</p>\n\n<pre><code>Private Sub Form_Load()\n\n    Call InitializePriceCategory\n    Call InitializePublisher\n    Call InitializeAutoSearch\n    Call InitializeConsultingFee\n    Call InitializePermissionCode    \n\n    On Error GoTo errhandler\n\neofit:\n\n    Exit Sub\n\nerrhandler:\n\n    z = ErrorFunction(Err, Err.Description, Erl, \"Form_Load\")\n\n    Err = 0\n\n    Select Case z\n        Case 0: Resume Next\n        Case 1: GoTo eofit\n    End Select\nEnd Sub\n</code></pre>\n\n<p>The only thing that changes for each function, is the select query that gets executed, the combo-box, and the number of columns that each specific combo-box needs to show. </p>\n\n<p>Example of the function InitializePriceCategory:</p>\n\n<pre><code>Public Function InitializePriceCategory()\n\n    Dim ADOCon As ADODB.Connection\n    Dim ADORS As ADODB.Recordset\n    Dim avarRecords As Variant\n    Dim avarTransposedArray As Variant\n    Dim avarOriginalArray As Variant\n    Dim intRecord As Integer\n    Dim strSQL As String\n\n    On Error GoTo errhandler\n\n    strSQL = \"SELECT DISTINCT\" &amp; _\n             \"  [Category]\" &amp; _\n             \", [ProductDescription]\" &amp; _\n             \", [BasePrice]\" &amp; _\n             \", [AdditionalPrintPrice]\" &amp; _\n             \", [MinimumPurchaseAmount]\" &amp; _\n             \", [isChoral]\" &amp; _\n             \", [isScoringBasedMinAmount]\" &amp; _\n             \", [isTierBased] \" &amp; _\n             \"FROM [dbo].[z_PriceCategories] \" &amp; _\n             \"ORDER BY [Category]\"\n\n    Set ADOCon = New ADODB.Connection\n    With ADOCon\n        .ConnectionString = GetConnectionString(\"Conn\")\n        .Open\n    End With\n\n    Set ADORS = New ADODB.Recordset\n    With ADORS\n        .ActiveConnection = ADOCon\n        .Open strSQL, , adOpenStatic, adLockReadOnly\n        .MoveLast\n        .MoveFirst\n        avarRecords = .GetRows(.RecordCount)\n    End With\n\n    For intRecord = 0 To UBound(avarRecords, 2)\n\n        ' Check for commas within the string on column 1 (description),\n        ' otherwise the value gets truncated\n        If InStr(avarRecords(1, intRecord), \",\") &gt; 0 Then\n            avarRecords(1, intRecord) = \"\"\"\" &amp; avarRecords(1, intRecord) &amp; \"\"\"\"\n        End If\n\n        PriceCategory.AddItem (avarRecords(0, intRecord) &amp; \";\" &amp; _\n                               avarRecords(1, intRecord) &amp; \";\" &amp; _\n                               avarRecords(2, intRecord) &amp; \";\" &amp; _\n                               avarRecords(3, intRecord) &amp; \";\" &amp; _\n                               avarRecords(4, intRecord) &amp; \";\" &amp; _\n                               avarRecords(5, intRecord) &amp; \";\" &amp; _\n                               avarRecords(6, intRecord) &amp; \";\" &amp; _\n                               avarRecords(7, intRecord))\n\n    Next intRecord\neofit:\n\n    On Error Resume Next\n\n    ADOCon.Close: Set ADOCon = Nothing\n    ADORS.Close: Set ADORS = Nothing\n\n    Exit Function\n\nerrhandler:\n\n    z = ErrorFunction(Err, Err.Description, Erl, \"InitializePriceCategory\", , True)\n\n    Err = 0\n\n    Select Case z\n        Case 0: Resume Next\n        Case 1: GoTo eofit\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>The biggest difference and most challenging for me to figure out how to work out, among each of the initialize functions so that I can have only one initialize function, is the number of columns.</p>\n\n<p>My goal is to have something simple on the form load code:</p>\n\n<pre><code>Private Sub Form_Load()\n\n    On Error GoTo errhandler\n\n    Call InitializeCombo(Me.PriceCategory, \"SELECT col1, col2, col3, col4, col5, col6, col7, col8 FROM PriceCategory \", 8, \",\")\n    Call InitializeCombo(Me.PublisherName, \"SELECT col1, col2 FROM Publishers \", 2, \"\"\"\")\n\neofit:\n\n    Exit Sub\n\nerrhandler:\n\n    z = ErrorFunction(Err, Err.Description, Erl, \"Form_Load\")\n\n    Err = 0\n\n    Select Case z\n        Case 0: Resume Next\n        Case 1: GoTo eofit\n    End Select\nEnd Sub\n</code></pre>\n\n<p>And then the InitializeCombo function code to be (incomplete idea):</p>\n\n<pre><code>Public Function InitializeCombo(pCombo As ComboBox, pQuery As String, pCols As Integer, Optional pSpecialCharacter As String)\n\n    Dim ADOCon As ADODB.Connection\n    Dim ADORS As ADODB.Recordset\n    Dim avarRecords As Variant\n    Dim avarTransposedArray As Variant\n    Dim avarOriginalArray As Variant\n    Dim intRecord As Integer    \n\n    On Error GoTo errhandler\n\n    Set ADOCon = New ADODB.Connection\n    With ADOCon\n        .ConnectionString = GetConnectionString(\"Conn\")\n        .Open\n    End With   \n\n    Set ADORS = New ADODB.Recordset\n    With ADORS\n        .ActiveConnection = ADOCon\n        .Open pQuery, , adOpenStatic, adLockReadOnly\n        .MoveLast\n        .MoveFirst\n        avarRecords = .GetRows(.RecordCount)\n    End With\n\n    ' ON THIS PART I AM NOT SURE HOW TO STILL BE ABLE TO DO THE SPECIAL CHARACTER CHECK \n    If InStr(avarRecords(1, intRecord), \"\"\"\") &gt; 0 Then\n        avarRecords(1, intRecord) = \"'\" &amp; avarRecords(1, intRecord) &amp; \"'\"\n    End If\n\n    For intRecord = 0 To UBound(avarRecords, 2)\n\n        ' ON THIS PART, I DO NOT KNOW HOW TO INSTRUCT/ LOOP TO USE THE NUMBER OF COLUMNS PARAMETER \n        ' AND ADD THE NUMBER OF COLUMNS NEEDED; WHETHER ONE COMBO-BOX NEEDS 8 AND THE NEXT ONE ONLY NEEDS 2.\n        pCombo.AddItem (avarRecords(0, intRecord) &amp; \";\" &amp; _\n                        avarRecords(1, intRecord) &amp; \";\")\n\n    Next intRecord\n\neofit:\n\n    On Error Resume Next\n\n    ADOCon.Close: Set ADOCon = Nothing\n    ADORS.Close: Set ADORS = Nothing\n\n    Exit Function\n\nerrhandler:\n\n    z = ErrorFunction(Err, Err.Description, Erl, \"InitializeCombo\", , True)\n    Err = 0\n    Select Case z\n        Case 0: Resume Next\n        Case 1: GoTo eofit\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>I am thinking that what I need is to add another loop inside the first for loop that iterates through the records array, but I am not sure how to add this part.</p>\n\n<p>I hope I can get some help on this issue as I think that I am close to get it right, I just ran into a roadblock I have not been able to figure out. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 135, "user_id": 5104055, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8199307b213a1c7fc74ff82098bf2f98?s=128&d=identicon&r=PG&f=1", "display_name": "acvbasql", "link": "https://stackoverflow.com/users/5104055/acvbasql"}, "edited": false, "score": 0, "creation_date": 1494453295, "post_id": 43903252, "comment_id": 74840593, "body": "Edit, nevermind, my initial thought wouldn&#39;t work &amp; I have to take off.  It&#39;s definitely doable, just need to spend more time looking.  Sorry."}, {"owner": {"reputation": 2034, "user_id": 2304204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mM66T.jpg?s=128&g=1", "display_name": "Oleg Imanilov", "link": "https://stackoverflow.com/users/2304204/oleg-imanilov"}, "edited": false, "score": 0, "creation_date": 1494453365, "post_id": 43903252, "comment_id": 74840630, "body": "You can try to use countif function. If &quot;countif(&lt;range&gt;,&lt;first-cell-in-range&gt;)&quot; equals to number of cells in that range - means all are same."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494453864, "post_id": 43903252, "comment_id": 74840804, "body": "Can you sort the data first? That would make it a bit quicker."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1494453927, "post_id": 43903252, "comment_id": 74840816, "body": "Simply add a third column, where you unite the first two columns. Then remove all non-uniques."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494455232, "post_id": 43903252, "comment_id": 74841287, "body": "Why don&#39;t you also want to keep <code>|11111 |BBBBB </code>, and <code>33333 | CCCCC</code> and <code>33333 | BBBBB</code>? Edit: wait ...so you also want to edit data too? From your entire set of data you put at the top, <i>all</i> you want to keep is what&#39;s at the end, &quot;KEEP&quot;?"}, {"owner": {"reputation": 35, "user_id": 7793800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd8062b5e56605f631d8291101465be?s=128&d=identicon&r=PG&f=1", "display_name": "CP1127", "link": "https://stackoverflow.com/users/7793800/cp1127"}, "edited": false, "score": 0, "creation_date": 1494475121, "post_id": 43903252, "comment_id": 74845909, "body": "The data is sorted by the values in column A. There are multiple occurrences of the same value in column A, which I was referring to as sets. What I am looking for are ones where the value in column B changes within the set. In my example of an occurence I would like to remove, column A and B are the same values on each row. In the example I would want to keep, column B changes on one of the rows."}, {"owner": {"reputation": 35, "user_id": 7793800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd8062b5e56605f631d8291101465be?s=128&d=identicon&r=PG&f=1", "display_name": "CP1127", "link": "https://stackoverflow.com/users/7793800/cp1127"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494475390, "post_id": 43903252, "comment_id": 74845985, "body": "Sorry for the confusion @BruceWayne , I have updated the example to reflect what I am trying to do."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7793800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd8062b5e56605f631d8291101465be?s=128&d=identicon&r=PG&f=1", "display_name": "CP1127", "link": "https://stackoverflow.com/users/7793800/cp1127"}, "edited": false, "score": 0, "creation_date": 1494511838, "post_id": 43903811, "comment_id": 74868900, "body": "Thank you @DavidPedack, but the only issue is I need to keep the entire dataset if there is a change. The macro is deleting every line except the line where there is a change. I am trying to eliminate the sets where every line is the same and keep the sets if there are any changes in column B."}, {"owner": {"reputation": 35, "user_id": 7793800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd8062b5e56605f631d8291101465be?s=128&d=identicon&r=PG&f=1", "display_name": "CP1127", "link": "https://stackoverflow.com/users/7793800/cp1127"}, "edited": false, "score": 0, "creation_date": 1494540945, "post_id": 43903811, "comment_id": 74886060, "body": "Thank you @DavidPedack, it worked! I appreciate your time and help!"}], "tags": [], "owner": {"reputation": 497, "user_id": 3776309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7004e0b78bf0a646c8b3ab1df1ee194?s=128&d=identicon&r=PG&f=1", "display_name": "David Pedack", "link": "https://stackoverflow.com/users/3776309/david-pedack"}, "is_accepted": true, "score": 1, "last_activity_date": 1494527097, "last_edit_date": 1494527097, "creation_date": 1494456189, "answer_id": 43903811, "question_id": 43903252, "link": "https://stackoverflow.com/questions/43903252/remove-matching-datasets/43903811#43903811", "title": "Remove matching datasets", "body": "<p>Looks like you reworked your question, that makes more sense now...  Assuming your data looks like the following when you start, with the data starting in Row 1 (no column header):</p>\n\n<pre><code>|11111 |AAAAA|\n|11111 |AAAAA|\n|11111 |AAAAA|\n|11111 |AAAAA|\n|22222 |AAAAA|\n|22222 |BBBBB|\n|22222 |AAAAA|\n|33333 |AAAAA|\n|33333 |CCCCC|\n|33333 |AAAAA|\n|33333 |BBBBB|\n</code></pre>\n\n<p>The following would work:</p>\n\n<pre><code>Sub decideOnYourOwnNameForThis()\n\nendRow = Range(\"A1\").End(xlDown).Row\n\n'setup formulas\nRange(\"C2\").Formula = \"=IF(A2=A1,IF(B2&lt;&gt;B1,1,0), 0)\"\n\n'select the first formula row and copy\nRange(\"C2\").Select\nSelection.Copy\n\n'paste in the formulas\nRange(\"C2:C\" &amp; endRow).Select\nSelection.PasteSpecial Paste:=xlPasteFormulas\n\n'destroy the forumulas\nRange(\"C2:C\" &amp; endRow).Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues\n\n'fill up an array of col A values that you'd like to keep\nDim myArray() As String\naa = 1\n\nFor i = 2 To endRow\n    If Cells(i, 3) = 1 Then\n        ReDim Preserve myArray(1 To aa) As String\n        myArray(aa) = Cells(i, 1)\n        aa = aa + 1\n    End If\nNext i\n\n\n'work backward and delete any row where col A is not contained in the array\nFor i = endRow To 1 Step -1\n\n    boolContained = False\n    For j = LBound(myArray) To UBound(myArray)\n        If Cells(i, 1) = myArray(j) Then\n            boolContained = True\n            Exit For\n        End If\n    Next j\n\n    If Not boolContained Then\n        Rows(i &amp; \":\" &amp; i).Select\n        Selection.Delete Shift:=xlUp\n    End If\n\nNext i\n\n'remove the column if you don't want it\nColumns(\"C:C\").Select\nSelection.Delete Shift:=xlToLeft\n\nEnd Sub\n</code></pre>\n\n<p>Finally, run your splitter code if you want the breaks, you can embed this before the End Sub above:</p>\n\n<pre><code>Call InsertBlankRowWhenValueChanges\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7793800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd8062b5e56605f631d8291101465be?s=128&d=identicon&r=PG&f=1", "display_name": "CP1127", "link": "https://stackoverflow.com/users/7793800/cp1127"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 43903811, "answer_count": 1, "score": 0, "last_activity_date": 1494527097, "creation_date": 1494452877, "last_edit_date": 1494475237, "question_id": 43903252, "link": "https://stackoverflow.com/questions/43903252/remove-matching-datasets", "title": "Remove matching datasets", "body": "<p>I have a sheet that lists data as follows:</p>\n\n<pre><code>|  A   |   B  |\n|11111 |AAAAA |\n|11111 |AAAAA |\n|11111 |AAAAA |\n|      |      |\n|22222 |AAAAA |\n|22222 |BBBBB |\n|22222 |AAAAA |\n|      |      |\n|33333 |AAAAA |\n|33333 |CCCCC |\n|33333 |AAAAA |\n|33333 |BBBBB |\n</code></pre>\n\n<p>The original data is not divided by blank rows. I wanted to divide the data into sets so I used the following macro to add a blank row whenever the value in Column A changes:</p>\n\n<pre><code>Sub InsertBlankRowWhenValueChanges()\n\nDim Rng As Range\nDim WorkRng As Range\nOn Error Resume Next\nxTitleId = \"Select Range\"\n    Set WorkRng = Application.Selection\n    Set WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\n\nApplication.ScreenUpdating = False\n    For i = WorkRng.Rows.Count To 2 Step -1\n        If WorkRng.Cells(i, 1).Value &lt;&gt; WorkRng.Cells(i - 1, 1).Value Then\n        WorkRng.Cells(i, 1).EntireRow.Insert\n        End If\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I need to somehow only keep the datasets that have changes in column B. If all of the data rows in column B match, the entire set can be removed.</p>\n\n<p>Example:</p>\n\n<p>REMOVE</p>\n\n<pre><code>|11111 |AAAAA |\n|11111 |AAAAA |\n|11111 |AAAAA |\n</code></pre>\n\n<p>KEEP</p>\n\n<pre><code>|22222 |AAAAA |\n|22222 |BBBBB |\n|22222 |AAAAA |\n</code></pre>\n\n<p>Is there anyway that this can be done?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 13019092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e243ab94f6ddd80c64f404983602204?s=128&d=identicon&r=PG&f=1", "display_name": "christian estrella", "link": "https://stackoverflow.com/users/13019092/christian-estrella"}, "edited": false, "score": 0, "creation_date": 1583507952, "post_id": 43903171, "comment_id": 107152300, "body": "<a href=\"https://stackoverflow.com/questions/60565181/fill-specific-text-for-a-specific-column/60566813#60566813\" title=\"fill specific text for a specific column\">stackoverflow.com/questions/60565181/&hellip;</a> Can you help me this link as well?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7994080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vkDG4B2solY/AAAAAAAAAAI/AAAAAAAAAJk/Ydkdoj8Egm4/photo.jpg?sz=128", "display_name": "Peter Alberto", "link": "https://stackoverflow.com/users/7994080/peter-alberto"}, "edited": false, "score": 0, "creation_date": 1496076830, "post_id": 43903446, "comment_id": 75503026, "body": "That worked perfectly! Wow, thanks so much!  I REALLY appreciate the help!"}, {"owner": {"reputation": 463, "user_id": 2426635, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/90350e6379ff5cda8c004a264bd6c4a5?s=128&d=identicon&r=PG", "display_name": "pwwolff", "link": "https://stackoverflow.com/users/2426635/pwwolff"}, "reply_to_user": {"reputation": 1, "user_id": 7994080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vkDG4B2solY/AAAAAAAAAAI/AAAAAAAAAJk/Ydkdoj8Egm4/photo.jpg?sz=128", "display_name": "Peter Alberto", "link": "https://stackoverflow.com/users/7994080/peter-alberto"}, "edited": false, "score": 0, "creation_date": 1496302280, "post_id": 43903446, "comment_id": 75607646, "body": "Happy to hear it :) - I had been looking for this for a long time myself, use it all the time. Ultimately found the basis for this on SO. If this solved your problem, could you accept the answer?"}], "tags": [], "owner": {"reputation": 463, "user_id": 2426635, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/90350e6379ff5cda8c004a264bd6c4a5?s=128&d=identicon&r=PG", "display_name": "pwwolff", "link": "https://stackoverflow.com/users/2426635/pwwolff"}, "is_accepted": false, "score": 0, "last_activity_date": 1494453878, "creation_date": 1494453878, "answer_id": 43903446, "question_id": 43903171, "link": "https://stackoverflow.com/questions/43903171/find-last-row-select-specific-column-in-row/43903446#43903446", "title": "Find last row, select specific column in row", "body": "<p>1) Define a function to copy some text to the clipboard:</p>\n\n<pre><code>Sub CopyText(Text As String)\n    'VBA Macro using late binding to copy text to clipboard.\n    'By Justin Kay, 8/15/2014\n    Dim MSForms_DataObject As Object\n    Set MSForms_DataObject = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    MSForms_DataObject.SetText Text\n    MSForms_DataObject.PutInClipboard\n    Set MSForms_DataObject = Nothing\nEnd Sub\n</code></pre>\n\n<p>Then something like this:</p>\n\n<pre><code>Sub GetLastTimestampAndCopy()\n    dim ws as worksheet\n    dim strValue as string\n    dim lngLastRow as long\n\n    set ws = Activeworkbook.Worksheets(\"LOG\")\n\n    ' Get the last populated cell in the first column\n    lngLastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n    ' Get corresponding value in the same row but in column I\n    strValue = ws.Cells(lngLastRow, 9).Value\n\n    CopyText strValue\nEnd Sub\n</code></pre>\n\n<p>Execute the second SUB and you should have the value on your clipboard.</p>\n"}], "owner": {"reputation": 1, "user_id": 7994080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vkDG4B2solY/AAAAAAAAAAI/AAAAAAAAAJk/Ydkdoj8Egm4/photo.jpg?sz=128", "display_name": "Peter Alberto", "link": "https://stackoverflow.com/users/7994080/peter-alberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 723, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494575953, "creation_date": 1494452455, "last_edit_date": 1494575953, "question_id": 43903171, "link": "https://stackoverflow.com/questions/43903171/find-last-row-select-specific-column-in-row", "title": "Find last row, select specific column in row", "body": "<p>I'm just starting to learn VBA and I've tried to find solutions here but to no avail. I'm seeking a VBA macro for this:</p>\n\n<p>I have a sheet in my workbook called LOG that gets a timestamp in column A when I start to fill the row.  Once I've completed a task I use <code>=CONCATENATE</code> in column I to summarize the rows A through H.  Column I has the formula content filled down to row 300 or more. Column A is blank until I enter a time-stamp \n ( \"ctrl + :\" ).</p>\n\n<p>What I am seeking to do is run a macro through a command button where it will find the last timestamped row in column A, and then select and copy contents (not the formula) of that row in column I to clipboard.</p>\n\n<p>I've tried to modify so many different suggestions I've found in stackoverflow but with little success. I'm not sure really what I'm doing wrong and I've tried so many of them I don't know which I would share with you for an example. Any help would be very appreciated! Thanks again!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494451847, "post_id": 43902921, "comment_id": 74839990, "body": "Are you using English/American/etc regional settings, or something else?  (I think some of the other regional versions of Excel, use something other than &quot;mm&quot; for month)"}, {"owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 0, "creation_date": 1494451921, "post_id": 43902921, "comment_id": 74840020, "body": "Can we see what is in cell AG1?  I just tried this code on my own data and it seems to work fine.  What happens when you try to format the whole date using a single <code>Format</code> call like this:  <code>Format(Range(&quot;AG1&quot;), &quot;yyyy-mm-dd&quot;)</code>?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494452073, "post_id": 43902921, "comment_id": 74840092, "body": "Also try temporarily setting cell AG1 to be General format, and see whether it becomes a number such as 42866 - just to make sure we are dealing with a valid date."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1494452265, "post_id": 43902921, "comment_id": 74840167, "body": "The day part of your data in AG1 wouldn&#39;t happen to be 1 by any chance?"}, {"owner": {"reputation": 1071, "user_id": 1227058, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cbacebe081b945a7494edb55e1ba8262?s=128&d=identicon&r=PG", "display_name": "Matteo", "link": "https://stackoverflow.com/users/1227058/matteo"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494452296, "post_id": 43902921, "comment_id": 74840183, "body": "@YowE3K - Yes, &quot;$-en-&quot; format...  and I tried to Generalize it, to no avail...  AG1 just contains a date, in date format &quot;mm/dd/yyy&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1494452359, "post_id": 43902921, "comment_id": 74840205, "body": "What does <code>?range(&quot;ag1&quot;).value2</code> return from the VBE&#39;s Immediate window? (use Ctrl+G to get the Immediate window) <a href=\"https://stackoverflow.com/posts/43902921/edit\">edit</a> and you <b>really</b> should specify a parent worksheet unless in a private worksheet code sheet."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494452662, "post_id": 43902921, "comment_id": 74840314, "body": "If changing the cell to General format in Excel didn&#39;t change the cell to display a number, you haven&#39;t got a date in the cell - you just have something that looks like a date.  But, even so, <code>Format(text_that_looks_like_a_date, &quot;mm&quot;)</code> should implicitly convert the text to a <code>Date</code> prior to the formatting, so I&#39;m not sure why it wouldn&#39;t work."}, {"owner": {"reputation": 1071, "user_id": 1227058, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cbacebe081b945a7494edb55e1ba8262?s=128&d=identicon&r=PG", "display_name": "Matteo", "link": "https://stackoverflow.com/users/1227058/matteo"}, "edited": false, "score": 0, "creation_date": 1494452695, "post_id": 43902921, "comment_id": 74840330, "body": "@Jeeped - it returns 42826"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494452773, "post_id": 43902921, "comment_id": 74840365, "body": "If you put <code>04&#47;02&#47;2017</code> into AG1, does your function now return 2?  And is your locale set to use &quot;dd/mm/yyyy&quot; format?  If you have text in the cell, and Excel can interpret it as a valid dd/mm/yyyy date, it will. If it can&#39;t, it will try to interpret it as a mm/dd/yyyy date."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494452846, "post_id": 43902921, "comment_id": 74840399, "body": "I think you nailed it @YowE3K. Strictly a DMY vs MDY issue."}, {"owner": {"reputation": 1071, "user_id": 1227058, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cbacebe081b945a7494edb55e1ba8262?s=128&d=identicon&r=PG", "display_name": "Matteo", "link": "https://stackoverflow.com/users/1227058/matteo"}, "edited": false, "score": 0, "creation_date": 1494453079, "post_id": 43902921, "comment_id": 74840507, "body": "&quot;mm/01/yyyy&quot; format being used here..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1494453222, "post_id": 43902921, "comment_id": 74840566, "body": "... and yet it is returning <b>1</b> as the month ... curious. Edit your question to include several examples of dates; both with amigous day/months and without. Show the results you are receiving and state what you want to receive."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494453255, "post_id": 43902921, "comment_id": 74840580, "body": "@Jeeped - but that doesn&#39;t <b>really</b> explain it, does it?  If <code>Value2</code> is returning 42826, then it is a date of 1 April 2017 in the cell.  The difference between <code>Value2</code> and <code>Value</code> shouldn&#39;t affect things if the OP is in a  mm/dd/yyyy locale and is displaying in mm/dd/yyyy format.  I always get confused with this stuff!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494453500, "post_id": 43902921, "comment_id": 74840677, "body": "@Matteo - just to confirm ... <code>&quot;mm&#47;01&#47;yyyy&quot; format being used here</code> - you mean that your computer is set to a mm/dd/yyyy date display format, not just that that cell within Excel is formatted as mm/dd/yyyy?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494453738, "post_id": 43902921, "comment_id": 74840756, "body": "@YowE3K - It is hard to say. Without several examples of dates and what they are producing I am simply using Occam&#39;s razor to determine the root cause. If he is getting Jan from 04/01/2017 (e.g. 01-Apr-2017) then it seems to be logical that  it is somehow a DMY."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1494453821, "post_id": 43902921, "comment_id": 74840787, "body": "Just for the record.... it is a little late for an April Fool&#39;s joke."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494453950, "post_id": 43902921, "comment_id": 74840821, "body": "@Jeeped - That comment had me laughing for the last 20 seconds - people will start noticing that I am not working when I should be!"}, {"owner": {"reputation": 1071, "user_id": 1227058, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cbacebe081b945a7494edb55e1ba8262?s=128&d=identicon&r=PG", "display_name": "Matteo", "link": "https://stackoverflow.com/users/1227058/matteo"}, "edited": false, "score": 0, "creation_date": 1494454766, "post_id": 43902921, "comment_id": 74841122, "body": "Ok, I&#39;m not sure what happened, but it&#39;s working as intended.  I think maybe I wasn&#39;t checking the right output filename.  Regardless, thanks to all and I&#39;ll post the final code down below..."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494451518, "post_id": 43902950, "comment_id": 74839852, "body": "<code>mm</code> is intended to return the month, with leading <code>0</code> if less than 10.  And <code>dd</code> is intended to return the day, with leading <code>0</code> if less than 10."}, {"owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 0, "creation_date": 1494451694, "post_id": 43902950, "comment_id": 74839925, "body": "@MiguelFebres The problem is not the date format (returning &quot;01&quot; instead of &quot;1&quot;), but that it is returning the wrong number (&quot;01&quot; instead of anything)"}], "tags": [], "owner": {"reputation": 1839, "user_id": 2744388, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/d54f9631b5946e19db875c7d3c018567?s=128&d=identicon&r=PG", "display_name": "Miguel Febres", "link": "https://stackoverflow.com/users/2744388/miguel-febres"}, "is_accepted": false, "score": 0, "last_activity_date": 1494451460, "creation_date": 1494451460, "answer_id": 43902950, "question_id": 43902921, "link": "https://stackoverflow.com/questions/43902921/vba-for-excel-misbehaving-doesnt-return-the-right-value/43902950#43902950", "title": "VBA for Excel misbehaving... doesn&#39;t return the right value", "body": "<p>According to this table you should be using \"m\"</p>\n\n<pre><code>No. Formatting code Display as      Example\n1   ddd             Weekday name    Sat\n2   dddd            Weekday name    Saturday\n3   mmm             Month  name     Jan\n4   mmmm            Month name      January\n5   m               Month           1\n6   d               Day             17\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1494455508, "post_id": 43903598, "comment_id": 74841409, "body": "I&#39;d recommend that you change <code>Year(Range(&quot;AG1&quot;)) &amp; &quot;-&quot; &amp; Format(Range(&quot;AG1&quot;), &quot;mm&quot;)</code> to be <code>Format(Range(&quot;AG1&quot;), &quot;yyyy-mm&quot;)</code> - just for readability reasons."}], "tags": [], "owner": {"reputation": 1071, "user_id": 1227058, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cbacebe081b945a7494edb55e1ba8262?s=128&d=identicon&r=PG", "display_name": "Matteo", "link": "https://stackoverflow.com/users/1227058/matteo"}, "is_accepted": true, "score": 0, "last_activity_date": 1494454848, "creation_date": 1494454848, "answer_id": 43903598, "question_id": 43902921, "link": "https://stackoverflow.com/questions/43902921/vba-for-excel-misbehaving-doesnt-return-the-right-value/43903598#43903598", "title": "VBA for Excel misbehaving... doesn&#39;t return the right value", "body": "<p>Here's the final code that worked for me...</p>\n\n<pre><code>Private Sub btnCreate_Click()\n  ActiveSheet.Copy\n  Application.ExecuteExcel4Macro \"show.toolbar(\"\"Ribbon\"\",False)\"\n  ActiveSheet.Shapes.Range(Array(\"btnCreate\")).Select\n  Selection.Delete\n  ActiveWorkbook.SaveAs \"C:\\Users\\\" &amp; (Environ$(\"Username\")) &amp; \"\\Desktop\\\" &amp; \"Timecard, \" &amp; Year(Range(\"AG1\")) &amp; \"-\" &amp; Format(Range(\"AG1\"), \"mm\") &amp; \" - \" &amp; _\n    Range(\"R2\").Value &amp; \", \" &amp; Range(\"T2\").Value, xlOpenXMLWorkbookMacroEnabled\n  ActiveWindow.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1071, "user_id": 1227058, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cbacebe081b945a7494edb55e1ba8262?s=128&d=identicon&r=PG", "display_name": "Matteo", "link": "https://stackoverflow.com/users/1227058/matteo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 43903598, "answer_count": 2, "score": 0, "last_activity_date": 1494454848, "creation_date": 1494451172, "question_id": 43902921, "link": "https://stackoverflow.com/questions/43902921/vba-for-excel-misbehaving-doesnt-return-the-right-value", "title": "VBA for Excel misbehaving... doesn&#39;t return the right value", "body": "<p>I have the following function in my worksheet...</p>\n\n<p><code>Format(Range(\"AG1\"), \"mm\")</code></p>\n\n<p>I'm using it to auto-populate the saveas filename, which is a larger function, but it all works except for this part.  As part of that larger function there is</p>\n\n<p><code>Year(Range(\"AG1\"))</code></p>\n\n<p>which is returning the correct year in \"yyyy\" format.  (It doesn't require any specific formatting, it just returns the year in 4-digit format.)</p>\n\n<p>However, the first function, <code>Format(Range(\"AG1\"), \"mm\")</code> is always returning 01, indicating that is is January, which it isn't always.  I need the month based on the current date to be returned in \"mm\" format.</p>\n\n<p>The <code>Range(\"AG1\")</code> refers to a cell in the worksheet that has a date entered as <code>[mm/dd/yyyy]</code>.</p>\n\n<p>Any ideas what I'm doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1494450585, "post_id": 43902646, "comment_id": 74839396, "body": "I am not sure why you use End? shouldn&#39;t it be something like: If ActiveWorkbook.ProtectStructure Then       MsgBox ActiveWorkbook.Name &amp; &quot; is already protected.&quot;, vbCritical      Exit Sub End If"}, {"owner": {"reputation": 139, "user_id": 2942794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z2jmY.jpg?s=128&g=1", "display_name": "T-Rex", "link": "https://stackoverflow.com/users/2942794/t-rex"}, "reply_to_user": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1494451033, "post_id": 43902646, "comment_id": 74839620, "body": "@RADO Thanks for trying, that will actually give me a Compile Error: End If without block If"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 1, "creation_date": 1494452154, "post_id": 43902646, "comment_id": 74840124, "body": "I redesigned your code and tested it, it works. Why it did not work before: you tested for workbook protection, and then set worksheet protection. These are two different objects."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1494455130, "post_id": 43902646, "comment_id": 74841253, "body": "As @RADO says <code>ProtectStructure</code> is only telling you whether the <b>order of the sheets</b> is protected (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838601.aspx\" rel=\"nofollow noreferrer\">&quot;True if the order of the sheets in the workbook is protected.&quot;</a>) and, if it was, you were ending code execution.  If it wasn&#39;t, you were displaying a message saying it was, and then returning to whatever called the subroutine."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 2942794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z2jmY.jpg?s=128&g=1", "display_name": "T-Rex", "link": "https://stackoverflow.com/users/2942794/t-rex"}, "edited": false, "score": 0, "creation_date": 1494452410, "post_id": 43903030, "comment_id": 74840232, "body": "that worked perfect. I also tried using Else and added an EndIf at the end which made it work as well, but I think the aforementioned is very clean, so thank you again."}], "tags": [], "owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1494452070, "last_edit_date": 1494452070, "creation_date": 1494451732, "answer_id": 43903030, "question_id": 43902646, "link": "https://stackoverflow.com/questions/43902646/2010-excel-vba-if-workbook-is-already-protected-end-sub-issue/43903030#43903030", "title": "2010 Excel VBA - If Workbook is already Protected End Sub Issue", "body": "<p>I slightly redesigned your code:</p>\n\n<pre><code>Sub ProtectAll_ADMIN()\nDim ws As Worksheet\nDim pWord1 As String\nDim pWord2 As String\n\nFor Each ws In Worksheets\n    If ws.ProtectContents Then\n        MsgBox ActiveWorkbook.Name &amp; \" is already protected.\", vbCritical\n        Exit Sub\n    End If\nNext ws\n\n' To Hide all rows and columns for editing\nCall mcr_HideRowsColumns_ADMIN\n\npWord1 = InputBox(\"Please Enter the password\")\nIf pWord1 = \"\" Then Exit Sub\n\npWord2 = InputBox(\"Please re-enter the password\")\nIf pWord2 = \"\" Then Exit Sub\n\n'Make certain passwords are identical\nIf InStr(1, pWord2, pWord1, 0) = 0 Or InStr(1, pWord1, pWord2, 0) = 0 Then\n    MsgBox \"You entered different passwords. No action taken!\"\n    Exit Sub\nEnd If\n\nFor Each ws In Worksheets\n     ws.Protect Password:=pWord1\nNext\n\nMsgBox \"All Sheets are Protected.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 2942794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z2jmY.jpg?s=128&g=1", "display_name": "T-Rex", "link": "https://stackoverflow.com/users/2942794/t-rex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 43903030, "answer_count": 1, "score": 0, "last_activity_date": 1494452070, "creation_date": 1494449957, "question_id": 43902646, "link": "https://stackoverflow.com/questions/43902646/2010-excel-vba-if-workbook-is-already-protected-end-sub-issue", "title": "2010 Excel VBA - If Workbook is already Protected End Sub Issue", "body": "<p>I have a button that uses the sub ProtectAll_ADMIN() code below. </p>\n\n<p><a href=\"https://i.stack.imgur.com/jakKd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jakKd.jpg\" alt=\"Admin Buttons\"></a></p>\n\n<p>When the administrator has already protected the workbook an error will occur without checking if the WorkBook is already protected. So I want a message box to tell the administrator that the Workbook has already been protected. The following code will give me the message that it is already protected even if it has not been. If I strip out the following lines of code out it will run fine, but I am back to square one again and it will error out because a column is already hidden from my Call mcr_HideRowsColumns_ADMIN(). i.e. I wanted this sub routine separate, because there are a lot of sheets that need hidden columns and rows.</p>\n\n<pre><code> If ActiveWorkbook.ProtectStructure Then End\n    MsgBox ActiveWorkbook.Name &amp; \" is already protected.\", _\n        vbCritical\n Exit Sub\n</code></pre>\n\n<p>Here is the entire code below and I would truly appreciate someone's keen eye:</p>\n\n<pre><code>Sub ProtectAll_ADMIN()\n\n     Dim S As Object\n\n     If ActiveWorkbook.ProtectStructure Then End\n       MsgBox ActiveWorkbook.Name &amp; \" is already protected.\", _\n        vbCritical\n     Exit Sub\n\n     ' To Hide all rows and columns for editing\n     Call mcr_HideRowsColumns_ADMIN\n\n     Dim pWord1 As String, pWord2 As String\n        pWord1 = InputBox(\"Please Enter the password\")\n     If pWord1 = \"\" Then Exit Sub\n        pWord2 = InputBox(\"Please re-enter the password\")\n\n     If pWord2 = \"\" Then Exit Sub\n     'Make certain passwords are identical\n     If InStr(1, pWord2, pWord1, 0) = 0 Or _\n        InStr(1, pWord1, pWord2, 0) = 0 Then\n          MsgBox \"You entered different passwords. No action taken!\"\n     Exit Sub\n     End If\n     For Each ws In Worksheets\n         ws.Protect Password:=pWord1\n     Next\n         MsgBox \"All Sheets are Protected.\"\n     Exit Sub\n\n    '-------------------------------------------\n    Sheets(\"Home\").Select\n    Range(\"A1\").Select\n\n End Sub\n</code></pre>\n\n<p>Any Thoughts? THANK YOU!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494450968, "post_id": 43902438, "comment_id": 74839583, "body": "Scott&#39;s answer solves the issue raised in the question, but I&#39;m wondering what answer you are expecting if <code>last</code> is 8, <code>first</code> is 4 and <code>revenue</code> is 6 - are you after 6^1+6^2+6^3+6^4 again (i.e. the same as if <code>last</code> was 5 and <code>first</code> was 1) or are you really trying to produce 6^4+6^5+6^6+6^7+6^8?"}, {"owner": {"reputation": 11, "user_id": 7993992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdf0da48adf236fa5589aba521c5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "mary", "link": "https://stackoverflow.com/users/7993992/mary"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494510487, "post_id": 43902438, "comment_id": 74867759, "body": "if last is 8 and first is 4. then diff is 4 and total will be 6+6^2+6^3+6^4"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494450087, "post_id": 43902497, "comment_id": 74839168, "body": "I would add <code>Option Explicit</code>, as well as explicit visibility and return type for the function, and explicit type for the parameters (all types should be <code>Double</code> I think), which should be passed <code>ByVal</code>. I&#39;ll leave the cryptic/meaningless &quot;AC&quot; identifier uncommented though (oops) ;-)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494452215, "post_id": 43902497, "comment_id": 74840148, "body": "@YowE3K yeah, yeah, yeah 8P"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494453001, "post_id": 43902497, "comment_id": 74840467, "body": "@YowE3k I am on my phone what do you expect."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494454377, "post_id": 43902497, "comment_id": 74840964, "body": "I must admit that I don&#39;t expect much of people who use phones for accessing the internet.  (My mobile phone isn&#39;t even internet-enabled - I just use it as a .... phone!! :D)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1494452955, "last_edit_date": 1494452955, "creation_date": 1494449382, "answer_id": 43902497, "question_id": 43902438, "link": "https://stackoverflow.com/questions/43902438/accumulate-number-of-vba-function-is-not-working/43902497#43902497", "title": "Accumulate number of VBA function is not working", "body": "<p>You need to assign a value to the Function for it to return a value.  You also have a spelling error on <code>diff = last - firs</code> :</p>\n\n<pre><code>Function AC(last, first, revenue)\n\ndiff = last - first\nFor i = 1 To diff\n    Count = revenue ^ i\n    Total = Total + Count\nNext i\nAC = Total\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>To be safe one should also always declare the variables, and we can do the addition right to the function:</p>\n\n<pre><code>Option Explicit\n\nFunction AC(ByVal last As Long, ByVal first As Long, ByVal revenue As Double) As Double\nDim diff As Long\nDim i as long\nDim Count as Double\ndiff = last - first\nFor i = 1 To diff\n    Count = revenue ^ i\n    AC = AC + Count\nNext i\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7993992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdf0da48adf236fa5589aba521c5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "mary", "link": "https://stackoverflow.com/users/7993992/mary"}, "edited": false, "score": 0, "creation_date": 1494510699, "post_id": 43914409, "comment_id": 74867931, "body": "Thanks, the formula just make thing really simple"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1494502789, "creation_date": 1494502789, "answer_id": 43914409, "question_id": 43902438, "link": "https://stackoverflow.com/questions/43902438/accumulate-number-of-vba-function-is-not-working/43914409#43914409", "title": "Accumulate number of VBA function is not working", "body": "<p>With array formula <code>AC = [sum(6 ^ row(1:4))]</code> ( <code>#</code> is short for <code>As Double</code>) :</p>\n\n<pre><code>Function AC#(last#, first#, revenue#)\n    AC = Evaluate(\"sum(\" &amp; revenue &amp; \" ^ row(1:\" &amp; last - first &amp; \"))\")\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>With Excel Formula:</p>\n\n<pre><code>=SUMPRODUCT(revenue ^ ROW(INDIRECT(\"1:\" &amp; last - first)))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7993992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdf0da48adf236fa5589aba521c5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "mary", "link": "https://stackoverflow.com/users/7993992/mary"}, "edited": false, "score": 1, "creation_date": 1494511404, "post_id": 43914997, "comment_id": 74868539, "body": "Thanks, I think I will use this function"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1494504961, "last_edit_date": 1494504961, "creation_date": 1494504530, "answer_id": 43914997, "question_id": 43902438, "link": "https://stackoverflow.com/questions/43902438/accumulate-number-of-vba-function-is-not-working/43914997#43914997", "title": "Accumulate number of VBA function is not working", "body": "<p>Here's a loop-less implementation:</p>\n\n<pre><code>Function AC(last, first, revenue)\n    If revenue = 1 then AC = last - first: Exit Function\n    AC = revenue*((revenue^(last - first) - 1) / (revenue-1))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7993992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdf0da48adf236fa5589aba521c5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "mary", "link": "https://stackoverflow.com/users/7993992/mary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1494504961, "creation_date": 1494449111, "last_edit_date": 1494498574, "question_id": 43902438, "link": "https://stackoverflow.com/questions/43902438/accumulate-number-of-vba-function-is-not-working", "title": "Accumulate number of VBA function is not working", "body": "<p>I am trying to use VBA function to add up a number's all power result together. </p>\n\n<p>For example if I have 6 as revenue, and have <code>first=1</code> and <code>last=5</code>, <code>diff=5-1=4</code>, then the result should be like <code>total=6+6^2+6^3+6^4</code>.</p>\n\n<p>Below is my VBA code and not sure why it is not working and always give me result as 0:</p>\n\n<pre><code>Function AC(last, first, revenue)\n    diff = last - firs\n    For i = 1 To diff\n        Count = revenue ^ i\n        Total = Total + Count\n    Next i\nEnd Function\n</code></pre>\n\n<p>Thanks if anyone can help me</p>\n"}, {"tags": ["vba", "excel", "vbscript", "scheduled-tasks"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1494448818, "post_id": 43902252, "comment_id": 74838521, "body": "have you tried using the debugger and stepping through the code to see where it is hanging? (would also remove the on error while debugging)"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1494448912, "post_id": 43902252, "comment_id": 74838574, "body": "My guess is that your macro is getting confused on which <code>Workbook</code> is active and exactly what columns or cells are being referenced. Take a look at <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/11274/always-define-and-set-references-to-all-workbooks-and-sheets#t=20170510203911048245\">these</a> very good <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate#t=20170510203911048245\">references</a> and see if you can clean up your code to remove the problem."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1494449458, "post_id": 43902252, "comment_id": 74838846, "body": "I tried your code, prepared both VBS file and VBA macro with proper paths, the script and the macro work as expected, nothing stays running, Win 7 HB x64, Excel 2010 64-bit."}], "owner": {"reputation": 169, "user_id": 4608248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1a155709573d1fc48c4f3875e1ea7ec?s=128&d=identicon&r=PG&f=1", "display_name": "rvrtex", "link": "https://stackoverflow.com/users/4608248/rvrtex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494448400, "creation_date": 1494448400, "last_edit_date": 1531164843, "question_id": 43902252, "link": "https://stackoverflow.com/questions/43902252/vbs-script-doesnt-stop-running", "title": "VBS Script doesn&#39;t stop running", "body": "<p>So I saw <a href=\"https://stackoverflow.com/questions/31402313/vbs-doesnt-stop-running\">this questions</a> and it was not able to solve my problem. I have a scheduled task that I want to run daily. It opens a excel workbook, runs a macro to update something and then never stops running. </p>\n\n<p>Here is the VBS script.</p>\n\n<pre><code>Option Explicit\n\nExcelMacroRun\n\nSub ExcelMacroRun()\n\n    Dim xlApp, xlBook\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    xlApp.DisplayAlerts = False\n    'xlApp.AskToUpdateLinks = False\n    xlApp.AlertBeforeOverwriting = False\n\n\n    '~~&gt; Change Path here\n    Set xlBook = xlApp.Workbooks.Open(\"P:\\Fido\\Automated\\DailyPrices\\DailyPrices_new.xlsm\", 0)\n    xlApp.Run \"getPriceData\"\n    xlBook.Save\n    xlBook.Close\n    xlApp.Quit\n\n    Set xlBook = Nothing\n    Set xlApp = Nothing\nEnd Sub\n\nWScript.Quit\n</code></pre>\n\n<p>Here is the macro:</p>\n\n<pre><code>Sub getPriceData()\n\nApplication.ScreenUpdating = False\nOn Error GoTo echk\n\nechk1 = False\nApplication.Calculation = xlManual\n\n'Import new fund data into Imports page\n    Worksheets(\"Import\").Activate\n    Cells.Delete\n    Workbooks.Open Filename:=\"P:\\FIDO\\Automated\\DailyPrices\\prices.csv\"\n    Windows(\"prices.csv\").Activate\n    Cells.Select\n    Selection.Copy\n    Windows(\"DailyPrices_new.xlsm\").Activate\n    Worksheets(\"Import\").Activate\n    Cells.Select\n    Selection.PasteSpecial Paste:=xlAll\n\n'Import new annuity data into Annuities page\n    Worksheets(\"AnnuityImport\").Activate\n    Cells.Delete\n    Workbooks.Open Filename:=\"P:\\FIDO\\Automated\\DailyPrices\\AnnuityPRA.csv\"\n    Windows(\"AnnuityPRA.csv\").Activate\n    Cells.Select\n    Selection.Copy\n    Windows(\"DailyPrices_new.xlsm\").Activate\n    Worksheets(\"AnnuityImport\").Activate\n    Cells.Select\n    Selection.PasteSpecial Paste:=xlAll\n</code></pre>\n\n<p>There is a code block here where it adds a column to the excel file. Deletes a column if it is to long and runs a calculation. Then it comes to this part of the file (the end):</p>\n\n<pre><code>Calculate\nApplication.Calculation = xlAutomatic\n\n\nExit Sub\n echk:\n     'MsgBox Error\n     echk = True\n     Resume Next\n End Sub\n</code></pre>\n\n<p>It is set to run regardless if the user is logged in. It stays running even if I self start it. I am lost here. Can anyone see what I am missing to why it will not stop running?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1494447640, "post_id": 43901930, "comment_id": 74837920, "body": "<a href=\"http://stackoverflow.com/questions/41730313/vba-slows-over-time-can-i-load-my-object-into-memory-to-speed-things-up/41731094#41731094\" title=\"vba slows over time can i load my object into memory to speed things up\">stackoverflow.com/questions/41730313/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 7910420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f8a7cdd62b982f735d873e35cec233?s=128&d=identicon&r=PG&f=1", "display_name": "thunderbuck88", "link": "https://stackoverflow.com/users/7910420/thunderbuck88"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1494450367, "post_id": 43901930, "comment_id": 74839297, "body": "YowE3K, thanks for your edit. Slai, thanks so much for your response - this helped speed up my code by many times."}, {"owner": {"reputation": 33, "user_id": 7910420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f8a7cdd62b982f735d873e35cec233?s=128&d=identicon&r=PG&f=1", "display_name": "thunderbuck88", "link": "https://stackoverflow.com/users/7910420/thunderbuck88"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1494450479, "post_id": 43901930, "comment_id": 74839349, "body": "In fact, it&#39;s probably going to help speed up every piece of code I ever write.  Thanks again."}], "owner": {"reputation": 33, "user_id": 7910420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f8a7cdd62b982f735d873e35cec233?s=128&d=identicon&r=PG&f=1", "display_name": "thunderbuck88", "link": "https://stackoverflow.com/users/7910420/thunderbuck88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494447663, "creation_date": 1494447246, "last_edit_date": 1494447663, "question_id": 43901930, "link": "https://stackoverflow.com/questions/43901930/how-can-i-speed-up-my-directory-find-and-highlight-vba-script", "title": "How can I speed up my directory-find-and-highlight VBA script?", "body": "<p>I have written a very simple series of functions to find-and-highlight paragraphs of text containing certain terms within a series of documents in the same directory. Although functional, the code is extremely slow to run over some documents, the characteristics of which I have not yet really established (although I suspect they may either be text-box-heavy, or may just include a lot of blank paragraphs being tested for nothing - more on this later).</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub FindCheeses()\n    Dim x As Object\n    Dim sFolder As String\n    Dim strFilePattern As String\n    Dim strFileName\n    Dim sFileName As String\n\n    sFolder = \"X:\\Menus\\\"\n    strFilePattern = \"*.docx\"\n    strFileName = Dir(sFolder &amp; strFilePattern)\n    Do Until strFileName = vbNullString\n        sFileName = sFolder &amp; strFileName\n        Set x = Documents.Open(sFileName)\n        Call HighlightCheeses(x)\n        ActiveDocument.Close (wdSaveChanges)\n\n        Set x = Nothing\n        strFileName = Dir()\n    Loop\nEnd Sub\n\nFunction HighlightCheeses(oWordDoc)\n    Call HighlightStuff(\"roquefort\", \"cheddar\", \"wensleydale\", oWordDoc)\nEnd Function\n\nFunction HighlightStuff(x, y, z, oWordDoc) As String\n    Dim rngStory As Object\n    Dim i As Long\n    Dim xPos As Integer, yPos As Integer, zPos As Integer\n    Dim para As String\n\n    For Each rngStory In oWordDoc.StoryRanges\n        For i = 1 To rngStory.Paragraphs.Count\n            para = rngStory.Paragraphs(i).Range.Text\n            If para &lt;&gt; vbNullString Then\n                xPos = InStr(1, para, x, vbBinaryCompare)\n                yPos = InStr(1, para, y, vbBinaryCompare)\n                zPos = InStr(1, para, z, vbBinaryCompare)\n                If xPos &lt;&gt; 0 Then\n                    rngStory.Paragraphs(i).Range.HighlightColorIndex = wdYellow\n                End If\n                If yPos &lt;&gt; 0 Then\n                    rngStory.Paragraphs(i).Range.HighlightColorIndex = wdYellow\n                End If\n                If zPos &lt;&gt; 0 Then\n                    rngStory.Paragraphs(i).Range.HighlightColorIndex = wdYellow\n                End If\n            End If\n        Next i\n    Next\nEnd Function\n</code></pre>\n\n<p>I know it's a weird way to have written the code but I was trying to make it relatively simple for someone else to adapt.  Is that what is causing it to run slowly in some cases?  For some reason the test for whether the text of a paragraph is not empty always seems to succeed - that could also be the reason but I'm not sure how to resolve.</p>\n\n<p>Very grateful for any advice - hope this question fits the guidelines!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 3, "creation_date": 1494447378, "post_id": 43901895, "comment_id": 74837789, "body": "<code>RC3</code> is already a Range, so no need for range(range), just <code>RC3.Value</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1494447573, "post_id": 43901895, "comment_id": 74837886, "body": "<code>Selection.EntireRow.Delete</code> seems to be deleting an unspecified, arbitrary user-selected row. Probably not what you intend. Why work off <code>Selection</code> anyway?"}, {"owner": {"reputation": 13, "user_id": 7993831, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CGleZZxFGSA/AAAAAAAAAAI/AAAAAAAAEkg/A77m6l9drKc/photo.jpg?sz=128", "display_name": "Austin Huddleson", "link": "https://stackoverflow.com/users/7993831/austin-huddleson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494448445, "post_id": 43901895, "comment_id": 74838324, "body": "@Mat&#39;sMug Thanks! I forgot to change that back to RC2.EntireRow.Delete..."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1494448413, "last_edit_date": 1495541405, "creation_date": 1494448413, "answer_id": 43902256, "question_id": 43901895, "link": "https://stackoverflow.com/questions/43901895/excel-vba-method-range-of-object-global-failed-error-1004/43902256#43902256", "title": "Excel VBA Method &#39;Range&#39; of object&#39;_global&#39; failed error 1004", "body": "<pre><code>Do While (Range(RC3).Value &lt;&gt; \"\" And I &lt; 30)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/43901895/excel-vba-method-range-of-object-global-failed-error-1004#comment74837789_43901895\"><code>RC3</code> is a <code>Range</code> object</a>. What <code>Range(SomeRangeObject)</code> does is really <code>Range(SomeRangeObject.Value)</code>, so unless <code>RC3.Value</code> contains a valid range address string, that <em>unqualified</em> <code>Range</code> call is going to blow up.</p>\n\n<p>Note <em>unqualified</em>: your code <em>implicitly</em> works off the <code>ActiveSheet</code>:</p>\n\n<pre><code>Set Allrws = Range(\"A2:S\" &amp; CStr(LastRow))\n</code></pre>\n\n<p>Whenever <code>Range</code> is used like this, it's implicitly doing <code>ActiveSheet.Range</code>, through the <code>_Global</code> hidden module.</p>\n\n<p>Unqualified <code>Range</code>, <code>Cells</code>, <code>Rows</code>, <code>Columns</code> and <code>Names</code> calls are all implicitly referring to the <code>ActiveSheet</code>, and the misunderstanding of this fact is the reason behind every single \"Related\" question in the side bar (the ones I checked anyway), and there are thousands more of the same on this site: it's an <em>extremely</em> common source of bugs. So, <strong>qualify worksheet member calls</strong> and avoid problems.</p>\n\n<p>Your code <em>happens</em> to work (well, given the above modification). If the <code>With ActiveSheet</code> block was changed to <code>With Sheet12</code>, you would start seeing issues stemming from all the unqualified <code>Range</code> calls.</p>\n"}], "owner": {"reputation": 13, "user_id": 7993831, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CGleZZxFGSA/AAAAAAAAAAI/AAAAAAAAEkg/A77m6l9drKc/photo.jpg?sz=128", "display_name": "Austin Huddleson", "link": "https://stackoverflow.com/users/7993831/austin-huddleson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8720, "favorite_count": 0, "accepted_answer_id": 43902256, "answer_count": 1, "score": 0, "last_activity_date": 1494448413, "creation_date": 1494447115, "last_edit_date": 1531164843, "question_id": 43901895, "link": "https://stackoverflow.com/questions/43901895/excel-vba-method-range-of-object-global-failed-error-1004", "title": "Excel VBA Method &#39;Range&#39; of object&#39;_global&#39; failed error 1004", "body": "<p>I can't for the life of my figure out why I'm getting \"'Range' of object'_global' failed\" on my do while statement. It's like the range named RC3 isn't being recognized. Any help is greatly appreciated.</p>\n\n<pre><code>Sub DeleteBlankRows()\n\nDim Allrws As Range\nDim Rws As Range\nDim RC2 As Range\nDim RC3 As Range\nDim I As Integer\nDim CopyRange As Range\nDim LastRow As Long\n\nWith Application\n\n'.ScreenUpdating = False ' don't spam the interface with selections\n\n    With ActiveSheet\n\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' Put the number of the last row in LastRow\n\n    End With\n\n    Set Allrws = Range(\"A2:S\" &amp; CStr(LastRow))  ' set range to be observed\n\n    For Each Rws In Allrws.Rows   ' for each row in the range of Allrws call it Rws and do the following with it\n\n        Set RC2 = Rws.Offset(0, 3).Resize(1, 1)      ' move and resize the range of RC2 to include only the cell under column D\n        Set RC3 = Rws.Offset(0, 7).Resize(1, 1)      ' move and resize the range of RC3 to include only the cell under column I        \n        I = 0   ' initilize the rows deleted counter\n\n            Do While (Range(RC3).Value &lt;&gt; \"\" And I &lt; 30)    ' as long as RC points to a empty cell and we haven't removed more then 30 rows keep removing rows                                                             \n\n                If (range(RC2).Value = \"Permit &amp; Design\" Or range(RC2).Value = \"Miscellanious\") Then 'don't delete row if Permit &amp; Design or Miscellanious is in the cell under column D\n\n                  I = 30        ' escape the loop if true\n\n                Else\n\n                  Selection.EntireRow.Delete      ' delete the selected row if false\n\n                  I = I + 1                       ' add 1 to the counter\n\n                End If        \n\n            Loop                                   ' Go back to the start of the Do While\n\n    Next Rws                    ' go back to the For Each and put the next row in Rws\n\n    .ScreenUpdating = True      ' now update the interface with the changes\n\nend with\n\nend sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494444368, "post_id": 43901147, "comment_id": 74836202, "body": "Stack Overflow is not a code for me site.  Please post the attempt that got you the closest and tell us were it went wrong and we will help overcome the specific problem."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494444667, "post_id": 43901147, "comment_id": 74836391, "body": "See this: <a href=\"http://stackoverflow.com/questions/33744149/code-in-vba-loops-and-never-ends-how-to-fix-this\" title=\"code in vba loops and never ends how to fix this\">stackoverflow.com/questions/33744149/&hellip;</a> though the question is not the same, the answers will give you a good starting point."}, {"owner": {"reputation": 3, "user_id": 7993687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRRCT.jpg?s=128&g=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/7993687/kyle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494444774, "post_id": 43901147, "comment_id": 74836441, "body": "I will take a look at that.  I have tried looking all over and unless i am missing something, then I dont know the solution."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1494445460, "post_id": 43901147, "comment_id": 74836805, "body": "Your first bit of code can&#39;t even run as this fails on two counts <code>Range(H2000000)</code>. it should be <code>Range(&quot;H&quot; &amp; rows.count)</code> as there are not 2m rows in a spreadsheet. In the second one, COUNTA only counts the number of non-empty cells, as a quick perusal of Excel Help would tell you. Also why are you checking the last value in H but then checking column B?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494445596, "post_id": 43901147, "comment_id": 74836875, "body": "@Kyle, &quot;long&quot; numbers are integers only.  Turning .089 to a long number automatically rounds it up or down to 1 or 0.  I&#39;ll try to find the code for you."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494445714, "post_id": 43901147, "comment_id": 74836955, "body": "@JohnMuggins - don&#39;t think he is turning it into a long?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1494445958, "post_id": 43901147, "comment_id": 74837092, "body": "Thanks @SJR.  I was just going by his statement &quot;It needs to be As Long because this spreadsheet is uploaded from a database daily&quot; on top.  I probably misunderstood that."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494446326, "post_id": 43901147, "comment_id": 74837278, "body": "@JohnMuggins - well I may have misunderstood, we&#39;re all in the dark a bit."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7993687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRRCT.jpg?s=128&g=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/7993687/kyle"}, "edited": false, "score": 0, "creation_date": 1494509618, "post_id": 43901580, "comment_id": 74867053, "body": "I know i left some details out, not on purpose.  Like i mentioned, I do not code too much, so just giving what I knew.  Anyway, thank you very much this code worked just fine."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 0, "last_activity_date": 1494446223, "last_edit_date": 1494446223, "creation_date": 1494445880, "answer_id": 43901580, "question_id": 43901147, "link": "https://stackoverflow.com/questions/43901147/removing-rows-with-less-than-089-significant-value/43901580#43901580", "title": "Removing rows with less than .089 (significant value)", "body": "<p>This works fine with leaving column H as double precision decimal numbers.  you just forgot to put quotation marks around your \"H20000\"</p>\n\n<p>Oh wait - Column \"H\" is column 8 - not column 2. re-edited.  And 2000000 causes an error.  I changed it to 200000.</p>\n\n<pre><code>Sub Delete089()\nDim LastRow As Long, n As Long\nLastRow = Range(\"H200000\").End(xlUp).Row\nFor n = LastRow To 1 Step -1\n    If Cells(n, 8).Value &lt;= 0.089 Then Cells(n, 1).EntireRow.Delete\nNext n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1494446320, "creation_date": 1494446320, "answer_id": 43901705, "question_id": 43901147, "link": "https://stackoverflow.com/questions/43901147/removing-rows-with-less-than-089-significant-value/43901705#43901705", "title": "Removing rows with less than .089 (significant value)", "body": "<pre><code>Sub Del089()\n\n    LastRow = Cells(Rows.Count, 8).End(xlUp).Row\n\n    For x = LastRow To 1 Step -1\n\n        If Cells(x, 8).Value &lt;= 0.089 Then\n            Cells(x, 8).EntireRow.Delete\n        End If\n\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p>Assuming we are talking about Column H.</p>\n"}], "owner": {"reputation": 3, "user_id": 7993687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRRCT.jpg?s=128&g=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/7993687/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 43901580, "answer_count": 2, "score": 0, "last_activity_date": 1494447950, "creation_date": 1494444283, "last_edit_date": 1531164843, "question_id": 43901147, "link": "https://stackoverflow.com/questions/43901147/removing-rows-with-less-than-089-significant-value", "title": "Removing rows with less than .089 (significant value)", "body": "<p>I am trying to write a Macro to delete rows with any values in Column H (AverageWeight) below 0.890.  No matter what I write and try it will just not do anything.  I am no coding expert by any means and just do it form time to time to help with work metrics.  Can someone look at my data and help.  It needs to be As Long because this spreadsheet is uploaded from a database daily.</p>\n\n<p>Codes below:</p>\n\n<pre><code>Sub Delete089()\n    Dim LastRow As Long, n As Long\n    LastRow = Range(H2000000).End(xlUp).Row\n    For n = LastRow To 1 Step -1\n        If Cells(n, 2).Value &lt;= 0.089 Then Cells(n, 2).EntireRow.Delete\n    Next n\nEnd Sub\n\nSub Delete089()\n\nDim i As Long\n\n    With Application\n\n        .Calculation = xlCalculationManual\n\n        .ScreenUpdating = False\n\n    For i = Selection.Rows.Count To 1 Step -1\n\n        If WorksheetFunction.CountA(Selection.Rows(i)) &lt; 0.89 Then\n\n            Selection.Rows(i).EntireRow.Delete\n\n        End If\n\n    Next i\n\n        .Calculation = xlCalculationAutomatic\n\n        .ScreenUpdating = True\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/910n8.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494446834, "post_id": 43900842, "comment_id": 74837524, "body": "Are you sure you are running the macro in the new workbook?  (If, for instance, you have a button to invoke the macro, and you left that button invoking <code>&#39;Application Log-Macro.xlsm&#39;!SortApps</code>, then the first thing that pressing the button will do is open <code>Application Log-Macro.xlsm</code>.)"}, {"owner": {"reputation": 1, "user_id": 7957867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37556b0436fa043c548a970db8a4e698?s=128&d=identicon&r=PG&f=1", "display_name": "lumpyspaceprincess", "link": "https://stackoverflow.com/users/7957867/lumpyspaceprincess"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494593486, "post_id": 43900842, "comment_id": 74908552, "body": "@YowE3K - Good thinking, that is exactly what the problem was. Thank you so much!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7957867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37556b0436fa043c548a970db8a4e698?s=128&d=identicon&r=PG&f=1", "display_name": "lumpyspaceprincess", "link": "https://stackoverflow.com/users/7957867/lumpyspaceprincess"}, "edited": false, "score": 1, "creation_date": 1494593718, "post_id": 43901873, "comment_id": 74908722, "body": "TYSM for your help. It turns out that the issue was that I was using a Quick Access button from the old workbook to run the macro, but I think your advice will be helpful for a different workbook I&#39;m working with right now."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1494446979, "creation_date": 1494446979, "answer_id": 43901873, "question_id": 43900842, "link": "https://stackoverflow.com/questions/43900842/macro-opening-old-workbook/43901873#43901873", "title": "Macro opening old workbook", "body": "<p>If you copied sheets from the old workbook when creating the new workbook, there may be an internal reference to the old workbook in your new one.  First rule out that possibility by following the instructions here.  <a href=\"https://support.office.com/en-us/article/Find-links-external-references-in-a-workbook-fcbf4576-3aab-4029-ba25-54313a532ff1\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Find-links-external-references-in-a-workbook-fcbf4576-3aab-4029-ba25-54313a532ff1</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7957867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37556b0436fa043c548a970db8a4e698?s=128&d=identicon&r=PG&f=1", "display_name": "lumpyspaceprincess", "link": "https://stackoverflow.com/users/7957867/lumpyspaceprincess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494446979, "creation_date": 1494443225, "last_edit_date": 1531164843, "question_id": 43900842, "link": "https://stackoverflow.com/questions/43900842/macro-opening-old-workbook", "title": "Macro opening old workbook", "body": "<p>I am using a workbook that is an updated copy of an older workbook. <em>When I run the macro in the new workbook, it seems to run just fine BUT it also opens the old workbook.</em> I would like this not to happen.</p>\n\n<ul>\n<li>The new workbook is called <strong>LOG.xlsm</strong>.</li>\n<li>The old workbook is called <strong>Application Log-Macro.xlsm</strong>. It is in the same folder as the new workbook.</li>\n<li>I'm running Excel 2016.</li>\n</ul>\n\n<p>Please help me out here --  I'm guessing I need to change the code to make sure the active workbook is LOG.xlsm??</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub SortApps()\n'\n' SortApps Macro\nApplication.Goto Reference:=\"AppsTable\"\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields. _\n    Clear\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields. _\n    Clear\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add _\n    Key:=Range(\"AppsTable[NOTES]\"), SortOn:=xlSortOnCellColor, Order:= _\n    xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (1).SortOnValue\n    .Pattern = xlPatternLinearGradient\n    .Gradient.Degree = 0\n    .Gradient.ColorStops.Clear\nEnd With\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (1).SortOnValue.Gradient.ColorStops.Add(0)\n    .Color = 16763391\n    .TintAndShade = 0\nEnd With\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (1).SortOnValue.Gradient.ColorStops.Add(1)\n    .Color = 16738047\n    .TintAndShade = 0\nEnd With\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add _\n    Key:=Range(\"AppsTable[NOTES]\"), SortOn:=xlSortOnCellColor, Order:= _\n    xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (2).SortOnValue\n    .Pattern = xlPatternLinearGradient\n    .Gradient.Degree = 180\n    .Gradient.ColorStops.Clear\nEnd With\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (2).SortOnValue.Gradient.ColorStops.Add(0)\n    .Color = 3394611\n    .TintAndShade = 0\nEnd With\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (2).SortOnValue.Gradient.ColorStops.Add(1)\n    .Color = 3407718\n    .TintAndShade = 0\nEnd With\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add( _\n    Range(\"AppsTable[STAT]\"), xlSortOnCellColor, xlAscending, , xlSortNormal). _\n    SortOnValue.Color = RGB(204, 0, 102)\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add( _\n    Range(\"AppsTable[STAT]\"), xlSortOnCellColor, xlAscending, , xlSortNormal). _\n    SortOnValue.Color = RGB(204, 153, 255)\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add _\n    Key:=Range(\"AppsTable[T2]\"), SortOn:=xlSortOnCellColor, Order:= _\n    xlDescending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (5).SortOnValue\n    .Pattern = xlPatternLinearGradient\n    .Gradient.Degree = 270\n    .Gradient.ColorStops.Clear\nEnd With\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (5).SortOnValue.Gradient.ColorStops.Add(0)\n    .Color = 14202006\n    .TintAndShade = 0\nEnd With\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields _\n    (5).SortOnValue.Gradient.ColorStops.Add(1)\n    .Color = 9592886\n    .TintAndShade = 0\nEnd With\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add( _\n    Range(\"AppsTable[NOTES]\"), xlSortOnCellColor, xlDescending, , xlSortNormal). _\n    SortOnValue.Color = RGB(218, 238, 243)\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add( _\n    Range(\"AppsTable[STAT]\"), xlSortOnCellColor, xlAscending, , xlSortNormal). _\n    SortOnValue.Color = RGB(242, 220, 219)\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add( _\n    Range(\"AppsTable[RI DUE]\"), xlSortOnFontColor, xlAscending, , xlSortNormal). _\n    SortOnValue.Color = RGB(192, 0, 0)\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add( _\n    Range(\"AppsTable[STAT]\"), xlSortOnCellColor, xlAscending, , xlSortNormal). _\n    SortOnValue.Color = RGB(247, 150, 70)\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add( _\n    Range(\"AppsTable[STAT]\"), xlSortOnCellColor, xlAscending, , xlSortNormal). _\n    SortOnValue.Color = RGB(255, 235, 156)\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add _\n    Key:=Range(\"AppsTable[APP DT]\"), SortOn:=xlSortOnValues, Order:= _\n    xlAscending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort.SortFields.Add _\n    Key:=Range(\"AppsTable[SSN]\"), SortOn:=xlSortOnValues, Order:=xlAscending _\n    , DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Apps\").ListObjects(\"AppsTable\").Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nRange(\"K9\").Select\nActiveWindow.SmallScroll Down:=21\nRange(\"AppsTable[NOTES]\").Select\nActiveWindow.SmallScroll Down:=-39\nSelection.Rows.AutoFit\nRange(\"A9\").Select\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for your advice! I'm sure it's something easy but it's throwing me for a loop, because (surprise) I don't actually know what the heck I'm doing. :\")</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494446366, "post_id": 43900405, "comment_id": 74837294, "body": "Your current code should be copying data to the first row following the last non-empty cell in column A.  All copied cells will be placed <b>on that one row</b>, irrespective of whether column B or C was empty in the previous row.  Your only issue would arise if column A itself was empty for Responder1, in which case Responder2&#39;s values would overwrite all of Responder1&#39;s values - but they would still be being written to a single row."}, {"owner": {"reputation": 9, "user_id": 4716706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d053d49dedcf94fb1995d3896ce68456?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh", "link": "https://stackoverflow.com/users/4716706/sourabh"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494480894, "post_id": 43900405, "comment_id": 74847716, "body": "@YowE3K Thanks for editing the question. Actually, I have to copy multiple range of cells. So I am doing it by rewriting the same code for each range of cells. So it&#39;s just not column A, but the column for multiple ranges. Also, i do not want any overwriting, I want new response to start in a new row.  Do you have any suggestion for option no. 2?"}, {"owner": {"reputation": 9, "user_id": 4716706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d053d49dedcf94fb1995d3896ce68456?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh", "link": "https://stackoverflow.com/users/4716706/sourabh"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494486060, "post_id": 43900405, "comment_id": 74850371, "body": "@Ioannis  using following code :   <code>Set multipleRange = Union(range1, range2, range3, range4) multipleRange.Select Selection.Copy Sheets(&quot;Raw Data&quot;).Select Worksheets(&quot;Raw Data&quot;).Cells(Rows.Count, &quot;A&quot;).End(xlUp).Offset(1, 0).PasteSpecial</code> But <code>Selection.Copy</code> is not working in this case. Don&#39;t know what is the problem."}, {"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "edited": false, "score": 0, "creation_date": 1494486355, "post_id": 43900405, "comment_id": 74850548, "body": "Have you defined <code>range1, ...range4</code> properly? are you familiar with <a href=\"https://www.google.nl/search?q=vba+debugging&amp;oq=vba+debugging&amp;aqs=chrome..69i57j0l5.2567j0j7&amp;sourceid=chrome&amp;ie=UTF-8\" rel=\"nofollow noreferrer\">VBA debugging</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4716706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d053d49dedcf94fb1995d3896ce68456?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh", "link": "https://stackoverflow.com/users/4716706/sourabh"}, "edited": false, "score": 0, "creation_date": 1494445874, "post_id": 43900464, "comment_id": 74837050, "body": "The &quot;<i>SkipBlanks = False</i>&quot; seems to have worked with some ranges (I am having different ranges in workbook, so repeating the code separately for each range). However I am having little difficulty in understanding your code here, specially &quot;<i>with --- End with</i>&quot;.   Also, Do you have any suggestion to option 2?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494446478, "post_id": 43900464, "comment_id": 74837356, "body": "The default value for the <code>SkipBlanks</code> parameter is <code>False</code> (as seen in the documentation that you included), so saying <code>SkipBlanks:=False</code> isn&#39;t necessary."}], "tags": [], "owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "is_accepted": false, "score": 0, "last_activity_date": 1494494527, "last_edit_date": 1525816189, "creation_date": 1494441909, "answer_id": 43900464, "question_id": 43900405, "link": "https://stackoverflow.com/questions/43900405/treating-blank-values-in-excel-using-vba-code/43900464#43900464", "title": "Treating Blank values in Excel using VBA code", "body": "<p>Quick answer: </p>\n\n<p>Use <code>Worksheets(\"Sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0).PasteSpecial SkipBlanks = False</code></p>\n\n<p>Reference from <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow noreferrer\">MSDN</a>:</p>\n\n<blockquote>\n  <p>SkipBlanks True to have blank cells in the range on the Clipboard not\n  be pasted into the destination range. The default value is False.</p>\n</blockquote>\n\n<p>However, using <code>Select</code> is not considered good practice. Consider reading <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this</a> for more information. For copy-pasting ranges, I cannot recommend more <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">Chip Pearson's page</a>.</p>\n\n<p>Demo:</p>\n\n<pre><code>Sub test()\n\nDim LastRow As Long Dim arCopy() As Variant \nDim rDest As Range\n\nWith Sheet2 ' --&gt; Qualify the ranges\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1 End With\n\narCopy = Sheet1.Range(\"A2:K2\").Value\n\nSet rDest = Sheet2.Cells(LastRow, \"A\")\n\nSet rDest = rDest.Resize(1, UBound(arCopy, 2))\n\nrDest.Value = arCopy\n\nEnd Sub\n</code></pre>\n\n<p>Sheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6qR8D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6qR8D.png\" alt=\"Input sheet\"></a></p>\n\n<p>Sheet2 before:\n<a href=\"https://i.stack.imgur.com/kAozj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kAozj.png\" alt=\"Sheet2 Before\"></a></p>\n\n<p>Sheet2 After:\n<a href=\"https://i.stack.imgur.com/ARQ0A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ARQ0A.png\" alt=\"enter image description here\"></a></p>\n\n<p>The above has the added benefit that you do not need to worry about Blank cells, as they are copied by default.</p>\n\n<p>I hope this helps!</p>\n\n<p><strong>EDIT</strong> (addressing comments)</p>\n\n<ul>\n<li>It is true that since <code>SkipBlanks = False</code> by default, your <code>PasteSpecial</code> does <em>not</em> skip blanks. Are you sure your cells are indeed blank and do not appear to be blank? You can make a quick check with the <code>ISBLANK()</code> function. If <code>SkipBlanks</code> <em>appears</em> to be working only some times, then there is certainly something different with respect to the cells it is applied to.</li>\n<li><p><code>With ... End With</code>: This is a shortcut construct that enhances readability. Basically, a block of methods or properties that are under the same object, such as </p>\n\n<pre><code> Sheet1.Range(\"A1\")=\"Rob\"\n Sheet1.Copy(\"A2\")\n Sheet1.Rows.Count\n</code></pre>\n\n<p>can be written as </p>\n\n<pre><code>With Sheet1\n    .Range(\"A1\") = \"Rob\"\n    .Copy(\"A2\")\n    .Rows.Count\nEnd With\n</code></pre>\n\n<p>This enhances readability</p></li>\n<li><p>Your second suggestion </p>\n\n<blockquote>\n  <p>can we assign some value for e.g. NULL or 0 to those blank cells, so\n  that the new response can be stored in new row.</p>\n</blockquote>\n\n<p>In principle, this is possible. However, you should identify which cells are \"blank\", and we already know that one method that does not skip blanks does not appear to work, so identifying blank cells and substituting them is a bit of a catch 22. In other words, if we knew how to find these \"blank\" cells so that we assign them NULL or 0, then <code>SkipBlanks</code> would had taken care of them in a more elegant way (because it is designed to do exactly this). </p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 4716706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d053d49dedcf94fb1995d3896ce68456?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh", "link": "https://stackoverflow.com/users/4716706/sourabh"}, "edited": false, "score": 0, "creation_date": 1494507274, "post_id": 43909811, "comment_id": 74865118, "body": "Thanks. This code worked out for me. This is actually running a loop and finding out that if there is at least one non-blank entry in one row, then the next response will stored in next row automatically.   Thanks for the help!!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1506008606, "last_edit_date": 1506008606, "creation_date": 1494490017, "answer_id": 43909811, "question_id": 43900405, "link": "https://stackoverflow.com/questions/43900405/treating-blank-values-in-excel-using-vba-code/43909811#43909811", "title": "Treating Blank values in Excel using VBA code", "body": "<p>Try the following code:</p>\n\n<pre><code>Sub Submit1()\n    Dim nextRow As Long\n    With Worksheets(\"Sheet2\")\n        'Find the last non-empty cell in the worksheet, and determine its row\n        'Then add 1 to that, so we are pointing at the next row\n        nextRow = .Cells.Find(What:=\"*\", _\n                              After:=.Range(\"A1\"), _\n                              Lookat:=xlPart, _\n                              LookIn:=xlFormulas, _\n                              SearchOrder:=xlByRows, _\n                              SearchDirection:=xlPrevious, _\n                              MatchCase:=False).Row + 1\n        'Copy values to \"nextRow\"\n        Worksheets(\"Sheet1\").Range(\"A2:C2\").Copy .Cells(nextRow, \"A\")\n        'Perform other copies as necessary, e.g.\n        Worksheets(\"Sheet1\").Range(\"A5:D5\").Copy .Cells(nextRow, \"D\")\n        Worksheets(\"Sheet1\").Range(\"X4:Z4\").Copy .Cells(nextRow, \"H\")\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Regarding your second suggestion:  Just don't do it.</p>\n"}], "owner": {"reputation": 9, "user_id": 4716706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d053d49dedcf94fb1995d3896ce68456?s=128&d=identicon&r=PG&f=1", "display_name": "Sourabh", "link": "https://stackoverflow.com/users/4716706/sourabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 43909811, "answer_count": 2, "score": 0, "last_activity_date": 1506008606, "creation_date": 1494441719, "last_edit_date": 1494445957, "question_id": 43900405, "link": "https://stackoverflow.com/questions/43900405/treating-blank-values-in-excel-using-vba-code", "title": "Treating Blank values in Excel using VBA code", "body": "<p>I am new to Excel VBA. I have made a macro-enabled Excel to record survey responses. Whenever I run the macro, certain cells get copied (from Sheet1) and stored as a row vector in another worksheet (Sheet2).</p>\n\n<p>The problem is that, if Responder1 has some blank cells in his response, then when I record another response (Responder2), then values corresponding to the variable where Responder1 had blanks, are stored in the previous row.</p>\n\n<p>Here is the VBA code</p>\n\n<pre><code>Sub Submit1()\nRange(\"A2:C2\").Select    #in Sheet1\nSelection.Copy\nSheets(\"Sheet2\").Select\nWorksheets(\"Sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0).PasteSpecial\nEnd Submit1\n</code></pre>\n\n<p>Now there are two things that I can think of doing:- </p>\n\n<ol>\n<li>If it is possible to check that if previous row has at least one non-blank entry then the new response will be recorded in next row automatically.</li>\n<li>If above is not possible, can we assign some value for e.g. NULL or 0 to those blank cells, so that the new response can be stored in new row.</li>\n</ol>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494440624, "post_id": 43900037, "comment_id": 74833970, "body": "It will need to be a sub and cannot be called like a formula on the sheet."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1494440927, "post_id": 43900037, "comment_id": 74834121, "body": "On a side note, this function does not clean up Unicode. It removes unprintable plus some more ASCII characters from a string, and it does so in a most inefficient way."}, {"owner": {"reputation": 303, "user_id": 4430375, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51ee13ebaef0e2d2b136f5f07b5f5249?s=128&d=identicon&r=PG&f=1", "display_name": "twegner", "link": "https://stackoverflow.com/users/4430375/twegner"}, "edited": false, "score": 0, "creation_date": 1494443083, "post_id": 43900037, "comment_id": 74835455, "body": "Are the cells in the same location on the imported sheets? If there is consistency then a sub could be written to call the function on the cells. What is the range you want to use it on?"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494443039, "post_id": 43900749, "comment_id": 74835426, "body": "You can do the whole range as one,  Look into <code>Range.Replace</code>"}], "tags": [], "owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "is_accepted": false, "score": 1, "last_activity_date": 1494442897, "creation_date": 1494442897, "answer_id": 43900749, "question_id": 43900037, "link": "https://stackoverflow.com/questions/43900037/improve-function-that-cleans-non-printing-and-other-ascii-characters/43900749#43900749", "title": "Improve function that cleans non printing and other ASCII characters", "body": "<p>Here is the Sub Procedure I wrote which when tested worked.</p>\n\n<pre><code>Sub CleanCells()\n  Dim x As Long, CodesToClean As Variant\n  CodesToClean = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, _\n                       21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 127, 129, 141, 143, 144, 157)\n\n  Dim rng As Range\n    Dim row As Range\n    Dim cell As Range\n\n    Set rng = Range(\"A1:A168\")\n\n    For Each row In rng.Rows\n        For Each cell In row.Cells\n        'Do Something\n                S = Replace(S, Chr(160), \" \")\n                For x = LBound(CodesToClean) To UBound(CodesToClean)\n                  If InStr(S, Chr(CodesToClean(x))) Then S = Replace(S, Chr(CodesToClean(x)), \"\")\n                Next\n                WorksheetFunction.Trim (S)\n\n        Next cell\n    Next row\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1494557617, "last_edit_date": 1494557617, "creation_date": 1494483081, "answer_id": 43907776, "question_id": 43900037, "link": "https://stackoverflow.com/questions/43900037/improve-function-that-cleans-non-printing-and-other-ascii-characters/43907776#43907776", "title": "Improve function that cleans non printing and other ASCII characters", "body": "<p>A <code>Regexp</code> will be cleaner.</p>\n\n<p>As a <em>UDF</em> below (which could be used in an array)</p>\n\n<p>See <a href=\"https://regex101.com/r/Hdv65h/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/Hdv65h/1</a></p>\n\n<pre><code>Function strClean(strIn As String) As String\nDim objRegexp As Object\nSet objRegexp = CreateObject(\"vbscript.regexp\")\nWith objRegexp\n    'hex codes for 0-31, 127, 129, 141, 143, 144, 157\n    .Pattern = \"[\\x00-\\x1F]|\\x7F|\\x7F|\\x81|\\x8D|\\x8F|\\x90|\\x9D\"\n    .Global = True\n    strClean = .Replace(strIn, vbNullString)\nEnd With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1494557617, "creation_date": 1494440495, "last_edit_date": 1531161705, "question_id": 43900037, "link": "https://stackoverflow.com/questions/43900037/improve-function-that-cleans-non-printing-and-other-ascii-characters", "title": "Improve function that cleans non printing and other ASCII characters", "body": "<p>I have an Excel 2013 Workbook with sheets imported from various sources. </p>\n\n<p>These contain <em>Unicode</em> characters all over the place which the clean function do not account for. </p>\n\n<p>I found a function which works cell by cell, but I'd like to have it used on a range of cells instead of having to put the function in each cell individually.</p>\n\n<p>Could someone please help me convert this function?</p>\n\n<p>Thank you</p>\n\n<pre><code>  Function CleanTrim(ByVal S As String, Optional ConvertNonBreakingSpace As Boolean = True) As String\n  Dim X As Long, CodesToClean As Variant\n  CodesToClean = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, _\n                       21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 127, 129, 141, 143, 144, 157)\n\n  If ConvertNonBreakingSpace Then S = Replace(S, Chr(160), \" \")\n  For X = LBound(CodesToClean) To UBound(CodesToClean)\n    If InStr(S, Chr(CodesToClean(X))) Then S = Replace(S, Chr(CodesToClean(X)), \"\")\n  Next\n  CleanTrim = WorksheetFunction.Trim(S)\n\n'Call function == use CleanTrim just like it was a built-in Excel function. For example, =CleanTrim(B2)\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1494440516, "post_id": 43900000, "comment_id": 74833908, "body": "Is there a sheet in that workbook called <code>Sheet1</code>?"}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494442436, "post_id": 43900000, "comment_id": 74835048, "body": "Yes Sheet 1 and Sheet 2. thee code was working perfectly previously then suddenly runs with this error."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1494444082, "post_id": 43900000, "comment_id": 74836043, "body": "Have you tried <code>Set myXLSheet = myXLWorkbook.Sheets(&quot;Sheet1&quot;)</code>?"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594639969, "creation_date": 1494440380, "last_edit_date": 1594639969, "question_id": 43900000, "link": "https://stackoverflow.com/questions/43900000/what-is-the-source-of-the-object-defined-error", "title": "What is the source of the object defined error?", "body": "<p>I am unable to identify the <em>object-defined error</em> that is displayed. It occurs on the <code>Set myxlSheet</code> statement.</p>\n\n<pre><code>Private Sub LoadConfigFile(filename As String)\n\n    Dim myXLApp As Object\n    Dim myXLWorkbook As Object\n    Dim myXLSheet As Object\n    Dim LastRow As Integer\n    Dim LastColumn As Integer\n    Dim ColumnCounter As Integer\n    Dim RowCounter As Integer\n    Dim StartRates As Boolean\n    Dim tempPlanName As String, TempPreTax As String\n    Dim dbs As Database\n    Dim rst As Recordset\n    Dim LPosition As Integer\n\n    On Error GoTo ProcError\n\n    'check if the file exists\n    If Dir(filename) = \"\" Then\n        MsgBox \"Cannot find Config file\"\n        Exit Sub\n    End If\n\n    'clear out CRDRates table and set up to enter data\n    Set dbs = CurrentDb\n    DoCmd.RunSQL \"DELETE * from [tblConfigRates]\"      'clear out CRDRates table\n    Set rst = dbs.OpenRecordset(\"tblConfigRates\", dbOpenDynaset)\n\n    'start MS Excel by checking if it is already open (GetObject). If not open it will error and go to CreateObject\n    Set myXLApp = GetObject(, \"Excel.Application\")\n    myXLApp.Visible = False       'user does not need flashing Excel on screen\n    Set myXLWorkbook = myXLApp.Workbooks.Open(filename, ReadOnly:=True)\n\n    Set myXLSheet = myXLWorkbook.Worksheets(\"Sheet1\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "activex"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494441221, "post_id": 43899896, "comment_id": 74834296, "body": "You <i>made</i> ActiveX controls? Or you made tools <i>using</i> ActiveX controls?"}, {"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1494442903, "post_id": 43899896, "comment_id": 74835336, "body": "@Mat&#39;sMug I made tools <i>using</i> ActiveX controls. Using the Developer tab and Insert to add them to a worksheet. the&#39;re all simple ones like comboboxes and Listboxes, but with vba code behind them."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494443023, "post_id": 43899896, "comment_id": 74835414, "body": "Per the MSDN article you linked, you&#39;re going to need to maintain and ship 32 and 64 bit versions."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1494450326, "post_id": 43899896, "comment_id": 74839288, "body": "Is there a particular reason you used ActiveX controls rather than normal form controls? Perhaps to use their events? If not then you can programatically replace them all with form controls."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 14839487, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjPsEN_qncsIMCzadi6cbCaOd2QmovG_n8ljABW=k-s128", "display_name": "John Erwyn Smith", "link": "https://stackoverflow.com/users/14839487/john-erwyn-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1609360762, "creation_date": 1609360762, "answer_id": 65513293, "question_id": 43899896, "link": "https://stackoverflow.com/questions/43899896/activex-controls-in-excel-2013-64-bit/65513293#65513293", "title": "ActiveX controls in Excel 2013 64 bit", "body": "<p>ActiveX has more controls, with other options.</p>\n<p>Excel 2013 x64: Doesn't have &quot;SerialPort&quot; in form controls. is an activex control</p>\n"}], "owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 934, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609360762, "creation_date": 1494440015, "question_id": 43899896, "link": "https://stackoverflow.com/questions/43899896/activex-controls-in-excel-2013-64-bit", "title": "ActiveX controls in Excel 2013 64 bit", "body": "<p>I've developed a number of excel tools which include ActiveX controls from the developer tab and VBA. They all work in Excel 2013 <strong>32 bit</strong>. However one of my clients is using Excel 2013 <strong>64 bit</strong> and the tools do not function on his PC. I understand that this is probably due to the ActiveX controls. (<a href=\"https://technet.microsoft.com/en-us/library/ee681792.aspx\" rel=\"nofollow noreferrer\">https://technet.microsoft.com/en-us/library/ee681792.aspx</a>)</p>\n\n<p>is there a simple way to make my tools excel 2013 64 bit compatible? preferably without having to install office 2013 64 bit and having to re-work them all?</p>\n"}, {"tags": ["excel", "vba", "counting"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494439801, "post_id": 43899770, "comment_id": 74833503, "body": "What have you tried so far? I had <code>=COUNTIF([range],[criteria])-1</code> but if you have <code>1,2,3,4,3,4,3</code> you want to show <code>3</code> for the number of <code>3</code>s, correct?"}, {"owner": {"reputation": 3, "user_id": 7993391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13c55058f7fe12c28ec640fa787a22aa?s=128&d=identicon&r=PG&f=1", "display_name": "Nachtstiel", "link": "https://stackoverflow.com/users/7993391/nachtstiel"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1494440581, "post_id": 43899770, "comment_id": 74833944, "body": "Correct. I am trying to use visual basic specifically to count cells with a certain fill color. The number of cells with the color will almost never be the same. The formula I have now is For Each rcell In Range(&quot;B12:Z50&quot;) If rcell.Interior.Color = RGB(255, 255, 0) yellowcount = yellowcount + 1"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7993391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13c55058f7fe12c28ec640fa787a22aa?s=128&d=identicon&r=PG&f=1", "display_name": "Nachtstiel", "link": "https://stackoverflow.com/users/7993391/nachtstiel"}, "edited": false, "score": 0, "creation_date": 1494440865, "post_id": 43899878, "comment_id": 74834080, "body": "That is something I&#39;ll keep in mind when I don&#39;t need to use VBA, thank you for the quick response."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 7993391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13c55058f7fe12c28ec640fa787a22aa?s=128&d=identicon&r=PG&f=1", "display_name": "Nachtstiel", "link": "https://stackoverflow.com/users/7993391/nachtstiel"}, "edited": false, "score": 0, "creation_date": 1494440987, "post_id": 43899878, "comment_id": 74834155, "body": "@Nachtstiel - If that works for you and answered your question, you can mark it as the &quot;Answer&quot; by clicking the check mark left of the post."}, {"owner": {"reputation": 3, "user_id": 7993391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13c55058f7fe12c28ec640fa787a22aa?s=128&d=identicon&r=PG&f=1", "display_name": "Nachtstiel", "link": "https://stackoverflow.com/users/7993391/nachtstiel"}, "edited": false, "score": 0, "creation_date": 1494444550, "post_id": 43899878, "comment_id": 74836323, "body": "I found a solution for what i was looking for. I used For Each rcell In Range(&quot;B12:Z50&quot;)     If rcell.Interior.Color = RGB(255, 255, 0) And yellowprev = 0 Then         yellowcount = yellowcount + 1         yellowprev = yellowprev + 1         If yellowprev &gt; 5 Then         yellowprev = 0         End If    ElseIf rcell.Interior.Color &lt;&gt; RGB(255, 255, 0) Then         yellowprev = 0         End If"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1494441341, "last_edit_date": 1494441341, "creation_date": 1494439951, "answer_id": 43899878, "question_id": 43899770, "link": "https://stackoverflow.com/questions/43899770/vba-excel-count-cells-in-a-range-with-a-specific-value/43899878#43899878", "title": "VBA Excel count cells in a range with a specific value", "body": "<p>Use this:</p>\n\n<pre><code>=COUNTIF(A:A,3)-COUNTIFS(A1:A1040000,3,A2:A1040001,3)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fxLIx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fxLIx.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>The following formula works just as well:</p>\n\n<pre><code>=COUNTIFS(A1:A1040000,3,A2:A1040001,\"&lt;&gt;\" &amp; 3)\n</code></pre>\n\n<p>In vba:</p>\n\n<pre><code>Dim output as Long\nWith AcitveSheet\n    output = Application.WorksheetFunction.Countifs(.Range(\"A1:A1040000\"),3,.Range(A2:A1040001),\"&lt;&gt;\" &amp; 3)\nEnd With\nDebug.Print output\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7993391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13c55058f7fe12c28ec640fa787a22aa?s=128&d=identicon&r=PG&f=1", "display_name": "Nachtstiel", "link": "https://stackoverflow.com/users/7993391/nachtstiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1703, "favorite_count": 0, "accepted_answer_id": 43899878, "answer_count": 1, "score": 0, "last_activity_date": 1494441341, "creation_date": 1494439584, "question_id": 43899770, "link": "https://stackoverflow.com/questions/43899770/vba-excel-count-cells-in-a-range-with-a-specific-value", "title": "VBA Excel count cells in a range with a specific value", "body": "<p>I am looking for a way to count the number of cells in a range with a specific value, but will skip cells that are next to the previous cell if they have the same value. So that if I have a series like 1,2,3,3,4,3 the result for the number of 3's would be 2.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1494439106, "post_id": 43899585, "comment_id": 74833117, "body": "&quot;...breaks the second time...&quot;  - Do you get an error? What error?"}, {"owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494439607, "post_id": 43899585, "comment_id": 74833398, "body": "Yes, sorry for not including that in the OP:  &quot;Run-time error 1004 Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494439760, "post_id": 43899585, "comment_id": 74833479, "body": "Where/how do you declare and define <code>payoutFileName</code>. Also, what&#39;s <code>SchedName</code> the first time it&#39;s run, and the second?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494439813, "post_id": 43899585, "comment_id": 74833514, "body": "Also what is <code>basicScheduleFileName</code> ?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494441116, "post_id": 43899585, "comment_id": 74834234, "body": "try adding &quot;.xlsx&quot; to the end of your SchedName"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494441224, "post_id": 43899585, "comment_id": 74834299, "body": "also Worksheet.activate is not a valid variable name"}, {"owner": {"reputation": 4987, "user_id": 3100515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dZSlO.jpg?s=128&g=1", "display_name": "Ajean", "link": "https://stackoverflow.com/users/3100515/ajean"}, "edited": false, "score": 0, "creation_date": 1494447851, "post_id": 43899585, "comment_id": 74838031, "body": "It is best to <a href=\"https://stackoverflow.com/posts/43899585/edit\">edit</a> your question to include all the pertinent information rather than just adding comments."}, {"owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "edited": false, "score": 0, "creation_date": 1494451373, "post_id": 43899585, "comment_id": 74839776, "body": "Thank you for all of the replies. In order:   <b>payoutFileName</b> is a global set at the beginning of the program and never changed.   <b>SchedName first time</b> - Basic_Schedule-ALL  <b>SchedName second time</b> - Basic_Schedule-Blackduck (both valid and expected).   <b>basicScheduleFileName</b> is another global like payoutFileName that is set at the beginning of the program and never changed.   Tried .xlsx, no change.   Removed Worksheet.Activate, essentially that is there because I was just throwing things at the wall."}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1494454216, "post_id": 43899585, "comment_id": 74840914, "body": "Does the first iteration skip the save as portion?"}, {"owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1494455249, "post_id": 43899585, "comment_id": 74841301, "body": "@NickSlash No, the first save as fires and saves the file as expected, it&#39;s the next one that breaks. I assume it is maybe losing focus or a reference or something, but I am not sure."}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1494522930, "post_id": 43899585, "comment_id": 74876779, "body": "Cant replicate your issue, with your current code you appear to be saving a copy of the entire workbook and not the specific sheet. Although this might just be something I did..."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "edited": false, "score": 0, "creation_date": 1494452496, "post_id": 43900890, "comment_id": 74840258, "body": "Thank you for taking the time to get this put together. Unfortunately, as with all of my other attempts, this code works the first iteration of the loop and then breaks on the next."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "edited": false, "score": 0, "creation_date": 1494504753, "post_id": 43900890, "comment_id": 74863234, "body": "Do you know how to set a break point to debug?  We need to find the exact line where it stops at.  Since it works fine on my Excel 2013 I am not able to detect your bad line.  You&#39;ll have to do this yourself.  Check out this site on debugging.  <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/DebuggingVBA.aspx</a>"}, {"owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "edited": false, "score": 0, "creation_date": 1494517137, "post_id": 43900890, "comment_id": 74873206, "body": "The code breaks on the .SaveAs line, which is the same behavior I saw in my earlier code.  Let me ask you a question about your code, I have at least a dozen or so worksheets that I need to save as separate files in my code. The code you provided closes the workbook (<code>wb.Close</code>)after the first save, won&#39;t that kick me out of the loop once I have saved once?"}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 1, "creation_date": 1494522583, "post_id": 43900890, "comment_id": 74876587, "body": "<code>wb</code> is a new workbook, not the one executing the code so there is no issue closing it."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494527724, "post_id": 43900890, "comment_id": 74879459, "body": "Nick is correct.  The new workbook you created is set to wb, so when yu close wb you are closing the new workbook.  But at least now we know where your code is throwing an error.  And you say it is on the second time you try to save a worksheet, not the first time.  so put  abreak point on the saveas line.  When it stops the first time hit PF5 to let it finish the the first worksheet.  When it comes back the second time, and stops you can hover your mouse over the variables of the path and file name to see their values. they are probably incompatible filename or the path is non-existent."}, {"owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "edited": false, "score": 0, "creation_date": 1494541919, "post_id": 43900890, "comment_id": 74886431, "body": "@JohnMuggins I just reviewed your code again and my &quot;fix&quot; and realize we came to the same answer. Sincere apologies, I must have done something incorrect in my code when I ported your answer over. I blame how frazzled I was yesterday. I thought I was having an epiphany today, perhaps my brain just finally caught up to what you were telling me all along."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 2, "last_activity_date": 1494443375, "creation_date": 1494443375, "answer_id": 43900890, "question_id": 43899585, "link": "https://stackoverflow.com/questions/43899585/excel-vba-saveas-breaking-in-loop/43900890#43900890", "title": "Excel VBA .SaveAs breaking in loop", "body": "<p>I don't know what value \"payOutFileName\" has so I left it out of the code.  I also don't know the value for basicScheduleFileName so I set it to \"Something.\"  You will have to change that to whatever you need to change it too.  This works fine when saving to my dir \"C\\Files\"  Might be a little buggy for you.  Hopefully it will be a start.</p>\n\n<pre><code>Sub asdfghj()\nDim SchedWorkbook As Workbook\nDim SchedName As String\nDim basicScheduleFileName As String\nDim payoutFileName As String\nDim ws As Worksheet\nDim wb As Workbook\n\nbasicScheduleFileName = \"Something\"\nSet SchedWorkbook = ActiveWorkbook\nApplication.DisplayAlerts = False\n\nFor Each ws In SchedWorkbook.Sheets\nDebug.Print ws.Name\n    If ws.Name = \"Instructions\" Or ws.Name = \"Invoice_Items\" _\n    Or ws.Name = \"Customers\" Or _\n       ws.Name = \"Terms\" Or ws.Name = \"Dilution_Type\" Or _\n       ws.Name = \"Approval_Status\" Or _\n       ws.Name = \"Carriers\" Then\n        GoTo NextSched\n    End If\n\n    If ws.Name = \"Invoices\" Then\n        SchedName = basicScheduleFileName &amp; \"ALL\" &amp; \".xlsx\"\n    Else\n        SchedName = ws.Name &amp; \".xlsx\"\n    End If\n\n    ws.Activate\n\n'    SaveAs Application.ActiveWorkbook.Path &amp; \"\\\" &amp; payoutFileName &amp; \"\\Basic Schedule\" &amp; \"\\\" &amp; SchedName, xlOpenXMLWorkbook\n\n    Set wb = Workbooks.Add\n    ws.Copy Before:=wb.Sheets(1)\n    wb.Sheets(\"Sheet1\").Delete\n    wb.SaveAs Filename:=\"C:\\Files\\\" &amp; SchedName, FileFormat:= _\n        xlOpenXMLWorkbook, CreateBackup:=False\n    wb.Close\n\nNextSched:\nNext ws\n\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494530777, "post_id": 43923644, "comment_id": 74881127, "body": "Made a suggestion to improve your solution, edited it in to your answer above. Cheers."}, {"owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494542123, "post_id": 43923644, "comment_id": 74886492, "body": "Thank you very much for the additional tips @DavidZemens I will make those changes."}], "tags": [], "owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "is_accepted": false, "score": 1, "last_activity_date": 1494530760, "last_edit_date": 1494530760, "creation_date": 1494529256, "answer_id": 43923644, "question_id": 43899585, "link": "https://stackoverflow.com/questions/43899585/excel-vba-saveas-breaking-in-loop/43923644#43923644", "title": "Excel VBA .SaveAs breaking in loop", "body": "<p>First off, thanks to everyone who took time and brainpower trying to figure out my issue. I finally figured out a fix that works.<br>\n<strong>First</strong> I made sure to get rid of ActiveWorkbook and ActiveSheet references to avoid any confusion in Excel.<br>\n<strong>Second</strong> As @NickSlash pointed out, it was likely that even if my code did work, it would save multiple copies of the same file under different names. So, to solve that while fixing my original issue, I changed my code to copy the worksheets that I need into a new workbook and save them that way:</p>\n\n<pre><code>Dim WS As Worksheet\nDim WB As Workbook\nDim NWB As Workbook\nDim SchedName As String\n\nSet WB = Workbooks(\"Basic_Schedule-.xls\")\nWB.Activate\n\n'Application.DisplayAlerts = False\n\nFor Each WS In WB.Sheets\n    WB.Activate\n\n    If WS.Name = \"Instructions\" Or WS.Name = \"Invoice_Items\" Or WS.Name = \"Customers\" Or _\n       WS.Name = \"Terms\" Or WS.Name = \"Dilution_Type\" Or WS.Name = \"Approval_Status\" Or _\n       WS.Name = \"Carriers\" Then\n        GoTo NextSched\n    End If\n\n    If WS.Name = \"Invoices\" Then\n        SchedName = basicScheduleFileName &amp; \"ALL\" &amp; \".xlsx\"\n    Else\n        SchedName = WS.Name &amp; \".xlsx\"\n    End If\n\n\n    'Copy sheet to another WB\n    Set NWB = Workbooks.Add\n    WB.Activate\n    Sheets(WS.Name).Copy After:=NWB.Sheets(NWB.Sheets.Count)\n    NWB.Sheets(\"Sheet1\").Delete\n    NWB.SaveAs filename:=basicScheduleFilePath &amp; \"\\\" &amp; payoutFileName &amp; \"\\Basic Schedule\" &amp; \"\\\" &amp; SchedName\n    NWB.Close\n    WB.Activate\n\nNextSched:\nNext WS\n</code></pre>\n\n<p>Instead of this:</p>\n\n<pre><code>'Copy sheet to another WB\nSet NWB = Workbooks.Add\nWB.Activate\nSheets(WS.Name).Copy After:=NWB.Sheets(NWB.Sheets.Count)\nNWB.Sheets(\"Sheet1\").Delete\nNWB.SaveAs filename:=basicScheduleFilePath &amp; \"\\\" &amp; payoutFileName &amp; \"\\Basic Schedule\" &amp; \"\\\" &amp; SchedName\nNWB.Close\nWB.Activate\n</code></pre>\n\n<p>Do this -- you can avoid the \"Activate\" method call, and also if you have a reference to <code>WS</code> as an object, it's redundant to do <code>WB.Sheets(WS.Name)</code> when <code>WS</code> already refers to the same Worksheet.</p>\n\n<pre><code>'Copy sheet to another WB\nWS.Copy '## Creates a new workbook with the copied sheet.\nSet NWB = ActiveWorkbook\nNWB.SaveAs filename:=basicScheduleFilePath &amp; \"\\\" &amp; payoutFileName &amp; \"\\Basic Schedule\" &amp; \"\\\" &amp; SchedName\nNWB.Close\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7993236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac601920074d1e1ba30f3cc923ceaa6d?s=128&d=identicon&r=PG&f=1", "display_name": "IntegrityAnthony", "link": "https://stackoverflow.com/users/7993236/integrityanthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1207, "favorite_count": 0, "accepted_answer_id": 43900890, "answer_count": 2, "score": 0, "last_activity_date": 1494530760, "creation_date": 1494438913, "last_edit_date": 1494452702, "question_id": 43899585, "link": "https://stackoverflow.com/questions/43899585/excel-vba-saveas-breaking-in-loop", "title": "Excel VBA .SaveAs breaking in loop", "body": "<p>I have an excel workbook broken out with multiple worksheets, 1 per customer. In my code, I am trying to save each individual customer worksheet as its own excel file. However, the .SaveAs command breaks the second time it triggers in the loop. Any pointers would be fantastic.</p>\n\n<pre><code>Dim SchedWorksheet As Worksheet\nDim SchedWorkbook As Workbook\nDim SchedName As String\n\nSet SchedWorkbook = ActiveWorkbook\nSet SchedWorksheet = ActiveSheet\nApplication.DisplayAlerts = False\n\nFor Each Worksheet In SchedWorkbook.Sheets\n    If Worksheet.Name = \"Instructions\" Or Worksheet.Name = \"Invoice_Items\" \n    Or Worksheet.Name = \"Customers\" Or _\n       Worksheet.Name = \"Terms\" Or Worksheet.Name = \"Dilution_Type\" Or \n       Worksheet.Name = \"Approval_Status\" Or _\n       Worksheet.Name = \"Carriers\" Then\n        GoTo NextSched\n    End If\n\n    If Worksheet.Name = \"Invoices\" Then\n        'basicScheduleFileName is global set at beginning of program\n        SchedName = basicScheduleFileName &amp; \"ALL\"\n    Else\n        SchedName = Worksheet.Name\n    End If\n\n    'payoutFileName is global set at beginning of program\n    Worksheet.SaveAs Application.ActiveWorkbook.Path &amp; \"\\\" &amp; payoutFileName \n    &amp; \"\\Basic Schedule\" &amp; \"\\\" &amp; SchedName, xlOpenXMLWorkbook\n\nNextSched:\nNext Worksheet\n</code></pre>\n\n<p>The error on the second iteration is as follows: \nRun-time error 1004 'Application-defined or object-defined error'</p>\n\n<p>I have also attempted to run this loop using the SchedWorksheet object in lieu of Worksheet and get the error \"method .SaveAs of object _Worksheet failed\" on the second iteration.  </p>\n\n<p><strong>Question</strong> I have code extremely similar to his code earlier in my program that takes a similar dataset and uses an exportAsFixedFormat call to save each worksheet as a PDF. Is there an equivalent for .xlsx? (.csv would be fine as well) </p>\n"}, {"tags": ["vba", "vbscript", "email-headers"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494438479, "post_id": 43899177, "comment_id": 74832768, "body": "What <i>exactly</i> are you having a problem with?  Reading a text file from disk?  Identifying the lines of interest? Splitting the lines into your required fields ?"}, {"owner": {"reputation": 87, "user_id": 7939780, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b97a2507e37cc093ea41e7f0381b6870?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/7939780/craig"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494440051, "post_id": 43899177, "comment_id": 74833655, "body": "The latter.  The lines of interest are embedded in the &quot;Received: From&quot; section of the header.  If you look at this link, you&#39;ll see the code for accomplishing what I would like to do (however, it is done with Powershell, not VBA):  <a href=\"https://gallery.technet.microsoft.com/office/8c15881d-c10f-4309-9900-4ff0653987a5\" rel=\"nofollow noreferrer\">gallery.technet.microsoft.com/office/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7939780, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b97a2507e37cc093ea41e7f0381b6870?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/7939780/craig"}, "edited": false, "score": 0, "creation_date": 1494548457, "post_id": 43922485, "comment_id": 74888037, "body": "Thanks, Gman.  I&#39;m still testing...I&#39;m noticing a number of variations, however, in the header text of the emails I processed, so I may need to do some one-off scripting to account for these (i.e., a &quot;from&quot; tag may be followed by 1 or more &quot;by&quot; tags)."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 87, "user_id": 7939780, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b97a2507e37cc093ea41e7f0381b6870?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/7939780/craig"}, "edited": false, "score": 0, "creation_date": 1494555057, "post_id": 43922485, "comment_id": 74889483, "body": "@Craig Ok. But even multiple &quot;by&quot; thing can be handled by a small tweak in the code."}, {"owner": {"reputation": 87, "user_id": 7939780, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b97a2507e37cc093ea41e7f0381b6870?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/7939780/craig"}, "edited": false, "score": 0, "creation_date": 1494579648, "post_id": 43922485, "comment_id": 74899428, "body": "Thanks.  The issue I have is that the above example (1st link that I provided) shows a header example that produces the 2nd link (there are actually 4 hops embedded in the paragraph).  Does your code create a similar result for each email header passed to it?  It&#39;s almost as if we need a &quot;do loop&quot; that loops through each paragraph string and carves out each hop."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 87, "user_id": 7939780, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b97a2507e37cc093ea41e7f0381b6870?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/7939780/craig"}, "edited": false, "score": 0, "creation_date": 1494580100, "post_id": 43922485, "comment_id": 74899719, "body": "@Craig To handle that I have used a split statement in the code. It should work if the number of times the word &quot;Received: &quot; is encountered in the text file = No. of hops you are referring to."}], "tags": [], "owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1494525208, "creation_date": 1494525208, "answer_id": 43922485, "question_id": 43899177, "link": "https://stackoverflow.com/questions/43899177/vba-parse-email-header-routing-hops-data/43922485#43922485", "title": "VBA Parse Email Header Routing (Hops) Data", "body": "<p>Try this code and let me know if it works for you or not.\nYou just need to provide the path of the folder containing all your text files. The code would store the output in a file\"1.txt\" within the same folder. All the values in the file will be separated by double-pipe(||). Ofcourse, you can change it later as per your requirement.</p>\n\n<pre><code>Dim objFso, strFolderPath, objFolder, file, workFile, tempArr, strAllData\nDim strRecordData, arrRecordData\nstrFolderPath = \"C:\\Users\\gu.singh\\Desktop\\Desktop\\Gurman\\2017\\5. May\\aa\"   'REPLACE THIS PATH WITH YOUR FOLDER PATH\nSet objFso = CreateObject(\"Scripting.FileSystemObject\")\nIf objFso.FolderExists(strFolderPath) Then\n    Set objFolder = objFso.GetFolder(strFolderPath)\n    For Each file In objFolder.Files\n        tempArr = Split(file.Name,\".\")\n        If StrComp(tempArr(UBound(tempArr)),\"txt\",1)=0 Then\n            Set workFile = file.OpenAsTextStream(1)\n            strAllData = workFile.ReadAll()\n            workFile.Close\n            arrRecordData = Split(strAllData,\"Received:\")\n            For i=1 To UBound(arrRecordData) Step 1\n                intby = InStr(1,arrRecordData(i),\"by \",1)\n                intfrom = InStr(1,arrRecordData(i),\"from \",1)\n                intwith = InStr(1,arrRecordData(i),\"with \",1)\n                intsemi = InStr(1,arrRecordData(i),\";\",1)\n                intdash = InStr(1,arrRecordData(i),\"-\",1)\n                strFROM = Trim(Mid(arrRecordData(i),intfrom+Len(\"from \"), intby-intfrom-Len(\"from \")))\n                strBY = Trim(Mid(arrRecordData(i),intby+Len(\"by \"), intwith-intby-Len(\"by \")))\n                strWITH = Trim(Mid(arrRecordData(i),intwith+Len(\"with \"), intsemi-intwith-Len(\"with \")))\n                strDATE = Trim(Mid(arrRecordData(i),intsemi+Len(\";\"), intdash-intsemi-Len(\";\")))\n                strResult = strResult &amp; strBY &amp;\"||\"&amp;strFROM&amp;\"||\"&amp;strWITH&amp;\"||\"&amp;strDATE&amp;vbCrLf\n            Next\n\n            Set WorkFile = Nothing\n        End If\n    Next\n    Set objFolder = Nothing\nEnd If\nSet fyl = objFso.OpenTextFile(strFolderPath&amp;\"\\1.txt\",2,True)\nfyl.Write strResult\nfyl.Close\nSet fyl=Nothing\nSet objFso = Nothing\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7939780, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b97a2507e37cc093ea41e7f0381b6870?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/7939780/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494525208, "creation_date": 1494437367, "question_id": 43899177, "link": "https://stackoverflow.com/questions/43899177/vba-parse-email-header-routing-hops-data", "title": "VBA Parse Email Header Routing (Hops) Data", "body": "<p>I'm interested in using VBA/VBscript to parse email header data.  There are other answers on this site that address this to some degree, however not to the extent that I need.</p>\n\n<p>I have a number of message headers that I've extracted from emails and have saved as text files, all in one folder (see image below).  I would like to loop through the folder and parse the area identified in the box (perhaps save to excel or a table in Access?).  The data identified in the box shows all the email \"hops\" (when an email is sent it is transferred between many computers - each transfer is a \"hop\").  This data is found in the \"Received: from\" section highlighted below:</p>\n\n<p>*NOTE: Apologies, I'm not at a reputation as of yet to post images:</p>\n\n<p><a href=\"https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/76/18/3782.HSG-8-18-11-1.jpg\" rel=\"nofollow noreferrer\">https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/76/18/3782.HSG-8-18-11-1.jpg</a></p>\n\n<p>The result should look like this:</p>\n\n<p><a href=\"https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/76/18/7624.hsg-8-19-11-1.png\" rel=\"nofollow noreferrer\">https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/76/18/7624.hsg-8-19-11-1.png</a></p>\n\n<p>This is accomplished by parsing the FROM, BY, WITH, and DATESTAMP information from the above boxed area of the message header.</p>\n\n<p>Kind of a tall order, I know.  But I can't seem to find anything online.  Any assistance (or direction to other solutions) would be appreciated.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1494438221, "post_id": 43899125, "comment_id": 74832621, "body": "Does the range being copied have any null headers?"}, {"owner": {"reputation": 968, "user_id": 134118, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7494efd9e38cf32e9b64d145ff8660bf?s=128&d=identicon&r=PG", "display_name": "warsong", "link": "https://stackoverflow.com/users/134118/warsong"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1494497782, "post_id": 43899125, "comment_id": 74858416, "body": "The headers in both ranges look fine, but thanks for pointing that out."}], "answers": [{"comments": [{"owner": {"reputation": 968, "user_id": 134118, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7494efd9e38cf32e9b64d145ff8660bf?s=128&d=identicon&r=PG", "display_name": "warsong", "link": "https://stackoverflow.com/users/134118/warsong"}, "edited": false, "score": 0, "creation_date": 1494497787, "post_id": 43907449, "comment_id": 74858418, "body": "The two ranges (CsummaryA and SsummaryA) in the line that errors are not even remotely similar. What is really confusing is how the error doesn&#39;t happen on the other line with similar code."}, {"owner": {"reputation": 121, "user_id": 6473755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XjkrS5wR0EQ/AAAAAAAAAAI/AAAAAAAAAEU/dHhTTnShP2g/photo.jpg?sz=128", "display_name": "Kamlesh Kishor", "link": "https://stackoverflow.com/users/6473755/kamlesh-kishor"}, "reply_to_user": {"reputation": 968, "user_id": 134118, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7494efd9e38cf32e9b64d145ff8660bf?s=128&d=identicon&r=PG", "display_name": "warsong", "link": "https://stackoverflow.com/users/134118/warsong"}, "edited": false, "score": 0, "creation_date": 1494506607, "post_id": 43907449, "comment_id": 74864602, "body": "Can you paste an image of headers for both the advanced filter statements. That would help in identifying the possible reason for error."}], "tags": [], "owner": {"reputation": 121, "user_id": 6473755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XjkrS5wR0EQ/AAAAAAAAAAI/AAAAAAAAAEU/dHhTTnShP2g/photo.jpg?sz=128", "display_name": "Kamlesh Kishor", "link": "https://stackoverflow.com/users/6473755/kamlesh-kishor"}, "is_accepted": false, "score": 1, "last_activity_date": 1494481624, "creation_date": 1494481624, "answer_id": 43907449, "question_id": 43899125, "link": "https://stackoverflow.com/questions/43899125/excel-vba-extract-range-is-missing-or-illegal-error-on-range-advancedfilter/43907449#43907449", "title": "Excel VBA - Extract range is missing or illegal error on Range.AdvancedFilter", "body": "<p>Make sure that the column headers in both CriteriaRange and CopyToRange are exactly same in terms of how they are spelled and there are no null headers as JNevill mentioned. The order of columns doesn't matter as long as they as spelled the same.</p>\n"}], "owner": {"reputation": 968, "user_id": 134118, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7494efd9e38cf32e9b64d145ff8660bf?s=128&d=identicon&r=PG", "display_name": "warsong", "link": "https://stackoverflow.com/users/134118/warsong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 816, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494498546, "creation_date": 1494437220, "last_edit_date": 1531164843, "question_id": 43899125, "link": "https://stackoverflow.com/questions/43899125/excel-vba-extract-range-is-missing-or-illegal-error-on-range-advancedfilter", "title": "Excel VBA - Extract range is missing or illegal error on Range.AdvancedFilter", "body": "<p>I'm attempting to debug some old code (not written by me) and I'm getting the following run-time error (1004) on the first AdvancedFilter method in the code below.</p>\n\n<blockquote>\n  <p>The extract range has a missing or illegal field name</p>\n</blockquote>\n\n<pre><code>Application.Goto Reference:=\"first_line\"\n'Range(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Name = \"data\"\n\nApplication.Goto Reference:=\"heading\"\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Name = \"base\"\n\nApplication.Goto Reference:=\"col_last\"\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Name = \"test_last\"\n\n\n\nSheets(\"work\").Visible = True\nApplication.Goto Reference:=\"base\"\n\n\n\nRange(\"base\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range( _\n    \"CsummaryA\"), CopyToRange:=Range(\"SsummaryA\"), Unique:=False\n\n ' error actually happens at this line, not the previous one as I stated previously\nApplication.Goto Reference:=\"base\"\nRange(\"base\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range( _\n    \"Csummary\"), CopyToRange:=Range(\"Ssummary\"), Unique:=True\n</code></pre>\n\n<p>Any ideas on what could be causing the error?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1494437178, "post_id": 43899054, "comment_id": 74831966, "body": "excel-vba is very different from VB.NET.  Whatever you are using, please remove the other tag"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494438263, "post_id": 43899054, "comment_id": 74832648, "body": "When the demand on memory gets too high, Excel stops responding,  The only way to do it, in sheet, is to slow the process down at each loop to allow Excel to update the screen.  But this is counter intuitive as we want it to run as quick as possible."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494439223, "post_id": 43899054, "comment_id": 74833181, "body": "Please realize with the code below you are slowing down your code, to show something.  Just want to make sure you are aware of the consequences.  It may be more important to show progress than to finish the code as quick as possible."}], "answers": [{"tags": [], "owner": {"reputation": 190, "user_id": 5927134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872d62710be12a87366b857a314b52c3?s=128&d=identicon&r=PG&f=1", "display_name": "SuShuang", "link": "https://stackoverflow.com/users/5927134/sushuang"}, "is_accepted": true, "score": 0, "last_activity_date": 1494438186, "creation_date": 1494438186, "answer_id": 43899403, "question_id": 43899054, "link": "https://stackoverflow.com/questions/43899054/update-cell-value-from-within-vba-to-show-user-that-sub-is-running/43899403#43899403", "title": "Update cell value from within VBA to show user that Sub is running", "body": "<p>The best way in my opinion to show the progress is to create UserForm. Below you'll find VBA code you should place in this UserForm. Just insert there 1 button and one caption - it should works. Try :)</p>\n\n<p>In a module:</p>\n\n<pre><code>Sub UserFormTest()\n\nUserForm1.Show\n\nEnd Sub\n</code></pre>\n\n<p>In a UserForm:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim r As Integer\n\nFor r = 2 To 10000\n    'Your code goes here\n    Call Aktual(r)\n    Timeout 0.01\n\nNext r\nApplication.ScreenUpdating = True\n\nUnload Me\n\nEnd Sub\n\n\n\nPrivate Sub Aktual(intProgres As Integer)\n\nLabel1.Caption = \"Progress \" &amp; intProgres\n\n\nEnd Sub\n\n\nSub Timeout(seconds As Double)\nStart_Time = Timer\nDo\nDoEvents\n\nLoop Until (Timer + 1000 - Start_Time) &gt;= seconds\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7124303, "user_type": "registered", "profile_image": "https://graph.facebook.com/1170356773001716/picture?type=large", "display_name": "velvetlady", "link": "https://stackoverflow.com/users/7124303/velvetlady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 43899403, "answer_count": 1, "score": 0, "last_activity_date": 1494438186, "creation_date": 1494437013, "last_edit_date": 1531164843, "question_id": 43899054, "link": "https://stackoverflow.com/questions/43899054/update-cell-value-from-within-vba-to-show-user-that-sub-is-running", "title": "Update cell value from within VBA to show user that Sub is running", "body": "<p>This has been asked before but i have tried all the suggestions without success. I am running a VB for Excel subroutine that is controlled by user input read from the spreadsheet and that loops to recalculate values in memory within the subroutine. I have a line that outputs the iteration number to a cell for the user to see the progress and verify it is running properly. The cell updates for a few iterations (usual 4) and then ceases to show progress even though the routine will eventually proceed to completion at which time the cell finally updates. The current procedure may run 600-700 iterations to reach a converged solution.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1494437627, "post_id": 43899089, "comment_id": 74832245, "body": "Perfect. Thanks :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1494437427, "last_edit_date": 1494437427, "creation_date": 1494437114, "answer_id": 43899089, "question_id": 43898970, "link": "https://stackoverflow.com/questions/43898970/vba-to-get-the-date-of-the-previous-workday/43899089#43899089", "title": "VBA to get the date of the Previous Workday", "body": "<p>Consider:</p>\n\n<pre><code>=WORKDAY(TODAY(),-1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/GRTuT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GRTuT.png\" alt=\"enter image description here\"></a></p>\n\n<p>This formula can be easily modified to handle holidays.</p>\n\n<p>In VBA:</p>\n\n<pre><code>Sub dural()\n    MsgBox CDate(Evaluate(\"WORKDAY(TODAY(),-1)\"))\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 5927134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872d62710be12a87366b857a314b52c3?s=128&d=identicon&r=PG&f=1", "display_name": "SuShuang", "link": "https://stackoverflow.com/users/5927134/sushuang"}, "is_accepted": false, "score": 0, "last_activity_date": 1494439560, "creation_date": 1494439560, "answer_id": 43899762, "question_id": 43898970, "link": "https://stackoverflow.com/questions/43898970/vba-to-get-the-date-of-the-previous-workday/43899762#43899762", "title": "VBA to get the date of the Previous Workday", "body": "<p>It's worth to say that this function can handle also Public Holidays, but this argument is optional. So in fact we have:</p>\n\n<pre><code>=WORKDAY(TODAY(),-1, 'Range with Public Holidays Dates')\n</code></pre>\n\n<p>for example:</p>\n\n<pre><code>=WORKDAY(TODAY(),-1, A1:A10)\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8539, "favorite_count": 0, "accepted_answer_id": 43899089, "answer_count": 2, "score": 0, "last_activity_date": 1607062673, "creation_date": 1494436699, "last_edit_date": 1531164843, "question_id": 43898970, "link": "https://stackoverflow.com/questions/43898970/vba-to-get-the-date-of-the-previous-workday", "title": "VBA to get the date of the Previous Workday", "body": "<p>I am trying to get the Previous working day of today. Say if suppose today is Wednesday, then the previous working day will be Tueday but if today is Monday then the previous working day will be Friday. How do I get the date of the previous working day?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1494437368, "post_id": 43898923, "comment_id": 74832085, "body": "First, when you call the <code>Match</code> function, in the <code>AddToArray</code> function, you are calling it with the parameter <code>s</code> but you have declared the worksheet as variable name <code>sh</code>, which you have not initialized to anything.  You also are calling it with the parameter <code>column</code> which hasn&#39;t been declared and hasn&#39;t been initialized, so this statement won&#39;t work."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1494447937, "post_id": 43898923, "comment_id": 74838057, "body": "One more thing:  The <code>Match</code> function won&#39;t work.  As written, it will always return <code>False</code> because it will get through the <code>While</code> loop and then automatically get set to <code>False</code>.  You need to put the <code>Match=False</code> statement at the BEGINNING of the function if you want to do it this way."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1494439154, "post_id": 43899332, "comment_id": 74833138, "body": "Good explanation!! Could be even better to execute a <code>CountIf</code> or other construct to determine the size in advance, and then use a single <code>ReDim</code> statement outside the loop, or to use a collection or dictionary (<code>dictionary.Items()</code> returns an array, for instance) :)   Plenty of ways to skin this cat!"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 1, "last_activity_date": 1494438449, "last_edit_date": 1494438449, "creation_date": 1494437876, "answer_id": 43899332, "question_id": 43898923, "link": "https://stackoverflow.com/questions/43898923/add-strings-to-dynamic-array-vba/43899332#43899332", "title": "Add Strings to Dynamic Array VBA", "body": "<p>As I stated in a comment to the question, there are a couple of problems in your code before adding anything to the array that will prevent this from working, but assuming that this was caused by simplifying the code to ask the question, the following should work.</p>\n\n<p>The specific question that you are asking, is how to populate the array while increasing its size when needed.</p>\n\n<p>To do this, simply do this:</p>\n\n<p>Instead of:</p>\n\n<pre><code>ReDim Preserve a(size)\nFor Each rw In sh.Rows\n    If Match(sh.Cells(rw.Row, 1), s, column) = True Then\n</code></pre>\n\n<p>Reorder this so that it is:</p>\n\n<pre><code>For Each rw In sh.Rows\n    If Match(sh.Cells(rw.Row, 1), s, column) = True Then\n         ReDim Preserve a(size) 'increase size of array\n         a(size) = sh.Cells(rw.Row,1) 'put value in array\n         size = size + 1 'create value for size of next array\n    End If\nNext rw\n\n....\n</code></pre>\n\n<p>This probably isn't the best way to accomplish this task, but this is what you were asking to do.  First, increasing the array size EVERY time is going to waste a lot of time.  It would be better to increase the array size every 10 or 100 matches instead of every time.  I will leave this exercise to you.  Then you could resize it at the end to the exact size you want.</p>\n"}, {"comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1494438311, "post_id": 43899347, "comment_id": 74832672, "body": "I agree that this is a much better solution to the OPs problem than the OPs original approach, but it would be better if you explained WHY you made all of these changes.  For instance, you called out that you replaced their <code>Match</code> function with the default <code>Find</code> function without telling them why.  It is likely obvious to you why you would do this, but it is likely not obvious to the OP, else they would have been able to solve the problem themselves already."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1494439199, "post_id": 43899347, "comment_id": 74833165, "body": "@OpiesDad. Thanks for the push in the right direction. I definitely didn&#39;t have enough comments with the code."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 2, "last_activity_date": 1494438988, "last_edit_date": 1494438988, "creation_date": 1494437952, "answer_id": 43899347, "question_id": 43898923, "link": "https://stackoverflow.com/questions/43898923/add-strings-to-dynamic-array-vba/43899347#43899347", "title": "Add Strings to Dynamic Array VBA", "body": "<p>Here is one solution. I scrapped your <code>Match</code> function and replaced it with a <code>Find</code> function. </p>\n\n<pre><code>Option Explicit\n\nSub AddToArray()\n    Dim primaryColumn As Range, secondaryColumn As Range, matchedRange As Range\n    Dim i As Long, currentIndex As Long\n    Dim matchingNames As Variant\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Set primaryColumn = .Range(\"A1:A10\")\n        Set secondaryColumn = .Range(\"B1:B10\")\n    End With\n\n    'Size your array so no dynamic resizing is necessary\n    ReDim matchingNames(1 To primaryColumn.Rows.Count)\n    currentIndex = 1\n\n    'loop through your primary column \n    'add any values that match to the matchingNames array\n    For i = 1 To primaryColumn.Rows.Count\n        On Error Resume Next\n        Set matchedRange = secondaryColumn.Find(primaryColumn.Cells(i, 1).Value)\n        On Error GoTo 0\n\n        If Not matchedRange Is Nothing Then\n            matchingNames(currentIndex) = matchedRange.Value\n            currentIndex = currentIndex + 1\n        End If\n    Next i\n\n    'remove unused part of array\n    ReDim Preserve matchingNames(1 To currentIndex - 1)\n\n    'matchingNames array now contains just the values you want... use it how you need!\n    Debug.Print matchingNames(1)\n    Debug.Print matchingNames(2)\n    '...etc\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>Extra comments</em></p>\n\n<p>There is no need to create your own <em>Match</em> function because it already exists in VBA:</p>\n\n<pre><code>Application.Match()\nWorksheetFunction.Match()\n</code></pre>\n\n<p>and as I mentioned above you can also achieve the same result with the <code>Find</code> function which is my preference here because I prefer the way you can check for no matches (other methods throw less convenient errors).</p>\n\n<p>Finally, I also opted to restructure your code into one <code>Sub</code> rather than two <code>Functions</code>. You weren't returning anything with your <code>AddToArray</code> function which pretty much means by definition it should actually be a <code>Sub</code></p>\n"}], "owner": {"reputation": 614, "user_id": 3893580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bbf5b1f688a462c3a076210ea9efb3?s=128&d=identicon&r=PG&f=1", "display_name": "Caerus", "link": "https://stackoverflow.com/users/3893580/caerus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6637, "favorite_count": 0, "accepted_answer_id": 43899347, "answer_count": 2, "score": 2, "last_activity_date": 1494438988, "creation_date": 1494436562, "question_id": 43898923, "link": "https://stackoverflow.com/questions/43898923/add-strings-to-dynamic-array-vba", "title": "Add Strings to Dynamic Array VBA", "body": "<p><strong>Problem:</strong> I am comparing two columns of names. If a name from the primary column matches a name in the secondary column, then I would like to add the matching name to an array of strings.</p>\n\n<p><strong>Function 1:</strong> This boolean function should indicate whether there is a match:</p>\n\n<pre><code>Function Match(name As String, s As Worksheet, column As Integer) As Boolean\nDim i As Integer\ni = 2\nWhile s.Cells(i, column) &lt;&gt; \"\"\n  If s.Cells(i, column).Value = name Then\n        Match = True\n  End If\n  i = i + 1\nWend\nMatch = False\nEnd Function\n</code></pre>\n\n<p><strong>Function 2:</strong> This function should add the matching name to a dynamic array of strings. Here I am somewhat stuck as I am new to arrays- any suggestions?</p>\n\n<pre><code>Function AddToArray(ys) As String()\nDim a() As String\nDim size As Integer\nDim i As Integer\nDim sh As Worksheet\nDim rw As Range\nsize = 0\nReDim Preserve a(size)\nFor Each rw In sh.Rows\n    If Match(sh.Cells(rw.Row, 1), s, column) = True Then\n        ??\n\nsize = size + 1\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494437970, "post_id": 43898714, "comment_id": 74832454, "body": "RTE 9 means &quot;this item doesn&#39;t exist&quot; - if there&#39;s no module named <code>sample_module</code> in the <code>VBComponents</code> collection, then there&#39;s nothing to remove."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494438017, "post_id": 43898714, "comment_id": 74832481, "body": "Also, if the rest of the script executes, you have <code>On Error Resume Next</code> somewhere, and that&#39;s probably a bad idea."}, {"owner": {"reputation": 97, "user_id": 6906950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-rmdhI2jCaAA/AAAAAAAAAAI/AAAAAAAAAB0/6AxIXyJBIu0/photo.jpg?sz=128", "display_name": "Walter Whalen", "link": "https://stackoverflow.com/users/6906950/walter-whalen"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494438704, "post_id": 43898714, "comment_id": 74832904, "body": "There is a sample_module though. Some users get the error and some do not. For the users who don&#39;t get the error, the module is removed. I also don&#39;t have any  On Error Resume Next in the script. I feel like I&#39;m not referencing the module correctly, but I&#39;m not sure how to address it."}, {"owner": {"reputation": 97, "user_id": 6906950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-rmdhI2jCaAA/AAAAAAAAAAI/AAAAAAAAAB0/6AxIXyJBIu0/photo.jpg?sz=128", "display_name": "Walter Whalen", "link": "https://stackoverflow.com/users/6906950/walter-whalen"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494438784, "post_id": 43898714, "comment_id": 74832945, "body": "Is it possible that the module should be referenced as a part of the worksheet?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494438862, "post_id": 43898714, "comment_id": 74832992, "body": "Depends what the heck &quot;referenced as a part of the worksheet&quot; stands for I guess."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494438945, "post_id": 43898714, "comment_id": 74833044, "body": "Also what matters isn&#39;t that the module exists and is loaded in the VBE, but that it exists <b>in the ActiveVBProject</b>."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6906950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-rmdhI2jCaAA/AAAAAAAAAAI/AAAAAAAAAB0/6AxIXyJBIu0/photo.jpg?sz=128", "display_name": "Walter Whalen", "link": "https://stackoverflow.com/users/6906950/walter-whalen"}, "edited": false, "score": 0, "creation_date": 1494437643, "post_id": 43898744, "comment_id": 74832253, "body": "I thought I was when I was setting vbCom. I also already had the users enable trust access. Should I alter my vbCom reference somehow?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 97, "user_id": 6906950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-rmdhI2jCaAA/AAAAAAAAAAI/AAAAAAAAAB0/6AxIXyJBIu0/photo.jpg?sz=128", "display_name": "Walter Whalen", "link": "https://stackoverflow.com/users/6906950/walter-whalen"}, "edited": false, "score": 0, "creation_date": 1494440942, "post_id": 43898744, "comment_id": 74834131, "body": "@WalterWhalen no. Your code is making late-bound calls to the VBIDE API, because you declared <code>vbCom As Object</code>."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1494435904, "last_edit_date": 1525816189, "creation_date": 1494435904, "answer_id": 43898744, "question_id": 43898714, "link": "https://stackoverflow.com/questions/43898714/run-time-error-9-when-removing-module-excel-vba/43898744#43898744", "title": "Run-Time Error &#39;9&#39; when removing module Excel VBA", "body": "<p>You need to add reference to the VBA Extensibility library and enable \"Trust access to the Visual Basic Project\" on each client running those commands. You can see this page from Chip with a great breakdown: <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1494439148, "post_id": 43899616, "comment_id": 74833136, "body": "Kudos for removing the <code>ActiveVBProject</code> ambiguity."}, {"owner": {"reputation": 97, "user_id": 6906950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-rmdhI2jCaAA/AAAAAAAAAAI/AAAAAAAAAB0/6AxIXyJBIu0/photo.jpg?sz=128", "display_name": "Walter Whalen", "link": "https://stackoverflow.com/users/6906950/walter-whalen"}, "edited": false, "score": 0, "creation_date": 1494443087, "post_id": 43899616, "comment_id": 74835456, "body": "Thanks for the assistance. This works quite well. The error isn&#39;t showing up anymore."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 97, "user_id": 6906950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-rmdhI2jCaAA/AAAAAAAAAAI/AAAAAAAAAB0/6AxIXyJBIu0/photo.jpg?sz=128", "display_name": "Walter Whalen", "link": "https://stackoverflow.com/users/6906950/walter-whalen"}, "edited": false, "score": 0, "creation_date": 1494443150, "post_id": 43899616, "comment_id": 74835486, "body": "@WalterWhalen  you&#39;re welcome, you can mark as &quot;Answer&quot; by clicking the gray check mark next to my answer"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1494439168, "last_edit_date": 1494439168, "creation_date": 1494439044, "answer_id": 43899616, "question_id": 43898714, "link": "https://stackoverflow.com/questions/43898714/run-time-error-9-when-removing-module-excel-vba/43899616#43899616", "title": "Run-Time Error &#39;9&#39; when removing module Excel VBA", "body": "<p>Try to run the code with the <code>For Each vbCom In .VBComponents</code> loop below, see what you get:</p>\n\n<pre><code>Option Explicit\n\nSub CheckVBProjComp()\n\nDim vbCom As Object\nDim flag As Boolean\nDim VbComName As String\n\nVbComName = \"sample_module\"\n\nWith ThisWorkbook.VBProject\n    For Each vbCom In .VBComponents\n        If vbCom.Name Like VbComName Then\n            .VBComponents.Remove .VBComponents(vbCom.Name)\n            flag = True\n            Exit For\n        End If\n    Next vbCom\nEnd With\n\nIf flag Then\n    MsgBox \"VB Component \" &amp; Chr(34) &amp; VbComName &amp; Chr(34) &amp; \" successfully removed\", vbOKOnly\nElse\n    MsgBox \"Unable to find VB Component \" &amp; Chr(34) &amp; VbComName &amp; Chr(34), vbInformation\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1494440735, "creation_date": 1494440735, "answer_id": 43900098, "question_id": 43898714, "link": "https://stackoverflow.com/questions/43898714/run-time-error-9-when-removing-module-excel-vba/43900098#43900098", "title": "Run-Time Error &#39;9&#39; when removing module Excel VBA", "body": "<p>If the goal is simply to remove all modules in a given Excel Workbook, then work off that <code>Workbook</code>'s <code>VBProject</code>, don't assume the <code>VBE.ActiveVBProject</code> is going to be the project behind the workbook you're targeting.</p>\n\n<p>This procedure strips all non-document modules from the specified <code>target</code>:</p>\n\n<pre><code>Public Sub RemoveAllMacros(ByVal target As Workbook)\n\n    'if the target is ThisWorkbook, we're removing the very macro we're running!\n    If target Is ThisWorkbook Then Exit Sub\n\n    Dim components As VBComponents\n    Set components = target.VBProject.VBComponents\n\n    Dim component As VBComponent\n    For Each component In components\n        If component.Type &lt;&gt; vbext_ct_Document Then components.Remove component\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6906950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-rmdhI2jCaAA/AAAAAAAAAAI/AAAAAAAAAB0/6AxIXyJBIu0/photo.jpg?sz=128", "display_name": "Walter Whalen", "link": "https://stackoverflow.com/users/6906950/walter-whalen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 43899616, "answer_count": 3, "score": 0, "last_activity_date": 1494440735, "creation_date": 1494435766, "question_id": 43898714, "link": "https://stackoverflow.com/questions/43898714/run-time-error-9-when-removing-module-excel-vba", "title": "Run-Time Error &#39;9&#39; when removing module Excel VBA", "body": "<p>I am sharing a worksheet with a few colleagues. This spreadsheet will eventually be sent to an external party, so we are removing the VBE module programatically as a part of the macro. I used this code which was taken from Microsoft's documentation:</p>\n\n<pre><code> Dim vbCom As Object\n\n    Set vbCom = Application.VBE.ActiveVBProject.VBComponents\n\n    vbCom.Remove VBComponent:= vbCom.Item(\"sample_module\")\n</code></pre>\n\n<p>It works for some users, but I get Run-Time Error '9' with others. The rest of the script eventually executes, but the module isn't removed. </p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1494435499, "post_id": 43898561, "comment_id": 74830986, "body": "&quot;provide macros/VBA&quot; Unfortunately this is not a &quot;Code For Me&quot; site. We can help you address specific issues in your code to overcome obstacles or errors, but we generally don&#39;t write code from scratch for free.  If you have something that you have tried, please edit your post to include your attempt."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1494435604, "post_id": 43898561, "comment_id": 74831057, "body": "If you are looking for how to get started, look into the <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Split</a> function, and you will also need to learn how to loop.  Simple looping examples <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1494435759, "post_id": 43898561, "comment_id": 74831148, "body": "You can also use the function &quot;Text to Columns&quot; to separate the second column, then copy and Paste Special - Transpose and then just fill in the first column by copying or dragging. Repeat ad nauseum."}, {"owner": {"reputation": 165, "user_id": 5366288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4b39Aey9brc/AAAAAAAAAAI/AAAAAAAACMw/t2klKGEJoKE/photo.jpg?sz=128", "display_name": "Pradyumna Sagar", "link": "https://stackoverflow.com/users/5366288/pradyumna-sagar"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1494436443, "post_id": 43898561, "comment_id": 74831576, "body": "@nbayly I tried that but I have like 800 rows to do that."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1494438344, "last_edit_date": 1494438344, "creation_date": 1494437223, "answer_id": 43899128, "question_id": 43898561, "link": "https://stackoverflow.com/questions/43898561/how-to-separate-and-transpose-row-in-excel/43899128#43899128", "title": "How to separate and transpose row in excel?", "body": "<p>I happen to have a macro that pretty much does this, so I just tweaked it to match your data.  Otherwise, I'd also ask that you show some effort first.  I assume your data is in column A (\"testa\", \"second\", etc) and column B (the delimited data)</p>\n\n<pre><code>Sub splitCopyDown()\nDim rng As Range, cel As Range\nDim cols As Long, lastRow As Long, i As Long, k As Long\n\nSet rng = Range(\"B1:B\" &amp; Cells(Rows.Count, 2).End(xlUp).Row)\nrng.TextToColumns Destination:=Range(\"B1\"), Semicolon:=True\n\nlastRow = Cells(Rows.Count, 2).End(xlUp).Row\n\nFor i = lastRow To 1 Step -1\n    cols = Cells(i, Columns.Count).End(xlToLeft).Column\n    Set rng = Range(Cells(i, 3), Cells(i, cols))\n    Range(rng.Offset(1, 0), rng.Offset(cols - 2, 0)).EntireRow.Insert\n    rng.Copy\n    rng.Cells(1).Offset(1, -1).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n    rng.Clear\nNext i\n\nlastRow = Cells(Rows.Count, 2).End(xlUp).Row\nRange(Cells(1, 1), Cells(lastRow, 1)).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=r[-1]c\"\nRange(Cells(1, 1), Cells(lastRow, 1)).Value = Range(Cells(1, 1), Cells(lastRow, 1)).Value\nEnd Sub\n</code></pre>\n\n<p>(It's an older macro, but it checks out. You could likely make it more efficient)</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1494438743, "post_id": 43899237, "comment_id": 74832925, "body": "(I wonder, can we edit posts to remove 100% absolutely and completely false and irrelevant information? I have no idea what you mean with that last sentence....hmmmmmmm.)"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1494437566, "creation_date": 1494437566, "answer_id": 43899237, "question_id": 43898561, "link": "https://stackoverflow.com/questions/43898561/how-to-separate-and-transpose-row-in-excel/43899237#43899237", "title": "How to separate and transpose row in excel?", "body": "<p>While BruceWayne beat me to the punch, I quickly jotted this subroutine out so I figured I should share it so I don't feel like I wasted 5 minutes of my day.</p>\n\n<pre><code>Sub liftAndSeperate()\n    Dim rngData As Range\n    Dim intWriteRow As Integer\n    Dim rngReadRow As Range\n    Dim readArrayElem As Variant\n\n    'Assuming the data is in Sheet1 A1:B20\n    Set rngData = Sheet1.Range(\"A1:B20\")\n\n    'Assuming we will write to Sheet2 starting at row 1:\n    intWriteRow = 1\n\n    'Loop through each row in that range:\n    'The row we are reading will be held in variable rngReadRow\n    For Each rngReadRow In rngData.Rows\n\n        'Generate an array using split and loop through the array to write the values out\n        For Each readArrayElem In Split(rngReadRow.Cells(1, 2).Value, \";\")\n\n            'Write out column A from sheet1 to sheet2\n            Sheet2.Cells(intWriteRow, 1).Value = rngReadRow.Cells(1, 1)\n\n            'Write out the array element\n            Sheet2.Cells(intWriteRow, 2).Value = readArrayElem\n\n            'Increment to the next write row\n            intWriteRow = intWriteRow + 1\n        Next readArrayElem\n    Next rngReadRow\nEnd Sub\n</code></pre>\n\n<p>p.s. BruceWayne is Batman (now his cover is blown)</p>\n"}], "owner": {"reputation": 165, "user_id": 5366288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4b39Aey9brc/AAAAAAAAAAI/AAAAAAAACMw/t2klKGEJoKE/photo.jpg?sz=128", "display_name": "Pradyumna Sagar", "link": "https://stackoverflow.com/users/5366288/pradyumna-sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "closed_date": 1494437560, "accepted_answer_id": 43899128, "answer_count": 2, "score": 1, "last_activity_date": 1494438344, "creation_date": 1494435256, "last_edit_date": 1531161705, "question_id": 43898561, "link": "https://stackoverflow.com/questions/43898561/how-to-separate-and-transpose-row-in-excel", "closed_reason": "Duplicate", "title": "How to separate and transpose row in excel?", "body": "<p>I have excel sheet with two columns, the first column contains contain names and second contain multiple semicolons separated values I want to separate the second column and transpose with first column value repeated,</p>\n\n<p>example\nsheet:</p>\n\n<pre><code>testa   KRAS;EGFR\nsecond  HSP90AB1;KSR1;PLXND1;LAMB2;ROCK2\ntest    PPP2R1A;TRIB3;EGFR;FGFR2\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>testa   KRAS\ntesta   EGFR\nsecond  HSP90AB1\nsecond  KSR1\nsecond  PLXND1\nsecond  LAMB2\nsecond  ROCK2\ntest    PPP2R1A\ntest    TRIB3\ntest    EGFR\ntest    FGFR2\n</code></pre>\n\n<p>Right now I am manually separating it, is there any macros/VBA for this?</p>\n"}, {"tags": ["excel", "save", "vba"], "comments": [{"owner": {"reputation": 85, "user_id": 6845519, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-lumzAaJ4zHA/AAAAAAAAAAI/AAAAAAAAABQ/oEvVFcdTs4M/photo.jpg?sz=128", "display_name": "sheetal singh", "link": "https://stackoverflow.com/users/6845519/sheetal-singh"}, "edited": false, "score": 0, "creation_date": 1494435449, "post_id": 43898475, "comment_id": 74830953, "body": "I seems that It finds last used cell in 4th column(E) instead of last blank cells of the column!"}, {"owner": {"reputation": 135, "user_id": 5104055, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8199307b213a1c7fc74ff82098bf2f98?s=128&d=identicon&r=PG&f=1", "display_name": "acvbasql", "link": "https://stackoverflow.com/users/5104055/acvbasql"}, "edited": false, "score": 1, "creation_date": 1494440245, "post_id": 43898475, "comment_id": 74833751, "body": "That&#39;s because your &quot;last&quot; variable is set to look at column E.  Either change that to a column that is populated for every row, or try using UsedRange.Rows.Count.  Also, edit your code so it shows up properly and you&#39;ll probably get more responses."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 135, "user_id": 5104055, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8199307b213a1c7fc74ff82098bf2f98?s=128&d=identicon&r=PG&f=1", "display_name": "acvbasql", "link": "https://stackoverflow.com/users/5104055/acvbasql"}, "edited": false, "score": 0, "creation_date": 1494447152, "post_id": 43898475, "comment_id": 74837680, "body": "Definitely use the UsedRange.Rows.Count as @acvbasql suggested.  That will give you the absolute last row that is not blank."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9514525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b972b779e84366ee29c278a5957060c?s=128&d=identicon&r=PG&f=1", "display_name": "Nisha E", "link": "https://stackoverflow.com/users/9514525/nisha-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1521454261, "creation_date": 1521454261, "answer_id": 49360338, "question_id": 43898475, "link": "https://stackoverflow.com/questions/43898475/vba-to-save-data-on-another-sheet/49360338#49360338", "title": "VBA to save data on another sheet", "body": "<p>For the first time its placing the data in the range(\"A4\") and so on, this is happening because you are writing statements individually, and then you have written code to copy the data from range(\"A5\" &amp; \":AI\" &amp; LR + 2) so its placing data in correct position. If you want to paste data in sheet \"Data\" in range(\"W2\") then ignore the individual statements.</p>\n"}], "owner": {"reputation": 85, "user_id": 6845519, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-lumzAaJ4zHA/AAAAAAAAAAI/AAAAAAAAABQ/oEvVFcdTs4M/photo.jpg?sz=128", "display_name": "sheetal singh", "link": "https://stackoverflow.com/users/6845519/sheetal-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1839, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523485510, "creation_date": 1494434993, "last_edit_date": 1531164843, "question_id": 43898475, "link": "https://stackoverflow.com/questions/43898475/vba-to-save-data-on-another-sheet", "title": "VBA to save data on another sheet", "body": "<p>I am using a VBA to copy and save data on another sheet namely 'Data'. The data saved but first time it saved at wrong place i.e. Range. It jumps 50 rows. After second time and onwards it saved at right places. Could you tell me my mistakes<img src=\"https://i.stack.imgur.com/b52rP.png\" alt=\"![Its the screenshot of &#39;Data&#39; Sheet\">]<a href=\"https://i.stack.imgur.com/b52rP.png\" rel=\"nofollow noreferrer\">1</a> </p>\n\n<pre><code>Sub Save_Click()\n\n' Save Pay_Slip on \"Data\"Sheet\n\nApplication.ScreenUpdating = False\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\nDim LR As Long\nDim last As Long\n\nSheets(\"Data\").Unprotect Password:=\"\"\nSheets(\"Pay_Slip\").Unprotect Password:=\"\"\n\nLR = Sheets(\"Pay_Slip\").Range(\"B500\").End(xlUp).Row\nlast = Sheets(\"Data\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n\nSet copySheet = Worksheets(\"Pay_Slip\")\nSet pasteSheet = Worksheets(\"Data\")\n\nSheets(\"Data\").Range(\"A\" &amp; last + 3).Value = \nSheets(\"Pay_Slip\").Range(\"Y3\").Value\nSheets(\"Data\").Range(\"B\" &amp; last + 3).Value = \nSheets(\"Pay_Slip\").Range(\"T3:V3\").Value\nSheets(\"Data\").Range(\"C\" &amp; last + 3).Value = \nSheets(\"Pay_Slip\").Range(\"I2:K2\").Value\n\ncopySheet.Range(\"A5\" &amp; \":AI\" &amp; LR + 2).Copy\npasteSheet.Cells(Rows.Count, 4).End(xlUp).Offset(1, 0).PasteSpecial \nxlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nSheets(\"Pay_Slip\").Range(\"X2\").Value = _\nSheets(\"Pay_Slip\").Range(\"X2\").Value + 1\n\nSheets(\"Pay_Slip\").Protect Password:=\"\"\nSheets(\"Data\").Protect Password:=\"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494434962, "post_id": 43898417, "comment_id": 74830676, "body": "<code>SaveCopyAs</code> ?  It would help to explain a little more exactly what it is you&#39;re doing."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1494435730, "post_id": 43898417, "comment_id": 74831132, "body": "What about copying an existing file using the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264639.aspx\" rel=\"nofollow noreferrer\">Name</a> statement, and then opening that file, making your changes, and doing the <code>Workbook.Save</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1494436160, "post_id": 43898417, "comment_id": 74831369, "body": "&quot;whenever a <i>save as object is present</i>&quot; - uh, &quot;save as&quot; is a <i>method</i>, the <i>object</i> is <code>Workbook</code>. Care to expand on your &quot;document management system&quot;? Is that a <code>Workbook_BeforeSave</code> event handler at application level (i.e. an Excel add-in)? Other than that, it&#39;s like @tigeravatar said: use the <code>VBA.FileSystem</code> module members to work with the files directly, without going through the Excel object model."}, {"owner": {"reputation": 37, "user_id": 3070873, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c8e46e3b1dd6d7b75acfe2e4ffcdc62a?s=128&d=identicon&r=PG&f=1", "display_name": "RickyD", "link": "https://stackoverflow.com/users/3070873/rickyd"}, "edited": false, "score": 0, "creation_date": 1494437495, "post_id": 43898417, "comment_id": 74832168, "body": "Hi. To clarify;  The Document Management System (Humingbird) hijacks your document when you try to &quot;Save As&quot; and tries to put the document in a repository as opposed to the hard drive. I have to do a lot of manipulation (via VBA) before it&#39;s ready to go into the DM system.    <code>NewBook.SaveCopyAs Filename:=FName</code>  Works great! Thanks Tim."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1494437560, "creation_date": 1494437560, "answer_id": 43899235, "question_id": 43898417, "link": "https://stackoverflow.com/questions/43898417/create-an-excel-file-on-disk-without-saveas/43899235#43899235", "title": "Create an Excel file on disk without &quot;SaveAs&quot;", "body": "<p>Though it's unclear what you're trying to do (or why), here's a hack that might be useful as it does not invoke <code>SaveAs</code> or <code>SaveCopyAs</code> (not sure if the latter is a problem for your DMS):</p>\n\n<pre><code>Dim sPath$, sFileName$, newFileName$\nsPath = \"C:\\Path\\Where\\You\\Want\\YourFileSaved\\\"\nsFileName = \"MyExcelFile.xlsx\"\n'The Worksheet.Copy method will create a new Excel file\nActiveWorkbook.Worksheets(1).Copy\n'Specify the path where you'd like the file to be\nChDir sPath\n'Saves the file with default name e.g., \"Book2.xlsx\", etc.\nActiveWorkbook.Save\n\n'Rename the file if needed, first get the file's default name:\nnewFileName = ActiveWorkbook.FullName\n'Close it so we can rename it\nActiveWorkbook.Close\n'Rename it:\nName newFileName As sFileName\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3070873, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c8e46e3b1dd6d7b75acfe2e4ffcdc62a?s=128&d=identicon&r=PG&f=1", "display_name": "RickyD", "link": "https://stackoverflow.com/users/3070873/rickyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494437560, "creation_date": 1494434815, "last_edit_date": 1494436885, "question_id": 43898417, "link": "https://stackoverflow.com/questions/43898417/create-an-excel-file-on-disk-without-saveas", "title": "Create an Excel file on disk without &quot;SaveAs&quot;", "body": "<p>Is there a way to create an Excel file on disk? I can't use the typical <code>NewBook.SaveAs</code> because my document management system hook grabs it whenever a SaveAs operation is present. I can however open a document on disk and save with the original filename.</p>\n\n<p>I could use <code>ActiveWorkbook.Save</code> which is what I need. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["sql", "sql-server", "vb.net", "vba"], "comments": [{"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1494434180, "post_id": 43898147, "comment_id": 74830229, "body": "@test will only be available in sproc1.  That&#39;s how temporary tables and variables work."}], "answers": [{"comments": [{"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1494438316, "post_id": 43898341, "comment_id": 74832675, "body": "how do you execute sproc1 as well as handle <code>@serial</code> in sproc1?"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1494438899, "post_id": 43898341, "comment_id": 74833013, "body": "If I execute sproc1 from ADO, will the resultsets from sproc 2 or 3 produce as expected?  i.e. if I <code>select col1, col2, col3 from table</code> in sproc2, will col1, col2, and col3 show as recordset results from executing sproc1?"}], "tags": [], "owner": {"reputation": 1492, "user_id": 1901232, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/a9c784b8b0617ef2a531907539045e5d?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/1901232/stephen"}, "is_accepted": true, "score": 1, "last_activity_date": 1494434559, "creation_date": 1494434559, "answer_id": 43898341, "question_id": 43898147, "link": "https://stackoverflow.com/questions/43898147/set-parameters-in-a-stored-procedure-that-returns-a-resultset/43898341#43898341", "title": "Set parameters in a stored procedure that returns a resultset", "body": "<p>For this to work <code>sproc2</code> and <code>sproc3</code> should been defined like this:</p>\n\n<pre><code>CREATE PROC sproc2 @test VARCHAR(50), @serial VARCHAR(50) OUTPUT\n</code></pre>\n\n<p>What this does is, it sends the value of <code>@test</code> as a value param. The <code>OUTPUT</code> keyword on <code>@serial</code> enables you to keep track of any changes done on <code>@serial</code>.</p>\n"}], "owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 43898341, "answer_count": 1, "score": 0, "last_activity_date": 1494434559, "creation_date": 1494433900, "question_id": 43898147, "link": "https://stackoverflow.com/questions/43898147/set-parameters-in-a-stored-procedure-that-returns-a-resultset", "title": "Set parameters in a stored procedure that returns a resultset", "body": "<p>I'm trying to consolidate some code but before I open this particular can of worms I wanted to find out from you guys.  If I have several stored procedures...</p>\n\n<p>sproc1 - \"master proc\" which sets @test </p>\n\n<p>sproc2 - proc that executes if @test exists and returns both a resultset and (if possible) resets @serial</p>\n\n<p>sproc3 - proc that executes if @test does not exist and returns both a resultset and (if possible) resets @serial</p>\n\n<p><strong>sproc1</strong></p>\n\n<pre><code>    @leftStack INT,\n    @leftTray INT,\n    @midStack INT,\n    @midTray INT,\n    @rightStack INT,\n    @rightTray INT\n\n    AS\n\n\n    DECLARE @soLineNumber varchar(50)\n    DECLARE @serial VARCHAR(50)\n    DECLARE @rack INT\n    DECLARE @tray INT\n    DECLARE @position INT\n\n    SELECT @test = oL.[SERIAL_NUMBER]\n        FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_OPTICS] AS oL\n            WHERE NOT EXISTS \n            ( \n            SELECT [SERIAL_NUMBER] \n                FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_OPTIC_RESULTS] AS rL \n                    WHERE oL.[SERIAL_NUMBER] = rL.[SERIAL_NUMBER] \n            ) \n            AND NOT EXISTS \n                ( \n                SELECT [SERIAL_NUMBER] \n                    FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_OPTIC_INSERTED] AS oI \n                        WHERE oL.[SERIAL_NUMBER] = oI.[SERIAL_NUMBER] \n                ) \n    --      AND oL.[SO_LINE_NUMBER] = @soLineNumber --pick regardless of SO line number, to reduce gaps between lines\n            AND ((oL.[RACK] = @leftStack AND oL.[TRAY] = @leftTray) \n            OR (oL.[RACK] = @midStack AND oL.[TRAY] = @midTray) \n            OR (oL.[RACK] = @rightStack AND oL.[TRAY] = @rightTray))\n         ORDER BY [SO_LINE_NUMBER] ASC\nIF NULLIF(@test, '') IS NOT NULL\n    BEGIN\n        EXEC sproc2\n    END\nIF NULLIF(@test, '') IS NULL\n    BEGIN\n        EXEC sproc3\n    END\n\nUPDATE [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_OPTICS] SET [PICKED] = 'True' WHERE [SERIAL_NUMBER] = @serial\nEND\n</code></pre>\n\n<p>My questions:\n1) how can I reset @serial from sproc2 and sproc3?</p>\n\n<p>2) in an ADO recordset query, will the results from the executed stored procedures pull in, if so, how?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494433335, "post_id": 43897901, "comment_id": 74829675, "body": "<code>Me.Controls(&quot;newCombo&quot; &amp; (NewSet)).Value = Cells(emptyRow + (NewSet) - 1, 6).Value</code> is trying to set the value of the ComboBox to be the value from the cell - don&#39;t you want to set the value of the cell to be the value of the ComboBox?"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1494433383, "post_id": 43897901, "comment_id": 74829701, "body": "What specific result would you like to happen?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1494447277, "post_id": 43897901, "comment_id": 74837731, "body": "Please post the entire module.  It looks like your Set NewCombo1 = Me.Controls.Add..... is outside of any subroutine."}, {"owner": {"reputation": 45, "user_id": 7901426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc1102aced169ff278a45385f379325?s=128&d=identicon&r=PG&f=1", "display_name": "iretex", "link": "https://stackoverflow.com/users/7901426/iretex"}, "reply_to_user": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1494530422, "post_id": 43897901, "comment_id": 74880922, "body": "see link to the complete module <a href=\"https://docs.google.com/document/d/1Nbi4ooTLzrlj1yVqAReecRl8ONRdr1aQDXu41YkSCf4/edit?usp=sharing\" rel=\"nofollow noreferrer\">docs.google.com/document/d/&hellip;</a>  @Zerk I want to be able to save data entered into the dynamically generated ComboBox and TextBoxes when the save button is pressed."}, {"owner": {"reputation": 45, "user_id": 7901426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc1102aced169ff278a45385f379325?s=128&d=identicon&r=PG&f=1", "display_name": "iretex", "link": "https://stackoverflow.com/users/7901426/iretex"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494530528, "post_id": 43897901, "comment_id": 74880984, "body": "@YowE3K That&#39;s exactly my intention, unfortunately it&#39;s not working, I get runtime error with that syntax"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494531914, "post_id": 43897901, "comment_id": 74881742, "body": "@iretex - (a) What is your intention?  Your question (and comment to Zerk) says that you want to set the values in the cells to be the values of the ComboBoxes, but your code is setting the value of the ComboBoxes to be the values in the cells.  (b) The &quot;transfer&quot; part of your code works for me - I created three ComboBoxes using your sample creation line - and then I ran the parts of your subroutine that related to setting the ComboBoxes values and it correctly populated the ComboBoxes. (c) If you get a runtime error, tell us what the error is and on which line it occurs."}, {"owner": {"reputation": 45, "user_id": 7901426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc1102aced169ff278a45385f379325?s=128&d=identicon&r=PG&f=1", "display_name": "iretex", "link": "https://stackoverflow.com/users/7901426/iretex"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494538281, "post_id": 43897901, "comment_id": 74885007, "body": "@YowE3K Just  a little bit of clarification here, I want to transfer the values entered into the dynamically generated combo and text boxes into a spreadsheet. The code breaks at this line and that&#39;s why I&#39;m bothered about what could possible be wrong with it. Me.Controls(&quot;newCombo&quot; &amp; (NewSet)).Value = Cells(emptyRow + (NewSet) - 1, 6).Value"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494539195, "post_id": 43897901, "comment_id": 74885420, "body": "Well, as a start, stop trying to set the ComboBoxes&#39; values to be equal to the cells&#39; values, and instead set the cells&#39; values to be the ComboBoxes&#39; values - i.e. <code>Cells(emptyRow + NewSet - 1, 6).Value = Me.Controls(&quot;newCombo&quot; &amp; NewSet).Value</code>.  But, if you are getting an error, you probably need to tell us what error you are getting and also show us more of the code - as I said, the transfer part of your code is working for me, so that implies there are other things that you aren&#39;t doing right."}, {"owner": {"reputation": 45, "user_id": 7901426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc1102aced169ff278a45385f379325?s=128&d=identicon&r=PG&f=1", "display_name": "iretex", "link": "https://stackoverflow.com/users/7901426/iretex"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494578561, "post_id": 43897901, "comment_id": 74898752, "body": "Many Thanks, @YowE3K I just edited the syntax as advised, but unfortunately, the content of the parent object is cleared on getting to that line of code and when I increase the set of controls to 3 by clicking &#39;more&#39; twice, I get this error &quot;Run-time error &#39;-2147024809 (80070057)&#39; Could not find the specified object.&quot;"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494579681, "post_id": 43897901, "comment_id": 74899450, "body": "I think you are going to have to paste your code into the question - we probably won&#39;t be able to resolve it from the bits that you have shown, e.g. which bits of your code are being executed when you click &quot;more&quot; (I assume you must have a button called &quot;more&quot;?)"}, {"owner": {"reputation": 45, "user_id": 7901426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc1102aced169ff278a45385f379325?s=128&d=identicon&r=PG&f=1", "display_name": "iretex", "link": "https://stackoverflow.com/users/7901426/iretex"}, "edited": false, "score": 0, "creation_date": 1494585116, "post_id": 43897901, "comment_id": 74902997, "body": "@YowE3Kpls find the link to the full module, I&#39;m not permitted to paste the code in the comment box  <a href=\"https://docs.google.com/document/d/1Nbi4ooTLzrlj1yVqAReecRl8ONRdr1aQDXu41YkSCf4/edit?usp=sharing\" rel=\"nofollow noreferrer\">docs.google.com/document/d/&hellip;</a>"}], "owner": {"reputation": 45, "user_id": 7901426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc1102aced169ff278a45385f379325?s=128&d=identicon&r=PG&f=1", "display_name": "iretex", "link": "https://stackoverflow.com/users/7901426/iretex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494439651, "creation_date": 1494433073, "last_edit_date": 1494439651, "question_id": 43897901, "link": "https://stackoverflow.com/questions/43897901/i-want-to-transfer-values-entered-by-user-from-a-combobox-created-at-runtime-in", "title": "I want to transfer values entered by user from a combobox created at runtime in excel vba to a spreadsheet", "body": "<p>I was able to come up with this algorithm but I'm not getting result with it.</p>\n\n<pre><code>Set NewCombo1 = Me.Controls.Add(\"Forms.ComboBox.1\", \"newCombo\" &amp; (NewSet), True)\n\nPrivate Sub CommandButton1_Click()\n\n    'Make Sheet1 active\n    Sheets(\"ShipmentDetails\").Activate\n\n    'Determine emptyRow\n    emptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n    'Transfer information\n    Cells(emptyRow, 6).Value = Sku1.Value\n\n    For NewSet = 2 To 3\n        'This is the dynamically created comboBox\n        Me.Controls(\"newCombo\" &amp; (NewSet)).Value = Cells(emptyRow + (NewSet) - 1, 6).Value\n    Next NewSet\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1494432892, "post_id": 43897802, "comment_id": 74829418, "body": "Why dont you look for a .com and unstring it to 2"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1494433108, "post_id": 43897802, "comment_id": 74829552, "body": "Or split <code>extractStr</code> on every space, loop through your array and use the same validation you have done here? I have not grasped the details of what you are doing to validate as emails though I think it could be simpler than that perhaps using regex."}, {"owner": {"reputation": 11, "user_id": 4971021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf91e70b46658a899814e4ad9525abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Courtez", "link": "https://stackoverflow.com/users/4971021/courtez"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494434224, "post_id": 43897802, "comment_id": 74830248, "body": "@YowE3k that worked perfectly, thanks!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 1, "creation_date": 1494434605, "post_id": 43897802, "comment_id": 74830473, "body": "@GowthamShiva because .com is not the only TLD for emails. There are hundreds, if not thousands of possible domains: .co.uk, .co.jp, .net, .org., .biz, .edu, .gov, etc..."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1494434386, "creation_date": 1494434386, "answer_id": 43898293, "question_id": 43897802, "link": "https://stackoverflow.com/questions/43897802/excel-separate-extracted-emails-with-a-space/43898293#43898293", "title": "Excel: Separate Extracted emails with a space", "body": "<p>If you wish to replace the line feed character from the current output string, which looks like</p>\n\n<blockquote>\n  <p>joe@email.com<br>\n  bob@email.com</p>\n</blockquote>\n\n<p>with a space, so that it looks like</p>\n\n<blockquote>\n  <p>joe@email.com bob@email.com </p>\n</blockquote>\n\n<p>you can simply change</p>\n\n<pre><code>OutStr = OutStr &amp; Chr(10) &amp; getStr\n</code></pre>\n\n<p>to be</p>\n\n<pre><code>OutStr = OutStr &amp; \" \" &amp; getStr\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1494435274, "creation_date": 1494435274, "answer_id": 43898569, "question_id": 43897802, "link": "https://stackoverflow.com/questions/43897802/excel-separate-extracted-emails-with-a-space/43898569#43898569", "title": "Excel: Separate Extracted emails with a space", "body": "<p>Seems like this could be much more efficiently done. I agree with @nbayly Split on space character, iterate the array of \"words\" and if the \"word\" contains an <code>@</code> then you can safely assume it's an email address.</p>\n\n<pre><code>Function GetEmails(words$)\n\nDim word\nDim emails As Object\nSet emails = CreateObject(\"Scripting.Dictionary\")\n\nFor Each word In Split(words, \" \")\n    'Strip characters that you don't like:\n    word = Replace(word, \"'\", \"\")\n    word = Replace(word, \",\", \"\")\n    word = Replace(word, \")\", \"\")\n    word = Replace(word, \"(\", \"\")\n    'etc...\n    word = Trim(word)\n    'Get rid of trailing periods\n    word = IIf(Right(word, 1) = \".\", Left(word, Len(word) - 1), word)\n    If InStr(1, word, \"@\") &lt;&gt; 0 Then\n        'This is probably an email address\n        ' adds to the dictionary\n        emails(word) = word\n    Else\n        'This is not an email address, do nothing\n    End If\nNext\n\nGetEmails = Join(emails.Keys(), \" \")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4971021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf91e70b46658a899814e4ad9525abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Courtez", "link": "https://stackoverflow.com/users/4971021/courtez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1494435274, "creation_date": 1494432741, "last_edit_date": 1531161705, "question_id": 43897802, "link": "https://stackoverflow.com/questions/43897802/excel-separate-extracted-emails-with-a-space", "title": "Excel: Separate Extracted emails with a space", "body": "<p>I'm using an excel macro to pull emails from longer strings (i.e. 'the email joe@email.com will be extracted' - would return only 'joe@email.com'), the only problem is if there are two emails in the string it will return them as one large string that looks like this: 'joe@email.combob@email.com'. What I would like is for it to return it as this: 'joe@email.com bob@email.com'. I'll provide the function I'm using to do this and was hoping someone would know how to modify it in it's current state to make it so it separates the emails by space.</p>\n\n<pre><code>Function ExtractEmailFun(extractStr As String) As String\n'Update 20130829\nDim CharList As String\nOn Error Resume Next\nCheckStr = \"[A-Za-z0-9._-]\"\nOutStr = \"\"\nIndex = 1\nDo While True\n    Index1 = VBA.InStr(Index, extractStr, \"@\")\n    getStr = \"\"\n    If Index1 &gt; 0 Then\n        For p = Index1 - 1 To 1 Step -1\n            If Mid(extractStr, p, 1) Like CheckStr Then\n                getStr = Mid(extractStr, p, 1) &amp; getStr\n            Else\n                Exit For\n            End If\n        Next\n        getStr = getStr &amp; \"@\"\n        For p = Index1 + 1 To Len(extractStr)\n            If Mid(extractStr, p, 1) Like CheckStr Then\n                getStr = getStr &amp; Mid(extractStr, p, 1)\n            Else\n                Exit For\n            End If\n        Next\n        Index = Index1 + 1\n        If OutStr = \"\" Then\n            OutStr = getStr\n        Else\n            OutStr = OutStr &amp; Chr(10) &amp; getStr\n        End If\n    Else\n        Exit Do\n    End If\nLoop\nExtractEmailFun = OutStr\nEnd Function\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494435087, "post_id": 43897799, "comment_id": 74830745, "body": "What does it do instead of working?"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1494435881, "post_id": 43897799, "comment_id": 74831220, "body": "So it&#39;s bombing on <code>Set appIE = CreateObject(&quot;internetexplorer.application&quot;)</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494440322, "post_id": 43897799, "comment_id": 74833797, "body": "Can you provide a test value for Range(&quot;J6&quot;) which will return a non-empty webpage on that URL?"}], "answers": [{"comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1494439429, "post_id": 43899080, "comment_id": 74833294, "body": "I found a copy of <code>shdocvw.dll</code> here: <code>C:\\Windows\\System32</code>"}], "tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 0, "last_activity_date": 1494439356, "last_edit_date": 1495542379, "creation_date": 1494437091, "answer_id": 43899080, "question_id": 43897799, "link": "https://stackoverflow.com/questions/43897799/vba-extract-text-value-from-webpage/43899080#43899080", "title": "VBA extract text value from webpage?", "body": "<p>You need to add <code>Microsoft Internet Controls</code> to your references to be able to create the object. You may have to register the <code>shdocvw.dll</code> library on your computer. It may be registered on your laptop already which is why it might be bombing on your computer.</p>\n\n<p><strong><a href=\"http://www.wikihow.com/Register-a-DLL\" rel=\"nofollow noreferrer\">How to register a .dll</a></strong></p>\n\n<p><strong><a href=\"https://msdn.microsoft.com/en-us/library/aa752084(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN Documentation</a></strong>: look at the last sentence before the <code>C#</code> example.</p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/30670975/microsoft-internet-controls-ieframe-dll-or-shdocvw-dll\">Similar Question</a></strong></p>\n\n<p>After playing around a little bit and ensuring everything was registered, this ran fine on my PC:</p>\n\n<pre><code>Public Sub ie()\n\n    Dim ieApp As SHDocVw.InternetExplorerMedium\n    Dim html As HTMLDocument\n\n    Set ieApp = New SHDocVw.InternetExplorerMedium\n\n    ieApp.Visible = True\n\n    ieApp.Navigate \"http://internalAddress/\"\n\n    Do While ieApp.Busy Or ieApp.ReadyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n    Set html = ieApp.Document.getElementById(\"myID\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 740, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494439356, "creation_date": 1494432736, "last_edit_date": 1494435753, "question_id": 43897799, "link": "https://stackoverflow.com/questions/43897799/vba-extract-text-value-from-webpage", "title": "VBA extract text value from webpage?", "body": "<p>I have a webpage with some text in a HTML Span like so:</p>\n\n<pre><code>&lt;span id=\"ctl00_ContentPlaceHolder1_FormView1_GridView1_ctl02_lb_ExpiryDate\"&gt;Expiry Date : 16/02/2018&lt;/span&gt;\n</code></pre>\n\n<p>I am trying to get this value display it as a message in excel using the below code:</p>\n\n<pre><code>Sub PullExpiry()\n\nDim appIE As Object\nSet appIE = CreateObject(\"internetexplorer.application\")\n\nWith appIE\n    .Navigate \"https://www.brcdirectory.com/InternalSite//Site.aspx?BrcSiteCode=\" &amp; Range(\"J6\").Value\n    .Visible = True\nEnd With\n\nDo While appIE.Busy Or appIE.ReadyState &lt;&gt; 4\n    DoEvents\nLoop\n\n\nSet getPrice = appIE.Document.getElementById(\"ctl00_ContentPlaceHolder1_FormView1_GridView1_ctl02_lb_ExpiryDate\")\nDim myValue As String\nmyValue = getPrice.innerText\n\nappIE.Quit\nSet appIE = Nothing\n\nMsgBox myValue\nEnd Sub\n</code></pre>\n\n<p>This was working on my laptop (operating windows) but it does not work on my computer (also operating windows). Both windows are the same version with the same version of IE. I cannot explain it.</p>\n\n<p>I have Microsoft Office and Excel Object libraries turned on in both references.</p>\n\n<p>I get an error about an active x component not being able to create something </p>\n\n<p>Please can someone show me where i am going wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1494432970, "post_id": 43897792, "comment_id": 74829463, "body": "Can you give us some clues - perhaps which line it crashes on and the error message, or (if it runs but doesn&#39;t do what you expect) what isn&#39;t happening that you expect to happen or what is happening that you aren&#39;t expecting."}, {"owner": {"reputation": 9, "user_id": 7992860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd79402b703a177ac566237727062e38?s=128&d=identicon&r=PG&f=1", "display_name": "Mj Eliad", "link": "https://stackoverflow.com/users/7992860/mj-eliad"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494434681, "post_id": 43897792, "comment_id": 74830510, "body": "Its just not doing anything and no errors displayed when clicking the button. By the way macro is embedded to the button and this should be working. Is there any wrong on my codes?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494467245, "post_id": 43897792, "comment_id": 74844109, "body": "Go to the VBA &quot;Immediate Window&quot; and enter <code>?Application.EnableEvents</code>.  Does it return <code>True</code> or does it return <code>False</code>?"}, {"owner": {"reputation": 9, "user_id": 7992860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd79402b703a177ac566237727062e38?s=128&d=identicon&r=PG&f=1", "display_name": "Mj Eliad", "link": "https://stackoverflow.com/users/7992860/mj-eliad"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494483054, "post_id": 43897792, "comment_id": 74848646, "body": "@YowE3K It says True."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494484514, "post_id": 43897792, "comment_id": 74849399, "body": "Place a <code>MsgBox &quot;Hello&quot;</code> just after the <code>Sub Transfer</code> line (I assume your button is invoking the <code>Transfer</code> subroutine) and see whether the <code>MsgBox</code> is displayed when you click the button."}, {"owner": {"reputation": 9, "user_id": 7992860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd79402b703a177ac566237727062e38?s=128&d=identicon&r=PG&f=1", "display_name": "Mj Eliad", "link": "https://stackoverflow.com/users/7992860/mj-eliad"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494485554, "post_id": 43897792, "comment_id": 74850059, "body": "It did not prompt when i click the button."}, {"owner": {"reputation": 9, "user_id": 7992860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd79402b703a177ac566237727062e38?s=128&d=identicon&r=PG&f=1", "display_name": "Mj Eliad", "link": "https://stackoverflow.com/users/7992860/mj-eliad"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494485848, "post_id": 43897792, "comment_id": 74850224, "body": "<a href=\"https://www.mediafire.com/file/s855mdbl1w9h2jz/main.rar\" rel=\"nofollow noreferrer\">mediafire.com/file/s855mdbl1w9h2jz/main.rar</a> here is my document link if you wanted to check."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494486741, "post_id": 43897792, "comment_id": 74850801, "body": "Can you confirm that the button has <code>Transfer</code> assigned to it as the macro to run.  (I&#39;m not going to open a macro-enabled file from an unknown internet site.)"}, {"owner": {"reputation": 9, "user_id": 7992860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd79402b703a177ac566237727062e38?s=128&d=identicon&r=PG&f=1", "display_name": "Mj Eliad", "link": "https://stackoverflow.com/users/7992860/mj-eliad"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494490245, "post_id": 43897792, "comment_id": 74853097, "body": "Yes it is assign to a butto."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494490968, "post_id": 43897792, "comment_id": 74853523, "body": "I&#39;m rapidly running out of ideas!  I assume you are using a &quot;Forms Control&quot; button (otherwise it would need a <code>Button_Click</code> type event, rather than being connected to <code>Transfer</code>) so right-click on the button, select &quot;Assign Macro&quot;.  In the dialog box that should appear, you should see an &quot;Edit&quot; button on the right-hand side.  Click that and make sure you end up in your <code>Transfer</code> code."}, {"owner": {"reputation": 9, "user_id": 7992860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd79402b703a177ac566237727062e38?s=128&d=identicon&r=PG&f=1", "display_name": "Mj Eliad", "link": "https://stackoverflow.com/users/7992860/mj-eliad"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494551684, "post_id": 43897792, "comment_id": 74888728, "body": "@YowE3K,  This button is an activeX cotrol not a Form Control. But this button is embedded to run the macro (transfer). this was working before and now its just suddenly stop."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494556587, "post_id": 43897792, "comment_id": 74889862, "body": "Right-click the button and select <code>View Code</code> - what code does it take you to?  I would have thought it should take you to something like <code>CommandButton1_Click</code> (where &quot;CommandButton1&quot; is the name of the control), so I am rather surprised that you say it is linked to <code>Transfer</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494445645, "post_id": 43898683, "comment_id": 74836911, "body": "<code>ws2</code> is a <code>Worksheet</code> object that the OP has set to refer to one particular worksheet within <code>wkb</code> which is a <code>Workbook</code> object.  So saving the workbook referred to by <code>wkb</code> is saving all worksheets within that workbook, including the one referred to by <code>ws2</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 7993131, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3501b3dffe243530bf82d40986985d0f?s=128&d=identicon&r=PG", "display_name": "El Rafael", "link": "https://stackoverflow.com/users/7993131/el-rafael"}, "is_accepted": false, "score": 0, "last_activity_date": 1494435645, "creation_date": 1494435645, "answer_id": 43898683, "question_id": 43897792, "link": "https://stackoverflow.com/questions/43897792/save-data-to-another-excel-workbook-after-button-click-using-macro/43898683#43898683", "title": "Save data to another excel workbook after button click using macro", "body": "<p>In the loop you are assigning data to ws2 workbook and after that you save/close wkb. I think adding wkb to the loop would fo the job.</p>\n"}], "owner": {"reputation": 9, "user_id": 7992860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd79402b703a177ac566237727062e38?s=128&d=identicon&r=PG&f=1", "display_name": "Mj Eliad", "link": "https://stackoverflow.com/users/7992860/mj-eliad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 692, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494445485, "creation_date": 1494432715, "last_edit_date": 1494432885, "question_id": 43897792, "link": "https://stackoverflow.com/questions/43897792/save-data-to-another-excel-workbook-after-button-click-using-macro", "title": "Save data to another excel workbook after button click using macro", "body": "<p>I have 2 workbooks: the main.xlsm (main workbook) and backup.xlsx (backup). Now what I want is to save a backup copy to backup.xlsx upon clicking a button using macro. I have the code below, but I don't know why it wouldn't work.</p>\n\n<pre><code>Sub ToggleEvents(blnState As Boolean)\n    With Application\n        .DisplayAlerts = blnState\n        .EnableEvents = blnState\n        .ScreenUpdating = blnState\n        If blnState Then .CutCopyMode = False\n        If blnState Then .StatusBar = False\n    End With\nEnd Sub\n\nFunction WbOpen(wbName As String) As Boolean\n    On Error Resume Next\n    WbOpen = Len(Workbooks(wbName).Name)\nEnd Function\n\nSub Transfer()\nDim c As Integer\nDim Ws1 As Worksheet, Ws2 As Worksheet\n\nDim wkb As Workbook\nDim FilePath As String, FileName As String\nDim blnOpened As Boolean\n\n'the next two refer to the destination file path and filename\nFilePath = \"C:\\Newfolder\\\"\nFileName = \"backup.xlsx\"\n\nCall ToggleEvents(False)\n    If WbOpen(FileName) = True Then\n    Set Ws2 = Workbooks(\"backup.xlsx\").Sheets(\"RAW\")\n    blnOpened = False\n    Else\n        If Right(FilePath, 1) &lt;&gt; Application.PathSeparator Then\n            FilePath = FilePath &amp; Application.PathSeparator\n        End If\n        Set wkb = Workbooks.Open(FilePath &amp; FileName, , , , \"backup.xlsx\")\n        Set Ws2 = Workbooks(\"backup.xlsx\").Sheets(\"RAW\")\n\n\n        blnOpened = True\n    End If\n\n    Set Ws1 = ThisWorkbook.Sheets(\"ProdTracker\")\n\nc = 2\nDo While Ws2.Range(\"A\" &amp; c) &lt;&gt; \"\"\n    c = c + 1\n    Loop\n    Ws2.Range(\"A\" &amp; c) = Ws1.Range(\"AA2\")\n    Ws2.Range(\"B\" &amp; c) = Ws1.Range(\"AA3\")\n    Ws2.Range(\"C\" &amp; c) = Ws1.Range(\"AA42\")\n    Ws2.Range(\"D\" &amp; c) = Ws1.Range(\"AA4\")\n    Ws2.Range(\"E\" &amp; c) = Ws1.Range(\"AA5\")\n    Ws2.Range(\"F\" &amp; c) = Ws1.Range(\"AA6\")\n    Ws2.Range(\"G\" &amp; c) = Ws1.Range(\"AA7\")\n    Ws2.Range(\"H\" &amp; c) = Ws1.Range(\"AA8\")\n    Ws2.Range(\"I\" &amp; c) = Ws1.Range(\"AA9\")\n    Ws2.Range(\"J\" &amp; c) = Ws1.Range(\"AA10\")\n    Ws2.Range(\"K\" &amp; c) = Ws1.Range(\"AA11\")\n    Ws2.Range(\"L\" &amp; c) = Ws1.Range(\"AA12\")\n    Ws2.Range(\"M\" &amp; c) = Ws1.Range(\"AA13\")\n    Ws2.Range(\"N\" &amp; c) = Ws1.Range(\"AA14\")\n    Ws2.Range(\"O\" &amp; c) = Ws1.Range(\"AA15\")\n    Ws2.Range(\"P\" &amp; c) = Ws1.Range(\"AA16\")\n    Ws2.Range(\"Q\" &amp; c) = Ws1.Range(\"AA17\")\n    Ws2.Range(\"R\" &amp; c) = Ws1.Range(\"AA18\")\n    Ws2.Range(\"S\" &amp; c) = Ws1.Range(\"AA19\")\n    Ws2.Range(\"T\" &amp; c) = Ws1.Range(\"AA20\")\n    Ws2.Range(\"U\" &amp; c) = Ws1.Range(\"AA21\")\n    Ws2.Range(\"V\" &amp; c) = Ws1.Range(\"AA22\")\n    Ws2.Range(\"W\" &amp; c) = Ws1.Range(\"AA23\")\n    Ws2.Range(\"X\" &amp; c) = Ws1.Range(\"AA24\")\n    Ws2.Range(\"Y\" &amp; c) = Ws1.Range(\"AA25\")\n    Ws2.Range(\"Z\" &amp; c) = Ws1.Range(\"AA26\")\n    Ws2.Range(\"AA\" &amp; c) = Ws1.Range(\"AA27\")\n    Ws2.Range(\"AB\" &amp; c) = Ws1.Range(\"AA28\")\n    Ws2.Range(\"AC\" &amp; c) = Ws1.Range(\"AA29\")\n    Ws2.Range(\"AD\" &amp; c) = Ws1.Range(\"AA30\")\n    Ws2.Range(\"AE\" &amp; c) = Ws1.Range(\"AA31\")\n    Ws2.Range(\"AF\" &amp; c) = Ws1.Range(\"AA32\")\n    Ws2.Range(\"AG\" &amp; c) = Ws1.Range(\"AA33\")\n    Ws2.Range(\"AH\" &amp; c) = Ws1.Range(\"AA34\")\n    Ws2.Range(\"AI\" &amp; c) = Ws1.Range(\"AA35\")\n    Ws2.Range(\"AJ\" &amp; c) = Ws1.Range(\"AA36\")\n    Ws2.Range(\"AK\" &amp; c) = Ws1.Range(\"AA37\")\n    Ws2.Range(\"AL\" &amp; c) = Ws1.Range(\"AA38\")\n    Ws2.Range(\"AM\" &amp; c) = Ws1.Range(\"AA39\")\n    Ws2.Range(\"AN\" &amp; c) = Ws1.Range(\"AA40\")\n    Ws2.Range(\"AO\" &amp; c) = Ws1.Range(\"AA41\")\n    Ws2.Range(\"AP\" &amp; c) = Ws1.Range(\"AA43\")\n    Ws2.Range(\"AQ\" &amp; c) = Ws1.Range(\"AA44\")\n    Ws2.Range(\"AR\" &amp; c) = Ws1.Range(\"AA45\")\n    Ws2.Range(\"AS\" &amp; c) = Ws1.Range(\"AA46\")\n    Ws2.Range(\"AT\" &amp; c) = Ws1.Range(\"AA47\")\n    Ws2.Range(\"AU\" &amp; c) = Ws1.Range(\"AA48\")\n    Ws2.Range(\"AV\" &amp; c) = Ws1.Range(\"AA49\")\n    Ws2.Range(\"AW\" &amp; c) = Ws1.Range(\"AA50\")\n    Ws2.Range(\"AX\" &amp; c) = Ws1.Range(\"AA51\")\n    Ws2.Range(\"AY\" &amp; c) = Ws1.Range(\"AA52\")\n\n\n        If blnOpened = True Then\n        wkb.Close SaveChanges:=True\n        End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "find", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1494498040, "post_id": 43897308, "comment_id": 74858575, "body": "Your code finds the next occurrence of red text. You have accurately described that action. But you also seem to want from it that it should select a broader range of red text if the selection is already red (meaning, no search is required), and you seem to wish that it should continue searching the next red range when you run it again. These two requirements are conflicting in themselves, but your code doesn&#39;t provide for either of them."}, {"owner": {"reputation": 13, "user_id": 7436641, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8ac043ceba3b8a4c3c161d3528b41bc7?s=128&d=identicon&r=PG&f=1", "display_name": "hmm", "link": "https://stackoverflow.com/users/7436641/hmm"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1494577806, "post_id": 43897308, "comment_id": 74898294, "body": "@Variatus - thanks again for your help. I&#39;ve added collapse statements and it now seems to be doing what I want."}], "owner": {"reputation": 13, "user_id": 7436641, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8ac043ceba3b8a4c3c161d3528b41bc7?s=128&d=identicon&r=PG&f=1", "display_name": "hmm", "link": "https://stackoverflow.com/users/7436641/hmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494431775, "creation_date": 1494431345, "last_edit_date": 1494431775, "question_id": 43897308, "link": "https://stackoverflow.com/questions/43897308/word-vba-find-red-text-stops-if-whole-paragraph-is-red", "title": "Word VBA &#39;find red text&#39; stops if whole paragraph is red", "body": "<p>I have a macro that jumps to the next occurrence of red text in a document.</p>\n\n<p>It works fine until it gets to a paragraph that is all red (including the paragraph mark). It then won't move forward in the document until I move the cursor forward and try again.</p>\n\n<p>I've also noticed that when the cursor is within the paragraph, if I run the macro, only the text from the cursor to the end of the paragraph is highlighted.\nI suspect I need to use some form of 'collapse'? Can anyone advise?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub Find_Red_Text()\nWith ActiveDocument.ActiveWindow\n    .ActivePane.View.SeekView = wdSeekMainDocument\n    Selection.Find.ClearFormatting\n    Selection.Find.Font.Color = wdColorRed\n    With Selection.Find\n        .Text = \"\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "range"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7992619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5b013bf274d246dd1514210e877ddf?s=128&d=identicon&r=PG&f=1", "display_name": "AngeloBE", "link": "https://stackoverflow.com/users/7992619/angelobe"}, "edited": false, "score": 0, "creation_date": 1494430526, "post_id": 43896932, "comment_id": 74827977, "body": "Don&#39;t you create a third dimension then? e.g. data(1,1)(3)"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 1, "user_id": 7992619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5b013bf274d246dd1514210e877ddf?s=128&d=identicon&r=PG&f=1", "display_name": "AngeloBE", "link": "https://stackoverflow.com/users/7992619/angelobe"}, "edited": false, "score": 0, "creation_date": 1494430767, "post_id": 43896932, "comment_id": 74828128, "body": "@AngeloBE Yes, but you don&#39;t get a subject out of range error. If you want to access the ranges in the traditional way then I&#39;d suggest using a collection instead. See update for example"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494432047, "post_id": 43896932, "comment_id": 74828950, "body": "s/Subject/Subscript/ ;-)"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1494430667, "last_edit_date": 1494430667, "creation_date": 1494430268, "answer_id": 43896932, "question_id": 43896873, "link": "https://stackoverflow.com/questions/43896873/vba-fill-2d-array-with-distinct-ranges/43896932#43896932", "title": "VBA Fill 2D array with distinct ranges", "body": "<p>You need to reference both dimensions of your variant array. For example:</p>\n\n<pre><code>data(1, 1) = Range(\"Range1\").value\n</code></pre>\n\n<p><hr/>\nAs per your comments, I'd suggest you use a <code>Collection</code> instead</p>\n\n<pre><code>Dim data As Collection\nSet data = New Collection\n\ndata.Add Range(\"Range1\")\ndata.Add Range(\"Range2\")\n...\n\nMsgBox data(1).Address 'returns the address of Range1\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7992619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5b013bf274d246dd1514210e877ddf?s=128&d=identicon&r=PG&f=1", "display_name": "AngeloBE", "link": "https://stackoverflow.com/users/7992619/angelobe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494430667, "creation_date": 1494430125, "last_edit_date": 1494430368, "question_id": 43896873, "link": "https://stackoverflow.com/questions/43896873/vba-fill-2d-array-with-distinct-ranges", "title": "VBA Fill 2D array with distinct ranges", "body": "<p>I want to fill a 2D array with several named ranges that are not connected. The contain one column and a constant number of rows</p>\n\n<p>Code:</p>\n\n<pre><code>Range(\"Range1\").Select\nLastRow = Selection.Rows.count\n\nDim data() as variant\nRedim data(1 to 4,1 to LastRow)\ndata(1)=Range(\"Range1\").value\ndata(2)=Range(\"Range2\").value\ndata(3)=Range(\"Range3\").value\ndata(4)=Range(\"Range4\").value\n</code></pre>\n\n<p>It gives a subject out of range error, but I cannot work out why?</p>\n"}, {"tags": ["vb.net", "vba", "winforms", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1494430431, "post_id": 43896680, "comment_id": 74827911, "body": "I have auccessfully used almost exactly the same with VSTO, apart syntactical changes. i.e. no <code>Set</code>, <code>Type:=MsoControlType.msoControlButton</code> etc... (Well a atually I used <code>Controls.Add(1)</code> I dont remember if there was a specific reason)."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1494430635, "post_id": 43896680, "comment_id": 74828042, "body": "All those types are unknown in my visual studio... What Imports did you use?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1494430777, "post_id": 43896680, "comment_id": 74828140, "body": "<code>Microsoft.Office.Core</code>, <code>Microsoft.Office.Interop</code>, <code>Microsoft.Office.Interop.Excel</code>. But the project was created through VSTO so IDR if these were added automatically. Had done this years ago but since moved &quot;back&quot; to VBA :). Also I see in the project <code>Microsoft.Office.Tools.Common</code>,  <code>Microsoft.Office.Tools.Excel</code> and a few other things, I guess VSTO added them since the project was created as Workbook project."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494431037, "post_id": 43896680, "comment_id": 74828326, "body": "Downvoted. What&#39;s not clear at all, is what you&#39;re intending to do. VBA code runs embedded in Excel. Are you asking about doing the equivalent in VB.NET (in a VSTO/Excel solution), or about &quot;having something that looks like a context menu in a {insert UI framework here} application written in VB.NET&quot;? - The answer is <b>WILDLY</b> different depending on whether you&#39;re making a VSTO/Excel solution, a WinForms app, or a WPF app."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1494431192, "post_id": 43896680, "comment_id": 74828423, "body": "@A.S.H none of these imports seems to achieve anything... Does my code compile on your side (apart from the &quot;set&quot; obviously)"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494431234, "post_id": 43896680, "comment_id": 74828450, "body": "@Mat&#39;sMug : I am editing my question accordingly. I merely need something that serves the same use, thus that looks similar, which I can click upon, in a regular VB.NET program"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494431370, "post_id": 43896680, "comment_id": 74828529, "body": "I think the answer was given by @Mat&#39;sMug; my own project is a <code>VSTO&#47;Excel Workbook</code> so much of the references and imports were added autmatically."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494431597, "post_id": 43896680, "comment_id": 74828655, "body": "@Mat&#39;sMug : indeed.You are a fast one! I found out and edited it again while you were answering :-) Does it answer now? (PS: on second thought, commenting BEFORE editing was kind of stupid of me)"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1494433502, "post_id": 43896680, "comment_id": 74829758, "body": "I am investigating contextmenustrip , it might indeed answer my need. Thanks all!"}], "answers": [{"comments": [{"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1494430514, "post_id": 43896793, "comment_id": 74827965, "body": "CommandBar is not a known type in my editor. Maybe there is an &quot;imports&quot; to add? Thanks!"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1494430820, "post_id": 43896793, "comment_id": 74828171, "body": "commandbars and toolbars becomes from the Visual Studio .NET IDE from an add-in. Are you using it?"}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1494431059, "post_id": 43896793, "comment_id": 74828337, "body": "If that answers, I use visual studio 2015"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1494431200, "post_id": 43896793, "comment_id": 74828426, "body": "Sure... well, this example applies to older version, (this ones [Microsoft Visual Studio .NET 2002 Enterprise Developer, Microsoft Visual Studio .NET 2002 Professional Edition, Microsoft Visual Studio .NET 2003 Enterprise Architect, Microsoft Visual Studio .NET 2003 Enterprise Developer, Microsoft Visual Studio .NET 2003 Professional Edition] )"}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 0, "last_activity_date": 1494429936, "creation_date": 1494429936, "answer_id": 43896793, "question_id": 43896680, "link": "https://stackoverflow.com/questions/43896680/vb-net-equivalent-of-commandbars/43896793#43896793", "title": "VB.NET equivalent of CommandBars", "body": "<p>You can follow the example bellow here:</p>\n\n<pre><code>Public Class Connect\n   Implements Extensibility.IDTExtensibility2\n   Implements IDTCommandTarget\n\n   Private Const MY_COMMAND_NAME As String = \"MyCommand\"\n\n   Private applicationObject As EnvDTE.DTE\n   Private addInInstance As EnvDTE.AddIn\n   Private myStandardCommandBarControl As CommandBarControl\n   Private myToolsCommandBarControl As CommandBarControl\n   Private myCodeWindowCommandBarControl As CommandBarControl\n   Private myTemporaryToolbar As CommandBar\n   Private myTemporaryCommandBarPopup As CommandBarPopup\n\n   Public Sub OnConnection(ByVal application As Object, ByVal connectMode _\n      As Extensibility.ext_ConnectMode, ByVal addInInst As Object, _\n      ByRef custom As System.Array) Implements Extensibility.IDTExtensibility2.OnConnection\n\n      Dim myCommand As Command\n      Dim standardCommandBar As CommandBar\n      Dim menuCommandBar As CommandBar\n      Dim toolsCommandBar As CommandBar\n      Dim codeCommandBar As CommandBar\n      Dim toolsCommandBarControl As CommandBarControl\n      Dim myCommandBarButton As CommandBarButton\n      Dim position As Integer\n\n      Try\n\n         applicationObject = CType(application, EnvDTE.DTE)\n         addInInstance = CType(addInInst, EnvDTE.AddIn)\n\n         Select Case connectMode\n\n            Case ext_ConnectMode.ext_cm_AfterStartup, ext_ConnectMode.ext_cm_Startup\n\n               ' Try to retrieve the command, just in case it was already created\n               Try\n                  myCommand = applicationObject.Commands.Item(addInInstance.ProgID &amp; \".\" &amp; \"MyCommand\")\n               Catch\n               End Try\n\n               ' Add the command if it does not exists\n               If myCommand Is Nothing Then\n\n                  myCommand = applicationObject.Commands.AddNamedCommand(addInInstance, _\n                     \"MyCommand\", \"MyCommand\", \"Executes the command for MyAddin\", True, 59, Nothing, _\n                     vsCommandStatus.vsCommandStatusSupported Or vsCommandStatus.vsCommandStatusEnabled)\n\n               End If\n\n               ' Retrieve some built-in command bars\n               standardCommandBar = applicationObject.CommandBars.Item(\"Standard\")\n               menuCommandBar = applicationObject.CommandBars.Item(\"MenuBar\")\n               toolsCommandBar = applicationObject.CommandBars.Item(\"Tools\")\n               codeCommandBar = applicationObject.CommandBars.Item(\"Code Window\")\n\n               ' Add a button to the built-in \"Standard\" toolbar\n               myStandardCommandBarControl = myCommand.AddControl(standardCommandBar, _\n                  standardCommandBar.Controls.Count + 1)\n\n               myStandardCommandBarControl.Caption = MY_COMMAND_NAME\n\n               ' Change the button style, which must be done casting the control to a button\n               myCommandBarButton = DirectCast(myStandardCommandBarControl, CommandBarButton)\n               myCommandBarButton.Style = MsoButtonStyle.msoButtonIcon\n\n               ' Add a button to the built-in \"Tools\" menu\n               myToolsCommandBarControl = myCommand.AddControl(toolsCommandBar, toolsCommandBar.Controls.Count + 1)\n               myToolsCommandBarControl.Caption = MY_COMMAND_NAME\n\n               ' Add a button to the built-in \"Code Window\" context menu\n               myCodeWindowCommandBarControl = myCommand.AddControl(codeCommandBar, codeCommandBar.Controls.Count + 1)\n               myCodeWindowCommandBarControl.Caption = MY_COMMAND_NAME\n\n               ' Add a new toolbar with a button on it\n               myTemporaryToolbar = applicationObject.CommandBars.Add(\"MyTemporaryToolbar\", _\n                  MsoBarPosition.msoBarTop, System.Type.Missing, True)\n\n               ' Change the button style, which must be done casting the control to a button\n               myCommandBarButton = DirectCast(myCommand.AddControl(myTemporaryToolbar), CommandBarButton)\n               myCommandBarButton.Style = MsoButtonStyle.msoButtonIcon\n\n               ' Make visible the toolbar\n               myTemporaryToolbar.Visible = True\n\n               ' Calculate the position of a new command bar popup by the \"Tools\" menu\n               toolsCommandBarControl = DirectCast(toolsCommandBar.Parent, CommandBarControl)\n               position = toolsCommandBarControl.Index + 1\n\n               ' Add a new command bar popup with a button on it\n               myTemporaryCommandBarPopup = DirectCast(menuCommandBar.Controls.Add( _\n                  MsoControlType.msoControlPopup, System.Type.Missing, System.Type.Missing, _\n                  position, True), CommandBarPopup)\n\n               myTemporaryCommandBarPopup.CommandBar.Name = \"MyTemporaryCommandBarPopup\"\n               myTemporaryCommandBarPopup.Caption = \"My menu\"\n               myCommand.AddControl(myTemporaryCommandBarPopup.CommandBar)\n               myTemporaryCommandBarPopup.Visible = True\n\n         End Select\n\n      Catch e As System.Exception\n         System.Windows.Forms.MessageBox.Show(e.ToString)\n      End Try\n\n   End Sub\n\n   Public Sub OnDisconnection(ByVal RemoveMode As Extensibility.ext_DisconnectMode, _\n      ByRef custom As System.Array) Implements Extensibility.IDTExtensibility2.OnDisconnection\n\n      Try\n\n         If Not (myStandardCommandBarControl Is Nothing) Then\n            myStandardCommandBarControl.Delete()\n         End If\n\n         If Not (myCodeWindowCommandBarControl Is Nothing) Then\n            myCodeWindowCommandBarControl.Delete()\n         End If\n\n         If Not (myToolsCommandBarControl Is Nothing) Then\n            myToolsCommandBarControl.Delete()\n         End If\n\n         If Not (myTemporaryToolbar Is Nothing) Then\n            myTemporaryToolbar.Delete()\n         End If\n\n         If Not (myTemporaryCommandBarPopup Is Nothing) Then\n            myTemporaryCommandBarPopup.Delete()\n         End If\n\n      Catch e As System.Exception\n         System.Windows.Forms.MessageBox.Show(e.ToString)\n      End Try\n\n   End Sub\n\n   Public Sub OnBeginShutdown(ByRef custom As System.Array) Implements Extensibility.IDTExtensibility2.OnBeginShutdown\n   End Sub\n\n   Public Sub OnAddInsUpdate(ByRef custom As System.Array) Implements Extensibility.IDTExtensibility2.OnAddInsUpdate\n   End Sub\n\n   Public Sub OnStartupComplete(ByRef custom As System.Array) Implements _\n      Extensibility.IDTExtensibility2.OnStartupComplete\n   End Sub\n\n   Public Sub Exec(ByVal cmdName As String, ByVal executeOption As vsCommandExecOption, _\n      ByRef varIn As Object, ByRef varOut As Object, ByRef handled As Boolean) Implements IDTCommandTarget.Exec\n\n      handled = False\n\n      If (executeOption = vsCommandExecOption.vsCommandExecOptionDoDefault) Then\n\n         If cmdName = addInInstance.ProgID &amp; \".\" &amp; MY_COMMAND_NAME Then\n\n            handled = True\n            System.Windows.Forms.MessageBox.Show(\"Command executed.\")\n\n         End If\n\n      End If\n\n   End Sub\n\n   Public Sub QueryStatus(ByVal cmdName As String, ByVal neededText As vsCommandStatusTextWanted, _\n      ByRef statusOption As vsCommandStatus, ByRef commandText As Object) Implements IDTCommandTarget.QueryStatus\n\n      If neededText = EnvDTE.vsCommandStatusTextWanted.vsCommandStatusTextWantedNone Then\n\n         If cmdName = addInInstance.ProgID &amp; \".\" &amp; MY_COMMAND_NAME Then\n            statusOption = CType(vsCommandStatus.vsCommandStatusEnabled + _\n               vsCommandStatus.vsCommandStatusSupported, vsCommandStatus)\n         Else\n            statusOption = vsCommandStatus.vsCommandStatusUnsupported\n         End If\n\n      End If\n\n   End Sub\n\nEnd Class\n</code></pre>\n"}], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 838, "favorite_count": 0, "closed_date": 1494433569, "answer_count": 1, "score": 2, "last_activity_date": 1494431542, "creation_date": 1494429640, "last_edit_date": 1531164843, "question_id": 43896680, "link": "https://stackoverflow.com/questions/43896680/vb-net-equivalent-of-commandbars", "closed_reason": "Duplicate", "title": "VB.NET equivalent of CommandBars", "body": "<p>I have this code in VBA (shown in a simplified version) :</p>\n\n<pre><code>Sub TheMenu()\n    Dim Obj As CommandBar\n    Set Obj = Application.CommandBars.Add(Position:=msoBarPopup, MenuBar:=False, Temporary:=True)\n    Obj.Controls.Add(Type:=msoControlButton).Caption = \"Button1\"\n    Obj.Controls.Add(Type:=msoControlButton).Caption = \"Button2\"\n    Obj.ShowPopup\nEnd Sub\n</code></pre>\n\n<p>I wish to make something equivalent (meaning \"that looks similar and has similar uses\", I don't need more) in VB.NET. Do you know any way of doing so?\n<a href=\"https://i.stack.imgur.com/LSvVF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LSvVF.png\" alt=\"Excel VBA rendering\"></a></p>\n\n<p>I am using in VS2015, a \"Windows Forms application\" project using .NET framework 4.6.1 .</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494428764, "post_id": 43896227, "comment_id": 74826663, "body": "Stack Over flow is not a code for me site.  It is a site where people come with specific question about code that is not working.  This is too broad for this site."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1494429605, "post_id": 43896227, "comment_id": 74827318, "body": "I may have overcomplicated this with my answer by not realizing what you were actually trying to do - just use Text to Columns and split using comma - I believe that&#39;s what you&#39;re looking for."}], "owner": {"reputation": 11, "user_id": 7503007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6610e003315783ceb8bcd9abaa1858?s=128&d=identicon&r=PG&f=1", "display_name": "asdfghj", "link": "https://stackoverflow.com/users/7503007/asdfghj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494429282, "creation_date": 1494428450, "last_edit_date": 1531161705, "question_id": 43896227, "link": "https://stackoverflow.com/questions/43896227/excel-split-cell-into-multiple-columns-based-on-everty-nth-occurence", "title": "Excel - Split Cell Into Multiple Columns Based On Everty Nth Occurence", "body": "<p>I am trying to figure out how to do this:\nI have a Column where each row may have a different amount of html-formatted emails and a line break. </p>\n\n<p>For example:</p>\n\n<p><strong>Column A</strong></p>\n\n<pre><code>&lt;a href=mailto:'test@test.com'&gt;test@test.com&lt;/a&gt;&lt;br/&gt;, &lt;a href=mailto:'test2@test.com'&gt;test2@test.com&lt;/a&gt;&lt;br/&gt;\n</code></pre>\n\n<p>Some rows may have one email, some may have many. </p>\n\n<p>I would like to create a function where I could split the cell into mulitple columns, putting only 3 or 4 emails in new columns. So if there is one-three emails, it could stay in its column, but if there are four, the fourth would be moved to a new column, if there were five, the fourth and fifth would be put into a new column together.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1494428338, "post_id": 43896142, "comment_id": 74826316, "body": "You should be using <code>For</code> and not <code>While</code> with that syntax, but note that you are looping through the columns, not the rows."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1494428496, "post_id": 43896142, "comment_id": 74826446, "body": "following Rory, if you want to loop through the rows, use <code>For i = UBound(allData) To LBound(allData)</code>, it will take the first dimension, which is the row"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1494428587, "post_id": 43896142, "comment_id": 74826522, "body": "you should loop from lbound to ubound or from ubound to lbound step -1"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494429233, "post_id": 43896142, "comment_id": 74827041, "body": "Use a <code>For</code> loop when iterating arrays for optimal performance."}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1494434620, "post_id": 43896142, "comment_id": 74830481, "body": "If i use For loop then i face this issue which i asked about it earlier and someone gave me that solution. <a href=\"http://stackoverflow.com/questions/43765057/loop-is-not-working-till-the-last-row-in-vba/43765293?noredirect=1#comment74572247_43765293\" title=\"loop is not working till the last row in vba\">stackoverflow.com/questions/43765057/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 6473755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XjkrS5wR0EQ/AAAAAAAAAAI/AAAAAAAAAEU/dHhTTnShP2g/photo.jpg?sz=128", "display_name": "Kamlesh Kishor", "link": "https://stackoverflow.com/users/6473755/kamlesh-kishor"}, "is_accepted": false, "score": 0, "last_activity_date": 1494480880, "creation_date": 1494480880, "answer_id": 43907305, "question_id": 43896142, "link": "https://stackoverflow.com/questions/43896142/how-can-i-use-lbound-and-ubound-using-while-loop-in-vba/43907305#43907305", "title": "How can I use Lbound and Ubound using while loop in VBA?", "body": "<p>If you are looking to iterate through each value in allData you will need nested loops, one to iterate through rows and one to iterate through columns. </p>\n\n<p>Something like this should work.</p>\n\n<pre><code>Sub iterate2D()\n    Dim allData As Variant\n    allData = Range(\"A2:Z1048576\").Value\n    For i = LBound(allData) To UBound(allData)  'For Row\n        For j = LBound(allData, 2) To UBound(allData, 2) 'For Column\n            'Your code\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>Another way to do it would be that you can simply loop through each of the cell in the selection without dumping the value of selected range in an array. </p>\n\n<pre><code>Sub iterate()\n    For Each cell In Range(\"A2:Z1048576\")\n        'Your code\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3741, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494480880, "creation_date": 1494428250, "last_edit_date": 1531164843, "question_id": 43896142, "link": "https://stackoverflow.com/questions/43896142/how-can-i-use-lbound-and-ubound-using-while-loop-in-vba", "title": "How can I use Lbound and Ubound using while loop in VBA?", "body": "<p>I have to use while loop cause if i am using for loop, some how my loop is not ending util the last row. But what i am confuse here i am trying to loop it fastest possible, so i am using variant range and dumping all the data in one variable. Problem is i am getting an error with this line below. Any idea how to fix it. Error is for using To is not complete.</p>\n\n<pre><code>          Dim allData as Variant\n          allData = ws.Range(\"A2:Z1048576\").Value\n\n          While i = UBound(allData, 2) To LBound(allData, 2)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1494428084, "post_id": 43896039, "comment_id": 74826116, "body": "<a href=\"http://stackoverflow.com/questions/43895629/vba-delete-blank-rows-in-a-given-range-on-excel\" title=\"vba delete blank rows in a given range on excel\">stackoverflow.com/questions/43895629/&hellip;</a>  loop the other way"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1494428618, "post_id": 43896100, "comment_id": 74826545, "body": "I missed this also, change the declaration line to <code>Dim i as Long, LastRow As Long</code>  If not i will be variant and LastRow will overflow if the rows are large."}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": true, "score": 2, "last_activity_date": 1494503047, "last_edit_date": 1494503047, "creation_date": 1494428144, "answer_id": 43896100, "question_id": 43896039, "link": "https://stackoverflow.com/questions/43896039/deleting-rows-in-excel-using-vba/43896100#43896100", "title": "Deleting rows in Excel using VBA", "body": "<p>try this</p>\n\n<pre><code>Sub DeleteRows()\n\n   Dim i as long, LastRow As long\n   with activesheet\n   LastRow = .Cells(.Rows.Count, 1).End(xlUp).row\n\n   For i =  LastRow to 2 step -1\n\n      If .Cells(i, 1).Value &lt;&gt; \"certain value\" Then\n\n         .Rows(i).Delete\n\n      End If\n\n   Next i\n   End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 2783240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42c558d2c17915378dac38fcf879751c?s=128&d=identicon&r=PG&f=1", "display_name": "joepd", "link": "https://stackoverflow.com/users/2783240/joepd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 43896100, "answer_count": 1, "score": 0, "last_activity_date": 1494503047, "creation_date": 1494427987, "question_id": 43896039, "link": "https://stackoverflow.com/questions/43896039/deleting-rows-in-excel-using-vba", "title": "Deleting rows in Excel using VBA", "body": "<p>I need to delete rows that have a certain value in a certain column. The number of rows is variable. I tried to do this with the following VBA code:</p>\n\n<pre><code>Sub DeleteRows()\n\n   Dim i, LastRow As Integer\n   LastRow = ActiveSheet.Cells(Sheets(1).Rows.Count, 1).End(xlUp).row\n\n   For i = 2 to LastRow\n\n      If Cells(i, 1).Value &lt;&gt; \"certain value\" Then\n\n         Rows(i).Delete\n\n      End If\n\n   Next i\n\nEnd Sub\n</code></pre>\n\n<p>LastRow does contain the correct value. When I run this code, nothing happens. I'm new in VBA, I hope someone can push me in the right direction. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1494428626, "post_id": 43895851, "comment_id": 74826550, "body": "when you say you are looking for the name <code>x</code>, you mean in the <code>PivotTable</code>&#39;s field name <code>&quot;Full Name&quot;</code> ?"}, {"owner": {"reputation": 1, "user_id": 7992409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f604d6bcc71a9200b5c0ca308bdee10?s=128&d=identicon&r=PG&f=1", "display_name": "Doj321", "link": "https://stackoverflow.com/users/7992409/doj321"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1494429969, "post_id": 43895851, "comment_id": 74827588, "body": "@ShaiRado, yes!  x will be something like &quot;John Doe&quot;  and every row labelled Full Name has a value like &quot;Jane Smith&quot;  and I am comparing x with the Full Name value to find the right person.  I should add that these rows are all in one column"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1494485160, "post_id": 43895851, "comment_id": 74849805, "body": "see my answer and code below"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1494484957, "creation_date": 1494484957, "answer_id": 43908262, "question_id": 43895851, "link": "https://stackoverflow.com/questions/43895851/excel-vba-issue-returning-value-instead-of-false-through-pivot-table/43908262#43908262", "title": "EXCEL VBA issue returning #VALUE! instead of false through pivot table", "body": "<p>Try the code below (explanation inside the code as comments):</p>\n\n<p><strong><em>Public Function Dependency</em> Code</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Function Dependency(x As String) As String\n\nDim pt          As PivotTable\nDim ptNameFld   As PivotField\nDim ptPermFld   As PivotField\nDim C           As Range\n\n' set the Pivto-Table object, modify \"Sheet1\" with your sheet's name\nSet pt = Worksheets(\"Sheet1\").PivotTables(\"PivotTable1\")\n\n' set the Pivot Field \"Full Name\"\nSet ptNameFld = pt.PivotFields(\"Full Name\")\n\n' set the Pivot Field \"Permissions\"\nSet ptPermFld = pt.PivotFields(\"Permissions\")\n\n' loop through all rows in \"Full Name\" data range\nFor Each C In ptNameFld.DataRange.Rows\n    If C.Value2 Like x Then ' if the name matches \"x\"\n        ' for DEBUG Only\n        'Debug.Print ptPermFld.DataRange(C.Row - ptPermFld.LabelRange.Row)\n\n        Dependency = ptPermFld.DataRange(C.Row - ptPermFld.LabelRange.Row) ' get the value of \"Permission\", of the same row\n        Exit For\n    End If\nNext C\n\nEnd Function\n</code></pre>\n\n<p><strong><em>Sub TestDependency</em> Code</strong> (to test the Function)</p>\n\n<pre><code>Sub TestDependency()\n\nMsgBox Dependency(\"John Doe\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7992409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f604d6bcc71a9200b5c0ca308bdee10?s=128&d=identicon&r=PG&f=1", "display_name": "Doj321", "link": "https://stackoverflow.com/users/7992409/doj321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494485096, "creation_date": 1494427551, "last_edit_date": 1531164843, "question_id": 43895851, "link": "https://stackoverflow.com/questions/43895851/excel-vba-issue-returning-value-instead-of-false-through-pivot-table", "title": "EXCEL VBA issue returning #VALUE! instead of false through pivot table", "body": "<p>I'm new to VBA programming and I've run into a weird issue.\nSo I have a pivot table with 3 types of rows (\"users\", \"Full Name\", \"Permissions\").</p>\n\n<p>I wrote a program to look for a certain name <code>x</code> in the <code>PivotTable</code>, and once it's found the name it looks at the following \"permissions\" and returns \"True\" if they 'Have Permissions'. Now the case when it returns \"True\" works fine, but for some reason every time it fails instead of returning false like I thought it would it returns #VALUE!,  does anyone know why?</p>\n\n<pre><code>Public Function Dependency(x As String) As String\n\nDim rngRow As Range\nDim pt As PivotTable\nDim pf2Value As String\nDim pf3Value As String\n\npf2Value = \"False\"\npf3Value = \"False\"\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\")\n\nFor Each rngRow In pt.RowRange        \n    If pf2Value = \"True\" And rngRow.PivotField.Name = \"Permissions\" Then\n        If rngRow.Value = \"Has Permissions\" Then\n                pf3Value = \"True\"\n        End If\n    End If\n    If pf2Value = \"True\" And pf3Value = \"True\" And rngRow.PivotField.Name &lt;&gt; \"Permissions\" Then Exit For\n    If rngRow.PivotField.Name = \"Full Name\" And rngRow.Value = x Then\n        pf2Value = \"True\"\n    End If\n    If rngRow.PivotField.Name = \"Full Name\" And rngRow.Value &lt;&gt; x Then\n        pf2Value = \"False\"\n    End If\nNext rngRow\nDependency = pf3Value\n\nEnd Function\n</code></pre>\n\n<p>If I do this it does return false:</p>\n\n<pre><code>Public Function Dependency(x As String) As String\n\nDim rngRow As Range\nDim pt As PivotTable\nDim pf2Value As String\nDim pf3Value As String\n\npf2Value = \"False\"\npf3Value = \"False\"\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\")\n\nFor Each rngRow In pt.RowRange\nNext rngRow\nDependency = pf3Value\n\nEnd Function\n</code></pre>\n\n<p>the issue starts when I add this line:</p>\n\n<pre><code>Public Function Dependency(x As String) As String\n\nDim rngRow As Range\nDim pt As PivotTable\nDim pf2Value As String\nDim pf3Value As String\n\npf2Value = \"False\"\npf3Value = \"False\"\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\")\n\nFor Each rngRow In pt.RowRange\n    If pf2Value = \"True\" And rngRow.PivotField.Name = \"Permissions\" Then\n    End If\nNext rngRow\nDependency = pf3Value\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 1, "creation_date": 1494428690, "post_id": 43895839, "comment_id": 74826597, "body": "Excellent, thanks for you time and guidance. It works now."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1494427525, "creation_date": 1494427525, "answer_id": 43895839, "question_id": 43895717, "link": "https://stackoverflow.com/questions/43895717/save-each-worksheet-in-workbook-as-an-individual-pdf/43895839#43895839", "title": "Save each worksheet in workbook as an individual pdf", "body": "<p>Try to change like this:</p>\n\n<pre><code>If myFile &lt;&gt; \"False\" Then\n            ActiveSheet.ExportAsFixedFormat _\n                    Type:=xlTypePDF, _\n                    FileName:=myFile, _\n                    Quality:=xlQualityStandard, _\n                    IncludeDocProperties:=True, _\n                    IgnorePrintAreas:=False, _\n                    OpenAfterPublish:=False\n</code></pre>\n\n<p>Then try to find a way how to loop through the sheets, its a trivial VBA task.\nIn general, in your code <code>wsA</code> was not set. Thus, you got an error.</p>\n"}], "owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 43895839, "answer_count": 1, "score": 1, "last_activity_date": 1518801397, "creation_date": 1494427269, "last_edit_date": 1518801397, "question_id": 43895717, "link": "https://stackoverflow.com/questions/43895717/save-each-worksheet-in-workbook-as-an-individual-pdf", "title": "Save each worksheet in workbook as an individual pdf", "body": "<p>I want to loop over all worksheets in a workbook and save them as individual pdfs in the same path as the workbook. The files are named after the worksheet name. </p>\n\n<p>This code below works up until the \"wsA.ExportAsFixedFort\" line. The error message i get is:</p>\n\n<pre><code>Run-time error '91': Object variable or With block variable not set\n</code></pre>\n\n<p>But i cant figure out what the issue is...</p>\n\n<p>Any suggestions? </p>\n\n<pre><code>Option Explicit\n\nSub WorksheetLoop()\n\nDim wsA As Worksheet\nDim wbA As Workbook\nDim strTime As String\nDim strName As String\nDim strPath As String\nDim strFile As String\nDim strPathFile As String\nDim myFile As Variant\nDim WS_Count As Integer\nDim I As Integer\n\n' Set WS_Count equal to the number of worksheets in the active workbook.\nSet wbA = ActiveWorkbook\nWS_Count = wbA.Worksheets.Count\nstrPath = wbA.Path\nstrTime = Format(Now(), \"yyyymmdd\\_hhmm\")\n\n'get active workbook folder, if saved\nstrPath = wbA.Path\nIf strPath = \"\" Then\n  strPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\n\n' Begin the loop.\nFor I = 1 To WS_Count\n\n    'replace spaces and periods in sheet name\n    strName = Replace(wbA.Worksheets(I).Name, \" \", \"\")\n    strName = Replace(strName, \".\", \"_\")\n\n    'create default name for savng file\n    strFile = strName &amp; \"_\" &amp; strTime &amp; \".pdf\"\n    myFile = strPath &amp; strFile\n\n    Debug.Print myFile\n\n    'export to PDF if a folder was selected\n    If myFile &lt;&gt; \"False\" Then\n        wsA.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=myFile, _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False\n        'confirmation message with file info\n        MsgBox \"PDF file has been created: \" _\n          &amp; vbCrLf _\n          &amp; myFile\n    End If\n\nNext I\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1494427484, "post_id": 43895629, "comment_id": 74825574, "body": "<code>for x=numrows to 1 step -1:if range(&quot;a&quot;&amp;x).value=&quot;&quot; then rows(x).delete:next x</code>"}, {"owner": {"reputation": 466, "user_id": 3941955, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9914ab5e21ce70d4a1d00f555e8f4c12?s=128&d=identicon&r=PG&f=1", "display_name": "George Eco", "link": "https://stackoverflow.com/users/3941955/george-eco"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494427557, "post_id": 43895629, "comment_id": 74825623, "body": "Seriously??? Nathan if this works it is fantastic. Please compose an answer so I can accept it. Was it THAT simple?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1494428124, "post_id": 43895629, "comment_id": 74826152, "body": "Modify the solution from the duplicate to operate against <code>Range(&quot;A10:A21&quot;)</code> instead of <code>Columns(&quot;A:A&quot;)</code>."}, {"owner": {"reputation": 466, "user_id": 3941955, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9914ab5e21ce70d4a1d00f555e8f4c12?s=128&d=identicon&r=PG&f=1", "display_name": "George Eco", "link": "https://stackoverflow.com/users/3941955/george-eco"}, "edited": false, "score": 0, "creation_date": 1494428532, "post_id": 43895629, "comment_id": 74826480, "body": "Oh! So David, then (&quot;A:A&quot;) means the entire column A I suppose. Then making the Columns(&quot;A10:A21&quot;)  Range(&quot;A10:A21&quot;) will just limit the effect to the specified range. Am I right?"}], "answers": [{"comments": [{"owner": {"reputation": 466, "user_id": 3941955, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9914ab5e21ce70d4a1d00f555e8f4c12?s=128&d=identicon&r=PG&f=1", "display_name": "George Eco", "link": "https://stackoverflow.com/users/3941955/george-eco"}, "edited": false, "score": 0, "creation_date": 1494428313, "post_id": 43895985, "comment_id": 74826297, "body": "Thank you so much. Yes I assume I will set ws as my active worksheet before using that. So it was not EntireRow.delete after all. It was that! I will check it out after having a break, (I am pretty tired) but I am sure it will work thus I will accept the answer no matter what."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 466, "user_id": 3941955, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9914ab5e21ce70d4a1d00f555e8f4c12?s=128&d=identicon&r=PG&f=1", "display_name": "George Eco", "link": "https://stackoverflow.com/users/3941955/george-eco"}, "edited": false, "score": 1, "creation_date": 1494428385, "post_id": 43895985, "comment_id": 74826357, "body": "@GeorgeEco <code>ws.Rows(x)</code> and <code>ws.Range(&quot;A&quot; &amp; x).EntireRow</code> refer to the same object/range. Both will do the same result."}, {"owner": {"reputation": 466, "user_id": 3941955, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9914ab5e21ce70d4a1d00f555e8f4c12?s=128&d=identicon&r=PG&f=1", "display_name": "George Eco", "link": "https://stackoverflow.com/users/3941955/george-eco"}, "edited": false, "score": 0, "creation_date": 1494429337, "post_id": 43895985, "comment_id": 74827117, "body": "Nathan, David I assume that if I need to check from row 21 to 10  I will just have to do a for x=21 to 10 step -1 right?"}, {"owner": {"reputation": 466, "user_id": 3941955, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9914ab5e21ce70d4a1d00f555e8f4c12?s=128&d=identicon&r=PG&f=1", "display_name": "George Eco", "link": "https://stackoverflow.com/users/3941955/george-eco"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494544310, "post_id": 43895985, "comment_id": 74887105, "body": "It worked perfectly, after setting it on my task I needed it for.  Thank you so much, both of you. @DavidZemens and Nathan"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1494427861, "creation_date": 1494427861, "answer_id": 43895985, "question_id": 43895629, "link": "https://stackoverflow.com/questions/43895629/vba-delete-blank-rows-in-a-given-range-on-excel/43895985#43895985", "title": "VBA Delete blank rows in a given range on Excel", "body": "<p>You need to loop backwards from the end of the range and delete the relevant row index, like so</p>\n\n<pre><code>for x=numrows to 1 step -1\n    if ws.range(\"a\" &amp; x).value=\"\" then ws.rows(x).delete\nnext x \n</code></pre>\n\n<p>Where ws is the worksheet you are working on.</p>\n"}], "owner": {"reputation": 466, "user_id": 3941955, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9914ab5e21ce70d4a1d00f555e8f4c12?s=128&d=identicon&r=PG&f=1", "display_name": "George Eco", "link": "https://stackoverflow.com/users/3941955/george-eco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "closed_date": 1494428078, "accepted_answer_id": 43895985, "answer_count": 1, "score": 0, "last_activity_date": 1494428022, "creation_date": 1494427056, "last_edit_date": 1531164843, "question_id": 43895629, "link": "https://stackoverflow.com/questions/43895629/vba-delete-blank-rows-in-a-given-range-on-excel", "closed_reason": "Duplicate", "title": "VBA Delete blank rows in a given range on Excel", "body": "<p><strong>Before thinking to flag this as a duplicate question</strong>, please let me assure you that I found not an answer satisfying this very simple need.\nSo I have a picture included to help me describe what EXACTLY I want to do.\nPlease scroll down and pass the picture.\n<a href=\"https://i.stack.imgur.com/yceLL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yceLL.png\" alt=\"Just for the example\"></a></p>\n\n<p>Imagine data being set in a neat way.\nRows 1 to 9 must stay untouched.\nRows 22 and so on must stay untouched.</p>\n\n<p>From line 21 to 10 (that way intended) I want the code to check if the line is blank.\nIf the line is blank I want the line deleted. Removed entirely.\nOtherwise, I want it untouched.</p>\n\n<p>Thus in the picture, lines 1 to 9 stay untouched.\nFrom lines 21 to 10, only 10 and 11 stay.\nLines 22 and so on stay untouched.</p>\n\n<p>Checking the first cell if it is null, will do the trick, I just want the correct syntax to make it happen right and only within A21 to A10 for the example.</p>\n\n<p>It is probably stupidly easy, but for some reason it gives me a hard time to do it right, since I am new to the VBA methods.</p>\n\n<p>I am sure there will be the <strong><em>EntireRow.Delete</em></strong> method involved somehow\nI am just not so good yet with what you can do with VBA yet.</p>\n\n<p>The first answer to this question was pretty near my needs and yet so far.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/39897789/excel-vba-to-delete-blank-rows-within-a-range\">Excel VBA to delete blank rows within a range</a></p>\n\n<p>Problem is that I am not very experienced and I don't understand all the methods, neither all arguments passed to that example. It is kinda complex and what I would love to see is something simple, documented in a way to understand what is going on, so I can implement it on my real life scenario.</p>\n\n<p>This question:\n<a href=\"https://stackoverflow.com/questions/19430673/excel-vba-delete-entire-row-if-cell-in-column-a-is-blank-long-dataset\">Excel VBA: Delete entire row if cell in column A is blank (Long Dataset)</a></p>\n\n<p>The question has an answer for the ENTIRE spreadsheet, not helpful really in my case.</p>\n\n<p>As you can see, I provide an example, I am not asking you to do my job, I just honestly wanna learn how to do what I asked.</p>\n\n<p>I am not sure if I need a FOR that iterates with negative step -1, including some methods inside the loop, or if there is a ready method for this, including a looping, so here I am asking more experienced people how to do something, probably ridiculously easy.<br>\nAny help would be appreciated.</p>\n"}, {"tags": ["excel", "excel-formula", "concatenation", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1494426094, "post_id": 43895196, "comment_id": 74824449, "body": "Yes it is possible with a &#39;VBA sub procedure but not with a formula."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1494426248, "post_id": 43895196, "comment_id": 74824561, "body": "<i>To the viewers of this &#39;question&#39;</i> - Why doesn&#39;t someone create an answer that states <i>Yes, this is possible</i> then we can use it to mark all future <i>Is it posssible...</i> questions as duplicate?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1494426321, "post_id": 43895196, "comment_id": 74824614, "body": "@Jeeped - it would be trolling, I think..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1494426596, "post_id": 43895196, "comment_id": 74824794, "body": "@Jeeped using remove duplicates on a copy of the IDs, then: <code>=IFERROR(INDEX($B:$D,AGGREGATE(15,6,ROW($A$2:$A$7)&#47;($A$2:$A$&zwnj;&#8203;7=$A12),INT((COLUMN(&zwnj;&#8203;A:A)-1)&#47;3)+1),MOD(CO&zwnj;&#8203;LUMN(A:A)-1,3)+1),&quot;&quot;&zwnj;&#8203;)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494427023, "post_id": 43895196, "comment_id": 74825154, "body": "@computersareneat Stack Overflow is not a code for me site nor a show me where to start site.  Please show what you have tried and where you are stuck."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1494432729, "post_id": 43895196, "comment_id": 74829316, "body": "@ScottCraner - Yes, a &#39;helper&#39; column could identify duplicates and aid filtering but I took the OP literally to mean that they wanted to delete rows with a formula. Nice formula btw."}], "owner": {"reputation": 71, "user_id": 7087292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1bfad66454c41536b7804a3e84d76eea?s=128&d=identicon&r=PG&f=1", "display_name": "ComputersAreNeat", "link": "https://stackoverflow.com/users/7087292/computersareneat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 517, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494432265, "creation_date": 1494425954, "last_edit_date": 1531161705, "question_id": 43895196, "link": "https://stackoverflow.com/questions/43895196/concatenate-split-cells-and-delete-unnecessary-rows-in-excel", "title": "Concatenate/Split Cells and Delete Unnecessary Rows in Excel", "body": "<p>I have a large data set in which I need to concatenate multiple rows together and then delete the source rows.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZJWxj.jpg\" rel=\"nofollow noreferrer\">Example data set</a></p>\n\n<p>Current logic I wish to apply:</p>\n\n<ol>\n<li>Look through data and find matching ID's in column A.</li>\n<li>Concatenate the data from the matching ID's to form a single row.</li>\n<li>Delete the (now) unnecessary rows.</li>\n<li>Split the concatenated cell into multiple cells/columns. </li>\n</ol>\n\n<p>Is this possible in excel using a formula or macro? Any help is greatly appreciated. Thanks</p>\n\n<p>edit: if possible, can someone please help me get started with the macro as well?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "edited": false, "score": 0, "creation_date": 1494427653, "post_id": 43895469, "comment_id": 74825707, "body": "I have 3 tables, and the field of table 1 &quot;Libelle Projet&quot; it does not have the same name as the fields of table 2 and 3"}, {"owner": {"reputation": 5124, "user_id": 789780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f87ff2c915edbb0422812732a43a6d8?s=128&d=identicon&r=PG", "display_name": "Jerrad", "link": "https://stackoverflow.com/users/789780/jerrad"}, "reply_to_user": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "edited": false, "score": 0, "creation_date": 1494427893, "post_id": 43895469, "comment_id": 74825943, "body": "That doesn&#39;t matter.  Table1 isn&#39;t really involved in your question (you&#39;re just setting the Projets column equal to the string &#39;projetX&#39;).  If this isn&#39;t what you&#39;re trying to do, you&#39;ll need to clarify your question."}, {"owner": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "edited": false, "score": 0, "creation_date": 1494428264, "post_id": 43895469, "comment_id": 74826263, "body": "For example in table 1 we have id and libelle project and date, and in table 2 we have id, categorie, projects, and date.and in table 3 it is like table 2 but just it is empty . I want to assign the value &quot;Project X&quot; to the column of table3 &quot;Projectcs&quot; or table 2 &quot;projects&quot;."}, {"owner": {"reputation": 5124, "user_id": 789780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f87ff2c915edbb0422812732a43a6d8?s=128&d=identicon&r=PG", "display_name": "Jerrad", "link": "https://stackoverflow.com/users/789780/jerrad"}, "reply_to_user": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "edited": false, "score": 0, "creation_date": 1494429739, "post_id": 43895469, "comment_id": 74827420, "body": "I understand.  That&#39;s what my answer does."}, {"owner": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "edited": false, "score": 0, "creation_date": 1494506714, "post_id": 43895469, "comment_id": 74864710, "body": "I have to modify the question thank you can you help me??"}, {"owner": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "edited": false, "score": 0, "creation_date": 1494510518, "post_id": 43895469, "comment_id": 74867785, "body": "Thank you well chef"}, {"owner": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "edited": false, "score": 0, "creation_date": 1495102824, "post_id": 43895469, "comment_id": 75115481, "body": "hello, please i changed the quetions can you help me ?"}, {"owner": {"reputation": 5124, "user_id": 789780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f87ff2c915edbb0422812732a43a6d8?s=128&d=identicon&r=PG", "display_name": "Jerrad", "link": "https://stackoverflow.com/users/789780/jerrad"}, "reply_to_user": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "edited": false, "score": 0, "creation_date": 1495199189, "post_id": 43895469, "comment_id": 75165723, "body": "Don&#39;t keep changing the question.  Post new questions."}], "tags": [], "owner": {"reputation": 5124, "user_id": 789780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f87ff2c915edbb0422812732a43a6d8?s=128&d=identicon&r=PG", "display_name": "Jerrad", "link": "https://stackoverflow.com/users/789780/jerrad"}, "is_accepted": true, "score": 0, "last_activity_date": 1494507679, "last_edit_date": 1494507679, "creation_date": 1494426694, "answer_id": 43895469, "question_id": 43895070, "link": "https://stackoverflow.com/questions/43895070/how-to-assign-tasks-to-a-project-in-access/43895469#43895469", "title": "How to assign tasks to a project in access?", "body": "<pre><code>insert into table3(ID, categorie, DATE, Projets)\nselect ID, categorie, DATE, Projects, 'projetX'\nfrom table2\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I think this answers your updated question (your table and column names are inconsistent, so I'm not sure):</p>\n\n<pre><code>update TACHES_TEMPLATE, (select top 1 [Libelle Projects] from Projects order by ID desc) x\nset TACHES_TEMPLATE.projets = x.[Libelle Projects]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6848180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7YWBWgISdCc/AAAAAAAAAAI/AAAAAAAABZI/2NKCvBhXMpI/photo.jpg?sz=128", "display_name": "Houssam Nachit", "link": "https://stackoverflow.com/users/6848180/houssam-nachit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 43895469, "answer_count": 1, "score": 0, "last_activity_date": 1594639924, "creation_date": 1494425641, "last_edit_date": 1594639924, "question_id": 43895070, "link": "https://stackoverflow.com/questions/43895070/how-to-assign-tasks-to-a-project-in-access", "title": "How to assign tasks to a project in access?", "body": "<pre><code>    UPDATE table1, (select top 1 [ID],chef,formateur,techni from table1 order by Num desc) \nAS x SET table2.ID = x.[ID], table2.Nom = x.[chef], table2.Nom = x.[formateur],\ntable2.Nom = x.[techni]\nWHERE table2.mission=\"chef\" and table2.mission=\"Formateur\" and table2.mission=\"techni\" ;\n\nreturns\ntable2                                            table 1\n ID | mission      |Nom|                ID |chef|Formateur|techni|   \n --------------------------------           ----------------------------\n  1 |  chef        |   |                 1 |nom1|    nom2 | nom3|  \n  2 |  Formateur   |   |               **Result**  \n  3 |  techni      |   |                   ID | mission   | Nom|\n                                         --------------------------  \n                                            1 |  chef     | nom1|      \n                                            2 |  Formateur| nom2|\n                                            3 |  techni   | nom3|  \n</code></pre>\n\n<ol>\n<li>I want to assign the name of table1 in table 2.\nPlease i need your help :)</li>\n</ol>\n"}, {"tags": ["vba", "variables", "scada"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6611982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eaa6b2f69b4dab3974d88ad9ecafe91?s=128&d=identicon&r=PG&f=1", "display_name": "Kaniass", "link": "https://stackoverflow.com/users/6611982/kaniass"}, "is_accepted": false, "score": 0, "last_activity_date": 1495633814, "creation_date": 1495633814, "answer_id": 44160376, "question_id": 43894544, "link": "https://stackoverflow.com/questions/43894544/how-to-link-a-measure-variable-in-a-supervision-to-a-vba-code/44160376#44160376", "title": "How to link a measure variable in a supervision to a VBA code?", "body": "<p>You dont need any vba code and inputbox to enter a value. Use simply a standard Send animation with an internal variable.</p>\n"}], "owner": {"reputation": 1, "user_id": 7992084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mkZew18WgD8/AAAAAAAAAAI/AAAAAAAAABo/HyI8sUmMYjI/photo.jpg?sz=128", "display_name": "Tachaqourrt Anas", "link": "https://stackoverflow.com/users/7992084/tachaqourrt-anas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495633814, "creation_date": 1494424401, "question_id": 43894544, "link": "https://stackoverflow.com/questions/43894544/how-to-link-a-measure-variable-in-a-supervision-to-a-vba-code", "title": "How to link a measure variable in a supervision to a VBA code?", "body": "<p>I'm currently in an Internship where i'm supposed to bring some modifications and upgrades to an already functioning SCADA in Pcvue.</p>\n\n<p>One of my mission is to be able to modify an already existing measure variable directly into the supervision while it's active.</p>\n\n<p>I managed to code a working inputBox via VBA  but the problem i'm left with is that i don't know how to assign the number i write directly to the already existing measure variable.</p>\n\n<p>Do you guys have any idea how to code this?</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1494424512, "post_id": 43894341, "comment_id": 74823168, "body": "If you do this twice, it will try to rename the sheet to <code>newname</code> (the value in C2), when that sheet name would already by taken?"}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1494424791, "post_id": 43894341, "comment_id": 74823397, "body": "Good point, This is an issue that I have already dealt with with this tool. The value in cell C2 gets changed by the user before each instance of running the macro."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1494425154, "post_id": 43894341, "comment_id": 74823695, "body": "I&#39;ve posted an answer below, but I&#39;m not explicitly sure what your problem is. You say this happens when you go back to sheet1, is this sub triggered by a sheet change event?"}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1494511553, "post_id": 43894341, "comment_id": 74868681, "body": "@Wolfie No, that&#39;s what is weird. I have it set to a button. I&#39;ve made some changes base on your code below, which I very much appreciate. I think I have one question, posted below about the check on if there is already a sheet with that name."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 0, "creation_date": 1494511222, "post_id": 43894853, "comment_id": 74868396, "body": "Shouldn&#39;t     <code>If sh Is Nothing then</code> include some kind of indicator for not? If sh is nothing says that there isn&#39;t a worksheet with the same name, so the code should continue right? It should end if sh is not nothing?"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 1, "creation_date": 1494511909, "post_id": 43894853, "comment_id": 74868958, "body": "Yes @DataNinja, you are right! My mistake, I didn&#39;t test the above code. I have corrected the mistake in an edit."}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 0, "creation_date": 1494514119, "post_id": 43894853, "comment_id": 74870819, "body": "I can confirm, This works Perfectly. Thank you for your help. It is much appreciated."}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 1, "creation_date": 1494515637, "post_id": 43894853, "comment_id": 74872114, "body": "For future continuity as well, I will add, the error was coming back to a protected sheet and trying to select the object (Prohibited by the protection). I just added <code>ThisWorkbook.Sheets(1).range(&quot;C2&quot;).Select</code>after to circumvent that issue."}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 1, "last_activity_date": 1494511878, "last_edit_date": 1494511878, "creation_date": 1494425100, "answer_id": 43894853, "question_id": 43894341, "link": "https://stackoverflow.com/questions/43894341/still-getting-error-can-not-do-this-to-a-protected-sheet-even-though-macro-is/43894853#43894853", "title": "Still Getting error &quot;Can not do this to a protected sheet&quot; even though macro is working properly?", "body": "<p>The below re-write cleans up a few things. Hopefully with those taken care of, the sub should run without error. Namely:</p>\n\n<ul>\n<li>Checks for existing sheet with same name to avoid potential clash</li>\n<li>Uses <code>.Value</code> to avoid putting large amount of data in the clipboard</li>\n<li>Avoids Selecting and Activating when not necessary</li>\n<li>Fully qualifies ranges using <code>ThisWorkbook</code></li>\n</ul>\n\n<p>See comments for details</p>\n\n<pre><code>Sub freezesheet()\n    'set variable for the naming of the new sheet\n    Dim newname As String\n    'assigns newname variable to a designated value\n    newname = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C2\").Value\n    ' Check if sheet name already exists\n    Dim sh as worksheet\n    On Error Resume Next\n    Set sh = ThisWorkbook.Sheets(newname)\n    On Error GoTo 0\n    If Not sh Is Nothing Then\n        MsgBox \"Error: sheet name already exists, aborted\"\n        Exit Sub\n    End If\n    'copies the sheet to a new sheet after sheet 3\n    ThisWorkbook.Sheets(\"Sheet1\").Copy after:=Sheets(3)\n    With ThisWorkbook.Sheets(4)\n        .Name = newname ' New sheet was after sheet 3, so now sheet 4\n        'unprotects the sheet so we can copy and paste as values\n        .Unprotect \"1\"\n        'makes all of the formulas on the sheets into values\n        .UsedRange.Value = .UsedRange.Value\n        'Re-protects sheet to ensure that we don't make changes to historical data.\n        .Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n                , AllowFormattingCells:=True, AllowFormattingColumns:=True, _\n                AllowFormattingRows:=True\n    End With\n    ThisWorkbook.Sheets(\"Sheet1\").Activate\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 43894853, "answer_count": 1, "score": 0, "last_activity_date": 1494511878, "creation_date": 1494423950, "last_edit_date": 1494432231, "question_id": 43894341, "link": "https://stackoverflow.com/questions/43894341/still-getting-error-can-not-do-this-to-a-protected-sheet-even-though-macro-is", "title": "Still Getting error &quot;Can not do this to a protected sheet&quot; even though macro is working properly?", "body": "<p>So I thought I was finished with this code and it was working but when I navigate away from Sheet 1 to any other sheet and then back to sheet 1 A msgbox pops up and informs me that I can't do that to a protected sheet. </p>\n\n<p>I am unclear as to why this is happening as the code is doing exactly what it is supposed to... Any help would be appreciated.</p>\n\n<p>Edit: I probably should have mentioned that the Sheet is protected with the password \"1\". I realize this is not the most appropriate password, it is more for ease of access while I work through this problem.</p>\n\n<pre><code>Sub freezesheet()\n'set variable for the naming of the new sheet\nDim newname As String\n\n'assignes our open variable to a designated value\nSheets(\"Sheet1\").Activate\nnewname = Sheets(\"Sheet1\").Range(\"C2\").Value\n\n'copies the sheet to a new sheet after the designated tab\nSheets(\"Sheet1\").Copy after:=Sheets(3)\nActiveSheet.Name = newname\n\n'unprotects the sheet so we can copy and paste as values\nActiveSheet.Unprotect \"1\"\n\n'makes all of the formulas on the sheets into values and returns you to the original sheet\nCells.Select\n    selection.Copy\n    selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n\n'Re-protects sheet to ensure that we don't make changes to historical data.\nActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _\n        AllowFormattingRows:=True\n\nSheets(\"Sheet1\").Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": true, "score": 0, "last_activity_date": 1494424252, "creation_date": 1494424252, "answer_id": 43894476, "question_id": 43894317, "link": "https://stackoverflow.com/questions/43894317/how-to-copy-non-consecutive-rows-with-a-loop-vba/43894476#43894476", "title": "How to copy non-consecutive rows with a loop [vba]?", "body": "<p>You need to do the Copy in the Loop.</p>\n\n<pre><code>wbTarget.Worksheets(\"Sheet1\").UsedRange.ClearContents\nwbSrc.Activate\nApplication.CutCopyMode = False\n\nDim idx as Integer\nidx = 1\n    Do While wbSrc.Worksheets(\"R\").Cells(j, \"G\").Value &lt;&gt; Empty\n        If InStr(wbSrc.Worksheets(\"R\").Cells(j, \"G\").Value, LogID) Then\n            wbSrc.Worksheets(\"R\").Range(wbSrc.Worksheets(\"R\").Cells(j, \"G\"),wbSrc.Worksheets(\"R\").Cells(j, \"J\")).Copy\n\n            wbTarget.Worksheets(\"Sheet1\").Range(\"A\" &amp; idx).PasteSpecial\n            Application.CutCopyMode = False\n            idx = idx +1\n        End If\n\n        j = j + 1\n    Loop\n\n\nwbTarget.Save\nwbTarget.Close\nwbSrc.Activate\n\nSet wbTarget = Nothing\nSet wbSrc = Nothing\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6383975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e0f05d5ec6278efa6d0e6dbe3409b?s=128&d=identicon&r=PG&f=1", "display_name": "Isayah", "link": "https://stackoverflow.com/users/6383975/isayah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 43894476, "answer_count": 1, "score": 1, "last_activity_date": 1494424252, "creation_date": 1494423905, "question_id": 43894317, "link": "https://stackoverflow.com/questions/43894317/how-to-copy-non-consecutive-rows-with-a-loop-vba", "title": "How to copy non-consecutive rows with a loop [vba]?", "body": "<p>So I currently made code to go through a column and then check if the value at the cell meets the criteria or not. If yes, the code is supposed to copy the entire row or add that row to the clipboard. But the problem I have right now is that if there are multiple cells that fit the criteria, the end result is only the very last row that I copied. How can I fix this problemm?</p>\n\n<pre><code>wbTarget.Worksheets(\"Sheet1\").UsedRange.ClearContents\nwbSrc.Activate\nApplication.CutCopyMode = False\n\nDo While wbSrc.Worksheets(\"R\").Cells(j, \"G\").Value &lt;&gt; Empty\n    If InStr(wbSrc.Worksheets(\"R\").Cells(j, \"G\").Value, LogID) Then\n        wbSrc.Worksheets(\"R\").Range(wbSrc.Worksheets(\"R\").Cells(j, \"G\"), wbSrc.Worksheets(\"R\").Cells(j, \"J\")).Copy\n    End If\n    j = j + 1\nLoop\n\nwbTarget.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial\nApplication.CutCopyMode = False\nwbTarget.Save\nwbTarget.Close\nwbSrc.Activate\n\nSet wbTarget = Nothing\nSet wbSrc = Nothing\n</code></pre>\n\n<p>So if row 1, 4, 9, 50, 74, 90, 150 fits the criteria, that code only copies (adds to the clipboard) row 150. What can I do to fix this problem?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": true, "score": 2, "last_activity_date": 1494423927, "creation_date": 1494423927, "answer_id": 43894328, "question_id": 43894208, "link": "https://stackoverflow.com/questions/43894208/excel-user-defined-function-doesnt-work-properly-when-used-in-sumifs-function/43894328#43894328", "title": "Excel user defined function doesn&#39;t work properly when used in SUMIFS function", "body": "<p>You get the wrong result because your <code>=SUMIFS()</code> compares values to <strong>string value</strong> <code>\"=tabname()\"</code>, not the <strong>result of function</strong> <code>tabname()</code>. Try this:</p>\n\n<pre><code>=SUMIFS(Bokningar!E:E;Bokningar!B:B;TabName())-SUM(C:C)\n</code></pre>\n"}], "owner": {"reputation": 5926, "user_id": 3128156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/h3FIS.jpg?s=128&g=1", "display_name": "Sahand", "link": "https://stackoverflow.com/users/3128156/sahand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 43894328, "answer_count": 1, "score": 0, "last_activity_date": 1494423927, "creation_date": 1494423653, "question_id": 43894208, "link": "https://stackoverflow.com/questions/43894208/excel-user-defined-function-doesnt-work-properly-when-used-in-sumifs-function", "title": "Excel user defined function doesn&#39;t work properly when used in SUMIFS function", "body": "<p>I have defined the function:</p>\n\n<pre><code>Function TabName()\n    TabName = ActiveSheet.Name\nEnd Function\n</code></pre>\n\n<p>When I type <code>=TabName()</code> into a cell, I get the text <code>tabname</code> in the cell, as you can see here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3WM7w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3WM7w.png\" alt=\"function does what it should do\"></a></p>\n\n<p>But when I use the function in a cell like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kLs7a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kLs7a.png\" alt=\"Function doesn&#39;t work properly\"></a></p>\n\n<p>I get the wrong result. The correct result is what I get if I \"hardcode\" the tab name in like in this screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Opo6W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Opo6W.png\" alt=\"Hardcoded\"></a></p>\n\n<p>Why is this, and what can I do to make my function work properly?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 4, "creation_date": 1494423921, "post_id": 43894198, "comment_id": 74822715, "body": "Long needs to be double, both as long are 0"}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494424770, "post_id": 43894198, "comment_id": 74823376, "body": "Arrrrgh, it&#39;s always the simple things. Many thanks!"}], "owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494423619, "creation_date": 1494423619, "question_id": 43894198, "link": "https://stackoverflow.com/questions/43894198/excel-vba-public-constants-not-working-correctly-in-if-function", "title": "Excel VBA: Public constants not working correctly in if function", "body": "<p>In module 1 I have declared a single public constant:</p>\n\n<p><code>Public Const hueBoundryRed As Long = 0</code></p>\n\n<p>In module 2 I have the following code which works perfectly:</p>\n\n<pre><code>With sheetALL.Cells(allFirstRow + aolNum, valueAddedCol)\n.Font.Color = col_Black\n.Value = valueAddedARE\nIf valueAddedARE &lt;= hueBoundryRed Then\n.Font.Color = col_Red\nElseIf valueAddedARE &gt; hueBoundryRed And valueAddedARE &lt;= 0.05 Then\n.Font.Color = col_Amber\nElseIf valueAddedARE &gt; 0.05 And valueAddedARE &lt;= 0.3 Then\n.Font.Color = col_Green\nElseIf valueAddedARE &gt; 0.3 Then\n.Font.Color = col_Blue\nEnd If\nEnd With\n</code></pre>\n\n<p>But if I then replace the 0.05 and 0.3 with constants in module 1:</p>\n\n<pre><code>Public Const hueBoundryAmber As Long = 0.05\nPublic Const hueBoundryGreen As Long = 0.3\n</code></pre>\n\n<p>Then when I run the following code in module 2 everything defaults to the final ifelse condition and turns blue:</p>\n\n<pre><code>With sheetALL.Cells(allFirstRow + aolNum, valueAddedCol)\n.Font.Color = col_Black\n.Value = valueAddedARE\nIf valueAddedARE &lt;= hueBoundryRed Then\n.Font.Color = col_Red\nElseIf valueAddedARE &gt; hueBoundryRed And valueAddedARE &lt;= hueBoundryAmber Then\n.Font.Color = col_Amber\nElseIf valueAddedARE &gt; hueBoundryAmber And valueAddedARE &lt;= hueBoundryGreen Then\n.Font.Color = col_Green\nElseIf valueAddedARE &gt; hueBoundryGreen Then\n.Font.Color = col_Blue\nEnd If\nEnd With\n</code></pre>\n\n<p>Why?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494425589, "post_id": 43894176, "comment_id": 74824055, "body": "Can you clarify the question?  You&#39;re trying to loop through worksheets? Or just how to make this same code run faster/&quot;tighter&quot;?"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494425714, "post_id": 43894176, "comment_id": 74824160, "body": "Hey Bruce, I just want to make sure that this will run efficient, or if it is going to slow down my excel. I have gotten this to work so that all the data moves to the different worksheets. Seeing if there is anything I can fix to do it better. All I did was copy this code, and repeat it for the 9 different names that would appear in Column D on the Active Job Report"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494426581, "post_id": 43894176, "comment_id": 74824788, "body": "Do you mean you run the above once, then change this <code>If rngCel.Value = &quot;Shane Love&quot; Then</code> to some other name and run the same again. (Do you also change the <code>Sheets(&quot;Shane Love&quot;)</code> references to the new name you&#39;re looking for?  Then run again with another new name, etc.?"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494428362, "post_id": 43894176, "comment_id": 74826336, "body": "Yes, I just copied the same that I have above, and change the rng.cel.value to equal the new name  &amp; the sheets(&quot;&quot;)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494433475, "post_id": 43894176, "comment_id": 74829746, "body": "Do you have a list of the names? That would help. Or, is each sheet one of the names (which I think it&#39;s what it sounds like, no?)"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494436175, "post_id": 43894176, "comment_id": 74831379, "body": "Names are as follows. Rich Baran, Jamie Lorfano, Billy Sharp, Shane Love, Chris Gillin, Dennis Hampton, Jason, Engineering which consists of 3 names (Rick Macgowan, Ross Fletcher, Parker Grove). Then the last tab would be for all the names in column D that don&#39;t match any of those names. I will try what you posted below."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494437355, "post_id": 43898431, "comment_id": 74832074, "body": "Another note is that every time the active job report is refreshed, I would want to make sure that these worksheets would be refreshed. I don&#39;t know if there is something to clear the worksheet everytime, but I ran into an error when I tried to run this."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494438387, "post_id": 43898431, "comment_id": 74832719, "body": "@D.Schiermeyer - What error? What line did it occur on?"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494440889, "post_id": 43898431, "comment_id": 74834103, "body": "It is a &quot;Type Mismatch&quot; and it happens on the Headers at the beginning"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494441058, "post_id": 43898431, "comment_id": 74834197, "body": "@D.Schiermeyer - D&#39;oh!! See my edit, I just change <code>Dim headers() as String</code> to <code>... as Variant</code>"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494441422, "post_id": 43898431, "comment_id": 74834421, "body": "The next one I ran into is &quot;object doesn&#39;t support this property or method&quot; at line &quot;For Each ws In ActiveWorkbook&quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494441715, "post_id": 43898431, "comment_id": 74834600, "body": "@D.Schiermeyer <i>facepalm</i> sorry, I must have been sleep writing this. Change that to <code>For each ws in ActiveWorkbook.Worksheets</code>"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494447744, "post_id": 43898431, "comment_id": 74837980, "body": "That worked well! Thank you. If you saw the list of names I had above, I have two other worksheets that I would like to add. One would be for engineering, which would include the names 3 names. The other would be for everyone else, which would mean if it didn&#39;t get added to one of the worksheets, I would want it to display in this worksheet. Is this difficult to add?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494448273, "post_id": 43898431, "comment_id": 74838235, "body": "@D.Schiermeyer - I&#39;m not sure what you mean. If you have other worksheets you want to add, as long as they&#39;re in the workbook, it should run on them.  You can also specify sheets to run it on by adding <code>or ws.Name = &quot;engineering&quot;</code> to this: <code>If ws.Name &lt;&gt; wsSource.Name Then</code>, so <code>If ws.Name &lt;&gt; wsSource.Name or ws.Name = &quot;engineering&quot; Then</code>...?"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1494513110, "post_id": 43898431, "comment_id": 74869948, "body": "I want to add 3 different names from the Active Job Report Column D to the Engineering worksheet. I got confused how to do that with 3 different criteria. I also want to have a worksheet for the rest of the names in Column D, that didn&#39;t go into any of the separate worksheets. Sorry if this is still confusing"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1494441734, "last_edit_date": 1494441734, "creation_date": 1494434863, "answer_id": 43898431, "question_id": 43894176, "link": "https://stackoverflow.com/questions/43894176/copying-row-based-on-cell-value-slowing-down-excel/43898431#43898431", "title": "Copying row based on cell value slowing down excel", "body": "<p>How's this work? I assume that every sheet, except \"Active Job Report\" are a sheet you want to run the macro on.</p>\n\n<pre><code>Sub copyWS()\nDim wsSource As Worksheet, wsDestin As Worksheet, ws As Worksheet\nDim lngDestinRow As Long, i As Long\nDim rngSource As Range, rngCel As Range\nDim headers() As Variant\n\nheaders() = Array(\"Due Date\", \"Customer\", \"Ordered By\", \"Job #\", \"Part Number\", \"REV\", \"Description\", \"Make QTY\", \"Trnsf QTY\", _\n                  \"Cmpltd QTY\", \"FRR\", \"Current Work Area\", \"Current OP\", \"Order Date\", \"Priority\")\n' Shane Love\n\nSet wsSource = Sheets(\"Active Job Report\")    'Edit \"Sheet1\" to your source sheet name\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; wsSource.Name Then\n        With wsSource\n            'Following line assumes column headers in Source worksheet so starts at row2\n            Set rngSource = .Range(.Cells(2, \"D\"), .Cells(.Rows.Count, \"D\").End(xlUp))\n        End With\n\n        Set wsDestin = Sheets(ws.Name)\n        With wsDestin\n            .Cells.ClearContents\n            For Each rngCel In rngSource\n                If rngCel.Value = wsDestin.Name Then\n                    'Following line assumes column headers in Destination worksheet\n                    lngDestinRow = .Cells(.Rows.Count, \"D\").End(xlUp).Offset(1, 0).Row\n                    rngCel.EntireRow.Copy Destination:=wsDestin.Cells(lngDestinRow, \"A\")\n                End If\n            Next rngCel\n\n            For i = LBound(headers) To UBound(headers)\n                .Cells(1, i + 2).Value = headers(i)    ' starts with i + 2, because first iteration of i, i=0, so i+2 = 2 (Col. B)\n            Next i\n\n            .Columns(\"Q:S\").EntireColumn.Hidden = True\n            '.Columns(\"P:R\").EntireColumn.Hidden = True\n\n            .Range(\"B1:P1\").AutoFilter\n            .Columns(\"A:P\").AutoFit\n        End With\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 43898431, "answer_count": 1, "score": 0, "last_activity_date": 1494441734, "creation_date": 1494423554, "last_edit_date": 1494432026, "question_id": 43894176, "link": "https://stackoverflow.com/questions/43894176/copying-row-based-on-cell-value-slowing-down-excel", "title": "Copying row based on cell value slowing down excel", "body": "<p>Below is the code that I am using to copy rows from a sheet call \"Active Job Report\" to a new sheet Labeled by a persons name. It is looking for the persons name in Column D and then copying all the rows to the Sheet labeled by that persons name. This is just for one person, and I currently just copied and changed names for the other sheets.</p>\n\n<p>I have 9 different sheets (The different people that have ordered) that information is getting copied to. I have basic VBA knowledge, so I am wondering if there is a more efficient way, or if I can copy the code for each persons name to copy the rows. It seems like the file runs really slow with this.</p>\n\n<p>I want to tie all of this into a current macro that is pulling data from a software database into excel. If this is unclear I will update with information needed.</p>\n\n<pre><code>Dim wsSource As Worksheet\nDim wsDestin As Worksheet\nDim lngDestinRow As Long\nDim rngSource As Range\nDim rngCel As Range\n\n' Shane Love\nSet wsSource = Sheets(\"Active Job Report\")     'Edit \"Sheet1\" to your source sheet name\nSet wsDestin = Sheets(\"Shane Love\")\n\n\nSheets(\"Shane Love\").Cells.ClearContents\n\nWith wsSource\n    'Following line assumes column headers in Source worksheet so starts at row2\n    Set rngSource = .Range(.Cells(2, \"D\"), .Cells(.Rows.Count, \"D\").End(xlUp))\nEnd With\n\nFor Each rngCel In rngSource\n    If rngCel.Value = \"Shane Love\" Then\n        With wsDestin\n            'Following line assumes column headers in Destination worksheet\n            lngDestinRow = .Cells(.Rows.Count, \"D\").End(xlUp).Offset(1, 0).Row\n            rngCel.EntireRow.Copy Destination:=wsDestin.Cells(lngDestinRow, \"A\")\n        End With\n    End If\nSheets(\"Shane Love\").Select\nRange(\"B1\").Select\nActiveCell.FormulaR1C1 = \"Due Date\"\nRange(\"C1\").Select\nActiveCell.FormulaR1C1 = \"Customer\"\nRange(\"D1\").Select\nActiveCell.FormulaR1C1 = \"Ordered By\"\nRange(\"E1\").Select\nActiveCell.FormulaR1C1 = \"Job #\"\nRange(\"F1\").Select\nActiveCell.FormulaR1C1 = \"Part Number\"\nRange(\"G1\").Select\nActiveCell.FormulaR1C1 = \"REV\"\nRange(\"H1\").Select\nActiveCell.FormulaR1C1 = \"Description\"\nRange(\"I1\").Select\nActiveCell.FormulaR1C1 = \"Make QTY\"\nRange(\"J1\").Select\nActiveCell.FormulaR1C1 = \"Trnsf QTY\"\nRange(\"k1\").Select\nActiveCell.FormulaR1C1 = \"Cmpltd QTY\"\nRange(\"L1\").Select\nActiveCell.FormulaR1C1 = \"FRR\"\nRange(\"M1\").Select\nActiveCell.FormulaR1C1 = \"Current Work Area\"\nRange(\"N1\").Select\nActiveCell.FormulaR1C1 = \"Current OP\"\nRange(\"O1\").Select\nActiveCell.FormulaR1C1 = \"Order Date\"\nRange(\"P1\").Select\nActiveCell.FormulaR1C1 = \"Priority\"\n\nSheets(\"Shane Love\").Select\nColumns(\"Q:S\").Select\nSelection.EntireColumn.Hidden = True\n'Columns(\"P:R\").Select\n'Selection.EntireColumn.Hidden = True\n\nWorksheets(\"Shane Love\").Range(\"B1:P1\").AutoFilter\nWorksheets(\"Shane Love\").Columns(\"A:P\").AutoFit\n\n\nNext rngCel`\n</code></pre>\n"}, {"tags": ["vba", "qlikview"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1494426051, "post_id": 43894084, "comment_id": 74824423, "body": "Can you write before the next the following <code>Debug.Print Filepath &amp; strNeighName &amp; &quot;.jpg&quot;</code> and check the result in the immediate window?"}, {"owner": {"reputation": 23, "user_id": 7992018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c39af8356d3d026d61a8463c0e763b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7992018/daniel"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1494428845, "post_id": 43894084, "comment_id": 74826735, "body": "tried this Unfortunately qlikview does not support the use of Debug"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1494428917, "post_id": 43894084, "comment_id": 74826788, "body": "Then <code>MsgBox Filepath &amp; strNeighName &amp; &quot;.jpg&quot;</code>? The problem should be somewhere there."}, {"owner": {"reputation": 23, "user_id": 7992018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c39af8356d3d026d61a8463c0e763b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7992018/daniel"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1494429337, "post_id": 43894084, "comment_id": 74827118, "body": "Thank you Vityata ,This has fixed the problem however how can I get it to run through without it incrementally showing the msg box now ?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1494429440, "post_id": 43894084, "comment_id": 74827191, "body": "Honestly no idea... Try writing  <code>Application.Wait(Now + TimeValue(&quot;0:00:02&quot;))</code>, instead of the msgbox, it may work..."}, {"owner": {"reputation": 23, "user_id": 7992018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c39af8356d3d026d61a8463c0e763b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7992018/daniel"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1494430415, "post_id": 43894084, "comment_id": 74827899, "body": "The MSGBOX is showing that it is running through the fields  fine however it is no longer saving to the drive location"}, {"owner": {"reputation": 928, "user_id": 1194321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4eac97c6c58eeaa20669082abe19ccc?s=128&d=identicon&r=PG", "display_name": "mickeger", "link": "https://stackoverflow.com/users/1194321/mickeger"}, "edited": false, "score": 0, "creation_date": 1494440522, "post_id": 43894084, "comment_id": 74833914, "body": "Are you allowing System Access? There are a setting to the left in macro editor."}, {"owner": {"reputation": 23, "user_id": 7992018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c39af8356d3d026d61a8463c0e763b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7992018/daniel"}, "edited": false, "score": 1, "creation_date": 1494492136, "post_id": 43894084, "comment_id": 74854283, "body": "Hi yes the export issue has now been sorted it was not allowing system access thankyou"}, {"owner": {"reputation": 928, "user_id": 1194321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4eac97c6c58eeaa20669082abe19ccc?s=128&d=identicon&r=PG", "display_name": "mickeger", "link": "https://stackoverflow.com/users/1194321/mickeger"}, "edited": false, "score": 0, "creation_date": 1494494233, "post_id": 43894084, "comment_id": 74855798, "body": "Great. I put my comment as answer. Mark it as a solution."}], "answers": [{"tags": [], "owner": {"reputation": 928, "user_id": 1194321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4eac97c6c58eeaa20669082abe19ccc?s=128&d=identicon&r=PG", "display_name": "mickeger", "link": "https://stackoverflow.com/users/1194321/mickeger"}, "is_accepted": true, "score": 0, "last_activity_date": 1494494202, "creation_date": 1494494202, "answer_id": 43911280, "question_id": 43894084, "link": "https://stackoverflow.com/questions/43894084/vba-macro-export-problems/43911280#43911280", "title": "VBA macro export Problems", "body": "<p>Are you <code>Allowing System Access</code>? \nThere is a setting to the left in macro editor.</p>\n"}], "owner": {"reputation": 23, "user_id": 7992018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c39af8356d3d026d61a8463c0e763b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7992018/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 43911280, "answer_count": 1, "score": 0, "last_activity_date": 1494494202, "creation_date": 1494423315, "question_id": 43894084, "link": "https://stackoverflow.com/questions/43894084/vba-macro-export-problems", "title": "VBA macro export Problems", "body": "<p>I have a problem with my code  it is showing the same data for each JPG I want it to show different data based on the \"Neighbourhood\" field but all I am getting is 100s of files showing the same  data on my export,\nThe files are exporting using all of the different variable names but all showing the same data</p>\n\n<p>I have a feeling I am missing something but cannot find a resolution </p>\n\n<p>code is below </p>\n\n<pre><code> sub KnowYourNeighbourhood\n\n ActiveDocument.Sheets(\"SH02\").Activate  \n Set t=ActiveDocument.ActiveSheet  \n set field1 = ActiveDocument.Fields(\"Neighbourhood\").GetPossibleValues\n\n for i = 0 to field1.Count - 1\n strNeighName = field1.item(i).Text\n\n\n\n ActiveDocument.Fields(\"Neighbourhood\").Select field1.Item(i).Text\n\n\n\n Filepath = \"H:\\My Pictures\\\"  \n t.ExportBitmapToFile Filepath &amp; strNeighName &amp;\".jpg\"\n next   \n ActiveDocument.ClearAll true\n end sub\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1494447180, "post_id": 43893063, "comment_id": 74837688, "body": "is <code>Reply-To: &quot;Bob Smith&quot; &lt; EmailAddress@gmail.com &gt;</code> on email body?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7991785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399d273c3b0044d90812424de2f2f355?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/7991785/billy"}, "edited": false, "score": 0, "creation_date": 1494523520, "post_id": 43903756, "comment_id": 74877094, "body": "That worked perfectly. I knew there had to be something like that, but couldn&#39;t find any info in their documentation after like a days worth of looking. Probably just don&#39;t know the terms to search for. New to the whole VBA and coding in general. Appreciate it a ton!"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1494455850, "creation_date": 1494455850, "answer_id": 43903756, "question_id": 43893063, "link": "https://stackoverflow.com/questions/43893063/vba-outlook-getting-the-reply-to-email-address-from-the-email/43903756#43903756", "title": "VBA Outlook Getting the &quot;Reply-To&quot; Email Address from the Email", "body": "<p>ReplyRecipients(1) will return an instance of the Recipient object, which you pass to Recipients.Add, which expects a string. So VBA converts the object to string by reading the default property (Name). Change the line </p>\n\n<pre><code>.Recipients.Add Item.ReplyRecipients(1)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>if Item.ReplyRecipients.Count &gt; 0 Then\n  .Recipients.Add Item.ReplyRecipients(1).Address\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7991785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399d273c3b0044d90812424de2f2f355?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/7991785/billy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1475, "favorite_count": 0, "accepted_answer_id": 43903756, "answer_count": 1, "score": 0, "last_activity_date": 1494455850, "creation_date": 1494420720, "question_id": 43893063, "link": "https://stackoverflow.com/questions/43893063/vba-outlook-getting-the-reply-to-email-address-from-the-email", "title": "VBA Outlook Getting the &quot;Reply-To&quot; Email Address from the Email", "body": "<p>I'm trying to put together a script that will send a template based email back to Reply-To email addresses using Outlook Rules. I found using Item.ReplyRecipients(1) works great on certain emails where the email address is stored directly in the reply-to field. </p>\n\n<p>Such as when the header has:</p>\n\n<p>Reply-To: EmailAddress@gmail.com</p>\n\n<p>However, other emails have the header come through like below. In this case Item.ReplyRecipients(1) only will return Bob Smith and not the actual email stored in the &lt; >.</p>\n\n<p>Reply-To: \"Bob Smith\" &lt; EmailAddress@gmail.com ></p>\n\n<p>I'm at a loss as to how to grab the actual email address in that circumstance. The full script is below</p>\n\n<pre><code>Sub BillAutoReplywithTemplate(Item As Outlook.MailItem)\nDim oRespond As Outlook.MailItem\n\n\n\nSet oRespond = \nApplication.CreateItemFromTemplate(\"C:\\Users\\Me\\Desktop\\Outlook \nTemplates\\TemplateTest.oft\")\n\nWith oRespond\n\n   .Recipients.Add Item.ReplyRecipients(1)\n   .Subject = \"Re: \" &amp; Item.Subject\n   .HTMLBody = oRespond.HTMLBody &amp; _\n           vbCrLf &amp; \"---Original Message Below---\" &amp; vbCrLf &amp; _\n           Item.HTMLBody\n\n.Send\nEnd With\nSet oRespond = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access-2010", "excel-2010"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1494421253, "post_id": 43893050, "comment_id": 74820541, "body": "oXL.WorksheetFunction"}, {"owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494422130, "post_id": 43893050, "comment_id": 74821292, "body": "OMG, I have no idea how long I worked on this yesterday.  I can&#39;t believe it was that simple.  Thank you!"}], "owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494420686, "creation_date": 1494420686, "question_id": 43893050, "link": "https://stackoverflow.com/questions/43893050/ms-access-2010-vba-excel-application-match-not-allowing-excel-to-close-completel", "title": "ms access 2010 vba excel application match not allowing excel to close completely", "body": "<p>I am using excel to create a pivot table through access and I have come into an issue where excel is not completely closing at the end of my code (it is still showing in Task Manager).  To troubleshoot this, I commented out my entire code and started uncomenting it line by line until it replicated the issue.  </p>\n\n<p>I now know that my <code>.Match</code> statement is the culprate, but I am not sure how to correct it.  I have tried using <code>Excel.Application.WorksheetFunction.Match</code> and <code>Excel.Application.Match</code> but still get the same result. I know the first <code>.Match</code> statement is in an <code>If IsError</code> statement, but I have isolated to specificly the <code>.Match</code> statement.</p>\n\n<p>When I end the process through Task Manager and run my code again, I get error 462 \"The remote server machine does not exist or is unavailable.\"</p>\n\n<p>here is my code, thanks for the help.</p>\n\n<pre><code>Sub exceltest()\n'Reference to MS Excel Library and to DAO or ACEDAO\nDim oRS As DAO.Recordset\nDim i As Long\nDim oXL As Excel.Application\nDim oWB As Excel.Workbook\nDim oWS As Excel.Worksheet\nDim oWC As Excel.Worksheet\nDim oRange As Excel.Range\nDim oTable As Excel.PivotTable\nDim oField As Excel.PivotField\nDim z As Long\nDim y As Long\nDim pt As Excel.PivotTable\nDim pf As Excel.PivotField\nDim ctl As Control\nDim rpt As Report\nDim LAATotalRange As Excel.Range\nDim LAARange As Excel.Range\nDim LAANBRange As Excel.Range\nDim LAAWBRange As Excel.Range\nDim LUSTotalRange As Excel.Range\nDim LUSRange As Excel.Range\nDim LUSNBRange As Excel.Range\nDim LUSWBRange As Excel.Range\nDim GTotalRange As Excel.Range\n\n\nSet oXL = New Excel.Application\noXL.Visible = False\nSet oWB = oXL.Workbooks.Add\nSet oWS = oWB.Sheets(1)\nSet oRS = CurrentDb.OpenRecordset(\"tblRONData\")\n\noWS.Cells(2, 1).CopyFromRecordset oRS\n\n   For i = 0 To oRS.Fields.Count - 1\n        oWS.Cells(1, i + 1) = oRS.Fields(i).Name\n   Next i\n\n'create pivot table\n\noWS.Cells.EntireColumn.AutoFit\n\nSet oTable = oWS.PivotTableWizard\n\nSet oField = oTable.PivotFields(\"Metal\")\noField.Orientation = xlRowField\n\nSet oField = oTable.PivotFields(\"Type\")\noField.Orientation = xlRowField\n\nSet oField = oTable.PivotFields(\"Sub Fleet\")\noField.Orientation = xlRowField\n\nSet oField = oTable.PivotFields(\"Day\")\noField.Orientation = xlColumnField\n\nSet oField = oTable.PivotFields(\"LAA NB\")\noField.Orientation = xlDataField\noField.Function = xlCount\n\n'format pivot table\n\nSet oWC = oWB.Sheets(\"Sheet4\")\nSet oWS2 = oWB.Sheets(\"Sheet2\")\n\noWS2.Cells(1, 1) = \"TRUE\"\noWS2.Cells(2, 1) = \"LAA\"\noWS2.Cells(3, 1) = \"LUS\"\noWS2.Cells(4, 1) = \"LAA TOTAL\"\noWS2.Cells(5, 1) = \"LUS TOTAL\"\noWS2.Cells(6, 1) = \"NB TOTAL\"\noWS2.Cells(7, 1) = \"WB TOTAL\"\noWS2.Cells(8, 1) = \"GRAND TOTAL\"\n\n\nz = oWC.Cells(2, 4).End(xlToRight).Column\ny = oWC.Cells(2, z).End(xlDown).Row\nw = z - 1\n\nsc1 = RGB(255, 197, 197) ' LUS NB\nsc2 = RGB(255, 91, 91)   ' LUS WB\nsc3 = RGB(209, 246, 255) ' LAA NB\nsc4 = RGB(0, 173, 214)   ' LAA WB\n\n\nIf IsError(Excel.Application.WorksheetFunction.Match(oWS2.Cells(2, 1).Value, oWC.Columns(1), 0)) = False Then\n'    LAARow = Excel.Application.Match(oWS2.Cells(2, 1).Value, oWC.Columns(1), 0)\n'    LAATOTALRow = Excel.Application.Match(oWS2.Cells(4, 1).Value, oWC.Columns(1), 0)\n'        Set LAATotalRange = oWC.Range(oWC.Cells(LAATOTALRow, 1), oWC.Cells(LAATOTALRow, z))\n'            LAATotalRange.Font.Bold = True\n'            LAATotalRange.Font.Size = 12\n'        Set LAARange = oWC.Range(oWC.Cells(LAARow, 2), oWC.Cells(LAATOTALRow, 2))\n'            If IsError(Excel.Application.Match(oWS2.Cells(6, 1).Value, LAARange, 0)) = False Then\n'                LAANBRow = Excel.Application.Match(oWS2.Cells(6, 1).Value, LAARange, 0) + 2\n'                Set LAANBRange = oWC.Range(oWC.Cells(LAANBRow, 2), oWC.Cells(LAANBRow, z))\n'                LAANBRange.Interior.Color = sc3\n '               LAANBRange.Font.Bold = True\n'                LAANBRange.Font.Size = 11\n'            End If\n'            If IsError(Excel.Application.Match(oWS2.Cells(7, 1).Value, LAARange, 0)) = False Then\n'                LAAWBRow = Excel.Application.Match(oWS2.Cells(7, 1).Value, LAARange, 0) + 2\n'                Set LAAWBRange = oWC.Range(oWC.Cells(LAAWBRow, 2), oWC.Cells(LAAWBRow, z))\n'                LAAWBRange.Interior.Color = sc4\n'                LAAWBRange.Font.Bold = True\n'                LAAWBRange.Font.Size = 11\n'            End If\nEnd If\n\n'If IsError(Excel.Application.Match(oWS2.Cells(3, 1).Value, oWC.Columns(1), 0)) = False Then\n'    LUSRow = Excel.Application.Match(oWS2.Cells(3, 1).Value, oWC.Columns(1), 0)\n'    LUSTOTALRow = Excel.Application.Match(oWS2.Cells(5, 1).Value, oWC.Columns(1), 0)\n'        Set LUSTotalRange = oWC.Range(oWC.Cells(LUSTOTALRow, 1), oWC.Cells(LUSTOTALRow, z))\n'            LUSTotalRange.Font.Bold = True\n '           LUSTotalRange.Font.Size = 12\n '       Set LUSRange = oWC.Range(oWC.Cells(LUSRow, 2), oWC.Cells(LUSTOTALRow, 2))\n'            If IsError(Excel.Application.Match(oWS2.Cells(6, 1).Value, LUSRange, 0)) = False Then\n '               LUSNBRow = Excel.Application.Match(oWS2.Cells(6, 1).Value, LUSRange, 0) + LAATOTALRow\n'                Set LUSNBRange = oWC.Range(oWC.Cells(LUSNBRow, 2), oWC.Cells(LUSNBRow, z))\n'                LUSNBRange.Interior.Color = sc1\n'                LUSNBRange.Font.Bold = True\n'                LUSNBRange.Font.Size = 11\n'            End If\n'            If IsError(Excel.Application.Match(oWS2.Cells(7, 1).Value, LUSRange, 0)) = False Then\n'                LUSWBRow = Excel.Application.Match(oWS2.Cells(7, 1).Value, LUSRange, 0) + LAATOTALRow\n'                Set LUSWBRange = oWC.Range(oWC.Cells(LUSWBRow, 2), oWC.Cells(LUSWBRow, z))\n'                LUSWBRange.Interior.Color = sc2\n '               LUSWBRangeFont.Bold = True\n '               LUSWBRange.Font.Size = 11\n '           End If\n'End If\n\n'Set GTotalRange = oWC.Range(oWC.Cells(y, 1), oWC.Cells(y, z))\n\n'With GTotalRange\n'     .Font.Bold = True\n'     .Font.Size = 13\n'     .Interior.Color = RGB(143, 202, 140)\n'End With\n\n\n '   With oWC\n '       .Cells.Font.Name = \"Arial monospaced for SAP\"\n '       .Cells.Font.Size = 10\n  '      .Range(.Columns(4), .Columns(z)).ColumnWidth = 6.3\n  '      .Range(.Columns(4), .Columns(z)).WrapText = True\n  '       Set oRange = .Range(.Cells(2, 1), .Cells(y, w))\n  '      .PivotTables(1).ShowDrillIndicators = False\n  '      .PivotTables(1).PivotCache.Refresh\n   '     .PivotTables(1).MergeLabels = True\n  '      .Range(.Columns(4), .Columns(z)).EntireColumn.AutoFit\n  '      .Rows(1).EntireRow.Hidden = True\n  '      .Columns(z).EntireColumn.Hidden = True\n\n  '  End With\n\n\n\n\n'Set pt = oWC.PivotTables(1)\n\n'  For Each pf In pt.PivotFields\n'      pf.EnableItemSelection = False\n'  Next\n\n\n'oRange.CurrentRegion.CopyPicture xlScreen, xlBitmap\n'DoCmd.OpenReport ReportName:=\"rptRONData\", View:=acViewDesign\n\n'For Each ctl In Reports!rptRONData\n'ctl.Name = \"ctlDelPic\"\n'DeleteReportControl \"rptRONData\", \"ctlDelPic\"\n'Next\n\n'DoCmd.RunCommand acCmdPaste\n\n'For Each ctl In Reports!rptRONData\n'    ctl.Name = \"ctlNewData\"\n'        With Reports!rptRONData.ctlNewData\n'            .SizeMode = acOLESizeStretch\n'            .Width = 23040\n'        End With\n'Next\n\n'DoCmd.Close acReport, \"rptRONData\", acSaveYes\n\n\noWB.Close False\n'oXL.Visible = True\n\nSet oWB = Nothing\nSet oWS = Nothing\nSet oRS = Nothing\nSet oTable = Nothing\nSet oField = Nothing\nSet oWC = Nothing\nSet oWS2 = Nothing\nSet LAATotalRange = Nothing\nSet LAARange = Nothing\nSet LAANBRange = Nothing\nSet LAAWBRange = Nothing\nSet LUSTotalRange = Nothing\nSet LUSRange = Nothing\nSet LUSNBRange = Nothing\nSet LUSWBRange = Nothing\nSet GTotalRange = Nothing\nSet oRange = Nothing\nSet pt = Nothing\n\noXL.Quit\n\nSet oXL = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1087, "user_id": 2484483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zQmyD.png?s=128&g=1", "display_name": "YetAnotherRandomUser", "link": "https://stackoverflow.com/users/2484483/yetanotherrandomuser"}, "edited": false, "score": 0, "creation_date": 1494420289, "post_id": 43892473, "comment_id": 74819692, "body": "Instead of copypasta, why not use a <code>select case</code> statement?  Switching to that may help find/resolve whatever error you have elsewhere.  <a href=\"https://www.techonthenet.com/excel/formulas/case.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/case.php</a>"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1494420812, "post_id": 43892473, "comment_id": 74820133, "body": "Have you tried <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">stepping through your code</a>.  This method allows you to see the impact each line of code has on your worksheets.  You should be able to track down the offending line in no time."}, {"owner": {"reputation": 1, "user_id": 7991688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554524d5e5b3f8a58282b55fc0aaabd1?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme Wood", "link": "https://stackoverflow.com/users/7991688/graeme-wood"}, "edited": false, "score": 0, "creation_date": 1494421549, "post_id": 43892473, "comment_id": 74820771, "body": "Thanks for the idea of stepping through the code...I&#39;ve narrowed it down to the  &#39;.EntireRow.Delete&#39; code when the script finds no valid rows for the filter its searching for. For example, when the script filters for &quot;OP Write Off&quot; and there are no rows with that in, its going to Row1 and moving that row to the designated sheet. It should be disregarding that part of the code as there&#39;s nothing to move ( no value found )."}, {"owner": {"reputation": 1181, "user_id": 1047635, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8d6e0423415429e3652a5cc573a4f935?s=128&d=identicon&r=PG", "display_name": "matt_black", "link": "https://stackoverflow.com/users/1047635/matt-black"}, "edited": false, "score": 0, "creation_date": 1494421721, "post_id": 43892473, "comment_id": 74820937, "body": "You might also try adding an explicit sheet for each statement involving columns. The statements as they stand might act on the wrong sheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1494422830, "post_id": 43892473, "comment_id": 74821831, "body": "Protip: <a href=\"https://stackoverflow.com/posts/43892473/edit\">edit</a> your title so that it describes the problem in some kind of searchable way. the current title is applicable to 60,960 questions on this site."}, {"owner": {"reputation": 1, "user_id": 7991688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554524d5e5b3f8a58282b55fc0aaabd1?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme Wood", "link": "https://stackoverflow.com/users/7991688/graeme-wood"}, "edited": false, "score": 0, "creation_date": 1494426798, "post_id": 43892473, "comment_id": 74824950, "body": "Thanks for the tip, I&#39;ve edited the title now."}], "owner": {"reputation": 1, "user_id": 7991688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554524d5e5b3f8a58282b55fc0aaabd1?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme Wood", "link": "https://stackoverflow.com/users/7991688/graeme-wood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494426773, "creation_date": 1494419135, "last_edit_date": 1494426773, "question_id": 43892473, "link": "https://stackoverflow.com/questions/43892473/excel-vb-deleting-rows-when-no-value-found", "title": "Excel VB deleting rows when no value found", "body": "<p>I'm currently designing a small workbook to move work between sheets when allocated. I've written a small code which is supposed to scan the sheet from row A7 onwards for a keyword and then move the row to either Sheet 5 or Sheet 6 based on the value.</p>\n\n<p>However, now I have added more auto filters to the code, the script seems to be deleting rows from a1 and moving them to Sheet 5 and 6 in error which is destroying the formatting. I've duplicated the code for the 5 different keywords which is possibly where the error occurs...does anyone know why?</p>\n\n<pre><code>Sub CommandButton1_Click()\n\nApplication.ScreenUpdating = True\nColumns(11).AutoFilter 1, \"ORNC\"\nWith Range(\"a7\", Range(\"K\" &amp; Rows.Count).End(3))\n    .Copy Sheet6.Cells(Rows.Count, 1).End(3).Offset(1)\n    .EntireRow.Delete\nEnd With\nColumns(11).AutoFilter\n\nApplication.ScreenUpdating = True\nColumns(11).AutoFilter 1, \"ORCIF\"\nWith Range(\"a7\", Range(\"k\" &amp; Rows.Count).End(3))\n    .Copy Sheet5.Cells(Rows.Count, 1).End(3).Offset(1)\n    .EntireRow.Delete\nEnd With\nColumns(11).AutoFilter\nApplication.ScreenUpdating = True\n\n Application.ScreenUpdating = True\nColumns(11).AutoFilter 1, \"OP Write Off\"\nWith Range(\"a7\", Range(\"k\" &amp; Rows.Count).End(3))\n    .Copy Sheet5.Cells(Rows.Count, 1).End(3).Offset(1)\n    .EntireRow.Delete\nEnd With\nColumns(11).AutoFilter\nApplication.ScreenUpdating = True\n\nApplication.ScreenUpdating = True\nColumns(11).AutoFilter 1, \"LO Write Off\"\nWith Range(\"a7\", Range(\"k\" &amp; Rows.Count).End(3))\n    .Copy Sheet5.Cells(Rows.Count, 1).End(3).Offset(1)\n    .EntireRow.Delete\nEnd With\nColumns(11).AutoFilter\nApplication.ScreenUpdating = True\n\nApplication.ScreenUpdating = True\nColumns(11).AutoFilter 1, \"Not a Recon\"\nWith Range(\"a7\", Range(\"k\" &amp; Rows.Count).End(3))\n    .Copy Sheet5.Cells(Rows.Count, 1).End(3).Offset(1)\n    .EntireRow.Delete\nEnd With\nColumns(11).AutoFilter\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n\n<p>As you can see, the script should look for one of the keywords in column K from row 7 onwards, and then move to Sheet 5/6 based on its return.</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Graeme</p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 138, "user_id": 2284877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/041b5353112512851f3a4897b1b2ce26?s=128&d=identicon&r=PG", "display_name": "user2284877", "link": "https://stackoverflow.com/users/2284877/user2284877"}, "edited": false, "score": 0, "creation_date": 1494420072, "post_id": 43892360, "comment_id": 74819506, "body": "did you checked for another website / className ? the code works ok  for  for <a href=\"http://stackoverflow.com\">stackoverflow.com</a> classname=&#39;summary&#39; for example"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1494420914, "post_id": 43892360, "comment_id": 74820230, "body": "Can you provide a sample of the html and highlight the area you wish to extract?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494420984, "post_id": 43892360, "comment_id": 74820296, "body": "Is it in a span? I remember something when scraping a web site once, that you cant have text in a span, or something like that."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494423390, "post_id": 43892360, "comment_id": 74822274, "body": "<code>Do While IE.Busy</code> also worth checking the <code>readystate</code> as well."}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494423395, "post_id": 43892360, "comment_id": 74822276, "body": "@Nathan_Sav Please see updated question with HTML"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494423514, "post_id": 43892360, "comment_id": 74822379, "body": "have you tried innerHTML?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494423653, "post_id": 43892360, "comment_id": 74822497, "body": "<code>Application.Wait</code> is an unreliable way to wait, just use <code>DoEvents</code> instead. Also, if you&#39;re using a recent version of IE9+ you can use <code>getElementByID</code> method, since ID is a unique identifier."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494423792, "post_id": 43892360, "comment_id": 74822611, "body": "that&#39;s it, its the ID not the class name. :)"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494423800, "post_id": 43892360, "comment_id": 74822619, "body": "@Nathan_Sav thanks tried ready state and it just seemed to make it crash"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494423858, "post_id": 43892360, "comment_id": 74822664, "body": "@Nathan_Sav tried InnerHtml and it produces error object variable or with block variable not set"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494423898, "post_id": 43892360, "comment_id": 74822693, "body": "@Nathan_Sav but if i change ClassName to ID it produces another object variable or with block variable not set  error"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1494424034, "post_id": 43892360, "comment_id": 74822800, "body": "break it down then, say <code>set e=ie.document.getelementbyid(&quot;ctl00_ContentPlaceHolder1_Form&zwnj;&#8203;View1_GridView1_ctl0&zwnj;&#8203;2_lb_ExpiryDate&quot;)</code> then <code>s=e.innerText</code> see, even go back to checking IE, you can use the locals window to help to."}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494424070, "post_id": 43892360, "comment_id": 74822834, "body": "@DavidZemens thanks ive tried  what you said in my code, see edit. Bit gives me an automation error on this line dd = IE.Document.getElementByID(&quot;ctl00_ContentPlaceHolder1_FormVi&zwnj;&#8203;ew1_GridView1_ctl02_&zwnj;&#8203;lb_ExpiryDate&quot;)(0).i&zwnj;&#8203;nnerText"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1494427589, "post_id": 43892360, "comment_id": 74825651, "body": "there&#39;s no <code>(0)</code> if you use <code>getElementID</code> because that method only/always returns either a single element (as long as it exists)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494427699, "post_id": 43892360, "comment_id": 74825759, "body": "Also, when debugging, you need to stop chaining your methods &amp; properties in order to determine where the error is. First, see if <code>getElementById</code> returns an object. Use @Nathan_Sav &#39;s suggestion to do this."}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 891, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494424028, "creation_date": 1494418840, "last_edit_date": 1494424028, "question_id": 43892360, "link": "https://stackoverflow.com/questions/43892360/vba-get-text-from-webpage-and-display-as-message-in-excel", "title": "vba get text from webpage and display as message in excel?", "body": "<p>I am using the following code in vba to extract a value from a website.</p>\n\n<p>Let's pretend the value is wrapped inside a html span id. i want to retrieve this value and display it as a message box in excel.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub PullExpiry()\n\n    Dim IE As Object\n\n    ' Create InternetExplorer Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    ' You can uncoment Next line To see form results\n    IE.Visible = False\n\n    ' URL to get data from\n    IE.Navigate \"https://www.brcdirectory.com/InternalSite//Site.aspx?BrcSiteCode=\" &amp; Range(\"J6\").Value\n\n    ' Statusbar\n    Application.StatusBar = \"Loading, Please wait...\"\n\n    ' Wait while IE loading...\n    Do While IE.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n\n    Application.StatusBar = \"Searching for value. Please wait...\"\n\n    Dim dd As String\n    dd = IE.Document.getElementsByClassName(\"ctl00_ContentPlaceHolder1_FormView1_GridView1_ctl02_lb_ExpiryDate\")(0).innerText\n\n    MsgBox dd\n\n    ' Show IE\n    IE.Visible = True\n\n    ' Clean up\n    Set IE = Nothing\n\n    Application.StatusBar = \"\"\n\n\n\nEnd Sub\n</code></pre>\n\n<p>HTML:</p>\n\n<pre><code>&lt;span id=\"ctl00_ContentPlaceHolder1_FormView1_GridView1_ctl02_lb_ExpiryDate\"&gt;Expiry Date : 16/02/2018&lt;/span&gt;\n</code></pre>\n\n<p>I get an object doesn't support this property or method error:</p>\n\n<pre><code>IE.Document.getElementsByClassName(\"ctl00_ContentPlaceHolder1_FormView1_GridView1_ctl02_lb_ExpiryDate\")(0).innerText\n</code></pre>\n\n<p>Please can someone show me where i am going wrong?</p>\n\n<p>EDIT</p>\n\n<pre><code>Other code tried:\n\nSub PullExpiry()\n\n    Dim IE As Object\n\n    ' Create InternetExplorer Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    ' You can uncoment Next line To see form results\n    IE.Visible = False\n\n    ' URL to get data from\n    IE.Navigate \"https://www.brcdirectory.com/InternalSite//Site.aspx?BrcSiteCode=\" &amp; Range(\"J6\").Value\n\n    ' Statusbar\n    Application.StatusBar = \"Loading, Please wait...\"\n\n    ' Wait while IE loading...\n    Do While IE.Busy\n    DoEvents\n    Loop\n\n    Application.StatusBar = \"Searching for value. Please wait...\"\n\n    Dim dd As String\n    dd = IE.Document.getElementByID(\"ctl00_ContentPlaceHolder1_FormView1_GridView1_ctl02_lb_ExpiryDate\")(0).innerText\n    MsgBox dd\n\n    ' Show IE\n    IE.Visible = True\n\n    ' Clean up\n    Set IE = Nothing\n\n    Application.StatusBar = \"\"\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4027097, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh5.googleusercontent.com/-R7gIOt0kIzw/AAAAAAAAAAI/AAAAAAAAACg/0KvwZl-JWWQ/photo.jpg?sz=128", "display_name": "Prasoon Pandey", "link": "https://stackoverflow.com/users/4027097/prasoon-pandey"}, "edited": false, "score": 0, "creation_date": 1494419364, "post_id": 43892468, "comment_id": 74818944, "body": "What should be the syntax if i want to enable it for a column (say B) through macro on a sheet ?"}, {"owner": {"reputation": 907, "user_id": 5752528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b1754f69488117c0de4445a406fef4?s=128&d=identicon&r=PG&f=1", "display_name": "Nitesh Halai", "link": "https://stackoverflow.com/users/5752528/nitesh-halai"}, "reply_to_user": {"reputation": 99, "user_id": 4027097, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh5.googleusercontent.com/-R7gIOt0kIzw/AAAAAAAAAAI/AAAAAAAAACg/0KvwZl-JWWQ/photo.jpg?sz=128", "display_name": "Prasoon Pandey", "link": "https://stackoverflow.com/users/4027097/prasoon-pandey"}, "edited": false, "score": 0, "creation_date": 1494420030, "post_id": 43892468, "comment_id": 74819475, "body": "Used the macro recorder. Updated in answer."}, {"owner": {"reputation": 99, "user_id": 4027097, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh5.googleusercontent.com/-R7gIOt0kIzw/AAAAAAAAAAI/AAAAAAAAACg/0KvwZl-JWWQ/photo.jpg?sz=128", "display_name": "Prasoon Pandey", "link": "https://stackoverflow.com/users/4027097/prasoon-pandey"}, "edited": false, "score": 0, "creation_date": 1494422030, "post_id": 43892468, "comment_id": 74821201, "body": "Your code formats it in the way i want. Thank you for that. But still it&#39;s actual value is 0.989 When i checked its length it shows 5. How can i make it to read the length as 6. Basically i want it&#39;s value to be exact 0.9890 and not 0.989 Thank you again for your help. Please let me know if it is possible."}, {"owner": {"reputation": 907, "user_id": 5752528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b1754f69488117c0de4445a406fef4?s=128&d=identicon&r=PG&f=1", "display_name": "Nitesh Halai", "link": "https://stackoverflow.com/users/5752528/nitesh-halai"}, "reply_to_user": {"reputation": 99, "user_id": 4027097, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh5.googleusercontent.com/-R7gIOt0kIzw/AAAAAAAAAAI/AAAAAAAAACg/0KvwZl-JWWQ/photo.jpg?sz=128", "display_name": "Prasoon Pandey", "link": "https://stackoverflow.com/users/4027097/prasoon-pandey"}, "edited": false, "score": 0, "creation_date": 1494422256, "post_id": 43892468, "comment_id": 74821378, "body": "Use this formula to change it to a string, assuming your value is in F20. =TEXT(F20,&quot;#,##0.0000;-#,##0.0000&quot;). This will give you a length of 6 as well. As of now, I don&#39;t know how to incorporate the same in a macro."}], "tags": [], "owner": {"reputation": 907, "user_id": 5752528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b1754f69488117c0de4445a406fef4?s=128&d=identicon&r=PG&f=1", "display_name": "Nitesh Halai", "link": "https://stackoverflow.com/users/5752528/nitesh-halai"}, "is_accepted": false, "score": 1, "last_activity_date": 1494422312, "last_edit_date": 1494422312, "creation_date": 1494419123, "answer_id": 43892468, "question_id": 43892355, "link": "https://stackoverflow.com/questions/43892355/how-to-prevent-excel-from-removing-trailing-zeros-after-decimal-point/43892468#43892468", "title": "How to prevent Excel from removing trailing zeros after decimal point?", "body": "<p>Use the customs format. </p>\n\n<pre><code>#,##0.0000;-#,##0.0000\n</code></pre>\n\n<p>You can add more zeroes at the end if you want to show more decimal places.</p>\n\n<p>Using a macro:</p>\n\n<pre><code>Sub Macro1()\n    Columns(\"B:B\").Select\n    Selection.NumberFormat = \"#,##0.0000;-#,##0.0000\"\nEnd Sub\n</code></pre>\n\n<p>Use this formula to change it to a string, assuming your value is in F20: </p>\n\n<pre><code>=TEXT(F20,\"#,##0.0000;-#,##0.0000\"). \n</code></pre>\n\n<p>This will give you a length of 6 as well. As of now, I don't know how to incorporate the same in a macro.</p>\n"}], "owner": {"reputation": 99, "user_id": 4027097, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh5.googleusercontent.com/-R7gIOt0kIzw/AAAAAAAAAAI/AAAAAAAAACg/0KvwZl-JWWQ/photo.jpg?sz=128", "display_name": "Prasoon Pandey", "link": "https://stackoverflow.com/users/4027097/prasoon-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2444, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494431925, "creation_date": 1494418823, "last_edit_date": 1531161705, "question_id": 43892355, "link": "https://stackoverflow.com/questions/43892355/how-to-prevent-excel-from-removing-trailing-zeros-after-decimal-point", "title": "How to prevent Excel from removing trailing zeros after decimal point?", "body": "<p>Whenever i enter 0.9890 in excel sheet and hit enter it shows 0.989 only. I want to retain the text or number as it is in excel sheet. This feature i want to enable through macro for the workbook. How can i do it ?</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 3, "creation_date": 1494421019, "post_id": 43892285, "comment_id": 74820325, "body": "If any of these answers helped you please consider <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accepting them</a>.  Accepting answers rewards those who help you.  It also helps others with the same problem to find a working answer."}], "answers": [{"tags": [], "owner": {"reputation": 844, "user_id": 3775798, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/EOqLt.png?s=128&g=1", "display_name": "Knowledge Cube", "link": "https://stackoverflow.com/users/3775798/knowledge-cube"}, "is_accepted": false, "score": 3, "last_activity_date": 1494418967, "creation_date": 1494418967, "answer_id": 43892412, "question_id": 43892285, "link": "https://stackoverflow.com/questions/43892285/escaping-special-characters-in-vba-is-not-working/43892412#43892412", "title": "escaping special characters in vba is not working", "body": "<p>When using the VBA <code>Like</code> operator, you are supposed to escape special characters by enclosing them in square brackets (<code>[</code> and <code>]</code>). What you are using above is syntax for a regular expression, which is not the same thing as a <code>Like</code> pattern. See <a href=\"https://msdn.microsoft.com/en-us/library/ms235204(v=vs.100).aspx\" rel=\"nofollow noreferrer\">this page on MSDN</a> for more information about the differences between <code>Like</code> and regular expressions.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1494419490, "last_edit_date": 1495541406, "creation_date": 1494419490, "answer_id": 43892597, "question_id": 43892285, "link": "https://stackoverflow.com/questions/43892285/escaping-special-characters-in-vba-is-not-working/43892597#43892597", "title": "escaping special characters in vba is not working", "body": "<p>Try the solution below using <code>RegEx.Replace</code> method.</p>\n\n<p><strong>Note</strong>: special thanks for helping with the <code>Pattern</code> from this <a href=\"https://stackoverflow.com/questions/3115150/how-to-escape-regular-expression-special-characters-using-javascript\">Answer</a></p>\n\n<pre><code>Option Explicit\n\nSub ClearData()\n\nDim StrTest As String\nDim Result  As String\nDim Reg1    As Object\n\nStrTest = \"[1234567890]\"\n\nSet Reg1 = CreateObject(\"VBScript.RegExp\")\nWith Reg1\n    .Global = True\n    .IgnoreCase = True\n    .Pattern = \"[-[\\]{}()*+?.,\\\\/^$|#\\s]\" ' escape special characters pattern\nEnd With\n\nIf Reg1.test(StrTest) Then\n    Result = Reg1.Replace(StrTest, Result)\nEnd If\n\nEnd SUb\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 138, "user_id": 2284877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/041b5353112512851f3a4897b1b2ce26?s=128&d=identicon&r=PG", "display_name": "user2284877", "link": "https://stackoverflow.com/users/2284877/user2284877"}, "is_accepted": false, "score": 0, "last_activity_date": 1494421172, "creation_date": 1494421172, "answer_id": 43893244, "question_id": 43892285, "link": "https://stackoverflow.com/questions/43892285/escaping-special-characters-in-vba-is-not-working/43893244#43893244", "title": "escaping special characters in vba is not working", "body": "<p>Another solution:</p>\n\n<pre><code>Sub no_spch()\n\nFor Each cell In range(\"a1:a10\")\nspch = \"#+-,'.()[]!?`&amp;:*\"\nFor i = 1 To Len(spch)\ncell.Value = Replace(Replace(cell.Value, Mid(spch, i, 1), \"\"), \" \", \"\")\nNext\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7991629, "user_type": "registered", "profile_image": "https://graph.facebook.com/450963585239026/picture?type=large", "display_name": "Flo Gaede", "link": "https://stackoverflow.com/users/7991629/flo-gaede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4203, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1494422957, "creation_date": 1494418653, "last_edit_date": 1494422957, "question_id": 43892285, "link": "https://stackoverflow.com/questions/43892285/escaping-special-characters-in-vba-is-not-working", "title": "escaping special characters in vba is not working", "body": "<p>I don't know why but I can't escape special characters in patterns.</p>\n\n<pre><code>If StrTest Like \"\\[*\\]\" Then ...\n</code></pre>\n\n<p>It still does not match values like [1234567890].\nIn other threads I read that \"\\\" is used to escape characters, but it does still not work.</p>\n\n<p>In between the brackets I want any string to be possible.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494418876, "post_id": 43892230, "comment_id": 74818568, "body": "for starters the formula contains an error, check your quotation marks which I&#39;m pretty sure you don&#39;t need, and should be : <code>Index(TargetRange,MATCH(C4,myRange))</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494418907, "post_id": 43892230, "comment_id": 74818588, "body": "Also, your <code>Large</code> function should not be range <code>04:T4</code> but <code>O4:T4</code>, right?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494419505, "post_id": 43892230, "comment_id": 74819061, "body": "Pull apart your function in to its constituents (i.e., examine the <code>Match</code> function and see if that is the source of the error. (Hint: it is, because Match only works against a single row or column, and you&#39;ve defined <code>myRange</code> as a range of multiple, non-contiguous columns.)"}, {"owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1494423603, "post_id": 43892230, "comment_id": 74822462, "body": "Thanks for your advice. I believe I need to use an array function.  I use the following code:  =INDEX(TargetRange,MAX(IF(myRange=C4,COLUMN(TargetRange)))). However, I get #VALUE!. Any ideas?"}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 0, "creation_date": 1494430819, "post_id": 43892230, "comment_id": 74828170, "body": "Can you clarify whether all values in myRange contain a number? If so, are these numbers always non-negative?"}], "owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494418512, "creation_date": 1494418512, "question_id": 43892230, "link": "https://stackoverflow.com/questions/43892230/match-and-index-for-range-that-consists-of-multiple-columns", "title": "MATCH and INDEX for Range that consists of multiple Columns", "body": "<p>I would like to get your help!</p>\n\n<p>I have an Excel file in which Sheet1 consists of multiple cells.\nMy lookup_value is C4. C4 is a value that is calculated with the following formula </p>\n\n<pre><code>=LARGE(04:T4,1)\n</code></pre>\n\n<p>where</p>\n\n<p>04 - T4 are located in Sheet1 and represent the five largest values of a \"defined\" range called \"myRange\"`</p>\n\n<pre><code>=LARGE(\"myRange\",1) ...  =LARGE(\"myRange\",5)\n</code></pre>\n\n<p>\"myRange\" is located in Sheet2 and is writtten as:</p>\n\n<pre><code>=Sheet2!$N$2:$N$100,Sheet2!$AA$2:$AA$100,Sheet2!$AN$2:$AN$100,Sheet2!$BA$2:$BA$100,Sheet2!$BN$2:$BN$100)\n</code></pre>\n\n<p>I use \"myRang\" as the lookup_array</p>\n\n<p>Now I would like to use a formula to retrieve the cell that is 11 columns to the left of the cell in my lookup_array that is equal to C4. So, this cell could in column C/P/AC/AP/BC or BP in Sheet2</p>\n\n<p>I have named this range \"TargetRange\" </p>\n\n<p><code>=Sheet2!$C$2:$C$100,Sheet2!$P$2:$P$100,Sheet2!$AC$2:$AC$100,Sheet2!$BC$2:$BC$10,Sheet2!$BP$2:$BP$100,)</code></p>\n\n<p>If I use the formula </p>\n\n<pre><code>=INDEX(\"TargetRange,MATCH(C4,\"myRange)) \n</code></pre>\n\n<p>I get N/A. Can anyone help me in the right direction?</p>\n\n<p>Thank you for your help!!</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1494599848, "post_id": 43891612, "comment_id": 74912967, "body": "Is it important that the picture be <i>in</i> the frame, or is it sufficient that it be added to the slide in the same position and at the same size as the frame?   Is the picture already in the same proportions as the frame?"}, {"owner": {"reputation": 1623, "user_id": 3080315, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dca9f77ce600fbae2b1cd16df56dba3e?s=128&d=identicon&r=PG&f=1", "display_name": "jz22", "link": "https://stackoverflow.com/users/3080315/jz22"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1494836237, "post_id": 43891612, "comment_id": 74978601, "body": "Yes, it is important that the picture is in the frame. It should be scaled to the frame of the placeholder."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1495146963, "post_id": 43891612, "comment_id": 75142615, "body": "Is there some reason why the picture MUST be in a placeholder rather than simply scaled to fit a particular area?"}], "answers": [{"comments": [{"owner": {"reputation": 1623, "user_id": 3080315, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dca9f77ce600fbae2b1cd16df56dba3e?s=128&d=identicon&r=PG&f=1", "display_name": "jz22", "link": "https://stackoverflow.com/users/3080315/jz22"}, "edited": false, "score": 0, "creation_date": 1494836445, "post_id": 43962028, "comment_id": 74978725, "body": "Thanks a lot. But this code only adds a picture to the slide. I would like to put a placeholder on a slide and insert an image into this frame with a macro."}], "tags": [], "owner": {"reputation": 1540, "user_id": 5829910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHFX.jpg?s=128&g=1", "display_name": "Zsmaster", "link": "https://stackoverflow.com/users/5829910/zsmaster"}, "is_accepted": false, "score": 2, "last_activity_date": 1494751685, "creation_date": 1494751685, "answer_id": 43962028, "question_id": 43891612, "link": "https://stackoverflow.com/questions/43891612/powerpoint-macro-to-insert-a-picture-into-a-frame/43962028#43962028", "title": "PowerPoint macro to insert a picture into a frame", "body": "<p>try the following code:</p>\n\n<pre><code>Public Sub InsertPic()\n    Set myDocument = ActivePresentation.Slides(2)\n    myDocument.Shapes.AddPicture FileName:=\"d:\\pic.jpg\", LinkToFile:=msoTrue, SaveWithDocument:=msoTrue, Left:=100, Top:=100, Width:=200, Height:=200\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1623, "user_id": 3080315, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dca9f77ce600fbae2b1cd16df56dba3e?s=128&d=identicon&r=PG&f=1", "display_name": "jz22", "link": "https://stackoverflow.com/users/3080315/jz22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1494751685, "creation_date": 1494416871, "last_edit_date": 1494431853, "question_id": 43891612, "link": "https://stackoverflow.com/questions/43891612/powerpoint-macro-to-insert-a-picture-into-a-frame", "title": "PowerPoint macro to insert a picture into a frame", "body": "<p>I have a PowerPoint file with a content placeholder frame named \"image2\" on slide 22. There is an image called hello.png in a folder somewhere on my computer. Now I need a macro to put the image into this frame. It is important that the image is having the size and the position of the frame after it is imported.</p>\n\n<p>I found this piece of code on the internet but it doesn't work for me.</p>\n\n<pre><code>ActivePresentation.Slides(22).Shapes(\"image2\").Picture = LoadPicture(\"path to the image\")\n</code></pre>\n\n<p>It says method or data member not found. I also found the method addPicture but it doesn't work either.</p>\n\n<p>Can you help me out? Thanks in advance.</p>\n"}, {"tags": ["vba", "macos", "pdf", "ms-word", "macos-sierra"], "answers": [{"comments": [{"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1519012504, "post_id": 43909280, "comment_id": 84722038, "body": "This worked for me in Feb 2018. After 1) adding the macro, 2) saving the doc as a macro enabled doc, and 3) adding this macro to the quick access toolbar. That gives pdfs with one-button click."}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 1, "last_activity_date": 1494488257, "creation_date": 1494488257, "answer_id": 43909280, "question_id": 43891164, "link": "https://stackoverflow.com/questions/43891164/saving-ms-word-docx-as-pdf-on-mac-os-x-with-one-click-using-macros/43909280#43909280", "title": "Saving MS word (docx) as pdf on Mac OS X with one click using macros", "body": "<p>You need to remove the existing file extension before adding the new one. Like this:</p>\n\n<pre><code>Sub SaveActiveDocAsPDF()\n\nOn Error Resume Next\n\nDim saveName As String\nsaveName = ActiveDocument.FullName\nsaveName = Left(saveName, Len(saveName) - 5) &amp; \".pdf\"\n\nActiveDocument.SaveAs fileName:=saveName, _\nFileFormat:=wdFormatPDF\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7991307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c2a2ac090e903df9ed192cacc73008?s=128&d=identicon&r=PG&f=1", "display_name": "Valentins Abasins", "link": "https://stackoverflow.com/users/7991307/valentins-abasins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 0, "accepted_answer_id": 43909280, "answer_count": 1, "score": 0, "last_activity_date": 1593885086, "creation_date": 1494415724, "last_edit_date": 1593885086, "question_id": 43891164, "link": "https://stackoverflow.com/questions/43891164/saving-ms-word-docx-as-pdf-on-mac-os-x-with-one-click-using-macros", "title": "Saving MS word (docx) as pdf on Mac OS X with one click using macros", "body": "<p>I have a question on how to edit the following macros to save MS word (.docx) file as PDF on macOS Sierra without .docx in the file name. That is, the macros works perfectly BUT it always saves files as, for example, letter.docx.pdf. It is a very easy option to save in pdf with one click only.</p>\n\n<p>And I would appreciate if someone could help to me amend the macros below so that there is no .docx in the file name. I have tried to hide extensions in Finder, but that does not seem to help:</p>\n\n<hr>\n\n<pre><code>Sub SaveActiveDocAsPDF()\n\nOn Error Resume Next\n\nActiveDocument.SaveAs _\nfileName:=ActiveDocument.FullName &amp; \".pdf\", _\nFileFormat:=wdFormatPDF\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Thank you very much in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1494416508, "creation_date": 1494416508, "answer_id": 43891488, "question_id": 43891083, "link": "https://stackoverflow.com/questions/43891083/usedrange-find-function-skipping-hidden-columns-in-the-second-run-is-there-any/43891488#43891488", "title": "UsedRange.find function skipping hidden columns in the second run. Is there any property which deals with this?", "body": "<p>set <code>Range.Find(LookIn:=xlFormulas)</code> to include hidden cells as well</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find Method Reference</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4817920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac9490c9f173cc6db5892c2a6be42360?s=128&d=identicon&r=PG&f=1", "display_name": "7777", "link": "https://stackoverflow.com/users/4817920/7777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494416508, "creation_date": 1494415492, "last_edit_date": 1494415827, "question_id": 43891083, "link": "https://stackoverflow.com/questions/43891083/usedrange-find-function-skipping-hidden-columns-in-the-second-run-is-there-any", "title": "UsedRange.find function skipping hidden columns in the second run. Is there any property which deals with this?", "body": "<p>I am trying to find out the last column of the used range using find function. But it is skipping the last hidden columns in the second run onwards.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1494420578, "creation_date": 1494420578, "answer_id": 43893019, "question_id": 43891071, "link": "https://stackoverflow.com/questions/43891071/adding-and-multiplying-combobox-textbox/43893019#43893019", "title": "Adding and multiplying combobox/textbox", "body": "<p>You're pretty close already.</p>\n\n<pre><code>if combox3.value like \"Chard\" And Combobox4.value like \"Days\" then\n    textbox4.value = textbox4.value * range(\"A1\") ' or whatever range you choose.\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7991388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a367de9f9aaec2a0ba735dadab135dc?s=128&d=identicon&r=PG&f=1", "display_name": "lorenzo1993", "link": "https://stackoverflow.com/users/7991388/lorenzo1993"}, "is_accepted": false, "score": 0, "last_activity_date": 1494422071, "creation_date": 1494422071, "answer_id": 43893598, "question_id": 43891071, "link": "https://stackoverflow.com/questions/43891071/adding-and-multiplying-combobox-textbox/43893598#43893598", "title": "Adding and multiplying combobox/textbox", "body": "<p>this is what ive got so far:</p>\n\n<p>If combox3.Value Like \"Chard\" And ComboBox4.Value Like \"Days\" And ComboBox9.Value Like \"Monday,Tuesday,Wednesday,Thursday,Friday\" Then\n    TextBox4.Value = TextBox4.Value * Range(\"B2\") ' or whatever range you choose.\nEnd If\nEnd Sub</p>\n\n<p>im getting run time error 424 now, object required. I cant seem to get textbox 4 to multiply by the value in sheet 3 cell B2?</p>\n"}], "owner": {"reputation": 1, "user_id": 7991388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a367de9f9aaec2a0ba735dadab135dc?s=128&d=identicon&r=PG&f=1", "display_name": "lorenzo1993", "link": "https://stackoverflow.com/users/7991388/lorenzo1993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494422071, "creation_date": 1494415456, "last_edit_date": 1531164843, "question_id": 43891071, "link": "https://stackoverflow.com/questions/43891071/adding-and-multiplying-combobox-textbox", "title": "Adding and multiplying combobox/textbox", "body": "<p>If ComboBox3.Value Like \"<em>Chard</em>\" And ComboBox4.Value Like \"<em>Days</em>\" Then * texbox4.Value</p>\n\n<p>This is the first part of the code that I have but I am stuck. I want it to read the value in combo box 3 and then read the value in combo box 4, then to read the value in text box 4 and multiple this by a value which is stored on a sheet within the workbook.</p>\n\n<p>How do I go about this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "excel", "string", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1494415558, "post_id": 43891008, "comment_id": 74816060, "body": "Does the function has been registered in system?"}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1494415964, "post_id": 43891008, "comment_id": 74816366, "body": "No, and apparently it doesn&#39;t need to. The function is defined in the same <code>extern &quot;C&quot;</code> block of other functions, which seem to work just fine."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1494416709, "post_id": 43891008, "comment_id": 74816940, "body": "Have you tried registering it to see if it fixes the issue? It could be an arbitrary .dll that&#39;s loaded as part of the IDE in Excel, but not in your other application."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1494417116, "post_id": 43891008, "comment_id": 74817252, "body": "Is there some reason you aren&#39;t saying what the &quot;other environment&quot; is?"}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1494418195, "post_id": 43891008, "comment_id": 74818074, "body": "It&#39;s a proprietary application with a developement environment. Since it is something related to work, I&#39;d prefer not to say."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1494418533, "post_id": 43891008, "comment_id": 74818311, "body": "I tried to register using both system32 and SysWOW64 commands, but it says &quot;cannot find entry point&quot;. It is very much likely though, since this is a company computer, that I am not allowed to do that."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1494422197, "post_id": 43891008, "comment_id": 74821328, "body": "Is the other environment (SAX) a 64-bit program? I assume the VBA you were using is 32-bit."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1494424600, "post_id": 43891008, "comment_id": 74823237, "body": "you are correct, 32 bit"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1494604074, "post_id": 43891008, "comment_id": 74915904, "body": "This code suffers pretty heavily from a &quot;failure is not an option&quot; approach.  No way to tell the caller that the filename could not be converted to a float.  And it certainly will fail in a very nasty and undiagnosable way if there is no regex match.  Like it would if the &quot;other environment&quot; passes a BSTR instead of a LPCSTR, the normal marshalling for strings.  Albeit not so likely that it bombs with a std::regex_error exception, you&#39;ll have to post the stack trace to get a better guess.  And document the VS version, early ones had a lot of regex bugs."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1494768726, "post_id": 43891008, "comment_id": 74958977, "body": "All the checks to ensure that there is a file which WILL give a convertable filename have been written in VBA, but thus is not the problem. Nor it is BSTR instead of LPCSTR (I can anyway import a variant and obtain its BstrVal and work with that, which I tried, and got the same error). VS version is the 2010, but, let me stress it again: it worked fine when I tested the same import in Excel."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1494830264, "post_id": 43891008, "comment_id": 74975539, "body": "Sorry, VS version is 2013, not 2010. Toolset is version VS 2013 - Windows XP (v120_xp)"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1494830770, "post_id": 43891008, "comment_id": 74975800, "body": "Does it work if you remove all the function&#39;s code, but just return a fixed float value? If it does, it means the function&#39;s code is failing. I would put a trace at each step."}, {"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 0, "creation_date": 1494831606, "post_id": 43891008, "comment_id": 74976199, "body": "What do you mean? If I just build a function that returns a float, I have no problem or whatsoever. The function code <i>is</i> failing, and exactly at the regex."}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1494940250, "post_id": 43891008, "comment_id": 75033156, "body": "Your other environment may have a memory leak or something like that that breaks the dll function execution,               I recomnd compiling the dll as an ActiveX dll that is COM compliant,      Chances are that it will be more stable integrating with your target environment"}], "answers": [{"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1495181307, "post_id": 44019552, "comment_id": 75153675, "body": "Marshalling your BSTRs into STL strings before working with them sounds right, it is what I do.   <a href=\"http://exceldevelopmentplatform.blogspot.co.uk/2017/02/bstrs-should-be-treated-as-data.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.co.uk/2017/02/&hellip;</a>"}], "tags": [], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "is_accepted": true, "score": 2, "last_activity_date": 1495009955, "creation_date": 1495009955, "answer_id": 44019552, "question_id": 43891008, "link": "https://stackoverflow.com/questions/43891008/dll-function-not-working-in-a-vba-environment-but-working-in-excel-vba/44019552#44019552", "title": "DLL function not working in a VBA environment but working in Excel VBA", "body": "<p>Turns out something was wrong with the string I've been importing. I do not understand what, since when I debugged the program, they looked fine. I solved by importing a <code>SAFEARRAY</code> of strings (which required me to change the whole function and the VBA code as well), whose <code>BSTR</code> value could be accessed as follows:</p>\n\n<pre><code>int _stdcall FilenameSort(LPSAFEARRAY* StringArray)\n{\n    // Fills a vector with the wstring values\n    char** StrPtr = 0;\n    long LowerBound = 0;  SafeArrayGetLBound(*StringArray, 1, &amp;LowerBound);\n    long UpperBound = 0;  SafeArrayGetUBound(*StringArray, 1, &amp;UpperBound);\n    const long Dimension = UpperBound - LowerBound;\n    SafeArrayAccessData(*StringArray, reinterpret_cast&lt;void**&gt;(&amp;StrPtr));\n\n    BSTR element;\n    vector&lt;wstring&gt; wstrArr;\n\n    for (long i = 0; i &lt;= Dimension; ++i)\n    {\n        SafeArrayGetElement(*StringArray, &amp;i, &amp;element);\n        wstring ws(element, SysStringLen(element));\n        wstrArr.push_back(ws);\n    }\n</code></pre>\n\n<p>Having converted all the <code>BSTR</code>s in <code>wstring</code>s correctly, I could work with <code>wregex</code>s without any problem.</p>\n"}], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 44019552, "answer_count": 1, "score": 9, "last_activity_date": 1495009955, "creation_date": 1494415321, "last_edit_date": 1494832371, "question_id": 43891008, "link": "https://stackoverflow.com/questions/43891008/dll-function-not-working-in-a-vba-environment-but-working-in-excel-vba", "title": "DLL function not working in a VBA environment but working in Excel VBA", "body": "<p>I have the following function contained in a DLL I wrote (c++) that I debugged in Excel, and worked just fine:</p>\n\n<pre><code>float _stdcall ReturnT(LPCSTR FileName)\n{\n\n// Extracts the generic language string from the (importing BSTR  \n// would import kanji or whatever) and converts it into a wstring\nwstring str = CA2T(FileName);\n\n// Sets the string to find as _t or _T followed by 2 or 3 digits and a subsequent _ or .\nwregex ToFind(L\"_[tT]\\\\d{2,3}(_|.)\");\nwsmatch TStr;\n\nregex_search(str, TStr, ToFind);    // Now the wsmatch variable contains all the info about the matching\nwstring T = TStr.str(0).erase(0, 2);    // Removes the first 2 characters\nT.erase(T.end() - 1);               // Removes the last character\n\n// Checks if T is 3 digits or not (2 digits) and eventually add a \".\"\nwstring TVal = L\"\";\nif (T.size() == 3)\n{\n    TVal += T.substr(0, 2) + L\".\" + T.substr(2, 3);\n}\nelse if (T.size() == 2)\n{\n    TVal += T;\n}\n\n// Converts T string to a float\nconst float TValue = (float) _wtof(TVal.c_str());\n\nreturn TValue;\n}\n</code></pre>\n\n<p>If <code>FileName</code> is for example <code>foo_T024.lol</code>, this function correctly returns a <code>float</code> (in C++, or <code>Single</code> in VBA) with the value of 2.4 .</p>\n\n<p>I call the function from VBA (both from Excel and the other environment) as:</p>\n\n<pre><code>Private Declare Function ReturnT Lib \"[myDLLname]\" (ByVal FileName As String) As Single\n</code></pre>\n\n<p>If I do the same from the other environment and use the function on the same string, I get an <code>**ERROR**</code> and sadly nothing else, because I can't debug (being this a proprietary application).</p>\n\n<p>What could be the problem?</p>\n\n<p>EDIT: I found out that this other environment is actually <a href=\"http://ftgsoftware.com/manuals/basic32.pdf\" rel=\"noreferrer\">SAX</a>, which is basically identical to VBA.</p>\n\n<p>EDIT: I managed to link Visual Studio with the application, so I could check what's imported and what is wrong. <code>FileName</code> looks correctly imported, (I used also a <code>VARIANT</code>-input approach to see if that was the issue, which it wasn't) but I receive an error at this line:</p>\n\n<pre><code>wregex ToFind(L\"_[tT]\\\\d{2,3}(\\\\_|\\\\.)\");\n</code></pre>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p>Unhandled exception at 0x75F0C54F in NSI2000.exe: Microsoft C++ exception: std::regex_error at memory location 0x0018E294.</p>\n</blockquote>\n\n<p>And it stops by <code>xthrow.cpp</code> at this point:</p>\n\n<pre><code>#if _HAS_EXCEPTIONS\n\n#include &lt;regex&gt;\n\n_STD_BEGIN\n_CRTIMP2_PURE _NO_RETURN(__CLRCALL_PURE_OR_CDECL _Xregex_error(regex_constants::error_type _Code))\n    {   // report a regex_error\n    _THROW_NCEE(regex_error, _Code);\n    }                                     &lt;--- Code stops here\n_STD_END\n #endif /* _HAS_EXCEPTIONS */\n</code></pre>\n\n<p>EDIT: My VS version is 2013, the platformtoolset is the \"Visual Studio 2013 - Windows XP (v120_xp)\". My compiler version is: \"Version 18.00.21005.1 for x64\"</p>\n"}, {"tags": ["vba", "outlook", "outlook-2013"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1494432585, "creation_date": 1494432585, "answer_id": 43897742, "question_id": 43890545, "link": "https://stackoverflow.com/questions/43890545/outlook-fails-to-load-template-images/43897742#43897742", "title": "Outlook Fails to Load Template Images", "body": "<p>You are only copying the message body, but not the attachments (which probably contain the images). </p>\n"}], "owner": {"reputation": 313, "user_id": 2976696, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d48d5affd0f2cf7cae8126cc63316cd?s=128&d=identicon&r=PG", "display_name": "Reginald Greyling", "link": "https://stackoverflow.com/users/2976696/reginald-greyling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593157505, "creation_date": 1494414012, "last_edit_date": 1593157505, "question_id": 43890545, "link": "https://stackoverflow.com/questions/43890545/outlook-fails-to-load-template-images", "title": "Outlook Fails to Load Template Images", "body": "<p>The following code:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n  Dim sName As String\n  Dim otlQuote As Outlook.MailItem\n\n  If InStr(Item.Subject, \"SOQ\") &lt;&gt; 0 Then\n    sName = Item.Body\n    Set otlQuote = Application.CreateItemFromTemplate(Environ(\"AppData\") &amp; \"\\Microsoft\\Templates\\Outlook Templates\\Quotations.oft\")\n    Item.HTMLBody = otlQuote.HTMLBody\n    Item.HTMLBody = Replace(Item.HTMLBody, \"Good day \", \"Good day \" &amp; sName)\n  End If\nEnd Sub\n</code></pre>\n\n<p>Produces images that look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7tL9p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7tL9p.png\" alt=\"FailedImage\"></a></p>\n\n<p>I know why this is happening, it\u2019s because the image is linked and not embedded into the file, but is there any way to resolve this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "edited": false, "score": 1, "creation_date": 1494412177, "post_id": 43889640, "comment_id": 74813555, "body": "Please provide additional information like what code did you execute? Did it fail with an error or expectation was not met?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494415297, "post_id": 43889640, "comment_id": 74815872, "body": "select case may help, <code>select case left(range(&quot;&quot;),3)</code>  what have you tried?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1494415515, "post_id": 43889640, "comment_id": 74816036, "body": "Why do you need to use consecutive loops for this? Also you aren&#39;t doing yourself any favours by keeping your dates in a non recognised excel format"}, {"owner": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494417515, "post_id": 43889640, "comment_id": 74817571, "body": "Forgot to mention I need this in VBA and I am starter level. This is 3rd party excel sheet output so I can&#39;t choose the formatting. Ultimate aim is to find clashing times on each day, up until now I have been able to loop through and find clashing times on all days included, that is not of a much help. Therefore, need to run loop individually for Monday then move on to loop Tuesday and so on..."}, {"owner": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494418494, "post_id": 43889640, "comment_id": 74818278, "body": "Loop for picking cell to compare For rwIndex = 1 To 100             For colIndex = 3 To 25 loop inside to compare with all cells in the sheet For rwIndex_ = 1 To 100                     For colIndex_ = 3 To 25 then highlight the same times - Right(Sheets(&quot;Staff Schedule&quot;).Cells(rwIndex, colIndex).Value, 5) and Right(Sheets(&quot;Staff Schedule&quot;).Cells(rwIndex_, colIndex_).Value, 5)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494512859, "post_id": 43906973, "comment_id": 74869733, "body": "That is some great looking code! The only issue is that my excel does not look exactly as I posted earlier. The first cell with date is always E4 not A1 and with times G4 not C1. In the code I changed the column from A to E and started the column loop from 7 rather than 3. It still misses some duplicates in the process?"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494516012, "post_id": 43906973, "comment_id": 74872408, "body": "Works for the data set I used (based on what you posted).  Only the time is stored as a key - so if, say, &quot;08:45&quot; is in the dictionary then any other entries with this time should get colored as a duplicate.  You could have trailing spaces or something that makes the time strings different from each other.  You&#39;ll have to debug to see why duplicates are being missed.  You can &#39;step into&#39; the code and hit F8 to execute each line by line to see what going on."}, {"owner": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494518427, "post_id": 43906973, "comment_id": 74874101, "body": "It is working now. Next I need to skip some rows depending on text in column C, hopefully should be able insert code. Thank you"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494520432, "post_id": 43906973, "comment_id": 74875359, "body": "If what I&#39;ve posted is the &#39;solution&#39; you should indicate it as such.  This does a couple of things: prioritizes the post for web searches (more visible to others and possibly helps them too), marks it as complete so people that answer questions know that it&#39;s been resolved, and provides up-votes to posters - which will be good for you as well given that people who answer are more likely to review your future questions."}, {"owner": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494601383, "post_id": 43906973, "comment_id": 74914063, "body": "Where do I indicate as this being &quot;solution&quot;?"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494602035, "post_id": 43906973, "comment_id": 74914522, "body": "Click the green outlined checkmark to the left of the answer."}, {"owner": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494934097, "post_id": 43906973, "comment_id": 75028594, "body": "Thanks a lot, please let me know if there is anything I could do, is there any book or website you would recommend for learning Excel VBA?"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "edited": false, "score": 0, "creation_date": 1494947895, "post_id": 43906973, "comment_id": 75039083, "body": "You could start with this (<a href=\"http://www.jlathamsite.com/teach/vba/programminginexcelvba_anintroduction.pdf\" rel=\"nofollow noreferrer\">link</a>).  VBA is huge, so once you&#39;ve got an handle on the basics, it&#39;s really a matter of googling to get what you&#39;re after."}], "tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": true, "score": 0, "last_activity_date": 1494480465, "last_edit_date": 1494480465, "creation_date": 1494479362, "answer_id": 43906973, "question_id": 43889640, "link": "https://stackoverflow.com/questions/43889640/how-to-run-separate-loops-on-set-of-consecutive-rows-in-excel-vba/43906973#43906973", "title": "How to run separate loops on set of consecutive rows in excel vba", "body": "<p>You can use a dictionary to check whether you have duplicate times for a given day.  In total you'll have 3 nested loops: the first to iterate through all the rows in the worksheet, the next to iterate through all the rows of a given day and the last to iterate through the column entries.</p>\n\n<p>It appears that you're not interested in the initial string in each cell (for example 'Res01', 'Res02', etc) but just want to know whether there are identical times for a given day and to highlight both cells of that duplicate.</p>\n\n<p>Also since you only want duplicates within a given day, the dictionary is cleared out when processing is started for that day.  The key of the dictionary is the time string and the value is the address of the cell.  For each cell the macro checks whether that time is already in the dictionary.  If it is then that's a duplicate and both the original cell and the current cell background colors are changed.  If not then the key/value pair is stored and processing continues.</p>\n\n<p>I decided to change the color of background (green/blue) showing duplicates for consecutive days just to make it easier to see the differences.</p>\n\n<pre><code>Option Explicit\n\nSub HighliteDiffs()\n  Dim sht As Worksheet\n  Set sht = Worksheets(\"Staff Schedule\")\n\n  Dim r As Integer, c As Integer, clr As Integer: clr = 4\n  Dim curDay As String, val As String, addr As String\n\n  Dim dict As Object\n  Set dict = CreateObject(\"Scripting.Dictionary\")\n\n  Dim rng As Range\n\n  With sht\n    Dim lastRow As Integer, lastCol As Integer\n    lastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\n    r = 2\n    Do While r &lt;= lastRow\n      If clr = 4 Then\n        clr = 5\n      Else\n        clr = 4\n      End If\n      dict.RemoveAll\n      curDay = Left(Cells(r, \"A\").Value, 11)\n      Do While curDay = Left(Cells(r, \"A\").Value, 11)\n        lastCol = .Cells(r, .Columns.Count).End(xlToLeft).Column\n        For c = 3 To lastCol\n          val = Right(.Cells(r, c).Value, 5)\n          If dict.Exists(val) Then\n            addr = dict(val)\n            Set rng = .Cells(Range(addr).Row, Range(addr).Column)\n            rng.Interior.ColorIndex = clr\n            .Cells(r, c).Interior.ColorIndex = clr\n          Else\n            dict(val) = .Cells(r, c).Address\n          End If\n        Next\n        r = r + 1\n      Loop\n    Loop\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7990896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a448b0174492dcaa376e7305cce22?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/7990896/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 43906973, "answer_count": 1, "score": 0, "last_activity_date": 1494480465, "creation_date": 1494411499, "last_edit_date": 1494413545, "question_id": 43889640, "link": "https://stackoverflow.com/questions/43889640/how-to-run-separate-loops-on-set-of-consecutive-rows-in-excel-vba", "title": "How to run separate loops on set of consecutive rows in excel vba", "body": "<p>I need to run independent loops on different sets of rows depending on value of a column, for e.g. loop for column value \"Monday\" which is repeated from row 1 to n then \"Tuesday\" from n+1 to ~18, these loops need to run consecutively one after another. Example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/2yAbD.png\" alt=\"Example as below\"></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1494412841, "post_id": 43889486, "comment_id": 74813997, "body": "please try to use <code>Application.Wait (Now + TimeValue(&quot;0:00:04&quot;))</code> instead of <code>Do until DoEvent</code> loop..."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1494415183, "post_id": 43889486, "comment_id": 74815776, "body": "add <code>.busy</code> to your ie check"}, {"owner": {"reputation": 11, "user_id": 7216732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c5f4b315dafa2093b622c17c792cd2f?s=128&d=identicon&r=PG&f=1", "display_name": "nidhisha", "link": "https://stackoverflow.com/users/7216732/nidhisha"}, "edited": false, "score": 0, "creation_date": 1494443936, "post_id": 43889486, "comment_id": 74835942, "body": "Application.Wait (Now + TimeValue(&quot;0:00:04&quot;)) worked. Thanks Maddy Nikam. However only the IE window opens but the data is not returned to the sheet. How do i continue to get output on the worksheet? Is there any way i can link the existing IE window to the query table to get the output on the worksheet?"}], "owner": {"reputation": 11, "user_id": 7216732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c5f4b315dafa2093b622c17c792cd2f?s=128&d=identicon&r=PG&f=1", "display_name": "nidhisha", "link": "https://stackoverflow.com/users/7216732/nidhisha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494411115, "creation_date": 1494411115, "question_id": 43889486, "link": "https://stackoverflow.com/questions/43889486/run-time-error-91-while-getting-data-from-password-protected-site-using-vba", "title": "Run-time error 91 while getting data from password protected site using vba", "body": "<p>Below is the piece of code I am using:</p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    With IE\n        .Visible = True\n        .Navigate \"https:......\" \n        Do Until .ReadyState = 4\n            DoEvents\n        Loop\n    .document.all.Item(\"sso_username\").Value = \"username\"\n    .document.all.Item(\"ssopassword\").Value = \"password\"\n    .document.forms(1).submit\n    End With\n\n\n\n   With ActiveSheet.QueryTables.Add(Connection:= _\n   \"URL;https:....\" , Destination:=Range(\"A2\"))\n      .Name = \"q?s=goog_2\"\n      .FieldNames = True\n      .RowNumbers = False\n      .FillAdjacentFormulas = False\n      .PreserveFormatting = True\n      .RefreshOnFileOpen = False\n      .BackgroundQuery = True\n      .RefreshStyle = xlInsertDeleteCells\n      .SavePassword = False\n      .SaveData = True\n      .AdjustColumnWidth = True\n      .RefreshPeriod = 0\n      .WebSelectionType = xlSpecifiedTables\n      .WebFormatting = xlWebFormattingNone\n      .WebTables = \"1,2\"\n      .WebPreFormattedTextToColumns = True\n      .WebConsecutiveDelimitersAsOne = True\n      .WebSingleBlockTextImport = False\n      .WebDisableDateRecognition = False\n      .WebDisableRedirections = False\n      .Refresh BackgroundQuery:=False\n  End With\n</code></pre>\n\n<p>The error is shown for \n  .document.all.Item(\"sso_username\").Value = \"username\"\nCan anybody let me know what i am missing out?</p>\n"}, {"tags": ["ms-access", "vba", "ms-office", "converter"], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1494412198, "creation_date": 1494412198, "answer_id": 43889894, "question_id": 43889435, "link": "https://stackoverflow.com/questions/43889435/convert-mde-file-to-mdb/43889894#43889894", "title": "Convert MDE file to MDB", "body": "<p>It's impossible. MDE is compiled version, forms, reports and code cannot be edited.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7877447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pw2ZC.png?s=128&g=1", "display_name": "LhSandi", "link": "https://stackoverflow.com/users/7877447/lhsandi"}, "edited": false, "score": 0, "creation_date": 1494551719, "post_id": 43891082, "comment_id": 74888741, "body": "Hi Gustav you for your help,but it&#39;s can&#39;t run,with dialog error &quot;:Critical Error&quot;"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1494415492, "creation_date": 1494415492, "answer_id": 43891082, "question_id": 43889435, "link": "https://stackoverflow.com/questions/43889435/convert-mde-file-to-mdb/43891082#43891082", "title": "Convert MDE file to MDB", "body": "<p>You may have a bit of luck with the <a href=\"http://accesstools.narod.ru/\" rel=\"nofollow noreferrer\">MDE forms/reports extractor v1.2</a> tool.</p>\n\n<p>But no code.</p>\n"}, {"tags": [], "owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "is_accepted": false, "score": 1, "last_activity_date": 1494419506, "creation_date": 1494419506, "answer_id": 43892603, "question_id": 43889435, "link": "https://stackoverflow.com/questions/43889435/convert-mde-file-to-mdb/43892603#43892603", "title": "Convert MDE file to MDB", "body": "<p>It is possible. There are services for that.\n<a href=\"http://www.everythingaccess.com/mdeconversion.asp\" rel=\"nofollow noreferrer\">http://www.everythingaccess.com/mdeconversion.asp</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7877447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pw2ZC.png?s=128&g=1", "display_name": "LhSandi", "link": "https://stackoverflow.com/users/7877447/lhsandi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1540, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1494419506, "creation_date": 1494411004, "question_id": 43889435, "link": "https://stackoverflow.com/questions/43889435/convert-mde-file-to-mdb", "title": "Convert MDE file to MDB", "body": "<p>how to convert MDE file to MDB?</p>\n\n<p><a href=\"https://i.stack.imgur.com/W2ryY.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I can't change design the form because design view is disable.\nThank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1494410538, "post_id": 43889069, "comment_id": 74812417, "body": "Please check this <a href=\"https://support.microsoft.com/en-us/help/291308/how-to-select-cells-ranges-by-using-visual-basic-procedures-in-excel\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/291308/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "is_accepted": true, "score": 1, "last_activity_date": 1494411624, "last_edit_date": 1495542381, "creation_date": 1494411624, "answer_id": 43889683, "question_id": 43889069, "link": "https://stackoverflow.com/questions/43889069/point-to-the-excel-sheet-where-the-macro-actually-stored/43889683#43889683", "title": "Point to the Excel sheet where the Macro actually stored", "body": "<p>I have found the answer from <a href=\"https://support.microsoft.com/en-us/help/291308/how-to-select-cells-ranges-by-using-visual-basic-procedures-in-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/291308/how-to-select-cells-ranges-by-using-visual-basic-procedures-in-excel</a></p>\n\n<p>I have just used Workbooks(\"FT_State_update.xlsm\") to point the particular workbook. Thanks to <a href=\"https://stackoverflow.com/users/7889129/maddy-nikam\">Maddy Nikam</a></p>\n"}], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 43889683, "answer_count": 1, "score": 0, "last_activity_date": 1494411624, "creation_date": 1494410071, "last_edit_date": 1531164843, "question_id": 43889069, "link": "https://stackoverflow.com/questions/43889069/point-to-the-excel-sheet-where-the-macro-actually-stored", "title": "Point to the Excel sheet where the Macro actually stored", "body": "<p>I have a sheet named \"State List Generation\" in which I have written a code which can extract City and State list from some text. I wanted to run this macro in another sheet which contains the text. I will be able to run this through macro window of excel if the first file is open. The problem is my state and city list is in the first sheet (State List Generation). When i run the macro from the second sheet which has data, the second sheet becomes the active sheet!!. I am not able to point the first excel where the the actual macro is present. Is there any way??</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1494410869, "post_id": 43888843, "comment_id": 74812658, "body": "what do you mean does not work?"}, {"owner": {"reputation": 35, "user_id": 4389878, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/801590724/picture?type=large", "display_name": "Bosco Tsin", "link": "https://stackoverflow.com/users/4389878/bosco-tsin"}, "reply_to_user": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1494424396, "post_id": 43888843, "comment_id": 74823070, "body": "run time error, it says the SaveAs command cannot find the method or data"}, {"owner": {"reputation": 35, "user_id": 4389878, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/801590724/picture?type=large", "display_name": "Bosco Tsin", "link": "https://stackoverflow.com/users/4389878/bosco-tsin"}, "reply_to_user": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1494424427, "post_id": 43888843, "comment_id": 74823091, "body": "sorry might be bad translation... my excel in my home computer is in traditional chinese..."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4389878, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/801590724/picture?type=large", "display_name": "Bosco Tsin", "link": "https://stackoverflow.com/users/4389878/bosco-tsin"}, "edited": false, "score": 0, "creation_date": 1494487418, "post_id": 43894916, "comment_id": 74851240, "body": "Hello John but it says run time error 1004 as I go to the third line... Any ideas???"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 35, "user_id": 4389878, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/801590724/picture?type=large", "display_name": "Bosco Tsin", "link": "https://stackoverflow.com/users/4389878/bosco-tsin"}, "edited": false, "score": 0, "creation_date": 1494505919, "post_id": 43894916, "comment_id": 74864088, "body": "Did you change the path and file name to your delimited file?  &quot;C:\\Files\\Delimited_File.txt&quot; is valid on my machine.  You must change that to the path and file on your machine.  It must be a valid path and file for this to work."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 35, "user_id": 4389878, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/801590724/picture?type=large", "display_name": "Bosco Tsin", "link": "https://stackoverflow.com/users/4389878/bosco-tsin"}, "edited": false, "score": 0, "creation_date": 1494506157, "post_id": 43894916, "comment_id": 74864252, "body": "I&#39;ve edited the answer to include YOUR path and filenames.  If it doesn&#39;t work then it must be a bad path or file name.  Check it again.  Also, you can no longer save in .xls format from vba- it must be .xlsx"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 35, "user_id": 4389878, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/801590724/picture?type=large", "display_name": "Bosco Tsin", "link": "https://stackoverflow.com/users/4389878/bosco-tsin"}, "edited": false, "score": 0, "creation_date": 1494506827, "post_id": 43894916, "comment_id": 74864806, "body": "I want to retract that.  I found the filetype to save as an .xls file.  It&#39;s in the answer below."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1494506046, "last_edit_date": 1494506046, "creation_date": 1494425289, "answer_id": 43894916, "question_id": 43888843, "link": "https://stackoverflow.com/questions/43888843/convert-delimited-txt-to-xls-with-opentext-in-vba/43894916#43894916", "title": "Convert Delimited TXT to XLS with OpenText in VBA?", "body": "<pre><code>Sub delimitedTXTtoXLS()\n    Dim wb As Workbook\n    Workbooks.OpenText filename:=\"C:\\Users\\boscotsin\\Desktop\\test0.txt\", origin:=xlMSDOS, DataType:=xlDelimited, Tab:=True\n    Set wb = ActiveWorkbook\n    wb.SaveAs filename:=\"C:\\Users\\boscotsin\\Desktop\\success.xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    wb.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1494506981, "creation_date": 1494506981, "answer_id": 43915934, "question_id": 43888843, "link": "https://stackoverflow.com/questions/43888843/convert-delimited-txt-to-xls-with-opentext-in-vba/43915934#43915934", "title": "Convert Delimited TXT to XLS with OpenText in VBA?", "body": "<pre><code>' Excel8\n\nSub delimitedTXTtoXLS2()\n    Dim wb As Workbook\n    Workbooks.OpenText FileName:=\"C:\\Users\\boscotsin\\Desktop\\test0.txt\", origin:=xlMSDOS, DataType:=xlDelimited ', Comma:=True\n    Set wb = ActiveWorkbook\n    wb.SaveAs FileName:=\"C:\\Users\\boscotsin\\Desktop\\success.xlsx\", FileFormat:=56, CreateBackup:=False\n    wb.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4389878, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/801590724/picture?type=large", "display_name": "Bosco Tsin", "link": "https://stackoverflow.com/users/4389878/bosco-tsin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494506981, "creation_date": 1494409494, "last_edit_date": 1531164843, "question_id": 43888843, "link": "https://stackoverflow.com/questions/43888843/convert-delimited-txt-to-xls-with-opentext-in-vba", "title": "Convert Delimited TXT to XLS with OpenText in VBA?", "body": "<p>I would like to convert delimited txt into xls file. I have come up with 2 very simple line of commands which I suppose should work but in reality it didn't. Can anyone tell me what mistakes I have made?</p>\n\n<p>If this work, I am going to loop it with dir for 3000 txt files...</p>\n\n<p>Thanks!</p>\n\n<p>Bosco</p>\n\n<pre><code>Sub ConvertDelimitedTXTtoXLS()\n    Dim wb As Workbooks\n    wb.OpenText Filename:=\"C:\\Users\\boscotsin\\Desktop\\test0.txt\", DataType:=xlDelimited, Tab:=True\n    wb.SaveAs Filename:=\"C:\\Users\\boscotsin\\Desktop\\success.xls\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1494412641, "post_id": 43888842, "comment_id": 74813846, "body": "You need to define <code>Project</code>, I think you meant as a <code>Workbook</code>. So use, <code>Dim Project As Workbook</code> , and then <code>Set Project = ThisWorkbook</code> , or to whatever workbook you want to set it to."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7990859, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/006ed672e4cd9982a7f0d5cde6c1a159?s=128&d=identicon&r=PG&f=1", "display_name": "jabezs09", "link": "https://stackoverflow.com/users/7990859/jabezs09"}, "edited": false, "score": 0, "creation_date": 1494410578, "post_id": 43889085, "comment_id": 74812447, "body": "Thank you so much! I changed it to Project when I was trying to get rid of a previous error. Life saver"}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 0, "last_activity_date": 1494415017, "last_edit_date": 1494415017, "creation_date": 1494410106, "answer_id": 43889085, "question_id": 43888842, "link": "https://stackoverflow.com/questions/43888842/vba-run-time-error-424-when-copying-lines-from-one-page-to-another-if-they-fulf/43889085#43889085", "title": "VBA Run Time Error 424 when copying lines from one page to another (if they fulfil certain criteria)", "body": "<p>you should assign a value to project, remove it or replace it by thisworkbook</p>\n"}], "owner": {"reputation": 1, "user_id": 7990859, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/006ed672e4cd9982a7f0d5cde6c1a159?s=128&d=identicon&r=PG&f=1", "display_name": "jabezs09", "link": "https://stackoverflow.com/users/7990859/jabezs09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494415017, "creation_date": 1494409494, "last_edit_date": 1531164843, "question_id": 43888842, "link": "https://stackoverflow.com/questions/43888842/vba-run-time-error-424-when-copying-lines-from-one-page-to-another-if-they-fulf", "title": "VBA Run Time Error 424 when copying lines from one page to another (if they fulfil certain criteria)", "body": "<p>I am very new to VBA and coding in general, and am completely perplexed\nI need to take Rows from one worksheet to another if they are populated in one column but not another but am getting Run Time Error 424: Object required. It is highlighting the starred area\nHere is my code </p>\n\n<pre><code>Sub CopyRowsAcross()\n\n'Name Worksheets\nDim e As Integer\nDim wsd2 As Worksheet:** Set wsd2 = Project.Sheets(\"DataSheet2\")**\nDim wsBS As Worksheet: Set wsBS = Project.Sheets(\"Budget Summary\")\n\n'Set Criteria for copying lines across\nFor e = 2 To 1776\n    'Headers\n    If IsEmpty(wsd2.Cells(e, 1).Value) = False And IsEmpty(wsd2.Cells(e, 4).Value) = True Then\n        wsd2.Rows(e).Copy wsBS.Rows(wsBS.Cells(wsBS.Rows.Count, 2).End(xlUp).Row + 1)\n    End If\nNext e\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "edited": false, "score": 0, "creation_date": 1494409590, "post_id": 43888780, "comment_id": 74811765, "body": "Aren&#39;t you missing a <code>o As Double</code> decleration ?"}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "reply_to_user": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "edited": false, "score": 0, "creation_date": 1494409678, "post_id": 43888780, "comment_id": 74811823, "body": "Its not giving an error on compilation so i assume it is done implicitly while executing for loop..."}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "reply_to_user": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "edited": false, "score": 0, "creation_date": 1494409742, "post_id": 43888780, "comment_id": 74811872, "body": "much like i and j"}, {"owner": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "edited": false, "score": 0, "creation_date": 1494409829, "post_id": 43888780, "comment_id": 74811932, "body": "ok neshama. im still checking this."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1494413115, "post_id": 43888780, "comment_id": 74814184, "body": "Add <code>Option Explicit</code> to the top of your module.  When you compile, it will highlight any undeclared variables.  Repeat until you get a clean compile."}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "edited": false, "score": 0, "creation_date": 1494413500, "post_id": 43888780, "comment_id": 74814490, "body": "The compile is actually clean there is no error on compile. The output is garbage... There seems to be some error in the logic i have built for achieving my objective..."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "is_accepted": true, "score": 0, "last_activity_date": 1494654003, "last_edit_date": 1494654003, "creation_date": 1494563177, "answer_id": 43929286, "question_id": 43888780, "link": "https://stackoverflow.com/questions/43888780/logical-error-in-my-code/43929286#43929286", "title": "Logical Error in my code", "body": "<p>I went ahead and pushed this myself with this.</p>\n\n<p>Realized there were multiple mistakes:</p>\n\n<ol>\n<li><p>I had to initialize the new column to 0. That I missed. Changed column from 7 to 6 due to some reasons.</p></li>\n<li><p>I did not exit the main for-loop when the criteria was reached due to which the process went on even after the process was supposed to be complete. Used the Boolean variable flag for this.</p></li>\n<li><p>While counting for the iterations involving the repetition of the value given by small function, the variable \"l\" was counted one +1. Made suitable adjustments. (Changed column from 50 to 500 due to some reason)</p></li>\n<li><p>I observed that Excel was not updating the calculated valued by itself, so included Application.Calculate function at the beginning.</p></li>\n</ol>\n\n<p>Here is the working code:</p>\n\n<pre><code>Application.Calculate\nDim m As Range, cl As Range, k As Double, b As Double, lIndex As Double, a As Double, multi As Double, l As Double, x As Double, Check As Double, flag As Boolean\n    l = 2\n    Set m = ActiveSheet.Range(\"E3:E40\")\n    multi = 2                                                             'To move to starting position of the data set\n    flag = False\n\n    For i = 1 To 172\n\n        b = 45 + 43 * (i - 1)\n        Cells(b, 6).Value = 0\n\n        For p = 3 To 40\n\n            Cells(p + ((i - 1) * 43), 6).Value = 0                               'Initializing to column no. 6 to 0\n\n        Next p\n\n        For k = 1 To 38\n\n            If flag = True Then\n            flag = 0\n            Exit For\n            End If\n\n            If k + l - 2 &lt;= 38 Then\n                a = Application.Small(m, (k + l - 2))\n                k = k + l - 2\n            Else\n                Exit For\n            End If\n\n            l = 1\n\n            For j = 1 To 38\n\n                Cells(j, 500).Value = 0                                     'Initializing to column no. 500 to 0\n\n                If Cells(j + multi, 5).Value = a Then                      'Checking for match\n                    Cells(l, 500).Value = j + multi                         'Storing Row coordinates in column no. 500\n                    l = l + 1\n                End If\n\n            Next j\n\n            For o = 1 To l - 1\n\n                x = Cells(o, 500).Value\n                Cells(x, 6).Value = 0\n                Cells(b, 6).Value = Cells(b, 6).Value + Cells(x, 2).Value\n                Check = Cells(b, 6).Value\n                If Cells(b, 6).Value &lt;= Cells(b, 1).Value Then             'Checking whether sum of the column is less than or equal to sum of first column of set\n                    Cells(x, 6).Value = Cells(x, 2).Value\n                Else:\n                    Cells(x, 6).Value = Cells(b, 1).Value - (Cells(b, 6).Value - Cells(x, 2).Value)\n                    Cells(b, 6).Value = Cells(b, 6).Value - Cells(x, 2).Value + Cells(x, 6).Value\n                    flag = True\n                Exit For\n                End If\n\n            Next o\n\n        Next k\n\n        Set m = m.Offset(43)\n        multi = multi + 43\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 43929286, "answer_count": 1, "score": -2, "last_activity_date": 1494654003, "creation_date": 1494409271, "last_edit_date": 1531161705, "question_id": 43888780, "link": "https://stackoverflow.com/questions/43888780/logical-error-in-my-code", "title": "Logical Error in my code", "body": "<p>I have written the code below in which I have to first identify smallest, 2nd smallest and so on numbers and then obtain the row numbers for them (I am saving the row numbers in a separate column, here column 50, in case there are more than one such number) and copy contents from one column (Here column 2) to another (Here Column 7) in the order of the row numbers, i.e. Smallest first, then 2nd smallest, and so on.</p>\n\n<p><strong>There are 172 such data sets starting at every 43 rows</strong></p>\n\n<p><strong>This will continue till the sum of the numbers in the new column (45 row of Column 7 of each dataset) (To which the data is copied) is less than a specified number (45 row of Column 1 in every data set, i.e., A45 then A88)</strong></p>\n\n<p><strong>EDIT: The sums being compared above, i.e. G45 is compared to A45 is through formula in the sheet itself</strong></p>\n\n<pre><code>Dim m As Range, cl As Range, k As Double, b As Double, lIndex As Double, a As Double, multi As Double, l As Integer, x As Double\n\nSet m = ActiveSheet.Range(\"E3:E40\")\nmulti = 2                                                              'To move to starting position of the data set\n\nFor i = 1 To 172\n    b = 45 + 43 * (i - 1)\n\n    For k = 1 To 38\n        a = Application.Small(m, k) 'To find the kth smallest number\n        l = 1\n        For j = 1 To 38             'To store the matching row numbers (Multiple instances) in column 50\n                Cells(j, 50).Value = 0                                     'Initializing to column no. 50 to 0\n                If Cells(j + multi, 5).Value = a Then                      'Checking for match\n                    Cells(l, 50).Value = j + multi                         'Storing Row coordinates in column no. 50\n                    l = l + 1\n                End If\n            Next j\n\n '==============THE FOLLOWING IS THE AREA WHERE THE PROBLEM MIGHT BE====================== \n\n\n        For o = 1 To l - 1 'To Copy the values based on the criteria\n            x = Cells(o, 50).Value\n            If Cells(b, 7).Value &lt;= Cells(b, 1).Value Then             '\"CRITERIA\" Checking whether sum of the column is less than or equal to sum of first column of set\n                Cells(x, 7).Value = Cells(x, 2).Value\n            End If\n        Next o\n\n    Next k\n\n    Set m = m.Offset(43)\n    multi = multi + 43\nNext i\n</code></pre>\n\n<p>The problem is that the condition for copying copy (The sum should be less than certain value) is not working. It actually copies all the data from column 2 to column 7.</p>\n\n<p>Can someone help in finding what might be the reason for this...</p>\n\n<p><strong>NOTE: I checked and confirmed that the code to store row numbers in column 50 is working fine. So the problem might be in the lower half of the code which is the for loop with variable \"o\"</strong></p>\n"}, {"tags": ["vba", "excel", "range"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7990843, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154512129651935/picture?type=large", "display_name": "Wouter Slechten", "link": "https://stackoverflow.com/users/7990843/wouter-slechten"}, "edited": false, "score": 0, "creation_date": 1494409662, "post_id": 43888826, "comment_id": 74811809, "body": "Thanks for the quick response, I was completely oblivious to the offset command. Fixed it by using that command now, however still using .Value as it is not intented to add up values, but only use both of them in a different calculation. Many thanks!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 7990843, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154512129651935/picture?type=large", "display_name": "Wouter Slechten", "link": "https://stackoverflow.com/users/7990843/wouter-slechten"}, "edited": false, "score": 0, "creation_date": 1494416685, "post_id": 43888826, "comment_id": 74816919, "body": "@WouterSlechten <code>.value2</code> is exactly like <code>.value</code> unless the value is a date or a currency. It is only a matter of good practice to prefer <code>.Value2</code> for fetching from Excel to VBA."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1494409421, "creation_date": 1494409421, "answer_id": 43888826, "question_id": 43888729, "link": "https://stackoverflow.com/questions/43888729/trying-to-get-a-value-from-a-column-right-to-my-selected-cell-as-the-values-are/43888826#43888826", "title": "Trying to get a value from a column right to my selected cell (as the values are coorelated)", "body": "<blockquote>\n<pre><code>currentChimneyDiameter = cell(cell.Row, cell.Column + 1).Value\n</code></pre>\n</blockquote>\n\n<p>This will not get you the next cell, but a cell that is <em>very far away</em> from your <code>cell</code>. If will <code>offset</code> your <code>cell</code> by <code>(cell.Row, cell.Column + 1)</code>. To get just the next cell, use instead of the above:</p>\n\n<pre><code>currentChimneyDiameter = cell.offset(0 ,1).Value2\n'                            ^^^^^^^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7990843, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154512129651935/picture?type=large", "display_name": "Wouter Slechten", "link": "https://stackoverflow.com/users/7990843/wouter-slechten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494432099, "creation_date": 1494409112, "last_edit_date": 1531164843, "question_id": 43888729, "link": "https://stackoverflow.com/questions/43888729/trying-to-get-a-value-from-a-column-right-to-my-selected-cell-as-the-values-are", "title": "Trying to get a value from a column right to my selected cell (as the values are coorelated)", "body": "<p>I'm trying to run through cells in a range (which works fine as I use it in a different macro as well), but now I also need the value at the right of it to use this value in my calculations, however it seems to not run through it as intended. Any help or advice is welcome, I'm pretty novice at coding. </p>\n\n<pre><code>For Each cell In rng\n    currentChimneyHeight = cell.Value\n    currentChimneyDiameter = cell(cell.Row, cell.Column + 1).Value\n    Worksheets(\"Stab-klasse\").Range(\"C27\") = currentChimneyDiameter\n    Worksheets(\"Stab-klasse\").Range(\"C26\") = currentChimneyHeight\n    Worksheets(\"Dosis en depositie\").Range(\"B7:B28\").Copy\n    Worksheets(\"Variatie Schouw\").Range(Cells(7, currentCollumn), Cells(28, currentCollumn)).PasteSpecial xlPasteValues\n    Worksheets(\"Dosis en depositie\").Range(\"E7:E28\").Copy\n    Worksheets(\"Variatie Schouw\").Range(Cells(7, currentCollumn + 1), Cells(28, currentCollumn + 1)).PasteSpecial xlPasteValues\n    Cells(6, currentCollumn) = currentChimneyHeight\n    Cells(6, currentCollumn + 1) = currentChimneyDiameter\n    currentCollumn = currentCollumn + 2\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox", "userform"], "answers": [{"tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": true, "score": 0, "last_activity_date": 1494410746, "creation_date": 1494410746, "answer_id": 43889330, "question_id": 43888432, "link": "https://stackoverflow.com/questions/43888432/userform-checkbox-send-text-to-spreadsheet/43889330#43889330", "title": "Userform checkbox send text to spreadsheet", "body": "<p>add the following to savedata</p>\n\n<pre><code>Case \"O\"\nif c.value then\n worksheets(\"Data\").range(c.tag &amp; this.row)=\"Absent\"\n c.value=false\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7990282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90de55b155242612e5ede8db61b9f81?s=128&d=identicon&r=PG&f=1", "display_name": "James7584", "link": "https://stackoverflow.com/users/7990282/james7584"}, "is_accepted": false, "score": 0, "last_activity_date": 1494429831, "creation_date": 1494429831, "answer_id": 43896747, "question_id": 43888432, "link": "https://stackoverflow.com/questions/43888432/userform-checkbox-send-text-to-spreadsheet/43896747#43896747", "title": "Userform checkbox send text to spreadsheet", "body": "<p>Ok, your input was very helpful. I also needed to declare it under 'Initialise' which I've done now. Problem solved. </p>\n"}], "owner": {"reputation": 3, "user_id": 7990282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90de55b155242612e5ede8db61b9f81?s=128&d=identicon&r=PG&f=1", "display_name": "James7584", "link": "https://stackoverflow.com/users/7990282/james7584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 43889330, "answer_count": 2, "score": 0, "last_activity_date": 1494429831, "creation_date": 1494408248, "question_id": 43888432, "link": "https://stackoverflow.com/questions/43888432/userform-checkbox-send-text-to-spreadsheet", "title": "Userform checkbox send text to spreadsheet", "body": "<p>I am trying to get a checkbox1  to populate the phrases 'Absent' within the next free row when the checkbox is ticked, and within Column O, when a command button submits the userform to the spreadsheet.</p>\n\n<p>The code below is for my 'submit' command button, which works well with no issues. How would I incorporate the <strong>checkbox please to add 'absent'</strong> into the exact same row as the other information that is currently being added?</p>\n\n<p>Also, I would like the checkbox to be able to <strong>revert back to its 'unchecked'</strong> state upon the form being submitted.</p>\n\n<p>Any help is much appreciated. </p>\n\n<p>The command button  submit code is:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nSet ThisRow = Range(\"A\" &amp; Rows.Count).End(xlUp)\nIf ThisRow.Row = 1 Then\nMe.TextBox1 = 1\nElse\nMe.TextBox1 = ThisRow.Row + 1   \nEnd If\n\nMe.TextBox2.Value = Now\nSet ThisRow = ThisRow.Offset(1)\nSaveData\nEnd Sub\n</code></pre>\n\n<p>Saving the data to spreadsheet:</p>\n\n<pre><code>Private Sub SaveData()\nDim C As MSForms.Control\nDim varValue As Variant    'Must be variant to accept different types of data\n\nFor Each C In Me.Controls\n    If C.Tag &lt;&gt; \"\" Then\n        varValue = C.Value\n        Select Case C.Tag\n                 Case \"A\", \"D\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\"\n                Worksheets(\"Data\").Range(C.Tag &amp; ThisRow.Row) = varValue\n\n\n            Case \"B\", \"C\", \"E\"\n                If IsDate(varValue) Then\n                    Worksheets(\"Data\").Range(C.Tag &amp; ThisRow.Row) = CDate(varValue)\n                End If\n\n        End Select\n</code></pre>\n\n<p>The initialise code is:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nMe.listDate.ListIndex = -1\nlistOwner.ListIndex = 0\n\nMe.listOwner.Tag = \"D\"\nMe.listDate.Tag = \"E\"\n\nMe.listEmployee.Tag = \"F\n</code></pre>\n\n<p>etc etc etc and so on </p>\n"}, {"tags": ["vba", "performance", "excel", "optimization"], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 1, "creation_date": 1494407185, "post_id": 43887599, "comment_id": 74810042, "body": "WOW no comment ! It takes less than a second now ! I&#39;ll just have to adapt the index. Thanks a lot :)"}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 4, "creation_date": 1494408397, "post_id": 43887599, "comment_id": 74810939, "body": "I would also suggest using <code>Split()</code> instead of looping thru string."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1494423069, "post_id": 43887599, "comment_id": 74822024, "body": "Would there be a way to store for each row (without a second loop) the <code>Split()</code> range (which is a 1-D array) in the second dimension of the result array ? So something like this : <code>result(i-1,:)= Split(Cells(i,1),&quot;;&quot;)</code> ? Or would I need a loop to store each element 1 by 1 ? (&quot; : &quot; means all elements...but unvalid in VBA I fear)"}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1494425057, "post_id": 43887599, "comment_id": 74823600, "body": "@Seb You need a loop. <code>tempArray = Split(...)</code> and then loop from <code>LBound(TempArray) To UBound(TempArray)</code> or something like that."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1494425646, "post_id": 43887599, "comment_id": 74824098, "body": "OK thanks. I was just wondering if we could avoid this second loop, so basically it&#39;s impossible to store a 1-D array at a given emplacement of a 2-D array. We HAVE TO do it element by element interesting..."}], "tags": [], "owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "is_accepted": true, "score": 4, "last_activity_date": 1494406036, "creation_date": 1494406036, "answer_id": 43887599, "question_id": 43887503, "link": "https://stackoverflow.com/questions/43887503/performance-optimisation/43887599#43887599", "title": "Performance Optimisation", "body": "<p>You should see a significant boost in performance by storing the data in an array, operating on the array, and storing the data back into the spreadsheet.</p>\n\n<p>Something like:</p>\n\n<pre><code>Dim data As Variant\nDim result As Variant\n\ndata = Range(Cells(2, 1), Cells(Row_Number, 1))\nRedim result (1 To Row_Number, 1 To 7) As Variant\n</code></pre>\n\n<p>Now instead of reading from <code>Cells(i, 1)</code>, you read from <code>data(i, 1)</code> and instead of writing to <code>Cells(i, n)</code> you write to <code>result(i, n)</code>.</p>\n\n<p>And at the end of your code:</p>\n\n<pre><code>Range(Cells(2, 1), Cells(Row_Number, 7)) = result\n</code></pre>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 43887599, "answer_count": 1, "score": 1, "last_activity_date": 1494406036, "creation_date": 1494405785, "question_id": 43887503, "link": "https://stackoverflow.com/questions/43887503/performance-optimisation", "title": "Performance Optimisation", "body": "<p>I have this bit of my code which takes like 90 % of the runtime.</p>\n\n<p>There are about 8000 rows and information are stored in column A. This bit of code is splitting this information in the other columns.\nIt takes approximately 15 mins to run ( :O ).\nAny suggestions on how to improve the performance ?</p>\n\n<pre><code>For i = 2 To Row_Number ' Loop for each row\n\n    If InStr(Cells(i, 1), \"//\") = 0 Then ' This means that if // appears somewhere in the text we delete all the rows (including this one) (see Else :) and stop the loop\n        j = 1\n        Do Until Mid(Cells(i, 1), j, 1) = \";\"\n            j = j + 1\n        Loop\n        LongVIN = Mid(Cells(i, 1), 1, j - 1)\n        k = j\n        j = j + 1\n        Do Until Mid(Cells(i, 1), j, 1) = \";\"\n            j = j + 1\n        Loop\n        Cells(i, 3) = Mid(Cells(i, 1), k + 1, j - k - 1) ' Model\n        k = j\n        j = j + 1\n        Do Until Mid(Cells(i, 1), j, 1) = \";\"\n            j = j + 1\n        Loop\n        Cells(i, 4) = Mid(Cells(i, 1), k + 1, j - k - 1) ' Dealer\n        k = j\n        j = j + 1\n        Do Until Mid(Cells(i, 1), j, 1) = \";\"\n            j = j + 1\n        Loop\n\n        k = j\n        j = j + 1\n        Do Until Mid(Cells(i, 1), j, 1) = \";\"\n            j = j + 1\n        Loop\n        Cells(i, 6) = Mid(Cells(i, 1), k + 1, j - k - 1) ' Region\n\n        k = j\n        j = j + 1\n        Do Until Mid(Cells(i, 1), j, 1) = \";\"\n            j = j + 1\n        Loop\n        Cells(i, 7) = CDate(Mid(Cells(i, 1), k + 1, j - k - 1)) ' Retail Date\n        k = j\n\n        Cells(i, 5) = Mid(Cells(i, 1), k + 1, Len(Cells(i, 1)) - k) '(Len - (k+1) +1) Dealer Name\n\n        Cells(i, 1) = Mid(LongVIN, 1, 10)\n        Cells(i, 2) = Mid(LongVIN, 11, 7)\n\n    Else:\n        Range(\"A\" &amp; i &amp; \":A\" &amp; Row_Number).Delete 'ClearContents\n        Exit For\n\n    End If\n\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1494407528, "post_id": 43887258, "comment_id": 74810286, "body": "can please post exact excel formula?...and for setting <code>Cells(i, j) = 0</code> you can simply use <code>If IsError(Cells(i, j)) Then Cells(i, j) = 0  End If</code>"}, {"owner": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1494408162, "post_id": 43887258, "comment_id": 74810766, "body": "@MaddyNikam pls see the update"}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494411606, "post_id": 43888718, "comment_id": 74813166, "body": "another problem is when there is no corresponding value, how to set as 0? Lookup may choose the last value."}, {"owner": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494411885, "post_id": 43888718, "comment_id": 74813342, "body": "pls see the update, so we can replace <code>&quot; &amp; _cell_i &amp; &quot;</code> by <code>cell_i </code> in your code?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494416507, "post_id": 43888718, "comment_id": 74816776, "body": "@A.Oreo not sure I understand, but if you mean you want to use the literal <code>I28</code> instead of a variable cell_i, then yes you can do that."}, {"owner": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494421356, "post_id": 43888718, "comment_id": 74820620, "body": "how to set 0 to the no corresponding value\uff1f"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494422072, "post_id": 43888718, "comment_id": 74821237, "body": "@A.Oreo see the additional edit. You basically enclose the initial formula with <code>IFERROR(myformula, 0)</code>."}, {"owner": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494422846, "post_id": 43888718, "comment_id": 74821846, "body": "@but if <code>Lookup</code> do not find the effective one, it may choose the last one in the array, so I think we can not use <code>IFERROR</code> here"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494423347, "post_id": 43888718, "comment_id": 74822238, "body": "@A.Oreo if not match occurs your formula <i>does</i> return an error code, according to my tests."}, {"owner": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494423459, "post_id": 43888718, "comment_id": 74822328, "body": "yes, so the non-matching value will not be zero, that isn&#39;t I want"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "edited": false, "score": 0, "creation_date": 1494423894, "post_id": 43888718, "comment_id": 74822685, "body": "@A.Oreo But then using Excel&#39;s <code>IFERROR</code> or VBA&#39;s <code>If IsError</code> will do the job."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1494422359, "last_edit_date": 1494422359, "creation_date": 1494409072, "answer_id": 43888718, "question_id": 43887258, "link": "https://stackoverflow.com/questions/43887258/two-criteria-of-lookup-in-vba/43888718#43888718", "title": "two criteria of lookup in vba", "body": "<blockquote>\n<pre><code>(cell_i = ThisWorkbook.Sheets(\"MV_Backtest\").Columns(\"A:A\")) * (cell_j = ThisWorkbook.Sheets(\"MV_Backtest\").Columns(\"B:B\"))\n</code></pre>\n</blockquote>\n\n<p>While the above code looks correct for an Excel formula, it is not valid <strong>VBA</strong>. In Excel it generates and multiples two arrays, but you cannot generate an array like that in VBA (VBA does not allow array multiplication, array comparison, etc).</p>\n\n<p>If you have a valid Excel formula, you can let Excel evaluate it then get the result. Two ways to do that:</p>\n\n<p>1- Using <code>Application.Evaluate</code>:</p>\n\n<pre><code>Cells(i, j).value = Application.Evaluate(\"=Lookup(1,0/((\" &amp; cell_i &amp; _\n    \"= MV_Backtest!A:A) * (\" &amp; cell_j &amp;_\n    \"=MV_Backtest!B:B)), MV_Backtest!C:C)\")\n</code></pre>\n\n<p>2- Using <code>.Formula</code></p>\n\n<pre><code>Cells(i, j).Formula = \"=Lookup(1,0/((\" &amp; _\n  cell_i &amp; \"=MV_Backtest!A:A) * (\" &amp; _\n  cell_j &amp; \"=MV_Backtest!B:B)), MV_Backtest!C:C)\"\n</code></pre>\n\n<p>If you want after then to fix the value and remove the formula, you can:</p>\n\n<pre><code>Cells(i, j).Value = Cells(i, j).Value2\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>To set a cell to zero when no match exists, the usual way is the enclose the formula with <code>IFERROR(myformula, 0)</code>. Hence, for example:</p>\n\n<pre><code> Cells(i, j).value = Application.Evaluate(\"=IFERROR(Lookup(1,0/((\" &amp; cell_i &amp; _\n    \"= MV_Backtest!A:A) * (\" &amp; cell_j &amp;_\n    \"=MV_Backtest!B:B)), MV_Backtest!C:C)), 0\")\n</code></pre>\n\n<p>Or, you can check (in VBA) if the resulting value of the <em>initial formula</em> is an error code. i.e.</p>\n\n<pre><code>If IsError(Cells(i, j).Value) Then Cells(i, j).Value = 0\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 6764740, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38e71edbd8fae17b7957b01a807530d6?s=128&d=identicon&r=PG&f=1", "display_name": "A.Oreo", "link": "https://stackoverflow.com/users/6764740/a-oreo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2915, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494422359, "creation_date": 1494404959, "last_edit_date": 1494411822, "question_id": 43887258, "link": "https://stackoverflow.com/questions/43887258/two-criteria-of-lookup-in-vba", "title": "two criteria of lookup in vba", "body": "<p>I want to lookup the value in <code>Columns C</code> of Sheets(\"MV_Backtest\") s.t cell_i match <code>Columns A</code>, cell_j match <code>Columns B</code>, here is the code:</p>\n\n<pre><code>Sub Matrix()\n  lastRow = ThisWorkbook.Sheets(\"Sheet2\").Cells(Rows.Count, 2).End(xlUp).Row\n  lastColumn = ThisWorkbook.Sheets(\"Sheet2\").Cells(1, \n  Columns.Count).End(xlToLeft).Column\n\n  For i = 2 To lastRow\n    For j = 3 To lastColumn\n      cell_i = ThisWorkbook.Sheets(\"Sheet2\").Cells(i, 2)\n      cell_j = ThisWorkbook.Sheets(\"Sheet2\").Cells(1, j)\n      Cells(i, j) = Application.WorksheetFunction.Lookup(1, 0 / (cell_i = \n      ThisWorkbook.Sheets(\"MV_Backtest\").Columns(\"A:A\")) * (cell_j = \n      ThisWorkbook.Sheets(\"MV_Backtest\").Columns(\"B:B\")), \n      ThisWorkbook.Sheets(\"MV_Backtest\").Columns(\"C:C\"))\n    Next j\n  Next i\nEnd Sub\n</code></pre>\n\n<p>Note that each value in one column may not unique, but combining two values, it is unique.</p>\n\n<p>It's ok in the Excel but there is something wrong here?</p>\n\n<p>By the way, how  could I set <code>Cells(i, j) = 0</code> when neither of two conditions match.</p>\n\n<p>Here is the Excel formula:</p>\n\n<pre><code>=LOOKUP(1,0/(I28=I20:I22)*(J28=J20:J22),K20:K22)\n</code></pre>\n\n<p><code>cell_i</code>  is <code>I28</code>, <code>I20:I22</code> is <code>Columns A</code>, <code>cell_j</code>  is <code>J28</code>, <code>J20:J22</code> is <code>Columns B</code>, <code>K20:K22</code>  is <code>Columns C</code>.</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1494418114, "last_edit_date": 1494418114, "creation_date": 1494407388, "answer_id": 43888106, "question_id": 43886347, "link": "https://stackoverflow.com/questions/43886347/intercept-email-before-sent-by-pastel/43888106#43888106", "title": "Intercept Email Before Sent by Pastel", "body": "<p><em>Remove everything and try just the following code, make sure to restart Outlook before testing</em></p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    Dim prompt As String\n\n    prompt = \"Are you sure you want to send \" &amp; Item.subject &amp; \"?\"\n\n    If MsgBox(prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1494433061, "creation_date": 1494433061, "answer_id": 43897895, "question_id": 43886347, "link": "https://stackoverflow.com/questions/43886347/intercept-email-before-sent-by-pastel/43897895#43897895", "title": "Intercept Email Before Sent by Pastel", "body": "<p>If you use this format, you have to run Initialize_Handler.</p>\n\n<p>If you wish, instead of running it manually, you could do this when Outlook starts.</p>\n\n<p>In the ThisOutlookSession module.</p>\n\n<pre><code>Private Sub Application_Startup\n    Initialize_Handler\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 2976696, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d48d5affd0f2cf7cae8126cc63316cd?s=128&d=identicon&r=PG", "display_name": "Reginald Greyling", "link": "https://stackoverflow.com/users/2976696/reginald-greyling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 43888106, "answer_count": 2, "score": 1, "last_activity_date": 1608878688, "creation_date": 1494402147, "last_edit_date": 1608878688, "question_id": 43886347, "link": "https://stackoverflow.com/questions/43886347/intercept-email-before-sent-by-pastel", "title": "Intercept Email Before Sent by Pastel", "body": "<p>Sage Pastel Evolution is unable to send emails in HTML format.</p>\n<p>I am trying to intercept email before it is sent, add information to the subject and body in HTML format.</p>\n<p>I placed the following in the <code>ThisOutlookSession</code> module:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n    \nPublic WithEvents myOlApp As Outlook.Application\n    \nPublic Sub Initialize_Handler()\n    Set myOlApp = Outlook.Application\nEnd Sub\n    \nPrivate Sub myOlApp_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    Dim sPrompt As String\n      \n    sPrompt = &quot;Are you sure you want to send &quot; &amp; Item.Subject &amp; &quot;?&quot;\n    If MsgBox(sPrompt, vbYesNo + vbQuestion, &quot;Sample&quot;) = vbNo Then\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n<p>Nothing seems to be happening when I send an email, neither through Evolution nor through Outlook.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1494402218, "post_id": 43886223, "comment_id": 74806948, "body": "Your post says column &quot;G&quot;, but your code has column &quot;A&quot;, so which one do you want ?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1494402393, "creation_date": 1494402393, "answer_id": 43886407, "question_id": 43886223, "link": "https://stackoverflow.com/questions/43886223/macro-to-clear-contents-including-format-in-a-column/43886407#43886407", "title": "Macro to clear contents including format in a column", "body": "<p>The code below will <code>ClearContents</code> and <code>ClearFormats</code> from column \"G\" (starting from \"G3\" until last row with data in column \"G\") </p>\n\n<pre><code>Sub ClearData()\n\nWith Range(\"G3:G\" &amp; Cells(Rows.Count, \"G\").End(xlUp).Row)\n    .ClearContents\n    .ClearFormats\nEnd With\nMsgBox \"Data Cleared\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 43886407, "answer_count": 1, "score": 0, "last_activity_date": 1494407542, "creation_date": 1494401742, "last_edit_date": 1531164843, "question_id": 43886223, "link": "https://stackoverflow.com/questions/43886223/macro-to-clear-contents-including-format-in-a-column", "title": "Macro to clear contents including format in a column", "body": "<p>I want to clear contents including format in column G till the last data in the column. Note column G also has some empty cells in between. I used below code it works fine but it clears data from all columns. Please any help will be appreciated.</p>\n\n<pre><code>Sub ClearData()\nRange(\"A3\", Columns(\"A\").SpecialCells(xlCellTypeLastCell)).Clear\nMsgBox (\"Data Cleared\")\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "edited": false, "score": 0, "creation_date": 1494399513, "post_id": 43884964, "comment_id": 74805230, "body": "The <code>vlookup</code> formula is the answer here. You can certainly use vlookup in VBA too, but there&#39;s probably no need. Spend a little time getting familiar with it in formula form."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7989865, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hcNAGJk-Mzk/AAAAAAAAAAI/AAAAAAAAAGk/K4fvpXiCuJY/photo.jpg?sz=128", "display_name": "soroush tehrani", "link": "https://stackoverflow.com/users/7989865/soroush-tehrani"}, "edited": false, "score": 0, "creation_date": 1494460974, "post_id": 43891951, "comment_id": 74842750, "body": "I need a macro! It is another workbook which goes to a worksheet in another workbook and do the job! It will be something similar to the code that I have posted."}], "tags": [], "owner": {"reputation": 342, "user_id": 7936219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd360b71441219f8ecaf3b3481aa0a51?s=128&d=identicon&r=PG&f=1", "display_name": "Jorvik77", "link": "https://stackoverflow.com/users/7936219/jorvik77"}, "is_accepted": false, "score": 0, "last_activity_date": 1494417775, "creation_date": 1494417775, "answer_id": 43891951, "question_id": 43884964, "link": "https://stackoverflow.com/questions/43884964/vba-codes-for-excel-find-a-cells-value-in-another-workbook-and-copy-adjacent-ce/43891951#43891951", "title": "VBA codes for Excel- Find a cells value in another workbook and copy adjacent cell to the first workbook", "body": "<p>You can use INDEX and MATCH.</p>\n\n<p><a href=\"https://i.stack.imgur.com/txfa7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/txfa7.png\" alt=\"enter image description here\"></a></p>\n\n<p>In this case, the value in cell E2 is matched against values in B2 to B6. This is then indexed against column C and the value in column C is returned.</p>\n\n<p>*ignore the typo for \"mammal\"!</p>\n"}], "owner": {"reputation": 1, "user_id": 7989865, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hcNAGJk-Mzk/AAAAAAAAAAI/AAAAAAAAAGk/K4fvpXiCuJY/photo.jpg?sz=128", "display_name": "soroush tehrani", "link": "https://stackoverflow.com/users/7989865/soroush-tehrani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494493457, "creation_date": 1494397531, "last_edit_date": 1531161705, "question_id": 43884964, "link": "https://stackoverflow.com/questions/43884964/vba-codes-for-excel-find-a-cells-value-in-another-workbook-and-copy-adjacent-ce", "title": "VBA codes for Excel- Find a cells value in another workbook and copy adjacent cell to the first workbook", "body": "<p>I have a quick question; I have two workbooks, let's say wbk1 and wbk2; What I am trying to do is finding each cell value of a column in wbk1 in a specific column of wbk2 and return offset cell value from wbk2 to adjacent cell of the searched value in wbk1.</p>\n\n<p>Is there any one who can help?\nBy the way, I could find following code if it helps;\n'=================</p>\n\n<pre><code>Sub find1()\n\nDim Key\nDim Target\nDim Hnum\nDim Success\nDim wbk As Workbook\nDim Lastrow As Long\nDim one As Long\n\nSuccess = False\nApplication.ScreenUpdating = False\n\nstrSecondFile = \"C:\\Soroush\\08- Technical\\03- Stock\\Test\\PL_Test_01\\PL_Test_01.xlsm\"\nstrFrthFile = \"C:\\Soroush\\08- Technical\\03- Stock\\CNC_Test.xlsx\"\n'==\n\n Sheets(\"sheet2\").Select\n\n    Lastrow = ActiveSheet.UsedRange.Rows.Count\n\n    If Not IsEmpty(Cells(5, 9).Value) Then\n    Key = Cells(5, 9).Value\n\n For i = 5 To Lastrow\n\n' If Not IsEmpty(Cells(i, 9).Value) Then\n'    Key = Cells(i, 9).Value\n\n Set wbk = Workbooks.Open(strFrthFile)\n With wbk.Sheets(\"Sheet1\")\n\n    Set Target = Columns(1).find(Key, LookIn:=xlValues)\n\n    If Not Target Is Nothing Then\n\n        ActiveCell.Select\n        Selection.Copy\n\n\n        Set wbk = Workbooks.Open(strSecondFile)\n            With wbk.Sheets(\"Sheet2\")\n                Sheets(\"Sheet2\").Select\n                    Cells(i, 10).Select\n                        ActiveCell.Paste\n\n\n                 If Not IsEmpty(Cells(i + 1, 9).Value) Then\n                    Key = Cells(i + 1, 9).Value\n\n            End If\n\n        End With\n\n    End If\n\n End With\n'End If\n\n Next\n    End If\n\nEnd Sub\n\n\n'=========================================================================\n</code></pre>\n\n<p>But It does not work and I can't figure it out. I appreciate any comments on this macro.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1494397429, "post_id": 43884584, "comment_id": 74804210, "body": "You must have some protected worksheet. You cannot select or manipulate shapes in a protected worksheet, unless you allow the option &quot;Edit Objects&quot; when porotecting."}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1494397469, "post_id": 43884908, "comment_id": 74804224, "body": "If the sheet is protected, which I suspect, it wont allow to modify the placement."}, {"owner": {"reputation": 103, "user_id": 7874238, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ff922db236d13bd6182c8ce29f21fb8c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/7874238/stacey"}, "edited": false, "score": 0, "creation_date": 1494397731, "post_id": 43884908, "comment_id": 74804334, "body": "Its working now, thank you. Just one last question in case I dont want it to be applied in all the worksheets but just few worksheets which I have selected then how should I modify the code as my selected sheet can differ so I cannot specify the names of the worksheets"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 103, "user_id": 7874238, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ff922db236d13bd6182c8ce29f21fb8c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/7874238/stacey"}, "edited": false, "score": 0, "creation_date": 1494397818, "post_id": 43884908, "comment_id": 74804390, "body": "@Stacey then you need to loop through the sheets and see which ones are <code>Selected</code> - I think it&#39;s an excellent new <b>SO</b> post"}, {"owner": {"reputation": 103, "user_id": 7874238, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ff922db236d13bd6182c8ce29f21fb8c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/7874238/stacey"}, "edited": false, "score": 0, "creation_date": 1494402154, "post_id": 43884908, "comment_id": 74806910, "body": "Sure I am posting a new post for this"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1494397286, "creation_date": 1494397286, "answer_id": 43884908, "question_id": 43884584, "link": "https://stackoverflow.com/questions/43884584/change-the-placement-property-of-the-all-the-sheets-in-a-workbook/43884908#43884908", "title": "Change the placement property of the all the sheets in a workbook", "body": "<p>You don't need to <code>Select</code> the <code>Cht</code> in order to modify it's properties.</p>\n\n<p>Almost never you will need to <code>Select</code> or <code>Activate</code> in order to modify a property or a value, the only think \"it does\" is slow your code's run-time.</p>\n\n<p>Just use:</p>\n\n<pre><code>For Each Sht In ActiveWorkbook.Worksheets\n    For Each Cht In Sht.ChartObjects\n        If Cht.Visible = True Then\n            Cht.Placement = PropertyOption\n            'Do something with the chart...\n        End If\n    Next Cht\nNext Sht\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 7874238, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ff922db236d13bd6182c8ce29f21fb8c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/7874238/stacey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 43884908, "answer_count": 1, "score": 0, "last_activity_date": 1494397286, "creation_date": 1494395957, "last_edit_date": 1531164843, "question_id": 43884584, "link": "https://stackoverflow.com/questions/43884584/change-the-placement-property-of-the-all-the-sheets-in-a-workbook", "title": "Change the placement property of the all the sheets in a workbook", "body": "<p>I am trying to change the placement property of all the <code>ChartObjects</code> and shape in my workbook.</p>\n\n<p>However I am getting a Run-Time error </p>\n\n<blockquote>\n  <p>requested shapes are locked for selection</p>\n</blockquote>\n\n<p>on this line:</p>\n\n<pre><code> cht.Select\n</code></pre>\n\n<p>Please find below the code:</p>\n\n<pre><code>Sub LoopThroughCharts()\n'PURPOSE: Loop through every object in the active workbook\n\nDim sht As Worksheet\nDim CurrentSheet As Worksheet\nDim cht As ChartObject\nDim shp As Shape\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nSet CurrentSheet = ActiveSheet\n'Retrieve Input from User\nPropertyOption = Application.InputBox(\"Change Everything To What Placement Property?\" &amp; _\n\"(Must be 1, 2, or 3)\" &amp; vbCr &amp; vbCr &amp; \"   [1] Move and Size with Cells\" &amp; vbCr &amp; _\n\"   [2] Move but Don't Size with Cells\" &amp; vbCr &amp; \"   [3] Don't Move or Size with Cells\" &amp; _\nvbCr &amp; \" \", Type:=1, Title:=\"Placement Property For All\")\n\n'Handle If User Cancels\nIf PropertyOption = 0 Then Exit Sub\n\nFor Each sht In ActiveWorkbook.Worksheets\n    For Each cht In sht.ChartObjects\n        If cht.Visible = True Then\n            cht.Select\n            cht.Placement = PropertyOption\n            'Do something with the chart...\n        End If\n    Next cht\nNext sht\n\nFor Each sht In ActiveWorkbook.Worksheets\n    For Each shp In sht.Shapes\n        If shp.Visible = True Then\n            shp.Select\n            shp.Placement = PropertyOption\n        End If\n    Next shp\nNext sht\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2016"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1494392168, "post_id": 43883808, "comment_id": 74802197, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17751443/excel-vba-cant-get-a-match-error-unable-to-get-the-match-property-of-the-wor\">Excel VBA: Can&#39;t get a match, error &quot;Unable to get the Match property of the WorksheetFunction class&quot;</a>"}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494392392, "post_id": 43883808, "comment_id": 74802276, "body": "No actually I have taken a look at it already. Does&#39;nt solve my problem."}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494392436, "post_id": 43883808, "comment_id": 74802289, "body": "Also my question is a bit different. I am also open to other methods, if anyone can suggest, for this problem."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494392511, "post_id": 43883808, "comment_id": 74802315, "body": "It would help greatly if you could explain <i>what</i> doesn&#39;t work with other solutions you&#39;ve tried/found online. Right now it&#39;s a pretty vague question.  &quot;I have tried solutions online&quot;.  Great! What solutions did you try, and what didn&#39;t work?  &quot;Please have a fair review before judging the same.&quot; - So far, we only know you&#39;re trying to use <code>Match()</code> and getting an error. This same error was presented in that possible duplicate. Please expand on what you&#39;ve tried, how your question is different than others online, and how your issue isn&#39;t solved by the top 10 Google results of same question."}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494392707, "post_id": 43883808, "comment_id": 74802374, "body": "@BruceWayne... You have read the question already, I have tried replacing the .Match function with Application. Match, Application.WorksheetFunction.Match and WorksheetFunction.Match... Please read the questio comletely and my code also, you will find that I have already incorporated the points of those solutions without any effect on my error."}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494392847, "post_id": 43883808, "comment_id": 74802423, "body": "I think you have just read the title and commented. Not expected from a guy with your level of reputation on this site..."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1494393461, "post_id": 43883926, "comment_id": 74802643, "body": ":| you are &quot;stealing&quot; my &quot;bread and butter&quot; :) my precious <code>Match</code> ( +1 )"}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "edited": false, "score": 0, "creation_date": 1494393649, "post_id": 43883926, "comment_id": 74802737, "body": "Thank you so much @A.S.H . It worked like a charm. There is one more question I need to ask if you could help me out... I ran the code and it gives outptut that is not expected. It skipped certain values and copied certain which were not expected. I think this might be because there are multiple values which are same when we use the small function. Do you know any way I can avoid that so that the same values are also processed?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "edited": false, "score": 0, "creation_date": 1494393889, "post_id": 43883926, "comment_id": 74802819, "body": "@AviGupta I have to say that I expected that you will have this problem. Unfortunately, <code>Match</code> will always return the first appearence of the searched item. The problem is more complex and is a question on its own. You can probably try some approach with setting <i>temporarily</i> a cell to blank after it has been taken. But that should be done carefully (always fecth the smallest, copy and set to blank, loop) ..."}, {"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "edited": false, "score": 0, "creation_date": 1494394163, "post_id": 43883926, "comment_id": 74802929, "body": "Will do that, thanks. You are an angel... I am newbie and really need answers like these. Thanks a lot!!!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1494394371, "post_id": 43883926, "comment_id": 74803007, "body": "In always wished the error messages would be more descriptive when they were thrown, as the compiler (?) surely knows what part of the function is causing the error. Nice troubleshooting and fix!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "edited": false, "score": 0, "creation_date": 1495061868, "post_id": 43883926, "comment_id": 75098696, "body": "@AviGupta is there a reason you unchecked this as accepted answer?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "edited": false, "score": 0, "creation_date": 1495129763, "post_id": 43883926, "comment_id": 75134267, "body": "@AviGupta ah, it happens. Thanks, glad to help anytime :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 4, "last_activity_date": 1494393121, "last_edit_date": 1494393121, "creation_date": 1494392670, "answer_id": 43883926, "question_id": 43883808, "link": "https://stackoverflow.com/questions/43883808/error-unable-to-get-match-property-of-the-worksheet-class-i-have-already-trie/43883926#43883926", "title": "#ERROR: Unable to get match property of the worksheet class. I have already tried solutions available online", "body": "<p><code>a = Application.Small(m, j)</code> will surely return an <code>Error Code</code> when j is actually bigger that the size of te range m. In your code, the range <code>m = Range(\"E3:E40\")</code> has 38 cells, but j can go as high as 38 * 172.</p>\n\n<p>Then you try to call <code>Match</code> with an error code as the first parameter <code>a</code>. This resuts in run-time error. Note here that <code>Application.Match</code> would result in an error code while <code>WorksheetFunction.Match</code> raises a run-time error.</p>\n\n<p>In all cases, no error should occur in your <code>Match</code> if you had fetched correctly the \"kth smallest\" element. Without being able to check all of you code, I guess what you wanted here was </p>\n\n<pre><code>a = Application.Small(m, k) ' &lt;--- k, not j\n</code></pre>\n\n<p>And then no error should occur in <code>*.Match(a, m, 0)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "edited": false, "score": 0, "creation_date": 1494393998, "post_id": 43884089, "comment_id": 74802869, "body": "Actually I need the smallest, then 2nd smallest value, then 3rd smallest and so on. So it should proceed like j = 1,2,3... and so on. At least that&#39;s the idea. But with the above solution, using k is a better idea instead of j."}, {"owner": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "reply_to_user": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "edited": false, "score": 0, "creation_date": 1494400141, "post_id": 43884089, "comment_id": 74805601, "body": "As stated on my answer, if you have values 4, 6, 20, 10. you will always get 4 when j/k will only increment by 1. and you will get 6 when j/k is equal to 5."}], "tags": [], "owner": {"reputation": 417, "user_id": 7761311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/a53159b6ed1d109072ca901e7141641c?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Co", "link": "https://stackoverflow.com/users/7761311/paul-co"}, "is_accepted": false, "score": 0, "last_activity_date": 1494393515, "creation_date": 1494393515, "answer_id": 43884089, "question_id": 43883808, "link": "https://stackoverflow.com/questions/43883808/error-unable-to-get-match-property-of-the-worksheet-class-i-have-already-trie/43884089#43884089", "title": "#ERROR: Unable to get match property of the worksheet class. I have already tried solutions available online", "body": "<p>After checking your code:   </p>\n\n<p>After getting the smallest value, the next value of <code>j</code> should be <code>a + 1</code> not <code>j + 1</code>.<br>\nWhy? because if your smallest value is 4 from (4, 6, 10)<br>\non first loop, j = 1, small will return 4.<br>\non second loop, j = 2, small will still return 4, instead of 6.</p>\n"}], "owner": {"reputation": 47, "user_id": 7950082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b5c06a436735634e4e004a51dfd0d10?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Gupta", "link": "https://stackoverflow.com/users/7950082/avi-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 2, "accepted_answer_id": 43883926, "answer_count": 2, "score": 2, "last_activity_date": 1494393515, "creation_date": 1494391805, "last_edit_date": 1494392566, "question_id": 43883808, "link": "https://stackoverflow.com/questions/43883808/error-unable-to-get-match-property-of-the-worksheet-class-i-have-already-trie", "title": "#ERROR: Unable to get match property of the worksheet class. I have already tried solutions available online", "body": "<p><strong>NOTE: My problem was not solved by other similar questions on this as well as other sites. Please have a fair view at my question before judging the same</strong></p>\n\n<p>I am trying to perform a task in which first I have to identify the smallest, 2nd smallest numbers and so on and according to this I have to copy data from one column to another. This will continue until the sum of the copied values becomes grater than or equal to certain value in the sheet (<strong>Here row no. for the comparison is given by variable \"b\"</strong>). This will be repeated for 172 different sets which are repeated after every 43 cells.</p>\n\n<p>I have written the following code: </p>\n\n<pre><code> Dim m As Range, k As Double, j As Double, b As Double, lIndex As Double, a As Double\n\n Set m = ActiveSheet.Range(\"E3:E40\")\n\n For i = 1 To 172\n         j = 1\n         b = 45 + 43 * (i - 1)\n         For k = 1 To 38\n                    a = Application.Small(m, j)\n                    lIndex = Application.WorksheetFunction.Match(a, m, 0)\n\n                    If Cells(b, 7).Value &lt; Cells(b, 1).Value Then\n                        Cells(lIndex, 7).Value = Cells(lIndex, 2).Value\n                    Else\n                    End If\n\n                    j = j + 1\n\n         Next k\n\n         Set m = m.Offset(43)\n\n Next i\n</code></pre>\n\n<p>Now there is an error that pops up saying, Unable to get match property of the worksheet class.</p>\n\n<p><strong>NOTE: I have tried solutions online.</strong></p>\n\n<p><strong>Can there be any other way to do it</strong> </p>\n\n<p>OR</p>\n\n<p><strong>Is there something wrong I am doing logically or in the syntax as I am new to excel VBAs and coding itself.</strong></p>\n"}, {"tags": ["excel", "vba", "ado"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494391867, "post_id": 43883728, "comment_id": 74802091, "body": "Square brackets aren&#39;t normally a requirement, but could be around <code>Date</code> - that&#39;s probably a reserved word."}], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 4268311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/70a67dc6daa45322d5513cd57aee9200?s=128&d=identicon&r=PG&f=1", "display_name": "dya", "link": "https://stackoverflow.com/users/4268311/dya"}, "is_accepted": true, "score": 0, "last_activity_date": 1494391847, "creation_date": 1494391847, "answer_id": 43883812, "question_id": 43883728, "link": "https://stackoverflow.com/questions/43883728/excel-vba-ado-to-workbook-syntax-multiple-conditions/43883812#43883812", "title": "Excel VBA ADO to workbook syntax - multiple conditions", "body": "<p>Solved my own problem, just have to add square brackets around field names when multiple conditions. Struggling with the date a bit, but I'll get that down.</p>\n"}], "owner": {"reputation": 154, "user_id": 4268311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/70a67dc6daa45322d5513cd57aee9200?s=128&d=identicon&r=PG&f=1", "display_name": "dya", "link": "https://stackoverflow.com/users/4268311/dya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 43883812, "answer_count": 1, "score": 0, "last_activity_date": 1494391847, "creation_date": 1494391341, "question_id": 43883728, "link": "https://stackoverflow.com/questions/43883728/excel-vba-ado-to-workbook-syntax-multiple-conditions", "title": "Excel VBA ADO to workbook syntax - multiple conditions", "body": "<p>I'm querying another Excel workbook via ADO connection. In several parts, I need to use multiple conditions, but I can't seem to figure out the syntax. Can anyone point out a fix to my sql string?:</p>\n\n<p>SELECT FROM [Sheet1$] WHERE Date = '10/05/2017' AND Group = 3</p>\n\n<p>It seems to work fine when I only use one condition, but not multiple. Thanks!</p>\n\n<p>[edit] The error I'm getting says \"Syntax error (missing operator in query expression 'Date = '10/05/2017' AND'.\"</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1494389810, "post_id": 43883353, "comment_id": 74801481, "body": "I don&#39;t relay on conditions that are not that clear. Why not to only <code>If ThisDocument.VBASigned = True Then ...</code> or <code>If ThisDocument.VBASigned = False Then ...</code> ? I think adding a <code>Not</code> makes the boolean far way tanggled than it should be and it could be a logical condition that&#39;s failing."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494389838, "post_id": 43883353, "comment_id": 74801495, "body": "<b>How</b> <code>isSigned</code> gets to be <code>True</code> wouldn&#39;t affect the code&#39;s actions after it <b>is</b> set to <code>True</code>.  (It&#39;s just a variable - it has no memory of what happened to it in the past.)  Are you sure you didn&#39;t manually set <code>isSigned</code> to <code>True</code> after stepping into the <code>If</code> statement while it was <code>False</code>?  Have you included <code>Option Explicit</code> to ensure there are no hidden characters in your variable names?"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 2, "creation_date": 1494390186, "post_id": 43883353, "comment_id": 74801592, "body": "@Sgdva either way it should work.  &quot;If Not True Then&quot;   is   the same as &quot;If False Then&quot;  and is quite common."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494390308, "post_id": 43883353, "comment_id": 74801620, "body": "@YowE3K I hear ya.  Shouldn&#39;t make a difference but it does.  Definitely DID NOT accidentally change anything, I&#39;ve tested this many ways with many permutations and the issue (as written above) is 100% reproducible on my system."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1494390327, "post_id": 43883353, "comment_id": 74801626, "body": "@SlowLearner Indeed, but I have seen some native functions in VBA to fail if some weird logic is used and had to come up with my own. Whenever you&#39;re able to, try to keep the logic simple. I don&#39;t see why you&#39;d need to use the Not True instead of False"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494390437, "post_id": 43883353, "comment_id": 74801658, "body": "See what happens if you change it to <code>isSigned = ThisDocument.VBASigned * 0 - 1</code>.  And also see what happens if you delete the line and retype it."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1494390722, "post_id": 43883353, "comment_id": 74801734, "body": "@Sgdva IMO it&#39;s not usually a good idea to use expressions like <code>booleanexpression = True</code> (which is just equivalent to <code>booleanexpression</code>) and <code>booleanexpression = False</code> (which is just equivalent to <code>Not booleanexpression</code>) - it just makes the code harder to read.  (e.g. <code>If Visible Then</code> is usually easier to read then <code>If Visible = True Then</code>, and <code>If Not Visible Then</code> is usually easier to read then <code>If Visible = False Then</code>)"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 1, "creation_date": 1494390724, "post_id": 43883353, "comment_id": 74801736, "body": "First step. Debug.Print ThisDocument.VBASigned"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494390724, "post_id": 43883353, "comment_id": 74801737, "body": "@YowE3K why would I do that?  true * 0 = false * 0"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494390863, "post_id": 43883353, "comment_id": 74801770, "body": "I was hoping to see whether there was something invalid in the line that was confusing things - by just editing it to force it to be -1 (i.e. True) it may give us info - i.e. you say <code>isSigned = True</code> works correctly, but my statement should be forcing exactly the same thing to occur and, if still does something funny, we learn a bit more."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494391553, "post_id": 43883353, "comment_id": 74801993, "body": "Also try deleting and retyping the <code>If Not isSigned Then</code> line.  (It seems weird, but there have been several cases over the last couple of months where simply retyping what appears to be the exact same line has resolved inexplicable problems.)"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494391844, "post_id": 43883353, "comment_id": 74802077, "body": "@YowE3K I noticed this issue in a different project then rewrote it in a new project which was blank, then I posted here.  By the way, there is a pretty cool VBA decompiler by Orlando - works well, fixes the issues you speak of: <a href=\"http://cpap.com.br/orlando/VBADecompilerMore.asp\" rel=\"nofollow noreferrer\">cpap.com.br/orlando/VBADecompilerMore.asp</a>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1494392202, "post_id": 43883353, "comment_id": 74802210, "body": "OK - I am completely stumped.  (I wish I had a file with a VBASigned of True so that I could test it better - this is intriguing!)"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494392690, "post_id": 43883353, "comment_id": 74802366, "body": "@YowE3K is it possible to open a private chat - I don&#39;t know how to do it..."}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1494393538, "post_id": 43883353, "comment_id": 74802674, "body": "@SlowLearner - have you actually tried <code>If isSigned = False</code>? This was a known bug in Access VBA some years ago."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1494393899, "post_id": 43883353, "comment_id": 74802827, "body": "@Skippy - just tested and yes that actually works as expected, but I&#39;m more concerned about why the code posted in the question does not work as expected and if anyone is able to reproduce. Thanks,"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1494398324, "post_id": 43883353, "comment_id": 74804630, "body": "@Skippy - would that bug cause the code to behave differently depending on how the boolean variable was being set to <code>True</code>?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494398420, "post_id": 43883353, "comment_id": 74804674, "body": "@SlowLearner - I wouldn&#39;t have been able to use chat earlier (work firewall blocks it) but I&#39;m home now - we could possibly use the <a href=\"http://chat.stackoverflow.com/rooms/111528/vba-lounge\">VBA Lounge</a> if you are still around and want to chat."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1494399710, "post_id": 43883353, "comment_id": 74805336, "body": "@peh - thanks for fixing the code, wouldn&#39;t let me do it tried all sorts of things."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1494399886, "post_id": 43883353, "comment_id": 74805439, "body": "I did some tests and can confirm @SlowLearner&#39;s issue. Using <code>isSigned = ThisDocument.VBASigned</code> or even with <code>isSigned = cBool(ThisDocument.VBASigned)</code> let <code>If Not isSigned Then</code> fail. Using <code>isSigned = True</code> doesn&#39;t fail on the <code>If</code>. This looks like a strange bug in Office because both <code>ThisDocument.VBASigned</code> and <code>isSigned</code> are of the type boolean."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1494400333, "post_id": 43883353, "comment_id": 74805720, "body": "This looks like a bug in <b>Word</b> only. If I test the same code in Excel with <code>ThisWorkbook.VBASigned</code> instead of <code>ThisDocument.VBASigned</code> it works like it should. Therefore I bet on a Word bug."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1494400514, "post_id": 43883353, "comment_id": 74805826, "body": "Thanks @Peh - glad you could verify."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1494401437, "post_id": 43883353, "comment_id": 74806428, "body": "@SlowLearner what is the output for <code>Debug.Print TypeName(ThisDocument.VBASigned)</code> and <code>Debug.Print TypeName(isSigned)</code> in Word VBA Project?"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1494401600, "post_id": 43883353, "comment_id": 74806544, "body": "@omegastripes  here is the output <code>?TypeName(ThisDocument.VBASigned)</code> returns <code>Boolean</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1494407382, "post_id": 43883353, "comment_id": 74810181, "body": "@Sgdva - I said earlier that it isn&#39;t a good idea to use things like <code>booleanexpression = False</code> instead of <code>Not booleanexpression</code>, but in this situation it looks like that solution would have worked - because <code>ThisDocument.VBASigned</code> wasn&#39;t a &quot;true&quot; <code>Boolean</code> value (it is just a <code>Boolean</code> variable containing a numeric value)."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494474300, "post_id": 43883353, "comment_id": 74845705, "body": "@YowE3K You know, microsoft ;) Nevertheless, your solution is really expanded, thanks for clarifying what&#39;s happening according to the documentation!"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494401147, "post_id": 43885975, "comment_id": 74806246, "body": "SlowLearner and I have just been discussing this in a chat - we found that Word&#39;s VBASigned is returning <code>1</code> if True rather than <code>-1</code>"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1494401991, "post_id": 43885975, "comment_id": 74806806, "body": "Thanks Peh - good to know, sad that MS Word is so unloved.  Strange bug to have in one component of an integrated office suite... just saying."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1494401026, "creation_date": 1494401026, "answer_id": 43885975, "question_id": 43883353, "link": "https://stackoverflow.com/questions/43883353/the-weirdest-vba-issue-i-have-ever-seen-vbasigned-possible-bug-on-boolean-condi/43885975#43885975", "title": "The weirdest VBA issue I have ever seen (VBASigned Possible Bug on Boolean Condition)", "body": "<p>Testing this against Excel show that this is a bug in Word.</p>\n\n<p>Assuming we have new documents with VBA enabled and VBA signed:</p>\n\n<p>Using in Excel:</p>\n\n<pre><code>Sub testExcel()\n    Dim isSigned As Boolean\n    isSigned = ThisWorkbook.VBASigned\n    Debug.Print ThisWorkbook.VBASigned\n    If Not isSigned Then\n        Debug.Print \"I am NOT signed\"\n    Else\n        Debug.Print \"I AM signed\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Results in</p>\n\n<blockquote>\n  <p>True<br>\n  I AM signed</p>\n</blockquote>\n\n<p>But using the same in Word </p>\n\n<pre><code>Sub testWord()\n    Dim isSigned As Boolean\n    isSigned = ThisDocument.VBASigned\n    Debug.Print ThisDocument.VBASigned\n    If Not isSigned Then\n        Debug.Print \"I am NOT signed\"\n    Else\n        Debug.Print \"I AM signed\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Results in</p>\n\n<blockquote>\n  <p>True<br>\n  I am NOT signed</p>\n</blockquote>\n\n<p>This clearly shows that there is a bug in Word.</p>\n\n<hr>\n\n<p>This was tested with</p>\n\n<ul>\n<li>Windows 10 x64</li>\n<li>Office Professional Plus 2016 \n\n<ul>\n<li>Version 1703 Build 7967.2139</li>\n<li>German</li>\n<li>64 Bit Office</li>\n</ul></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1494401459, "post_id": 43886092, "comment_id": 74806440, "body": "This basically explains the behavior which is more than I expected to achieve :-) thanks!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1494401687, "post_id": 43886092, "comment_id": 74806598, "body": "I can confirm this. But this still is a bug in Word then."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1494401935, "post_id": 43886092, "comment_id": 74806764, "body": "@Peh yup, still a bug in word - but really nice to know what the bug is... knowing that it is 1 instead of -1 gives me confidence because I better understand the issue."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1494407173, "post_id": 43886092, "comment_id": 74810035, "body": "@SlowLearner - I have added some code to the answer that will convert the VBASigned to a &quot;true&quot; <code>Boolean</code> by first passing it through an <code>Integer</code> variable."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 7, "last_activity_date": 1494407094, "last_edit_date": 1494407094, "creation_date": 1494401362, "answer_id": 43886092, "question_id": 43883353, "link": "https://stackoverflow.com/questions/43883353/the-weirdest-vba-issue-i-have-ever-seen-vbasigned-possible-bug-on-boolean-condi/43886092#43886092", "title": "The weirdest VBA issue I have ever seen (VBASigned Possible Bug on Boolean Condition)", "body": "<p>After playing with a digitally signed version of a document that SlowLearner supplied me, I have determined that Word's VBASigned is returning a <code>1</code> when it is signed.</p>\n\n<p>This then leads to problems in the <code>If</code> statement, because <code>Not 1</code> is equal to <code>-2</code>, and <code>Not 0</code> is equal to <code>-1</code> - thus leading to <code>Not VBASigned</code> returning a non-zero (i.e. non-False) value in all cases.</p>\n\n<hr>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836069.aspx\" rel=\"noreferrer\">MSDN documentation</a> states that <code>VBASigned</code> is a read-only Boolean, and the type of variable returned has been confirmed (by <code>TypeName(ThisDocument.VBASigned)</code>) to be <code>Boolean</code>, but it appears it should be treated as a numeric value instead.</p>\n\n<hr>\n\n<p>An additional interesting fact is that <code>CBool(ThisDocument.VBASigned) * 1</code> gives an answer of <code>1</code>, while a <code>CBool(1) * 1</code> gives an answer of <code>-1</code>.  So it seems that, when VBA decides that a value is already a <code>Boolean</code> (such as <code>ThisDocument.VBASigned</code> is meant to be), it doesn't bother to do any conversions.  But, when the parameter to <code>CBool</code> is not a <code>Boolean</code>, it converts a non-zero value to be <code>-1</code>.</p>\n\n<hr>\n\n<p>Code that would work:</p>\n\n<pre><code>Sub test()\n    Dim myVBASigned As Integer\n    Dim isSigned As Boolean\n    myVBASigned = ThisDocument.VBASigned 'Store as Integer\n    isSigned = myVBASigned               'Convert to a \"true\" Boolean\n\n    If Not isSigned Then                 'Use the \"true\" Boolean\n        Debug.Print \"I am NOT signed\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 1, "accepted_answer_id": 43886092, "answer_count": 2, "score": 6, "last_activity_date": 1524799613, "creation_date": 1494388632, "last_edit_date": 1531164843, "question_id": 43883353, "link": "https://stackoverflow.com/questions/43883353/the-weirdest-vba-issue-i-have-ever-seen-vbasigned-possible-bug-on-boolean-condi", "title": "The weirdest VBA issue I have ever seen (VBASigned Possible Bug on Boolean Condition)", "body": "<p>In MS Word I added some code to see if a document is missing its digital signature, or at least I thought I did. I've decided to share before testing this on other systems.</p>\n\n<pre><code>Sub test()\n    If Not ThisDocument.VBASigned Then\n        Debug.Print \"I am NOT signed\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Problem: The code above produces the same result irrespective of whether or not the document has a digital signature.  If I modify the code by removing the <code>Not</code> I still get unexpected results.  </p>\n\n<p>I've tried to coerce things by doing things like:</p>\n\n<pre><code>If Not CBool(ThisDocument.VBASigned) Then\n</code></pre>\n\n<p>But more surprisingly, the following code also fails:</p>\n\n<pre><code>Sub test()\n    Dim isSigned As Boolean\n    isSigned = ThisDocument.VBASigned\n\n    If Not isSigned Then\n        Debug.Print \"I am NOT signed\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Even though <code>ThisDocument.VBASigned</code> AND <code>isSigned</code> are both <code>TRUE</code>...<br>\n<a href=\"https://i.stack.imgur.com/nk9cH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nk9cH.png\" alt=\"snapshot of my code running\"></a>\nbut if change <code>isSigned = ThisDocument.VBASigned</code> to <code>isSigned = True</code> then everything works as expected. </p>\n\n<p>Can anyone confirm this?\nAny thoughts?</p>\n\n<hr>\n\n<p>Edits below answer some of the questions:</p>\n\n<ol>\n<li><p>Yes, using <code>Option Explicit</code>, Yes also tried Debug.<br>\nThis code:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim isSigned As Boolean\n    isSigned = ThisDocument.VBASigned\n    Debug.Print ThisDocument.VBASigned\n    If Not isSigned Then\n        Debug.Print \"I am NOT signed\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Produces this output:</p>\n\n<blockquote>\n  <p>True<br>\n    I am NOT signed</p>\n</blockquote></li>\n<li><p>Testing: <code>True * 0 - 1</code>.</p>\n\n<pre><code>Sub test()\n    Dim isSigned As Boolean\n    isSigned = ThisDocument.VBASigned\n    Debug.Print ThisDocument.VBASigned\n    If Not (isSigned * 0 - 1) Then\n        Debug.Print \"I am NOT signed\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Produces this (expected) output:</p>\n\n<blockquote>\n  <p>True</p>\n</blockquote></li>\n</ol>\n\n<hr>\n\n<p>Edit: interesting article by Raymond Chen that might provide some further insights as to how this happened: <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20041222-00/?p=36923\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/oldnewthing/20041222-00/?p=36923</a></p>\n\n<p>In short, as the Windows operating system evolved it included different types of booleans: int > byte > variant</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 7989317, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155154870151280/picture?type=large", "display_name": "Joe", "link": "https://stackoverflow.com/users/7989317/joe"}, "edited": false, "score": 0, "creation_date": 1495086613, "post_id": 43883123, "comment_id": 75105050, "body": "I am looking to have the URL in column J grab the image and paste it in another cell K with the size of 1&quot; x 1&quot;.  The original image size if 4&quot;x4&quot;.  The original question I posted only inserts the image in the same cell.  I want the URL to stay in J."}], "owner": {"reputation": 11, "user_id": 7989317, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155154870151280/picture?type=large", "display_name": "Joe", "link": "https://stackoverflow.com/users/7989317/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "closed_date": 1494388095, "answer_count": 0, "score": 1, "last_activity_date": 1494486686, "creation_date": 1494386866, "last_edit_date": 1494486686, "question_id": 43883123, "link": "https://stackoverflow.com/questions/43883123/how-to-disply-url-as-image-resized-in-another-excel-cell", "closed_reason": "Duplicate", "title": "How to disply URL as image &amp; resized in another Excel cell", "body": "<p><a href=\"https://i.stack.imgur.com/2tclA.png\" rel=\"nofollow noreferrer\">Cell J Image</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/kXblg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kXblg.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm looking to convert a URL into an image but I want the image in a new cell and sized to an inch by an inch.</p>\n\n<p>I was able to get a script from another question asked, but need the extra script to add to it</p>\n\n<p>This coding is the same from another question but not the additions of placing the image into a different cell and sizing it</p>\n\n<p>so URL in column J puts image in column K sized to 1\" x 1\"</p>\n\n<p>in this example, .insert (v) is inserted in cell \"J\" </p>\n\n<pre><code>Sub InstallPictures()\n\n    Dim i As Long, v As String\n    For i = 2 To 1903\n        v = Cells(i, \"J\").Value\n        If v = \"\" Then Exit Sub\n        With ActiveSheet.Pictures\n            .Insert (v)\n        End With\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1494389483, "post_id": 43882940, "comment_id": 74801393, "body": "Why not also assign <code>ActiveSheet</code> to a variable too? It would help cut down on any ambiguity insofar as what is the ActiveSheet."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1494399731, "post_id": 43882940, "comment_id": 74805350, "body": "See my answer and code below"}, {"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1494453112, "post_id": 43882940, "comment_id": 74840521, "body": "@ShaiRado Thank you very much. Huge help!"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "edited": false, "score": 0, "creation_date": 1495037993, "post_id": 43885554, "comment_id": 75086722, "body": "I&#39;m having some trouble modifying this to loop through paths stored in a worksheet (instead of having the paths defined in the code). Any suggestions there? <a href=\"http://stackoverflow.com/questions/44012400/misunderstood-runtime-error-vba-for-excel-and-ms-project\">Link</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "edited": false, "score": 0, "creation_date": 1495038622, "post_id": 43885554, "comment_id": 75087103, "body": "@ERKSMTY  you should post a new question, describe exactly what you are trying to achieve, and add your relevant code. This will allow other users and myself to help you"}, {"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "edited": false, "score": 0, "creation_date": 1495041311, "post_id": 43885554, "comment_id": 75088655, "body": "check out the link in my last comment"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1494417547, "last_edit_date": 1494417547, "creation_date": 1494399714, "answer_id": 43885554, "question_id": 43882940, "link": "https://stackoverflow.com/questions/43882940/vba-copy-paste-data-into-excel-from-project/43885554#43885554", "title": "VBA Copy Paste Data into Excel from Project", "body": "<p>I am not sure how your original code above worked, since you <code>Dim</code> and <code>Set</code> the variable <code>appProj</code>, but later trying to open the MS-Project file with <code>projApp.Application.FileOpenEx \"C:File.mpp\"</code> (<code>projApp</code> &lt;> <code>appProj</code>).</p>\n\n<p>Try the code below (tested), it will copy the 3 columns (<code>\"Name\"</code> , <code>\"Resource Names\"</code> and <code>\"Finish\"</code>) to worksheet \"Project Data\" at columns \"A:C\".</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub OpenProjectCopyPasteData()\n\nDim PrjApp      As MSProject.Application\nDim aProg       As MSProject.Project\nDim PrjFullName As String\nDim t           As Task\nDim rng         As Range\nDim ws          As Worksheet\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n'Clear current contents\nSet ws = Worksheets(\"Project Data\")\nSet rng = ws.Range(\"A:J\")\nrng.ClearContents\n\nOn Error Resume Next\nSet PrjApp = GetObject(, \"MSProject.Application\")\nIf PrjApp Is Nothing Then\n    Set PrjApp = New MSProject.Application\nEnd If\nOn Error GoTo 0\nPrjApp.ScreenUpdating = False\nPrjApp.Visible = True\n\n'Open MS Project file\nPrjFullName = \"C:File.mpp\" '&lt;-- keep the MS-Project file name and path in a variable\nPrjApp.Application.FileOpenEx PrjFullName\nSet aProg = PrjApp.ActiveProject\n\n' show all tasks\nOutlineShowAllTasks\n\n'Copy the project columns and paste into Excel\nSelectTaskColumn Column:=\"Name\"\nEditCopy\nSet ws = Worksheets(\"Project Data\")\nSet rng = ws.Range(\"A:A\")\nrng.PasteSpecial xlPasteValues\nrng.PasteSpecial xlPasteFormats\n\nSelectTaskColumn Column:=\"Resource Names\"\nEditCopy\nSet rng = ws.Range(\"B:B\")\nrng.PasteSpecial xlPasteValues\nrng.PasteSpecial xlPasteFormats\n\nSelectTaskColumn Column:=\"Finish\"\nEditCopy\nSet rng = ws.Range(\"C:C\")\nrng.PasteSpecial xlPasteValues\nrng.PasteSpecial xlPasteFormats\n\n' reset settings of Excel and MS-Project\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nPrjApp.ScreenUpdating = True\nPrjApp.DisplayAlerts = True\n\n'PrjApp.FileClose False\nPrjApp.Quit pjDoNotSave\nSet PrjApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3070, "favorite_count": 0, "accepted_answer_id": 43885554, "answer_count": 1, "score": 3, "last_activity_date": 1593559326, "creation_date": 1494385457, "last_edit_date": 1593559326, "question_id": 43882940, "link": "https://stackoverflow.com/questions/43882940/vba-copy-paste-data-into-excel-from-project", "title": "VBA Copy Paste Data into Excel from Project", "body": "<p>I'm running the code below and getting spurious results. </p>\n\n<p>For some reason it copies five lines of code into the desired worksheet instead of the specified MS Project data. </p>\n\n<p>Can Anyone help out a newbie?</p>\n\n<p>Five lines of code incorrectly copied into Excel worksheet:</p>\n\n<pre><code>'Open MS Project file\nprojApp.Application.FileOpenEx \"C:File.mpp\"\n\nSet projApp = projApp.ActiveProject\n\n'Final set up of code\nSet projApp = Nothing\n</code></pre>\n\n<p><img src=\"https://imgur.com/gallery/POkTc\" alt=\"Error Image\"></p>\n\n<pre><code>Sub OpenProjectCopyPasteData()\n\nDim appProj As MSProject.Application\nDim aProg As MSProject.Project\nDim sel As MSProject.Selection\nDim ts As Tasks\nDim t As Task\nDim rng As Range\nDim ws As Worksheet\n\nApplication.DisplayAlerts = False\n\n'Clear current contents\n\nSet ws = Worksheets(\"Project Data\")\nSet rng = ws.Range(\"A:J\")\nrng.ClearContents\n\nOn Error Resume Next\nSet appProj = GetObject(, \"MSProject.Application\")\nIf appProj Is Nothing Then\n    Set appProj = New MSProject.Application\nEnd If\nappProj.Visible = True\n\n'Open MS Project file\nprojApp.Application.FileOpenEx \"C:File.mpp\"\nSet projApp = projApp.ActiveProject\n\n'Final set up of code\nSet projApp = Nothing\n\nappProj.Visible = True\n\nWindowActivate WindowName:=aProg\n\n'Copy the project columns and paste into Excel\nSet ts = aProg.Tasks\n\nSelectTaskColumn Column:=\"Task Name\"\nOutlineShowAllTasks\nOutlineShowAllTasks\nEditCopy\nSet ws = Worksheets(\"Project Data\")\nSet rng = ws.Range(\"A:A\")\nActiveSheet.Paste Destination:=rng\n\nSelectTaskColumn Column:=\"Task Name\"\nEditCopy\nSet rng = ws.Range(\"B:B\")\nActiveSheet.Paste Destination:=rng\n\nSelectTaskColumn Column:=\"Resource Names\"\nEditCopy\nSet rng = ws.Range(\"C:C\")\nActiveSheet.Paste Destination:=rng\n\nSelectTaskColumn Column:=\"Finish\"\nEditCopy\nSet rng = ws.Range(\"D:D\")\nActiveSheet.Paste Destination:=rng\n\nApplication.DisplayAlerts = True\nappProj.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 11, "user_id": 7985637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfc5c70a225bfb4175ee4cfcebb8579?s=128&d=identicon&r=PG&f=1", "display_name": "thijs piso", "link": "https://stackoverflow.com/users/7985637/thijs-piso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494387318, "creation_date": 1494384874, "last_edit_date": 1494387318, "question_id": 43882857, "link": "https://stackoverflow.com/questions/43882857/multiple-selections-in-a-dropdown-list-in-the-same-column-doesnt-work", "title": "Multiple selections in a dropdown list in the same column doesn&#39;t work", "body": "<p>I am currently making a spreadsheet where I have two dropdown lists in the same column (G). My intention is to have multiple selections and the choice from the dropdownlist is put in the column next to the list (H). If another selection is made this will be put under the first selection. </p>\n\n<p>However the top dropdown list (G3) only lets me make one selection, the one (G14) below lets me make more.</p>\n\n<p>The top dropdown lets met make more selections after i made one in the bottom one but then adds it to the column next to the bottom one. </p>\n\n<p>I hope this is explained well enough.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nOn Error GoTo exitHandler\nDim rngDV As Range\nDim lRow As Long\nDim lCol As Long\n\nlCol = Target.Column 'column with data validation cell\n\nIf Target.Count &gt; 1 Then GoTo exitHandler\n\nOn Error Resume Next\nSet rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\nOn Error GoTo exitHandler\nIf rngDV Is Nothing Then GoTo exitHandler\nIf Intersect(Target, rngDV) Is Nothing Then\n'do nothing\nElse\nIf Target.Value = \"\" Then GoTo exitHandler\nApplication.EnableEvents = False\nSelect Case Target.Column\n   Case 7\n    If Target.Offset(0, 1).Value = \"\" Then\n       lRow = Target.Row\n    Else\n       lRow = Cells(Rows.Count, lCol + 1).End(xlUp).Row + 1\n    End If\n    Cells(lRow, lCol + 1).Value = Target.Value\n    Target.ClearContents\n End Select\n\n End If\n\n exitHandler:\n Application.EnableEvents = True\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1494384002, "post_id": 43882731, "comment_id": 74800164, "body": "Use <code>End(xlUp)</code> from the bottom of the sheet - that will preserve the gaps"}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494433438, "post_id": 43882731, "comment_id": 74829731, "body": "That&#39;ll do, thank you!"}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494434241, "post_id": 43882731, "comment_id": 74830258, "body": "I just gave that a shot, and it doesn&#39;t seem to work. I tried it from G1048576, A1048576, G520 and A520 - as well as the combinations (e.g., A1048576:G1048576). From the very bottom of the page it only copies the last row. From 520 it only copies the last 15 rows. I&#39;ll keep fiddling with it, but if you have anything else in mind I&#39;d love to hear it."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "edited": false, "score": 0, "creation_date": 1494453999, "post_id": 43898656, "comment_id": 74840838, "body": "Thanks for taking the time to help, and for the tip. Your way would cut the number of lines needed in half, compared to how I ended up writing it. Definitely keeping this in mind for later. Thanks again!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1494435556, "creation_date": 1494435556, "answer_id": 43898656, "question_id": 43882731, "link": "https://stackoverflow.com/questions/43882731/copying-rows-and-columns-including-blanks-in-excel-vba-without-xldown/43898656#43898656", "title": "Copying rows and columns, including blanks, in excel vba without xlDown", "body": "<p>For example:</p>\n\n<pre><code>With Workbooks(\"Finished Products YTD Generator\").Worksheets(\"LGT\")\n    .Range(.Range(\"A1\"), .Cells(Rows.Count, 1).End(xlUp).Offset(0, 7)).Copy _\n        LGSheet.Range(\"A1\") 'or whatever\nEnd With\n</code></pre>\n\n<p>Note that you don't need to activate sheets to copy or paste, and it's a good habit to get out of.</p>\n"}], "owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "accepted_answer_id": 43898656, "answer_count": 1, "score": 0, "last_activity_date": 1494435556, "creation_date": 1494383820, "last_edit_date": 1494384077, "question_id": 43882731, "link": "https://stackoverflow.com/questions/43882731/copying-rows-and-columns-including-blanks-in-excel-vba-without-xldown", "title": "Copying rows and columns, including blanks, in excel vba without xlDown", "body": "<p>I'd like to copy Rows and Columns of a worksheet to a new workbook. I can open and activate the new book and new sheets, but the data I am copying is currently A1:F520 on one sheet and A1:G1031 on another. There are multiple blanks in between \n and within several \"groups\" of data sets. \n<img src=\"https://i.stack.imgur.com/oMO44.png\" alt=\"Example of Groups\"></p>\n\n<p>For the sake of the visual organization of our data, I want to keep those blanks in. The ranges will be changing over time, so I don't want to define something specific. I'd  rather keep it general like Range(\"A1\", Range(\"A1\".End(xlDown)). I suppose I could just include some ridiculously large range to ensure everything is there, but I'd rather accomplish this in a more dynamic (if that is the right word) sort of way.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Option Explicit\n\nPublic LGSheet As Worksheet\nPublic SGSheet As Worksheet\nPublic NewWorkbook As Workbook\nPublic UserYear As Integer\nSub DefineYear()\n\n    UserYear = Application.InputBox(Prompt:=\"Set Date for New Workbook\", Type:=1)\n    Set NewWorkbook = Workbooks.Add\n    Set SGSheet = Worksheets.Add\n    Set LGSheet = Worksheets.Add\n    Call PasteLGTandSGT\n\nEnd Sub\nSub PasteLGTandSGT()\n\n    Workbooks(\"Finished Products YTD Generator\").Activate\n    Worksheets(\"LGT\").Activate\n        Range(\"A1\", Range(\"A1\").End(xlDown)).Copy\n    LGSheet.Activate\n</code></pre>\n\n<p>Obviously I've put the xlDown bit here, and my google-fu isn't strong enough to find out anything more.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494382666, "post_id": 43882531, "comment_id": 74799879, "body": "Have you tried any VBA code?  If so, what isn&#39;t working?  Is there a reason you don&#39;t want to just write an Excel formula?"}, {"owner": {"reputation": 1, "user_id": 5451407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f1e70310c4449908e4a78963861711?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Le", "link": "https://stackoverflow.com/users/5451407/frank-le"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494382837, "post_id": 43882531, "comment_id": 74799911, "body": "i have tried using loop to count to the first zero but i could not figure out how to start the next zero."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494384877, "post_id": 43882531, "comment_id": 74800346, "body": "How does cell F6 affect things?  Is that the number <code>0</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494385248, "post_id": 43882531, "comment_id": 74800431, "body": "Does it have to be vba: Put this in B1 and copy down <code>=IF(A1=0,&quot;&quot;,IF(ROW() = 1,1,IF(INDEX(B:B,ROW()-1)=&quot;&quot;,1,INDEX(B:B,ROW()-1)+1)))</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494385408, "post_id": 43882531, "comment_id": 74800469, "body": "@ScottCraner - Oooh - I like - I was wondering how to get around the row 1 issue."}, {"owner": {"reputation": 1, "user_id": 5451407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f1e70310c4449908e4a78963861711?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Le", "link": "https://stackoverflow.com/users/5451407/frank-le"}, "edited": false, "score": 0, "creation_date": 1494385434, "post_id": 43882531, "comment_id": 74800475, "body": "yes i enter the #0 into the cell"}, {"owner": {"reputation": 1, "user_id": 5451407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f1e70310c4449908e4a78963861711?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Le", "link": "https://stackoverflow.com/users/5451407/frank-le"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1494385758, "post_id": 43882531, "comment_id": 74800548, "body": "@ScottCraner Formula is good too. GREAT!! thank you."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494385830, "post_id": 43882531, "comment_id": 74800563, "body": "Scott&#39;s formula is infinitely better than any VBA code."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5451407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f1e70310c4449908e4a78963861711?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Le", "link": "https://stackoverflow.com/users/5451407/frank-le"}, "edited": false, "score": 0, "creation_date": 1494386437, "post_id": 43882922, "comment_id": 74800679, "body": "yes they both work great! wow so many different method, ill try to digest this. thank you!"}, {"owner": {"reputation": 1, "user_id": 5451407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f1e70310c4449908e4a78963861711?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Le", "link": "https://stackoverflow.com/users/5451407/frank-le"}, "edited": false, "score": 0, "creation_date": 1494482185, "post_id": 43882922, "comment_id": 74848251, "body": "i am look at this line of code and could not figure out. Is this mainly for Row 1 issue?                                                                                                             [ElseIf r = 1 Then         Cells(r, &quot;B&quot;).Value = 1]"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 5451407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f1e70310c4449908e4a78963861711?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Le", "link": "https://stackoverflow.com/users/5451407/frank-le"}, "edited": false, "score": 0, "creation_date": 1494484652, "post_id": 43882922, "comment_id": 74849499, "body": "@FrankLe - yes, that is just to handle row 1 - because subsequent tests look at row <code>r - 1</code> which wouldn&#39;t work if <code>r</code> was 1 (Excel doesn&#39;t have a row 0)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1494385741, "last_edit_date": 1494385741, "creation_date": 1494385333, "answer_id": 43882922, "question_id": 43882531, "link": "https://stackoverflow.com/questions/43882531/looking-to-count-a-number-of-times-until-the-number-reappear/43882922#43882922", "title": "Looking to count a number of times until the number reappear", "body": "<p>The code below will do what you say you wanted to do in the question:</p>\n\n<pre><code>Dim r As Long\nFor r = 1 To Cells(Rows.Count, \"A\").End(xlUp).Row\n    If Cells(r, \"A\").Value = 0 Then \n        Cells(r, \"B\").Value = \"\"\n    ElseIf r = 1 Then\n        Cells(r, \"B\").Value = 1\n    ElseIf Cells(r - 1, \"A\").Value = 0 Then\n        Cells(r, \"B\").Value = 1\n    Else\n        Cells(r, \"B\").Value = Cells(r - 1, \"B\").Value + 1\n    End If\nNext\n</code></pre>\n\n<hr>\n\n<p>This could also be done using an Excel formula of</p>\n\n<pre><code>=IF(A2=0,\"\",IF(A1=0,1,B1+1))\n</code></pre>\n\n<p>in cell B2 and copying it down.  But that relies on the data starting in row 2 (or later), because the references to A1 and B1 (i.e. the previous row) would crash if your data started in row 1.</p>\n"}], "owner": {"reputation": 1, "user_id": 5451407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f1e70310c4449908e4a78963861711?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Le", "link": "https://stackoverflow.com/users/5451407/frank-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1494385741, "creation_date": 1494382234, "last_edit_date": 1531164843, "question_id": 43882531, "link": "https://stackoverflow.com/questions/43882531/looking-to-count-a-number-of-times-until-the-number-reappear", "title": "Looking to count a number of times until the number reappear", "body": "<p>I am looking to start count in column B until column A sees the #0, and then reset and recount until the next zero, and so forth.</p>\n\n<pre><code>   A  B\n1  2  1    \n2  3  2\n3  9  3\n4  5  4\n5  3  5\n6  0  \n7  4  1\n8  5  2\n9  9  3 \n10 0  \n11 7  1  \n.  2  2\n.  5  3\n.  0\n</code></pre>\n\n<p>--------------------code i have tried and fail--------------------------</p>\n\n<pre><code>check = False\n\nFor i = 2 To Rows.Count\nFor j = 1 To 50\n        Cells(i, 2).Value = i\n     If Cells(i, 1).Value = Cells(6, 6).Value Then\n        check = True\n    End If\nNext j\n If check = True Then\n j = 1\nEnd If\n\ntoAdd = True\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1494382195, "post_id": 43882334, "comment_id": 74799770, "body": "Could be that it&#39;s the last sheet in the workbook. Workbooks must have at least one sheet, so you cannot delete the last one."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1494387041, "post_id": 43882334, "comment_id": 74800824, "body": "Why not just delete the sheets your about to re-create from your filter with in your <code>For Each Loop</code> - no need  for all this line code-"}, {"owner": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "edited": false, "score": 0, "creation_date": 1494421213, "post_id": 43882334, "comment_id": 74820503, "body": "Unfortunately it isn&#39;t the last sheet.  There is the sheet my buttons which control the MACROs exist on as well as the sheet with the source data."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "edited": false, "score": 0, "creation_date": 1494422433, "post_id": 43891762, "comment_id": 74821505, "body": "Tom the above code actually errors out at &quot;Next Sheet&quot; but I have used a similar condensed code which still failed to remove the one sheet."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "edited": false, "score": 0, "creation_date": 1494423455, "post_id": 43891762, "comment_id": 74822322, "body": "How many sheets are you left with after this has run? and which sheet does it fail to remove?"}, {"owner": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "edited": false, "score": 0, "creation_date": 1494424979, "post_id": 43891762, "comment_id": 74823538, "body": "1 Sheet which is the sheet named &quot;P High Offstd&quot;.  This sheet is the 5th sheet in the workbook.  I am aware that I could technically do a sheet count and remove sheets 3-7 but I wanted to be more accurate to avoid user error."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "edited": false, "score": 1, "creation_date": 1494425085, "post_id": 43891762, "comment_id": 74823627, "body": "To avoid user error use the vba object name instead of the Sheet name. Check the sheet name that there are no additonal spaces (Including inbetween each word)"}, {"owner": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "edited": false, "score": 0, "creation_date": 1494426238, "post_id": 43891762, "comment_id": 74824554, "body": "I think it was just a name issue after I removed all spaces it worked."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "edited": false, "score": 0, "creation_date": 1494426378, "post_id": 43891762, "comment_id": 74824650, "body": "Glad you found it. Try to use the vba object name in future - Saves a lot of time in code and avoids a lot of errors like this"}, {"owner": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "edited": false, "score": 0, "creation_date": 1494514108, "post_id": 43891762, "comment_id": 74870813, "body": "In this code the issue with using the object name is each time it creates a new sheet it adds 1 to the previous set so for instance the sheets were .sheet3-7 and then the next time it created the sheet, even though the previous sheets were deleted it named the next ones .sheet8-12.  Is there a way to avoid this when the created sheet is named?  That would solve all of my issues with using the vba object name."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1494417249, "creation_date": 1494417249, "answer_id": 43891762, "question_id": 43882334, "link": "https://stackoverflow.com/questions/43882334/excel-delete-sheets-previously-created/43891762#43891762", "title": "Excel delete Sheets previously created", "body": "<p>Your code can be simplified to</p>\n\n<pre><code>With Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\nEnd With\n\nFor Each Sheet In ActiveWorkbook.Worksheets\n    If Sheet.Name = \"Processing 0% Performance\" Or Sheet.Name = \"Processing 0 OnStd\" _\n    Or Sheet.Name = \"P High OffStd\" Or Sheet.Name = \"P High OffStd\" Or Sheet.Name = \"Processing Low Performance\" Then\n        Sheet.Delete\nNext Sheet\n\nWith ActiveWorkbook.Worksheets(\"Processing\")\n    .Range(\"AA1:AZ\" &amp; .Range(\"AA1\").End(xlDown).Row).ClearContents\n    .Range(\"C3:C\" &amp; .Range(\"C3\").End(xlDown).Row).ClearContents\n    .Range(\"E3:E\" &amp; .Range(\"E3\").End(xlDown).Row).ClearContents\nEnd With\nWith Application\n    .DisplayAlerts = True\n    .ScreenUpdating = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7776669, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a588f502c4a2f16cf6495a62beb565f?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Herr", "link": "https://stackoverflow.com/users/7776669/greg-herr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 43891762, "answer_count": 1, "score": 1, "last_activity_date": 1494417249, "creation_date": 1494380738, "last_edit_date": 1494383709, "question_id": 43882334, "link": "https://stackoverflow.com/questions/43882334/excel-delete-sheets-previously-created", "title": "Excel delete Sheets previously created", "body": "<p>I have a Macro which I have set up to go through multiple sorts and filters and at the end of each step it creates a new worksheet and pastes the filtered information.  </p>\n\n<p>When I want the person to be able to use the same workbook with a new set of data I want the Macro to start by deleting all of the previously created sheets.  </p>\n\n<p>I have tried multiple styles of code which all delete worksheets but cannot get it to delete \"P High Offstd.\"  </p>\n\n<p>I have tried adjusting the orders of the delete as well as various ways to delete worksheets but it refuses to delete that worksheet.  </p>\n\n<p>I have even tried changing the name as it used to be called Processing High Offstd.  Any assistance would be beneficial.</p>\n\n<pre><code>Application.ScreenUpdating = False\nFor Each Sheet In ActiveWorkbook.Worksheets\nIf Sheet.Name = \"Processing 0% Performance\" Then\n    Application.DisplayAlerts = False\n    Worksheets(\"Processing 0% Performance\").Delete\n    Application.DisplayAlerts = True\nEnd If\nNext Sheet\nFor Each Sheet In ActiveWorkbook.Worksheets\nIf Sheet.Name = \"Processing 0 OnStd\" Then\n    Application.DisplayAlerts = False\n    Worksheets(\"Processing 0 OnStd\").Delete\n    Application.DisplayAlerts = True\nEnd If\nNext Sheet\nFor Each Sheet In ActiveWorkbook.Worksheets\nIf Sheet.Name = \"P High OffStd\" Then\n    Application.DisplayAlerts = False\n    Worksheets(\"P High OffStd\").Delete\n    Application.DisplayAlerts = True\nEnd If\nNext Sheet\nFor Each Sheet In ActiveWorkbook.Worksheets\nIf Sheet.Name = \"Processing Low Performance\" Then\n    Application.DisplayAlerts = False\n    Worksheets(\"Processing Low Performance\").Delete\n    Application.DisplayAlerts = True\nEnd If\nNext Sheet\nWith ActiveWorkbook.Worksheets(\"Processing\")\n.Range(\"AA1:AZ\" &amp; .Range(\"AA1\").End(xlDown).Row).ClearContents\n.Range(\"C3:C\" &amp; .Range(\"C3\").End(xlDown).Row).ClearContents\n.Range(\"E3:E\" &amp; .Range(\"E3\").End(xlDown).Row).ClearContents\nEnd With\n</code></pre>\n"}, {"tags": ["forms", "vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1494379193, "post_id": 43882124, "comment_id": 74799070, "body": "Where do I find the rectangle? Are you talking about MS Word? I&#39;m using version 2010."}, {"owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1494379401, "post_id": 43882124, "comment_id": 74799129, "body": "Sorry I didn&#39;t read correctly, for some reason I thought u were using MS Access (not MS Word). You can use a label with a background color as likely the simplest solution."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1494379968, "post_id": 43882124, "comment_id": 74799250, "body": "Yes! That&#39;s what I &quot;discovered&quot; years ago and forgot. Please modify your answer and I&#39;ll accept it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1494380102, "post_id": 43882124, "comment_id": 74799263, "body": "@Variatus a label with <code>SpecialEffect=fmSpecialEffectEtched</code> and an empty <code>Caption</code> looks just like what I think you&#39;re afer."}], "tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": true, "score": 3, "last_activity_date": 1494380194, "last_edit_date": 1494380194, "creation_date": 1494378978, "answer_id": 43882124, "question_id": 43882057, "link": "https://stackoverflow.com/questions/43882057/create-a-group-box-in-word-userform/43882124#43882124", "title": "Create a &#39;Group Box&#39; in Word Userform", "body": "<p>For MS Word use a label with a background color.</p>\n\n<p>For MS Access use the rectangle Object behind the controls.</p>\n\n<p>First make the form background a grey color. Then add subforms(ms access) and rectangles to segment the controls. </p>\n\n<p>The end effect is it looking like a paneled interface.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494379397, "post_id": 43882152, "comment_id": 74799126, "body": "That&#39;s <i>visually</i> sound, but overlapping controls <i>technically</i> isn&#39;t. But upvoted for answering OP&#39;s question quite exactly as it was asked - &quot;Could I place a Text Box, for example, in front of a Frame control without it also being &quot;within&quot; it?&quot;"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1494379662, "post_id": 43882152, "comment_id": 74799187, "body": "How can I move the frame to the back? I&#39;m using MS Word 2010."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1494379710, "post_id": 43882152, "comment_id": 74799197, "body": "I&#39;ve never actually used this in a form, but noticed that it would work while &quot;messing around&quot;. What are the pitfalls?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1494379713, "post_id": 43882152, "comment_id": 74799199, "body": "@Mat&#39;s Mug: What is the technical reason for overlapping controls not being &quot;technically sound&quot;?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1494379863, "post_id": 43882152, "comment_id": 74799231, "body": "@Rich Holton -The immediate &quot;pitfall&quot; is that my version of Word doesn&#39;t seem to offer the capability of placing controls in front of each other."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1494380158, "post_id": 43882152, "comment_id": 74799273, "body": "@Variatus hmm, in older versions of Windows / Office it was a problem IIRC. After some quick research it appears fixed. Still, container controls are designed and meant to <i>contain</i> child controls; there&#39;s a bit of a logical relationship between the controls."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1494380693, "post_id": 43882152, "comment_id": 74799411, "body": "@Variatus: I&#39;m working on it right now. It isn&#39;t quite what I remember, but I&#39;ll let you know when I figure it out."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1494382828, "post_id": 43882152, "comment_id": 74799909, "body": "@Variatus: I&#39;m sorry, I get make it work the way I remember. Either my memory is false, or something has changed. In VBE, under the Format menu, the last item is Order (I think). The sub-menu gives options to move-to-back, Move-to-front, etc. It&#39;s equivalent to the zorder method. But apparently, you can&#39;t use this on a Frame. It may work on a Text Box behind other controls though. I didn&#39;t try that."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1494388459, "post_id": 43882152, "comment_id": 74801159, "body": "@Rich Holton: Thanks for your effort. Your memory is undiminishedly perfect :-). I didn&#39;t even know it was there. But having chewed on this for a week I was so relieved to be reminded to use labels for this I threw out my frames without a minute&#39;s delay. Didn&#39;t stop to even think of what they might do to my grey hair if they could be moved to the back. After I recover I shall try. Thank you for your support."}], "tags": [], "owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "is_accepted": false, "score": 1, "last_activity_date": 1494379215, "creation_date": 1494379215, "answer_id": 43882152, "question_id": 43882057, "link": "https://stackoverflow.com/questions/43882057/create-a-group-box-in-word-userform/43882152#43882152", "title": "Create a &#39;Group Box&#39; in Word Userform", "body": "<p>You can use a Frame control. Place the other controls first, then place the Frame control, and move it to the back. This should look visually identical to having the controls in the Frame.</p>\n"}], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 43882124, "answer_count": 2, "score": 1, "last_activity_date": 1494380194, "creation_date": 1494378468, "question_id": 43882057, "link": "https://stackoverflow.com/questions/43882057/create-a-group-box-in-word-userform", "title": "Create a &#39;Group Box&#39; in Word Userform", "body": "<p>\"Group Box\", for lack of a better word: I want areas in my user form which are visually different from others, with a different background colour and a frame around them, such as is possible to create using Frame controls. However, I want none of the events of Frame controls and none of their interaction with other controls in the form.</p>\n\n<p>More particular, I want to be able to tab through all text, list, combo and check boxes, regardless of their location in 'Group Boxes', in fact also regardless of the possible location of their 'Group Box' within another 'Group Box'. Most of my controls have On Enter, On Exit, On Change and On Key even procedures attached to them which may re-direct the focus to any control on the form. Doing so under the constant interference of Frame controls with their events and rules - many of them not working correctly, none of them properly explained anywhere - is a gargantuan task. The easy way would be to have the visual design capabilities only, without the \"intelligence\" which assumes control in a way not compatible with my own plans.</p>\n\n<p>Perhaps the one feature of frames which makes them unfit for my purposes is that they act as forms within the form, meaning they appoint an ActiveControl when activated which they refuse to release when another control takes the focus outside their own frame. It is inconvenient to prevent a first control's On Enter procedure from running when <strong>any</strong> control in a frame receives the focus (different for first and subsequent times), but it's a much bigger task to deal with the selected control's On Exit event which won't fire until the form is closed, meaning it is missed when the control optically loses the focus and a nuisance when it technically does.</p>\n\n<p>Is there a control that fits my needs in MS Word? Or can the Frame control be stripped of its events in some way? Could I place a Text Box, for example, in front of a Frame control without it also being \"within\" it?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3058, "user_id": 2481559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/iVWj1.jpg?s=128&g=1", "display_name": "Josan Iracheta", "link": "https://stackoverflow.com/users/2481559/josan-iracheta"}, "edited": false, "score": 0, "creation_date": 1494372984, "post_id": 43881368, "comment_id": 74797714, "body": "The <code>away</code> row is manually populated, correct?"}, {"owner": {"reputation": 53, "user_id": 3839914, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/211595a80498c47142fde86b1743534c?s=128&d=identicon&r=PG&f=1", "display_name": "user3839914", "link": "https://stackoverflow.com/users/3839914/user3839914"}, "reply_to_user": {"reputation": 3058, "user_id": 2481559, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/iVWj1.jpg?s=128&g=1", "display_name": "Josan Iracheta", "link": "https://stackoverflow.com/users/2481559/josan-iracheta"}, "edited": false, "score": 0, "creation_date": 1494373750, "post_id": 43881368, "comment_id": 74797893, "body": "Yes, Away row is manually populated Josan. Thanks."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1494374563, "post_id": 43881368, "comment_id": 74798057, "body": "What formula, etc, are in the current lines above?  Or are they just hardcoded values, in which case it&#39;s going to be hard to replace them with a formula (but it would possibly be possible to generate new rows based on the original lines, plus the &quot;away&quot; line)"}, {"owner": {"reputation": 53, "user_id": 3839914, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/211595a80498c47142fde86b1743534c?s=128&d=identicon&r=PG&f=1", "display_name": "user3839914", "link": "https://stackoverflow.com/users/3839914/user3839914"}, "edited": false, "score": 0, "creation_date": 1494374759, "post_id": 43881368, "comment_id": 74798111, "body": "Either way is fine, either formula above or to generate new rows based on the original lines and the &quot;away&quot; values. How to generate new rows, based on these values ?"}], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 7838734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb24434f461b81c75b23bc4b2ba9da6?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Grigsby", "link": "https://stackoverflow.com/users/7838734/phil-grigsby"}, "is_accepted": true, "score": 1, "last_activity_date": 1494389447, "creation_date": 1494389447, "answer_id": 43883431, "question_id": 43881368, "link": "https://stackoverflow.com/questions/43881368/excel-query-deleting-column-values/43883431#43883431", "title": "Excel Query - Deleting Column Values", "body": "<p>Here is a possible solution using Excel VBA.</p>\n\n<p>First, the contents of the original roster (named \"Master\") are copied to a new worksheet \"Updated Roster\".  This lets you keep an unchanged copy of the original roster, in case you later <strong>remove</strong> a name from the \"Away\" row and need to re-apply the updates.</p>\n\n<p>Next, the first column is scanned to locate the \"Away:\" row.</p>\n\n<p>Finally, for each of the remaining columns, the list of \"away\" names is loaded into an array.</p>\n\n<p>Then, each \"away\" name is processed one at a time.  Each occurrence of the name is removed from each row of the roster by matching against regular expressions and then replacing with either a comma or nothing, as appropriate.</p>\n\n<pre><code>Option Explicit\n\nDim AwayRowNbr As Long\n\nSub UpdateRoster()\n\n  Dim UpdatedRoster As Worksheet\n  Dim RowNbr As Long\n  Dim ColNbr As Long\n  Dim MaxColNbr As Long\n  Dim MaxRowNbr As Long\n\n  ' Insert new \"Updated Roster\" worksheet\n  Set UpdatedRoster = Sheets.Add(After:=Sheets(Sheets.Count))\n  UpdatedRoster.Name = \"Updated Roster\"\n\n  With ThisWorkbook.Worksheets(\"Updated Roster\")\n\n    ' Copy contents of \"Master\" worksheet to \"Updated Roster\"\n    ThisWorkbook.Worksheets(\"Master\").Cells.Copy Destination:=.Cells\n\n    ' Locate \"Away\" row, and determine last column with data\n    AwayRowNbr = .Range(\"A:A\").Find(What:=\"Away:\", LookIn:=xlValues).Row\n    MaxColNbr = .Cells(AwayRowNbr, Columns.Count).End(xlToLeft).Column\n\n    For ColNbr = 2 To MaxColNbr\n      Call RemoveNames(.Cells(AwayRowNbr, ColNbr).Value, ColNbr)\n    Next ColNbr\n\n  End With\n\nEnd Sub\n\nSub RemoveNames(AwayNames As String, ColNbr As Long)\n\n   Dim AwayName() As String\n   Dim Name As String\n   Dim NameIdx As Integer\n   Dim RegEx As Object\n   Dim RowNbr As Long\n   Dim MaxRowNbr As Long\n   Dim BeforeReplace As String\n   Dim AfterReplace As String\n\n   With ThisWorkbook.Worksheets(\"Updated Roster\")\n\n     ' Create regular expression object\n     Set RegEx = CreateObject(\"vbscript.regexp\")\n     RegEx.Global = False\n\n     ' Load \"away\" names into a String array\n     AwayName() = Split(AwayNames, \",\")\n\n     ' Determine last row with data\n     MaxRowNbr = .Cells(Rows.Count, ColNbr).End(xlUp).Row\n\n     ' Process each \"away\" name\n     For NameIdx = LBound(AwayName) To UBound(AwayName)\n       Name = Trim(AwayName(NameIdx))\n       For RowNbr = 2 To MaxRowNbr\n         If RowNbr &lt;&gt; AwayRowNbr Then\n\n           AfterReplace = .Cells(RowNbr, ColNbr).Value\n\n           ' Remove name if delimited by commas\n           RegEx.Pattern = \", *\" &amp; Name &amp; \" *,\"\n           Do\n             BeforeReplace = AfterReplace\n             AfterReplace = RegEx.Replace(BeforeReplace, \",\")\n           Loop Until BeforeReplace = AfterReplace\n\n           ' Remove name if at beginning or end of cell\n           RegEx.Pattern = \"(^ *\" &amp; Name &amp; \" *,)|(, *\" &amp; Name &amp; \" *$)|(^ *\" &amp; Name &amp; \" *$)\"\n           Do\n             BeforeReplace = AfterReplace\n             AfterReplace = RegEx.Replace(BeforeReplace, \"\")\n           Loop Until BeforeReplace = AfterReplace\n\n           .Cells(RowNbr, ColNbr).Value = AfterReplace\n\n         End If\n       Next RowNbr\n     Next NameIdx\n\n   End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 3839914, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/211595a80498c47142fde86b1743534c?s=128&d=identicon&r=PG&f=1", "display_name": "user3839914", "link": "https://stackoverflow.com/users/3839914/user3839914"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 43883431, "answer_count": 1, "score": 0, "last_activity_date": 1494389447, "creation_date": 1494372752, "last_edit_date": 1531161705, "question_id": 43881368, "link": "https://stackoverflow.com/questions/43881368/excel-query-deleting-column-values", "title": "Excel Query - Deleting Column Values", "body": "<p>In our team roster, we are trying to remove the shifts of people, who are away on a given day. For e.g. in the screenshot for 25th May 2017 entry, Leo is away. What formula/option/code can I use in the lines above, so that all of the Leo's shifts are automatically deleted - based on the manual entry in this \"Away\" Column. </p>\n\n<p><img src=\"https://i.stack.imgur.com/ySCMd.png\" alt=\"This is the link to the screenshot of roster\"></p>\n"}, {"tags": ["excel", "vb.net", "vba", "vsto", "excel.application"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7988219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QTvYO.jpg?s=128&g=1", "display_name": "Edson Mota", "link": "https://stackoverflow.com/users/7988219/edson-mota"}, "is_accepted": true, "score": 0, "last_activity_date": 1495025986, "creation_date": 1495025986, "answer_id": 44025621, "question_id": 43881325, "link": "https://stackoverflow.com/questions/43881325/how-to-load-powerpivot-data-model-with-multiple-tables/44025621#44025621", "title": "How to load powerpivot data model with multiple tables?", "body": "<p>It looks like there's an incompatibility, regards the office 2016 be a single thread application. It makes the Add2 command be blocked from Excel UI</p>\n\n<p>You can see the full answer here: <a href=\"https://social.msdn.microsoft.com/Forums/en-US/ddf2ab36-14a5-431c-b465-114aee6eb5d6/how-to-load-powerpivot-data-model-with-multiple-tables-vsto-excel-application?forum=vsto\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/ddf2ab36-14a5-431c-b465-114aee6eb5d6/how-to-load-powerpivot-data-model-with-multiple-tables-vsto-excel-application?forum=vsto</a></p>\n\n<p>Thank you!</p>\n"}], "owner": {"reputation": 11, "user_id": 7988219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QTvYO.jpg?s=128&g=1", "display_name": "Edson Mota", "link": "https://stackoverflow.com/users/7988219/edson-mota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 44025621, "answer_count": 1, "score": 0, "last_activity_date": 1499550091, "creation_date": 1494372457, "last_edit_date": 1499550091, "question_id": 43881325, "link": "https://stackoverflow.com/questions/43881325/how-to-load-powerpivot-data-model-with-multiple-tables", "title": "How to load powerpivot data model with multiple tables?", "body": "<p>I need to create an Excel application based on some tables.</p>\n\n<p>I ran the code in VBA and it worked. In \"Visual Studio\" it doesn't work.</p>\n\n<p>My code here:</p>\n\n<pre><code>Dim xlApp As Excel.Application\nxlApp = Globals.ThisAddIn.Application\nxlApp.ActiveWorkbook.Connections.Add2(\"Target Connection Name\", \"\", _\n     \"OLEDB;Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Data Source=SERVER\\SQLEXPRESS;Use Procedure for Prepare=1;Auto Translate=True;Packet \n      Size=8192;Workstation ID=NAME;Use Encryption for Data=False;Tag with column collation when possible=False;Initial Catalog=MYSQLDATABASE;\", _\n      \"\"\"TAB_CATEGORIA\"\",\"\"TAB_MOVIMENTO\"\"\", Excel.XlCmdType.xlCmdTableCollection, vbTrue, vbTrue)\n</code></pre>\n\n<p>When I execute this code, I receive the following message:</p>\n\n<blockquote>\n  <p>\"The cartridge directory could not be found. Use the Windows Installer\n  to repair the application.\"</p>\n</blockquote>\n\n<p>I realized that when we generate a new instance, it works: </p>\n\n<pre><code>Dim xlApp As NEW Excel.Application \n</code></pre>\n\n<p>But, unfortunately, I <strong>need</strong> the current instance </p>\n\n<pre><code>xlApp = Globals.ThisAddIn.Application\n</code></pre>\n\n<p>When I use \"Globals.ThisAddIn.Application\" to generate a WorkbookConnection object, the exception is thrown.</p>\n\n<blockquote>\n  <p>More information,</p>\n  \n  <ul>\n  <li>Office 2013 updated</li>\n  <li>Visual Studio 2015 updated</li>\n  </ul>\n</blockquote>\n\n<p>**** You can see just below my stack trace *****</p>\n\n<pre><code>System.Runtime.InteropServices.COMException was unhandled by user code\n  ErrorCode=-2146827284\n  HelpLink=xlmain11.chm\n  HResult=-2146827284\n  Message=N\u00e3o pudemos obter dados do Modelo de Dados. Veja a mensagem de erro que recebemos:\n\nThe cartridge directory could not be found. Use the Windows Installer to repair the application. \n  Source=Microsoft Excel\n  StackTrace:\n       em System.RuntimeType.ForwardCallToInvokeMember(String memberName, BindingFlags flags, Object target, Int32[] aWrapperTypes, MessageData&amp; msgData)\n       em Microsoft.Office.Interop.Excel.Connections.Add2(String Name, String Description, Object ConnectionString, Object CommandText, Object lCmdtype, Object CreateModelConnection, Object ImportRelationships)\n       em ExcelAddIn2.Conectar.Button1_Click(Object sender, RibbonControlEventArgs e) na D:\\work\\projetos\\SPHERA\\OmieDecisionMaker\\OmieDecisionMaker\\ExcelAddIn2\\Ribbon1.vb:linha 37\n       em Microsoft.Office.Tools.Ribbon.RibbonPropertyStorage.ControlActionRaise(IRibbonControl control)\n       em Microsoft.Office.Tools.Ribbon.RibbonPropertyStorage.ButtonClickCallback(RibbonComponentImpl component, Object[] args)\n       em Microsoft.Office.Tools.Ribbon.RibbonManagerImpl.Invoke(RibbonComponentCallback callback, Object[] args)\n       em Microsoft.Office.Tools.Ribbon.RibbonManagerImpl.System.Reflection.IReflect.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args, ParameterModifier[] modifiers, CultureInfo culture, String[] namedParameters)\n  InnerException:\n</code></pre>\n"}, {"tags": ["excel", "vba", "oledb"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1494366787, "post_id": 43880271, "comment_id": 74795901, "body": "Please show the code where you are assigning that connection string to a variable. Generally, it should be like <code>strConnection = &quot;Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data  Source=&quot; &amp; ThisWorkbook.FullName &amp; &quot;;Mode=ReadWrite;...&quot;</code>, check <a href=\"http://stackoverflow.com/a/33400291/2165759\">this answer</a>. If you need to sort or filter records only, then <a href=\"http://stackoverflow.com/a/36189658/2165759\">this one</a> may be helpful."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494375172, "post_id": 43880271, "comment_id": 74798187, "body": "The file needs to be saved somewhere on disk before you can use a SQL query against it, and you need to pass the actual file path in the connection string."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1494396226, "post_id": 43880271, "comment_id": 74803658, "body": "This is exactly what I want to omit by needing to specify the data source programmatically. Is there no other way I.e. by using Power Queen or sorts. It seems like a pretty obvious scenario. Even changing the name or location of the Excel workbook the macro needs to update the data source"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494428771, "post_id": 43880271, "comment_id": 74826676, "body": "It&#39;s not clear why you really don&#39;t want to use the obvious solution?"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1494511229, "post_id": 43880271, "comment_id": 74868401, "body": "@TimWilliams because the obvious solution is not to use VBA if that is possible. Even if I pass the actual file path if I save the file with a new name or send it via email it work work anymore."}], "answers": [{"comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1500887045, "post_id": 45254480, "comment_id": 77515065, "body": "This does not solve the issue in any way. This still requires manual update of the cell reference."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1500726082, "creation_date": 1500726082, "answer_id": 45254480, "question_id": 43880271, "link": "https://stackoverflow.com/questions/43880271/running-an-ms-query-on-the-current-excel-workbook/45254480#45254480", "title": "Running an MS Query on the current Excel Workbook", "body": "<p>Hummmm, can you put <code>Data Source=C:\\myfile.xlsm</code> into a cell reference and pass that as a parameter?</p>\n\n<p>STRING \" &amp; Worksheet(\"Sheet1\").Range(\"A1\").Value &amp; \" STRING</p>\n"}], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1500726082, "creation_date": 1494365867, "last_edit_date": 1494396320, "question_id": 43880271, "link": "https://stackoverflow.com/questions/43880271/running-an-ms-query-on-the-current-excel-workbook", "title": "Running an MS Query on the current Excel Workbook", "body": "<p><strong>How to run an MS Query (Ace Oledb) on the current Excel workbook without having to specify an external data source in the connection string? i.e Data Source file path</strong></p>\n\n<p>Below is my full connection string:</p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data \nSource=C:\\myfile.xlsm;Mode=ReadWrite;Extended Properties=\"Excel 12.0 \nXml;HDR=YES\";Jet OLEDB:System database=\"\";Jet OLEDB:Registry Path=\"\";\nJet OLEDB:Engine Type=35;Jet OLEDB:Database Locking Mode=0;Jet OLEDB:Global \nPartial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New \nDatabase Password=\"\";Jet OLEDB:Create System Database=False;Jet \nOLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on \nCompact=False;Jet OLEDB:Compact Without Replica Repair=False;Jet \nOLEDB:SFP=False;Jet OLEDB:Support Complex Data=False;Jet OLEDB:Bypass \nUserInfo Validation=False;Jet OLEDB:Limited DB Caching=False;Jet \nOLEDB:Bypass ChoiceField Validation=False\n</code></pre>\n\n<p>I would like to remove this reference <code>Data Source=C:\\myfile.xlsm</code> <strong>making the connection string assume it should always reference the current Excel file</strong>.</p>\n\n<p>What I want is to be able to setup an MS Query in my Excel file that can be shared via email to other users. Currently I need to programatically (VBA) replace the Data Source in the connection string which is not an elegant solution. I want to avoid any need of vba usage.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1494366174, "last_edit_date": 1494366174, "creation_date": 1494365235, "answer_id": 43880135, "question_id": 43880054, "link": "https://stackoverflow.com/questions/43880054/retrofit-vba-code-so-it-can-loop-through-columns/43880135#43880135", "title": "Retrofit VBA code so it can loop through columns", "body": "<p>It is probably best to calculate the \"last row\" once, e.g.</p>\n\n<pre><code>lastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>That then allows your current statement of</p>\n\n<pre><code>Range(\"B2:B\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Formula =\n</code></pre>\n\n<p>to be replaced by the equivalent</p>\n\n<pre><code>Range(\"B2:B\" &amp; lastRow).Formula =\n</code></pre>\n\n<p>which can be re-expressed, using <code>Cells</code> instead of addresses, as</p>\n\n<pre><code>Range(Cells(2, \"B\"), Cells(lastRow, \"B\")).Formula =\n</code></pre>\n\n<p>This can then be easily converted to a formula which uses a variable for the column:</p>\n\n<pre><code>Range(Cells(2, c), Cells(lastRow, c)).Formula =\n</code></pre>\n\n<p>Note that the column parameter of the <code>Cells</code> object can be either expressed as a number (i.e. column 1, 2, 3, etc) or as a string (i.e. column \"A\", \"B\", \"C\", etc).  Using a numeric value is useful when iterating over multiple columns.  Using a string value is useful when you are just using a single, known, column - it makes the code more \"readable\".</p>\n\n<hr>\n\n<p>Your rewritten code could therefore be:</p>\n\n<pre><code>Dim c As Long\nDim lastRow As Long\nlastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nFor c = 2 To Cells(1, Columns.Count).End(xlToLeft).Column\n    Range(Cells(2, c), Cells(lastRow, c)).Formula = \"[super convoluted formula]\"\n    Range(Cells(2, c), Cells(lastRow, c)).Value = _\n             Range(Cells(2, c), Cells(lastRow, c)).Value\nNext\n</code></pre>\n\n<p>(There is no need to do a copy/paste if you are just trying to paste values - it will be safer to just set the <code>Value</code> property to the <code>Value</code> property.)</p>\n"}], "owner": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 43880135, "answer_count": 1, "score": 0, "last_activity_date": 1494366174, "creation_date": 1494364820, "last_edit_date": 1531164843, "question_id": 43880054, "link": "https://stackoverflow.com/questions/43880054/retrofit-vba-code-so-it-can-loop-through-columns", "title": "Retrofit VBA code so it can loop through columns", "body": "<p>I have been using this bit of code in my VBA tinkering for years:</p>\n\n<pre><code>Range(\"B2:B\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Formula = _\n    \"\"\nRange(\"B2:B\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n\n<p>I now need to be able to take this function, and loop it through 1460 columns, but that 1460 will be variable.</p>\n\n<p>My tries so far look like this:</p>\n\n<pre><code>Dim a As Interger\na = 3\n\nDo While Cells(1, a) &lt;&gt; \"\"\n\n    Range(Range(\"R1Ca:RCa\") &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Formula = _\n        \"[super convoluted formula]\"\n    Range(Range(\"R1Ca:RCa\") &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n\n    a = a + 1\n\nLoop\n</code></pre>\n\n<p>So my focused question at this point is how do I modify the \"B2:B\" in my starting example into a variable that can be looped to hit all of the columns?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1494372383, "post_id": 43880004, "comment_id": 74797568, "body": "i&#39;m not on my computer so this is a rough alternative : delete all your sub. Range(&quot;d3&quot;).shapes.comment.visible=not range(&quot;d3&quot;).shapes.comment.visible.    .but could be shaperange instead shapes. Sorry for my bad formating, the phone writing is very difficult."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1494399667, "post_id": 43880004, "comment_id": 74805317, "body": "Nana, please practice using the code formatting controls here, so that your code appears in block formatting, as per my edit."}], "answers": [{"tags": [], "owner": {"reputation": 190, "user_id": 5924247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3c5cfadb8d5900db455505c409e111?s=128&d=identicon&r=PG&f=1", "display_name": "FTSC", "link": "https://stackoverflow.com/users/5924247/ftsc"}, "is_accepted": true, "score": 0, "last_activity_date": 1494367643, "creation_date": 1494367643, "answer_id": 43880635, "question_id": 43880004, "link": "https://stackoverflow.com/questions/43880004/trying-to-use-a-shape-button-to-toggle-in-vba-to-hide-or-expose-a-comment/43880635#43880635", "title": "Trying to use a shape button to toggle in VBA to hide or expose a comment", "body": "<p>Try this, call this routine from the click event of the image:</p>\n\n<pre><code>Sub CommentOnOff()\n\nDim cmt As Comment\n\nIf Worksheets(\"Sheet1\").Comments.Count = 0 Then\nMsgBox \"There are no comments added to this sheet.\", vbOKOnly, \"No comments \non this sheet\"\nExit Sub\nEnd If\n\nIf Application.DisplayCommentIndicator = xlCommentIndicatorOnly Then\nApplication.DisplayCommentIndicator = xlCommentAndIndicator\nFor Each cmt In ActiveSheet.Comments\ncmt.Shape.Top = cmt.Parent.Top + 5\ncmt.Shape.Left = _\ncmt.Parent.Offset(0, 1).Left + 5\nNext\n\nElse\nApplication.DisplayCommentIndicator = xlCommentIndicatorOnly\nFor Each cmt In ActiveSheet.Comments\ncmt.Shape.Top = cmt.Parent.Top + 5\ncmt.Shape.Left = _\ncmt.Parent.Offset(0, 1).Left + 5\nNext\nEnd If\n\nSet cmt = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7988186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86bacf44ad6ff26e0f01fc8b1b9e640?s=128&d=identicon&r=PG&f=1", "display_name": "Nana", "link": "https://stackoverflow.com/users/7988186/nana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 43880635, "answer_count": 1, "score": 0, "last_activity_date": 1494399636, "creation_date": 1494364536, "last_edit_date": 1531164843, "question_id": 43880004, "link": "https://stackoverflow.com/questions/43880004/trying-to-use-a-shape-button-to-toggle-in-vba-to-hide-or-expose-a-comment", "title": "Trying to use a shape button to toggle in VBA to hide or expose a comment", "body": "<p>However, I don't want to use the ActiveXcontrol button.</p>\n\n<pre><code>Sub togglingashape()\n' I recorded a macro to give me the target shape\n' Active.Shapes.Range(Array(\"Flowchart: Alternate Process 1\"))\n' to use in condition below :\n\nIf Active.Shapes.Range(Array(\"Flowchart: Alternate Process 1\")).Value = True Then\n\n    Range(\"D3\").Comment.Visible = True\n\nElse\n    Range(\"D3\").Comment.Visible = False\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone help?</p>\n"}]