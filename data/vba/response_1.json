[{"tags": ["vba", "collections"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1421283691, "last_edit_date": 1421283691, "creation_date": 1421283276, "answer_id": 27955178, "question_id": 27954559, "link": "https://stackoverflow.com/questions/27954559/adding-objects-to-collection-adds-only-the-most-recent-instance-over-and-over/27955178#27955178", "title": "Adding objects to Collection adds only the most recent instance over and over", "body": "<p>You need to declare the variable only once, but then using the keyword <code>Set</code> to assign the same variable to a new filmSheet instance reference each time:</p>\n\n<pre><code>Dim tempFilmSheet As filmSheet 'declare variable only once \n\nFor Each genre In genreCollection\n\n    Set tempFilmSheet = New filmSheet 'instantiate n-times    \n    Call tempFilmSheet.AddSheetToWorkbook(wb)\n    Call tempFilmSheet.SetGenre(genre)\n    Call tempFilmSheet.CopyFilmListRangeToSheet(originalDataSheet)\n    Call tempFilmSheet.DeleteUnrelatedRows\n    Call tempFilmSheet.CountFilmsInGenre\n    totalFilmCount = totalFilmCount + tempFilmSheet.filmCount\n    filmSheetCollection.Add tempFilmSheet\n\nNext\n</code></pre>\n\n<p>To better undestand the problem, you might want to read the difference between <a href=\"http://msdn.microsoft.com/en-us/library/gg251750(v=office.14).aspx\" rel=\"nofollow\">declaring an object</a> with <code>Dim</code> and <a href=\"http://msdn.microsoft.com/en-us/library/gg251642(v=office.14).aspx\" rel=\"nofollow\">setting an object to an object reference</a> with <code>Set</code>.</p>\n"}], "owner": {"reputation": 773, "user_id": 829962, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/18c1bc90065025ba96ddba64d7e4f6bd?s=128&d=identicon&r=PG", "display_name": "Darren", "link": "https://stackoverflow.com/users/829962/darren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 27955178, "answer_count": 1, "score": 0, "last_activity_date": 1421283691, "creation_date": 1421279069, "question_id": 27954559, "link": "https://stackoverflow.com/questions/27954559/adding-objects-to-collection-adds-only-the-most-recent-instance-over-and-over", "title": "Adding objects to Collection adds only the most recent instance over and over", "body": "<p>When I execute the following code, everything works as expected except the very last line within the loop body. While this does add a \"filmSheet\" object to the Collection, it fills it only with the very last filmSheet object that was created, over and over. Is this because all of the previous filmSheet objects are destroyed each time the code exits and reenters the loop? It is really odd, though, because it is as if it is overwriting all of the previous filmSheet objects with the very last one. Anyone have some insight into what is going on here and how it can be corrected?</p>\n\n<p>By the way, a filmSheet object is basically a wrapper class for an Excel worksheet object with some additional functionality.</p>\n\n<pre><code>For Each genre In genreCollection\n    Dim tempFilmSheet As New filmSheet\n\n    Call tempFilmSheet.AddSheetToWorkbook(wb)\n    Call tempFilmSheet.SetGenre(genre)\n    Call tempFilmSheet.CopyFilmListRangeToSheet(originalDataSheet)\n    Call tempFilmSheet.DeleteUnrelatedRows\n    Call tempFilmSheet.CountFilmsInGenre\n    totalFilmCount = totalFilmCount + tempFilmSheet.filmCount\n    filmSheetCollection.Add tempFilmSheet\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421277646, "post_id": 27954218, "comment_id": 44303590, "body": "Can you break this up into chunks of maybe 10k rows and process each chunk in a loop?"}, {"owner": {"reputation": 291, "user_id": 2321313, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/7985a65cbb3476d3a63ac553bdde09ac?s=128&d=identicon&r=PG", "display_name": "Futochan", "link": "https://stackoverflow.com/users/2321313/futochan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421278565, "post_id": 27954218, "comment_id": 44303895, "body": "@TimWilliams Hi Tim, do you mind showing me on how to breaking these into chunks? I am fairly new to vba.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1421281104, "post_id": 27954218, "comment_id": 44304742, "body": "The range <code>&quot;O2:AM&quot; &amp; lastrow2</code> is <i>within</i> <code>&quot;A1:BH&quot; &amp; lastrow2</code> so while it may make coding easier, you are using 40% more memory than you need to."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421282505, "post_id": 27954218, "comment_id": 44305104, "body": "@Futochan - hard to write an example without knowing what you plan to do with those arrays once you have them populated."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1421284162, "post_id": 27954218, "comment_id": 44305549, "body": "If you use <code>Dim vArray As Variant</code> the assignment would be <code>vArray = ThisWorkbook.Sheets(&quot;File&quot;).Range(&quot;A1:BH&quot; &amp; lastrow2)</code> with none of the bother in between. The array&#39;s index would be <i>1</i> based with <code>LBound(vArray, &lt;first rank&gt;)</code> and <code>UBound(vArray, &lt;last rank&gt;)</code> as extents."}, {"owner": {"reputation": 291, "user_id": 2321313, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/7985a65cbb3476d3a63ac553bdde09ac?s=128&d=identicon&r=PG", "display_name": "Futochan", "link": "https://stackoverflow.com/users/2321313/futochan"}, "edited": false, "score": 0, "creation_date": 1421359735, "post_id": 27954218, "comment_id": 44340570, "body": "@Jeeped what do I need to put for &lt;first rank&gt; and &lt;last rank&gt;? Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1421360393, "post_id": 27954218, "comment_id": 44340886, "body": "In this circumstance the <i>rank</i> is the same as column. If <i>lastrow2-</i> was <i>999</i> then vArray(2, 5) would be the same as E2. See <a href=\"http://msdn.microsoft.com/en-us/library/wak0wfyt.aspx\" rel=\"nofollow noreferrer\">Arrays in Visual Basic</a> \u25c4 search for <i>rank</i> on the page."}], "owner": {"reputation": 291, "user_id": 2321313, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/7985a65cbb3476d3a63ac553bdde09ac?s=128&d=identicon&r=PG", "display_name": "Futochan", "link": "https://stackoverflow.com/users/2321313/futochan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1421335364, "creation_date": 1421277187, "last_edit_date": 1531164843, "question_id": 27954218, "link": "https://stackoverflow.com/questions/27954218/out-of-memory-redim-varray-vba", "title": "Out of Memory Redim vArray VBA", "body": "<p>I have the following block of codes which searches the indicated range for text qualifiers and periods (dots). If these were found, it will be highlighted. The code ran fine if the data set is small but run into issues if the file is big. I tested it on a while with 55000 rows and it gave me a \"out of memory\" error. Is there any way around this? Thanks!</p>\n\n<pre><code>    'Check for extra text qualifiers and if there are periods\n    Keywords = Array(Chr(34), \"'\", \",\")\n    CodeKeyword = Array(\".\")\n    lastrow2 = ThisWorkbook.Worksheets(\"File\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set SearchRange = ThisWorkbook.Sheets(\"File\").Range(\"A1:BH\" &amp; lastrow2)\n    Set SearchRangeCode = ThisWorkbook.Sheets(\"File\").Range(\"O2:AM\" &amp; lastrow2)\n    iRange_Col = SearchRange.Columns.Count\n    iRange_Row = SearchRange.Rows.Count\n    iRangeCode_Col = SearchRangeCode.Columns.Count\n    iRangeCode_Row = SearchRangeCode.Rows.Count\n    ReDim vArray(1 To iRange_Row, 1 To iRange_Col)\n    ReDim vArrayCode(1 To iRangeCode_Row, 1 To iRangeCode_Col)\n    vArray = SearchRange\n    vArrayCode = SearchRangeCode\n</code></pre>\n"}, {"tags": ["excel", "cell", "autofill", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421284385, "post_id": 27953862, "comment_id": 44305596, "body": "You&#39;d need to describe how the range to be filled would be determined"}], "answers": [{"tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": false, "score": 0, "last_activity_date": 1448345738, "creation_date": 1448345738, "answer_id": 33886672, "question_id": 27953862, "link": "https://stackoverflow.com/questions/27953862/activecell-autofill-destination/33886672#33886672", "title": "ActiveCell.AutoFill Destination", "body": "<p>You can use a power table hence you can simply mention the range as <code>Range(\"Table1[#Headers],[Headername]\")</code></p>\n"}], "owner": {"reputation": 1, "user_id": 4455460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E5MC3ucZWjA/AAAAAAAAAAI/AAAAAAAAAnU/5hOKOdx3YR0/photo.jpg?sz=128", "display_name": "C L", "link": "https://stackoverflow.com/users/4455460/c-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 662, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448345738, "creation_date": 1421275618, "last_edit_date": 1531164843, "question_id": 27953862, "link": "https://stackoverflow.com/questions/27953862/activecell-autofill-destination", "title": "ActiveCell.AutoFill Destination", "body": "<p>I am new to VB programming and to excel macro.<br>\nI record a macro with below code.</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"Date today\"\nRange(\"J2\").Select\nActiveCell.FormulaR1C1 = \"=TODAY()\"\nActiveCell.AutoFill Destination:=Range(\"J2:J922\")\n</code></pre>\n\n<p>I want (\"J2:J922\") to be dynamic. Sometimes the column is not exactly J922. It can be below or above to the range.<br>\nCan anyone help me to what is the proper code for this?</p>\n"}, {"tags": ["vba", "outlook", "send-on-behalf-of"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4013265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3217b3a501a5491badb06231ddfd56d5?s=128&d=identicon&r=PG&f=1", "display_name": "Peng Lion", "link": "https://stackoverflow.com/users/4013265/peng-lion"}, "edited": false, "score": 0, "creation_date": 1421282411, "post_id": 27953480, "comment_id": 44305079, "body": "Thanks, this is helpful but not a solution for when I send on behalf. The drop down box only has my email address and not the other shared email account. I really need it to be &quot;when sent on behalf, or from AccountX&quot;."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1421273812, "last_edit_date": 1592644375, "creation_date": 1421273812, "answer_id": 27953480, "question_id": 27953328, "link": "https://stackoverflow.com/questions/27953328/always-cc-when-sending-on-behalf-of/27953480#27953480", "title": "Always CC when sending &quot;On Behalf Of&quot;", "body": "<p>This will do what you are looking for (It is the first Google results of &quot;always CC myself Outlook&quot;)\n<a href=\"http://www.extendoffice.com/documents/outlook/1108-outlook-auto-cc.html\" rel=\"nofollow noreferrer\">http://www.extendoffice.com/documents/outlook/1108-outlook-auto-cc.html</a></p>\n<ol>\n<li><p>Launch your outlook 2013 or 2010, and make sure that you are in the mail section. Then click Home &gt; Rules &gt; Manage Rules &amp; Alerts.</p>\n</li>\n<li><p>After selecting Manage Rules &amp; Alerts option, the Rules and Alerts dialog will popup. Under E-mail Rules, click New Rule option.</p>\n</li>\n<li><p>In the Rules Wizard, click Apply rule on messages I send then click Next to continue.</p>\n</li>\n<li><p>Then another dialog pops up.</p>\n<p>(1.) In Step 1, check through the specified account box. In Step 2, please click on the word - specified.\n(2.) And then click the Account drop down list to choose the account that you want to apply this rule.</p>\n</li>\n<li><p>After selecting the account, and click OK to return to the previous window, you will see the selected account showing in the Rules Wizard. Then click on Next button.</p>\n</li>\n<li><p>(1.) In this wizard, check Cc the message to people or public group box, and then click on people or public group in step 2.<br />\n(2.) In the Rule Address dialog box, double click your cc recipient to add the address to the To-&gt; text box, (If I want to cc myself, I will select or type my own email address in the To-&gt; column.), finally click OK.</p>\n</li>\n<li><p>It returns to the previous window, and you can see the cc recipient address appearing. Then click Finish button.</p>\n</li>\n<li><p>Now, it returns to the very beginning dialog, click OK button, then the cc rule will be created. If you don\u2019t want to enable the rule, uncheck it.</p>\n</li>\n</ol>\n<p>Then after sending or forwarding an email message to others with your specified account, your account or your specific cc recipient will always receive the same message.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 4013265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3217b3a501a5491badb06231ddfd56d5?s=128&d=identicon&r=PG&f=1", "display_name": "Peng Lion", "link": "https://stackoverflow.com/users/4013265/peng-lion"}, "edited": false, "score": 0, "creation_date": 1421343435, "post_id": 27964164, "comment_id": 44331741, "body": "Eugene - this sounds like what I&#39;m looking for. Unfortunately, I&#39;m not familiar with the Outlook objects or how I should structure any of the code. Also, would it make sense to add an &quot;if statement&quot; to check if I&#39;ve already CC&#39;d the SendOnBehalf user? Would you be able to provide some code structure as a starting point? I really appreciate your help."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 43, "user_id": 4013265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3217b3a501a5491badb06231ddfd56d5?s=128&d=identicon&r=PG&f=1", "display_name": "Peng Lion", "link": "https://stackoverflow.com/users/4013265/peng-lion"}, "edited": false, "score": 0, "creation_date": 1421343910, "post_id": 27964164, "comment_id": 44332063, "body": "Yes, you need to add the &quot;if&quot; statement to the code."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1421327185, "creation_date": 1421327185, "answer_id": 27964164, "question_id": 27953328, "link": "https://stackoverflow.com/questions/27953328/always-cc-when-sending-on-behalf-of/27964164#27964164", "title": "Always CC when sending &quot;On Behalf Of&quot;", "body": "<p>It looks like you need to handle the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff865076(v=office.15).aspx\" rel=\"nofollow\">ItemSend</a> event of the Application class. It is fired whenever an Microsoft Outlook item is sent, either by the user through an Inspector (before the inspector is closed, but after the user clicks the Send button) or when the Send method for an Outlook item, such as MailItem, is used in a program. Note, the Cancel parameter allows to cancel the process of sending the email. </p>\n\n<p>In the ItemSend event handler you can check out the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff862145(v=office.15).aspx\" rel=\"nofollow\">SentOnBehalfOfName</a> property of the item passed as a parameter and add the CC recipient using the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff865320(v=office.15).aspx\" rel=\"nofollow\">Recipients</a> property of the MailItem class. The Recipients collection provides the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff866951(v=office.15).aspx\" rel=\"nofollow\">Add</a> method for adding recipients. </p>\n\n<pre><code> Set myRecipient = myItem.Recipients.Add(\"Dan Wilson\") \n myRecipient.Type = OlMailRecipientType.olCC\n</code></pre>\n\n<p>After don't forget to call the <a href=\"http://msdn.microsoft.com/en-us/library/ff862796.aspx\" rel=\"nofollow\">Resolve</a> or ResolveAll method of the Recipient class to resolve a Recipient object against the Address Book.</p>\n\n<p>See <a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/08/outlook-fill-recipients-programmatically/\" rel=\"nofollow\">How To: Fill TO,CC and BCC fields in Outlook programmatically</a> for more information. </p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 4013265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3217b3a501a5491badb06231ddfd56d5?s=128&d=identicon&r=PG&f=1", "display_name": "Peng Lion", "link": "https://stackoverflow.com/users/4013265/peng-lion"}, "edited": false, "score": 0, "creation_date": 1421373492, "post_id": 27972587, "comment_id": 44344744, "body": "This is very very close to what I need. I added it to ThisOutlookSession but it won&#39;t automatically add &quot;Someone Else&quot; when I change the SentOnBehalfOfName = &quot;someone@somewhere.com&quot;. Can we have this code always running in the background so that when we change the &quot;From&quot; it will automatically add &quot;Someone Esle&quot;. Thanks for all the help!"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 43, "user_id": 4013265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3217b3a501a5491badb06231ddfd56d5?s=128&d=identicon&r=PG&f=1", "display_name": "Peng Lion", "link": "https://stackoverflow.com/users/4013265/peng-lion"}, "edited": false, "score": 0, "creation_date": 1421374857, "post_id": 27972587, "comment_id": 44345074, "body": "@Peng Lion the solution described in my first edit is now avaialble."}, {"owner": {"reputation": 43, "user_id": 4013265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3217b3a501a5491badb06231ddfd56d5?s=128&d=identicon&r=PG&f=1", "display_name": "Peng Lion", "link": "https://stackoverflow.com/users/4013265/peng-lion"}, "edited": false, "score": 0, "creation_date": 1421431467, "post_id": 27972587, "comment_id": 44370979, "body": "works perfectly as described. Thanks and great work! One improvement could be made - if the CC already has the desired item.Recipients.Add(&quot;Someone Else&quot;), we should skip adding it a second time. Thanks for answering my question!"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1421374646, "last_edit_date": 1421374646, "creation_date": 1421354463, "answer_id": 27972587, "question_id": 27953328, "link": "https://stackoverflow.com/questions/27953328/always-cc-when-sending-on-behalf-of/27972587#27972587", "title": "Always CC when sending &quot;On Behalf Of&quot;", "body": "<p>SentOnBehalfOfName is tricky. It is usually empty until the item has been sent.</p>\n\n<p>With this code in ThisOutlookSession you should find it blank.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal item As Object, Cancel As Boolean)\n\n    Dim myRecipient As Recipient\n\n    Debug.Print \" item.SentOnBehalfOfName - \" &amp; item.SentOnBehalfOfName\n\n    If item.SentOnBehalfOfName = \"someone@somewhere.com\" Then\n        Set myRecipient = item.Recipients.Add(\"Someone Else\")\n        myRecipient.Type = olCC\n        item.Recipients.ResolveAll\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>At least one way to get around this:</p>\n\n<pre><code>Sub createSentOnBehalf()\n\n    Dim objMsg As mailitem\n\n    Set objMsg = Application.CreateItem(olMailItem)\n    objMsg.SentOnBehalfOfName = \"someone@somewhere.com\"\n    objMsg.Display\n\n    Set objMsg = Nothing\n\nEnd Sub\n\nSub replySentOnBehalf()\n\n    Dim objMsg As mailitem\n\n    Set objMsg = ActiveInspector.currentItem.reply\n    objMsg.SentOnBehalfOfName = \"someone@somewhere.com\"\n    objMsg.Display\n\n    Set objMsg = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Edit: Just realized you could set the cc while creating / replying rather than waiting until ItemSend.</p>\n\n<p>Edit2: Move the cc code from itemsend</p>\n\n<pre><code>Sub createSentOnBehalf()\n\n    Dim objMsg As mailitem\n    Dim myRecipient As Recipient\n\n    Set objMsg = Application.CreateItem(olMailItem)\n    objMsg.SentOnBehalfOfName = \"someone@somewhere.com\"\n\n    Set myRecipient = objMsg.Recipients.Add(\"Someone Else\")\n    myRecipient.Type = olCC\n    objMsg.Recipients.ResolveAll\n\n    objMsg.Display\n\n    Set objMsg = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4013265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3217b3a501a5491badb06231ddfd56d5?s=128&d=identicon&r=PG&f=1", "display_name": "Peng Lion", "link": "https://stackoverflow.com/users/4013265/peng-lion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1709, "favorite_count": 0, "accepted_answer_id": 27972587, "answer_count": 3, "score": 0, "last_activity_date": 1593475009, "creation_date": 1421273161, "last_edit_date": 1593475009, "question_id": 27953328, "link": "https://stackoverflow.com/questions/27953328/always-cc-when-sending-on-behalf-of", "title": "Always CC when sending &quot;On Behalf Of&quot;", "body": "<p>I often send emails on behalf of another user. I'd like to use VBA to automatically CC that user every time I send an email from/on behalf of that user. </p>\n\n<p>I'm not familiar with VBA for Outlook but I'm thinking you could write an if statement that says \"if sending message from UserX, cc UserX\". The code should run automatically any time an email is sent on behalf.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 57, "user_id": 1825774, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6CPUJ.jpg?s=128&g=1", "display_name": "DD  CPA-MBA-DBA", "link": "https://stackoverflow.com/users/1825774/dd-cpa-mba-dba"}, "edited": false, "score": 0, "creation_date": 1421309708, "post_id": 27952782, "comment_id": 44312092, "body": "Both of the answers below make sense both dont address my issue.  VBA codes does correctly activate the correct sheet and excel changes to that sheet.  But when I try to edit it continues to edit the previous sheet.  I have discovered if I run the macro directly or assign macro to a shape, Excel will activate the correct sheet and I will not have a problem editing.  BUT I have the macro assigned to a command button_click and that seems to be part of the problem for some reason."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1421314659, "post_id": 27952782, "comment_id": 44314468, "body": "There must be some more code to fire the UserForm MainMenu. Report1Button_Click is on MainMenu isn&#39;t it? Could you also post the code that makes the changes to Report1 because all the posted code does is activate it then possibly Unload MainMenu?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421333461, "post_id": 27952782, "comment_id": 44324905, "body": "@user1825774 Yes, we would need to see your code as an edit to your original post."}, {"owner": {"reputation": 57, "user_id": 1825774, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6CPUJ.jpg?s=128&g=1", "display_name": "DD  CPA-MBA-DBA", "link": "https://stackoverflow.com/users/1825774/dd-cpa-mba-dba"}, "edited": false, "score": 0, "creation_date": 1421887163, "post_id": 27952782, "comment_id": 44537677, "body": "I  have created a ribbon customization that runs macro code for sheet activation and there are no problems with editing the new sheet after that .  Problem exists when a button in a dialog box activates the sheet, and only in Excel 2013, Excel 2007 is not a problem."}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 4266188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/991ec1358e51338524fb88be91663ed1?s=128&d=identicon&r=PG&f=1", "display_name": "Me_me_me", "link": "https://stackoverflow.com/users/4266188/me-me-me"}, "is_accepted": false, "score": 0, "last_activity_date": 1421272332, "last_edit_date": 1421272332, "creation_date": 1421271560, "answer_id": 27952938, "question_id": 27952782, "link": "https://stackoverflow.com/questions/27952782/sheet-activate-changes-sheet-but-continues-to-edit-data-on-previous-sheet/27952938#27952938", "title": "Sheet.Activate changes sheet but continues to edit data on previous sheet", "body": "<p>Try changing the sequence of lines in your code. I had a similar situation and it turned out that I inserted the \"delete sheet\" code in between the commands that were copying data from sheet1 to sheet2. When I put the deletion lines (commands) after I finished copying sheets everything started to work correctly. Many commands activate one sheet while performing and this immediately disactivates another sheet. So if you used \"ActiveSheet\" sommand somewhere it may be incorrectly understood - the command may be executed not on the sheet you meant. </p>\n"}, {"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 1, "last_activity_date": 1421271595, "creation_date": 1421271595, "answer_id": 27952948, "question_id": 27952782, "link": "https://stackoverflow.com/questions/27952782/sheet-activate-changes-sheet-but-continues-to-edit-data-on-previous-sheet/27952948#27952948", "title": "Sheet.Activate changes sheet but continues to edit data on previous sheet", "body": "<p>When you run <code>VBA</code> code, it will default to using the <code>ActiveSheet</code> if you don't define the Sheet.  When you have objects/methods that you want performed on a specific sheet, you should always specify!  You can do that one of two ways:</p>\n\n<pre><code>Sheets(\"Report1\").[Object].[Method]\n'or\nSheets(\"Report1\").[Method]\n</code></pre>\n\n<p>or you can pass the Sheet name to a variable and use that for shorter code</p>\n\n<pre><code>Dim Report1 As Worksheet\nSet Report1 = Sheets(\"Report1\")\nReport1.[Object].[Method]\n'or\nReport1.[Method]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1421276860, "creation_date": 1421276860, "answer_id": 27954153, "question_id": 27952782, "link": "https://stackoverflow.com/questions/27952782/sheet-activate-changes-sheet-but-continues-to-edit-data-on-previous-sheet/27954153#27954153", "title": "Sheet.Activate changes sheet but continues to edit data on previous sheet", "body": "<p>Just use the full address for the range you are trying to manipulate, for example instead of:</p>\n\n<pre><code>Sheets(\"mySheet\").Activate\nRange(\"A1:B10\").Cut\nSheets(\"myOtherSheet\").Activate\nRange(\"A1:B10\").Paste\n</code></pre>\n\n<p>use:</p>\n\n<pre><code>Sheets(\"mySheet\").Range(\"A1:A10\").Cut Destination:=Sheets(\"myOtherSheet\").Range(\"A1:B10\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3221177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c854dfba25b367cd50036ab0a91152b?s=128&d=identicon&r=PG&f=1", "display_name": "SBN", "link": "https://stackoverflow.com/users/3221177/sbn"}, "is_accepted": false, "score": 0, "last_activity_date": 1478613081, "creation_date": 1478613081, "answer_id": 40488644, "question_id": 27952782, "link": "https://stackoverflow.com/questions/27952782/sheet-activate-changes-sheet-but-continues-to-edit-data-on-previous-sheet/40488644#40488644", "title": "Sheet.Activate changes sheet but continues to edit data on previous sheet", "body": "<p>I just had the same problem, also with Excel 2013. So even if the thread is over 9 month inactive, I want to share my solution in case somebody gets here through a Google search. </p>\n\n<p>The solution was really simple. Call the userform with:</p>\n\n<pre><code>UserForm1.show vbModeless\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 1825774, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6CPUJ.jpg?s=128&g=1", "display_name": "DD  CPA-MBA-DBA", "link": "https://stackoverflow.com/users/1825774/dd-cpa-mba-dba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1478613081, "creation_date": 1421270878, "last_edit_date": 1421364779, "question_id": 27952782, "link": "https://stackoverflow.com/questions/27952782/sheet-activate-changes-sheet-but-continues-to-edit-data-on-previous-sheet", "title": "Sheet.Activate changes sheet but continues to edit data on previous sheet", "body": "<p>I have a dialog box with a couple of buttons that launch macros to activate and change to different sheets.  </p>\n\n<p>The problem I am having is after I click the button, the macro activates the new sheet and I see it. But when I go to delete data, add data or try to delete a row \"Nothing happens\" the data on the screen is still there.  If I go back to the previous sheet, the cells and rows that I had intended to delete were deleted in that sheet.  It is very wierd and never seen anything like that.  It appears that my macro code is note doing enough to actually change to the new sheet.  I do not have this problem if I click a different sheet tab to change to it.  Or if I click the dialog button to go to the new sheet and quickly do a ctrl-pgDown and Ctrl-PgUp to change from another tab and back that seems to fix the problem.</p>\n\n<p>This is the code in my macro I am using to try to change to the desired tab.</p>\n\n<pre><code>Private Sub Report1Button_Click()\nOn Error GoTo Handler\nSheets(\"Report1\").Activate\nIf StayOpenBox.Value = False Then\n    Unload MainMenu\nEnd If\nExit Sub\nHandler:\nMsgBox \"Sheet 'Report1' not found or renamed\"\nEnd Sub\n</code></pre>\n\n<p>Thanks for any help or suggestions</p>\n\n<p>UPDATE:</p>\n\n<p>Here is code that I use to call the dialog box.  I have a shape on the other sheet that is assigned to this macro to open dialog box</p>\n\n<pre><code>Sub ShowMainMenu()\n\nWith UserForm1\n  .Show\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Also there is no further code to make edits to the new sheet.  My Button click simply switches to the other sheet and when I attempt to make edits manually, they are actually done on the previous sheet which is not the one I am currently looking at.  So anything I do,  Bold text, delete text, delete row, etc, is not done on the current sheet I am looking at, but when I return to the previous sheet the changes where made there.  Im on Excel 2013, I have reproduced this problem in 2 separate files, but I will try on a different computer and older version of excel.  Screenshot of my situation is below.</p>\n\n<p><img src=\"https://i.stack.imgur.com/qESTs.jpg\" alt=\"Screenshot of Code\"></p>\n\n<p>UPDATE 2:\nI ran this xlsm file on a 2nd computer with Xls 2007 and was not having the problem.  So I ran the macro on a 3rd computer that also has Excel 2013 and it is experiencing the same problem.  So it is not computer specific and seems to be a problem in XLS 2013 but not in XLS 2007.  I will try to find a computer with Excel 2010 to test as well, but something about this code is causing a problem in 2013 but not in older versions of excel.</p>\n"}, {"tags": ["vba", "email", "excel", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1421271976, "post_id": 27952370, "comment_id": 44301143, "body": "<code>ConversationID</code> and <code>ConversationIndex</code> are both read-only properties.  I would suggest maybe trying to get a handle on the existing conversation your email as a reply to one message in that thread, which should preserve the conversation view."}, {"owner": {"reputation": 21431, "user_id": 321973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/79175a222a9933b9fc278cd94b228bf7?s=128&d=identicon&r=PG", "display_name": "Tobias Kienzler", "link": "https://stackoverflow.com/users/321973/tobias-kienzler"}, "edited": false, "score": 0, "creation_date": 1503910193, "post_id": 27952370, "comment_id": 78788591, "body": "Strongly related: <a href=\"https://stackoverflow.com/q/8806882/321973\">stackoverflow.com/q/8806882/321973</a>"}, {"owner": {"reputation": 21431, "user_id": 321973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/79175a222a9933b9fc278cd94b228bf7?s=128&d=identicon&r=PG", "display_name": "Tobias Kienzler", "link": "https://stackoverflow.com/users/321973/tobias-kienzler"}, "edited": false, "score": 0, "creation_date": 1503910415, "post_id": 27952370, "comment_id": 78788723, "body": "See example in <a href=\"https://msdn.microsoft.com/en-us/library/ms527456(v=exchg.10).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms527456(v=exchg.10).aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4455151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934fdf8d0e659460e5b017daa650585a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas T", "link": "https://stackoverflow.com/users/4455151/andreas-t"}, "edited": false, "score": 0, "creation_date": 1421338566, "post_id": 27953030, "comment_id": 44328545, "body": "Thanks for your help David!   I&#39;m a newbie,   Do I need to add some Reference Libraries in my Excel VBA to get this to work? I added the Microsoft Outlook 15 Mail Library. Debugger stops now at the below, and I can&#39;t figure out how to run it.  Set NS = Application.GetNamespace(&quot;MAPI&quot;)  Error code: Run time error 438, Object doesn&#39;t suport this property or method.  Thanks :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 41, "user_id": 4455151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934fdf8d0e659460e5b017daa650585a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas T", "link": "https://stackoverflow.com/users/4455151/andreas-t"}, "edited": false, "score": 0, "creation_date": 1421339480, "post_id": 27953030, "comment_id": 44329134, "body": "In my code, the <code>Application</code> would refer to Outlook.  When you port over to your code, you have the instance of Outlook as <code>OutApp</code>, so <code>OutApp.GetNameSpace(&quot;MAPI&quot;)</code> should do the trick.  If you have trouble, revise your Question to show the code you&#39;re trying to implement, and I&#39;ll help tweak it for you :)"}, {"owner": {"reputation": 41, "user_id": 4455151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934fdf8d0e659460e5b017daa650585a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas T", "link": "https://stackoverflow.com/users/4455151/andreas-t"}, "edited": false, "score": 0, "creation_date": 1421345244, "post_id": 27953030, "comment_id": 44332839, "body": "Thanks David. Next the debugger stops at  Set m = NS.GetItemFromID(entry)  I see that I need to modify the entry variable based on my own entryID property. Where can I find my entryID property?  Thanks again for all your help!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 41, "user_id": 4455151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934fdf8d0e659460e5b017daa650585a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas T", "link": "https://stackoverflow.com/users/4455151/andreas-t"}, "edited": false, "score": 0, "creation_date": 1421345558, "post_id": 27953030, "comment_id": 44332987, "body": "Use the entryId property of an email item known to you.  You can use Google or the MS documentation to find examples of how this can be done :)"}, {"owner": {"reputation": 21431, "user_id": 321973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/79175a222a9933b9fc278cd94b228bf7?s=128&d=identicon&r=PG", "display_name": "Tobias Kienzler", "link": "https://stackoverflow.com/users/321973/tobias-kienzler"}, "edited": false, "score": 1, "creation_date": 1503913334, "post_id": 27953030, "comment_id": 78790396, "body": "The example at <a href=\"https://msdn.microsoft.com/en-us/library/ms527456(v=exchg.10).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms527456(v=exchg.10).aspx</a> suggests instead of replying to an existing message you can also modify the <code>newMail</code>&#39;s <code>.ConversationIndex</code> (obtained via <code>CreateConversationIndex</code>) and <code>.ConverstaionTopic</code> directly."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1421271994, "creation_date": 1421271994, "answer_id": 27953030, "question_id": 27952370, "link": "https://stackoverflow.com/questions/27952370/sending-email-with-vba-under-the-same-outlook-conversation/27953030#27953030", "title": "Sending email with VBA under the same Outlook conversation", "body": "<p>This is the Outlook code that you can port over to Excel, using the method I suggest in the comments above.</p>\n\n<pre><code>Sub test()\nDim m As MailItem\nDim newMail As MailItem\nDim NS As NameSpace\nDim convo As Conversation\nDim cItem\nDim entry As String 'known conversationID property\n\nSet NS = Application.GetNamespace(\"MAPI\")\n\n'Use the EntryID of a known item\n'## MODIFY THIS BASED ON YOUR ENTRYID PROPERTY!! ##\nentry = \"0000000019EF3F5F49714748915AA379833C20460700D6CCDE850A3B9D41A5B930CCE1E12030000337DBD42F00003C7DFC9FAAF8254DACC71DEEEC1DF0A30003ADA9AF2D0000\"\n\n'Get a handle on this item:\nSet m = NS.GetItemFromID(entry)\n\n'Get a handle on the existing conversation\nSet convo = m.GetConversation\n\n'Get a handle on the conversation's root item:\nSet cItem = convo.GetRootItems(1)\n\n'Create your new email as a reply thereto:\nSet newMail = cItem.Reply\n\n'Modify the new mail item as needed:\nWith newMail\n    .To = \"\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Subject Report 1\"\n    .HTMLBody = RangeToHTML(Range(\"A1:AQ45\"))\n    .Attachments.Add Dest.FullName\n    .Display\n    '.Send\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4455151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934fdf8d0e659460e5b017daa650585a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas T", "link": "https://stackoverflow.com/users/4455151/andreas-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1787, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1421271994, "creation_date": 1421269362, "question_id": 27952370, "link": "https://stackoverflow.com/questions/27952370/sending-email-with-vba-under-the-same-outlook-conversation", "title": "Sending email with VBA under the same Outlook conversation", "body": "<p>I'm using the basic VBA code to send an email with a copy of my spreadsheet on a daily basis. The email subject is always the same.</p>\n\n<p>I want these emails to appear in Outlook as the same conversation, so that they are nested/threaded when using Conversation view. However, these emails always come up as a new conversation.</p>\n\n<p>How can I set a property in the OutMail variable below similar to .subject etc to create my own ConversationID / ConversationIndex that is always identical so that emails appear nested?</p>\n\n<p>VBA code:</p>\n\n<pre><code>Dim Source As Range  'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\nDim Dest As Workbook\nDim wb As Workbook\nDim TempFilePath As String\nDim TempFileName As String\nDim FileExtStr As String\nDim FileFormatNum As Long\nDim OutApp As Object\nDim OutMail As Object\n\n\n\n\nSet Source = Nothing\nOn Error Resume Next\nSet Source = Range(\"A1:AQ45\").SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf Source Is Nothing Then\n    MsgBox \"The source is not a range or the sheet is protected, please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet wb = ActiveWorkbook\nSet Dest = Workbooks.Add(xlWBATWorksheet)\n\nSource.Copy\nWith Dest.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial Paste:=xlPasteValues\n    .Cells(1).PasteSpecial Paste:=xlPasteFormats\n    .Cells(1).Select\n    Application.CutCopyMode = False\nEnd With\n\nTempFilePath = \"C:\\temp\\\"\nTempFileName = \"MyReport \" &amp; Format(Now, \"yyyy-mm-dd hh-mm-ss\")\nFileExtStr = \".xlsx\": FileFormatNum = 51\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\n\nWith Dest\n    .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, FileFormat:=FileFormatNum\n    On Error Resume Next\nEnd With\n\n\nWith Dest \n    With OutMail\n        .to = \"xyz@zyx.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Subject Report 1\"\n        .HTMLBody = RangetoHTML(Range(\"A1:AQ45\"))\n        .Attachments.Add Dest.FullName\n        .Send\n    End With\nEnd With\n\n\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n\n\n\nWith Dest\n    On Error GoTo 0\n    .Close savechanges:=False\n End With\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1789, "user_id": 2757993, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wKxbN.jpg?s=128&g=1", "display_name": "Zach Spencer", "link": "https://stackoverflow.com/users/2757993/zach-spencer"}, "edited": false, "score": 1, "creation_date": 1421266922, "post_id": 27951710, "comment_id": 44298533, "body": "is this not working? It is unclear what you are trying to ask."}, {"owner": {"reputation": 1, "user_id": 4455021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b5dc3248f9cdab73f7533c2a506e301?s=128&d=identicon&r=PG&f=1", "display_name": "AOD", "link": "https://stackoverflow.com/users/4455021/aod"}, "reply_to_user": {"reputation": 1789, "user_id": 2757993, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wKxbN.jpg?s=128&g=1", "display_name": "Zach Spencer", "link": "https://stackoverflow.com/users/2757993/zach-spencer"}, "edited": false, "score": 0, "creation_date": 1421267177, "post_id": 27951710, "comment_id": 44298647, "body": "the script works on an email when it is selected, I wanted to change it to work automatically on incoming mail (using an outlook rule) without having to select the email"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1421326536, "creation_date": 1421326536, "answer_id": 27963975, "question_id": 27951710, "link": "https://stackoverflow.com/questions/27951710/change-script-from-selected-to-incoming-mail/27963975#27963975", "title": "change script from selected to incoming mail", "body": "<p>You need to pass an item as a parameter. So, the code should look like the following one:</p>\n\n<pre><code>Public Sub script(itm as Outlook.MailItem)\n    Dim saveFolder As String\n    Dim objAtt As Outlook.attachment\n    Dim dateFormat\n\n    dateFormat = Format(Now, \"yymmdd \")\n    saveFolder = \"D:\\temp\"\n    For Each objAtt In itm.Attachments\n       If objAtt.Size &gt; 5200 Then\n          objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; objAtt.DisplayName\n          Set objAtt = Nothing\n       End If\n    Next objAtt\nEnd Sub\n</code></pre>\n\n<p>And don't save attachments on the C: drive, it requires admin privileges on the latest Windows OS. Choose another drive/folder. </p>\n"}, {"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1421411001, "post_id": 27981248, "comment_id": 44358884, "body": "Although ItemAdd is superior to rules this simple, frequently asked about code morphs between standalone and runascript format. Each asker wanting the other format. Eugene Astafiev has answered this."}], "tags": [], "owner": {"reputation": 2149, "user_id": 678412, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/be80b55a8500cee80cea1f61296b429e?s=128&d=identicon&r=PG", "display_name": "darbid", "link": "https://stackoverflow.com/users/678412/darbid"}, "is_accepted": false, "score": 0, "last_activity_date": 1421401957, "creation_date": 1421401957, "answer_id": 27981248, "question_id": 27951710, "link": "https://stackoverflow.com/questions/27951710/change-script-from-selected-to-incoming-mail/27981248#27981248", "title": "change script from selected to incoming mail", "body": "<p>I am not sure that you can use a rule for this.  I think you will need to hook up an Outlook event.  To do this you would use code like the following;</p>\n\n<pre><code>Private WithEvents olItems As Outlook.Items\n\nPrivate Sub Application_Startup()\n\n   Dim olApp As Outlook.Application \n   Dim objNS As Outlook.NameSpace \n   Set olApp = Outlook.Application \n   Set objNS = olApp.GetNamespace(\"MAPI\") \n   ' this is for your local Inbox - if you have more inboxes you need to set it for each one\n   Set olItems = objNS.GetDefaultFolder(olFolderInbox).Items\n\nEnd Sub\n\n'You can add this because you used \"WithEvents\" to declare olItems\nPrivate Sub olItems_ItemAdd(ByVal item As Object) \n\n  Dim olMailItem As Outlook.MailItem\n 'this event will fire for all items so you need to make sure you have a mail item.\n  If TypeName(item) = \"MailItem\" Then\n    Set olMailItem = item \n    Dim saveFolder As String\n    Dim objAtt As Outlook.attachment\n    Dim dateFormat\n    dateFormat = Format(Now, \"yymmdd \")\n    saveFolder = \"D:\\temp\"\n\n    For Each objAtt In olMailItem.Attachments\n      If objAtt.Size &gt; 5200 Then\n        objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; objAtt.DisplayName\n        Set objAtt = Nothing\n      End If\n    Next objAtt    \nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4455021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b5dc3248f9cdab73f7533c2a506e301?s=128&d=identicon&r=PG&f=1", "display_name": "AOD", "link": "https://stackoverflow.com/users/4455021/aod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593071113, "creation_date": 1421266826, "last_edit_date": 1593071113, "question_id": 27951710, "link": "https://stackoverflow.com/questions/27951710/change-script-from-selected-to-incoming-mail", "title": "change script from selected to incoming mail", "body": "<p>Basic question - I have a script that saves attachments from selected emails in outlook, I want it to save the attachments automatically when they come in instead (I'll create a rule in outlook to run the script when an email comes in), any help would be appreciated!</p>\n\n<pre><code>Public Sub script()\n\nDim saveFolder As String\nDim objAtt As Outlook.attachment\nDim itm As Outlook.MailItem\nDim dateFormat\n    dateFormat = Format(Now, \"yymmdd \")\n\nsaveFolder = \"C:\\temp\"\nFor Each itm In ActiveExplorer.Selection\n    For Each objAtt In itm.Attachments\n     If objAtt.Size &gt; 5200 Then\n       objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; objAtt.DisplayName\n        Set objAtt = Nothing\n        End If\n    Next objAtt\nNext itm\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1421271019, "post_id": 27951396, "comment_id": 44300677, "body": "try <code>set rs = Nothing</code> and <code>set db = Nothing</code> at the end of your code"}, {"owner": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1421271072, "post_id": 27951396, "comment_id": 44300710, "body": "also, it may be a good idea to open the record set as a snapshot: <code>set rs = db.openRecordset(strSQL, dbOpenSnapshot, dbReadOnly)</code>"}, {"owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "reply_to_user": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1421271173, "post_id": 27951396, "comment_id": 44300759, "body": "i set them to nothing and that did not help...let me try snapshot"}, {"owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "reply_to_user": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1421271234, "post_id": 27951396, "comment_id": 44300788, "body": "I used Snapshot, it performs a little slower, and still got the same issue...@Barranka"}, {"owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "reply_to_user": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1421271331, "post_id": 27951396, "comment_id": 44300833, "body": "@Barranka is there some way I could set the values without having that connection string open?"}, {"owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "reply_to_user": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1421271589, "post_id": 27951396, "comment_id": 44300968, "body": "@Barranka it seems like this effects it even if i don&#39;t press the Duplicate button we designed...So the button is creating a connection even though it&#39;s not being pressed."}, {"owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "reply_to_user": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1421273147, "post_id": 27951396, "comment_id": 44301703, "body": "@Barranka does this have to do with the fact that my form properties record source is tied to another query? IS there some way i can just reference that one? instead of using the one I wrote in previous question?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421343645, "post_id": 27951396, "comment_id": 44331895, "body": "What happens if you change the form&#39;s Record Locks property from &quot;All Records&quot; to &quot;No Locks&quot;?"}, {"owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421343679, "post_id": 27951396, "comment_id": 44331923, "body": "It makes the form read-only @HansUp"}, {"owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "edited": false, "score": 0, "creation_date": 1421343713, "post_id": 27951396, "comment_id": 44331939, "body": "Does that mean there&#39;s an error in the table? Why would a nolock restrict it to read only...wouldn&#39;t that in fact make it write-ready?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421343814, "post_id": 27951396, "comment_id": 44332008, "body": "That surprised me and I&#39;m baffled.  Can you upload a copy of that db somewhere?"}, {"owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "edited": false, "score": 0, "creation_date": 1421344006, "post_id": 27951396, "comment_id": 44332120, "body": "Do you have Skype? we can talk through this more...Could there be an error record in the table?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1421344712, "post_id": 27951396, "comment_id": 44332543, "body": "Sorry, no Skype.  But I doubt that really matters.  I ... oops ... I got mail!  Later."}], "owner": {"reputation": 2552, "user_id": 1082842, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jaCUy.jpg?s=128&g=1", "display_name": "Hituptony", "link": "https://stackoverflow.com/users/1082842/hituptony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1421343011, "creation_date": 1421265621, "last_edit_date": 1421343011, "question_id": 27951396, "link": "https://stackoverflow.com/questions/27951396/access-vba-are-form-properties-keeping-my-tables-open", "title": "Access / VBA - Are Form Properties keeping my tables open?", "body": "<p>UPDATE:\nI've done some more testing and disabled the button I added, the form still will not close the connection when I close the form. I'm thinking it has more to do with the form properties then the code behind the button, or perhaps the button code and form have conflicting properties keeping the table open. </p>\n\n<p>I also tried to set the rs = Nothing and db = Nothing after I close the connections in the VBA.</p>\n\n<p>So i have a sub-form, that gets called by my Mainform. When this happens I try and populate some controls using the VBA code below. However, when i close the sub-form, and try and re-access the sub-form from the Mainform, it says :\n<img src=\"https://i.stack.imgur.com/uIF8Q.png\" alt=\"cporders2\"></p>\n\n<pre><code>Private Sub CommandDupe_Click()\nDim db As DAO.Database, rs As DAO.Recordset\nDim strSQL As String\n\nSet db = CurrentDb()\nstrSQL = \"SELECT TOP 1 CPOrders.Cust, Customer.NAME, CPOrders.CP_Ref, CPOrders.Slsman, CPOrders.Date_opn, CPOrders.CPSmall, CPOrders.InvIssu, CPOrders.InvNo, CPOrders.InvDate, CPOrders.DueDate, CPOrders.ETADate, CPOrders.Closed, CPOrders.Cust, CPOrders.Name, CPOrders.BuyerRef, CPOrders.ToCity, CPOrders.ToState, CPOrders.ToCtry, CPOrders.ToPort, CPOrders.Supplier, CPOrders.Origin, CPOrders.Product, CPOrders.GradeType, CPOrders.NoUnits, CPOrders.Pkg, CPOrders.Qty, CPOrders.TotSale, CPOrders.TotCost, CPOrders.GrMargin, CPOrders.[Sale$/Unit], CPOrders.[Cost$/Unit], CPOrders.OceanCost, CPOrders.OceanNotes, CPOrders.BLadingDate, CPOrders.USAPort, CPOrders.FOBCost, CPOrders.FASExportVal, CPOrders.InlandFrt, CPOrders.CommodCode, CPOrders.Notes, CPOrders.ProjCust, CPOrders.ProjValue, CPOrders.ContainerNumber, CPOrders.Vessel, CPOrders.Ord_Terms, CPOrders.Invoice_ID FROM Customer INNER JOIN CPOrders ON Customer.[CUST_#] = CPOrders.Cust ORDER BY CPOrders.Invoice_ID desc;\"\nSet rs = db.OpenRecordset(strSQL, dbOpenDynaset, dbReadOnly)\nrs.MoveFirst\n\n\nCP_Ref.Value = rs(\"CP_Ref\")\nSlsman.Value = rs(\"Slsman\")\nDate_opn.Value = rs(\"Date_opn\")\nCPSmall.Value = rs(\"CPSmall\")\nInvIssu.Value = rs(\"InvIssu\")\nInvNo.Value = rs(\"InvNo\")\nInvDate.Value = rs(\"InvDate\")\nDueDate.Value = rs(\"DueDate\")\nCust.Value = rs(\"Cust\")\nBuyerRef.Value = rs(\"BuyerRef\")\nToCity.Value = rs(\"ToCity\")\nToState.Value = rs(\"ToState\")\nToCtry.Value = rs(\"ToCtry\")\nToPort.Value = rs(\"ToPort\")\nProduct.Value = rs(\"Product\")\nSupplier.Value = rs(\"Supplier\")\nGradeType.Value = rs(\"GradeType\")\nOrigin.Value = rs(\"Origin\")\nNoUnits.Value = rs(\"NoUnits\")\nPkg.Value = rs(\"Pkg\")\nQty.Value = rs(\"Qty\")\nTotSale.Value = rs(\"TotSale\")\nTotCost.Value = rs(\"TotCost\")\nOceanCost.Value = rs(\"OceanCost\")\nOceanNotes.Value = rs(\"OceanNotes\")\nBLadingDate.Value = rs(\"BLadingDate\")\nUSAPort.Value = rs(\"USAPort\")\nFOBCost.Value = rs(\"FOBCost\")\nNotes.Value = rs(\"Notes\")\nInlandFrt.Value = rs(\"InlandFrt\")\nCommodCode.Value = rs(\"CommodCode\")\nVessel.Value = rs(\"Vessel\")\nContainerNumber.Value = rs(\"ContainerNumber\")\nProjCust.Value = rs(\"ProjCust\")\nProjValue.Value = rs(\"ProjValue\")\n\n\nrs.Close\ndb.Close\n</code></pre>\n\n<p>As you can see I do close the rs and the db...what else can i do to make sure this connection is closed after I close the sub-form? I need to be able to access this from the MainForm consistently.</p>\n\n<p>Thanks in advance!!!\nAlso I added the form properties of the form that does not close<img src=\"https://i.stack.imgur.com/S55yj.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "debugging"], "answers": [{"tags": [], "owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "is_accepted": true, "score": 1, "last_activity_date": 1421264852, "last_edit_date": 1495541505, "creation_date": 1421264530, "answer_id": 27951077, "question_id": 27950895, "link": "https://stackoverflow.com/questions/27950895/how-to-access-long-string-value-at-runtime/27951077#27951077", "title": "How to access long string value at runtime", "body": "<p>One option is to copy the string to the clipboard (from code itself or, when the code is paused, from the Immediate Window).</p>\n\n<p>Then again, this is not <em>that</em> easy in VBA, but you can go two ways, as described<br>\n<a href=\"https://stackoverflow.com/questions/5552299/how-to-copy-to-clipboard-using-access-vba\">on SO HERE</a>.<br>\nThe solution with API-calls and a ready-made function from the <a href=\"http://support.microsoft.com/kb/210216\" rel=\"nofollow noreferrer\">msdn post</a> (also mentioned in that answer) is a bit lengthy, but then again it just needs copying once into a module and then works fine straight away. I just tested it with 100K characters - no problem.</p>\n"}], "owner": {"reputation": 17349, "user_id": 1951708, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/uUTYl.jpg?s=128&g=1", "display_name": "Lorenz Meyer", "link": "https://stackoverflow.com/users/1951708/lorenz-meyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 27951077, "answer_count": 1, "score": 1, "last_activity_date": 1421264852, "creation_date": 1421263734, "question_id": 27950895, "link": "https://stackoverflow.com/questions/27950895/how-to-access-long-string-value-at-runtime", "title": "How to access long string value at runtime", "body": "<p>I found a problem with the VBA Locals Window while debuggin a macro in Excel 2013. I used the <em>Locals Window</em> to track the value of a string.</p>\n\n<p>If the string exceed a certain length (about 100 caracters) it is not possible to copy it out of the <em>Locals Window</em> to examine it somewhere else (eg. in notepad++).</p>\n\n<p>Is there a way to access the full content of a string variable at runtime ?</p>\n"}, {"tags": ["vba", "excel", "charts", "powerpoint"], "comments": [{"owner": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "edited": false, "score": 0, "creation_date": 1421263937, "post_id": 27950742, "comment_id": 44296963, "body": "Does this workbook exist? <code>C:\\Users\\wzawisa\\Downloads\\MarketSegmentTotals.xls</code>. If it does, does it have a sheet titled <code>MarketSegmentTotals</code>?"}, {"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "reply_to_user": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "edited": false, "score": 0, "creation_date": 1421264721, "post_id": 27950742, "comment_id": 44297397, "body": "Yes. Both of those exist and are open. Thats what confuses me about why this error would appear."}, {"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "reply_to_user": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "edited": false, "score": 0, "creation_date": 1421265542, "post_id": 27950742, "comment_id": 44297883, "body": "I fixed this issue but now, at the new line indicated in the edit it says the &quot;Object doesn&#39;t support that property or method.&quot; I&#39;m not sure why."}, {"owner": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "edited": false, "score": 0, "creation_date": 1421266613, "post_id": 27950742, "comment_id": 44298399, "body": "For starters, you will want to flip the order of your calls to <code>RangeToPresentation</code>"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1421267020, "post_id": 27950742, "comment_id": 44298576, "body": "Well, for one thing the <code>Workbook</code> class does not have a <code>.NamedRange</code> property.  You could use the <code>.Names(..)</code> collection if you supply the name of the the Named Range."}, {"owner": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1421267191, "post_id": 27950742, "comment_id": 44298652, "body": "Correct @RBarryYoung so if you wanted to get this working (which I wouldn&#39;t suggest doing it this way, there is more to fix) you could probably do <code>xlWorkBook.ActiveSheet.Range(NamedRange.Address).CopyPicture ...</code>"}, {"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421267209, "post_id": 27950742, "comment_id": 44298662, "body": "Whoops. Ok, I changed that line to <code>xlWorkBook.Sheets(sheetName).Range(NamedRange).CopyPicture Appearance:=xlScreen, _         Format:=xlBitmap</code>  Which I thought would solve my issue but it is still saying &quot;Application or object defined error.&quot;"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "edited": false, "score": 0, "creation_date": 1421267475, "post_id": 27950742, "comment_id": 44298786, "body": "@jaysunice3401 Not sure, he doesnt declare anything explicitly, so I&#39;m not sure what type/state the <code>NamedRange</code> parameter/variable is by the time it gets there.  And I agree, there&#39;s other problems here.."}, {"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421267540, "post_id": 27950742, "comment_id": 44298818, "body": "What other problems?"}, {"owner": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "edited": false, "score": 1, "creation_date": 1421267559, "post_id": 27950742, "comment_id": 44298830, "body": "I think it&#39;s coming through as variant. So yes, my comment probably isn&#39;t going to work unless you <code>dim rng1 as Range</code> and then <code>set rng1</code>."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "edited": false, "score": 1, "creation_date": 1421267601, "post_id": 27950742, "comment_id": 44298841, "body": "Try declaring <code>rng1, rng2</code> as Ranges, use <code>Set ..</code> on their assignments and then use @jaysunice3401&#39;s code: <code>...Range(NamedRange.Address)...</code> instead."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "edited": false, "score": 0, "creation_date": 1421267629, "post_id": 27950742, "comment_id": 44298855, "body": "@jaysunice3401 My thoughts exactly."}, {"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1421269865, "post_id": 27950742, "comment_id": 44300001, "body": "I made your suggested edits but now it is back to saying &quot;Subscript out of range&quot; at <code>xlWorkBook.Sheets(sheetName).Range(NamedRange.Address).CopyP&zwnj;&#8203;icture Appearance:=xlScreen, _ Format:=xlBitmap</code> @RBarryYoung"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1421270357, "post_id": 27950742, "comment_id": 44300313, "body": "Hmm, try changing the whole line to just <code>NamedRange.CopyPicture Appearance:=xlScreen, Format:=xlBitmap</code>."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1421270579, "post_id": 27950742, "comment_id": 44300446, "body": "Oh!  You know what, according to the 2003 VBA doc, <code>xlBitmap</code> is a <code>Format:=</code> value, and <code>xlScreen</code> is an <code>Appearance:=</code> value, <i>but</i> according to the current .Net interop doc, it&#39;s the other way around.  Not sure which is right, so try reversing them, if the previous comment doesn&#39;t fix it."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421334802, "post_id": 27953099, "comment_id": 44325855, "body": "Thank you! For some reason I get an error saying the object doesnt support the property or method on the first line of the first with statement setting the chart type.  Why would this be happening?"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421346984, "post_id": 27953099, "comment_id": 44333774, "body": "@Pablo - Try the edited code and post feedback. Please take the time to check the minor differences with the previous version. In case it works, I will remove most of the commented code (clutter)."}, {"owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421347241, "post_id": 27953099, "comment_id": 44333904, "body": "Thank you! it worked! Now one more question, How would I crop the pictures once I get them in powerpoint?"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "edited": false, "score": 0, "creation_date": 1421355073, "post_id": 27953099, "comment_id": 44338135, "body": "@Pablo - <a href=\"http://stackoverflow.com/questions/1660428/cropping-an-image-in-powerpoint-using-vba\" title=\"cropping an image in powerpoint using vba\">stackoverflow.com/questions/1660428/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": true, "score": 1, "last_activity_date": 1421355356, "last_edit_date": 1421355356, "creation_date": 1421272258, "answer_id": 27953099, "question_id": 27950742, "link": "https://stackoverflow.com/questions/27950742/subscript-out-of-range-error-when-trying-to-copy-excel-charts-to-power-point-pre/27953099#27953099", "title": "Subscript out of range error when trying to copy Excel charts to Power Point presentation", "body": "<p>I think that you are mixing <code>Range</code>s. Please try the code posted below, which contains quite a few modifications from your original code. I detail below the main ones. You have to set a reference to the <em>Microsoft Excel vvv Object Library</em>. In the VBE, use <em>Tools</em> -> <em>References</em>.</p>\n\n<p>Main changes:</p>\n\n<ol>\n<li><p>Declared the type of arguments in your <code>Function</code>.</p></li>\n<li><p>Changed the <code>Function</code> to <code>Sub</code> (you only perform actions, you do not return a value).</p></li>\n<li><p>Used <code>NamedRange</code> directly. There is no need for the convoluted way in which you used it. The first argument is now superfluous (you may remove it).</p></li>\n<li><p>Used variables to refer to objects. This allows for much easier coding and debugging.</p></li>\n<li><p>Removed some of the <code>Select</code> and <code>Activate</code>. You should not use them unless strictly needed (apparently this is not the case).</p></li>\n</ol>\n\n<p>There are still quite a few points where you can improve your code, in particular along the lines set above.\nPlease first try it. If it does not work, use the debugger, watches and the immediate window to explore deeper, and give feedback.</p>\n\n<pre><code>Option Explicit\n\nPublic dlgOpen As FileDialog\nPublic folder As String\nPublic excelApp As Object\nPublic xlWorkBook As Excel.Workbook\nPublic xlWorkBook2 As Excel.Workbook\nPublic PPT As Presentation\nPublic Name1 As String\nPublic Name2 As String\nPublic rng1 As Excel.Range\nPublic rng2 As Excel.Range\nDim NamedRange As Excel.Range\nDim xlws As Excel.Worksheet\nDim xlsh As Excel.Shape\nDim xlch As Excel.Chart\nDim xlws2 As Excel.Worksheet\nDim xlsh2 As Excel.Shape\nDim xlch2 As Excel.Chart\n\nPublic Sub GenerateVisual()\n    Set PPT = ActivePresentation\n    Set excelApp = CreateObject(\"Excel.Application\")\n    excelApp.Visible = True\n\n    Set xlWorkBook = excelApp.workbooks.Open(\"C:\\Users\\wzawisa\\Downloads\\MarketSegmentTotals.xls\")\n    Set xlws = xlWorkBook.Sheets(\"MarketSegmentTotals\")\n    Set xlsh = xlws.Shapes.AddChart\n    Set xlch = xlsh.Chart\n    With xlch\n        .ChartType = xlColumnClustered\n        .SetSourceData Source:=xlws.Range(\"$A$1:$F$2\")\n        .Legend.Delete\n        .SetElement (msoElementChartTitleAboveChart)\n        .SetElement (msoElementDataLabelCenter)\n        .ChartTitle.Text = \"DD Ready by Market Segment\"\n    End With\n    xlws.ListObjects.Add\n\n    With xlch.Parent\n        .Top = 100    ' reposition\n        .Left = 100   ' reposition\n    End With\n\n    Set xlWorkBook2 = excelApp.workbooks.Open(\"C:\\Users\\wzawisa\\Downloads\\GeneralTotals.xls\")\n    Set xlws2 = xlWorkBook.Sheets(\"Totals\")\n    'xlWorkBook2.Sheets(\"Totals\").Activate\n    Set xlsh2 = xlws2.Shapes.AddChart\n    Set xlch2 = xlsh2.Chart\n    With xlch2\n        .ChartType = xlColumnClustered\n        .SetSourceData Source:=xlws2.Range(\"$A$1:$C$2\")\n        .Legend.Delete\n        .SetElement (msoElementChartTitleAboveChart)\n        .SetElement (msoElementDataLabelCenter)\n        .ChartTitle.Text = \"Total DD Ready\"\n    End With\n    xlWorkBook2.ActiveSheet.ListObjects.Add\n\n    With xlws2.Parent\n        .Top = 100    ' reposition\n        .Left = 100   ' reposition\n    End With\n\n    Set rng1 = xlws.Range(\"B8:F25\")\n    Set rng2 = xlws2.Range(\"A8:C25\")\n\n    Call RangeToPresentation(\"MarketSegmentTotals\", rng1)\n    Call RangeToPresentation(\"Totals\", rng2)\n\n    'Set dlgOpen = Application.FileDialog(Type:=msoFileDialogFolderPicker)\n    '\n    'dlgOpen.Show\n    'dlgOpen.Title = \"Select Report Location\"\n    '\n    'folder = dlgOpen.SelectedItems(1)\n\nEnd Sub\n\n\nPublic Sub RangeToPresentation(ByVal sheetName As String, NamedRange As Excel.Range)\n    Dim ppApp As Object\n    Dim ppPres As Object\n    Dim PPSlide As Object\n    Set ppApp = GetObject(, \"Powerpoint.Application\")\n    Set ppPres = ppApp.ActivePresentation\n    ppApp.ActiveWindow.ViewType = ppViewNormal\n\n    ' Select the last (blank slide)\n    Dim longSlideCount As Integer\n    longSlideCount = ppPres.Slides.Count\n    ppPres.Slides(1).Select    \n    Set PPSlide = ppPres.Slides(ppApp.ActiveWindow.Selection.SlideRange.SlideIndex)\n\n    NamedRange.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n\n    ' Paste the range\n    PPSlide.Shapes.Paste.Select\n\n    'Set the image to lock the aspect ratio\n    ppApp.ActiveWindow.Selection.ShapeRange.LockAspectRatio = msoTrue\n\n    'Set the image size slightly smaller than width of the PowerPoint Slide\n    ppApp.ActiveWindow.Selection.ShapeRange.Width = ppApp.ActivePresentation.PageSetup.SlideWidth - 10\n    ppApp.ActiveWindow.Selection.ShapeRange.Height = ppApp.ActivePresentation.PageSetup.SlideHeight - 10\n\n    'Shrink image if outside of slide borders\n    If ppApp.ActiveWindow.Selection.ShapeRange.Width &gt; 700 Then\n        ppApp.ActiveWindow.Selection.ShapeRange.Width = 700\n    End If\n    If ppApp.ActiveWindow.Selection.ShapeRange.Height &gt; 600 Then\n        ppApp.ActiveWindow.Selection.ShapeRange.Height = 600\n    End If\n\n    ' Align the pasted range\n    ppApp.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n    ppApp.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True\n\n    ' Clean up\n    Set PPSlide = Nothing\n    Set ppPres = Nothing\n    Set ppApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4371819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/19bd70f54a163569948314e013d1f7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4371819/pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 27953099, "answer_count": 1, "score": 3, "last_activity_date": 1421695039, "creation_date": 1421263060, "last_edit_date": 1421695039, "question_id": 27950742, "link": "https://stackoverflow.com/questions/27950742/subscript-out-of-range-error-when-trying-to-copy-excel-charts-to-power-point-pre", "title": "Subscript out of range error when trying to copy Excel charts to Power Point presentation", "body": "<p>I am trying to copy charts from excel to PPT in a PPT macro using a function.  Though, when I try to run the function it says \"Subscript out of range\" on the line indicated below and I am really confused why. </p>\n\n<pre><code>Public dlgOpen As FileDialog\nPublic folder As String\nPublic excelApp As Object\nPublic xlWorkBook As Object\nPublic xlWorkBook2 As Object\nPublic PPT As Presentation\nPublic Name1 As String\nPublic Name2 As String\nPublic rng1 As Range\nPublic rng2 As Range\nDim NamedRange As Range\n\n\nPublic Sub GenerateVisual()\n    Set PPT = ActivePresentation\n    Set excelApp = CreateObject(\"Excel.Application\")\n    excelApp.Visible = True\n\n    Set xlWorkBook = excelApp.workbooks.Open(\"C:\\Users\\wzawisa\\Downloads\\MarketSegmentTotals.xls\")\n    xlWorkBook.Sheets(\"MarketSegmentTotals\").Activate\n    xlWorkBook.ActiveSheet.Shapes.AddChart.Select\n    xlWorkBook.ActiveChart.ChartType = xlColumnClustered\n    xlWorkBook.ActiveChart.SetSourceData Source:=xlWorkBook.ActiveSheet.Range(\"MarketSegmentTotals!$A$1:$F$2\")\n    xlWorkBook.ActiveChart.Legend.Delete\n    xlWorkBook.ActiveChart.SetElement (msoElementChartTitleAboveChart)\n    xlWorkBook.ActiveChart.SetElement (msoElementDataLabelCenter)\n    xlWorkBook.ActiveChart.ChartTitle.Text = \"DD Ready by Market Segment\"\n    xlWorkBook.ActiveSheet.ListObjects.Add\n\n    With xlWorkBook.ActiveChart.Parent\n        .Top = 100    ' reposition\n        .Left = 100   ' reposition\n    End With\n\n    Set xlWorkBook2 = excelApp.workbooks.Open(\"C:\\Users\\wzawisa\\Downloads\\GeneralTotals.xls\")\n    xlWorkBook2.Sheets(\"Totals\").Activate\n    xlWorkBook2.ActiveSheet.Shapes.AddChart.Select\n    xlWorkBook2.ActiveChart.ChartType = xlColumnClustered\n    xlWorkBook2.ActiveChart.SetSourceData Source:=xlWorkBook2.ActiveSheet.Range(\"Totals!$A$1:$C$2\")\n    xlWorkBook2.ActiveChart.Legend.Delete\n    xlWorkBook2.ActiveChart.SetElement (msoElementChartTitleAboveChart)\n    xlWorkBook2.ActiveChart.SetElement (msoElementDataLabelCenter)\n    xlWorkBook2.ActiveChart.ChartTitle.Text = \"Total DD Ready\"\n    xlWorkBook2.ActiveSheet.ListObjects.Add\n\n    With xlWorkBook2.ActiveChart.Parent\n        .Top = 100    ' reposition\n        .Left = 100   ' reposition\n    End With\n\n    Set rng1 = xlWorkBook.Sheets(\"MarketSegmentTotals\").Range(\"B8:F25\")\n    Set rng2 = xlWorkBook2.Sheets(\"Totals\").Range(\"A8:C25\")\n\n    Call RangeToPresentation(\"MarketSegmentTotals\", rng1)\n    Call RangeToPresentation(\"Totals\", rng2)\n\n    'Set dlgOpen = Application.FileDialog(Type:=msoFileDialogFolderPicker)\n    '\n    'dlgOpen.Show\n    'dlgOpen.Title = \"Select Report Location\"\n    '\n    'folder = dlgOpen.SelectedItems(1)\n\nEnd Sub\n\n\nPublic Function RangeToPresentation(sheetName, NamedRange)\n    Dim ppApp As Object\n    Dim ppPres As Object\n    Dim PPSlide As Object\n\n    Set ppApp = GetObject(, \"Powerpoint.Application\")\n\n    Set ppPres = ppApp.ActivePresentation\n    ppApp.ActiveWindow.ViewType = ppViewNormal\n\n    ' Select the last (blank slide)\n    longSlideCount = ppPres.Slides.Count\n    ppPres.Slides(1).Select\n\n    Set PPSlide = ppPres.Slides(ppApp.ActiveWindow.Selection.SlideRange.SlideIndex)\n\n    xlWorkBook.Sheets(sheetName).Range(NamedRange.Address).CopyPicture Appearance:=xlScreen, _\n        Format:=xlBitmap\n\n    ' Paste the range\n    PPSlide.Shapes.Paste.Select\n\n    'Set the image to lock the aspect ratio\n    ppApp.ActiveWindow.Selection.ShapeRange.LockAspectRatio = msoTrue\n\n    'Set the image size slightly smaller than width of the PowerPoint Slide\n    ppApp.ActiveWindow.Selection.ShapeRange.Width = ppApp.ActivePresentation.PageSetup.SlideWidth - 10\n    ppApp.ActiveWindow.Selection.ShapeRange.Height = ppApp.ActivePresentation.PageSetup.SlideHeight - 10\n\n    'Shrink image if outside of slide borders\n    If ppApp.ActiveWindow.Selection.ShapeRange.Width &gt; 700 Then\n        ppApp.ActiveWindow.Selection.ShapeRange.Width = 700\n    End If\n\n    If ppApp.ActiveWindow.Selection.ShapeRange.Height &gt; 600 Then\n        ppApp.ActiveWindow.Selection.ShapeRange.Height = 600\n    End If\n\n    ' Align the pasted range\n    ppApp.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n    ppApp.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True    \n\n    ' Clean up\n    Set PPSlide = Nothing\n    Set ppPres = Nothing\n    Set ppApp = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1421262966, "post_id": 27950622, "comment_id": 44296435, "body": "Two things: 1) You should probably <code>ReDim</code> your arrays once before using <code>ReDim Preserve</code> on them, and 2) <code>ReDim Preserve</code> can only change the size of the last dimension.  One (or both) of these two is causing your problem."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1421264423, "post_id": 27950622, "comment_id": 44297235, "body": "I am having trouble working out your dynamic arrays, but they look a bit over-complex. Is there a reason why you cannot use a variant array redimmed as iData(3,PCCOUNT)? Then you could always use Redim preserve if it needs to get larger."}], "answers": [{"tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": false, "score": 0, "last_activity_date": 1421264436, "creation_date": 1421264436, "answer_id": 27951054, "question_id": 27950622, "link": "https://stackoverflow.com/questions/27950622/populate-dynamic-multi-dimensional-mult-type-arrays-array-excel-vba/27951054#27951054", "title": "Populate dynamic multi-dimensional, mult-type arrays array Excel VBA", "body": "<p>The problem is you are accessing the array indexes of your <code>T_small</code> properties. You never define (or change) the bounds of <code>iData(x).myStr</code>; rather you <em>only</em> define the bounds of <code>myStr</code>, which is <strong>not</strong> part of your <code>iData</code> array.</p>\n\n<p>In other words, the of bounds error comes from trying to access <code>iData(x).myStr(x)</code> because <code>iData(x).myStr</code> has no bounds defined.</p>\n\n<p>This should work:</p>\n\n<pre><code>' Now that the iData bounds have been defined, update the property bounds.\nReDim Preserve iData(N).myStr(myStr(N))\nReDim Preserve iData(N).y(y(N))\nReDim Preserve iData(N).z(z(N))\n</code></pre>\n\n<p>Note that I am having a bit of difficulty following exactly what your code is trying to accomplish, so the above only addresses the specific error you are getting.</p>\n"}], "owner": {"reputation": 1, "user_id": 4454702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e841b470e914183d270905b625cf144?s=128&d=identicon&r=PG&f=1", "display_name": "Dafaddah", "link": "https://stackoverflow.com/users/4454702/dafaddah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 841, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421356127, "creation_date": 1421262536, "last_edit_date": 1421263647, "question_id": 27950622, "link": "https://stackoverflow.com/questions/27950622/populate-dynamic-multi-dimensional-mult-type-arrays-array-excel-vba", "title": "Populate dynamic multi-dimensional, mult-type arrays array Excel VBA", "body": "<p>I am trying to use excel 2010 VBA to populate an array containing three arrays. The first is a string type array and the other two are integer type arrays. The relevant portion of the macro is below.</p>\n\n<pre><code>Option Explicit\nOption Base 1\nPrivate Type T_small\n\n    myStr() As String\n    y() As Integer\n    z() As Integer\nEnd Type\n\nSub ColorByPoint()\n\nOn Error GoTo ErrHandler\n\nDim I As Integer, SCCount As Integer, PCCount As Integer, CLCount As Integer\nDim N As Integer, M As Integer, K As Integer, P As Integer\nDim x() As String, y() As Integer, z() As Integer\nDim pvtItM  As Variant\nDim xName As String, str As String\nDim xlRowField As Range\nDim PC As ChartObjects\nDim WS As Sheet3\nDim SC As SeriesCollection\nDim MyObj As Object\nDim PvTbl As Object\nDim CelVal As Integer\nDim rng As Variant, lbl As Variant, vlu As Variant\nDim ItemField1 As PivotItem, ItemField2 As PivotItem\nDim ValueField As PivotField\nDim dField As PivotCell\nDim oPi As PivotItem\nDim acolRng As Range\nDim arowRng As Range\nDim myStr() As String\nDim iData() As T_small\nDim xSSN() As String\n\nSet WS = Application.ActiveWorkbook.ActiveSheet\n\nSet MyObj = Worksheets(\"Pivot1\").ChartObjects(\"MyChart\").Chart\nSet PvTbl = Worksheets(\"Pivot1\").PivotTables(\"PivotTable1\")\nSet rng = PvTbl.PivotFields(\"SSN\").PivotItems\nSet lbl = PvTbl.DataFields\nM = 1\n\nSCCount = MyObj.SeriesCollection.Count          'Series count\nPCCount = PvTbl.TableRange1.Rows.Count          'Rows Count\nCLCount = PvTbl.TableRange1.Columns.Count    'Columns Count\n\n\nSet acolRng = PvTbl.ColumnRange\nSet arowRng = PvTbl.RowRange\nWorksheets(\"Pivot1\").Activate\n\n P = PCCount\n\n    ReDim Preserve myStr(P)\n    ReDim Preserve y(P)\n    ReDim Preserve z(P)\n    ReDim Preserve iData(P)\nFor N = 2 To PCCount\n    ReDim Preserve iData((iData(2).myStr(2)), (iData(N).y(N)),(iData(N).z(N)))\nNext N\n\n\nFor I = 2 To PvTbl.TableRange1.Rows.Count Step 1\n    For K = 2 To PvTbl.TableRange1.Columns.Count Step 1\n        M = K\n        N = K\n\n        iData(I).myStr(I) = PvTbl.Cells(\"myStr\" &amp; I, \"K\").Value\n        iData(I).y(I) = PvTbl.Cells(\"I\", \"M\").Value\n        iData(I).z(I) = PvTbl.Cells(\"I\", \"N\").Value\n    Next K\nNext I\n</code></pre>\n\n<p>The problem is that the line</p>\n\n<pre><code>ReDim Preserve iData((iData(2).myStr(2)), (iData(N).y(N)), (iData(N).z(N)))\n</code></pre>\n\n<p>continues to give me a \"Run Time error 9 Subscript out  of range\" error. I've tried everything I can think of to get past this including using \"N\"'s instead of the \"2\" indexes throughout, adding and removing parentheses, etc. </p>\n\n<p><strong>What causes the runtime error?</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1421351707, "post_id": 27950460, "comment_id": 44336354, "body": "See my profile for an email address if you wish to send me something."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1421278080, "creation_date": 1421278080, "answer_id": 27954394, "question_id": 27950460, "link": "https://stackoverflow.com/questions/27950460/collating-repeated-text-on-a-single-page/27954394#27954394", "title": "Collating repeated text on a single page", "body": "<p>The answer to \"Is there any way of setting up a macro ... ?\" is almost certainly \"Yes\" but with such a vague question it is impossible to tell.</p>\n\n<p>This site is here so programmers can help each other develop.  I have seen beginners grow into useful answerers and even the most gifted regular asks the occasional question.  But this is not a free coding site; you must make an effort to solve your own problem before coming here.</p>\n\n<p>You cannot expect to understand code snippets you find here if you know nothing of VBA.  Learning the basics of VBA will quickly repay itself.  Search for \u201cExcel VBA tutorial\u201d.  There are many to choose from so try a few and then finish one that matches your learning style.  I prefer books.  I visited my local library, borrowed a few Excel VBA Primers and then bought the one I preferred.  Twelve years later, I still refer to it occasionally.</p>\n\n<p>Your question implies that these prefixed strings are scattered across a master sheet.  You want to locate all strings starting \u201cXYZ:\u201d and copy them to worksheet XYZ.</p>\n\n<p>I am sure any tutorial or book will teach you how to use <code>Find</code>.  They will also show you how to move data from one sheet to another.  What they might not do is show you how to search for \u201cA:\u201d then \u201cR:\u201d then \u201cC:\u201d and so on for the minimum of effort.  I will give you a start by showing how I would work through a set of workbooks.</p>\n\n<p>The macro below checks for the existence of each of the worksheets and creates them if they do not already exist.  I doubt you will understand much of the code until you have mastered the basics of VBA.  What I want you to notice is that quite a small piece of code can selectively create 19 worksheets. </p>\n\n<p>The macro you want will have a similar structure but the statements <code>Err.Clear</code> to <code>End If</code> will be replaced by a block which is something like:</p>\n\n<ul>\n<li>Search Master sheet for first occurrence, if any, of current prefix</li>\n<li>If an occurrence is found, loop copying every occurrence to next free row in column A of relevant worksheet.</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\nSub CreateWorksheets()\n\n  Dim ErrNum As Long\n  Dim InxP As Long\n  Dim PrefixCrnt As Variant\n  Dim Prefixes() As Variant\n  Dim Wsht As Worksheet\n  Dim WshtName As String\n\n  Application.ScreenUpdating = False\n\n  Prefixes = Array(\"A\", \"R\", \"C\", \"E\", \"T\", \"PG\", \"FQ\", \"CL\", \"RFI\", _\n                   \"D/W\", \"CCIR\", \"EEFI\", \"PIR\", \"NIR\", \"RFC\")\n\n  ' For each prefix in Prefices, create a worksheet with\n  ' this name if it does not already exist.\n\n  For InxP = LBound(Prefixes) To UBound(Prefixes)\n\n    PrefixCrnt = Prefixes(InxP)\n    ' Remove characters that cannot be present in a worksheet name\n    WshtName = Replace(PrefixCrnt, \"/\", \"-\")\n\n    Err.Clear                   ' Clear record of any past error\n    On Error Resume Next        ' Switch off normal error handling\n    Set Wsht = Worksheets(WshtName)\n    ErrNum = Err.Number         ' Save error number\n    On Error GoTo 0             ' Restore normal error handling\n    If ErrNum &lt;&gt; 0 Then\n      ' Worksheets(wshtname) does not exist\n      ' Create new worksheet and place after all existing worksheets\n      Worksheets.Add After:=Worksheets(Worksheets.Count)\n      ' New worksheet is now active workbook\n      ActiveSheet.Name = WshtName   ' Rename new worksheet\n    End If\n\n  Next InxP\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1421341456, "post_id": 27966488, "comment_id": 44330473, "body": "I too failed to see the value of a fall-out without the original context. I decided to ignore the problem since it is easy to pick up values from the left-most columns of the same row or the top rows of the same column. At first, I did not understand you loop per prefix per sheet other than &quot;Summary&quot;. What you noticed and I didn&#39;t is that there are &quot;a number of questions on various tabs&quot;.  You read the requirement as one summary sheet while I read it as one per prefix.  We will have to wait for Ben K to clarify his requirement before we know who is correct."}, {"owner": {"reputation": 1, "user_id": 4454632, "user_type": "registered", "profile_image": "https://graph.facebook.com/558865197/picture?type=large", "display_name": "Ben K", "link": "https://stackoverflow.com/users/4454632/ben-k"}, "edited": false, "score": 0, "creation_date": 1421349591, "post_id": 27966488, "comment_id": 44335205, "body": "Tony, Barry, first of all thank you for helping me.  You are actually both right!  Creating the sheets as Tony has done works well; and the data capture Barry has created also is right.  What I need to do now is try and separate the various values between the sheets so that you only have one variety per sheet.  If it would help I would be happy to email you the document I am using so you could see what I was getting at?  I&#39;d rather not post it for general consumption.  I&#39;m also going to have a play with it now and come back to you.  Thanks again for your help and advice!"}, {"owner": {"reputation": 1936, "user_id": 2474149, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ec6e9e714905b4aa40e2a762a3efa0c?s=128&d=identicon&r=PG", "display_name": "barryleajo", "link": "https://stackoverflow.com/users/2474149/barryleajo"}, "edited": false, "score": 0, "creation_date": 1421350461, "post_id": 27966488, "comment_id": 44335703, "body": "Glad you are making progress.  I am happy to help you further if you so wish."}], "tags": [], "owner": {"reputation": 1936, "user_id": 2474149, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ec6e9e714905b4aa40e2a762a3efa0c?s=128&d=identicon&r=PG", "display_name": "barryleajo", "link": "https://stackoverflow.com/users/2474149/barryleajo"}, "is_accepted": false, "score": 0, "last_activity_date": 1421334559, "creation_date": 1421334559, "answer_id": 27966488, "question_id": 27950460, "link": "https://stackoverflow.com/questions/27950460/collating-repeated-text-on-a-single-page/27966488#27966488", "title": "Collating repeated text on a single page", "body": "<p>OK Ben, notwithstanding the advice given by @Tony Dallimore I actually think this is quite a challenge for someone with no VBA experience, I also have a slightly different interpretation of the requirement, hence this proposed Answer.  I'll give you some base code from which to learn a little and hopefully for you to modify as hinted below.</p>\n\n<p>For this example I have assumed that there is a blank sheet called \"Summary\" (with the headings shown) already added to your workbook.  You could use Tony's answer as a basis for you to automatically provide this if it doesn't already exist, or blank it if it does.</p>\n\n<p><img src=\"https://i.stack.imgur.com/O7zUs.png\" alt=\"enter image description here\"></p>\n\n<p>The code below will then populate this sheet with the Sheet Title of the fallout (col A), the row/col location of the fallout (col B) and the cell contents of the fallout as requested (col C).  You could perhaps amend the code to split the prefix into a separate coll?  I am using Q1, Q2, Q3 as the sheet names and data which combines the prefix with the sheet name to constitute the fallout text eg. \"CCIR:Q3\".</p>\n\n<p>As remarked by Tony, in the absence of data/layout, this is an example of the simple data I used on sheet Q1:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Jdgmo.png\" alt=\"enter image description here\"> </p>\n\n<p>My code uses two <code>Range</code> methods called <code>.Find</code> and <code>.FindNext</code>.  To find values (your prefixes) they need to be uniquely identifiable.  In your prefix list, searching for \"R:\" will also find \"CCIR:\", \"PIR:\" and \"NIR:\"; similarly searching for \"C:\" will also find \"RFC:\".  This is troublesome so I have modified your prefixes to be \"RR:\" and \"CC:\" respectively.  You will need to decide whether either to change you prefixes to reflect this or use some other basis to locate your prefixes.</p>\n\n<p><code>Find</code> and <code>FindNext</code> require some understanding so perhaps have a look at <a href=\"http://www.siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba/\" rel=\"nofollow noreferrer\">Siddarth Rout's excellent summary here.</a></p>\n\n<p>You may also care to research <code>Worksheet.UsedRange</code> starting <a href=\"http://msdn.microsoft.com/en-us/library/office/ff840732%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Copy and paste the following code samples into a normal code module and run ReportPrefixes - you may have to learn how to do this. There is a 'main' Sub called <code>Sub ReportPrefixes()</code> and a called Sub called <code>Sub addFallout()</code>.  They can be pasted together in the same code module.</p>\n\n<pre><code>Option Explicit\nSub ReportPrefixes()\nDim wsSum As Worksheet, sht As Worksheet\nDim prefx() As Variant\nDim fndPrefx As Range, fndStAdd As Range\nDim curPrefx As Long\n\nprefx = Array(\"A:\", \"RR:\", \"CC:\", \"E:\", \"T:\", \"PG:\", \"FQ:\", \"CL:\", \"RFI:\", _\n                   \"D/W:\", \"CCIR:\", \"EEFI:\", \"PIR:\", \"NIR:\", \"RFC:\")\n\n    For Each sht In Worksheets\n        If sht.Name &lt;&gt; \"Summary\" Then\n            With sht.UsedRange\n                For curPrefx = LBound(prefx) To UBound(prefx)\n                    Set fndPrefx = .Find(what:=prefx(curPrefx), LookAt:=xlPart, LookIn:=xlValues, _\n                                 searchDirection:=xlNext, searchOrder:=xlByRows, MatchCase:=False)\n                        If Not fndPrefx Is Nothing Then\n                            Set fndStAdd = fndPrefx\n                            Call addFallout(sht.Name, fndPrefx.Row, fndPrefx.Column, fndPrefx.Value)\n                                Do\n                                    Set fndPrefx = .FindNext(After:=fndPrefx)\n                                        If Not fndPrefx Is Nothing Then\n                                            If fndPrefx.Address = fndStAdd.Address Then Exit Do\n                                            Call addFallout(sht.Name, fndPrefx.Row, fndPrefx.Column, fndPrefx.Value)\n                                        End If\n                                Loop\n                        End If\n                Next curPrefx\n            End With\n        End If\n    Next sht\n\nEnd Sub\n\nSub addFallout(ByVal wsht As String, ByVal rw As Long, ByVal col As Long, ByVal val As String)\nDim nxtRow As Long, wrCol As Long\nwrCol = 1\n\n    With Sheets(\"Summary\")\n        nxtRow = .Cells(Rows.Count, wrCol).End(xlUp).Row + 1\n        .Cells(nxtRow, wrCol).Value = wsht\n        .Cells(nxtRow, wrCol).Offset(0, 1).Value = \"Row:\" &amp; rw &amp; \" Col:\" &amp; col\n        .Cells(nxtRow, wrCol).Offset(0, 2).Value = val\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4454632, "user_type": "registered", "profile_image": "https://graph.facebook.com/558865197/picture?type=large", "display_name": "Ben K", "link": "https://stackoverflow.com/users/4454632/ben-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1421334559, "creation_date": 1421261962, "last_edit_date": 1421263061, "question_id": 27950460, "link": "https://stackoverflow.com/questions/27950460/collating-repeated-text-on-a-single-page", "title": "Collating repeated text on a single page", "body": "<p>I am using an Excel workbook for military planning.  The planning process takes me through a number of questions on various tabs; the analysis of the answers to these questions leads to tasks, considerations, constraints, requests for further information and so on.  These fall-outs from the analysis are prefixed with abbreviations (T: for task; R: for risk, etc).  I am trying to find a way of collating all the occurrences of the fall-outs and collate them in a separate tab within the same workbook to save trawling back through each tab to copy and paste them.  Is there any way of setting up a macro that searches for cell contents with the prefix and copying the entire cell data from one tab to another?</p>\n\n<p>The prefixes are as follows:</p>\n\n<pre><code>A: \nR:\nC:\nE:\nT:\nPG: \nFQ:\nCL:\nRFI:\nD/W: \nCCIR:\nEEFI:\nPIR:\nNIR:\nRFC:\n</code></pre>\n\n<p>Can anyone help me?  I have no idea when it comes to writing scripts.</p>\n"}, {"tags": ["excel", "vba", "count"], "answers": [{"tags": [], "owner": {"reputation": 17996, "user_id": 2572423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/38bd07fe81c679a4282ed1e6d4eeb266?s=128&d=identicon&r=PG&f=1", "display_name": "JasonAizkalns", "link": "https://stackoverflow.com/users/2572423/jasonaizkalns"}, "is_accepted": false, "score": 0, "last_activity_date": 1421264678, "last_edit_date": 1495535121, "creation_date": 1421264678, "answer_id": 27951119, "question_id": 27950302, "link": "https://stackoverflow.com/questions/27950302/how-do-i-create-a-counta-formula-that-only-counts-data-in-cell-highlighted-a-spe/27951119#27951119", "title": "How do I create a counta formula that only counts data in cell highlighted a specific color?", "body": "<p>This will feel a bit overwhelming if you are not experienced with VBA, but there are a few questions and answers already on SO -- see <a href=\"https://stackoverflow.com/questions/18876456/excel-vba-match-cell-color\">here</a> or <a href=\"https://stackoverflow.com/questions/27904416/excel-vba-countif-value-criterion-and-color-criterion\">here</a>.</p>\n\n<p>Regardless, have you considered using \"Filter by Color\" as an alternative? Use <code>Data &gt; Filter</code> and then choose <code>Filter by Color</code>. Once filtered, you should find a nifty count in the lower-left corner of the Excel window.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Aer9L.png\" alt=\"Pic01\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/Wdc8A.png\" alt=\"Pic02\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/jrgbP.png\" alt=\"Pic03\"></p>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "is_accepted": false, "score": 0, "last_activity_date": 1421269003, "creation_date": 1421269003, "answer_id": 27952288, "question_id": 27950302, "link": "https://stackoverflow.com/questions/27950302/how-do-i-create-a-counta-formula-that-only-counts-data-in-cell-highlighted-a-spe/27952288#27952288", "title": "How do I create a counta formula that only counts data in cell highlighted a specific color?", "body": "<p>you could try this.\nthe following code asks for a cell reference for input (to receive the color to search for)\ncounts how many cells found with the specified color into a specific range.\nand returns the counted number into a messagebox.</p>\n\n<pre><code>Sub Color()\n    Dim colorCount, colorVal As Double\n    Dim rng, cell As Range\n\n    colorCount = 0\n    Set rng = Application.InputBox(prompt:=\"Write a cell address that already has the desired color.(e.g.:A1)\", Title:=\"Define the color.\", Type:=8)\n    colorVal = Cells(rng.Row, rng.Column).Interior.Color\n    For Each cell In Range(\"a1:a5\")\n        If cell.Interior.Color = colorVal Then\n            colorCount = colorCount + 1\n        End If\n    Next\n    MsgBox colorCount\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4454717, "user_type": "registered", "profile_image": "https://graph.facebook.com/500367975/picture?type=large", "display_name": "S. Hammock", "link": "https://stackoverflow.com/users/4454717/s-hammock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1421269003, "creation_date": 1421261364, "question_id": 27950302, "link": "https://stackoverflow.com/questions/27950302/how-do-i-create-a-counta-formula-that-only-counts-data-in-cell-highlighted-a-spe", "title": "How do I create a counta formula that only counts data in cell highlighted a specific color?", "body": "<p>I have an attendance spreadsheet with data highlighted in 3 different colors. At the bottom of the spreadsheet I have a CountA formula to count all cells that have an 'x' imputed for a total count each day. I also need a formula that will do the same count but by the color of the highlighted cell only. This formula will also need to automatically update when data is changed or updated on the spreadsheet. I am quite familiar with Excel but I have very little experience with creating VGA's and have not had any luck with creating one that works at this time. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 4450065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cycpLbNcHxk/AAAAAAAAAAI/AAAAAAAAANA/jbqei7Egx_g/photo.jpg?sz=128", "display_name": "Ibby", "link": "https://stackoverflow.com/users/4450065/ibby"}, "is_accepted": false, "score": 3, "last_activity_date": 1421270162, "creation_date": 1421270162, "answer_id": 27952594, "question_id": 27950263, "link": "https://stackoverflow.com/questions/27950263/excel-add-items-to-userform-combo-box/27952594#27952594", "title": "(Excel) Add items to Userform combo box", "body": "<p>I believe you are in the incorrect Private sub. You are using the event \"Change\" in the private sub \"ComboBox_1.\" You should be using the event \"Initialize\" (this event starts when the userform is loaded) in the private sub \"Userform\" to populate your ComboBox before you see the form. Here's how it should look:</p>\n\n<pre><code>Private Sub Userform_Initialize()\n\n    With Combobox1\n         .AddItem \"PRA110AC\"\n         .AddItem \"RAH111AC\"\n         .AddItem \"RAJ112AC\"\n         .AddItem \"Extern\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>I hope this helps! </p>\n"}], "owner": {"reputation": 9, "user_id": 4454721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd79a1da0172b470a029c216a534559?s=128&d=identicon&r=PG&f=1", "display_name": "huzzug", "link": "https://stackoverflow.com/users/4454721/huzzug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12853, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504121983, "creation_date": 1421261211, "last_edit_date": 1531164843, "question_id": 27950263, "link": "https://stackoverflow.com/questions/27950263/excel-add-items-to-userform-combo-box", "title": "(Excel) Add items to Userform combo box", "body": "<p>I currently have an Excel spreadsheet which is created to gather my sales staff's time sheet for the day. There are a few things I'd like to do:</p>\n\n<ol>\n<li><p>I have created a Userform with the required details within the form, but the items in Combo box do not show. Here's the code for it    </p>\n\n<pre><code>Private Sub ComboBox1_Change()\n'combobox1_list\n.AddItem \"PRA110AC\"\n.AddItem \"RAH111AC\"\n.AddItem \"RAJ112AC\"\n.AddItem \"MAL113AC\"\n.AddItem \"Extern\"\n\nEnd Sub\n</code></pre></li>\n<li><p>I want this data to be pooled to another sheet within the same workbook under appropriate headers. I also want this to be a hidden sheet as this is confidential.</p></li>\n</ol>\n\n<p>I am new to this so I may have messed this up, but I guess I get a chance ;)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 37420, "user_id": 237838, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/5jQlF.jpg?s=128&g=1", "display_name": "Andrew Barber", "link": "https://stackoverflow.com/users/237838/andrew-barber"}, "edited": false, "score": 6, "creation_date": 1421261067, "post_id": 27950179, "comment_id": 44295394, "body": "What does the debugger say?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1421261444, "post_id": 27950179, "comment_id": 44295633, "body": "There may already be a sheet named <code>country</code>. The <code>country</code> may contain characters not allowed in the worksheet name. The <code>country</code> may exceed the character limit for worksheet names...It would help to know specifically what your error says..."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421261511, "post_id": 27950179, "comment_id": 44295667, "body": "How are you defining the <code>ActiveCell</code>?  Use of this can cause problems.  Can you define the <code>Range()</code> of the cell you want the value from? (Especially if you select more than one cell)"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1421263029, "post_id": 27950179, "comment_id": 44296468, "body": "@DavidZemens, your comment is actually an answer, and I bet my hat it&#39;s THE answer."}], "answers": [{"comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1421264198, "post_id": 27950987, "comment_id": 44297115, "body": "<a href=\"https://christopherjmcclellan.wordpress.com/2013/10/25/dynamically-naming-excel-worksheets-the-headache-free-way/\" rel=\"nofollow noreferrer\">I wrote some code to handle worksheet naming</a>. Seems very relevant. It&#39;s also restricted to just 31 characters, not 34."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421264590, "post_id": 27950987, "comment_id": 44297330, "body": "Sorry, didn&#39;t see you were posting an answer while I was writing mine. Would you like to join the two (I can edit yours, you arrived first ;))"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1421264674, "post_id": 27950987, "comment_id": 44297374, "body": "@RubberDuck great example code! Thanks also for clarifying on the char limit and the certain special characters."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1421264997, "last_edit_date": 1421264997, "creation_date": 1421264115, "answer_id": 27950987, "question_id": 27950179, "link": "https://stackoverflow.com/questions/27950179/assign-value-to-variable-error-in-excel-vba/27950987#27950987", "title": "Assign value to variable error in Excel VBA", "body": "<p>When naming worksheets, you have to keep in mind the restrictions:</p>\n\n<ul>\n<li><p>A worksheet cannot have the same name as an already-existing\nworksheet.</p></li>\n<li><p>A worksheet's name cannot exceed 31 characters.</p></li>\n<li><p>Some special characters are not allowed: this includes both forward/bacwkard slash, square brackets,    question mark, asterisk and colon.</p></li>\n</ul>\n\n<p>There may be additional limitations on worksheet names, but these ones come to mind immediately because I have encountered them in the past.</p>\n\n<p>This is a code snippet that handle worksheet's names validation: </p>\n\n<pre><code>Function validateWSName(ByVal test_name As String) As String\n    'if name is blank, give a valid name to continue testing\n     If test_name = \"\" Then test_name = \"wsName\"\n     'if name is longer than 31 characters, then cut it off\n     If Len(test_name) &gt; 31 Then test_name = Left(test_name,31)\n     'if name contains forbidden characters : \\ / ? * [ or ] then eliminate them\n     test_name = Replace(test_name, \":\", \"\")\n     test_name = Replace(test_name, \"/\", \"\")\n     test_name = Replace(test_name, \"\\\", \"\")\n     test_name = Replace(test_name, \"?\", \"\")\n     test_name = Replace(test_name, \"*\", \"\")\n     test_name = Replace(test_name, \"[\", \"\")\n     test_name = Replace(test_name, \"]\", \"\")\n     'if name already exists in the worbook, then add a counter at the end\n     For Each ws In ThisWorkbook.Sheets\n         If ws.Name = test_name Then\n             keyName = ws.Name\n             counter = 1\n             test_name = test_name &amp; counter\n             Do While test_name = keyName\n                 If counter &lt; 10 Then\n                     test_name = Left(test_name, Len(test_name)-1) &amp; counter \n                 Else\n                     test_name = Left(test_name, Len(test_name)-2) &amp; counter\n                 End If\n                 counter = counter + 1\n             Loop\n             Exit For\n         End If\n     Next ws\n\n     validateWSName = test_name\nEnd Function\n</code></pre>\n\n<p>Your probability of getting errors there would hence reduce a lot if you add this snippet to your project and rewrite your code as follows:</p>\n\n<pre><code>Sub Makro1()\n\nDim country As String\nLet country = ActiveCell.Value\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = validateWSName(country)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 27950987, "answer_count": 1, "score": -2, "last_activity_date": 1421264997, "creation_date": 1421260929, "last_edit_date": 1421261195, "question_id": 27950179, "link": "https://stackoverflow.com/questions/27950179/assign-value-to-variable-error-in-excel-vba", "title": "Assign value to variable error in Excel VBA", "body": "<p>I'm new in VBA and I have some issues since very beginning. I want to create new sheet which is named same like the value in active cell. I wrote such a script:</p>\n\n<pre><code>Sub Makro1()\n\nDim country As String\nLet country = ActiveCell.Value\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = country\n\nEnd Sub\n</code></pre>\n\n<p>Debugger points line with <code>ActiveSheet.Name = country</code>. What is wrong with this code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1421261246, "post_id": 27950093, "comment_id": 44295504, "body": "If you set a new custom number to the first cell with VBA (<code>.range(&quot;A1&quot;).NumberFormat = &quot;0.0%;@&quot;</code>), doesn&#39;t that new custom number format become listed for future use with a bulk replacement operation?"}, {"owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "edited": false, "score": 0, "creation_date": 1421261919, "post_id": 27950093, "comment_id": 44295887, "body": "@Jeeped yep, this seems to solve it :). What exactly does the &quot;;@&quot; do? I am not familiar with this."}], "answers": [{"comments": [{"owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "edited": false, "score": 1, "creation_date": 1421317007, "post_id": 27950697, "comment_id": 44315797, "body": "This works perfectly too, although about 2 times slower than the answer @Jeeped gave. It seems that looping through each cell in a large range is slower than the bulk find/replace. Thanks a lot!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1421262876, "creation_date": 1421262876, "answer_id": 27950697, "question_id": 27950093, "link": "https://stackoverflow.com/questions/27950093/excel-vba-add-a-custom-number-format/27950697#27950697", "title": "Excel VBA - add a custom number format", "body": "<p>Consider the simple:</p>\n\n<pre><code>Sub dural()\n    Dim r As Range\n    For Each r In ActiveSheet.UsedRange\n        If r.NumberFormat = \"0.00%\" Then\n            r.NumberFormat = \"0.0%\"\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1421265072, "creation_date": 1421265072, "answer_id": 27951232, "question_id": 27950093, "link": "https://stackoverflow.com/questions/27950093/excel-vba-add-a-custom-number-format/27951232#27951232", "title": "Excel VBA - add a custom number format", "body": "<p>If you apply the custom number format to a single cell, it will become 'listed' and subsequently available for future use with a bulk replacement operation. I might recommend using something like,</p>\n\n<pre><code> .range(\"A1\").NumberFormat = \"0.0%;@\"\n</code></pre>\n\n<p>That particular format mask can be applied to any cell with a percentage or text. If you had a column header label with a text value and applied that CNF, the <code>;@</code> portion forces the text to be displayed literally (without change). In this manner you are open to more possibilities <em>where</em> you put the first CNF. After it has been used once, it will be available for bulk replacement operation(s) on the remainder of the percentage values.</p>\n"}], "owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25618, "favorite_count": 0, "accepted_answer_id": 27951232, "answer_count": 2, "score": 3, "last_activity_date": 1444311172, "creation_date": 1421260644, "last_edit_date": 1531161705, "question_id": 27950093, "link": "https://stackoverflow.com/questions/27950093/excel-vba-add-a-custom-number-format", "title": "Excel VBA - add a custom number format", "body": "<p>I have a file, generated outside Excel with many percentages. All these percentages have a single decimal place. When imported into excel, Excel adds a second decimal place to the percentages - this seems to be some default format for percentages in Excel. It just adds a \"0\".</p>\n\n<p>I want to format all double-decimal places percentages to a single decimal point. If I do this manually, by using CTRL+H, Find format/replace format, it goes well. But I cannot do this via VBA/macro, even if I record the macro while doing the replacement manually. The code generated by recording the macro is this:</p>\n\n<pre><code>Application.FindFormat.NumberFormat = \"0.00%\"\nApplication.ReplaceFormat.NumberFormat = \"0.0%\"\nCells.Replace What:=\"\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\n    xlByRows, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True\n</code></pre>\n\n<p>The failure happens at:</p>\n\n<pre><code>Application.ReplaceFormat.NumberFormat = \"0.0%\"\n</code></pre>\n\n<p>After a lot of trial and error, I found that the new format needs to be in the Custom format list. But single-decimal place percentages is not there by default. If I manually format a single cell to the desired format, the macro works. Of course, I do not want to do that with every file.</p>\n\n<p>Any input would be much appreciated.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ms-access", "ms-word", "vba", "field"], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 1586303, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/42736209bde3ef40c23d29827309c2bb?s=128&d=identicon&r=PG", "display_name": "Chuck", "link": "https://stackoverflow.com/users/1586303/chuck"}, "is_accepted": true, "score": 0, "last_activity_date": 1421265342, "last_edit_date": 1421265342, "creation_date": 1421262161, "answer_id": 27950525, "question_id": 27949590, "link": "https://stackoverflow.com/questions/27949590/cant-set-field-name-when-creating-word-document/27950525#27950525", "title": "Can&#39;t set field name when creating word document", "body": "<p>I needed to address the Cell first:\n    <code>.Cell(1, 2).Range.FormFields(1).Result = \"Joseph\"</code> and\n    <code>.Cell(1, 2).Range.FormFields(1).Name = \"FirstName\"</code>\nrather than\n    <code>fField.Text</code>.</p>\n"}], "owner": {"reputation": 193, "user_id": 1586303, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/42736209bde3ef40c23d29827309c2bb?s=128&d=identicon&r=PG", "display_name": "Chuck", "link": "https://stackoverflow.com/users/1586303/chuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 27950525, "answer_count": 1, "score": 0, "last_activity_date": 1594652456, "creation_date": 1421258842, "last_edit_date": 1594652456, "question_id": 27949590, "link": "https://stackoverflow.com/questions/27949590/cant-set-field-name-when-creating-word-document", "title": "Can&#39;t set field name when creating word document", "body": "<p>I'm using Office 365. My Access VBA code is creating a Word document. I can add a field onto a table within the document. But when I try to set the Name of the field or the text within the field, it is bombing out. Here's my code:</p>\n\n<pre><code>Dim WordApp As New Word.Application\nDim WordDoc As New Word.Document\nDim fField As Word.FormField\n\nSet WordApp = CreateObject(\"Word.Application\")\nWordApp.Visible = True\nWordApp.Activate\nSet WordDoc = WordApp.Documents.Add\nWordDoc.Select\n' Here I set up some header text, then I set WordRange to be at the end of the document\nSet WordTable = WordDoc.Tables.Add(WordRange, 6, 4)\n\nWith WordDoc.Tables(1)\n    Set oRange = .Cell(1, 2).Range\n    Set fField = ActiveDocument.FormFields.Add(Range:=oRange, Type:=wdFieldFormTextInput)\n'\n' If I do it either of the two ways below, I get a 'Runtime error 91: Object Variable or With block variable not set'\n'\nfField.Range.Fields(1).Result.Text = \"FirstName\"\nfField.Range.Text = \"FirstName\"\n'\n' The same error comes up when I try to\n'\nfField.Name = \"FirstName\"\nEnd With\n</code></pre>\n\n<p>I've seen examples for both of these approaches on websites, they all seem to say that this will work.</p>\n\n<p>Do note that I've chopped out a bunch of stuff that also populates the table, but I don't think it has any affect on what I'm doing here.</p>\n\n<p>It bombs out on either line: </p>\n\n<pre><code>fField.Range.Fields(1).Result.Text = \"FirstName\" \n</code></pre>\n\n<p>or </p>\n\n<pre><code>fField.Range.Text = \"firstName\" \n</code></pre>\n\n<p>(I only use one of those at a time, I comment out the other). Both of these result in the following error.</p>\n\n<blockquote>\n  <p>Runtime error 91: Object Variable or With block variable not set.</p>\n</blockquote>\n\n<p>While waiting for a response, I copied all of my code into a temp routine and I got rid of all the extraneous stuff. I found that when I try to put the field into a table, it bombs (at the lines mentioned above), but when I create the field outside of a table, it can set the text and the name of the field with no problem! Any ideas how I can get this to work inside of a table???</p>\n"}, {"tags": ["excel", "vba", "pdf", "union"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1421258712, "post_id": 27949449, "comment_id": 44294089, "body": "Just write: <code>Summary_with_Criteria.ExportAsFixedFormat</code>...  (Well there are some other syntax things too...)"}, {"owner": {"reputation": 77, "user_id": 4366760, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f0cb5ddaa7ec68506d1df7e5d2742ca4?s=128&d=identicon&r=PG&f=1", "display_name": "aoswald", "link": "https://stackoverflow.com/users/4366760/aoswald"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421259310, "post_id": 27949449, "comment_id": 44294427, "body": "thanks Chrismas007, that worked except it put the second range on a separate page"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421260580, "post_id": 27949449, "comment_id": 44295143, "body": "In that case, I would just copy each range to a temp sheet, save that sheet as PDF, then delete that sheet."}, {"owner": {"reputation": 77, "user_id": 4366760, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f0cb5ddaa7ec68506d1df7e5d2742ca4?s=128&d=identicon&r=PG&f=1", "display_name": "aoswald", "link": "https://stackoverflow.com/users/4366760/aoswald"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421260869, "post_id": 27949449, "comment_id": 44295283, "body": "ok thanks - I&#39;ll try that"}], "owner": {"reputation": 77, "user_id": 4366760, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f0cb5ddaa7ec68506d1df7e5d2742ca4?s=128&d=identicon&r=PG&f=1", "display_name": "aoswald", "link": "https://stackoverflow.com/users/4366760/aoswald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1421259281, "creation_date": 1421258383, "last_edit_date": 1421259281, "question_id": 27949449, "link": "https://stackoverflow.com/questions/27949449/combine-ranges-to-pdf", "title": "Combine Ranges to PDF", "body": "<p>I would like to combine two ranges that I have defined and save the to a pdf.  So far I have this:</p>\n\n<pre><code>Sub SaveAsPDF3()\n'\n' SaveAsPDF Macro\n'\nDim pdfpath As String\nDim RP_Sum As Integer\nDim RP_Sum_Tot As Integer\nDim Summary As Range\nDim Critera As Range\nDim Summary_with_Criteria As Range\nSet Criteria = Range(\"Criteria\")\nSet Summary = Range(\"Summary\")\n\n\nActiveSheet.PageSetup.Orientation = xlLandscape\npdfpath = Range(\"Ind_RP_Pdf\")\n\nRP_Sum = Application.WorksheetFunction.CountA(Sheets(\"Reports\").Range(\"A10:A100\"))\nMsgBox (RP_Sum)\nRP_Sum_Tot = 8 + RP_Sum + 2\n'MsgBox (RP_Sum_Tot)\n    Range(Cells(8, 1), Cells(RP_Sum_Tot, 11)).Name = \"Summary\"\nSet Summary_with_Criteria = Application.Union(Summary, Criteria)\n\nRange(\"Summary_with_Criteria\").ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=pdfpath, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n\nRange(\"Report_Learner\").Select\nEnd Sub\n</code></pre>\n\n<p>I get an error on the ExprotAsFixedformat line</p>\n\n<p>Any suggestions?\nthanks</p>\n"}, {"tags": ["performance", "excel", "for-loop", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1421260555, "post_id": 27949117, "comment_id": 44295127, "body": "If you repeated call a sub with new criteria, the sub has to set up the environment (e.g. <code>With Sheets(&quot;mySheet&quot;) ... End With</code> or Set ws = Sheets(&quot;mySheet&quot;), last_row = ..., etc) to process the procedure. If the loop is within the sub, the environment is only set once."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1421264775, "post_id": 27949117, "comment_id": 44297433, "body": "Performance is a non-issue, reading the file from the disk or the network takes <i>much</i> longer.  Focus on writing logical and maintainable code."}, {"owner": {"reputation": 23, "user_id": 4454429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W4nSFCkg9V0/AAAAAAAAAAI/AAAAAAAAAqY/MxhkDVaG3Bw/photo.jpg?sz=128", "display_name": "Stanley Law", "link": "https://stackoverflow.com/users/4454429/stanley-law"}, "edited": false, "score": 0, "creation_date": 1421265325, "post_id": 27949117, "comment_id": 44297756, "body": "Hans, I guess this is the essence of my question.  I know it will work either way.  I just don&#39;t know which preferred."}], "answers": [{"comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421266129, "post_id": 27949734, "comment_id": 44298172, "body": "Even if in the same module?  Outside the scope of the sub?"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 1, "creation_date": 1421272280, "post_id": 27949734, "comment_id": 44301289, "body": "It all has to do with the L1/L2 cache of the processor. The registers are &#215; times faster than nearby memory access so if your program keeps things within the scope of the loop it is going to be much faster since the compiler is going to translate this into registry access commands vs. pointer memory access."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": true, "score": 1, "last_activity_date": 1421259337, "creation_date": 1421259337, "answer_id": 27949734, "question_id": 27949117, "link": "https://stackoverflow.com/questions/27949117/vba-loop-efficiency/27949734#27949734", "title": "VBA loop efficiency", "body": "<p>This question is too broad right now to be answered effectively. So am just offering a small insight that might help you structure your program.</p>\n\n<p>Typically the most efficient code is the one where all the variables are as local as possible. If inside a loop you are using globals, or calling other functions it is going to be much worse than performing all the calculation with local variables.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4454429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W4nSFCkg9V0/AAAAAAAAAAI/AAAAAAAAAqY/MxhkDVaG3Bw/photo.jpg?sz=128", "display_name": "Stanley Law", "link": "https://stackoverflow.com/users/4454429/stanley-law"}, "edited": false, "score": 1, "creation_date": 1421265233, "post_id": 27951045, "comment_id": 44297711, "body": "Interesting.  I hadn&#39;t even thought about attempting to run some sort of timer code.  I will look at this.  Thank you."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 23, "user_id": 4454429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W4nSFCkg9V0/AAAAAAAAAAI/AAAAAAAAAqY/MxhkDVaG3Bw/photo.jpg?sz=128", "display_name": "Stanley Law", "link": "https://stackoverflow.com/users/4454429/stanley-law"}, "edited": false, "score": 0, "creation_date": 1421265908, "post_id": 27951045, "comment_id": 44298059, "body": "Thanks for asking the question. I&#39;ve been wanting to make a timer for this for a while, but never really got around to it until this. In your particular example, it might not be noticeable, but this can be applied to any procedures, including comparing <code>WorksheetFunctions</code> vs VBA functions, or anything.  It would probably be most useful on large DataSets."}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": false, "score": 0, "last_activity_date": 1421267452, "last_edit_date": 1495540256, "creation_date": 1421264379, "answer_id": 27951045, "question_id": 27949117, "link": "https://stackoverflow.com/questions/27949117/vba-loop-efficiency/27951045#27951045", "title": "VBA loop efficiency", "body": "<p>If you want to test each, and time them, you can use a timer.  If you have a major gap, you will be able to catch it.  If not, you will have your answer with no significant difference as far as processing time. </p>\n\n<ul>\n<li>You can either use this and call your sub from <code>TimerTest</code>, or simply <code>Call TimerStart</code> at the beginning of your code and <code>TimerStop</code> at the end.  </li>\n<li>Run some code with the timer</li>\n<li>Log the result</li>\n<li>Repeat and compare</li>\n<li><code>HH:MM:SS:00</code> format</li>\n</ul>\n\n<p><strong>Timer Code:</strong></p>\n\n<pre><code>Public strStartTime As String\nPublic strEndTime As String\nPublic startTime As Date\nPublic endTime As Date\n\n\nSub timeTest()\n\n    Call TimerStart\n        'INSERT CALL TO YOUR SUB HERE\n    Call TimerStop   \n\nEnd Sub\n\nSub TimerStart()\n\n    startTime = Now\n\nEnd Sub\n\nSub TimerStop()\n\n    endTime = Now\n\n'Waited until the timer stopped to perform any additional code, such as formatting the time\n\n    Dim TotalTime As String\n\n    strStartTime = Format(startTime, \"hh:mm:ss:\" &amp; Right(Format(Timer, \"#0.00\"), 2))  \n    strEndTime = Format(endTime, \"hh:mm:ss:\" &amp; Right(Format(Timer, \"#0.00\"), 2))\n    TotalTime = Format(endTime - startTime, \"hh:mm:ss:\" &amp; Right(Format(Timer, \"#0.00\"), 2))\n\n    MsgBox (\"      Start: \" &amp; strStartTime &amp; vbNewLine &amp; _\n            \"        End: \" &amp; strEndTime &amp; vbNewLine &amp; _\n            \"Total Time : \" &amp; TotalTime)               \nEnd Sub\n</code></pre>\n\n<p><strong>Credit:</strong> @Nick Dandoulakis for timer formatting in his answer here: <a href=\"https://stackoverflow.com/questions/1470632/vba-show-clock-time-with-accuracy-of-less-than-a-second\">Providing this solution to show clock time with accuracy of less than a second</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 4454429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W4nSFCkg9V0/AAAAAAAAAAI/AAAAAAAAAqY/MxhkDVaG3Bw/photo.jpg?sz=128", "display_name": "Stanley Law", "link": "https://stackoverflow.com/users/4454429/stanley-law"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 27949734, "answer_count": 2, "score": 2, "last_activity_date": 1421267452, "creation_date": 1421257235, "last_edit_date": 1531164843, "question_id": 27949117, "link": "https://stackoverflow.com/questions/27949117/vba-loop-efficiency", "title": "VBA loop efficiency", "body": "<p>I've used the answers found in the site a TON of times, but this is my first post.</p>\n\n<p>Is it more efficient to perform a for loop inside a function or sub or to just send the incremented value of the loop into the function or sub as an argument?</p>\n\n<p>I am importing some text data files into Excel, parsing out the various fields, and then splitting some of the fields into individual characters.  One file I am using is a list of doctors.  I have name, address, phone, DEA number, NPI, etc.</p>\n\n<p>When checking the DEA number, I have a sub that receives the line number to be checked that splits the DEA into its individual digits, perform checking on these digits one at a time and then modify another field with the status of that DEA.  This status cell will be colored red if it contains anything but the word \"GOOD\".  Also, I am coloring the individual digit that is bad, if applicable.  </p>\n\n<p>This one sub is doing a lot and I could probably break it up a little, but there aren't any other places in the doctor file that I am performing this exact step, so I figured I should keep it like it is.</p>\n\n<p>Anyways, the real question is whether I should send the line number into the sub or should I just call the sub and have the sub calculate the number of lines and do the checking.  In the first case, I will call the sub a number of times equal to the number of lines in the doctor file.  In the second, I will call the sub once and the sub contains the for loop for each line.  Which is usually more efficient.</p>\n\n<p>Apologies if I seem redundant.  I train some complex software and that sort of thing leaks into other areas of life sometimes. </p>\n\n<p>EDIT:  I tried to add this into a comment but have insufficient experience posting here.  Apologies if I violate some rule for this...</p>\n\n<p>Here is the code I use currently to call the sub:</p>\n\n<pre><code>'Use the Doctor Last Name as the number of rows count\nDim numRows As Integer\nnumRows = Application.CountA(Sheets(\"DoctorDEA\").Range(\"m:m\"))\n\n'lineCtr is the Line Counter used to iterate the FOR loops\nDim lineCtr As Integer\n    lineCtr = 1\n\n'Call DEACHecking and DisplayIssues Subs\nFor lineCtr = 1 To numRows - 1\n    DEAChecking (lineCtr)\n    DisplayIssues (lineCtr)\nNext lineCtr\n</code></pre>\n\n<p>My questions is this:  Would it be better to just call DEAChecking with no arguments and just have DEAChecking calculate the line numbers and then use the FOR loop or to leave it as is?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1421261687, "post_id": 27948860, "comment_id": 44295755, "body": "Not much there but see <a href=\"http://stackoverflow.com/questions/2312050/intercepting-outlook-category-assignment-events\">this</a> thread"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1421344991, "creation_date": 1421344991, "answer_id": 27970030, "question_id": 27948860, "link": "https://stackoverflow.com/questions/27948860/capturing-the-assigned-category-to-email-in-excel-sheet-real-time-vba/27970030#27970030", "title": "Capturing the assigned category to email in excel sheet (real time) VBA", "body": "<p>Yes, you are on the right avenue - the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff865866(v=office.15).aspx\" rel=\"nofollow\">ItemChange</a> is a way to go. For example:</p>\n\n<pre><code>Public WithEvents myOlItems As Outlook.Items  \n\nPublic Sub Initialize_handler()  \n    Set myOlItems = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderCalendar).Items  \nEnd Sub \n\nPrivate Sub myOlItems_ItemChange(ByVal Item As Object)  \n    Dim prompt As String    \n    prompt = Item.Categories \n    If MsgBox(prompt, vbYesNo + vbQuestion) = vbYes Then \n       Item.Display  \n    End If         \nEnd Sub\n</code></pre>\n\n<p>Also you may consider handling the <a href=\"http://msdn.microsoft.com/en-us/library/office/ff868239(v=office.15).aspx\" rel=\"nofollow\">PropertyChange</a> event of Outlook items.</p>\n"}], "owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "accepted_answer_id": 27970030, "answer_count": 1, "score": 0, "last_activity_date": 1593475025, "creation_date": 1421256381, "last_edit_date": 1593475025, "question_id": 27948860, "link": "https://stackoverflow.com/questions/27948860/capturing-the-assigned-category-to-email-in-excel-sheet-real-time-vba", "title": "Capturing the assigned category to email in excel sheet (real time) VBA", "body": "<p>My goal is to capture to an excel sheet what category each email is assigned.</p>\n\n<p>I want to capture this information in real time as once categorized the emails are then moved to different folders.</p>\n\n<p>So I am running the below code in \"ThisOutlookSession\" to save the Subject &amp; the Body of the received emails (I also sometimes capture the received date/time, etc...): </p>\n\n<pre><code>Private WithEvents myOlItems  As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim olApp As Outlook.Application\n    Dim objNS As Outlook.NameSpace\n      Set olApp = Outlook.Application\n      Set objNS = olApp.GetNamespace(\"MAPI\")\n      Set myOlItems = objNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub myOlItems_ItemAdd(ByVal item As Object)\n\nOn Error GoTo ErrorHandler\n\n  Dim Msg As Outlook.MailItem\n\n  If TypeName(item) = \"MailItem\" Then\n    Set Msg = item\n\n\n    Dim XLApp As Object ' Excel.Application\n    Dim XlWK As Object ' Excel.Workbook\n    ' New Excel.Application\n    Set XLApp = CreateObject(\"Excel.Application\")\n     On Error Resume Next\n   Set wb = XLApp.Workbooks.Open _\n (\"C:\\Users\\Name\\Downloads\\Test.xlsx\")\n XLApp.Visible = True\n wb.Worksheets(\"Sheet1\").Range(\"B2\").Value = Msg.Subject\n wb.Worksheets(\"Sheet1\").Range(\"C2\").Value = Msg.Body\n    On Error GoTo 0\n\n    MsgBox Msg.Subject\n    MsgBox Msg.Body\n\n  End If\n\nProgramExit:\n  Exit Sub\nErrorHandler:\n  MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n  Resume ProgramExit\nEnd Sub\n</code></pre>\n\n<p>My goal is to capture once the email is categorized (i.e. once a category is assigned to an email). I think the ItemChange event will be the way to go, but haven't had any luck getting it to work so far.</p>\n\n<p>Any advise on how to go about changing my code to capture the email's body &amp; subject once the category is assigned will be highly appreciated.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 611, "user_id": 3861489, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1cb3c96bca2dc5329a4a308ca2f3f7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3861489/brian"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1421254490, "post_id": 27948162, "comment_id": 44291470, "body": "You&#39;re right, but this is only one part of a larger script...VBA was the most efficient way to get what I was looking for."}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 3861489, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1cb3c96bca2dc5329a4a308ca2f3f7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3861489/brian"}, "edited": false, "score": 0, "creation_date": 1421255627, "post_id": 27948417, "comment_id": 44292158, "body": "Awesome! Thank you very much for your help, I really appreciate it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1421254839, "creation_date": 1421254839, "answer_id": 27948417, "question_id": 27948162, "link": "https://stackoverflow.com/questions/27948162/loop-through-names-and-total-sales-for-each-name-from-a-separate-worksheet/27948417#27948417", "title": "Loop through names and total sales for each name from a separate worksheet", "body": "<p>A native worksheet <code>SUMIF</code> formula should give you the results you need.</p>\n\n<pre><code>with sheets(\"Sheet1\")\n    .range(\"i1:i525\").offset(0, 1).formula = \"=SUMIF(A:A, I1, C:C)\"\nend with\n</code></pre>\n\n<p>I'm not entirely sure where column D comes in.</p>\n"}], "owner": {"reputation": 611, "user_id": 3861489, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1cb3c96bca2dc5329a4a308ca2f3f7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/3861489/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 27948417, "answer_count": 1, "score": 0, "last_activity_date": 1421254839, "creation_date": 1421253983, "last_edit_date": 1531161705, "question_id": 27948162, "link": "https://stackoverflow.com/questions/27948162/loop-through-names-and-total-sales-for-each-name-from-a-separate-worksheet", "title": "Loop through names and total sales for each name from a separate worksheet", "body": "<p>I am attempting to go through a list of sales people, and take each name and loop it through the list of sales and get a total sales for each individual sales person. I am able to take any sales person and loop through the list to get me the total sales for that individual, where I am having issues is taking each sales person, then moving onto the next sales person.</p>\n\n<p>On my spreadsheet, range(i1:i525) is the list of all 525 sales people. Column a has 10,000 sales amounts.</p>\n\n<p>Here is what I have so far...</p>\n\n<pre><code>Sub find_tot()\nDim i As Integer\nDim x As Integer\n\nx = 0\nFor Each t In Range(\"i1:i525\")\n\n    For i = 1 To 10000:\n        If Cells(i, 1).Value Like t Then\n            x = x + (Cells(i, 3).Value)\n    Else:\n        Cells(i, 4).Value = \"\"\n\n        End If\n        Range(i, 10).Value = x\n    Next\n\nNext t\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1421252762, "post_id": 27947550, "comment_id": 44290314, "body": "You are using a lot of direct cell addressing which is good but you are not specifying the parent worksheet which can be ambiguous (aka Bad). Why declare <code>ws As Worksheet</code> if you aren&#39;t going to use it?"}, {"owner": {"reputation": 1, "user_id": 4454192, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9_l5M6BDtE/AAAAAAAAAAI/AAAAAAAAADE/080uQcgRWeg/photo.jpg?sz=128", "display_name": "Josh Potts", "link": "https://stackoverflow.com/users/4454192/josh-potts"}, "edited": false, "score": 0, "creation_date": 1421253429, "post_id": 27947550, "comment_id": 44290776, "body": "@Jeeped I&#39;ve got the code from another forum, but the post was a few years old. I&#39;m pretty new to Excel macros, hence needing some help - whether it&#39;s re-writing the existing code or writing it from scratch."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4454192, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9_l5M6BDtE/AAAAAAAAAAI/AAAAAAAAADE/080uQcgRWeg/photo.jpg?sz=128", "display_name": "Josh Potts", "link": "https://stackoverflow.com/users/4454192/josh-potts"}, "edited": false, "score": 0, "creation_date": 1421254684, "post_id": 27948048, "comment_id": 44291600, "body": "thanks for the help. So that should remove the whole row for the duplicate item it&#39;s removing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 4454192, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9_l5M6BDtE/AAAAAAAAAAI/AAAAAAAAADE/080uQcgRWeg/photo.jpg?sz=128", "display_name": "Josh Potts", "link": "https://stackoverflow.com/users/4454192/josh-potts"}, "edited": false, "score": 0, "creation_date": 1421254934, "post_id": 27948048, "comment_id": 44291742, "body": "@JoshPotts - It will remove the row from column A to the last used column in row 1."}, {"owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "edited": false, "score": 0, "creation_date": 1421257349, "post_id": 27948048, "comment_id": 44293250, "body": "Well done &amp; nicely put together! +1 I would&#39;ve used the same approach: sort - remove duplicates - sort :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1421253661, "creation_date": 1421253661, "answer_id": 27948048, "question_id": 27947550, "link": "https://stackoverflow.com/questions/27947550/remove-duplicate-values-using-data-in-2-columns-removing-lowest-value/27948048#27948048", "title": "Remove Duplicate Values - Using Data In 2 Columns &amp; Removing Lowest Value", "body": "<p>I've added a <code>With ... End With</code> block that will allow you to assign the parent worksheet to all of the cell references.</p>\n\n<p>The <code>.RemoveDuplicates</code> command is vastly superior to walking through the rows and deleting them if the count is greater than 1. Remove Duplicates always removes from the bottom up so as long as the data has been sorted on column D in a descending manner, you should be OK.</p>\n\n<pre><code>Sub remdup()\n    Dim ws As Worksheet, LR As Long, LC As Integer\n\n    Set ws = Sheets(\"Sheet1\")    '&lt;&lt; change this to the name of the worksheet\n    With ws\n        LR = .Cells(Rows.Count, 1).End(xlUp).Row\n        LC = .Cells(1, Columns.Count).End(xlToLeft).Column\n        With .Cells(1, 1).Resize(LR, LC)\n            .Sort Key1:=.Columns(4), Order1:=xlDescending, _\n                Orientation:=xlTopToBottom, Header:=xlYes\n            .RemoveDuplicates Columns:=5, Header:=xlYes\n            .Sort Key1:=.Columns(1), Order1:=xlDescending, _\n                Orientation:=xlTopToBottom, Header:=xlYes\n        End With\n    End With\n    Set ws = Nothing\nEnd Sub\n</code></pre>\n\n<p>Finally, I have assumed that you actually <em>have</em> a header row. There really isn't any reason to use <code>xlGuess</code>. Either you have one or not.</p>\n"}], "owner": {"reputation": 1, "user_id": 4454192, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y9_l5M6BDtE/AAAAAAAAAAI/AAAAAAAAADE/080uQcgRWeg/photo.jpg?sz=128", "display_name": "Josh Potts", "link": "https://stackoverflow.com/users/4454192/josh-potts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 27948048, "answer_count": 1, "score": -1, "last_activity_date": 1421696948, "creation_date": 1421252178, "last_edit_date": 1421696948, "question_id": 27947550, "link": "https://stackoverflow.com/questions/27947550/remove-duplicate-values-using-data-in-2-columns-removing-lowest-value", "title": "Remove Duplicate Values - Using Data In 2 Columns &amp; Removing Lowest Value", "body": "<p>I have duplicate values in column E. Column D has numbers in. Using the two columns, I need to find duplicates in column E and remove the ones with the lowest number from the results.</p>\n\n<p>I have been trying the following code, which I found online, but am unsure which values need changing to make it work for my document. Row 1 has column titles in it. Also when running the following code, I receive an error message.</p>\n\n<pre><code>Sub remdup()\n    Dim ws As Worksheet, LR As Long, i As Long, LC As Integer\n    LR = Cells(Rows.Count, \u201cA\u201d).End(xlUp).Row\n    LC = Cells(1, Columns.Count).End(xlToLeft).Column\n    Range(Cells(1, 1), Cells(LR, LC)).Sort Key1:=Cells(1, 8), Order1:=xlDescending, _\n    Header:=xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom\n    For i = LR To 2 Step -1\n        If WorksheetFunction.CountIf(Columns(1), Cells(i, 1).Value) &gt; 1 Then Rows(i).Delete\n    Next i\n    Range(Cells(1, 1), Cells(LR, LC)).Sort Key1:=Cells(1, 1), Order1:=xlDescending, _\n    Header:=xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421252374, "post_id": 27947493, "comment_id": 44290050, "body": "FYI, if it&#39;s an ActiveX button, you can simply set its <code>TakeFocusOnClick</code> property to <code>False</code>."}, {"owner": {"reputation": 164, "user_id": 1216449, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vscMm.png?s=128&g=1", "display_name": "JLee", "link": "https://stackoverflow.com/users/1216449/jlee"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421254329, "post_id": 27947493, "comment_id": 44291369, "body": "Thank you Rory. Very useful info."}], "tags": [], "owner": {"reputation": 164, "user_id": 1216449, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vscMm.png?s=128&g=1", "display_name": "JLee", "link": "https://stackoverflow.com/users/1216449/jlee"}, "is_accepted": false, "score": 0, "last_activity_date": 1421251996, "creation_date": 1421251996, "answer_id": 27947493, "question_id": 27947132, "link": "https://stackoverflow.com/questions/27947132/expanding-and-collapsing-groups-causing-the-user-to-have-to-click-twice/27947493#27947493", "title": "Expanding and collapsing Groups causing the user to have to click twice", "body": "<p>OK, nevermind. I figured it out. It was that the button still had focus, and the first click brought the focus back to the sheet, so the 2nd click actually clicked the + or -. I fixed it by adding</p>\n\n<pre><code>Range(\"A1\").Select\n</code></pre>\n\n<p>at the end of the expand and collapse code.</p>\n"}], "owner": {"reputation": 164, "user_id": 1216449, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vscMm.png?s=128&g=1", "display_name": "JLee", "link": "https://stackoverflow.com/users/1216449/jlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421251996, "creation_date": 1421250984, "last_edit_date": 1531164843, "question_id": 27947132, "link": "https://stackoverflow.com/questions/27947132/expanding-and-collapsing-groups-causing-the-user-to-have-to-click-twice", "title": "Expanding and collapsing Groups causing the user to have to click twice", "body": "<p>I realize this is a little nitpicky, but if there is a solution, I'd like to know it.</p>\n\n<p>In an excel worksheet, rows 4 to 6 are grouped, and the sum of them shows on row 7.</p>\n\n<p>The following button code to expand and collapse the groups works fine. However, I realized that after I have used either of the buttons, when I then click on the + or - to manually expand or collapse that group (or any other group), it requires 2 clicks (wrong), instead of 1 click (correct) on the + or - sign. This leads me to believe that there might be another setting that I need to handle in the button events.</p>\n\n<pre><code>Private Sub Btn_Collapse_Rows_Click()\n   On Error Resume Next\n   Rows(\"7:7\").EntireRow.ShowDetail = False\n   On Error Goto 0\nEnd Sub\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Private Sub Btn_Expand_Rows_Click()\n   On Error Resume Next\n   Rows(\"7:7\").EntireRow.ShowDetail = True\n   On Error Goto 0\nEnd Sub\n</code></pre>\n\n<p>Does anyone know if there is a fix for this?</p>\n"}, {"tags": ["ms-access", "vba", "scheduled-tasks", "windows-server-2003"], "answers": [{"tags": [], "owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "is_accepted": false, "score": 0, "last_activity_date": 1421249589, "creation_date": 1421249589, "answer_id": 27946606, "question_id": 27946235, "link": "https://stackoverflow.com/questions/27946235/exit-an-access-vba-macro-with-an-exit-code-returned-to-the-shell-scheduled-tas/27946606#27946606", "title": "Exit an Access VBA Macro with an exit code returned to the shell / Scheduled Task Manager?", "body": "<p>If you're willing to use an API call it can:</p>\n\n<pre><code>Private Declare Sub ExitProcess Lib \"kernel32\" (ByVal uExitCode As Long)\n</code></pre>\n\n<p>In your code, you can exit with a value, like <code>7</code>, for the example below:</p>\n\n<pre><code>Call ExitProcess(7)\n</code></pre>\n\n<p>Note that calling the above will immediately exit Access without any prompt or saving or anything. It should be the very last thing you do.</p>\n"}], "owner": {"reputation": 23176, "user_id": 18149, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f5e10278b9b6a518d5835f658704d85f?s=128&d=identicon&r=PG", "display_name": "leeand00", "link": "https://stackoverflow.com/users/18149/leeand00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594651689, "creation_date": 1421248561, "last_edit_date": 1594651689, "question_id": 27946235, "link": "https://stackoverflow.com/questions/27946235/exit-an-access-vba-macro-with-an-exit-code-returned-to-the-shell-scheduled-tas", "title": "Exit an Access VBA Macro with an exit code returned to the shell / Scheduled Task Manager?", "body": "<p>I'm running a <a href=\"https://serverfault.com/questions/659430/what-event-id-is-generated-when-a-scheduled-task-fails-in-windows-server-2003/659436?noredirect=1#comment803271_659436\">scheduled task</a> in Windows Server 2003.  When the scheduled task runs, it calls a VBA Macro which runs, does some database stuff, then exits.   </p>\n\n<p>The VBA Macro needs to return a non-zero value to the Shell / Scheduled Task Manager if something goes wrong in the Macro (for instance a database goes down).</p>\n\n<p>Is it possible to return a non-zero value from the vba macro to notify the Scheduled Task Manager that something has gone wrong?  I'd like to be able to fish the value out of <code>SchedLgU.txt</code> so I can be notified when something goes wrong.</p>\n"}, {"tags": ["vba", "excel", "user-interface"], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1421248415, "creation_date": 1421248415, "answer_id": 27946185, "question_id": 27946135, "link": "https://stackoverflow.com/questions/27946135/executing-macro-without-showing-other-sheet/27946185#27946185", "title": "Executing Macro without showing other sheet", "body": "<p>turn screenupdating off, but ensure you switch it back on again when the code has finished:</p>\n\n<pre><code>Sub AutoFill()\n\nApplication.ScreenUpdating = False\nWorksheets(\"Sheet2\").Unprotect\n\nWorksheets(\"Sheet2\").Rows(\"8:8\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n\n    Set SourceRange = Worksheets(\"Sheet2\").Rows(9)\n    Set fillRange = Worksheets(\"Sheet2\").Range(\"8:9\")\n    SourceRange.AutoFill Destination:=fillRange, Type:=xlFillDefault\n\nWorksheets(\"Sheet2\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\nWorksheets(\"Sheet2\").EnableSelection = xlNoRestrictions\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 27946185, "answer_count": 1, "score": 1, "last_activity_date": 1421700122, "creation_date": 1421248266, "last_edit_date": 1421700122, "question_id": 27946135, "link": "https://stackoverflow.com/questions/27946135/executing-macro-without-showing-other-sheet", "title": "Executing Macro without showing other sheet", "body": "<p>I've developed the following macro to insert a new line in Sheet 2 and to Autofill this new line from another one. The macro is running properly.</p>\n\n<pre><code>Sub AutoFill()\n    Worksheets(\"Sheet2\").Unprotect\n    Worksheets(\"Sheet2\").Rows(\"8:8\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Set SourceRange = Worksheets(\"Sheet2\").Rows(9)\n    Set fillRange = Worksheets(\"Sheet2\").Range(\"8:9\")\n    SourceRange.AutoFill Destination:=fillRange, Type:=xlFillDefault    \n    Worksheets(\"Sheet2\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n    Worksheets(\"Sheet2\").EnableSelection = xlNoRestrictions\nEnd Sub\n</code></pre>\n\n<p>I set to run the macro on Sheet1 and I don't want Sheet2 to be shown when I do it. How do I do that?</p>\n"}, {"tags": ["vba", "button", "action", "powerpoint"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1421248231, "post_id": 27945984, "comment_id": 44287332, "body": "What kind of action button are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1421248968, "creation_date": 1421248968, "answer_id": 27946391, "question_id": 27945984, "link": "https://stackoverflow.com/questions/27945984/vba-wont-run-when-triggered-inside-slideshow-view-by-clicking-action-button/27946391#27946391", "title": "VBA won&#39;t run when triggered inside Slideshow view by clicking action button", "body": "<p>Comments inline explain where you went wrong and include a few suggestions to save trouble in the future:</p>\n\n<pre><code>Sub SaveCurrentSlideAsJpg()\n\nDim imagePath As String\n'Dim slideNum As Integer\nDim slideNum As Long\nDim oSld As Slide\n\n' temporarily to suit my testing neeeds:\n' imagePath = \"C:\\Users\\####\\Pictures\\Slides\\\"\nimagePath = \"C:\\Temp\\\"\n\n' You can't select anything during a slide show so there can be\n' no .Selection object\n'slideNum = ActiveWindow.Selection.SlideRange(1).SlideIndex\nSet oSld = SlideShowWindows(1).View.Slide\nslideNum = oSld.SlideIndex\n\n' first check if this already exists then delete it\n' Safer to convert the long to a string before appending it to other strings:\n'If Dir(imagePath &amp; ActivePresentation.Name &amp; \"_\" &amp; slideNum &amp; \".jpg\") &lt;&gt; \"\" Then\nIf Dir(imagePath &amp; ActivePresentation.Name &amp; \"_\" &amp; CStr(slideNum) &amp; \".jpg\") &lt;&gt; \"\" Then\n    Kill imagePath &amp; ActivePresentation.Name &amp; \"_\" &amp; CStr(slideNum) &amp; \".jpg\"\n  End If\n' now save the slide\n' use our previously declared slide object instead and convert slideNum to string\n 'ActiveWindow.View.Slide.Export\n ' NOTE: you might also want to make sure that the presentation's been saved\n ' at least once, else .Name will be blank and you'll get files like _1.jpg\n oSld.Export _\n FileName:=imagePath &amp; ActivePresentation.Name &amp; \"_\" &amp; CStr(slideNum) &amp; \".jpg\", _\n FilterName:=\"JPG\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4453871, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-Ov0od3gLkcM/AAAAAAAAAAI/AAAAAAAAAbk/q_RSWstAX2E/photo.jpg?sz=128", "display_name": "Aidar Amrekulov", "link": "https://stackoverflow.com/users/4453871/aidar-amrekulov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426596623, "creation_date": 1421247874, "last_edit_date": 1426596623, "question_id": 27945984, "link": "https://stackoverflow.com/questions/27945984/vba-wont-run-when-triggered-inside-slideshow-view-by-clicking-action-button", "title": "VBA won&#39;t run when triggered inside Slideshow view by clicking action button", "body": "<p>I have created a short VBA code to export the current slide in Slideshow view in JPEG format. It works when run from VBA when a slideshow is running. It doesn't work from an action button on the slide.    </p>\n\n<pre><code>Sub SaveCurrentSlideAsJpg()    \nDim imagePath As String\nDim slideNum As Integer   \nimagePath = \"C:\\Users\\####\\Pictures\\Slides\\\"\nslideNum = ActiveWindow.Selection.SlideRange(1).SlideIndex  \n' first check if this already exists then delete it    \nIf Dir(imagePath &amp; ActivePresentation.Name &amp; \"_\" &amp; slideNum &amp; \".jpg\") &lt;&gt; \"\"Then    \n    Kill imagePath &amp; ActivePresentation.Name &amp; \"_\" &amp; slideNum &amp; \".jpg\"    \nEnd If    \n' now save the slide    \n ActiveWindow.View.Slide.Export _    \n FileName:=imagePath &amp; ActivePresentation.Name &amp; \"_\" &amp; slideNum &amp; \".jpg\", _ \n FilterName:=\"JPG\"   \nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "sql-update", "vba"], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1421252827, "post_id": 27946926, "comment_id": 44290354, "body": "I tried to wrap it using Cdate and I am getting all kind of syntax error. Would you be able to assist me with it."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 1, "creation_date": 1421253701, "post_id": 27946926, "comment_id": 44290960, "body": "Could you please Edit your post? So I can see what you have done. Along with the full explanation of all the kinds of error you are getting."}, {"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1421253959, "post_id": 27946926, "comment_id": 44291112, "body": "ok, so I grabbed the date into another field &quot;TempD&quot; and formatted it properly with cdate to update my &quot;Emaildate&quot; field with it    :  UPDATE MissingT SET MissingT.emaildate = cdate(Format(Right([tempd],4) &amp; &quot;/&quot; &amp; Mid([tempd],6,3) &amp; &quot;/&quot; &amp; Mid([tempd],9,2)));                                                    Before Formatting the the date looks like &quot;Wed, Nov 26, 2014&quot;"}, {"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1421254354, "post_id": 27946926, "comment_id": 44291385, "body": "But I am still getting Conversion error. Emaildate is a Date/Time field and TempD is a text field."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1421254405, "post_id": 27946926, "comment_id": 44291421, "body": "Again ! Edit your post with what you have done, for us to see it."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1421315598, "post_id": 27946926, "comment_id": 44314999, "body": "Probably you have a few trailing spaces. Try <code>Trim</code> before formatting the String."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 1, "last_activity_date": 1421251692, "last_edit_date": 1495542041, "creation_date": 1421250390, "answer_id": 27946926, "question_id": 27944868, "link": "https://stackoverflow.com/questions/27944868/update-a-date-field/27946926#27946926", "title": "Update a date field", "body": "<p>This might be a bit more tricky than your previous problem - <a href=\"https://stackoverflow.com/questions/27903227/fnd-2nd-occourance-of-a-string-in-a-memo-field\">Fnd 2nd occourance of a string in a Memo Field</a></p>\n\n<p>Traveling bottom up, use <code>StrReverse</code> function.</p>\n\n<pre><code>? StrReverse(\"Hello World!\")\n!dlroW olleH\n</code></pre>\n\n<p>However if you wish to search a particular String's starting position, then you can use the <code>InStrRev</code>  function, </p>\n\n<pre><code>? InStrRev(\"Hello World! It is a wonderful day. It truly is\", \"It\")\n 37 \n? InStr(\"Hello World! It is a wonderful day. It truly is\", \"It\")\n 14 \n</code></pre>\n\n<p>The error you have is because Mid returns a String, but my understanding is that the field EmailDate is a Date type. So you need to wrap it using <code>CDate</code> or <code>CDbl</code> function to treat it as Date. </p>\n"}], "owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 27946926, "answer_count": 1, "score": 0, "last_activity_date": 1421254938, "creation_date": 1421244453, "last_edit_date": 1421254938, "question_id": 27944868, "link": "https://stackoverflow.com/questions/27944868/update-a-date-field", "title": "Update a date field", "body": "<p>Date Field Name: EmailDate, \nTable Name: MissingT, \nMemo Field Name: Worklog.</p>\n\n<p>I am trying to query the worklog and find a word \"Effective date: \" and get the rest of the characters on that same line following \"Effective date: \". Then update \"EmailDate\" field with it. </p>\n\n<pre><code>UPDATE MissingT SET MissingT.Emaildate = mid([Worklog],(InStr(1,[Worklog],'Effective Date: ')+16),13)\nWHERE (((MissingT.[worklog]) Like  \"*\" &amp; 'Effective Date: ' &amp; \"*\" ));\n</code></pre>\n\n<p>I am getting a conversion error message. </p>\n\n<p>Also, is there anyway to search the Worklog memo field from bottom up, rather than from top down?. I created another field called \"TempD\" and get the date in there first. So the date in TempD filed would look like \"Wed, Dec 3, 2014\". Then I did the query to update the emaildate with cdate function as below:   UPDATE MissingT SET MissingT.emaildate = cdate(Format(Right([tempd],4) &amp; \"/\" &amp; Mid([tempd],6,3) &amp; \"/\" &amp; Mid([tempd],9,2))); ........But I am still getting conversion failure. </p>\n"}, {"tags": ["vba", "excel", "error-handling", "internal-compiler-error"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1421242261, "post_id": 27944093, "comment_id": 44283538, "body": "Long shot: do you have any conditional formatting that uses UDFs?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1421242689, "post_id": 27944093, "comment_id": 44283787, "body": "I ran into this before in access and the solution there was to decompile/recompile the database. Unfortunately, I don&#39;t believe Excel VBA Projects can be decompiled."}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 2, "creation_date": 1421243362, "post_id": 27944093, "comment_id": 44284217, "body": "will it break on a STOP command?"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1421243654, "post_id": 27944093, "comment_id": 44284388, "body": "Perhaps removing that Sub, compiling, saving, closing Excel, reopening, pasting again, compiling? Or, if your workbook is not that large, transferring all data and code into a blank workbook. It might be a sledgehammer to crack a nut, but it may work."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1421244381, "post_id": 27944093, "comment_id": 44284823, "body": "Could you provide some more details about your machine and your Excel? This error is not reproducible, as you say it&#39;s not about On Error handling because that&#39;s for managing run-time errors, while this is clearly a compile error so your code should not even start running."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 2, "creation_date": 1421246055, "post_id": 27944093, "comment_id": 44285842, "body": "This might be too simple, but comment out <code>Application.EnableEvents = False</code> and see what happens..."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421248088, "post_id": 27944093, "comment_id": 44287232, "body": "@Chrismas007, at this point you might be right. In a normal context, that macro should not even start running (it&#39;s not compilable). But here it seems the compiler ignores the line of code completely, so why not."}, {"owner": {"reputation": 65, "user_id": 3579617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1619108508/picture?type=large", "display_name": "ComputerNerd3579617", "link": "https://stackoverflow.com/users/3579617/computernerd3579617"}, "edited": false, "score": 0, "creation_date": 1421408694, "post_id": 27944093, "comment_id": 44357626, "body": "I&#39;ve never heard of a stop command. I&#39;ll try that."}, {"owner": {"reputation": 65, "user_id": 3579617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1619108508/picture?type=large", "display_name": "ComputerNerd3579617", "link": "https://stackoverflow.com/users/3579617/computernerd3579617"}, "edited": false, "score": 1, "creation_date": 1421409485, "post_id": 27944093, "comment_id": 44358063, "body": "Ugh! It is the formula in the conditional formatting. <i>Why!? cruel world!?</i>"}, {"owner": {"reputation": 65, "user_id": 3579617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1619108508/picture?type=large", "display_name": "ComputerNerd3579617", "link": "https://stackoverflow.com/users/3579617/computernerd3579617"}, "reply_to_user": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1421412002, "post_id": 27944093, "comment_id": 44359440, "body": "@sancho.s I tried that. Didn&#39;t work."}, {"owner": {"reputation": 65, "user_id": 3579617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1619108508/picture?type=large", "display_name": "ComputerNerd3579617", "link": "https://stackoverflow.com/users/3579617/computernerd3579617"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421413379, "post_id": 27944093, "comment_id": 44360202, "body": "@Chrismas007 you should notice there&#39;s something in my event that would create an infinite loop if I did that."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1421419997, "post_id": 27944093, "comment_id": 44363967, "body": "Which of the two proposals did you try?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421420742, "post_id": 27944093, "comment_id": 44364485, "body": "@Rory see OP&#39;s edit. Seems you hit the nail on the head and he&#39;d like you to add that as an answer. ComputerNerd3579617 you can&#39;t ping a user from inside of a question. It only works from a comment."}], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1421250616, "post_id": 27944773, "comment_id": 44288832, "body": "Congrats on your 10k sir."}, {"owner": {"reputation": 65, "user_id": 3579617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1619108508/picture?type=large", "display_name": "ComputerNerd3579617", "link": "https://stackoverflow.com/users/3579617/computernerd3579617"}, "edited": false, "score": 0, "creation_date": 1421409822, "post_id": 27944773, "comment_id": 44358253, "body": "Er, it says it won&#39;t run on 64 bit versions of excel. I didn&#39;t even know there was a different version, how do I know I&#39;m running 64 bit? It&#39;s a company computer on 64 bit windows so i&#39;ll bet it&#39;s 64 bit software."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1421424749, "post_id": 27944773, "comment_id": 44367164, "body": "You can see exactly what version and build of Excel you are using from File-&gt;Help-&gt;About Excel in XL 2010 or File-&gt;Account-&gt;About Excel in XL 2013"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1421249106, "last_edit_date": 1421249106, "creation_date": 1421244182, "answer_id": 27944773, "question_id": 27944093, "link": "https://stackoverflow.com/questions/27944093/vba-compiler-not-breaking-trapping-on-errors-and-no-error-message-when-using/27944773#27944773", "title": "VBA compiler not breaking / trapping on errors and no error message, when using UDF in conditional formatting", "body": "<p>I suggest using Rob Bovey's Code Cleaner to get rid of the accumulated p-code that can cause errors like this. When Excel VBA starts behaving strangely cleaning the code often fixes the problem.<br>\n<a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow\">http://www.appspro.com/Utilities/CodeCleaner.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1421429262, "creation_date": 1421429262, "answer_id": 27989462, "question_id": 27944093, "link": "https://stackoverflow.com/questions/27944093/vba-compiler-not-breaking-trapping-on-errors-and-no-error-message-when-using/27989462#27989462", "title": "VBA compiler not breaking / trapping on errors and no error message, when using UDF in conditional formatting", "body": "<p>If you are using UDFs in conditional formatting, this kind of problem can occur. It is most likely if you don't have error handling, or if you try and access any properties other than <code>.Value</code> or <code>.Formula</code>. It is often possible to work around the issue - e.g. using an alternative calculation, or putting the UDF in a cell - but occasionally you may just be out of luck.</p>\n"}], "owner": {"reputation": 65, "user_id": 3579617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1619108508/picture?type=large", "display_name": "ComputerNerd3579617", "link": "https://stackoverflow.com/users/3579617/computernerd3579617"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 27989462, "answer_count": 2, "score": 6, "last_activity_date": 1421429262, "creation_date": 1421242042, "last_edit_date": 1421413211, "question_id": 27944093, "link": "https://stackoverflow.com/questions/27944093/vba-compiler-not-breaking-trapping-on-errors-and-no-error-message-when-using", "title": "VBA compiler not breaking / trapping on errors and no error message, when using UDF in conditional formatting", "body": "<p><em>See new development.</em></p>\n\n<p>I have a strange problem in Excel. I've got a <code>Worksheet_Change</code> event that I'm using and I'm trying to debug it. I save the program and open it back up and all of a sudden the compiler is not breaking on an error. In fact, it's not breaking at all!! I'll put a break at the head of the sub (and the next three lines for good measure) and it just does not happen. I thought maybe the events weren't enabled... So, I've put a message box as one of the first lines of code. The message box pops up.... even with the break on it's line.</p>\n\n<p>This happened once before on a particular line of another macro and I tried copying everything into a .txt file and pasting it back into an earlier version of my program. This worked for months, but the problem now came back. </p>\n\n<p>The coding isn't really important but I'll paste it below for kicks and giggles. It's aborting without an error wether I remove all the \"on error\"'s or not. I've cut and pasted the code into a new sub and it works fine. I've also checked the options and checked \"break on all errors.\" nothing, even an undefined call won't throw an error, will stop the program from aborting. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\nApplication.EnableEvents = False\nDim aVar() As String\nDim iVar As Integer\nOn Error GoTo 0\n\nMsgBox \"you changed something\" 'this is a msgbox that does pop up during execution, verifying that the sub did in fact, run. \nCall iRandomNonsense 'this is a sub that does not exist which the compiler does not tell me about any more.\n\nIf target.Columns.Count = 1 Then\n    Select Case target.Column\n    Case 2\n        If target.Count = 1 And Cells(target.Row, 1) = \"\" Then _\n            Cells(target.Row, 1) = Now\n    Case 8\n        On Error GoTo ExitSub\n        aVar = Split(target.Value)\n            For Each sVar In aVar\n            If IsNumeric(sVar) And Len(sVar) = 5 Then\n            If sVar &gt; 30000 Then\n            aVar(iVar) = \"ALN-\" &amp; sVar\n            Else\n            aVar(iVar) = \"DEV-\" &amp; sVar\n            End If\n            End If\n            iVar = iVar + 1\n        Next\n        target.Value = Join(aVar, \" \")\n    End Select\nElse\n    On Error GoTo ExitSub\n    target.Resize(target.Rows.Count, Cells(target.Row, target.Columns.Count).End(xlToLeft).Column + 1 - target.Column).Select\n    Select Case Selection.Columns.Count\n    Case 18, 21  'Paste from Scrap report\n        Debug.Print \"Paste from Scrap report\" &amp; Now\n        Call purgeCheckboxes\n        With Selection\n            .Copy\n            .PasteSpecial (xlValues)\n        End With\n        OnSelRow(4, 8).Select\n        Selection.Copy Destination:=OnSelRow(1)\n        'desc\n        OnSelRow(6) = OnSelRow(10)\n        OnSelRow(4) = OnSelRow(15)\n        With Range(Cells(Selection.Row, 10), Cells(Selection.Row + Selection.Rows.Count - 1, 10))\n            .FormulaR1C1 = _\n                \"=RC[2]&amp;\"\" \"\"&amp;RC[3]&amp;\"\" \"\"&amp;RC[-3]&amp;\"\" \"\"&amp;RC[4]&amp;\"\" \"\"&amp;RC[7]&amp;\"\" \"\"&amp;RC[11]\"\n            .Copy\n            .PasteSpecial (xlValues)\n        End With\n        Application.CutCopyMode = False\n        Range(Cells(Selection.Row, 7), Cells(Selection.Row + Selection.Rows.Count - 1, 7)).FormulaR1C1 = \"TRUE\"\n        Range(Cells(Selection.Row, 8), Cells(Selection.Row + Selection.Rows.Count - 1, 8)).FormulaR1C1 = \"T D Q 9 A Wav DMR\"\n        Range(Cells(Selection.Row, 9), Cells(Selection.Row + Selection.Rows.Count - 1, 9)).FormulaR1C1 = \"2\"\n        Range(Cells(Selection.Row, 11), Cells(Selection.Row + Selection.Rows.Count - 1, 11)).Select\n        Range(Selection, Cells(Selection.Row, UsedRange.Columns.Count)).Select\n        Selection.ClearContents\n        ActiveWindow.ScrollColumn = 1\n    End Select\n    Call RefreshCondFormats\nEnd If\nExitSub:\nOn Error GoTo 0\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>A new development:\nI followed the advice in one of the comments. \"Long shot: do you have any conditional formatting that uses UDFs? \u2013  Rory yesterday\" It resolved the breaking error when I deleted the User Formula in my conditional formatting. Now the compiler stops like its supposed to and when I comment out \"iRandomNonsense\" it breaks on my command. When I put the formatting back it screws up again.  </p>\n\n<p>Rory, put your comment down as an answer (with a little more description as to how you figured this out) and I'll check it off to you. </p>\n\n<p>If anyone's willing, I'd really like to know a way around this glitch in excel. It seems like a utility I might use in the future, and it really bothers me I can't use a user function in a conditional format. Also, this code has been very useful to me and I don't see any other way to do what I've done without either a user formula in conditional formatting, or a hairy autocorrect code.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 769, "user_id": 857990, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6f97ebf41e2977f6dd665b2f969ee4d?s=128&d=identicon&r=PG", "display_name": "user857990", "link": "https://stackoverflow.com/users/857990/user857990"}, "edited": false, "score": 0, "creation_date": 1421247902, "post_id": 27943842, "comment_id": 44287104, "body": "Used a work-around, by giving always the first table in the section a title and then check before merging if the title matches. This way, it can stay <code>With ActiveDocument</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1421250935, "creation_date": 1421250935, "answer_id": 27947117, "question_id": 27943842, "link": "https://stackoverflow.com/questions/27943842/have-a-vba-macro-run-for-all-tables-under-each-section/27947117#27947117", "title": "Have a VBA macro run for all tables under each section", "body": "<p>You are going to want to look into <code>StoryRanges</code> <a href=\"http://msdn.microsoft.com/en-us/library/office/ff845743%28v=office.15%29.aspx\" rel=\"nofollow\">MSDN Reference</a></p>\n\n<p>This link <a href=\"http://word.mvps.org/faqs/customization/ReplaceAnywhere.htm\" rel=\"nofollow\">CLICK HERE</a> has some great resources on looping through different <code>StoryRanges</code> for the purposes of doing a <code>Find</code> and <code>Replace</code> but you could remove that code and use your own code in its place.</p>\n"}], "owner": {"reputation": 769, "user_id": 857990, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6f97ebf41e2977f6dd665b2f969ee4d?s=128&d=identicon&r=PG", "display_name": "user857990", "link": "https://stackoverflow.com/users/857990/user857990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 774, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422550872, "creation_date": 1421241290, "last_edit_date": 1422550872, "question_id": 27943842, "link": "https://stackoverflow.com/questions/27943842/have-a-vba-macro-run-for-all-tables-under-each-section", "title": "Have a VBA macro run for all tables under each section", "body": "<p>I have an MS Word macro, that does a merge of all the tables in the document, besides the first one.</p>\n\n<pre><code>Dim rng As Range\nDim i As Long\nWith ActiveDocument\n    For i = .Tables.Count To 3 Step -1\n        Set rng = .Tables(i).Range\n        rng.Collapse wdCollapseStart\n        rng.Start = .Tables(i - 1).Range.End\n        rng.Delete\n    Next i\nEnd With\n</code></pre>\n\n<p>Now instead of it running over all tables I'd like it to run over all tables under each section heading. How would this be possible?</p>\n\n<p>Alternatively, instead of <code>ActiveDocument</code> use <code>Selection</code> and keep selecting a whole section, one after another.</p>\n"}, {"tags": ["vba", "reporting-services"], "comments": [{"owner": {"reputation": 9845, "user_id": 1594867, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/584465eb7d4dfeae286ecd15ba984077?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1594867/dan"}, "edited": false, "score": 3, "creation_date": 1421239775, "post_id": 27943204, "comment_id": 44282037, "body": "In my experience, the expression language used in SSRS feels more like VBA than VB.NET. In any case, since you can add a reference to any .NET assembly, I would guess the version depends on what version of SQL Server/Data Tools you&#39;re using. For example, with SQL Server 2014, I would guess the version is .NET 4.0 or maybe even 4.5. But why does it matter? What are you trying to achieve?"}, {"owner": {"reputation": 4411, "user_id": 1576573, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4uoQp.jpg?s=128&g=1", "display_name": "Oxon", "link": "https://stackoverflow.com/users/1576573/oxon"}, "reply_to_user": {"reputation": 9845, "user_id": 1594867, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/584465eb7d4dfeae286ecd15ba984077?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1594867/dan"}, "edited": false, "score": 0, "creation_date": 1421240058, "post_id": 27943204, "comment_id": 44282213, "body": "I was curious about the version. Googled it. Found nothing. So I thought I should ask here on stackoverflow. Your comment answers the question. You can reply to the question. I will accept it as the right answer. P.S. I knew about adding assembly references to the report but I never thought about the version of the Data Tools. Interesting."}, {"owner": {"reputation": 9845, "user_id": 1594867, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/584465eb7d4dfeae286ecd15ba984077?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1594867/dan"}, "edited": false, "score": 0, "creation_date": 1421240154, "post_id": 27943204, "comment_id": 44282265, "body": "I&#39;ll leave my comment as a comment for now - perhaps someone more enlightened can shed additional light on the question :-)"}], "answers": [{"comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1421346775, "post_id": 27970425, "comment_id": 44333651, "body": "So your &quot;answer&quot; is &quot;I don&#39;t know.&quot;?"}, {"owner": {"reputation": 1578, "user_id": 4362954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZVv4.jpg?s=128&g=1", "display_name": "SQLDiver", "link": "https://stackoverflow.com/users/4362954/sqldiver"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1421346937, "post_id": 27970425, "comment_id": 44333741, "body": "My answer is that this is undefined"}], "tags": [], "owner": {"reputation": 1578, "user_id": 4362954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZVv4.jpg?s=128&g=1", "display_name": "SQLDiver", "link": "https://stackoverflow.com/users/4362954/sqldiver"}, "is_accepted": true, "score": 4, "last_activity_date": 1421346353, "creation_date": 1421346353, "answer_id": 27970425, "question_id": 27943204, "link": "https://stackoverflow.com/questions/27943204/which-version-of-vb-is-used-in-ssrs/27970425#27970425", "title": "Which version of VB is used in SSRS", "body": "<p>Good question.  Microsoft are not very clear about this.  The RDL specification for SQL Server 2008 R2 states that expressions \"are defined in a Visual Basic compatible syntax\", but does not provide any other detail, except an obsolete link.  There is also no mention of custom code other than .NET references for precompiled dlls.</p>\n\n<p>Code written in a report is stored as text within the RDL file after it is deployed, which means that it is either interpreted on the fly or JIT-compiled when it the report is run.  For this reason, if you have a large volume of, or intensive code, precompiling to a dll and referencing it in the report will offer better performance.</p>\n"}], "owner": {"reputation": 4411, "user_id": 1576573, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4uoQp.jpg?s=128&g=1", "display_name": "Oxon", "link": "https://stackoverflow.com/users/1576573/oxon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 1, "accepted_answer_id": 27970425, "answer_count": 1, "score": 8, "last_activity_date": 1421346353, "creation_date": 1421239299, "question_id": 27943204, "link": "https://stackoverflow.com/questions/27943204/which-version-of-vb-is-used-in-ssrs", "title": "Which version of VB is used in SSRS", "body": "<p>Which version of Visual Basic does SSRS support?</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-GB/library/ms156028.aspx\" rel=\"noreferrer\">MSDN page</a> says that you write Visual Basic in the report code but doesn't say much about the version.</p>\n"}, {"tags": ["vba", "ms-word", "word-2007"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1421246753, "post_id": 27943179, "comment_id": 44286308, "body": "What have you done to debug? Put a breakpoint on your <code>For Each shp</code> statement, and check the <code>shp.Type</code> property for a known &quot;line&quot;. It may not be of type <code>msoLine</code>, and that would obviously then &quot;fail&quot; to select/delete such shapes."}, {"owner": {"reputation": 38, "user_id": 2531449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c944d68ab6b21b44f355855120139a67?s=128&d=identicon&r=PG", "display_name": "user2531449", "link": "https://stackoverflow.com/users/2531449/user2531449"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424200765, "post_id": 27943179, "comment_id": 45448677, "body": "can you brief me a little more."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424201322, "post_id": 27943179, "comment_id": 45448978, "body": "I don&#39;t have either 2003 or 2007 available to test these conditions, and in 2010, the shapes default names are not like what you describe (instead, I get &quot;Straight Connector 1&quot;, etc.).  So, you should do some debugging and try to tinker with the various properties to see what is possible."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424201646, "post_id": 27943179, "comment_id": 45449162, "body": "Why don&#39;t people understand that code is absolutely illegible when you put it in the <i>comments</i>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424201680, "post_id": 27943179, "comment_id": 45449183, "body": "When deleting items from a collection, it is always necessary to iterate backwards through the collection."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424201846, "post_id": 27943179, "comment_id": 45449263, "body": "Revise your Q to include that code. Also, please clarify what precisely is the problem and you have arrived at that. For example, previously you indicate some difficulty determining the version origin of each shape. Are you sure that&#39;s actually relevant? Or if, after debugging you realize that maybe some shapes are not deleted because you&#39;re indexing incorrectly, then state that as the problem."}, {"owner": {"reputation": 38, "user_id": 2531449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c944d68ab6b21b44f355855120139a67?s=128&d=identicon&r=PG", "display_name": "user2531449", "link": "https://stackoverflow.com/users/2531449/user2531449"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424202167, "post_id": 27943179, "comment_id": 45449454, "body": "I have updated the question also my problem is that the code i have not deleting the autoshape line (straight connector) all at once."}, {"owner": {"reputation": 38, "user_id": 2531449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c944d68ab6b21b44f355855120139a67?s=128&d=identicon&r=PG", "display_name": "user2531449", "link": "https://stackoverflow.com/users/2531449/user2531449"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424202606, "post_id": 27943179, "comment_id": 45449656, "body": "David Zemens could you please try and let me know?"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1424204663, "last_edit_date": 1424204663, "creation_date": 1424202672, "answer_id": 28569942, "question_id": 27943179, "link": "https://stackoverflow.com/questions/27943179/word-2007-vba-cant-delete-all-the-autoshape-line-at-once/28569942#28569942", "title": "word 2007 vba can&#39;t delete all the autoshape line at once", "body": "<p>When you are removing items from a collection, it is necessary to do this in <em>reverse</em> order. This is because collections are indexed. Consider the following example collection:</p>\n\n<pre><code>Item#  Name\n  1      David\n  2      Sergio\n  3      Beatrice\n  4      Eunice\n</code></pre>\n\n<p>If we do attempt to delete all items by straight iteration from 1 to .Count, it will not work:</p>\n\n<pre><code>Sub foo()\nDim coll As New Collection\nDim i As Integer\n\ncoll.Add 1, \"David\"\ncoll.Add 2, \"Sergio\"\ncoll.Add 3, \"Beatrice\"\ncoll.Add 4, \"Eunice\"\n\nFor i = 1 To coll.Count\n    coll.Remove (i)\nNext\n\nMsgBox coll.Count\n\nEnd Sub\n</code></pre>\n\n<p>On the first iteration, i = 1 and it will remove \"David\", on the second pass, i = 2, but since item 1 was previously removed, the second index is now \"Beatrice\", so \"Sergio\" is skipped. And on the third iteration, i = 3 but there is no longer 3 items in the collection and you will get an error! (subscript out of range). If you have not encountered the error yet, that is possible.</p>\n\n<p>So, to avoid this problem, you need to step backwards:</p>\n\n<pre><code>For i = coll.Count to 1 Step -1\n    coll.Remove(i)\nNext\n</code></pre>\n\n<p>This means you have to use an indexed iteration rather than a <code>For Each</code>, so adapted to your code, you can try like:    </p>\n\n<pre><code>For i = ActiveDocument.Shapes.Count to 1 Step - 1\n    Set shp = ActiveDocument.Shapes(i)\n\n    If shp.Type = msoAutoShape Then\n\n        ActiveWindow.ScrollIntoView Selection.Range, True\n        shp.Select\n\n        If Selection.ShapeRange.Line.DashStyle = msoLineSolid Then\n            Selection.Delete\n        End If\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 38, "user_id": 2531449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c944d68ab6b21b44f355855120139a67?s=128&d=identicon&r=PG", "display_name": "user2531449", "link": "https://stackoverflow.com/users/2531449/user2531449"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424204663, "creation_date": 1421239217, "last_edit_date": 1424201886, "question_id": 27943179, "link": "https://stackoverflow.com/questions/27943179/word-2007-vba-cant-delete-all-the-autoshape-line-at-once", "title": "word 2007 vba can&#39;t delete all the autoshape line at once", "body": "<p>i'm using the following code to select and delete all autoshape lines in the document.</p>\n\n<p>It works fine in MSWord 2003. (Also for the lines drawn using 2003 when opened in 2007)\nBut its not selecting the lines which are drawn in MS word 2007.</p>\n\n<pre><code>Sub line() \nDim shp As Shape, intBoxNbr As Integer\n\nintNbrShapes = 0\nFor Each shp In ActiveDocument.Shapes\nIf shp.Type = msoLine Then\nintNbrShapes = intNbrShapes + 1\nActiveWindow.ScrollIntoView Selection.Range, True\nshp.Select\nSelection.Delete\n'shp.Delete\n'(Selection.Delete is used in MSWord 2007 and shp.Delete used in MSWord 2003)\nEnd If\nNext shp\n\nEnd Sub\n</code></pre>\n\n<p>I found that the line drawn in MSword 2007 has the name as Autoshape##, where 2003 has line##.\nI have other auto shapes (text box etc) in the document so i cant use just \"If shp.Type = msoAutoShape Then\".\nplease help how to select and just delete line drawn using MS word 2007.</p>\n\n<p>thanks. </p>\n\n<p>I updated the code now... its not removing all the lines at once. i need to run the macro multiple times to remove all.</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\nDim shp As Shape, i As Integer\n\ni = 0\nFor Each shp In ActiveDocument.Shapes\nIf shp.Type = msoAutoShape Then\ni = i + 1\nActiveWindow.ScrollIntoView Selection.Range, True\nshp.Select\n\nIf Selection.ShapeRange.Line.DashStyle = msoLineSolid Then\nSelection.Delete\nEnd If\n\n'shp.Delete\n\nEnd If\nNext shp\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1421239947, "post_id": 27943107, "comment_id": 44282148, "body": "Another approach, possibly faster, would be to use the .AutoFilter selecting &quot;accepted&quot; for column E.  Then copy/paste the Visible cells (in columns A:D) in a single bloc."}], "answers": [{"tags": [], "owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "is_accepted": true, "score": 3, "last_activity_date": 1421239796, "creation_date": 1421239796, "answer_id": 27943366, "question_id": 27943107, "link": "https://stackoverflow.com/questions/27943107/copying-certain-cells-from-a-row-when-criterea-are-met-and-pasting-into-a-new/27943366#27943366", "title": "Copying certain cells from a row, when criterea are met, and pasting into a new sheet", "body": "<p>You are not updating the last row of the destination sheet.</p>\n\n<p>Put</p>\n\n<pre><code>LastRowDestSheet = LastRowDestSheet + 1\n</code></pre>\n\n<p>in the end of the if-clause (after 'Set DestRange = DestSheet.Range...')</p>\n"}, {"comments": [{"owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "edited": false, "score": 0, "creation_date": 1421240336, "post_id": 27943411, "comment_id": 44282383, "body": "That&#39;s fantastic and does exactly what I asked. but is there any way to only paste the data into the &quot;Accepted Change Requests&quot; if the data in column A of the copied data does not already exist in column A of the destination sheet (i.e. there isn&#39;t already a chnage request with that unique ID)."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "edited": false, "score": 0, "creation_date": 1421240473, "post_id": 27943411, "comment_id": 44282449, "body": "I&#39;m afraid you will have to clarify a bit more, <code>DestSheet</code> <i>is</i> the &quot;Accepted Change Requests&quot; sheet so the values are only copied there?"}, {"owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "edited": false, "score": 0, "creation_date": 1421240691, "post_id": 27943411, "comment_id": 44282570, "body": "Basically any new change requests will be added to &quot;All Change Requests&quot; sheet and will be assigned a unique ID in column A. I only want to copy those which are accepted, by setting the value of column E to &quot;Accepted&quot;, onto the &quot;Accepted Change Requests&quot; sheet. However, I do not want any change requests that already appear on the &quot;Accepted Change Requests&quot; to be duplicated. I hope this makes sense?"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1421240716, "post_id": 27943411, "comment_id": 44282581, "body": "You&#39;d have to add a unique ID for that purpose. Also copy that unique ID to the dest sheet and iterate over existing entries/autofilter them to check for the unique ID you are copying at the moment"}, {"owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "edited": false, "score": 0, "creation_date": 1421240786, "post_id": 27943411, "comment_id": 44282617, "body": "EngJohn - How would I do that?"}, {"owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "edited": false, "score": 0, "creation_date": 1421241865, "post_id": 27943411, "comment_id": 44283257, "body": "Thanks but that only copies across the first accepted change request"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421242023, "post_id": 27943411, "comment_id": 44283371, "body": "Did you remove the data from &#39;Accepted&#39; sheet first? This checks to see if the ID in Columns A already exists in column A of the &#39;Accepted&#39; sheet, if it does, skip the copy, if it doesn&#39;t, copy the data..."}, {"owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "edited": false, "score": 0, "creation_date": 1421242309, "post_id": 27943411, "comment_id": 44283569, "body": "I removed all data, apart from my headings, from the accepted sheet before running the macro. It still only copies the first accepted entry."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421242449, "post_id": 27943411, "comment_id": 44283639, "body": "I&#39;ve made a small further edit which implicitly tells the evaluation to look for an <i>exact</i> match, you can see if that has any difference. Other than that it&#39;s bit hard without actually seeing the data."}, {"owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "edited": false, "score": 0, "creation_date": 1421263979, "post_id": 27943411, "comment_id": 44296988, "body": "I&#39;m also trying to get the code to insert the date at which the change request is first carried over onto the destination sheet into column e of the destination sheet but when I do this it doesn&#39;t add it to the correct row. I just added the following code to the loop <code>code</code>With DestSheet.Range(&quot;E&quot; &amp; i)                                     .Value = Date                                     .NumberFormat = &quot;dd/mm/yyyy&quot; <code>code</code>"}, {"owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "edited": false, "score": 0, "creation_date": 1421264472, "post_id": 27943411, "comment_id": 44297259, "body": "Don&#39;t worry, stupid mistake. I solved it by changing the addittion to the loop to: <code>code</code>                                 With DestSheet.Range(&quot;E&quot; &amp; LastRowDestSheet + 1)                                     .Value = Date                                     .NumberFormat = &quot;dd/mm/yyyy&quot; <code>code</code>"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1421242393, "last_edit_date": 1421242393, "creation_date": 1421239925, "answer_id": 27943411, "question_id": 27943107, "link": "https://stackoverflow.com/questions/27943107/copying-certain-cells-from-a-row-when-criterea-are-met-and-pasting-into-a-new/27943411#27943411", "title": "Copying certain cells from a row, when criterea are met, and pasting into a new sheet", "body": "<p>Try replacing your loop with this:               </p>\n\n<pre><code>For i = 2 To LastRowSourceSheet\n   If SourceSheet.Range(\"E\" &amp; i).Value = \"Accepted\" Then _\n     DestSheet.Range(\"A\" &amp; LastRowDestSheet + 1 &amp; \":D\" &amp; LastRowDestSheet + 1).Value = _\n         SourceSheet.Range(\"A\" &amp; i &amp; \":D\" &amp; i).Value   \n   LastRowDestSheet = LastRowDestSheet + 1\nNext i\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong> <em>(Further OP request)</em></p>\n\n<pre><code>For i = 2 To LastRowSourceSheet\n   If SourceSheet.Range(\"E\" &amp; i).Value = \"Accepted\" Then\n     If Evaluate(\"ISERROR(MATCH(A\" &amp; i &amp; \",'Accepted Change Requests'!A:A,0))\") Then \n         DestSheet.Range(\"A\" &amp; LastRowDestSheet + 1 &amp; \":D\" &amp; LastRowDestSheet + 1).Value = _\n            SourceSheet.Range(\"A\" &amp; i &amp; \":D\" &amp; i).Value\n         LastRowDestSheet = LastRowDestSheet + 1\n     End If\n   End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 610, "user_id": 4453367, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Bab6s.jpg?s=128&g=1", "display_name": "newishuser", "link": "https://stackoverflow.com/users/4453367/newishuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 27943366, "answer_count": 2, "score": 0, "last_activity_date": 1421763855, "creation_date": 1421238953, "last_edit_date": 1421763855, "question_id": 27943107, "link": "https://stackoverflow.com/questions/27943107/copying-certain-cells-from-a-row-when-criterea-are-met-and-pasting-into-a-new", "title": "Copying certain cells from a row, when criterea are met, and pasting into a new sheet", "body": "<p>I'm trying to copy cells A:D from a row, when column E = \"Accepted\", and paste the data, as values, into a different sheet. </p>\n\n<p>Every time I try though, it only copies the last row and I can't understand why. I'd be really grateful for any help.</p>\n\n<p>My code looks like this: </p>\n\n<pre><code>Public Sub AcceptLastChangeRequest()\n\nWith Application\n        .ScreenUpdating = False\n        .EnableEvents = False\nEnd With\n\nOn Error GoTo errorHandler:\n\n    Dim varAnswer As String\n        varAnswer = MsgBox(\"Are you sure you wish to accept the most recent Change Request?\", vbYesNo, \"Accept Change Request\")\n            If varAnswer = vbNo Then\n                MsgBox (\"No changes saved\")\n                    With Application\n                        .ScreenUpdating = True\n                        .EnableEvents = True\n                    End With\n                Exit Sub\n            End If\n\n    Dim SourceRange As Range, DestRange As Range\n    Dim DestSheet As Worksheet, SourceSheet As Worksheet\n    Dim LastRowDestSheet As Long, i As Long, LastRowSourceSheet As Long\n        Set DestSheet = ThisWorkbook.Worksheets(\"Accepted Change Requests\")\n        Set SourceSheet = ThisWorkbook.Worksheets(\"All Change Requests\")\n\n            LastRowDestSheet = DestSheet.Cells(DestSheet.Rows.Count, \"A\").End(xlUp).Row\n            LastRowSourceSheet = SourceSheet.Cells(SourceSheet.Rows.Count, \"E\").End(xlUp).Row\n\n                For i = 2 To LastRowSourceSheet\n                    If Sheets(\"All Change Requests\").Range(\"E\" &amp; i).Value = \"Accepted\" Then\n                        Set SourceRange = SourceSheet.Range(\"A\" &amp; i, \"D\" &amp; i)\n                        Set DestRange = DestSheet.Range(\"A\" &amp; LastRowDestSheet + 1)\n                        SourceRange.Copy\n                        DestRange.PasteSpecial _\n                        Paste:=xlPasteValues, _\n                        operation:=xlPasteSpecialOperationNone, _\n                        skipblanks:=False, _\n                        Transpose:=False\n\n                        Application.CutCopyMode = False\n\n                    End If\n                Next i\n\n            With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n            End With\n\n    Exit Sub\n\nerrorHandler:\nMsgBox (\"There was an error adding this Change Request\")\nResume Next\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "olap", "excel-interop"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 1445062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c069c50f7bea908f915178f3ab20dafa?s=128&d=identicon&r=PG", "display_name": "yabol", "link": "https://stackoverflow.com/users/1445062/yabol"}, "edited": false, "score": 1, "creation_date": 1421402753, "post_id": 27962731, "comment_id": 44354290, "body": "Hello Fabian, thanks for your answer, problem is that I don&#39;t know what members are inside pivotField or rather cubefield because I&#39;m using olap data source. So for instance one time I will have years in filter and next time I will have some machines names.  So what I was trying to do was to grab some members randomly(e.g like on your screenshot numbers 38,42) and pass it to filter. But I can&#39;t find way to get this values."}], "tags": [], "owner": {"reputation": 437, "user_id": 1001339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3fbfa577965219727ed332370d011fd?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/1001339/fabian"}, "is_accepted": false, "score": 0, "last_activity_date": 1421322397, "creation_date": 1421322397, "answer_id": 27962731, "question_id": 27942994, "link": "https://stackoverflow.com/questions/27942994/c-and-excel-cubefield-item-list/27962731#27962731", "title": "C# and excel cubefield item list", "body": "<p>You can filter your fields like this:</p>\n\n<pre><code>yourPivotField.CurrentPageName = string.Format(\"[{0}].[{1}].&amp;[{2}]\", SheetName, FieldName, FieldValue);\n</code></pre>\n\n<p>This sets the filter of your pivot table</p>\n\n<p><img src=\"https://i.stack.imgur.com/kkRX6.png\" alt=\"set Excel Filter \"></p>\n\n<p>Not sure if it it this you were searching for.</p>\n"}], "owner": {"reputation": 51, "user_id": 1445062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c069c50f7bea908f915178f3ab20dafa?s=128&d=identicon&r=PG", "display_name": "yabol", "link": "https://stackoverflow.com/users/1445062/yabol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 720, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1421322397, "creation_date": 1421238584, "last_edit_date": 1421238668, "question_id": 27942994, "link": "https://stackoverflow.com/questions/27942994/c-and-excel-cubefield-item-list", "title": "C# and excel cubefield item list", "body": "<p>I'm trying to automate testing of excel add-in that allows you to create some analysis entities based on  pivot table definition. \nI'm able to create random pivot table using cubefield objects(I'm adding random fields to rows,columns, and measures) but I need also to add some filtering and here I'm stuck. \nIs there any way to get cubefield item list ? For example when I have date field in filter \nlist of all days and then I want to select some random days for filtering.</p>\n\n<p>This is my code maybe it's not elegant but it works for my purpose. \nI'm basically grabbing cubefields check if it's measure or dimension and then I'm setting \nit's orientation. </p>\n\n<pre><code>public  void PivotTableFieldList()\n{\n\n        _currentPivotTable = (Excel.PivotTable) _worksheet.PivotTables(\"PivotTable1\");\n        _currentPivotTable.ManualUpdate = true;\n\n        List&lt;Excel.CubeField&gt; measureList = new List&lt;Excel.CubeField&gt;();\n        List&lt;Excel.CubeField&gt; dimensionList = new List&lt;Excel.CubeField&gt;();\n\n        foreach (Excel.CubeField field in _currentPivotTable.CubeFields)\n        {\n            if (field.CubeFieldType == Excel.XlCubeFieldType.xlMeasure &amp;&amp; field.ShowInFieldList)\n            {\n               measureList.Add(field);\n            }\n        }\n\n        foreach (Excel.CubeField field in _currentPivotTable.CubeFields)\n        {\n            if (field.CubeFieldType != Excel.XlCubeFieldType.xlMeasure &amp;&amp; field.ShowInFieldList)\n            {\n                dimensionList.Add(field);\n           }\n        }\n\n        Random dimRan=new Random();\n        dimRan.Next(0, dimensionList.Count);\n        Random mesRan = new Random();\n        mesRan.Next(0, measureList.Count);\n        dimensionList.ToArray();\n        measureList.ToArray();\n\n        Excel.CubeField[] measureRandomList= new Excel.CubeField[3];\n        Excel.CubeField[] dimensionRandomList = new Excel.CubeField[6];\n\n        for (int i = 0; i &lt; 3; i++)\n        {\n            measureRandomList[i] = measureList[mesRan.Next(1, measureList.Count)];\n        }\n\n        for (int i = 0; i &lt; 6; i++)\n        {\n            dimensionRandomList[i] = dimensionList[dimRan.Next(i, dimensionList.Count)];\n         }\n\n        for (int i = 0; i &lt; 3; i++)\n        {\n            var field = measureRandomList[i];\n            var name = measureRandomList[i].Name;\n            field.Orientation= Excel.XlPivotFieldOrientation.xlDataField;\n        }\n\n        dimensionRandomList[0].Orientation= Excel.XlPivotFieldOrientation.xlRowField;\n        dimensionRandomList[1].Orientation = Excel.XlPivotFieldOrientation.xlColumnField;\n        dimensionRandomList[2].Orientation = Excel.XlPivotFieldOrientation.xlPageField;\n        dimensionRandomList[2].EnableMultiplePageItems=true;\n\n\n        //How can I get cubefield items list ? \n\n    }\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2058, "user_id": 1720085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/31607e975427d648b2342b74cb888417?s=128&d=identicon&r=PG", "display_name": "Daniel Bonetti", "link": "https://stackoverflow.com/users/1720085/daniel-bonetti"}, "edited": false, "score": 0, "creation_date": 1421238053, "post_id": 27942777, "comment_id": 44281101, "body": "Are you using Office 64 bits?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1421238337, "post_id": 27942777, "comment_id": 44281245, "body": "Save As <i>Excel Binary Workbook (.xlsb)</i>. It will cut the size down substantially (depends upon type of data for exact proportions) and will decrease load and save time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2058, "user_id": 1720085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/31607e975427d648b2342b74cb888417?s=128&d=identicon&r=PG", "display_name": "Daniel Bonetti", "link": "https://stackoverflow.com/users/1720085/daniel-bonetti"}, "edited": false, "score": 0, "creation_date": 1421238568, "post_id": 27942777, "comment_id": 44281373, "body": "re: @DanielBonetti comment - <a href=\"https://support.office.com/en-US/Article/Choose-the-32-bit-or-64-bit-version-of-Office-2dee7807-8f95-4d0c-b5fe-6c6f49b8d261\" rel=\"nofollow noreferrer\">Choose the 32-bit or 64-bit version of Office</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1421238779, "post_id": 27942777, "comment_id": 44281480, "body": "May I ask why you have 1300 sheets? Sounds like a nightmare to me."}, {"owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "edited": false, "score": 0, "creation_date": 1421239979, "post_id": 27942777, "comment_id": 44282161, "body": "I&#39;ll try to save as xlsb, But will My macros and vba work then? Each sheet is representing one article and all traffic(inputs and outputs) are registered on that sheet. So, how much articles, that much sheets."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1421241227, "post_id": 27942777, "comment_id": 44282860, "body": "I suspect it would make your life much easier to use one data sheet with an additional column indicating the relevant article. Or a database. ;)"}, {"owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "edited": false, "score": 0, "creation_date": 1421316098, "post_id": 27942777, "comment_id": 44315328, "body": "DataBase would be nice, but When I was makeing this program Year ago, I haven&#39;t had time and knowlage to do something like that. I would probably make it in MS Access."}, {"owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "edited": false, "score": 0, "creation_date": 1421316123, "post_id": 27942777, "comment_id": 44315343, "body": "I saved it as XLSB and got 55MB file from 90MB. All works fine, formulas, VBA-s, faster saving and openning file. Thank you all for your response, If we ever meet, I&#39;ll buy you a beer and a lap dance. One more thing: Can this xlsb work like shared workbook?"}], "answers": [{"tags": [], "owner": {"reputation": 1442, "user_id": 4115522, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KR2bz.jpg?s=128&g=1", "display_name": "Reenactor Rob", "link": "https://stackoverflow.com/users/4115522/reenactor-rob"}, "is_accepted": true, "score": 3, "last_activity_date": 1421238467, "creation_date": 1421238467, "answer_id": 27942960, "question_id": 27942777, "link": "https://stackoverflow.com/questions/27942777/saving-large-excel-files-issue/27942960#27942960", "title": "Saving large excel files issue", "body": "<p>Try using Save As-> Excel Binary Workbook.</p>\n\n<p><a href=\"http://spreadsheet1.com/how-to-save-as-binary-excel-workbook.html\" rel=\"nofollow\">Spreadsheet1.com-Binary excel workbook</a></p>\n"}], "owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3179, "favorite_count": 0, "accepted_answer_id": 27942960, "answer_count": 1, "score": 0, "last_activity_date": 1421241083, "creation_date": 1421237863, "last_edit_date": 1531161705, "question_id": 27942777, "link": "https://stackoverflow.com/questions/27942777/saving-large-excel-files-issue", "title": "Saving large excel files issue", "body": "<p>An excel file (about 90 MB) is a program with around 1300 Sheets with formulas and VBAs. As file is getting bigger, I have sometimes problem with saving it. It says: \"Document not saved!\" And I can't also save it to another location or name,  because Meni: \"File\" is not responding. I often lose many work that I did. I have 8GB of RAM memory. Is there something that can be done to increase stability or what else to solve my issue?</p>\n"}, {"tags": ["vb.net", "vba"], "comments": [{"owner": {"reputation": 25863, "user_id": 500974, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/goEft.png?s=128&g=1", "display_name": "Matt Wilko", "link": "https://stackoverflow.com/users/500974/matt-wilko"}, "edited": false, "score": 0, "creation_date": 1421239035, "post_id": 27942748, "comment_id": 44281598, "body": "This question appears to be off-topic because SO is not a code translation service"}, {"owner": {"reputation": 127, "user_id": 4453230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a972ef1f325323e42b303f97b2756a0a?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4453230/andi"}, "reply_to_user": {"reputation": 25863, "user_id": 500974, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/goEft.png?s=128&g=1", "display_name": "Matt Wilko", "link": "https://stackoverflow.com/users/500974/matt-wilko"}, "edited": false, "score": 0, "creation_date": 1421239293, "post_id": 27942748, "comment_id": 44281724, "body": "I am not lloking for a code-translation. But for a source on exact information about the Date data type."}, {"owner": {"reputation": 427, "user_id": 1003954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9bc521004ab81dce765ede3c0c0ac81?s=128&d=identicon&r=PG", "display_name": "GVashist", "link": "https://stackoverflow.com/users/1003954/gvashist"}, "edited": false, "score": 0, "creation_date": 1421256143, "post_id": 27942748, "comment_id": 44292470, "body": "You might want to add a <code>Java</code> tag to get help about Java. In the meantime, take a look at <a href=\"http://stackoverflow.com/questions/11555262/how-to-read-integers-and-date-in-binary-file\">this question</a>. This question deals with binary to multiple data type conversion."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1421262061, "post_id": 27942748, "comment_id": 44295956, "body": "The Date datatype in VBA is stored as a DOUBLE (i.e., Double-Precision floating point) scaled to days: so 1.5 is the same as 1 and 1/2 days or 36 hours."}], "answers": [{"tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1421362781, "last_edit_date": 1421362781, "creation_date": 1421277504, "answer_id": 27954270, "question_id": 27942748, "link": "https://stackoverflow.com/questions/27942748/how-to-read-date-from-vb-binary-file-in-another-language/27954270#27954270", "title": "How to read Date from VB binary-file in another language?", "body": "<p>As @RBarryYoung mentions in his comment to the question, VBA stores Date/Time values internally as floating-point <code>Double</code> values. The integer part is the number of days since 1899-12-30 and the fractional part is the time (e.g., 0.25 = 6 AM, 0.5 = Noon, 0.75 = 6 PM).</p>\n\n<p>In the example you gave, the Date/Time (Double) value is stored in bytes as <code>c5 b3 a2 11 80 7b e4 40</code>. Windows has always been a little-endian environment, so by reversing the order of the bytes we know that it corresponds to the 64-bit binary value <code>0x40e47b8011a2b3c5</code>. </p>\n\n<p>A Binary-to-IEEE_Double convertor like <a href=\"http://www.binaryconvert.com/result_double.html?hexadecimal=40E47B8011A2B3C5\" rel=\"nofollow\">this one</a> tells us that the decimal <code>Double</code> value is <code>4.19480021527777789742685854435E4</code>, and if we ask VBA what the corresponding Date/Time value is we get</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>?CDate(41948.0021527777789742685854435)\n2014-11-05 00:03:06\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4453230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a972ef1f325323e42b303f97b2756a0a?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4453230/andi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 1, "accepted_answer_id": 27954270, "answer_count": 1, "score": 1, "last_activity_date": 1421362781, "creation_date": 1421237760, "last_edit_date": 1421258406, "question_id": 27942748, "link": "https://stackoverflow.com/questions/27942748/how-to-read-date-from-vb-binary-file-in-another-language", "title": "How to read Date from VB binary-file in another language?", "body": "<p>I get a binary file from a VB-application which consists of about 1400 records of a Timestamp in Date format followed by 19 Long values.</p>\n\n<p>I am able to read the data in VBA with this function:</p>\n\n<pre><code>Dim myDate As Date\nDim myLong As Long\niFileNum = FreeFile\nOpen \"C:\\test.bin\" For Binary Access Read As #iFileNum\nDo While Not EOF(iFileNum)\n  Get iFileNum, , myDate\n  MsgBox(myDate)\n  For i = 1 To 19\n    Get iFileNum, , myLong\n  Next i\nLoop    \n</code></pre>\n\n<p>Now i want to read the Date-timestamps from the file (I am already able to read the Long-values) within java, but i cannot find any information on how to interpret the 8 bytes of the Date-type.</p>\n\n<p>As an example, the first timestamp in binary form is <code>c5 b3 a2 11 80 7b e4 40</code>.\nVB output for this is 2014-11-05 0:03:06 AM.</p>\n\n<p>To clarify, I am not looking for a java implementation, but for information of the binary representation of data type 'Date' from VB.\n(for which i wasn't able to find any more information as than this <a href=\"http://msdn.microsoft.com/en-us/library/3eaydw6e.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/3eaydw6e.aspx</a> , which doesn't help much)</p>\n"}, {"tags": ["string", "excel", "vba", "excel-formula", "vlookup"], "comments": [{"owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 0, "creation_date": 1421237475, "post_id": 27942610, "comment_id": 44280798, "body": "Is it always the third character you&#39;ll be changing?"}, {"owner": {"reputation": 65, "user_id": 2624220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5ddb94d98811914d4ca8b325e78006fb?s=128&d=identicon&r=PG", "display_name": "Shoaib", "link": "https://stackoverflow.com/users/2624220/shoaib"}, "reply_to_user": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 0, "creation_date": 1421238172, "post_id": 27942610, "comment_id": 44281158, "body": "It depends, but record length will remain same. Last zero has to be replaced by a special character."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 2624220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5ddb94d98811914d4ca8b325e78006fb?s=128&d=identicon&r=PG", "display_name": "Shoaib", "link": "https://stackoverflow.com/users/2624220/shoaib"}, "edited": false, "score": 0, "creation_date": 1421298542, "post_id": 27942826, "comment_id": 44308696, "body": "Thanks for you reply. This approach should work for me if instead of fixed data we can use generic column value name for finding an replacing data. I guess I should use replace function?"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 3, "last_activity_date": 1421240495, "last_edit_date": 1421240495, "creation_date": 1421238029, "answer_id": 27942826, "question_id": 27942610, "link": "https://stackoverflow.com/questions/27942610/vlookup-function-to-modify-column-data/27942826#27942826", "title": "VLOOKUP function to modify column data", "body": "<p>I think you are asking whether possible \"on the fly\" to which the answer would be yes. For example:  </p>\n\n<pre><code>=SUBSTITUTE(VLOOKUP(A1,A!A:B,2,0),\"000\",\"00$\")\n</code></pre>\n\n<hr>\n\n<p>If to replace last <code>0</code> with <code>$</code> the following adaptation may suit:  </p>\n\n<pre><code>=SUBSTITUTE(VLOOKUP(A1,A!A:B,2,0),0,\"$\",LEN(VLOOKUP(A1,A!A:B,2,0))-LEN(SUBSTITUTE(VLOOKUP(A1,A!A:B,2,0),0,\"\")))\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 2624220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5ddb94d98811914d4ca8b325e78006fb?s=128&d=identicon&r=PG", "display_name": "Shoaib", "link": "https://stackoverflow.com/users/2624220/shoaib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443496465, "creation_date": 1421237282, "last_edit_date": 1443496465, "question_id": 27942610, "link": "https://stackoverflow.com/questions/27942610/vlookup-function-to-modify-column-data", "title": "VLOOKUP function to modify column data", "body": "<p>I have some data, say selected IDs, in sheet A. Sheet B contains all the data and I use VLOOKUP to filter the rows in sheet B based on IDs in sheet A. I want to know if I can change the data in any column of that filtered rows. Say I have a data with ID 10:</p>\n\n<pre><code>10   0002345678\n</code></pre>\n\n<p>I want to change the corresponding data against this ID by adding a \"$\" instead of one zero so record length doesn't change:</p>\n\n<pre><code>10   00$2345678 \n</code></pre>\n\n<p>I have a lot of entries and want to automate this process.  </p>\n\n<p>Can we use the REPLACE function as a parameter in the VLOOKUP, or any other solution like using VBA?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1647, "user_id": 1670729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4b2565ee06b2c90975e364cbab37feef?s=128&d=identicon&r=PG", "display_name": "Mana", "link": "https://stackoverflow.com/users/1670729/mana"}, "edited": false, "score": 0, "creation_date": 1421235788, "post_id": 27942137, "comment_id": 44279886, "body": "The example is for excel, but the principles apply for all office vba enabled products"}, {"owner": {"reputation": 185, "user_id": 3773028, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/100000327049499/picture?type=large", "display_name": "caezar", "link": "https://stackoverflow.com/users/3773028/caezar"}, "edited": false, "score": 0, "creation_date": 1421245829, "post_id": 27942137, "comment_id": 44285725, "body": "But this exemple is for get the file from FTP. I need to send the file."}, {"owner": {"reputation": 1647, "user_id": 1670729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4b2565ee06b2c90975e364cbab37feef?s=128&d=identicon&r=PG", "display_name": "Mana", "link": "https://stackoverflow.com/users/1670729/mana"}, "reply_to_user": {"reputation": 185, "user_id": 3773028, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/100000327049499/picture?type=large", "display_name": "caezar", "link": "https://stackoverflow.com/users/3773028/caezar"}, "edited": false, "score": 1, "creation_date": 1421312177, "post_id": 27942137, "comment_id": 44313203, "body": "if you read the article, it&#39;s for both uploading and downloading. Instead of &#39;get&#39; you use &#39;put&#39;, and of course some other small changes."}], "tags": [], "owner": {"reputation": 1647, "user_id": 1670729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4b2565ee06b2c90975e364cbab37feef?s=128&d=identicon&r=PG", "display_name": "Mana", "link": "https://stackoverflow.com/users/1670729/mana"}, "is_accepted": true, "score": 2, "last_activity_date": 1421235744, "creation_date": 1421235744, "answer_id": 27942137, "question_id": 27941977, "link": "https://stackoverflow.com/questions/27941977/how-can-i-copy-a-folder-with-files-to-a-ftp-folder-using-vba/27942137#27942137", "title": "How can I copy a folder with files to a FTP folder using VBA?", "body": "<p>Here's a good guide on how to do this</p>\n\n<p><a href=\"http://officetricks.com/ftp-server-file-transfer-with-excel-macro/\" rel=\"nofollow\">http://officetricks.com/ftp-server-file-transfer-with-excel-macro/</a></p>\n"}], "owner": {"reputation": 185, "user_id": 3773028, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/100000327049499/picture?type=large", "display_name": "caezar", "link": "https://stackoverflow.com/users/3773028/caezar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 0, "closed_date": 1446776446, "accepted_answer_id": 27942137, "answer_count": 1, "score": -1, "last_activity_date": 1593475397, "creation_date": 1421235287, "last_edit_date": 1593475397, "question_id": 27941977, "link": "https://stackoverflow.com/questions/27941977/how-can-i-copy-a-folder-with-files-to-a-ftp-folder-using-vba", "closed_reason": "Needs more focus", "title": "How can I copy a folder with files to a FTP folder using VBA?", "body": "<p>How can I copy a folder with files to a FTP folder using VBA? It is the same as copying a file anywhere?</p>\n"}, {"tags": ["vba", "excel", "excel-2007", "data-import"], "comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1421233224, "post_id": 27941152, "comment_id": 44278486, "body": "If you overwrite those worksheets, what sense lies in keeping those references? Are you just appending content?"}, {"owner": {"reputation": 1697, "user_id": 2378266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b6f94560178b5956b0a0a96a118268d?s=128&d=identicon&r=PG&f=1", "display_name": "HotDogCannon", "link": "https://stackoverflow.com/users/2378266/hotdogcannon"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1421233375, "post_id": 27941152, "comment_id": 44278579, "body": "the data from the text file are &#39;updated&#39; values. This would be essentially &#39;refreshing&#39; the worksheet, using data from text files."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1421233659, "post_id": 27941152, "comment_id": 44278732, "body": "maybe you should try to just append new informations. That way you can keep the old worksheet, the references to it and still update it. I gotta admit I&#39;m not sure what your code does - never worked with querytables - but if you can just extract new informations, I&#39;m sure there&#39;s a way to easily append it."}, {"owner": {"reputation": 1697, "user_id": 2378266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b6f94560178b5956b0a0a96a118268d?s=128&d=identicon&r=PG&f=1", "display_name": "HotDogCannon", "link": "https://stackoverflow.com/users/2378266/hotdogcannon"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1421233912, "post_id": 27941152, "comment_id": 44278874, "body": "that&#39;s why i thought i&#39;d ask the clever folks of SA if they knew of a good solution ;)"}, {"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1421240897, "post_id": 27941152, "comment_id": 44282677, "body": "See similar question <a href=\"http://stackoverflow.com/questions/9791935/excel-interop-how-to-change-named-range\">Excel Interop - How to change named range</a>. Using named ranges for your references makes the data updating much easier"}], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 2378266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b6f94560178b5956b0a0a96a118268d?s=128&d=identicon&r=PG&f=1", "display_name": "HotDogCannon", "link": "https://stackoverflow.com/users/2378266/hotdogcannon"}, "edited": false, "score": 0, "creation_date": 1421242018, "post_id": 27941868, "comment_id": 44283363, "body": "I get &#39;Cannot rename a sheet to the same name as another sheet, a referenced object library or a workbook referenced by Visual Basic&#39; pointing to the line &#39;ws.Name = strFile2&#39;"}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 1697, "user_id": 2378266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b6f94560178b5956b0a0a96a118268d?s=128&d=identicon&r=PG&f=1", "display_name": "HotDogCannon", "link": "https://stackoverflow.com/users/2378266/hotdogcannon"}, "edited": false, "score": 0, "creation_date": 1421242570, "post_id": 27941868, "comment_id": 44283715, "body": "Sorry about that, try now."}, {"owner": {"reputation": 1697, "user_id": 2378266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b6f94560178b5956b0a0a96a118268d?s=128&d=identicon&r=PG&f=1", "display_name": "HotDogCannon", "link": "https://stackoverflow.com/users/2378266/hotdogcannon"}, "edited": false, "score": 0, "creation_date": 1421243186, "post_id": 27941868, "comment_id": 44284115, "body": "no worries. Now i get &#39;the destination range is not on the same worksheet the Query table is being created on&#39;...maybe i have to prescribe the current worksheet??"}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "reply_to_user": {"reputation": 1697, "user_id": 2378266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b6f94560178b5956b0a0a96a118268d?s=128&d=identicon&r=PG&f=1", "display_name": "HotDogCannon", "link": "https://stackoverflow.com/users/2378266/hotdogcannon"}, "edited": false, "score": 0, "creation_date": 1421256616, "post_id": 27941868, "comment_id": 44292802, "body": "I added the ws.Activate lines and edited the With reference. All the other examples of querytables referenced them this way so it may be required in this case. This is a little bit of trial and error but I cant set up a test sheet for a querytable to check for sure."}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": true, "score": 1, "last_activity_date": 1421256490, "last_edit_date": 1421256490, "creation_date": 1421234959, "answer_id": 27941868, "question_id": 27941152, "link": "https://stackoverflow.com/questions/27941152/excel-macro-to-import-text-file-and-overwrite-worksheet-without-breaking-referen/27941868#27941868", "title": "Excel macro to import text file and overwrite worksheet without breaking references", "body": "<p>Assuming you don't have any other information stored on those sheets besides the querytable, try this (I cut out your with statement for space):</p>\n\n<pre><code>Sub ImportManyTXTs()\nDim strFile As String\nDim Sht As Worksheet\nDim ws As Worksheet\nstrFile = Dir(\"C:\\location\\of\\folder\\with\\textfiles\\*.txt\")\nDo While strFile &lt;&gt; vbNullString\n\nstrFile2 = Replace(strFile, \".txt\", \"\")\n\nFor Each Sht in Worksheets\n    If Sht.Name = strFile2 Then\n        Sht.Cells.ClearContents\n        Set ws = Sht\n    End If\nNext Sht\nIf ws Is Nothing Then\n    Set ws = Sheets.Add\n    ws.Name = strFile2\nEnd If\nws.Activate\n\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    'YourStuffHere\nEnd With\n\nstrFile = Dir\nLoop\nEnd Sub\n</code></pre>\n\n<p>In this case the contents of the sheet will just be replaced if it already exists, the references to the cells shouldn't change.</p>\n"}], "owner": {"reputation": 1697, "user_id": 2378266, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b6f94560178b5956b0a0a96a118268d?s=128&d=identicon&r=PG&f=1", "display_name": "HotDogCannon", "link": "https://stackoverflow.com/users/2378266/hotdogcannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2666, "favorite_count": 0, "accepted_answer_id": 27941868, "answer_count": 1, "score": 0, "last_activity_date": 1421256490, "creation_date": 1421232649, "question_id": 27941152, "link": "https://stackoverflow.com/questions/27941152/excel-macro-to-import-text-file-and-overwrite-worksheet-without-breaking-referen", "title": "Excel macro to import text file and overwrite worksheet without breaking references", "body": "<p>I have the following macro that I routinely use to import text files into separate excel worksheets:</p>\n\n<pre><code>Sub ImportManyTXTs()\nDim strFile As String\nDim ws As Worksheet\nstrFile = Dir(\"C:\\location\\of\\folder\\with\\textfiles\\*.txt\")\nDo While strFile &lt;&gt; vbNullString\n\nstrFile2 = Replace(strFile, \".txt\", \"\")\n\nSet ws = Sheets.Add\nWith ws.QueryTables.Add(Connection:= _\n    \"TEXT;\" &amp; \"C:\\location\\of\\folder\\with\\textfiles\\\" &amp; strFile, Destination:=Range(\"$A$1\"))\n    .Name = strFile\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xldelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = True\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = True\n    .TextFileColumnDataTypes = Array(1, 1, 1)\n    .TextFileFixedColumnWidths = Array(7, 9)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\nws.Name = strFile2\nstrFile = Dir\nLoop\nEnd Sub\n</code></pre>\n\n<p>...but I would like to overwrite an existing worksheet if the same name is already used. In other worksheets I have references to cells in the worksheets that would be 'overwritten' so I need a way to do this without breaking the references to those cells. Anyone know of a good solution for this?</p>\n"}, {"tags": ["excel", "ms-access", "vba", "gmail"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 7, "last_activity_date": 1421238345, "last_edit_date": 1592644375, "creation_date": 1421238345, "answer_id": 27942924, "question_id": 27941012, "link": "https://stackoverflow.com/questions/27941012/reading-gmail-email-messages-via-vba-without-outlook/27942924#27942924", "title": "Reading GMail email messages via VBA without Outlook", "body": "<p>You can use the google api to archive this without outlook.\nThere is <a href=\"https://github.com/VBA-tools/VBA-Web\" rel=\"noreferrer\">VBA-Web</a> on github that supports the gmail api.</p>\n<h3>Here is an example for gmail with vba-web:</h3>\n<pre><code>Attribute VB_Name = &quot;Gmail&quot;\n' Setup client and authenticator (cached between requests)\nPrivate pGmailClient As WebClient\nPrivate Property Get GmailClient() As WebClient\n    If pGmailClient Is Nothing Then\n        ' Create client with base url that is appended to all requests\n        Set pGmailClient = New WebClient\n        pGmailClient.BaseUrl = &quot;https://www.googleapis.com/gmail/v1/&quot;\n        \n        ' Use the pre-made GoogleAuthenticator found in authenticators/ folder\n        ' - Automatically uses Google's OAuth approach including login screen\n        ' - Get API client id and secret from https://console.developers.google.com/\n        ' - https://github.com/timhall/Excel-REST/wiki/Google-APIs for more info\n        Dim Auth As New GoogleAuthenticator\n        Auth.Setup CStr(Credentials.Values(&quot;Google&quot;)(&quot;id&quot;)), CStr(Credentials.Values(&quot;Google&quot;)(&quot;secret&quot;))\n        Auth.AddScope &quot;https://www.googleapis.com/auth/gmail.readonly&quot;\n        Auth.Login\n        Set pGmailClient.Authenticator = Auth\n    End If\n    \n    Set GmailClient = pGmailClient\nEnd Property\n\n' Load messages for inbox\nFunction LoadInbox() As Collection\n    Set LoadInbox = New Collection\n    \n    ' Create inbox request with userId and querystring for inbox label\n    Dim Request As New WebRequest\n    Request.Resource = &quot;users/{userId}/messages&quot;\n    Request.AddUrlSegment &quot;userId&quot;, &quot;me&quot;\n    Request.AddQuerystringParam &quot;q&quot;, &quot;label:inbox&quot;\n    \n    Dim Response As WebResponse\n    Set Response = GmailClient.Execute(Request)\n    \n    If Response.StatusCode = WebStatusCode.Ok Then\n        Dim MessageInfo As Dictionary\n        Dim Message As Dictionary\n        \n        For Each MessageInfo In Response.Data(&quot;messages&quot;)\n            ' Load full messages for each id\n            Set Message = LoadMessage(MessageInfo(&quot;id&quot;))\n            If Not Message Is Nothing Then\n                LoadInbox.Add Message\n            End If\n        Next MessageInfo\n    End If\nEnd Function\n\n' Load message details\nFunction LoadMessage(MessageId As String) As Dictionary\n    Dim Request As New WebRequest\n    Request.Resource = &quot;users/{userId}/messages/{messageId}&quot;\n    Request.AddUrlSegment &quot;userId&quot;, &quot;me&quot;\n    Request.AddUrlSegment &quot;messageId&quot;, MessageId\n    \n    Dim Response As WebResponse\n    Set Response = GmailClient.Execute(Request)\n    \n    If Response.StatusCode = WebStatusCode.Ok Then\n        Set LoadMessage = New Dictionary\n    \n        ' Pull out relevant parts of message (from, to, and subject from headers)\n        LoadMessage.Add &quot;snippet&quot;, Response.Data(&quot;snippet&quot;)\n        \n        Dim Header As Dictionary\n        For Each Header In Response.Data(&quot;payload&quot;)(&quot;headers&quot;)\n            Select Case Header(&quot;name&quot;)\n            Case &quot;From&quot;\n                LoadMessage.Add &quot;from&quot;, Header(&quot;value&quot;)\n            Case &quot;To&quot;\n                LoadMessage.Add &quot;to&quot;, Header(&quot;value&quot;)\n            Case &quot;Subject&quot;\n                LoadMessage.Add &quot;subject&quot;, Header(&quot;value&quot;)\n            End Select\n        Next Header\n    End If\nEnd Function\n\nSub Test()\n    Dim Message As Dictionary\n    For Each Message In LoadInbox\n        Debug.Print &quot;From: &quot; &amp; Message(&quot;from&quot;) &amp; &quot;, Subject: &quot; &amp; Message(&quot;subject&quot;)\n        Debug.Print Message(&quot;snippet&quot;) &amp; vbNewLine\n    Next Message\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5995530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffae5affe2824971e2626567d369628e?s=128&d=identicon&r=PG&f=1", "display_name": "user5995530", "link": "https://stackoverflow.com/users/5995530/user5995530"}, "is_accepted": false, "score": 1, "last_activity_date": 1507450417, "last_edit_date": 1507450417, "creation_date": 1507419912, "answer_id": 46626182, "question_id": 27941012, "link": "https://stackoverflow.com/questions/27941012/reading-gmail-email-messages-via-vba-without-outlook/46626182#46626182", "title": "Reading GMail email messages via VBA without Outlook", "body": "<p>You can pull GMAIL email data into Excel by adding a custom reference library EAGetMail.</p>\n\n<p>You can find the install link and a demo macro <a href=\"http://www.vba-market.com/vba-import-gmail-emails-into-excel/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 512, "user_id": 1608044, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/cdb93aaa525d615611aac6fb15b759b6?s=128&d=identicon&r=PG", "display_name": "pio pio", "link": "https://stackoverflow.com/users/1608044/pio-pio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9333, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1594638972, "creation_date": 1421232170, "last_edit_date": 1594638972, "question_id": 27941012, "link": "https://stackoverflow.com/questions/27941012/reading-gmail-email-messages-via-vba-without-outlook", "title": "Reading GMail email messages via VBA without Outlook", "body": "<p>How can I read GMail emails via VBA without having Outlook installed on the PC ?</p>\n\n<p>I googled it but I didn't find any solution which does not relies on Outlook.</p>\n"}, {"tags": ["ms-access", "dll", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4280753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783fab77a25c1d5136748514da9445fc?s=128&d=identicon&r=PG&f=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/4280753/colin"}, "edited": false, "score": 0, "creation_date": 1421236104, "post_id": 27941668, "comment_id": 44280066, "body": "I am returning a C string (char *, i.e., pointer to char), not char."}], "tags": [], "owner": {"reputation": 403, "user_id": 4447046, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4447046/serenity"}, "is_accepted": false, "score": 0, "last_activity_date": 1421234325, "creation_date": 1421234325, "answer_id": 27941668, "question_id": 27940971, "link": "https://stackoverflow.com/questions/27940971/call-c-function-in-dll-that-returns-char-from-ms-access-vba/27941668#27941668", "title": "Call C function in DLL that returns char * from MS-Access VBA", "body": "<p>A <code>char</code> is the same as an <code>integer</code>. In VBA that means a <code>long</code> (as VBA uses 16 bit terminology). There are no strings involved. To convert an integer or char to a string use <code>chr(x)</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 4280753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783fab77a25c1d5136748514da9445fc?s=128&d=identicon&r=PG&f=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/4280753/colin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594652514, "creation_date": 1421232013, "last_edit_date": 1594652514, "question_id": 27940971, "link": "https://stackoverflow.com/questions/27940971/call-c-function-in-dll-that-returns-char-from-ms-access-vba", "title": "Call C function in DLL that returns char * from MS-Access VBA", "body": "<p>I have a DLL with a function declared like this:</p>\n\n<pre><code>char * __declspec(dllexport) WINAPI test(int x);\n</code></pre>\n\n<p>I want to call it in Access VBA like this:</p>\n\n<pre><code>Private Declare Function \"test\" Lib \"MyDLL.dll\"(ByVal x As Long) As String\n\nSub MySub\n    Dim s As String\n    s = test(1)\nEnd Sub\n</code></pre>\n\n<p>Based on articles found in Google, I wrote a function in the DLL:</p>\n\n<pre><code>BSTR CStrToVBStr(char *str)\n{\n    int wslen = MultiByteToWideChar(CP_ACP, 0, str, lstrlen(str), 0, 0);\n    BSTR bstr = SysAllocStringLen(0, wslen);\n    MultiByteToWideChar(CP_ACP, 0, str, strlen(str), bstr, wslen);\n    return bstr;\n}\n</code></pre>\n\n<p>After the call to test(), s apparently contains  Unicode characters. That is, a char * \"test\" is returned to VBA so that Mid(s, 1, 1) = \"t\", Mid(s, 2, 1) = Chr(0), Mid(s, 3, 1) = \"e\", etc. I decide to skip the conversion to Unicode and wrote CstrToVBStr as</p>\n\n<pre><code>BSTR CStrToVBStr(char *str)\n{\n    return SysAllocString(str);\n}\n</code></pre>\n\n<p>and ignored the warning that SysAllocString takes an OLECHAR * and not a char * parameter.\nThe returned string looks good now, but the null character terminator is included, so if the char * is \"test\", then in VBA len(s) = 5 and Right(s,1) = Chr(0).</p>\n\n<p>What is the right way to do what I am doing? All examples that I have seen are about char * as parameters, not return values. I can change test() to be</p>\n\n<pre><code>void __declspec(dllexport) WINAPI test(int x, char *result);\n</code></pre>\n\n<p>but I would like to know if what I am trying to do is possible.</p>\n\n<p>I am using Access 2007 on Windows 7 (64-bit).</p>\n"}, {"tags": ["excel", "spreadsheet", "vba"], "comments": [{"owner": {"reputation": 9808, "user_id": 671013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d735ca95ae6d53fa8fd9fa79814e514?s=128&d=identicon&r=PG", "display_name": "Dror", "link": "https://stackoverflow.com/users/671013/dror"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1421232629, "post_id": 27940531, "comment_id": 44278121, "body": "@pnuts: No. Can it be used &quot;interactively&quot;?"}, {"owner": {"reputation": 16381, "user_id": 1176601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YCkL9.jpg?s=128&g=1", "display_name": "Aprillion", "link": "https://stackoverflow.com/users/1176601/aprillion"}, "edited": false, "score": 1, "creation_date": 1421242673, "post_id": 27940531, "comment_id": 44283780, "body": "not sure what you mean by <a href=\"http://en.wikipedia.org/wiki/Canonical\" rel=\"nofollow noreferrer\">canonical</a> - there is usually no standard way to solve non-standard problems and there is even less standardization about how to solve problems in Excel"}], "answers": [{"tags": [], "owner": {"reputation": 16381, "user_id": 1176601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YCkL9.jpg?s=128&g=1", "display_name": "Aprillion", "link": "https://stackoverflow.com/users/1176601/aprillion"}, "is_accepted": false, "score": 1, "last_activity_date": 1421244075, "creation_date": 1421244075, "answer_id": 27944735, "question_id": 27940531, "link": "https://stackoverflow.com/questions/27940531/mutually-dependent-variables-in-a-spreadsheet/27944735#27944735", "title": "Mutually dependent variables in a spreadsheet", "body": "<p>You can separate input fields from the calculated values and add some validation that only one of the mutually exclusive field is used, e.g.:</p>\n\n<p><img src=\"https://i.stack.imgur.com/2KLGR.png\" alt=\"enter image description here\"></p>\n\n<p>in my example, I used following conditional formatting to highlight invalid input:</p>\n\n<pre><code>=AND($B$4&lt;&gt;\"\", $B$5&lt;&gt;\"\")\n</code></pre>\n\n<p>and I used following the formulas for calculated values:</p>\n\n<pre><code>=B2\n=B3\n=IF(AND($B$4&lt;&gt;\"\", $B$5&lt;&gt;\"\"), \"#ERROR: only 1 value can be specified\",\n    IF($B$4&lt;&gt;\"\", $B$4, $B$5-1))\n=IF(AND($B$4&lt;&gt;\"\", $B$5&lt;&gt;\"\"), \"#ERROR: only 1 value can be specified\",\n    IF($B$5&lt;&gt;\"\", $B$5, $B$4+1))\n</code></pre>\n\n<p>more generally:</p>\n\n<pre><code>=if(error_condition, error_message, if(b_is_not_empty, b, g(x,a,c)))\n</code></pre>\n"}], "owner": {"reputation": 9808, "user_id": 671013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d735ca95ae6d53fa8fd9fa79814e514?s=128&d=identicon&r=PG", "display_name": "Dror", "link": "https://stackoverflow.com/users/671013/dror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421244075, "creation_date": 1421230641, "last_edit_date": 1531161705, "question_id": 27940531, "link": "https://stackoverflow.com/questions/27940531/mutually-dependent-variables-in-a-spreadsheet", "title": "Mutually dependent variables in a spreadsheet", "body": "<p>Assume I have an input variable <code>x</code> and three parameters <code>a,b,c</code> such that:</p>\n\n<ul>\n<li>Given <code>b</code> we have <code>c = f(x,a,b)</code> for some (known) function <code>f</code></li>\n<li>Given <code>c</code> we have <code>b = g(x,a,c)</code> for some (known, different) function <code>g</code>.</li>\n</ul>\n\n<p>I want to model this in a spreadsheet (Excel for instance). More precisely, if the user provides <code>x,a</code> and <code>b</code> then <code>c</code> will be evaluated and if <code>c</code> is given then <code>b</code> will be evaluated. It seems like this cannot be achieved directly, since a cell can hold <em>either</em> a value <em>or</em> a formula.</p>\n\n<p>Is there a <strong>canonical</strong> way to do this? If not, what would be a best-practice workaround (probably some VBA magic)?</p>\n"}, {"tags": ["vba", "email", "excel"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 3023621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22f33439bd8e858cd80d1cf2f80772c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3023621", "link": "https://stackoverflow.com/users/3023621/user3023621"}, "edited": false, "score": 0, "creation_date": 1421232171, "post_id": 27940260, "comment_id": 44277874, "body": "Cool, thanks for the answer - I&#39;ll give it a try and get back to you!"}], "tags": [], "owner": {"reputation": 403, "user_id": 4447046, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4447046/serenity"}, "is_accepted": true, "score": 2, "last_activity_date": 1421229858, "creation_date": 1421229858, "answer_id": 27940260, "question_id": 27940097, "link": "https://stackoverflow.com/questions/27940097/sending-emails-from-vba-formatting-array-data-into-columns/27940260#27940260", "title": "Sending emails from VBA: formatting array data into columns", "body": "<p>You need to know html and add tags. So a basic table,</p>\n\n<pre><code>&lt;table&gt;\n&lt;thead&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;&lt;td&gt;cell1&lt;/td&gt;&lt;td&gt;cell2&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td&gt;cell1&lt;/td&gt;&lt;td&gt;cell2&lt;/td&gt;&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>There's lots of formatting you can apply in a few ways. I use CSS normally.</p>\n\n<p>Here's some random example from my harddrive.</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;style&gt;\nTABLE       {font-size: 90%; text-align:left; margin-left:40pt;margin-right:10pt;background-color:lavender;width=\"90%\"}\nTHEAD       {color: white;font-weight:bold;background-color:darkblue; margin-left:40pt;margin-right:10pt}\nTD      {Vertical-Align:Top;cell-padding:3}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;table&gt;\n    &lt;thead&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n    &lt;tr&gt;&lt;td&gt;cell1&lt;/td&gt;&lt;td&gt;cell2&lt;/td&gt;&lt;/tr&gt;\n    &lt;tr&gt;&lt;td&gt;cell1&lt;/td&gt;&lt;td&gt;cell2&lt;/td&gt;&lt;/tr&gt;\n    &lt;/tbody&gt;\n    &lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 3023621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22f33439bd8e858cd80d1cf2f80772c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3023621", "link": "https://stackoverflow.com/users/3023621/user3023621"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 27940260, "answer_count": 1, "score": 0, "last_activity_date": 1421229858, "creation_date": 1421229357, "question_id": 27940097, "link": "https://stackoverflow.com/questions/27940097/sending-emails-from-vba-formatting-array-data-into-columns", "title": "Sending emails from VBA: formatting array data into columns", "body": "<p>I'm doing some coding in VBA and am pretty new to it all. I would like to send an email using the information stored in a 2D array. Currently, I just send:</p>\n\n<pre><code>Mr ABCD: 123456\nMr EFGHIJ: 789101112\netc...\n</code></pre>\n\n<p>where Array(0,0) = Mr ABCD, Array(0,1) = 123456, and it's quite ugly given the poor formatting. I would like to make it look slightly more readable, firstly by ensuring that all numeric values are at the same offset, i.e:</p>\n\n<pre><code>Mr ABCD:   123456\nMr EFGHIJ: 789101112\netc...\n</code></pre>\n\n<p>I have tried simply buffering each name string with a suitable amount of spaces, however the default font does not have equivalently sized characters, so each string may be the same length but not the same size. </p>\n\n<p>So, is there any way to set the string object to have a default font of Courier for example, to ensure all characters are the same size? Preferably this would be done without copying the array into a spreadsheet.</p>\n\n<p>Another question is how would I best craft this into an email that has the same grid format as a spreadsheet, where each grid is of uniform size? Once again, preferably without copying into a spreadsheet. Thank you!</p>\n"}, {"tags": ["vba", "variables", "vb6"], "answers": [{"comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1421229405, "post_id": 27939931, "comment_id": 44276370, "body": "This article is very interesting! Thank you"}, {"owner": {"reputation": 14759, "user_id": 123723, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0af39d29746ae4e1aac45fd517269f58?s=128&d=identicon&r=PG", "display_name": "C-Pound Guru", "link": "https://stackoverflow.com/users/123723/c-pound-guru"}, "edited": false, "score": 6, "creation_date": 1421263172, "post_id": 27939931, "comment_id": 44296543, "body": "I hesitate to +1 this accepted answer without at least a small summary of the info in the link (on the off chance the link becomes no longer available)."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1421228843, "last_edit_date": 1525816189, "creation_date": 1421228843, "answer_id": 27939931, "question_id": 27939826, "link": "https://stackoverflow.com/questions/27939826/is-using-variants-in-vba-bad-for-performance/27939931#27939931", "title": "Is using variants in vba bad for performance?", "body": "<p><em>Is using variants in vba bad for performance?</em> - <strong>Yes!</strong></p>\n\n<p><code>Variant</code> should be avoided wherever possible.  (There are of cource some legitimate uses)</p>\n\n<p><a href=\"http://www.cpearson.com/excel/DeclaringVariables.aspx\" rel=\"nofollow noreferrer\">One example of a reputable resource supporting this view</a></p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 4447046, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4447046/serenity"}, "is_accepted": true, "score": 13, "last_activity_date": 1421231018, "creation_date": 1421231018, "answer_id": 27940670, "question_id": 27939826, "link": "https://stackoverflow.com/questions/27939826/is-using-variants-in-vba-bad-for-performance/27940670#27940670", "title": "Is using variants in vba bad for performance?", "body": "<p>It depends. Variants are slower then native types, but in most programs, it doesn't matter at all. Most macros are small and get compiled when run and the diference may be a few microseconds, that you can't perceive.</p>\n\n<p>Variants have their advantages, I love them.</p>\n\n<p>So it depends on what you are doing. If your program runs in a blink of an eye, there is no advantage in avoiding variants. If it takes time strongly type your variables (and declare objects correctly - see below).</p>\n\n<p>If performance is an issue there are other things apart from this that I'll mention below.</p>\n\n<p><strong>General Issues</strong></p>\n\n<p>When setting properties or calling methods, each is a function call in the CPU. That means stack setup overhead. Function calls are slower than inline code. Use loops rather than functions in VBA forthe same reason.</p>\n\n<p>F or a start don't specify all those properties over and over again. Unless you change them they don't change. </p>\n\n<pre><code>With Selection.Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchByte = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = False\n    .MatchFuzzy = False\n\n    For loop to go through each word pair\n        .Text = SrcText\n        .Replacement.Text = DestText\n        .Find.Execute Replace:=wdReplaceAll\n    Next\n\nEnd With\n</code></pre>\n\n<p><strong>Minimise Dots</strong></p>\n\n<p>So if you are interested in performance minimise dots (each dot is a lookup), especially in loops.</p>\n\n<p>There are two ways. One is to set objects to the lowest object if you are going to access more than once.</p>\n\n<p>eg (slower)</p>\n\n<pre><code>set xlapp = CreateObject(\"Excel.Application\")\nmsgbox xlapp.worksheets(0).name \n</code></pre>\n\n<p>(faster because you omitt a dot every time you use the object)</p>\n\n<pre><code>set xlapp = CreateObject(\"Excel.Application\")\nset wsheet = xlapp.worksheets(0)\nmsgbox wsheet.name\n</code></pre>\n\n<p>The second way is with. You can only have one with active at a time.</p>\n\n<p>This skips 100 lookups.</p>\n\n<pre><code>with wsheet\nFor x = 1 to 100\n msgbox .name\nNext\nend with\n</code></pre>\n\n<p><strong>String Concatination</strong></p>\n\n<p>And don't join strings one character at a time. See this from a VBScript programmer. It requires 50,000 bytes and many allocation and deallocation to make a 100 character string.</p>\n\n<p><a href=\"http://blogs.msdn.com/b/ericlippert/archive/2003/10/20/53248.aspx\">http://blogs.msdn.com/b/ericlippert/archive/2003/10/20/53248.aspx</a></p>\n\n<p><strong>Reading Properties</strong></p>\n\n<p>Don't reread properties that don't change especially if out of process or late bound. Put them into a variable. </p>\n\n<p><strong>Object Types</strong></p>\n\n<p>Two concepts here - in or out of process and early or late binding.</p>\n\n<p>exefiles are connected to out of process. All calls are marshalled over RPC (a networking protocol). Dllfiles are in process and function calls are made direct with a jump.</p>\n\n<p>Early binding is <code>set x = objecttype</code>. Functions are looked up when you write the program. On execution the program is hard coded to jump to address stored in the vtable for that function.</p>\n\n<p>Late binding is set <code>x = createobject(\"objecttype\")</code>. Each function call goes like this. \"Hi object do you have a print command\". \"Yes\", it replies, \"command number 3\". \"Hi object can you please do command number 3\". \"Sure, here's the result\".</p>\n\n<p>From Visual Basic Concepts (part of Help)</p>\n\n<p>You can make your Visual Basic applications run faster by optimizing the way Visual Basic resolves object references. The speed with which Visual Basic handles object references can be affected by: </p>\n\n<p>Whether or not the ActiveX component has been implemented as an in-process server or an out-of-process server.</p>\n\n<p>Whether an object reference is early-bound or late-bound. In general, if a component has been implemented as part of an executable file (.exe file), it is an out-of-process server and runs in its own process. If it has been implemented as a dynamic-link library, it is an in-process server and runs in the same process as the client application.</p>\n\n<p>Applications that use in-process servers usually run faster than those that use out-of-process servers because the application doesn't have to cross process boundaries to use an object's properties, methods, and events. For more information about in-process and out-of-process servers, see \"In-Process and Out-of-Process Servers.\"</p>\n\n<p>Object references are early-bound if they use object variables declared as variables of a specific class. Object references are late-bound if they use object variables declared as variables of the generic Object class. Object references that use early-bound variables usually run faster than those that use late-bound variables.</p>\n\n<p><strong>Excel Specific</strong></p>\n\n<p>See this link from a Microsoft person. This is excel specific rather than VBA. Autocalc and other calc options/screenupdating etc.</p>\n\n<p><a href=\"http://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/\">http://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/</a></p>\n\n<h2>.</h2>\n"}], "owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2904, "favorite_count": 3, "accepted_answer_id": 27940670, "answer_count": 2, "score": 2, "last_activity_date": 1421231018, "creation_date": 1421228480, "question_id": 27939826, "link": "https://stackoverflow.com/questions/27939826/is-using-variants-in-vba-bad-for-performance", "title": "Is using variants in vba bad for performance?", "body": "<p>I guess the title is pretty straightforward, what impact does declaring variables as variants, instead of a specific datatype, has on performance in VBA? </p>\n\n<p>Maybe it's because I am not that experienced with programming, but intuitively it should decrease performance due to the computer having to check which datatype is assigned, and then changing the variant to the assigned datatype, instead of immediately assigning the value to it. I have not been able to find some literature on this.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "autofill"], "answers": [{"tags": [], "owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1421229609, "creation_date": 1421229609, "answer_id": 27940175, "question_id": 27939582, "link": "https://stackoverflow.com/questions/27939582/autofill-formula-but-stop-short/27940175#27940175", "title": "Autofill formula, but stop short", "body": "<p>I'm not sure what you're doing with the rest of the data but this should work:</p>\n\n<pre><code>Sub aaa()\nDim iInputRows As Integer\nDim iCount\niInputRows = CInt(InputBox(\"How many data entry rows required?\"))\n\nIf iInputRows &gt; 1 Then\nFor iCount = 1 To iInputRows - 1\n    Rows(iCount + 13 &amp; \":\" &amp; iCount + 13).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"D\" &amp; iCount + 13).Value = iCount + 1\n\nNext iCount\nRange(\"X13:AR13\").AutoFill Destination:=Range(\"AX13:AR\" &amp; iInputRows + 13)\nEnd If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 3740620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dde3f3e85c952780d1a0dea14508767?s=128&d=identicon&r=PG&f=1", "display_name": "user3740620", "link": "https://stackoverflow.com/users/3740620/user3740620"}, "edited": false, "score": 0, "creation_date": 1421314271, "post_id": 27940201, "comment_id": 44314247, "body": "Thanks Jeeped.  The code autofills but I am getting one row more than that stipulated by the user, i.e. 10 rows input = 11 rows inserted.  I have had to change the arguments &quot;(iInputRows + 1,x)&quot; to just &quot;(iInputRows, x)&quot; which sorts it out."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1421229683, "creation_date": 1421229683, "answer_id": 27940201, "question_id": 27939582, "link": "https://stackoverflow.com/questions/27939582/autofill-formula-but-stop-short/27940201#27940201", "title": "Autofill formula, but stop short", "body": "<p>You should be able to insert all of the rows at once then use a data series in column D and fill down the formulas in columns X:AR.</p>\n\n<pre><code>Dim iInputRows As Long\n\niInputRows = CInt(InputBox(\"How many data entry rows required?\"))\n\nIf iInputRows &gt; 1 Then\n    Rows(14).Resize(iInputRows, Columns.Count).EntireRow.Insert _\n      Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"D13\").Resize(iInputRows + 1, 1).DataSeries Rowcol:=xlColumns, _\n      Type:=xlLinear, Step:=1\n    Range(\"X13:AR13\").Resize(iInputRows + 1, 21).FillDown\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 3740620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dde3f3e85c952780d1a0dea14508767?s=128&d=identicon&r=PG&f=1", "display_name": "user3740620", "link": "https://stackoverflow.com/users/3740620/user3740620"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 27940201, "answer_count": 2, "score": 1, "last_activity_date": 1421765730, "creation_date": 1421227762, "last_edit_date": 1421765730, "question_id": 27939582, "link": "https://stackoverflow.com/questions/27939582/autofill-formula-but-stop-short", "title": "Autofill formula, but stop short", "body": "<p>I have a macro that inserts a number of rows into a spreadsheet, the number of rows stipulated by user input into a dialog box.  What I am trying to achieve is for formula to be autofilled down the respective columns according to the number of rows were inserted by the user.</p>\n\n<p>The current code I have is:</p>\n\n<pre><code>Dim iInputRows As Integer\nDim iCount\niInputRows = CInt(InputBox(\"How many data entry rows required?\")) 'message box for user input (interger)\n\nIf iInputRows &gt; 1 Then\nFor iCount = 1 To iInputRows - 1\n    Rows(iCount + 13 &amp; \":\" &amp; iCount + 13).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove 'insert no. of rows from from first row (row 13) to user input minus 1 (this ensures that the exact no. of rows are inserted from row 13 down)\n    Range(\"D\" &amp; iCount + 13).Value = iCount + 1 'column D is used for sequential numbering purposes\nNext iCount\nEnd If\n</code></pre>\n\n<p>The formula from which to autofill are <code>= X13:AR13</code>.</p>\n\n<p>I am relatively comfortable with the autofill formula, but I am having difficulties in this application to halt the autofill according to the stipulated number of rows.  </p>\n"}, {"tags": ["vba", "excel", "printing", "excel-2013", "page-size"], "answers": [{"comments": [{"owner": {"reputation": 2586, "user_id": 2289942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qKeJZ.png?s=128&g=1", "display_name": "Nawed Nabi Zada", "link": "https://stackoverflow.com/users/2289942/nawed-nabi-zada"}, "edited": false, "score": 0, "creation_date": 1421313129, "post_id": 27947181, "comment_id": 44313643, "body": "I assume your answer is correct, therefor accepted. But I guess I will never know because I decided to do the job in C# and make a DLL for the macro."}, {"owner": {"reputation": 1322, "user_id": 678586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hmChB.jpg?s=128&g=1", "display_name": "zeta", "link": "https://stackoverflow.com/users/678586/zeta"}, "edited": false, "score": 0, "creation_date": 1478561016, "post_id": 27947181, "comment_id": 68197501, "body": "xlPaperUser, how is this defined? It seems like it might be set in the printer preferences page size?"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "reply_to_user": {"reputation": 1322, "user_id": 678586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hmChB.jpg?s=128&g=1", "display_name": "zeta", "link": "https://stackoverflow.com/users/678586/zeta"}, "edited": false, "score": 1, "creation_date": 1478581685, "post_id": 27947181, "comment_id": 68202818, "body": "@zeta My understanding is that xlPaperUser is defined by the printer, which is why you cannot set it using VBA."}], "tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": true, "score": 3, "last_activity_date": 1421251126, "creation_date": 1421251126, "answer_id": 27947181, "question_id": 27939513, "link": "https://stackoverflow.com/questions/27939513/choosing-paper-size-not-default-sizes-in-excel-vba/27947181#27947181", "title": "Choosing paper size (NOT DEFAULT sizes) in excel vba", "body": "<p><strong>Question 1</strong></p>\n\n<p><code>xlPaperUser</code> is a User-Defined paper size that is assigned a constant value of 256. If this has not been defined, it may throw an error.</p>\n\n<p><strong>Question 2</strong></p>\n\n<p>There is no way to create custom paper sizes in Excel, <strong>however</strong> you can create custom paper sizes on many printers. Under Page Setup, click the Options button. This will bring up the printer properties dialog box. Change your paper size to a custom size using this dialog box and click OK.</p>\n\n<p>Then in Excel run this: <code>MsgBox PageSetup.PaperSize</code>. This will give you the new constant value assigned to that paper size in Excel. Then change <code>.PaperSize = xlPaperUser</code> in your macro to <code>.PaperSize =</code> &amp; whatever the constant is that you just found.</p>\n\n<p><strong>Question 3</strong></p>\n\n<p><code>.PrintArea</code> takes a string input, not a range. Change your line to <code>ActiveSheet.PageSetup.PrintArea = Range(\"Img\").Address</code> and it should work.</p>\n"}, {"comments": [{"owner": {"reputation": 2586, "user_id": 2289942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qKeJZ.png?s=128&g=1", "display_name": "Nawed Nabi Zada", "link": "https://stackoverflow.com/users/2289942/nawed-nabi-zada"}, "edited": false, "score": 0, "creation_date": 1572443599, "post_id": 58626834, "comment_id": 103561328, "body": "I didn&#39;t really write it in the question, but the whole idea was to make an automated process of getting some labels (with QR codes) printed based on excel sheets. All dialogs should be avoided. In case of dialogs I would just use the default printing dialog."}], "tags": [], "owner": {"reputation": 37, "user_id": 5843978, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/6USqF.jpg?s=128&g=1", "display_name": "drunkenvash", "link": "https://stackoverflow.com/users/5843978/drunkenvash"}, "is_accepted": false, "score": 0, "last_activity_date": 1572443260, "creation_date": 1572443260, "answer_id": 58626834, "question_id": 27939513, "link": "https://stackoverflow.com/questions/27939513/choosing-paper-size-not-default-sizes-in-excel-vba/58626834#58626834", "title": "Choosing paper size (NOT DEFAULT sizes) in excel vba", "body": "<p>I would like to add to this.<br>\nYou can also add this line <code>Application.Dialogs(xlDialogPageSetup).Show</code></p>\n\n<p>An Example would be:</p>\n\n<pre><code>Sub printGraphs()\n\nApplication.Dialogs(xlDialogPrinterSetup).Show\nApplication.Dialogs(xlDialogPageSetup).Show\n    With ActiveSheet.PageSetup\n        .LeftMargin = Application.InchesToPoints(0.7)\n        .RightMargin = Application.InchesToPoints(0.7)\n        .TopMargin = Application.InchesToPoints(0.75)\n        .BottomMargin = Application.InchesToPoints(0.75)\n        .HeaderMargin = Application.InchesToPoints(0.3)\n        .FooterMargin = Application.InchesToPoints(0.3)\n        .PrintQuality = 1200\n        .CenterHorizontally = True\n        .CenterVertically = False\n        .Orientation = xlLandscape\n        .FirstPageNumber = xlAutomatic\n        .Order = xlDownThenOver\n        .BlackAndWhite = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = False\n        .PrintErrors = xlPrintErrorsDisplayed\n    End With\n        ActiveWorkbook.PrintOut From:=1, To:=3, Copies:=1, Collate:=True, _\n        IgnorePrintAreas:=False\n\nEnd Sub\n</code></pre>\n\n<p>This prompts the user to choose their page size based on printer selected. I use this to print a workbook with multiple tabs all at once, and only the tabs I want.</p>\n"}], "owner": {"reputation": 2586, "user_id": 2289942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qKeJZ.png?s=128&g=1", "display_name": "Nawed Nabi Zada", "link": "https://stackoverflow.com/users/2289942/nawed-nabi-zada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48455, "favorite_count": 2, "accepted_answer_id": 27947181, "answer_count": 2, "score": 2, "last_activity_date": 1572443260, "creation_date": 1421227592, "question_id": 27939513, "link": "https://stackoverflow.com/questions/27939513/choosing-paper-size-not-default-sizes-in-excel-vba", "title": "Choosing paper size (NOT DEFAULT sizes) in excel vba", "body": "<p>I have Brother QL-720NW Label Printer, which I want to print some labels on.</p>\n\n<p>The printer has a roll of width 62mm</p>\n\n<p>When I try to print something to it, I need to setup the page, and define page size.\nIf the page size is incorrect (width more than 62mm) the printer won't print anything.</p>\n\n<p>Now my problem is that I am using excel with macros to send some data to the printer.\nI know there is some predefined page sizes (<a href=\"http://msdn.microsoft.com/en-us/library/office/ff834612%28v=office.15%29.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/office/ff834612%28v=office.15%29.aspx</a>) which can be used, but in my case all of them are too big for this purpose.</p>\n\n<p>Here a sample of the code I have so far:</p>\n\n<pre><code>Sub CreateTestCode()\n\n' setting printer\nDim objPrinter As String\nobjPrinter = ActivePrinter\nActiveSheet.PageSetup.PrintArea = Range(\"Img\")\nWith ActiveSheet.PageSetup\n.PrintTitleRows = \"\"\n.PrintTitleColumns = \"\"\n.PrintHeadings = False\n.PrintGridlines = False\n.RightMargin = Application.InchesToPoints(0.39)\n.LeftMargin = Application.InchesToPoints(0.39)\n.TopMargin = Application.InchesToPoints(0.39)\n.BottomMargin = Application.InchesToPoints(0.39)\n.PaperSize = xlPaperUser\n.Orientation = xlLandscape\n.Draft = False\nEnd With\n\nDim printerName As String\nprinterName = \"BrotherQL720NW Labelprinter on XYZ\"\n\nActiveSheet.PrintOut Preview:=True, ActivePrinter:=printerName\n\nActivePrinter = objPrinter\nEnd Sub\n</code></pre>\n\n<p>Now I have 3 questions:</p>\n\n<p>1: At the .PaperSize = xlPaperUser I get a runtime-error '1004'. Unable to set the PaperSize of the PageSetup class. What is wrong here ?</p>\n\n<p>2: How can I set the paper size to something like 62mm x 50mm ?</p>\n\n<p>3:  Even that I define the print area to Range(\"Img\") it still print the whole sheet ?!?</p>\n\n<p>By the way I am totally new to vba, this is my first attempt to use vba.</p>\n"}, {"tags": ["vba", "ms-access", "report"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1421228811, "post_id": 27939457, "comment_id": 44275992, "body": "Sorry, your question is very unclear. Could you please try editing it again? You say design form, then report. What is is?"}, {"owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1421229063, "post_id": 27939457, "comment_id": 44276151, "body": "simple: I cant open a report without any error or freezing"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1421229503, "post_id": 27939457, "comment_id": 44276420, "body": "So add the error with its appropriate error number and description."}, {"owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1421229677, "post_id": 27939457, "comment_id": 44276514, "body": "I am getting no error. I cant open the report without any error message or freezing"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1421232668, "post_id": 27939457, "comment_id": 44278151, "body": "Can you export the report do a different MDB file? what happens? (probably nothing!)"}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": true, "score": 0, "last_activity_date": 1421250249, "last_edit_date": 1495540241, "creation_date": 1421250249, "answer_id": 27946876, "question_id": 27939457, "link": "https://stackoverflow.com/questions/27939457/can-t-open-reports-in-a-microsoft-access-database/27946876#27946876", "title": "Can\u2019t Open Reports in a Microsoft Access Database", "body": "<p>As much as you probably don't want to hear this, I have encountered this a number of times and the best solution was to create a new database and copy each item into it one-by-one.  Sometimes a database carries enough corruption so that even a compact/repair doesn't remove it.</p>\n\n<p>As a \"first line of defense\" you can try using the undocumented <a href=\"https://stackoverflow.com/questions/3266542/how-does-one-decompile-and-recompile-a-database-application\">Decompile switch</a>, but it's my experience that it rarely works.  Still, it's worth a shot since it's quick and simple.</p>\n"}], "owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1718, "favorite_count": 0, "accepted_answer_id": 27946876, "answer_count": 1, "score": -1, "last_activity_date": 1459891399, "creation_date": 1421227440, "question_id": 27939457, "link": "https://stackoverflow.com/questions/27939457/can-t-open-reports-in-a-microsoft-access-database", "title": "Can\u2019t Open Reports in a Microsoft Access Database", "body": "<p>I have a problem. I want to open a report in my microsoft access file in design form, but MS Access doesnt open this report. I dont get any error message, and without freezing.</p>\n\n<p>I have no problem with other report files, but for a special report I have this problem. How can I solve this problem?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4445306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EwrNW.jpg?s=128&g=1", "display_name": "press_anykey", "link": "https://stackoverflow.com/users/4445306/press-anykey"}, "is_accepted": false, "score": 0, "last_activity_date": 1421239472, "creation_date": 1421239472, "answer_id": 27943262, "question_id": 27939345, "link": "https://stackoverflow.com/questions/27939345/macro-to-update-table-from-form-in-access/27943262#27943262", "title": "Macro to update table from form in Access", "body": "<p>You can either set the table as the row source of your form in the properties(design View).\nOr you could make a query that uses insert to make new records in your table and fill them with the values from your form, like this SQL:</p>\n\n<pre><code>INSERT INTO YourTable( [User], [Name] ) \nSELECT [Forms]![YourForm]![Uservalue] AS [User], [Forms]![YourForm]![NameValue] AS [Name];\n</code></pre>\n\n<p>Then put an event procedure in the OnClick event of the SUBMIT button that calls the query(VBA)</p>\n\n<pre><code>DoCmd.OpenQuery \"YourQuery\"\n</code></pre>\n\n<p>Or to run the SQL code straight from VBA.</p>\n\n<pre><code>DoCmd.RunSQL \"YourSQL\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 0, "last_activity_date": 1421264163, "creation_date": 1421264163, "answer_id": 27950997, "question_id": 27939345, "link": "https://stackoverflow.com/questions/27939345/macro-to-update-table-from-form-in-access/27950997#27950997", "title": "Macro to update table from form in Access", "body": "<p>Data in an Access bound form WILL NOT write the data to the table until you close the database or close the form, or navigate to a new record.</p>\n\n<p>However,  you can simply place a submit button on the form.\nSo the code behind the submit button would be:</p>\n\n<pre><code>' code to submit data to table:\nMe.Dirty = false\n</code></pre>\n\n<p>The above code will case the form to submit and write the data to the forms underlying table. So YOU CAN write code to submit the forms data if you wish. It is only one line.</p>\n\n<p>If the user closes the form, or closes the database and they NOT hit submit, then what do you want to do? You have to explain what you want to occur in this case. If you do nothing, then Access will automatically submit the data to the table for you. Or perhaps you want to nag and torture the user and prompt them as to what to do? And if you say no to not save data, do you want to return back to the form, or continue closing that form? (the user will think if they hit no to not save, then they are asking for a chance to edit the form data some more, and not discard the data entry they done so for).</p>\n\n<p>You also not explain after the user hits submit more then one time, then what you want to occur? If the user accidently hits the submit button two times (REALLY EASY say with a double mouse click, then do you want the forms data to be written to the table two times?</p>\n\n<p>So there is HUGE HUGE number of questions you not answered here. </p>\n\n<p>So if the user does not hit submit, but closes the form (or database), what do you want to occur?</p>\n\n<p>If the user by accident hits submit two times, do you want the data to be written to the table two times? What do you want to happen here? What will stop user from hitting submit multiple times and not resulting in multiple reocrds?</p>\n\n<p>So keep in mind that ONE LINE of code behind the button called submit will submit the data to the table, but it it\u2019s the 100+ other details as to what supposed to occur when user\u2019s hit submit more then once, and what occurs when closing the form without having hit submit is the details you not yet shared. And not only is there closing of the form, but what about closing the application?</p>\n\n<p>So keep in mind ONLY ONE LINE of code is required to submit the data to the table and that code is:</p>\n\n<pre><code>Me.Dirty = false\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4452632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84da63b4e6a92bf1ba41505fbe7d2ef7?s=128&d=identicon&r=PG&f=1", "display_name": "Lateef", "link": "https://stackoverflow.com/users/4452632/lateef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4951, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1421264163, "creation_date": 1421227082, "last_edit_date": 1421254353, "question_id": 27939345, "link": "https://stackoverflow.com/questions/27939345/macro-to-update-table-from-form-in-access", "title": "Macro to update table from form in Access", "body": "<p>I have an MS Access form linked to an MS Access table.  Whenever the form is filled, the table will be populated only if I close the database. </p>\n\n<p>I have a dummy \"SUBMIT\" button on the form, and I want to be able to populate my table from the form on the click of this button and clear the form for new entry.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1421227965, "post_id": 27939237, "comment_id": 44275487, "body": "VBA may be overkill for this. Look into the <a href=\"http://office.microsoft.com/en-001/excel-help/sumif-function-HP010062465.aspx\" rel=\"nofollow noreferrer\">SUMIF function</a> for a conditional total of <i>Lit</i> based upon the <i>Lamp ID</i>."}, {"owner": {"reputation": 8095, "user_id": 250725, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/T5rng.jpg?s=128&g=1", "display_name": "psubsee2003", "link": "https://stackoverflow.com/users/250725/psubsee2003"}, "edited": false, "score": 0, "creation_date": 1421228181, "post_id": 27939237, "comment_id": 44275607, "body": "Concur with @Jeeped... unless there is something else that isn&#39;t being mentioned, VBA is not the right tool for this job.  The built in excel formulas will be more efficient."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1421232177, "post_id": 27939915, "comment_id": 44277879, "body": "<code>i = i++</code> is not valid in VBA"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1421232363, "post_id": 27939915, "comment_id": 44277966, "body": "while you are at it, you might like to close the While block"}, {"owner": {"reputation": 75, "user_id": 1606058, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f04959a12d5a2c6594ef037ddc4a04c0?s=128&d=identicon&r=PG", "display_name": "aDev", "link": "https://stackoverflow.com/users/1606058/adev"}, "edited": false, "score": 0, "creation_date": 1421309585, "post_id": 27939915, "comment_id": 44312039, "body": "i am keep getting the run-time error 1004 (Application-defined or Object-defined error)."}, {"owner": {"reputation": 75, "user_id": 1606058, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f04959a12d5a2c6594ef037ddc4a04c0?s=128&d=identicon&r=PG", "display_name": "aDev", "link": "https://stackoverflow.com/users/1606058/adev"}, "edited": false, "score": 0, "creation_date": 1421377257, "post_id": 27939915, "comment_id": 44345620, "body": "@katz works now. and thanks for helping out! did not know &#39;sumif&#39; function previously, but now i do. =)"}], "tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": true, "score": 1, "last_activity_date": 1421313693, "last_edit_date": 1421313693, "creation_date": 1421228785, "answer_id": 27939915, "question_id": 27939237, "link": "https://stackoverflow.com/questions/27939237/excel-vba-calculate-filtered-cells-and-copy-to-another-sheet/27939915#27939915", "title": "Excel VBA calculate filtered cells and copy to another sheet", "body": "<p>Try this if needed in VBA on sheet2:</p>\n\n<pre><code>Sub test()\nDim Sheet1 As Worksheet\nDim Sheet2 As Worksheet\nSet Sheet1 = Worksheets(\"Sheet1\")\nSet Sheet2 = Worksheets(\"Sheet2\")\n    i = 2 'start in row 2 with lamps\n    While Not IsEmpty(Sheet2.Cells(i, 1))\n    Sheet2.Cells(i, 2) = WorksheetFunction.SumIf(Sheet1.Range(\"A1:A9\"), Sheet2.Cells(i, 1), Sheet1.Range(\"B1:B9\"))\n    i = i + 1\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1606058, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f04959a12d5a2c6594ef037ddc4a04c0?s=128&d=identicon&r=PG", "display_name": "aDev", "link": "https://stackoverflow.com/users/1606058/adev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 27939915, "answer_count": 1, "score": -1, "last_activity_date": 1421313693, "creation_date": 1421226690, "last_edit_date": 1531161705, "question_id": 27939237, "link": "https://stackoverflow.com/questions/27939237/excel-vba-calculate-filtered-cells-and-copy-to-another-sheet", "title": "Excel VBA calculate filtered cells and copy to another sheet", "body": "<p>So, I have 2 worksheets; Sheet1 for entering data for number of times a lamp is lit in a day (there are several lamps), and Sheet 2 is summary for total accumulated lit times of each lamp.</p>\n\n<p><img src=\"https://i.stack.imgur.com/2Ysz9.png\" alt=\"Sheet1\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/OWUFv.png\" alt=\"Sheet2\"></p>\n\n<p>My worker will update the data (i.e. Lamp ID and number of lit) in Sheet1 everyday. How do I calculate the total accumulated lit for each lamp in Sheet1 and then copy the value to Sheet2 via VBA? I am not sure how to communicate different worksheets...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 192, "user_id": 2910993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed0b3e42ffc95bccce90669844839579?s=128&d=identicon&r=PG&f=1", "display_name": "Alwyn Miranda", "link": "https://stackoverflow.com/users/2910993/alwyn-miranda"}, "edited": false, "score": 0, "creation_date": 1421224053, "post_id": 27937767, "comment_id": 44273554, "body": "its not a template. Its macro enabled workbook. templates extension are something lik xlt"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421233985, "post_id": 27937767, "comment_id": 44278914, "body": "The Run Macro dialogue is run at Application level, so no, you can&#39;t do this. More importantly, why would you want to?"}, {"owner": {"reputation": 192, "user_id": 2910993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed0b3e42ffc95bccce90669844839579?s=128&d=identicon&r=PG&f=1", "display_name": "Alwyn Miranda", "link": "https://stackoverflow.com/users/2910993/alwyn-miranda"}, "edited": false, "score": 0, "creation_date": 1421302625, "post_id": 27937767, "comment_id": 44309691, "body": "My clients are working with many excel sheets open. When I send my macro related workbook to them, I want to make sure they wont run the code in the wrong workbook. Sinceit cant be done maybe I have to inform them about this clearly.... Since Macro process is irreversible. :)"}], "answers": [{"tags": [], "owner": {"reputation": 1583, "user_id": 3503032, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1176862391/picture?type=large", "display_name": "Max Segal", "link": "https://stackoverflow.com/users/3503032/max-segal"}, "is_accepted": true, "score": 1, "last_activity_date": 1421306836, "last_edit_date": 1421306836, "creation_date": 1421232801, "answer_id": 27941195, "question_id": 27937767, "link": "https://stackoverflow.com/questions/27937767/macro-visibility-in-other-excel-sheets/27941195#27941195", "title": "Macro visibility in other excel sheets", "body": "<p>Excel macros popup lists all the macros available for execution in all workbooks that are open in the current Excel instance. This means that the only option to execute the macro only from a specific workbook is to check if ActiveWorkbook is the workbook you want the macro to be executed from. You can accomplish that with this line on top of your sub code:</p>\n\n<pre><code>If Not ActiveWorkbook.Name = \"abc.xlsm\" Then Exit Sub\n</code></pre>\n"}], "owner": {"reputation": 192, "user_id": 2910993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed0b3e42ffc95bccce90669844839579?s=128&d=identicon&r=PG&f=1", "display_name": "Alwyn Miranda", "link": "https://stackoverflow.com/users/2910993/alwyn-miranda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 27941195, "answer_count": 1, "score": 0, "last_activity_date": 1421306836, "creation_date": 1421220550, "question_id": 27937767, "link": "https://stackoverflow.com/questions/27937767/macro-visibility-in-other-excel-sheets", "title": "Macro visibility in other excel sheets", "body": "<p>I created the macro in one of the excel workbook (abc.xlsm). And I want only that particular workbook to display the macros in view macros popup. But when view macros from other workbook (xyz.xlsx) I am able to view the macros which I created in the abc.xlsm.\nI tried with private keyword before the macro. But it will hide the macro visibility in all the workbooks including the first workbook (abc.xlsm)\nIS THERE ANYWAY TO RESTRICT THE MACRO VISIBILITY ONLY IN THE WORKBOOK WHICH IT WAS CREATED?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 4452260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872e45945f414bbacfc5714b1c1ff3cb?s=128&d=identicon&r=PG&f=1", "display_name": "JAI", "link": "https://stackoverflow.com/users/4452260/jai"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1421223003, "post_id": 27937557, "comment_id": 44273066, "body": "@Maciej Los well i&#39;ve only tried how to insert a comment on the same sheet. example a cell to the right as the comment.   Sub TextIntoComments_GetFromRight()   Dim cell As Range Selection.ClearComments For Each cell In Intersect(Selection, ActiveSheet.UsedRange) If Trim(cell.Offset(0, 1).Text) &lt;&gt; &quot;&quot; Then cell.AddComment cell.Offset(0, 1).Text cell.Comment.Visible = False cell.Comment.Shape.TextFrame.AutoSize = True End If Next cell End Sub"}, {"owner": {"reputation": 7733, "user_id": 2092048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4896d8e38ccff90deda9e8dcf8d7c01?s=128&d=identicon&r=PG", "display_name": "nkjt", "link": "https://stackoverflow.com/users/2092048/nkjt"}, "edited": false, "score": 0, "creation_date": 1421230485, "post_id": 27937557, "comment_id": 44276941, "body": "To add information to your question, press the &quot;edit&quot; button underneath your post. Do not post code in comments."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1422546555, "post_id": 27937557, "comment_id": 44800946, "body": "@JAI Were you able to use the answer below?"}], "answers": [{"tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": false, "score": 1, "last_activity_date": 1421255109, "creation_date": 1421255109, "answer_id": 27948499, "question_id": 27937557, "link": "https://stackoverflow.com/questions/27937557/create-comments-from-a-selected-range/27948499#27948499", "title": "Create comments from a selected range", "body": "<p>The following code will accept two range inputs from the user. One for the range that needs comments, and one for the range of comments. These two ranges must be the same size. It will then add the text from the second range as comments to the first range. This will work regardless of which sheet the two ranges are on.</p>\n\n<pre><code>Sub TextIntoComments_GetFromRight()\n    Dim CommentRange    As Range\n    Dim CellComments    As Range\n    Dim cell            As Range\n    Dim cell2           As Range\n    Dim ws1 As Worksheet, ws2 As Worksheet\n\n    Set CommentRange = Range(\"A1\")\n    Set CellComments = Range(\"A1:A2\")\n    Do Until CommentRange.Rows.Count = CellComments.Rows.Count And CommentRange.Columns.Count = CellComments.Columns.Count\n        Set CommentRange = Application.InputBox(\"Select the range that needs comments.\", Type:=8)\n        Set CellComments = Application.InputBox(\"Select the range of comments to be inserted.\", Type:=8)\n        If CommentRange.Rows.Count &lt;&gt; CellComments.Rows.Count Or CommentRange.Columns.Count &lt;&gt; CellComments.Columns.Count Then MsgBox \"The range sizes do not match. Please select matching range sizes.\", vbCritical\n    Loop\n\n    Set ws1 = CommentRange.Worksheet\n    Set ws2 = CellComments.Worksheet\n    CommentRange.ClearComments\n    For Each cell In CommentRange\n        Set cell2 = ws2.Cells(CellComments.Row + (cell.Row - CommentRange.Row), CellComments.Column + (cell.Column - CommentRange.Column))\n        If cell2.Text &lt;&gt; \"\" Then\n            cell.AddComment cell2.Text\n            cell.Comment.Visible = False\n            cell.Comment.Shape.TextFrame.AutoSize = True\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4452260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872e45945f414bbacfc5714b1c1ff3cb?s=128&d=identicon&r=PG&f=1", "display_name": "JAI", "link": "https://stackoverflow.com/users/4452260/jai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1421765851, "creation_date": 1421219530, "last_edit_date": 1421765851, "question_id": 27937557, "link": "https://stackoverflow.com/questions/27937557/create-comments-from-a-selected-range", "title": "Create comments from a selected range", "body": "<p>I basically want a macro to insert the selection as comments to a selected range. So basically I would require to have two selected ranges? How does this work? </p>\n\n<p>My problem- I have the comments for the cells in a different sheet in rows. And in the second sheet I have column headers for which I need those rows as comments to be inserted. </p>\n\n<pre><code>Sub TextIntoComments_GetFromRight()\n    Dim cell As Range\n    Selection.ClearComments\n    For Each cell In Intersect(Selection, ActiveSheet.UsedRange)\n      If Trim(cell.Offset(0, 1).Text) &lt;&gt; \"\" Then\n        cell.AddComment cell.Offset(0, 1).Text\n        cell.Comment.Visible = False\n        cell.Comment.Shape.TextFrame.AutoSize = True\n      End If\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "multiple-columns"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1421235789, "post_id": 27937424, "comment_id": 44279887, "body": "what happens when you step through it looking at the source files as they are opened, and checking the columns that are copied?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4422511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80f857c970044f351167f78d8cc7bff4?s=128&d=identicon&r=PG&f=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/4422511/edward"}, "edited": false, "score": 0, "creation_date": 1421241134, "post_id": 27942246, "comment_id": 44282813, "body": "Thanks for your reply. I&#39;ve tried adding the code, but it shows &#39;compile error: Invalid qualifier&#39; to the line I added."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "reply_to_user": {"reputation": 21, "user_id": 4422511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80f857c970044f351167f78d8cc7bff4?s=128&d=identicon&r=PG&f=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/4422511/edward"}, "edited": false, "score": 0, "creation_date": 1421247886, "post_id": 27942246, "comment_id": 44287092, "body": "I have edited it, try again, should be placed <b>after</b> the line <code>DataRng.Copy OutRng</code> I think"}], "tags": [], "owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "is_accepted": false, "score": 0, "last_activity_date": 1421247822, "last_edit_date": 1421247822, "creation_date": 1421236041, "answer_id": 27942246, "question_id": 27937424, "link": "https://stackoverflow.com/questions/27937424/vba-to-do-column-consolidation/27942246#27942246", "title": "VBA to do column consolidation", "body": "<p>to get the filename of the source workbook, you can use:</p>\n\n<pre><code>Cells(32, LastOutCol + 1).value=TargetFiles.SelectedItems(FileIdx).Name\n</code></pre>\n\n<p>and as for all the data being the same, you could step through and check the columns that are being copied in the source workbook in each iteration of the loop by adding a breakpoint on the line:</p>\n\n<pre><code>DataRng.Copy OutRng\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4422511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80f857c970044f351167f78d8cc7bff4?s=128&d=identicon&r=PG&f=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/4422511/edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594150824, "creation_date": 1421218907, "last_edit_date": 1594150824, "question_id": 27937424, "link": "https://stackoverflow.com/questions/27937424/vba-to-do-column-consolidation", "title": "VBA to do column consolidation", "body": "<p>I am trying to make a consolidated financial statement, which shows all details of subsidiary and consolidated figure in the last column (I plan to use formula for total consolidated figure). I am trying to copy some specific column of worksheet (let's say column C) from selected files (each file has only one sheet with exacltly same layout, structure, and basic data) then paste it into one master sheet (newly added) to show detail of the column C from each file in column B of the master sheet from left to right. Also, I want to show the name of each file in row 1 of the master sheet, but I still can't figure out how to put it in my code. </p>\n\n<p>Here is my code. So far, after I ran it in excel 2010, I found that every column are the same. I don't know what went wrong. I have more than 60 files to do this detailed consolidation. Any help woud be very much appreciated. Thank you.</p>\n\n<pre><code>Sub CombineSheetColumn()\nDim DataBook As Workbook, OutBook As Workbook\nDim DataSheet As Worksheet, OutSheet As Worksheet\nDim TargetFiles As FileDialog\nDim MaxNumberFiles As Long, FileIdx As Long, _\nHeaderRow As Long\nDim DataRng As Range, OutRng As Range\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n'initialize constants\n\nHeaderRow = 2 'assume headers are always in row 2\nLastOutCol = 1\n\n'select files\nSet TargetFiles = Application.FileDialog(msoFileDialogOpen)\n  With TargetFiles\n    .AllowMultiSelect = True\n    .Title = \"Multi-select target data files:\"\n    .ButtonName = \"\"\n    .Filters.Clear\n    .Filters.Add \".xlsx files\", \"*.xlsx\"\n    .Show\n  End With\n\n'set up the output workbook\n  Set OutBook = Workbooks.Add\n  Set OutSheet = OutBook.Sheets(1)\n\n'loop through all selected files\n  For FileIdx = 1 To TargetFiles.SelectedItems.Count\n'open the file and assign the workbook/worksheet\n  Set DataBook = Workbooks.Open(TargetFiles.SelectedItems(FileIdx))\n  Set DataSheet = DataBook.ActiveSheet\n\n    Set DataRng = Range(DataSheet.Cells(HeaderRow + 1, 3), DataSheet.Cells(32, 3))\n    Set OutRng = Range(OutSheet.Cells(HeaderRow + 1, 2), OutSheet.Cells(32, LastOutCol + 1))     \n'copy the data to the outbook\n  DataRng.Copy OutRng\n\n'close the data book without saving\n  DataBook.Close False\n\n'update the last outbook row\n  LastOutCol = OutSheet.Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column  \nNext FileIdx\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "filter"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421289853, "post_id": 27937337, "comment_id": 44306785, "body": "Please show the code you&#39;ve tried that doesn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4444188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b5eb75c6f73b971772df99639668e3f5?s=128&d=identicon&r=PG&f=1", "display_name": "kobebryant", "link": "https://stackoverflow.com/users/4444188/kobebryant"}, "edited": false, "score": 0, "creation_date": 1421291342, "post_id": 27956130, "comment_id": 44307111, "body": "I have thought this way but the number may be more than thousand, I just want to pick the number begins with 15. But begins with just for text, why it doesn&#39;t recognize number as text although I format it to text"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 61, "user_id": 4444188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b5eb75c6f73b971772df99639668e3f5?s=128&d=identicon&r=PG&f=1", "display_name": "kobebryant", "link": "https://stackoverflow.com/users/4444188/kobebryant"}, "edited": false, "score": 0, "creation_date": 1421292035, "post_id": 27956130, "comment_id": 44307288, "body": "@kobebryant If it is ok to change the numbers to text, see my edit."}, {"owner": {"reputation": 61, "user_id": 4444188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b5eb75c6f73b971772df99639668e3f5?s=128&d=identicon&r=PG&f=1", "display_name": "kobebryant", "link": "https://stackoverflow.com/users/4444188/kobebryant"}, "edited": false, "score": 0, "creation_date": 1421293688, "post_id": 27956130, "comment_id": 44307647, "body": "Awesome, when I change to text normally the excel program be crashed, but I used VBA it&#39;s run smoothly, lol. Thank you so much L42, I don&#39;t know how to make friend with you"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 61, "user_id": 4444188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b5eb75c6f73b971772df99639668e3f5?s=128&d=identicon&r=PG&f=1", "display_name": "kobebryant", "link": "https://stackoverflow.com/users/4444188/kobebryant"}, "edited": false, "score": 0, "creation_date": 1421298288, "post_id": 27956130, "comment_id": 44308646, "body": "@kobebryant We already are friends and with the rest of SO community. They may criticize you or DV and close some of your questions but that is for you to learn. That&#39;s real friends for me."}, {"owner": {"reputation": 61, "user_id": 4444188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b5eb75c6f73b971772df99639668e3f5?s=128&d=identicon&r=PG&f=1", "display_name": "kobebryant", "link": "https://stackoverflow.com/users/4444188/kobebryant"}, "edited": false, "score": 0, "creation_date": 1421390918, "post_id": 27956130, "comment_id": 44349091, "body": "thank you so much, all what you said is good. First time I join in SO I really love this forum&#39;s apperance especially member likes you. All my post perfomed not good, but I&#39;m try to adapt."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 2, "last_activity_date": 1421291938, "last_edit_date": 1421291938, "creation_date": 1421290715, "answer_id": 27956130, "question_id": 27937337, "link": "https://stackoverflow.com/questions/27937337/filter-number-with-option-begins-with/27956130#27956130", "title": "Filter number with option &quot;begins with&quot;", "body": "<p>Yes you are correct, that is not possible in AutoFilter.<br>\nHere's a way though if your data are numbers.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$8:$AF$1194\").AutoFilter Field:=12, Criteria1:=\"&gt;=1500\"\n</code></pre>\n\n<p>Or this if you specifically want those with <strong>15</strong> in it.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$8:$AF$1194\").AutoFilter Field:=12, Criteria1:=\"&gt;=1500\" _\n    Operator:=xlAnd, Criteria2:=\"&lt;1600\"\n</code></pre>\n\n<p><strong>Edit1:</strong> Answer to follow-up in comment</p>\n\n<p>You can change all your data into <em>Text</em> by using <em>Text To Columns</em> under <strong>Data Tab</strong>.<br>\n<strong>Steps:</strong></p>\n\n<ol>\n<li>Select the entire column where you have your data in number format.</li>\n<li>Then click on <em>Text To Columns</em>. Press <em>Next</em> on the 1st and 2nd dialogue box.</li>\n<li>On the 3rd dialogue box, select <em>Text</em> instead of <em>General</em>.</li>\n</ol>\n\n<p>Now, all your data are in the form of text.<br>\nYou can then use below code to filter all that begins with <strong>15</strong>.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$8:$AF$1194\").AutoFilter Field:=12, Criteria1:=\"15*\"\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4444188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b5eb75c6f73b971772df99639668e3f5?s=128&d=identicon&r=PG&f=1", "display_name": "kobebryant", "link": "https://stackoverflow.com/users/4444188/kobebryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8193, "favorite_count": 0, "accepted_answer_id": 27956130, "answer_count": 1, "score": 0, "last_activity_date": 1421291938, "creation_date": 1421218554, "last_edit_date": 1421290541, "question_id": 27937337, "link": "https://stackoverflow.com/questions/27937337/filter-number-with-option-begins-with", "title": "Filter number with option &quot;begins with&quot;", "body": "<p>Can we filter number in excel with option \"begins with\", when I filter at the box \"search\" of combobox ex: 15*. It's ok, but in Number Filters/Custom Filters I use \"begins with\" it didn't work. I try to record Macro with the way \"search\" in combobox for the code but it is impossible.</p>\n\n<p>How to write VBA code for this. Thank you, this is the macro recorded.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$8:$AF$1194\").AutoFilter Field:=12, Criteria1:=Array( _  \n    \"1521\", \"1522\", \"1526\", \"1541\", \"1542\", \"1543\", \"1561\"),Operator:=xlFilterValues\n</code></pre>\n\n<p>But I wanna filter the value 15*</p>\n"}, {"tags": ["email", "excel", "outlook", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1421253112, "post_id": 27936217, "comment_id": 44290558, "body": "Do you specifically want RTF or it can be HTML as long as you get a link?"}, {"owner": {"reputation": 51, "user_id": 2897356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9c29442d852a51a757478b6dfc0d3d?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/2897356/dave"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1421272961, "post_id": 27936217, "comment_id": 44301621, "body": "Hi Dmitry. I would like to use RTF, but if it&#39;s far too complicated then I&#39;ll have to convert the code over to using HTMLbody instead."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1421274510, "post_id": 27936217, "comment_id": 44302324, "body": "You can still use RTF, but you would need to work with the RtfBody property or use the Word Document object. What was wrong with your code above?"}, {"owner": {"reputation": 51, "user_id": 2897356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9c29442d852a51a757478b6dfc0d3d?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/2897356/dave"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1421278692, "post_id": 27936217, "comment_id": 44303925, "body": "There isn&#39;t anything <i>wrong</i> with my code, I just didn&#39;t know how to add the URL in the strBody, so that it would come up as a hyperlink in the email body when the email was generated. A code sample would be handy..... :)  The commented code explains what I&#39;m trying to achieve.  Thanks."}, {"owner": {"reputation": 51, "user_id": 2897356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9c29442d852a51a757478b6dfc0d3d?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/2897356/dave"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1421279577, "post_id": 27936217, "comment_id": 44304245, "body": "@DmitryStreblechenko Could this be what I&#39;m looking for? <code>Object.Hyperlinks.Add(Anchor, Address, SubAddress, ScreenTip, TextToDisplay, Target)</code> where Object would be the word document object?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2897356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9c29442d852a51a757478b6dfc0d3d?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/2897356/dave"}, "edited": false, "score": 0, "creation_date": 1421271036, "post_id": 27937624, "comment_id": 44300689, "body": "Thank you Paresh. Unfortunately, I&#39;m looking to have the mail body only in Rich Text format, as I will be pasting in some cells (which have been formatted) from other parts of the spreadsheet.  Otherwise, I&#39;d do it all in HTMLbody, but need to know if it&#39;s possible to do what I&#39;m trying in RTF body."}], "tags": [], "owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1421219878, "creation_date": 1421219878, "answer_id": 27937624, "question_id": 27936217, "link": "https://stackoverflow.com/questions/27936217/excel-vba-url-hyperlink-in-richtext-email-body/27937624#27937624", "title": "Excel VBA URL hyperlink in RichText email body", "body": "<p>There's small change in your code.</p>\n\n<p>You need to add <strong>BODYFORMAT</strong> as </p>\n\n<pre><code>.BodyFormat = olFormatHTML\n</code></pre>\n\n<p>After setting <strong>BODYFORMAT</strong>, set the <strong>HTMLBODY</strong> of the Email.</p>\n\n<pre><code> .HTMLBody = \"&lt;HTML&gt;&lt;H2&gt;The body of this message will appear in HTML.&lt;/H2&gt;&lt;BODY&gt;Type the message text here. &lt;/BODY&gt;&lt;/HTML&gt;\" \n</code></pre>\n\n<p>Check this link for complete example: </p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/ff869979(v=office.15).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/office/ff869979(v=office.15).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 2897356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9c29442d852a51a757478b6dfc0d3d?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/2897356/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1421280406, "creation_date": 1421280406, "answer_id": 27954765, "question_id": 27936217, "link": "https://stackoverflow.com/questions/27936217/excel-vba-url-hyperlink-in-richtext-email-body/27954765#27954765", "title": "Excel VBA URL hyperlink in RichText email body", "body": "<p>After Dmitry pointing me in the right direction, I tried the following code:</p>\n\n<p><code>wdDoc.Hyperlinks.Add wdDoc.Range, \"http://www.google.com\", , , \"HERE\"</code> </p>\n\n<p>and it has solved my problem!</p>\n\n<p>I wasn't considering the <code>word.document</code> object when creating the email body, when I should have been. Hope this helps someone else.</p>\n"}], "owner": {"reputation": 51, "user_id": 2897356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9c29442d852a51a757478b6dfc0d3d?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/2897356/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2814, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1421280406, "creation_date": 1421212198, "last_edit_date": 1531161705, "question_id": 27936217, "link": "https://stackoverflow.com/questions/27936217/excel-vba-url-hyperlink-in-richtext-email-body", "title": "Excel VBA URL hyperlink in RichText email body", "body": "<p>Does anyone know how to create a RichText email body, that has a URL bookmark in it?</p>\n\n<p>For example, here is my code:</p>\n\n<pre><code>Sub SendEmailUsingWord()\n\nDim olApp As Outlook.Application\nDim olEmail As Outlook.MailItem\nDim olInsp As Outlook.Inspector\nDim wdDoc As Word.Document\nDim strBody As String\n\n' The body of the message, want to create a hyperlink to (e.g.) http://www.google.com but\n' still display HERE.\n' In HTML it would be &lt;a href=\"http://www.google.com\"&gt;HERE&lt;/a&gt;\n' But I want to achieve this in a Rich Text email\n\nstrBody = \"Please click HERE to be fantastic!\" &amp; vbNewLine\n\nSet olApp = New Outlook.Application\nSet olEmail = olApp.CreateItem(olMailItem)\n\nWith olEmail\n    .BodyFormat = olFormatRichText\n    .Display\n\n    .To = \"someone@someone.com\"\n    .Subject = \"Email Subject\"\n\n    Set olInsp = .GetInspector\n    Set wdDoc = olInsp.WordEditor\n\n    wdDoc.Range.InsertBefore strBody\n    '.send\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Many thanks for your help :)\nDave</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1421206430, "post_id": 27935410, "comment_id": 44268064, "body": "Well yes. But each range should have a header otherwise the first cell will not move during sorting."}, {"owner": {"reputation": 5, "user_id": 4451577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d2ff4635005707d349ee60bbf60440?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond", "link": "https://stackoverflow.com/users/4451577/raymond"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421208975, "post_id": 27935410, "comment_id": 44268651, "body": "Thanks for the reply @L42, it&#39;s good to know it&#39;s possible. Each range has a header in column C (next to the blank B cell) but each header is specific to that range so there&#39;s 400+ headers. Any ideas?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421214508, "post_id": 27935410, "comment_id": 44270024, "body": "So you mean you have 400+ headers and 400+ Range to sort?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421216796, "post_id": 27935410, "comment_id": 44270737, "body": "Record a macro while sorting the first few blocks, then try editing the resulting code. Post back (with code) if you run into problems, and describe exactly what the problem is."}, {"owner": {"reputation": 5, "user_id": 4451577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d2ff4635005707d349ee60bbf60440?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond", "link": "https://stackoverflow.com/users/4451577/raymond"}, "edited": false, "score": 0, "creation_date": 1421294135, "post_id": 27935410, "comment_id": 44307762, "body": "Thank you very much @Jeeped, your code does EXACTLY what I wanted to do. Btw, this code went through about 950 rows in about 15-20 sec which is great as far as I&#39;m concerned. I have a question though, could you please briefly explain this part of your code?"}, {"owner": {"reputation": 5, "user_id": 4451577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d2ff4635005707d349ee60bbf60440?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond", "link": "https://stackoverflow.com/users/4451577/raymond"}, "edited": false, "score": 0, "creation_date": 1421294595, "post_id": 27935410, "comment_id": 44307849, "body": "&#39;rws = .Evaluate(&quot;SMALL(INDEX(ROW(B:B)+SIGN(LEN(B:B))*1E+99, , )&quot; &amp; _                                   &quot;, COUNTBLANK(B$1:B&quot; &amp; fr &amp; &quot;)+1)-1&quot;) - (fr - 1)&#39;"}, {"owner": {"reputation": 5, "user_id": 4451577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d2ff4635005707d349ee60bbf60440?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond", "link": "https://stackoverflow.com/users/4451577/raymond"}, "edited": false, "score": 0, "creation_date": 1421294695, "post_id": 27935410, "comment_id": 44307866, "body": "Please don&#39;t feel obligated to answer, you already answered my original question and I&#39;m grateful for that. If you could provide any insight though I&#39;d really appreciate it. Sorry about posting the code in the incorrect format."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1421221878, "creation_date": 1421221878, "answer_id": 27938109, "question_id": 27935410, "link": "https://stackoverflow.com/questions/27935410/excel-macro-to-sort-multiple-dynamic-ranges/27938109#27938109", "title": "Excel macro to sort multiple dynamic ranges", "body": "<p>If it can be assumed that a blank cell in column B indicates a new section to be sorted and that there will always be at least one row of data to sort, the following should accomplish your goal.</p>\n\n<pre><code>Sub sort_sections()\n    Dim fr As Long, rws As Long, lc As Long\n\n    With ActiveSheet\n        lc = .Cells(1, Columns.Count).End(xlToLeft).Column\n        For fr = 1 To .Cells(Rows.Count, 3).End(xlUp).Row\n            If IsEmpty(.Cells(fr, 2)) Then\n                rws = .Evaluate(\"SMALL(INDEX(ROW(B:B)+SIGN(LEN(B:B))*1E+99, , )\" &amp; _\n                                  \", COUNTBLANK(B$1:B\" &amp; fr &amp; \")+1)-1\") - (fr - 1)\n                With .Cells(fr, 1).Resize(rws, lc)\n                    Debug.Print .Address(0, 0)  'output the section address to the Immediate window\n                    .Cells.Sort Key1:=.Columns(3), Order1:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n                End With\n            End If\n        Next fr\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>That will turn this:</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/OcxJ6.png\" alt=\"Section Sorting\"></p>\n\n<p>... into this,</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/iXIZ9.png\" alt=\"Section Sorting\"></p>\n\n<p>There are a number of ways to collect the extent of the section by looking for the next blank cell in column B. With no sample data provided, I chose a rather complex method that <em>should</em> account for variations in data but it is calculation heavy. Four hundred sections will take a few minutes.</p>\n"}], "owner": {"reputation": 5, "user_id": 4451577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d2ff4635005707d349ee60bbf60440?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond", "link": "https://stackoverflow.com/users/4451577/raymond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1250, "favorite_count": 0, "accepted_answer_id": 27938109, "answer_count": 1, "score": 0, "last_activity_date": 1424227186, "creation_date": 1421206177, "last_edit_date": 1531164843, "question_id": 27935410, "link": "https://stackoverflow.com/questions/27935410/excel-macro-to-sort-multiple-dynamic-ranges", "title": "Excel macro to sort multiple dynamic ranges", "body": "<p>I'm looking for a macro to sort multiple dynamic ranges within the same sheet. Each range is separated from the next by an empty cell in column B. Ideally, I would like the code to go through column B, find the first dynamic range, select/activate all rows (.EntireRow) in that range, sort ascending based on column C, and then go down to the next dynamic range and so on. Is this possible?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421196775, "post_id": 27933927, "comment_id": 44265932, "body": "Which sheet are you referring to in this line?  <code>ElseIf sheet1.Cells(2, 2) &gt; 1 &lt; sheet.Cells(3, 6) Then</code>  ... On the second half?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1421198185, "last_edit_date": 1421198185, "creation_date": 1421197399, "answer_id": 27934259, "question_id": 27933927, "link": "https://stackoverflow.com/questions/27933927/im-working-with-a-button-command-but-cant-see-whats-wrong-with-this-code-usi/27934259#27934259", "title": "I&#39;m Working with a button command, but can&#39;t see what&#39;s wrong with this code using elseif statements", "body": "<p>It would appear that you have a couple of languages confused here. The VBA method of writing the third and fourth comparisons is closer to,</p>\n\n<pre><code>If Sheet1.Cells(2, 2) = Empty Then\n            Sheet3.Cells(3, 3) = \"\"\n            Sheet4.Cells(3, 3) = 0\n'MEC limited\nElseIf Sheet2.Cells(2, 2) = 1 Then\n        Sheet3.Cells(3, 3) = 0\n'MEC aceptable\nElseIf Sheet1.Cells(2, 2) &gt; 1 And Sheet1.Cells(2, 2) &lt; Sheet2.Cells(3, 6) Then\n        Sheet3.Cells(3, 3) = 1\n'MEC Good\nElseIf Sheet1.Cells(2, 2) &gt; 5 And Sheet1.Cells(2, 2) &lt;= Sheet2.Cells(3, 7) Then\n        Sheet3.Cells(3, 3) = 2\nEnd If\n</code></pre>\n\n<p>There is still some priority in these statements. If B2 is 6 then it is greater than 1 and greater than 5. Depending on what is in F3 and G3, the fourth condition may never be reached. Given your example of F3 being 5 it should be OK.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1421198228, "post_id": 27934285, "comment_id": 44266298, "body": "Good catch! I totally missed that typo."}, {"owner": {"reputation": 41, "user_id": 4451394, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36b86c45d85da4bb11f287050550aec6?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/4451394/alan"}, "edited": false, "score": 1, "creation_date": 1421199152, "post_id": 27934285, "comment_id": 44266504, "body": "sorry, its beacause it was in in spanish (instead of sheet is hoja), the typo was when i translated the code, the original code its fine."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421199224, "post_id": 27934285, "comment_id": 44266520, "body": "As if figuring out the code isn&#39;t tricky enough without having to translate to English just to ask the question.  Bless you for that.  Still, which <code>hoja</code> is it?  <code>Hoja1</code> or <code>Hoja2</code>?"}, {"owner": {"reputation": 41, "user_id": 4451394, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36b86c45d85da4bb11f287050550aec6?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/4451394/alan"}, "edited": false, "score": 0, "creation_date": 1421199808, "post_id": 27934285, "comment_id": 44266619, "body": "its Hoja2 and Thank you, for the answer"}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": true, "score": 2, "last_activity_date": 1421198344, "last_edit_date": 1421198344, "creation_date": 1421197604, "answer_id": 27934285, "question_id": 27933927, "link": "https://stackoverflow.com/questions/27933927/im-working-with-a-button-command-but-cant-see-whats-wrong-with-this-code-usi/27934285#27934285", "title": "I&#39;m Working with a button command, but can&#39;t see what&#39;s wrong with this code using elseif statements", "body": "<p>You had a typo in your sheets for 'MEC Aceptable.  <strong><code>sheet.Cells</code></strong>.  Judging by the context, it looks like it should be <code>Sheet2.Cells</code></p>\n\n<pre><code>ElseIf sheet1.Cells(2, 2) &gt; 1 &lt; sheet.Cells(3, 6) Then\n</code></pre>\n\n<p>In addition to that, try using <code>Select Case</code>.  You can use IF statements, but <code>Select Case</code> gets handy when you have many <code>ElseIf</code>s</p>\n\n<pre><code>Select Case (Sheet1.Cells(2, 2).Value)\n\n    Case Is = \"\"\n        Sheet3.Cells(3, 3) = \"\"\n        Sheet4.Cells(3, 3) = 0\n    Case Is = 1\n        Sheet3.Cells(3, 3) = 0\n    Case Is &lt;= Sheet2.Cells(3, 6) 'There was typo in your orig code.. Sheet2?\n        Sheet3.Cells(3, 3) = 1\n    Case Is &lt;= Sheet2.Cells(3, 7)\n        Sheet3.Cells(3, 3) = 2\n\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4451394, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36b86c45d85da4bb11f287050550aec6?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/4451394/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 27934285, "answer_count": 2, "score": 0, "last_activity_date": 1421198813, "creation_date": 1421194928, "last_edit_date": 1531161705, "question_id": 27933927, "link": "https://stackoverflow.com/questions/27933927/im-working-with-a-button-command-but-cant-see-whats-wrong-with-this-code-usi", "title": "I&#39;m Working with a button command, but can&#39;t see what&#39;s wrong with this code using elseif statements", "body": "<p>What this code is supposed to do is that if you have a number in <code>cell 2,2</code> and it's between a range of those if statements, it will give you a number in <code>cell 3,3</code>.  The problem is that it only works on the first 3 statements.  The fourth one doesn't work.  It gives you number 1 instead of number 2.</p>\n\n<p>*note: the program uses more statements but this is just to show that the problem is after the third statement, and sorry for my English. </p>\n\n<pre><code>Cell 3,6= 5\n\nCell 3,7= 10\n\n'MEC\nIf sheet1.Cells(2, 2) = Empty Then\n            sheet3.Cells(3, 3) = \"\"\n            sheet4.Cells(3, 3) = 0\n\n'MEC limited\nElseIf sheet2.Cells(2, 2) = 1 Then\n    sheet3.Cells(3, 3) = 0\n\n'MEC aceptable\nElseIf sheet1.Cells(2, 2) &gt; 1 &lt; sheet.Cells(3, 6) Then\n    sheet3.Cells(3, 3) = 1\n\n'MEC Good\nElseIf sheet1.Cells(2, 2) &gt; 5 &lt;= sheet2.Cells(3, 7) Then\n    sheet3.Cells(3, 3) = 2                 \nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3801128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b07ca050e00478b00e2c49090518da4?s=128&d=identicon&r=PG&f=1", "display_name": "user3801128", "link": "https://stackoverflow.com/users/3801128/user3801128"}, "edited": false, "score": 1, "creation_date": 1421196854, "post_id": 27934075, "comment_id": 44265958, "body": "Thanks allot mate... I am kind new to this language and did not remember the Select Case. And yehh you did well changing as well the function to a sub rotine because in beguining i have that has a function because i was calling it directly in the cell part but them i change because it was not making many sense to me..."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 35, "user_id": 3801128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b07ca050e00478b00e2c49090518da4?s=128&d=identicon&r=PG&f=1", "display_name": "user3801128", "link": "https://stackoverflow.com/users/3801128/user3801128"}, "edited": false, "score": 0, "creation_date": 1421197256, "post_id": 27934075, "comment_id": 44266061, "body": "Glad to help.  The main part though I&#39;m pretty sure is that <code>NextSt = Status</code> needed set."}, {"owner": {"reputation": 35, "user_id": 3801128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b07ca050e00478b00e2c49090518da4?s=128&d=identicon&r=PG&f=1", "display_name": "user3801128", "link": "https://stackoverflow.com/users/3801128/user3801128"}, "edited": false, "score": 0, "creation_date": 1421197967, "post_id": 27934075, "comment_id": 44266236, "body": "Yehh when i was checking the code i was asking my self that... Does all functions will have the hability to have a variable set with there name ? I mean, the function result can be always set like it was a variable ?"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 35, "user_id": 3801128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b07ca050e00478b00e2c49090518da4?s=128&d=identicon&r=PG&f=1", "display_name": "user3801128", "link": "https://stackoverflow.com/users/3801128/user3801128"}, "edited": false, "score": 0, "creation_date": 1421198099, "post_id": 27934075, "comment_id": 44266275, "body": "Yes, typically, you should declare what TYPE of result gets passed back. <code>Function funcName(arg1 As Type) As VariableType</code> The function works just like a function in the worksheet.  You put arguments into it, and it RETURNS something back.  A <code>Sub</code> will perform operations and do things for you, but not return a value.  It can SET variables to values, or set worksheets values, but not pass a result back through calling it.  In essence, the Function becomes a variable in a way."}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": true, "score": 0, "last_activity_date": 1421196088, "creation_date": 1421196088, "answer_id": 27934075, "question_id": 27933908, "link": "https://stackoverflow.com/questions/27933908/variable-function-not-being-change-using-a-second-function-value/27934075#27934075", "title": "variable function not being change using a second function value", "body": "<p>It looks like you aren't passing anything back from the function.  Specifically <code>NextSt</code></p>\n\n<p>Try using <code>Select Case</code> instead of a bunch of <code>IF</code> statements.</p>\n\n<p>Also <code>PiqSt</code> doesn't need to be a function at all.  I'm going to include the code that needs changed.</p>\n\n<pre><code>Sub PiqSt(Piq As String)\n\n    Select Case Piq\n        Case Is = \"A\"\n            PiqA = NextSt(PiqA)\n        Case Is = \"B\"\n            PiqB = NextSt(PiqB)\n        Case Is = \"C\"\n            PiqC = NextSt(PiqC)\n        Case Is = \"D\"\n            PiqD = NextSt(PiqD)\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>This Function had <code>Status</code> being set, but you never set <code>NextSt = Status</code>.  The Function passes a value back in its own name.  So you'd say <code>someVariable = NextSt(string)</code> </p>\n\n<pre><code>Function NextSt(Status As String) As String\n\n    Select Case Status\n        Case Is = \"D\"\n            Status = \"N\"\n        Case Is = \"N\"\n            Status = \"F1\"\n        Case Is = \"F1\"\n            Status = \"F2\"\n        Case Is = \"F2\"\n            Status = \"D\"\n    End Select\n\n    NextSt = Status\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3801128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b07ca050e00478b00e2c49090518da4?s=128&d=identicon&r=PG&f=1", "display_name": "user3801128", "link": "https://stackoverflow.com/users/3801128/user3801128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 27934075, "answer_count": 1, "score": 0, "last_activity_date": 1421196088, "creation_date": 1421194799, "last_edit_date": 1531164843, "question_id": 27933908, "link": "https://stackoverflow.com/questions/27933908/variable-function-not-being-change-using-a-second-function-value", "title": "variable function not being change using a second function value", "body": "<p>Was trying to rotate the PiqA values from</p>\n\n<p>D to N, N to F1, F1 to F2 and F2 back to D.</p>\n\n<p>The idea is to make a work calendar where each day will be D, N, F1 or F2 but for some reason the variables in function <code>PiqSt</code> are not being changed;</p>\n\n<pre><code>Public PiqA As String\nPublic PiqB As String\nPublic PiqC As String\nPublic PiqD As String\n\nSub Calendario()\nCells.Clear\n\nColumns(\"A:AJ\").ColumnWidth = 3.5\nColumns(\"A:AJ\").HorizontalAlignment = xlCenter\nCabecalho\n\nEnd Sub\n\nSub Cabecalho()\nDim MyYear As Variant\nDim MyMonth As Variant\n\n'MyYear = InputBox(\"What year ?\")\n'MyMonth = InputBox(\"What month ?\")\nMyYear = \"2015\"\nMyMonth = \"2\"\nTDaysMonth = Day(DateSerial(MyYear, MyMonth + 1, 1) - 1)\n\nRange(\"A1:AF1\").Merge\nRange(\"A1\").Value = Format(\"1/\" &amp; MyMonth &amp; \"/\" &amp; MyYear, \"mmmm\")\nRange(\"A3\").Value = \"A\"\nRange(\"A4\").Value = \"B\"\nRange(\"A5\").Value = \"C\"\nRange(\"A6\").Value = \"D\"\n\nPiqA = \"D\"\nPiqB = \"F1\"\nPiqC = \"N\"\nPiqD = \"F2\"\n\nFor I = 1 To TDaysMonth\n    Cells(2, I + 1).Value = I\n    Cells(7, I + 1).Value = Left(Format(I &amp; \"/\" &amp; MyMonth &amp; \"/\" &amp; MyYear, \"dddd\"), 1)\n\n    Cells(3, I + 1).Value = PiqA\n    PiqSt (\"A\")\n    'Cells(4, I + 1).Value = PiqB\n    'Cells(5, I + 1).Value = PiqC\n    'Cells(6, I + 1).Value = PiqD\nNext I\n\nEnd Sub\n\nFunction PiqSt(Piq)\nIf Piq = \"A\" Then\n    PiqA = NextSt(PiqA)\nElseIf Piq = \"B\" Then\n    PiqB = NextSt(PiqB)\nElseIf Piq = \"C\" Then\n    PiqC = NextSt(PiqC)\nElseIf Piq = \"D\" Then\n    PiqD = NextSt(PiqD)\nEnd If\nEnd Function\n\nFunction NextSt(Status)\nIf Status = \"D\" Then\n    Status = \"N\"\nElseIf Status = \"N\" Then\n    Status = \"F1\"\nElseIf Status = \"F1\" Then\n    Status = \"F2\"\nElseIf Status = \"F2\" Then\n    Status = \"D\"\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1421195310, "post_id": 27933888, "comment_id": 44265553, "body": "This question appears to be off-topic because it is just a programming &quot;spec&quot;, with no real evidence that you have done any significant research into the topic or have made any effort to solve it yourself. Please <a href=\"https://stackoverflow.com/posts/27933888/edit\">edit</a> your question to show [1] the topic(s) you have searched for, and/or [2] the things you have tried and why they didn&#39;t work. If &quot;you have no idea where to begin&quot; then please read a book on Access or do some online tutorials and come back when you have an actual question."}, {"owner": {"reputation": 1, "user_id": 1606586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be632b72c13b1dba58142f9d3db2f35b?s=128&d=identicon&r=PG", "display_name": "Andrew Wade", "link": "https://stackoverflow.com/users/1606586/andrew-wade"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1421200030, "post_id": 27933888, "comment_id": 44266671, "body": "So glad i came here for some help...Thanks Gord."}, {"owner": {"reputation": 1, "user_id": 1606586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be632b72c13b1dba58142f9d3db2f35b?s=128&d=identicon&r=PG", "display_name": "Andrew Wade", "link": "https://stackoverflow.com/users/1606586/andrew-wade"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1421200194, "post_id": 27933888, "comment_id": 44266710, "body": "To keep Gord happy, I have made a simple form with a command button that allows me to search my computer for a file. This part works fine. I have made a command button to export the searched file to the specific drive as listed above but cannot seem to get it to export the file. I am unsure of how to write the code to get the searched file to export to the specific drive."}, {"owner": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 0, "creation_date": 1421206854, "post_id": 27933888, "comment_id": 44268170, "body": "I&#39;ve been using Getz/Litwin/Gilbert&#39;s code for this purpose, and I intended to post an answer accordingly, but unfortunately I&#39;m pretty sure it&#39;s not OK to post on the web; it&#39;s also pretty awfully long. Dig up a copy of their Access Developer&#39;s Handbook maybe."}, {"owner": {"reputation": 1, "user_id": 1606586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be632b72c13b1dba58142f9d3db2f35b?s=128&d=identicon&r=PG", "display_name": "Andrew Wade", "link": "https://stackoverflow.com/users/1606586/andrew-wade"}, "edited": false, "score": 0, "creation_date": 1421222410, "post_id": 27933888, "comment_id": 44272832, "body": "Thanks Nathan Ill do some searching for their Handbook. I have been searching everywhere to find something. Hopefully i can find their code on the web somewhere."}, {"owner": {"reputation": 1, "user_id": 1606586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be632b72c13b1dba58142f9d3db2f35b?s=128&d=identicon&r=PG", "display_name": "Andrew Wade", "link": "https://stackoverflow.com/users/1606586/andrew-wade"}, "edited": false, "score": 0, "creation_date": 1421222817, "post_id": 27933888, "comment_id": 44272996, "body": "The main problem i have Nathan is that i have very little knowledge in writing and understanding code. Im really new to all of this."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "reply_to_user": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 1, "creation_date": 1421223226, "post_id": 27933888, "comment_id": 44273153, "body": "Hi Andrew, I don&#39;t have a full answer for you as Gord makes a point, this question doesn&#39;t have a specific, answerable problem we can solve. However if you&#39;ve got a bit of a handle on VBA then <a href=\"http://support.microsoft.com/kb/824272\" rel=\"nofollow noreferrer\">this page</a> explains how to display and use the standard File Dialog in Access and you can hopefully use it to make a start on your own attempt. As another aside when you&#39;re responding to someone&#39;s comment they won&#39;t be notified unless you include <code>@[name]</code> in your own comment, e.g. to get @NathanTuggy &#39;s attention."}, {"owner": {"reputation": 1, "user_id": 1606586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be632b72c13b1dba58142f9d3db2f35b?s=128&d=identicon&r=PG", "display_name": "Andrew Wade", "link": "https://stackoverflow.com/users/1606586/andrew-wade"}, "reply_to_user": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1421237032, "post_id": 27933888, "comment_id": 44280550, "body": "Thanks @Aiken. I have very little understanding of VBA, and I&#39;m after either a code, or be pointed in the direction of a code that will make my export button send the file to the specified drive directory. I have tried numerous times to rewrite the code I have to get it to send the file, with no success."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1421238640, "post_id": 27933888, "comment_id": 44281400, "body": "It would help potential answerers a lot if you edited your question to include what you&#39;ve tried so far (as in the code), what you expect it to do, what it actually does and any errors that occur. See <a href=\"http://stackoverflow.com/help/mcve\">this page</a> for more guidelines on what sort of code to include"}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1421246415, "creation_date": 1421246415, "answer_id": 27945503, "question_id": 27933888, "link": "https://stackoverflow.com/questions/27933888/using-standard-file-dialogs-within-access/27945503#27945503", "title": "Using standard file dialogs within Access", "body": "<p>What you really want to do is <strong>copy</strong> a file from your local drive to a network drive, not <strong>export</strong> it.  In order to do that, add this to your code:</p>\n\n<pre><code>Dim fso As Object\nSet fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n</code></pre>\n\n<p>Then you could use </p>\n\n<pre><code>fso.CopyFile(source, destination[, overwrite] )\n</code></pre>\n\n<p>You should be able to capture both the source and the destination from the Standard Dialogue forms.</p>\n"}], "owner": {"reputation": 1, "user_id": 1606586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be632b72c13b1dba58142f9d3db2f35b?s=128&d=identicon&r=PG", "display_name": "Andrew Wade", "link": "https://stackoverflow.com/users/1606586/andrew-wade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1421273721, "creation_date": 1421194674, "last_edit_date": 1421210008, "question_id": 27933888, "link": "https://stackoverflow.com/questions/27933888/using-standard-file-dialogs-within-access", "title": "Using standard file dialogs within Access", "body": "<p>I am trying to make a browse / export button in Access 2003. What I need is a command button that will allow me to browse for any file located on the computer using the standard file open dialog. Once the file has been located, I need a button to export that file to a specific location on a drive (<code>S:\\eDNA\\admin\\eDNA\\Engine Data</code>).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6123, "user_id": 2670182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MzRYh.jpg?s=128&g=1", "display_name": "Cool Blue", "link": "https://stackoverflow.com/users/2670182/cool-blue"}, "edited": false, "score": 0, "creation_date": 1421193484, "post_id": 27933595, "comment_id": 44265037, "body": "Is the code in a normal module or a worksheet module? Also, what happens if you do it manually in the exact same place?"}, {"owner": {"reputation": 43, "user_id": 2445620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a7d0bd4ec353224f26fa02380a1c55?s=128&d=identicon&r=PG", "display_name": "Ian Gough", "link": "https://stackoverflow.com/users/2445620/ian-gough"}, "reply_to_user": {"reputation": 6123, "user_id": 2670182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MzRYh.jpg?s=128&g=1", "display_name": "Cool Blue", "link": "https://stackoverflow.com/users/2670182/cool-blue"}, "edited": false, "score": 0, "creation_date": 1421310553, "post_id": 27933595, "comment_id": 44312453, "body": "The code is in a normal module and it works with absolutely no problems at all when its done manually."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2445620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a7d0bd4ec353224f26fa02380a1c55?s=128&d=identicon&r=PG", "display_name": "Ian Gough", "link": "https://stackoverflow.com/users/2445620/ian-gough"}, "edited": false, "score": 0, "creation_date": 1421310617, "post_id": 27933921, "comment_id": 44312477, "body": "Sadly it didn&#39;t work, it gave the exact same error message. I will have a look at removing the select statements. Thanks for your effort though."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 43, "user_id": 2445620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a7d0bd4ec353224f26fa02380a1c55?s=128&d=identicon&r=PG", "display_name": "Ian Gough", "link": "https://stackoverflow.com/users/2445620/ian-gough"}, "edited": false, "score": 0, "creation_date": 1421310976, "post_id": 27933921, "comment_id": 44312662, "body": "Try taking out the sheet protection for a pass to narrow down the cause"}, {"owner": {"reputation": 43, "user_id": 2445620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a7d0bd4ec353224f26fa02380a1c55?s=128&d=identicon&r=PG", "display_name": "Ian Gough", "link": "https://stackoverflow.com/users/2445620/ian-gough"}, "edited": false, "score": 0, "creation_date": 1421312013, "post_id": 27933921, "comment_id": 44313124, "body": "That didn&#39;t work either,i have also tried turning off the data validations and freeze panes on the sheet in question to see if they carry any quirks but no joy so far."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 43, "user_id": 2445620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a7d0bd4ec353224f26fa02380a1c55?s=128&d=identicon&r=PG", "display_name": "Ian Gough", "link": "https://stackoverflow.com/users/2445620/ian-gough"}, "edited": false, "score": 0, "creation_date": 1421312138, "post_id": 27933921, "comment_id": 44313184, "body": "This might sound strange, but you could try copying all the data on the sheet to a new sheet, rename it to the name you are using and try again"}, {"owner": {"reputation": 43, "user_id": 2445620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a7d0bd4ec353224f26fa02380a1c55?s=128&d=identicon&r=PG", "display_name": "Ian Gough", "link": "https://stackoverflow.com/users/2445620/ian-gough"}, "edited": false, "score": 0, "creation_date": 1421314373, "post_id": 27933921, "comment_id": 44314309, "body": "No joy unfortunatley, i even cut the code down to just 3 lines and it worked the first time then crashed   ActiveCell.Rows(&quot;1:1&quot;).EntireRow.Select             Selection.Copy             Selection.Insert Shift:=xlDown"}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": false, "score": 2, "last_activity_date": 1421194890, "last_edit_date": 1495542683, "creation_date": 1421194890, "answer_id": 27933921, "question_id": 27933595, "link": "https://stackoverflow.com/questions/27933595/excel-automation-error-when-inserting-a-row/27933921#27933921", "title": "Excel Automation error when inserting a row", "body": "<p>Try this:  Using <code>With ActiveSheet</code></p>\n\n<pre><code>Sub Staffing_AddRow()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    ActiveCell.Select\n\n    'CHANGES BEGIN HERE\n    With ActiveSheet\n        If .Cells(ActiveCell.row, 223).Value = \"Y\" Then\n            ActiveSheet.Unprotect Password:=\"PasswordGoesHere\"\n            '------------------------------------\n            ActiveCell.Rows(\"1:1\").EntireRow.Select\n            Selection.Copy\n            Selection.Insert Shift:=xlDown\n            '------------------------------------\n            .Cells(ActiveCell.row, 13).Select\n            ActiveSheet.Protect Password:=\"PasswordGoesHere\"\n        Else\n            If Response = MsgBox(\"You can't insert a row here!\", _\n                vbCritical, \"Warning\") Then\n            .Cells(ActiveCell.row, 13).Select\n            End If\n            .Cells(ActiveCell.row, 13).Select\n        End If\n        Application.ScreenUpdating = True\n        Application.Calculation = xlCalculationAutomatic\n    End With\nEnd Sub\n</code></pre>\n\n<p>See also: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using select statements in macros</a></p>\n"}], "owner": {"reputation": 43, "user_id": 2445620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a7d0bd4ec353224f26fa02380a1c55?s=128&d=identicon&r=PG", "display_name": "Ian Gough", "link": "https://stackoverflow.com/users/2445620/ian-gough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1421194890, "creation_date": 1421192732, "last_edit_date": 1421193270, "question_id": 27933595, "link": "https://stackoverflow.com/questions/27933595/excel-automation-error-when-inserting-a-row", "title": "Excel Automation error when inserting a row", "body": "<p>I have a big problem and its driving me insane. I have a very simple piece of code that is supposed to copy a row and add it in below the active row plus a validation at the start of the code to check that you are allowed to add the row on that particular line. </p>\n\n<p>The macro works perfectly when you first go in to the sheet. However, as soon as i enter anything in on any of the cells on the sheet the code bombs out with an automation error. Please say someone has found this before and has a fix for it?</p>\n\n<p>The line it doesn't like is as shown here.  <code>Selection.Insert Shift:=xlDown</code></p>\n\n<pre><code>Sub Staffing_AddRow()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    ActiveCell.Select\n    Cells(ActiveCell.Row, 223).Select\n    If ActiveCell.Value = \"Y\" Then\n        ActiveSheet.Unprotect Password:=\"PasswordGoesHere\"\n        '------------------------------------\n        ActiveCell.Rows(\"1:1\").EntireRow.Select\n        Selection.Copy\n        Selection.Insert Shift:=xlDown\n        '------------------------------------\n        Cells(ActiveCell.Row, 13).Select\n        ActiveSheet.Protect Password:=\"PasswordGoesHere\"\n    Else\n        If Response = MsgBox(\"You can't insert a row here!\", _\n            vbCritical, \"Warning\") Then\n        Cells(ActiveCell.Row, 13).Select\n        End If\n        Cells(ActiveCell.Row, 13).Select\n    End If\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>when it tries to paste that specific row in the worksheet I get <code>Run-time error '-2147417848 (80010108)': Automation error the object invoked has disconnected from its clients</code>. </p>\n"}, {"tags": ["excel", "ms-word", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421215373, "post_id": 27933318, "comment_id": 44270259, "body": "<code>wdPrintRangeOfPages</code> is a constant defined in the Word object library - Excel does not know what it is.  either add a reference to the Word library, or substitute the actual value."}, {"owner": {"reputation": 15, "user_id": 3698448, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d44ac7bf42804575d7130b6a800270c?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath", "link": "https://stackoverflow.com/users/3698448/bharath"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421215809, "post_id": 27933318, "comment_id": 44270407, "body": "I am a learner,i dont know how to code, can you suggest exact code"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421215884, "post_id": 27933318, "comment_id": 44270429, "body": "Put <code>4</code> in place of <code>wdPrintRangeOfPages</code>"}, {"owner": {"reputation": 15, "user_id": 3698448, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d44ac7bf42804575d7130b6a800270c?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath", "link": "https://stackoverflow.com/users/3698448/bharath"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421216440, "post_id": 27933318, "comment_id": 44270611, "body": "Now i am getting type mismatch error"}, {"owner": {"reputation": 15, "user_id": 3698448, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d44ac7bf42804575d7130b6a800270c?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath", "link": "https://stackoverflow.com/users/3698448/bharath"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421216769, "post_id": 27933318, "comment_id": 44270728, "body": "Yes on same line Tim"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421216858, "post_id": 27933318, "comment_id": 44270761, "body": "What&#39;s the value of <code>intpage</code> when it fails?  Don&#39;t have a printer here, so I can&#39;t test your code."}, {"owner": {"reputation": 15, "user_id": 3698448, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d44ac7bf42804575d7130b6a800270c?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath", "link": "https://stackoverflow.com/users/3698448/bharath"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421300412, "post_id": 27933318, "comment_id": 44309142, "body": "I am checking with 2"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1421301587, "creation_date": 1421301587, "answer_id": 27957576, "question_id": 27933318, "link": "https://stackoverflow.com/questions/27933318/runtime-error-5148-to-print-selected-page-from-code/27957576#27957576", "title": "Runtime Error 5148 - To print selected page from code", "body": "<p>Try this:</p>\n\n<pre><code>objWord.PrintOut Range:=4, Pages:=CStr(intpage) '4=wdPrintRangeOfPages\n</code></pre>\n\n<p>Note: <code>PrintOut</code> also has a <code>Copies</code> parameter which you could use instead of looping.</p>\n"}], "owner": {"reputation": 15, "user_id": 3698448, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d44ac7bf42804575d7130b6a800270c?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath", "link": "https://stackoverflow.com/users/3698448/bharath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 27957576, "answer_count": 1, "score": 0, "last_activity_date": 1424826924, "creation_date": 1421191312, "last_edit_date": 1531164843, "question_id": 27933318, "link": "https://stackoverflow.com/questions/27933318/runtime-error-5148-to-print-selected-page-from-code", "title": "Runtime Error 5148 - To print selected page from code", "body": "<p>I am trying to print word document selected page from excel VBA, The page number will be get from input msg box. I am getting Runtime ERROR 5148.</p>\n\n<p>Kindly help me in this.</p>\n\n<pre><code>Dim directory As String, fileName As String, ans As String, i As Integer\nDim objWord As Object\nDim intpage As Integer, intcopies As Integer\n\nSet objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = True\n\n' path to the folder\ndirectory = \"E:\\print\\\"\nfileName = Dir(directory &amp; \"*.doc*\") ' Open Multiple Word Docs Both .doc and .docx\nDo While fileName &lt;&gt; \"\"\n    objWord.Documents.Open (directory &amp; fileName)\n\n    On Error Resume Next\n    intpage = CInt(InputBox(\"Which page to print?\"))\n    intcopies = CInt(InputBox(\"How many copies?\"))\n    On Error GoTo 0\n\n    If intpage * intcopies &lt;&gt; 0 Then\n       For i = 1 To intcopies ' Loop to print next page of uer Choice Note: simplex is not working in my Office, Default Duplex\n\n       '### HERE IS THE PROBLEM###\n        objWord.PrintOut Range:=wdPrintRangeOfPages, Pages:=intpage\n\n        Next\n    Else\n        MsgBox \"sorry, wrong page or copies, try again\"\n    End If\n        'Next\n    objWord.Documents.Close\n        'set file to next in Dir\n    fileName = Dir()\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "batch-file", "cmd"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421189489, "post_id": 27932948, "comment_id": 44263586, "body": "I&#39;m wondering perhaps is this a permission issue with Excel/CMD.exe..."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1421189738, "post_id": 27932948, "comment_id": 44263689, "body": "Why is this whole process necessary? Why do you dynamically need to create a VBScript file? Why not just convert this VBScript code to Excel VBA and run it directly?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1421189982, "post_id": 27932948, "comment_id": 44263785, "body": "I could run the VBS code directly from Excel I guess, but I don&#39;t think it will solve the issue (I will try just in case and report back) - however - I&#39;m using this code to download/register the mscomct2.ocx file on a Win7 machine if it doesn&#39;t exist (DatePicker control doesn&#39;t work on Win7 unless this file is installed) I can prompt the user to run the script manually instead, but I&#39;d still like to know what the issue it with calling in from VBA"}, {"owner": {"reputation": 4671, "user_id": 2844742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/GRfAv.gif?s=128&g=1", "display_name": "unclemeat", "link": "https://stackoverflow.com/users/2844742/unclemeat"}, "edited": false, "score": 0, "creation_date": 1421191281, "post_id": 27932948, "comment_id": 44264283, "body": "A bit of an off topic tip - the <code>if</code> command has in built handling of error levels. So you can format your command like so: <code>IF NOT ERRORLEVEL 0 ...</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 4671, "user_id": 2844742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/GRfAv.gif?s=128&g=1", "display_name": "unclemeat", "link": "https://stackoverflow.com/users/2844742/unclemeat"}, "edited": false, "score": 0, "creation_date": 1421191693, "post_id": 27932948, "comment_id": 44264438, "body": "@unclemeat I actually copied the script from <a href=\"https://sites.google.com/site/eneerge/home/BatchGotAdmin\" rel=\"nofollow noreferrer\">sites.google.com/site/eneerge/home/BatchGotAdmin</a> - Point noted though for future reference so cheers."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1421191929, "post_id": 27932948, "comment_id": 44264535, "body": "You don&#39;t need to run the VBS from Excel. You can convert the VBS to Excel VBA (it&#39;s not hard) and just run the VBA from Excel. The simpler your system the less likely it is to break. I would be concerned about hard coding administrator logins into your code though."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1421192073, "post_id": 27932948, "comment_id": 44264577, "body": "So the root cause is you want to &quot;download/register the mscomct2.ocx file on a Win7 machine if it doesn&#39;t exist&quot;, and you need to do this as an administrator?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421192077, "post_id": 27932948, "comment_id": 44264579, "body": "I know I can write the VBS in VBA, the batch code is actually copied from elsewhere I didn&#39;t write that bit in but in the process of taking it out anyway. I don&#39;t have any logins hardcoded though...?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421192134, "post_id": 27932948, "comment_id": 44264602, "body": "^^ correctomondo, but preferably without user interaction, other than to press OK on the UAC prompt. Like I said, all works fine unless the batch file is called from VBA"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1421195380, "post_id": 27932948, "comment_id": 44265568, "body": "Consider using <b>RunAs</b>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1421196245, "post_id": 27932948, "comment_id": 44265795, "body": "@Gary&#39;sStudent Thanks for the suggestion, currently trying that out - however it seems no matter which way I tackle this, the batch file doesn&#39;t have access to any system directories when called from Excel, even with the ShellExecute/RunAs method. If I run the batch file manually it&#39;s fine. I may take a different approach to this problem altogether..."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1421196364, "post_id": 27932948, "comment_id": 44265828, "body": "@SO Good luck! Please update this post if you discover a solution."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1421197236, "post_id": 27932948, "comment_id": 44266055, "body": "@Gary&#39;sStudent Thank you, and of course I will update this post with any findings!"}], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1921, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1450868086, "creation_date": 1421189390, "last_edit_date": 1531164843, "question_id": 27932948, "link": "https://stackoverflow.com/questions/27932948/running-batch-file-from-excel-vba", "title": "Running batch file from Excel VBA", "body": "<p>I have a batch file (Windows command line) that creates a VBS file, runs it, and that in turn re-launches the cmd.exe program in elevated mode so that I can copy a file to the System32 folder.</p>\n\n<p>If I run this batch file manually, all goes according to plan, but if I run it from a VBA Excel macro the batch file gets stuck in an infinite loop, even after the UAC prompt has appeared and I have allowed elevated access. Am I calling the batch file incorrectly from VBA?</p>\n\n<p>I'm fine with VBA, OKish with windows CMD, but haven't often used the two together.</p>\n\n<p>I've tried the following statements in my macro, all 3 have the same result:</p>\n\n<pre><code>Shell Environ(\"USERPROFILE\") &amp; \"\\Desktop\\TEMP.bat\"\n\nCreateObject(\"WScript.Shell\").Run \"CMD /C %USERPROFILE%\\Desktop\\TEMP.bat\", 0, False\n\nDebug.Print CreateObject(\"WScript.Shell\").Exec(\"CMD /C %USERPROFILE%\\Desktop\\TEMP.bat\").StdOut.ReadAll\n</code></pre>\n\n<p>For what it's worth, this is the Batch file code:</p>\n\n<hr>\n\n<pre class=\"lang-cmd prettyprint-override\"><code>@ECHO OFF\n:----------------------\n&gt;NUL 2&gt;&amp;1 \"%SYSTEMROOT%\\system32\\cacls.exe\" \"%SYSTEMROOT%\\system32\\config\\system\"\nIF '%ERRORLEVEL%' NEQ '0' (\nGOTO UACPrompt\n) ELSE ( GOTO gotAdmin )\n\n:UACPrompt\nECHO Set UAC = CreateObject^(\"Shell.Application\"^) &gt; \"%TEMP%\\getadmin.vbs\"\nECHO UAC.ShellExecute \"%~s0\", \"\", \"\", \"runas\", 1 &gt;&gt; \"%TEMP%\\getadmin.vbs\"\n\n\"%TEMP%\\getadmin.vbs\"\n\nEXIT /B\n:gotAdmin\n\nIF EXIST \"%temp%\\getadmin.vbs\" ( DEL \"%TEMP%\\getadmin.vbs\" )\nPUSHD \"%CD%\"\nCD /D \"%~dp0\"\n:----------------------\n\n:: &lt; REST OF SCRIPT HERE - NOT RELEVANT TO QUESTION &gt;\n</code></pre>\n\n<hr>\n\n<p>And this is what's in the VBS file:<br>\n</p>\n\n<pre><code>Set UAC = CreateObject(\"Shell.Application\") \nUAC.ShellExecute \"C:\\Users\\SO\\Desktop\\TEMP.bat\", \"\", \"\", \"runas\", 1 \n</code></pre>\n\n<p>Any pointers/suggestions welcome. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4407043, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-FKQ5_AtuS2Y/AAAAAAAAAAI/AAAAAAAAAGw/Gxv2SabGAjQ/photo.jpg?sz=128", "display_name": "Vaibhav Dhore", "link": "https://stackoverflow.com/users/4407043/vaibhav-dhore"}, "edited": false, "score": 0, "creation_date": 1421192621, "post_id": 27933276, "comment_id": 44264752, "body": "Thanks L42, actually I am very poor in excel programming. Can you give me some link where I can go step by step in executing above code."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 59, "user_id": 4407043, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-FKQ5_AtuS2Y/AAAAAAAAAAI/AAAAAAAAAGw/Gxv2SabGAjQ/photo.jpg?sz=128", "display_name": "Vaibhav Dhore", "link": "https://stackoverflow.com/users/4407043/vaibhav-dhore"}, "edited": false, "score": 0, "creation_date": 1421192839, "post_id": 27933276, "comment_id": 44264818, "body": "@VaibhavDhore You can start in <a href=\"http://msdn.microsoft.com/en-us/library/office/ff820991(v=office.15).aspx\" rel=\"nofollow noreferrer\">MSDN</a>. Btw, does above code suit your purpose?"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1421191019, "creation_date": 1421191019, "answer_id": 27933276, "question_id": 27932760, "link": "https://stackoverflow.com/questions/27932760/get-source-table-name-for-slicers/27933276#27933276", "title": "Get source table name for slicers", "body": "<p>Slicers are linked to PivotTables and PivotTables are linked to the source table.<br>\nSo access first the PivotTable and then the table. Something like.</p>\n\n<pre><code>ActiveWorkbook.SlicerCaches(\"Slicer_Measure_1\").PivotTables(\"PivotTable1\").SourceData\n</code></pre>\n\n<p>Or if you don't know which PivotTable(s) is/are linked to it, you can use a loop.</p>\n\n<pre><code>Dim pt As PivotTable\nFor Each pt In ActiveWorkbook.SlicerCaches(\"Slicer_Measure_1\").PivotTables\n    Debug.Print pt.Name, pt.SourceData\nNext\n</code></pre>\n\n<p>This will give you the PivotTable associated with your Slicer and the corresponding Table source. HTH.</p>\n"}], "owner": {"reputation": 59, "user_id": 4407043, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-FKQ5_AtuS2Y/AAAAAAAAAAI/AAAAAAAAAGw/Gxv2SabGAjQ/photo.jpg?sz=128", "display_name": "Vaibhav Dhore", "link": "https://stackoverflow.com/users/4407043/vaibhav-dhore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421191614, "creation_date": 1421188525, "last_edit_date": 1421191614, "question_id": 27932760, "link": "https://stackoverflow.com/questions/27932760/get-source-table-name-for-slicers", "title": "Get source table name for slicers", "body": "<p>I want to find the source table and column name for slicer in excel 2013. I found out that:</p>\n\n<pre><code>ActiveWorkbook.SlicerCaches(\"Slicer_Measure_1\").SourceName\n</code></pre>\n\n<p>will yield the result in VBA, but I am not able to capture it.<br> Can someone please give a sample code for this?</p>\n"}, {"tags": ["vba", "excel", "filter", "powerpivot"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421204678, "post_id": 27932285, "comment_id": 44267729, "body": "Have you tried hardcoding the string you pass on the <code>CurrentPageName</code> to just see if it works?"}, {"owner": {"reputation": 1, "user_id": 4451104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aad85653e95ffc74d9cc10319a10c6d9?s=128&d=identicon&r=PG&f=1", "display_name": "mylegs", "link": "https://stackoverflow.com/users/4451104/mylegs"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421250526, "post_id": 27932285, "comment_id": 44288782, "body": "So, no.  The following isn&#39;t working for company named AAA.          Sub filtercompany()     &#39; Filtercompany         ActiveSheet.PivotTables(&quot;PivotTable1&quot;) _         .PivotFields(&quot;[Company].[Name].[Name]&quot;).ClearAllFilters     ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;[Company&zwnj;&#8203;].[Name].[Name]&quot;) _         .CurrentPageName = &quot;[Company].[Name].&amp;[AAA]&quot; End Sub                                                             Is there an actual way to do this using any type of VBA?  I&#39;ve tried recording a macro, but that isn&#39;t working either.  Is it me or powerpivot?  Or both?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421282340, "post_id": 27932285, "comment_id": 44305067, "body": "Do you actually have that PivotField name? I mean, that string is not a standard format. You should be using the actual PivotField name you got in your PowerPivot."}, {"owner": {"reputation": 1, "user_id": 4451104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aad85653e95ffc74d9cc10319a10c6d9?s=128&d=identicon&r=PG&f=1", "display_name": "mylegs", "link": "https://stackoverflow.com/users/4451104/mylegs"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421339283, "post_id": 27932285, "comment_id": 44329018, "body": "Yes, those are the names of the fields and table in the PowerPivot data model.  I can make this work in a regular pivot table, but PowerPivot is giving me heartburn..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6302157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154744993204068/picture?type=large", "display_name": "Matt Garrison", "link": "https://stackoverflow.com/users/6302157/matt-garrison"}, "edited": false, "score": 0, "creation_date": 1462568321, "post_id": 32135266, "comment_id": 62180173, "body": "I was able to make this work for PowerPivot using the method described by Pierre above, but only once I checked &quot;Select Multiple Items&quot; within the pivot table."}], "tags": [], "owner": {"reputation": 1, "user_id": 5250896, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9cdc2eaa3ed31a2b1f03d08bc1debbc0?s=128&d=identicon&r=PG", "display_name": "Pierre", "link": "https://stackoverflow.com/users/5250896/pierre"}, "is_accepted": false, "score": 0, "last_activity_date": 1440144101, "creation_date": 1440144101, "answer_id": 32135266, "question_id": 27932285, "link": "https://stackoverflow.com/questions/27932285/filter-powerpivot-table-using-a-cell-reference/32135266#32135266", "title": "Filter PowerPivot table using a cell reference", "body": "<p>Check out my string. It Works fine when I gave a projektnumber to i</p>\n\n<pre><code>Dim i As Variant\n\ni = 216722\n\nActiveSheet.PivotTables(\"PiLEverant\u00f6r\").PivotFields( _\n    \"[Tabell2].[Kolumn1].[Kolumn1]\").VisibleItemsList = Array( _\n    \"[Tabell2].[Kolumn1].&amp;[\" &amp; i &amp; \"]\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4451104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aad85653e95ffc74d9cc10319a10c6d9?s=128&d=identicon&r=PG&f=1", "display_name": "mylegs", "link": "https://stackoverflow.com/users/4451104/mylegs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4755, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462568321, "creation_date": 1421186391, "last_edit_date": 1531164843, "question_id": 27932285, "link": "https://stackoverflow.com/questions/27932285/filter-powerpivot-table-using-a-cell-reference", "title": "Filter PowerPivot table using a cell reference", "body": "<p>So I've tried in vain to get the instructions from this <a href=\"https://stackoverflow.com/questions/19126266/how-to-update-powerpivot-pivot-table-filter-via-cell-reference\">post</a> to work with my data.  I keep getting a run-time error 1004.  My goal is to input a company name into cell I1 of the same sheet as the pivot table and then have the pivot table filter by that entry.  Here's my adapted code:</p>\n\n<pre><code>Sub filtercompany()\n    ' Filtercompany\n    Dim FilterValue As String\n    FilterValue = ActiveSheet.Range(\"I1\").Value 'get value for filter\n\n    ActiveSheet.PivotTables(\"PivotTable1\") _\n        .PivotFields(\"[Company].[Name].[Name]\").ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"[Company].[Name].[Name]\") _\n        .CurrentPageName = \"[Company].[Name].&amp;[\" &amp; FilterValue &amp; \"]\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "listbox", "userform"], "comments": [{"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1421178613, "post_id": 27930130, "comment_id": 44257773, "body": "You can refer to the sheet using name as well as index. What are you wanting to get done by getting the string of the selected item? i.e. <code>Msgbox(Worksheets(selectedItemFromList).Name)</code>"}, {"owner": {"reputation": 45, "user_id": 4418424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbe0fc9fb0f6e14823150fba1f1b1f79?s=128&d=identicon&r=PG&f=1", "display_name": "Mark ", "link": "https://stackoverflow.com/users/4418424/mark"}, "reply_to_user": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1421178897, "post_id": 27930130, "comment_id": 44257950, "body": "I thought I could add it to a formula to refer to the worksheet (where xxxxxxxx represents the choice from the listbox):   Cells(1, 1).FormulaR1C1 = &quot;=VLOOKUP(R7C5,&quot; &amp; xxxxxxx &amp; &quot;!R1C1:R65000C8,2,FALSE)&quot; I should mention I am passing the the sheet selected back to the sub in a variable type: string."}, {"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1421179377, "post_id": 27930130, "comment_id": 44258267, "body": "You are building the formula using string. So, I am not sure why would that not work?"}], "answers": [{"comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 2, "creation_date": 1421179987, "post_id": 27930629, "comment_id": 44258642, "body": "yes, I happen to have a sheet named Stan, no big whoop."}, {"owner": {"reputation": 45, "user_id": 4418424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbe0fc9fb0f6e14823150fba1f1b1f79?s=128&d=identicon&r=PG&f=1", "display_name": "Mark ", "link": "https://stackoverflow.com/users/4418424/mark"}, "edited": false, "score": 0, "creation_date": 1421180562, "post_id": 27930629, "comment_id": 44258977, "body": "Thanks so Much.  I have a very similar set up.  Now when I bring back the public variable, in this case &quot;listchoice&quot;.  How can I get VBA to use this as a worksheeet?  At this point the user is wanting to lookup data which is residing on sheets[listchoice]."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 45, "user_id": 4418424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbe0fc9fb0f6e14823150fba1f1b1f79?s=128&d=identicon&r=PG&f=1", "display_name": "Mark ", "link": "https://stackoverflow.com/users/4418424/mark"}, "edited": false, "score": 0, "creation_date": 1421180775, "post_id": 27930629, "comment_id": 44259112, "body": "see the revised answer to get some examples of using the variable in a worksheet declaration to set values. Using <code>Sheets(&quot;sheetName&quot;)</code>, the expected type for a sheet name is a string anyway, so it fits nicely."}, {"owner": {"reputation": 45, "user_id": 4418424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbe0fc9fb0f6e14823150fba1f1b1f79?s=128&d=identicon&r=PG&f=1", "display_name": "Mark ", "link": "https://stackoverflow.com/users/4418424/mark"}, "edited": false, "score": 1, "creation_date": 1421181771, "post_id": 27930629, "comment_id": 44259628, "body": "Thanks so Much.  Now I see my problem was related more to the reference in the formula. Your work validated my idea was in the right direction.  I did not place the .name after the variable in myVlookup."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 45, "user_id": 4418424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbe0fc9fb0f6e14823150fba1f1b1f79?s=128&d=identicon&r=PG&f=1", "display_name": "Mark ", "link": "https://stackoverflow.com/users/4418424/mark"}, "edited": false, "score": 0, "creation_date": 1421181869, "post_id": 27930629, "comment_id": 44259689, "body": "That&#39;s great.  I&#39;m glad to hear you were already headed in that direction.  Just as a tip, check out the Locals Window when debugging, it tells you what type things are and their values as you step through the code.  No insult meant if you already knew about it.  You can see how everything is accessed."}, {"owner": {"reputation": 45, "user_id": 4418424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbe0fc9fb0f6e14823150fba1f1b1f79?s=128&d=identicon&r=PG&f=1", "display_name": "Mark ", "link": "https://stackoverflow.com/users/4418424/mark"}, "edited": false, "score": 1, "creation_date": 1421182532, "post_id": 27930629, "comment_id": 44260052, "body": "No insult taken...Your help was greatly appreciated. I have a lot to learn."}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": true, "score": 3, "last_activity_date": 1421181228, "last_edit_date": 1421181228, "creation_date": 1421179766, "answer_id": 27930629, "question_id": 27930130, "link": "https://stackoverflow.com/questions/27930130/vba-listbox-select-worksheet-by-index/27930629#27930629", "title": "VBA listbox select worksheet by index", "body": "<p>Try this out. </p>\n\n<p>Declare a public variable above the code for the UserForm, making it available throughout your workbook from any module or code.</p>\n\n<pre><code>Public listChoice As String\n</code></pre>\n\n<p>Using your code to get the sheet names for the ListBox rowsource.</p>\n\n<pre><code>Private Sub UserForm_Activate()\n\n    For n = 1 To ActiveWorkbook.Sheets.count\n        With ListBox1\n            .AddItem ActiveWorkbook.Sheets(n).name\n        End With\n    Next n\n\nEnd Sub\n</code></pre>\n\n<p>Including an update event for the ListBox</p>\n\n<pre><code>Private Sub ListBox1_AfterUpdate()\n\n    listChoice = ListBox1.Text\n\nEnd Sub\n</code></pre>\n\n<p>I included a test just to demonstrate that the result is still retained.  You don't need this, it demonstrates the results on the screenshot.  </p>\n\n<pre><code>Private Sub cmdTestChoice_Click()\n\n    MsgBox (\"The choice made on the ListBox was: \" &amp; listChoice)\n\nEnd Sub\n</code></pre>\n\n<p><strong>edit:</strong> To access that sheet later, you can call it using something like this:</p>\n\n<p>Some examples of different ways to access a cell, using .Range, or .Cells, with numbers or letters.</p>\n\n<p>Using lRow &amp; lCol as Long to set row and column numbers.</p>\n\n<pre><code>Sheets(listChoice).Cells(lRow, lCol).Value = TextBox1.Value  'Set cell on sheet from TextBox\nTextBox2.Value = Sheets(listChoice).Range(\"A2\").Value        'Set TextBox From Cell on Sheet\n'Set a cell on another sheet using the selected sheet as a source.\nSheets(\"AnotherSheet\").Cells(lRow, \"D\") = Sheets(listChoice).Range(\"D2\")  \n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/W3GX8.png\" alt=\"Screenshot\"></p>\n"}], "owner": {"reputation": 45, "user_id": 4418424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbe0fc9fb0f6e14823150fba1f1b1f79?s=128&d=identicon&r=PG&f=1", "display_name": "Mark ", "link": "https://stackoverflow.com/users/4418424/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8638, "favorite_count": 0, "accepted_answer_id": 27930629, "answer_count": 1, "score": 3, "last_activity_date": 1461334338, "creation_date": 1421177772, "last_edit_date": 1421180589, "question_id": 27930130, "link": "https://stackoverflow.com/questions/27930130/vba-listbox-select-worksheet-by-index", "title": "VBA listbox select worksheet by index", "body": "<p>I have a form with listbox which dynamically provides a list of the worksheets in the current workbook (code below).  I wish to take the selected Sheet and refer to it in a formula later in the process.  From hours of playing around I cannot seem to accomplish this. I believe I read somewhere that you cannot take the string back to the sub and use it to refer to to an object.  So I thought maybe I can create two listboxes </p>\n\n<ol>\n<li>for sheet name </li>\n<li>for sheet index </li>\n</ol>\n\n<p>that I could pass the index number to and maybe use that in my formula to lookup items from the correct sheet. </p>\n\n<p>For the life of my I cannot seem to find a way to connect the two since the items will always be changing; the code will be ran on multiple workbooks by multiple operators so the layout will most likely change between users. I can easily add the second list box with index #'s but I have a block on how to associate the name which will have meaning to the user and the index which I can pass back to the sub. I realize the \"On click\" procedure for the list box to associate the two but with the dynamic nature of the fields I cannot come up with the logic to put that into code.</p>\n\n<pre><code>For N = 1 To ActiveWorkbook.Sheets.Count\n    With ListBox1\n        .AddItem ActiveWorkbook.Sheets(N).Name\n    End With\nNext N\n</code></pre>\n"}, {"tags": ["vba", "pdf", "printing"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1421181242, "post_id": 27929977, "comment_id": 44259345, "body": "You could always check to see if the file&#39;s extension is <code>.PDF</code> before executing the call to <code>ShellExecute</code>."}], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 3837942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGpZT.jpg?s=128&g=1", "display_name": "bp_", "link": "https://stackoverflow.com/users/3837942/bp"}, "is_accepted": false, "score": 1, "last_activity_date": 1421182349, "creation_date": 1421182349, "answer_id": 27931281, "question_id": 27929977, "link": "https://stackoverflow.com/questions/27929977/check-if-pdf-is-sent-to-printer/27931281#27931281", "title": "Check if PDF is sent to printer", "body": "<p>Lots to read here, and honestly, above my skill set, but it looks to answer your question.  </p>\n\n<p>It may also be as simple as just checking the count in the printer queue. If the previous file was a .PDF, then only print the next file if the queue count is equal to zero.</p>\n\n<p>Printer Queue Count...\n<a href=\"http://visualbasic.happycodings.com/applications-vba/code9.html\" rel=\"nofollow\">http://visualbasic.happycodings.com/applications-vba/code9.html</a></p>\n\n<p>Tons of printer options...\n<a href=\"http://www.merrioncomputing.com/Programming/WatchPrinter.htm\" rel=\"nofollow\">http://www.merrioncomputing.com/Programming/WatchPrinter.htm</a></p>\n"}], "owner": {"reputation": 41, "user_id": 4450652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f820de8002032d89facb13d1b40886f6?s=128&d=identicon&r=PG", "display_name": "guest12102012", "link": "https://stackoverflow.com/users/4450652/guest12102012"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1421182349, "creation_date": 1421177185, "last_edit_date": 1421181173, "question_id": 27929977, "link": "https://stackoverflow.com/questions/27929977/check-if-pdf-is-sent-to-printer", "title": "Check if PDF is sent to printer", "body": "<p>I am currently using ShellExecute to print a PDF using the below code. </p>\n\n<p>The PDF is being printed alongside other (Word) documents. However, I need them to print out in a specific order, which is a problem because the PDFs take longer to be sent. </p>\n\n<blockquote>\n  <p><strong>Is there a way to check if the PDF was sent to the printer before moving on to the next line of code?</strong> </p>\n</blockquote>\n\n<pre><code>Private Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" (ByVal hwnd As Long, _\n  ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, _\n  ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n\nShellExecute Application.hwnd, \"Print\", formPath, 0&amp;, 0&amp;, 0&amp;`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421182347, "post_id": 27929926, "comment_id": 44259945, "body": "Is &quot;time_(n)&quot; in a group of named ranges?"}, {"owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "reply_to_user": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421187250, "post_id": 27929926, "comment_id": 44262616, "body": "Yes. ws.Range(&quot;time_10&quot;) is what lastTime should be set to, if I knew how to pass a variable into the .Range property."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1421189099, "post_id": 27929926, "comment_id": 44263414, "body": "If <code>totalTimes</code> has the value 10 then your code should work provided the named range exists on that sheet."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421190984, "post_id": 27929926, "comment_id": 44264175, "body": "Put a break on line <code>totalTimes = </code> and bring up the Locals window, to see what the value is of totalTimes."}, {"owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1421255186, "post_id": 27929926, "comment_id": 44291900, "body": "It appears that totalTimes was returning 0 instead of 10, like I expected. The named ranges were not on the &quot;ActiveSheet,&quot; but the next sheet over. Thanks for your help @TimWilliams and @peege!"}], "answers": [{"tags": [], "owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "is_accepted": true, "score": 0, "last_activity_date": 1421255273, "creation_date": 1421255273, "answer_id": 27948554, "question_id": 27929926, "link": "https://stackoverflow.com/questions/27929926/possible-to-have-a-variable-inside-a-range-property/27948554#27948554", "title": "Possible to have a variable inside a range property?", "body": "<p>It appears that totalTimes was returning 0 instead of 10, like I expected. The named ranges were not on the \"ActiveSheet,\" but the next sheet over. Thanks for your help @TimWilliams and @peege!</p>\n"}], "owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 27948554, "answer_count": 1, "score": 0, "last_activity_date": 1421255273, "creation_date": 1421177012, "last_edit_date": 1531164843, "question_id": 27929926, "link": "https://stackoverflow.com/questions/27929926/possible-to-have-a-variable-inside-a-range-property", "title": "Possible to have a variable inside a range property?", "body": "<p>Is it possible to pass a variable into the .range property?</p>\n\n<p>I would like the following function to work, but I can't seem to get it to work. My guess is it is something to do with how I'm calling the range property.</p>\n\n<pre><code>function computeNVEndTime()\nDim lastTime As Range\nDim totalTimes As Integer\nDim prod As New ProductionWebObj\ndim ws as WorkSheet\n\nset ws = ActiveSheet\ntotalTimes = prod.FindNumberOfRanges(\"time\")\nSet lastTime = ws.Range(\"time_\" &amp; totalTimes)\n\nIf isEmptyString(lastTime) Then\n    computeNVEndTime = \"\"\nElse: computeNVEndTime = lastTime.Value\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste", "worksheet"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1421175240, "post_id": 27928293, "comment_id": 44255844, "body": "I am unable to reproduce your error. Is there a reason you are using late binding?"}, {"owner": {"reputation": 167, "user_id": 4130393, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f872bf73b709d248b0417042ceafb641?s=128&d=identicon&r=PG&f=1", "display_name": "SaladSnake", "link": "https://stackoverflow.com/users/4130393/saladsnake"}, "edited": false, "score": 0, "creation_date": 1421175244, "post_id": 27928293, "comment_id": 44255853, "body": "Try this and see if it works. <code>CurrentSheet.Cells.CopySpecial</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 6, "last_activity_date": 1421175754, "last_edit_date": 1421175754, "creation_date": 1421175378, "answer_id": 27929444, "question_id": 27928293, "link": "https://stackoverflow.com/questions/27928293/copying-active-sheet-into-another-workbook-copy-method-of-range-class-failed/27929444#27929444", "title": "copying active sheet into another workbook: Copy Method of Range class failed", "body": "<p>A couple of suggestions, this should work (at least it does on my computer, I was able to perfectly replicate your bug):</p>\n\n<p><strong>FIX 1</strong></p>\n\n<p>Don't create a new Excel application, use the same thread; in other words, remove this:</p>\n\n<pre><code>Set oExcel = CreateObject(\"Excel.Application\")\nSet oBook = oExcel.Workbooks.Open(path1)\n</code></pre>\n\n<p>and write this:</p>\n\n<pre><code>Set oBook = Workbooks.Open(path1)\n</code></pre>\n\n<p><strong>FIX 2</strong></p>\n\n<p>You can set your active sheet when you want, but be clear with the reference, use \"ThisWorkbook\" so the compiler will be happy and you don't risk to reference the other sheet (this is always a good practice, never fully trust the default reference if you already know what your expected reference is, like in this case): </p>\n\n<pre><code>Set CurrentSheet = ThisWorkbook.ActiveSheet\n</code></pre>\n\n<p><strong>and a SUGGESTION...</strong></p>\n\n<p>Put an error handler: if the method fails, you will find with a bunch of openend Excel threads (check it out, you will have as many as you have already failed running your code. Here is how I would write the full code (suggestion included): </p>\n\n<pre><code>Public Const path1 As String = \"C:\\yourfile.xlsb\"\nDim oExcel As Object\nDim oBook As Object\nDim oSheet As Object\nDim CurrentSheet As Object\n\nSub copyNpaste()\n\nSet oBook = Workbooks.Open(path1)\nSet oSheet = oBook.Worksheets(\"TARGET\")\nSet CurrentSheet = ThisWorkbook.ActiveSheet\n\nOn Error GoTo ESCAPE 'if the code fails, we go to \"Escape\" and at least we close the file\n\n'Deleting what's on \"TARGET\" first\noSheet.Cells.Delete\n\n'This is where the Error happens.\nCurrentSheet.Cells.Copy _\nDestination:=oSheet.Cells\n\noBook.Save\n\nESCAPE:\n\noBook.Close\n\nSet oExcel = Nothing\nSet oBook = Nothing\nSet oSheet = Nothing\nSet CurrentSheet = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong></p>\n\n<p>Open your Task Manager (Ctrl+Alt+Del) and go to processes... close all the EXCEL.EXE processes you have probably left everytime you have failed running your code, before your laptop explodes :)  </p>\n"}], "owner": {"reputation": 21, "user_id": 4091559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd860764036debf76b8fdad9b98bc7c3?s=128&d=identicon&r=PG&f=1", "display_name": "J Lee", "link": "https://stackoverflow.com/users/4091559/j-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8996, "favorite_count": 0, "accepted_answer_id": 27929444, "answer_count": 1, "score": 1, "last_activity_date": 1562593601, "creation_date": 1421171229, "last_edit_date": 1421766267, "question_id": 27928293, "link": "https://stackoverflow.com/questions/27928293/copying-active-sheet-into-another-workbook-copy-method-of-range-class-failed", "title": "copying active sheet into another workbook: Copy Method of Range class failed", "body": "<p>I want my code to copy the entire worksheet(SOURCE) and paste it into some other worksheet(TARGET) under other workbook(WHERE_I_WANNA_PASTE_IT) and save it. </p>\n\n<p>I am getting this error: </p>\n\n<blockquote>\n  <p>Run=-time error '1004': Copy Method of Range class failed</p>\n</blockquote>\n\n<p>on this line:</p>\n\n<blockquote>\n<pre><code>CurrentSheet.Cells.Copy Destination:=oSheet.cells \n</code></pre>\n</blockquote>\n\n<p>The code:</p>\n\n<pre><code>Public Const path1 As String = \"C:\\Where_I_WANNA_PASTE_IT.xlsb\"\nDim oExcel As Object\nDim oBook As Object\nDim oSheet As Object\nDim CurrentSheet As Object\n\nSub copyNpaste\n\nSet CurrentSheet = ActiveSheet\nSet oExcel = CreateObject(\"Excel.Application\")\nSet oBook = oExcel.Workbooks.Open(path1)\nSet oSheet = oBook.Worksheets(\"TARGET\")\n\n'Deleting what's on \"TARGET\" first\noSheet.cells.delete\n\n'This is where the Error happens.\nCurrentSheet.Cells.Copy _\nDestination:=oSheet.Cells\n\noBook.Save\noBook.Close\n\nSet oExcel = Nothing\nSet oBook = Nothing\nSet oSheet = Nothing\nSet CurrentSheet = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 3, "creation_date": 1421171130, "post_id": 27928240, "comment_id": 44253510, "body": "If you can do it manually, try using the macro recorder. Then come back when you have a specific question on the code that you have."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1421172120, "post_id": 27928240, "comment_id": 44254079, "body": "Revise your question to include some of your specifics, like sheet names and specific ranges. Definitely take @TheEngineer up on recording a macro, for a chunk of it, preferably if it&#39;s something you repeat, one full iteration of it. Then there&#39;s a frame of reference.  Otherwise all anyone can do is guess what you want to happen."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421174692, "post_id": 27928240, "comment_id": 44255550, "body": "Welcome to Stack Overflow.  Just so you understand my text isn&#39;t meant to be harsh.  I&#39;m just trying to help you get what you need, and learn from it in the process, while still fitting into the site&#39;s guidelines.  <a href=\"http://stackoverflow.com/help/how-to-ask\">See some examples here:</a>"}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1421228861, "post_id": 27928240, "comment_id": 44276025, "body": "If you have tried using the ActiveWorkbook.WorkSheet identifier, that implies to me you have already tried some code. Please can you provide the code you have tried? It doesn&#39;t matter that it didn&#39;t work (after all, you wouldn&#39;t be here if it did), it will give us a better idea what you are trying to do."}], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 2, "creation_date": 1421172918, "post_id": 27928499, "comment_id": 44254516, "body": "<i>&quot;I was going to suggest the same thing @TheEngineer did because your question sounded too general&quot;</i> Then it probably is too broad and should be voted down and flagged, not answered..."}, {"owner": {"reputation": 1290, "user_id": 757395, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/13974f1875a428326adea5f9121a136c?s=128&d=identicon&r=PG", "display_name": "stifin", "link": "https://stackoverflow.com/users/757395/stifin"}, "edited": false, "score": 0, "creation_date": 1421173168, "post_id": 27928499, "comment_id": 44254665, "body": "Well, I believe we should answer if we can help. Everyone said he should just Macro Recorder. However, the question is &quot;Excel macro to pull from unnamed worksheets&quot; and further clarified by &quot;I&#39;ve tried using the activeworkbook.worksheet identifier but am stuck&quot;. This clearly tells that he was having trouble with general references to the sheets in his active workbook. These specifics were clouded by all the other information he provided, which I realised after reading more carefully."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421256411, "post_id": 27928499, "comment_id": 44292665, "body": "Nice work.  That&#39;s as complete of an answer as a question such as this can get."}], "tags": [], "owner": {"reputation": 1290, "user_id": 757395, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/13974f1875a428326adea5f9121a136c?s=128&d=identicon&r=PG", "display_name": "stifin", "link": "https://stackoverflow.com/users/757395/stifin"}, "is_accepted": false, "score": 1, "last_activity_date": 1421229250, "last_edit_date": 1421229250, "creation_date": 1421172070, "answer_id": 27928499, "question_id": 27928240, "link": "https://stackoverflow.com/questions/27928240/macro-to-pull-data-from-unnamed-worksheets/27928499#27928499", "title": "Macro to pull data from unnamed worksheets", "body": "<p>I was going to suggest the same thing @TheEngineer did because your question sounded too general and the only answer seemed to be for someone to code a complete solution for you.</p>\n\n<p>However, reading a little closer, I <em>think</em> what you are asking for is the loop I've given you below.</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n'\n    ' 6 \"working variables\" to temporarily hold the values from each worksheet\n    Dim sCell1 as String\n    Dim sCell2 as String\n    Dim sCell3 as String\n    Dim sCell4 as String\n    Dim sCell5 as String\n    Dim sCell6 as String\n\n    Dim iTargetRowIdx as Integer 'counter to point at next empty row in target sheet\n    iTargetRowIdx = 1 'NOTE: change this if your 1st target row is not 1\n\n    For Each Sheet In ActiveWorkbook.Sheets\n\n        'avoid copying from the target worksheet itself\n        If Sheet.Name &lt;&gt; \"&lt;your target sheet name&gt;\" Then\n\n            'copy value from each of 6 cells to our working variables\n            'INSTRUCTION: replace each pair of \"&lt;row&gt;\" and \"&lt;col&gt;\" with row and column numbers of each of your 6 cells\n            sCell1 = Sheet.Cells(&lt;row&gt;, &lt;col&gt;) ' 1st cell to copy\n            sCell2 = Sheet.Cells(&lt;row&gt;, &lt;col&gt;) ' 2nd cell to copy\n            sCell3 = Sheet.Cells(&lt;row&gt;, &lt;col&gt;) ' 3rd cell to copy\n            sCell4 = Sheet.Cells(&lt;row&gt;, &lt;col&gt;) ' 4th cell to copy\n            sCell5 = Sheet.Cells(&lt;row&gt;, &lt;col&gt;) ' 5th cell to copy\n            sCell6 = Sheet.Cells(&lt;row&gt;, &lt;col&gt;) ' 6th cell to copy\n\n            'NOTE: if you want to see the value of what's in a cell while the macro is running, you can use Debug.Print, which prints to your Immediate Window (the little panel) at the bottom of the VBA editor) e.g.\n            Debug.Print (Sheet.Cells(1, 1))\n            'this prints what is in cell A1\n            'NOTE: Debug.Print is just a debugging tool to help you see what is going on inside your macro - you can safely remove the statement altogether\n        End If\n\n        'then put code here to paste those values to the next row in your target worksheet\n        'assumes you want the 6 values pasted to cols A to F in each new row\n        Worksheets(\"&lt;your target sheet name\").Cells(iTargetRowIdx, 1) = sCell1\n        Worksheets(\"&lt;your target sheet name\").Cells(iTargetRowIdx, 2) = sCell2\n        Worksheets(\"&lt;your target sheet name\").Cells(iTargetRowIdx, 3) = sCell3\n        Worksheets(\"&lt;your target sheet name\").Cells(iTargetRowIdx, 4) = sCell4\n        Worksheets(\"&lt;your target sheet name\").Cells(iTargetRowIdx, 5) = sCell5\n        Worksheets(\"&lt;your target sheet name\").Cells(iTargetRowIdx, 6) = sCell6\n\n        iTargetRowIdx = iTargetRowIdx + 1 'point to next empty row\n    Next Sheet\nEnd Sub\n</code></pre>\n\n<p>This loops through every sheet in your workbook.  Inside the loop, you do all the work you described. You need to edit the code for your specifics.</p>\n\n<p>You didn't say if you want to run one macro for ALL workbooks or if just on one workbook. This macro runs for only one workbook and that is the workbook where you place this macro. You can put this macro in every workbook that you want it to work in OR you can post a separate question about how to run one macro on many workbooks.</p>\n"}], "owner": {"reputation": 1, "user_id": 4450339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871d18b1563dc0b7602feff068dbd877?s=128&d=identicon&r=PG&f=1", "display_name": "Spectroscott", "link": "https://stackoverflow.com/users/4450339/spectroscott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1421229250, "creation_date": 1421171064, "last_edit_date": 1531161705, "question_id": 27928240, "link": "https://stackoverflow.com/questions/27928240/macro-to-pull-data-from-unnamed-worksheets", "title": "Macro to pull data from unnamed worksheets", "body": "<p>Thank you in advance for the help with this question. I have a set of workbooks who have varying numbers of worksheets. On each worksheet, there are 6 cells of information that I need to have compiled onto one master worksheet in that workbook. The 6 cells of information are on the same page of every worksheet. My final output would be a table on one worksheet that has all of the data from the other worksheets in that book. I can do it manually but was hoping that a macro would help. I've tried using the activeworkbook.worksheet identifier but am stuck. Thanks for any help. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1421171721, "creation_date": 1421171721, "answer_id": 27928417, "question_id": 27928234, "link": "https://stackoverflow.com/questions/27928234/autofill-filldown-formulas-with-changing-range/27928417#27928417", "title": "Autofill/FillDown Formulas with Changing Range", "body": "<p>This should do what you are looking for. It will find the first blank column in Row 2, insert the formula there, then copy it down to the last row using column B to check for last used row (since that is the column the <code>VLookUp</code> is looking at:</p>\n\n<pre><code>Sub TesterIt()\n\n  Dim LastRow As Long, StartCell As Range\n\n  Set StartCell = ActiveSheet.Cells(2, Columns.Count).End(xlToLeft).Offset(0, 1)\n  StartCell.Formula = \"=VLOOKUP(B2,Plate.xlsm!$R$3:$S$10,2,FALSE)\"\n  LastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n  Range(StartCell, Cells(LastRow, StartCell.Column)).FillDown\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1421205466, "creation_date": 1421205466, "answer_id": 27935315, "question_id": 27928234, "link": "https://stackoverflow.com/questions/27928234/autofill-filldown-formulas-with-changing-range/27935315#27935315", "title": "Autofill/FillDown Formulas with Changing Range", "body": "<p>Or you can do it directly like this:</p>\n\n<pre><code>With ActiveSheet\n    Dim FirstEmpCol As Long, LastRow As Long\n    FirstEmpCol = .Cells(1, .Columns.Count).End(xlToLeft).Offset(0, 1).Column\n    LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n    .Range(.Cells(2, FirstEmpCol), .Cells(LastRow, FirstEmpCol).Formula = _\n        \"=VLOOKUP(B2,Plate.xlsm!$R$3:$S$10,2,FALSE)\"    \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4450348, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2af1825a86e64ac2423e6a2788a5c04?s=128&d=identicon&r=PG&f=1", "display_name": "Ash_23S", "link": "https://stackoverflow.com/users/4450348/ash-23s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1590, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1421205466, "creation_date": 1421171033, "last_edit_date": 1421171288, "question_id": 27928234, "link": "https://stackoverflow.com/questions/27928234/autofill-filldown-formulas-with-changing-range", "title": "Autofill/FillDown Formulas with Changing Range", "body": "<p>I'm new to VBA and could greatly use some help using the Autofill/Filldown functions.</p>\n\n<p>I'm setting up a macro to incorporate a Vlookup formula in cells of the first empty column of a new worksheet. </p>\n\n<p>This works well for the first cell, but I am having trouble in copying the formula down to all of the cells in spreadsheet (or at least to row 450), using the autofill/filldown functions, as I do not know how to do this without defining the range. I cannot define the range as it will vary each time..</p>\n\n<pre><code>ActiveSheet.Range(\"IV1\").End(xlToLeft).Offset(, 1).Formula = \"=VLOOKUP(B2,Plate.xlsm!$R$3:$S$10,2,FALSE)\"\n</code></pre>\n\n<p>Please help!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8247, "user_id": 1457269, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed84b6b7868b1ca4fd974144875d1330?s=128&d=identicon&r=PG&f=1", "display_name": "ApplePie", "link": "https://stackoverflow.com/users/1457269/applepie"}, "edited": false, "score": 0, "creation_date": 1421172228, "post_id": 27928258, "comment_id": 44254132, "body": "Use caution with UsedRange <a href=\"http://stackoverflow.com/questions/11886284/usedrange-count-counting-wrong\" title=\"usedrange count counting wrong\">stackoverflow.com/questions/11886284/&hellip;</a>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1421171123, "creation_date": 1421171123, "answer_id": 27928258, "question_id": 27928143, "link": "https://stackoverflow.com/questions/27928143/macro-to-copy-a-value-into-another-cell-if-a-criteria-is-met/27928258#27928258", "title": "Macro to copy a value into another cell if a criteria is met", "body": "<p><strong>Without</strong> a macro:</p>\n\n<p>In <strong>B2</strong> enter:</p>\n\n<pre><code>=IF(A2=\"CHEESE\",A2,\"\")\n</code></pre>\n\n<p>and copy down</p>\n\n<p><strong>With</strong> a macro:</p>\n\n<pre><code>Sub Cheesey()\n    For Each r In Intersect(ActiveSheet.UsedRange, Range(\"A:A\"))\n        If r.Text = \"CHEESE\" Then\n            r.Offset(0, 1) = \"CHEESE\"\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 202, "user_id": 4203414, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7fbd998943c689355bc3cfdd03f212bb?s=128&d=identicon&r=PG&f=1", "display_name": "80gm2", "link": "https://stackoverflow.com/users/4203414/80gm2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8405, "favorite_count": 0, "accepted_answer_id": 27928258, "answer_count": 1, "score": 0, "last_activity_date": 1507000903, "creation_date": 1421170743, "last_edit_date": 1531161705, "question_id": 27928143, "link": "https://stackoverflow.com/questions/27928143/macro-to-copy-a-value-into-another-cell-if-a-criteria-is-met", "title": "Macro to copy a value into another cell if a criteria is met", "body": "<p>I need to write a macro that for example, would copy the value from column A where the condition of cheese was met, and then pasted this value into the adjacent cell in the next column. Where would you start with this?</p>\n\n<p><img src=\"https://i.stack.imgur.com/RGd1x.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "ms-word", "lotus-notes", "sendmail", "lotus"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 4, "creation_date": 1421170161, "post_id": 27927680, "comment_id": 44252970, "body": "<a href=\"http://www.fabalou.com/vbandvba/lotusnotesmail.asp\" rel=\"nofollow noreferrer\">This</a> might be a good point to start, please note that Stack Overflow is not a code-writing service but it&#39;s rather to help fixing an already attempted code."}, {"owner": {"reputation": 2628, "user_id": 1207647, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8vPGt.png?s=128&g=1", "display_name": "Karl-Henry Martinsson", "link": "https://stackoverflow.com/users/1207647/karl-henry-martinsson"}, "edited": false, "score": 0, "creation_date": 1421275802, "post_id": 27927680, "comment_id": 44302885, "body": "That code looks (to me) like VBA for Excel..."}], "answers": [{"tags": [], "owner": {"reputation": 2628, "user_id": 1207647, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8vPGt.png?s=128&g=1", "display_name": "Karl-Henry Martinsson", "link": "https://stackoverflow.com/users/1207647/karl-henry-martinsson"}, "is_accepted": false, "score": 0, "last_activity_date": 1421276467, "creation_date": 1421276467, "answer_id": 27954064, "question_id": 27927680, "link": "https://stackoverflow.com/questions/27927680/send-word-doc-as-an-attachment-on-lotus-notes-email/27954064#27954064", "title": "Send Word Doc as an attachment on Lotus Notes Email", "body": "<p>Like with all programming, break down the problem into smaller problems/steps. Then solve one of them at a time. Let's look at your problem and how to handle each one. I will assume that you want to run a VBA macro from within Word, when you have the specific document open.</p>\n\n<p>1) Read the email address(es) from within the Word document. Since you know what the document look like, you have to figure this out on your own. Store the address(es) in an array (of string).</p>\n\n<p>2) Create a PDF of the currently open document. I assume that Word have the same functionality today as OpenOffice, and that you can simply export the document as a PDF file. Should not be difficult to write. Just remember to store the name and path of the PDF you create (you should force the filename when you save it, preferably also put the file in your temp folder) so you can get the file later.</p>\n\n<p>3) Use the Notes backend classes in COM to generate a new email, populate the address field, subject and body, and attach the PDF you created in step 2. You can take a look at a Lotusscript class I wrote to handle mail notifications, perhaps that can help you:</p>\n\n<p><a href=\"http://blog.texasswede.com/lotusscript-mail-notification-class/\" rel=\"nofollow\">http://blog.texasswede.com/lotusscript-mail-notification-class/</a></p>\n\n<p>What you need to remember is that the address fields are multi-value fields. You simply put the addresses in an array and store the array in that field.\nAlso, if you want to send the email from another user than the one currently logged in, you must use the undocumented method of storing the email document in mail.box, instead of using teh Send method of the NotesDocument class.</p>\n"}], "owner": {"reputation": 1, "user_id": 4450230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8318da508272c04259abc2f0c01609c?s=128&d=identicon&r=PG&f=1", "display_name": "Monica", "link": "https://stackoverflow.com/users/4450230/monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1291, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1425672619, "creation_date": 1421169130, "last_edit_date": 1425672619, "question_id": 27927680, "link": "https://stackoverflow.com/questions/27927680/send-word-doc-as-an-attachment-on-lotus-notes-email", "title": "Send Word Doc as an attachment on Lotus Notes Email", "body": "<p>I have a Word Document that contains an email address and I need to send this document to different people using Lotus Notes, which is my default email client and to which I am already connected to. I would also like, if possible, to <strong>send the document as a PDF</strong>.</p>\n\n<p>Please can someone help me write a macro that <em>attaches the document as a PDF</em> and <em>sends it to all email addresses</em> already in the Word document using Lotus Notes.</p>\n\n<p>I have tried to use a piece of code that I found in this forum, but is not getting the email addresses:</p>\n\n<pre><code>Sub Send_mail_recipients()\nDim Text As String\nDim char As String\nDim rowcount, n_address, n_cells, Cell_Crt, CharNo As Integer\nDim Recipient(100) As Variant\n 'With Application.ActiveWindow.Document\n 'Activate the Document\n  'n_address = 0\n Text = \"\"\n  ActiveDocument.Tables(2).Select\n     n_cells = Selection.Cells.Count\n  For Cell_Crt = 1 To n_cells\n If Selection.Cells(Cell_Crt).Range.Text Like \"*@*\" Then\n'Recipient(n_address) = Selection.Cells(Cell_Crt).Range.Text\nText = Text + Selection.Cells(Cell_Crt).Range.Text + \", \"\n'n_address = n_address + 1\nEnd If\n'Text = Selection.Cells(Cell_Crt).Range.Text\nNext\nEnd If\n</code></pre>\n\n<p>In the end I have decided to attach an excel file.\nThe excel file is attached to an email address but I would like to attach this excel file as a PDF. I am not sure how to do it. \nThis is the code am using to attach active excel file to an email</p>\n\n<pre><code>Sub LotusNotesExcelEmail()\n\nDim noSession As Object, noDatabase As Object, noDocument As Object\nDim obAttachment As Object, EmbedObject As Object\nDim stSubject As Variant, stAttachment As String\nDim vaRecipient As Variant, vaMsg As Variant\n\nConst EMBED_ATTACHMENT As Long = 1454\n\n'Retrieve the path and filename of the active workbook.\n stAttachment = ActiveWorkbook.FullName\n\n'Initiate the Lotus Notes COM's Objects.\nSet noSession = CreateObject(\"Notes.NotesSession\")\nSet noDatabase = noSession.GETDATABASE(\"\", \"\")\n\n'If Lotus Notes is not open then open the mail-part of it.\nIf noDatabase.IsOpen = False Then noDatabase.OPENMAIL\n\n'Create the e-mail and the attachment.\nSet noDocument = noDatabase.CreateDocument\nSet obAttachment = noDocument.CreateRichTextItem(\"stAttachment\")\nSet EmbedObject = obAttachment.EmbedObject(EMBED_ATTACHMENT, \"\",  stAttachment)\n\n\n    'Get the name of the recipient from the user.\n    vaRecipient = Worksheets(\"Invitaci\u00f3n_curso\").Range(\"B8\").Value\n\n 'Add values to the created e-mail main properties.\n With noDocument\n.Form = \"Memo\"\n.SendTo = vaRecipient\n.Subject = \"Solicitud Invitaci\u00f3n Curso \"\n.Body = \"Estimado xxxxx. Adjuntamos solicitud de invitaci\u00f3n a curso\u2026\u2026\u2026\u2026\u2026!\"\n .SaveMessageOnSend = True\nEnd With\n\n\n'Send the e-mail.\n\n With noDocument\n.PostedDate = Now()\n.SEND 0, vaRecipient\n End With\n Dim myMessage As String\n myMessage = MsgBox(\"Est\u00e1 seguro de que quiere enviar este correo?\",    vbYesNo, \"Est\u00e1 seguro?\")\n\n If myMessage = vbYes Then\n     With noDocument\n         .PostedDate = Now()\n         .SEND 0, vaRecipient\n     End With\nEnd If\n\n\n'Release objects from the memory.\nSet EmbedObject = Nothing\nSet obAttachment = Nothing\nSet noDocument = Nothing\nSet noDatabase = Nothing\nSet noSession = Nothing\n\n'Activate Excel for the user.\n'AppActivate \"Microsoft Excel\"\n'MsgBox \"El mensaje de correo se ha enviado correctamente\", vbOKOnly\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "com"], "comments": [{"owner": {"reputation": 7399, "user_id": 800524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02839e8311c198171b66b57d1d0cc023?s=128&d=identicon&r=PG", "display_name": "acelent", "link": "https://stackoverflow.com/users/800524/acelent"}, "edited": false, "score": 3, "creation_date": 1421284060, "post_id": 27927333, "comment_id": 44305526, "body": "Have you searched for ways of making a COM  DLL component in Python?  Or a server application?  And setting up InProcServer32 or LocalServer32, CLSID, ProgId, etc? And possibly making a type library so you can inspect your Python objects in VBA?"}], "answers": [{"tags": [], "owner": {"reputation": 217, "user_id": 879882, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/318885c6f19ea4bfbd534cee57fd1551?s=128&d=identicon&r=PG", "display_name": "thebtm", "link": "https://stackoverflow.com/users/879882/thebtm"}, "is_accepted": false, "score": 0, "last_activity_date": 1437418481, "creation_date": 1437418481, "answer_id": 31524209, "question_id": 27927333, "link": "https://stackoverflow.com/questions/27927333/can-i-use-my-python-custom-objects-in-vba/31524209#31524209", "title": "Can I use my python custom objects in VBA?", "body": "<p>The last time I checked, Excel VBA is restricted to a limited set of the .NET Framework. That said, you can still make calls to C# if you want to translate the Python to C#.</p>\n"}], "owner": {"reputation": 51, "user_id": 4099747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34eec5a4485df003615f9bae50f49c6?s=128&d=identicon&r=PG&f=1", "display_name": "TxT", "link": "https://stackoverflow.com/users/4099747/txt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1594078296, "creation_date": 1421167990, "last_edit_date": 1594078296, "question_id": 27927333, "link": "https://stackoverflow.com/questions/27927333/can-i-use-my-python-custom-objects-in-vba", "title": "Can I use my python custom objects in VBA?", "body": "<p>It's clear that there are options to use <strong>python functions</strong> in excel/VBA.(xlwings, Pyxll, DataNitro).</p>\n\n<p>However, I'm looking for ways to use <strong>my python objects</strong> in VBA. In my ideal world, I would be just able to do something like this:</p>\n\n<pre><code>dim car1 as object\ndim car2 as object\ndim road as object\n\nset road = CreateObject(\"MyPythonLib.road\")\nset car1 = CreateObject(\"MyPythonLib.car\")\nset car2 = CreateObject(\"MyPythonLib.car\")\n\nroad.add(car1)\nroad.add(car2)\n</code></pre>\n"}, {"tags": ["vba", "excel", "find", "delete-row"], "comments": [{"owner": {"reputation": 442, "user_id": 3232345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5181b4baa44236d3af02e67ee92b30a6?s=128&d=identicon&r=PG&f=1", "display_name": "Tascalator", "link": "https://stackoverflow.com/users/3232345/tascalator"}, "edited": false, "score": 0, "creation_date": 1421167566, "post_id": 27927042, "comment_id": 44251450, "body": "Im sorry I dont understand how you wrote the question; what does your excel spreadsheet looks like? Are you saying that each row is an entry, but each entries can have any amount of columns? could you add a screenshot.  When you press the button what should happen exactly? Delete rows matching a cell?"}, {"owner": {"reputation": 359, "user_id": 3953007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b181069a8d5c10aa07f12b5ccd2c3c60?s=128&d=identicon&r=PG&f=1", "display_name": "risail", "link": "https://stackoverflow.com/users/3953007/risail"}, "reply_to_user": {"reputation": 442, "user_id": 3232345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5181b4baa44236d3af02e67ee92b30a6?s=128&d=identicon&r=PG&f=1", "display_name": "Tascalator", "link": "https://stackoverflow.com/users/3232345/tascalator"}, "edited": false, "score": 0, "creation_date": 1421167825, "post_id": 27927042, "comment_id": 44251601, "body": "When I hit the button I need it to evaluate Colum A &amp; Column B and delete the Rows with #N/A. Only one column has to have N/A in it for the requirement for the delete to be met.  I use the Spreadsheet as a template so the amount of rows I have varies every time I use the SS."}], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 3953007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b181069a8d5c10aa07f12b5ccd2c3c60?s=128&d=identicon&r=PG&f=1", "display_name": "risail", "link": "https://stackoverflow.com/users/3953007/risail"}, "edited": false, "score": 0, "creation_date": 1421168359, "post_id": 27927250, "comment_id": 44251948, "body": "I get an error Run-Time &#39;13&quot; type mismatch on this line    If Cells(iCntr, 1).Value = &quot;#N/A&quot; Or Cells(iCntr, 2).Value = &quot;#N/A&quot; Then"}, {"owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "reply_to_user": {"reputation": 359, "user_id": 3953007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b181069a8d5c10aa07f12b5ccd2c3c60?s=128&d=identicon&r=PG&f=1", "display_name": "risail", "link": "https://stackoverflow.com/users/3953007/risail"}, "edited": false, "score": 0, "creation_date": 1421168514, "post_id": 27927250, "comment_id": 44252054, "body": "@Dan - I realized after posting you are looking for Excel errors (which are noted as &quot;#NA&quot;). I updated the answer to use the <code>Text</code> property instead of <code>Value</code>. This should resolve the error."}], "tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": true, "score": 6, "last_activity_date": 1421168100, "last_edit_date": 1421168100, "creation_date": 1421167721, "answer_id": 27927250, "question_id": 27927042, "link": "https://stackoverflow.com/questions/27927042/find-and-delete-rows-where-cell-value-is-n-a/27927250#27927250", "title": "Find and delete Rows where cell value is &quot;#N/A&quot;", "body": "<p>Your logic is pretty much there, but your syntax is off. Additionally, you are <em>only</em> checking column A for the value and not column B (per your comments above).</p>\n\n<pre><code>Sub Button2_Click()\n    Dim lRow As Long\n    'This will find how many rows there are\n    With ActiveSheet\n        lRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        MsgBox lastRow\n    End With\n\n    Dim iCntr As Long\n    For iCntr = lRow To 1 Step -1\n        'Replace \"#N/A\" with the value you want to delete\n        ' Check column A and B for the value.\n        If Cells(iCntr, 1).Text = \"#N/A\" Or Cells(iCntr, 2).Text = \"#N/A\" Then\n            Rows(iCntr).Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Or simplified:</p>\n\n<pre><code>Sub Button2_Click()\n    Dim iCntr As Long\n    For iCntr = Cells(Rows.Count, \"A\").End(xlUp).Row To 1 Step -1\n        'Replace \"#N/A\" with the value you want to delete\n        ' Check column A and B for the value.\n        If Cells(iCntr, 1).Text = \"#N/A\" Or Cells(iCntr, 2).Text = \"#N/A\" Then\n            Rows(iCntr).Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1421167792, "creation_date": 1421167792, "answer_id": 27927270, "question_id": 27927042, "link": "https://stackoverflow.com/questions/27927042/find-and-delete-rows-where-cell-value-is-n-a/27927270#27927270", "title": "Find and delete Rows where cell value is &quot;#N/A&quot;", "body": "<p>Because you have two subs, you must pass <strong>lastRow</strong> from one to the other:</p>\n\n<pre><code>Sub Button2_Click()\n'This will find how many rows there are\n With ActiveSheet\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    MsgBox lastRow\nEnd With\n\nCall sbDelete_Rows_Based_On_Criteria(lastRow)\n\nEnd Sub\n\n Sub sbDelete_Rows_Based_On_Criteria(lastRow)\n Dim lRow As Long\n Dim iCntr As Long\n lRow = lastRow\n For iCntr = lRow To 1 Step -1\n    'Replaces XX with the variable you want to delete\n    If Cells(iCntr, 1).Text = \"#N/A\" Then\n        Rows(iCntr).Delete\n    End If\n Next\n End Sub\n</code></pre>\n\n<p>Note:</p>\n\n<ol>\n<li>the sub are unnested</li>\n<li>Use <strong>.Text</strong></li>\n</ol>\n"}], "owner": {"reputation": 359, "user_id": 3953007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b181069a8d5c10aa07f12b5ccd2c3c60?s=128&d=identicon&r=PG&f=1", "display_name": "risail", "link": "https://stackoverflow.com/users/3953007/risail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13740, "favorite_count": 1, "accepted_answer_id": 27927250, "answer_count": 2, "score": 1, "last_activity_date": 1421767826, "creation_date": 1421167089, "last_edit_date": 1421767826, "question_id": 27927042, "link": "https://stackoverflow.com/questions/27927042/find-and-delete-rows-where-cell-value-is-n-a", "title": "Find and delete Rows where cell value is &quot;#N/A&quot;", "body": "<p>I have an excel document that I use to analyze data sets each data asset I bring in has varying amounts of data.  I have tried to write a macro that I assign to a button that can identify delete rows based on the value of a  cell. It does not work.  What am I doing wrong?</p>\n\n<pre><code>Sub Button2_Click()\n[vb]\n'This will find how many rows there are\n With ActiveSheet\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    MsgBox lastRow\n End With\n\n Sub sbDelete_Rows_Based_On_Criteria()\n     Dim lRow As Long\n     Dim iCntr As Long\n     lRow = lastRow\n     For iCntr = lRow To 1 Step -1\n         'Replaces XX with the variable you want to delete\n         If Cells(iCntr, 1) = \"#N/A\" Then\n             Rows(iCntr).Delete\n         End If\n     Next\n End Sub\n [/vb]\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "excel", "duplicates"], "comments": [{"owner": {"reputation": 877, "user_id": 2062207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e0b649216cf47aeef099b95205102843?s=128&d=identicon&r=PG", "display_name": "user2062207", "link": "https://stackoverflow.com/users/2062207/user2062207"}, "edited": false, "score": 0, "creation_date": 1421162583, "post_id": 27925416, "comment_id": 44247893, "body": "Apologies for the example, probably not the easiest on the eyes"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 5, "creation_date": 1421162669, "post_id": 27925416, "comment_id": 44247953, "body": "I am guessing it has something to do with <code>InStr</code> -&gt; <i>Returns an integer specifying the start position of the first occurrence of one <b>string within another</b>.</i> So it probably is going to treat <code>13-Hexadecenoic acid</code> as a duplicate of <code>3-Hexadecenoic acid</code> Thus even after removing the first <code>3-Hexadecenoic acid</code> it will still find <code>13-Hexadecenoic acid</code> and remove the second"}, {"owner": {"reputation": 877, "user_id": 2062207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e0b649216cf47aeef099b95205102843?s=128&d=identicon&r=PG", "display_name": "user2062207", "link": "https://stackoverflow.com/users/2062207/user2062207"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1421163869, "post_id": 27925416, "comment_id": 44248827, "body": "Thank you for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 877, "user_id": 2062207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e0b649216cf47aeef099b95205102843?s=128&d=identicon&r=PG", "display_name": "user2062207", "link": "https://stackoverflow.com/users/2062207/user2062207"}, "edited": false, "score": 0, "creation_date": 1421163835, "post_id": 27925741, "comment_id": 44248805, "body": "Fantastic! Thank you so much!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 10, "last_activity_date": 1421164064, "last_edit_date": 1421164064, "creation_date": 1421163298, "answer_id": 27925741, "question_id": 27925416, "link": "https://stackoverflow.com/questions/27925416/removing-duplicates-from-a-cell-in-excel/27925741#27925741", "title": "Removing duplicates from a cell in excel", "body": "<p>Probably there are several ways to do this, but <code>Dictionary</code> objects are great for enforcing uniqueness.</p>\n\n<pre><code>Function stringOfUniques(inputString As String, delimiter as String)\nDim xVal As Variant\nDim dict as Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nFor Each xVal In Split(inputString, delimiter)\n    dict(xVal) = xVal\nNext xVal\n\nstringOfUniques = Join(dict.Keys(),\",\")\nEnd Function\n</code></pre>\n\n<p>This function has also been modified to accept a variable delimiter argument, so you will pass the input string <em>and</em> the delimiter: <code>\";\"</code> to the function, which will return a comma-separated string.</p>\n\n<p><strong>A Note on Dictionaries:</strong> </p>\n\n<p>Dictionaries store key/value pairs. The <em>keys</em> must be unique.</p>\n\n<p>In the example, I use a simple assignment to the dictionary object:  <code>dict(key) = key</code>.  A dictionary will automatically <em>add or overwrite</em> an item when referenced by it's key, so this is a really simple way of enforcing uniqueness. </p>\n\n<p>In other circumstances (i.e., you want to <em>count</em> the number of occurrences of each key), you would want to test using the <code>dict.Exists(key)</code> in order to modify the <code>value</code> without overwriting the key/value pair, for example:</p>\n\n<pre><code>'Assigns a \"count\" value to the dictionary for each unique Key\nFor Each xVal In Split(inputString, delimiter)\n    If dict.Exists(xVal) Then\n        dict(xVal) = dict(xVal) + 1\n    Else\n        dict(xVal) = 1\n    End If\nNext xVal\n\n'Read the \"count\" from each key:\nFor Each xVal in dict.Keys()\n    MsgBox xVal &amp; \" appears \" &amp; dict(xVal) &amp; \" times\"\nNext\n</code></pre>\n"}], "owner": {"reputation": 877, "user_id": 2062207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e0b649216cf47aeef099b95205102843?s=128&d=identicon&r=PG", "display_name": "user2062207", "link": "https://stackoverflow.com/users/2062207/user2062207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1940, "favorite_count": 1, "accepted_answer_id": 27925741, "answer_count": 1, "score": 5, "last_activity_date": 1421768575, "creation_date": 1421162304, "last_edit_date": 1531164843, "question_id": 27925416, "link": "https://stackoverflow.com/questions/27925416/removing-duplicates-from-a-cell-in-excel", "title": "Removing duplicates from a cell in excel", "body": "<p>So I've got a list of strings, for which some of the strings contain duplicates. </p>\n\n<p>For example:</p>\n\n<blockquote>\n  <p>13-Hexadecenoic acid;13-methyl-4-pentadecenoic\n  acid;14-Methyl-6-pentadecenoic acid;15-Hexadecanolide;3-Hexadecenoic\n  acid;4-hexadecenoic acid;13-Hexadecenoic\n  acid;13-methyl-4-pentadecenoic acid;14-Methyl-6-pentadecenoic\n  acid;15-Hexadecanolide;3-Hexadecenoic acid;4-hexadecenoic acid;</p>\n</blockquote>\n\n<p>So I came across a macro online and tweaked it to work for my problem, which goes like this:</p>\n\n<pre><code>Function stringOfUniques(inputString As String) As String\n    Dim inArray() As String\n    Dim xVal As Variant\n    inArray = Split(inputString, \";\")\n    For Each xVal In inArray\n        If InStr(stringOfUniques, Trim(xVal)) = 0 Then _\n        stringOfUniques = stringOfUniques &amp; Trim(xVal) &amp; \",\"\n    Next xVal\n\nEnd Function\n</code></pre>\n\n<p>And for some of my strings this works brilliantly, however for the example above it will return the string with the duplicates removed, but weirdly will get rid off both copies of one of the words '3-Hexadecenoic acid'. So basically</p>\n\n<p>What I should get:</p>\n\n<blockquote>\n  <p>13-Hexadecenoic acid;13-methyl-4-pentadecenoic\n  acid;14-Methyl-6-pentadecenoic acid;15-Hexadecanolide;3-Hexadecenoic\n  acid;4-hexadecenoic acid; </p>\n</blockquote>\n\n<p>What I actually get:</p>\n\n<blockquote>\n  <p>13-Hexadecenoic acid;13-methyl-4-pentadecenoic\n  acid;14-Methyl-6-pentadecenoic acid;15-Hexadecanolide;4-hexadecenoic\n  acid;</p>\n</blockquote>\n\n<p>Is there something in my code that's causing this to happen?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1421162260, "post_id": 27925351, "comment_id": 44247700, "body": "If &quot;blank value&quot; is a valid condition for you, then you can&#39;t use <code>End(xlUp)</code>, because that skips over blanks (unless you are sure the last row&#39;s <code>A</code> is never blank)."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4154753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eebdf20c61766c78e22b2810e5be0383?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bershok", "link": "https://stackoverflow.com/users/4154753/matthew-bershok"}, "edited": false, "score": 0, "creation_date": 1421162648, "post_id": 27925475, "comment_id": 44247939, "body": "Thank you GSerg. Worked like a charm."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 1, "last_activity_date": 1421162472, "creation_date": 1421162472, "answer_id": 27925475, "question_id": 27925351, "link": "https://stackoverflow.com/questions/27925351/excel-vba-moving-contents-of-cell-and-deleting-rows-reading-each-line-till-end-o/27925475#27925475", "title": "Excel VBA moving contents of cell and deleting rows reading each line till end of data", "body": "<pre><code>For iA = lastRowA To 1 Step -1\n    With ws.Rows(iA)\n        valueA = .Cells(1).value\n\n        If Len(valueA) = 0 Then\n            .Cells(4).Offset(-1, 1).Value = .Cells(4).Value\n            .Delete\n        End If\n    End With\nNext\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4154753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eebdf20c61766c78e22b2810e5be0383?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bershok", "link": "https://stackoverflow.com/users/4154753/matthew-bershok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421162472, "creation_date": 1421162076, "question_id": 27925351, "link": "https://stackoverflow.com/questions/27925351/excel-vba-moving-contents-of-cell-and-deleting-rows-reading-each-line-till-end-o", "title": "Excel VBA moving contents of cell and deleting rows reading each line till end of data", "body": "<p>I am currently trying to finish a macro for excel vba. I need to read each line. If the value in column A is blank or equal to 0 I need to move the contents of column D from that row up one row and right one column. Example, If cell A55 is blank it will read the value in D55 and move it up one row and right one column to cell E54. It needs to then delete the entire row with the blank value in A55, therefore removing row 55 completely. I have the following code. This code will read the code line by line and delete the rows I need it to; however I can not get it to move the contents in column D. Thank you in advance</p>\n\n<pre><code>Dim ws As Worksheet, iA&amp;, lastRowA&amp;, valueA$,\nSet ws = ActiveWorkbook.ActiveSheet\n\nlastRowA = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nFor iA = lastRowA To 1 Step -1\n    valueA = ws.Cells(iA, 1).value\n    ' Check if it contains blank space in \"A\" column\n    If (valueA = \"\") Then\n        'CODE TO MOVE CONTENTS FROM CELL TO NEW LOCATION\n        ws.Rows(iA).Delete\n    End If\nNext\n</code></pre>\n"}, {"tags": ["performance", "excel", "labview", "cpu-speed", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4449672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff8ad24c3da540bb166e7bb3c4d606b?s=128&d=identicon&r=PG&f=1", "display_name": "MS Mike", "link": "https://stackoverflow.com/users/4449672/ms-mike"}, "edited": false, "score": 0, "creation_date": 1421226861, "post_id": 27925839, "comment_id": 44274919, "body": "Thank you for your answer, unfortunately this hasn&#39;t worked. At first its fine but then starts slowing down after a while."}], "tags": [], "owner": {"reputation": 644, "user_id": 11833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9976a6c4dae19bb2e722ed5aef2cd13?s=128&d=identicon&r=PG", "display_name": "Phil Brooks", "link": "https://stackoverflow.com/users/11833/phil-brooks"}, "is_accepted": false, "score": 0, "last_activity_date": 1421163613, "creation_date": 1421163613, "answer_id": 27925839, "question_id": 27925111, "link": "https://stackoverflow.com/questions/27925111/excel-vba-slows-down-when-excel-is-not-the-front-window/27925839#27925839", "title": "Excel VBA slows down when excel is not the front window", "body": "<p>You could try setting your Windows environment to adjust for best performance of background services.</p>\n\n<p><a href=\"http://www.ni.com/white-paper/3773/en/\" rel=\"nofollow\">http://www.ni.com/white-paper/3773/en/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4449672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff8ad24c3da540bb166e7bb3c4d606b?s=128&d=identicon&r=PG&f=1", "display_name": "MS Mike", "link": "https://stackoverflow.com/users/4449672/ms-mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421163613, "creation_date": 1421161447, "last_edit_date": 1531161705, "question_id": 27925111, "link": "https://stackoverflow.com/questions/27925111/excel-vba-slows-down-when-excel-is-not-the-front-window", "title": "Excel VBA slows down when excel is not the front window", "body": "<p>I have many different VBA macros that are commanded to run by an analysis sequence this analyser sequence and a Labview VI also reads and takes information that has been calculated in the excel spreadsheet.</p>\n\n<p>The analysis sequence has timers and delays that you can see counting down during which it checks on the status certain cells of the excel spreadsheet.</p>\n\n<p>All the analysis sequences, excel VBA macros and Labview VIs work perfectly but only when the excel window is running in front. if any other window is selected the calculations slow down which means the delay timers shown on the other sequences also slow down 5 or 6 times slower.</p>\n\n<p>This becomes a problem because the Labview VI has buttons to select options meaning in normal operation the excel sheet won't be in front. </p>\n\n<p>I have tried changing priorities in the task manager which changes nothing and making things run on different CPUs which again does nothing. the CPU is running around 50% all the time but the CPU usage of excel jumps from 2 or 3 when excel window is up front to around 50 when another window is selected. </p>\n\n<p>I've also made the macros as streamlines as i can think of doing by turning of screen updating and so on. </p>\n\n<p>A fix like the VBA code bringing the sheet to the from will be just as good as having the excel window permanently at the front. but an idea of what could be causing the issue would be much appreciated.</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 1, "creation_date": 1421163907, "post_id": 27924986, "comment_id": 44248847, "body": "Could you please define &quot;table&quot;.  Are you speaking of the object &quot;table&quot; that can be inserted into a worksheet? Or the worksheet itself?  edit: I think you mean object, with them being stacked..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1421163911, "post_id": 27924986, "comment_id": 44248849, "body": "There is a way to recognize the top-left corner of each table <b>IF</b> the tables are <code>ListObjects</code> (created from the Insert | Table ribbon).  Simply iterate each <code>ListObject</code> on the worksheet, and copy its <code>DataBodyRange</code>. If they are simple formatted cells, then you would have to use some other logic, which will be more complicated."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421164000, "post_id": 27924986, "comment_id": 44248913, "body": "Have you considered setting them as visible or not?"}, {"owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "reply_to_user": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421165958, "post_id": 27924986, "comment_id": 44250277, "body": "@peege Sorry I wasn&#39;t clearer. It&#39;s not actually a table object, but simply a grouping of cells that I was referring to as a &quot;table.&quot;"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421165979, "post_id": 27924986, "comment_id": 44250291, "body": "OK, that changes everything.  What exactly are you trying to do then?  Specifically?  If this happens, move this data to HERE..  Etc."}, {"owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "reply_to_user": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421172989, "post_id": 27924986, "comment_id": 44254556, "body": "@peege Well as you can see, I currently have the program cutting a table from one location and pasting it to another location. However, some spreadsheets I&#39;m working with will have more than one table, and of varying sizes possibly (varying only in one row added, or such). So, I need the program to be able to detect when there are multiple tables, and move them right under the original table that was moved. If it helps, each table has the same header, so I was thinking it could be possible to have the table look for the same header each time, and then implement Gary&#39;s CornerFinder below maybe."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421206246, "post_id": 27924986, "comment_id": 44268013, "body": "It would help a lot if you can show us how your tables are organized, what are dynamically changing and what is constant. Are there headers or markers or any reference?"}, {"owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421216977, "post_id": 27924986, "comment_id": 44270803, "body": "@L42 Here&#39;s a picture of a table: <a href=\"http://imgur.com/cAzsUlZ\" rel=\"nofollow noreferrer\">imgur.com/cAzsUlZ</a>  The dynamic parts that could change are simply: 1) more data filling up those blank spaces 2) an extra row or two added to the bottom of the table or 3) the report each group of hours is credited in. So, to be clear, the yellow part, the header of the table, is static and stays the same with every table."}, {"owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421283715, "post_id": 27924986, "comment_id": 44305433, "body": "@L42 Thanks for editing my question with that table. I didn&#39;t know you could do that."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421285485, "post_id": 27924986, "comment_id": 44305871, "body": "Ah, you can only do that if you&#39;ve earned enough reputation. Btw, this is possible. I&#39;ll see what I can do. While I&#39;m at it, check this <a href=\"http://blogs.msmvps.com/jonskeet/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">StackOverflow Question Checklist</a> to help you improve your questions in the future and attract more people to answer it."}, {"owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1421285674, "post_id": 27924986, "comment_id": 44305914, "body": "@L42 Okay! Thanks so much for all of your help. I&#39;m pretty new to this, so I&#39;ve been working with a rudimentary knowledge, and getting most of my commands from viewing the source of a macro after I do the action that I want it to do automatically for me. And thanks for the link, I&#39;ll definitely use it in any future questions I may have."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "edited": false, "score": 0, "creation_date": 1421172679, "post_id": 27926173, "comment_id": 44254378, "body": "Thank you for your reply! I have a follow up question for you though, as I am quite new. How would I implement this in my program? Would I use your CornerFinder to store the corners of the table as Strings, and then another program would use said strings as the locations for what to move? I&#39;m not sure how something like that would look, but I&#39;m excited to implement your solution if possible into something like that."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1421164565, "creation_date": 1421164565, "answer_id": 27926173, "question_id": 27924986, "link": "https://stackoverflow.com/questions/27924986/vba-excel-how-to-recognize-certain-types-of-data/27926173#27926173", "title": "VBA Excel - How to recognize certain types of data", "body": "<p>If you have a <strong>rectangular</strong> range, then to find its upper left-hand corner and lower right-hand corner:</p>\n\n<pre><code>Sub CornerFinder(RR As Range)\n    Dim addy1 As String, addy2 As String\n    addy1 = RR(1).Address(0, 0)\n\n    Dim nLastRow As Long, nLastColumn As Long\n    nLastRow = RR.Rows.Count + RR.Row - 1\n    nLastColumn = RR.Columns.Count + RR.Column - 1\n    addy2 = Cells(nLastRow, nLastColumn).Address(0, 0)\n\n    MsgBox addy1 &amp; vbCrLf &amp; addy2\nEnd Sub\n</code></pre>\n\n<p>Tested with:</p>\n\n<pre><code>Sub MAIN()\n    Dim r As Range\n    Set r = Range(\"B9:J37\")\n    Call CornerFinder(r)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "edited": false, "score": 0, "creation_date": 1421354073, "post_id": 27955830, "comment_id": 44337577, "body": "Thanks so much for your code! It worked almost perfectly, I had to change just a little bit of it to account for adding a new sheet. I&#39;m very thankful for your help :)  I do have one final question if that&#39;s okay haha. Looking through it, I believe you check the box right below &quot;credit in report&quot; and keep copying until the box below is blank. However, I have some tables that look like this: <a href=\"http://imgur.com/5dP6PQi\" rel=\"nofollow noreferrer\">imgur.com/5dP6PQi</a>  -- would it be possible to make it check Credited in report, but then instead always check under the first column of dates? That column is consistent throughout the sheets I&#39;ll..."}, {"owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "edited": false, "score": 0, "creation_date": 1421354286, "post_id": 27955830, "comment_id": 44337710, "body": "...be working with, column H -- but of course the row it is in can change. If that&#39;s not possible based on how you coded it, that&#39;s okay -- I&#39;m so very happy with what you&#39;ve already given me and I can possibly just eliminate those data points or make them have their own row, since they&#39;re not present in every sheet and table I&#39;ll be going through."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "edited": false, "score": 0, "creation_date": 1421363913, "post_id": 27955830, "comment_id": 44342185, "body": "@hymatty Of course that is possible. We looked for the cell that contains <b>Credited in Report</b> and used it as reference in finding the last cell with data. You only need to use <i>Offset property</i> to get to the correct column. So change this part <code>.Range(tb_loc(i))</code> to <code>.Range(tb_loc(i)).Offset(0, 3)</code> since you want to check 3 cells from it."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1421288469, "creation_date": 1421288469, "answer_id": 27955830, "question_id": 27924986, "link": "https://stackoverflow.com/questions/27924986/vba-excel-how-to-recognize-certain-types-of-data/27955830#27955830", "title": "VBA Excel - How to recognize certain types of data", "body": "<p>Ok based on your sample data and sample code, try this out.</p>\n\n<pre><code>Sub Test()\n    Const tlh As String = \"Credited in Report\"\n    With Sheets(\"Sheet1\") 'Change to suit\n        Dim tl As Range, bl As Range\n        Dim first_add As String, tbl_loc As Variant\n        Set tl = .Cells.Find(tlh)\n        If Not tl Is Nothing Then\n            first_add = tl.Address\n        Else\n            MsgBox \"Table does not exist.\": Exit Sub\n        End If\n        Do\n            If Not IsArray(tbl_loc) Then\n                tbl_loc = Array(tl.Address)\n            Else\n                ReDim Preserve tbl_loc(UBound(tbl_loc) + 1)\n                tbl_loc(UBound(tbl_loc)) = tl.Address\n            End If\n            Set tl = .Cells.FindNext(tl)\n        Loop While tl.Address &lt;&gt; first_add\n        Dim i As Long, lrow As Long, tb_cnt As Long: tb_cnt = 0\n        For i = LBound(tbl_loc) To UBound(tbl_loc)\n            Set bl = .Cells.Find(vbNullString, .Range(tbl_loc(i)) _\n                , , , xlByColumns, xlNext)\n            lrow = Sheets(\"Sheet2\").Range(\"A\" &amp; _\n                   Sheets(\"Sheet2\").Rows.Count).End(xlUp).Row\n            .Range(.Range(tbl_loc(i)).Offset(IIf(tb_cnt &lt;&gt; 0, 1, 0), 0), _\n                bl.Offset(-1, 0)).Resize(, 9).Copy _\n                Sheets(\"Sheet2\").Range(\"A\" &amp; lrow).Offset(IIf(lrow = 1, 0, 1), 0)\n            tb_cnt = tb_cnt + 1\n            Set bl = Nothing\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>This consolidates the data in one table.<br>\nI used copy instead of cut to be safe. You can change it whatever suits you.<br>\nI also use another sheet for the output since I'm using copy.<br></p>\n\n<p>For example you have below in Sheet1:</p>\n\n<p><img src=\"https://i.stack.imgur.com/R9NZq.png\" alt=\"enter image description here\"></p>\n\n<p>It will be consolidated in Sheet2 like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/12zIQ.png\" alt=\"enter image description here\"></p>\n\n<p>Is this what you're trying? If not, you can go ahead and learn from the code.<br>\nThen once you do, adjust it to suit your needs. :-) HTH.</p>\n"}], "owner": {"reputation": 13, "user_id": 4441299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c39d44d1750cdb11c5dbceb9d73228?s=128&d=identicon&r=PG&f=1", "display_name": "hymatty", "link": "https://stackoverflow.com/users/4441299/hymatty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 27955830, "answer_count": 2, "score": 1, "last_activity_date": 1421288469, "creation_date": 1421161073, "last_edit_date": 1421282170, "question_id": 27924986, "link": "https://stackoverflow.com/questions/27924986/vba-excel-how-to-recognize-certain-types-of-data", "title": "VBA Excel - How to recognize certain types of data", "body": "<p>I'm trying to build a macro that will move a table (group of cells) for me to another area of the excel spreadsheet. I've currently built this (this is the relevant part of code), but it only works with one table, as I coded it based on location of the first table. However, some of my spreadsheets have more tables, of differing locations (all the tables are stacked on top of each other, but have differing heights -- so I can't easily do what I've already done for the first table). </p>\n\n<p>So my question is -- is there a way to code VBA to recognize the top left corner of each table (the data in the top left corner is always the same with each table) and then detect when the table (data) end both to the right and bottom of that top left corner, and then move all that? </p>\n\n<p>I'm very new to this, and honestly am proud of my shabby \"coding\" below. Any help would be appreciated. I thought about using an \"If..Then\" statement for the detecting of the top left corner but have no idea how to go from there. Thank you for any help.</p>\n\n<pre><code>' Moving data and headers\nWorksheets(\"Inventory\").Range(\"E6:E14\").Cut Worksheets(\"Inventory\").Range(\"A1:A9\")\nWorksheets(\"Inventory\").Range(\"F6:F14\").Cut Worksheets(\"Inventory\").Range(\"B1:B9\")\nWorksheets(\"Inventory\").Range(\"G6:G14\").Cut Worksheets(\"Inventory\").Range(\"C1:C9\")\nWorksheets(\"Inventory\").Range(\"H8:H14\").Cut Worksheets(\"Inventory\").Range(\"D3:D9\")\nWorksheets(\"Inventory\").Range(\"I8:I14\").Cut Worksheets(\"Inventory\").Range(\"E3:E9\")\nWorksheets(\"Inventory\").Range(\"J8:J14\").Cut Worksheets(\"Inventory\").Range(\"F3:F9\")\nWorksheets(\"Inventory\").Range(\"K8:K14\").Cut Worksheets(\"Inventory\").Range(\"G3:G9\")\nWorksheets(\"Inventory\").Range(\"L8:L14\").Cut Worksheets(\"Inventory\").Range(\"H3:H9\")\nWorksheets(\"Inventory\").Range(\"M8:M14\").Cut Worksheets(\"Inventory\").Range(\"I3:I9\")\n' Merging and putting in Days Worked\nRange(\"D1:I1\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlBottom\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\n</code></pre>\n\n<p><strong>Sample Table:</strong></p>\n\n<p><img src=\"https://i.imgur.com/cAzsUlZ.png\" alt=\"sample\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421161647, "post_id": 27924776, "comment_id": 44247282, "body": "As a courtesy, you should let people know that you&#39;ve asked this question on another site and already had answers..."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1421162039, "post_id": 27924776, "comment_id": 44247547, "body": "(this works but I don&#39;t know if I can fully recommend this so I am just leaving it as a comment) You could just initially set <code>Ret</code> to false, then use <code>On Error Resume Next</code> then call your <code>.Find(...)</code> and then re-set the error handling back to <code>On Error GoTo 0</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1421257781, "post_id": 27924776, "comment_id": 44293521, "body": "@chancea I would strongly advise against that, it&#39;s just ignoring the error rather than dealing with it appropriately. Setting a range via .Find() and testing if it is <code>Nothing</code> for example would be a cleaner option. Too many people use <code>On Error</code> statements without understanding the implications of poor error handling which inevitably leads to more problems in the future."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421258442, "post_id": 27924776, "comment_id": 44293939, "body": "@SO Yeah I basically agree with you, that is why I would never leave that kind of suggestion as an answer.  It is an ugly workaround but bad practice.  But hey, if you are only making a macro to fix a spreadsheet once or if it&#39;s not going to be used in some kind of industry then I think it&#39;s (deep breath) <i>somewhat</i> okay to do this."}], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421161601, "post_id": 27925004, "comment_id": 44247246, "body": "You are missing a period in front of <code>Columns</code>... Also, the <code>Find</code> could be pulled out of the <code>With</code> <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">if you insist on using select</a>"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421164895, "post_id": 27925004, "comment_id": 44249549, "body": "I understand your down vote @Chrismas007, but the code behaves exactly the same using .Columns and just Columns. It is good to explicitly denote them, but that is not the cause of the cause of the error !"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1421165026, "post_id": 27925004, "comment_id": 44249637, "body": "My downvote was more for <code>Select</code> as I am pretty passionately against it (although I had some old code I just posted for another answer on PPT with <code>Select</code>... ugh)  Also always better to define the period just to be clear but I got your point."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1421258001, "post_id": 27925004, "comment_id": 44293674, "body": "@PaulFrancis <code>Columns(&quot;B:B&quot;)</code> refers to column B of the Active sheet only, where as <code>.Columns(&quot;B:B&quot;)</code> refers explicitly to column B of the sheets &quot;Dados&quot;. The code will only behave the same if &quot;Dados&quot; happens to be the active sheet at the time of execution."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 0, "last_activity_date": 1421161124, "creation_date": 1421161124, "answer_id": 27925004, "question_id": 27924776, "link": "https://stackoverflow.com/questions/27924776/runtime-error-91-when-using-range-find-and-string-from-textbox/27925004#27925004", "title": "Runtime error 91 - When using Range.Find and String from TextBox", "body": "<p>FindText is a String Variable not an Object variable. Only Objects can be set to or have the Value Null. So when the False is executed. It is looking for an Object, since it is not set it throws the error.</p>\n\n<p>You do not even need the line of code as it computes afters getting into the Selection. You need to validate the Data before going for checking, so try this maybe.</p>\n\n<pre><code>Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    Dim Ret As Boolean\n    Dim FindText As String\n\n    If Len(TextBox1.Text &amp; vbNullString) = 0 Then Exit Sub\n\n    If KeyCode = 13 Then\n        With Sheets(\"Dados\")\n            Columns(\"B:B\").Select\n            FindText = TextBox1.Text\n            Ret = Selection.Find(What:=FindText, _\n                                 After:=.Cells(1, 1), _\n                                 LookIn:=xlValues, _\n                                 LookAt:=xlWhole, _\n                                 SearchOrder:=xlByColumns, _\n                                 SearchDirection:=xlNext, _\n                                 MatchCase:=False, _\n                                 SearchFormat:=False).Activate\n            MsgBox \"Hy \" &amp; FindText &amp; \" &gt; \" &amp; Ret\n        End With\n    End If \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": -1, "last_activity_date": 1421165373, "last_edit_date": 1495535121, "creation_date": 1421161468, "answer_id": 27925118, "question_id": 27924776, "link": "https://stackoverflow.com/questions/27924776/runtime-error-91-when-using-range-find-and-string-from-textbox/27925118#27925118", "title": "Runtime error 91 - When using Range.Find and String from TextBox", "body": "<p>First off <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">stop using <code>.select</code></a>.  Secondly, you are missing a period before <code>Columns</code> to refer to your <code>With</code>...</p>\n\n<pre><code>Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\nDim Ret As Boolean\nDim FindText As String\nIf KeyCode = 13 Then\n    If TextBox1.Text = \"\" Then Exit Sub\n    FindText = TextBox1.Text\n    With Sheets(\"Dados\")\n        If .Columns(\"B:B\").Find(What:=FindText, After:=.Cells(1, 1), LookIn:=xlValues, LookAt_\n            :=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase_\n            :=False, SearchFormat:=False) is Nothing Then\n            Ret = False\n        Else\n            Ret = True\n        End If\n    End With\n    MsgBox \"Hy \" &amp; FindText &amp; \" &gt; \" &amp; Ret\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4265194, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EjHTAtADEvo/AAAAAAAAAAI/AAAAAAAABxI/gPXrqQygALw/photo.jpg?sz=128", "display_name": "Pedro Amorim", "link": "https://stackoverflow.com/users/4265194/pedro-amorim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1421257543, "creation_date": 1421160400, "last_edit_date": 1421257543, "question_id": 27924776, "link": "https://stackoverflow.com/questions/27924776/runtime-error-91-when-using-range-find-and-string-from-textbox", "title": "Runtime error 91 - When using Range.Find and String from TextBox", "body": "<p>I'm facing a problem with a function I'm trying to create. </p>\n\n<p>The function should do the following: \n- Ask for the values\n- Return True or False if the value exists or not in the B:B column.</p>\n\n<p>This is what I have so far...</p>\n\n<pre><code>Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\nDim Ret As Boolean\nDim FindText As String\nIf KeyCode = 13 Then\n    With Sheets(\"Dados\")\n        Columns(\"B:B\").Select\n        FindText = TextBox1.Text\n        Ret = Selection.Find(What:=FindText, After:=.Cells(1, 1), LookIn:=xlValues, LookAt _\n        :=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase _\n        :=False, SearchFormat:=False).Activate\n        MsgBox \"Hy \" &amp; FindText &amp; \" &gt; \" &amp; Ret\n        If FindText Is Nothing Then Exit Sub\n    End With\nEnd If End Sub\n</code></pre>\n\n<p>This works great when the value is true, but gives me the <code>runtime error 91 - Object variable or With block variable not set</code> if the value is false :(</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 2, "creation_date": 1421159109, "post_id": 27924249, "comment_id": 44245511, "body": "This doesn&#39;t work if there is no file extension but there is a dot in the name."}, {"owner": {"reputation": 394, "user_id": 3837942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGpZT.jpg?s=128&g=1", "display_name": "bp_", "link": "https://stackoverflow.com/users/3837942/bp"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1421159367, "post_id": 27924249, "comment_id": 44245691, "body": "No?  Can you tell me what error is occuring?  I am missing it."}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 2, "creation_date": 1421159545, "post_id": 27924249, "comment_id": 44245824, "body": "Think it through.  You&#39;re using an InStrRev to find the dot.  Well, what if the file name is &quot;John.And.Mary.Spreadsheet&quot;, because they have Hide Extensions option on?  Now it thinks the file is &quot;John.And.Mary&quot; and the file extension is &quot;Spreadsheet&quot;."}, {"owner": {"reputation": 394, "user_id": 3837942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGpZT.jpg?s=128&g=1", "display_name": "bp_", "link": "https://stackoverflow.com/users/3837942/bp"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 1, "creation_date": 1421160299, "post_id": 27924249, "comment_id": 44246380, "body": "Not according to my system.  Not sure if the version you are using changes things, but the .Name property returns the full name, regardless of the Hidden extensions.  At least, that is what it is doing for me."}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 1, "creation_date": 1421160492, "post_id": 27924249, "comment_id": 44246514, "body": "Read the OP&#39;s question.  He&#39;s saying he gets the extension only if that option is turned off."}, {"owner": {"reputation": 394, "user_id": 3837942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGpZT.jpg?s=128&g=1", "display_name": "bp_", "link": "https://stackoverflow.com/users/3837942/bp"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 3, "creation_date": 1421160973, "post_id": 27924249, "comment_id": 44246852, "body": "Is it possible the OP is wrong, hence asking for help on SO?  Or are all OPs infallible?"}, {"owner": {"reputation": 25863, "user_id": 500974, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/goEft.png?s=128&g=1", "display_name": "Matt Wilko", "link": "https://stackoverflow.com/users/500974/matt-wilko"}, "edited": false, "score": 0, "creation_date": 1421162920, "post_id": 27924249, "comment_id": 44248144, "body": "the Hide known extensions extensions is just a setting in file explorer it doesn&#39;t have an effect in VBA. Having said that a file doesn&#39;t have to have any extension so that may be what is happening here"}, {"owner": {"reputation": 394, "user_id": 3837942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGpZT.jpg?s=128&g=1", "display_name": "bp_", "link": "https://stackoverflow.com/users/3837942/bp"}, "edited": false, "score": 0, "creation_date": 1421183216, "post_id": 27924249, "comment_id": 44260421, "body": "I saved my test file with no extension, then manually opened it in Excel and produced the same results.  Wondering if Windows &#39;assigns&#39; an extension when you manually select a program to open the file?"}, {"owner": {"reputation": 3183, "user_id": 1214743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9CsNP.png?s=128&g=1", "display_name": "Malachi", "link": "https://stackoverflow.com/users/1214743/malachi"}, "edited": false, "score": 1, "creation_date": 1421958329, "post_id": 27924249, "comment_id": 44571872, "body": "Hiding the Extension doesn&#39;t mean that the file doesn&#39;t have one, it means it isn&#39;t being shown by the file explorer"}], "tags": [], "owner": {"reputation": 394, "user_id": 3837942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGpZT.jpg?s=128&g=1", "display_name": "bp_", "link": "https://stackoverflow.com/users/3837942/bp"}, "is_accepted": true, "score": -1, "last_activity_date": 1421158834, "creation_date": 1421158834, "answer_id": 27924249, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/27924249#27924249", "title": "File name without extension name VBA", "body": "<pre><code>strTestString = Left(ThisWorkbook.Name, (InStrRev(ThisWorkbook.Name, \".\", -1, vbTextCompare) - 1))\n</code></pre>\n\n<p>full credit: <a href=\"http://mariaevert.dk/vba/?p=162\" rel=\"nofollow\">http://mariaevert.dk/vba/?p=162</a></p>\n"}, {"comments": [{"owner": {"reputation": 394, "user_id": 3837942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGpZT.jpg?s=128&g=1", "display_name": "bp_", "link": "https://stackoverflow.com/users/3837942/bp"}, "edited": false, "score": 3, "creation_date": 1421161790, "post_id": 27924854, "comment_id": 44247381, "body": "Didn&#39;t know that was there!  Nice answer."}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 5, "creation_date": 1444368830, "post_id": 27924854, "comment_id": 53883206, "body": "RbeerDuck,  When I run this command, there is a compile error &quot;User-defined type not defined&quot;"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1444381414, "post_id": 27924854, "comment_id": 53889659, "body": "@Isu you need to add a reference to the library."}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1444430885, "post_id": 27924854, "comment_id": 53917365, "body": "Can you explain that please?"}, {"owner": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "edited": false, "score": 0, "creation_date": 1460124521, "post_id": 27924854, "comment_id": 60610804, "body": "and if &quot;Hide extensions for known file types&quot; is on, how will GetBasename know that &quot;John.and.Mary.spreadsheet&quot; is already the base name ? I think it will assume &quot;spreadsheet&quot; is the file extension and will return &quot;John.and.Mary&quot;, so this doesn&#39;t address OP&#39;s problem."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 2065, "user_id": 2836552, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47c7b954e22c8f427b46edf4cc9c2432?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeStarProgrammer57", "link": "https://stackoverflow.com/users/2836552/threestarprogrammer57"}, "edited": false, "score": 2, "creation_date": 1460133898, "post_id": 27924854, "comment_id": 60616958, "body": "@ThreeStarProgrammer57 I think you should try it before you suggest it doesn&#39;t work."}, {"owner": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "edited": false, "score": 1, "creation_date": 1470650263, "post_id": 27924854, "comment_id": 65018294, "body": "It certainly doesn&#39;t work if you use the <code>Workbook.Name</code> property as the argument for these fso functions when &quot;Hide extensions for known file types&quot; is set.  <code>Workbook.Fullname</code> should be used instead."}, {"owner": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "edited": false, "score": 4, "creation_date": 1470651658, "post_id": 27924854, "comment_id": 65019168, "body": "Sorry - should&#39;ve explained myself.  It won&#39;t work if you have extensions hidden in explorer and the filename is something stupid like &quot;Myworkbook.csv.xlsx&quot; (far from uncommon).  In this case the <code>.Name</code> property is &quot;Myworkbook.csv&quot; and <code>GetBaseName</code> returns &quot;Myworkbook&quot; which is incorrect. Furthermore: if you try to use the companion fso function <code>GetExtensionName</code> with <code>Workbook.Name</code> property when extensions are hidden you won&#39;t get an answer.  Far better practice to just use the <code>Workbook.Fullname</code> property, which returns the same string regardless of Explorer&#39;s &quot;hide extensions&quot; setting."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 5, "creation_date": 1529423451, "post_id": 27924854, "comment_id": 88863539, "body": "I prefer late binding - <code>Dim fso: Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)</code>"}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 65, "last_activity_date": 1457026571, "last_edit_date": 1495540471, "creation_date": 1421160670, "answer_id": 27924854, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/27924854#27924854", "title": "File name without extension name VBA", "body": "<p>The answers given here already may work in limited situations, but are certainly not the best way to go about it. Don't reinvent the wheel. The <a href=\"http://msdn.microsoft.com/en-us/library/6kxy1a51(v=vs.84).aspx\" rel=\"noreferrer\">File System Object</a> in the <a href=\"http://msdn.microsoft.com/en-us/library/bstcxhf7(v=vs.84).aspx\" rel=\"noreferrer\">Microsoft Scripting Runtime library</a> already has a method to do exactly this. It's called <a href=\"http://msdn.microsoft.com/en-us/library/xhxzwwe1(v=vs.84).aspx\" rel=\"noreferrer\">GetBaseName</a>. It handles periods in the file name as is.</p>\n\n<pre><code>Public Sub Test()\n\n    Dim fso As New Scripting.FileSystemObject\n    Debug.Print fso.GetBaseName(ActiveWorkbook.Name)\n\nEnd Sub\n\nPublic Sub Test2()\n\n    Dim fso As New Scripting.FileSystemObject\n    Debug.Print fso.GetBaseName(\"MyFile.something.txt\")\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/3236348/3198973\">Instructions for adding a reference to the Scripting Library</a></p>\n"}, {"tags": [], "owner": {"reputation": 353, "user_id": 4476460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8dfa9fc2eee39eada8e9bc761795b4?s=128&d=identicon&r=PG", "display_name": "Harry S", "link": "https://stackoverflow.com/users/4476460/harry-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1582741003, "last_edit_date": 1582741003, "creation_date": 1485726298, "answer_id": 41926301, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/41926301#41926301", "title": "File name without extension name VBA", "body": "<p>To be verbose it the removal of extension is demonstrated for\nworkbooks.. which now have a variety of extensions  .\n. a new unsaved Book1 has no ext\n. works the same for files</p>\n\n<pre><code>Function WorkbookIsOpen(FWNa$, Optional AnyExt As Boolean = False) As Boolean\n\nDim wWB As Workbook, WBNa$, PD%\nFWNa = Trim(FWNa)\nIf FWNa &lt;&gt; \"\" Then\n    For Each wWB In Workbooks\n        WBNa = wWB.Name\n        If AnyExt Then\n            PD = InStr(WBNa, \".\")\n            If PD &gt; 0 Then WBNa = Left(WBNa, PD - 1)\n            PD = InStr(FWNa, \".\")\n            If PD &gt; 0 Then FWNa = Left(FWNa, PD - 1)\n            '\n            ' the alternative of using split..  see commented out  below\n            ' looks neater but takes a bit longer then the pair of instr and left\n            ' VBA does about 800,000  of these small splits/sec\n            ' and about 20,000,000  Instr Lefts per sec\n            ' of course if not checking for other extensions they do not matter\n            ' and to any reasonable program\n            ' THIS DISCUSSIONOF TIME TAKEN DOES NOT MATTER\n            ' IN doing about doing 2000 of this routine per sec\n\n            ' WBNa = Split(WBNa, \".\")(0)\n            'FWNa = Split(FWNa, \".\")(0)\n        End If\n\n        If WBNa = FWNa Then\n            WorkbookIsOpen = True\n            Exit Function\n        End If\n    Next wWB\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1752, "user_id": 2029790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655269fb547aed3b52ab6048e9851c3c?s=128&d=identicon&r=PG", "display_name": "Vincent Orback", "link": "https://stackoverflow.com/users/2029790/vincent-orback"}, "edited": false, "score": 5, "creation_date": 1490529559, "post_id": 43028343, "comment_id": 73142718, "body": "Don\u2019t just provide a link. Extract the information from your link and write it out in your answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 7769301, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c3a79ceddbb00d91e0225a6f6c7aff85?s=128&d=identicon&r=PG", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/7769301/ahmed"}, "is_accepted": false, "score": -4, "last_activity_date": 1490529019, "creation_date": 1490529019, "answer_id": 43028343, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/43028343#43028343", "title": "File name without extension name VBA", "body": "<p>Answer is here:\nI think this answer is good, please try it\n<a href=\"http://mariaevert.dk/vba/?p=162\" rel=\"nofollow noreferrer\">http://mariaevert.dk/vba/?p=162</a></p>\n"}, {"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 2, "creation_date": 1529423682, "post_id": 43489443, "comment_id": 88863646, "body": "This will fail if you have more dots in the file name."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 1, "creation_date": 1578394133, "post_id": 43489443, "comment_id": 105415847, "body": "+1 I found this answer helpful. Tip: use <code>&quot;.x&quot;</code> or even <code>&quot;.xls&quot;</code> in case you have more dots in the file name."}, {"owner": {"reputation": 162, "user_id": 3934322, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f41d72ccf7dff923d54109ca7a90c52d?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/3934322/pawel"}, "edited": false, "score": 0, "creation_date": 1582534860, "post_id": 43489443, "comment_id": 106796850, "body": "If you have more dots in the file name use InStrRev in place of both InStr &#39;s"}], "tags": [], "owner": {"reputation": 141, "user_id": 7888256, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/bd8a551d200f7526874c6736a5332555?s=128&d=identicon&r=PG", "display_name": "Ifca", "link": "https://stackoverflow.com/users/7888256/ifca"}, "is_accepted": false, "score": 14, "last_activity_date": 1492587670, "last_edit_date": 1492587670, "creation_date": 1492587580, "answer_id": 43489443, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/43489443#43489443", "title": "File name without extension name VBA", "body": "<p>Simple but works well for me </p>\n\n<pre><code>FileName = ActiveWorkbook.Name \nIf InStr(FileName, \".\") &gt; 0 Then \n   FileName = Left(FileName, InStr(FileName, \".\") - 1) \nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1585756989, "post_id": 54365067, "comment_id": 107876478, "body": "What if the filename is <code>My.Special.Workbook.xlsm</code>? Split returns a four-element array."}], "tags": [], "owner": {"reputation": 51, "user_id": 8024357, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210084449286299/picture?type=large", "display_name": "Bob Nightingale", "link": "https://stackoverflow.com/users/8024357/bob-nightingale"}, "is_accepted": false, "score": 3, "last_activity_date": 1548418046, "creation_date": 1548418046, "answer_id": 54365067, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/54365067#54365067", "title": "File name without extension name VBA", "body": "<p>Using the Split function seems more elegant than InStr and Left, in my opinion.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n\nDim ThisFileName As String\nDim BaseFileName As String\n\nDim FileNameArray() As String\n\nThisFileName = ThisWorkbook.Name\nFileNameArray = Split(ThisFileName, \".\")\nBaseFileName = FileNameArray(0)\n\nMsgBox \"Base file name is \" &amp; BaseFileName\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6021678, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208132238881815/picture?type=large", "display_name": "Jeremy Smith", "link": "https://stackoverflow.com/users/6021678/jeremy-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1550678728, "creation_date": 1550678728, "answer_id": 54790605, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/54790605#54790605", "title": "File name without extension name VBA", "body": "<p>This gets the file type as from the last character (so avoids the problem with dots in file names)</p>\n\n<pre><code>Function getFileType(fn As String) As String\n\n''get last instance of \".\" (full stop) in a filename then returns the part of the filename starting at that dot to the end\nDim strIndex As Integer\nDim x As Integer\nDim myChar As String\n\nstrIndex = Len(fn)\nFor x = 1 To Len(fn)\n\n    myChar = Mid(fn, strIndex, 1)\n\n    If myChar = \".\" Then\n        Exit For\n    End If\n\n    strIndex = strIndex - 1\n\nNext x\n\ngetFileType = UCase(Mid(fn, strIndex, Len(fn) - x + 1))\n</code></pre>\n\n<p>End Function</p>\n"}, {"tags": [], "owner": {"reputation": 1722, "user_id": 563231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2rzat.jpg?s=128&g=1", "display_name": "David Metcalfe", "link": "https://stackoverflow.com/users/563231/david-metcalfe"}, "is_accepted": false, "score": -1, "last_activity_date": 1606620592, "creation_date": 1606620592, "answer_id": 65056738, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/65056738#65056738", "title": "File name without extension name VBA", "body": "<p>You could always use <code>Replace()</code> since you're performing this on the workbook's Name, which will almost certainly end with <code>.xlsm</code> by virtue of using VBA.</p>\n<p><strong>Using ActiveWorkbook per your example:</strong></p>\n<p><code>Replace(Application.ActiveWorkbook.Name, &quot;.xlsm&quot;, &quot;&quot;)</code></p>\n<p><strong>Using ThisWorkbook:</strong></p>\n<p><code>Replace(Application.ThisWorkbook.Name, &quot;.xlsm&quot;, &quot;&quot;)</code></p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7128831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ut0F.jpg?s=128&g=1", "display_name": "Vulka", "link": "https://stackoverflow.com/users/7128831/vulka"}, "is_accepted": false, "score": 0, "last_activity_date": 1617717875, "creation_date": 1617717875, "answer_id": 66970199, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba/66970199#66970199", "title": "File name without extension name VBA", "body": "<p>I use a macro from my personal.xlsb and run it on both xlsm and xlsx files so a variation on David Metcalfe's answer that I use is</p>\n<blockquote>\n<p>Dim Wrkbook As String</p>\n</blockquote>\n<blockquote>\n<p>Wrkbook = Replace(Application.ActiveWorkbook.Name, &quot;.xlsx&quot;, &quot;.pdf&quot;)</p>\n</blockquote>\n<blockquote>\n<p>Wrkbook = Replace(Application.ActiveWorkbook.Name, &quot;.xlsm&quot;, &quot;.pdf&quot;)</p>\n</blockquote>\n"}], "owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123285, "favorite_count": 6, "accepted_answer_id": 27924249, "answer_count": 9, "score": 18, "last_activity_date": 1617717875, "creation_date": 1421157775, "last_edit_date": 1531164843, "question_id": 27923926, "link": "https://stackoverflow.com/questions/27923926/file-name-without-extension-name-vba", "title": "File name without extension name VBA", "body": "<p>I need to get file name without extension name by VBA. I know <code>ActiveWorkbook.Name</code> property , but if user haves Windows property <code>Hide extensions for known file types</code> turn off, the result of my code will be [Name.Extension]. How can I return only name of Workbook independent of windows property?</p>\n\n<p>I try even <code>ActiveWorkbook.Application.Caption</code> but I can't customize this property.</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1421157269, "post_id": 27923570, "comment_id": 44244330, "body": "Interesting. I&#39;m not sure why the UDF would get called, but you could certainly stop it from happening by removing the dead code that you&#39;re not using anymore. (Comment it out if you don&#39;t want to lose it.)"}, {"owner": {"reputation": 1290, "user_id": 757395, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/13974f1875a428326adea5f9121a136c?s=128&d=identicon&r=PG", "display_name": "stifin", "link": "https://stackoverflow.com/users/757395/stifin"}, "edited": false, "score": 2, "creation_date": 1421159060, "post_id": 27923570, "comment_id": 44245483, "body": "I think part of the answer is that this should not be happening so it&#39;s possible you&#39;ve got something funky going on in the structure of your code. When you hit the breakpoint, you can try viewing your call stack (under the VBA View menu) to give you a clue as to where the call to your function came from"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1421165173, "post_id": 27923570, "comment_id": 44249738, "body": "Add a line <code>Debug.Print Application.Caller</code> to your function.  What does it output when you run a full recalculate?"}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1421167054, "post_id": 27923570, "comment_id": 44251106, "body": "rename the function, and see what fails?"}, {"owner": {"reputation": 652, "user_id": 4313030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3dca5d632772b88d49a337cdab2bcbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Jordi", "link": "https://stackoverflow.com/users/4313030/jordi"}, "edited": false, "score": 0, "creation_date": 1421276201, "post_id": 27923570, "comment_id": 44303049, "body": "I commented out the UDF, which results in slower execution of the Application.CalculateFullRebuild. I imagine not finding the functions becomes slower than calculating them."}, {"owner": {"reputation": 652, "user_id": 4313030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3dca5d632772b88d49a337cdab2bcbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Jordi", "link": "https://stackoverflow.com/users/4313030/jordi"}, "edited": false, "score": 0, "creation_date": 1421276273, "post_id": 27923570, "comment_id": 44303078, "body": "The call stack shows that the function is being called from non VBA code, which is being called in response to Aplication.CalculateFullRebuild."}, {"owner": {"reputation": 652, "user_id": 4313030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3dca5d632772b88d49a337cdab2bcbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Jordi", "link": "https://stackoverflow.com/users/4313030/jordi"}, "edited": false, "score": 0, "creation_date": 1421276582, "post_id": 27923570, "comment_id": 44303204, "body": "I&#39;m gonna try the application.caller to see if it sheds new light. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1421216145, "post_id": 27924680, "comment_id": 44270519, "body": "OP states &quot;I deleted the calls to these functions from the cells&quot;.  If that is the case (big if) then the system would not be working as it should: a VBA function without any reference from a worksheet (or defined range, conditional formatting, etc) should not be triggered by a calculation."}, {"owner": {"reputation": 652, "user_id": 4313030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3dca5d632772b88d49a337cdab2bcbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Jordi", "link": "https://stackoverflow.com/users/4313030/jordi"}, "edited": false, "score": 0, "creation_date": 1421276443, "post_id": 27924680, "comment_id": 44303147, "body": "To my best knowledge, that is the case. I do not recall using those UDFs neither in contitional formatting nor defined ranges, but I&#39;ll check. I will also check for hidden or veryHidden sheets. Any other place where it could be hidden?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 652, "user_id": 4313030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3dca5d632772b88d49a337cdab2bcbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Jordi", "link": "https://stackoverflow.com/users/4313030/jordi"}, "edited": false, "score": 1, "creation_date": 1421277537, "post_id": 27924680, "comment_id": 44303559, "body": "@Jordi  First determine <b>how</b> the UDF is being called <b>MsgBox TypeName(Application.Caller)</b> within the UDF.  Then look for the <i>Parent</i> or the <i>Address</i>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1421160098, "creation_date": 1421160098, "answer_id": 27924680, "question_id": 27923570, "link": "https://stackoverflow.com/questions/27923570/unused-udf-being-called-when-doing-calculatefullrebuild/27924680#27924680", "title": "Unused UDF being called when doing CalculateFullRebuild", "body": "<p>The system is working as it should.  Consider:</p>\n\n<pre><code>Function qwerty() As String\n    qwerty = \"qwerty\"\n    MsgBox \"XX\"\nEnd Function\n</code></pre>\n\n<p>It is non-Volatile and has no arguments.  It will be calculated at the time it is entered in a worksheet cell.  <strong>Application.Calculate</strong> may cause it to be calculated <em>once,</em> however:</p>\n\n<pre><code>Sub ytrewq()\n    Application.CalculateFullRebuild\nEnd Sub\n</code></pre>\n\n<p>will cause the <em>UDF</em> to be re-calculated each time <em>ytrewq</em> is run.</p>\n"}, {"comments": [{"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1421175028, "post_id": 27924925, "comment_id": 44255725, "body": "Thats not correct: unused UDFs will not be called by Application.CalculateFullRebuid because they are not in the depenfdency chain. The dependency chain is built from worksheet formulas not VBA code."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1421175170, "post_id": 27924925, "comment_id": 44255803, "body": "@CharlesWilliams How is <code>CalculateFullRebuild</code> calling the UDFs then?"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 1, "creation_date": 1421175388, "post_id": 27924925, "comment_id": 44255941, "body": "The most likely explanation is the UDF is being used in a formula that the OP has not yet found - maybe a hidden sheet or a defined name or a conditional format or a shape or .... Thats why Tim Williams suggestion of using Application.Caller to find out where its being called from is a asensible approach"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 0, "last_activity_date": 1421162452, "last_edit_date": 1421162452, "creation_date": 1421160890, "answer_id": 27924925, "question_id": 27923570, "link": "https://stackoverflow.com/questions/27923570/unused-udf-being-called-when-doing-calculatefullrebuild/27924925#27924925", "title": "Unused UDF being called when doing CalculateFullRebuild", "body": "<p><code>Application.CalculateFullRebuild</code> <a href=\"http://msdn.microsoft.com/en-us/library/office/ff822609%28v=office.15%29.aspx\" rel=\"nofollow\">MSDN reference</a> has this to say:</p>\n\n<blockquote>\n  <p>The <code>CalculateFullRebuild</code> method is similar to re-entering all formulas. ... [When run] a full calculation of the data in all open workbooks is performed and the dependencies are rebuilt.</p>\n</blockquote>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/bb687891%28v=office.15%29.aspx\" rel=\"nofollow\">Further MSDN reference</a> states:</p>\n\n<blockquote>\n  <p>Causes Excel to rebuild the dependency tree and the calculation chain</p>\n</blockquote>\n\n<p>This means that any UDFs in the module code or sheet code will be recalculated because Excel is rebuilding and testing functions for dependency and use in the calculation chain.</p>\n\n<p>If you are looking for a way to simply manually calculate the existing formulas in the sheet via your <code>Sub</code>, you can use <a href=\"http://msdn.microsoft.com/en-us/library/office/ff195517%28v=office.15%29.aspx\" rel=\"nofollow\">'Application.Calculate' (MSDN)</a>:</p>\n\n<pre><code>Application.Calculate 'for all open Sheets\nSheets(\"Name of Sheet\").Calculate 'Specific Sheet\nSheets(\"Name of Sheet\").Range(\"Name of Range\").Calculate 'Specific Range\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 652, "user_id": 4313030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3dca5d632772b88d49a337cdab2bcbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Jordi", "link": "https://stackoverflow.com/users/4313030/jordi"}, "is_accepted": false, "score": 0, "last_activity_date": 1471363570, "last_edit_date": 1471363570, "creation_date": 1421276907, "answer_id": 27954169, "question_id": 27923570, "link": "https://stackoverflow.com/questions/27923570/unused-udf-being-called-when-doing-calculatefullrebuild/27954169#27954169", "title": "Unused UDF being called when doing CalculateFullRebuild", "body": "<p>To the moment my approach has been commenting all the code inside the UDF with two objectives: increasing speed on one side and checking if any side effect happened on the other side. To the moment, I have not observed any side effect, so more to the point that they are not being used anywhere.</p>\n\n<p>Right now the application I'm developing is working quite well, but I'll try the solutions you're proposing just out of curiosity. By bets are on either it's being used somewhere hidden and forgoten or simply that I have some rubbish inide the workbook structure that is not getting cleaned.</p>\n\n<p>Thanks!</p>\n\n<h2>Update</h2>\n\n<p>Tried again the next day and those UDF are no longer being called. Thus, I'll have to assume that something odd was going on with Excel that went away when I restarted it.</p>\n\n<p>Anyway, thanks a lot for the Application.Caller thing, which I didn't know about.</p>\n"}], "owner": {"reputation": 652, "user_id": 4313030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3dca5d632772b88d49a337cdab2bcbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Jordi", "link": "https://stackoverflow.com/users/4313030/jordi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 27924925, "answer_count": 3, "score": 4, "last_activity_date": 1471363570, "creation_date": 1421156661, "last_edit_date": 1421162862, "question_id": 27923570, "link": "https://stackoverflow.com/questions/27923570/unused-udf-being-called-when-doing-calculatefullrebuild", "title": "Unused UDF being called when doing CalculateFullRebuild", "body": "<p>I have some User Defined Functions in an Excel book. I used them for a while but, after a while, I deleted the calls to these functions from the cells because I found a better way to accomplish the same task (I didn't delete the function definition itself in the VBA editor). So, these functions are no longer being called neither in the book nor from any VBA code, I checked it using a search to be 100% sure.</p>\n\n<p>Now I'm doing some review on my code and I noticed something strange: in a Sub procedure in the same workbook (which has nothing to do with these functions) I call <code>Application.CalculateFullRebuild</code>. When this happens those UDF get called, I can see it by setting a break point inside the UDF. </p>\n\n<p>I'd like to know why is it happening and what can be done to avoid it, as it is slowing that Sub unnecessarily. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 1, "creation_date": 1421156528, "post_id": 27923460, "comment_id": 44243896, "body": "Try looking into <code>Private Sub Workbook_BeforeClose(Cancel As Boolean)</code>"}, {"owner": {"reputation": 53, "user_id": 4449443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a89b72e18ccc78297372e18995bd10?s=128&d=identicon&r=PG&f=1", "display_name": "RiveR", "link": "https://stackoverflow.com/users/4449443/river"}, "edited": false, "score": 0, "creation_date": 1421156720, "post_id": 27923460, "comment_id": 44244003, "body": "I guess that will do. Am I supposed to close this question now?"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421156852, "post_id": 27923460, "comment_id": 44244079, "body": "You don&#39;t have to, it&#39;s probably been flagged, and if it&#39;s viewed as being a duplicate, it will get closed.  If someone wants to write up a formal answer, you can select it or write your own answer.  Keep in mind, you don&#39;t want a high ratio of deleted questions.  If you delete too many of your own questions, there can be a temporary question ban.  So I&#39;d leave it to the moderators to decide in this case.  It&#39;s not cut and dry anyway.  you are using the same event, but with different requirements.  If you needed help specifically with the sub that gets called, I&#39;d LEAVE it OPEN."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421157462, "post_id": 27923460, "comment_id": 44244450, "body": "You had <code>Now - 2</code>, but yesterday would be <code>now - 1</code> also."}], "answers": [{"tags": [], "owner": {"reputation": 4959, "user_id": 783421, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7634fc50bf44d5c0e9e5cd819fb912ad?s=128&d=identicon&r=PG", "display_name": "Qbik", "link": "https://stackoverflow.com/users/783421/qbik"}, "is_accepted": false, "score": 2, "last_activity_date": 1421156722, "creation_date": 1421156722, "answer_id": 27923592, "question_id": 27923460, "link": "https://stackoverflow.com/questions/27923460/vba-excel-action-when-closing-workbook/27923592#27923592", "title": "VBA Excel action when closing workbook", "body": "<p>You should use <code>Workbook.BeforeClose</code> event :\n<a href=\"http://msdn.microsoft.com/en-us/library/office/ff194765%28v=office.15%29.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/office/ff194765%28v=office.15%29.aspx</a></p>\n\n<p>to do that in project window in VBA editor you have to use ThisWorkbook and place your code there. Your code will work only for workbooks modified in this way.</p>\n"}, {"tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": true, "score": 11, "last_activity_date": 1421157364, "creation_date": 1421157364, "answer_id": 27923799, "question_id": 27923460, "link": "https://stackoverflow.com/questions/27923460/vba-excel-action-when-closing-workbook/27923799#27923799", "title": "VBA Excel action when closing workbook", "body": "<p><strong>This is using the Workbook code:</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Call sbWriteCellWhenClosing\nEnd Sub\n</code></pre>\n\n<p><strong>In a separate Module:</strong></p>\n\n<pre><code>Sub sbWriteCellWhenClosing()\n\n    ActiveSheet.Range(\"G2\") = Format(Now - 1, \"dd-mm-yy\")   '-1 for yesterday\n    ActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4449443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a89b72e18ccc78297372e18995bd10?s=128&d=identicon&r=PG&f=1", "display_name": "RiveR", "link": "https://stackoverflow.com/users/4449443/river"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33172, "favorite_count": 0, "closed_date": 1589394715, "accepted_answer_id": 27923799, "answer_count": 2, "score": 4, "last_activity_date": 1589394430, "creation_date": 1421156224, "last_edit_date": 1589394430, "question_id": 27923460, "link": "https://stackoverflow.com/questions/27923460/vba-excel-action-when-closing-workbook", "closed_reason": "Duplicate", "title": "VBA Excel action when closing workbook", "body": "<p>Is it possible automatically let Excel do an action when someone closes the file?</p>\n\n<p>Situation:\nI have an Excel file which is also used by several other people. This file publishes a mhtml file whens saving. This mhtml file will be saved with the date of yesterday like \"Dashboard 2015-01-12\". The seen data in the mhtml file has to contain the date related to the file name. The data seen depends on a single cell in this excel file, G2.</p>\n\n<p>I want the Excel file to do this: \nchange a single cell (G2) into the date of yesterday. Then save it. Then close it.</p>\n\n<p>I want this action to be done:\nwhen someone is closing the file.</p>\n\n<p>Code I have so far:</p>\n\n<pre>Sub sbWriteCellWhenClosing()\n\nWorkbooks(\"BOOK1.XLS\").Close SaveChanges:=True\nRange(\"G2\") = Format(Now - 2, dd - mm - yy)\n\nEnd Sub</pre>\n\n<p>Edit:</p>\n\n<p>Will this do the job?</p>\n\n<pre>\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n  Range(\"G2\") = Format(Now - 1, dd - mm - yy)\n   ActiveWorkbook.Close SaveChanges:=True\nEnd Sub\n</pre>\n"}, {"tags": ["vba", "powerpoint", "powerpoint-2010"], "comments": [{"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 1, "creation_date": 1421154660, "post_id": 27922768, "comment_id": 44242782, "body": "It&#39;s not clear to me whether you&#39;re asking how to change the Default Save Format of Powerpoint 2010 to one that includes macros (.pptm) or whether you want to use a macro to change the Default Save Format. Which one is it?"}], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1421162660, "creation_date": 1421162660, "answer_id": 27925528, "question_id": 27922768, "link": "https://stackoverflow.com/questions/27922768/defaultsaveformat-for-powerpoint-2010/27925528#27925528", "title": "DefaultSaveFormat for Powerpoint 2010", "body": "<p>In code, there's a constant that tells PPT to save as Default ... meaning in whatever format PPT deems correct.  You can't force that, but you can, again in code, tell PPT to save in any specific format.</p>\n\n<p>You can change the format it saves in by default when the USER does a File | Save As in the File | Options | Save dialog box.  </p>\n"}], "owner": {"reputation": 9, "user_id": 4449346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6eddac49def39bcc8060f889bdc225?s=128&d=identicon&r=PG&f=1", "display_name": "Trampi", "link": "https://stackoverflow.com/users/4449346/trampi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421162660, "creation_date": 1421153859, "question_id": 27922768, "link": "https://stackoverflow.com/questions/27922768/defaultsaveformat-for-powerpoint-2010", "title": "DefaultSaveFormat for Powerpoint 2010", "body": "<p>How do I set the DefaultSaveFormat for Powerpoint 2010 for the Powerpoint with macro version?</p>\n"}, {"tags": ["excel", "rows", "hidden", "vba"], "comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421155953, "post_id": 27922641, "comment_id": 44243542, "body": "It might help if you described what range you are trying to get, because from looking at the formula, it&#39;s hard to determine if you have it right or wrong.  Are you debugging using your Locals Window? To check and make sure the Ranges are what you expect?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1421156523, "post_id": 27922641, "comment_id": 44243890, "body": "In the first row, <code>Cells</code> and <code>Rows</code> have a leading period.  This means they must be within a With statement.  Perhaps showing the entire block of code would help."}, {"owner": {"reputation": 51, "user_id": 4303658, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ba6543e127bef28dea4097026899514e?s=128&d=identicon&r=PG&f=1", "display_name": "Samatar", "link": "https://stackoverflow.com/users/4303658/samatar"}, "edited": false, "score": 0, "creation_date": 1421224729, "post_id": 27922641, "comment_id": 44273859, "body": "I have just figured out why it was not working, there were some rows hidden and therefore was throwing up an error. I have now added a line to show all cells before the code gets to work. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4303658, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ba6543e127bef28dea4097026899514e?s=128&d=identicon&r=PG&f=1", "display_name": "Samatar", "link": "https://stackoverflow.com/users/4303658/samatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1421224850, "creation_date": 1421224850, "answer_id": 27938757, "question_id": 27922641, "link": "https://stackoverflow.com/questions/27922641/hiding-rows-that-have-the-symbol-form-of-x-in-it/27938757#27938757", "title": "Hiding rows that have the symbol form of &quot;x&quot; in it", "body": "<p>Show all hidden rows first.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Filter_Sheet()\r\n    Dim ws As Worksheet\r\n    Dim Target As Range\r\n    Dim rng1 As Range\r\n    Dim rng2 As Range\r\n    Dim rng3 As Range\r\n    Dim sizey As Long\r\n    Dim Drows As Long\r\n    Dim Cell As Range\r\n              \r\n    Set ws = Worksheets(\"Measurement Signal List - SPA\")\r\n    Set ws1 = Worksheets(\"Measurement Info Sheet\")\r\n    Set ws2 = Worksheets(\"Filter Page\")\r\n   'Show hidden cells \r\n    ws2.Cells.EntireRow.Hidden = False\r\n    \r\n    If ActiveCell.Column &gt; 1 Then\r\n        MsgBox (\"Please choose File name from Column 1\")\r\n        Exit Sub\r\n    End If\r\n    If IsEmpty(ActiveCell) Then\r\n        MsgBox (\"Please choose a file\")\r\n        Exit Sub\r\n    End If\r\n   \r\n    With ws\r\n        Set Target = .Cells.Find(What:=ActiveCell.Value, After:=.Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)\r\n        If Not Target Is Nothing Then\r\n          Set rng1 = ws.Range(Target, .Cells(.Rows.Count, Target.Column).End(xlUp))\r\n          'Identify next empty range in final sheet\r\n            sizey = rng1.Rows.Count\r\n            Drows = sizey + 6\r\n            \r\n          Set rng2 = ws2.Range(ws2.Cells(7, 2), ws2.Cells(Drows, 2))\r\n          rng2.Value = rng1.Value\r\n                   \r\n          For Each Cell In rng2\r\n          If Cell.Value = ChrW(&amp;HFB) Then\r\n          Cell.EntireRow.Hidden = True\r\n          End If\r\n          If Cell.Value = ChrW(&amp;HFC) Then\r\n          Cell.Interior.Color = RGB(6, 232, 49)\r\n          End If\r\n          Next Cell\r\n                                 \r\n              Else\r\n            MsgBox \"File not found\"\r\n        End If\r\n    End With\r\n    \r\n    Set rng3 = ws2.Range(\"A1\")\r\n    Application.Goto Reference:=rng3, Scroll:=True\r\n    \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 51, "user_id": 4303658, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ba6543e127bef28dea4097026899514e?s=128&d=identicon&r=PG&f=1", "display_name": "Samatar", "link": "https://stackoverflow.com/users/4303658/samatar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 27938757, "answer_count": 1, "score": 0, "last_activity_date": 1421224850, "creation_date": 1421153437, "last_edit_date": 1531164843, "question_id": 27922641, "link": "https://stackoverflow.com/questions/27922641/hiding-rows-that-have-the-symbol-form-of-x-in-it", "title": "Hiding rows that have the symbol form of &quot;x&quot; in it", "body": "<p>I have part of a script in which I want to hide all rows containing the symbol \"x\" which is in font \"wingdings\" known as <code>ChrW(&amp;HFB)</code>. The code below seems to throw up error 1004. However I do not know how to get around it? Any suggestions ?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Set rng1 = ws.Range(Target, .Cells(.Rows.Count, Target.Column).End(xlUp))\r\n\r\n'Identify next empty range in final sheet\r\nsizey = rng1.Rows.Count\r\nDrows = sizey + 6\r\n        \r\nSet rng2 = ws2.Range(ws2.Cells(7, 2), ws2.Cells(Drows, 2))\r\nrng2.Value = rng1.Value\r\n      \r\nFor Each Cell In rng2\r\n    If Cell.Value = ChrW(&amp;HFB) Then\r\n        .EntireRow.Hidden = True\r\n    End If\r\nNext Cell</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "loops", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421153369, "post_id": 27922566, "comment_id": 44242067, "body": "Alex, what is the difference in terms of memory allocation of using Variants instead of Strings in this example?  I&#39;m curious."}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1421153503, "post_id": 27922566, "comment_id": 44242148, "body": "Thanks Alex, when I used variants it didn&#39;t appear to loop through as the message box gave the same sheet name every time"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1421153518, "post_id": 27922566, "comment_id": 44242159, "body": "A variant::string is the size + something like 20 bytes overhead so its completely trivial"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 2, "creation_date": 1421250912, "post_id": 27922566, "comment_id": 44289024, "body": "Please do not encourage beginners to use <code>Select</code>."}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1421314044, "post_id": 27922566, "comment_id": 44314132, "body": "What would you suggest other than select?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1422097128, "post_id": 27922566, "comment_id": 44622848, "body": "@squarah The poster of a question or an answer is told if comments are posted against it.  If you want others to know you have posted a comment you must include @ name as I have. I only sure your comment because I check back every week or so."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1422097264, "post_id": 27922566, "comment_id": 44622876, "body": "@squarah <code>Select</code> is not recommended because it is a slow command and with many sheets across multiple workbooks it can become very confusing.  In my answer I used <code>With</code> which is the recommended approach."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": -2, "last_activity_date": 1421153249, "creation_date": 1421153249, "answer_id": 27922566, "question_id": 27922453, "link": "https://stackoverflow.com/questions/27922453/loop-through-specified-sheets-in-vba/27922566#27922566", "title": "loop through specified sheets in VBA", "body": "<p>Use variants instead of worksheets.</p>\n\n<p><code>Array</code> returns a Variant array of string so cant be cast to <code>Worksheet</code>, the <code>Each</code> variable must be a <code>Variant</code>.</p>\n\n<pre><code>Dim Assets As Variant\nDim Asset  As Variant\n\nAssets = Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\")\n\nFor Each Asset In Assets\n    'my code here\n    Sheets(Asset).Select\n    MsgBox ActiveSheet.Name 'test loop\nNext Asset\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "is_accepted": false, "score": 4, "last_activity_date": 1421159676, "last_edit_date": 1421159676, "creation_date": 1421153424, "answer_id": 27922632, "question_id": 27922453, "link": "https://stackoverflow.com/questions/27922453/loop-through-specified-sheets-in-vba/27922632#27922632", "title": "loop through specified sheets in VBA", "body": "<p>Solved it but always happy to hear other methods</p>\n\n<pre><code>Sub loopsheets()\n\nDim Sh As Worksheet\nFor Each Sh In Sheets(Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\"))\n\nMsgBox Sh.Range(\"b1\")\n\nNext\nEnd Sub\n</code></pre>\n\n<p>Cheers</p>\n"}, {"comments": [{"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1421313415, "post_id": 27948869, "comment_id": 44313786, "body": "Thanks for your input. As I am tasked with creating VBA programs with very little programming experience I am prone to taking shortcuts."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 1, "creation_date": 1421313926, "post_id": 27948869, "comment_id": 44314063, "body": "@squarah  Across the world it seems managers are expecting staff to develop programs just be asking questions on the internet. You appear to have acquired some experience since you demonstrated a better class of confusion than many. As you have discovered there are people here who are happy to help.  Welcome to the joys of programming."}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1421314719, "post_id": 27948869, "comment_id": 44314496, "body": "Cheers @Tony Dallimore"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 1, "creation_date": 1495694706, "post_id": 27948869, "comment_id": 75363019, "body": "@TonyDallimore thanks for that wonderful explanation. You should write a book."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 1, "creation_date": 1495741345, "post_id": 27948869, "comment_id": 75391003, "body": "@Mertinc  Thanks for the positive feedback.  I am trying to create an introduction to Outlook VBA within the SO documentation pages.  My difficulty is finding the time.."}, {"owner": {"reputation": 257, "user_id": 3092948, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/60bbd96ddbe583c0dbb6361328e19666?s=128&d=identicon&r=PG&f=1", "display_name": "Zeretil", "link": "https://stackoverflow.com/users/3092948/zeretil"}, "edited": false, "score": 1, "creation_date": 1503583573, "post_id": 27948869, "comment_id": 78685858, "body": "Very late but just wanted to thank you @TonyDallimore, since pointing out I shouldn&#39;t use ActiveX and showing how to use &quot;With X&quot; and the &quot;.&quot; syntax has greatly helped me in building this project I am working on."}, {"owner": {"reputation": 457, "user_id": 11832197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U8ZO6LVb3x8/AAAAAAAAAAI/AAAAAAAAAWg/8gxyuHZSKdA/photo.jpg?sz=128", "display_name": "Antonio Santos", "link": "https://stackoverflow.com/users/11832197/antonio-santos"}, "edited": false, "score": 0, "creation_date": 1603802374, "post_id": 27948869, "comment_id": 114146589, "body": "This is a heck of an answer!"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 19, "last_activity_date": 1421256414, "creation_date": 1421256414, "answer_id": 27948869, "question_id": 27922453, "link": "https://stackoverflow.com/questions/27922453/loop-through-specified-sheets-in-vba/27948869#27948869", "title": "loop through specified sheets in VBA", "body": "<p>The code you show in your question fails because of:</p>\n\n<pre><code>Assets = Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\")\n</code></pre>\n\n<p><code>Assets</code> is a Worksheet which is a type of Object and you must use <code>Set</code> when assigning a value to an Object:</p>\n\n<pre><code>Set Assets = Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\")\n</code></pre>\n\n<p>This would fail because <code>Array(\"\u2026\")</code> is not a worksheet.</p>\n\n<p>You imply that an earlier version of your code would run but did not loop through the worksheets.  The reason is:</p>\n\n<pre><code>MsgBox ActiveSheet.Name\n</code></pre>\n\n<p>This displays the name of the active worksheet but nothing in this loop changes the active worksheet.</p>\n\n<p>I am not happy with your solution although there is nothing explicitly wrong with it.  I have seen too many programs fail because the programmer did too much in a single statement.  Firstly, the more complicated a statement, the longer it will take to get right in the first place and the longer it takes to understand during subsequent maintenance.  Sometimes the original programmer got the statement slightly wrong; sometimes the maintenance programmer got it wrong when trying to update it.  In every case, any saving in runtime was not justified by the extra time spend by the programmers.</p>\n\n<p>Alex K has fixed your code by redefining <code>Assets</code> and <code>Asset</code> as Variants, as required by VBA, and adding <code>Sheets(Asset).Select</code> to change which worksheet is active.  I cannot approve of this because <code>Select</code> is a slow statement.  In particular, if you do not include <code>Application.ScreenUpdating = False</code>, the duration of your routine can go through the roof as the screen is repainted from each <code>Select</code>.</p>\n\n<p>Before explaining my solutions, some background on Variants.</p>\n\n<p>If I write:</p>\n\n<pre><code>Dim I as Long\n</code></pre>\n\n<p><code>I</code> will always be a long integer.  </p>\n\n<p>At runtime, the compiler/interpreter does not have to consider what <code>I</code> is when it encounters:</p>\n\n<pre><code> I = I + 5\n</code></pre>\n\n<p>But suppose I write:</p>\n\n<pre><code>Dim V as Variant\n\nV = 5\nV = V + 5\nV = \"Test\"\nV = V &amp; \" 1\"\n</code></pre>\n\n<p>This is perfectly valid (valid but not sensible) code because a Variant can contain a number, a string or a worksheet.  But every time my code accesses V, the interpreter has to check the type of the current contents of V and decide if it is appropriate in the current situation.  This is time consuming.</p>\n\n<p>I do not want to discourage you from using Variants when appropriate because they can be incredibly useful but you need to be aware of their overheads.</p>\n\n<p>Next I wish to advocate the use of meaningful and systematic names.  I name my variables according to a system that I have used for years.  I can look at any of my programs/macros and know what the variables are.  This is a real time saver when I need to update a program/macro I wrote 12 or 15 months ago.</p>\n\n<p>I do not like:</p>\n\n<pre><code>Dim Assets As Variant\nAssets = Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\")\n</code></pre>\n\n<p>because \"pipe_mat_tables\" and so on are not assets; they are the names of worksheets.  I would write:</p>\n\n<pre><code>Dim WshtNames As Variant\nWshtNames = Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\")\n</code></pre>\n\n<p>My first offering is:</p>\n\n<pre><code>Option Explicit\nSub Test1()\n\n  Dim WshtNames As Variant\n  Dim WshtNameCrnt As Variant\n\n  WshtNames = Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\")\n\n  For Each WshtNameCrnt In WshtNames\n    With Worksheets(WshtNameCrnt)\n      Debug.Print \"Cell B1 of worksheet \" &amp; .Name &amp; \" contains \" &amp; .Range(\"B1\").Value\n    End With\n  Next WshtNameCrnt\n\nEnd Sub\n</code></pre>\n\n<p>I could have named <code>WshtNameCrnt</code> as <code>WshtName</code> but I was taught that names should differ by at least three characters to avoid using the wrong one and not noticing.</p>\n\n<p>The <code>Array</code> function returns a variant containing an array.  The control variable of a <code>For Each</code> statement must be an object or a variant.  This is why I have defined <code>WshtNames</code> and <code>WshtNameCrnt</code> as Variants.  Note, your solution worked because a worksheet is an object.</p>\n\n<p>I have used <code>With Worksheets(WshtNameCrnt)</code> which means any code before the matching <code>End With</code> can access a component of this worksheet by having a period at the beginning.  So <code>.Name</code> and <code>.Range(\"B1\").Value</code> reference <code>Worksheets(WshtNameCrnt)</code> without selecting the worksheet.  This is faster and clearer than any alternative.</p>\n\n<p>I have used <code>Debug.Print</code> rather than <code>MsgBox</code> because it is less bother.  My code runs without my having to press <kbd>Return</kbd> for every worksheet and I have a tidy list in the Immediate Window which I can examine at my leisure.  I often have many <code>Debug.Print</code> statements within my code during development which why I have output a sentence rather than just a worksheet name or cell value.</p>\n\n<p>My second offering is:</p>\n\n<pre><code>Sub Test2()\n\n  Dim InxW As Long\n  Dim WshtNames As Variant\n\n  WshtNames = Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\")\n\n  For InxW = LBound(WshtNames) To UBound(WshtNames)\n     With Worksheets(WshtNames(InxW))\n      Debug.Print \"Cell B1 of worksheet \" &amp; .Name &amp; \" contains \" &amp; .Range(\"B1\").Value\n    End With\n  Next InxW\n\nEnd Sub\n</code></pre>\n\n<p>This macro has the same effect as the first.  I sometimes find <code>For</code> more convenient than <code>For Each</code> although I can see no advantage either way in this case.  Note that I have written <code>LBound(WshtNames)</code> even though the lower bound of WshtNames will always be zero.  This is just me being (over? excessively?) precise.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37639, "favorite_count": 5, "accepted_answer_id": 27948869, "answer_count": 3, "score": 2, "last_activity_date": 1531482871, "creation_date": 1421152917, "last_edit_date": 1495540018, "question_id": 27922453, "link": "https://stackoverflow.com/questions/27922453/loop-through-specified-sheets-in-vba", "title": "loop through specified sheets in VBA", "body": "<p>I am trying to use a bit of code I found here <a href=\"https://stackoverflow.com/questions/21761697/for-each-function-to-loop-through-specifically-named-worksheets\">For Each Function, to loop through specifically named worksheets</a> to loop through specified sheets in a workbook, run a small amount of code and move to next sheet.</p>\n\n<pre><code>Sub LoopThroughSheets()\nDim Assets As Worksheet\nDim Asset As Worksheet\n\n\nAssets = Array(\"pipe_mat_tables\", \"pipe_diam_tables\", \"pipe_length_tables\")\nFor Each Asset In Assets\n'my code here\n   MsgBox ActiveSheet.Name 'test loop\n\nNext Asset\n\nEnd Sub\n</code></pre>\n\n<p>This is not looping through the sheets. I tried <code>Dim Assets as Worksheet</code> but this broke the code. </p>\n\n<p>Any help much appreciated,</p>\n\n<p>Cheers</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421151807, "post_id": 27922065, "comment_id": 44241147, "body": "You are looking at Range C2:C100, If it&#39;s not empty, copy the data to the same sheet, Column A?"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421152264, "post_id": 27922065, "comment_id": 44241400, "body": "The problem with <code>Set PartListRange = Sheets(&quot;Query&quot;).Range(&quot;C2:100&quot;)1</code> is <code>C2:C100</code>"}, {"owner": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "reply_to_user": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421152671, "post_id": 27922065, "comment_id": 44241650, "body": "copy the data one at a time only in to cell &quot;A2&quot; :)"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "edited": false, "score": 0, "creation_date": 1421152066, "post_id": 27922175, "comment_id": 44241308, "body": "This doesn&#39;t fix the error. Excel is saying the error is something to do with the line Set PartListRange = Sheets(&quot;Query&quot;).Range(&quot;C2:100&quot;)"}, {"owner": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "edited": false, "score": 0, "creation_date": 1421152698, "post_id": 27922175, "comment_id": 44241661, "body": "Thank you for fixing my bad spelling ;-)"}], "tags": [], "owner": {"reputation": 87, "user_id": 2579942, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e5c065b9f920bd3a994c4bc4455e9095?s=128&d=identicon&r=PG", "display_name": "Box", "link": "https://stackoverflow.com/users/2579942/box"}, "is_accepted": false, "score": 0, "last_activity_date": 1421151970, "creation_date": 1421151970, "answer_id": 27922175, "question_id": 27922065, "link": "https://stackoverflow.com/questions/27922065/excel-vba-iteration-copy-and-paste/27922175#27922175", "title": "Excel VBA Iteration Copy and Paste", "body": "<pre><code>If Cel.Value &lt;&gt; \"\" Then\n</code></pre>\n\n<p>you spelt Cell wrong</p>\n\n<pre><code>ParListCell\n</code></pre>\n\n<p>and Part :P</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "edited": false, "score": 0, "creation_date": 1421152521, "post_id": 27922227, "comment_id": 44241555, "body": "How would I edit this so that each cell it copied, it was only pasted in to cell &quot;A2&quot;?"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "edited": false, "score": 0, "creation_date": 1421152626, "post_id": 27922227, "comment_id": 44241628, "body": "Do you mean A2 for every row?  You would only see the last one done.  Because they&#39;d all rewrite it.  If you wanted to do that, you&#39;d say <code>.Cells(2,&quot;A&quot;)</code> instead of <code>(lRow, &quot;A&quot;)</code>"}, {"owner": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "edited": false, "score": 0, "creation_date": 1421152971, "post_id": 27922227, "comment_id": 44241834, "body": "Yeah that&#39;s what I want it do. Eventually I will call another macro after each iteration to gather data based on the data in Cell &quot;A2&quot;."}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "edited": false, "score": 0, "creation_date": 1421153023, "post_id": 27922227, "comment_id": 44241873, "body": "Revised to pause with MsgBox"}, {"owner": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "edited": false, "score": 0, "creation_date": 1421675526, "post_id": 27922227, "comment_id": 44437552, "body": "how do I change this line of code to work with columns and not rows?? lastRow = Sheets(sName).Range(&quot;C&quot; &amp; Rows.count).End(xlUp).row"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "edited": false, "score": 0, "creation_date": 1421767860, "post_id": 27922227, "comment_id": 44480306, "body": "<code>lastCol = Sheets(sName).Cells(1, Columns.count).End(xlToLeft).column</code> Where 1 is the column header row.  It&#39;s best to use the headers, knowing that you have data in that row.  <code>Dim lastCol As Long</code>"}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": true, "score": 1, "last_activity_date": 1421154344, "last_edit_date": 1421154344, "creation_date": 1421152180, "answer_id": 27922227, "question_id": 27922065, "link": "https://stackoverflow.com/questions/27922065/excel-vba-iteration-copy-and-paste/27922227#27922227", "title": "Excel VBA Iteration Copy and Paste", "body": "<p>This is a slightly different way of doing the same thing, using <code>.Cells(row,col)</code> and setting the values using a loop.</p>\n\n<p>Using lastRow, instead of row 100.  You can change that if need be.  I'm including it, because most times that's needed.</p>\n\n<p><strong>What this does:</strong></p>\n\n<ul>\n<li><p>Loop through the range of 2-100 or 2-lastRow, depending on your choice.</p></li>\n<li><p>Check the value in column \"C\" to make sure it isn't empty.</p></li>\n<li><p>If not empty, copy to Range(\"A2\").  (note, each iteration that the conditions match will over-write)</p></li>\n<li><p>Pause in the action to run a macro or call another sub, using a MsgBox, in this example as a placeholder</p></li>\n</ul>\n\n<p><strong>Code:</strong>  Un-comment lines related to lastRow to utilize it.</p>\n\n<pre><code>Sub conditionalCopy()\n\n'Dim lastRow As Long\nDim lRow As Long\nDim sName As String\n\n    sName = \"Query\"\n    'lastRow = Sheets(sName).Range(\"C\" &amp; Rows.count).End(xlUp).row\n\n    'For lRow = 2 to lastRow        'Uncomment lastRow to use instead of 100 for max.\n    For lRow = 2 To 100             'Range(\"C2:C100\")    \n        If Sheets(sName).Cells(lRow, \"C\").Text &lt;&gt; \"\" Then\n            Sheets(sName).Range(\"A2\").Value = Sheets(sName).Cells(lRow, \"C\").Value\n            MsgBox(\"Here is your break in the action...\" &amp; vbNewLine &amp; _\n                   \"Press Enter to continue loop\")\n        End If\n    Next lRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 1350873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624398778242cb0e5299b9466e1ce936?s=128&d=identicon&r=PG", "display_name": "demonLaMagra", "link": "https://stackoverflow.com/users/1350873/demonlamagra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 0, "accepted_answer_id": 27922227, "answer_count": 2, "score": 0, "last_activity_date": 1421154344, "creation_date": 1421151597, "last_edit_date": 1531164843, "question_id": 27922065, "link": "https://stackoverflow.com/questions/27922065/excel-vba-iteration-copy-and-paste", "title": "Excel VBA Iteration Copy and Paste", "body": "<p>I'm trying to create a macro that declares a range of cells and copies and pastes each cell 1 at a time  in to cell \"A2\". This should only happen if the cell in column have data present.</p>\n\n<p>The error I'm getting is a Run-Time error '1004' Application-defined or object-defined error.</p>\n\n<p>I'm more from a C# background so I'm hoping its just a syntax error but this is what I have so far.</p>\n\n<p>Any help will be greatly appreciated.</p>\n\n<pre><code>Sub Update1()\n'\n' Update1 Macro\n' Update\n'\n  Dim PartListRange As Range\n  Dim PartListCell As Range\n\n  Set PartListRange = Sheets(\"Query\").Range(\"C2:100\")\n\n  For Each PartListCell In PartListRange.Cells\n     If Cell.Value &lt;&gt; \"\" Then\n         Worksheets(\"Query\").Range(PartListCell).Copy _\n         Destination:=Worksheets(\"Query\").Range(\"A2\")\n         ActiveWorkbook.RefreshAll\n     End If\n  Next PartListCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1034, "user_id": 3929836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccb963cb6f80474a86696d8adbabec5?s=128&d=identicon&r=PG&f=1", "display_name": "jas_raj", "link": "https://stackoverflow.com/users/3929836/jas-raj"}, "edited": false, "score": 2, "creation_date": 1421151178, "post_id": 27921782, "comment_id": 44240797, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/12426870/display-excel-vba-message-box-when-a-cell-within-a-range-changes-and-meets-a-giv\">Display Excel VBA message box when a cell within a range changes AND meets a given criteria</a>"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421154176, "post_id": 27921782, "comment_id": 44242519, "body": "Except that was closed for being not a real question."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4422492, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-70MfkxZLdPY/AAAAAAAAAAI/AAAAAAAAAE0/LA_R0cQtkZk/photo.jpg?sz=128", "display_name": "Juluru Karthik", "link": "https://stackoverflow.com/users/4422492/juluru-karthik"}, "edited": false, "score": 0, "creation_date": 1421216753, "post_id": 27922145, "comment_id": 44270721, "body": "Hi Liniel, actually my question is when Im changing the values in cells from yes to no, I should get a messgae / alert box, not by running the macro. Can you suggest me for that"}, {"owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "reply_to_user": {"reputation": 3, "user_id": 4422492, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-70MfkxZLdPY/AAAAAAAAAAI/AAAAAAAAAE0/LA_R0cQtkZk/photo.jpg?sz=128", "display_name": "Juluru Karthik", "link": "https://stackoverflow.com/users/4422492/juluru-karthik"}, "edited": false, "score": 0, "creation_date": 1421219550, "post_id": 27922145, "comment_id": 44271746, "body": "@JuluruKarhik if you won&#39;t use macro, so how you want to trigger your alert?"}], "tags": [], "owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1421152443, "last_edit_date": 1421152443, "creation_date": 1421151877, "answer_id": 27922145, "question_id": 27921782, "link": "https://stackoverflow.com/questions/27921782/how-to-get-alert-box-or-message-box-when-i-try-to-change-the-value-of-a-cell-in/27922145#27922145", "title": "how to get alert box or message box when i try to change the value of a cell in EXCEL", "body": "<pre><code>Public Sub Worksheet_change(ByVal Target As Range)\n\nDim YourCell As Range\nSet YourCell = Cells(1, 1)\n\nIf YourCell.Value = \"No\" Then\nMsgBox (\"YourAllert\"), vbExclamation\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4422492, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-70MfkxZLdPY/AAAAAAAAAAI/AAAAAAAAAE0/LA_R0cQtkZk/photo.jpg?sz=128", "display_name": "Juluru Karthik", "link": "https://stackoverflow.com/users/4422492/juluru-karthik"}, "edited": false, "score": 0, "creation_date": 1421216652, "post_id": 27922845, "comment_id": 44270682, "body": "Hi Peege, actually my question is when Im changing the values in cells from yes to no, I should get a messgae / alert box, not by running the macro. Can you suggest me for that"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 4422492, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-70MfkxZLdPY/AAAAAAAAAAI/AAAAAAAAAE0/LA_R0cQtkZk/photo.jpg?sz=128", "display_name": "Juluru Karthik", "link": "https://stackoverflow.com/users/4422492/juluru-karthik"}, "edited": false, "score": 1, "creation_date": 1421217781, "post_id": 27922845, "comment_id": 44271079, "body": "@JuluruKarthik - maybe you should try the suggested answer instead of assuming it doesn&#39;t do what you want."}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": true, "score": 0, "last_activity_date": 1421262063, "last_edit_date": 1421262063, "creation_date": 1421154140, "answer_id": 27922845, "question_id": 27921782, "link": "https://stackoverflow.com/questions/27921782/how-to-get-alert-box-or-message-box-when-i-try-to-change-the-value-of-a-cell-in/27922845#27922845", "title": "how to get alert box or message box when i try to change the value of a cell in EXCEL", "body": "<p>This should do what you are looking for.  It's going to do two things:</p>\n\n<ul>\n<li><p>Save the value of the selection, in a <code>_SelectionChange</code> event.</p></li>\n<li><p>Launch a separate <code>_Change</code> event and get the updated value.</p></li>\n<li><p>If the selection WAS a \"YES\", AND the new change is \"NO\" (checks for Upper-Lower)</p></li>\n<li><p>Display a Message</p></li>\n</ul>\n\n<p><strong>The variable needs to be outside the scope of either change event.</strong></p>\n\n<pre><code>Dim oldValue As Variant\n</code></pre>\n\n<p><strong>The selection change event:</strong></p>\n\n<pre><code>Public Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    oldValue = Target.Value\n\nEnd Sub\n</code></pre>\n\n<p><strong>The change event:</strong></p>\n\n<pre><code>Public Sub Worksheet_change(ByVal Target As Range)\n    If LCase(oldValue) = \"yes\" And LCase(Target.Value) = \"no\" Then\n        MsgBox (\"The value of \" &amp; Target.Address &amp; \" has changed from \" &amp; oldValue &amp; \" to: \" &amp; Target.Value)\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4422492, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-70MfkxZLdPY/AAAAAAAAAAI/AAAAAAAAAE0/LA_R0cQtkZk/photo.jpg?sz=128", "display_name": "Juluru Karthik", "link": "https://stackoverflow.com/users/4422492/juluru-karthik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 27922845, "answer_count": 2, "score": 0, "last_activity_date": 1424227196, "creation_date": 1421150751, "last_edit_date": 1531164843, "question_id": 27921782, "link": "https://stackoverflow.com/questions/27921782/how-to-get-alert-box-or-message-box-when-i-try-to-change-the-value-of-a-cell-in", "title": "how to get alert box or message box when i try to change the value of a cell in EXCEL", "body": "<p>I want to get a alert box or message box when any one changes the value of a cell in excel from \"Yes\" to \"No\".\nCan any one help me in acheiving this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1421150623, "post_id": 27921612, "comment_id": 44240497, "body": "If this is intended to go into AZ5:AZ13 then you need to put <i>AZ</i> into quotes. e.g. <code>Range(&quot;AZ&quot; &amp; BZ) = pfad</code>"}, {"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1421150703, "post_id": 27921612, "comment_id": 44240556, "body": "What are <code>AZ</code> and <code>BZ</code>? Depending on the values stored in those variables, you will potentially need some formatting inside the <code>Range</code> assignment."}, {"owner": {"reputation": 1, "user_id": 4449025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9edd7ac310120237711774731fa74f4?s=128&d=identicon&r=PG&f=1", "display_name": "P. Bombik", "link": "https://stackoverflow.com/users/4449025/p-bombik"}, "edited": false, "score": 0, "creation_date": 1421150988, "post_id": 27921612, "comment_id": 44240699, "body": "AZ is a String and BZ is a Integer. They are going down a row and they should inserting &#39;pfad&#39; in this row"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421155193, "post_id": 27921612, "comment_id": 44243125, "body": "I have to mention, you can use numbers to represent the Column, instead of using a string, with column letters.  If you have to go through a lot to do that.  Consider <code>.Cells(row, col)</code> where <code>row</code> and <code>col</code> are both <code>Long</code> type, (or integer, but preferably Long)"}, {"owner": {"reputation": 1, "user_id": 4449025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9edd7ac310120237711774731fa74f4?s=128&d=identicon&r=PG&f=1", "display_name": "P. Bombik", "link": "https://stackoverflow.com/users/4449025/p-bombik"}, "edited": false, "score": 0, "creation_date": 1421155738, "post_id": 27921612, "comment_id": 44243419, "body": "When i change it to &quot;Cells(AZ,BZ) = pfad there is still the same failure"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "edited": false, "score": 0, "creation_date": 1421160524, "post_id": 27921612, "comment_id": 44246541, "body": "it needs to be <code>Cells(BZ, AZ)</code>.  BZ is for a number representation of the ROW, and AZ is for the column, and can usually accept either letters as a string or numbers, in variable form.  How are you getting the value for AZ?  can you post that also?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4449025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9edd7ac310120237711774731fa74f4?s=128&d=identicon&r=PG&f=1", "display_name": "P. Bombik", "link": "https://stackoverflow.com/users/4449025/p-bombik"}, "edited": false, "score": 0, "creation_date": 1421158221, "post_id": 27923014, "comment_id": 44244934, "body": "There is still the same failure. In Debugmode its marking the Sheets(&quot;&quot;)... line"}, {"owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "reply_to_user": {"reputation": 1, "user_id": 4449025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9edd7ac310120237711774731fa74f4?s=128&d=identicon&r=PG&f=1", "display_name": "P. Bombik", "link": "https://stackoverflow.com/users/4449025/p-bombik"}, "edited": false, "score": 0, "creation_date": 1421160446, "post_id": 27923014, "comment_id": 44246477, "body": "How are you getting AZ?"}], "tags": [], "owner": {"reputation": 2449, "user_id": 4101237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909492203598c767566ab44379862ab7?s=128&d=identicon&r=PG&f=1", "display_name": "peege", "link": "https://stackoverflow.com/users/4101237/peege"}, "is_accepted": false, "score": 0, "last_activity_date": 1421155061, "last_edit_date": 1421155061, "creation_date": 1421154753, "answer_id": 27923014, "question_id": 27921612, "link": "https://stackoverflow.com/questions/27921612/runtime-error-1004-while-range-string/27923014#27923014", "title": "Runtime Error 1004 while Range = String", "body": "<p>This might be the assignment you are looking for.  </p>\n\n<pre><code>Dim As Integer   'Long, preferable\nDim AZ As String\nDim pfad As String\n\nSheets(\"SheetName\").Cells(BZ, AZ).Value = pfad\n</code></pre>\n\n<p>You will want to put that line after you've defined pfad instead of before it as well.</p>\n\n<pre><code>Do While z &lt; 9            \n    BZ = zeile + 5\n    z = z + 1\n    zeile = zeile + 1\n    zeileStr = CStr(zeile)\n    pfad = t1 &amp; tn &amp; t2 &amp; tn &amp; t3 &amp; kunde &amp; t4 &amp; datum &amp; t5 &amp; zeileStr\n\n    Sheets(\"SheetName\").Cells(BZ, AZ).Value = pfad\nLoop\n</code></pre>\n\n<p><strong>note:</strong> Wend is used for backwards compatibility more now.  Using <code>Do While... Loop</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4449025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9edd7ac310120237711774731fa74f4?s=128&d=identicon&r=PG&f=1", "display_name": "P. Bombik", "link": "https://stackoverflow.com/users/4449025/p-bombik"}, "is_accepted": false, "score": 0, "last_activity_date": 1421315441, "creation_date": 1421315441, "answer_id": 27960719, "question_id": 27921612, "link": "https://stackoverflow.com/questions/27921612/runtime-error-1004-while-range-string/27960719#27960719", "title": "Runtime Error 1004 while Range = String", "body": "<pre><code>Dim AZ As Long \nDim BZ As Long \nDim pfad As String \nDim zeile As Integer \nDim zeileStr As String \nDim z As Integer\n\ntn = Range(\"B3\")\nkunde = Range(\"B4\")\nzeile = 2\nAZ = 1\nBZ = 0\nzeileStr = CStr(zeile)\n</code></pre>\n\n<p>All  variables are defined or their values are i a cell.</p>\n\n<p>When i used the Range() order, AZ was a String. </p>\n"}], "owner": {"reputation": 1, "user_id": 4449025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9edd7ac310120237711774731fa74f4?s=128&d=identicon&r=PG&f=1", "display_name": "P. Bombik", "link": "https://stackoverflow.com/users/4449025/p-bombik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1500145925, "creation_date": 1421150274, "last_edit_date": 1531164843, "question_id": 27921612, "link": "https://stackoverflow.com/questions/27921612/runtime-error-1004-while-range-string", "title": "Runtime Error 1004 while Range = String", "body": "<p>I want to create a long String out of various Letters and some variables</p>\n\n<p>All variables are Strings.</p>\n\n<pre><code>pfad = t1 &amp; tn &amp; t2 &amp; tn &amp; t3 &amp; kunde &amp; t4 &amp; datum &amp; t5 &amp; zeileStr\n</code></pre>\n\n<p>After pfad has been created, id like to have this String or in other words this sentence in an specific Cell. This Cell should be choosen by 2 variables ( Row and column).\nHere my Code:</p>\n\n<pre><code>While z &lt; 9            \nBZ = zeile + 5\n\nRange(AZ &amp; BZ) = pfad  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; this is marked yellow, when im going to debug mode\nz = z + 1\nzeile = zeile + 1\nzeileStr = CStr(zeile)\npfad = t1 &amp; tn &amp; t2 &amp; tn &amp; t3 &amp; kunde &amp; t4 &amp; datum &amp; t5 &amp; zeileStr\nWend\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1431131599, "creation_date": 1431131599, "answer_id": 30134724, "question_id": 27921008, "link": "https://stackoverflow.com/questions/27921008/adjust-column-width-in-rangetohtml-for-outlook/30134724#30134724", "title": "Adjust column width in RangetoHTML for Outlook", "body": "<p>Try this</p>\n\n<pre><code>With TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n     Cells(1).Select\n     Cells(1).EntireRow.AutoFit\n     Cells(1).EntireColumn.AutoFit\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2360, "user_id": 5545315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/921Gk.png?s=128&g=1", "display_name": "darrylyeo", "link": "https://stackoverflow.com/users/5545315/darrylyeo"}, "edited": false, "score": 1, "creation_date": 1477339942, "post_id": 40226195, "comment_id": 67716880, "body": "Where does that code go? Show the entire code with your edit."}, {"owner": {"reputation": 20526, "user_id": 811240, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/04a9e3a116a19abc2dc8692378655c47?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/811240/mike"}, "edited": false, "score": 2, "creation_date": 1477399257, "post_id": 40226195, "comment_id": 67742338, "body": "Typically adding a bit of explanation to your answers instead of just &quot;try this&quot; goes a long way. Explain <i>why</i> the user should &quot;try this&quot;. Why is this better than what is currently being done? How does it solve the problem."}], "tags": [], "owner": {"reputation": 1, "user_id": 7066202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acae0d20cb71d47ba213ce9e1b675afd?s=128&d=identicon&r=PG&f=1", "display_name": "Vishu", "link": "https://stackoverflow.com/users/7066202/vishu"}, "is_accepted": false, "score": 0, "last_activity_date": 1477337871, "creation_date": 1477337871, "answer_id": 40226195, "question_id": 27921008, "link": "https://stackoverflow.com/questions/27921008/adjust-column-width-in-rangetohtml-for-outlook/40226195#40226195", "title": "Adjust column width in RangetoHTML for Outlook", "body": "<p>Try </p>\n\n<pre><code>    On Error GoTo 0\nEnd With\nTempWB.Sheets(1).UsedRange.Columns.AutoFit\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4448966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44baa142edbf537101ebb257242e2769?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/4448966/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2190, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1571751118, "creation_date": 1421148179, "last_edit_date": 1571751118, "question_id": 27921008, "link": "https://stackoverflow.com/questions/27921008/adjust-column-width-in-rangetohtml-for-outlook", "title": "Adjust column width in RangetoHTML for Outlook", "body": "<p>I send emails automatically from Excel.</p>\n\n<p>Sometimes the third column ends up completely at the right, outside the mail-window of the receiver (while I autofit the cells before I use RangetoHTML).</p>\n\n<p>It seems that the width of the second column is set much wider or that the third column is set wider and aligned right.</p>\n\n<p>The thing is that it doesn't happen every time. Adjusting the row heights is easily done but not the column width. </p>\n\n<p>How do I keep the width formatting constant in RangetoHTML?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function RangetoHTML(rng As Range)\n\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\nDim R As Long\n\nTempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n'Publish the sheet to a html file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.readall\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "locale", "powerpoint", "datetime-format"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1421163256, "post_id": 27920995, "comment_id": 44248373, "body": "I don&#39;t see any direct way of doing this; perhaps pass Format(Now,&quot;mm&quot;) and the LangID you want off to a function that looks up the return value from an array of month names that you provide, then build the rest of the date string from there.  Reasonable if you only need to support a few languages and easy enough to add more to.  Not so reasonable if the answer to &quot;What languages must you support?&quot; is &quot;All of them&quot;"}, {"owner": {"reputation": 1, "user_id": 4449002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9601f7ec290a3616a6141bb7d7b9aaf7?s=128&d=identicon&r=PG&f=1", "display_name": "mfh8010", "link": "https://stackoverflow.com/users/4449002/mfh8010"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1421169907, "post_id": 27920995, "comment_id": 44252808, "body": "seems wrong to write my own array of month names when MS already did the work...."}, {"owner": {"reputation": 1, "user_id": 4449002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9601f7ec290a3616a6141bb7d7b9aaf7?s=128&d=identicon&r=PG&f=1", "display_name": "mfh8010", "link": "https://stackoverflow.com/users/4449002/mfh8010"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1421170641, "post_id": 27920995, "comment_id": 44253263, "body": "...i can add a date placeholder on the header/footer - and i can change the locale for the date display via the dialog box...so all i would need to do is replicate this programmatically. But i can&#180;t find out where to do this...and strangely this dialog doesn&#180;t respond to changes in the Office language settings or the locale (default is US-English even after deleting this as an option in the Language preferences dialog)."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1421201625, "post_id": 27920995, "comment_id": 44267017, "body": "&quot;seems wrong to write my own array of month names when MS already did the work.... &quot;  Seems wrong that they don&#39;t expose it to us.  But since they didn&#39;t ..."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4153174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6729165b74e701a78473839c0158c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carpetbagger", "link": "https://stackoverflow.com/users/4153174/carpetbagger"}, "is_accepted": false, "score": 0, "last_activity_date": 1612125477, "last_edit_date": 1612125477, "creation_date": 1612105186, "answer_id": 65980556, "question_id": 27920995, "link": "https://stackoverflow.com/questions/27920995/how-to-change-the-locale-of-a-formatted-date-in-powerpoint-vba/65980556#65980556", "title": "How to change the locale of a formatted date in Powerpoint VBA", "body": "<p>Had the same problem and it was difficult to find a solution, so I will answer this older question:</p>\n<p>Activate the Excel Library with <strong>Tools &gt; References &gt; Microsoft Excel 16.0 Object Library</strong> (or your current Excel version, might be 12.0 or 14.0)\n<a href=\"https://i.stack.imgur.com/UJib4.png\" rel=\"nofollow noreferrer\">Menu entrance</a>\n<a href=\"https://i.stack.imgur.com/NFqBK.png\" rel=\"nofollow noreferrer\">Activate Microsoft Excel 16.0 Object Library</a></p>\n<p>Then you can use this Excel WorksheetFunction:</p>\n<pre><code>Debug.Print WorksheetFunction.Text(Now, &quot;[$-409]MMMM&quot;)\n</code></pre>\n<p>You can even even specify it with further parameters like different calendars, a list of of locale codes can be found here: <a href=\"https://stackoverflow.com/questions/54134729/what-does-the-130000-in-excel-locale-code-130000-mean/54540455#54540455\">https://stackoverflow.com/questions/54134729</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4449002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9601f7ec290a3616a6141bb7d7b9aaf7?s=128&d=identicon&r=PG&f=1", "display_name": "mfh8010", "link": "https://stackoverflow.com/users/4449002/mfh8010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 630, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612125477, "creation_date": 1421148131, "last_edit_date": 1495535121, "question_id": 27920995, "link": "https://stackoverflow.com/questions/27920995/how-to-change-the-locale-of-a-formatted-date-in-powerpoint-vba", "title": "How to change the locale of a formatted date in Powerpoint VBA", "body": "<p>in a powerpoint vba application I want to format a date according to the current spell-check language (which may or may not be the same as the system locale language).</p>\n\n<p>e.g. Locale is German(Austria) but the document is in English for an english customer, hence the date format should be \"1st January 2015\" and not \"01. J\u00e4nner 2015\" </p>\n\n<p>I found a solution for excel on this site:\n<a href=\"https://stackoverflow.com/questions/16934582/how-to-change-the-locale-of-a-formatted-date\">How to change the locale of a formatted date?</a></p>\n\n<p>trying the same technique in powerpoint vba does not appear to work: </p>\n\n<pre><code>debug.print format (now(), \"[$-415] MMMM\")\n J\u00e4nner\n\ndebug.print format (now(), \"[$-809] MMMM\")\n J\u00e4nner\n\ndebug.print format (now(), \"[any old rubbish] MMMM\")\n J\u00e4nner\n</code></pre>\n\n<p>--> vba ignores whatever is in the square brackets. </p>\n\n<p>Any suggestions how to achieve the same result within VBA?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1421147970, "post_id": 27920885, "comment_id": 44239021, "body": "You could use a reader.  some googleing should should turn up how to use it.  Also, see this post: <a href=\"http://stackoverflow.com/questions/3955061/vba-adodb-excel-read-data-from-recordset\" title=\"vba adodb excel read data from recordset\">stackoverflow.com/questions/3955061/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2263, "user_id": 3841809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3DLrQ.jpg?s=128&g=1", "display_name": "uncool", "link": "https://stackoverflow.com/users/3841809/uncool"}, "edited": false, "score": 0, "creation_date": 1421151099, "post_id": 27921191, "comment_id": 44240758, "body": "ahhh I see! Thank you!"}, {"owner": {"reputation": 2263, "user_id": 3841809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3DLrQ.jpg?s=128&g=1", "display_name": "uncool", "link": "https://stackoverflow.com/users/3841809/uncool"}, "edited": false, "score": 0, "creation_date": 1421151151, "post_id": 27921191, "comment_id": 44240777, "body": "It still remains though why I can&#39;t find the matching string when I loop through the recordset."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2263, "user_id": 3841809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3DLrQ.jpg?s=128&g=1", "display_name": "uncool", "link": "https://stackoverflow.com/users/3841809/uncool"}, "edited": false, "score": 0, "creation_date": 1421152286, "post_id": 27921191, "comment_id": 44241413, "body": "Your select statement uses <code>SELECT TOP 1 ID FROM ...</code> which is only going to return a maximum of 1 record (TOP 1) and only 1 field (ID). If you want more fields and more records then you need something like <code>SELECT * FROM ...</code>."}, {"owner": {"reputation": 2263, "user_id": 3841809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3DLrQ.jpg?s=128&g=1", "display_name": "uncool", "link": "https://stackoverflow.com/users/3841809/uncool"}, "edited": false, "score": 0, "creation_date": 1421160566, "post_id": 27921191, "comment_id": 44246581, "body": "The result when using TOP 1 and * are the same. If I use range.copyfromrecordset the target string is there in both cases. I just can&#39;t seem to get to it when looping through the recordset...."}, {"owner": {"reputation": 2263, "user_id": 3841809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3DLrQ.jpg?s=128&g=1", "display_name": "uncool", "link": "https://stackoverflow.com/users/3841809/uncool"}, "edited": false, "score": 0, "creation_date": 1421161087, "post_id": 27921191, "comment_id": 44246935, "body": "Okay, so I was using the .name property. Which apparently seems to return the column name and not the value name, everything was alright from the beginning. Thanks Jeeped!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1421148753, "creation_date": 1421148753, "answer_id": 27921191, "question_id": 27920885, "link": "https://stackoverflow.com/questions/27920885/issues-with-looping-through-recordset-trying-to-find-match-between-data-and-dat/27921191#27921191", "title": "Issues with looping through recordset, trying to find match between data and database records", "body": "<p>The default ADO <code>.Open</code> uses an <code>adOpenForwardOnly</code> cursor that always returns a <code>.RecordCount</code> of -1. You are also specifying adOpenForwardOnly in the recordset properties. You need to change it to <code>adOpenStatic</code> or <code>adOpenKeyset</code> to get an accurate record count returned.</p>\n\n<pre><code>DataConnection.Open, adOpenStatic\n \u00b7\u00b7\u00b7\nWith RecordSet\n    .ActiveConnection = DataConnection\n    .Source = SQLString\n    .LockType = adLockReadOnly\n    .CursorType = adOpenStatic\n    .Open\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 2263, "user_id": 3841809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3DLrQ.jpg?s=128&g=1", "display_name": "uncool", "link": "https://stackoverflow.com/users/3841809/uncool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "accepted_answer_id": 27921191, "answer_count": 1, "score": 0, "last_activity_date": 1594645659, "creation_date": 1421147792, "last_edit_date": 1594645659, "question_id": 27920885, "link": "https://stackoverflow.com/questions/27920885/issues-with-looping-through-recordset-trying-to-find-match-between-data-and-dat", "title": "Issues with looping through recordset, trying to find match between data and database records", "body": "<p>I'm very new to SQL and the whole ADO enviroment. What I'm trying to do is to see if a string is already in an ID table. The results show up just fine when I use the range.copyfromrecordset method. \nBut when I loop through the code I cannot find the string in the fields and rows somehow. </p>\n\n<p>When using recordset.recordcount it gives -1. The String \"SWED-A.ST\" is in the ID table which I'm accessing and retrieving successfully, but how do I loop through the recordset and show it in the immediate window with debug.print? I've tried to loop through the fields by using a loop and movenext but only the table-heading \"ID\" shows up....</p>\n\n<p>Code </p>\n\n<pre><code>Sub Macro1() ' Tester Sub\n\n    Dim TickerID As String: TickerID = \"SWED-A.ST\"\n    Dim SQLString As String: SQLString = \"SELECT TOP 1 ID FROM Instruments WHERE ID = '\" &amp; TickerID &amp; \"'\"\n\n    Dim ADODBBuilder As ADODBBuilder: Set ADODBBuilder = New ADODBBuilder\n    Dim RecordSet As ADODB.RecordSet: Set RecordSet = ADODBBuilder.ReturnRecordset(TickerID, , , SQLString)\n\nPublic Function ReturnRecordset(Optional TickerID As String, Optional startdate As Date, Optional enddate As Date, Optional CustomSQLString As String) As ADODB.RecordSet\n\nConst ConnectionPath As String = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\name\\Desktop\\DataBase.accdb;Persist Security Info=False;\"\n\n    Dim DataConnection As ADODB.Connection: Set DataConnection = New ADODB.Connection\n    Dim RecordSet As ADODB.RecordSet: Set RecordSet = New ADODB.RecordSet\n\n    DataConnection.ConnectionString = ConnectionPath\n    DataConnection.Open\n\n    If Len(CustomSQLString) &gt; 0 Then\n        SQLString = CustomSQLString\n    Else\n         If Sheets(\"Mainwindow\").Btn_CurrentTime.Value = True Then\n            SQLString = \"SELECT * FROM \" &amp; TickerID _\n            &amp; \" WHERE [Date] BETWEEN #\" &amp; startdate &amp; \"# AND #\" &amp; enddate &amp; \"#\"\n        Else\n            SQLString = \"SELECT * FROM \" &amp; TickerID\n        End If\n    End If\n\n    With RecordSet\n        .ActiveConnection = DataConnection\n        .Source = SQLString\n        .LockType = adLockReadOnly\n        .CursorType = adOpenForwardOnly\n        .Open\n    End With\n\n    Set ReturnRecordset = RecordSet\n\n    'Cleanup\n    Set RecordSet = Nothing\n    Set DataConnection = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vb.net", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1421149121, "creation_date": 1421149121, "answer_id": 27921298, "question_id": 27920402, "link": "https://stackoverflow.com/questions/27920402/odbc-data-source-updates-after-pivot-refreshes/27921298#27921298", "title": "ODBC data source updates after Pivot refreshes", "body": "<p>If they are all ODBC connections:</p>\n\n<pre><code>For Each objConnection In ThisWorkbook.Connections\nobjConnection.ODBCConnection.BackgroundQuery = False\nobjConnection.Refresh\nDoEvents\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 484, "user_id": 3580480, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/97cbe6ebbd6ae4b98ce80c23ea0b6eb3?s=128&d=identicon&r=PG&f=1", "display_name": "user3580480", "link": "https://stackoverflow.com/users/3580480/user3580480"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 27921298, "answer_count": 1, "score": 0, "last_activity_date": 1421149121, "creation_date": 1421146261, "last_edit_date": 1531161705, "question_id": 27920402, "link": "https://stackoverflow.com/questions/27920402/odbc-data-source-updates-after-pivot-refreshes", "title": "ODBC data source updates after Pivot refreshes", "body": "<p>I am trying to create an Excel macro, that refreshes an ODBC data connection and then refreshes all the linked Pivot tables afterwards.</p>\n\n<p>I am using the below code, I have also tried various different interations, but no matter what I do the Pivot tables refresh first and then the data refresh happens afterwards, meaning the pivots show the old data.</p>\n\n<pre><code>Sub AutoUpdate()\n\n        For Each objConnection In ThisWorkbook.Connections\n        objConnection.Refresh\n        DoEvents\n\n        Next\n            Dim Sheet As Worksheet, Pivot As PivotTable\n            For Each Sheet In ThisWorkbook.Worksheets\n\n                For Each Pivot In Sheet.PivotTables\n                Pivot.RefreshTable\n                Pivot.Update\n                Next\n\n            Next\n\n' ODBC Data Refresh starts here!!\n\nEnd Sub\n</code></pre>\n\n<p>How can I get the ODBC data to refresh before the pivots?</p>\n\n<p>I have also tried to use a DoEvents command, but that doesn't seem to make any difference.</p>\n\n<p>Any help greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1421150557, "post_id": 27919420, "comment_id": 44240460, "body": "Welcome to Stack Overflow! I&#39;m not sure I understand your problem statement. When you say &quot;sub-sheets&quot;, what does that mean? (Inside the linked worksheet, I do not see a worksheet named &quot;sub-sheets&quot; or &quot;Subsheets&quot;.) Additionally, the linked sheet does not include a worksheet named &quot;Master Table&quot;. Can you please clarify?"}, {"owner": {"reputation": 9, "user_id": 4448523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c24fb72ba6f3b12543227bd53827ca5?s=128&d=identicon&r=PG&f=1", "display_name": "edc", "link": "https://stackoverflow.com/users/4448523/edc"}, "reply_to_user": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1421150912, "post_id": 27919420, "comment_id": 44240663, "body": "Hi dan, thanks for your reply. My mistake, Master Sheet is &quot;DBQ Query Result&quot; and subsheets are regular sheets that came from Product Line Column which are Driling and Workover, Fishing, Liner Systems,Professional Services, Wellbore Cleaning"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 4448523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c24fb72ba6f3b12543227bd53827ca5?s=128&d=identicon&r=PG&f=1", "display_name": "edc", "link": "https://stackoverflow.com/users/4448523/edc"}, "is_accepted": false, "score": 1, "last_activity_date": 1421322555, "creation_date": 1421322555, "answer_id": 27962773, "question_id": 27919420, "link": "https://stackoverflow.com/questions/27919420/compare-all-columns-between-two-sheets-based-on-a-unique-identifier-column-and-u/27962773#27962773", "title": "Compare all columns between two sheets based on a unique identifier column and update Sheet1 rows if difference exists", "body": "<p>I came across few codes online and modified them to fit my need.</p>\n\n<p>So, this is how it goes:</p>\n\n<p>You have 3 Main Sheets next to your PL Sheets - Subsheets (Driling and Workover, Fishing, Liner Systems, Professional Services, Wellbore Cleaning):</p>\n\n<ul>\n<li>Original</li>\n<li>Updated</li>\n<li>Changes</li>\n</ul>\n\n<p>This code will print the changes between Original Sheet and Updated Sheet:</p>\n\n<pre><code>Option Explicit\n\n    Sub CompareSheets()\n        '\n        ' constants\n        '  worksheets &amp; ranges\n        '   original\n        Const ksWSOriginal = \"ORIGINAL\"\n        Const ksOriginal = \"OriginalTable\"\n        Const ksOriginalKey = \"OriginalKey\"\n        '   updated\n        Const ksWSUpdated = \"UPDATED\"\n        Const ksUpdated = \"UpdatedTable\"\n        Const ksUpdatedKey = \"UpdatedKey\"\n        '   changes\n        Const ksWSChanges = \"CHANGES\"\n        Const ksChanges = \"ChangesTable\"\n        '  labels\n        Const ksChange = \"CHANGE\"\n        Const ksRemove = \"REMOVE\"\n        Const ksAdd = \"ADD\"\n        '\n        ' declarations\n        Dim rngO As Range, rngOK As Range, rngU As Range, rngUK As Range, rngC As Range\n        Dim c As Range\n        Dim I As Long, J As Long, lChanges As Long, lRow As Long, bEqual As Boolean\n        '\n        ' start\n        Set rngO = Worksheets(ksWSOriginal).Range(ksOriginal)\n        Set rngOK = Worksheets(ksWSOriginal).Range(ksOriginalKey)\n        Set rngU = Worksheets(ksWSUpdated).Range(ksUpdated)\n        Set rngUK = Worksheets(ksWSUpdated).Range(ksUpdatedKey)\n        Set rngC = Worksheets(ksWSChanges).Range(ksChanges)\n        With rngC\n            If .Rows.Count &gt; 1 Then\n                Range(.Rows(2), .Rows(.Rows.Count)).ClearContents\n                Range(.Rows(2), .Rows(.Rows.Count)).Font.ColorIndex = xlColorIndexAutomatic\n                Range(.Rows(2), .Rows(.Rows.Count)).Font.Bold = False\n            End If\n        End With\n        '\n        ' process\n        lChanges = 1\n        '  1st pass: updates &amp; deletions\n        With rngOK\n            For I = 5 To .Rows.Count\n                Set c = rngUK.Find(.Cells(I, 1).Value, , xlValues, xlWhole)\n                If c Is Nothing Then\n                    ' deletion\n                    lChanges = lChanges + 1\n                    rngC.Cells(lChanges, 1).Value = ksRemove\n                    For J = 1 To rngO.Columns.Count\n                        rngC.Cells(lChanges, J + 1).Value = rngO.Cells(I, J).Value\n                        rngC.Cells(lChanges, J + 1).Font.Color = vbRed\n                        rngC.Cells(lChanges, J + 1).Font.Bold = True\n                    Next J\n                Else\n                    bEqual = True\n                    lRow = c.Row - rngUK.Row + 1\n                    For J = 1 To rngO.Columns.Count\n                        If rngO.Cells(I, J).Value &lt;&gt; rngU.Cells(lRow, J).Value Then\n                            bEqual = False\n                            Exit For\n                        End If\n                    Next J\n                    If Not bEqual Then\n                        ' change\n                        lChanges = lChanges + 1\n                        rngC.Cells(lChanges, 1).Value = ksChange\n                        For J = 1 To rngO.Columns.Count\n                            If rngO.Cells(I, J).Value = rngU.Cells(lRow, J).Value Then\n                                rngC.Cells(lChanges, J + 1).Value = rngO.Cells(I, J).Value\n                            Else\n                                rngC.Cells(lChanges, J + 1).Value = rngU.Cells(I, J).Value\n                                rngC.Cells(lChanges, J + 1).Font.Color = vbMagenta\n                                rngC.Cells(lChanges, J + 1).Font.Bold = True\n                            End If\n                        Next J\n                    End If\n                End If\n            Next I\n        End With\n        '  2nd pass: additions\n        With rngUK\n            For I = 5 To .Rows.Count\n                Set c = rngOK.Find(.Cells(I, 1).Value, , xlValues, xlWhole)\n                If c Is Nothing Then\n                    ' addition\n                    lChanges = lChanges + 1\n                    rngC.Cells(lChanges, 1).Value = ksAdd\n                    For J = 1 To rngU.Columns.Count\n                        rngC.Cells(lChanges, J + 1).Value = rngU.Cells(I, J).Value\n                        rngC.Cells(lChanges, J + 1).Font.Color = vbBlue\n                        rngC.Cells(lChanges, J + 1).Font.Bold = True\n                    Next J\n                End If\n            Next I\n        End With\n        '\n        ' end\n        Worksheets(ksWSChanges).Activate\n        rngC.Cells(2, 3).Select\n        Set rngC = Nothing\n        Set rngUK = Nothing\n        Set rngU = Nothing\n        Set rngOK = Nothing\n        Set rngO = Nothing\n        Beep\n        '\n    End Sub\n</code></pre>\n\n<p>This Button Code will Apply Updates to rows noted as \"Changes\" and \"Add\" (I dont care about Remove)</p>\n\n<pre><code>    Sub Update()\n\n    Dim sh1 As Worksheet, sh2 As Worksheet\n    Dim tempName As String\n    Dim lastRow1 As Long, lastRow2 As Long\n    Dim s2Row As Long, s1Row As Long\n    Application.ScreenUpdating = False\n\n    Set sh1 = ActiveWorkbook.Worksheets(\"ORIGINAL\")\n    Set sh2 = ActiveWorkbook.Worksheets(\"CHANGES\")\n\n    lastRow1 = sh1.Cells(Rows.Count, \"A\").End(xlUp).Row    'Get last row for both sheets\n    lastRow2 = sh2.Cells(Rows.Count, \"A\").End(xlUp).Row    ' searching both\n\n    For s2Row = 2 To lastRow2                              'Loop through \"CHANGES\"\n        If sh2.Cells(s2Row, 1).Value = \"CHANGE\" Then\n            tempName = sh2.Cells(s2Row, 2).Value           'extra step for understanding concept\n                                                           'There is a match, so now\n            For s1Row = 2 To lastRow1                      'Search through the other sheet\n                If sh1.Cells(s1Row, 1).Value = tempName Then\n                    For I = 2 To 35\n                        sh1.Cells(s1Row, I).Value = sh2.Cells(s2Row, I + 1).Value    'Copy Values\n                    Next I\n                End If\n            Next s1Row\n        End If\n    Next s2Row\n\n    For s2Row = 2 To lastRow2\n        If sh2.Cells(s2Row, 1).Value = \"ADD\" Then\n                    sh2.Range(\"B\" &amp; s2Row &amp; \":BB\" &amp; s2Row).Copy         'Copy rows\n                    sh1.Rows(lastRow1 + 1).Insert Shift:=xlDown         'Insert rows\n                    sh1.Cells(lastRow1 + 1, 78).Value = \"ADD\"            'Classify the row as newly added\n        End If\n    Next s2Row\n\n    Application.ScreenUpdating = True\n    Sheets(\"ORIGINAL\").Activate\n    End Sub\n</code></pre>\n\n<p>And this button will apply updates to PL Cell Values for existing UniqueIDs changes</p>\n\n<pre><code>    Sub Update_PL()\n        Dim ws As Worksheet\n        Dim lastRng As Range\n        Application.ScreenUpdating = False 'speed up code\n\n        'Added to loop through all UniqueIDs and update accordingly\n        Dim sh1 As Worksheet, sh2 As Worksheet\n        Dim tempName As String\n        Dim lastRow1 As Long, lastRow2 As Long\n        Dim s2Row As Long, s1Row As Long\n\n        'No Longer requires clearing screen, we will match unique ids and update/add as necessary\n        'ThisWorkbook.Sheets(\"ORIGINAL\").Rows(\"5:65536\").ClearContents 'clear\n\n        Set sh1 = ActiveWorkbook.Worksheets(\"ORIGINAL\") 'Define Master Table\n        Set sh2 = ws                                    'Selects Active Sheet\n\n        For Each ws In ThisWorkbook.Worksheets\n            Set lastRng = ThisWorkbook.Sheets(\"ORIGINAL\").Range(\"A65536\").End(xlUp).Offset(1, 0)\n\n            Select Case ws.Name\n            Case \"ORIGINAL\" 'exlude\n            Case \"UPDATED\" 'exlude\n            Case \"CHANGES\" 'exlude\n            Case \"Report Table\" 'exlude\n            Case \"DASHBOARD\" 'exlude\n                 'do nothing\n            Case Else\n                ws.Activate\n                    lastRow2 = sh1.Cells(Rows.Count, \"A\").End(xlUp).Row                              'Count Master Table Rows to extract Last Row #\n                    With ActiveSheet\n                        lastRow1 = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row                  'Count Active Sheet Rows to extract Last Row #\n                    End With\n                For s2Row = 2 To lastRow2                                                            'Loop through Active WorkSheet\n                        tempName = sh1.Cells(s2Row, 1).Value                                         'Define UniqueID to loop\n                        tempPL = sh1.Cells(s2Row, 22).Value                                          'Define PL to loop\n                        For s1Row = 2 To lastRow1                                                    'Match UniqueIDs between Master sheet and Active Sheet\n                            If ActiveSheet.Cells(s1Row, 1).Value = tempName Then                     'If Matches TRUE then\n                                For I = 2 To 35                                                      'Loop all Columns and update as necessary\n                                    ActiveSheet.Cells(s1Row, I).Value = sh1.Cells(s2Row, I).Value    'Copy Values\n                                Next I\n                            End If\n                        Next s1Row\n                Next s2Row\n\n                 'copy data from individual sheets\n                 'Range(\"A2\", Range(\"AB65536\").End(xlUp)).Copy lastRng\n\n            End Select\n        Next\n        Application.CutCopyMode = False 'clear clipboard\n        Application.ScreenUpdating = True\n        Sheets(\"ORIGINAL\").Activate\n    End Sub\n</code></pre>\n\n<p>And this last button is used to Add new UniqueIDs to corresponding PL</p>\n\n<pre><code>    Sub Add_Rows()\n        Dim ws As Worksheet\n        Dim lastRng As Range\n        Application.ScreenUpdating = False 'speed up code\n\n        'Added to loop through all UniqueIDs and update accordingly\n        Dim sh1 As Worksheet\n        Dim tempPL As String\n        Dim lastRow1 As Long, lastRow2 As Long\n        Dim s2Row As Long, s1Row As Long\n\n        Set sh1 = ActiveWorkbook.Worksheets(\"ORIGINAL\") 'Define Master Table\n\n        For Each ws In ThisWorkbook.Worksheets\n            Set lastRng = ThisWorkbook.Sheets(\"ORIGINAL\").Range(\"A65536\").End(xlUp).Offset(1, 0)\n\n            Select Case ws.Name\n            Case \"ORIGINAL\" 'exlude\n            Case \"UPDATED\" 'exlude\n            Case \"CHANGES\" 'exlude\n            Case \"Report Table\" 'exlude\n            Case \"DASHBOARD\" 'exlude\n                 'do nothing\n            Case Else\n                ws.Activate\n                    lastRow2 = sh1.Cells(Rows.Count, \"A\").End(xlUp).Row                              'Count Master Table Rows to extract Last Row #\n                    With ActiveSheet\n                        lastRow1 = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row                  'Count Active Sheet Rows to extract Last Row #\n                    End With\n\n                For s2Row = 5 To lastRow2                                                            'Loop through Active WorkSheet\n                        If sh1.Cells(s2Row, 78).Value = \"ADD\" Then\n                            tempPL = sh1.Cells(s2Row, 23).Value\n                                If ActiveSheet.Name = tempPL Then\n                                        sh1.Range(\"A\" &amp; s2Row &amp; \":AB\" &amp; s2Row).Copy                      'Copy rows\n                                        ActiveSheet.Rows(lastRow1 + 1).Insert Shift:=xlDown              'Insert rows\n                                        sh1.Cells(s2Row, 78).Value = \"ADDED\"                      'Validate Row has been added in Master Sheet\n                                End If\n                        End If\n                Next s2Row\n\n            End Select\n\n        Next\n            Application.CutCopyMode = False     'clear clipboard\n            Application.ScreenUpdating = True   'Resume ScreenUpdating\n            Sheets(\"ORIGINAL\").Activate         'Display Original Sheet\n\n    End Sub\n</code></pre>\n\n<p>Complicated? Yeah... but solved my issue.</p>\n\n<p>BR! Eddy</p>\n"}], "owner": {"reputation": 9, "user_id": 4448523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c24fb72ba6f3b12543227bd53827ca5?s=128&d=identicon&r=PG&f=1", "display_name": "edc", "link": "https://stackoverflow.com/users/4448523/edc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2534, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1421769305, "creation_date": 1421143221, "last_edit_date": 1421769305, "question_id": 27919420, "link": "https://stackoverflow.com/questions/27919420/compare-all-columns-between-two-sheets-based-on-a-unique-identifier-column-and-u", "title": "Compare all columns between two sheets based on a unique identifier column and update Sheet1 rows if difference exists", "body": "<p>I have a workbook that has 2 worksheets and sub-sheets Named as per Product Line Column:</p>\n\n<ul>\n<li>NEW DATA sheet</li>\n<li>Master Table sheet (\"DBQ Query Result\")</li>\n<li>Subsheets (Driling and Workover, Fishing, Liner Systems, Professional Services, Wellbore Cleaning)</li>\n</ul>\n\n<p>They both have same headers, within the column headers there is a uniqueID column.</p>\n\n<h3>PART A</h3>\n\n<p>I would like to match uniqueID between those 2 sheets and:</p>\n\n<ul>\n<li>When there is a match, compare row cell values for each column and update if there is difference</li>\n<li>When there is a uniqueID in NEW DATA sheet that does not exist in Master Table, I would like this whole row associated to this uniqueId to be copied to Master Table sheet</li>\n</ul>\n\n<h3>PART B</h3>\n\n<p>I would like to have a new button that when pressed, UniqueID from Master Page will be compared with Unique Id column of each subsheet and:</p>\n\n<ul>\n<li>When there is a match, update subsheet row according to UNIQUEID</li>\n<li>When there is no match, that means a new UNIQUEID is created and this should be added to its corresponding subsheet as a last row</li>\n</ul>\n\n<p>I would like to accomplish the above using VBA macro please. I have attached a sample of the excel <a href=\"https://dl.dropboxusercontent.com/u/29585269/Sample.xlsx\" rel=\"nofollow\">https://dl.dropboxusercontent.com/u/29585269/Sample.xlsx</a>.</p>\n\n<p>Please let me know if you need any additional information.</p>\n"}, {"tags": ["vba", "excel", "shape"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4444891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5a362d026f742b39c5c626b613211087?s=128&d=identicon&r=PG&f=1", "display_name": "Vin", "link": "https://stackoverflow.com/users/4444891/vin"}, "edited": false, "score": 0, "creation_date": 1421149560, "post_id": 27920393, "comment_id": 44239893, "body": "Well the data inserted is in a table but the table is not called Table 1. Table 1 is just the name of the sheet. It can be anything. So can it really be the problem?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23, "user_id": 4444891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5a362d026f742b39c5c626b613211087?s=128&d=identicon&r=PG&f=1", "display_name": "Vin", "link": "https://stackoverflow.com/users/4444891/vin"}, "edited": false, "score": 0, "creation_date": 1421149725, "post_id": 27920393, "comment_id": 44240004, "body": "@Vin - If you type an <i>a, b</i> or <i>c</i> into J9 (disregarding the <i>Table1</i> reference altogether) then the code above works."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1421150260, "last_edit_date": 1495535304, "creation_date": 1421146246, "answer_id": 27920393, "question_id": 27919280, "link": "https://stackoverflow.com/questions/27919280/error-424-object-needed/27920393#27920393", "title": "Error 424 Object needed", "body": "<p>It looks like is not with the shape code but with the <code>Table1</code>. Tables use a special structured addressing system (see <a href=\"https://stackoverflow.com/questions/7872504/excel-vba-select-get-and-set-data-in-table\">Select, get and set data in Table</a>). If you just want the value from cell J9 then this should do.</p>\n\n<pre><code>With Sheets(\"Table 1\")\n    Select Case LCase(.Range(\"J9\").Value)\n        Case \"a\"\n            .Shapes(\"Test\").Fill.ForeColor.SchemeColor = 1\n        Case \"b\"\n            .Shapes(\"Test\").Fill.ForeColor.SchemeColor = 2\n        Case \"c\"\n            .Shapes(\"Test\").Fill.ForeColor.SchemeColor = 3\n        Case Else\n            ' do nothing\n    End Select\nEnd With\n</code></pre>\n\n<p>If a simple reference to J9 is insufficient, you will have to provide more information on the exact nature of <strong>Table1</strong>.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>You may not be referencing the shape's name correctly. This code will enumerate all of hte shapes on the Table 1 worksheet and return their names to the VBE's Immediate window (in the VBE as <kbd>Ctrl</kbd>+<kbd>G</kbd>).</p>\n\n<pre><code>Dim i As Long\nWith Sheets(\"Table 1\")\n    For i = 1 To .Shapes.Count\n        Debug.Print .Shapes(i).Name\n    Next i\nEnd With\n</code></pre>\n\n<p>Is <strong>Test</strong> there as one of the names? can you determine the name of the shape you want to change?</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4444891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5a362d026f742b39c5c626b613211087?s=128&d=identicon&r=PG&f=1", "display_name": "Vin", "link": "https://stackoverflow.com/users/4444891/vin"}, "edited": false, "score": 0, "creation_date": 1421149316, "post_id": 27920451, "comment_id": 44239757, "body": "I tried your solution. Now the error 424 is gone but there is another error. It says, &quot;error 438: object doesn&#39;t support this property or method&quot;"}], "tags": [], "owner": {"reputation": 2712, "user_id": 939124, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4f1b4e5fc78800ab69d5d9611bf50431?s=128&d=identicon&r=PG", "display_name": "mattboy", "link": "https://stackoverflow.com/users/939124/mattboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1421146420, "creation_date": 1421146420, "answer_id": 27920451, "question_id": 27919280, "link": "https://stackoverflow.com/questions/27919280/error-424-object-needed/27920451#27920451", "title": "Error 424 Object needed", "body": "<p>Does changing all Table1 references to Worksheets(\"Table1\") fix it? For example:</p>\n\n<pre><code>If Worksheets(\"Table1\").Range(\"J9\") = \"a\" Then\nActiveSheet.Shapes(\"Test\").Fill.ForeColor.SchemeColor = 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 4444891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5a362d026f742b39c5c626b613211087?s=128&d=identicon&r=PG&f=1", "display_name": "Vin", "link": "https://stackoverflow.com/users/4444891/vin"}, "is_accepted": false, "score": 0, "last_activity_date": 1421168458, "creation_date": 1421168458, "answer_id": 27927490, "question_id": 27919280, "link": "https://stackoverflow.com/questions/27919280/error-424-object-needed/27927490#27927490", "title": "Error 424 Object needed", "body": "<p>@Jeeped Is it the same if I were to use apple, orange and lemon instead of alphabets? I changed my code to make it similar like yours. This time there is no error message but nothing happens                                                                                                                               </p>\n\n<pre><code>Sub test()\nWith ActiveSheet\n    Select Case LCase(.Range(\"J9\").Value)\n        Case \"apple\"\n            .Shapes(\"Test\").Fill.ForeColor.SchemeColor = 1\n        Case \"orange\"\n            .Shapes(\"Test\").Fill.ForeColor.SchemeColor = 2\n        Case \"lemon\"\n            .Shapes(\"Test\").Fill.ForeColor.SchemeColor = 3\n        Case Else\n            ' do nothing\n    End Select\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Is there anything wrong in this code? and by the way, what is LCase??</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1421169374, "last_edit_date": 1421169374, "creation_date": 1421168817, "answer_id": 27927600, "question_id": 27919280, "link": "https://stackoverflow.com/questions/27919280/error-424-object-needed/27927600#27927600", "title": "Error 424 Object needed", "body": "<pre><code>Sub SO()\n\nActiveSheet.Shapes(\"Test\").Fill.FillColor.SchemeColor = Asc(UCase(Sheets(\"Table 1\").Range(\"J9\"))) - 64\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4444891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5a362d026f742b39c5c626b613211087?s=128&d=identicon&r=PG&f=1", "display_name": "Vin", "link": "https://stackoverflow.com/users/4444891/vin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1454582813, "creation_date": 1421142774, "last_edit_date": 1531164843, "question_id": 27919280, "link": "https://stackoverflow.com/questions/27919280/error-424-object-needed", "title": "Error 424 Object needed", "body": "<p>well my idea is to refer the alphabet in cell J9 of the first worksheet called Table1 and to automatically color the shape called \"Test\" on the  active worksheet. So basically if the alphabet entered is \"a\" in the cell J9 on the first worksheet, the shape \"Test\" on worksheet 2 should give out color 1, and if \"b\", color 2 and so on. I have written a code for it but sadly I keep receiving Error 424 Object Required. Any help would be deeply appreciated! Thanks!</p>\n\n<pre><code>Sub test()\nIf Table1.Range(\"J9\") = \"a\" Then\nActiveSheet.Shapes(\"Test\").Fill.ForeColor.SchemeColor = 1\n\nElseIf Table1.Range(\"J9\") = \"b\" Then\nActiveSheet.Shapes(\"Test\").Fill.ForeColor.SchemeColor = 2\n\nElseIf Table1.Range(\"J9\") = \"c\" Then\nActiveSheet.Shapes(\"Test\").Fill.ForeColor.SchemeColor = 3\n\nElseIf Table1.Range(\"J9\") = \"d\" Then\nActiveSheet.Shapes(\"Test\").Fill.ForeColor.SchemeColor = 4\n\nElse\nActiveSheet.Shapes(\"Test\").Fill.ForeColor.SchemeColor = 5\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1421143738, "post_id": 27919059, "comment_id": 44236691, "body": "With a properly assigned array of column letters in <code>addressCols</code> this code runs as intended. You may have made a mistake in the <i>rank</i> of the array or need to transpose if reading the array from a worksheet range. I would also suggest that the last 4 lines within the loop be merged into <code>xlVlookupSheet.Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteValues</code>."}, {"owner": {"reputation": 1, "user_id": 3106697, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6989dc56117176c922f52d4d40ad4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3106697/amit"}, "edited": false, "score": 0, "creation_date": 1421145948, "post_id": 27919059, "comment_id": 44237996, "body": "I replaced the last four lines with above code , but same error"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3106697, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6989dc56117176c922f52d4d40ad4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3106697/amit"}, "is_accepted": false, "score": 0, "last_activity_date": 1421225057, "creation_date": 1421225057, "answer_id": 27938802, "question_id": 27919059, "link": "https://stackoverflow.com/questions/27919059/runtime-error-1004-microsoft-excel-cannot-paste-the-data-in-excel-vba/27938802#27938802", "title": "Runtime error 1004 Microsoft excel cannot paste the data in excel vba", "body": "<p>The problem is that , from where I was copying that excel sheet contains 33767 styles . it will not copy from source to destination if the styles will be more than 3000. Hence i removed the styles and made the simple normal sheet and it worked.</p>\n\n<p>you can get the number of active workbook styles by below code:-</p>\n\n<p>activeworkbook.styles.count  </p>\n\n<p>For more information one can go below link:-</p>\n\n<p><a href=\"http://www.think-cell.com/en/support/kb/0156.shtml\" rel=\"nofollow\">http://www.think-cell.com/en/support/kb/0156.shtml</a></p>\n"}], "owner": {"reputation": 1, "user_id": 3106697, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6989dc56117176c922f52d4d40ad4ea6?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3106697/amit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1338, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421225057, "creation_date": 1421142180, "last_edit_date": 1421142746, "question_id": 27919059, "link": "https://stackoverflow.com/questions/27919059/runtime-error-1004-microsoft-excel-cannot-paste-the-data-in-excel-vba", "title": "Runtime error 1004 Microsoft excel cannot paste the data in excel vba", "body": "<p>I have two excel sheets. <code>xlVlookupSheet</code> is one sheet name and <code>xlShtCmdb</code> is another sheet from where it copying the columns data.</p>\n\n<p>I am getting the following error:-</p>\n\n<pre><code>Runtime error 1004 Microsoft excel cannot paste the data-\n</code></pre>\n\n<p>It is coming in the second iteration of the below <code>for loop</code>. <code>addressCols</code> is an array which contains the column names to be copied.</p>\n\n<pre><code>    For index = UBound(addressCols) To 0 Step -1\n        xlVlookupSheet.Columns(\"A:A\").Insert xlToLeft\n         xlShtCmdb.Columns(addressCols(index) &amp; \":\" &amp; addressCols(index)).Copy\n        xlVlookupSheet.Activate\n        xlVlookupSheet.Select\n        xlVlookupSheet.Range(\"A1\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues  \n    Next\n</code></pre>\n"}, {"tags": ["vba", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4303658, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ba6543e127bef28dea4097026899514e?s=128&d=identicon&r=PG&f=1", "display_name": "Samatar", "link": "https://stackoverflow.com/users/4303658/samatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1421248516, "creation_date": 1421248516, "answer_id": 27946220, "question_id": 27918862, "link": "https://stackoverflow.com/questions/27918862/getting-script-to-recognise-text-and-arrange-in-correct-column-based-on-cell-tex/27946220#27946220", "title": "Getting script to recognise text and arrange in correct column based on cell text", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub move_Data()\r\nDim iL As Long, rng1 As Range, rng2 As Range, pasterng As Range, lRow As Long, lRows As Long, str As String, var As Range, var1 As Range, var2 As Range, var3 As Range, var4 As Range, var5 As Range, var6 As Range, titlerow As Long\r\n\r\nSet ws1 = Sheet1\r\nSet ws2 = Sheet2\r\n\r\niL = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\r\n\r\nFor i = 1 To iL\r\n\r\nSet Title1 = ws1.Cells(i, 1)\r\n\r\ntitlerow = ws2.Cells(ws2.Rows.Count, 1).End(xlUp).Row\r\ntitlerows = titlerow + 1\r\n\r\nSet Title2 = ws2.Cells(titlerows, 1)\r\n\r\nTitle2.Value = Title1.Value\r\n\r\nSet rng1 = ws1.Range(ws1.Cells(i, 1), ws1.Cells(i, ws1.Columns.Count).End(xlToLeft).Columns)\r\nSet var = rng1.Find(\"Date: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 2).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 2)\r\npasterng.Value = var.Value\r\nEnd If\r\n\r\nSet var1 = rng1.Find(\"Time: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var1 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 3).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 3)\r\npasterng.Value = var1.Value\r\nEnd If\r\n\r\nSet var2 = rng1.Find(\"Recording Duration: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var2 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 4).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 4)\r\npasterng.Value = var2.Value\r\nEnd If\r\n\r\nSet var3 = rng1.Find(\"Database: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var3 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 5).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 5)\r\npasterng.Value = var3.Value\r\nEnd If\r\n\r\nSet var4 = rng1.Find(\"Experiment: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var4 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 6).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 6)\r\npasterng.Value = var4.Value\r\nEnd If\r\n\r\nSet var5 = rng1.Find(\"Workspace: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var5 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 7).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 7)\r\npasterng.Value = var5.Value\r\nEnd If\r\n\r\nSet var6 = rng1.Find(\"Devices: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var6 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 8).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 8)\r\npasterng.Value = var6.Value\r\nEnd If\r\n\r\nSet var7 = rng1.Find(\"Program Description: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var7 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 9).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 9)\r\npasterng.Value = var7.Value\r\nEnd If\r\n\r\nSet var8 = rng1.Find(\"WP: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var8 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 10).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 10)\r\npasterng.Value = var8.Value\r\nEnd If\r\n\r\nSet var9 = rng1.Find(\"RP: \", LookIn:=xlValues, LookAt:=xlPart)\r\nIf Not var9 Is Nothing Then\r\nlRow = ws2.Cells(ws2.Rows.Count, 11).End(xlUp).Row\r\nlRows = lRow + 1\r\nSet pasterng = ws2.Cells(lRows, 11)\r\npasterng.Value = var9.Value\r\nEnd If\r\n\r\nSet Comments = var9.Offset(0, 1)\r\n\r\nSet Commentrng = ws1.Range(Comments, ws1.Cells(i, ws1.Columns.Count).End(xlToLeft))\r\nsizex = Commentrng.Columns.Count\r\nsizexs = sizex + 11\r\nSet Commentpaste = ws2.Range(ws2.Cells(titlerows, 12), ws2.Cells(titlerows, sizexs))\r\nCommentpaste.Value = Commentrng.Value\r\n\r\nNext i\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 51, "user_id": 4303658, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ba6543e127bef28dea4097026899514e?s=128&d=identicon&r=PG&f=1", "display_name": "Samatar", "link": "https://stackoverflow.com/users/4303658/samatar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421248516, "creation_date": 1421141609, "question_id": 27918862, "link": "https://stackoverflow.com/questions/27918862/getting-script-to-recognise-text-and-arrange-in-correct-column-based-on-cell-tex", "title": "Getting script to recognise text and arrange in correct column based on cell text", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>'Text to columns, seperate into columns\r\nwsx1.Columns(2).TextToColumns , _\r\nDestination:=wsx1.Range(\"B1\"), _\r\nDataType:=xlDelimited, _\r\nTextQualifier:=xlDoubleQuote, _\r\nConsecutiveDelimiter:=True, _\r\nOther:=True, _\r\nOtherChar:=\"|\", _\r\nTrailingMinusNumbers:=False\r\n'remove unwanted information &amp; shift cells accross\r\nFor Each cell In wsx1.Range(\"A1:AD50000\")\r\n    If cell.Value = \"Pre-trigger Time: 20[s]\" Then\r\n        cell.Delete Shift:=xlShiftToLeft\r\n    End If\r\n Next cell\r\n \r\n For Each cell In wsx1.Range(\"A1:AD50000\")\r\n    If cell.Value = \"\u00a7@\" Then\r\n        cell.Delete Shift:=xlShiftToLeft\r\n    End If\r\n Next cell\r\n'Now, copy what you want from x:\r\nlRows = wsx1.Cells(wsx1.Rows.Count, \"A\").End(xlUp).Row\r\nlCols = wsx1.Cells(1, wsx1.Columns.Count).End(xlToRight).Column\r\nSet rng3 = wsx1.Range(wsx1.Cells(1, 1), wsx1.Cells(lRows, lCols))\r\n'Identify next empty range in final sheet\r\nsizex = rng3.Columns.Count\r\nsizey = rng3.Rows.Count\r\nlRows2 = wsy1.Cells(wsy1.Rows.Count, \"A\").End(xlUp).Row\r\nDRows = sizey + lRows2\r\nDCols = sizex\r\nSet rng4 = wsy1.Range(wsy1.Cells(lRows2 + 1, 1), wsy1.Cells(DRows, DCols))\r\nrng4.Value = rng3.Value\r\nwsy1.Columns(\"A:Q\").AutoFit\r\n'Close x:\r\nApplication.DisplayAlerts = False\r\nx.Close\r\nApplication.DisplayAlerts = True</code></pre>\r\n</div>\r\n</div>\r\n\nI am extracting information from a CSV file, First I am separating the string using text to columns and then transferring the data to the correct workbook.\n The issue I m having is trying to find a way to recognise the text content for e.g. Date should go in column 2, time in column 3, etc...</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Samatar1 Date:01/01/15 Time: 12:46 Record Duration: 25 s Data: exc Experiment: S2 Workspace : mina \r\n\r\nThe above format is how the text is shown in the table</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 2902829, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/1PcPi.jpg?s=128&g=1", "display_name": "Shiva", "link": "https://stackoverflow.com/users/2902829/shiva"}, "edited": false, "score": 0, "creation_date": 1421148006, "post_id": 27920618, "comment_id": 44239038, "body": "I have around 5K records, so I cant put ActiveX text box"}], "tags": [], "owner": {"reputation": 2712, "user_id": 939124, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4f1b4e5fc78800ab69d5d9611bf50431?s=128&d=identicon&r=PG", "display_name": "mattboy", "link": "https://stackoverflow.com/users/939124/mattboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1421146978, "creation_date": 1421146978, "answer_id": 27920618, "question_id": 27918780, "link": "https://stackoverflow.com/questions/27918780/ms-excel-show-length-dynamically-on-changing-cell-value/27920618#27920618", "title": "MS Excel: Show length dynamically on changing cell value", "body": "<p>I don't think this is possible when typing in a cell. The closest solution I can think of is to create an ActiveX TextBox instead, then reading the length of its value when it's changed like this:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    Range(\"A1\") = Len(TextBox1.Value)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 2902829, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/1PcPi.jpg?s=128&g=1", "display_name": "Shiva", "link": "https://stackoverflow.com/users/2902829/shiva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421146978, "creation_date": 1421141322, "last_edit_date": 1531161705, "question_id": 27918780, "link": "https://stackoverflow.com/questions/27918780/ms-excel-show-length-dynamically-on-changing-cell-value", "title": "MS Excel: Show length dynamically on changing cell value", "body": "<p>There is a string value in <code>cell A2</code> which should show its length in <code>cell B2</code>. When I change the string in <code>cell A2</code> and press enter, the length in <code>cell B2</code> will also change as per LEN function. But I need length to show \"dynamically\" when typed in the cell by pressing F2. Below is the Excel VBA that I tried</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Set KeyCells = Range(\"A2:A2\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n\n    Range(\"B2\").Value = Len(Range(Target.Address))\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2410, "user_id": 1295906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/eQGaA.jpg?s=128&g=1", "display_name": "Smittey", "link": "https://stackoverflow.com/users/1295906/smittey"}, "is_accepted": true, "score": 0, "last_activity_date": 1421331904, "creation_date": 1421331904, "answer_id": 27965574, "question_id": 27918743, "link": "https://stackoverflow.com/questions/27918743/worksheet-saveas-not-inheriting-workbook-custom-properties/27965574#27965574", "title": "Worksheet SaveAs not inheriting workbook custom properties", "body": "<p>I'm not sure that this is possible, however I did come up with a solution. It silently opens up the workbook that needs the custom properties, gives it the custom properties, saves it and then closes it down.</p>\n\n<pre><code>Dim app As New Excel.Application\napp.Visible = False 'Visible is False by default, so this isn't necessary\nDim book As Excel.Workbook\n\nSet book = app.Workbooks.Add(documentName)\n\n    With book.CustomDocumentProperties\n        .Add Name:=\"property1\", _\n            LinkToContent:=False, _\n            Type:=msoPropertyTypeString, _\n            Value:=\"One\"\n        .Add Name:=\"property2\", _\n            LinkToContent:=False, _\n            Type:=msoPropertyTypeString, _\n            Value:=\"two\"\n    End With\n\n    app.DisplayAlerts = False\n    book.Close FileName:=documentName, SaveChanges:=True\n    app.Quit\nSet app = Nothing\n</code></pre>\n"}], "owner": {"reputation": 2410, "user_id": 1295906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/eQGaA.jpg?s=128&g=1", "display_name": "Smittey", "link": "https://stackoverflow.com/users/1295906/smittey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 27965574, "answer_count": 1, "score": 0, "last_activity_date": 1421331904, "creation_date": 1421141237, "last_edit_date": 1531164843, "question_id": 27918743, "link": "https://stackoverflow.com/questions/27918743/worksheet-saveas-not-inheriting-workbook-custom-properties", "title": "Worksheet SaveAs not inheriting workbook custom properties", "body": "<p>I'm attempting to save a worksheet as a new workbook but in doing so the custom properties of the initial workbook are not being inherited.</p>\n\n<pre><code>' Set the workbook properties\nActiveWorkbook.CustomDocumentProperties.item(\"customProp1\") = variableOne\nActiveWorkbook.CustomDocumentProperties.item(\"customProp2\") = variableTwo\n\n' Save the worksheet as a new workbook\nWorksheets(\"Sheet1\").SaveAs FileName:=documentName\nActiveWorkbook.Close SaveChanges:=True\n</code></pre>\n\n<p>I've had an extensive search and I can't find a solution to this.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["excel", "copy", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": false, "score": 1, "last_activity_date": 1421226483, "creation_date": 1421226483, "answer_id": 27939179, "question_id": 27918166, "link": "https://stackoverflow.com/questions/27918166/vba-copy-columns-value-to-another-column/27939179#27939179", "title": "VBA copy column&#39;s value to another column", "body": "<p>Why not simply copy always the needed range?</p>\n\n<pre><code>Sub test()\nRange(\"Z4:Z203\").Select\nSelection.Copy\nRange(\"I5:I204\").Select\nActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3425118, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/100001301225242/picture?type=large", "display_name": "user3425118", "link": "https://stackoverflow.com/users/3425118/user3425118"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1202, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421226483, "creation_date": 1421139298, "last_edit_date": 1531161705, "question_id": 27918166, "link": "https://stackoverflow.com/questions/27918166/vba-copy-columns-value-to-another-column", "title": "VBA copy column&#39;s value to another column", "body": "<p>how to use VBA's End(xlRight) to copy one column's value to another one?\nlike I want to always copy columnZ's range(\"Z4:Z203\") value to another column's range(\"i5:i204\"),how can i use End(xlright) check if the column was pasted and it will paste on next column ? </p>\n"}, {"tags": ["excel", "vba", "ftp"], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3371361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e3e2ae2a44ba090e17cca4953dfc73e2?s=128&d=identicon&r=PG", "display_name": "Matt D. Webb", "link": "https://stackoverflow.com/users/3371361/matt-d-webb"}, "is_accepted": false, "score": 0, "last_activity_date": 1421136735, "creation_date": 1421136735, "answer_id": 27917531, "question_id": 27917208, "link": "https://stackoverflow.com/questions/27917208/update-excel-sheet-from-content-of-a-ftp-folder-with-date-and-time/27917531#27917531", "title": "Update Excel sheet from content of a ftp folder with date and time", "body": "<p>You would need to access the contents of a folder directory <code>Dir()</code>, you can then specify a network drive for example: <code>\\\\SERVER\\Folder\\</code></p>\n\n<p>Below is an example to get you started:</p>\n\n<pre><code>Sub GetDirectoryContents()\n\nDim row As Integer, Folder As String, Directory As String\nDirectory = \"\\\\Your Folder\\\"\nrow = 1\nCells(row, 1) = \"FileName\"\nCells(row, 2) = \"Size\"\nCells(row, 3) = \"Date/Time\"\n\n\n'Get Directory\nFolder = Dir(Directory)\n\nDo While Folder &lt;&gt; \"\"\n\nrow = row + 1\n\nCells(row, 1) = Folder\n\nCells(row, 2) = FileLen(Directory &amp; Folder)\n\nCells(row, 3) = FileDateTime(Directory &amp; Folder)\n\n'Get next File\nFolder = Dir()\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>If you want to update this information when the workbook opens you can call this code on within the <code>ThisWorkbook</code> module:</p>\n\n<pre><code>Private Sub Workbook_Open()\nGetDirectoryContents()\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4448221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bea2c8eda80dde7427036569755bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Vince", "link": "https://stackoverflow.com/users/4448221/vince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552193892, "creation_date": 1421135350, "last_edit_date": 1552193892, "question_id": 27917208, "link": "https://stackoverflow.com/questions/27917208/update-excel-sheet-from-content-of-a-ftp-folder-with-date-and-time", "title": "Update Excel sheet from content of a ftp folder with date and time", "body": "<p>I have a folder on a shared network. I want that whenever that folder is updated e.g. if 10 pdf files are placed in that folder, the column in the Excel sheet gets updated on a single click and shows a count 10 in a column and time of last update file in other folder.</p>\n\n<p>Above is just a scenario, I have to implement this for very big data with multiple files &amp; folders and lastly I'm going to implement it on Google doc spreadsheet.</p>\n"}, {"tags": ["performance", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1421134920, "creation_date": 1421134920, "answer_id": 27917122, "question_id": 27916675, "link": "https://stackoverflow.com/questions/27916675/excel-vba-a-faster-way-to-loop-through-a-bunch-of-range-finds/27917122#27917122", "title": "Excel VBA - A faster way to loop through a bunch of Range.Finds", "body": "<p>You try to use <a href=\"http://support.microsoft.com/kb/257819\" rel=\"nofollow\">ADO (<em>ActiveX Data Object</em>)</a>.<br>\nThis will allow you to use simple SQL statements as in your example.<br></p>\n\n<p>Sample:</p>\n\n<pre><code>Sub ject()\n    Dim con As Object: Set con = CreateObject(\"ADODB.Connection\")\n    Dim rec As Object: Set rec = CreateObject(\"ADODB.Recordset\")\n    Dim datasource As String\n    datasource = \"C:\\Users\\user.name\\Desktop\\TestFolder\\Test.xlsx\" 'change to suit\n\n    Dim sconnect As String\n    'Connection string used is for Excel 2007 and up\n    sconnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                \"Data Source=\" &amp; datasource &amp; \";\" &amp; _\n                \"Extended Properties=\"\"Excel 12.0;HDR=YES\"\";\"\n    con.Open sconnect\n\n    Dim sqlstr As String\n\n    sqlstr = \"SELECT e.column1, u.column2, e.column3, e.column4 \"\n    sqlstr = sqlstr &amp; \"FROM [A$] e \" 'from a sheet named A\n    sqlstr = sqlstr &amp; \"INNER JOIN [B$] u \" 'compare with a sheet named B\n    sqlstr = sqlstr &amp; \"ON e.id = u.id \" \n    sqlstr = sqlstr &amp; \"GROUP BY e.column1, u.column2, e.column3, e.column4 \"\n\n    rec.Open sqlstr, con, 3, 1\n\n    Dim lrow As Long\n    With Sheets(\"C\") 'Change to suit\n        .Range(\"A1\").CopyFromRecordset rec\n    End With\n\n    rec.Close: con.Close\n    Set rec = Nothing: Set con = Nothing\nEnd Sub\n</code></pre>\n\n<p>This method maybe a bit new to you but I'm sure works and it sure is fast <br> (although I have not actually compared the speed).<br>\nTo know about connection strings for <a href=\"http://www.connectionstrings.com/excel-2003/\" rel=\"nofollow\">XL 2003 and below</a> and <a href=\"http://www.connectionstrings.com/excel-2007/\" rel=\"nofollow\">XL 2007 and up</a> check the links.<br>\nBtw, you can set the data source into the same workbook where you run the macro. <br></p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>datasource = ThisWorkbook.FullName\n</code></pre>\n\n<p>where you have Sheets <strong>A</strong> and <strong>B</strong> and another Sheet <strong>C</strong> for the output. HTH.</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 1189711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1eed81a5cd5d602da3545a383e14c58d?s=128&d=identicon&r=PG", "display_name": "pgr", "link": "https://stackoverflow.com/users/1189711/pgr"}, "is_accepted": false, "score": 0, "last_activity_date": 1421153405, "creation_date": 1421153405, "answer_id": 27922625, "question_id": 27916675, "link": "https://stackoverflow.com/questions/27916675/excel-vba-a-faster-way-to-loop-through-a-bunch-of-range-finds/27922625#27922625", "title": "Excel VBA - A faster way to loop through a bunch of Range.Finds", "body": "<p>The most significant way to speed up this sort of thing is to know that interactions between the \"VBA world\" and the \"Worksheet world\" are slow, so you should keep them to a minimum.</p>\n\n<p>So you should refactor your code like this:</p>\n\n<ol>\n<li>swallow the entire WorksheetA table into an array</li>\n<li>swallow the entire WorksheetB table into an array</li>\n<li>do your for-cycle work as you have now, but over those arrays, and writing into a third array</li>\n<li>drop the entire third array into a worksheet</li>\n</ol>\n\n<p>This is done using variant arrays as documented here:</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ff726673.aspx#xlFasterVBA\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ff726673.aspx#xlFasterVBA</a></p>\n\n<p>in the section labeled: Read and Write Large Blocks of Data in a Single Operation</p>\n\n<p>Refactoring is easier than it seems, because arrays also take row and column coordinates, just like the original sheets.</p>\n\n<p>Of course you could have memory problems if your tables are too big, but with today's RAM sizes, they would have to be really, really huge to be a problem...</p>\n"}], "owner": {"reputation": 117, "user_id": 4448081, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0QFPcPx0lFU/AAAAAAAAAAI/AAAAAAAAABM/PTJrMGLetp0/photo.jpg?sz=128", "display_name": "aslanides", "link": "https://stackoverflow.com/users/4448081/aslanides"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2578, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1421153405, "creation_date": 1421133083, "last_edit_date": 1531164843, "question_id": 27916675, "link": "https://stackoverflow.com/questions/27916675/excel-vba-a-faster-way-to-loop-through-a-bunch-of-range-finds", "title": "Excel VBA - A faster way to loop through a bunch of Range.Finds", "body": "<p>I'm performing a 'join-like' operation (analogous to a database) in which I have two distinct datasets A and B with some identifier in common (let's call this the 'id'). My objective is to create a third dataset C which consists of the intersection of A and B (joining on id). In SQL the corresponding query would be something like</p>\n\n<pre><code>SELECT a.id, a.some_column, b.another_column \nFROM a,b \nWHERE a.id = b.id \n</code></pre>\n\n<p>I'm able to do the same in Excel by looping over all the rows in A's id column and doing a <code>Range.Find</code> over B's id column for each row in A. Something like this:</p>\n\n<pre><code>For Each r in Worksheet_A.Range(Cells(start_row_a,id_column_a),Cells(end_row_A,id_column_a))\n    Set found = Worksheet_B.Range(Cells(start_row_b,id_column_b),Cells(end_row_b,id_column_b)).Find(r.Value)\n    If Not found is Nothing Then\n        ' write stuff to Worksheet_C, e.g. found.Value, found.Offset(0,1).Value, r.Offset(0,-1).Value, etc.\n    End If\nNext r\n</code></pre>\n\n<p>This works fine, but it's pretty slow. I'm aware that explicit loops in languages like VB are quite slow. My question is: is there a fasterway? Have I missed a much better implementation? The closest question I could find on SO is <a href=\"https://stackoverflow.com/questions/25852657/faster-way-to-loop-through-two-sheets-of-10000-rows\">here</a>, but I don't really understand the best answer, and I'm not sure whether it's applicable to my scenario.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1421136076, "post_id": 27916668, "comment_id": 44232948, "body": "is this available in excel 2003?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1421136346, "post_id": 27916668, "comment_id": 44233053, "body": "@lakesh, yes, it is. Try!"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 1, "last_activity_date": 1421135042, "last_edit_date": 1421135042, "creation_date": 1421133064, "answer_id": 27916668, "question_id": 27916501, "link": "https://stackoverflow.com/questions/27916501/how-to-find-word-between-character-and-a-number-in-vba/27916668#27916668", "title": "How to find word between character and a number in VBA", "body": "<p>Using <a href=\"http://msdn.microsoft.com/en-us/library/ms974570.aspx\" rel=\"nofollow\">Regex</a>.</p>\n\n<p>Note: you need a reference to MS VBScripts Regular Expression library.</p>\n\n<pre><code>Dim r As VBScript_RegExp_55.RegExp\nDim sPattern As String, myString As String\nDim mc As VBScript_RegExp_55.MatchCollection, m As VBScript_RegExp_55.Match\n\nmyString = \"IRS150Sup2500Vup\"\nsPattern = \"\\w?up+\" 'searches for Sup, Vup, etc.\nSet r = New VBScript_RegExp_55.RegExp\nr.Pattern = sPattern\n\nSet mc = r.Execute(myString)\nFor Each m In mc ' Iterate Matches collection.\n    MsgBox \"word: '\" &amp; m.Value &amp; \"' founded at: \" &amp; m.FirstIndex &amp; \" length: \" &amp; m.Length\nNext\n</code></pre>\n\n<p>For further information, please see:<br/>\n<a href=\"https://support.microsoft.com/kb/818802/en\" rel=\"nofollow\">How To Use Regular Expressions in Microsoft Visual Basic 6.0 </a><br/>\n<a href=\"https://support.office.com/en-ca/article/Find-and-replace-text-by-using-regular-expressions-Advanced-eeaa03b0-e9f3-4921-b1e8-85b0ad1c427f\" rel=\"nofollow\">Find and replace text by using regular expressions (Advanced)</a></p>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 27916668, "answer_count": 1, "score": 0, "last_activity_date": 1421135042, "creation_date": 1421132357, "last_edit_date": 1495541134, "question_id": 27916501, "link": "https://stackoverflow.com/questions/27916501/how-to-find-word-between-character-and-a-number-in-vba", "title": "How to find word between character and a number in VBA", "body": "<p>For example, I have this string that reads <code>\"IRS150Sup2500Vup\"</code>. It could also be <code>\"IRS250Sdown1250Vdown\"</code>.</p>\n\n<p>In my previous <a href=\"https://stackoverflow.com/questions/27913879/how-to-find-a-number-between-two-characters-in-vba\">qn</a>, I asked how to find a number between 2 characters. Now, I need to find the word up or down after the second S now. Since it appears between the character S and the number, how do I do it?</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>Dim pos, pos1,pos2 strString As String\npos = InStr(1, objFile.Name, \"S\") + 1\npos1 = InStr(pos, objFile.Name, \"S\")\npos2 = InStr(pos1, objFile.Name, ?)\n</code></pre>\n\n<p>pos1 returns the index of the second S. I am not sure what to place in ?</p>\n"}]