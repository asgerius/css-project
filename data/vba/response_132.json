[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500508184, "post_id": 45202743, "comment_id": 77372681, "body": "How do you want to select it? A range? Can you use <code>SumIfs()</code> or a filter perhaps? What have you tried?"}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500514490, "post_id": 45202743, "comment_id": 77374121, "body": "Hey! So the way I&#39;m thinking is for it to select the range of cells starting with &quot;today&#39;s date&quot; and for it to go back 5 years of trading days (appx 1260 days). I can&#39;t use SumIfs, at least not to my knowledge, because I&#39;m not trying to add them all up. And I&#39;m not sure what you mean by filter, i don&#39;t really know how to incorporate that into the VBA code. Sorry if I am not being clear I&#39;m new to this, I can clear up any more questions. Thanks!"}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500515090, "post_id": 45202743, "comment_id": 77374285, "body": "Hmm, I think i wasn&#39;t clear in my last comment, my goal is to be able to select these cells, then offset it so I can select the column where the prices are. There is probably a more efficient way, but I&#39;m not sure what else I can do. My goal after selecting this is to have each cell divide by the previous one and then subtract one. For example, if E1 was 100 and E2 was 110, it would be (110/100)-1"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500528035, "post_id": 45204161, "comment_id": 77377891, "body": "Hey! Wow that is amazing, thanks for listing out the steps, it really helps me understand it much more. I&#39;m still sort of working out how to then figure out the standard deviation, but I&#39;m sure it&#39;ll be much easier from here. One question I have is I noticed you used      decadeAgo, is there anyway I could make it 5 years ago? Instead of 10. I wasn&#39;t able to find what VBA uses to refer to 5 years ago. Thanks again for your help!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500528736, "post_id": 45204161, "comment_id": 77378209, "body": "@vba.Beginner - Of course! THe part that was making it 10 years ago is in the <code>Function PY()...</code>. See my edit, hopefully it&#39;s more clear!  Again, I suggest stepping through the macro with <code>F8</code>, as that makes it go line by line, and uncomment out the <code>.Select</code>, so you can see in Excel what&#39;s happening a little easier.  Glad it helped!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500528929, "post_id": 45204161, "comment_id": 77378295, "body": "@vba.Beginner - If you wanted to do it, say, 5 years and 3 days before, you&#39;d just do <code>get_Previous_Date = DateSerial(Year(Dt) - 5, Month(Dt), Day(Dt) - 3)</code>. If you wanted just two months, <code>get_Previous_Date = DateSerial(Year(Dt), Month(Dt) - 2, Day(Dt))</code>. Does that make sense? [note: i&#39;ve updated that function name to be a little more intuitive]"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500529079, "post_id": 45204161, "comment_id": 77378353, "body": "@vba.Beginner - And finally, I&#39;m almost positive there&#39;s a native <code>Standard Deviation</code> function in Excel. Just look in to that and you should be good to go!  <a href=\"http://researchbasics.education.uconn.edu/calculatingmeanstandarddev/\" rel=\"nofollow noreferrer\">See here</a> for one example, and <a href=\"https://support.office.com/en-us/article/STDEV-function-51fecaaa-231e-4bbb-9230-33650a72c9b0\" rel=\"nofollow noreferrer\">here for another</a>"}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500568124, "post_id": 45204161, "comment_id": 77407027, "body": "Sorry for the late reply, I&#39;ve just gotten access to my computer. Yes! That makes a lot more sense now that you&#39;ve explained it, thank you so much! I am going to play around with the Standard Deviation function, then I&#39;m sure I will be able to figure it out from there. Another more off-topic question, how did you get so good at VBA? Is there a specific website or anything you went to learn? I have been taking the WiseOwl tutorials on youtube, but that only goes so far. Thanks again for all your help!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500568385, "post_id": 45204161, "comment_id": 77407195, "body": "@vba.Beginner - 1) Start with the macro recorder. That will help you learn some basics. 2) Learn how to avoid using <a href=\"https://stackoverflow.com/questions/10714251/\"><code>.Select</code>/<code>.Activate</code></a>, 3) Try as best you can yourself to Google things, and make attempts.  Stepping through macros with <code>F8</code> helps too, since you can go line by line. 4) Of course,  StackOverflow :D ...also there&#39;s <a href=\"http://www.cpearson.com/Excel/Topic.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s</a> site (perhaps intimidating, but really really good and well written), and again, brush up on your Google-fu and Google away!"}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500571372, "post_id": 45204161, "comment_id": 77408975, "body": "Thanks for the advice BruceWayne! You&#39;ve helped me way more than you think! :D :D :D"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1500529252, "last_edit_date": 1500529252, "creation_date": 1500518320, "answer_id": 45204161, "question_id": 45202743, "link": "https://stackoverflow.com/questions/45202743/vba-selecting-cells-that-contain-dates-for-the-past-5-years/45204161#45204161", "title": "VBA - Selecting cells that contain dates for the past 5 years", "body": "<p>How's this? I make a few assumptions, like your dates are contiguous, and there's no empty cell in your Date column. I also assume your dates are in order, ascending. (So your day 10 years ago is in say row 10, and today is in row 1000).</p>\n\n<pre><code>Sub get_difference()\nDim dateRng As Range, cel As Range, priceRng As Range\nDim dateCol As Long, stockCol As Long, lastDate As Range\nDim tdyDate As Date, decadeAgo As Date\n\ndateCol = 1 ' column A has your dates\nstockCol = 5\n\ntdyDate = WorksheetFunction.Text(Now(), \"mm/dd/yyyy\")\ndecadeAgo = get_Previous_Date(tdyDate)\nDebug.Print decadeAgo\n\nWith Sheets(\"Stock Prices\") ' change name as necessary\n    With .Columns(dateCol)\n        Set lastDate = .Find(what:=tdyDate) ' Assuming no break in data from A1\n        'lastDate.Select\n        Set cel = .Find(what:=decadeAgo)\n        'cel.Select\n    End With\n    Set rng = .Range(.Cells(cel.Row, dateCol), .Cells(lastDate.Row, dateCol))\n    'rng.Select\n    Set priceRng = rng.Offset(0, stockCol - dateCol)\n    'priceRng.Select\n    'priceRng.Offset(0, 1).Select\n    priceRng.Offset(0, 1).FormulaR1C1 = \"=IFERROR((RC[-1]/R[-1]C[-1])-1,\"\"\"\")\"\nEnd With\n\nEnd Sub\nFunction get_Previous_Date(Dt As Date) As Date\n    ' https://www.mrexcel.com/forum/excel-questions/37667-how-subtract-year-date-2.html\n    Dim numYearsBefore as Long, numDaysBefore as Long, numMonthsBefore as Long\n    numYearsBefore = 10 ' Change this to any amount of years\n    numDaysBefore = 0\n    numMonthsBefore = 0\n    get_Previous_Date = DateSerial(Year(Dt) - numYearsBefore, Month(Dt) - numMonthsBefore, Day(Dt) - numDaysBefore)\nEnd Function\n</code></pre>\n\n<p>Make changes as needed, i.e. sheet name (I called mine \"Stock Prices\"), and the columns. It's also a little verbose, and could be made more compact, but I figured it'd help you learn to keep it like that. I suggest stepping through with <code>F8</code> to see what happens, and uncommenting the <code>.select</code> lines so you can visually see what it's doing.</p>\n"}], "owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 0, "accepted_answer_id": 45204161, "answer_count": 1, "score": 0, "last_activity_date": 1500529252, "creation_date": 1500507353, "question_id": 45202743, "link": "https://stackoverflow.com/questions/45202743/vba-selecting-cells-that-contain-dates-for-the-past-5-years", "title": "VBA - Selecting cells that contain dates for the past 5 years", "body": "<p>I currently have a spreadsheet that has the dates (excluding weekends and holidays) for the past 10 years in column A. For example, A1 contains \"7/19/2007\" and A2520 contains \"7/19/2017\"</p>\n\n<p>Column E contains the closing price for the stock SPY on those corresponding dates.</p>\n\n<p>I am trying to figure out the standard deviation for the past 5 years. In order to do so, my idea was to write a VBA code that would select today's date and the previous five years, and then use that to calculate the standard deviation.</p>\n\n<p>This list is updated everyday, meaning tomorrow, it will contain 7/20/2017 and the closing price for that day. My issue is that I cannot figure out how to make it so it will select today's date and the past five years, so then I can calculate the standard deviation.</p>\n\n<p>Thank you guys for all your help! Sorry if this seems simple, I have just started learning VBA last week!</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 449, "user_id": 2569972, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000034412539/picture?type=large", "display_name": "Jace J McPherson", "link": "https://stackoverflow.com/users/2569972/jace-j-mcpherson"}, "is_accepted": true, "score": 3, "last_activity_date": 1500507842, "creation_date": 1500507842, "answer_id": 45202824, "question_id": 45202741, "link": "https://stackoverflow.com/questions/45202741/excel-if-and-or-formula/45202824#45202824", "title": "Excel IF and OR formula", "body": "<pre><code>=IF(OR(A2=\"Denied\", B2=\"Denied\"), \n    \"Denied\", \n    IF(OR(A2=\"Reimbursed\", B2=\"Reimbursed\"), \n        \"Reimbursed\", \n        \"NA\"\n    )\n)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8334685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d30c6af026b259d895a63bed87f1787?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/8334685/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 45202824, "answer_count": 1, "score": 0, "last_activity_date": 1500508063, "creation_date": 1500507343, "question_id": 45202741, "link": "https://stackoverflow.com/questions/45202741/excel-if-and-or-formula", "title": "Excel IF and OR formula", "body": "<p><a href=\"https://i.stack.imgur.com/4cxQ9.jpg**\" rel=\"nofollow noreferrer\">My attempt </a></p>\n\n<p>I'm trying to use the IF statement so that when excel is looking at row A and row B, it'll give the result in Row C. </p>\n\n<p>If the formula scan row A and B, and both A and B is NA, then row C come up to NA.</p>\n\n<p>If A come up as NA, and B come up as Denied, then row C will show up as Denied.</p>\n\n<p>If A come up as reimbursed and B come up as NA, then C will show up as reimbursed. </p>\n\n<p>here's my formula: </p>\n\n<blockquote>\n  <p>=IF(AND(A2 = \"NA\", B2 = \"NA\"),\"NA\",IF(OR(A2=\"Denied\",B2 =\"Denied\"),\"Denied\",\"NA\"))</p>\n</blockquote>\n\n<p>Can I get some tip on how to include \"reimbursed\" in the formula? </p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500508806, "post_id": 45202907, "comment_id": 77372867, "body": "This is what arrays are for.  Or a scripting dictionary.  There&#39;s no mechanism in the VBA language for &quot;evaluation&quot; of code, as you might find in (eg) javascript."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1500508954, "post_id": 45202907, "comment_id": 77372905, "body": "You&#39;re thinking in PHP or something. For this to work you would need <i>reflection</i>, which isn&#39;t a language feature of VBA. Use arrays."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500512864, "post_id": 45202907, "comment_id": 77373715, "body": "Are you actually wanting the value of a <b>variable</b> called <code>a1</code>, or are you just after the value of the <b>Excel cell</b> <code>A1</code> (i.e. you want <code>Range(&quot;a&quot; &amp; RowNum).Value</code>)?"}, {"owner": {"reputation": 155, "user_id": 6069292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hznqg.jpg?s=128&g=1", "display_name": "Bandersnatch", "link": "https://stackoverflow.com/users/6069292/bandersnatch"}, "edited": false, "score": 0, "creation_date": 1500514829, "post_id": 45202907, "comment_id": 77374211, "body": "1&amp; 2.  I&#39;ve tried an array of the variable names dimensioned as string.  Same problem - ArrayName(1) gives me &quot;a1&quot;, not the value of the variable a1.  3.  I want Range(&quot;A&quot; &amp; a1).Value or Range(&quot;A&quot; &amp; ArrayName(RowNum)).Value.  Neither of those works."}, {"owner": {"reputation": 155, "user_id": 6069292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hznqg.jpg?s=128&g=1", "display_name": "Bandersnatch", "link": "https://stackoverflow.com/users/6069292/bandersnatch"}, "edited": false, "score": 0, "creation_date": 1500518075, "post_id": 45202907, "comment_id": 77374948, "body": "I went a different way and got it to work.  I used an array of integers and set the elements of the array to the values of the a(n) variables whenever they changed.  Then Range(&quot;A&quot; &amp; ArrayName(RowNum)).Value gets the correct answer.  Thanks all of you for your suggestions."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1500517476, "creation_date": 1500517476, "answer_id": 45204030, "question_id": 45202907, "link": "https://stackoverflow.com/questions/45202907/get-the-value-of-a-variable-using-the-text-name-of-the-variable-in-vba/45204030#45204030", "title": "Get the value of a variable using the text *name* of the variable in VBA", "body": "<p>You should probably use a Dictionary:</p>\n\n<pre><code>Sub Test()\n    Dim myVars As Object\n    Dim myVar As Variant\n    Dim RowNum As Long\n\n    Set myVars = CreateObject(\"Scripting.Dictionary\")\n    myVars(\"a1\") = 7\n    myVars(\"a5\") = \"xyz\"\n    myVars(\"hello\") = 42\n\n    For RowNum = 1 To 10\n        myVar = myVars(\"a\" &amp; RowNum)\n        'use MyVar in calculation\n        MsgBox \"a\" &amp; RowNum &amp; \" contains \" &amp; myVar\n        If RowNum = 1 Then\n            MsgBox Range(\"D\" &amp; myVars(\"a\" &amp; RowNum)).Address\n        End If\n    Next RowNum\n\nEnd Sub\n</code></pre>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1436881020, "open_beta_date": 1296068400, "closed_beta_date": 1295463600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon@2.png", "twitter_account": "StackCodeReview", "favicon_url": "https://cdn.sstatic.net/Sites/codereview/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon.png", "audience": "peer programmer code reviews", "site_url": "https://codereview.stackexchange.com", "api_site_parameter": "codereview", "logo_url": "https://cdn.sstatic.net/Sites/codereview/Img/logo.png", "name": "Code Review", "site_type": "main_site"}, "on_date": 1500508461, "question_id": 169709}, "owner": {"user_type": "does_not_exist", "display_name": "Bandersnatch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1351, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1500517476, "creation_date": 1500507117, "question_id": 45202907, "link": "https://stackoverflow.com/questions/45202907/get-the-value-of-a-variable-using-the-text-name-of-the-variable-in-vba", "title": "Get the value of a variable using the text *name* of the variable in VBA", "body": "<p>I'm trying to loop through a list of variables named a1, a2, etc... and construct the name of the variable on the fly, something like this:</p>\n\n<pre><code>a1 = 7\nFor RowNum = 1 to 10\n    MyVar = \"a\" &amp; RowNum\n    'use MyVar in calculation\n    MsgBox MyVar\nNext RowNum\n</code></pre>\n\n<p>The problem is I need the <em>value</em> of MyVar, and all I get is the name.  Here, in the first iteration of the loop, MsgBox shows \"a1\" and I need 7.  I've tried many permutations using .Value and I just get compile or runtime errors.</p>\n\n<p>How do I get the value of a variable from its name in text?  Can this be done in VBA?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500504784, "post_id": 45202204, "comment_id": 77371695, "body": "where are you copying sheet 2 and sheet 3 to"}, {"owner": {"reputation": 41, "user_id": 7134777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39181533c6bea1a663b5d7e350508deb?s=128&d=identicon&r=PG&f=1", "display_name": "woollen19", "link": "https://stackoverflow.com/users/7134777/woollen19"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500506250, "post_id": 45202204, "comment_id": 77372144, "body": "sheet 2 and 3 copies will all the split worksheets. therefore, a new workbook will have header and 5000 lines from sheet 1, whole of sheet 2 and whole of sheet 3."}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1500517510, "post_id": 45202204, "comment_id": 77374809, "body": "You know how to &quot;New Workbook&quot;, &quot;Copy Rows&quot; and &quot;Copy Worksheet&quot;, I think this should not a problem to complete the whole task.  For save as xml, you can search in <a href=\"https://stackoverflow.com\">Stack Overflow</a> or google, it have a lot of sample for your reference."}, {"owner": {"reputation": 41, "user_id": 7134777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39181533c6bea1a663b5d7e350508deb?s=128&d=identicon&r=PG&f=1", "display_name": "woollen19", "link": "https://stackoverflow.com/users/7134777/woollen19"}, "edited": false, "score": 0, "creation_date": 1500518108, "post_id": 45202204, "comment_id": 77374960, "body": "@Prinsor, I actually do not know how to copy rows, worksheet. I have made the above code based on googling. Any help is appreciated! I&#39;ve just got an hour to fix this :("}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1500519302, "post_id": 45202204, "comment_id": 77375250, "body": "I&#39;m sorry that you may go to wrong place, you can ask specific question in <a href=\"https://stackoverflow.com\">Stack Overflow</a>, but not writing service."}, {"owner": {"reputation": 41, "user_id": 7134777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39181533c6bea1a663b5d7e350508deb?s=128&d=identicon&r=PG&f=1", "display_name": "woollen19", "link": "https://stackoverflow.com/users/7134777/woollen19"}, "edited": false, "score": 0, "creation_date": 1500519897, "post_id": 45202204, "comment_id": 77375397, "body": "This is the code I have currently modified to, to match with my requirements. now I only need to amend the formula to copy sheet 2 and sheet3 as whole into newly created workbooks"}, {"owner": {"reputation": 41, "user_id": 7134777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39181533c6bea1a663b5d7e350508deb?s=128&d=identicon&r=PG&f=1", "display_name": "woollen19", "link": "https://stackoverflow.com/users/7134777/woollen19"}, "edited": false, "score": 0, "creation_date": 1500519959, "post_id": 45202204, "comment_id": 77375420, "body": "Sub Macro1() Dim inputFile As String, inputWb As Workbook     Dim lastRow As Long, row As Long, n As Long     Dim newCSV As Workbook  With ActiveWorkbook.Worksheets(1)     lastRow = .Cells(Rows.Count, &quot;A&quot;).End(xlUp).row      Set newCSV = Workbooks.Add      n = 0     For row = 2 To lastRow Step 5         n = n + 1         .Rows(1).EntireRow.Copy newCSV.Worksheets(1).Range(&quot;A1&quot;)         .Rows(row &amp; &quot;:&quot; &amp; row + 5 - 1).EntireRow.Copy newCSV.Worksheets(1).Range(&quot;A2&quot;)"}, {"owner": {"reputation": 41, "user_id": 7134777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39181533c6bea1a663b5d7e350508deb?s=128&d=identicon&r=PG&f=1", "display_name": "woollen19", "link": "https://stackoverflow.com/users/7134777/woollen19"}, "edited": false, "score": 0, "creation_date": 1500519963, "post_id": 45202204, "comment_id": 77375421, "body": "&#39;Save in same folder as input workbook with .xlsx replaced by (n).csv         newCSV.SaveAs Filename:=n &amp; &quot;.xml&quot;, FileFormat:=xlCSV, CreateBackup:=False     Next End With  newCSV.Close saveChanges:=False  End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 7134777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39181533c6bea1a663b5d7e350508deb?s=128&d=identicon&r=PG&f=1", "display_name": "woollen19", "link": "https://stackoverflow.com/users/7134777/woollen19"}, "is_accepted": false, "score": 0, "last_activity_date": 1500603725, "creation_date": 1500603725, "answer_id": 45227981, "question_id": 45202204, "link": "https://stackoverflow.com/questions/45202204/excel-macro-split-workbook/45227981#45227981", "title": "Excel Macro: split workbook", "body": "<p>Below is the code that does the trick!! May be helpful to someone.</p>\n\n<pre><code>Sub Macro1()\nDim inputFile As String, inputWb As Workbook\n    Dim lastRow As Long, row As Long, n As Long\n    Dim newCSV As Workbook\n\nWith ActiveWorkbook.Worksheets(1)\n    lastRow = .Cells(Rows.Count, \"A\").End(xlDown).row\n\n    Set newCSV = Workbooks.Add\n\n    n = 0\n    For row = 2 To lastRow Step 5\n        n = n + 1\n        .Rows(1).EntireRow.Copy newCSV.Worksheets(1).Range(\"A1\")\n        .Rows(row &amp; \":\" &amp; row + 5 - 1).EntireRow.Copy newCSV.Worksheets(1).Range(\"A2\")\n\n        'Save in same folder as input workbook with .xlsx replaced by (n).csv\n        newCSV.SaveAs Filename:=n &amp; \".CSV\", FileFormat:=xlCSV, CreateBackup:=False\n    Next\nEnd With\n\nnewCSV.Close saveChanges:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7134777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39181533c6bea1a663b5d7e350508deb?s=128&d=identicon&r=PG&f=1", "display_name": "woollen19", "link": "https://stackoverflow.com/users/7134777/woollen19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500603725, "creation_date": 1500504054, "last_edit_date": 1500514807, "question_id": 45202204, "link": "https://stackoverflow.com/questions/45202204/excel-macro-split-workbook", "title": "Excel Macro: split workbook", "body": "<p>I\u2019ve got a workbook with 90000 lines and three worksheets (Sheet1, Sheet2, Sheet3)</p>\n\n<p><strong>Sheet 1</strong> has the main data (90000 lines)</p>\n\n<p><strong>Sheet 2</strong> has some data</p>\n\n<p><strong>Sheet 3</strong> has some data</p>\n\n<p>What I want is to <strong>split the data</strong> in sheet 1 into 5000 lines, <strong>copy</strong> sheet 2 and sheet 3 as it is and then <strong>save it as \u201cfilename-1\u201d</strong>. I want to do this for all lines. I also need the headers in all split files. I want to save this in xml format.</p>\n\n<p>If anyone can help will be great!</p>\n\n<p>I have currently come until here, which splits sheet1 only and does not copy the headers and sheet2 and 3. And does not save it as xml. [ for sample purposes I\u2019ve left this to save after every 5 rows]</p>\n\n<pre><code>Sub Macro1()\n    Dim rLastCell As Range\n    Dim rCells As Range\n    Dim strName As String\n    Dim lLoop As Long, lCopy As Long\n    Dim wbNew As Workbook\n\n    With ThisWorkbook.Sheets(1)\n        Set rLastCell = .Cells.Find(What:=\"*\", After:=[A1], SearchDirection:=xlPrevious)\n\n        For lLoop = 1 To rLastCell.Row Step 5\n            lCopy = lCopy + 1\n            Set wbNew = Workbooks.Add\n            .Range(.Cells(lLoop, 1), .Cells(lLoop + 5, .Columns.Count)).EntireRow.Copy _\n                Destination:=wbNew.Sheets(1).Range(\"A1\")\n            wbNew.Close SaveChanges:=True, Filename:=\"Chunk\" &amp; lCopy &amp; \"Rows\" &amp; lLoop &amp; \"-\" &amp; lLoop + 5\n        Next lLoop\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "date", "locking", "unlock"], "comments": [{"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1500503255, "post_id": 45201807, "comment_id": 77371210, "body": "Try something like this &#39;range.locked = False&#39; before you protect the sheet.  Only locked cells will be protected when you protect your sheet.  Cells that are not locked (i.e., locked = false) will not be protected on a protected sheet."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1500505240, "post_id": 45201807, "comment_id": 77371830, "body": "this lets you see the multiple column range <code>Range(&quot;D:K, M:P, R:S, U:V&quot;).Select</code> ... use this way though: <code>Range(&quot;D:K, M:P, R:S, U:V&quot;).Locked = False</code> as mentioned by @Jarom"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500506060, "post_id": 45201807, "comment_id": 77372090, "body": "for single row in those columns ... <code>intersect(rows(8),Range(&quot;D:K, M:P, R:S, U:V&quot;)).Select</code>  and  <code>intersect(rows(8),Range(&quot;D:K, M:P, R:S, U:V&quot;)).Locked = False</code> ...  don&#39;t forget, the <i>.Select</i> is only for debugging, so that you can see the resulting range. do not use it in production code, unless really, really necessary"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1500509734, "post_id": 45201807, "comment_id": 77373071, "body": "Or <code>Rows(8).Range(&quot;D1:K1, M1:P1, R1:S1, U1:V1&quot;)</code>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500627372, "post_id": 45201807, "comment_id": 77432257, "body": "@TimWilliams i like that form much better than <i>intersect</i>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8334353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88bf087e439cf4e22a7d4f046e6c846?s=128&d=identicon&r=PG&f=1", "display_name": "Siaka C", "link": "https://stackoverflow.com/users/8334353/siaka-c"}, "edited": false, "score": 0, "creation_date": 1500729429, "post_id": 45203508, "comment_id": 77473855, "body": "Thank you so much, i recently started to learn VBA and your code is so much better and totally fixed my problem. Thanks a lot"}, {"owner": {"reputation": 3, "user_id": 8334353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88bf087e439cf4e22a7d4f046e6c846?s=128&d=identicon&r=PG&f=1", "display_name": "Siaka C", "link": "https://stackoverflow.com/users/8334353/siaka-c"}, "edited": false, "score": 0, "creation_date": 1500929110, "post_id": 45203508, "comment_id": 77541837, "body": "Sorry but Is there a way to modify the code in way that a person using the sheet will be allowed to insert a comment on the unlock cells if needed ?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 3, "user_id": 8334353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88bf087e439cf4e22a7d4f046e6c846?s=128&d=identicon&r=PG&f=1", "display_name": "Siaka C", "link": "https://stackoverflow.com/users/8334353/siaka-c"}, "edited": false, "score": 0, "creation_date": 1500936645, "post_id": 45203508, "comment_id": 77544903, "body": "I recorded macro to do what you need during Protect, and you just need to add <code>DrawingObjects:=False, Contents:=True, Scenarios:=True</code> (see answer edited). But you might also want to Delete exisiting comment before Protect?"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1500936480, "last_edit_date": 1500936480, "creation_date": 1500513040, "answer_id": 45203508, "question_id": 45201807, "link": "https://stackoverflow.com/questions/45201807/unlock-a-specif-row-range-based-on-the-date/45203508#45203508", "title": "Unlock a specif Row Range based on the date", "body": "<p>Why not take it a step further? Only let them select the row of Today's date of those columns when the worksheet is activated!</p>\n\n<pre><code>Option Explicit\n\nPrivate Const PWD As String = \"3827\"\nPrivate Const UNLOCK_COLS As String = \"D:K,M:P,R:S,U:V\"\n\nPrivate Sub Worksheet_Activate()\n    Dim dToday As Date, oRng As Range, oItem As Variant\n    dToday = Date\n    With ActiveSheet\n        .Unprotect Password:=PWD\n        .Cells.Locked = True\n        ' Look for row with today's date and unlock the row inside usedrange\n        Set oRng = .Columns(\"B\").Find(What:=dToday)\n        If Not oRng Is Nothing Then\n            For Each oItem In Split(UNLOCK_COLS, \",\")\n                Intersect(oRng.EntireRow, .Columns(oItem)).Locked = False\n            Next\n        End If\n        .Protect Password:=PWD\n        .EnableSelection = xlUnlockedCells\n    End With\nEnd Sub\n</code></pre>\n\n<p><hr>\nWith optimisation sugguestion from Tim Williams, you can even skip the loop:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const PWD As String = \"3827\"\nPrivate Const UNLOCK_COLS As String = \"D1:K1,M1:P1,R1:S1,U1:V1\"\n\nPrivate Sub Worksheet_Activate()\n    Dim dToday As Date, oRng As Range\n    dToday = Date\n    With ActiveSheet\n        .Unprotect Password:=PWD\n        .Cells.Locked = True\n        ' Look for row with today's date and unlock the specific columns in the row\n        Set oRng = .Columns(\"B\").Find(What:=dToday)\n        If Not oRng Is Nothing Then oRng.EntireRow.Range(UNLOCK_COLS).Locked = False\n        .Protect Password:=PWD DrawingObjects:=False, Contents:=True, Scenarios:=True ' This allows Adding comments\n        .EnableSelection = xlUnlockedCells\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8334353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88bf087e439cf4e22a7d4f046e6c846?s=128&d=identicon&r=PG&f=1", "display_name": "Siaka C", "link": "https://stackoverflow.com/users/8334353/siaka-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 45203508, "answer_count": 1, "score": 0, "last_activity_date": 1500936480, "creation_date": 1500501799, "last_edit_date": 1500501990, "question_id": 45201807, "link": "https://stackoverflow.com/questions/45201807/unlock-a-specif-row-range-based-on-the-date", "title": "Unlock a specif Row Range based on the date", "body": "<p>I need some help to upgrade my VBA code.</p>\n\n<p>I try to find a code which will unlock a specific row based on the current date. The problem is, I don't want all the row's cells to be unlocked but only a set of specific range. Like on the current date which are in the column \"B\", the cells unlocked will be from (\"D\" to \"K\"); (\"M\" to \"P\"); (\"R\"to\"S\") and (\"U\"to\"V\").</p>\n\n<p>The cells in-between contain formulas that I don't want people to mess up or change by mistake.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Range(\"B\" &amp; Selection.Row).Value &lt;&gt; Date Then\n        ActiveSheet.Protect Password:=\"3827\"\n        MsgBox \"Only today's date needs to be edited!\", vbInformation, \"REMINDER\"\n    ElseIf Range(\"B\" &amp; Selection.Row).Value = Date Then\n        ActiveSheet.Unprotect Password:=\"3827\"\n        ActiveSheet.EnableSelection = xlNoRestrictions\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-addin"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1500499736, "post_id": 45201271, "comment_id": 77369866, "body": "So are you having problems moving a particular script to an addin?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1500530411, "post_id": 45201271, "comment_id": 77378898, "body": "May be this will help- <a href=\"https://msdn.microsoft.com/en-us/library/office/gg597509%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396#UsingVBAToCreateAddins_WhenToUseVBA\" rel=\"nofollow noreferrer\">Creating VBA Add-ins to Extend and Automate Microsoft Office Documents</a>"}, {"owner": {"reputation": 121, "user_id": 6867777, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/846afcc0bd8e744626ce90227088a5f0?s=128&d=identicon&r=PG&f=1", "display_name": "livy111", "link": "https://stackoverflow.com/users/6867777/livy111"}, "edited": false, "score": 0, "creation_date": 1500604603, "post_id": 45201271, "comment_id": 77422248, "body": "That link seems pretty helpful, will be able to explore more in depth next week when I actually create the add-ins. And no particular script issues, just the fact that I was informed and also discovered via research, that you cannot just copy/paste your VB macro into a VB project within VS and it will work. If it was that simple, I am sure I would find more articles stating as such. Any input on that matter is appreciated!"}], "answers": [{"tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 1, "last_activity_date": 1500856520, "creation_date": 1500856520, "answer_id": 45271152, "question_id": 45201271, "link": "https://stackoverflow.com/questions/45201271/how-to-move-existing-outlook-vba-code-into-an-outlook-add-in/45271152#45271152", "title": "How to move existing Outlook VBA code into an Outlook add-in?", "body": "<p>I'm not aware of any VBA to VB.NET conversion tools, but the similarities are enough that you can copy and paste most code and correct the differences on the individual lines that prevent compilation.  However it would be necessary to have a decent working knowledge of VB.NET in order to do this effectively.</p>\n\n<p>I would though recommend that this task be considered a complete re-write, especially since you need to port it to an add-in project. The way you call your VBA methods may differ greatly depending on whether they are event or UI/Ribbon driven.</p>\n\n<p>Also note that there is no macro recorder for Outlook.</p>\n"}], "owner": {"reputation": 121, "user_id": 6867777, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/846afcc0bd8e744626ce90227088a5f0?s=128&d=identicon&r=PG&f=1", "display_name": "livy111", "link": "https://stackoverflow.com/users/6867777/livy111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1913, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1605525195, "creation_date": 1500499393, "last_edit_date": 1605525195, "question_id": 45201271, "link": "https://stackoverflow.com/questions/45201271/how-to-move-existing-outlook-vba-code-into-an-outlook-add-in", "title": "How to move existing Outlook VBA code into an Outlook add-in?", "body": "<p>I am trying to develop add-ins because my organization wants to move away from macros, due to the logistical tasks of deploying to thousands of users.</p>\n<p>Is there a guide to repurpose existing VBA code into add-ins?</p>\n<p>I want to be able to view/modify the source code.</p>\n<p>Most helpful article so far:\n<a href=\"https://blogs.msdn.microsoft.com/csharpfaq/2010/09/27/converting-a-vba-macro-to-c-4-0/\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/csharpfaq/2010/09/27/converting-a-vba-macro-to-c-4-0/</a> where they suggest &quot;recording a macro in Office and then use the results in their code in VS&quot;.</p>\n"}, {"tags": ["vba", "excel", "visio"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500502856, "post_id": 45200897, "comment_id": 77371092, "body": "what happens if you enable <i>ScreenUpdating</i>  and <i>DisplayAlerts</i> ?  ... you could eliminate one <i>PasteSpecial</i> line if you use <code>wb.Worksheets(1).PasteSpecial xlPasteValuesAndNumberFormats</code>"}, {"owner": {"reputation": 5903, "user_id": 3908170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vou9q.jpg?s=128&g=1", "display_name": "DarkCygnus", "link": "https://stackoverflow.com/users/3908170/darkcygnus"}, "edited": false, "score": 0, "creation_date": 1500503521, "post_id": 45200897, "comment_id": 77371292, "body": "Hi and welcome to Stack Overflow, please take a time to go through the <a href=\"https://stackoverflow.com/tour\">welcome tour</a> to know your way around here (and also to earn your first badge), read how to create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> and also check <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask Good Questions</a> so you increase your chances to get feedback and useful answers."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500503637, "post_id": 45200897, "comment_id": 77371328, "body": "also, please do not use <code>.Select  .... Selection.</code> form in your code if you can help it. use the format that you used in the first <i>PasteSpecial</i> line.  reason: <code>Selection</code> refers to any cell or range of that you happen to click on or select even while the program is running. think of what would happen if you are doing a long calculation and you happen to click the mouse or touch the touchscreen(if you happen to have a touchscreen)."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8334230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d824b0623466e57cc7fb288eece04c?s=128&d=identicon&r=PG&f=1", "display_name": "CH1350", "link": "https://stackoverflow.com/users/8334230/ch1350"}, "is_accepted": false, "score": 0, "last_activity_date": 1500565139, "creation_date": 1500565139, "answer_id": 45219352, "question_id": 45200897, "link": "https://stackoverflow.com/questions/45200897/paste-special-vba-does-not-work-in-embedded-excel-workbook/45219352#45219352", "title": "Paste Special VBA does not work in embedded excel workbook", "body": "<p>While playing around with this more it seemed like xlPasteFormat was pasting an image over the values rather than formatting. I scrapped the pastespecial method and used a different solution.</p>\n\n<pre><code>    wb.Worksheets(1).Paste\n    wb.Worksheets(1).Range(\"A1:HK2\").Value = WorkRng.Value\n</code></pre>\n\n<p>I paste everything with the first paste and set the values with the second line so that the formatting stays.</p>\n\n<p>Thanks for the help everyone.</p>\n"}], "owner": {"reputation": 1, "user_id": 8334230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d824b0623466e57cc7fb288eece04c?s=128&d=identicon&r=PG&f=1", "display_name": "CH1350", "link": "https://stackoverflow.com/users/8334230/ch1350"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500565139, "creation_date": 1500497963, "last_edit_date": 1500498209, "question_id": 45200897, "link": "https://stackoverflow.com/questions/45200897/paste-special-vba-does-not-work-in-embedded-excel-workbook", "title": "Paste Special VBA does not work in embedded excel workbook", "body": "<p>I'm having an issue with the PasteSpecial function when working in an embedded excel workbook. The program I am working in is \"Promax\" which is block diagramming software running in Visio, which has the option to add an embedded excel workbook. I've essentially set up a number of cells in excel so that I can import a bunch of fields into a PDF form.</p>\n\n<p>While working in the embedded workbook I am unable to get this function to give any output into the new excel worksheet. If I save a version of the workbook that is outside of promax, the code runs fine. If I just try to paste instead of paste special the code works fine, but all of the references that I pasted break in the new workbook.</p>\n\n<pre><code>Sub ExporttotxtFile()\nDim wb As Workbook\nDim saveFile As String\nDim WorkRng As Range\nOn Error Resume Next\nSet WorkRng = Sheets(\"Sheet1\").Range(\"A1:HK2\")\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nSet wb = Application.Workbooks.Add\nWorkRng.Copy\nwb.Worksheets(1).PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\nwb.Worksheets(1).Range(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\nsaveFile = Application.GetSaveAsFilename(InitialFileName:=\"Export\", fileFilter:=\"Text Files (*.txt), *.txt\")\nwb.SaveAs Filename:=saveFile, FileFormat:=xlText, CreateBackup:=False\nwb.Close\nApplication.CutCopyMode = False\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Does anyone have a solution to this or another method of getting this done? This code was taken from this: <a href=\"https://www.extendoffice.com/documents/excel/612-excel-export-data-to-text.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/612-excel-export-data-to-text.html</a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1500498153, "creation_date": 1500498153, "answer_id": 45200935, "question_id": 45200864, "link": "https://stackoverflow.com/questions/45200864/how-to-use-filter-option-for-no-fill/45200935#45200935", "title": "How to use filter option for no fill", "body": "<ol>\n<li>Change a color of one cell to empty (no color)</li>\n<li>Start recording a macro</li>\n<li>Select the filter for no color</li>\n<li>Stop recording macro</li>\n<li>Change color of cell to yellow again</li>\n<li>Run recorded macro</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 6539718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e721b393044987285fe38ecf8a1bdb21?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/6539718/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500498153, "creation_date": 1500497804, "last_edit_date": 1531164843, "question_id": 45200864, "link": "https://stackoverflow.com/questions/45200864/how-to-use-filter-option-for-no-fill", "title": "How to use filter option for no fill", "body": "<p>I would like to know the excel VBA coding for the below scenario. </p>\n\n<p>I have highlighted the cells in yellow color that matches my condition and now i want to filter the no fill cells. But, the bad part is there is no cell that doesn't matches my condition and thus there is no cells without yellow color. which doesn't show the no fill option in the filter drop down.\nHow can i able to get the data of those no fill cells.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500507150, "post_id": 45200815, "comment_id": 77372410, "body": "how often are you planning on doing this process?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500507390, "post_id": 45200815, "comment_id": 77372466, "body": "the meaning of your initial remarks is not clear in my mind. are you able to use a <b>web browser</b> and download the file by clicking on the <i>download data</i> link on the yahoo web page?  ...  if yes, can you use <b>excel</b> to open the resulting csv file?  if you have not tried, then please, open the file using excel.  you should see the data in a worksheet"}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500507702, "post_id": 45200815, "comment_id": 77372544, "body": "I&#39;m not sure if I am understanding your question properly, but my idea is that once I have the 5 years in there, I can then just have each consecutive day be pasted in there. So this list would be updated daily. For example, tomorrow I would run this again in order to pull the data for 7/20/2017 in there."}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500507766, "post_id": 45200815, "comment_id": 77372566, "body": "Oh I see your question. My idea is to be able to skip that process of opening the web browser every day and having to open the csv file, and instead, to have excel download it automatically and paste in the new day and closing price of SPY"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500524825, "post_id": 45200815, "comment_id": 77376764, "body": "i understand. i checked the download link. today it is <code>https:&#47;&#47;query1.finance.yahoo.com&#47;v7&#47;finance&#47;download&#47;SPY?per&zwnj;&#8203;iod1=1463461200&amp;peri&zwnj;&#8203;od2=1494910800&amp;inter&zwnj;&#8203;val=1d&amp;events=histor&zwnj;&#8203;y&amp;crumb=aGnIEkELa61</code>. i suspect that <i>period1</i> and <i>crumb</i> parameters will change daily. could use <i>XMLHTTP</i> to download the file and then parse it  .... there must be an <i>XMLHTTP</i> library available for a Mac. here is an example of pulling data from web  <a href=\"https://stackoverflow.com/questions/25488687/parse-html-content-in-vba#25493388\" title=\"parse html content in vba%2325493388\">stackoverflow.com/questions/25488687/&hellip;</a>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500525534, "post_id": 45200815, "comment_id": 77376985, "body": "<a href=\"https://query1.finance.yahoo.com/v7/finance/download/SPY?period1=0&amp;period2=1494910800&amp;interval=1d&amp;events=history&amp;crumb=aGnIEkELa61\" rel=\"nofollow noreferrer\">query1.finance.yahoo.com/v7/finance/download/&hellip;</a>   adjusting <i>period1</i> parameter moves the start date to january 29, 1993"}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500526144, "post_id": 45200815, "comment_id": 77377192, "body": "Thanks for the information! I&#39;ll play around with the URL and see if I can move the start date to 5 years back. I&#39;m not familiar with XMLHTTP but I will look into it."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500527032, "post_id": 45200815, "comment_id": 77377501, "body": "my bad. XMLHTTP appears to be windows based. which web browser are you using?"}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500528287, "post_id": 45200815, "comment_id": 77378017, "body": "I mainly use google chrome on it, but I can use mozilla or safari. I don&#39;t have access to my laptop until tomorrow, but I will check out that link and test it out! Thanks for the info!"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500528818, "post_id": 45200815, "comment_id": 77378246, "body": "here is some code for a Mac <a href=\"https://stackoverflow.com/questions/15981960/how-do-i-issue-an-http-get-from-excel-vba-for-mac-2011\" title=\"how do i issue an http get from excel vba for mac 2011\">stackoverflow.com/questions/15981960/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500526205, "post_id": 45204058, "comment_id": 77377217, "body": "Hmm, that was part of the issue I was having. I don&#39;t understand that because they have a filter tab where you can change the date to go back 5 years."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500582233, "post_id": 45204058, "comment_id": 77415325, "body": "@ryguy72, that URL is a great find. you can use <i><a href=\"http://finance.google.com/finance/historical?q=SPY&amp;startdate=Jan+01+1970&amp;enddate=Dec+31+2050&amp;output=csv\" rel=\"nofollow noreferrer\">finance.google.com/finance/&hellip;</a></i>  , and it will pull down everything back to 2001 without calculating start and end dates"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1500583824, "post_id": 45204058, "comment_id": 77416197, "body": "Hope it helps.  Mark it as an answer if it does help you."}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500592463, "post_id": 45204058, "comment_id": 77419480, "body": "@ryguy72 Hey! Thanks for this, this made everything so much easier!"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1500563564, "last_edit_date": 1500563564, "creation_date": 1500517707, "answer_id": 45204058, "question_id": 45200815, "link": "https://stackoverflow.com/questions/45200815/download-file-from-website/45204058#45204058", "title": "Download file from Website", "body": "<p>Ok, I understand now.  Check out the link below.</p>\n\n<p><a href=\"http://investexcel.net/multiple-stock-quote-downloader-for-excel/\" rel=\"nofollow noreferrer\">http://investexcel.net/multiple-stock-quote-downloader-for-excel/</a></p>\n\n<p>Download the file from the link titled 'Get Excel Spreadsheet to Download Bulk Historical Stock Data from Google Finance'.  That will give you what you want.  I'll post the code here, but it's pretty extensive, and may not necessarily be helpful.</p>\n\n<p><a href=\"https://i.stack.imgur.com/EWCUc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EWCUc.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>'Samir Khan\n'simulationconsultant@gmail.com\n'The latest version of this spreadsheet can be downloaded from http://investexcel.net/multiple-stock-quote-downloader-for-excel/\n'Please link to http://investexcel.net if you like this spreadsheet\n\n\nSub DownloadStockQuotes(ByVal stockTicker As String, ByVal StartDate As Date, ByVal EndDate As Date, ByVal DestinationCell As String, ByVal freq As String)\n\nDim qurl As String\nDim StartMonth, StartDay, StartYear, EndMonth, EndDay, EndYear As String\n\nqurl = \"http://finance.google.com/finance/historical?q=\" &amp; stockTicker\nqurl = qurl &amp; \"&amp;startdate=\" &amp; MonthName(Month(StartDate), True) &amp; _\n       \"+\" &amp; Day(StartDate) &amp; \"+\" &amp; Year(StartDate) &amp; _\n       \"&amp;enddate=\" &amp; MonthName(Month(EndDate), True) &amp; _\n       \"+\" &amp; Day(EndDate) &amp; \"+\" &amp; Year(EndDate) &amp; \"&amp;output=csv\"\n\nOn Error GoTo ErrorHandler:\n\nQueryQuote:\nWith ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; qurl, Destination:=Range(DestinationCell))\n    .BackgroundQuery = True\n    .TablesOnlyFromHTML = False\n    .Refresh BackgroundQuery:=False\n    .SaveData = True\nEnd With\n\nErrorHandler:\n\nEnd Sub\n\nSub DownloadData()\n\nDim frequency As String\nDim numRows As Integer\nDim lastRow As Integer\nDim lastErrorRow As Integer\nDim lastSuccessRow As Integer\nDim stockTicker As String\nDim numStockErrors As Integer\nDim numStockSuccess As Integer\n\nnumStockErrors = 0\nnumStockSuccess = 0\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nlastErrorRow = ActiveSheet.Cells(Rows.Count, \"J\").End(xlUp).Row\nlastSuccessRow = ActiveSheet.Cells(Rows.Count, \"L\").End(xlUp).Row\n\nClearErrorList lastErrorRow\nClearSuccessList lastSuccessRow\n\nlastRow = ActiveSheet.Cells(Rows.Count, \"a\").End(xlUp).Row\nfrequency = Worksheets(\"Parameters\").Range(\"b7\")\n\n'Delete all sheets apart from Parameters sheet\nDim ws As Worksheet\nApplication.DisplayAlerts = False\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" Then ws.Delete\nNext\n\nApplication.DisplayAlerts = True\n\n'Loop through all tickers\nFor ticker = 12 To lastRow\n\n    stockTicker = Worksheets(\"Parameters\").Range(\"$a$\" &amp; ticker)\n\n    If stockTicker = \"\" Then\n        GoTo NextIteration\n    End If\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n\n    If InStr(stockTicker, \":\") &gt; 0 Then\n        ActiveSheet.Name = Replace(stockTicker, \":\", \"\")\n    Else\n        ActiveSheet.Name = stockTicker\n    End If\n\n    Cells(1, 1) = \"Stock Quotes for \" &amp; stockTicker\n    Call DownloadStockQuotes(stockTicker, Worksheets(\"Parameters\").Range(\"$b$5\"), Worksheets(\"Parameters\").Range(\"$b$6\"), \"$a$2\", frequency)\n    Columns(\"a:a\").TextToColumns Destination:=Range(\"a1\"), DataType:=xlDelimited, _\n                                 TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n                                 Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1))\n\n\n    If InStr(stockTicker, \":\") &gt; 0 Then\n        stockTicker = Replace(stockTicker, \":\", \"\")\n    End If\n\n    Sheets(stockTicker).Columns(\"A:G\").ColumnWidth = 10\n\n    lastRow = Sheets(stockTicker).UsedRange.Row - 2 + Sheets(stockTicker).UsedRange.Rows.Count\n\n    If lastRow &lt; 3 Then\n        Application.DisplayAlerts = False\n        Sheets(stockTicker).Delete\n        numStockErrors = numStockErrors + 1\n        ErrorList stockTicker, numStockErrors\n        GoTo NextIteration\n        Application.DisplayAlerts = True\n    Else\n        numStockSuccess = numStockSuccess + 1\n        If Left(stockTicker, 1) = \"^\" Then\n            SuccessList Replace(stockTicker, \"^\", \"\"), numStockSuccess\n        Else\n            SuccessList stockTicker, numStockSuccess\n        End If\n    End If\n\n    Sheets(stockTicker).Sort.SortFields.Add Key:=Range(\"A3:A\" &amp; lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With Sheets(stockTicker).Sort\n        .SetRange Range(\"A2:G\" &amp; lastRow)\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Range(\"a3:a\" &amp; lastRow).NumberFormat = \"yyyy-mm-dd;@\"\n\n    'Delete final blank row otherwise will get ,,,, at bottom of CSV\n    Sheets(stockTicker).Rows(lastRow + 1 &amp; \":\" &amp; Sheets(stockTicker).Rows.Count).Delete\n\n    'Remove initial ^ in ticker names from Sheets\n    If Left(stockTicker, 1) = \"^\" Then\n        ActiveSheet.Name = Replace(stockTicker, \"^\", \"\")\n    Else\n        ActiveSheet.Name = stockTicker\n    End If\n\n    'Remove hyphens in ticker names from Sheet names, otherwise error in collation\n    If InStr(stockTicker, \"-\") &gt; 0 Then\n        ActiveSheet.Name = Replace(stockTicker, \"-\", \"\")\n    End If\n\n\nNextIteration:\nNext ticker\n\nApplication.DisplayAlerts = False\n\nIf Sheets(\"Parameters\").Shapes(\"WriteToCSVCheckBox\").ControlFormat.Value = xlOn Then\n    On Error GoTo ErrorHandler:\n    Call CopyToCSV\nEnd If\n\nIf Sheets(\"Parameters\").Shapes(\"CollateDataCheckBox\").ControlFormat.Value = xlOn Then\n    On Error GoTo ErrorHandler:\n    Call CollateData\nEnd If\n\nErrorHandler:\n\nWorksheets(\"Parameters\").Select\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nWorksheets(\"Parameters\").Select\nFor Each C In ThisWorkbook.Connections\n    C.Delete\nNext\n\nEnd Sub\nSub CollateData()\n\nDim ws As Worksheet\nDim i As Integer, first As Integer\nDim maxRow As Integer\nDim maxTickerWS As Worksheet\n\nmaxRow = 0\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" Then\n        If ws.UsedRange.Rows.Count &gt; maxRow Then\n            maxRow = ws.UsedRange.Rows.Count\n            Set maxTickerWS = ws\n        End If\n    End If\nNext\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Open\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"High\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Low\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Close\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Volume\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Adjusted Close\"\n\ni = 1\nmaxTickerWS.Range(\"A2\", \"B\" &amp; maxRow).Copy Destination:=Sheets(\"Open\").Cells(1, i)\nSheets(\"Open\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"High\").Cells(1, i)\nmaxTickerWS.Range(\"c2\", \"c\" &amp; maxRow).Copy Destination:=Sheets(\"High\").Cells(1, i + 1)\nSheets(\"High\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Low\").Cells(1, i)\nmaxTickerWS.Range(\"d2\", \"d\" &amp; maxRow).Copy Destination:=Sheets(\"Low\").Cells(1, i + 1)\nSheets(\"Low\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Close\").Cells(1, i)\nmaxTickerWS.Range(\"e2\", \"e\" &amp; maxRow).Copy Destination:=Sheets(\"Close\").Cells(1, i + 1)\nSheets(\"Close\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Volume\").Cells(1, i)\nmaxTickerWS.Range(\"f2\", \"f\" &amp; maxRow).Copy Destination:=Sheets(\"Volume\").Cells(1, i + 1)\nSheets(\"Volume\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Adjusted Close\").Cells(1, i)\nmaxTickerWS.Range(\"g2\", \"g\" &amp; maxRow).Copy Destination:=Sheets(\"Adjusted Close\").Cells(1, i + 1)\nSheets(\"Adjusted Close\").Cells(1, i + 1) = maxTickerWS.Name\n\ni = i + 2\n\nFor Each ws In Worksheets\n\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" And ws.Name &lt;&gt; maxTickerWS.Name And ws.Name &lt;&gt; \"Open\" And ws.Name &lt;&gt; \"High\" And ws.Name &lt;&gt; \"Low\" And ws.Name &lt;&gt; \"Close\" And ws.Name &lt;&gt; \"Volume\" And ws.Name &lt;&gt; \"Adjusted Close\" Then\n\n        Sheets(\"Open\").Cells(1, i) = ws.Name\n        Sheets(\"Open\").Range(Sheets(\"Open\").Cells(2, i), Sheets(\"Open\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",2,0)\"\n\n        Sheets(\"High\").Cells(1, i) = ws.Name\n        Sheets(\"High\").Range(Sheets(\"High\").Cells(2, i), Sheets(\"High\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",3,0)\"\n\n        Sheets(\"Low\").Cells(1, i) = ws.Name\n        Sheets(\"Low\").Range(Sheets(\"Low\").Cells(2, i), Sheets(\"Low\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",4,0)\"\n\n        Sheets(\"Close\").Cells(1, i) = ws.Name\n        Sheets(\"Close\").Range(Sheets(\"Close\").Cells(2, i), Sheets(\"Close\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",5,0)\"\n\n        Sheets(\"Volume\").Cells(1, i) = ws.Name\n        Sheets(\"Volume\").Range(Sheets(\"Volume\").Cells(2, i), Sheets(\"Volume\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",6,0)\"\n\n        Sheets(\"Adjusted Close\").Cells(1, i) = ws.Name\n        Sheets(\"Adjusted Close\").Range(Sheets(\"Adjusted Close\").Cells(2, i), Sheets(\"Adjusted Close\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",7,0)\"\n\n        i = i + 1\n\n    End If\nNext\n\nOn Error Resume Next\n\nSheets(\"Open\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Close\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"High\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Low\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Volume\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Adjusted Close\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\n\nOn Error GoTo 0\n\nSheets(\"Open\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"High\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Low\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Close\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Volume\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Adjusted Close\").Columns(\"A:A\").EntireColumn.AutoFit\nEnd Sub\n\nSub SuccessList(ByVal stockTicker As String, ByVal numStockSuccess As Integer)\n\nSheets(\"Parameters\").Range(\"L\" &amp; 10 + numStockSuccess) = stockTicker\n\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalUp).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeLeft).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeTop).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeBottom).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeRight).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideHorizontal).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalUp).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\n\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideHorizontal).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\n\nEnd Sub\n\nSub ErrorList(ByVal stockTicker As String, ByVal numStockErrors As Integer)\n\nSheets(\"Parameters\").Range(\"J\" &amp; 10 + numStockErrors) = stockTicker\n\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalUp).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeLeft).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeTop).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeBottom).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeRight).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideHorizontal).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalUp).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\n\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideHorizontal).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\n\nEnd Sub\n\nSub ClearErrorList(ByVal lastErrorRow As Integer)\nIf lastErrorRow &gt; 10 Then\n    Worksheets(\"Parameters\").Range(\"J11:J\" &amp; lastErrorRow).Clear\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\nEnd If\nEnd Sub\n\nSub ClearSuccessList(ByVal lastSuccessRow As Integer)\nIf lastSuccessRow &gt; 10 Then\n    Worksheets(\"Parameters\").Range(\"L11:L\" &amp; lastSuccessRow).Clear\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\nEnd If\nEnd Sub\n\n\nSub CopyToCSV()\n\nDim MyPath As String\nDim MyFileName As String\n\ndateFrom = Worksheets(\"Parameters\").Range(\"$b$5\")\ndateTo = Worksheets(\"Parameters\").Range(\"$b$6\")\nfrequency = Worksheets(\"Parameters\").Range(\"$b$7\")\nMyPath = Worksheets(\"Parameters\").Range(\"$b$8\")\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" Then\n        ticker = ws.Name\n        MyFileName = ticker &amp; \" \" &amp; Format(dateFrom, \"dd-mm-yyyy\") &amp; \" - \" &amp; Format(dateTo, \"dd-mm-yyyy\") &amp; \" \" &amp; frequency\n        If Not Right(MyPath, 1) = \"\\\" Then MyPath = MyPath &amp; \"\\\"\n        If Not Right(MyFileName, 4) = \".csv\" Then MyFileName = MyFileName &amp; \".csv\"\n        Sheets(ticker).Copy\n        With ActiveWorkbook\n            .SaveAs Filename:= _\n                    MyPath &amp; MyFileName, _\n                    FileFormat:=xlCSV, _\n                    CreateBackup:=False\n            .Close False\n        End With\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500567182, "post_id": 45206523, "comment_id": 77406411, "body": "Hey thanks for the information! But someone else mentioned that the crumb may change everyday, and i think that&#39;s another issue I&#39;m having since after I clicked on your second link, it says code: unauthorized and invalid cookie. I&#39;m not too familiar with VBA just yet, so it will take me a while to figure out the code for all this, but I will try it and get back to you! Thanks!!"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500580735, "post_id": 45206523, "comment_id": 77414447, "body": "that is why you have to access the first link in order to get an updated crumb value for that day and then assemble the link for the actual data"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500581028, "post_id": 45206523, "comment_id": 77414609, "body": "the second link works only for me because the crumb is a cookie issued only to me.  your crumb value is different"}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500581219, "post_id": 45206523, "comment_id": 77414703, "body": "Ohh I see, that makes a lot more sense, I wasn&#39;t exactly sure what a crumb was or how it worked before. Thank you!!"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500581272, "post_id": 45206523, "comment_id": 77414735, "body": "using chrome browser ... go to first link ... press ctrl-U to view the source ... press ctrl-F to search ... type in &quot;crumbstore&quot; ... the crumb value is just to the right of the word &quot;crumbstore&quot;"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500581315, "post_id": 45206523, "comment_id": 77414759, "body": "i do not have access to a Mac, but i will try to piece together some code for you to try."}, {"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500592628, "post_id": 45206523, "comment_id": 77419522, "body": "Hey I just got around to being able to read your original post, thanks!"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 1, "last_activity_date": 1500531114, "creation_date": 1500531114, "answer_id": 45206523, "question_id": 45200815, "link": "https://stackoverflow.com/questions/45200815/download-file-from-website/45206523#45206523", "title": "Download file from Website", "body": "<p>here is all the info that i have gathered</p>\n\n<p><strong>first link:</strong>\ngo to <a href=\"https://finance.yahoo.com/quote/SPY/history?period1=0&amp;period2=1900000000&amp;interval=1d&amp;filter=history&amp;frequency=1d\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/SPY/history?period1=0&amp;period2=1900000000&amp;interval=1d&amp;filter=history&amp;frequency=1d</a></p>\n\n<p>i changed the start date to zero and end date to 1900000000, which is jan 01, 1970 to march 17, 2030. (unix timestamps)</p>\n\n<p>right click on \"download data\" link ... copy link address</p>\n\n<p>that gives <strong>second link:</strong> <a href=\"https://query1.finance.yahoo.com/v7/finance/download/SPY?period1=0&amp;period2=1900000000&amp;interval=1d&amp;events=history&amp;crumb=aGnIEkELa61\" rel=\"nofollow noreferrer\">https://query1.finance.yahoo.com/v7/finance/download/SPY?period1=0&amp;period2=1900000000&amp;interval=1d&amp;events=history&amp;crumb=aGnIEkELa61</a></p>\n\n<p>navigating to that URL returns a SPY.csv file spanning jan 29, 1993 to today (today being the actual today until 2030)</p>\n\n<p>your program will have to go to that URL (second link) every time you need the fresh data (use cURL for that), and download the csv file into memory and save it.</p>\n\n<p>now the catch, the download URL is not in cleartext in the html source of the first link.</p>\n\n<p><strong>this is what your program has to do:</strong> ( it will not be using a web browser, but cURL, which is a program that can request data from a web server)</p>\n\n<p>you do these steps so that you know what is involved</p>\n\n<p>open first link using google chrome ... right click ... view page source</p>\n\n<p>copy and paste the source into a text editor</p>\n\n<p>search for the crumb value (aGnIEkELa61 in the second link)(btw: it is a cookie)</p>\n\n<p>this shows you where to find the crumb ( your program would not know the value of the crumb, it would have to find it here)</p>\n\n<p>assemble the query URL ... </p>\n\n<p><code>url = \"https://query1.finance.yahoo.com/v7/finance/download/SPY?period1=0&amp;period2=1900000000&amp;interval=1d&amp;events=history&amp;crumb=\" &amp; crumbValue</code></p>\n\n<p>navigate to the resulting URL and download csv text data and process it</p>\n\n<p>recap:</p>\n\n<p>all downloads done by cURL which is called by the script</p>\n\n<p>download first link into memory and parse (look for value of crumb)</p>\n\n<p>use crumb to compute another URL (csv data)</p>\n\n<p>download data from the computed url into memory and parse into tables (or save and import ... probably easier)</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1500592832, "post_id": 45225155, "comment_id": 77419578, "body": "Hey! Wow this worked perfectly, I just had to take out some of the parameters. Thank you!"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 1, "last_activity_date": 1500584686, "creation_date": 1500584686, "answer_id": 45225155, "question_id": 45200815, "link": "https://stackoverflow.com/questions/45200815/download-file-from-website/45225155#45225155", "title": "Download file from Website", "body": "<p>i used some of the code posted by @ryguy72 and part from <a href=\"https://stackoverflow.com/questions/10269366/open-csv-file-with-correct-data-format-for-each-column-using-textfilecolumndatat#10269718\">Open CSV file with correct data format for each column using TextFileColumnDataTypes?</a>\nto get this minimal code as a test.</p>\n\n<p>it works in windows, maybe it will work on a Mac (creates a table on currentsheet and fills it with stock data from the url in the program)</p>\n\n<p>not all of the parameters in the <em>With</em> block are necessary, i think, but it is up to you to figure out which, by commenting out some and running the code (of course they can all be left in)</p>\n\n<pre><code>Sub DownloadStockQuotes()\n\n    Dim qurl As String\n    qurl = \"http://finance.google.com/finance/historical?q=SPY&amp;startdate=Jan+01+1970&amp;enddate=Dec+31+2050&amp;output=csv\"\n\n    Dim qt As QueryTable\n    Set qt = ActiveSheet.QueryTables.Add(connection:=\"TEXT;\" &amp; qurl, Destination:=Range(\"b2\"))\n\n    With qt\n        .Name = \"Output\"\n        .FieldNames = True\n        .RowNumbers = True\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 1252\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n\n        .TextFileColumnDataTypes = Array(2)         ' This doesn't make any difference anymore\n\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8304719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/25d4e721476a28dcf2d7c6bad6a4cf62?s=128&d=identicon&r=PG&f=1", "display_name": "vba.Beginner", "link": "https://stackoverflow.com/users/8304719/vba-beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 0, "accepted_answer_id": 45225155, "answer_count": 3, "score": 1, "last_activity_date": 1593676113, "creation_date": 1500497643, "last_edit_date": 1593676113, "question_id": 45200815, "link": "https://stackoverflow.com/questions/45200815/download-file-from-website", "title": "Download file from Website", "body": "<p>I am using Excel 2011 on Mac, meaning I am not able (or at least I do not know how to) navigate to a webpage and save data from a download link into an Excel Workbook.\nOn this website, </p>\n\n<p><a href=\"https://finance.yahoo.com/quote/SPY/history?period1=1342681200&amp;period2=1500447600&amp;interval=1d&amp;filter=history&amp;frequency=1d\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/SPY/history?period1=1342681200&amp;period2=1500447600&amp;interval=1d&amp;filter=history&amp;frequency=1d</a></p>\n\n<pre><code>  Sub Test()\n\n  Dim ws As Worksheet\n  Dim qr As QueryTable\n  Dim URL As String\n\n\n  Set ws = Worksheets(\"Sheet1\")\n\n  Sheets(\"Sheet1\").Cells.Clear\n  URL = \"https://finance.yahoo.com/quote/SPY/history?period1=1342681200&amp;period2=1500447600&amp;interval=1d&amp;filter=history&amp;frequency=1d\"\n\n  Set qr = ws.QueryTables.Add( _\n      Connection:=\"URL;\" &amp; URL, _\n      Destination:=Range(\"A1\"))\n      qr.RefreshStyle = xlOverwriteCells = True\n      qr.BackgroundQuery = True\n      qr.SaveData = True\n      qr.Refresh BackgroundQuery = False\n\n\n  End Sub\n</code></pre>\n\n<p>There is a \"download data\" button. I am trying to put this data into Excel so I can then calculate the 5 year standard deviation. Thank you!!</p>\n\n<p>One of the problems I am having is that you have to scroll down in order to view all of the dates, so when I input the data into a querytable, it will only pull the data from the dates that are showing at first.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 2, "creation_date": 1500507807, "post_id": 45201052, "comment_id": 77372580, "body": "delete the <code>Columns(&quot;M:M&quot;).Select</code> line. it does nothing useful and is not required."}], "tags": [], "owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "is_accepted": true, "score": 2, "last_activity_date": 1500500078, "last_edit_date": 1500500078, "creation_date": 1500498591, "answer_id": 45201052, "question_id": 45200732, "link": "https://stackoverflow.com/questions/45200732/vba-sort-a-z-on-one-column/45201052#45201052", "title": "VBA Sort A-Z on One Column", "body": "<p>Record a macro where you select the column you want to be sorted. As an example, I've recorded a macro that sorts column M in ascending order:</p>\n\n<pre><code>Sub SortAsc2()\n\nDim LastRow As Long\n\nLastRow = Cells(Rows.Count, \"M\").End(xlUp).Row\n\nColumns(\"M:M\").Select\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"M1\"), _\n    SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n    .SetRange Range(\"M1:M\" &amp; LastRow)\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 5531672, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2425e2c5670e7bc1f4d5de41d33292c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/5531672/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6553, "favorite_count": 0, "accepted_answer_id": 45201052, "answer_count": 1, "score": 2, "last_activity_date": 1500500078, "creation_date": 1500497336, "question_id": 45200732, "link": "https://stackoverflow.com/questions/45200732/vba-sort-a-z-on-one-column", "title": "VBA Sort A-Z on One Column", "body": "<p>How do I sort all my rows which I have A-Z based on ascending A-Z on column M\nI have tried the following but it hasn't worked any idea what I might be doing wrong?</p>\n\n<pre><code>Range(\"A1\", Range(\"Z\" &amp; Rows.Count).End(xlUp)).Sort [M1], xlAscending\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 1, "creation_date": 1500497258, "post_id": 45200691, "comment_id": 77368649, "body": "What exactly isn&#39;t working?  Also,  removing the on error resume next is often helpful for debugging, as it will hide the actual source of any errors..."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1500497358, "post_id": 45200691, "comment_id": 77368699, "body": "You set the answer from MsgBox to <code>answerABC</code>, but in <code>If</code> statement you check <code>answerBICL</code>. Is that &quot;typo&quot;?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1500497360, "post_id": 45200691, "comment_id": 77368701, "body": "You have to make sure you qualify all ranges with their expected workbook/worksheet.  Whenever you have <code>Range(Cells(), Cells())</code>, it&#39;s going to use the range and cells from the **ActiveWorkbook / Worksheet<code>.  You need to do like, </code>wBook.wSheet.Cells(Rows.Count,&quot;B&quot;).End(xlUp).Row` or else it&#39;s going to get the last row from the activebook/sheet. If you want that, then please be explicit still.  (Note that <code>Rows.Count</code> doesn&#39;t necessarily need the sheet/book reference, since that&#39;s the same (assumedly) for all worksheets.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1500497611, "post_id": 45200691, "comment_id": 77368813, "body": "Include <code>Option Explicit</code> as the first line of every code module.  That will then tell you as soon as you try to use undeclared variables in your code, and point you straight to the undefined <code>answerBICL</code> that @EganWolf mentioned."}, {"owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1500499100, "post_id": 45200691, "comment_id": 77369532, "body": "@EganWolf So sorry, answerBICL is a typo!"}, {"owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1500499106, "post_id": 45200691, "comment_id": 77369537, "body": "@nwhaught the code works and copies the data that I want, but after copying it gives me the &quot;No open file for ABC Found. Make sure the most recent ABC Excel WB is open!&quot; message."}, {"owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500499138, "post_id": 45200691, "comment_id": 77369551, "body": "@YowE3K let me try adding that and see if it helps! Thanks."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1500499386, "post_id": 45200691, "comment_id": 77369679, "body": "Did you try debugging it? Place text cursor somewhere within the code at press F8 to run macro line by line. You can check values of your variables at any time and it should help you find a problem."}, {"owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1500499883, "post_id": 45200691, "comment_id": 77369942, "body": "@EganWolf I tried that too!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500500010, "post_id": 45200691, "comment_id": 77370009, "body": "@AkshaySachdev Adding <code>Option Explicit</code> won&#39;t fix the problem - it just causes VBA to refuse to compile until you fix the problem (and in your case will highlight the fact that you are using a variable <code>answerBICL</code> when you probably meant to use <code>answerABC</code>)."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500513287, "post_id": 45200691, "comment_id": 77373813, "body": "<code>Columns(&quot;C:E&quot;).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove</code> ... inserts three columns"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "edited": false, "score": 0, "creation_date": 1500499865, "post_id": 45201335, "comment_id": 77369936, "body": "That is what is happening. If I have multiple excel workbooks open, it does find the right sheet, copy as required but then gives me the message! I&#39;m literally pulling out my hair and nothing really is working out!"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "edited": false, "score": 0, "creation_date": 1500500154, "post_id": 45201335, "comment_id": 77370073, "body": "It&#39;s processing all the sheets in the workbook, regardless of whether or not it found the value. Each sheet that gets processed resets xyz to nothing,  which is happening after the value is found."}, {"owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "edited": false, "score": 0, "creation_date": 1500500317, "post_id": 45201335, "comment_id": 77370144, "body": "I&#39;ll tell you my dilemma, I get a file where column B has values like ABC12345. I&#39;m looking to have my Find condition to look for value &quot;ABC&quot; in cell B2. If it&#39;s there, continue with the process, if not give the Message declared at end..  Set rFound = wSheet.Cells.Find(What:=&quot;ABC &quot;, After:=wSheet.Cells(1, 1), _ LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _ SearchDirection:=xlNext, MatchCase:=True)"}, {"owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "edited": false, "score": 0, "creation_date": 1500501149, "post_id": 45201335, "comment_id": 77370516, "body": "I&#39;ve edited and shared my final code which is still giving me the same issue! I know its a very poorly done code, but at the end all I want is it to work!"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "edited": false, "score": 0, "creation_date": 1500502821, "post_id": 45201335, "comment_id": 77371083, "body": "Awesome! If you&#39;ve got it working,  please click on the check to accept the answer, and/ or upvote..."}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 0, "last_activity_date": 1500499889, "last_edit_date": 1500499889, "creation_date": 1500499678, "answer_id": 45201335, "question_id": 45200691, "link": "https://stackoverflow.com/questions/45200691/performing-a-keyword-search-across-all-open-excel-workbooks-vba/45201335#45201335", "title": "Performing a keyword search across all open excel workbooks VBA", "body": "<p>Your issue is that you don't exit your inner for loop in time.  You exit the outer for after processing all of the sheets, which is setting XYZfound back to nothing. </p>\n\n<p>If you only need to find this thing once, then move your 'exit for' up a couple of lines, and terminate the loop before processing the next sheet in the workbook. </p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "edited": false, "score": 0, "creation_date": 1500501134, "post_id": 45201505, "comment_id": 77370510, "body": "I&#39;ve edited and shared my final code which is still giving me the same issue! I know its a very poorly done code, but at the end all I want is it to work!"}], "tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 1, "last_activity_date": 1500500429, "creation_date": 1500500429, "answer_id": 45201505, "question_id": 45200691, "link": "https://stackoverflow.com/questions/45200691/performing-a-keyword-search-across-all-open-excel-workbooks-vba/45201505#45201505", "title": "Performing a keyword search across all open excel workbooks VBA", "body": "<p>Aside from what @nwhaught said, there is a problem in <code>If xFound = 1 Then Exit For</code>. Your <code>xFound</code> is declared as <code>Boolean</code> and despite you set a value of <code>1</code> (one) to it, the real value is <code>True</code>. Now, for VBA <code>True</code> is not equal <code>1</code> and your <code>If</code> condition is always <code>False</code>. The value of <code>True</code> in VBA is <code>-1</code>, but you don't need this. Just use <code>If xFound Then Exit For</code>, as checking a value of boolean is enough, there's no need to compare it with another boolean.</p>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 0, "last_activity_date": 1500523997, "last_edit_date": 1500523997, "creation_date": 1500515636, "answer_id": 45203815, "question_id": 45200691, "link": "https://stackoverflow.com/questions/45200691/performing-a-keyword-search-across-all-open-excel-workbooks-vba/45203815#45203815", "title": "Performing a keyword search across all open excel workbooks VBA", "body": "<p>you can shorten the search lines by using this:</p>\n\n<pre><code>    Columns(\"A\").Replace \";\", \"\"\n    Columns(\"A\").Replace \":\", \"\"\n    Columns(\"A\").Replace \",\", \"\"\n    Columns(\"A\").Replace \"(\", \"\"\n    Columns(\"A\").Replace \")\", \"\"\n    Columns(\"A\").Replace \"{\", \"\"\n                 . \n                 . \n                 . \n                 . \n</code></pre>\n\n<p>this is an example of a good reason to use the <em>With</em> command</p>\n\n<pre><code>    With Columns(\"A\")\n        .Replace \";\", \"\"\n        .Replace \":\", \"\"\n        .Replace \",\", \"\"\n        .Replace \"(\", \"\"\n        .Replace \")\", \"\"\n        .Replace \"{\", \"\"\n                 . \n                 . \n                 . \n    End With\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>    Dim badText As Variant\n    For Each badText In Array(\";\", \":\", \",\", _\n                               \"(\", \")\", \"{\", \"}\", \"[\", \"]\", _\n                               \"~+\", \"~*\", \"~?\", \"_\", \".\", _\n                               \"'\", \"\\\", \"/\", \"@\", \"\"\"\")       ' chr(34) = \" (quote), in VBA string it must be escaped by doubling it up\n\n        Columns(\"A\").Replace badText, \"\"\n    Next badText\n</code></pre>\n\n<p>another place to simplify:</p>\n\n<p>the two range content checks where you put the text \"Company\" beside each non-empty cell</p>\n\n<pre><code>Set rngC = Range(\"C2:C100\")\nFor Each cell In rngC\n         .\n         .\nSet rngE = Range(\"H2:H100\")\nFor Each cell In rngE\n         .\n</code></pre>\n\n<p>the two <em>For</em> loops can be combined into one that starts with this line:</p>\n\n<pre><code>For Each cell In Range(\"C2:C100, H2:H100\")\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7287630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10154790244712806/picture?type=large", "display_name": "Akshay Sachdev", "link": "https://stackoverflow.com/users/7287630/akshay-sachdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 45203815, "answer_count": 3, "score": 0, "last_activity_date": 1500523997, "creation_date": 1500497128, "last_edit_date": 1500500992, "question_id": 45200691, "link": "https://stackoverflow.com/questions/45200691/performing-a-keyword-search-across-all-open-excel-workbooks-vba", "title": "Performing a keyword search across all open excel workbooks VBA", "body": "<p>I've been working on a lot of Excel VBA Macros codes and have achieved a lot. I've run into an issue, where I wish to perform a search for a keyword that may be available in one of the open Excel Workbooks, like - ABC12345 and I want the criteria to be met if \"ABC\" is found in cell B2.</p>\n\n<p>My code so far:</p>\n\n<pre><code>Sub ABC_Upload()\nSheets(\"Add File Here\").Select\nIf IsEmpty(Range(\"A1\")) Then\n  Worksheets(\"Master Mapper\").Activate\n\n  Dim answerABC As Integer\nanswerABC = MsgBox(\"Please check the Data Sheet. No value found in first row! Do you wish to find XYZ file in open workbooks and start process?\", vbYesNo + vbQuestion, \"Review &amp; Proceed\")\nIf answerABC = vbYes Then\n\n    'Starts here\n    Dim wSheet As Worksheet\n    Dim wBook As Workbook\n    Dim XYZFound As Range\n    Dim xFound As Boolean\n    Dim lngLastRow2 As Long\n\n    On Error Resume Next\n    For Each wBook In Application.Workbooks\n        For Each wSheet In wBook.Worksheets\n            Set XYZFound = Nothing\n            Set XYZFound = wSheet.Cells.Find(What:=\"ABC\", After:=wSheet.Cells(1, 1), _\n            LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, MatchCase:=True)\n            'Set XYZFound = wSheet.Cells.Find(What:=\"BIC\", After:=wSheet.Cells(1, 1), _\n            LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, MatchCase:=False)\n\n            'XYZFound.Cells.Select\n            If Not XYZFound Is Nothing Then\n                xFound = True\n                Application.Goto XYZFound, True\n            'Rows(1, 2).EntireRow.Hidden = True\n            lngLastRow2 = Cells(Cells.Rows.Count, \"B\").End(xlUp).Row\n            Range(\"A1:E\" &amp; lngLastRow2).Copy\n            ThisWorkbook.Worksheets(\"Add File Here\").Activate\n            Range(\"A1\").Select\n            ActiveSheet.Paste\n            Application.CutCopyMode = False\n\n            End If\n\n        Next wSheet\n        If xFound Then Exit For\n        Next wBook\n\nIf XYZFound Is Nothing Then\nMsgBox \"No open file for XYZ Meetings Found. Make sure the most recent XYZ Excel WB is open!\", vbCritical + vbOKOnly\nExit Sub\nEnd If\n    'Ends Here\n\nSheets(\"Add File Here\").Select\nColumns(\"A\").Replace _\n What:=\";\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\":\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\",\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"(\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\")\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"{\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"}\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"[\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"]\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"~+\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"~*\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"~?\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"_\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\".\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"'\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"\\\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"/\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\".\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=\"@\", Replacement:=\"\"\nColumns(\"A\").Replace _\n What:=Chr(34), Replacement:=\"\"\n\nColumns(\"C:C\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"C1\").Value = \"Client ID\"\nColumns(\"D:D\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"D1\").Value = \"Client Name\"\nColumns(\"E:E\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"E1\").Value = \"Planner Name\"\nColumns(\"I:I\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"I1\").Value = \"External System Name\"\nDim rng As Range\n    Dim i As Long\n\n    'Set the range in column A you want to loop through\n    Set rng = Range(\"B2:B100\")\n    For Each cell In rng\n        'test if cell is empty\n        If cell.Value &lt;&gt; \"\" Then\n            'write to adjacent cell\n            cell.Offset(0, 1).Value = \"Company ID\"\n        End If\n    Next\nDim rngC As Range\n    Dim Ci As Long\n\n    'Set the range in column A you want to loop through\n    Set rngC = Range(\"C2:C100\")\n    For Each cell In rngC\n        'test if cell is empty\n        If cell.Value &lt;&gt; \"\" Then\n            'write to adjacent cell\n            cell.Offset(0, 1).Value = \"Company\"\n        End If\n    Next\nDim rngP As Range\n    Dim Pi As Long\n\n    'Set the range in column A you want to loop through\n    Set rngP = Range(\"D2:D100\")\n    For Each cell In rngP\n        'test if cell is empty\n        If cell.Value &lt;&gt; \"\" Then\n            'write to adjacent cell\n            cell.Offset(0, 1).Value = \"NA\"\n        End If\n    Next\nDim rnEP As Range\n    Dim Ei As Long\n\n    'Set the range in column A you want to loop through\n    Set rngE = Range(\"H2:H100\")\n    For Each cell In rngE\n        'test if cell is empty\n        If cell.Value &lt;&gt; \"\" Then\n            'write to adjacent cell\n            cell.Offset(0, 1).Value = \"Company\"\n        End If\n    Next\n'MsgBox \"File has been formatted for XYZ and is ready for MMS upload.\", vbOKOnly\nDim answer As Integer\nanswer = MsgBox(\"Temporary File Prepared for XYZ. Do you wish to proceed with MMS_NewMtgs file creation?\", vbYesNo + vbQuestion, \"Review &amp; Proceed\")\nIf answer = vbYes Then\n    Call Prepare_OutputFile\nElse\n    MsgBox \"Output file not created!! Please select - Click to create MMS Formatted File from Master Mapper.\", vbOKOnly\nEnd If\nEnd If\nEnd If\nThisWorkbook.Saved = True\nEnd Sub\n</code></pre>\n\n<p>Any suggestions would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 161, "user_id": 3409525, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af2fd856978621577364a79d83d22ba3?s=128&d=identicon&r=PG&f=1", "display_name": "Yoav24", "link": "https://stackoverflow.com/users/3409525/yoav24"}, "edited": false, "score": 0, "creation_date": 1500496454, "post_id": 45200416, "comment_id": 77368197, "body": "cut/paste as well as copy/paste in Excel VBA has very clunky syntax. My go-to solution is doing it manually under Record Macro, and then using the generated VBA code as a working template."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500497445, "post_id": 45200416, "comment_id": 77368729, "body": "You can&#39;t do <code>...Cut [].Insert</code> on the same line. First, insert your line, then cut, then paste to the new line."}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1500499618, "post_id": 45200416, "comment_id": 77369800, "body": "@BruceWayne You technically can put multiple statements on the same line by separating them with <code>:</code>, though I would not recommend it for readability."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500500264, "post_id": 45200416, "comment_id": 77370114, "body": "@HaoZhang - Agreed...and also it doesn&#39;t look like OP is attempting that though."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1500530089, "post_id": 45200416, "comment_id": 77378764, "body": "You can first insert a blank row at &quot;Completed_Orders&quot;, then Copy to that blank Row and finally Delete from the source."}], "owner": {"reputation": 1, "user_id": 8334150, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213908980825119/picture?type=large", "display_name": "Chris A. McGough", "link": "https://stackoverflow.com/users/8334150/chris-a-mcgough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500496150, "creation_date": 1500496090, "last_edit_date": 1500496150, "question_id": 45200416, "link": "https://stackoverflow.com/questions/45200416/excel-2010-cut-and-insert-syntax", "title": "Excel 2010 cut and insert syntax", "body": "<p>I'm new to Excel VBA.I'm trying to feel my way through and I've hit a dead end.</p>\n\n<p>I need to \nInput amount of devices delivered.\nIf all devices were not delivered, leave the row in place, update the quantities and change the row color.\nIf all devices were delivered, then cut (and remove the empty row) and insert (moving older entries down) at the top of a different worksheet.</p>\n\n<p>I can't get the cut/insert to work correctly.  </p>\n\n<p>My current code:</p>\n\n<pre><code>Dim Models As Range    \nDim ModelCell As Range    \nDim RowNumber As Integer\n\nFor Each ModelCell In Models.Cells\n                If ModelCell.Value &lt;&gt; \"0\" Then\n\n                    CurrentCount = ModelCell.Value\n                    TotalReceived = InputBox(\"How many were received?\")\n                    ModelCell.Value = CurrentCount - TotalReceived\n                        If ModelCell.Value &gt; \"0\" Then\n                            Rows(RowNumber).Interior.Color = rgbAquamarine\n                        End If\n\n\n                Cells(RowNumber, 1).cut Worksheets(\"Completed_Orders\").Range(\"3:3\").Insert  'selects data and copies and pastes\n                Rows(RowNumber).Delete 'Deletes empty row\n                End If\n            Next ModelCell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1500497615, "post_id": 45200387, "comment_id": 77368814, "body": "What do you mean &quot;Like Condition&quot;? As for multiple criteria, you&#39;ll need to use multiple <code>.replace</code> lines in VBA for each condition."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1500498689, "post_id": 45200387, "comment_id": 77369335, "body": "You can use wildcards like <code>?</code> for a single character and <code>*</code> for a string."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1500506152, "post_id": 45200387, "comment_id": 77372116, "body": "You could use a regular expression to replace all occurrences of symbols in a given set of symbols by a target symbol, though that would require iterating over the cells with a loop rather than using the <code>Replace()</code> method."}, {"owner": {"reputation": 9, "user_id": 8251764, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c005033dcf27c51baac868ff36753ce?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/8251764/rick"}, "edited": false, "score": 0, "creation_date": 1500573337, "post_id": 45200387, "comment_id": 77410119, "body": "Thanks for the input"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1500522419, "creation_date": 1500522419, "answer_id": 45204775, "question_id": 45200387, "link": "https://stackoverflow.com/questions/45200387/how-can-i-use-what-in-vba-for-like-and-multiple-condition/45204775#45204775", "title": "how can I use what:= in VBA for like and multiple condition", "body": "<p>As mentioned in the comments, you can use multiple Replace statements:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ReplaceDoTwComma()\n\n    Dim findVal As Variant, replVal As Variant, i As Long, cols As Range\n\n    findVal = Split(\", - * test1\")  'add items to replace separated by a space\n\n    replVal = Split(\". _ ! test3\")  'add replacements (same number as findVal)\n\n    With Worksheets(\"Sheet1\")\n        With .Range(.Cells(1), .Cells.SpecialCells(xlCellTypeLastCell))\n            Set cols = Union(.Columns(4), .Columns(7))\n        End With\n    End With\n\n    For i = LBound(findVal) To UBound(findVal)\n\n        If findVal(i) = \"*\" Then findVal(i) = \"~*\"    'escapes special wild char \"*\"\n\n        cols.Replace What:=findVal(i), Replacement:=replVal(i), LookAt:=xlPart\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8251764, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c005033dcf27c51baac868ff36753ce?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/8251764/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 45204775, "answer_count": 1, "score": 0, "last_activity_date": 1500522419, "creation_date": 1500495992, "last_edit_date": 1531164843, "question_id": 45200387, "link": "https://stackoverflow.com/questions/45200387/how-can-i-use-what-in-vba-for-like-and-multiple-condition", "title": "how can I use what:= in VBA for like and multiple condition", "body": "<p>I have below code, which is working fine. However I need to know how to use like condition in place of what:',' and multiple search criteria like I need to find (\",\" \"-\", \"*\", etc)</p>\n\n<pre><code>Option Explicit\nSub ReplaceDoTwComma()   \n        Worksheets(\"Sheet1\").Columns(\"D\").replace _\n            What:=\",\", replacement:=\".\", LookAt:=xlPart    \n        Worksheets(\"Sheet1\").Columns(\"G\").replace _\n            What:=\",\", replacement:=\".\", LookAt:=xlPart \nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for help</p>\n"}, {"tags": ["vba", "web-scraping", "web-crawler"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1500495882, "post_id": 45200247, "comment_id": 77367854, "body": "The Yellow Pages site just returns the last page available if you use (eg) &quot;...page=999&quot;   It still returns 200 as status."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500495963, "post_id": 45200247, "comment_id": 77367898, "body": "Yep right you are, Tim Williams. This is where I got stuck."}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 1, "creation_date": 1500496199, "post_id": 45200247, "comment_id": 77368043, "body": "You might just have to match something in the page as well to make sure you still have results. For general redirections, you can try <a href=\"https://stackoverflow.com/questions/161343/how-do-i-prevent-serverxmlhttp-from-automatically-following-redirects-http-303\">disabling redirection for your HTTP request</a> and catch the HTTP status code to determine if it&#39;s trying to redirect you to a page you didn&#39;t intend on going to."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1500497013, "post_id": 45200247, "comment_id": 77368507, "body": "Thanks for your answer, Hao Zhang. Seems to be working. Get back to you after checking few more urls. Thanks."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1500497766, "post_id": 45200247, "comment_id": 77368887, "body": "Sorry Hao Zhang, it couldn&#39;t do the trick. I tried with yellow page but saw it running incessantly."}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500498356, "post_id": 45200247, "comment_id": 77369178, "body": "I noticed that every result entry has the class name &quot;result&quot;. Now you just need to find out an alternative to getElementsByClassName since it&#39;s apparently not available. Of course, there&#39;s no way for you to determine this for every page you run across, because they all have different behaviors that tell us when they are out of results. What I just told you only works for that Yellow Pages site."}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1500586632, "post_id": 45225295, "comment_id": 77417507, "body": "You are impossible Tehscript!!!! I run with two problematic sites and both of them rock as your code always does. It&#39;s an Oscar winning code. I never see this style. Thanks for everything. Long live!!!!"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1500587033, "post_id": 45225295, "comment_id": 77417649, "body": "My last ever urge to you to take a look into this link. I&#39;m a newbie in writing class so I can&#39;t rectify my mistakes. In your spare time plz plz plz &quot;<a href=\"https://stackoverflow.com/questions/45224058/class-crawler-written-in-python-throws-attribute-error\" title=\"class crawler written in python throws attribute error\">stackoverflow.com/questions/45224058/&hellip;</a>&quot; . Stay well."}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": true, "score": 1, "last_activity_date": 1500585231, "creation_date": 1500585231, "answer_id": 45225295, "question_id": 45200247, "link": "https://stackoverflow.com/questions/45200247/web-scraping-across-multipages-without-even-knowing-the-last-page-number/45225295#45225295", "title": "Web-scraping across multipages without even knowing the last page number", "body": "<p>You can always rely on elements if they exits or not. Here for example, if you try to use the object which you have set your element to, you will get:</p>\n\n<blockquote>\n  <p>Run-time error '91': Object variable or With block variable not set</p>\n</blockquote>\n\n<p>This is the key you should be looking for to put an end to your code. Please see the below example:</p>\n\n<pre><code>Sub yify()\nConst mlink = \"https://www.yify-torrent.org/genres/western/p-\"\nDim http As New XMLHTTP60, html As New HTMLDocument\nDim post As Object\nDim posts As Object\n\ny = 1\nDo\n    With http\n        .Open \"GET\", mlink &amp; y &amp; \"/\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    Set posts = html.getElementsByClassName(\"mv\")\n    On Error GoTo Endofpage\n    Debug.Print Len(posts) 'to force Error 91\n\n    For Each post In posts\n        With post.getElementsByTagName(\"div\")\n            x = x + 1\n            If .Length Then Cells(x, 1) = .Item(0).innerText\n        End With\n    Next post\n    y = y + 1\nEndofpage:\nLoop Until Err.Number = 91\nDebug.Print \"It's over\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 1, "accepted_answer_id": 45225295, "answer_count": 1, "score": 1, "last_activity_date": 1500585231, "creation_date": 1500495427, "last_edit_date": 1500554635, "question_id": 45200247, "link": "https://stackoverflow.com/questions/45200247/web-scraping-across-multipages-without-even-knowing-the-last-page-number", "title": "Web-scraping across multipages without even knowing the last page number", "body": "<p>Running my code for a site to crawl the titles of different tutorials spreading across several pages, I found it working flawless. I tried to write some code not depending on the last page number the url has but on the status code until it shows http.status&lt;>200. The code I'm pasting below is working impeccably in this case. However, Trouble comes up when I try to use another url to see whether it breaks automatically but found that the code did fetch all the results but did not break. What is the workaround in this case so that the code will break when it is done and stop the macro? Here is the working one?</p>\n\n<pre><code>Sub WiseOwl()\nConst mlink = \"http://www.wiseowl.co.uk/videos/default\"\nDim http As New XMLHTTP60, html As New HTMLDocument\nDim post As Object\n\nDo While True\n     y = y + 1\n    With http\n        .Open \"GET\", mlink &amp; \"-\" &amp; y &amp; \".htm\", False\n        .send\n        If .Status &lt;&gt; 200 Then\n            MsgBox \"It's done\"\n            Exit Sub\n        End If\n        html.body.innerHTML = .responseText\n    End With\n\n    For Each post In html.getElementsByClassName(\"woVideoListDefaultSeriesTitle\")\n        With post.getElementsByTagName(\"a\")\n            x = x + 1\n            If .Length Then Cells(x, 1) = .item(0).innerText\n        End With\n    Next post\nLoop\nEnd Sub\n</code></pre>\n\n<p>I found a logic to get around with yellowpage. My update script is able to parse yellowpage but breaks before scraping the last page because there is no \"Next Page\" button. I tried with this:\n\"<a href=\"https://www.dropbox.com/s/iptqm79b0byw3dz/Yellowpage.txt?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/iptqm79b0byw3dz/Yellowpage.txt?dl=0</a>\"</p>\n\n<p>However, the same logic I tried to apply with torrent site but it doesn't work here:</p>\n\n<p>\"<a href=\"https://www.yify-torrent.org/genres/western/p-1/\" rel=\"nofollow noreferrer\">https://www.yify-torrent.org/genres/western/p-1/</a>\"</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500495911, "post_id": 45200154, "comment_id": 77367873, "body": "So basically, you&#39;re clicking &quot;Next&quot; until the webpage itself no longer shows the &quot;Next&quot; button, correct?  That&#39;s how you know when to stop?"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 1, "creation_date": 1500496620, "post_id": 45200154, "comment_id": 77368287, "body": "Use a for loop and check whether getElementById returns <code>Nothing</code> to determine whether the button exists or not."}, {"owner": {"reputation": 5, "user_id": 8205404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb132f620a3d07dd54feba06ce4182fc?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8205404/chris"}, "edited": false, "score": 0, "creation_date": 1500550509, "post_id": 45200154, "comment_id": 77392834, "body": "Yes BruceWayne that is correct except the next button just becomes hidden. It wont return a &quot;nothing&quot; value at the end."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8205404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb132f620a3d07dd54feba06ce4182fc?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8205404/chris"}, "edited": false, "score": 0, "creation_date": 1500552475, "post_id": 45200587, "comment_id": 77394416, "body": "Thank you very much. I used this and have fixed THIS problem. I used the second code as I do not ever know the exact number of loops I will need. The problem is that my next button never returns a value of &quot;nothing&quot; so it continues to run script until I manually stop it, which is fine. I was wondering if you had a solution for that possibility? The button just fades at the end. I can put it in another question if you wish."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 5, "user_id": 8205404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb132f620a3d07dd54feba06ce4182fc?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8205404/chris"}, "edited": false, "score": 0, "creation_date": 1500571435, "post_id": 45200587, "comment_id": 77409014, "body": "Glad to help.  Ah I believe if it fades out on the last click, it may be there but not visible?  You can set a condition before the <code>next</code> to see if it&#39;s not visible anymore"}], "tags": [], "owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "is_accepted": true, "score": 0, "last_activity_date": 1500496760, "creation_date": 1500496760, "answer_id": 45200587, "question_id": 45200154, "link": "https://stackoverflow.com/questions/45200154/is-there-a-for-next-loop-to-jump-between-web-pages-to-scrape/45200587#45200587", "title": "Is there a For...Next loop to jump between web pages to scrape?", "body": "<p>Yep, a For loop for the required number of iterations if it's a static set of pages.  I believe we can make it simpler.</p>\n\n<pre><code>For y = 1 to 5\n    result =trim(objIE.document.getElementById(\"ContentPlaceHolder1_lblDetails2\").innerText)\n    Sheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n    objIE.document.getElementById(\"ContentPlaceHolder1_btnNext\").Click\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\nnext y\n'or if you want it to keep going, something like this\nDo until objIE.document.getElementById(\"ContentPlaceHolder1_btnNext\") is nothing\n    result =trim(objIE.document.getElementById(\"ContentPlaceHolder1_lblDetails2\").innerText)\n        Sheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n        objIE.document.getElementById(\"ContentPlaceHolder1_btnNext\").Click\n        Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\nloop\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8205404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb132f620a3d07dd54feba06ce4182fc?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8205404/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 45200587, "answer_count": 1, "score": 0, "last_activity_date": 1500496760, "creation_date": 1500495067, "question_id": 45200154, "link": "https://stackoverflow.com/questions/45200154/is-there-a-for-next-loop-to-jump-between-web-pages-to-scrape", "title": "Is there a For...Next loop to jump between web pages to scrape?", "body": "<p>So I have been trying to scrape info from a site using the code below but am having a tough time with the part I noted. Is there an easier way to get the results I want rather than just repeating the same code over and over? You never know how many results you will get so I cannot use that info. </p>\n\n<pre><code>Dim objIE As InternetExplorer\nDim y As Integer\nDim result As String\n\nSet objIE = New InternetExplorer\n\nobjIE.Visible = True\n\nobjIE.navigate \"https://www.searchiqs.com/nyalb/Login.aspx\"\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nobjIE.document.getElementById(\"btnGuestLogin\").Click\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_txtFromDate\").Value = \"07/01/2017\"\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_txtThruDate\").Value = \"07/19/2017\"\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_cboDocGroup\").Value = \"DBA\"\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_cmdSearch\").Click\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\ny = 1\n\n' brings up a table of results. I need to click on the view button and get the info from that page\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_grdResults_btnView_0\").Click\n\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n' element ID's are hidden for those looking to help\n\nresult = Trim(objIE.document.getElementById(\"ContentPlaceHolder1_lblDetails2\").innerText)\n\nSheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n\ny = y + 1\n\n' I would love to direct link to the next serch result here but the link does not change between pages so I click the next button\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_btnNext\").Click\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nresult = Trim(objIE.document.getElementById(\"ContentPlaceHolder1_lblDetails2\").innerText)\n\nSheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n\ny = y + 1\n\n' and I click the next button again\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_btnNext\").Click\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nresult = Trim(objIE.document.getElementById(\"ContentPlaceHolder1_lblDetails2\").innerText)\n\nSheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n\ny = y + 1\n\n'AND AGAIN\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_btnNext\").Click\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\nresult = Trim(objIE.document.getElementById(\"ContentPlaceHolder1_lblDetails2\").innerText)\n\nSheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n\ny = y + 1\n\n' You get the idea\n\nobjIE.document.getElementById(\"ContentPlaceHolder1_btnNext\").Click\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nresult = Trim(objIE.document.getElementById(\"ContentPlaceHolder1_lblDetails2\").innerText)\n\nSheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n\n' I basically repeat that process til I cant press CTRL V anymore. Is there a loop I can use to tighten this up?\n</code></pre>\n\n<p>Let me know. You guys have been a huge help in the past. Also would it be beneficial to use the XML method as my readystate loops have been giving me issues? Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1500499398, "post_id": 45200128, "comment_id": 77369688, "body": "It won&#39;t work simultaneously on 2013 and 2010 versions since the methods to call are different. If I&#39;m guessing correctly, you&#39;re having problems with the line <code>ppSlide.Shapes.Paste.Select</code> since that method wasn&#39;t called like that in 2010 versions"}, {"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1500557723, "post_id": 45200128, "comment_id": 77398853, "body": "how could I change that so it does work in 2010?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1500587510, "post_id": 45200128, "comment_id": 77417856, "body": "<a href=\"https://stackoverflow.com/questions/19186146/pastespecial-of-object-shapes-failed-vba\">This might help you</a>"}], "owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500494957, "creation_date": 1500494957, "last_edit_date": 1531164843, "question_id": 45200128, "link": "https://stackoverflow.com/questions/45200128/vba-code-for-powerpoint-2010", "title": "VBA code for PowerPoint 2010", "body": "<p>I am trying to take a table from Excel and copy and paste into a PowerPoint Presentation, but it needs to work with PowerPoint 2010.</p>\n\n<p>This is what I have:\nSub CreateNewPresentation()</p>\n\n<pre><code>Dim ppApp As Object\nDim ppPres As PowerPoint.Presentation\nDim ppSlide As PowerPoint.Slide\n\nSet ppApp = CreateObject(\"PowerPoint.Application\")\n\nppApp.Visible = True\nppApp.Activate\n\nSet ppPres = ppApp.Presentations.Add\n\n'Insert Table --- slide 1\nSet ppSlide = ppPres.Slides.Add(1, ppLayoutBlank)\nppSlide.Select\n\n'Selects data for the Table to be copied\nWorksheets(\"Select Bond Sectors\").Activate\nActiveSheet.Range(Cells(3, 2), Cells(27, 11)).Copy\nppSlide.Shapes.Paste.Select\nppSlide.Shapes(1).Width = _\n    4 * (ppPres.PageSetup.SlideWidth / 5)\nppSlide.Shapes(1).Height = _\n    4 * (ppPres.PageSetup.SlideHeight / 5)\nppSlide.Shapes(1).Left = _\n    (ppPres.PageSetup.SlideWidth / 10)\nppSlide.Shapes(1).Top = _\n    (ppPres.PageSetup.SlideHeight / 10)\n'End of Selects data for the Table to be copied\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "edited": false, "score": 0, "creation_date": 1500496625, "post_id": 45200016, "comment_id": 77368290, "body": "Thank you for the fast response, but the code you offered currently results in an Compile error:   Invalid or unqualified reference.   The debugger highlights the first .Offset of the code you provided.      I inserted the code after the Dim RowCount As Long.  Is there a specific area I should insert the code?"}, {"owner": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "edited": false, "score": 0, "creation_date": 1500500310, "post_id": 45200016, "comment_id": 77370138, "body": "Again Thanks for the fast response, however a different error occurred;  Run-time error &#39;424&#39;  Object required.  The debugger highlighted the AddLink . Offset(RowCount, 3).Value, Me.TextBox_Website_Link.Value part of the code.  I added your code above the Private Sub SubmitButton_Click() section of my code.  I should note, I&#39;m very new to VBA, have only been coding it the past few weeks."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "edited": false, "score": 0, "creation_date": 1500500607, "post_id": 45200016, "comment_id": 77370284, "body": "My bad - I had not removed the <code>.Value</code> after  <code>.Offset(RowCount, 3)</code> - see my edit"}, {"owner": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "edited": false, "score": 0, "creation_date": 1500501445, "post_id": 45200016, "comment_id": 77370612, "body": "THANK YOU, your code is working.  For the other section of code;  ws.Range(&quot;c&quot; &amp; LastRow).Value = Me.TextBox_Website_Link.Value   , what do I change it, since AddLink ws.Range(&quot;c&quot; &amp; LastRow) = Me.TextBox_Website_Link.Value  just results in a Compile error:  Argument not optional."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "edited": false, "score": 0, "creation_date": 1500502218, "post_id": 45200016, "comment_id": 77370891, "body": "Added above - you need to pass two items to <code>AddLink</code> - a Range and a String"}, {"owner": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "edited": false, "score": 0, "creation_date": 1500502464, "post_id": 45200016, "comment_id": 77370973, "body": "THANK YOU SO MUCH, amazing how easy it is to over look a comma.  Your help was invaluable."}, {"owner": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "edited": false, "score": 0, "creation_date": 1500935583, "post_id": 45200016, "comment_id": 77544623, "body": "Is it possible to add the link another way, the =Hyperlink function has issues with <a href=\"http://www.google.com\" rel=\"nofollow noreferrer\">google.com</a> vs www.google.com.  Just updating the cell would be better as it allows Excel&#39;s built in Website Link software to register a website link listed in the cell."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "edited": false, "score": 0, "creation_date": 1500936395, "post_id": 45200016, "comment_id": 77544842, "body": "<code>c.Parent.Hyperlinks.Add Anchor:=c, Address:=txt, TextToDisplay:=txt</code>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1500938709, "post_id": 45200016, "comment_id": 77545415, "body": "@TimWilliams maybe <code>c.Style.Name = &quot;Hyperlink&quot;</code> after adding it"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500939102, "post_id": 45200016, "comment_id": 77545492, "body": "Instead of c.Formula = &quot;=HYPERLINK(&quot;&quot;&quot; &amp; txt &amp; &quot;&quot;&quot;)&quot;, but after posting that I noticed it still doesn&#39;t convert <code>www.google.com</code> into <code>http:&#47;&#47;www.google.com</code>;. I think Autocorrect does that, but I&#39;m not sure it&#39;s accessible to VBA. You can just check to see of the link starts with &quot;http://&quot; and add it if it&#39;s missing."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1500502160, "last_edit_date": 1500502160, "creation_date": 1500494581, "answer_id": 45200016, "question_id": 45199913, "link": "https://stackoverflow.com/questions/45199913/data-submitted-via-a-userform-not-becoming-active-hyperlink/45200016#45200016", "title": "Data submitted via a Userform not becoming active Hyperlink", "body": "<p>EDIT: updating my answer since I notice you have multiple places where a link might be written out...</p>\n\n<p>First add this utility Sub:</p>\n\n<pre><code>Sub AddLink(c As Range, txt As String)\n    If Len(txt) &gt; 0 Then\n        c.Formula = \"=HYPERLINK(\"\"\" &amp; txt &amp; \"\"\")\"\n    Else\n        c.Value = \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Then wherever you might write a link you can make use that sub:</p>\n\n<p>e.g. change lines:</p>\n\n<pre><code>.Offset(RowCount, 3).Value = Me.TextBox_Website_Link.Value\n\nws.Range(\"c\" &amp; LastRow).Value = Me.TextBox_Website_Link.Value\n</code></pre>\n\n<p>to</p>\n\n<pre><code>AddLink .Offset(RowCount, 3), Me.TextBox_Website_Link.Value \n\nAddLink ws.Range(\"c\" &amp; LastRow), Me.TextBox_Website_Link.Value\n</code></pre>\n\n<p>respectively</p>\n"}], "owner": {"reputation": 31, "user_id": 8333623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6eb0c63671739145647e84adebe858?s=128&d=identicon&r=PG&f=1", "display_name": "user8333623", "link": "https://stackoverflow.com/users/8333623/user8333623"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 45200016, "answer_count": 1, "score": 0, "last_activity_date": 1500502160, "creation_date": 1500494196, "question_id": 45199913, "link": "https://stackoverflow.com/questions/45199913/data-submitted-via-a-userform-not-becoming-active-hyperlink", "title": "Data submitted via a Userform not becoming active Hyperlink", "body": "<p>I've created a user-form for a company to enter preferred  products, included is the product's website.  Currently when the user hits submit all the information is entered correctly, but the cell that contains the website is not a hyperlink to the website.  If I double click on the cell (as if to add text) and then exit the cell it turns the link into a hyperlink.</p>\n\n<p>What VBA code do I need to turn data entered in a text-box and submitted via a user-form into a hyperlink in the cell on the sheet?</p>\n\n<p>Here is the basic version of the code I have (Removed the other parts);</p>\n\n<pre><code>Private Sub ComboBoxDivision_Change()\n\nMe.ComboBoxSpecsNumber = \"\"\nMe.ComboBoxSpecsName = \"\"\nSelect Case Me.ComboBoxDivision\n    Case \"DIVISION 02 - EXISTING CONDITIONS\"\n    Me.ComboBoxSpecsNumber.RowSource = \"D02_Number\"\n    Me.ComboBoxSpecsName.RowSource = \"D02_Name\"\n\n    Case \"DIVISION 03 - CONCRETE\"\n    Me.ComboBoxSpecsNumber.RowSource = \"D03_Number\"\n    Me.ComboBoxSpecsName.RowSource = \"D03_Name\"\n\n    Case \"DIVISION 04 - MASONRY\"\n    Me.ComboBoxSpecsNumber.RowSource = \"D04_Number\"\n    Me.ComboBoxSpecsName.RowSource = \"D04_Name\"    \nEnd Select\nEnd Sub\n\nPrivate Sub ComboBoxSpecsNumber_Change()\nApplication.EnableEvents = False\n  With ComboBoxSpecsNumber\n    ComboBoxSpecsName.ListIndex = .ListIndex\n  End With\n  Application.EnableEvents = True\nEnd Sub\n\nPrivate Sub ComboBoxSpecsName_Change()\nApplication.EnableEvents = False\n  With ComboBoxSpecsName\n    ComboBoxSpecsNumber.ListIndex = .ListIndex\n  End With\n  Application.EnableEvents = True\nEnd Sub\n\nPrivate Sub SubmitButton_Click()\nIf Me.ComboBoxDivision.Value = \"\" Then\nMsgBox \"Please select a Division.\", vbExclamation, \"Product_Information_Form\"\nMe.ComboBoxDivision.SetFocus\nExit Sub\nEnd If\nIf Me.ComboBoxSpecsNumber.Value = \"\" Then\nMsgBox \"Please select a Specs Number or Name.\", vbExclamation, \"Product_Information_Form\"\nMe.ComboBoxSpecsNumber.SetFocus\nExit Sub\nEnd If\nIf Me.ComboBoxSpecsName.Value = \"\" Then\nMsgBox \"Please select a Specs Name or Name.\", vbExclamation, \"Product_Information_Form\"\nMe.ComboBoxSpecsName.SetFocus\nExit Sub\nEnd If\n\nDim RowCount As Long\nRowCount = Worksheets(\"FormData\").Range(\"A1\").CurrentRegion.Rows.Count\nWith Worksheets(\"FormData\").Range(\"A1\")\n.Offset(RowCount, 0).Value = Me.ComboBoxDivision.Value\n.Offset(RowCount, 1).Value = Me.ComboBoxSpecsNumber.Value\n.Offset(RowCount, 2).Value = Me.ComboBoxSpecsName.Value\n.Offset(RowCount, 3).Value = Me.TextBox_Website_Link.Value\n.Offset(RowCount, 4).Value = Format(Now, \"yyyy.mm.dd hh:mm:ss\")\nEnd With\n\nSelect Case Me.ComboBoxDivision\nCase \"DIVISION 02 - EXISTING CONDITIONS\"\nDim LastRow As Long, ws As Worksheet\nSet ws = Sheets(\"Div-02\")\nLastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nws.Range(\"a\" &amp; LastRow).Value = Me.ComboBoxSpecsNumber.Value\nws.Range(\"b\" &amp; LastRow).Value = Me.ComboBoxSpecsName.Value\nws.Range(\"c\" &amp; LastRow).Value = Me.TextBox_Website_Link.Value\n\nCase \"DIVISION 03 - CONCRETE\"\nSet ws = Sheets(\"Div-03\")\nLastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nws.Range(\"a\" &amp; LastRow).Value = Me.ComboBoxSpecsNumber.Value\nws.Range(\"b\" &amp; LastRow).Value = Me.ComboBoxSpecsName.Value\nws.Range(\"c\" &amp; LastRow).Value = Me.TextBox_Website_Link.Value\n\nCase \"DIVISION 04 - MASONRY\"\nSet ws = Sheets(\"Div-04\")\nLastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nws.Range(\"a\" &amp; LastRow).Value = Me.ComboBoxSpecsNumber.Value\nws.Range(\"b\" &amp; LastRow).Value = Me.ComboBoxSpecsName.Value\nws.Range(\"c\" &amp; LastRow).Value = Me.TextBox_Website_Link.Value\n\n\nEnd Select\n\nUnload Product_Information_Form\nStart_Form.Show\n\nEnd Sub\n</code></pre>\n\n<p>P.S.  I've tried searching numerous times for a solution, but always get information on how to add a hyperlink to a user form, which is not what I need.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1500518444, "last_edit_date": 1500518444, "creation_date": 1500494791, "answer_id": 45200076, "question_id": 45199872, "link": "https://stackoverflow.com/questions/45199872/create-a-hyperlink-list-of-sheets-in-excel/45200076#45200076", "title": "Create a hyperlink list of sheets in excel", "body": "<pre><code>Sub GetHyperlinks()\n    Dim arrExclude\n    Dim ws As Worksheet\n    Dim i As Integer\n\n    'Sheets to be excluded from linking\n    arrExclude = Array(\"Test Results\", \"some other sheet\", \"overview\")\n\n    i = 9\n\n    For Each ws In ThisWorkbook.Worksheets\n        'test to see if not excluded\n        If IsError(Application.Match(ws.Name, arrExclude, 0)) Then\n            ActiveWorkbook.Sheets(\"overview\").Hyperlinks.Add _\n                Anchor:=ActiveWorkbook.Sheets(\"overview\").Cells(i, 1), _\n                Address:=\"\", _\n                SubAddress:=\"'\" &amp; ws.Name &amp; \"'!A1\", _\n                TextToDisplay:=ws.Name\n            i = i + 1\n        End If 'include this sheet\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8334046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YI_cmEPKIYg/AAAAAAAAAAI/AAAAAAAAQR4/vasXvzyRtLs/photo.jpg?sz=128", "display_name": "Dennis Roberts", "link": "https://stackoverflow.com/users/8334046/dennis-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500518444, "creation_date": 1500494043, "last_edit_date": 1500498313, "question_id": 45199872, "link": "https://stackoverflow.com/questions/45199872/create-a-hyperlink-list-of-sheets-in-excel", "title": "Create a hyperlink list of sheets in excel", "body": "<p>I know how to populate a sheet with specific hyperlinks to all the sheets in a given workbook, but how do I exclude certain sheets from being listed?</p>\n\n<p>I have listed the VB below for what I was using. I would like to exclude certain sheets like \"Test Results\" etc.</p>\n\n<pre><code>Sub GetHyperlinks()\n    Dim ws As Worksheet\n    Dim i As Integer\n\n    i = 9\n\n    For Each ws In ThisWorkbook.Worksheets\n        ActiveWorkbook.Sheets(\"overview\").Hyperlinks.Add _\n        Anchor:=ActiveWorkbook.Sheets(\"overview\").Cells(i, 1), _\n        Address:=\"\", _\n        SubAddress:=\"'\" &amp; ws.NAme &amp; \"'!A1\", _\n        TextToDisplay:=ws.NAme\n\n        i = i + 1\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500497581, "post_id": 45199694, "comment_id": 77368792, "body": "Are you sure it&#39;s not working? It could have done its thing and closed itself, as that&#39;s the default behavior of a batch script."}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "reply_to_user": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500497686, "post_id": 45199694, "comment_id": 77368848, "body": "I know it&#39;s not working since the output file doesn&#39;t exist. I also just tried this exact same code on another system and it worked just fine. Also if it was working the script window would remain up since I added a pause condition at the end of the script. However if I manually launch the .bat file the script launches and outputs the merged file"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500497770, "post_id": 45199694, "comment_id": 77368889, "body": "Your batch file might be using relative paths. Try changing the working directory for the <code>Shell</code> command using <code>ChDir</code> (and <code>ChDrive</code> if required). If I had to guess, you&#39;d want to do <code>ChDir &quot;C:\\Temp&quot;</code>."}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "reply_to_user": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500498474, "post_id": 45199694, "comment_id": 77369228, "body": "Nope that didn&#39;t work"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500499731, "post_id": 45199694, "comment_id": 77369860, "body": "Try displaying (Debug.Print or MsgBox) exactly what you&#39;re writing to the batch file."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1500501122, "post_id": 45199694, "comment_id": 77370504, "body": "Please add the content of _SedjaScript.bat to your question."}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1500561035, "post_id": 45199694, "comment_id": 77401722, "body": "@Andre Done also reiterating that when I manually launch the .bat script it works just fine"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1500561798, "post_id": 45199694, "comment_id": 77402353, "body": "Hmm, curious. I suggest to add two lines <code>set</code> and <code>pause</code> to the start of the batch you write. The tool looks like a Java program. Check that <code>PATH</code> and maybe <code>JAVA_HOME</code> are set correctly. The problem may be that you run the batch from 32-bit Access vs. from 64-bit Windows when run directly."}, {"owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "edited": false, "score": 0, "creation_date": 1500562920, "post_id": 45199694, "comment_id": 77403236, "body": "AWESOME That did it! after manually setting the path for my JRE bin it worked. Thanks for that!"}], "answers": [{"tags": [], "owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "is_accepted": true, "score": 1, "last_activity_date": 1500563181, "creation_date": 1500563181, "answer_id": 45218607, "question_id": 45199694, "link": "https://stackoverflow.com/questions/45199694/access-vba-shell-command-not-working/45218607#45218607", "title": "Access VBA Shell command not working", "body": "<p>Thanks to Andre I was able to get the script to work inside VBA's Shell command.</p>\n\n<p>By setting the PATH for my JRE to <code>JAVA_HOME</code> I was able to successfully launch the script.</p>\n\n<pre><code>setx JAVA_HOME \"C:\\Program Files (x86)\\Java\\jre1.8.0_141\"\nsetx PATH \"%PATH%;%JAVA_HOME%\\bin\";\n</code></pre>\n"}], "owner": {"reputation": 144, "user_id": 5848238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1628310da2270781932632e8aaaf889?s=128&d=identicon&r=PG&f=1", "display_name": "mattlore", "link": "https://stackoverflow.com/users/5848238/mattlore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 0, "accepted_answer_id": 45218607, "answer_count": 1, "score": 1, "last_activity_date": 1500563181, "creation_date": 1500493383, "last_edit_date": 1500560992, "question_id": 45199694, "link": "https://stackoverflow.com/questions/45199694/access-vba-shell-command-not-working", "title": "Access VBA Shell command not working", "body": "<p>so I'm trying to get a very simple shell command to execute a batch file that's created, but for some reason the shell command doesn't do anything.</p>\n\n<p>The batch file gets created and when I double click on the batch file it executes the script just fine, but if I try to call the shell command in VBA it appears that it tries to open a command window, but immediately closes it after, not producing any errors. This code used to work fine before I reformatted this laptop AND this code works on another system running Server 2012 R2 (I'm running windows 10)</p>\n\n<pre><code>        Dim SedjaShell\n        f = \"C:\\Temp\\_SedjaScript.bat\"\n        Open f For Output As #1\n        Print #1, Chr(34) &amp; SedjaDir &amp; Chr(34) &amp; \" merge --files \" &amp; Page1 &amp; \" \" &amp; Page2 &amp; \" \" &amp; TOS &amp; \" \" &amp; Disclosure &amp; \" --output \" &amp; OutputDir\n        Print #1, \"Pause\"\n        Close #1\n\n        SedjaShell = Shell(\"C:\\Temp\\_SedjaScript.bat\", 1)\n</code></pre>\n\n<p>Is there something I might be missing?</p>\n\n<p>EDIT\nAdding the contents of _SedjaScript.Bat</p>\n\n<pre><code>\"C:\\Users\\User\\Desktop\\DealTracker\\MergeFiles\\sejda-console-3.0.4\\bin\\sejda-console.bat\" merge --files C:\\Temp\\ContractSummary.pdf C:\\Temp\\Page2.pdf C:\\Temp\\TOS.pdf C:\\Temp\\Disclosure.pdf --output \"C:\\Users\\User\\Desktop\\DealTracker\\Completed Contracts\\Company-Name-Inc-07-19-2017-Contract.pdf\"\nPause\n</code></pre>\n"}, {"tags": ["vba", "fonts", "powerpoint", "powerpoint-2013"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "edited": false, "score": 0, "creation_date": 1509568211, "post_id": 45217721, "comment_id": 81074463, "body": "How does this Font.Name string determine the difference between &#39;Calibri&#39; and &#39;Calibri (body)&#39; though? As I described above, both of these font types show up as &#39;mn&#39; for the FontType in this string, even though they are distinctly different from one-another."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "edited": false, "score": 0, "creation_date": 1509584199, "post_id": 45217721, "comment_id": 81080114, "body": "I think we&#39;d need to see a more detailed description of how you made the changes you describe in your original post.  Via code or manually and either way, exactly how?"}, {"owner": {"reputation": 331, "user_id": 3891180, "user_type": "registered", "profile_image": "https://graph.facebook.com/39500063/picture?type=large", "display_name": "Dean", "link": "https://stackoverflow.com/users/3891180/dean"}, "edited": false, "score": 0, "creation_date": 1563562079, "post_id": 45217721, "comment_id": 100754788, "body": "I know this is old, but the above worked for me.  I wanted to set the font to Georgia which is the main PowerPoint theme that I had selected.  If I did Font.Name = &quot;Georgia&quot; then it hard-coded this as the font.  But using the above set it to body font as desired.  Thanks"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 331, "user_id": 3891180, "user_type": "registered", "profile_image": "https://graph.facebook.com/39500063/picture?type=large", "display_name": "Dean", "link": "https://stackoverflow.com/users/3891180/dean"}, "edited": false, "score": 0, "creation_date": 1610986297, "post_id": 45217721, "comment_id": 116299765, "body": "@Dean And I&#39;m late to the party too. But in case it helps, PPT has themes, which include specs for fonts, colors and a few other bits. You can think of these as lookup-tables. Specifiying a theme font (ie, heading or body) tells PPT &quot;Go to the font theme table, look up the name of the body font, use that&quot;. When you change the font theme, any font that&#39;s been assigned body or heading THEME fonts will change accordingly. When you tell PPT &quot;Make this text Georgia&quot;, the font is no longer connected to the theme, and stays Georgia even when the theme changes. Each has its uses."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1500561101, "creation_date": 1500561101, "answer_id": 45217721, "question_id": 45199560, "link": "https://stackoverflow.com/questions/45199560/set-ppt-font-to-body-type/45217721#45217721", "title": "Set PPT Font to &#39;Body&#39; Type", "body": "<p>To set the font to the body or heading font, you need to use a weird bit of syntax:</p>\n\n<p>{object}.Font.Name = \"+\" + FontType + \"-\" + FontLang</p>\n\n<p>Where:</p>\n\n<p>FontType is \"mj\" or \"mn\" for Major (headings) or Minor (body) respectively.</p>\n\n<p>FontLang is \"lt\", \"cs\" or \"ea\" for Latin, Complex Scripts or East Asian</p>\n\n<p>For example to set the font to the theme's body text font for Latin text:</p>\n\n<pre><code>ActivePresentation.Slides(1).Shapes(1).TextFrame.TextRange.Font.Name = \"+mn-lt\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1610986019, "post_id": 65765638, "comment_id": 116299621, "body": "Since this thread&#39;s tagged &quot;VBA&quot;, your answer doesn&#39;t exactly fit, but it&#39;ll no doubt be useful to someone who wants to solve the problem in (I&#39;m guessing) VBA.NET.  Please edit your comment to point out that it&#39;s a solution for {whatever.language}"}, {"owner": {"reputation": 29, "user_id": 11792608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc9968b90026966b5926cf0c58580641?s=128&d=identicon&r=PG&f=1", "display_name": "Fred B", "link": "https://stackoverflow.com/users/11792608/fred-b"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1611228550, "post_id": 65765638, "comment_id": 116385793, "body": "You&#39;re right Steve, thanks for pointing that out. I&#39;ve edited my answer."}], "tags": [], "owner": {"reputation": 29, "user_id": 11792608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc9968b90026966b5926cf0c58580641?s=128&d=identicon&r=PG&f=1", "display_name": "Fred B", "link": "https://stackoverflow.com/users/11792608/fred-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1611228406, "last_edit_date": 1611228406, "creation_date": 1610915574, "answer_id": 65765638, "question_id": 45199560, "link": "https://stackoverflow.com/questions/45199560/set-ppt-font-to-body-type/65765638#65765638", "title": "Set PPT Font to &#39;Body&#39; Type", "body": "<p>A bit late to the party, but I found this in case anyone needs it.</p>\n<p>Edit: This is C# code, using the Interop PowerPoint namespace.</p>\n<pre><code>string headingsThemeFont = Globals.ThisAddIn.Application.ActivePresentation.SlideMaster.Theme.ThemeFontScheme.MajorFont.Item(MsoFontLanguageIndex.msoThemeLatin).Name;\n                   \nstring bodyThemeFont = Globals.ThisAddIn.Application.ActivePresentation.SlideMaster.Theme.ThemeFontScheme.MinorFont.Item(MsoFontLanguageIndex.msoThemeLatin).Name;\n                    \n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1611228406, "creation_date": 1500492930, "question_id": 45199560, "link": "https://stackoverflow.com/questions/45199560/set-ppt-font-to-body-type", "title": "Set PPT Font to &#39;Body&#39; Type", "body": "<p>I am not able to paste the entirety of my code, but the crux is that I have a textbox in PPT 2013, <strong>myTb</strong>, that I have (programmatically) pasted some text into. I now want to perform the following two actions:</p>\n\n<ol>\n<li>See if the original text was the PPT 'body default' font (e.g. 'Calibri (body)' vs. 'Calibri' in the MS Ribbon)</li>\n<li>If it was the body default, set the new text to also be the body default.</li>\n</ol>\n\n<p>I can't seem to figure either part out, even though I have experimented with reading/writing from/to most of the <strong>Shape.TextFrame[n].TextRange.Font.Name...</strong> fields. I also had two confounding points to ask about, regarding the <strong>Shape.TextFrame.TextRange.Font.NameComplexScript</strong> field:</p>\n\n<ol>\n<li>This field does not seem to be a 'complete' indicator of body-default vs non-body-default font. The reason is that if this textbox is originally the body-default ('Calibri (body)'), it will read '+mn-cs', but then I can change the font to the non-default variant ('Calibri'), and it still reads '+mn-cs'.</li>\n<li>I then proceed to change the textbox to an entirely different font, which changes this field to the font's name as expected. However, if I then change back to the body-default font (or any other font, for that matter), this field remains on the previous font's name.</li>\n</ol>\n"}, {"tags": ["ms-access", "ms-word", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 1, "creation_date": 1500493185, "post_id": 45199536, "comment_id": 77366395, "body": "<code>I have a Word document that I am trying to fill out programmatically through Access.</code> dear God I&#39;m so sorry. Do you have a patreon? I&#39;ll send money.  Your poor family... I&#39;m crying right now.  This is terrible.  Nobody should have to face this.  Nobody."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 7066080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-x3UBDvulOvI/AAAAAAAAAAI/AAAAAAAAJCA/Gj0VCNKHLwc/photo.jpg?sz=128", "display_name": "Rob Riggle", "link": "https://stackoverflow.com/users/7066080/rob-riggle"}, "is_accepted": true, "score": 1, "last_activity_date": 1500493286, "creation_date": 1500493286, "answer_id": 45199665, "question_id": 45199536, "link": "https://stackoverflow.com/questions/45199536/setting-word-drop-down-boxes-through-access-2013/45199665#45199665", "title": "Setting Word Drop-down boxes through Access 2013", "body": "<p>Of course, right after posting I found the problem.  Someone had typed in the selection in Access and it didn't match the dropdown.  I just needed to lock the users from typing in a response and force the use of the drop downs. </p>\n"}], "owner": {"reputation": 47, "user_id": 7066080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-x3UBDvulOvI/AAAAAAAAAAI/AAAAAAAAJCA/Gj0VCNKHLwc/photo.jpg?sz=128", "display_name": "Rob Riggle", "link": "https://stackoverflow.com/users/7066080/rob-riggle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 45199665, "answer_count": 1, "score": 0, "last_activity_date": 1594650980, "creation_date": 1500492859, "last_edit_date": 1594650980, "question_id": 45199536, "link": "https://stackoverflow.com/questions/45199536/setting-word-drop-down-boxes-through-access-2013", "title": "Setting Word Drop-down boxes through Access 2013", "body": "<p>I have a Word document that I am trying to fill out programmatically through Access.  The drop downs are Content Controls in Word.  I am able to set all but one drop down and I cant see any difference in the Word document that would be a problem.</p>\n\n<p>The code looks like:</p>\n\n<pre><code>Dim wDoc As Word.Document\nDim objCC As ContentControl\nDim objCE As ContentControlListEntry\nDim ListSelection As String\n\nSet WordApp = GetObject(, \"Word.Application\")\nWordApp.Visible = True\nWordApp.WindowState = wdWindowStateMaximize\nWordApp.Documents.Add Template:=strTemplateLocation, newtemplate:=False\n\nWith WordApp\n\n  ListSelection = Me.cmbAvailability.ListIndex + 2\n  Set objCC = .ActiveDocument.ContentControls(5): Set objCE = objCC.DropdownListEntries.Item(ListSelection): objCE.Select\n\n  ListSelection = Me.Area.ListIndex + 2\n  Set objCC = .ActiveDocument.ContentControls(13): Set objCE = objCC.DropdownListEntries.Item(ListSelection): objCE.Select\n</code></pre>\n\n<p>**There are about a dozen drop downs set here, just included a couple.  The fisrt set line works, but the second (\"Area\") doesn't.  In the full code, there are several drop down set before and after the \"Area\" line executes, all the others work.  I double checked to be sure the contentcontrol ID is correct.  I am sure I am just missing something, but cant see it.  Any ideas or suggestions on what to look at?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7092062, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-KlypQKcKR_8/AAAAAAAAAAI/AAAAAAAAB3o/0WThhpVQ_qQ/photo.jpg?sz=128", "display_name": "Carl", "link": "https://stackoverflow.com/users/7092062/carl"}, "edited": false, "score": 0, "creation_date": 1500572167, "post_id": 45199956, "comment_id": 77409417, "body": "This does exactly what I want.  Thank you very much for your help."}], "tags": [], "owner": {"reputation": 328, "user_id": 4665692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXJxN.jpg?s=128&g=1", "display_name": "sourceCode", "link": "https://stackoverflow.com/users/4665692/sourcecode"}, "is_accepted": true, "score": 0, "last_activity_date": 1500504292, "last_edit_date": 1500504292, "creation_date": 1500494408, "answer_id": 45199956, "question_id": 45199507, "link": "https://stackoverflow.com/questions/45199507/turn-string-in-to-date-excel-vba/45199956#45199956", "title": "Turn String in to Date Excel-VBA", "body": "<p>You can use the Split function to separate Strings via a delimiter.</p>\n\n<pre><code>Dim fulldate As String\n\nfulldate = Cells(1,1).Value\nCells(1, 2).Value = Split(fulldate,\",\")(1) &amp; \", \" &amp; Left(Trim(Split(fulldate,\",\")(2)), 4) \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 7092062, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-KlypQKcKR_8/AAAAAAAAAAI/AAAAAAAAB3o/0WThhpVQ_qQ/photo.jpg?sz=128", "display_name": "Carl", "link": "https://stackoverflow.com/users/7092062/carl"}, "edited": false, "score": 0, "creation_date": 1500572155, "post_id": 45200186, "comment_id": 77409415, "body": "Thank you very much for you help!"}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1500495188, "creation_date": 1500495188, "answer_id": 45200186, "question_id": 45199507, "link": "https://stackoverflow.com/questions/45199507/turn-string-in-to-date-excel-vba/45200186#45200186", "title": "Turn String in to Date Excel-VBA", "body": "<p>You can also use Mid to get everything after the first comma.</p>\n\n<p><code>Cells(1, 2).Value = Mid(Cells(1, 1), commaposition + 2)</code></p>\n"}], "owner": {"reputation": 31, "user_id": 7092062, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-KlypQKcKR_8/AAAAAAAAAAI/AAAAAAAAB3o/0WThhpVQ_qQ/photo.jpg?sz=128", "display_name": "Carl", "link": "https://stackoverflow.com/users/7092062/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 45199956, "answer_count": 2, "score": 1, "last_activity_date": 1500504292, "creation_date": 1500492748, "last_edit_date": 1531164843, "question_id": 45199507, "link": "https://stackoverflow.com/questions/45199507/turn-string-in-to-date-excel-vba", "title": "Turn String in to Date Excel-VBA", "body": "<p>I am trying to turn a string containing unwanted text, a date, and an unwanted time in to an entry that contains only the date.</p>\n\n<p>This is a sample of what I am starting with:</p>\n\n<p>\"Started: Sunday, October 30, 2016 3:17:37 PM\"</p>\n\n<p>And from that I would like to get:</p>\n\n<p>\"October 30, 2016\"</p>\n\n<p>I have tried to search the string for a comma using this code:</p>\n\n<pre><code>Dim fulldate As String, commaposition As Integer\n\nfulldate = Cells(1, 1).Value\ncommaposition = InStr(fulldate, \",\")\n\nCells(1, 2).Value = Right(fulldate, commaposition)\n</code></pre>\n\n<p>This however returns:</p>\n\n<p>\"2016 3:17:37 PM\"</p>\n\n<p>as it seems to pick the wrong comma.  I was hoping for the other comma, and then I could work on getting the time out, but alas I am stuck.</p>\n\n<p>Maybe there is some basic function I am missing?  I understand looping and how to manipulate the code to work with multiple sets once I can figure the base out.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1500492845, "post_id": 45199494, "comment_id": 77366183, "body": "What does your data look like? A formula wouldn&#39;t be acceptable? What have you tried, please post your current code/formulas."}, {"owner": {"reputation": 3, "user_id": 8333919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea19870ab94f594f739f0612cbf16da?s=128&d=identicon&r=PG&f=1", "display_name": "Victor S", "link": "https://stackoverflow.com/users/8333919/victor-s"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500493714, "post_id": 45199494, "comment_id": 77366703, "body": "Added an example image of my data, it has to be on vba, which is too bad because I think I could fix a formula for it :(  as for my current code, I&#39;m honestly clueless, don&#39;t know how can I restrict the search to only columns of the same year"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500493859, "post_id": 45199494, "comment_id": 77366788, "body": "Can you post the code you have too?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8333919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea19870ab94f594f739f0612cbf16da?s=128&d=identicon&r=PG&f=1", "display_name": "Victor S", "link": "https://stackoverflow.com/users/8333919/victor-s"}, "edited": false, "score": 1, "creation_date": 1500504003, "post_id": 45200308, "comment_id": 77371443, "body": "Thanks a lot!! seems like this will work! I think i&#39;ll modify it to be color the cell with the result but shouldn&#39;t have much problem now!"}], "tags": [], "owner": {"reputation": 2250, "user_id": 1923086, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/6CM1f.jpg?s=128&g=1", "display_name": "JahKnows", "link": "https://stackoverflow.com/users/1923086/jahknows"}, "is_accepted": true, "score": 0, "last_activity_date": 1500504005, "last_edit_date": 1500504005, "creation_date": 1500495708, "answer_id": 45200308, "question_id": 45199494, "link": "https://stackoverflow.com/questions/45199494/need-my-vba-code-to-search-a-value-only-amongst-certain-columns/45200308#45200308", "title": "Need my vba code to search a value only amongst certain columns", "body": "<p>This code should help you out. This is a quite generic code to do what you are asking. You can extend this by making a UserForm and asking the user what column header you wish to identify rather than only looking for 2013.</p>\n\n<pre><code>Sub \n   Dim lastColumn As Long\n   Dim max_value As Double\n\n   max_value = 0\n\n   lastColumn = Worksheets(\"Sheet1\").Cells(1, Columns.Count).End(xlToLeft).Column\n   For i = 1 To lastColumn\n      ' Seek out the column you desire!\n      If Worksheets(\"Sheet1\").Cells(2,i).Value = \"2013\" Then\n\n         Dim lastRow As Long\n         lastRow = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n         ' Go through the entire column of the desired type to read the values\n         For j = 3 To lastRow\n            If Worksheets(\"Sheet1\").Cells(j, i).Value &gt; max_val Then\n               max_value = Worksheets(\"Sheet1\").Cells(j, i).Value\n            End If\n         Next j\n      End If\n   Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8333919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea19870ab94f594f739f0612cbf16da?s=128&d=identicon&r=PG&f=1", "display_name": "Victor S", "link": "https://stackoverflow.com/users/8333919/victor-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 45200308, "answer_count": 1, "score": 0, "last_activity_date": 1500504005, "creation_date": 1500492723, "last_edit_date": 1500493565, "question_id": 45199494, "link": "https://stackoverflow.com/questions/45199494/need-my-vba-code-to-search-a-value-only-amongst-certain-columns", "title": "Need my vba code to search a value only amongst certain columns", "body": "<p>My question is this, not sure if it can be achieved:(Need to do it with vba)\nI have a range with 5 groups of 3 years each (a column for 2012, 2013 and 2014 in each group) these columns have grades. I need to find the highest grade amongst all the groups, but only for the year of 2013. I know how to find the higher grade, but it searches amongst all the columns.\nCan I find this grade but make it search only amongst the columns that belong to 2013?</p>\n\n<p><a href=\"https://i.stack.imgur.com/PHfqi.png\" rel=\"nofollow noreferrer\">example of the data range</a></p>\n"}, {"tags": ["vba", "excel", "worksheet-function", "worksheet"], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 0, "last_activity_date": 1500493313, "creation_date": 1500493313, "answer_id": 45199673, "question_id": 45199480, "link": "https://stackoverflow.com/questions/45199480/specifying-multiple-sheets-string-array/45199673#45199673", "title": "Specifying Multiple Sheets/String Array?", "body": "<p>Try this:</p>\n\n<pre><code>Dim SomeSheet as String\nSomeSheet = \"Other Sheet Name\"\n\nIf ws.Name &lt;&gt; \"Counterparty Overview\" Then\n  ws.Visible = xlSheetHidden\n  Sheets(SomeSheet).Visible = xlVisible\n  'or\n  Sheets(\"Other Sheet Name\").Visible = xlVisible\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8297564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fabee071a99aad49821c7ca72965d0?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8297564/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 45199673, "answer_count": 1, "score": 1, "last_activity_date": 1500493313, "creation_date": 1500492684, "last_edit_date": 1531164843, "question_id": 45199480, "link": "https://stackoverflow.com/questions/45199480/specifying-multiple-sheets-string-array", "title": "Specifying Multiple Sheets/String Array?", "body": "<p>I and working with some code that aims to Hide/Unhide Sheets based on a selection from a dropdown menu. The setup is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Target.Address = Range(\"SelectCP\").Address Then\n    Select Case Target.Value\n      Case \"All\"\n        ShowAllSheets\n      Case \"\"\n        'do nothing\n      Case Else\n        ShowSelSheets\n        'do nothing\n    End Select\n  End If\nEnd Sub\n</code></pre>\n\n<p>Where functions ShowAllSheets and ShowSelSheets are defined as:</p>\n\n<pre><code>Sub ShowAllSheets()\nDim ws As Worksheet\nFor Each ws In ActiveWorkbook.Sheets\n  ws.Visible = xlSheetVisible\nNext ws\nEnd Sub\n\n\nSub ShowSelSheets()\nDim ws As Worksheet\nDim strType As String\nstrType = Worksheets(\"Counterparty Overview\").Range(\"SelectCP\").Value\nFor Each ws In ActiveWorkbook.Sheets\n  If InStr(1, ws.Name, strType) &gt; 0 Then\n    ws.Visible = xlSheetVisible\n  Else\n    If ws.Name &lt;&gt; \"Counterparty Overview\" Then\n      ws.Visible = xlSheetHidden\n    End If\n  End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>The trouble I'm having is with this bit:</p>\n\n<pre><code>Else\nIf ws.Name &lt;&gt; \"Counterparty Overview\" Then\n  ws.Visible = xlSheetHidden\n</code></pre>\n\n<p>I want to specify two other sheets in addition to \"Counterparty Overview\" to always show. I've tried to initiate strType as a variable array, but get an error. Any Ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1500493194, "creation_date": 1500493194, "answer_id": 45199626, "question_id": 45199473, "link": "https://stackoverflow.com/questions/45199473/allowing-inserts-in-worksheet-change-event/45199626#45199626", "title": "Allowing inserts in worksheet_change event", "body": "<p>Something like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim KeyCells As Range\n\n    Set KeyCells = Application.Intersect(Range(\"I:I\"), Target)\n\n    If Not KeyCells Is Nothing Then\n        If KeyCells.Cells.Count &gt; 1 Then Exit Sub '&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n        If KeyCells.Value &lt;&gt; \"\" Then\n            Application.EnableEvents = False\n            With Target.EntireRow\n                .Copy Sheets(\"completed\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n                .Delete\n            End With\n            Application.EnableEvents = True\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Note it's possible for a user to change multiple rows at once, but your code does not handle that: if you try to compare a multi-cell range's Value to a single value that will raise a runtime error (because you're trying to compare an array to a single value)</p>\n"}], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 45199626, "answer_count": 1, "score": 0, "last_activity_date": 1500493194, "creation_date": 1500492649, "last_edit_date": 1531164843, "question_id": 45199473, "link": "https://stackoverflow.com/questions/45199473/allowing-inserts-in-worksheet-change-event", "title": "Allowing inserts in worksheet_change event", "body": "<p>I have created a worksheet change event where if the column I is altered (Date added), it will insert it to a new sheet and delete it. </p>\n\n<p>However, whenever I insert a row, it will automatically take that row and insert it to the other sheet, then delete it. How can I prevent it, so that it will only do an worksheet change event as long as the cell has a value so that I can insert?</p>\n\n<p>I was think that I could nest the IF statement a bit further by checking <code>ActiveCell.Value &lt;&gt; \"\"</code>, however that changes when the cell is clicked off. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Dim LastRowCompleted As Long\n    Dim RowToDelete As Long\n\n    RowToDelete = 0\n    LastRowCompleted = Sheets(\"completed\").Cells(Sheets(\"completed\").Rows.Count, \"A\").End(xlUp).Row\n    LastRowCompleted = LastRowCompleted + 1 'Next row after last row\n    Set KeyCells = Range(\"I:I\")\n\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n    Application.EnableEvents = False\n        'Cut and Paste Row\n        Target.EntireRow.Copy Sheets(\"completed\").Range(LastRowCompleted &amp; \":\" &amp; LastRowCompleted)\n        'Mark to delete row\n        RowToDelete = Target.EntireRow.Row\n\n    Call DeleteRow(RowToDelete)\n    Application.EnableEvents = True\n\n    End If\n\n\n\nEnd Sub\n\nSub DeleteRow(Row As Long)\n    If Row &gt; 0 Then\n        Rows(Row).EntireRow.Delete Shift:=xlUp\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500492491, "post_id": 45199366, "comment_id": 77365968, "body": "So the formula fills down from <code>B3</code>, but then also puts something in <code>B2</code>?  Same with <code>B6</code>, does it put something in <code>B5</code>?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1500492574, "post_id": 45199366, "comment_id": 77366014, "body": "Have you tried not using autofill and just copying those cells/formulas and pasting over the range?"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500492612, "post_id": 45199366, "comment_id": 77366036, "body": "Can you tell us what you get for <code>lrp</code> and <code>lrf</code>? If they&#39;re less than 3 at all, your range will include row 2."}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500492663, "post_id": 45199366, "comment_id": 77366070, "body": "BruceWayne: That is my exact issue"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500492680, "post_id": 45199366, "comment_id": 77366077, "body": "Hao: what do you mean what do I get for lrp and lrf?"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500492701, "post_id": 45199366, "comment_id": 77366089, "body": "Cyril: I am not quite sure what you mean"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500492763, "post_id": 45199366, "comment_id": 77366128, "body": "What if I use .filldown instead of .autofill?"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 1, "creation_date": 1500493129, "post_id": 45199366, "comment_id": 77366359, "body": "@GCC What values do they have right before the AutoFill calls? For example, if <code>lrp</code> turns out to be 2, your first AutoFill will evaluate the <code>Destination</code> from <code>Range(&quot;B3:AR&quot; &amp; lrp)</code> into <code>Range(&quot;B3:AR2&quot;)</code>, which will get changed into <code>Range(&quot;B2:AR3&quot;)</code>."}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "reply_to_user": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500493577, "post_id": 45199366, "comment_id": 77366616, "body": "@HaoZhang I have about 1200 rows that I need to fill."}], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500493145, "post_id": 45199520, "comment_id": 77366370, "body": "I am still getting the N/A&#39;s"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500493277, "post_id": 45199520, "comment_id": 77366443, "body": "But are you getting that in where the title should be?"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500493315, "post_id": 45199520, "comment_id": 77366470, "body": "I am getting that where the title should be"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500493359, "post_id": 45199520, "comment_id": 77366496, "body": "Do you have data in Column A?"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500493502, "post_id": 45199520, "comment_id": 77366578, "body": "I have data in A all the way until row 1200"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500493678, "post_id": 45199520, "comment_id": 77366684, "body": "And you started with the titles in place?  This should do it.  It does not cover the unwanted cells when I run it."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1500493810, "post_id": 45199520, "comment_id": 77366762, "body": "You are going to need to step through the code to and watch the variable getting filled to ensure the equal what you think they should."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1500492799, "creation_date": 1500492799, "answer_id": 45199520, "question_id": 45199366, "link": "https://stackoverflow.com/questions/45199366/why-does-my-autofill-code-display-n-a-in-a-cell-i-did-not-reference-for-vba/45199520#45199520", "title": "Why does my autofill code display #N/A in a cell I did not reference for VBA?", "body": "<p>Change:</p>\n\n<pre><code>lrp = Pricing.Range(\"A3\", Pricing.Range(\"A\" &amp; Rows.Count)).End(xlUp).Row\nlrf = Forecast.Range(\"A6\", Forecast.Range(\"A\" &amp; Rows.Count)).End(xlUp).Row\n</code></pre>\n\n<p>to</p>\n\n<pre><code>lrp = Pricing.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlrf = Forecast.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500492799, "creation_date": 1500492280, "question_id": 45199366, "link": "https://stackoverflow.com/questions/45199366/why-does-my-autofill-code-display-n-a-in-a-cell-i-did-not-reference-for-vba", "title": "Why does my autofill code display #N/A in a cell I did not reference for VBA?", "body": "<p>I asked a similar question to this yesterday and I have run into another issue. Here is my code (I have my worksheets declared):</p>\n\n<pre><code>Dim lrp As Long 'last row for pricing worksheet\nDim lrf As Long 'last row for forecasting worksheet\n\nlrp = Pricing.Range(\"A3\", Pricing.Range(\"A\" &amp; Rows.Count)).End(xlUp).Row\nlrf = Forecast.Range(\"A6\", Forecast.Range(\"A\" &amp; Rows.Count)).End(xlUp).Row\n\n'Pricing Worksheet\nPricing.Range(\"B3:AR3\").autofill Destination:=Pricing.Range(\"B3:AR\" &amp; lrp)\n\n'Forecasting Worksheet\nForecast.Range(\"B6:HO6\").autofill Destination:=Forecast.Range(\"B6:HO\" &amp; lrf)\n</code></pre>\n\n<p>If we take the pricing worksheet for example, the reason why I used (\"B3:AR3\") is because I have formulas in all those cells that I want copied down to the last row (lrp). This code does autofill all of it down but it also adds the formula into the cell above it. So now B2 for example has a formula in it that reads \"#N/A\" when it is supposed to be my header. How do I autofill the formula down from row 3 (from columns B to AR) all the way down to the last row without including it in the header.</p>\n\n<p>Thanks for all your guys help. Still new to VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1500491854, "post_id": 45199205, "comment_id": 77365614, "body": "have a cell on a hidden sheet (allows persistence) or a static variable (resets on each load) that records the number of times changes are made. Exit code if limit is exceeded"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500491857, "post_id": 45199205, "comment_id": 77365615, "body": "The answer is probably Yes - what did you already try, and what issues did you run into?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500491869, "post_id": 45199205, "comment_id": 77365619, "body": "Sure - you&#39;ll may want to look into <code>Worksheet Change()</code> event. What have you tried? Is it a maximum of changer per Excel session, or over the lifetime of a document?"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1500492223, "post_id": 45199205, "comment_id": 77365801, "body": "Maximum per excel session. I have tried the following.. Private Sub ComboBox2_Change() With Worksheets(&quot;Information Sheet&quot;).Shapes(&quot;Drop Down 14&quot;) If Worksheets(&quot;Disp_&amp;_Result_Calc&quot;).Range(&quot;Z1&quot;) = &quot;&quot; Then Call CombinedMacro2 Else MsgBox (&quot;You have specified the maximum number of depths!&quot;) End If End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 8312826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d3955dbf04bc4f35f686f6755a3130?s=128&d=identicon&r=PG&f=1", "display_name": "RiverKing", "link": "https://stackoverflow.com/users/8312826/riverking"}, "is_accepted": false, "score": 0, "last_activity_date": 1500492193, "creation_date": 1500492193, "answer_id": 45199351, "question_id": 45199205, "link": "https://stackoverflow.com/questions/45199205/allow-user-to-change-selection-in-dropdown-list-a-maximum-of-6-times-but-have-th/45199351#45199351", "title": "Allow user to change selection in dropdown list a maximum of 6 times but have the code run after each change in selection", "body": "<p>I think the STATIC Statement might be useful in this situation.  It will cause the variable defined to retain its value \"as long as the code is running\".  I understand this to mean that the procedure in which the STATIC variable is declared can modify the variable and exit.  When the same procedure is invoked again, the variable will have the same value (rather than being reinitialized as a variable defined by DIM would be).  Exiting and restarting the module would reinitialize the STATIC variable.</p>\n"}], "owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1500493236, "creation_date": 1500491617, "last_edit_date": 1500493236, "question_id": 45199205, "link": "https://stackoverflow.com/questions/45199205/allow-user-to-change-selection-in-dropdown-list-a-maximum-of-6-times-but-have-th", "title": "Allow user to change selection in dropdown list a maximum of 6 times but have the code run after each change in selection", "body": "<p>Is there a way to have a VBA code where the user is only allowed to change their selection in a dropdown box a maximum of 6 times? I need the macro assigned with the dropdown box to run after each time the user selects a value from the dropdown box. </p>\n\n<p>I have tried the following:</p>\n\n<pre><code>Private Sub ComboBox2_Change()\nWith Worksheets(\"Information Sheet\").Shapes(\"Drop Down 14\")\n    If Worksheets(\"Disp_&amp;_Result_Calc\").Range(\"Z1\") = \"\" Then\n        Call CombinedMacro2\n    Else\n        MsgBox (\"You have specified the maximum number of depths!\")\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "text"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 8310388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ee633d658298b6107c13b60c7af198?s=128&d=identicon&r=PG&f=1", "display_name": "Gitanjali", "link": "https://stackoverflow.com/users/8310388/gitanjali"}, "edited": false, "score": 0, "creation_date": 1500507077, "post_id": 45200688, "comment_id": 77372386, "body": "Thanks so much for flagging the error in Pearson&#39;s function - I would not have caught that. Once I edited it per your response, the import works!"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 117, "user_id": 8310388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ee633d658298b6107c13b60c7af198?s=128&d=identicon&r=PG&f=1", "display_name": "Gitanjali", "link": "https://stackoverflow.com/users/8310388/gitanjali"}, "edited": false, "score": 0, "creation_date": 1500514994, "post_id": 45200688, "comment_id": 77374261, "body": "@Gitanjali you should accept this post as the correct answer as it&#39;s a good catch."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1500509362, "last_edit_date": 1500509362, "creation_date": 1500497119, "answer_id": 45200688, "question_id": 45198781, "link": "https://stackoverflow.com/questions/45198781/trying-to-use-vba-to-import-fixed-width-text-files-to-excel/45200688#45200688", "title": "Trying to use VBA to import fixed-width text files to Excel", "body": "<p>You have an error in your posted function at the lines saying</p>\n\n<pre><code>FieldSpecs:=\"1,5|2,45|3,3|4,45|5,45|6,45|7,60|8,15|9,11|10,60| _\n             11,60|12,10|13,5|14,5|15,3|16,3|17,3|18,3|19,11|20,10| \n             ...190,250|191,250\")\n</code></pre>\n\n<p>because you can't have a continuation character within a String literal and still have it treated as a continuation character.  As that would stop your code compiling, I assume that isn't like that in your actual code.</p>\n\n<hr>\n\n<p>Chip Pearson has an error in his function.  The lines saying</p>\n\n<pre><code>If SkipLinesBeginningWith &lt;&gt; vbNullString And _\n   StrComp(Left(Trim(S), Len(SkipLinesBeginningWith)), _\n     SkipLinesBeginningWith, vbTextCompare) Then\n</code></pre>\n\n<p>will exclude all lines from processing if the <code>SkipLinesBeginningWith</code> variable is a null string because</p>\n\n<ul>\n<li><code>SkipLinesBeginningWith &lt;&gt; vbNullString</code> will be <code>False</code>, and</li>\n<li>the <code>StrComp(Left(Trim(S), Len(SkipLinesBeginningWith)), SkipLinesBeginningWith, vbTextCompare)</code> portion will return <code>0</code>, which is equivalent to <code>False</code>.</li>\n</ul>\n\n<p>It should actually be</p>\n\n<pre><code>If SkipLinesBeginningWith = vbNullString Or _\n   StrComp(Left(Trim(S), Len(SkipLinesBeginningWith)), _\n      SkipLinesBeginningWith, vbTextCompare) Then\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 8310388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ee633d658298b6107c13b60c7af198?s=128&d=identicon&r=PG&f=1", "display_name": "Gitanjali", "link": "https://stackoverflow.com/users/8310388/gitanjali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4964, "favorite_count": 0, "accepted_answer_id": 45200688, "answer_count": 1, "score": 3, "last_activity_date": 1500509362, "creation_date": 1500490239, "last_edit_date": 1525816189, "question_id": 45198781, "link": "https://stackoverflow.com/questions/45198781/trying-to-use-vba-to-import-fixed-width-text-files-to-excel", "title": "Trying to use VBA to import fixed-width text files to Excel", "body": "<p>I am new to VBA and hoping for some help implementing a user-defined function. I would really appreciate any help!</p>\n\n<p><strong>Context</strong>: I am trying to import a batch of fixed-width text files into separate Excel workbooks. The text files all have the same fields and format. I know the length of each field. </p>\n\n<p><strong>Issue</strong>: As I'm new to VBA, I looked for existing code. I found <a href=\"http://www.cpearson.com/excel/ImportingFixedWidth.aspx\" rel=\"nofollow noreferrer\">Chip Pearson's <em>ImportFixedWidth</em> function</a> and have been trying to implement it per his description. First, I copied his example macro calling the <em>ImportFixedWidth</em> function and edited it to reflect the number and length of each of my data fields. I called that module <em>TestImport</em>.</p>\n\n<pre><code>Sub TestImport()\n    Dim L As Long\n    L = ImportFixedWidth(FileName:=\"/Users/gitanjali/Desktop/CAC06075test.txt\", _\n        StartCell:=Range(\"A1\"), _\n        IgnoreBlankLines:=False, _\n        SkipLinesBeginningWith:=vbNullString, _\n        FieldSpecs:=\"1,5|2,45|3,3|4,45|5,45|6,45|7,60|8,15|9,11|10,60| _\n                     11,60|12,10|13,5|14,5|15,3|16,3|17,3|18,3|19,11|20,10| \n                     ...190,250|191,250\")\nEnd Sub\n</code></pre>\n\n<p>Then, I copied his ImportFixedWidth code into another module (Module2, see code block at the end of this post). </p>\n\n<p>I then tried to run the macro within the workbook, but it doesn't seem to work - that is, the function ImportFixedWidth should return either the number of records imported (if it works) or -1 (if it doesn't). When I run TestImport from the workbook, <em>nothing</em> is returned - the workbook remains blank.</p>\n\n<p><strong>Debugging</strong>: The code compiles, and I don't get any errors when I step through either the <em>TestImport</em> or Module2 code. </p>\n\n<p><strong>Question</strong>: I'm at a loss for next steps in terms of debugging. Are there any obvious errors in my implementation, or how I am trying to run the macro? </p>\n\n<pre><code> Function ImportFixedWidth(FileName As String, _\n    StartCell As Range, _\n    IgnoreBlankLines As Boolean, _\n    SkipLinesBeginningWith As String, _\n    ByVal FieldSpecs As String) As Long\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' ImportFixedWidth\n' By Chip Pearson, chip@cpearson.com www.cpearson.com\n' Date: 27-August-2011\n' Compatible with 64-bit platforms.\n'\n' This function imports text from a fixed field width file.\n' FileName is the name of the file to import. StartCell is\n' the cell in which the import is to begin. IgnoreBlankLines\n' indicates what to do with empty lines in the text file. If\n' IgnoreBlankLines is False, an empty row will appear in the\n' worksheet. If IgnoreBlankLines is True, no empty row will\n' appear in the worksheet. SkipLinesBeginingWith indicates\n' what character, if any, at the begining of the line indicates\n' that the line should not be imported, such as fpr providing for\n' comments within the text file. FieldSpecs indicates how to\n' map the data into cells. It is a string of the format:\n'           start,length|start,length|start,length...\n' where each 'start' is the character position of the field\n' in the text line and each 'length' is the length of the field.\n' For example, if FieldSpecs is\n'           1,8|9,3|12,5\n' indicates the first field starting in position 1 for a\n' length of 8, the second field starts in position 9 for a\n' length of 3, and finally a field beginning in position 12\n' for a length of 5. Fields can be in any order and may\n' overlap.\n' You can specify a number format for the field which will\n' be applied to the worksheet cell. This format should not\n' be in quotes and should follow the length element. For example,\n'       2,8|9,3,@|12,8,dddd dd-mmm-yyyy\n' This specifies that no formatting will be applied to column 2,\n' the Text (literal) format will be applied to column 9, and\n' the format 'dddd dd-mmm-yyyy' will be applied to column 12.\n'\n' The function calls ImportThisLine, which should return\n' True to import the text from the file, or False to skip\n' the current line.\n' This function returns the number of records imported if\n' successful or -1 if an error occurred.\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nDim FINdx As Long\nDim C As Long\nDim R As Range\nDim FNum As Integer\nDim S As String\nDim RecCount As Long\nDim FieldInfos() As String\nDim FInfo() As String\nDim N As Long\nDim T As String\nDim B As Boolean\n\nApplication.EnableCancelKey = xlInterrupt\nOn Error GoTo EndOfFunction:\n\nIf Dir(FileName, vbNormal) = vbNullString Then\n    ' file not found\n    ImportFixedWidth = -1\n    Exit Function\nEnd If\n\nIf Len(FieldSpecs) &lt; 3 Then\n    ' invalid FieldSpecs\n    ImportFixedWidth = -1\n    Exit Function\nEnd If\n\nIf StartCell Is Nothing Then\n    ImportFixedWidth = -1\n    Exit Function\nEnd If\n\nSet R = StartCell(1, 1)\nC = R.Column\nFNum = FreeFile\n\nOpen FileName For Input Access Read As #FNum\n' get rid of any spaces\nFieldSpecs = Replace(FieldSpecs, Space(1), vbNullString)\n' omit double pipes ||\nN = InStr(1, FieldSpecs, \"||\", vbBinaryCompare)\nDo Until N = 0\n    FieldSpecs = Replace(FieldSpecs, \"||\", \"|\")\n    N = InStr(1, FieldSpecs, \"||\", vbBinaryCompare)\nLoop\n' omit double commas\nN = InStr(1, FieldSpecs, \",,\", vbBinaryCompare)\nDo Until N = 0\n    FieldSpecs = Replace(FieldSpecs, \",,\", \",\")\n    N = InStr(1, FieldSpecs, \",,\", vbBinaryCompare)\nLoop\n\n' get rid of leading and trailing | characters, if necessary\nIf StrComp(Left(FieldSpecs, 1), \"|\", vbBinaryCompare) = 0 Then\n    FieldSpecs = Mid(FieldSpecs, 2)\nEnd If\nIf StrComp(Right(FieldSpecs, 1), \"|\", vbBinaryCompare) = 0 Then\n    FieldSpecs = Left(FieldSpecs, Len(FieldSpecs) - 1)\nEnd If\n\nDo\n    ' read the file\n    Line Input #FNum, S\n    If SkipLinesBeginningWith &lt;&gt; vbNullString And _\n            StrComp(Left(Trim(S), Len(SkipLinesBeginningWith)), _\n            SkipLinesBeginningWith, vbTextCompare) Then\n        If Len(S) = 0 Then\n            If IgnoreBlankLines = False Then\n                Set R = R(2, 1)\n            Else\n                ' do nothing\n            End If\n        Else\n            ' allow code to change the FieldSpecs values\n\n            If FieldSpecs = vbNullString Then\n                ' FieldSpecs is empty. Do nothing, don't import.\n            Else\n                If ImportThisLine(S) = True Then\n                    FieldInfos = Split(FieldSpecs, \"|\")\n                    C = R.Column\n                    For FINdx = LBound(FieldInfos) To UBound(FieldInfos)\n                        FInfo = Split(FieldInfos(FINdx), \",\")\n                        R.EntireRow.Cells(1, C).Value = Mid(S, CLng(FInfo(0)), CLng(FInfo(1)))\n                        C = C + 1\n                    Next FINdx\n                    RecCount = RecCount + 1\n                End If\n                Set R = R(2, 1)\n            End If\n        End If\n    Else\n        ' no skip first char\n    End If\n\nLoop Until EOF(FNum)\n\nEndOfFunction:\nIf Err.Number = 0 Then\n    ImportFixedWidth = RecCount\nElse\n    ImportFixedWidth = -1\nEnd If\nClose #FNum\nEnd Function\n\nPrivate Function ImportThisLine(S As String) As Boolean\n\nDim N As Long\nDim NoImportWords As Variant\nDim T As String\nDim L As Long\n\nNoImportWords = Array(\"page\", \"product\", \"xyz\")\nFor N = LBound(NoImportWords) To UBound(NoImportWords)\n    T = NoImportWords(N)\n    L = Len(T)\n    If StrComp(Left(S, L), T, vbTextCompare) = 0 Then\n        ImportThisLine = False\n        Exit Function\n    End If\nNext N\nImportThisLine = True\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500624471, "post_id": 45198257, "comment_id": 77430240, "body": "probably not. you are actually downloading the web page, so there is no way to run a query. which information are you trying to pull. your example code has nothing in B42. maybe because you are using a Mac and i am not. there may be a web API available to pull just the required value. sort of like this <a href=\"http://www.jarloo.com/yahoo_finance/\" rel=\"nofollow noreferrer\">jarloo.com/yahoo_finance</a>"}, {"owner": {"reputation": 11, "user_id": 8333620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a16f7f489427e69c5e8d1c043c3c96?s=128&d=identicon&r=PG&f=1", "display_name": "vbaLearner", "link": "https://stackoverflow.com/users/8333620/vbalearner"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1500652667, "post_id": 45198257, "comment_id": 77450017, "body": "Oh I see, I&#39;ve checked out that website before but I already have that API set up I was just wondering if I could make it more efficient. Thanks for the info!"}], "owner": {"reputation": 11, "user_id": 8333620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a16f7f489427e69c5e8d1c043c3c96?s=128&d=identicon&r=PG&f=1", "display_name": "vbaLearner", "link": "https://stackoverflow.com/users/8333620/vbalearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1500495048, "creation_date": 1500488486, "last_edit_date": 1500495048, "question_id": 45198257, "link": "https://stackoverflow.com/questions/45198257/vba-pulling-specific-data-from-querytables", "title": "VBA - Pulling specific data from QueryTables", "body": "<p>I am currently using Excel 2011 on Mac, and I am trying to pull data using a QueryTable, but I am forced to have to import the entire table. I am currently pasting the entire table onto a hidden sheet, then using a formula to pull data from the specific cell. To show you what I mean, Here is a sample:</p>\n\n<pre><code> Sub Yield()\n\n Dim URL As String\n Dim qt as QueryTable\n Dim hs As Worksheet\n Set hs = Worksheets(\"Hidden Sheet\")\n Set ws = Worksheets (\"Managed Equity Portfolios\")\n URL = \"http://www.nasdaq.com/symbol/spy\"\n Sheets(\"Hidden Sheet\").Visible = True\n\n Set qt = hs.QueryTables.Add( _\n      Connections:= \"URL;\" &amp; URL, _\n      Destination:= hs.Range(\"A1\"))\n      qt.RefreshStyle = xlOverwriteCells = True\n      qt.BackgroundQuery = True\n      qt.SaveData = True\n      qt.Refresh Background Query:= False\n      'I am using the same parameters here as my other code, honestly not\n       'sure why a lot of it is on here, but I kept it because it works.\n\n\n Worksheets(\"Hidden Sheet\").Visible = False\n\n End Sub\n</code></pre>\n\n<p>Currently, the information I need is being pasted into the Hidden Sheet in cell B42. I made it so the cell that I want the information ='Hidden Sheet!'B42 but this doesn't seem very efficient. Is there any way I could have just the cell B42 be put into Excel? </p>\n\n<p>I'll be on here to clear up any questions, thank you so much! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1500488083, "post_id": 45198103, "comment_id": 77363377, "body": "&quot;Please give me a simple code too.&quot; - Sorry, but SO isn&#39;t a &quot;code for me&quot; site, but rather &quot;help me with my code.&quot;  What have you tried so far? This is a pretty common thing to do, I&#39;d be surprised if there&#39;s no site/answer online. What have you searched for? What has/hasn&#39;t worked?"}, {"owner": {"reputation": 679, "user_id": 7777877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24c242cbeb9a19b58d59d6a59a44bd15?s=128&d=identicon&r=PG&f=1", "display_name": "Jsleshem", "link": "https://stackoverflow.com/users/7777877/jsleshem"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500488152, "post_id": 45198103, "comment_id": 77363416, "body": "Like @BruceWayne said, SO is not for asking for code. Please write a but of code and show it before asking for help."}, {"owner": {"reputation": 1640, "user_id": 179795, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/239be0d2607584eb16044da758a58ee1?s=128&d=identicon&r=PG", "display_name": "Behrooz", "link": "https://stackoverflow.com/users/179795/behrooz"}, "edited": false, "score": 1, "creation_date": 1500488661, "post_id": 45198103, "comment_id": 77363734, "body": "guys, Stop hating the guy for not knowing the rules, maybe &#39;teach&#39; him instead?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1640, "user_id": 179795, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/239be0d2607584eb16044da758a58ee1?s=128&d=identicon&r=PG", "display_name": "Behrooz", "link": "https://stackoverflow.com/users/179795/behrooz"}, "edited": false, "score": 0, "creation_date": 1500489503, "post_id": 45198103, "comment_id": 77364222, "body": "@Behrooz - No hate...We&#39;re not against teaching people, we&#39;re here to help! I suggest OP also see <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>.  There are myriad resources online that have what they&#39;re trying to do.  SO is a place to get specific help with specific problems, not a general &quot;How do I do this, give me the code&quot; site.  Also, in <a href=\"https://stackoverflow.com/help/how-to-answer\">How to Answer</a>, &quot; Save yourself some frustration and avoid trying to answer questions which...require too much guidance for you to answer in full, or request answers to multiple questions.&quot;"}, {"owner": {"reputation": 1640, "user_id": 179795, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/239be0d2607584eb16044da758a58ee1?s=128&d=identicon&r=PG", "display_name": "Behrooz", "link": "https://stackoverflow.com/users/179795/behrooz"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500608913, "post_id": 45198103, "comment_id": 77423173, "body": "@BruceWayne I know the rules, been here fore some time. Just thinking that if we ignore/downvote new users like this, sometimes they will never ask any questions ever again. I have personally avoided asking questions on SO for a few years because of this. there is a person on the other side, it takes a lot of courage for some people."}], "answers": [{"tags": [], "owner": {"reputation": 1640, "user_id": 179795, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/239be0d2607584eb16044da758a58ee1?s=128&d=identicon&r=PG", "display_name": "Behrooz", "link": "https://stackoverflow.com/users/179795/behrooz"}, "is_accepted": true, "score": 0, "last_activity_date": 1500488614, "creation_date": 1500488614, "answer_id": 45198296, "question_id": 45198103, "link": "https://stackoverflow.com/questions/45198103/how-to-make-textbox-to-remembers-the-previous-input-in-excel-vba/45198296#45198296", "title": "How to make textbox to remembers the previous input in Excel VBA?", "body": "<p>As others have pointed out this is not a code site, thus plain old English.<br>\nFirst, You need a static variable to store the previous value, static because it should not vanish from memory after your 'current' event is over.<br>\nThen, You need to set said variable after an input is checked in your event to have it ready for the next time.<br>\nso, this is how it goes:  </p>\n\n<pre><code>static varible here  \n\ninside your event sub:  \nchecking the variable to see if this is the first run\nuse previous value from variable  \nset current value from input to variable  \n</code></pre>\n\n<p>If you need the variable to persist between runs you should store it in a cell instead of static variable.</p>\n\n<p>P.S. I'm not doing this to hurt you or hate you or make a point; It's a simple reason, \"This is how you can learn.\"</p>\n"}], "owner": {"reputation": 9, "user_id": 8311384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b9e6ed32119e256dcf0b1bd651bb0d7?s=128&d=identicon&r=PG&f=1", "display_name": "Madhav", "link": "https://stackoverflow.com/users/8311384/madhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "accepted_answer_id": 45198296, "answer_count": 1, "score": -7, "last_activity_date": 1500532676, "creation_date": 1500488006, "last_edit_date": 1531161705, "question_id": 45198103, "link": "https://stackoverflow.com/questions/45198103/how-to-make-textbox-to-remembers-the-previous-input-in-excel-vba", "title": "How to make textbox to remembers the previous input in Excel VBA?", "body": "<p>How to make the textbox to remember the previous input in Excel VBA? </p>\n\n<p>I found that I have to save input value to any other cells and load when the form is open. I dont know how to do it. Can anyone help me here?  </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500487583, "post_id": 45197758, "comment_id": 77363111, "body": "<a href=\"https://stackoverflow.com/questions/7031416/return-index-of-an-element-in-an-array-excel-vba/7031744#7031744\" title=\"return index of an element in an array excel vba\">stackoverflow.com/questions/7031416/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 7777877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24c242cbeb9a19b58d59d6a59a44bd15?s=128&d=identicon&r=PG&f=1", "display_name": "Jsleshem", "link": "https://stackoverflow.com/users/7777877/jsleshem"}, "edited": false, "score": 0, "creation_date": 1500488297, "post_id": 45197976, "comment_id": 77363505, "body": "Although this works, it has a time of O(n^2). Try implementing a different sort (Like quicksort or mergesort) to significantly speed the processs."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 679, "user_id": 7777877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24c242cbeb9a19b58d59d6a59a44bd15?s=128&d=identicon&r=PG&f=1", "display_name": "Jsleshem", "link": "https://stackoverflow.com/users/7777877/jsleshem"}, "edited": false, "score": 0, "creation_date": 1500491536, "post_id": 45197976, "comment_id": 77365436, "body": "@Jsleshem I wasnt going to get too complicated for something so simple. He did say he was working with arrays...."}, {"owner": {"reputation": 679, "user_id": 7777877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24c242cbeb9a19b58d59d6a59a44bd15?s=128&d=identicon&r=PG&f=1", "display_name": "Jsleshem", "link": "https://stackoverflow.com/users/7777877/jsleshem"}, "edited": false, "score": 0, "creation_date": 1500491644, "post_id": 45197976, "comment_id": 77365497, "body": "fair, I understand"}, {"owner": {"reputation": 7, "user_id": 8333210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/621f6a037ea7fb9f945fab72cdacecb0?s=128&d=identicon&r=PG&f=1", "display_name": "LeFun", "link": "https://stackoverflow.com/users/8333210/lefun"}, "edited": false, "score": 1, "creation_date": 1500560457, "post_id": 45197976, "comment_id": 77401220, "body": "You sir, are my hero! Thank you so much. I was able to adjust it accordingly!"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 0, "last_activity_date": 1500560279, "last_edit_date": 1500560279, "creation_date": 1500487563, "answer_id": 45197976, "question_id": 45197758, "link": "https://stackoverflow.com/questions/45197758/excel-vba-get-minimum-out-of-1-dimension-in-multi-dimensional-array/45197976#45197976", "title": "Excel VBA: Get Minimum out of 1 Dimension in Multi Dimensional Array", "body": "<pre><code>Private Sub this()\n    Dim Targets As Variant\n    Dim minValuePerRow As String\n    minValuePerRow = \"\"\n    Targets = ThisWorkbook.Sheets(\"Sheet3\").UsedRange\n    For i = LBound(Targets, 1) To UBound(Targets, 1)\n        For j = LBound(Targets, 2) To UBound(Targets, 2)\n            If (Targets(i, j) &lt;&gt; 0 Or Targets(i, j) &lt;&gt; \"\") And minValuePerRow = \"\" Then minValuePerRow = Targets(i, j)\n            If Targets(i, j) &lt;&gt; 0 And Targets(i, j) &lt; minValuePerRow Then\n                 minValuePerRow = Targets(i, j)\n            End If\n        Next j\n        Debug.Print ; i\n        Debug.Print ; minValuePerRow\n        minValuePerRow = \"\"\n    Next i\nEnd Sub\n</code></pre>\n\n<p><em>EDIT</em></p>\n\n<p>Reworked and tested it. This should be more than plenty to help you adjust to your needs. </p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1500488038, "creation_date": 1500488038, "answer_id": 45198116, "question_id": 45197758, "link": "https://stackoverflow.com/questions/45197758/excel-vba-get-minimum-out-of-1-dimension-in-multi-dimensional-array/45198116#45198116", "title": "Excel VBA: Get Minimum out of 1 Dimension in Multi Dimensional Array", "body": "<p>This doesn't address the second part of your question about excluding zeros but...</p>\n\n<p>Given a 2-D array (such as you might get from a worksheet range using <code>Value</code>), you can use Application.Index to get a \"slice\" of that array:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Mk5ut.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mk5ut.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Tester()\n\n    Dim arr, slice\n    arr = Range(\"A1:C3\").Value\n\n    'get a \"row\"\n    slice = Application.Index(arr, 1, 0)\n    Debug.Print Join(slice, \"-\") '&gt;&gt; 1-2-3\n\n    'get a \"column\" (note use of Transpose here)\n    slice = Application.Transpose(Application.Index(arr, 0, 1))\n    Debug.Print Join(slice, \"-\") '&gt;&gt; 1-4-7\n    'col 2...\n    slice = Application.Transpose(Application.Index(arr, 0, 2))\n    Debug.Print Join(slice, \"-\") '&gt;&gt; 2-5-8\n\n    Debug.Print Application.Min(slice) '&gt;&gt; 2\n\n\nEnd Sub\n</code></pre>\n\n<p>Worth noting that the performance of this approach is kind of bad though: <a href=\"https://stackoverflow.com/questions/7031416/return-index-of-an-element-in-an-array-excel-vba/7031744#7031744\">Return Index of an Element in an Array Excel VBA</a></p>\n"}, {"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 0, "last_activity_date": 1500491731, "creation_date": 1500491731, "answer_id": 45199232, "question_id": 45197758, "link": "https://stackoverflow.com/questions/45197758/excel-vba-get-minimum-out-of-1-dimension-in-multi-dimensional-array/45199232#45199232", "title": "Excel VBA: Get Minimum out of 1 Dimension in Multi Dimensional Array", "body": "<p>If the array size is too large, you'll find this to be very slow.  It uses the Evaluate method to return the minimum for each row.  However, you'll notice that I've included a function that makes those target values available to the Evaluate Method. Also, you'll notice that Targets is declared at the module level.</p>\n\n<pre><code>Dim Targets As Variant\n\nPublic Function Values() As Variant\n    Values = Targets\nEnd Function\n\nSub test()\n    Dim i As Long\n\n    Targets = Range(\"A1:J10\").Value\n\n    For i = LBound(Targets, 1) To UBound(Targets)\n        Debug.Print Application.Evaluate(\"MIN(IF(INDEX(Values(),\" &amp; i &amp; \",0)&gt;0,INDEX(Values(),\" &amp; i &amp; \",0)))\")\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 7, "user_id": 8333210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/621f6a037ea7fb9f945fab72cdacecb0?s=128&d=identicon&r=PG&f=1", "display_name": "LeFun", "link": "https://stackoverflow.com/users/8333210/lefun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1462, "favorite_count": 0, "accepted_answer_id": 45197976, "answer_count": 3, "score": 0, "last_activity_date": 1500560279, "creation_date": 1500486881, "question_id": 45197758, "link": "https://stackoverflow.com/questions/45197758/excel-vba-get-minimum-out-of-1-dimension-in-multi-dimensional-array", "title": "Excel VBA: Get Minimum out of 1 Dimension in Multi Dimensional Array", "body": "<p>for work, I need to adjust some prewritten VBA code. But I am rather a beginner, thus it is quite challenging for me.</p>\n\n<p>The code creates a 2D array called Targets. It spans by (a variable number of ) KPIs and for each KPI the values for 10 years (fix number). E.g.:</p>\n\n<p><strong>KPI 1</strong> year_1 year_2 ... year_10<br/>\n<strong>KPI 2</strong> year_1 year_2 ... year_10<br/>\n...   ...    ....   ... .....   ...    ....   ... .....   ...    ...<br/>\n<strong>KPI n</strong>  year_1 year_2 ... year_10<br/></p>\n\n<p>I now need to calculate the minimum per KPI line (1D array).</p>\n\n<p>My ugly working code: \n<br/><code>WorksheetFunction.Min(Targets(k, 0), Targets(k , 1), Targets(k, 2), Targets(k, 3), Targets(k , 4), Targets(k , 5), Targets(k, 6), Targets(k, 7), Targets(k, 8), Targets(k , 9))</code></p>\n\n<p>Where k is directing to the correct KPI.</p>\n\n<p>How can I make it work such that it basically takes the entire line without me having to direct the code to each specific cell? (e.g. Targets (k,:) or Targets (k, 0 to 9))</p>\n\n<p>Bonus question: Some values within these arrays are zero as they are tbd. Those are supposed to be excluded from the minimum. So I need the Minimum > zero. Can you figure that out too?</p>\n\n<p>It probably is super easy. But I cannot seem to make it work.</p>\n\n<p>Thanks so much in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1500485587, "post_id": 45197301, "comment_id": 77361956, "body": "<code>Case 2</code> looks suspect, because for a cell to contain <code>&quot;pdf&quot;</code> it&#39;s len must be greater than or equal to 3."}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500485730, "post_id": 45197301, "comment_id": 77362026, "body": "So im asking excel to determine the LEN so it can run the formula to change it from a simple name to the actual filename. Example <code>A1 should turn into 173A0011.pdf</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1500485883, "post_id": 45197301, "comment_id": 77362124, "body": "The body of your <code>Case 2</code> block will <i>never</i> execute if the length of the cell &lt;&gt; 2. So, you need to determine under what conditions that block ought to execute, and either modify your <code>Case</code> or add a different <code>Case</code> statement to account for that condition(s)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1500485984, "post_id": 45197301, "comment_id": 77362195, "body": "What does your data look like? Examples would help. Also, remove/comment out your <code>Select Case</code> stuff. As mentioned, it&#39;s not going to run on <i>any</i> cell that&#39;s greater than length 2...which I assume is all cells, but especially cells with <code>pdf</code> in them anywhere."}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 0, "creation_date": 1500486483, "post_id": 45197301, "comment_id": 77362497, "body": "I only showed <code>Case 2</code> to keep the code here small. I have a Case 2,3,4,8,9,10,11,12. When i run the code everything works fine. but if i run the code to convert simple naming to actual naming <code>ie., A1 = Simple, 173A0011.pdf = actual</code> with a cell that ends in &quot;PDF&quot; then it removes that cell for some reason. So i thought my problem was in my <code>If(Right...</code> line. I want to say If last 3 characters of cell in range = &quot;PDF&quot; then skip Else run formula."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1500486667, "post_id": 45197301, "comment_id": 77362610, "body": "Do you use <code>Option Compare Text</code>? If not, go for <code>lcase(Right(bCell, 3)) &lt;&gt; SearchChar</code>, since comparisons in VBA are case sensitive by default."}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 0, "creation_date": 1500487409, "post_id": 45197301, "comment_id": 77363021, "body": "It seems to be an error with my  <code>Case Else         If LCase(Right(bCell, 3)) &lt;&gt; SearchChar Then             val = (bCell)         End If</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "is_accepted": false, "score": 0, "last_activity_date": 1500487924, "creation_date": 1500487924, "answer_id": 45198079, "question_id": 45197301, "link": "https://stackoverflow.com/questions/45197301/run-code-on-cells-that-dont-end-with-pdf/45198079#45198079", "title": "Run code on cells that don&#39;t end with &quot;PDF&quot;", "body": "<p>You may try like this to rename selection items not ending with \"pdf\"</p>\n\n<pre><code>Set rng = Selection\nSearchChar = \"pdf\"\nSelect Case n\n    Case 2\n        For Each r In rng\n            If Right(r, 3) &lt;&gt; SearchChar Then 'This must be wrong\n                r = SearchSite &amp; Left(r, 1) &amp; \"00\" &amp; Mid(r, 2, 1) &amp; \"1.pdf\"\n            End If\n        Next\nEnd Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "edited": false, "score": 0, "creation_date": 1500489850, "post_id": 45198254, "comment_id": 77364435, "body": "This got me on the right track.         <code>If LCase(Right(bCell, 3)) = SearchChar Then             val = bCell Else</code> Inserted this in below each case statement."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1500488784, "last_edit_date": 1500488784, "creation_date": 1500488471, "answer_id": 45198254, "question_id": 45197301, "link": "https://stackoverflow.com/questions/45197301/run-code-on-cells-that-dont-end-with-pdf/45198254#45198254", "title": "Run code on cells that don&#39;t end with &quot;PDF&quot;", "body": "<p>Have you tried changing your If statement to check if the right 3 characters are pdf, then \"nothing\" else your code?  Would be similar to:</p>\n\n<pre><code>If Right(bCell,3)=SearchChar Then\n'Nothing\nElse\nval = SearchSite &amp; Left(r, 1) &amp; \"00\" &amp; Mid(r, 2, 1) &amp; \"1.pdf\"\nbCell.Value=val\nEnd If\n</code></pre>\n\n<p>My guess is that where the last 3 characters are pdf, val = nothing, so what is printed out is bCell.Value= nothing, so it deletes it.  I moved that inside the else section.</p>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1500495694, "creation_date": 1500485371, "last_edit_date": 1500495694, "question_id": 45197301, "link": "https://stackoverflow.com/questions/45197301/run-code-on-cells-that-dont-end-with-pdf", "title": "Run code on cells that don&#39;t end with &quot;PDF&quot;", "body": "<p>I am trying to do some renaming and I do not want the code to run if the last 3 characters = pdf. Should be simple, but when I run the macro the renaming works fine but it deletes every cell that ends with pdf. </p>\n\n<pre><code>SearchChar = \"pdf\"\n\nFor Each bCell In rng.Cells\nSelect Case Len(bCell)\nCase 2\n    If Right(bCell, 3) &lt;&gt; SearchChar Then 'This must be wrong\n        val = SearchSite &amp; Left(bCell, 1) &amp; \"00\" &amp; Mid(bCell, 2, 1) &amp; \"1.pdf\"\n    End If\nEnd Select\nbCell.Value = val\nNext\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1500543869, "post_id": 45196944, "comment_id": 77388167, "body": "When you say a Subform that &quot;opens&quot;, this implies that it isn&#39;t actually a sub form but a pop up form? If it is then I suspect it&#39;s being opened filtered to the main record by the parent ID field from the calling form. If it really is a sub form it sounds as if the Parent/child relationship is broken in some weird way, or the subform isn&#39;t set up to allow additions?"}, {"owner": {"reputation": 1017, "user_id": 4855041, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/278274b696569b7d8b57975d2a7766f4?s=128&d=identicon&r=PG&f=1", "display_name": "Perry", "link": "https://stackoverflow.com/users/4855041/perry"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1500549208, "post_id": 45196944, "comment_id": 77391875, "body": "I am sorry Minty and must apologize.  I misspoke the form is not a sub form it is stand alone form that opens as a pop up.  The form is set to allow additions."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1500550076, "post_id": 45196944, "comment_id": 77392493, "body": "To be honest the simplest route would be to make it a sub form. Then the parent ID would default to the correct one and additions would be simple. You can always hide / show the sub form based on your button press."}], "answers": [{"comments": [{"owner": {"reputation": 1017, "user_id": 4855041, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/278274b696569b7d8b57975d2a7766f4?s=128&d=identicon&r=PG&f=1", "display_name": "Perry", "link": "https://stackoverflow.com/users/4855041/perry"}, "edited": false, "score": 0, "creation_date": 1500557073, "post_id": 45199967, "comment_id": 77398290, "body": "Actually the Access table did not have a primary key at all.  I tried to add a primary key to the SQL table but that did not help??"}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "reply_to_user": {"reputation": 1017, "user_id": 4855041, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/278274b696569b7d8b57975d2a7766f4?s=128&d=identicon&r=PG&f=1", "display_name": "Perry", "link": "https://stackoverflow.com/users/4855041/perry"}, "edited": false, "score": 0, "creation_date": 1500563318, "post_id": 45199967, "comment_id": 77403552, "body": "So when you started, there was no PK on the SQL side?  Can you add a new comment through the subform&#39;s recordsource?  Can you add other data on the server?"}, {"owner": {"reputation": 1017, "user_id": 4855041, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/278274b696569b7d8b57975d2a7766f4?s=128&d=identicon&r=PG&f=1", "display_name": "Perry", "link": "https://stackoverflow.com/users/4855041/perry"}, "edited": false, "score": 0, "creation_date": 1500573957, "post_id": 45199967, "comment_id": 77410479, "body": "I got the form to work and this is what I did.  I added a primary key to the table.  Then recreated the form and used it as a sub form.  It is now working.  Thanks for all the suggestions."}], "tags": [], "owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "is_accepted": false, "score": 0, "last_activity_date": 1500494442, "creation_date": 1500494442, "answer_id": 45199967, "question_id": 45196944, "link": "https://stackoverflow.com/questions/45196944/how-can-i-fix-an-access-2010-you-cant-go-to-specified-record-error/45199967#45199967", "title": "How Can I fix An Access 2010 &quot;You Can&#39;t go to specified record&quot; Error", "body": "<p>was the PK field in the Access table type autoNumber?  If so, you'll need to set up an identity specification in the design of the table on the SQL Server.</p>\n"}], "owner": {"reputation": 1017, "user_id": 4855041, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/278274b696569b7d8b57975d2a7766f4?s=128&d=identicon&r=PG&f=1", "display_name": "Perry", "link": "https://stackoverflow.com/users/4855041/perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1465, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500494442, "creation_date": 1500484188, "last_edit_date": 1500489761, "question_id": 45196944, "link": "https://stackoverflow.com/questions/45196944/how-can-i-fix-an-access-2010-you-cant-go-to-specified-record-error", "title": "How Can I fix An Access 2010 &quot;You Can&#39;t go to specified record&quot; Error", "body": "<p>I have inherited an Access 2010 Database and have a problem with a form that stopped working after the backend was migrated to SQL server.</p>\n\n<p>The form is pretty simple it is a subform that opens and shows a grid for comments that have been entered. There is a \"Add New\" button on the form that should allow the user to insert a new comment. the code for that button looks like this:</p>\n\n<pre><code>Private Sub cmd_new_comment_Click()\nOn Error GoTo Err_cmd_new_comment_Click\n\nDoCmd.GoToRecord , , acNewRec\nDoCmd.GoToControl (\"com_date\")\nMe.ActiveControl = Now()\nDoCmd.GoToControl (\"com_comments\")\n\nExit_cmd_new_comment_Click:\nExit Sub\n\nErr_cmd_new_comment_Click:\nMsgBox Err.Description\nResume Exit_cmd_new_comment_Click\n\nEnd Sub\n</code></pre>\n\n<p>When I click the \"Add New\" button I get the Error Message \"You Can't go the the specified record\".</p>\n\n<p>I believe the data is not the problem because when I open the comments form I can see all the previous comments it is only an issue when I want to add a new comment.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1500482841, "post_id": 45196468, "comment_id": 77360319, "body": "Private Sub Worksheet_Change(ByVal Target As Range)                             If Target.Column &lt;&gt; Columns(&quot;H&quot;).Column Then Exit Sub                   Select Case Target.Value2                                                                     Case 1, 5, 7: Target.Offset(0, 1).value = NextWorkday(Date,Target.Value2) End Select.                                                                                                End Sub"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1500484222, "post_id": 45196468, "comment_id": 77361207, "body": "it&#39;s not clear what you want ?  Are you getting any errors with this code ? Are you looking to do more ?"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1500485735, "post_id": 45196468, "comment_id": 77362030, "body": "Basically I would like to add to this code (that works alright)a couple of more option from my data validation drop down list &quot;No follow up&quot; and &quot;Follow up completed&quot; and make to these two option clear the content into next cell."}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1500491811, "post_id": 45196468, "comment_id": 77365584, "body": "Do you think is it still unclear?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500492507, "post_id": 45196468, "comment_id": 77365978, "body": "Just add another <code>Case</code> to your Worksheet_Change <code>Select</code> block."}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1500496846, "post_id": 45196468, "comment_id": 77368409, "body": "I have tried to add it but it doesn&#39;t work. I don&#39;t know why."}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1500496945, "post_id": 45196468, "comment_id": 77368473, "body": "Would like please to show me how? Thanks"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1500537014, "post_id": 45196468, "comment_id": 77383068, "body": "Private Sub Worksheet_Change(ByVal Target As Range)  If Target.Column &lt;&gt; Columns(&quot;H&quot;).Column Then Exit Sub   Select Case Target.Value2     Case 1, 3, 7: Target.Offset(0, 1).Value = NextWorkday(Date, Target.Value2)     Case &quot;No Follow up&quot;: Target.Offset(0, 1).ClearContents     Case &quot;Follow up completed&quot;: Target.Offset(0, 1).ClearContents   End Select End Sub"}], "owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500491622, "creation_date": 1500482789, "last_edit_date": 1531164843, "question_id": 45196468, "link": "https://stackoverflow.com/questions/45196468/clear-adjacent-cell-content-based-on-data-validation-drop-down-list-value", "title": "Clear adjacent cell content based on data validation drop down list value", "body": "<p>Please can you help me to clear content next to target column with data validation value \"No follow up\" and \"Follow up completed\". The following code helps me to set up next follow up date in the cells next to target value column H by choosing a data validation option (Case 1, case 5, case 7). Basically I would like to add to this code a couple of more option from my data validation drop down list \"No follow up\" and \"Follow up completed\" and make to these two option clear the content into next cell. </p>\n\n<p>I hope it's clear my question related this two new option I would like operating in this code.</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Range)\n\n If Target.Column &lt;&gt; Columns(\"H\").Column Then Exit Sub\n Select Case Target.Value2\n     Case 1, 5, 7: Target.Offset(0, 1).value = NextWorkday(Date,Target.Value2)\n End Select\n\n End Sub\n\n Function NextWorkday(dtDate As Date, lngDaysToAdd As Long)\n    NextWorkday = dtDate + lngDaysToAdd\n    Select Case Weekday(NextWorkday, vbMonday)\n        Case 6: NextWorkday = NextWorkday + 2\n        Case 7: NextWorkday = NextWorkday + 1\n    End Select\n End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500482038, "post_id": 45196167, "comment_id": 77359834, "body": "You cannot Evaluate a string of code like that in VBA.  Try <code>Application.Run</code> instead."}, {"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500482194, "post_id": 45196167, "comment_id": 77359925, "body": "With &#39;Application.Run&#39; it gives me Run-time error &#39;1004&#39; - &quot;Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500482260, "post_id": 45196167, "comment_id": 77359973, "body": "If you&#39;re having an issue with <code>Run</code> then maybe update your question with exactly how you tried it?"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1500482331, "post_id": 45196167, "comment_id": 77360019, "body": "@cydan - Have you added reference to Microsoft Visual Basic For Applications Extensibility 5.3 (Excel 2010)?"}, {"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "edited": false, "score": 0, "creation_date": 1500482541, "post_id": 45196167, "comment_id": 77360139, "body": "How do I add a reference to this? and I just used Run as I used Evaluate, the same way"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1500482617, "post_id": 45196167, "comment_id": 77360188, "body": "In VBA IDE, Tools-&gt;Reference"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1500482708, "post_id": 45196167, "comment_id": 77360240, "body": "@cydan Are your buttons Active X buttons or shapes?"}, {"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "edited": false, "score": 0, "creation_date": 1500482824, "post_id": 45196167, "comment_id": 77360308, "body": "The buttons are Active X. Now I added the reference for &quot;...Applications Extensibility&quot; and I get error code &#39;438&#39; when I try to run"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500482898, "post_id": 45196167, "comment_id": 77360358, "body": "You&#39;re doing <code>Run(S.Name + &quot;_Click&quot;)</code>, right?"}, {"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "edited": false, "score": 0, "creation_date": 1500482993, "post_id": 45196167, "comment_id": 77360428, "body": "Tried it by doing Run(S.Name + &quot;_Click&quot;), still didn&#39;t work"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 1, "creation_date": 1500484012, "post_id": 45196167, "comment_id": 77361090, "body": "It might not be seeing them because they&#39;re declared private. Try adding a public subroutine for each and alias them like <code>CommandButton1_Trigger</code>. All you need inside them is <code>Call CommandButton1_Click</code> since we&#39;re basically using them as a proxy to the private subroutines, which I believe need to be kept private or VBA might throw a fit."}, {"owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "edited": false, "score": 0, "creation_date": 1500484340, "post_id": 45196167, "comment_id": 77361291, "body": "The problem is, that I want to make a generic function that clicks the buttons without the knowledge of the buttons function names.. Maybe there&#39;s another way?"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1500486681, "post_id": 45196167, "comment_id": 77362620, "body": "Try qualifying your reference with the code name for the sheet <code>Application.Run Worksheets(1).CodeName &amp; &quot;.&quot; &amp; S.Name &amp; &quot;_Click&quot;</code>"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500487949, "post_id": 45196167, "comment_id": 77363304, "body": "<a href=\"https://www.mrexcel.com/forum/excel-questions/22555-can-visual-basic-applications-%22click%22-button.html#post2798876\" rel=\"nofollow noreferrer\">It looks like in order to click a button programmatically through VBA, you need to assign a boolean directly to the button object.</a> Maybe you can have the function loop through all the buttons and assign them <code>True</code>? Try assigning True to <code>s</code>. If that doesn&#39;t work, use a numeric index loop instead along with the <code>OLEObjects.Items</code> collection and assigning <code>True</code> that way. For example, <code>OLEObjects.Items(1) = True</code>."}], "answers": [{"tags": [], "owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "is_accepted": true, "score": 2, "last_activity_date": 1500495308, "last_edit_date": 1500495308, "creation_date": 1500489372, "answer_id": 45198543, "question_id": 45196167, "link": "https://stackoverflow.com/questions/45196167/vba-macro-that-clicks-all-the-buttons/45198543#45198543", "title": "VBA macro that clicks all the buttons", "body": "<p>See if this works.</p>\n\n<pre><code>For Each OLEObject In Worksheets(1).OLEObjects\n    If TypeName(OLEObject.Object) = \"CommandButton\" Then OLEObject.Object = True\nNext\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/oleobject-object-excel\" rel=\"nofollow noreferrer\">Here are some additional documentations on OLEObject.</a></p>\n"}], "owner": {"reputation": 615, "user_id": 7014046, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/429ecf4160e2c2a969c6f3f131328dd9?s=128&d=identicon&r=PG&f=1", "display_name": "cydan", "link": "https://stackoverflow.com/users/7014046/cydan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 45198543, "answer_count": 1, "score": 2, "last_activity_date": 1500495437, "creation_date": 1500481781, "last_edit_date": 1500495437, "question_id": 45196167, "link": "https://stackoverflow.com/questions/45196167/vba-macro-that-clicks-all-the-buttons", "title": "VBA macro that clicks all the buttons", "body": "<p>I'm trying to make a macro that clicks all the buttons in any document by getting all the buttons names and evaluating a call to these functions.</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nMsgBox \"b\"\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nMsgBox \"a\"\nEnd Sub\n\nSub test_macro()\nFor Each S In Worksheets(1).OLEObjects\n    Evaluate (\"Call \" + S.Name + \"_Click\")\nNext\nEnd Sub\n</code></pre>\n\n<p>What can be the problem here? and is there maybe another way to do it?</p>\n"}, {"tags": ["arrays", "vba", "excel", "powershell"], "answers": [{"tags": [], "owner": {"reputation": 9170, "user_id": 5039142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rm38D.png?s=128&g=1", "display_name": "G42", "link": "https://stackoverflow.com/users/5039142/g42"}, "is_accepted": true, "score": 1, "last_activity_date": 1500481904, "creation_date": 1500481904, "answer_id": 45196202, "question_id": 45196154, "link": "https://stackoverflow.com/questions/45196154/output-array-to-specific-worksheet-in-excel-uisng-powershell/45196202#45196202", "title": "Output Array to Specific Worksheet in Excel uisng PowerShell", "body": "<p>I believe the error is caused by trying to index into one-based array used by Excel as if though it was zero-based:</p>\n\n<pre><code>for ($i = 0; $i -lt $OutArray.Length; $i++) {\n    $ExcelWorkSheet.Cells.Item(($i + 1), 1) = $OutArray[$i]\n} \n</code></pre>\n\n<p>Or, to avoid aggravating the fragile Excel COMObject:</p>\n\n<pre><code>for ($i = 1; $i -le $OutArray.Length; $i++) {\n    $ExcelWorkSheet.Cells.Item($i, 1) = $OutArray[$i-1]\n} \n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6788153, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5edef93f94d540ca74bd99e5b5cbb86a?s=128&d=identicon&r=PG&f=1", "display_name": "boppa", "link": "https://stackoverflow.com/users/6788153/boppa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 45196202, "answer_count": 1, "score": -1, "last_activity_date": 1500481904, "creation_date": 1500481744, "question_id": 45196154, "link": "https://stackoverflow.com/questions/45196154/output-array-to-specific-worksheet-in-excel-uisng-powershell", "title": "Output Array to Specific Worksheet in Excel uisng PowerShell", "body": "<p>I have an array in PowerShell called \"$OutArray\"\nThe array is filled with multiple emails that I need to output into each cell in Excel in the very first column.  The sheet is labeled \"Reporters\".  </p>\n\n<p>I use the following for loop to try to output each item in the array:</p>\n\n<pre><code>$Excel = New-Object -ComObject Excel.Application\n$ExcelWorkBook = $Excel.Workbooks.Open($excel_file_path)\n$ExcelWorkSheet = $Excel.WorkSheets.Item(\"Reporters\")\n$ExcelWorkSheet.activate()\n\nfor ($i = 0; $i -lt $OutArray.Length; $i++) {\n    $ExcelWorkSheet.Cells.Item($i, 1) = $OutArray[$i]\n} \n</code></pre>\n\n<p>Btw, $excel_file_path is already declared properly.</p>\n\n<p>However, I receive the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Gp1ki.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gp1ki.png\" alt=\"PowerShell Error\"></a></p>\n\n<p>I was able to output the array in a new workbook by the following command:</p>\n\n<pre><code>$OutArray | out-file \"C:\\desiredPathHere\"\n</code></pre>\n\n<p>but I'm trying to append to an existing workbook in a new sheet.</p>\n\n<p>Any hints?</p>\n\n<p>Thanks everyone.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2179, "user_id": 2630666, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VIN5F.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2630666/matt"}, "edited": false, "score": 1, "creation_date": 1500483990, "post_id": 45196020, "comment_id": 77361076, "body": "What have you tried?  Show examples of your effort and say why it failed."}], "answers": [{"tags": [], "owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "is_accepted": false, "score": 0, "last_activity_date": 1500492919, "last_edit_date": 1500492919, "creation_date": 1500481473, "answer_id": 45196075, "question_id": 45196020, "link": "https://stackoverflow.com/questions/45196020/what-expression-to-use-to-capture-middle-part-of-a-string/45196075#45196075", "title": "What expression to use to capture middle part of a string", "body": "<p>If you know the string will always contain <code>\"background:url(</code> in the beginning and <code>)\"</code> at the end, you can just use <code>Mid$(message1, 17, Len(message1) - 18)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1500482165, "creation_date": 1500482165, "answer_id": 45196272, "question_id": 45196020, "link": "https://stackoverflow.com/questions/45196020/what-expression-to-use-to-capture-middle-part-of-a-string/45196272#45196272", "title": "What expression to use to capture middle part of a string", "body": "<pre><code>Dim s\n\ns = Split(strMessage, \":url(\")(1)\ns = Left(s, Len(s)-2)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8332960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3106b44a108c05acffbf6bed71162dd?s=128&d=identicon&r=PG&f=1", "display_name": "Basis Morse", "link": "https://stackoverflow.com/users/8332960/basis-morse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1500550814, "creation_date": 1500481245, "last_edit_date": 1500550814, "question_id": 45196020, "link": "https://stackoverflow.com/questions/45196020/what-expression-to-use-to-capture-middle-part-of-a-string", "title": "What expression to use to capture middle part of a string", "body": "<p>Beginner here. 2nd day into VB.</p>\n\n<p>How do I capture the middle part of the string below? What method (Split, Contains, Trim, eg) to use? </p>\n\n<p>Variable string message1: </p>\n\n<blockquote>\n  <p>\"background:url(//test.image.com/bao/uploaded/i2/1951211594/TB2m1gjzYlmpuFjSZFl>XXbdQXXa_!!1951211594.jpg_40x40q90.jpg)\"</p>\n</blockquote>\n\n<p>To become:</p>\n\n<blockquote>\n  <p>//test.image.com/bao/uploaded/i2/1951211594/TB2m1gjzYlmpuFjSZFlXXbdQXXa_!!19512>11594.jpg</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 161, "user_id": 3409525, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af2fd856978621577364a79d83d22ba3?s=128&d=identicon&r=PG&f=1", "display_name": "Yoav24", "link": "https://stackoverflow.com/users/3409525/yoav24"}, "edited": false, "score": 0, "creation_date": 1500481177, "post_id": 45195868, "comment_id": 77359348, "body": "try the Record Macro button and see how the copy-paste code is different than yours. It&#39;s a very finicky syntax sometimes."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1500481353, "post_id": 45195868, "comment_id": 77359445, "body": "Keep in mind that <code>ThisWorkbook</code> will not have a path if it&#39;s a new Workbook and that will cause the code to fail too. You may want to include a check to make sure it has a path."}], "answers": [{"tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 3, "last_activity_date": 1500481587, "creation_date": 1500481587, "answer_id": 45196115, "question_id": 45195868, "link": "https://stackoverflow.com/questions/45195868/paste-special-error-1004-pastespecial-method-of-range-class-failed/45196115#45196115", "title": "Paste Special error 1004 PasteSpecial method of Range class failed", "body": "<p>If you try exactly the steps in the code manually, you will find it also fails.  The issue is that inbetween copying the cells and trying to paste them, you are creating a new workbook and saving it.  This cancels copy/paste mode (i.e. the \"marching ants\" around the copied range disappear), so there is nothing to paste.</p>\n\n<p>The solution is to not use <code>Selection</code> at all.  In general any time you find yourself writing <code>.Select</code> in VBA you're doing it wrong (see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this question</a> for detail).  Here is how I would re-write your code:</p>\n\n<pre><code>Dim wk As Workbook\n\nSet wk = Workbooks.Add\nwk.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; \"Budget.xlsx\"\n\nThisWorkbook.Range(\"B3\").CurrentRegion.Copy\nwk.Worksheets(\"Sheet1\").Range(\"B3\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1500495327, "post_id": 45196194, "comment_id": 77367552, "body": "And, of course, get rid of the copy/paste with <code>wk.Worksheets(&quot;Sheet1&quot;).Range(&quot;B3&quot;).Resize(LastRow - 2, LastCol - 1).Value = .Range(&quot;B3&quot;).Resize(LastRow - 2, LastCol - 1).Value</code> ?  ;-)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1500481859, "creation_date": 1500481859, "answer_id": 45196194, "question_id": 45195868, "link": "https://stackoverflow.com/questions/45195868/paste-special-error-1004-pastespecial-method-of-range-class-failed/45196194#45196194", "title": "Paste Special error 1004 PasteSpecial method of Range class failed", "body": "<p>Try the code below (explanation inside the code as comments):</p>\n\n<pre><code>Dim wk As Workbook\nSet wk = Workbooks.Add\n\nwk.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; \"Budget.xlsx\"\nwk.Activate\nwk.Unprotect\n\n' have the Copy&gt;&gt;Paste section together\nDim LastCol As Long\nDim LastRow As Long\n\n' you never mentioned which sheet to copy from, I used the first index\nWith ThisWorkbook.Sheets(1)\n    LastCol = .Range(\"B3\").End(xlToRight).Column\n    LastRow = .Range(\"B3\").End(xlDown).Row\n    .Range(\"B3\", .Cells(LastRow, LastCol)).Copy ' &lt;-- Copy without Select\nEnd With\n\n' Paste without Select\nwk.Worksheets(\"Sheet1\").Range(\"B3\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8332966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86f44e62af70d09f70fe91e488f8911?s=128&d=identicon&r=PG&f=1", "display_name": "Justtheintern", "link": "https://stackoverflow.com/users/8332966/justtheintern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17189, "favorite_count": 0, "accepted_answer_id": 45196194, "answer_count": 2, "score": 4, "last_activity_date": 1547478721, "creation_date": 1500480775, "last_edit_date": 1500495027, "question_id": 45195868, "link": "https://stackoverflow.com/questions/45195868/paste-special-error-1004-pastespecial-method-of-range-class-failed", "title": "Paste Special error 1004 PasteSpecial method of Range class failed", "body": "<p>I have looked thoroughly at the current answers for this problem and none of them have fixed mine.</p>\n\n<p>The operation is simply copying a selection of a sheet and copying to a new book called budget.</p>\n\n<p>Again I have tried multiple different ways of doing the same thing and none of them seem to change this error. The select method works,it only breaks when I try to paste.</p>\n\n<p>Code:</p>\n\n<pre><code>Range(\"B3\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n\nDim wk As Workbook\nSet wk = Workbooks.Add\n\nwk.SaveAs FileName:=ThisWorkbook.path &amp; \"\\\" &amp; \"Budget.xlsx\"\nwk.Activate\nwk.Unprotect\nwk.Worksheets(\"Sheet1\").Range(\"B3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "reporting-services", "ssrs-2008", "iif"], "comments": [{"owner": {"reputation": 4103, "user_id": 7673964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i7ljk.jpg?s=128&g=1", "display_name": "Lucky", "link": "https://stackoverflow.com/users/7673964/lucky"}, "edited": false, "score": 0, "creation_date": 1500485937, "post_id": 45195702, "comment_id": 77362160, "body": "Give this answer a try: <a href=\"https://stackoverflow.com/questions/17511151/isnothing-not-working-on-empty-value-in-report-builder\">StackOverflow</a>"}, {"owner": {"reputation": 176, "user_id": 7947734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ellX8qCnb7Q/AAAAAAAAAAI/AAAAAAAAIO4/Y7Kc7N3WsNo/photo.jpg?sz=128", "display_name": "erick barreat", "link": "https://stackoverflow.com/users/7947734/erick-barreat"}, "reply_to_user": {"reputation": 4103, "user_id": 7673964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i7ljk.jpg?s=128&g=1", "display_name": "Lucky", "link": "https://stackoverflow.com/users/7673964/lucky"}, "edited": false, "score": 0, "creation_date": 1500487040, "post_id": 45195702, "comment_id": 77362821, "body": "No luck on that thread"}, {"owner": {"reputation": 1334, "user_id": 4409117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/21e9w.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/4409117/daniel"}, "edited": false, "score": 1, "creation_date": 1500491369, "post_id": 45195702, "comment_id": 77365334, "body": "You said the ELSE condition on the main IIF works fine, so can you strip this down to just the single top level IIF and tell us if that still generates an error? actually I see now that you said you did already confirm that this works. Next question, in the case that CoOppId is NULL, are the other fields in that row NULL as well?"}, {"owner": {"reputation": 176, "user_id": 7947734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ellX8qCnb7Q/AAAAAAAAAAI/AAAAAAAAIO4/Y7Kc7N3WsNo/photo.jpg?sz=128", "display_name": "erick barreat", "link": "https://stackoverflow.com/users/7947734/erick-barreat"}, "edited": false, "score": 0, "creation_date": 1500497807, "post_id": 45195702, "comment_id": 77368912, "body": "No, I am simply checking to see if this field is null and then displaying the fields which should be populated if CoOppId is Null."}, {"owner": {"reputation": 8653, "user_id": 803019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b856f939f6a128a1353942ab7901ebce?s=128&d=identicon&r=PG", "display_name": "niktrs", "link": "https://stackoverflow.com/users/803019/niktrs"}, "edited": false, "score": 0, "creation_date": 1500531261, "post_id": 45195702, "comment_id": 77379384, "body": "I think that Daniel has a point. When CoOppId is Null, at least another one field in your expression is null and that is the reason for the #Error. Try using <code>COALESCE(fieldname,&#39;&#39;)</code>  in your SQL code for the rest of the string fields or <code>COALESCE(fieldname,0)</code> for numeric fields."}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 7947734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ellX8qCnb7Q/AAAAAAAAAAI/AAAAAAAAIO4/Y7Kc7N3WsNo/photo.jpg?sz=128", "display_name": "erick barreat", "link": "https://stackoverflow.com/users/7947734/erick-barreat"}, "edited": false, "score": 0, "creation_date": 1500497644, "post_id": 45199461, "comment_id": 77368831, "body": "This seems to be the right direction from my further research. I will attempt this and get back with you with my findings"}, {"owner": {"reputation": 8653, "user_id": 803019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b856f939f6a128a1353942ab7901ebce?s=128&d=identicon&r=PG", "display_name": "niktrs", "link": "https://stackoverflow.com/users/803019/niktrs"}, "edited": false, "score": 0, "creation_date": 1500543845, "post_id": 45199461, "comment_id": 77388146, "body": "Custom code would be a good workaround to avoid errors and also make your expression&#39;s easier to read"}, {"owner": {"reputation": 176, "user_id": 7947734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ellX8qCnb7Q/AAAAAAAAAAI/AAAAAAAAIO4/Y7Kc7N3WsNo/photo.jpg?sz=128", "display_name": "erick barreat", "link": "https://stackoverflow.com/users/7947734/erick-barreat"}, "edited": false, "score": 0, "creation_date": 1500931096, "post_id": 45199461, "comment_id": 77542847, "body": "Thank you Daniel for your great response. It seems you had the right Idea, But Jayvee&#39;s answer was the solution that made my scenario work. If I could mark both as answers I would."}], "tags": [], "owner": {"reputation": 1334, "user_id": 4409117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/21e9w.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/4409117/daniel"}, "is_accepted": false, "score": 2, "last_activity_date": 1500492592, "creation_date": 1500492592, "answer_id": 45199461, "question_id": 45195702, "link": "https://stackoverflow.com/questions/45195702/embedded-iif-states-in-ssrs/45199461#45199461", "title": "embedded IIF States in SSRS", "body": "<p>I'm going to take a guess that when your CoOppId value is NULL, that your other fields in that row are also NULL.  Because IIF does not utilize short circuit logic (it always evaluates both sides of the IIF), you are trying to evaluate the expression \"NULL.Contains(\"TX\")\" and that will generate an #ERROR because NULL is not a string and cannot be operated on with the CONTAINS function.</p>\n\n<p>There are two workarounds available for this scenario, neither of them particularly nice in my opinion, however: </p>\n\n<p>1) Use nested IIFs to ensure that nothing is ever invalid.  </p>\n\n<pre><code>IIF(expression is NULL \n, CompanyAddress\n, IIF(**IIF(expression is NULL, \"\", expression)** ='TX'\n    , IIF(BOOL=TRUE\n        ,CompanyAddress\n        , SWITCH(DEALER ADDRESSES))\n    ,CompanyAddress)\n)\n</code></pre>\n\n<p>Look at the pseudo code above and notice the additional nested IIF around the expression that is using the CONTAINS functionality.  If CoOppId doesn't exist, it substitutes in an empty string for the CONTAINS check. Even though this branch never shows it's value for the null scenario, it will at least be valid now.</p>\n\n<p>2) Create a code-behind function that actually does perform short circuit logic for you:</p>\n\n<pre><code>Public Function CheckForNull(ByVal CoOppId As String, ByVal Addr1 as String, ByVal UDFMake As String, ... all fields)\nIf String.IsNullOrEmpty(CoOppId) \n  Return \"Nothing\"\nElse\n  Return *** do your calculation with your fields here\nEnd If\nEnd Function \n</code></pre>\n\n<p>Which you utilize in your report like:</p>\n\n<pre><code>=Code.CheckForNull(values....)\n</code></pre>\n\n<p>I just roughly laid out how such a code behind function works, it's obviously not complete but should be enough to point you in the right direction.</p>\n"}, {"tags": [], "owner": {"reputation": 7173, "user_id": 2964963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cvLah.jpg?s=128&g=1", "display_name": "Jayvee", "link": "https://stackoverflow.com/users/2964963/jayvee"}, "is_accepted": true, "score": 2, "last_activity_date": 1500500213, "last_edit_date": 1500500213, "creation_date": 1500499179, "answer_id": 45201213, "question_id": 45195702, "link": "https://stackoverflow.com/questions/45195702/embedded-iif-states-in-ssrs/45201213#45201213", "title": "embedded IIF States in SSRS", "body": "<p>I agree with @Daniel, the error is most likely being produce by the <code>Fields!UDFMake.Value.Contains</code> when the value is null, as IIF does not short-circuit.\nAlternatively to the good options that @Daniel mentioned you can replace the contains method by the function InStr as:</p>\n\n<pre><code>... , Switch(\n            InStr(Fields!UDFMake.Value,\"Chevy\") &gt; 0\n            , \"Knapp Chevrolet\" + chr(10) + \"PO box \" + chr(10) + \"Houston TX 77210\" ...\n</code></pre>\n\n<p>this will not produce an error even when the value of the field is Null.</p>\n"}], "owner": {"reputation": 176, "user_id": 7947734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ellX8qCnb7Q/AAAAAAAAAAI/AAAAAAAAIO4/Y7Kc7N3WsNo/photo.jpg?sz=128", "display_name": "erick barreat", "link": "https://stackoverflow.com/users/7947734/erick-barreat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 45201213, "answer_count": 2, "score": 1, "last_activity_date": 1500500213, "creation_date": 1500480258, "question_id": 45195702, "link": "https://stackoverflow.com/questions/45195702/embedded-iif-states-in-ssrs", "title": "embedded IIF States in SSRS", "body": "<p>Thank you for taking your time to help me today. I am trying to use multiple if statements to control what value is displayed depending on whether each statement is true. So right now I have this below which is essentially:</p>\n\n<pre><code>IIF(expression = NULL\n, CompanyAddress\n, IIF(Expression='TX'\n    , IIF(BOOL=TRUE\n        ,CompanyAddress\n        , SWITCH(DEALER ADDRESSES))\n    ,CompanyAddress)\n)\n</code></pre>\n\n<p>I have tested each individual IIF statements separately and I get the outcomes which I expect. Currently in the first IIF statement and the Expression = NULL is TRUE , It just outputs #Error and not the \"Nothin\" OR in my real case Company Address. But if Expression = NULL is FAlSE, I do get the correct output of either the companyAddress or the Dealer. </p>\n\n<pre><code>=IIF(IsNothing(Fields!CoOppId.Value)\n,(\"nothin\")\n, (IIF(Fields!Addr1.Value.Contains(\"TX\")\n    , IIF(Fields!UDFCustProv.Value = 1\n        , Fields!Addr0.Value\n        , Switch(\n            Fields!UDFMake.Value.Contains(\"Chevy\")\n            , \"Knapp Chevrolet\" + chr(10) + \"PO box \" + chr(10) + \"Houston TX 77210\"\n            , Fields!UDFMake.Value.contains(\"Ford\") \n            , \"Sterling McCall Ford\" + chr(10) + \"6445 Southwest Freeway\" + chr(10) + \"Houston TX 77074\"\n            , Fields!UDFMake.Value.contains(\"International\")\n            , \"Pliler International\" + chr(10) + \"2016 S. Eastman Rd\" + chr(10) + \"Longview TX 75602\"\n            , Fields!UDFMake.Value.contains(\"Freightliner\")\n            , \"Houston Freightliner, Inc\" + chr(10) +\"9550 North Loop East\" + chr(10) + \"Houston TX 77029\"\n            , Fields!UDFMake.Value.contains(\"RAM\")\n            , \"Max Haik Dodge Chrysler Jeep\" +chr(10)+ \"11000 I-45 North Freeway\" + chr(10) + \"Houston TX 77037\")),Fields!Addr0.Value)))\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 1, "creation_date": 1500479352, "post_id": 45195345, "comment_id": 77358239, "body": "Try <code>Loop While repNames(i) &lt;&gt; vbNullString</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500480561, "post_id": 45195345, "comment_id": 77358999, "body": "@HaoZhang sure, but that creates an infinite loop (given the example data) which will error (Subscript out of Range) once i &gt; 9."}], "answers": [{"comments": [{"owner": {"reputation": 763, "user_id": 8251318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff7844182651142d95d26253f7aada4c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8251318/matthew"}, "edited": false, "score": 0, "creation_date": 1500480613, "post_id": 45195475, "comment_id": 77359045, "body": "I had no idea about the vbNullString. Thank you very much :)"}, {"owner": {"reputation": 6633, "user_id": 392025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac8fa292707d21768f9ebe17de4b523?s=128&d=identicon&r=PG", "display_name": "Aurel B&#237;l&#253;", "link": "https://stackoverflow.com/users/392025/aurel-b%c3%adl%c3%bd"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500480660, "post_id": 45195475, "comment_id": 77359067, "body": "@DavidZemens Why? I can see why it would if <code>x</code> were 9. But <code>x</code> is specified as strictly higher than the number of elements. I agree, there should be logic to handle this and all in all, I would use a <code>For Each</code> like in your answer."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500480791, "post_id": 45195475, "comment_id": 77359140, "body": "@AurelB&#237;l&#253; huh? <code>repnames</code> is a base-1 array with an upper bound of 9. Why would <code>repnames(i)</code> fail when <code>i = 9</code>? It will certainly fail when <code>i = 10</code>, because 10 is a subscript out of range for that array with that upper-bound. <code>x</code> simply has nothing to do with this."}, {"owner": {"reputation": 6633, "user_id": 392025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac8fa292707d21768f9ebe17de4b523?s=128&d=identicon&r=PG", "display_name": "Aurel B&#237;l&#253;", "link": "https://stackoverflow.com/users/392025/aurel-b%c3%adl%c3%bd"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500487600, "post_id": 45195475, "comment_id": 77363122, "body": "@DavidZemens What? Base-1 array makes no sense, did you mean one-dimensional? <code>x</code> has something to do with this because in OP&#39;s question, he does <code>ReDim repNames(1 To x)</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500487685, "post_id": 45195475, "comment_id": 77363159, "body": "It <i>is</i> a base 1 array (lower bound == 1). I didn&#39;t notice (1 to x) though, so point taken. :)"}], "tags": [], "owner": {"reputation": 6633, "user_id": 392025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac8fa292707d21768f9ebe17de4b523?s=128&d=identicon&r=PG", "display_name": "Aurel B&#237;l&#253;", "link": "https://stackoverflow.com/users/392025/aurel-b%c3%adl%c3%bd"}, "is_accepted": false, "score": 1, "last_activity_date": 1500479564, "creation_date": 1500479564, "answer_id": 45195475, "question_id": 45195345, "link": "https://stackoverflow.com/questions/45195345/do-while-loop-vba-not-looping/45195475#45195475", "title": "Do-While loop (VBA) not looping", "body": "<p>Firstly, you should be comparing to <code>vbNullString</code>. This loops multiple times:</p>\n\n<pre><code>' Declare variables\nDim repNames() As String\nDim x As Integer\nDim i As Integer\n\n' Set data\nx = 25\nReDim repNames(1 To x)\nrepNames(1) = \"Ahern\"\nrepNames(2) = \"Castronovo\"\nrepNames(3) = \"Glick\"\nrepNames(4) = \"Fields\"\nrepNames(5) = \"Murphy\"\nrepNames(6) = \"Sleeter\"\nrepNames(7) = \"Vivian\"\nrepNames(8) = \"Walschot\"\nrepNames(9) = \"Wilson\"\n\n' Loop through items\ni = 1\nDo\n  Worksheets.Add.Name = repNames(i)\n  i = i + 2\nLoop While repNames(i) &lt;&gt; vbNullString\n</code></pre>\n\n<p>There is one more problem \u2013 why <code>i = i + 2</code> ? In your question you say you wanted the loop to execute 9 times, but using <code>i = i + 2</code> skips every other item. If you indeed want to loop through every item:</p>\n\n<pre><code>Do\n  Worksheets.Add.Name = repNames(i)\n  i = i + 1\nLoop While repNames(i) &lt;&gt; vbNullString\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 763, "user_id": 8251318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff7844182651142d95d26253f7aada4c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8251318/matthew"}, "edited": false, "score": 0, "creation_date": 1500480579, "post_id": 45195517, "comment_id": 77359016, "body": "Awesome man, thanks so much. I program in java as well &amp; typically would do a null test. Now I know thats discouraged in VBA!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 763, "user_id": 8251318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff7844182651142d95d26253f7aada4c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8251318/matthew"}, "edited": false, "score": 0, "creation_date": 1500480869, "post_id": 45195517, "comment_id": 77359179, "body": "@Matthew it&#39;s not discouraged, it just means something else in the VBA environment and it would be usually rare to check for <code>Null</code> under most circumstances unless I think if you&#39;re dealing with database nulls/NaNs etc."}], "tags": [], "owner": {"reputation": 357, "user_id": 8053975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c700e5609f9cbe458f009d9e00092549?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Juneau", "link": "https://stackoverflow.com/users/8053975/robert-juneau"}, "is_accepted": false, "score": 1, "last_activity_date": 1500479678, "creation_date": 1500479678, "answer_id": 45195517, "question_id": 45195345, "link": "https://stackoverflow.com/questions/45195345/do-while-loop-vba-not-looping/45195517#45195517", "title": "Do-While loop (VBA) not looping", "body": "<p>Here you go, I have changed the loop conditional, and changed <code>i=i+2</code> to <code>i=i+1</code>. A regular while loop would be better than a do while encase the first element is empty</p>\n\n<pre><code>Dim repNames()\nDim x As Integer\nx = 25\nReDim repNames(1 To x)\n\nrepNames(1) = \"Ahern\"\nrepNames(2) = \"Castronovo\"\nrepNames(3) = \"Glick\"\nrepNames(4) = \"Fields\"\nrepNames(5) = \"Murphy\"\nrepNames(6) = \"Sleeter\"\nrepNames(7) = \"Vivian\"\nrepNames(8) = \"Walschot\"\nrepNames(9) = \"Wilson\"\n\nDim i As Integer\ni = 1\n\nDo While repNames(i) &lt;&gt; \"\"                   \n   Worksheets.Add.Name = repNames(i)\n    i = i + 1\n\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 763, "user_id": 8251318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff7844182651142d95d26253f7aada4c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8251318/matthew"}, "edited": false, "score": 0, "creation_date": 1500480671, "post_id": 45195608, "comment_id": 77359074, "body": "I did actually, but it says because my rep is below 15 my upvotes wont show :("}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1500480339, "last_edit_date": 1500480339, "creation_date": 1500479974, "answer_id": 45195608, "question_id": 45195345, "link": "https://stackoverflow.com/questions/45195345/do-while-loop-vba-not-looping/45195608#45195608", "title": "Do-While loop (VBA) not looping", "body": "<p>As others note, <code>Null</code> is not the comparison you want to make. Testing <em>anything</em> for equivalence with <code>Null</code> will return <code>Null</code> -- even <code>?Null = Null</code> returns <code>Null</code>, which is why your loop is exiting early. (Note: To test for a <code>Null</code>, you need to use the <code>IsNull</code> function which returns a boolean, but that is <strong>NOT</strong> how you test for an empty string.)</p>\n\n<p>In VBA, to test for a zero-length string or empty string, you can use either <code>\"\"</code> or <code>vbNullString</code> constant, or some people use the <code>Len</code> function to check for zero-length.</p>\n\n<p>Rectifying that error, as originally written in your code, your logical test should abort the loop if <em>any</em> item is an empty string, but none of the items are empty strings (at least not in the example data you've provided) so you end up with an infinite loop which will error once <code>i</code> exceeds the number of items in the <code>repNames</code> array.</p>\n\n<p>This would be probably better suited as a <code>For Each</code> loop. </p>\n\n<pre><code>Dim rep as Variant\nFor Each rep in repNames\n    Worksheets.Add.Name = rep\nNext\n</code></pre>\n\n<p>If you need to skip empty values, or duplicate values, you can add that logic as needed within the loop:</p>\n\n<pre><code>For Each rep in repNames\n    If rep &lt;&gt; vbNullString 'only process non-zero-length strings\n        Worksheets.Add.name = rep\n    End If\nNext\n</code></pre>\n\n<p>Etc.</p>\n"}], "owner": {"reputation": 763, "user_id": 8251318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff7844182651142d95d26253f7aada4c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8251318/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "accepted_answer_id": 45195608, "answer_count": 3, "score": 2, "last_activity_date": 1500487726, "creation_date": 1500479111, "last_edit_date": 1500487726, "question_id": 45195345, "link": "https://stackoverflow.com/questions/45195345/do-while-loop-vba-not-looping", "title": "Do-While loop (VBA) not looping", "body": "<p>so I thought this would be a simple logical problem, but for the life of me I cannot find the issue with this code block. I have checked around on Stack for a solution, but all other do/while loop problems appear to be primarily with other languages.</p>\n\n<p>What I am trying to do is simply loop through an array &amp; add a new worksheet for each element in the array that is not null. Pretty simple right? Yet for some reason it simply loops through once and thats it.</p>\n\n<p>Here is the code block:</p>\n\n<pre><code>Dim repNames() As String\nDim x As Integer\n    x = 25\n    ReDim repNames(1 To x)\n\n    repNames(1) = \"Ahern\"\n    repNames(2) = \"Castronovo\"\n    repNames(3) = \"Glick\"\n    repNames(4) = \"Fields\"\n    repNames(5) = \"Murphy\"\n    repNames(6) = \"Sleeter\"\n    repNames(7) = \"Vivian\"\n    repNames(8) = \"Walschot\"\n    repNames(9) = \"Wilson\"\n\n    Dim i As Integer\n    i = 1\n\n    Do                                          'Loop keeps creating only 1 new sheet. Should create 9.\n        Worksheets.Add.Name = repNames(i)\n        i = i + 2\n\n    Loop While repNames(i) &lt;&gt; Null\n</code></pre>\n\n<p>I believe the problem is with this line: <code>Loop While repNames(i) &lt;&gt; Null</code>,\nbut obviously the logical test seems to hold up.</p>\n\n<p>Any help would be hugely appreciated!</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1500484333, "post_id": 45196905, "comment_id": 77361283, "body": "You can still play with it to customize it more, but this will be the core"}, {"owner": {"reputation": 41, "user_id": 7696753, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6eaa15793ae29d031aed1b899c083214?s=128&d=identicon&r=PG&f=1", "display_name": "JKnight", "link": "https://stackoverflow.com/users/7696753/jknight"}, "edited": false, "score": 0, "creation_date": 1500488392, "post_id": 45196905, "comment_id": 77363563, "body": "This works perfectly except it links the active sheet to sheet1 instead of linking sheet1 to the active sheet"}, {"owner": {"reputation": 41, "user_id": 7696753, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6eaa15793ae29d031aed1b899c083214?s=128&d=identicon&r=PG&f=1", "display_name": "JKnight", "link": "https://stackoverflow.com/users/7696753/jknight"}, "edited": false, "score": 0, "creation_date": 1500489631, "post_id": 45196905, "comment_id": 77364290, "body": "I thought this would work: Set rng = Sheets(&quot;Sheet1&quot;).Range(&quot;A50&quot;).End(xlUp).Offset(1, 0)     rng.Hyperlinks.Add anchor:=rng, Address:=&quot;&quot;, SubAddress:=ThisWorkbook.ActiveSheet.Name &amp; &quot;!A1&quot;, TextToDisplay:=UserForm2.TextBox4.Value   But I&#39;m get a &quot;Reference is invalid&quot; error message."}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 2, "last_activity_date": 1500502357, "last_edit_date": 1500502357, "creation_date": 1500484094, "answer_id": 45196905, "question_id": 45195342, "link": "https://stackoverflow.com/questions/45195342/vba-add-anchor-hyperlink-to-active-sheet/45196905#45196905", "title": "VBA Add Anchor (Hyperlink) to Active Sheet", "body": "<pre><code>Sub CreateHLFromActiveSheetToSheet1()\n    Set Rng = ActiveSheet.Range(\"A50\").End(xlUp).Offset(1, 0)\n    ActiveSheet.Hyperlinks.Add anchor:=Rng, Address:=\"\", SubAddress:=Sheets(\"Sheet1\").Name &amp; \"!A1\", _\n        ScreenTip:=\"Click to go to Sheet1\", TextToDisplay:=\"Go To Sheet1\"\n\nEnd Sub\n\nSub CreateHLFromSheet1ToActiveSheet()\n    Set WS = Sheet1\n    Set Rng = WS.Range(\"A50\").End(xlUp).Offset(1, 0)\n    WS.Hyperlinks.Add anchor:=Rng, Address:=\"\", SubAddress:=ActiveSheet.Name &amp; \"!A1\", _\n        ScreenTip:=\"Click to go to Sheet1\", TextToDisplay:=\"Go To \" &amp; ActiveSheet.Name\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7696753, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6eaa15793ae29d031aed1b899c083214?s=128&d=identicon&r=PG&f=1", "display_name": "JKnight", "link": "https://stackoverflow.com/users/7696753/jknight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1500502357, "creation_date": 1500479098, "question_id": 45195342, "link": "https://stackoverflow.com/questions/45195342/vba-add-anchor-hyperlink-to-active-sheet", "title": "VBA Add Anchor (Hyperlink) to Active Sheet", "body": "<p>I'm trying to create a hyperlink from the active sheet to Sheet1. Everything works great except for the \"Address\" in the anchor tab. I'm not sure if I have the correct syntax for connecting the active sheet to sheet1. The active sheet will always have a different name each time, hence the reason for needing the syntax for the active sheet as apposed to giving it a specific name. </p>\n\n<p>Set rng = Sheets(\"Sheet1\").Range(\"A50\").End(xlUp).Offset(1, 0)\nrng.Hyperlinks.Add anchor:=rng, Address:=ThisWorkbook.ActiveSheet, TextToDisplay:=UserForm2.TextBox4.Value</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1500479249, "post_id": 45195142, "comment_id": 77358185, "body": "Try <code>If Not Intersect(KeyCells2, Target) Is Nothing Then</code> instead. Also, you can change <code>Rows(Row).EntireRow.Delete Shift:=xlUp</code> to <code>Rows(Row).Delete Shift:=xlUp</code>"}, {"owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1500479430, "post_id": 45195142, "comment_id": 77358298, "body": "@ShaiRado that doesn&#39;t seem to help. I still obtain the same error. I have a feeling <code>Range(Target.Address)</code> is not getting the value is should some how."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1500479496, "post_id": 45195142, "comment_id": 77358334, "body": "you don&#39;t need to use <code>Range(Target.Address)</code> since <code>Target</code> is already defined as <code>Range</code>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1500482734, "creation_date": 1500482734, "answer_id": 45196450, "question_id": 45195142, "link": "https://stackoverflow.com/questions/45195142/run-time-error-424-while-checking-change-events/45196450#45196450", "title": "run-time error 424 while checking change events", "body": "<p>If you delete the row in the first <code>If</code> block then <code>Target</code> no longer exists, so you can't use it in your second <code>If</code> block.</p>\n\n<p>As a fix you could exit the Sub after deleting the row.</p>\n\n<p>P.S. - that \"auto-sort\" seems like it would be pretty annoying if you're trying to edit data...</p>\n"}], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500482734, "creation_date": 1500478541, "last_edit_date": 1531164843, "question_id": 45195142, "link": "https://stackoverflow.com/questions/45195142/run-time-error-424-while-checking-change-events", "title": "run-time error 424 while checking change events", "body": "<p>I have created a program which looks for items in Column A or Column I to change. If column I changes, it deletes and moves the row to a new sheet. If Column A changes, it should sort all of the data. However, when the second <code>Application.Intersect(KeyCells2, Range(Target.Address))</code> is called, it errors out telling me I have a run-time error 424. Why is this happening? It seems to have both a key cells range and a target.address.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Dim KeyCells2 As Range\n    Dim LastRowCompleted As Long\n    Dim RowToDelete As Long\n    Dim CurCell As String\n    RowToDelete = 0\n    LastRow = Sheets(\"Current\").Cells(Sheets(\"Current\").Rows.Count, \"A\").End(xlUp).Row\n    LastRowCompleted = Sheets(\"completed\").Cells(Sheets(\"completed\").Rows.Count, \"A\").End(xlUp).Row\n    LastRowCompleted = LastRowCompleted + 1 'Next row after last row\n    Set KeyCells = Range(\"I3:I16384\")\n    Set KeyCells2 = Range(\"A3:A16384\")\n    CurCell = ActiveCell.Address\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n        Application.EnableEvents = False\n\n        'Cut and Paste Row\n        Target.EntireRow.Copy Sheets(\"completed\").Range(LastRowCompleted &amp; \":\" &amp; LastRowCompleted)\n        'Mark to delete row\n        RowToDelete = Target.EntireRow.Row\n\n        Call DeleteRow(RowToDelete)\n\n    Application.EnableEvents = True\n\n    End If\n\n    Range(CurCell).Select\n\n    If Not Application.Intersect(KeyCells2, Range(Target.Address)) Is Nothing Then\n        Application.EnableEvents = False\n\n                'Sort\nMsgBox \"lastrow completed: \" &amp; LastRow\n        Range(\"A3:Z\" &amp; LastRow).Select\n    ActiveWorkbook.Worksheets(\"current\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"current\").Sort.SortFields.Add Key:=Range(\"A3:A\" &amp; LastRow) _\n        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    ActiveWorkbook.Worksheets(\"current\").Sort.SortFields.Add Key:=Range(\"B3:B\" &amp; LastRow) _\n        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    ActiveWorkbook.Worksheets(\"current\").Sort.SortFields.Add Key:=Range(\"E3:E\" &amp; LastRow) _\n        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"current\").Sort\n        .SetRange Range(\"A3:J\" &amp; LastRow)\n        .Header = xlGuess\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Range(CurCell).Select\n\n    Application.EnableEvents = True\n\n    End If\n\nEnd Sub\n\nSub DeleteRow(Row As Long)\n    If Row &gt; 0 Then\n        Rows(Row).EntireRow.Delete Shift:=xlUp\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "printing", "vba"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "edited": false, "score": 0, "creation_date": 1500482815, "post_id": 45195471, "comment_id": 77360300, "body": "This looks like it will work. So this is what shows up as the name: &quot;ScanSoft PDF Create! on Ne00:&quot;. Any idea if this will change from computer to computer. What is the Ne00, another printer came up as Ne03. I am working on an application that will be used by a wide range of computers.  And is there a way to loop through all the printers and just capture the name of one that has the word &#39;pdf&#39; in it?"}, {"owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "edited": false, "score": 0, "creation_date": 1500498178, "post_id": 45195471, "comment_id": 77369102, "body": "Found this to loop through printers. <a href=\"http://www.cpearson.com/excel/GetPrinters.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/GetPrinters.aspx</a>"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1500479533, "creation_date": 1500479533, "answer_id": 45195471, "question_id": 45195042, "link": "https://stackoverflow.com/questions/45195042/print-to-pdf-not-save-as-pdf-in-excel/45195471#45195471", "title": "Print to PDF (Not save as PDF) in Excel", "body": "<p>You just need to set your activeprinter to the pdf printer</p>\n\n<pre><code> Application.ActivePrinter =\"what ever your printer is called\"\n</code></pre>\n\n<p>To find out what it's called, set it as the activeprinter manually and then in the immediate window just type</p>\n\n<pre><code> ? Application.ActivePrinter\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 45195471, "answer_count": 1, "score": 0, "last_activity_date": 1500479533, "creation_date": 1500478279, "last_edit_date": 1531161705, "question_id": 45195042, "link": "https://stackoverflow.com/questions/45195042/print-to-pdf-not-save-as-pdf-in-excel", "title": "Print to PDF (Not save as PDF) in Excel", "body": "<p>I was wondering if there is a way to print to pdf. My company has a software installed as a printer (ScanSoft pdf). The reason I need to print as a pdf and not save is as follows:</p>\n\n<ul>\n<li>My default printer can only print letter documents. I have few routines that format the excel document that I am working on to a tabloid document. And the since I my default printer can't support 11x17 (Tabloid). The page breaks are defaulted to letter document settings. And the tabloid is not an option in the size options. If I go and select the print and select a pdf and exit the print dialogue without saving - the page breaks are converted to the tabloid settings. I have another routine that runs through the document and adjusts the page breaks to avoid splitting merged cells.</li>\n</ul>\n\n<p>What I am looking for at end of the day, run the routine to format document, run a routine to print as pdf then exit dialogue (to adjust page breaks), run routine to adjust page breaks, run routine to save pdf.</p>\n\n<p><a href=\"https://superuser.com/questions/893023/excel-vba-is-there-a-command-for-printing-to-pdf-dopdf-ver-7\">enter link description here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1500483970, "post_id": 45195013, "comment_id": 77361061, "body": "I am not completely clear on the process. Where is this macro residing? In <i>MaskLevels.xlsx</i>? If so, then why are you opening itself  and you want to dynamically change this to any workbook? If not, what is <i>MaskLevels.xlsx</i>?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1500484711, "post_id": 45195013, "comment_id": 77361473, "body": "Just explain what you want to do and let more experienced people help you with that, and of course you need to show that you have tried and failed, show the error you get"}, {"owner": {"reputation": 3, "user_id": 8297825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb293ba1de48f4213a4af0d834f261aa?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Guzman", "link": "https://stackoverflow.com/users/8297825/nicolas-guzman"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1500488813, "post_id": 45195013, "comment_id": 77363827, "body": "@Parfait MaskLevels.xlsx is the closed workbook that I would like to get my information from. I would like to paste the information into the workbook I ran the macro from whether it is Workbook1.xls, Workbook2.xls, ALL WIP.xls, ect."}, {"owner": {"reputation": 3556, "user_id": 5300473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/88eaa2b57410990d33dfa1b9330b77ae?s=128&d=identicon&r=PG", "display_name": "Spitzbueb", "link": "https://stackoverflow.com/users/5300473/spitzbueb"}, "edited": false, "score": 0, "creation_date": 1500491126, "post_id": 45195013, "comment_id": 77365202, "body": "Try <code>x.Worksheets(&quot;Sheet1&quot;).Copy</code> and <code>y.Worksheets(&quot;All WIP&quot;).bla.bla.PasteSpecial</code>"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1500494837, "creation_date": 1500494837, "answer_id": 45200091, "question_id": 45195013, "link": "https://stackoverflow.com/questions/45195013/how-can-i-copy-and-paste-from-a-closed-workbook-to-the-active-workbook/45200091#45200091", "title": "How can I copy and paste from a closed workbook to the active workbook?", "body": "<p>If you want to copy from <code>MaskLevels.xlsx</code> into whatever workbook the macro is running from, try:</p>\n\n<pre><code>Sub AddMaskLevels()\n    Dim y As Workbook\n    Dim x As Workbook\n    Set y = ThisWorkbook\n    Set x = Workbooks.Open(\"MaskLevels.xlsx\")\n\n    x.Sheets(\"Sheet1\").Range(\"A1:A81\").Copy\n    y.Sheets(\"All WIP\").Columns(9).End(xlDown).Offset(1, 0).PasteSpecial\n    'Close the workbook (no need to save it - hopefully nothing was changed)\n    x.Close False\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you want to copy from <code>MaskLevels.xlsx</code> into whatever workbook is active when you run the macro, try:</p>\n\n<pre><code>Sub AddMaskLevels()\n    Dim y As Workbook\n    Dim x As Workbook\n    Set y = ActiveWorkbook\n    Set x = Workbooks.Open(\"MaskLevels.xlsx\")\n\n    x.Sheets(\"Sheet1\").Range(\"A1:A81\").Copy\n    y.Sheets(\"All WIP\").Columns(9).End(xlDown).Offset(1, 0).PasteSpecial\n    'Close the workbook (no need to save it - hopefully nothing was changed)\n    x.Close False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8297825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb293ba1de48f4213a4af0d834f261aa?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Guzman", "link": "https://stackoverflow.com/users/8297825/nicolas-guzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 45200091, "answer_count": 1, "score": 0, "last_activity_date": 1500868151, "creation_date": 1500478213, "last_edit_date": 1500868151, "question_id": 45195013, "link": "https://stackoverflow.com/questions/45195013/how-can-i-copy-and-paste-from-a-closed-workbook-to-the-active-workbook", "title": "How can I copy and paste from a closed workbook to the active workbook?", "body": "<p>I was able to make a program that opens the workbook that copies and pastes into a workbook that is called in this case \"ALL WIP\". However, to make this more convenient, I would like it so no matter which workbook you run this in, it will copy and paste into that specific workbook. Thanks.</p>\n\n<pre><code>Sub AddMaskLevels()\n\nDim book\n\nSet book = Workbooks.Open(\"MaskLevels.xlsx\")\n\nDim x As Workbook\n\nDim y As Workbook\n\nSet x = Workbooks(\"MaskLevels.xlsx\")'Where the information is copied from'\n\nSet y = Workbooks(\"ALL WIP.xlsm\")'I want to make this into the active workbook'\n\nx.Sheets(\"Sheet1\").Range(\"A1:A81\").Copy\n\ny.Sheets(\"All WIP\").Columns(9).End(xlDown).Offset(1, 0).PasteSpecial 'The Sheet and column will always stay the same'\n\nx.Save\n\nx.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1500540035, "creation_date": 1500540035, "answer_id": 45209641, "question_id": 45194968, "link": "https://stackoverflow.com/questions/45194968/how-to-insert-fields-within-headings/45209641#45209641", "title": "How to insert fields within headings", "body": "<p>Try moving the cursor one character into the header word.</p>\n\n<p>I also added a line for ensuring that the search starts at the beginning of the document.</p>\n\n<pre><code>Sub prepareDocForImport()\n\n    Dim headingText As String\n    Dim myfield As Field\n\n    'Moving to beginning of doc in case a different starting point is selected\n    Selection.HomeKey wdStory\n\n        With Selection.Find\n         .ClearFormatting\n         .Wrap = wdFindContinue\n         .Forward = True\n         .Format = True\n         .MatchWildcards = False\n         .Text = \"\"\n         .Style = ActiveDocument.Styles(\"Heading 1 \")\n         .Execute\n\n         While .Found\n\n             headingText = Selection.Range.Text\n             headingText = Replace(headingText, \" \", \"_\")\n             headingText = LCase(headingText)\n             Selection.Collapse Direction:=wdCollapseStart\n\n             'Move seleection one character into the header text\n             Selection.MoveRight Count:=1\n\n             Set myfield = ActiveDocument.Fields.Add(Range:=Selection.Range, _\n                                                     Type:=wdFieldEmpty, _\n                                                     Text:=\"PRIVATE:MADCAP:FILENAME&lt;\" &amp; headingText &amp; \"&gt;\", _\n                                                     PreserveFormatting:=True)\n             .Execute\n\n         Wend\n     End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8332620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35805cbd6e5b61c6d14ea50996cfce5?s=128&d=identicon&r=PG&f=1", "display_name": "user8332620", "link": "https://stackoverflow.com/users/8332620/user8332620"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500540035, "creation_date": 1500478103, "last_edit_date": 1500478850, "question_id": 45194968, "link": "https://stackoverflow.com/questions/45194968/how-to-insert-fields-within-headings", "title": "How to insert fields within headings", "body": "<p>I am trying to insert fields within the headings in a Word document, not before or after them. This is to prepare Word files for import to Madcap Flare which allows file names to be specified within a private Word field. The following code doesn't work because the field is appended before the start of the heading, it needs to be embedded within it. How can I do this. </p>\n\n<pre><code>Sub prepareDocForImport()\n    Dim headingText As String '  \n        With Selection.Find  \n         .ClearFormatting  \n         .Wrap = wdFindContinue  \n         .Forward = True  \n         .Format = True  \n         .MatchWildcards = False  \n         .Text = \"\"  \n         .Style = ActiveDocument.Styles(\"Heading 1 \")  \n         .Execute  \n         While .Found  \n             headingText = Selection.Range.Text  \n             headingText = Replace(headingText , \" \", \"_\")  \n             headingText = LCase(headingText )  \n             Selection.Collapse Direction:=wdCollapseStart  \n             Set myField = ActiveDocument.Fields.Add(Range:=Selection.Range, Type:=wdFieldEmpty, Text:=\"PRIVATE:MADCAP:FILENAME&lt;\" &amp; headingText &amp; \"&gt;\")  \n            .Execute  \n\n         Wend\n     End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "if-statement", "target"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1500477759, "post_id": 45194726, "comment_id": 77357063, "body": "I suggest you do not compare dates using Format, but using DateDiff."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1500477768, "post_id": 45194726, "comment_id": 77357071, "body": "Why do you use the <code>Select Case</code> when a simple <code>if</code>-statement would do?"}, {"owner": {"reputation": 11114, "user_id": 1712135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cErYR.png?s=128&g=1", "display_name": "deHaar", "link": "https://stackoverflow.com/users/1712135/dehaar"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1500477845, "post_id": 45194726, "comment_id": 77357128, "body": "Why are you using a <code>Select Case</code> for checking all 2 possible values of a boolean value? Just do something like <code>If IsDate(Target.Value) ... Else ... End Select</code>? @FunThomas you were faster\u2026"}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "edited": false, "score": 0, "creation_date": 1500478121, "post_id": 45194726, "comment_id": 77357354, "body": "I had a simple if in there before, but I re-worked it to a case to see if it made a difference,, much to my chagrin it did not"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1500478595, "last_edit_date": 1500478595, "creation_date": 1500478046, "answer_id": 45194953, "question_id": 45194726, "link": "https://stackoverflow.com/questions/45194726/vba-cant-figure-out-why-case-statement-isnt-workign-correctly/45194953#45194953", "title": "VBA can&#39;t figure out why Case statement isn&#39;t workign correctly", "body": "<p>You need to get the today's date with <code>Date</code>, not with <code>Now</code>. See the difference between these two:</p>\n\n<pre><code>Public Sub TestMe()\n    Debug.Print DateDiff(\"d\", Date, Now)\n    Debug.Print DateDiff(\"h\", Date, Now)\n    Debug.Print DateDiff(\"m\", Date, Now)\nEnd Sub\n</code></pre>\n\n<p>You do not need to Format a date, when you compare it. And depending on your date, you may need to do some additional adjustments: Thus try like this:</p>\n\n<pre><code>If DateSerial(year(target),Month(target),day(target)) &lt; Date Then\n</code></pre>\n\n<p>When VBA/Excel compares dates, it simply compares their long numbers. The format is used only for you to know how it is displayed.</p>\n\n<p>E.g., today's date is <code>42935</code>, yesterday was <code>42934</code>. You get this value by writing <code>?clng(Date)</code> in the immediate window.</p>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1500478949, "last_edit_date": 1500478949, "creation_date": 1500478608, "answer_id": 45195163, "question_id": 45194726, "link": "https://stackoverflow.com/questions/45194726/vba-cant-figure-out-why-case-statement-isnt-workign-correctly/45195163#45195163", "title": "VBA can&#39;t figure out why Case statement isn&#39;t workign correctly", "body": "<p>Just to illustrate the use of <a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/datediff-function\" rel=\"nofollow noreferrer\">DateDiff</a>:</p>\n\n<pre><code>If Not Intersect(Target, rng6) Is Nothing Then\n    Select Case IsDate(Target.value)\n    Case False\n        Target.NumberFormat = \"m/yyyy\"\n        Target = Empty\n    Case True\n        If DateDiff(\"m\", Target.value, Now) &gt; 0 Then\n            MsgBox \"Must not be less than\" &amp; vbLf &amp; \"current month &amp; year !\", vbExclamation, \"Warning..\"\n            Target.value = Format(Now, \"m/yyyy\")\n        Else\n            Target.NumberFormat = \"m/yyyy\"\n            MsgBox Format(Target.value, \"m/yyyy\") &amp; \"  \" &amp; Format(Now, \"m/yyyy\")\n        End If\n    End Select\nEnd If\n</code></pre>\n\n<p><code>DateDiff(\"m\", Target.value, Now)</code> will negative starting next month, 0 this month and positive before.</p>\n\n<p>Edit: Note that DateDiff with \"m\" doesn't care if you are using <code>Date</code>or <code>Now</code> (only checks for month/year)</p>\n"}], "owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 45194953, "answer_count": 2, "score": 1, "last_activity_date": 1500478949, "creation_date": 1500477439, "question_id": 45194726, "link": "https://stackoverflow.com/questions/45194726/vba-cant-figure-out-why-case-statement-isnt-workign-correctly", "title": "VBA can&#39;t figure out why Case statement isn&#39;t workign correctly", "body": "<p>I have this snippet of code in my Worksheet change event, but it's not firing like it should.</p>\n\n<pre><code>If Not Intersect(Target, rng6) Is Nothing Then\n\n        Select Case IsDate(Target.Value)\n        Case False\n        Target.NumberFormat = \"m/yyyy\"\n        Target = Empty\n        Case True\n\n            If Format(Target.Value, \"m/yyyy\") &lt; Format(Now, \"m/yyyy\") Then\n            MsgBox \"Must not be less than\" &amp; vbLf &amp; \"current month &amp; year !\", vbExclamation, \"Warning..\"\n            Target.Value = Format(Now, \"m/yyyy\")\n            Else\n            Target.NumberFormat = \"m/yyyy\"\n            MsgBox Format(Target.Value, \"m/yyyy\") &amp; \"  \" &amp; Format(Now, \"m/yyyy\")\n            End If\n\n        End Select\n\n    End If\n</code></pre>\n\n<p>The FALSE section is working properly, but when it gets to TRUE and runs through the if statement, it's returning only one or the other.</p>\n\n<p>For example, I test entering in 01/2017 and it returns the first part of the IF, but when I enter in 10/2017 it returns the first part ALSO and converts it to today's M/YYYY, instead of the second part which it should because the current m/yyyy is greater than today's m/yyy.</p>\n\n<p>Can anyone identify what the error is here?? I'm sure it's simple and the solution is right there/</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1500477307, "post_id": 45194658, "comment_id": 77356709, "body": "You can just set up an inbox rule to do that."}, {"owner": {"reputation": 1, "user_id": 8265972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1dd791addfe57bd2714cbd940f4d07?s=128&d=identicon&r=PG&f=1", "display_name": "Sean McAuley", "link": "https://stackoverflow.com/users/8265972/sean-mcauley"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1500477475, "post_id": 45194658, "comment_id": 77356837, "body": "Yes, but I&#39;ve been asked to set up a button with a macro behind it to do this?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8265972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1dd791addfe57bd2714cbd940f4d07?s=128&d=identicon&r=PG&f=1", "display_name": "Sean McAuley", "link": "https://stackoverflow.com/users/8265972/sean-mcauley"}, "edited": false, "score": 0, "creation_date": 1500478700, "post_id": 45194958, "comment_id": 77357805, "body": "Thanks, that&#39;s it running perfect."}], "tags": [], "owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "is_accepted": false, "score": 1, "last_activity_date": 1500478064, "creation_date": 1500478064, "answer_id": 45194958, "question_id": 45194658, "link": "https://stackoverflow.com/questions/45194658/outlook-vba-how-to-only-delete-emails-older-than-90-days/45194958#45194958", "title": "Outlook VBA, how to only delete emails older than 90 days", "body": "<p>You can add an If statement to compare the current date with the sent date of each email in the loop.</p>\n\n<p>Change the oItems For loop as follows:</p>\n\n<pre><code>For i = oItems.Count To 1 Step -1\n    If DateDiff(\"d\", oItems.Item(i).SentOn, Now) &gt; 90 Then\n        oItems.Item(i).Delete\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8265972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1dd791addfe57bd2714cbd940f4d07?s=128&d=identicon&r=PG&f=1", "display_name": "Sean McAuley", "link": "https://stackoverflow.com/users/8265972/sean-mcauley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500478064, "creation_date": 1500477229, "question_id": 45194658, "link": "https://stackoverflow.com/questions/45194658/outlook-vba-how-to-only-delete-emails-older-than-90-days", "title": "Outlook VBA, how to only delete emails older than 90 days", "body": "<p>I have got a piece of code that deletes all emails within a specific folder but I am needing it to only delete the emails that are older than 90 days and was hoping someone would be able to help me, I have listed the code down below;</p>\n\n<pre><code>Sub RemoveAllItemsAndFoldersInDeletedItems()\n    Dim oDeletedItems As Outlook.Folder\n    Dim oFolders As Outlook.Folders\n    Dim oItems As Outlook.Items\n    Dim i As Long\n    'Obtain a reference to deleted items folder\n    Set oDeletedItems = Application.Session.GetDefaultFolder(olFolderDrafts)\n    Set oItems = oDeletedItems.Items\n    For i = oItems.Count To 1 Step -1\n        oItems.Item(i).Delete\n    Next\n    Set oFolders = oDeletedItems.Folders\n    For i = oFolders.Count To 1 Step -1\n        oFolders.Item(i).Delete\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "variables", "declare"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 2, "last_activity_date": 1500477122, "creation_date": 1500477122, "answer_id": 45194613, "question_id": 45194548, "link": "https://stackoverflow.com/questions/45194548/vba-how-to-declare-cell-variable/45194613#45194613", "title": "VBA - How to declare &quot;Cell&quot; variable", "body": "<p>In your case, <code>cell</code> is a <code>range</code>, so </p>\n\n<pre><code>dim cell as range\n</code></pre>\n\n<p>And: <strong><em>Always</em></strong> use <code>Option Explicit</code></p>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1500477151, "creation_date": 1500477151, "answer_id": 45194625, "question_id": 45194548, "link": "https://stackoverflow.com/questions/45194548/vba-how-to-declare-cell-variable/45194625#45194625", "title": "VBA - How to declare &quot;Cell&quot; variable", "body": "<p>You can use <code>Range</code>. They are somewhat interchangeable.</p>\n"}, {"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1500477165, "creation_date": 1500477165, "answer_id": 45194630, "question_id": 45194548, "link": "https://stackoverflow.com/questions/45194548/vba-how-to-declare-cell-variable/45194630#45194630", "title": "VBA - How to declare &quot;Cell&quot; variable", "body": "<p>Walking over a Range yields a Range so <code>Dim Cell As Range</code></p>\n\n<p>If in doubt ask VBA: <code>msgbox TypeName(Cell)</code></p>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1500477802, "creation_date": 1500477802, "answer_id": 45194862, "question_id": 45194548, "link": "https://stackoverflow.com/questions/45194548/vba-how-to-declare-cell-variable/45194862#45194862", "title": "VBA - How to declare &quot;Cell&quot; variable", "body": "<p>Sorry but that is horrible code and it offends the eyes. Find would be better, but just in the interest of better understanding</p>\n\n<pre><code> Sub Test()\n Dim Cell as Range\n For Each Cell In Sheets(1).Range(\"J:J\")\n      If Cell.Value = \"131125\" Then\n          Cell.EntireRow.copy Destination:=Sheets(\"Sheet2\").range(\"a\" &amp; cell.row)\n          'You might want to exit here if there's only one value to find with \n          'Exit For\n      End If\n Next\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 13, "user_id": 8332589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3be0ed61bc0200768b0973f5142e8d9b?s=128&d=identicon&r=PG&f=1", "display_name": "Too many qs", "link": "https://stackoverflow.com/users/8332589/too-many-qs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12167, "favorite_count": 0, "accepted_answer_id": 45194613, "answer_count": 4, "score": 1, "last_activity_date": 1500477802, "creation_date": 1500476946, "question_id": 45194548, "link": "https://stackoverflow.com/questions/45194548/vba-how-to-declare-cell-variable", "title": "VBA - How to declare &quot;Cell&quot; variable", "body": "<p>Apologies for the potentially very easy to answer question. I was trawling through some code on the site regarding how you search for a row and paste it in another worksheet, the code being the one below:</p>\n\n<pre><code>Sub Test()\nFor Each Cell In Sheets(1).Range(\"J:J\")\n  If Cell.Value = \"131125\" Then\n    matchRow = Cell.Row\n    Rows(matchRow &amp; \":\" &amp; matchRow).Select\n    Selection.Copy\n\n    Sheets(\"Sheet2\").Select\n    ActiveSheet.Rows(matchRow).Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n  End If\nNext\nEnd Sub\n</code></pre>\n\n<p>I was wondering what the \"Cell\" should be declared as, as in:</p>\n\n<pre><code>Dim Cell As ...\n</code></pre>\n\n<p>I'm aware that without \"Option Explicit\", this is irrelevant, but I'm curious nonetheless, so please do help and explain if you can.</p>\n\n<p>Thank you for your help in advance :)</p>\n"}, {"tags": ["vba", "excel", "loops", "replace"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500475895, "post_id": 45194122, "comment_id": 77355554, "body": "Do you want to loop through all worksheets, but still only look at &quot;Acronyms&quot;   for the replacing value?"}, {"owner": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1500475997, "post_id": 45194122, "comment_id": 77355640, "body": "Not all, only a select few, namely: &quot;Bodywork_Internal&quot;, &quot;Bodywork_Lower&quot; &amp; &quot;Chassis&quot;. But yes - always looking at &quot;Acronyms&quot;"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1500476154, "post_id": 45194122, "comment_id": 77355779, "body": "Since it&#39;s specific worksheets, you can create a loop to go through an array of worksheet names (the names you&#39;ve given).  That would be the simplest, rather than looping through all and restricting a few sheets, imo."}, {"owner": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "edited": false, "score": 0, "creation_date": 1500476203, "post_id": 45194122, "comment_id": 77355831, "body": "Yes Cyril, but it&#39;s the code for the loop that I am struggling with"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1500476244, "post_id": 45194122, "comment_id": 77355878, "body": "I was just starting to draft an answer, though I will admit I&#39;m not the best at working with the arrays.  Will need it tested a bit."}, {"owner": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "edited": false, "score": 0, "creation_date": 1500476282, "post_id": 45194122, "comment_id": 77355913, "body": "OK thanks for your help"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "edited": false, "score": 0, "creation_date": 1500476515, "post_id": 45194313, "comment_id": 77356096, "body": "Hi Richard. Would this not then loop through all worksheets? I want to specify only the select few I have mentioned in the comment above."}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500476730, "post_id": 45194313, "comment_id": 77356267, "body": "How about <code>For Each wsName In Array(&quot;name1, &quot;name2&quot;)</code>, followed by <code>Set ws = ThisWorkbook.Worksheets(wsName)</code>?"}], "tags": [], "owner": {"reputation": 538, "user_id": 8216122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/usPm7.jpg?s=128&g=1", "display_name": "Richard Mneyan", "link": "https://stackoverflow.com/users/8216122/richard-mneyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1500478179, "last_edit_date": 1500478179, "creation_date": 1500476318, "answer_id": 45194313, "question_id": 45194122, "link": "https://stackoverflow.com/questions/45194122/modify-vba-code-for-find-and-replace-to-loop-through-multiple-worksheets/45194313#45194313", "title": "Modify VBA code for find and replace to loop through multiple Worksheets", "body": "<pre><code>Sub CommandButton2_Click()\n   Dim ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n        If InStr(0, ws.NAME, \"wsName1,wsName2,wsName3\") &gt; 0 Then ' wsName1,wsName2,wsName3 = worksheets that you wnat to process\n           ProcessYourWorksheet (ws)\n        End If\n    Next ws\nEnd Sub\n\nPrivate Sub ProcessYourWorksheet(Worksheet As ws)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "edited": false, "score": 0, "creation_date": 1500477106, "post_id": 45194431, "comment_id": 77356556, "body": "Have slightly updated to shorten a little. Please can you accept the answer - that&#39;s how the site works but you don&#39;t seem to have done it yet at all."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1500477069, "last_edit_date": 1500477069, "creation_date": 1500476623, "answer_id": 45194431, "question_id": 45194122, "link": "https://stackoverflow.com/questions/45194122/modify-vba-code-for-find-and-replace-to-loop-through-multiple-worksheets/45194431#45194431", "title": "Modify VBA code for find and replace to loop through multiple Worksheets", "body": "<p>Here is one approach, which uses Select Case so just list the sheets you want the macro to cover.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim wsR As Worksheet\nDim ws As Worksheet\nDim rng As Range, rngR As Range\nDim rngReplacement\nDim c As Range\nDim curVal As String\n\nSet wsR = ThisWorkbook.Sheets(\"Acronyms\")\n\nWith wsR\n    Set rngR = .Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\nEnd With\n\nFor Each ws In Worksheets\n    Select Case ws.Name\n        Case \"Bodywork_Internal\", \"Bodywork_Lower\", \"Chassis\"\n            With ws\n                Set rng = .Range(\"B10\", .Range(\"C\" &amp; .Rows.Count).End(xlUp))\n            End With\n            For Each c In rngR\n                curVal = c.Value\n                With rng\n                    .Replace curVal, c.Offset(0, 1).Value, xlWhole, , True\n                End With\n            Next c\n    End Select\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1500477193, "last_edit_date": 1500477193, "creation_date": 1500476838, "answer_id": 45194508, "question_id": 45194122, "link": "https://stackoverflow.com/questions/45194122/modify-vba-code-for-find-and-replace-to-loop-through-multiple-worksheets/45194508#45194508", "title": "Modify VBA code for find and replace to loop through multiple Worksheets", "body": "<p>Let's see if I can't struggle through this with you...</p>\n\n<pre><code>Dim i as integer, WSArray as String, LRA as Long, LR as Long\n\nLRA = Sheets(\"Acronym\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\nWSArray=Array(\"Front_Wing\",\"Bodywork_Internal\",\"Bodywork_Lower\",\"Chassis\")\n\nFor i = 1 to LR\n\nLR=Sheets(WSArray).Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'Edit#01, adding something for if statement:\nIf Sheets(WSArray).Cells(i,1).Value=Application.Index(\"A1:A\" &amp; LRA,Application.Match(Sheets(WSArray).Cells(i,1),Sheets(\"Acronym\").Range(\"A1:A\" &amp; LRA)) Then\n\n    Sheets(WSArray).Cells(i,1).Value=Application.Index(\"B1:B\" &amp; LRA,Application.Match(Sheets(WSArray).Cells(i,1),Sheets(\"Acronym\").Range(\"A1:A\" &amp; LRA))\n    Else\n    End If\n\nNext i\n</code></pre>\n\n<p>My best guess at specifying the multiple names for sheets. </p>\n"}, {"tags": [], "owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1500477089, "creation_date": 1500477089, "answer_id": 45194600, "question_id": 45194122, "link": "https://stackoverflow.com/questions/45194122/modify-vba-code-for-find-and-replace-to-loop-through-multiple-worksheets/45194600#45194600", "title": "Modify VBA code for find and replace to loop through multiple Worksheets", "body": "<pre><code>Assuming your code runs, this should iterate through the worksheets\nPrivate Sub CommandButton2_Click()\n\nDim wsR As Worksheet\nDim ws As Worksheet\nDim rng As Range, rngR As Range\nDim i As Long\nDim rngReplacement\nDim c As Range\nDim curVal As String\n'Since wsR is where you get your comparison values, declare it. \n\nSet wsR = ThisWorkbook.Sheets(\"Acronyms\")\n\n'This loop will go through each worksheet that is not \"Acronym\" the rest is the same code as yours. \n\nFor Each ws in Activeworkbook.worksheets\n\nif ws.name &lt;&gt; \"Acronyms\" then\ni = ws.Rows.Count\n\nWith wsR\n    Set rngR = .Range(\"A1\", .Range(\"A\" &amp; i).End(xlUp))\nEnd With\n\nWith ws\n    Set rng = ws.Range(\"B10\", ws.Range(\"C\" &amp; i).End(xlUp))\nEnd With\n\nFor Each c In rngR\n    curVal = c.Value\n\n    With rng\n    .Replace curVal, c.Offset(0, 1).Value, xlWhole, , True\nEnd With\n\nNext\nend if\n\nnext ws\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 0, "accepted_answer_id": 45194431, "answer_count": 4, "score": 0, "last_activity_date": 1500478179, "creation_date": 1500475786, "question_id": 45194122, "link": "https://stackoverflow.com/questions/45194122/modify-vba-code-for-find-and-replace-to-loop-through-multiple-worksheets", "title": "Modify VBA code for find and replace to loop through multiple Worksheets", "body": "<p>I have the following code for searching a range of cells in Worksheet called \"Front_Wing\". It will replace any cell value that matches a value in Worksheet called \"Acronyms\" Column A with the cell value in \"Acronyms\" Column B.</p>\n\n<p>I have multiple worksheets, not only \"Front_Wing\", so I would like to modify this code to loop through multiple worksheets.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim wsR As Worksheet\nDim wsData As Worksheet\nDim rng As Range, rngR As Range\nDim i As Long\nDim rngReplacement\nDim c As Range\nDim curVal As String\n\nSet ws = ThisWorkbook.Sheets(\"Front_Wing\")\nSet wsR = ThisWorkbook.Sheets(\"Acronyms\")\n\ni = ws.Rows.Count\n\nWith ws\n    Set rng = ws.Range(\"B10\", ws.Range(\"C\" &amp; i).End(xlUp))\nEnd With\n\nWith wsR\n    Set rngR = .Range(\"A1\", .Range(\"A\" &amp; i).End(xlUp))\nEnd With\n\n\nFor Each c In rngR\n    curVal = c.Value\n\n    With rng\n        .Replace curVal, c.Offset(0, 1).Value, xlWhole, , True\n\n    End With\n\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "oracle-sqldeveloper"], "comments": [{"owner": {"reputation": 1007, "user_id": 91218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/FiA6Z.jpg?s=128&g=1", "display_name": "Degan", "link": "https://stackoverflow.com/users/91218/degan"}, "edited": false, "score": 0, "creation_date": 1500476132, "post_id": 45193810, "comment_id": 77355752, "body": "Rather than having an entire query in the worksheet, it is more common to put the query in VBA or the connection, and retrieve values from the worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1500476424, "post_id": 45194099, "comment_id": 77356024, "body": "Or why not add the space in code?   SqlText = SqlText &amp; &quot; &quot; &amp; r.Text"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1500475738, "creation_date": 1500475738, "answer_id": 45194099, "question_id": 45193810, "link": "https://stackoverflow.com/questions/45193810/sql-query-in-vba-code-stored-in-several-cells-in-excel/45194099#45194099", "title": "SQL query in VBA, code stored in several cells in Excel", "body": "<pre><code> Dim SqlText as String\n Dim r as range\n For each r in Range(\"A1:A62\")\n      SqlText = SqlText &amp; r.Text\n  Next r\n  Set rs = conn.Execute(sqlText)\n</code></pre>\n\n<p>Just be careful to start each line of text from A2 to A62 with a space to ensure the lines remain seperate when concatenated</p>\n"}, {"tags": [], "owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "is_accepted": false, "score": 0, "last_activity_date": 1500476783, "last_edit_date": 1500476783, "creation_date": 1500476447, "answer_id": 45194367, "question_id": 45193810, "link": "https://stackoverflow.com/questions/45193810/sql-query-in-vba-code-stored-in-several-cells-in-excel/45194367#45194367", "title": "SQL query in VBA, code stored in several cells in Excel", "body": "<p>If you want to select only the non blank lines of the first row where you have your SQL query you could use something like this.</p>\n\n<p>This has the benefit that you won't need to change the code once you add a line or two to your SQL query.</p>\n\n<pre><code>Public Function FirstRowAsString() As String\n\n    Dim variantValues() As Variant\n    Dim stringValue As String\n    Dim rowCounter As Long\n\n    range(\"A1\").Select\n    range(Selection, Selection.End(xlDown)).Select\n\n    variantValues = Selection.Value\n\n    For rowCounter = 1 To UBound(variantValues, 1) Step 1\n        stringValue = stringValue + \" \" + CStr(variantValues(rowCounter, 1))\n    Next rowCounter\n\n    FirstRowAsString = stringValue\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8306264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f3c9c27fd1577a3b5fcd682fb53e9b1?s=128&d=identicon&r=PG&f=1", "display_name": "NPN", "link": "https://stackoverflow.com/users/8306264/npn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 0, "accepted_answer_id": 45194099, "answer_count": 2, "score": 0, "last_activity_date": 1500476783, "creation_date": 1500474951, "last_edit_date": 1531164843, "question_id": 45193810, "link": "https://stackoverflow.com/questions/45193810/sql-query-in-vba-code-stored-in-several-cells-in-excel", "title": "SQL query in VBA, code stored in several cells in Excel", "body": "<p>I'm trying to write VBA code that allows user input (e.g change date) in Excel before retrieving data through SQL. The code works fine as long as I store the SQL query in a single cell. However, the SQL query includes 62 lines, so editing it inside a single cell is not optimal. </p>\n\n<p>I would like to split up the SQL code to 1 line per row in Excel, allowing for easier editing. The SQL code is currently stored in the \"SQL\" sheet, in cell \"A1\".</p>\n\n<p>Any ideas how to make this work with multiple rows/cells?</p>\n\n<pre><code>Sub ConnectSqlServer()\n\nDim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sConnString As String\n\n' Create the connection string.\nsConnString = \"Provider=OraOLEDB.Oracle;Data Source=xxxxxxx;User Id=xxxxxxx;Password=xxxxxxxxx;\"\n\n' Create the Connection and Recordset objects.\nSet conn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\n' Open the connection and execute.\nconn.Open sConnString\nSet rs = conn.Execute(Sheets(\"SQL\").Range(\"A1\"))\n\nFor intColIndex = 0 To rs.Fields.Count - 1\nSheets(\"Output\").Range(\"A1\").Offset(0, intColIndex).Value = rs.Fields(intColIndex).Name\nNext\n\n' Check we have data.\nIf Not rs.EOF Then\n    ' Transfer result.\n    Sheets(\"Output\").Range(\"A2\").CopyFromRecordset rs\n' Close the recordset\n    rs.Close\nElse\n    MsgBox \"Error: No records returned.\", vbCritical\nEnd If\n\n' Clean up\nIf CBool(conn.State And adStateOpen) Then conn.Close\nSet conn = Nothing\nSet rs = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "is_accepted": true, "score": 1, "last_activity_date": 1500475436, "creation_date": 1500475436, "answer_id": 45193998, "question_id": 45193718, "link": "https://stackoverflow.com/questions/45193718/i-want-my-code-to-return-random-names/45193998#45193998", "title": "I want my Code to Return Random Names", "body": "<pre><code>Private Sub CommandButton1_Click()\n    TextBox1.Text = Choose(WorksheetFunction.RandBetween(1, 3), \"Kwezi\", \"MAy\", \"FR\")\n    TextBox2.Text = Choose(WorksheetFunction.RandBetween(1, 3), \"Kwezi\", \"MAy\", \"FR\")\n    TextBox3.Text = Choose(WorksheetFunction.RandBetween(1, 3), \"Kwezi\", \"MAy\", \"FR\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 45193998, "answer_count": 1, "score": -3, "last_activity_date": 1500476272, "creation_date": 1500474688, "last_edit_date": 1531164843, "question_id": 45193718, "link": "https://stackoverflow.com/questions/45193718/i-want-my-code-to-return-random-names", "title": "I want my Code to Return Random Names", "body": "<p>Hi I want my code to return random names in the textboxes but it always gives me an error. here is my code :</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\n TextBox1.Text = Evaluate(Choose(RandBetween(1, 3), \"Kwezi\", \"MAy\", \"FR\"))\n TextBox2.Text = Evaluate(Choose(RandBetween(1, 3), \"Kwezi\", \"MAy\", \"FR\"))\n TextBox3.Text = Evaluate(Choose(RandBetween(1, 3), \"Kwezi\", \"MAy\", \"FR\"))\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox"], "comments": [{"owner": {"reputation": 53, "user_id": 8332216, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/329832528ff5ad2cf4e911b8013b2039?s=128&d=identicon&r=PG&f=1", "display_name": "M.Tailleur", "link": "https://stackoverflow.com/users/8332216/m-tailleur"}, "edited": false, "score": 0, "creation_date": 1500474798, "post_id": 45193605, "comment_id": 77354661, "body": "PS: I&#39;m working with non-active checkboxes"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500476897, "post_id": 45193605, "comment_id": 77356394, "body": "Are the checkboxes linked to any formulas/calculations?  You could try setting Calculation to manual while performing the update (don&#39;t forget to set back to automatic when done)"}, {"owner": {"reputation": 53, "user_id": 8332216, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/329832528ff5ad2cf4e911b8013b2039?s=128&d=identicon&r=PG&f=1", "display_name": "M.Tailleur", "link": "https://stackoverflow.com/users/8332216/m-tailleur"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500477359, "post_id": 45193605, "comment_id": 77356752, "body": "No the checkboxes are passive, they are just checked and that&#39;s all, I use them in another macro which detect whether they are checked or not after that"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500481589, "post_id": 45193605, "comment_id": 77359594, "body": "Just read your code again - you&#39;re looping over the checkboxes in two nested loops.  You shouldn&#39;t need to do that.  I will post an alternate approach, but can you describe exactly how the checkboxes are named, with a couple of examples?"}, {"owner": {"reputation": 53, "user_id": 8332216, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/329832528ff5ad2cf4e911b8013b2039?s=128&d=identicon&r=PG&f=1", "display_name": "M.Tailleur", "link": "https://stackoverflow.com/users/8332216/m-tailleur"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1500482411, "post_id": 45193605, "comment_id": 77360064, "body": "I found a solution but I don&#39;t know how to post it.."}], "owner": {"reputation": 53, "user_id": 8332216, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/329832528ff5ad2cf4e911b8013b2039?s=128&d=identicon&r=PG&f=1", "display_name": "M.Tailleur", "link": "https://stackoverflow.com/users/8332216/m-tailleur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1500474477, "creation_date": 1500474477, "question_id": 45193605, "link": "https://stackoverflow.com/questions/45193605/big-checkboxes-to-check-smallest-ones", "title": "Big CheckBoxes to Check Smallest Ones", "body": "<p>I am looking for a solution to my problem. I have this huge excel sheet (what is important here is that it is made of more than 700 rows), and I would like to make what I called \"big checkboxes\" to check \"little checkboxes\" <a href=\"https://i.stack.imgur.com/rNZE5.png\" rel=\"nofollow noreferrer\">click here to see a picture which explains it better</a>. </p>\n\n<p>The fact is that I have a huge amount of data and I can't know exactly how many little checkboxes will be linked to one big checkbox, so I have to make a macro to do the link for each checkbox. I have already written a macro which automatically create big and little checkboxes, so now I have just to create the link.</p>\n\n<p>I have created the \"link\" macro, and it works on a small spreadsheet. But on my 700-rows spreadsheet, it takes between 20 and 30 seconds for the program when I check a big checkbox to check the little checkboxes which are linked to it.</p>\n\n<p>I think that I am not doing it the right way: for exemple, to distinguish big checkboxes from little ones, I've named them CBX_\"range of cell where checkbox is\" instead of cbx__\"range of cell where checkbox is\". </p>\n\n<p>Please can you help me to make a faster program, really it shouldn't be complicated, it is just that I'm not really comfortable with the use of checkboxes.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub HideLinkedChkV3()\r\nApplication.ScreenUpdating = False\r\nDim bigchk As CheckBox\r\nDim chk As CheckBox\r\nDim lenrange As Integer\r\nDim diff As Long\r\nDim diff1 As Integer\r\nDim diff2 As Integer\r\nDim rgr_start As Integer\r\nDim rgr_end As Integer\r\n'rgr start and end are the rows where begin and end the little checkboxes\r\nDim rgc As Integer\r\n'rgc is the column where begin the little checkboxes\r\nrgr_start = 7\r\nrgr_end = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\r\nrgc = 2\r\nlenrange = Range(Cells(rgr_start, rgc), Cells(rgr_end, rgc)).Rows.Count\r\nFor Each bigchk In ActiveSheet.CheckBoxes\r\n'bigchk is a checkbox which checks multiple little checkboxes\r\nIf Left(bigchk.Name, 3) = \"CBX\" Then\r\n'here we're making sure that the checkbox is a big check\r\n    If bigchk.Value = Checked Then\r\n        For Each chk In ActiveSheet.CheckBoxes\r\n            diff1 = CInt(Right(chk.Name, Len(chk.Name) - 5))\r\n            diff2 = CInt(Right(bigchk.Name, Len(bigchk.Name) - 5))\r\n            diff = diff1 - diff2\r\n            If Left(chk.Name, 3) = \"cbx\" And diff &lt; lenrange And diff &gt;= 0 Then\r\n            'here we are making sure that the checkbox is a little checkbox and that it belongs to the big checkbox on its left\r\n                chk.Value = Checked\r\n            End If\r\n        Next chk\r\n    Else\r\n        For Each chk In ActiveSheet.CheckBoxes\r\n            diff1 = CInt(Right(chk.Name, Len(chk.Name) - 5))\r\n            diff2 = CInt(Right(bigchk.Name, Len(bigchk.Name) - 5))\r\n            diff = diff1 - diff2\r\n            If Left(chk.Name, 3) = \"cbx\" And diff &lt; lenrange And diff &gt;= 0 Then\r\n                chk.Value = Unchecked\r\n            End If\r\n        Next chk\r\n    End If\r\nEnd If\r\nNext bigchk\r\nApplication.ScreenUpdating = True\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500478391, "post_id": 45193436, "comment_id": 77357580, "body": "<a href=\"http://www.xtremevbtalk.com/-net-office-automation/296563-catch-excel-runtime-error-winform.html\" rel=\"nofollow noreferrer\">Here&#39;s an interesting read on how <code>Application.Run</code> works.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500474975, "post_id": 45193714, "comment_id": 77354812, "body": "Yeah, I was afraid of that. I need to call a routine using a variable string name. I would have used <code>CallByName</code> but this is in a normal module, not a class module. Guess the only way I could get around that is to build the error handling inside the called routine itself."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500475590, "post_id": 45193714, "comment_id": 77355287, "body": "@HaoZhang - it would work, if you put it the function/method in a class module. This looks like a good example for a singleton design pattern."}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500553554, "post_id": 45193714, "comment_id": 77395252, "body": "Is there a way to determine if a routine had been called using <code>Application.Run</code>? I want to at least be able to tell."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500553917, "post_id": 45193714, "comment_id": 77395543, "body": "@HaoZhang Put an optional boolean parameter in the routine and use it only when you call it via the standard calling. Thus, calling it by application run will not set it."}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500554358, "post_id": 45193714, "comment_id": 77395908, "body": "Hm, then I&#39;d have to add an additional parameter to many of my functions, which is not really a viable option for me. Also, I noticed that in the call stack, there is an entry called <code>[&lt;Non-Basic Code&gt;]</code> where the <code>Application.Run</code> call occurs. Not sure if I can somehow access it with the default Excel security settings (programmatic access to VB project untrusted)."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1500476392, "last_edit_date": 1500476392, "creation_date": 1500474691, "answer_id": 45193714, "question_id": 45193436, "link": "https://stackoverflow.com/questions/45193436/why-cant-i-trap-errors-that-occur-while-calling-a-routine-with-application-run/45193714#45193714", "title": "Why can&#39;t I trap errors that occur while calling a routine with Application.Run?", "body": "<p>That's true. However, try any of the other 2 methods as a workaround:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    On Error Resume Next\n\n    SomeRoutine 1, 1, 1\n    Call SomeRoutine(2, 2, 2)\n\n    Application.Run \"SomeRoutine\", 3, 3, 3\n\nEnd Sub\n\nPublic Sub SomeRoutine(a, b, c)\n\n    Debug.Print a\n    Debug.Print 5 / 0\n\nEnd Sub\n</code></pre>\n\n<p>With <code>Call</code> and w/o <code>Call</code> you may trap the errors neatly. With <code>Application.Run</code> - nope, because it is like an external call.</p>\n\n<p>In general, you may use the <em>Singleton design pattern</em> to create the <code>Sub SomeRoutine</code> in a class. Thus, you would be able to access it through <code>CallByName</code> like this:</p>\n\n<pre><code>Call CallByName(objSingleTonClass, \"SomeRoutine\", VbMethod, 5)\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1500476392, "creation_date": 1500474138, "last_edit_date": 1531164843, "question_id": 45193436, "link": "https://stackoverflow.com/questions/45193436/why-cant-i-trap-errors-that-occur-while-calling-a-routine-with-application-run", "title": "Why can&#39;t I trap errors that occur while calling a routine with Application.Run?", "body": "<p>It doesn't seem possible to trap errors when calling another routine using <code>Application.Run</code>.</p>\n\n<pre><code>Sub Test()\n    On Error Resume Next\n    Debug.Print Application.Run(\"SomeRoutine\", 1, 2, 3)\nEnd Sub\n</code></pre>\n\n<p>The run-time error dialog shows up anyway.</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1500474109, "post_id": 45193361, "comment_id": 77354091, "body": "I would use VBA in an excel workbook which can open and manipulate as many other workbooks as you like.  The integrated IDE will make things much easier."}, {"owner": {"reputation": 267, "user_id": 3979854, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/47d95f61a09525b38bfd840423e2b366?s=128&d=identicon&r=PG&f=1", "display_name": "MathsIsHard", "link": "https://stackoverflow.com/users/3979854/mathsishard"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1500477582, "post_id": 45193361, "comment_id": 77356925, "body": "@AlexK. Can I convert CSV files to XLSX in VBA?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1500477624, "post_id": 45193361, "comment_id": 77356960, "body": "Yes.  Easiest way is to start recording a macro, do it manually then look at the code it will generate."}], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 3979854, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/47d95f61a09525b38bfd840423e2b366?s=128&d=identicon&r=PG&f=1", "display_name": "MathsIsHard", "link": "https://stackoverflow.com/users/3979854/mathsishard"}, "edited": false, "score": 0, "creation_date": 1500474571, "post_id": 45193580, "comment_id": 77354469, "body": "Hi Mikhail, thanks for answering. I have already tried openpyxl (also xlsxwriter and others), my main problem is that I have around 1000~ CSV files and I have tried converting them with openpyxl (and others), it just takes an incredibly long time for it convert from csv---&gt;xlsx (around 5 minutes per file??) even when I use constant memory modes."}, {"owner": {"reputation": 85, "user_id": 6229350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z3a33.png?s=128&g=1", "display_name": "Mikhail Krassavin", "link": "https://stackoverflow.com/users/6229350/mikhail-krassavin"}, "reply_to_user": {"reputation": 267, "user_id": 3979854, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/47d95f61a09525b38bfd840423e2b366?s=128&d=identicon&r=PG&f=1", "display_name": "MathsIsHard", "link": "https://stackoverflow.com/users/3979854/mathsishard"}, "edited": false, "score": 0, "creation_date": 1500477797, "post_id": 45193580, "comment_id": 77357098, "body": "well, maybe an adaptation of this Go script will work for you <a href=\"https://github.com/tealeg/csv2xlsx\" rel=\"nofollow noreferrer\">github.com/tealeg/csv2xlsx</a>"}], "tags": [], "owner": {"reputation": 85, "user_id": 6229350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z3a33.png?s=128&g=1", "display_name": "Mikhail Krassavin", "link": "https://stackoverflow.com/users/6229350/mikhail-krassavin"}, "is_accepted": false, "score": 0, "last_activity_date": 1500474438, "creation_date": 1500474438, "answer_id": 45193580, "question_id": 45193361, "link": "https://stackoverflow.com/questions/45193361/vbs-or-vba-for-multiple-excel-files/45193580#45193580", "title": "VBS or VBA for Multiple Excel Files?", "body": "<p>I suggest you to use Python with the openpyxl package to implement your idea. The openpyxl package is <a href=\"http://openpyxl.readthedocs.io/en/default/usage.html\" rel=\"nofollow noreferrer\">intuitively easy to use</a>, while Python's flexibility will allow you to get the job done in short term.</p>\n"}], "owner": {"reputation": 267, "user_id": 3979854, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/47d95f61a09525b38bfd840423e2b366?s=128&d=identicon&r=PG&f=1", "display_name": "MathsIsHard", "link": "https://stackoverflow.com/users/3979854/mathsishard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500474623, "creation_date": 1500473967, "last_edit_date": 1500474623, "question_id": 45193361, "link": "https://stackoverflow.com/questions/45193361/vbs-or-vba-for-multiple-excel-files", "title": "VBS or VBA for Multiple Excel Files?", "body": "<p>Here is what I need to do:</p>\n\n<p>I have around 1000 folders, within each of these folders is an excel file that I need to reformat (all the excel files are similarly formatted), I imagine the actual programming part is quite easy but that is besides the point. If I need to run a script on each of these excel files, should I use VBA or VBS? </p>\n\n<p>As far as I understand, VBS can be run from the command line and doesn't require any Excel files to be open but VBA does require Excel to be open in order to run the script but that seems counter intuitive since I need to run a script on not just one workbook but a thousand. </p>\n\n<p>Any help will be appreciated.</p>\n\n<p>Many thanks.</p>\n\n<p>Edit: I should say explicitly, I am trying to convert around 1000 CSV files to XLSX, I have tried python packages such as OpenPYXL and XLSXwriter but they are just terribly slow - it takes around 5 minutes per file.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500474719, "post_id": 45193568, "comment_id": 77354591, "body": "With the new button, I&#39;m not actually adding a new sheet; I&#39;d just like to unhide an existing one."}, {"owner": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500474824, "post_id": 45193568, "comment_id": 77354679, "body": "The sequence of events is - Userform creates new sheet, which also contains a new button - clicking on new button will unhide an existing worksheet.  Thank you for the advice - I will try that, or a variation, in the userform code where I create the new button; hope I have understood correctly!"}], "tags": [], "owner": {"reputation": 1, "user_id": 7593529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a66c9669577fe7ec11758f228cb4acb?s=128&d=identicon&r=PG&f=1", "display_name": "atykhan", "link": "https://stackoverflow.com/users/7593529/atykhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1500474411, "creation_date": 1500474411, "answer_id": 45193568, "question_id": 45193332, "link": "https://stackoverflow.com/questions/45193332/vba-commandbutton-click-sub-when-the-worksheet-is-created-new-each-time/45193568#45193568", "title": "VBA - CommandButton Click sub - when the worksheet is created new each time", "body": "<p>As i understand you are trying to add new sheet with new button, i would recommend using non-dependent buttons with hyperlinks to run your module.</p>\n\n<p>Click insert shape - rectangle or so - and use  Selection.OnAction = \"YourWorkBook'!YOURSUB\"</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500479384, "post_id": 45195019, "comment_id": 77358256, "body": "Sorry, I&#39;m still a bit confused... the sheet that the button is on only comes into existence temporarily, so I don&#39;t think I can add anything into its module page?  (I&#39;m assuming that the sheet&#39;s module page would be that listed under Microsoft Excel Objects in the project - is that right?)"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500479746, "post_id": 45195019, "comment_id": 77358487, "body": "Yes. So When you create the button, you are doing something like       .OnAction = &quot;Fred&quot;"}, {"owner": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500479877, "post_id": 45195019, "comment_id": 77358575, "body": "Yep, I&#39;ve got ActiveSheet.CommandButton1.OnAction = &quot;ButtonForOriginal&quot; (&quot;ButtonForOriginal&quot; is the name of my sub).  The sub actually works in isolation, so I now think I&#39;m just not calling it correctly in this OnAction section.... hmm."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500480225, "post_id": 45195019, "comment_id": 77358798, "body": "Where is &quot;ButtonForOriginal&quot; - if you add a break does it get called correctly when you click on the button?"}, {"owner": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500480400, "post_id": 45195019, "comment_id": 77358896, "body": "It&#39;s in a separate standard module, Module1.  When I run it from there (i.e. just highlighting it and pressing play), it works - the correct changes are made to the workbook."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500480823, "post_id": 45195019, "comment_id": 77359155, "body": "You can add the name of the module to make it explicit .OnAction = &quot;Module1.ButtonForOriginal&quot;"}, {"owner": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "edited": false, "score": 0, "creation_date": 1500540812, "post_id": 45195019, "comment_id": 77385816, "body": "Hmm, that&#39;s still not working.  I&#39;m going to edit my original post to include the code I&#39;m using to create this button and to call the sub - if you (or anyone) would have a moment to look at it, that would be great."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1500478223, "creation_date": 1500478223, "answer_id": 45195019, "question_id": 45193332, "link": "https://stackoverflow.com/questions/45193332/vba-commandbutton-click-sub-when-the-worksheet-is-created-new-each-time/45195019#45195019", "title": "VBA - CommandButton Click sub - when the worksheet is created new each time", "body": "<p>\"CommandButton1_Click\" should be an Event Procedure. They go into the module page connected with the sheet that the object sits on. So when you click on it, it knows which procedure to run, it's the one connected to the sheet the button is on.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "is_accepted": true, "score": 0, "last_activity_date": 1500547312, "creation_date": 1500547312, "answer_id": 45212430, "question_id": 45193332, "link": "https://stackoverflow.com/questions/45193332/vba-commandbutton-click-sub-when-the-worksheet-is-created-new-each-time/45212430#45212430", "title": "VBA - CommandButton Click sub - when the worksheet is created new each time", "body": "<p>OK, I sort of figured it out.  I had for some reason decided to use an ActiveX command button, instead of a plain old Form one.  This seems to have made things more difficult.  I don't understand the detail, but I have achieved the effect I was after by doing this instead:</p>\n\n<pre><code>   ActiveSheet.Buttons.Add(1025, 130.5, 160, 400).Select\n       Selection.Characters.Text = \"Click here to see the original report\"\n    With Selection.Characters(Start:=1, Length:=200).Font\n        .Name = \"Verdana\"\n        .FontStyle = \"Regular\"\n        .Size = 10\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ColorIndex = 1\n    End With\n    Selection.OnAction = \"ButtonForOriginal\"\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7757481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213227f5c734a2c75be71669bc76ddc9?s=128&d=identicon&r=PG&f=1", "display_name": "s.turn", "link": "https://stackoverflow.com/users/7757481/s-turn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "accepted_answer_id": 45212430, "answer_count": 3, "score": 0, "last_activity_date": 1500547390, "creation_date": 1500473908, "last_edit_date": 1500547390, "question_id": 45193332, "link": "https://stackoverflow.com/questions/45193332/vba-commandbutton-click-sub-when-the-worksheet-is-created-new-each-time", "title": "VBA - CommandButton Click sub - when the worksheet is created new each time", "body": "<p>This feels like a stupid question but I can't figure it out, so here goes...</p>\n\n<p>I have a workbook which, based on what's input into a userform, creates a new worksheet each time a command button on the userform is clicked, and deletes the old one.</p>\n\n<p>That means that, although the new worksheet is always given the same name (\"Results\"), the sheet number increments each time; it's currently calling itself Sheet48 and next time I run it it will be Sheet49.</p>\n\n<p>What I'd like to do is add a command button to that \"Results\" sheet, which users can click to take them to a different worksheet.  I've got as far as adding some code into the userform which creates the command button itself on the \"Results\" worksheet.  I haven't yet written the sub which would tell it to take the user to a different worksheet, but I'm confident that I could do this without much trouble.</p>\n\n<p>My question is how I can assign the sub to the button, considering that the worksheet it's located on is not permanent?  I thought the sub should go into a standard module, but all the examples I see for this kind of thing begin with \"CommandButton1_Click\", or \"CommandButton2_Click\", and are stored within the sheet object itself.  It seems like these numbers 1 and 2 refer to the command button's order on a given worksheet, but presumably a sub on a standard module won't know which worksheet to look at.</p>\n\n<p>I hope that makes sense - any helpful explanations will be much appreciated!  Thanks.</p>\n\n<p>EDIT: \nThis is the code I'm using to create the command button and to (attempt to) assign the sub to it:</p>\n\n<pre><code>'Add a command button, which will allow users to jump to the full report\n\nActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", Link:=False _\n        , DisplayAsIcon:=False, Left:=1025, Top:=130.5, Width:=160, Height:= _\n        400).Select\n\nActiveSheet.CommandButton1.Caption = \"Click here to see the original report\"\nActiveSheet.CommandButton1.WordWrap = True\nActiveSheet.CommandButton1.OnAction = \"Module1.ButtonForOriginal\" 'the sub works in isolation, but this line isn't assigning it.\n</code></pre>\n\n<p>Can anyone see any issues there?  The ButtonForOriginal sub procedure works in isolation, so it looks like I'm just not calling it properly?</p>\n\n<p>EDIT 2 - I have now achieved the right effect with a different method - see my answer posted below if you're interested.  Thanks to those who helped and set me on the right path!</p>\n"}, {"tags": ["vba", "button", "web"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1500474545, "post_id": 45193319, "comment_id": 77354448, "body": "thank you, i&#39;ve already try it but still, it gives me an error (without &quot;with&quot; block&quot;)"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "reply_to_user": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1500474783, "post_id": 45193319, "comment_id": 77354647, "body": "Can you tell me what your <code>IE</code> variable is? Mine was created using <code>Set IE = CreateObject(&quot;HtmlFile&quot;).Script</code>."}, {"owner": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1500576954, "post_id": 45193319, "comment_id": 77412295, "body": "I create it using: Set IE = GetObject(&quot;new:{D5E8041D-920F-45e9-B8FB-B1DEB82C6E5E}&quot;)"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "reply_to_user": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1500579008, "post_id": 45193319, "comment_id": 77413514, "body": "Are you sure GetObject is returning a valid IWebBrowser2 object? Inspect the variable in the VBA editor by going to the View menu, and enabling Locals Window."}, {"owner": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1500580259, "post_id": 45193319, "comment_id": 77414177, "body": "Set IE = GetObject(&quot;new:{D5E8041D-920F-45e9-B8FB-B1DEB82C6E5E}&quot;)  IE.Visible = True IE.Navigate &quot;<a href=\"http://mxfrvwwinpro001.mx.corp/tsnet1/authentication/login.aspx\" rel=\"nofollow noreferrer\">mxfrvwwinpro001.mx.corp/tsnet1/authentication/login.aspx</a>&quot;  Do While IE.busy     DoEvents Loop"}, {"owner": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1500580322, "post_id": 45193319, "comment_id": 77414216, "body": "IE.Document.getElementById(&quot;TBUserName&quot;).Value = &quot;xxxxx&quot; IE.Document.getElementById(&quot;TBPasswd&quot;).Value = &quot;xxxxx&quot; Set a = IE.Document.getElementsByName(&quot;BLogon&quot;).Item a.Click  Do While IE.busy     DoEvents Loop  IE.Navigate &quot;<a href=\"http://mxfrvwwinpro001.mx.corp/\" rel=\"nofollow noreferrer\">mxfrvwwinpro001.mx.corp</a>......&quot;   Do While IE.busy     DoEvents Loop   Set b = IE.Document.getElementById(&quot;copy&quot;)"}, {"owner": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1500580358, "post_id": 45193319, "comment_id": 77414239, "body": "then, b gets the value &quot;Nothing&quot;"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "reply_to_user": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1500581012, "post_id": 45193319, "comment_id": 77414602, "body": "Print out <code>IE.Document.DocumentElement.OuterHTML</code> (to file or immediate panel since it might be too long for MsgBox; whichever is more convenient) and make sure that object exists. Sometimes they are added to the page dynamically and you won&#39;t see them until it happens."}, {"owner": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "edited": false, "score": 0, "creation_date": 1501022077, "post_id": 45193319, "comment_id": 77591562, "body": "Many thanks Hao Laoshi, i can&#39;t make it work but it seems to be a permission issue."}], "tags": [], "owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "is_accepted": false, "score": 0, "last_activity_date": 1500473871, "creation_date": 1500473871, "answer_id": 45193319, "question_id": 45193245, "link": "https://stackoverflow.com/questions/45193245/how-to-click-a-web-button-having-only-id-using-vba/45193319#45193319", "title": "how to click a web button having only ID using vba", "body": "<p>Try <code>IE.Document.getElementById(\"xxx\").click</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8332183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17943e5ffd186bcca4a894d3d50dbecd?s=128&d=identicon&r=PG&f=1", "display_name": "rfloparr", "link": "https://stackoverflow.com/users/8332183/rfloparr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 940, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500473871, "creation_date": 1500473670, "question_id": 45193245, "link": "https://stackoverflow.com/questions/45193245/how-to-click-a-web-button-having-only-id-using-vba", "title": "how to click a web button having only ID using vba", "body": "<p>I'm trying to click this button (in the code at the end)</p>\n\n<p>The thing is that, as you can see, i only have the ID, so i can\u00b4t use IE.Document.getElementsByName(\"xxxx\").Item or IE.Document.getElementsByTAG(\"xxx\").Item wich are the code i usually use to click a button.</p>\n\n<p>Can anyone help me?</p>\n\n<p>Many thanks in advance</p>\n\n<pre><code>    &lt;TD id=copyCell&gt;\n      &lt;BUTTON id=copy title=\"Copy grid to clipboard\" class=dbnetgrid&gt;&lt;IMG \n      id=copyImg \n      src=\"http://mxfrvwwinpro001.mx.corp/tsnet1/images/copy.gif\"&gt;&lt;/IMG&gt;\n      &lt;/BUTTON&gt;&amp;nbsp;\n    &lt;/TD&gt;\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1500476011, "post_id": 45193246, "comment_id": 77355655, "body": "Is there anything else to this code?  In trying to follow the goal of what is written, you are asking for cell I6 to match if a cell is blank in the range D6:H6 (will only show one value), then you copy I6 and paste the value to remove the formula.  You could forego the copy/paste by making the Range(&quot;I6&quot;).Formula=..., removing the quotations from the formula; you would need to add the worksheet application modifier as well.  Is this a valid assessment of the code and intent?"}, {"owner": {"reputation": 125, "user_id": 5484958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/366a69261f16042eae86786d1dfc12b2?s=128&d=identicon&r=PG&f=1", "display_name": "Navy Seal", "link": "https://stackoverflow.com/users/5484958/navy-seal"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1500476880, "post_id": 45193246, "comment_id": 77356377, "body": "Thanks for the commnet Cryil. Please see above, i have clarified."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1500479380, "post_id": 45193246, "comment_id": 77358255, "body": "Ok, gave you a comment (made several edits to it as I tested it out)... i always mess using isblank (works in excel formulas) versus using isempty (works in VBA).   Hopefully that fits the bill, given your clarification."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5484958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/366a69261f16042eae86786d1dfc12b2?s=128&d=identicon&r=PG&f=1", "display_name": "Navy Seal", "link": "https://stackoverflow.com/users/5484958/navy-seal"}, "edited": false, "score": 0, "creation_date": 1500477787, "post_id": 45194699, "comment_id": 77357090, "body": "Could you please elaborate how I am supposed to use this?"}, {"owner": {"reputation": 125, "user_id": 5484958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/366a69261f16042eae86786d1dfc12b2?s=128&d=identicon&r=PG&f=1", "display_name": "Navy Seal", "link": "https://stackoverflow.com/users/5484958/navy-seal"}, "edited": false, "score": 0, "creation_date": 1500478383, "post_id": 45194699, "comment_id": 77357576, "body": "I see whats happening- is there a way to fix the range of where the count starts? because there are filled cells on the right of I6 which isnt what I want"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 125, "user_id": 5484958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/366a69261f16042eae86786d1dfc12b2?s=128&d=identicon&r=PG&f=1", "display_name": "Navy Seal", "link": "https://stackoverflow.com/users/5484958/navy-seal"}, "edited": false, "score": 0, "creation_date": 1500479209, "post_id": 45194699, "comment_id": 77358162, "body": "You can replace Columns.count with a specific number so if you wanted to find the first blank cell to the left of I6 you could use       cells(6,9).End(xltoleft)   (since I is the 9th letter of the alphabet) but it gets complicated. Using End mimics the use of Control and the cursor keys and its behaviour in the middle of a table is not intuitive"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 1, "last_activity_date": 1500477347, "creation_date": 1500477347, "answer_id": 45194699, "question_id": 45193246, "link": "https://stackoverflow.com/questions/45193246/reversing-an-array-to-pick-values/45194699#45194699", "title": "Reversing an Array to Pick Values", "body": "<p><em>I am trying to pick up the closest filled cell starting from the right.</em></p>\n\n<p>Start at the far right and jump left</p>\n\n<pre><code> cells(6,columns.count).end(xltoleft).select\n</code></pre>\n\n<p>selects the last filled cell in row 6 unless the row is completely empty when it selects A6</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 5484958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/366a69261f16042eae86786d1dfc12b2?s=128&d=identicon&r=PG&f=1", "display_name": "Navy Seal", "link": "https://stackoverflow.com/users/5484958/navy-seal"}, "edited": false, "score": 0, "creation_date": 1500480189, "post_id": 45194863, "comment_id": 77358772, "body": "Thank you! Found a simpler solution"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1500478108, "last_edit_date": 1500478108, "creation_date": 1500477802, "answer_id": 45194863, "question_id": 45193246, "link": "https://stackoverflow.com/questions/45193246/reversing-an-array-to-pick-values/45194863#45194863", "title": "Reversing an Array to Pick Values", "body": "<p>In reading the update to the questions, I think you can do the following to tell you the value of the RC[-1] before the first blank:</p>\n\n<pre><code>Sub test()\nDim i As Integer\n\nFor i = 4 To 8 Step 1 'Calling out the Step in case you want to go from the right and say Step -1\n\nIf ISEMPTY(Cells(6, i)) Then\n\nIf ISEMPTY(Cells(6, 9)) Then\n\n    Cells(6, 9).Value = Cells(6, i - 1).Value\n    Else\n    End If\n\nElse\nEnd If\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>Let me know if that's what you're wanting.  This assumes that I6 is blank and I6 is filled in only if there was a blank, which allows you to skip to (in a roundabout way) terminate the loop.</p>\n"}], "owner": {"reputation": 125, "user_id": 5484958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/366a69261f16042eae86786d1dfc12b2?s=128&d=identicon&r=PG&f=1", "display_name": "Navy Seal", "link": "https://stackoverflow.com/users/5484958/navy-seal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 45194699, "answer_count": 2, "score": 0, "last_activity_date": 1500478108, "creation_date": 1500473661, "last_edit_date": 1531164843, "question_id": 45193246, "link": "https://stackoverflow.com/questions/45193246/reversing-an-array-to-pick-values", "title": "Reversing an Array to Pick Values", "body": "<p>I had a quick question- I am trying to pick up the closest filled cell starting from the right.</p>\n\n<p>I tried doing it starting from the left but the problem lies when there is a blank cell it will not continue and stop before it. Can someone please help out?</p>\n\n<p>Thanks</p>\n\n<pre><code>    Range(\"I6\").Select\nSelection.FormulaArray = \"=INDEX(D6:H6,(MATCH(TRUE,ISBLANK(D6:H6),0))-1)\"\nRange(\"I6\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n\n<p>Edit.</p>\n\n<p>In essence. If I have 1 in D6, 2 in E6 and 3 in E6. I will end with w in I6, sine the code selects the -1th cell. </p>\n\n<p>However, the problem is when I have </p>\n\n<p>D | E | F | G | H | I |</p>\n\n<p>1---2-------3-------2</p>\n\n<p>It will be 2 in col I, row 6 since 2 comes before the blank (in E). \nIf I start my array from the right side instead of the left- that will make things easier since I could look at the first filled cell.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1500482802, "post_id": 45195251, "comment_id": 77360296, "body": "Thanks, but the above code works fine, I am trying to figure out how to maybe use these snippets to find the closet natural page break below the last &quot;Overall Status&quot; in column D and move the hor. page break up for each instance to the end of column D."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1500478816, "creation_date": 1500478816, "answer_id": 45195251, "question_id": 45193226, "link": "https://stackoverflow.com/questions/45193226/move-closest-automatic-horizontal-pagebreak-up-to-keyword-line/45195251#45195251", "title": "Move closest automatic horizontal pagebreak up to keyword line", "body": "<p>Replace </p>\n\n<pre><code> With ActiveSheet.UsedRange\n</code></pre>\n\n<p>with</p>\n\n<pre><code> With Activesheet.range(\"D1:D\" &amp; HPageBreaks(1).Location.Row)\n</code></pre>\n\n<p>(Note this assumes that there is at least one pagebreak)     </p>\n"}, {"comments": [{"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1500923144, "post_id": 45282283, "comment_id": 77538781, "body": "Thanks, Harassed Dad!  I just tried your solution out (above) and it appears to work the treat!"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 2, "last_activity_date": 1500903861, "creation_date": 1500903861, "answer_id": 45282283, "question_id": 45193226, "link": "https://stackoverflow.com/questions/45193226/move-closest-automatic-horizontal-pagebreak-up-to-keyword-line/45282283#45282283", "title": "Move closest automatic horizontal pagebreak up to keyword line", "body": "<p>Ahh, my suggested change would insert a page break on the first occurrence of \"Overall Status\" before the first natural pagebreak. You want to insert before the last occurrence before a page break. The complication is that as soon as you enter a manual page break all the other breaks change.\nSo loop through the range of the first page to find the last occurrence\ninsert page break\nrepeat for all other pages</p>\n\n<p>the range in column D for a page n is given by the row of the last page break +1 to the row of the next page break so</p>\n\n<pre><code> Dim Search As String\n Search = \"Overall Status\"\n Dim x as long\n Dim r as range\n dim lastrow as long\n\n with activesheet\n     do while x &lt; .hpagebreaks.count\n           for each r in range(\"D\" &amp; (lastrow+1) &amp; \":D\" &amp; .HPageBreaks(x+1).Location.Row)\n              if r = search then     'might have found it\n                  lastrow = r.row  'so remember the row number\n              end if\n           next r\n           if lastrow = 0 then exit sub  'no find  \n           .hpagebreaks.add before:=range(\"A\" &amp; lastrow)\n\n           x = x +1\n      loop\n end with\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1198, "favorite_count": 0, "accepted_answer_id": 45282283, "answer_count": 2, "score": 0, "last_activity_date": 1500903861, "creation_date": 1500473615, "last_edit_date": 1531164843, "question_id": 45193226, "link": "https://stackoverflow.com/questions/45193226/move-closest-automatic-horizontal-pagebreak-up-to-keyword-line", "title": "Move closest automatic horizontal pagebreak up to keyword line", "body": "<p>I am trying to clean up how automatic horizontal page breaks fall on my worksheet. If the automatic page break does not break above the phrase \"Overall Status\" in column 'D' I would like to move the next closest horizontal page break below \"Overall Status\" up.  Below is a code snippet that places a horizontal page break above all lines that say \"Overall Status\" in column D, but that is way too many page breaks.</p>\n\n<pre><code>Sub Pagebreak()\n'adds horizontal pagebreak before every 'Overall Status'\n\nDim Search As String\n\nSearch = \"Overall Status\"\n\nWith ActiveSheet.UsedRange\n    Set c = .Find(What:=Search, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n    If Not c Is Nothing Then\n        FirstAddress = c.Address\n        Do\n            ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=c\n            Set c = .FindNext(c)\n        Loop While Not c Is Nothing And c.Address &lt;&gt; FirstAddress\n    End If\n\n    'Then try toggle between pagebreak screen and normal view\n    End With\nEnd Sub\n</code></pre>\n\n<p>The snippet of code below shows where the existing horizontal page break currently falls:</p>\n\n<pre><code>Sub HPageBreakTest()\n'counts and shows where horizontal pagebreaks are\nDim pgeBreak As HPageBreak\n\nWith ActiveSheet\n.Cells(65536, 1).Select\nMsgBox .HPageBreaks.Count &amp; \" Horizontal page breaks counted\"\nFor Each pgeBreak In .HPageBreaks\nMsgBox \"pgbreak at row: \" &amp; pgeBreak.Location.row\n.Cells(65536, 1).Select\nNext pgeBreak\n.Cells(1, 1).Select\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I would like to figure out how I can combine the logic of these two code snippets, to (1) locate the first automatic horizontal page break below \"Overall Status\" and (2) move that page break up just above \"Overall Status\" phrase in column D.  Not a horizontal page break for each instance of \"Overall Status.\"  I hope my question makes sense.  Thank you for your assistance in advance.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1500473667, "post_id": 45193204, "comment_id": 77353736, "body": "What have you done so far? Where are you stuck?"}, {"owner": {"reputation": 81, "user_id": 6355255, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/2b8300b7ba1a064982b63c1b85fbff6f?s=128&d=identicon&r=PG&f=1", "display_name": "Naresh Babu", "link": "https://stackoverflow.com/users/6355255/naresh-babu"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1500474134, "post_id": 45193204, "comment_id": 77354107, "body": "@FunThomas how to copy 4,6,7 under Action text and putting this in array"}], "owner": {"reputation": 81, "user_id": 6355255, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/2b8300b7ba1a064982b63c1b85fbff6f?s=128&d=identicon&r=PG&f=1", "display_name": "Naresh Babu", "link": "https://stackoverflow.com/users/6355255/naresh-babu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593676127, "creation_date": 1500473563, "last_edit_date": 1593676127, "question_id": 45193204, "link": "https://stackoverflow.com/questions/45193204/how-to-read-particular-excel-column-values-based-on-particular-text-and-putting", "title": "How to read particular excel column values based on particular text and putting it in array in excel macro", "body": "<p>I want to search Action in 3rd row and then i need copy all active cell values  in that(Action) column and putting it in array.\nI'm beginner please help me.</p>\n\n<pre><code>aaaa    Action  bbb\n1        4\n         6\n         7\n\nobjCarpetSheet.Range(\"B2:G2\").Value = objInputfileSheet.Range(\"B16:F16\").Value\n</code></pre>\n\n<p>I tried like this but it is reading values from B16 to F16 in CarpetSheet and past in B2 to G2  InputfileSheet.\nActually i want to read used range column value based on particular text and past in another excel. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1500473439, "post_id": 45193103, "comment_id": 77353530, "body": "no it won&#39;t, it creates the range, using your numbers, A1:D5.  Why do you think it the other way?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1500479215, "post_id": 45193103, "comment_id": 77358171, "body": "What issue are you getting (possibly an error code?) when you try to move your block of cells?  If X, Y, A, &amp; B, are all defined appropriately, you shouldn&#39;t run into issues.  This is a pretty standard approach, e.g., range(cells(i,1),cells(i+10,LR)) where LR is last row and i is the coded variable."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1500479268, "post_id": 45193103, "comment_id": 77358196, "body": "it would if you used <code>cells(x,y).value</code> but since you&#39;re omitting that it should default to return the range. If you want to specify, which may be good practice, use <code>cells(x,y).address</code>"}, {"owner": {"reputation": 1, "user_id": 8332139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c600b671b9dd1735bf38bd278887803?s=128&d=identicon&r=PG&f=1", "display_name": "Evan", "link": "https://stackoverflow.com/users/8332139/evan"}, "edited": false, "score": 0, "creation_date": 1500480000, "post_id": 45193103, "comment_id": 77358663, "body": "I think I found the issue. It looks like it arises from a part I removed out of simplification. I&#39;m referring to a different sheet (MySheet=&quot;Sheet1&quot;) and Sheets(MySheet).range(cells(x,y), cells(x+a, y+b)) was causing errors when another sheet was active. It seems I have to have range(Sheets(MySheet).cells(x,y), Sheets(MySheet).cells(x+a, y+b)) instead. Thanks everyone, though!"}], "owner": {"reputation": 1, "user_id": 8332139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c600b671b9dd1735bf38bd278887803?s=128&d=identicon&r=PG&f=1", "display_name": "Evan", "link": "https://stackoverflow.com/users/8332139/evan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 740, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500498309, "creation_date": 1500473326, "last_edit_date": 1531164843, "question_id": 45193103, "link": "https://stackoverflow.com/questions/45193103/referring-to-range-of-cells-through-rangecellsx-y-cellsxa-yb", "title": "Referring to range of cells through range(cells(x,y), cells(x+a,y+b))", "body": "<p>I want to automate moving blocks of cells, and am encountering issues when attempting to use <code>range(cells(x,y), cells(x+a, y+b)) [a, b, x, y are integer variables]</code>. Essentially, I would like to replicate <code>offset(\"A1\",x-1,y-1,a,b)</code> from plain Excel. The problem is that VBA will look up the value of <code>cells(x,y)</code> instead of using it simply as a position reference.</p>\n\n<p>For example, say <code>x=1, y=1, a=3, b=2 and A1 [r1, c1</code>] in the worksheet is \"Potato\" and <code>D5 [r5, c4]</code> is \"Apple\". VBA will reduce.</p>\n\n<pre><code>    range(cells(x,y), cells(x+a, y+b))\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    range(\"Potato\",\"Apple\")\n</code></pre>\n\n<p>Any advice? Thanks!</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 8271065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e104b70d6a9a88ef873ee3be028cab68?s=128&d=identicon&r=PG&f=1", "display_name": "qz_99", "link": "https://stackoverflow.com/users/8271065/qz-99"}, "is_accepted": false, "score": 0, "last_activity_date": 1500475495, "creation_date": 1500475495, "answer_id": 45194025, "question_id": 45192902, "link": "https://stackoverflow.com/questions/45192902/excel-vba-how-to-multiply-last-column-containing-data-with-the-column-before/45194025#45194025", "title": "Excel VBA: How to multiply last column containing data with the column before?", "body": "<p>Use this for multiplying the row's values:</p>\n\n<pre><code>outputSheet.Cells(4,1).Activate \nApplication.ScreenUpdating = False\nWhile ActiveCell.Value &lt;&gt; \"\"\n    ActiveCell.Offset(1, 0).Activate\nWend\n\nWhile ActiveCell.Offset(0, -1).Value &lt;&gt; \"\"\n    ActiveCell.Value = ActiveCell.Offset(0, -2).Value * ActiveCell.Offset(0, \n    -1).Value\n    ActiveCell.Offset(1, 0).Activate\nWend\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500475495, "creation_date": 1500472867, "question_id": 45192902, "link": "https://stackoverflow.com/questions/45192902/excel-vba-how-to-multiply-last-column-containing-data-with-the-column-before", "title": "Excel VBA: How to multiply last column containing data with the column before?", "body": "<p>I am still very new to VBA and am trying to multiply my last column (which changes monthly) by the values in the column before that one. What makes this difficult (for me) is that once this is executed, I need to add another column and multiply by the same column that the previous one was multiplied by. For example: My code performs a vlookup in the next available column, lets say that is column R. I then need to multiply the values in column R by the values in column Q (until the last row in column R). I then need to perform a new vlookup in column S, but still multiply it by the values in Q. Again, the columns change monthly. Here is my code so far, I have managed to figure out all the vlookups and everything, just having trouble multiplying my columns with previous column:</p>\n\n<pre><code>Sub vlookup5()\n    Dim SourceLastRow As Long\n    Dim OutputLastRow As Long\n    Dim sourceSheet As Worksheet\n    Dim outputSheet As Worksheet\n\n    Dim NextColumn As Long\n\n    Set sourceSheet = Worksheets(\"Data1\")\n    Set outputSheet = Worksheets(\"Pivot\")\n    With sourceSheet\n         SourceLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n    With outputSheet\n        NextColumn = .Cells(4, Columns.Count).End(xlToLeft).Column + 1\n        OutputLastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row - 1\n        .Range(Cells(4, NextColumn), Cells(OutputLastRow, NextColumn)).Formula = _\n             \"=VLOOKUP(D4,'\" &amp; sourceSheet.Name &amp; \"'!$A$2:$H$\" &amp; SourceLastRow &amp; \",6,0)*LastColumn\"\n        .Cells(OutputLastRow + 1, NextColumn).Formula = \"=SUM(\" &amp; Chr(64 + NextColumn) &amp; \"4:\" &amp; Chr(64 + NextColumn) &amp; OutputLastRow &amp; \")*1000\"\n    End With\n    End Sub\n\n Sub vlookup6()\n        Dim SourceLastRow As Long\n        Dim OutputLastRow As Long\n        Dim sourceSheet As Worksheet\n        Dim outputSheet As Worksheet\n\n        Dim NextColumn As Long\n\n    Set sourceSheet = Worksheets(\"Data1\")\n    Set outputSheet = Worksheets(\"Pivot\")\n    With sourceSheet\n         SourceLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n    With outputSheet\n        NextColumn = .Cells(4, Columns.Count).End(xlToLeft).Column + 1\n        OutputLastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row - 1\n        .Range(Cells(4, NextColumn), Cells(OutputLastRow, NextColumn)).Formula = _\n             \"=VLOOKUP(D4,'\" &amp; sourceSheet.Name &amp; \"'!$A$2:$H$\" &amp; SourceLastRow &amp; \",7,0)\"\n        .Cells(OutputLastRow + 1, NextColumn).Formula = \"=SUM(\" &amp; Chr(64 + NextColumn) &amp; \"4:\" &amp; Chr(64 + NextColumn) &amp; OutputLastRow &amp; \")*1000\"\n    End With\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1500472795, "creation_date": 1500472795, "answer_id": 45192865, "question_id": 45192824, "link": "https://stackoverflow.com/questions/45192824/how-to-use-vlookup-the-formula-to-search-for-string-in-vba/45192865#45192865", "title": "How to use vlookup (the formula) to search for string in VBA", "body": "<p>double the quotes:</p>\n\n<pre><code>Range(\"H21\").Formula = \"=VLOOKUP(\"\"cleared\"\",'mortgage'!A2:F12,4,FALSE)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1500473380, "last_edit_date": 1500473380, "creation_date": 1500472926, "answer_id": 45192927, "question_id": 45192824, "link": "https://stackoverflow.com/questions/45192824/how-to-use-vlookup-the-formula-to-search-for-string-in-vba/45192927#45192927", "title": "How to use vlookup (the formula) to search for string in VBA", "body": "<p>Your VBE thinks the word cleared is not part of the string as you've terminated it with double-quotes <em>beforehand</em>. You then appear to be starting a new string immediately <em>after</em> the word cleared.</p>\n\n<p>To use double quotes (aka speech-marks) within a string, you'll need to double them up like so:</p>\n\n<pre><code>Range(\"H21\").Formula = \"=VLOOKUP(\"\"cleared\"\",'mortgage'!A2:F12,4,FALSE)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1500473191, "post_id": 45192945, "comment_id": 77353327, "body": "In this instance, that won&#39;t help at all, as the returned text is <code>=VLOOKUP(&quot;cleared&quot;,mortgage!A2:F12,4,FALSE)</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1500473935, "post_id": 45192945, "comment_id": 77353960, "body": "@CLR - I knew I was missing something from this answer, some months ago - <a href=\"https://stackoverflow.com/questions/43050331/formula-is-giving-error-when-i-add-text/43050563#43050563\" title=\"formula is giving error when i add text\">stackoverflow.com/questions/43050331/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1500474260, "last_edit_date": 1500474260, "creation_date": 1500472954, "answer_id": 45192945, "question_id": 45192824, "link": "https://stackoverflow.com/questions/45192824/how-to-use-vlookup-the-formula-to-search-for-string-in-vba/45192945#45192945", "title": "How to use vlookup (the formula) to search for string in VBA", "body": "<p>Or another option:</p>\n\n<ol>\n<li>Write the working formula in Excel.  </li>\n<li>Select the cell with the\nformula. </li>\n<li>Run the following code:</li>\n</ol>\n\n<hr>\n\n<pre><code>Sub TestMe\n     debug.print selection.formula\nEnd Sub\n</code></pre>\n\n<hr>\n\n<ol start=\"4\">\n<li>Check the immediate window - that's the formula you are using in Excel.</li>\n<li>If you want useful formula, that you can actually copy+paste in your VBA code, use this:</li>\n</ol>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub PrintMeUsefulFormula()\n\n    Dim strFormula  As String\n    Dim strParenth  As String\n\n    strParenth = \"\"\"\"\n\n    strFormula = Selection.Formula\n    strFormula = Replace(strFormula, \"\"\"\", \"\"\"\"\"\")\n\n    strFormula = strParenth &amp; strFormula &amp; strParenth\n    Debug.Print strFormula\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<ol start=\"6\">\n<li>Check the immediate window.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1500473156, "post_id": 45193006, "comment_id": 77353303, "body": "Excel uses single quotes only on the sheet name, not to denote a string literal."}, {"owner": {"reputation": 55, "user_id": 8201033, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/adb3ce59a85980c4214ce097597db0da?s=128&d=identicon&r=PG&f=1", "display_name": "David Lionhardt", "link": "https://stackoverflow.com/users/8201033/david-lionhardt"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1500560057, "post_id": 45193006, "comment_id": 77400908, "body": "You&#39;re right, I completely forgot. I&#39;ll edit my comment with your correction to make it more visible, in the case someone makes a similar error."}], "tags": [], "owner": {"reputation": 55, "user_id": 8201033, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/adb3ce59a85980c4214ce097597db0da?s=128&d=identicon&r=PG&f=1", "display_name": "David Lionhardt", "link": "https://stackoverflow.com/users/8201033/david-lionhardt"}, "is_accepted": false, "score": 1, "last_activity_date": 1500560143, "last_edit_date": 1500560143, "creation_date": 1500473083, "answer_id": 45193006, "question_id": 45192824, "link": "https://stackoverflow.com/questions/45192824/how-to-use-vlookup-the-formula-to-search-for-string-in-vba/45193006#45193006", "title": "How to use vlookup (the formula) to search for string in VBA", "body": "<p>Use single quotes around cleared <strong>(DOES NOT WORK)</strong>:</p>\n\n<pre><code>Range(\"H21\").Formula = \"=VLOOKUP('cleared','mortgage'!A2:F12,4,FALSE)\"\n</code></pre>\n\n<p><strong>EDIT</strong> : Correction made by OP :</p>\n\n<p><em>Excel uses single quotes only on the sheet name, not to denote a string literal</em></p>\n"}], "owner": {"reputation": 1, "user_id": 8332142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e555f13d0125d431f19354c1951bc42?s=128&d=identicon&r=PG&f=1", "display_name": "usagi drop", "link": "https://stackoverflow.com/users/8332142/usagi-drop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1500560143, "creation_date": 1500472692, "last_edit_date": 1531164843, "question_id": 45192824, "link": "https://stackoverflow.com/questions/45192824/how-to-use-vlookup-the-formula-to-search-for-string-in-vba", "title": "How to use vlookup (the formula) to search for string in VBA", "body": "<p>Hi everyone I have a problem with VBA when I try to use vlookup formula like this:</p>\n\n<pre><code>Range(\"H21\").Formula = \"=VLOOKUP(\"cleared\",'mortgage'!A2:F12,4,FALSE)\"\n</code></pre>\n\n<p>it keeps telling me the part \"cleared\" is an syntax error. Can someone tell me how to deal with that? Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1500472163, "creation_date": 1500472163, "answer_id": 45192591, "question_id": 45192371, "link": "https://stackoverflow.com/questions/45192371/trying-to-identify-matching-cells-randomly-distributed-in-2-seperate-excel-sheet/45192591#45192591", "title": "Trying to identify matching cells randomly distributed in 2 seperate Excel sheets, and have the matching data copied and pasted into a third sheet", "body": "<p>Your problem is that rngA points to A1 and nothing changes that.\nAdd one line after your paste command:</p>\n\n<pre><code>ActiveSheet.Paste\nSet rngA = rngA.Offset(1,0)  ' This will move the pasting location one step down\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500472548, "post_id": 45192662, "comment_id": 77352756, "body": "This gave me a runtime error 5, Invalid procedure call or argument"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500472588, "post_id": 45192662, "comment_id": 77352782, "body": "@TheGusBus at which line ?"}, {"owner": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500472692, "post_id": 45192662, "comment_id": 77352883, "body": "It doesn&#39;t specify it just pops up with a window"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500472825, "post_id": 45192662, "comment_id": 77353005, "body": "@TheGusBus run the code in debug mode (with F8) and see what line"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1500472922, "post_id": 45192662, "comment_id": 77353088, "body": "<code>cell2</code> in the match needs to be <code>rng2</code>"}, {"owner": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500472985, "post_id": 45192662, "comment_id": 77353146, "body": "When I press F8 into this line it pops up  : NextRow = Sheets(&quot;Sheet5&quot;).Cells(Sheets(&quot;Sheet5&quot;).Rows.Count, &quot;A&quot;).End(xlUp).Row + 1"}, {"owner": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500473050, "post_id": 45192662, "comment_id": 77353212, "body": "oh ok nvm substituting rng2 in for cell2 fixed it"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500473198, "post_id": 45192662, "comment_id": 77353333, "body": "@TheGusBus now it&#39;s your part, where you mark this as &quot;ANSWER&quot;"}, {"owner": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500473312, "post_id": 45192662, "comment_id": 77353415, "body": "I do have another question though, the script runs fine when I am searching in a single column C:C, or D:D, but what if I want to search across six different columns? Like A:D or A1:D200? When I try that it comes up blank"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500473378, "post_id": 45192662, "comment_id": 77353473, "body": "@TheGusBus you mean <code>rng2</code> is across 4-5 columns ?"}, {"owner": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500473556, "post_id": 45192662, "comment_id": 77353634, "body": "yes both rng1 and rng 2 are across 4-5 columns, and in some cases up to 16K rows"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1500473834, "post_id": 45192662, "comment_id": 77353877, "body": "not sure, what type of comparison are you trying to make when you have 2 ranges of 4-5 columns width ? find exact match for all cells in a certain row ? or find one match from each row ?"}, {"owner": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "edited": false, "score": 0, "creation_date": 1500474526, "post_id": 45192662, "comment_id": 77354432, "body": "I am trying to see if a certain number &quot;938394&quot; for example, exists anywhere in the second spreadsheet, and if it does, copy and paste that number to spreadsheet 5. I think I can use your code to do it though by reorganizing my data into one single column"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1500472966, "last_edit_date": 1500472966, "creation_date": 1500472333, "answer_id": 45192662, "question_id": 45192371, "link": "https://stackoverflow.com/questions/45192371/trying-to-identify-matching-cells-randomly-distributed-in-2-seperate-excel-sheet/45192662#45192662", "title": "Trying to identify matching cells randomly distributed in 2 seperate Excel sheets, and have the matching data copied and pasted into a third sheet", "body": "<p>A few comments about your code:</p>\n\n<ul>\n<li><code>Dim rng1, rng2, rngA, cell1, cell2 As Range</code> means only <code>cell2</code> is defined <code>As Range</code>, while <code>rng1, rng2, rngA, cell1</code> defined <code>As Variant</code></li>\n<li>You don't need to have 2 <code>For</code> loops to compare, you can replace the second <code>For</code> loop with the <code>Match</code> function, it will save you precious run-time.</li>\n<li>You need to find the next empty row in \"Sheet5\", by using <code>NextRow = Sheets(\"Sheet5\").Cells(Sheets(\"Sheet5\").Rows.Count, \"A\").End(xlUp).Row + 1</code></li>\n<li>Last, you don't need to <code>Select</code> the sheets in order to copy>>paste, you can so it in 1-line (see in my code below).</li>\n</ul>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Sub findDuplicates()\n' code to find duplicates in 2 different worksheets\n\n' 4 ranges have been defined\nDim rng1 As Range, rng2 As Range, rngA As Range, cell1 As Range, cell2 As Range\nDim NextRow As Long\n\n\n'rng1 defines the existing data in column C and \"Sheet1\"\nSet rng1 = Sheets(\"Sheet1\").Range(\"C:C\")\n\n'rng2 defines the data in column C and \"Sheet2\"\nSet rng2 = Sheets(\"Sheet2\").Range(\"C:C\")\n\nSet rngA = Sheets(\"Sheet5\").Range(\"A1\")\n\nFor Each cell1 In rng1\n    If Not IsEmpty(cell1.Value) Then ' only check non-empty cells\n        If Not IsError(Application.Match(cell1.Value, rng2 , 0)) Then ' &lt;-- confirm match was asuccessful\n            ' find next empty row in column \"A\" in \"Sheet5\"\n            NextRow = Sheets(\"Sheet5\").Cells(Sheets(\"Sheet5\").Rows.Count, \"A\").End(xlUp).Row + 1\n            ' Copy &gt;&gt; Paste in 1 line (without need to Select the Sheets)\n            cell1.Copy Destination:=Sheets(\"Sheet5\").Range(\"A\" &amp; NextRow)\n        End If\n        'run the looping process\n    End If\nNext cell1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5562410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fb0de0df96ef5fc507d117467dbf51?s=128&d=identicon&r=PG&f=1", "display_name": "TheGusBus", "link": "https://stackoverflow.com/users/5562410/thegusbus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 45192662, "answer_count": 2, "score": 0, "last_activity_date": 1500472966, "creation_date": 1500471610, "last_edit_date": 1500471986, "question_id": 45192371, "link": "https://stackoverflow.com/questions/45192371/trying-to-identify-matching-cells-randomly-distributed-in-2-seperate-excel-sheet", "title": "Trying to identify matching cells randomly distributed in 2 seperate Excel sheets, and have the matching data copied and pasted into a third sheet", "body": "<p>So I have several worksheets on the same Excel workbook that I need to compare. Worksheet 1 is the masterlist, and I need to compare worksheets 1-2, 1-3, 1-4. I then need to paste any similar 1-2 data cells in column A of worksheet 5, and similar 1-3 data cells in column B of worksheet 5, and 1-4 similarities to column C of worksheet 5. For starters I have focused on getting the 1-2 comparison to work. So far I have been able to get my test number to be pasted to cell A1 of sheet 5. I am running into trouble because it only works for 1 cell, and I cannot get the program to paste a similarity in A1, and then A2... etc, when I have multiple similar items. They just overwrite each other in cell A1, or in the entire A column. I am also running into trouble because the program as it is written stops when it hits a blank space, but I need it to just skip the blanks and read the next cell when it comes across them. This is because my data sheets are very messy and the data is scattered over several thousands of rows among several different columns, with spaces randomly interjected. Below is my working code for just reading a similarity, and pasting it into A1. I should note that I have considered adding a specific cell range depending on which sheet I am on in order to put an end point on the program, but I haven't quite figured out how to work it in.</p>\n\n<pre><code>Sub findDuplicates()\n' code to find duplicates in 2 different worksheets\n\nDim rng1, rng2, rngA, cell1, cell2 As Range\n' 4 ranges have been defined\n\nSet rng1 = Sheets(\"Sheet1\").Range(\"C:C\")\n'rng1 defines the existing data in column C and worksheet1\n\nSet rng2 = Sheets(\"Sheet2\").Range(\"C:C\")\n'rng2 defines the data in column C and worksheet2\n\nSet rngA = Sheets(\"Sheet5\").Range(\"A1\")\n\nFor Each cell1 In rng1\n    If IsEmpty(cell1.Value) Then Exit For\n    'check for empty rows. If true then exit the program\n\n    For Each cell2 In rng2\n        If IsEmpty(cell2.Value) Then Exit For\n\n        If cell1.Value = cell2.Value Then\n            'compare data in cell1 and cell2 and then copy/paste if they have equal values\n            cell1.Copy\n            Sheets(\"Sheet5\").Select\n            rngA.Select\n            ActiveSheet.Paste\n        End If\n        'run the looping process\n    Next cell2\nNext cell1\n\nEnd Sub\n</code></pre>\n\n<p>The general idea of what I imagine the program to look like would be something like</p>\n\n<pre><code>Define ranges\n\nBlock of code that runs through each cell in sheet 1 comparing it to all cells in sheet 2.\n\nBlock of code that, when similarities are found, copy/paste that cell on sheet 1 to sheet 5 column A\n\n*Program resumes scan from the next cell on sheet 1*\n\nBlock of code that breaks the program when it hits the end of the specified cell range\n</code></pre>\n\n<p>Any help with this would be greatly appreciated! You would be saving me at least a week's worth of mindless work. </p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7536283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/crI55.jpg?s=128&g=1", "display_name": "nagarjun", "link": "https://stackoverflow.com/users/7536283/nagarjun"}, "edited": false, "score": 0, "creation_date": 1500641881, "post_id": 45192399, "comment_id": 77442412, "body": "Thank you very much, this helped me."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1500471666, "creation_date": 1500471666, "answer_id": 45192399, "question_id": 45192218, "link": "https://stackoverflow.com/questions/45192218/prevent-autorun-vba-code-when-opening-a-file/45192399#45192399", "title": "Prevent autorun VBA code when opening a file", "body": "<p>To prevent autorun VBA code like <code>Workbook_Open</code> or <code>Auto_Open</code> click File \u203a Open from the menu/ribbon, select your file and <strong>hold down the shift key</strong> when you click the Open button.</p>\n\n<p>For a detailed how-to also see here: <a href=\"http://www.jkp-ads.com/Articles/preventopenevent.asp\" rel=\"nofollow noreferrer\">Preventing auto_open and Workbook_Open events from running</a>.</p>\n"}], "owner": {"reputation": 39, "user_id": 7536283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/crI55.jpg?s=128&g=1", "display_name": "nagarjun", "link": "https://stackoverflow.com/users/7536283/nagarjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 1, "accepted_answer_id": 45192399, "answer_count": 1, "score": 1, "last_activity_date": 1500471803, "creation_date": 1500471220, "last_edit_date": 1500471803, "question_id": 45192218, "link": "https://stackoverflow.com/questions/45192218/prevent-autorun-vba-code-when-opening-a-file", "title": "Prevent autorun VBA code when opening a file", "body": "<p>I'm facing a problem where I have written a User form where I have provided the <code>application.visible = false</code> in the workbook program sheet under <code>on_open</code>, now I'm able to run the program but I'm unable to open the workbook or the VBA program.</p>\n\n<p>Please help</p>\n\n<p>Thank you and Regards,\nNagarjun B</p>\n"}, {"tags": ["vba", "excel", "textbox"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 1, "creation_date": 1500471521, "post_id": 45192183, "comment_id": 77351852, "body": "To do that, right click on the TextBox --&gt; Format Control --&gt; Properties --&gt; and check the radio button for &quot;Don&#39;t move or size with cells&quot;. Is that what you are trying to achieve?"}, {"owner": {"reputation": 403, "user_id": 6667879, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d24125511b2a08c2ed9f433f6412aae4?s=128&d=identicon&r=PG&f=1", "display_name": "JuniorDev", "link": "https://stackoverflow.com/users/6667879/juniordev"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1500473147, "post_id": 45192183, "comment_id": 77353291, "body": "thanks for your comment, i tried this before and it&#39;s not what i wanted. I want when you select the TextBox you can only edit the text inside. You can move the textbox or resize as you can see in the picture. I want the borders to be fixed, just lines not as you see there are the circles and rectangles on the borders"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500473846, "post_id": 45192183, "comment_id": 77353890, "body": "The &quot;circles and rectangles&quot; indicate that the shape has been <i>selected</i> by the users. Placing the cursor within the textbox (e.g., to allow the user to change the <i>text</i>) will automatically consider the shape <i>selected</i> and the &quot;circles and rectangles&quot; will appear. This is not preventable AFAIK."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500475000, "post_id": 45193031, "comment_id": 77354836, "body": "You might want to mention specifically that the protection should <i>not allow</i> the user to &quot;Edit Objects&quot;. This way, user can edit the text without being able to manipulate the textbox itself. This also gets rid of the &quot;circles &amp; rectangles&quot; surrounding the textbox when it is normally <i>selected</i>."}], "tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": false, "score": 1, "last_activity_date": 1500473708, "last_edit_date": 1500473708, "creation_date": 1500473157, "answer_id": 45193031, "question_id": 45192183, "link": "https://stackoverflow.com/questions/45192183/lock-textbox-from-moving-and-resizing-in-a-sheet-and-only-edit-the-text-excel-vb/45193031#45193031", "title": "Lock TextBox from moving and resizing in a sheet and only edit the text Excel VBA", "body": "<p>The <code>worksheet.protect</code> method has many arguments that allow/disallow the user to do certain things.  Most of the arguments default to disallow if not specified in the <code>worksheet.protect</code> method.  See here for a full list of the arguments the method takes<a href=\"http://link\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-protect-method-excel</a></p>\n\n<p>Maybe try something like this:</p>\n\n<pre><code>Sub protect_TextBox()\n\nActiveSheet.Protect UserInterFaceOnly:=True, AllowFormattingCells:=True, _\nAllowSorting:=True, AllowFiltering:=True\n'rest of my code...\n\nEnd Sub\n</code></pre>\n\n<p>You can see the other arguments on the link and include whatever you need.  Remember that the default of the arguments is false.  So if you do not include them there will be more restrictions on what the user can do to the cell.</p>\n"}], "owner": {"reputation": 403, "user_id": 6667879, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d24125511b2a08c2ed9f433f6412aae4?s=128&d=identicon&r=PG&f=1", "display_name": "JuniorDev", "link": "https://stackoverflow.com/users/6667879/juniordev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5651, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500473708, "creation_date": 1500471117, "question_id": 45192183, "link": "https://stackoverflow.com/questions/45192183/lock-textbox-from-moving-and-resizing-in-a-sheet-and-only-edit-the-text-excel-vb", "title": "Lock TextBox from moving and resizing in a sheet and only edit the text Excel VBA", "body": "<p>I create a TextBox in vba where Users enter a value then search it in the sheet as you can see here</p>\n\n<p><a href=\"https://i.stack.imgur.com/C9wK4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C9wK4.png\" alt=\"enter image description here\"></a></p>\n\n<p>My problem is I want to lock this TextBox from moving and the Users can just edit the text inside the box. I was trying Properties and checked \"Locked\" and unchecked \"Locked Text\" then protected the sheet </p>\n\n<pre><code>Sub protect_TextBox()\n\nActiveSheet.Protect UserInterFaceOnly:=True\n'rest of my code...\n\nEnd Sub\n</code></pre>\n\n<p>It locked my TextBox from moving and resizing and users can only edit the text inside </p>\n\n<p>But it locked also many funtions like filtering, formating... basically i can just select the cell nothing more.</p>\n\n<p>Any suggestions please how to freeze only the TextBox and keep the rest of cells unprotected ? </p>\n\n<p>Thank you very much. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1500472704, "post_id": 45191984, "comment_id": 77352895, "body": "Add a worksheet_OnSelect sub that turns off auto-correct if the desired target cell is selected and on for all other cells"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1500474594, "post_id": 45191984, "comment_id": 77354486, "body": "That worked! Thanks! If you create an answer I&#39;ll give you cred. Otherwise I can."}], "answers": [{"tags": [], "owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "is_accepted": false, "score": 0, "last_activity_date": 1500478766, "creation_date": 1500478766, "answer_id": 45195225, "question_id": 45191984, "link": "https://stackoverflow.com/questions/45191984/prevent-auto-correction-for-one-cell-in-excel/45195225#45195225", "title": "Prevent auto-correction for one cell in Excel", "body": "<p>Using Flephal's comment, this is how I solved it:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Address = ThisWorkbook.Sheets(\"input sheet\").Range(\"input_cell\").Address Then\n         Application.AutoCorrect.ReplaceText = False\n    Else\n        Application.AutoCorrect.ReplaceText = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": true, "score": 1, "last_activity_date": 1500479321, "creation_date": 1500479321, "answer_id": 45195406, "question_id": 45191984, "link": "https://stackoverflow.com/questions/45191984/prevent-auto-correction-for-one-cell-in-excel/45195406#45195406", "title": "Prevent auto-correction for one cell in Excel", "body": "<p>There is some further error checking you can do so you may prefer the following function:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    On Error Resume Next\n    Application.AutoCorrect.ReplaceText = IIf(Target = Me.Range(\"input_cell\"), False, True)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 45195406, "answer_count": 2, "score": 1, "last_activity_date": 1500479321, "creation_date": 1500470647, "question_id": 45191984, "link": "https://stackoverflow.com/questions/45191984/prevent-auto-correction-for-one-cell-in-excel", "title": "Prevent auto-correction for one cell in Excel", "body": "<p>I have a mission critical workbook that does a bunch of lookups based on a user typed input in on cell. The user input gets erroneously <em>corrected</em> if the user types something that looks like a typo to the auto-correct. For example, when the user types \"cna\" the auto-correct changes it to \"can\", which is usually a good thing, but a bad thing in this case. We want to look up \"cna\". The simple solution is to turn off auto-correct, but we want/like auto-correct, just not in this one user input cell. </p>\n\n<p><strong>How do I keep auto-correct on for the application/workbook, but prevent auto-correct for the user input cell (one cell) in question?</strong></p>\n\n<p>I researched it a bit and couldn't find a way to turn auto-correct off for one cell. It seems to be a global setting.</p>\n\n<p>I looked and didn't find an event that occurs prior to the auto-correct so I could capture the \"cna\", let auto-correct <em>correct</em> the value to \"can\", turn off events, then change it back to \"cna\". For example, the value is already \"can\" when this event is triggered:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   debug.print target.value '&lt;- returns \"can\" already\nEnd Sub\n</code></pre>\n\n<p>I don't want to add \"cna\" to the list of acceptable auto-correct words, because I want \"cna\" to be corrected to \"can\" in all cells but the user input cell in question.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "edited": false, "score": 0, "creation_date": 1500471833, "post_id": 45192198, "comment_id": 77352127, "body": "I attempted this but an issue caused me to shy away from it. It was prompting me to save an excel file for every worksheet."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1500471169, "creation_date": 1500471169, "answer_id": 45192198, "question_id": 45191950, "link": "https://stackoverflow.com/questions/45191950/save-as-pdf-vba-function-issue/45192198#45192198", "title": "Save As PDF VBA Function issue", "body": "<p>You need to call the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-exportasfixedformat-method-excel\" rel=\"nofollow noreferrer\">ExportAsFixedFormat</a> method.</p>\n\n<pre><code>.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"C:\\Example\\\" &amp; SheetName &amp; \".pdf\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "edited": false, "score": 0, "creation_date": 1500473843, "post_id": 45192672, "comment_id": 77353886, "body": "This works but I need each tab to be a separate PDF file. Thank you for your input."}, {"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "edited": false, "score": 0, "creation_date": 1500560178, "post_id": 45192672, "comment_id": 77401001, "body": "Abe, it is prompting an error that says, &quot;We could not find anything to print&quot;.  I copied and pasted your code and just changed the destination folder."}, {"owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "reply_to_user": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "edited": false, "score": 0, "creation_date": 1500574285, "post_id": 45192672, "comment_id": 77410690, "body": "If any of the tabs are totally blank, you&#39;ll get that error. You can use on error resume next to avoid it."}], "tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": true, "score": 1, "last_activity_date": 1500476078, "last_edit_date": 1500476078, "creation_date": 1500472358, "answer_id": 45192672, "question_id": 45191950, "link": "https://stackoverflow.com/questions/45191950/save-as-pdf-vba-function-issue/45192672#45192672", "title": "Save As PDF VBA Function issue", "body": "<pre><code>Sub Test()\nFor Each sht In Sheets\n  sht.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"C:\\\" &amp; sht.Name &amp; \".pdf\"\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 45192672, "answer_count": 2, "score": 0, "last_activity_date": 1500476442, "creation_date": 1500470565, "last_edit_date": 1500476442, "question_id": 45191950, "link": "https://stackoverflow.com/questions/45191950/save-as-pdf-vba-function-issue", "title": "Save As PDF VBA Function issue", "body": "<p>I made a simple function to save all my tabs into a destination folder. However, after implementing the total process I realized this won't work week to week. </p>\n\n<p>To solve the issue I'm having from one week to another, I need the files to be pdfs instead of .xlsx. I attempted to fix this myself by modifying the already existing function, however, when I open the pdfs it generates, they are \"corrupted\" or so says Adobe. </p>\n\n<p>Please see below:</p>\n\n<pre><code>Sub SaveFilesInFolder()\n'\n'This is a function for saving each worksheet as a workbook in a destination folder\n'\n\n'\n    Dim sh As Worksheet\n    Dim wb As Workbook\n\n    For Each sh In Worksheets\n        SheetName = sh.Name\n        sh.Copy\n\n        With ActiveWorkbook\n            .SaveAs FileName:=\"C:\\Example\\\" &amp; SheetName &amp; \".pdf\"\n            .Close SaveChanges:=True\n        End With\n\n    Next sh\n\nEnd Sub\n</code></pre>\n\n<p>I am aware of ExportAsFileFormat but I am having trouble getting that to work with the entire workbook that has 100+ tabs.</p>\n\n<p>Any recommendations are appreciated.</p>\n\n<p>Thank you,</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 7889757, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d5713e71c44aba9ccf99f0599c542168?s=128&d=identicon&r=PG&f=1", "display_name": "accortdr", "link": "https://stackoverflow.com/users/7889757/accortdr"}, "edited": false, "score": 0, "creation_date": 1500472029, "post_id": 45191703, "comment_id": 77352313, "body": "I get where you&#39;re coming from, but the tables that I am trying to fill with data are pre-made in a template that I created for this report. I simply want to loop through &quot;N&quot; where &quot;N(i)&quot; is the name of each of the 8 tables I have                 i.e. N1, N2 .... N8. Essentially the code I am trying to write simply tells excel which table to reference when adding the data."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 91, "user_id": 7889757, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d5713e71c44aba9ccf99f0599c542168?s=128&d=identicon&r=PG&f=1", "display_name": "accortdr", "link": "https://stackoverflow.com/users/7889757/accortdr"}, "edited": false, "score": 0, "creation_date": 1500472394, "post_id": 45191703, "comment_id": 77352618, "body": "Now, after reading your comment, I saw that it was pseudo code in your original question. I think I understand your question a bit better now, but that leads to more questions. Are you trying to compose a cell reference from a list of table names?"}, {"owner": {"reputation": 91, "user_id": 7889757, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d5713e71c44aba9ccf99f0599c542168?s=128&d=identicon&r=PG&f=1", "display_name": "accortdr", "link": "https://stackoverflow.com/users/7889757/accortdr"}, "edited": false, "score": 0, "creation_date": 1500473004, "post_id": 45191703, "comment_id": 77353166, "body": "So I am just trying to take the Data the corresponds to N1 and put it in the table for N1 and then the same for N2...N8.  There is no list of table names persay, but rather there is a whole worksheet with 8 blank tables that I am trying to fill by using a loop. I can get it to work for one table at a time, but I&#39;d like to go through all 8 consecutively and quickly."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1500469968, "creation_date": 1500469968, "answer_id": 45191703, "question_id": 45191585, "link": "https://stackoverflow.com/questions/45191585/looping-through-a-dynamic-variable/45191703#45191703", "title": "Looping through a dynamic variable", "body": "<p>You have two problems in your code. Name is a reserved name and you haven't declared it as a matrix. </p>\n\n<pre><code>Sub test()\n    Dim N(1 To 8) As String, i As Integer\n    For i = 1 To 8\n        N(i) = \"Data\"\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7889757, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d5713e71c44aba9ccf99f0599c542168?s=128&d=identicon&r=PG&f=1", "display_name": "accortdr", "link": "https://stackoverflow.com/users/7889757/accortdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500469968, "creation_date": 1500469666, "last_edit_date": 1531161705, "question_id": 45191585, "link": "https://stackoverflow.com/questions/45191585/looping-through-a-dynamic-variable", "title": "Looping through a dynamic variable", "body": "<p>I am trying to add data to several tables from a data set in order to categorize it for a report. In order to put all of the data in the correct category, I am trying to find a way to loop through the titles similar to this pseduocode</p>\n\n<p><code>Sub test ()</code></p>\n\n<p><code>Dim name as string, i as integer</code></p>\n\n<p><code>For i = 1 to 8</code></p>\n\n<p><code>name(i) = \"Data\"</code></p>\n\n<p><code>Next i</code></p>\n\n<p><code>End Sub</code></p>\n\n<p>From a similar question I saw, it was recommended to use a dictionary, but I do not believe that will help me because I already have the data stored and sorted, I just need to put it into a presentable template to send out each week.e</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "edited": false, "score": 0, "creation_date": 1500469216, "post_id": 45191324, "comment_id": 77349864, "body": "Ctrl+F the function name? (Searching Current Project rather than Current Module)"}, {"owner": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1500469260, "post_id": 45191324, "comment_id": 77349905, "body": "Are there any comments in the code? Any headers indicating which block does what function? If not, it&#39;s going to be a job unless you know VBA well enough to dissect each line"}, {"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1500469315, "post_id": 45191324, "comment_id": 77349947, "body": "Could always try the old way of commenting out a function and seeing if anything throws an error.  This can be tedious though."}, {"owner": {"reputation": 73, "user_id": 8132767, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/356170ec795c440aeae212a914ec2e28?s=128&d=identicon&r=PG&f=1", "display_name": "Keyboard Bandit", "link": "https://stackoverflow.com/users/8132767/keyboard-bandit"}, "reply_to_user": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "edited": false, "score": 0, "creation_date": 1500469663, "post_id": 45191324, "comment_id": 77350244, "body": "@finjo Ctrl+F is the way I am doing it now.  Unfortunately there are literally dozens of functions I have to search for and 12 sheets to check through.  This was really poorly built..."}, {"owner": {"reputation": 73, "user_id": 8132767, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/356170ec795c440aeae212a914ec2e28?s=128&d=identicon&r=PG&f=1", "display_name": "Keyboard Bandit", "link": "https://stackoverflow.com/users/8132767/keyboard-bandit"}, "reply_to_user": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1500469814, "post_id": 45191324, "comment_id": 77350361, "body": "@SeanKelly No, unfortunately there are no comments what so ever...  Fortunately VBA seems pretty straight forward, I&#39;m just trying to remove junk and legacy functions that were used in development but not the current version."}, {"owner": {"reputation": 73, "user_id": 8132767, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/356170ec795c440aeae212a914ec2e28?s=128&d=identicon&r=PG&f=1", "display_name": "Keyboard Bandit", "link": "https://stackoverflow.com/users/8132767/keyboard-bandit"}, "reply_to_user": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1500469871, "post_id": 45191324, "comment_id": 77350419, "body": "@TrevorD Well that&#39;s the current plan unless someone can point me toward a more efficient way to do it."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500469993, "post_id": 45191324, "comment_id": 77350540, "body": "There are ways to do like, cell-wise iteration and check <i>each</i> literal cell for function strings... <code>For each sht in ThisWorkbook.Worksheets: For each cl in sht.Cells: If Instr(cl.Value,&lt;function name&gt;) &lt;&gt; 0 Then...</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500470056, "post_id": 45191324, "comment_id": 77350589, "body": "If you&#39;re trying to determine whether the function is used (called) <i>in VBA</i> (not <i>using VBA</i>), then you can simply comment the function and re-compile, if the function is used, it will raise a compile error."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1500470632, "post_id": 45191324, "comment_id": 77351097, "body": "There is a nice open-source project to extend the functionality of the VBA editor: <a href=\"http://rubberduckvba.com/\" rel=\"nofollow noreferrer\">rubberduckvba.com</a> I don&#39;t know all of its features, but I would be surprised if it didn&#39;t include this."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8132767, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/356170ec795c440aeae212a914ec2e28?s=128&d=identicon&r=PG&f=1", "display_name": "Keyboard Bandit", "link": "https://stackoverflow.com/users/8132767/keyboard-bandit"}, "edited": false, "score": 0, "creation_date": 1500470025, "post_id": 45191552, "comment_id": 77350565, "body": "Oh... that&#39;s a good idea.  I feel like I should have tried this first...  before I came here =/"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 4, "last_activity_date": 1500469571, "creation_date": 1500469571, "answer_id": 45191552, "question_id": 45191324, "link": "https://stackoverflow.com/questions/45191324/is-there-a-way-to-see-if-a-vba-function-is-used-in-excel/45191552#45191552", "title": "Is there a way to see if a VBA function is used in Excel?", "body": "<p>If you find a function that you want to know if it is used, add something like this is in the beginning of the function:</p>\n\n<pre><code>Sub HelloWorld()\n    Debug.Print \"Starting HelloWorld()\"\n    ...\n    ...\n</code></pre>\n\n<p>Bring up the debug window with Ctrl-G and then start testing your workbook. All methods that are reported are in use. All the rest - <em>perhaps</em> not.</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 6300208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a90edea6f653d90419946c32b8fe878?s=128&d=identicon&r=PG&f=1", "display_name": "brett_x", "link": "https://stackoverflow.com/users/6300208/brett-x"}, "is_accepted": true, "score": 3, "last_activity_date": 1500470208, "creation_date": 1500470208, "answer_id": 45191802, "question_id": 45191324, "link": "https://stackoverflow.com/questions/45191324/is-there-a-way-to-see-if-a-vba-function-is-used-in-excel/45191802#45191802", "title": "Is there a way to see if a VBA function is used in Excel?", "body": "<p>Summary: you need to find references to VBA functions in both cells and the VBA code. </p>\n\n<p>You will need to do a \"Find\" (Ctrl+F) in both the Workbook and the VBA editor. </p>\n\n<p>For the workbook, be sure the search parameters to the entire workbook, and look in the Formulas: \n<a href=\"https://i.stack.imgur.com/L96al.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L96al.png\" alt=\"FindAndReplaceDialog\"></a></p>\n\n<p>For searching the VBA code, bring up a Find, and be sure to search all modules by selecting \"Current Project\": </p>\n\n<p><a href=\"https://i.stack.imgur.com/tulHI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tulHI.png\" alt=\"FindAndReplaceVBAEditor\"></a></p>\n\n<p>Buy stepping through these, you should find all references. It is still is a bit of work, but I think this is what you're looking for. </p>\n"}], "owner": {"reputation": 73, "user_id": 8132767, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/356170ec795c440aeae212a914ec2e28?s=128&d=identicon&r=PG&f=1", "display_name": "Keyboard Bandit", "link": "https://stackoverflow.com/users/8132767/keyboard-bandit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3262, "favorite_count": 0, "accepted_answer_id": 45191802, "answer_count": 2, "score": 1, "last_activity_date": 1500470208, "creation_date": 1500469004, "question_id": 45191324, "link": "https://stackoverflow.com/questions/45191324/is-there-a-way-to-see-if-a-vba-function-is-used-in-excel", "title": "Is there a way to see if a VBA function is used in Excel?", "body": "<p>I am an intern working on cleaning up a horrible, horrible mess of a calculator made with Excel and VBA.  I've never really played with VBA in the past, so this is all very new to me, so please forgive me if I am asking the wrong questions, I am here to learn!</p>\n\n<p>The first thing I am trying to do is understand the order of operations in this whole mish-mash.  There are 12 excel sheets holding variables and tables for the calculator, and looking through them it <i>looks</i> like not all of the functions defined in the VBA side actually get called.  Unfortunately there are far to many cells for me to look through individually, so I was wondering if there was a way to do it from the VBA side in the editor (Microsoft Visual Basic for Applications) that comes with excel when you turn on the developer tools.</p>\n\n<p>I have tried commenting out entire functions, then updateing the code to observe if it breaks, but besides comparing the new output to an un-altered version of the sheet cell by cell, well... it's not really feasable if I want to finish it this month =(.  </p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>-James</p>\n\n<p>TL;DR:  Is there an easy way to check if a function is actually used in VBA?</p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1500468989, "post_id": 45191118, "comment_id": 77349677, "body": "can you please post the entire thing sequentially"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1500469001, "post_id": 45191118, "comment_id": 77349688, "body": "How many columns are in your listbox?"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1500469066, "post_id": 45191118, "comment_id": 77349740, "body": "@Nathan_Sav I only have one column"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1500469866, "post_id": 45191118, "comment_id": 77350414, "body": "@Nathan_Sav is this better?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1500470145, "post_id": 45191118, "comment_id": 77350656, "body": "You haven&#39;t dimensioned <code>listboxarr</code>. Either do this when you declare the variable or use Redim is the size is not known beforehand."}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1500470532, "post_id": 45191118, "comment_id": 77350998, "body": "@SJR So like this?      Dim listboxarr(1,1,500)     ReDim listboxarr(1,1,500)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1500470984, "post_id": 45191118, "comment_id": 77351381, "body": "If you know the size beforehand you don&#39;t need Redim. I think the syntax should be <code>Dim listboxarr(1 to 500)</code>."}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1500471340, "post_id": 45191118, "comment_id": 77351674, "body": "@SJR Do I need  <code>Dim i As Integer For i = 1 To 500 &#39;    v this is a listbox     With selecteditems         listboxarr(1) = .List(i, 1)     End With Next i</code> Or should I put it inside?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500471673, "post_id": 45192231, "comment_id": 77351982, "body": "Do i put <code>listboxarr(j)</code> in the body for the e-mail than or just <code>listboxarr()</code>"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500472237, "post_id": 45192231, "comment_id": 77352484, "body": "I got the error <b>Subscription out of Range</b> when putting <code>listboxarr(j)</code>"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500473058, "post_id": 45192231, "comment_id": 77353224, "body": "What do you want to appear in the body? listboxarr may contain multiple items in it. Also if no item was selected in the ListBox1, the listboxarr would be empty and you will get the error you are talking about."}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500473173, "post_id": 45192231, "comment_id": 77353317, "body": "I want all the items in listboaxarr to appear in the body"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500473294, "post_id": 45192231, "comment_id": 77353396, "body": "In addition, I thought, when I put it in from the other listbox, it&#39;s already selected"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500473518, "post_id": 45192231, "comment_id": 77353592, "body": "Is this Correct? <code>Listbox1.MultiSelect = i</code>"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500473668, "post_id": 45192231, "comment_id": 77353737, "body": "Better set the Multiselect property in the design mode in properties. To display all the comma separated items of the array listboxarr, try this:   .body = IIf(found, Join(listboxarr, &quot;, &quot;), &quot;No item selected&quot;)   . Also if you want a line break between the items in the body, replace &quot;, &quot; in the above line with VbCr"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500473800, "post_id": 45192231, "comment_id": 77353852, "body": "found is a Boolean variable to make sure the items in the ListBox1 were selected. See the edited code."}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500474839, "post_id": 45192231, "comment_id": 77354697, "body": "Nothing is appearing, just &quot;No Item Selected&quot;, I keep selecting them and they do not apppear"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500475787, "post_id": 45192231, "comment_id": 77355460, "body": "I am trying to figure, what&#39;s wrong and it seems like it&#39;s not recognizing the selected should I change to <code>SelectedItems(i)</code>?"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500475913, "post_id": 45192231, "comment_id": 77355576, "body": "I take that back it works, for some reason before it wasn&#39;t"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500553816, "post_id": 45192231, "comment_id": 77395458, "body": "I know you already helped me with this, but I was wondering, if you can help me  with one last thing and that is having it work with a multicolumn"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "edited": false, "score": 0, "creation_date": 1500553976, "post_id": 45192231, "comment_id": 77395594, "body": "Please open a new question with your new requirement and provide the full code you are currently having so that other members may also help you."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1500474265, "last_edit_date": 1500474265, "creation_date": 1500471259, "answer_id": 45192231, "question_id": 45191118, "link": "https://stackoverflow.com/questions/45191118/how-to-turn-listbox-to-text-for-excel-vba/45192231#45192231", "title": "How to turn Listbox to Text for Excel VBA", "body": "<p>If you have allowed the MultiSelect property for the listbox to True, try this...</p>\n\n<pre><code>Dim listboxarr()\nDim i As Long, j As Long\n\n'Assuming the name of your ListBox is ListBox1. If not, change it in the following code.\n\nWith Me.ListBox1\n    For i = 0 To .ListCount - 1\n        If .Selected(i) Then\n            j = j + 1\n            ReDim Preserve listboxarr(1 To j)\n            listboxarr(j) = .List(i)\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p><strong>Edited Code:</strong></p>\n\n<pre><code>Dim listboxarr()\nDim i As Long, j As Long\nDim found As Boolean\n\n'Assuming the name of your ListBox is ListBox1. If not, change it in the following code.\n\nWith Me.ListBox1\n    For i = 0 To .ListCount - 1\n        If .Selected(i) Then\n            found = True\n            j = j + 1\n            ReDim Preserve listboxarr(1 To j)\n            listboxarr(j) = .List(i)\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p>And then you can use it like below...</p>\n\n<pre><code>.body = IIf(found, Join(listboxarr, \", \"), \"No item selected\")\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 0, "accepted_answer_id": 45192231, "answer_count": 1, "score": 0, "last_activity_date": 1500474265, "creation_date": 1500468508, "last_edit_date": 1500469818, "question_id": 45191118, "link": "https://stackoverflow.com/questions/45191118/how-to-turn-listbox-to-text-for-excel-vba", "title": "How to turn Listbox to Text for Excel VBA", "body": "<p>I am trying to automatize an e-mail, but I am having a problem when I try to send lines from listbox; I have tried a few different ways none that were even close to working. In addition, I don't know how to use the column. I am currrently tryying to get it to work via</p>\n\n<pre><code>Dim listboxarr()\nDim i As Integer\n\nFor i = 1 To 500\n'    v this is a listbox\n     With selecteditems\n         listboxarr(1) = .List(i, 1)\n     End With\nNext i\n</code></pre>\n\n<p>This code throws me:</p>\n\n<blockquote>\n  <p>Subscription out of Range</p>\n</blockquote>\n\n<p>This is the code for the email:</p>\n\n<pre><code>Private Sub addcb_Click()\nDim iCtr As Long\n\nFor iCtr = 0 To Me.allitems.ListCount - 1\n    If Me.allitems.Selected(iCtr) = True Then\n        Me.selecteditems.AddItem Me.allitems.List(iCtr)\n    End If\nNext iCtr\n\nFor iCtr = Me.allitems.ListCount - 1 To 0 Step -1\n    If Me.allitems.Selected(iCtr) = True Then\n        Me.allitems.RemoveItem iCtr\n    End If\nNext iCtr\nEnd Sub\n\n\nPrivate Sub removecb_Click()\nDim iCtr As Long\n\nFor iCtr = 0 To Me.selecteditems.ListCount - 1\n    If Me.selecteditems.Selected(iCtr) = True Then\n        Me.allitems.AddItem Me.selecteditems.List(iCtr)\n    End If\nNext iCtr\n\nFor iCtr = Me.selecteditems.ListCount - 1 To 0 Step -1\n        If Me.selecteditems.Selected(iCtr) = True Then\n            Me.selecteditems.RemoveItem iCtr\n        End If\nNext iCtr\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n\nDim listboxarr()\nDim i As Integer\n\nFor i = 1 To 500\n'    v this is a listbox\n     With selecteditems\n         listboxarr(1) = .List(i, 1)\n     End With\nNext i\n\nDim OutApp As Object\nDim OutMail As Object\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\n    .to = \"Someone\"\n    .CC = \"Someone else\"\n    .BCC = \"\"\n    .Subject = \"Something\"\n    .Body = listboxarr(1) \nEnd With\nOn Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nPrivate Sub UserForm_Initialize()\n\nDim itemsheet As Worksheet\nSet itemsheet = Application.ActiveWorkbook.Sheets(6)\n\nFor Each itemname In itemsheet.Range(\"C2:C3285\")\n    With Me.allitems\n       .AddItem itemname.Value\n    End With\nNext itemname\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "automation", "click"], "comments": [{"owner": {"reputation": 71, "user_id": 4978968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0390669cc328b1660a217d42cd0d5f65?s=128&d=identicon&r=PG&f=1", "display_name": "noas", "link": "https://stackoverflow.com/users/4978968/noas"}, "edited": false, "score": 0, "creation_date": 1500476159, "post_id": 45190952, "comment_id": 77355788, "body": "Did you tried <code>If InStr(IE.innerText, &quot;OH - Bill Lading of Lading&quot;) &gt; 0 Then IE.href</code>"}, {"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "reply_to_user": {"reputation": 71, "user_id": 4978968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0390669cc328b1660a217d42cd0d5f65?s=128&d=identicon&r=PG&f=1", "display_name": "noas", "link": "https://stackoverflow.com/users/4978968/noas"}, "edited": false, "score": 1, "creation_date": 1500478717, "post_id": 45190952, "comment_id": 77357816, "body": "Yes just tried it, still gives me an error"}, {"owner": {"reputation": 71, "user_id": 4978968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0390669cc328b1660a217d42cd0d5f65?s=128&d=identicon&r=PG&f=1", "display_name": "noas", "link": "https://stackoverflow.com/users/4978968/noas"}, "edited": false, "score": 0, "creation_date": 1500488588, "post_id": 45190952, "comment_id": 77363685, "body": "What is the error you get? Or just nothing happens when you run the macro."}, {"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "reply_to_user": {"reputation": 71, "user_id": 4978968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0390669cc328b1660a217d42cd0d5f65?s=128&d=identicon&r=PG&f=1", "display_name": "noas", "link": "https://stackoverflow.com/users/4978968/noas"}, "edited": false, "score": 1, "creation_date": 1500491912, "post_id": 45190952, "comment_id": 77365644, "body": "Run-time error &#39;91&#39;:  Object variable or With Block variable note set  and if i erase the 2nd macro, the first macro works fine with just putting in a number in the website and hitting the search.  But i don&#39;t see what object there is, and i&#39;m not using any &quot;with&quot; commands in the 2nd macro."}, {"owner": {"reputation": 71, "user_id": 4978968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0390669cc328b1660a217d42cd0d5f65?s=128&d=identicon&r=PG&f=1", "display_name": "noas", "link": "https://stackoverflow.com/users/4978968/noas"}, "edited": false, "score": 0, "creation_date": 1500546201, "post_id": 45190952, "comment_id": 77389908, "body": "You should read  <a href=\"http://www.cpearson.com/excel/byrefbyval.aspx\" rel=\"nofollow noreferrer\">Passing Variables By Reference And By Value</a>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532464765, "post_id": 45190952, "comment_id": 89983423, "body": "Could you provide more of the HTML? I am also concerned about the appearance of what I assume to be &lt;a&gt; tags but are missing angle brackets."}, {"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1532523726, "post_id": 45190952, "comment_id": 90007848, "body": "@QHarr unfortunately this question was so long ago at a previous job i don&#39;t remember.  Sorry."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532523821, "post_id": 45190952, "comment_id": 90007918, "body": "No worries. But thank you for getting back to me. I appreciate that."}], "owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1500468073, "creation_date": 1500468073, "question_id": 45190952, "link": "https://stackoverflow.com/questions/45190952/how-to-click-on-a-hyperlink-aspx-page-and-save", "title": "How to click on a hyperlink (aspx page) and save", "body": "<p>The hyperlink i'm trying to click using VBA looks like:</p>\n\n<pre> a id=SearchResults_dgResults__ctl5_lnkbtnGetImage \nclass=ItemStyle style=\"FONT-SIZE: 10pt; FONT-FAMILY: Arial\" href=\"javascript:__doPostBack\n('SearchResults$dgResults$_ctl5$lnkbtnGetImage','')\">OH - House Bill of Lading /a </pre>\n\n<p>I already got the VBA code to take a numerical value from cell A1 from excel sheet 1 to prefill a search box, click the search button, and list several hyperlinks.  I need the 2nd part of the code to click on a particular hyperlink titled \"OH - House Bill of Lading\" (above).  I don't know if its because this is an aspx page but i've tried googling and using other codes but to no avail.  </p>\n\n<p>The code i have so far is:</p>\n\n<pre>\nPublic Sub IE_Search_and_Extract()\n\n    Dim URL As String\n    Dim IE As SHDocVw.InternetExplorer\n    Dim htmlInput As MSHTML.HTMLInputElement\n    Dim htmlColl As MSHTML.IHTMLElementCollection\n    Dim HTMLdoc As HTMLDocument\n\n\n    URL = \"http://eglsiis12c.egl.corp/docvisionsearch/DocVisionSearch.aspx\"\n\n    Set IE = Get_IE_Window(URL)\n    If IE Is Nothing Then\n        Set IE = New SHDocVw.InternetExplorer\n    End If\n\n    With IE\n        SetForegroundWindow .hwnd\n        .Navigate URL\n        .Visible = True\n        While .Busy Or .ReadyState  READYSTATE_COMPLETE\n            DoEvents\n        Wend\n\n\n        .Document.getElementById(\"House1_txtHouseBillNum\").Value = ActiveSheet.Cells(1, 1)\n        .Document.getElementById(\"House1:btnHouseSearch\").Click\n\n\n        While .Busy Or .ReadyState  READYSTATE_COMPLETE\n            DoEvents\n        Wend\n\nEnd With\nCall Uppercase\nEnd Sub\n\n\nSub Uppercase()\n\nDim IE As SHDocVw.InternetExplorer\n\nSet IE = IE.Document.getElementsByTagName(\"a\")\n\nFor Each IE In IE.Document.getElementsByTagName(\"a\")\n    If InStr(IE.innerText, \"OH - Bill Lading of Lading\") > 0 Then IE.Click\nNext\n\n\n\n\n\n\nEnd Sub</pre>\n\n<p>I tried doing it as 2 separate macros hence the call uppercase.  Any suggestions? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 3, "creation_date": 1500468745, "post_id": 45190903, "comment_id": 77349439, "body": "The only things I&#39;m seeing immediately is &quot;Autofilter , Field&quot; where that &quot;, &quot; isn&#39;t needed and the criteria might need to be &quot;=Mon&quot;."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500469204, "post_id": 45190903, "comment_id": 77349858, "body": "I&#39;m getting same error but I&#39;m also working on a brand new computer using Excel 2016 for the very first time so not sure I can be much help (this is also causing my Excel to freeze and do other weird stuff, which is beyond unexpected)."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1500470889, "post_id": 45191790, "comment_id": 77351295, "body": "The comma will raise a wildly different runtime error (object has disconnected from its client). The criteria <i>might</i> need to be <code>&quot;=&quot; &amp; Mon</code> bot definitely not the literal string <code>&quot;=Mon&quot;</code> :)"}, {"owner": {"reputation": 17, "user_id": 7857201, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d62fc5a27bca1b5d155e7596d25a31f9?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Smith", "link": "https://stackoverflow.com/users/7857201/anna-smith"}, "edited": false, "score": 0, "creation_date": 1500472251, "post_id": 45191790, "comment_id": 77352499, "body": "Hi all,                                                                                                  ActiveSheet.Range(&quot;A1:E1&quot;).AutoFilter Field:=3, Criteria1:&quot;=&quot; &amp; Mon , Operator:=xlFilterValues .................gives me a compiler error"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1500472979, "post_id": 45191790, "comment_id": 77353139, "body": "Should be rather <code>Criteria1:=&quot;=&quot; &amp; Mon</code>. You want to have <code>&quot;=&quot; &amp; Mon</code> as a value of criteria."}], "tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": true, "score": 1, "last_activity_date": 1500471241, "last_edit_date": 1500471241, "creation_date": 1500470190, "answer_id": 45191790, "question_id": 45190903, "link": "https://stackoverflow.com/questions/45190903/run-time-error-1004-autofilter-method-of-range-class-failed/45191790#45191790", "title": "run-time error &#39;1004&#39;: Autofilter method of range class failed", "body": "<p>Problems in your code are:</p>\n\n<ol>\n<li>What @Cyril said in comments with update from @DavidZemens</li>\n</ol>\n\n<blockquote>\n  <p><code>\"Autofilter , Field\"</code> where that \", \" isn't needed and the criteria might need to be <code>\"=\" &amp; Mon</code></p>\n</blockquote>\n\n<ol start=\"2\">\n<li>You cannot set manually <code>ActiveSheet.AutoFilterMode = True</code>, but it's set automatically when calling <code>ActiveSheet.Range(\"A1:E1\").AutoFilter ...</code>. You can only set <code>ActiveSheet.AutoFilterMode = False</code> to turn the AutoFilter off.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11771974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5772de929a868ae11a7e783617db6af5?s=128&d=identicon&r=PG&f=1", "display_name": "jackw454", "link": "https://stackoverflow.com/users/11771974/jackw454"}, "is_accepted": false, "score": 0, "last_activity_date": 1616097607, "creation_date": 1616097607, "answer_id": 66698298, "question_id": 45190903, "link": "https://stackoverflow.com/questions/45190903/run-time-error-1004-autofilter-method-of-range-class-failed/66698298#66698298", "title": "run-time error &#39;1004&#39;: Autofilter method of range class failed", "body": "<p>I'm not sure if this is already resolved (it's years old) but I had a similar error '1004': Autofilter method of range class failed today and it turned out that the data I was supposed to be filtering was in a table and that borked it.  (The user who sends the report changed how they send it)</p>\n<p>De-tabling the data (Convert Table to Range) resolved my issue.  Maybe this will help someone else.</p>\n"}], "owner": {"reputation": 17, "user_id": 7857201, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d62fc5a27bca1b5d155e7596d25a31f9?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Smith", "link": "https://stackoverflow.com/users/7857201/anna-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8436, "favorite_count": 0, "accepted_answer_id": 45191790, "answer_count": 2, "score": 0, "last_activity_date": 1616097607, "creation_date": 1500467964, "last_edit_date": 1500469581, "question_id": 45190903, "link": "https://stackoverflow.com/questions/45190903/run-time-error-1004-autofilter-method-of-range-class-failed", "title": "run-time error &#39;1004&#39;: Autofilter method of range class failed", "body": "<p>I have used a small code in vba which gives me this error::</p>\n\n<pre><code>Dim today As Date\nDim Mon As Integer\n\ntoday = VBA.Date()\nMon = Month(today)\n\nSheets(\"Birthday List\").Activate\nActiveSheet.AutoFilterMode = False\nActiveSheet.Range(\"A1:E1\").AutoFilter , Field:=3, Criteria1:=Mon, Operator:=xlFilterValues\nActiveSheet.AutoFilterMode = True\n</code></pre>\n\n<p>Could you please help me how to correct it</p>\n\n<p>regards\nAnna Smith</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4203, "user_id": 2119523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fkQjy.jpg?s=128&g=1", "display_name": "Netloh", "link": "https://stackoverflow.com/users/2119523/netloh"}, "is_accepted": false, "score": 2, "last_activity_date": 1524599658, "last_edit_date": 1524599658, "creation_date": 1500470139, "answer_id": 45191773, "question_id": 45190863, "link": "https://stackoverflow.com/questions/45190863/copy-charts-from-one-sheet-to-another/45191773#45191773", "title": "Copy Charts from one sheet to another", "body": "<p>You should try to make use of a copy/paste technique, like the below.</p>\n\n<pre><code>Sub overview1()\n    Dim OutSht As Worksheet\n    Dim Chart As ChartObject\n    Dim PlaceInRange As Range\n\n    Set OutSht = ActiveWorkbook.Sheets(\"Overview_1\") '&lt;~~ Output sheet\n    Set PlaceInRange = OutSht.Range(\"B2:J21\")        '&lt;~~ Output location\n\n    'Loop charts\n    For Each Chart In Sheets(\"CAT\").ChartObjects\n        'Copy/paste charts\n        Chart.Copy\n        OutSht.Paste PlaceInRange\n    Next Chart\n\nEnd Sub\n</code></pre>\n\n<p>This is just a simple example which should keep you going. Obviously this example pastes all charts in the exact same locataion in the output sheet, which probably isn't what you are looking for.</p>\n"}], "owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7394, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524599658, "creation_date": 1500467862, "question_id": 45190863, "link": "https://stackoverflow.com/questions/45190863/copy-charts-from-one-sheet-to-another", "title": "Copy Charts from one sheet to another", "body": "<p>I have two Sheets, and would like to copy the Chart from sheet1 to sheet2. </p>\n\n<p>I am using the below code, the code is removing the Chart from Sheet1  and pasting them into sheet2. Instead, I would just like to have the duplicate of the Chart. </p>\n\n<p>ALso, I would like to have my Charts in particular range. How can I edit them ? </p>\n\n<p>Anylead would be helpful </p>\n\n<pre><code> Sub overview1()\n    Dim chartobj As Object\n    For Each chartobj In Sheets(\"CAT\").ChartObjects\n    chartobj.chart.Location xlLocationAsObject, \"Overview_1\"\n\n    Next chartobj\n    For Each chartobj In Sheets(\"Dev\").ChartObjects\n    chartobj.chart.Location xlLocationAsObject, \"Overview_1\"\n    Next chartobj\nEnd sub\n</code></pre>\n"}, {"tags": ["vba", "module", "userform"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8313021, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/122078678403309/picture?type=large", "display_name": "G&#246;khan Av\u015far", "link": "https://stackoverflow.com/users/8313021/g%c3%b6khan-av%c5%9far"}, "edited": false, "score": 0, "creation_date": 1500468490, "post_id": 45190604, "comment_id": 77349192, "body": "What i tried to do is defining variable all macro , it can be seen userform and module. For example, when &quot;x&quot; value is 2 in the module, i have to be 2 in the userform"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 43, "user_id": 8313021, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/122078678403309/picture?type=large", "display_name": "G&#246;khan Av\u015far", "link": "https://stackoverflow.com/users/8313021/g%c3%b6khan-av%c5%9far"}, "edited": false, "score": 0, "creation_date": 1500468636, "post_id": 45190604, "comment_id": 77349333, "body": "I think a more accurate statement would be, &quot;I still haven&#39;t figured out what I &#39;m doing incorrectly.&quot;   I&#39;ll leave my answer up because the way you had the Dim initially setup was 100% certain to always isolate within the procedure and might help someone else searching for the same problem. I don&#39;t know what else you&#39;re doing, but something is out of order, or not part of the same procedure which is reseting, or never setting your x value."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1500467267, "creation_date": 1500467267, "answer_id": 45190604, "question_id": 45190260, "link": "https://stackoverflow.com/questions/45190260/using-same-variables-both-module-and-userform/45190604#45190604", "title": "Using same Variables both Module and UserForm", "body": "<p>In your second example, you have the <code>Dim X As Long</code> in the click macro. This will narrow the scope to that range only, which is why it's always equaling zero.</p>\n\n<p>I can't see exactly what you're trying to do, but consider, putting X outside of the click macro, at the top of the Userform code.</p>\n\n<pre><code>Dim x As Long 'put here instead, at top of code editor\nPrivate Sub CommandButton1_Click()\n\nCells(x + 1, 8).Value = cmbStok.Value\nUnload UserForm2\nEnd Sub\n\n\n\nPrivate Sub UserForm_Initialize()\n\ntxtResimNo.Text = CStr(ThisWorkbook.Sheets(\"Sheet1\").Range(\"B2\").Value)\ntxtRev.Text = CStr(ThisWorkbook.Sheets(\"Sheet1\").Range(\"C2\").Value)\nTxtAc\u0131k.Text = CStr(ThisWorkbook.Sheets(\"Sheet1\").Range(\"B2\").Value)\n\n\ncmbStok.AddItem \"A: Stoktaki par\u00e7alar kullan\u0131lacakt\u0131r\"\ncmbStok.AddItem \"B: Stoktaki par\u00e7alar tadil edildikten sonra kullan\u0131lacakt\u0131r\"\ncmbStok.AddItem \"C: Stoktaki par\u00e7alar tadil edilemez, de\u011fi\u015fiklikten \u00f6nceki cihazlar i\u00e7in yedek par\u00e7a olarak kullan\u0131labilir\"\ncmbStok.AddItem \"D: Stoktaki par\u00e7alar tadil edilemez ve kullan\u0131lamaz\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1500470023, "creation_date": 1500470023, "answer_id": 45191720, "question_id": 45190260, "link": "https://stackoverflow.com/questions/45190260/using-same-variables-both-module-and-userform/45191720#45191720", "title": "Using same Variables both Module and UserForm", "body": "<p>You need to define your variables as global at the top of the modul.\n<code>global x as long</code>. It is not sufficient to write it as <code>dim x as long</code>. Then, remove the all other definitions for <code>x</code> in your code.</p>\n\n<p>And the usual side note: Always put <code>option explicit</code> at the top of every modul.</p>\n"}], "owner": {"reputation": 43, "user_id": 8313021, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/122078678403309/picture?type=large", "display_name": "G&#246;khan Av\u015far", "link": "https://stackoverflow.com/users/8313021/g%c3%b6khan-av%c5%9far"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 45191720, "answer_count": 2, "score": 0, "last_activity_date": 1500470023, "creation_date": 1500466463, "last_edit_date": 1500467845, "question_id": 45190260, "link": "https://stackoverflow.com/questions/45190260/using-same-variables-both-module-and-userform", "title": "Using same Variables both Module and UserForm", "body": "<p>I tried to use the same variable at module and user, but I was not successful. I have tried to use \"Public\" but the user form \"x\" always equals 0.\nCan anyone tell me where I made a mistake?</p>\n\n<p>Here I want to call UserForm n times </p>\n\n<pre><code>' UserForm2.Show\n    '  For x = 1 To n\n      '  UserForm2.Show\n     ' Next x\n</code></pre>\n\n<p>And here when I use UserForm every time, it should have stored the value I entered to the cells</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim x As Long\nCells(x + 1, 8).Value = cmbStok.Value\nUnload UserForm2\n\n\nEnd Sub\n\n\n\nPrivate Sub UserForm_Initialize()\n\ntxtResimNo.Text = CStr(ThisWorkbook.Sheets(\"Sheet1\").Range(\"B2\").Value)\ntxtRev.Text = CStr(ThisWorkbook.Sheets(\"Sheet1\").Range(\"C2\").Value)\nTxtAc\u0131k.Text = CStr(ThisWorkbook.Sheets(\"Sheet1\").Range(\"B2\").Value)\n\n\ncmbStok.AddItem \"A: Stoktaki par\u00e7alar kullan\u0131lacakt\u0131r\"\ncmbStok.AddItem \"B: Stoktaki par\u00e7alar tadil edildikten sonra kullan\u0131lacakt\u0131r\"\ncmbStok.AddItem \"C: Stoktaki par\u00e7alar tadil edilemez, de\u011fi\u015fiklikten \u00f6nceki cihazlar i\u00e7in yedek par\u00e7a olarak kullan\u0131labilir\"\ncmbStok.AddItem \"D: Stoktaki par\u00e7alar tadil edilemez ve kullan\u0131lamaz\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 6504337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1e942c50c89e6f2f1f9a3435bc24e943?s=128&d=identicon&r=PG&f=1", "display_name": "marhyno", "link": "https://stackoverflow.com/users/6504337/marhyno"}, "edited": false, "score": 0, "creation_date": 1500467430, "post_id": 45190370, "comment_id": 77348309, "body": "well nope, now its somewhere in the middle, and I tried changing the numbers, + and - and more but no luck, either its more on the left side or completely out of cell, in the next one"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 535, "user_id": 6504337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1e942c50c89e6f2f1f9a3435bc24e943?s=128&d=identicon&r=PG&f=1", "display_name": "marhyno", "link": "https://stackoverflow.com/users/6504337/marhyno"}, "edited": false, "score": 0, "creation_date": 1500467741, "post_id": 45190370, "comment_id": 77348562, "body": "Add a statement <code>Debug.print .Width</code> before the <code>end with</code> - what is the width of the checkbox (should be 15.75) ?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 535, "user_id": 6504337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1e942c50c89e6f2f1f9a3435bc24e943?s=128&d=identicon&r=PG&f=1", "display_name": "marhyno", "link": "https://stackoverflow.com/users/6504337/marhyno"}, "edited": false, "score": 0, "creation_date": 1500468169, "post_id": 45190370, "comment_id": 77348908, "body": "Hmm. Then try something like <code>.Left = t.Left + t.Width - 16</code> and play with the number until it fits."}, {"owner": {"reputation": 535, "user_id": 6504337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1e942c50c89e6f2f1f9a3435bc24e943?s=128&d=identicon&r=PG&f=1", "display_name": "marhyno", "link": "https://stackoverflow.com/users/6504337/marhyno"}, "edited": false, "score": 0, "creation_date": 1500468520, "post_id": 45190370, "comment_id": 77349221, "body": "tried that, what is really strange is that I cannot find optimal number, e.g. I use  .Left = t.Left + 45 ... and its somewhere in the middle and when I use  .Left = t.Left + 47 its completely out of the cell"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 535, "user_id": 6504337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1e942c50c89e6f2f1f9a3435bc24e943?s=128&d=identicon&r=PG&f=1", "display_name": "marhyno", "link": "https://stackoverflow.com/users/6504337/marhyno"}, "edited": false, "score": 0, "creation_date": 1500469387, "post_id": 45190370, "comment_id": 77350020, "body": "Do I understand it correct: You place a button in the sheet (cell) and on top of that the checkbox? Can you try without the button?"}, {"owner": {"reputation": 535, "user_id": 6504337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1e942c50c89e6f2f1f9a3435bc24e943?s=128&d=identicon&r=PG&f=1", "display_name": "marhyno", "link": "https://stackoverflow.com/users/6504337/marhyno"}, "edited": false, "score": 0, "creation_date": 1500471842, "post_id": 45190370, "comment_id": 77352142, "body": "I dont want to put it on the top, makro does it and I dont know why, Button should be on the left side and checkbox should be on the right side of that one cell"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1500466718, "creation_date": 1500466718, "answer_id": 45190370, "question_id": 45189906, "link": "https://stackoverflow.com/questions/45189906/excel-vba-position-of-checkbox-inside-of-the-cell/45190370#45190370", "title": "Excel VBA - position of checkbox inside of the cell", "body": "<p>Try</p>\n\n<pre><code>Set chkbx = ActiveSheet.CheckBoxes.Add(t.Left, t.Top, 0, 0)\nWith chkbx\n    .Name = \"CheckBox_\" &amp; x\n    .Caption = \"\"\n    .Left = t.Left + t.Width - .Width\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 6504337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1e942c50c89e6f2f1f9a3435bc24e943?s=128&d=identicon&r=PG&f=1", "display_name": "marhyno", "link": "https://stackoverflow.com/users/6504337/marhyno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500466718, "creation_date": 1500465619, "question_id": 45189906, "link": "https://stackoverflow.com/questions/45189906/excel-vba-position-of-checkbox-inside-of-the-cell", "title": "Excel VBA - position of checkbox inside of the cell", "body": "<p>I cannot position my checkbox to the right side of the cell. </p>\n\n<p>Macro adds button to specific cell to the left top corner, but when I want to Add also checkbox to the same cell it wont go to the right side, how can I do that ? Apparently the number 50 in the line Set chkbx is used to set the position. But my checkbox only goes to the left when I change it to the negative number. But it wont go to the right. How can I do it ?</p>\n\n<pre><code>Set t = ActiveSheet.Range(Cells(10, NewColumn), Cells(10, NewColumn))\nSet btn = ActiveSheet.Buttons.Add(t.Left, t.Top, 0, 0)\nWith btn\n  .OnAction = \"Button_clicked\"\n  .Caption = \"X\"\n  .Width = 15\n  .Height = 12\n  .Name = \"Delete_button_\" &amp; x\nEnd With\n</code></pre>\n\n<p>/<em>HERE IS THE CHECKBOX I WANT TO HAVE IN THE RIGHT UPPER CORNER</em>/</p>\n\n<pre><code>Set chkbx = ActiveSheet.CheckBoxes.Add(t.Left, t.Top, 50, 0)\nWith chkbx\n    .Name = \"CheckBox_\" &amp; x\n    .Caption = \"\"\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MzHYE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MzHYE.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1500548728, "post_id": 45189799, "comment_id": 77391587, "body": "I&#39;m thinking this question should be rolled back to a previous edit - you&#39;re updating your question with the responses supplied in the answer, so no one knows what your original code looks like unless they look through your edits.  (also the the supplied answer shouldn&#39;t be in a loop - it works on all records in one hit)."}, {"owner": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1500549250, "post_id": 45189799, "comment_id": 77391897, "body": "I did it without a loop and it assigned a null value to all the matched !"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1500552818, "post_id": 45189799, "comment_id": 77394706, "body": "It worked for me using the figures in your post.  You&#39;re not using it with VBA are you?  Just add the SQL as a new query and run it."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "edited": false, "score": 0, "creation_date": 1500534965, "post_id": 45195704, "comment_id": 77381567, "body": "Thank you for your reply.. I updated the code with you suggestions as you can see above in my code, but I got an error says syntax error in the update?"}, {"owner": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "edited": false, "score": 0, "creation_date": 1500547375, "post_id": 45195704, "comment_id": 77390661, "body": "there is an issue I just noticed is that it will add the same value to all the matched rows! why is that happing? Am I doing something wrong in my loop?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "edited": false, "score": 0, "creation_date": 1500559585, "post_id": 45195704, "comment_id": 77400501, "body": "Why is the update query in a loop? This answer avoids any VBA. It updates all needed rows. Just run the SQL query <b>once</b> with <code>DoCmd.OpenQuery &quot;myupdatequery&quot;</code>. If problem persists without loop, edit post with data to show how it <i>adds the same value to all matched rows</i> (unclear as update does not add)."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 3, "last_activity_date": 1500480261, "creation_date": 1500480261, "answer_id": 45195704, "question_id": 45189799, "link": "https://stackoverflow.com/questions/45189799/access-vba-sql-that-match-only-one/45195704#45195704", "title": "Access vba sql that match only one", "body": "<p>Consider a pure SQL solution with a nuanced <code>UPDATE</code> query that includes a subquery in <code>WHERE</code> clause, a conditional <code>IIF()</code>, and domain aggregate, <code>DLookUp</code>.</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>UPDATE myTable t\nSET t.N2 = IIF(t.N2 = -99, DLookUp(\"N1-N2\", \"myTable\", \"[Name]='\" &amp; t.[Name] &amp; \"' AND N2 &lt;&gt; -99\"), N2)\nWHERE t.[Name] IN (SELECT t.[Name]\n                   FROM myTable t\n                   GROUP BY t.[Name]\n                   HAVING (Count(t.[Name]) = 2) \n                      AND (Min(t.N2) &lt;&gt; Max(t.N2)) \n                      AND (Min(t.N2) = -99 OR Max(t.N2) = -99))\n</code></pre>\n\n<p>Before table</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Name    N1   N2\nA      500  300\nA        0  -99\nB       60  -99\nB       77  -99\nC        0  -99\nC       15  100\nC       30   -9\n</code></pre>\n\n<p>After table</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Name    N1   N2\nA      500  300\nA        0  200\nB       60  -99\nB       77  -99\nC        0  -99\nC       15  100\nC       30   -9\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 3, "accepted_answer_id": 45195704, "answer_count": 1, "score": 2, "last_activity_date": 1594639476, "creation_date": 1500465333, "last_edit_date": 1594639476, "question_id": 45189799, "link": "https://stackoverflow.com/questions/45189799/access-vba-sql-that-match-only-one", "title": "Access vba sql that match only one", "body": "<p>I have a table that has several repeated records. So I want to take those that were repeated twice and then check if only one of them is having a value of -99 in the total column, so if both of them have -99 it will ignore them but if only one of them has -99 than it will take the values of the second to calculate them and assign the result to the one with -99.</p>\n\n<pre><code>---------------------------------------------\nName        | N1           | N2              |\n----------------------------------------------\nA           | 500          | 300             |\n----------------------------------------------\nA           | 0            | **-99**         |\n----------------------------------------------\nB           | 60           | -99             |\n----------------------------------------------\nB           | 77           | -99             |\n----------------------------------------------\nC           | 0            | -99             |\n----------------------------------------------\nC           | 15           | 100             |\n----------------------------------------------\nC           | 30           | -9              |\n----------------------------------------------\n</code></pre>\n\n<p>For example here it will ignore B because both are having -99 AND C because count=3, but for A it will update the -99 row to be: 500-300 =200</p>\n\n<pre><code>---------------------------------------------\nName        | N1           | N2              |\n----------------------------------------------\nA           | 500          | 300             |\n----------------------------------------------\nA           | 0            | **200**         |\n----------------------------------------------\n</code></pre>\n\n<p>I've done some of the code but didn't know ho to complete it:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>        Private Sub GET_TWO_COU()\n\n            Dim COUs As Variant\n            Dim p As Variant\n            Dim sql As String\n            Dim STR As New ADODB.Recordset\n\n\n     sql = \"SELECT DISTINCT NAME FROM STR_TBL\"\n    STR.Open sql, cnn, adOpenStatic\n    STR.MoveLast\n    STR.MoveFirst\n    COUs = STR.GetRows(STR.RecordCount)\n    STR.Close\n\n    For Each p In COUs \n\n      Q1 = \"SELECT NAME FROM STR_TBL\"\n        STR.Open sql, cnn, adOpenStatic\n\n       Do Until STR.EOF\n       DoEvents\n               sql = \" UPDATE STR_TBL I\" _\n                    &amp; \"Set I.N2 = IIf(I.N2 = -99, DLookup(\"\"N1 - N2\"\" ,\" _\n                    &amp; \"\"\"STR_TBL\"\" , '\"[NAME] ='\" &amp; p &amp; \"' AND N2&lt;&gt; -99\"\"), N2)\" _\n                    &amp; \"WHERE I.[NAME] IN (SELECT I.[NAME] FROM STR_TBL I\" _\n                    &amp; \" GROUP BY I.[NAME] HAVING (Count(I.[NAME]) = 2)\" _\n                    &amp; \"AND (Min(I.N2) &lt;&gt; Max(I.N2))AND (Min(I.N2) = -99 OR Max(I.N2) = -99))\"\n\n            DoCmd.SetWarnings False\n            DoCmd.RunSQL sql\n            DoCmd.SetWarnings True\n                      STR.MoveNext\n           Loop\n           STR.Close\nNEXT\n\n     End Sub\n</code></pre>\n\n<p>NOTE: CODE UPDATED</p>\n\n<p>The other issue is that it will add the same value to all the matched rows! why is that happing? Am I doing something wrong in my loop?</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1500466259, "post_id": 45189789, "comment_id": 77347330, "body": "You&#39;re talking about column C, but your macro doesn&#39;t touch column C at all. Can you provide more information about your problem?"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 1, "creation_date": 1500466776, "post_id": 45190237, "comment_id": 77347760, "body": "Your last code worked perfect. Thanks for your ninja-edit, and great help. Cheers to you."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 1, "last_activity_date": 1500466405, "creation_date": 1500466405, "answer_id": 45190237, "question_id": 45189789, "link": "https://stackoverflow.com/questions/45189789/macro-wont-stop-when-value-in-column-is-empty/45190237#45190237", "title": "Macro won&#39;t stop when value in Column is empty", "body": "<p>Try updating this part...</p>\n\n<pre><code>For Each cl In Table1.cells\nSet rng = Table2.Find(cl, SearchDirection:=xlPrevious, LookAt:=xlWhole)\nIf Not rng Is Nothing Then\n    sht.Cells(Dept_Row, Dept_Clm) = sht2.Cells(rng.Row, 6).Value\nelse\nExit For 'exits the loop\n\nEnd If\nDept_Row = Dept_Row + 1\nNext cl\n</code></pre>\n\n<p>I'm not sure if that's the right part you want to exit the loop. Another way would just be... </p>\n\n<pre><code>For Each cl In Table1.cells\nIf Isempty(cl) then\n    Exit Sub 'this completely exits the macro\nEndif\nSet rng = Table2.Find(cl, SearchDirection:=xlPrevious, LookAt:=xlWhole)\nIf Not rng Is Nothing Then\n    sht.Cells(Dept_Row, Dept_Clm) = sht2.Cells(rng.Row, 6).Value\n\nEnd If\nDept_Row = Dept_Row + 1\nNext cl\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 45190237, "answer_count": 1, "score": 0, "last_activity_date": 1500466405, "creation_date": 1500465304, "question_id": 45189789, "link": "https://stackoverflow.com/questions/45189789/macro-wont-stop-when-value-in-column-is-empty", "title": "Macro won&#39;t stop when value in Column is empty", "body": "<p>I'm using below code populate a column in my main Sheet (referred to as sht in code). In this sheet (sht) i want the macro to stop when it hits an empty cell in Column C, when coming down from C85. How would i go and pursue this goal?</p>\n\n<pre><code>Sub VTZ()\n\nDim sht As Worksheet, sht2 As Worksheet\nSet sht = Sheets(\"16-Compliancy-Rebuild\")\nSet sht2 = Sheets(\"OpmerkingBackup\")\nDim Table1 As Range\nDim Table2 As Range\nDim Dept_Row As Long\nDim Dept_Clm As Long\nDim rng As Range\nSet Table1 = sht.Range(\"D85:D1185\")\nSet Table2 = sht2.Range(\"B3:B1103\")\nDept_Row = sht.Range(\"H85\").Row\nDept_Clm = sht.Range(\"H85\").Column\nFor Each cl In Table1\nSet rng = Table2.Find(cl, SearchDirection:=xlPrevious, LookAt:=xlWhole)\nIf Not rng Is Nothing Then\n    sht.Cells(Dept_Row, Dept_Clm) = sht2.Cells(rng.Row, 6).Value\nEnd If\nDept_Row = Dept_Row + 1\nNext cl\nMsgBox \"Done\"\nEnd Sub\n</code></pre>\n\n<p>Tried alot of Googling on forehand and can't seem to find the right way to do this. </p>\n"}, {"tags": ["vba", "excel", "csv", "export-to-csv", "delimiter"], "answers": [{"tags": [], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "is_accepted": true, "score": 0, "last_activity_date": 1500732376, "creation_date": 1500732376, "answer_id": 45255450, "question_id": 45189564, "link": "https://stackoverflow.com/questions/45189564/how-can-defining-fields-delimiter-character-encoding-and-records-seperator-cr/45255450#45255450", "title": "How can Defining fields delimiter character, Encoding and Records seperator ({CR}{LF}) for CSV files in export (Save As) from Excel by VBA", "body": "<pre><code>Option Explicit\n\nConst strDelimiter = \"\"\"\"\nConst strDelimiterEscaped = strDelimiter &amp; strDelimiter\nConst strSeparator = \",\"\nConst strRowEnd = vbCrLf\nConst strCharset = \"utf-8\"\n\nFunction CsvFormatString(strRaw As String) As String\n\n    Dim boolNeedsDelimiting As Boolean\n\n    boolNeedsDelimiting = InStr(1, strRaw, strDelimiter) &gt; 0 _\n        Or InStr(1, strRaw, Chr(10)) &gt; 0 _\n        Or InStr(1, strRaw, strSeparator) &gt; 0\n\n    CsvFormatString = strRaw\n\n    If boolNeedsDelimiting Then\n        CsvFormatString = strDelimiter &amp; _\n            Replace(strRaw, strDelimiter, strDelimiterEscaped) &amp; _\n            strDelimiter\n    End If\n\nEnd Function\n\nFunction CsvFormatRow(rngRow As Range) As String\n\n    Dim arrCsvRow() As String\n    ReDim arrCsvRow(rngRow.Cells.Count - 1)\n    Dim rngCell As Range\n    Dim lngIndex As Long\n\n    lngIndex = 0\n\n    For Each rngCell In rngRow.Cells\n        arrCsvRow(lngIndex) = CsvFormatString(rngCell.Text)\n        lngIndex = lngIndex + 1\n    Next rngCell\n\n\n    CsvFormatRow = Join(arrCsvRow, \",\") &amp; strRowEnd\n\nEnd Function\n\nSub CsvExportRange( _\n        rngRange As Range, _\n        Optional strFileName As Variant _\n    )\n\n    Dim rngRow As Range\n    Dim objStream As Object\n\n    If IsMissing(strFileName) Or IsEmpty(strFileName) Then\n        strFileName = Application.GetSaveAsFilename( _\n            InitialFileName:=ActiveWorkbook.Path &amp; \"\\\" &amp; rngRange.Worksheet.Name &amp; \".csv\", _\n            FileFilter:=\"CSV (*.csv), *.csv\", _\n            Title:=\"Export CSV\")\n    End If\n\n    Set objStream = CreateObject(\"ADODB.Stream\")\n    objStream.Type = 2\n    objStream.Charset = strCharset\n    objStream.Open\n\n    For Each rngRow In rngRange.Rows\n        objStream.WriteText CsvFormatRow(rngRow)\n    Next rngRow\n\n    objStream.SaveToFile strFileName, 2\n    objStream.Close\n\nEnd Sub\n\nSub CsvExportSelection()\n    CsvExportRange ActiveWindow.Selection\nEnd Sub\n\nSub CsvExportSheet(varSheetIndex As Variant)\n\n    Dim wksSheet As Worksheet\n    Set wksSheet = Sheets(varSheetIndex)\n\n    CsvExportRange wksSheet.UsedRange\n\n    End Sub\n</code></pre>\n\n<p><a href=\"https://www.mrexcel.com/forum/excel-questions/948333-visual-basic-applications-macro-save-excel-file-like-txt-utf-8-a.html#post4556223\" rel=\"nofollow noreferrer\">Reference</a></p>\n"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 45255450, "answer_count": 1, "score": 0, "last_activity_date": 1500732376, "creation_date": 1500464699, "last_edit_date": 1500466107, "question_id": 45189564, "link": "https://stackoverflow.com/questions/45189564/how-can-defining-fields-delimiter-character-encoding-and-records-seperator-cr", "title": "How can Defining fields delimiter character, Encoding and Records seperator ({CR}{LF}) for CSV files in export (Save As) from Excel by VBA", "body": "<p>I tied <code>Save As</code> my sheet in CSV format with (Comma Delimited) \",\" for fields and {CR}{LF} for records in line by below code.</p>\n\n<h2>The issue is:</h2>\n\n<p>1) Generated file is delimited by \";\" sign instead of \",\".</p>\n\n<p>2) Be sure records are separated by {CR}{LF}</p>\n\n<p>3) How can define encoding as Unicode UTF-8 (in situation if needed)</p>\n\n<p>I want this file have save by .txt extension.</p>\n\n<p>How can I generate CSV file in true format by above situation?</p>\n\n<pre><code>Sub GenCSV()\n\n    Dim NewBook As Workbook\n\n    Set NewBook = Workbooks.Add\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"tblTaxRep[[Header1]: _\n        [Headern]]\").SpecialCells(xlCellTypeVisible).Copy\n    With NewBook\n        .Worksheets(\"Sheet1\").Cells(1, 1).PasteSpecial (xlPasteValues)\n        .SaveAs Filename:=ThisWorkbook.Path &amp; \"Report\" &amp; \".txt\", FileFormat:=xlCSV\n        .Close SaveChanges:=False\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "office-interop", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5123, "user_id": 456266, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/37241a7a2b550bf42842f2d021e3f711?s=128&d=identicon&r=PG", "display_name": "YvesR", "link": "https://stackoverflow.com/users/456266/yvesr"}, "edited": false, "score": 0, "creation_date": 1500471631, "post_id": 45190505, "comment_id": 77351941, "body": "Doesn&#39;t make sense to save if it has no macro. Macros are mostly a security issue these days, so there is a reason a .xlsx file does not contain a macro. .xlsm files provoke additional scans and alerts. So that wouldn&#39;t be a proper solution."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1500466995, "creation_date": 1500466995, "answer_id": 45190505, "question_id": 45189323, "link": "https://stackoverflow.com/questions/45189323/check-if-a-excel-document-has-a-macro-to-set-correct-file-extension-on-save/45190505#45190505", "title": "Check if a Excel document has a macro to set correct file extension on save", "body": "<p>Why not just save all files as .xlsm\nit won't hurt if it doesn't have a macro</p>\n"}], "owner": {"reputation": 5123, "user_id": 456266, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/37241a7a2b550bf42842f2d021e3f711?s=128&d=identicon&r=PG", "display_name": "YvesR", "link": "https://stackoverflow.com/users/456266/yvesr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500466995, "creation_date": 1500464077, "last_edit_date": 1531161705, "question_id": 45189323, "link": "https://stackoverflow.com/questions/45189323/check-if-a-excel-document-has-a-macro-to-set-correct-file-extension-on-save", "title": "Check if a Excel document has a macro to set correct file extension on save", "body": "<p>I have a plugin where I download a Excel document from the net and open it.\nAs the Excel document can be <code>.xls</code> or <code>.xlsx</code> and the file might contain macros I need to check if the active workbook has macros.</p>\n\n<p>I find a solution but this runs into security problems...</p>\n\n<pre><code>var hasMacro = false;\nvar cmp = ExcelApp.ActiveWorkbook.VBProject;\nforeach (VBComponent c in from VBComponent c in cmp.VBComponents where c.CodeModule.CountOfLines &gt; 1 select c)\nhasMacro = true;\n</code></pre>\n\n<p>But running the code runs into</p>\n\n<pre><code>Programmatic access to Visual Basic Project is not trusted\n</code></pre>\n\n<p>if Excel has not correct properties set in the trust center.</p>\n\n<p>As I do only want to check if a Excel document has macros or not to set the correct file extension to <code>.xlsm</code> is there a smarter way to check for macros?</p>\n\n<p>Found this <a href=\"https://stackoverflow.com/questions/36286289/using-interop-excel-to-check-if-excel-file-contains-vba-macros\">SO Answer</a> but I do not have a property <code>HasVBProject</code>.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1500463813, "post_id": 45189196, "comment_id": 77345394, "body": "Is this part of an IF statement?  It is incomplete. What is the value of <code>i</code>?"}, {"owner": {"reputation": 47, "user_id": 7343935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6448aa576e89f8b57fda47af7d109e44?s=128&d=identicon&r=PG&f=1", "display_name": "Excel-lit", "link": "https://stackoverflow.com/users/7343935/excel-lit"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1500463886, "post_id": 45189196, "comment_id": 77345445, "body": "This is full if statement:If  <code>Sheet1.Cells(i, &quot;B&quot;).Value = &quot;A&quot; And Sheet1.Cells(i - 1, &quot;B&quot;).Value = &quot;D&quot; And Sheet1.Cells(i - 1, &quot;H&quot;).Value - Sheet1.Cells(i, &quot;H&quot;).Value &lt; 60 &#47; 86400 Then</code>  Sorry I don&#39;t know how to edit original question!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1500463951, "post_id": 45189196, "comment_id": 77345492, "body": "we need to see the rest of your code, it&#39;s almost impossible to find the possible cause to your error"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1500463992, "post_id": 45189196, "comment_id": 77345514, "body": "If <code>i</code> has a value of anything less than 2, it will error."}, {"owner": {"reputation": 47, "user_id": 7343935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6448aa576e89f8b57fda47af7d109e44?s=128&d=identicon&r=PG&f=1", "display_name": "Excel-lit", "link": "https://stackoverflow.com/users/7343935/excel-lit"}, "edited": false, "score": 0, "creation_date": 1500464179, "post_id": 45189196, "comment_id": 77345655, "body": "Great thanks. I just changes the <code>i</code> counter to 3 and its working fine. Thanks alot"}], "owner": {"reputation": 47, "user_id": 7343935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6448aa576e89f8b57fda47af7d109e44?s=128&d=identicon&r=PG&f=1", "display_name": "Excel-lit", "link": "https://stackoverflow.com/users/7343935/excel-lit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500463697, "creation_date": 1500463697, "question_id": 45189196, "link": "https://stackoverflow.com/questions/45189196/syntax-for-comparing-values", "title": "syntax for comparing values", "body": "<p>Anyone know what is wrong with following code?:<br>\nI have extra parenthesis to compare the  difference in value!</p>\n\n<pre><code>(Sheet1.Cells(i - 1, \"H\").Value - Sheet1.Cells(i, \"H\").Value) &lt; 60 / 86400\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500468559, "post_id": 45189399, "comment_id": 77349249, "body": "I understand. But yes, I am trying to compare the content of a cell with the entire array. If the cell content is &quot;Material1&quot; (text), I want it to search for a value inside an array called &quot;Material1&quot;."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500468843, "post_id": 45189399, "comment_id": 77349545, "body": "@ZedA. not sure I understand, you want to see if text in column &quot;W&quot; is &quot;Material1&quot;, then do what ? what value to find in <code>Material1</code> array ?"}, {"owner": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500469113, "post_id": 45189399, "comment_id": 77349780, "body": "yes, if the text in column &quot;W&quot; is &quot;Material1&quot; I want it to search for a value in an array with the same name. The value must satisfy my condition, which is related with column Z. If column Z is &lt;2, i want it to search for a value in that array that, when it&#39;s written in column X, changes my column Z to &lt; 2. Not sure if im clear!"}, {"owner": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500469497, "post_id": 45189399, "comment_id": 77350113, "body": "&quot;while&quot; the value in column X is &gt;2, I want it to test different values from the selected array."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1500464287, "creation_date": 1500464287, "answer_id": 45189399, "question_id": 45188921, "link": "https://stackoverflow.com/questions/45188921/excel-vba-search-for-a-value-in-an-array/45189399#45189399", "title": "excel vba - search for a value in an array", "body": "<p>You are trying to compare a cell's value with the entire <code>Material1</code> array here: </p>\n\n<pre><code>If Range(\"W\"&amp;Rows).value = Material1 then \n</code></pre>\n\n<p>If you want to check if the value in Column \"W\" equals to one of the elements in <code>Material1</code>, you can use the <code>Match</code> function:</p>\n\n<pre><code>If Not IsError(Application.Match(Range(\"W\" &amp; Rows).Value, Material1, 0)) Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500468701, "post_id": 45190175, "comment_id": 77349390, "body": "And how do I select the value that satisfies my condition, and write it let&#39;s say on Range(&quot;x&quot;&amp;rows)  ?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500470482, "post_id": 45190175, "comment_id": 77350952, "body": "Write code to test your condition againt elements of array, then write it <code>Range(&quot;x&quot;&amp;rows) = Materials(i)</code>."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1500466274, "creation_date": 1500466274, "answer_id": 45190175, "question_id": 45188921, "link": "https://stackoverflow.com/questions/45188921/excel-vba-search-for-a-value-in-an-array/45190175#45190175", "title": "excel vba - search for a value in an array", "body": "<p>Just loop through your arrays:</p>\n\n<pre><code>For i = LBound(Materials1) To UBound(Materials1)\n    'check for value using Materials(i)\nNext i\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4624, "favorite_count": 0, "accepted_answer_id": 45189399, "answer_count": 2, "score": 0, "last_activity_date": 1500466274, "creation_date": 1500462900, "question_id": 45188921, "link": "https://stackoverflow.com/questions/45188921/excel-vba-search-for-a-value-in-an-array", "title": "excel vba - search for a value in an array", "body": "<p>How do I select a value from an array, and write it on a cell, based on a condition?</p>\n\n<p>I have this:</p>\n\n<pre><code>Dim Material As Variant\n\nDim Material1 As Variant\nMaterial1 = Array(\"16\", \"20\", \"26\", \"32\", \"40\", \"50\", \"63\", \"70\")\n\nDim Material2 As Variant\nMaterial2 = Array(\"12\", \"16\", \"22\", \"28\", \"34\", \"42\", \"58\", \"65\")\n\nDim Rows as Long\nFor Rows = 9 to lastrow\n\nIf Range(\"P\"&amp;Rows).Value &lt;&gt; 0 then\n\nIf Range(\"W\"&amp;Rows).value = Material1 then\nMaterial = Material1\n'material can be Material2 also, but I would do the same IF\n\n\nIf Range(\"Z\"&amp;Rows).Value &gt; 2 then\nRange (\"X\"&amp;Rows).value = ' this is where I fail, I want to write here a value from Material1 (looping through position 1, 2, etc...)that does the opposite to my condition, i.e. &lt;2 (this is related with formulas in the sheet)\n</code></pre>\n\n<p>I didn't forget to \"end\" the IFs and to move to \"Next Rows\"</p>\n"}, {"tags": ["sql", "excel", "adodb", "vba"], "answers": [{"comments": [{"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 0, "creation_date": 1500462979, "post_id": 45188796, "comment_id": 77344818, "body": "I changed the name to &quot;DB.StoredProc&quot; for posting the question.  It is the real name on my system."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 0, "creation_date": 1500467101, "post_id": 45188796, "comment_id": 77348073, "body": "Oh sorry, just spotted it      Dim rs As ADODB.Recordset should be       Dim rs As New  ADODB.Recordset"}, {"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 0, "creation_date": 1500468036, "post_id": 45188796, "comment_id": 77348801, "body": "No problem.  I changed it as you said but no luck there."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1500462556, "creation_date": 1500462556, "answer_id": 45188796, "question_id": 45188075, "link": "https://stackoverflow.com/questions/45188075/excel-vba-run-sql-stored-procedure-error/45188796#45188796", "title": "Excel VBA - Run SQL Stored Procedure Error", "body": "<pre><code> cmd.CommandText = \"DB.StoredProc\"\n</code></pre>\n\n<p>should be the actual name of your stored procedure - unless you've actually named it StoredProc? </p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1500518155, "creation_date": 1500518155, "answer_id": 45204130, "question_id": 45188075, "link": "https://stackoverflow.com/questions/45188075/excel-vba-run-sql-stored-procedure-error/45204130#45204130", "title": "Excel VBA - Run SQL Stored Procedure Error", "body": "<p>Here are two options for you to consider.</p>\n\n<pre><code>Option Explicit\n\nSub RunSProc()\n\n'USE [Northwind]\n'GO\n'DECLARE @return_value int\n'EXEC    @return_value = [dbo].[TestNewProc]\n'        @ShipCountry = NULL\n'SELECT  'Return Value' = @return_value\n'GO\n\nDim con As Connection\nDim rst As Recordset\nDim strConn As String\n\nSet con = New Connection\nstrConn = \"Provider=SQLOLEDB;\"\nstrConn = strConn &amp; \"Data Source=YOUR_SERVER_NAME;\"\nstrConn = strConn &amp; \"Initial Catalog=YOUR_DB_NAME;\"\nstrConn = strConn &amp; \"Integrated Security=SSPI;\"\n\ncon.Open strConn\n\n'Put a country name in Cell E1\nSet rst = con.Execute(\"Exec dbo.TestNewProc '\" &amp; ActiveSheet.Range(\"E1\").Text &amp; \"'\")\n\n'The total count of records is returned to Cell A5\nActiveSheet.Range(\"A5\").CopyFromRecordset rst\n\nrst.Close\ncon.Close\n\nEnd Sub\n\n\nSub TryThis()\n\n'USE [Northwind]\n'GO\n'DECLARE @return_value int\n'EXEC    @return_value = [dbo].[Ten Most Expensive Products]\n'SELECT  'Return Value' = @return_value\n'GO\n\nDim con As Connection\nDim rst As Recordset\n\nSet con = New Connection\ncon.Open \"Provider=SQLOLEDB;Data Source=YOUR_SERVER_NAME;Initial Catalog=YOUR_DB_NAME;Integrated Security=SSPI;\"\n\nSet rst = con.Execute(\"Exec dbo.[Ten Most Expensive Products]\")\n'Results of SProc are returned to Cell A1\nActiveSheet.Range(\"A1\").CopyFromRecordset rst\n\nrst.Close\ncon.Close\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "is_accepted": false, "score": 1, "last_activity_date": 1500541258, "creation_date": 1500541258, "answer_id": 45210063, "question_id": 45188075, "link": "https://stackoverflow.com/questions/45188075/excel-vba-run-sql-stored-procedure-error/45210063#45210063", "title": "Excel VBA - Run SQL Stored Procedure Error", "body": "<p>I've solved the issue by adding <code>SET NOCOUNT ON</code> to my stored procedure.</p>\n\n<p>I wasn't initially sure if I would have access to be able to make that change.  I have a new issue though.  It works if I only use a single parameter but not when I use multiple parameters.</p>\n\n<p>I will close this thread, do some research and potentially open a new one.</p>\n\n<p>Thanks for your help.</p>\n"}], "owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1500541258, "creation_date": 1500460728, "last_edit_date": 1531164843, "question_id": 45188075, "link": "https://stackoverflow.com/questions/45188075/excel-vba-run-sql-stored-procedure-error", "title": "Excel VBA - Run SQL Stored Procedure Error", "body": "<p>I have the following code in my Excel workbook that I copied from <a href=\"http://mikesknowledgebase.com/pages/SQLServer/RunStoredProcedureFromExcel.htm\" rel=\"nofollow noreferrer\">this page.</a></p>\n\n<p>Code:</p>\n\n<pre><code>Sub Button1_Click()\n\nDim con As ADODB.Connection\nDim cmd As ADODB.Command\nDim rs As ADODB.Recordset\nDim WSP1 As Worksheet\n\nSet con = New ADODB.Connection\nSet cmd = New ADODB.Command\nSet rs = New ADODB.Recordset\n\n'''Clear extract area'''\nWorksheets(\"Extract\").UsedRange.Delete\n\n'''Log into SQL Server'''\ncon.Open \"Provider = SQLOLEDB;\" &amp; _\n         \"Data Source = MySource;\" &amp; _\n         \"Initial Catalog = MyDB;\" &amp; _\n         \"User ID = MyID;\" &amp; _\n         \"Password = MyPassword;\"\ncmd.ActiveConnection = con\n\n'''Set up parameters for stored procedure'''\ncmd.Parameters.Append cmd.CreateParameter(\"startDate\", adDate, adParamInput, , Range(\"C2\"))\ncmd.Parameters.Append cmd.CreateParameter(\"endDate\", adDate, adParamInput, , Range(\"C3\"))\n\ncmd.CommandText = \"DB.StoredProc\"\nSet rs = cmd.Execute(, , adCmdStoredProc)\n\nSet WSP1 = Worksheets(\"Extract\")\nWSP1.Activate\nIf rs.EOF = False Then WSP1.Cells(1, 1).CopyFromRecordset rs\n\nrs.Close\nSet rs = Nothing\nSet cmd = Nothing\n\ncon.Close\nSet con = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I get the following error message on the line 'If rs.EOF = False Then'</p>\n\n<blockquote>\n  <p>\"Operation is not allowed when the object is closed.\"</p>\n</blockquote>\n\n<p>This is the first time I've used these functions.  What have I done wrong?</p>\n\n<p>Also, have I set up the multiple parameters correctly?</p>\n\n<p>---Quick Edit---\nNot sure if it's worth mentioning that I have formatted my date as yyyy-mm-dd, as it is in SQL server.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1500461000, "post_id": 45188036, "comment_id": 77343393, "body": "Is it on sheet you want to sort? In that case you have the range A:B and sort. Excel will maintain the positions relative to values"}, {"owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1500461323, "post_id": 45188036, "comment_id": 77343630, "body": "No, it&#39;s something I calculated in VBA. There&#39;s no x, y, z, 5, 3, 8 anywhere in excel. I want to paste it in excel sorted, but just the values don&#39;t represent anything. Names of the variables are as important."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "edited": false, "score": 0, "creation_date": 1500463809, "post_id": 45188930, "comment_id": 77345392, "body": "Yes, I assumed that. Thanks anyway."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1500462939, "creation_date": 1500462939, "answer_id": 45188930, "question_id": 45188036, "link": "https://stackoverflow.com/questions/45188036/excel-vba-sort-values-and-variables/45188930#45188930", "title": "Excel VBA - sort values and variables", "body": "<p>In VBA there is no such thing as order between variables. You can determine if x is bigger than y, but that doesn't help you since you want them in a specific order.<br>\nMy answer is not exactly what you are asking for, but I suspect it'll help you anyway.<br>\nSince you've got your output to the sheet, albeit unsorted, it is easier to sort it there. Simply sort columns A and B together with column B as primary.<br>\nDoing this in code is a bit more complex. You would need to put both name (x, y, z) and value(8, 5, 3) in an array and then sort your array. How to sort arrays have been describe several times before (like here: <a href=\"https://stackoverflow.com/questions/11504418/excel-vba-quickest-way-to-sort-an-array-of-numbers-in-descending-order\">Excel VBA Quickest way to sort an array of numbers in descending order?</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "edited": false, "score": 0, "creation_date": 1500963991, "post_id": 45195480, "comment_id": 77552446, "body": "This actually is way better than my idea. Thanks."}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 1, "last_activity_date": 1506016718, "last_edit_date": 1506016718, "creation_date": 1500479576, "answer_id": 45195480, "question_id": 45188036, "link": "https://stackoverflow.com/questions/45188036/excel-vba-sort-values-and-variables/45195480#45195480", "title": "Excel VBA - sort values and variables", "body": "<p>AFAIK there isn't any way to do exactly what you are asking.  Variable names are part of your code; using and accessing them as data would need <a href=\"https://en.wikipedia.org/wiki/Reflection_(computer_programming)\" rel=\"nofollow noreferrer\">reflection</a> which is not something Excel VBA offers*.</p>\n\n<p>But I don't think what you are asking is the best way to achieve what you want by a long way.  What you seem to need is a way of storing (name, value) pairs and accessing both the name and the value.  One straightforward way to do this is to use the Dictionary object.</p>\n\n<p>There are alternatives if you need different functionality, e.g. using a pair of Arrays (one to hold the names, one to hold the values) - to make this neater you could write a class to keep the two together and implement whatever functions you need as methods.</p>\n\n<p>Once you have the (name,value) pairs outputting them in a sorted list is straightforward.  The simplest way is to write them to the spreadsheet and then use Excel's built-in <code>Range.Sort</code> (see <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-sort-method-excel\" rel=\"nofollow noreferrer\">MSDN documentation</a>).</p>\n\n<p>Putting it all together (note this needs a reference to the <code>Microsoft Scripting Runtime</code> library for the <code>Dictionary</code> object):</p>\n\n<pre><code>Dim dict As New Dictionary\nDim ws As Worksheet, rng As Range\nDim ky As Variant, itm As Variant\n\nSet ws = ThisWorkbook.Worksheets(1)\n\n'Add items to dictionary\ndict.Add \"x\", 5\ndict.Add \"y\", 3\ndict.Add \"z\", 8\n\n'You can use these in code like this:\nFor Each ky In dict.Keys\n    Debug.Print \"The value of \" &amp; ky &amp; \" is \" &amp; dict(ky)\nNext ky\n'you can change values\ndict.item(\"z\") = 10\ndict.item(\"z\") = 8\n\n'Output the values and keys (the key/value arrays are horizontal while\n'the range is vertical, hence transpose)\nSet rng = ws.Range(ws.Cells(1, 1), ws.Cells(dict.Count, 2))\nrng.Columns(1).Value = Application.Transpose(dict.Keys)\nrng.Columns(2).Value = Application.Transpose(dict.Items)\n'Sort them\nrng.Sort Key1:=ws.Range(\"B1\"), Header:=xlNo\n</code></pre>\n\n<hr>\n\n<p>*not easily anyway - there <em>are</em> some objects accessible through <code>VBProject</code> which allow limited access to the code.  But using that to do what you are asking for would be nigh on impossible.</p>\n"}], "owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1812, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506016718, "creation_date": 1500460633, "question_id": 45188036, "link": "https://stackoverflow.com/questions/45188036/excel-vba-sort-values-and-variables", "title": "Excel VBA - sort values and variables", "body": "<p>If you have variables and values in vba\nis it possible to sort them from max to min, but also to match them with variables.\nSo for example if you have in VBA: </p>\n\n<pre><code>Sub sort()\n...\nx = 5\ny = 3\nz = 8\n...\nEnd sub\n</code></pre>\n\n<p>That in excel you get (in A column variables, in B column values):</p>\n\n<pre><code> A  B\n z  8\n x  5\n y  3\n</code></pre>\n\n<p>It's pretty easy to sort 8, 5, 3.\nBut how to add z, x, y in their proper positions? </p>\n"}, {"tags": ["excel", "vba", "automation", "sap-gui"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1575139608, "post_id": 45187903, "comment_id": 104468140, "body": "You can find your answer here <a href=\"https://stackoverflow.com/a/58348742/11636588\">stackoverflow.com/a/58348742/11636588</a> or here <a href=\"https://simpleexcelvba.com/connect-to-sap-via-excel-vba/\" rel=\"nofollow noreferrer\">simpleexcelvba.com/connect-to-sap-via-excel-vba</a>"}], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "is_accepted": false, "score": 1, "last_activity_date": 1513785260, "creation_date": 1513785260, "answer_id": 47909914, "question_id": 45187903, "link": "https://stackoverflow.com/questions/45187903/how-to-run-sap-gui-script-from-excel-macro/47909914#47909914", "title": "How to run SAP GUI script from Excel Macro", "body": "<p>Unfortunately, I no longer have access to any SAP applications due to changing jobs so the below is from what I remember.</p>\n\n<ul>\n<li><p>You can add this into an Excel macro by copy and pasting into a <code>Sub</code>.</p></li>\n<li><p>You will need to open SAP manually as well keeping the computer unlocked, otherwise your macro will crash. It might be possible to open SAP via the macro, I did it in my last job and logged into it with a hard-coded password but I don't have the code to share.</p></li>\n<li><p>In the script pasted, replace every instance of <code>application</code> with something else, such as <code>guiApplication</code>, otherwise Excel will get confused with its own <code>Excel.Application</code> member.</p></li>\n<li><p>No other code is required but you will need to call the <code>Sub</code>routine and ensure you do not have <code>option explicit</code> set. You can but then you will need to instantiate <code>session</code>, <code>connection</code>, etc.</p></li>\n</ul>\n\n<p>Where to put the script:</p>\n\n<pre><code> Public Sub MySapScript()\n     ' Your Sap Script here\n End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1428, "user_id": 5347614, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/4ygeh.jpg?s=128&g=1", "display_name": "Adam Milecki", "link": "https://stackoverflow.com/users/5347614/adam-milecki"}, "edited": false, "score": 0, "creation_date": 1563382946, "post_id": 53576808, "comment_id": 100684841, "body": "This answer is spot on, thank you.  Two things that I needed to correct after trying to piece it together for my application were 1) &#39;Exit Sub&#39; after SAP script not &#39;End Sub&#39; and 2) Rename &#39;Application&#39; which is reserved in Excel world to &#39;SAPGuiApp&#39;."}], "tags": [], "owner": {"reputation": 41, "user_id": 10733491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43152dfa3e6b673bdcb9d0f8e4ad2233?s=128&d=identicon&r=PG", "display_name": "Steve W", "link": "https://stackoverflow.com/users/10733491/steve-w"}, "is_accepted": false, "score": 3, "last_activity_date": 1543718403, "last_edit_date": 1543718403, "creation_date": 1543717775, "answer_id": 53576808, "question_id": 45187903, "link": "https://stackoverflow.com/questions/45187903/how-to-run-sap-gui-script-from-excel-macro/53576808#53576808", "title": "How to run SAP GUI script from Excel Macro", "body": "<p>Open and log in to SAP manually.</p>\n\n<p>Open Excel, make sure the developer tab is visible. If not then select;</p>\n\n<p>File/Options/Customize Ribbon. Make sure 'Developer' is ticked.</p>\n\n<p>Select the Developer tab in Excel then choose 'Insert'. From the 'Active X' set\nof controls (Not the 'FORM' controls') select the Command Button control and draw it on your worksheet. Right-click the button and select 'Properties', look for 'Caption' and either delete it or change it to something more appropriate. After that, right-click the command button again and select 'View Code'. Paste the following code into the vba editor.</p>\n\n<p>On the VBA editor menu select; Debug/Compile VBA Project. Hopefully there will be no errors and you can now close the VBA editor.</p>\n\n<p>Now, click your button and the code should run your SAP transaction. If the button won't click, make sure 'Design Mode' isn't selected in the Developer tab.</p>\n\n<p>Don't forget to save your spreadsheet :)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nOn Error GoTo Err_NoSAP\n\nIf Not IsObject(SAPGuiApp) Then\n   Set SapGuiAuto = GetObject(\"SAPGUI\")\n   Set SAPGuiApp = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(Connection) Then\n   Set Connection = SAPGuiApp.Children(0)\nEnd If\nIf Not IsObject(SAP_session) Then\n   Set SAP_session = Connection.Children(0)\nEnd If\nIf IsObject(WScript) Then\n   WScript.ConnectObject SAP_session, \"on\"\n   WScript.ConnectObject SAPGuiApp, \"on\"\nEnd If\n\nIf (Connection.Children.Count &gt; 1) Then GoTo Err_TooManySAP\n\nSet aw = SAP_session.ActiveWindow()\naw.findById(\"wnd[0]\").Maximize\n\nOn Error GoTo Err_Description\nSAP_session.findById(\"wnd[0]\").Maximize\nSAP_session.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"ZL\"\nSAP_session.findById(\"wnd[0]\").sendVKey 0\nSAP_session.findById(\"wnd[0]/usr/chkP_DBAGG\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/ctxtP_DTA\").Text = \"DB\"\nSAP_session.findById(\"wnd[0]/usr/chkP_DBAGG\").SetFocus\nSAP_session.findById(\"wnd[0]/tbar[1]/btn[8]\").press\nSAP_session.findById(\"wnd[0]/tbar[1]/btn[25]\").press\nSAP_session.findById(\"wnd[0]/tbar[1]/btn[26]\").press\nSAP_session.findById(\"wnd[0]/usr/chkS005\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS017\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS018\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS020\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS025\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS030\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS031\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS055\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS057\").Selected = True\nSAP_session.findById(\"wnd[0]/usr/chkS057\").SetFocus\nSAP_session.findById(\"wnd[0]/tbar[1]/btn[8]\").press\nSAP_session.findById(\"wnd[0]/usr/ctxtC025-LOW\").SetFocus\nSAP_session.findById(\"wnd[0]/usr/ctxtC025-LOW\").caretPosition = 0\nSAP_session.findById(\"wnd[0]\").sendVKey 4\nSAP_session.findById(\"wnd[1]/usr/cntlCONTAINER/shellcont/shell\").selectionInterval = \"20170717,20170717\"\nSAP_session.findById(\"wnd[0]/usr/ctxtC025-HIGH\").SetFocus\nSAP_session.findById(\"wnd[0]/usr/ctxtC025-HIGH\").caretPosition = 0\nSAP_session.findById(\"wnd[0]\").sendVKey 4\nSAP_session.findById(\"wnd[1]/usr/cntlCONTAINER/shellcont/shell\").focusDate = \"20170724\"\nSAP_session.findById(\"wnd[1]/usr/cntlCONTAINER/shellcont/shell\").selectionInterval = \"20170724,20170724\"\nSAP_session.findById(\"wnd[0]/usr/txtL_MX\").Text = \"9999999\"\nSAP_session.findById(\"wnd[0]/usr/txtL_MX\").SetFocus\nSAP_session.findById(\"wnd[0]/usr/txtL_MX\").caretPosition = 11\nSAP_session.findById(\"wnd[0]/tbar[1]/btn[8]\").press\nSAP_session.findById(\"wnd[0]/mbar/menu[0]/menu[3]/menu[1]\").Select\nSAP_session.findById(\"wnd[1]/usr/ctxtDY_PATH\").SetFocus\nSAP_session.findById(\"wnd[1]/usr/ctxtDY_PATH\").caretPosition = 0\nSAP_session.findById(\"wnd[1]\").sendVKey 4\nSAP_session.findById(\"wnd[2]/usr/ctxtDY_PATH\").SetFocus\nSAP_session.findById(\"wnd[2]/usr/ctxtDY_PATH\").caretPosition = 0\nSAP_session.findById(\"wnd[2]\").sendVKey 4\nSAP_session.findById(\"wnd[3]/usr/ctxtDY_PATH\").SetFocus\nSAP_session.findById(\"wnd[3]/usr/ctxtDY_PATH\").caretPosition = 0\nSAP_session.findById(\"wnd[3]\").sendVKey 4\nSAP_session.findById(\"wnd[4]/usr/ctxtDY_PATH\").Text = \"G:\\PROFILES\\AP\\Desktop\"\nSAP_session.findById(\"wnd[4]/usr/ctxtDY_FILENAME\").Text = \"report.xlsx\"\nSAP_session.findById(\"wnd[4]/usr/ctxtDY_FILENAME\").caretPosition = 11\nSAP_session.findById(\"wnd[4]/tbar[0]/btn[11]\").press\nSAP_session.findById(\"wnd[3]/tbar[0]/btn[11]\").press\nSAP_session.findById(\"wnd[2]/tbar[0]/btn[0]\").press\nSAP_session.findById(\"wnd[1]/tbar[0]/btn[11]\").press\n\nExit Sub\n\nErr_Description:\n    MsgBox (\"The program has generated an error;\" &amp; Chr(13) &amp; _\n    \"the reason for this error is unknown.\"), VbInformation, _\n    \"For Information...\"\n        Exit Sub\n\nErr_NoSAP:\nMsgBox (\"You don't have SAP open or \" &amp; Chr(13) &amp; _\n\"scripting has been disabled.\"), VbInformation, _\n\"For Information...\"\n        Exit Sub\n\nErr_TooManySAP:\nMsgBox (\"You must only have one SAP session open. \" &amp; Chr(13) &amp; _\n        \"Please close all other open SAP sessions.\"), VbInformation, _\n        \"For Information...\"\n         Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 446, "user_id": 5910742, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gWO02.jpg?s=128&g=1", "display_name": "Scott Ridings", "link": "https://stackoverflow.com/users/5910742/scott-ridings"}, "is_accepted": false, "score": 1, "last_activity_date": 1586343895, "creation_date": 1586343895, "answer_id": 61099220, "question_id": 45187903, "link": "https://stackoverflow.com/questions/45187903/how-to-run-sap-gui-script-from-excel-macro/61099220#61099220", "title": "How to run SAP GUI script from Excel Macro", "body": "<p>I always had problems using the connection script that the recorder spit out (If IsObject(WScript) Then).</p>\n\n<p>This is what I've always used. In a code module insert the below.</p>\n\n<pre><code>Sub Connect_To_SAP()\n\n    Dim SapGuiAuto As Object\n    Dim SAPApp As Object\n    Dim SAPCon As Object\n    Dim session As Object\n\n    Set SapGuiAuto = GetObject(\"SAPGUI\")\n    Set SAPApp = SapGuiAuto.GetScriptingEngine\n    Set SAPCon = SAPApp.Children(0)\n    Set session = SAPCon.Children.ElementAt(0) ' &lt;--- Assumes you are using the first session open. '\n\n'Your script here\n\nEnd Sub\n</code></pre>\n\n<p>You can always throw your recorded script in here, but when you want to take things to the next level you should try adding the <strong>SAP GUI Scripting API</strong>. Deep in the SAP folder of your program files there's a class library you can use to make your SAP automation flawless. Try searching for this file \"<strong>sapfewse.ocx</strong>\". Get the file path.</p>\n\n<p>Then, in the IDE select Tools > References then click Browse and select that file. Once you've added it to the VBA Project press F2 to view all the methods and properties at your disposal.</p>\n"}], "owner": {"reputation": 135, "user_id": 3440963, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/100001400112457/picture?type=large", "display_name": "Ashique Sheikh", "link": "https://stackoverflow.com/users/3440963/ashique-sheikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26310, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1616366720, "creation_date": 1500460255, "last_edit_date": 1603035027, "question_id": 45187903, "link": "https://stackoverflow.com/questions/45187903/how-to-run-sap-gui-script-from-excel-macro", "title": "How to run SAP GUI script from Excel Macro", "body": "<p>I am trying to create a Excel macro which executes the SAP GUI Script. I already created the script but I didn't understand how to use that in VBA macro.</p>\n<p>This is my SAP GUI Script :</p>\n<pre><code>If Not IsObject(application) Then\n   Set SapGuiAuto  = GetObject(&quot;SAPGUI&quot;)\n   Set application = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(connection) Then\n   Set connection = application.Children(0)\nEnd If\nIf Not IsObject(session) Then\n   Set session    = connection.Children(0)\nEnd If\nIf IsObject(WScript) Then\n   WScript.ConnectObject session,     &quot;on&quot;\n   WScript.ConnectObject application, &quot;on&quot;\nEnd If\n\nsession.findById(&quot;wnd[0]&quot;).maximize\nsession.findById(&quot;wnd[0]/tbar[0]/okcd&quot;).text = &quot;ZL&quot;\nsession.findById(&quot;wnd[0]&quot;).sendVKey 0\nsession.findById(&quot;wnd[0]/usr/chkP_DBAGG&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/ctxtP_DTA&quot;).text = &quot;DB&quot;\nsession.findById(&quot;wnd[0]/usr/chkP_DBAGG&quot;).setFocus\nsession.findById(&quot;wnd[0]/tbar[1]/btn[8]&quot;).press\nsession.findById(&quot;wnd[0]/tbar[1]/btn[25]&quot;).press\nsession.findById(&quot;wnd[0]/tbar[1]/btn[26]&quot;).press\nsession.findById(&quot;wnd[0]/usr/chkS005&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS017&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS018&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS020&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS025&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS030&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS031&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS055&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS057&quot;).selected = true\nsession.findById(&quot;wnd[0]/usr/chkS057&quot;).setFocus\nsession.findById(&quot;wnd[0]/tbar[1]/btn[8]&quot;).press\nsession.findById(&quot;wnd[0]/usr/ctxtC025-LOW&quot;).setFocus\nsession.findById(&quot;wnd[0]/usr/ctxtC025-LOW&quot;).caretPosition = 0\nsession.findById(&quot;wnd[0]&quot;).sendVKey 4\nsession.findById(&quot;wnd[1]/usr/cntlCONTAINER/shellcont/shell&quot;).selectionInterval = &quot;20170717,20170717&quot;\nsession.findById(&quot;wnd[0]/usr/ctxtC025-HIGH&quot;).setFocus\nsession.findById(&quot;wnd[0]/usr/ctxtC025-HIGH&quot;).caretPosition = 0\nsession.findById(&quot;wnd[0]&quot;).sendVKey 4\nsession.findById(&quot;wnd[1]/usr/cntlCONTAINER/shellcont/shell&quot;).focusDate = &quot;20170724&quot;\nsession.findById(&quot;wnd[1]/usr/cntlCONTAINER/shellcont/shell&quot;).selectionInterval = &quot;20170724,20170724&quot;\nsession.findById(&quot;wnd[0]/usr/txtL_MX&quot;).text = &quot;9999999&quot;\nsession.findById(&quot;wnd[0]/usr/txtL_MX&quot;).setFocus\nsession.findById(&quot;wnd[0]/usr/txtL_MX&quot;).caretPosition = 11\nsession.findById(&quot;wnd[0]/tbar[1]/btn[8]&quot;).press\nsession.findById(&quot;wnd[0]/mbar/menu[0]/menu[3]/menu[1]&quot;).select\nsession.findById(&quot;wnd[1]/usr/ctxtDY_PATH&quot;).setFocus\nsession.findById(&quot;wnd[1]/usr/ctxtDY_PATH&quot;).caretPosition = 0\nsession.findById(&quot;wnd[1]&quot;).sendVKey 4\nsession.findById(&quot;wnd[2]/usr/ctxtDY_PATH&quot;).setFocus\nsession.findById(&quot;wnd[2]/usr/ctxtDY_PATH&quot;).caretPosition = 0\nsession.findById(&quot;wnd[2]&quot;).sendVKey 4\nsession.findById(&quot;wnd[3]/usr/ctxtDY_PATH&quot;).setFocus\nsession.findById(&quot;wnd[3]/usr/ctxtDY_PATH&quot;).caretPosition = 0\nsession.findById(&quot;wnd[3]&quot;).sendVKey 4\nsession.findById(&quot;wnd[4]/usr/ctxtDY_PATH&quot;).text = &quot;G:\\PROFILES\\AP\\Desktop&quot;\nsession.findById(&quot;wnd[4]/usr/ctxtDY_FILENAME&quot;).text = &quot;report.xlsx&quot;\nsession.findById(&quot;wnd[4]/usr/ctxtDY_FILENAME&quot;).caretPosition = 11\nsession.findById(&quot;wnd[4]/tbar[0]/btn[11]&quot;).press\nsession.findById(&quot;wnd[3]/tbar[0]/btn[11]&quot;).press\nsession.findById(&quot;wnd[2]/tbar[0]/btn[0]&quot;).press\nsession.findById(&quot;wnd[1]/tbar[0]/btn[11]&quot;).press\n</code></pre>\n<p>I have few doubts regarding this:</p>\n<ol>\n<li>How can I add this in Excel macro.</li>\n<li>Do I need to open the SAP GUI application manually before running it?</li>\n<li>Is there any add-on code to open the SAP GUI application from Excel macro?</li>\n</ol>\n<p>I only need button click to perform the process. I didn't pass any value dynamically.</p>\n"}, {"tags": ["windows", "vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1500459933, "creation_date": 1500459933, "answer_id": 45187781, "question_id": 45187620, "link": "https://stackoverflow.com/questions/45187620/quitting-the-ie-in-the-end-of-vba-function/45187781#45187781", "title": "Quitting the IE in the end of VBA function", "body": "<p>You are keeping a pointer to the DOM in the html variable. If you close IE, you are pointing to something non-existing.\nThe simple answer is to close IE at the end of getSomething. In your case, this means that you have to restructure your code so that your IE variable is accessible from other places than in getWebContents</p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 4617342, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c6ad72f8a0b2d02212a1e2d2abc96cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalf", "link": "https://stackoverflow.com/users/4617342/gandalf"}, "edited": false, "score": 0, "creation_date": 1500462138, "post_id": 45188260, "comment_id": 77344245, "body": "Ok, so does it mean that I need to initialize (and quit) IE in every function getSomething I use in excel sheet?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 121, "user_id": 4617342, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c6ad72f8a0b2d02212a1e2d2abc96cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalf", "link": "https://stackoverflow.com/users/4617342/gandalf"}, "edited": false, "score": 0, "creation_date": 1500463347, "post_id": 45188260, "comment_id": 77345102, "body": "Yes but in your example above, in order for the function to work, the IE object must remain in memory therefore you have no control for the <code>ie.Quit</code>."}, {"owner": {"reputation": 121, "user_id": 4617342, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c6ad72f8a0b2d02212a1e2d2abc96cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalf", "link": "https://stackoverflow.com/users/4617342/gandalf"}, "edited": false, "score": 0, "creation_date": 1500626425, "post_id": 45188260, "comment_id": 77431557, "body": "Thanks! It seems that VBA is just not a very flexible tool."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1500461185, "creation_date": 1500461185, "answer_id": 45188260, "question_id": 45187620, "link": "https://stackoverflow.com/questions/45187620/quitting-the-ie-in-the-end-of-vba-function/45188260#45188260", "title": "Quitting the IE in the end of VBA function", "body": "<p>You should define a procedure to handle the object lifetime from creation to destruction. You can then pass a reference for the object to the function.</p>\n\n<p>Lastly, you can dispose the object even if an error occurs at any stange.</p>\n\n<pre><code>Public Sub Main()\n    On Error GoTo ErrProc\n\n    Dim ie As InternetExplorer\n    Set ie = New InternetExplorer\n\n    '....\n\n    Dim obj As Object\n        obj = getWebContents(ie, \"url\")\n\nLeave:\n    ie.Quit\n    Set ie = Nothing\n    Set obj = Nothing\n    Application.StatusBar = \"\"\n    On Error GoTo 0\n    Exit Sub\n\nErrProc:\n    MsgBox Err.Description, vbCritical\n    Resume Leave\nEnd Sub\n\n\nPublic Function getWebContents(ie As InternetExplorer, webAddress As String) As HTMLObjectElement\n    '...\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4617342, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c6ad72f8a0b2d02212a1e2d2abc96cc?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalf", "link": "https://stackoverflow.com/users/4617342/gandalf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3325, "favorite_count": 0, "accepted_answer_id": 45188260, "answer_count": 2, "score": 1, "last_activity_date": 1500461185, "creation_date": 1500459530, "question_id": 45187620, "link": "https://stackoverflow.com/questions/45187620/quitting-the-ie-in-the-end-of-vba-function", "title": "Quitting the IE in the end of VBA function", "body": "<p>I implemented several functions which relies on downloading some information from some websites.</p>\n\n<p>The simplest example of such a function is:</p>\n\n<pre><code>Public Function getSomething(webAddress As String)\n    Dim html As HTMLObjectElement\n    Set html = getWebContents(webAddress)\n    Set elems = html.body.getElementsByTagName(tagName)\n    ...\nEnd Function\n</code></pre>\n\n<p>The function for acquire data from websites is:</p>\n\n<pre><code>Public Function getWebContents(webAddress As String) As HTMLObjectElement\n    Dim ie As InternetExplorer\n    Dim html As HTMLDocument\n    Set ie = New InternetExplorer\n    ie.Visible = False\n    ie.Navigate webAddress\n    Do While ie.READYSTATE &lt;&gt; READYSTATE_COMPLETE\n        Application.StatusBar = \"Trying ...\"\n        DoEvents\n    Loop\n\n    Set getWebContents = ie.Document\n\n    'close down IE and reset status bar\n    'ie.Quit\n    Set ie = Nothing\n    Application.StatusBar = \"\"\nEnd Function\n</code></pre>\n\n<p>The problem is that it seems that I need the line ie.Quit to be uncommented to close the IE instance. But when I uncomment ie.Quit the line</p>\n\n<pre><code>Set elems = html.body.getElementsByTagName(tagName)\n</code></pre>\n\n<p>generates errors.</p>\n\n<p>It seems that I cannot use HTMLObjectElement returned by function getWebContents when IE has been quitted. How to deal with that? I could implement a try...finally block in getSomething function and open ie there and close in the finally block. However I have many functions of a similar nature and making many similar try...finally blocks seems a stupid idea.</p>\n\n<p>Any thoughts?\nThanks!</p>\n"}, {"tags": ["excel", "vba", "variables", "max"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1500465863, "post_id": 45188901, "comment_id": 77347031, "body": "Actually, the date type is not my main problem in here. The main problem is that after the first loop, MAX_DATE doesn&#39;t reset itself properly. It stuck with the first value I believe."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1500465940, "post_id": 45188901, "comment_id": 77347088, "body": "Because it&#39;s OUTSIDE the loop."}, {"owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1500466437, "post_id": 45188901, "comment_id": 77347476, "body": "But it should be outside the WA loop, because it depends on 3 different WA values."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1500466502, "post_id": 45188901, "comment_id": 77347536, "body": "So it will be calculated only once, after the loop. It won&#39;t change value."}, {"owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1500468207, "post_id": 45188901, "comment_id": 77348938, "body": "Yes, but it should recalculate and change after the first &quot;p&quot; loop. But it stucks at the first value. :("}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1500468420, "post_id": 45188901, "comment_id": 77349128, "body": "Try to debug your code and see if <code>WA...</code> variables are changing."}, {"owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1500470016, "post_id": 45188901, "comment_id": 77350558, "body": "WA is changing but this part doesn&#39;t change I&#39;m afraid: <code>If WS_1 &lt;&gt; &quot;&quot; And WA1 &lt;&gt; &quot;&quot; And WS_2 &lt;&gt; &quot;&quot; And WA2 &lt;&gt; &quot;&quot; And WS_3 &lt;&gt; &quot;&quot; And WA3 = &quot;&quot; Or WS_1 &lt;&gt; &quot;&quot; And WA1 &lt;&gt; &quot;&quot; And WS_2 &lt;&gt; &quot;&quot; And WA2 = &quot;&quot; And WS_3 = &quot;&quot; Or WS_1 &lt;&gt; &quot;&quot; And WA1 = &quot;&quot; And WS_2 = &quot;&quot; And WS_3 = &quot;&quot; Then     MAX_DATE = &quot;&quot; </code>"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1500462847, "creation_date": 1500462847, "answer_id": 45188901, "question_id": 45187612, "link": "https://stackoverflow.com/questions/45187612/excel-vba-finding-max-variable-after-loop/45188901#45188901", "title": "Excel - VBA Finding max variable after loop", "body": "<p>First of all, declare these variables as <code>Date</code>. Then the compilier will know how to compare them using <code>&lt;</code> operator. Here's the code:</p>\n\n<pre><code>Dim d1, d2, d3 As Date\n\nd1 = \"06-01-2017\"\nd2 = \"05-01-2018\"\nd3 = \"01-01-1900\" 'This can be some default value, you can't pass here empty string (\"\")\n\nIf d1 &gt; d2 Then\n    MsgBox (\"a\")\nElse\n    MsgBox (\"b\")\nEnd If\n</code></pre>\n\n<p>If you use <code>Date</code> instead of <code>Variant</code> the message will be <code>b</code> and <code>a</code> otherwise.</p>\n\n<p>As you need to pass some default values, see my proposition in the code. It won't affect your maximum, since is rather \"low-value\" date :)</p>\n"}], "owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500462847, "creation_date": 1500459518, "question_id": 45187612, "link": "https://stackoverflow.com/questions/45187612/excel-vba-finding-max-variable-after-loop", "title": "Excel - VBA Finding max variable after loop", "body": "<p>I am trying to have the max of 2 or 3 different variables (variants). They are all dates.\nI have the code below, but I believe, I am doing something quite wrong.\nCould you people help me?\nHere is the code;</p>\n\n<pre><code>Dim QA As Integer: QA = 0    \nFor Each j_WS In Array(WS_1, WS_2, WS3) \n\nSelect Case QA \nCase 0: j = 1 \nCase 1: j = 2 \nCase 2: j = 3 \nEnd Select \n\no = 14 + j * 3 \nDim WA1 As Variant \nDim WA2 As Variant \nDim WA3 As Variant \nGorev = Cells(p, o).Address \nSlideNo = Cells(p, 34).Address \nEgitim_Adi = Cells(2, 3).Address \nDim Satir_bul As Variant \n\n\nIf Not IsError(Satir_bul) Then \n    Satir_bul = Worksheets(WS_All).Evaluate(\"=Match(\" &amp; Egitim_Adi &amp; \"&amp;\" &amp; SlideNo &amp; \"&amp;\" &amp; Gorev &amp; \", '\" &amp; j_WS &amp; \"'!A:A&amp;'\" &amp; j_WS &amp; \"'!B:B&amp;'\" &amp; j_WS &amp; \"'!C:C, 0)\") \nElse \n    WA1 = \"\" \n    WA2 = \"\" \n    WA3 = \"\" \nEnd If \n\n\nIf j = 1 And Worksheets(WS_All).Cells(8, 3).Value = \"Yeni Egitim\" Or j = 1 And Worksheets(WS_All).Cells(8, 3).Value = \"Tanitim / Reklam\" Then \n    WA1 = Worksheets(j_WS).Cells(Satir_bul, 7).Value \nElse: WA1 = Worksheets(j_WS).Cells(Satir_bul, 9).Value \n    If j = 2 And Worksheets(WS_All).Cells(8, 3).Value = \"Yeni Egitim\" Or j = 1 And Worksheets(WS_All).Cells(8, 3).Value = \"Tanitim / Reklam\" Then \n        WA2 = Worksheets(j_WS).Cells(Satir_bul, 7).Value \n    Else: WA2 = Worksheets(j_WS).Cells(Satir_bul, 9).Value \n        If j = 3 And Worksheets(WS_All).Cells(8, 3).Value = \"Yeni Egitim\" Or j = 1 And Worksheets(WS_All).Cells(8, 3).Value = \"Tanitim / Reklam\" Then \n            WA3 = Worksheets(j_WS).Cells(Satir_bul, 7).Value \n        Else: WA3 = Worksheets(j_WS).Cells(Satir_bul, 9).Value \n\n\n        End If \n    End If \nEnd If \n\n\nQA = QA + 1 \nNext j_WS \n\n\nIf WA1 &gt; WA2 And WA1 &gt; WA3 Then \n    MAX_DATE = WA1 \nElse \n    If WA2 &gt; WA3 And WA2 &gt; WA1 Then \n        MAX_DATE = WA2 \n    Else \n        If WA3 &gt; WA2 And WA3 &gt; WA1 Then \n            MAX_DATE = WA3 \n        Else \n            MAX_DATE = \"\" \n        End If \n    End If \nEnd If \n\n\nWorksheets(WS_All).Cells(p, 26).Value = MAX_DATE \n\n\nNext p \n</code></pre>\n\n<p>As you can see, almost everything is a predefined integer or something like that and WA1, WA2 and WA3 are all dates and I want MAX_DATE to be date too.</p>\n\n<p>WA1, WA2 and WA3 doesn't come correct within loops. WA1 comes correct at first loop, WA2 comes correct at second loop and so on but for example at the second loop, WA1 comes empty. And because of this, MAX_DATE value is not working correctly.</p>\n"}, {"tags": ["python", "vba", "xlwings"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 2539088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd3ebdc2fafbee10e6e4de50225a639?s=128&d=identicon&r=PG", "display_name": "user2539088", "link": "https://stackoverflow.com/users/2539088/user2539088"}, "edited": false, "score": 0, "creation_date": 1500654608, "post_id": 45213670, "comment_id": 77451166, "body": "selecting &#39;VBAProject (Book1)&#39; before going to References doesn&#39;t solve the problem for me unfortunately..."}], "tags": [], "owner": {"reputation": 1, "user_id": 2038941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a647fe33810dfcddff159223a04cb93?s=128&d=identicon&r=PG", "display_name": "Christian Fischer", "link": "https://stackoverflow.com/users/2038941/christian-fischer"}, "is_accepted": false, "score": 0, "last_activity_date": 1500550877, "creation_date": 1500550877, "answer_id": 45213670, "question_id": 45187597, "link": "https://stackoverflow.com/questions/45187597/python-xlwings-vba-reference-not-loading/45213670#45213670", "title": "Python xlwings VBA reference not loading", "body": "<p>I just had the same issue. xlwings seems to be in the list, if you have \"VBAProject (Book1)\" selected before going to Tools->References.\nYou have to make sure that you do not have the \"xlwings (xlwings.xlam)\" module selected, before selecting Tools-> References.</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 8372413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c000af2fb9ec75cef708845113b042?s=128&d=identicon&r=PG&f=1", "display_name": "VBAMadeMeDoIt", "link": "https://stackoverflow.com/users/8372413/vbamademedoit"}, "is_accepted": false, "score": 0, "last_activity_date": 1501164741, "creation_date": 1501164741, "answer_id": 45353351, "question_id": 45187597, "link": "https://stackoverflow.com/questions/45187597/python-xlwings-vba-reference-not-loading/45353351#45353351", "title": "Python xlwings VBA reference not loading", "body": "<p>Try removing the xlwings module from the VBA project(must be empty to remove...you should only have config settings there anyways) and installing the add-in via command line(xlwings addin install). Now when you try to edit your references, first confirm the xlwings project is visible in the VBA project directory on the left, and then select your current project and try to add a reference. Xlwings should now be in that list. I managed to resolve several issues by upgrading to the latest xlwings version - the older version Anaconda came with seemed to be missing a fair amount of functionality, mainly concerning the add-in(which as far as I can tell is superior to the module.)</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 2539088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd3ebdc2fafbee10e6e4de50225a639?s=128&d=identicon&r=PG", "display_name": "user2539088", "link": "https://stackoverflow.com/users/2539088/user2539088"}, "edited": false, "score": 0, "creation_date": 1503995000, "post_id": 45739209, "comment_id": 78826368, "body": "Thanks Zleu, this still doesn&#39;t work unfortunately. I do have a xlwings.xlam Reference in the left-hand menu in my VBA window but when I go to Tools --&gt; References, xlwings is still not in the list."}, {"owner": {"reputation": 26, "user_id": 7897120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63a8c042514087ae882d38396528791?s=128&d=identicon&r=PG&f=1", "display_name": "zleu", "link": "https://stackoverflow.com/users/7897120/zleu"}, "reply_to_user": {"reputation": 45, "user_id": 2539088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd3ebdc2fafbee10e6e4de50225a639?s=128&d=identicon&r=PG", "display_name": "user2539088", "link": "https://stackoverflow.com/users/2539088/user2539088"}, "edited": false, "score": 0, "creation_date": 1504107760, "post_id": 45739209, "comment_id": 78888074, "body": "@user2539088, yeah, don&#39;t worry if u couldn&#39;t find xlwings in references. have u tried to manually add modules in your vba project? ie. xlwings and xlwings_udfs, you just need to copy them from the official example workbook below: <a href=\"https://bitbucket.org/zoomeranalytics/xlwings_examples/downloads/udf.zip\" rel=\"nofollow noreferrer\">bitbucket.org/zoomeranalytics/xlwings_examples/downloads/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 2539088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd3ebdc2fafbee10e6e4de50225a639?s=128&d=identicon&r=PG", "display_name": "user2539088", "link": "https://stackoverflow.com/users/2539088/user2539088"}, "edited": false, "score": 0, "creation_date": 1506356779, "post_id": 45739209, "comment_id": 79777485, "body": "Hi @zleu - that worked, thanks a lot for your help! I don&#39;t have enough reputation to give your answer a vote up unfortunately..."}, {"owner": {"reputation": 26, "user_id": 7897120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63a8c042514087ae882d38396528791?s=128&d=identicon&r=PG&f=1", "display_name": "zleu", "link": "https://stackoverflow.com/users/7897120/zleu"}, "reply_to_user": {"reputation": 45, "user_id": 2539088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd3ebdc2fafbee10e6e4de50225a639?s=128&d=identicon&r=PG", "display_name": "user2539088", "link": "https://stackoverflow.com/users/2539088/user2539088"}, "edited": false, "score": 0, "creation_date": 1506437710, "post_id": 45739209, "comment_id": 79816632, "body": "Don&#39;t worry. main idea is that it worked! could u mark this as the answer? cheers. @user2539088"}], "tags": [], "owner": {"reputation": 26, "user_id": 7897120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63a8c042514087ae882d38396528791?s=128&d=identicon&r=PG&f=1", "display_name": "zleu", "link": "https://stackoverflow.com/users/7897120/zleu"}, "is_accepted": true, "score": 1, "last_activity_date": 1502983592, "creation_date": 1502983592, "answer_id": 45739209, "question_id": 45187597, "link": "https://stackoverflow.com/questions/45187597/python-xlwings-vba-reference-not-loading/45739209#45739209", "title": "Python xlwings VBA reference not loading", "body": "<p>I came across the same problem. However, there was a work around. Since ultimately you want the  work without alerting \"no xlwings moduldes\", you can manually import xlwings and xlwings_udfs modules into your current workbook then it will work. Those two modules should be available on any example spreadsheet from xlwings official website.</p>\n"}], "owner": {"reputation": 45, "user_id": 2539088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd3ebdc2fafbee10e6e4de50225a639?s=128&d=identicon&r=PG", "display_name": "user2539088", "link": "https://stackoverflow.com/users/2539088/user2539088"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1534, "favorite_count": 0, "accepted_answer_id": 45739209, "answer_count": 3, "score": 0, "last_activity_date": 1502983592, "creation_date": 1500459484, "question_id": 45187597, "link": "https://stackoverflow.com/questions/45187597/python-xlwings-vba-reference-not-loading", "title": "Python xlwings VBA reference not loading", "body": "<p>I want to run a python script from VBA using xlwings. I have installed the excel add-in by running</p>\n\n<pre><code>xlwings addin install\n</code></pre>\n\n<p>from the command prompt, however, the 'xlwings' reference is not showing up in the list of available references in my VBA project. (As a separate but perhaps connected issue, the xlwings add-in in the ribbon is only partly showing: it only shows the 'Active Workbook' and 'Advanced' subcategory.)</p>\n\n<p>I am on Windows 7 Enterprise and Excel 2016</p>\n\n<p><a href=\"https://i.stack.imgur.com/gEzUY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gEzUY.png\" alt=\"xlwings reference not showing up in the VBA references list\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/UaqhW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UaqhW.png\" alt=\"xlwings ribbon is not complete - there&#39;s some buttons missing\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1500462211, "post_id": 45187591, "comment_id": 77344289, "body": "When you copy/paste manually are you using the same range as the macro?"}, {"owner": {"reputation": 1, "user_id": 8330875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc72c0d756e87d08d2d1354ab42984d?s=128&d=identicon&r=PG&f=1", "display_name": "user8330875", "link": "https://stackoverflow.com/users/8330875/user8330875"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1500462697, "post_id": 45187591, "comment_id": 77344625, "body": "Yes everything the same. In fact, if I let the macro fail then I can just hit CTRL+V straight away and it finishes the job for me."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1500467894, "post_id": 45187591, "comment_id": 77348684, "body": "I don&#39;t understand how you can paste using Ctrl+V if the sheet is protected."}, {"owner": {"reputation": 1, "user_id": 8330875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc72c0d756e87d08d2d1354ab42984d?s=128&d=identicon&r=PG&f=1", "display_name": "user8330875", "link": "https://stackoverflow.com/users/8330875/user8330875"}, "edited": false, "score": 0, "creation_date": 1500469732, "post_id": 45187591, "comment_id": 77350300, "body": "I don&#39;t understand that either...."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8330875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc72c0d756e87d08d2d1354ab42984d?s=128&d=identicon&r=PG&f=1", "display_name": "user8330875", "link": "https://stackoverflow.com/users/8330875/user8330875"}, "edited": false, "score": 0, "creation_date": 1500461065, "post_id": 45187958, "comment_id": 77343434, "body": "Hi SJR. Thanks but that won&#39;t work as the sheet isn&#39;t just protected, it has a password on it, and like I said above I am not able to unprotect the sheet."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 8330875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc72c0d756e87d08d2d1354ab42984d?s=128&d=identicon&r=PG&f=1", "display_name": "user8330875", "link": "https://stackoverflow.com/users/8330875/user8330875"}, "edited": false, "score": 0, "creation_date": 1500461259, "post_id": 45187958, "comment_id": 77343574, "body": "Ok sorry didn&#39;t read your question properly. Do you know how it is protected? Can you not unprotect it because you don&#39;t have the password?"}, {"owner": {"reputation": 1, "user_id": 8330875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc72c0d756e87d08d2d1354ab42984d?s=128&d=identicon&r=PG&f=1", "display_name": "user8330875", "link": "https://stackoverflow.com/users/8330875/user8330875"}, "edited": false, "score": 0, "creation_date": 1500461562, "post_id": 45187958, "comment_id": 77343809, "body": "That&#39;s right, don&#39;t have the password. I could throw in some code to break it open but because of corporate compliance I don&#39;t really want to do that..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 8330875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc72c0d756e87d08d2d1354ab42984d?s=128&d=identicon&r=PG&f=1", "display_name": "user8330875", "link": "https://stackoverflow.com/users/8330875/user8330875"}, "edited": false, "score": 0, "creation_date": 1500461658, "post_id": 45187958, "comment_id": 77343894, "body": "Unless UserInterfaceOnly has been set to True, I don&#39;t think you can paste to a protected sheet. A good argument for someone to tell you the password?"}, {"owner": {"reputation": 203, "user_id": 8060864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ccaaff8f4d7eee72fe356c60bc71f534?s=128&d=identicon&r=PG&f=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/8060864/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1500477374, "post_id": 45187958, "comment_id": 77356762, "body": "Are you allowed to access a sheet&#39;s Range property at all if it&#39;s protected? If you&#39;re really willing, you might be able to simulate a copy &amp; paste action using <code>SendKeys</code>."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1500460414, "creation_date": 1500460414, "answer_id": 45187958, "question_id": 45187591, "link": "https://stackoverflow.com/questions/45187591/unable-to-paste-into-a-protected-worksheet-using-vba-but-can-do-it-manually/45187958#45187958", "title": "Unable to paste into a protected worksheet using VBA, but can do it manually", "body": "<p>Paste is a method of the worksheet, not range. Try this. I have assumed sheet references but you may need to adjust.</p>\n\n<pre><code>Sub COPYT()\n\nDim wb As Workbook\n\nSet wb = Workbooks.Open(Filename:=\"_FileName_.xls\")\nwb.Sheets(\"compliance\").unprotect    \nThisWorkbook.Sheets(1).Range(\"B2:U109\").Copy wb.Sheets(\"compliance\").Range(\"H10\")\nwb.Sheets(\"compliance\").protect\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8330875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc72c0d756e87d08d2d1354ab42984d?s=128&d=identicon&r=PG&f=1", "display_name": "user8330875", "link": "https://stackoverflow.com/users/8330875/user8330875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1451, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500465202, "creation_date": 1500459460, "last_edit_date": 1500465202, "question_id": 45187591, "link": "https://stackoverflow.com/questions/45187591/unable-to-paste-into-a-protected-worksheet-using-vba-but-can-do-it-manually", "title": "Unable to paste into a protected worksheet using VBA, but can do it manually", "body": "<p>I have written a macro that should copy a range of data from one workbook into another. The sheet in the other workbook is password protected, but if I copy and past manually, it allows me to do so. However, when I try and write this into my macro, it won't allow the paste. </p>\n\n<p>Code is currently as follows:</p>\n\n<pre><code>Sub COPYT()\n'\n' COPYT Macro\n\n    Range(\"B2:U109\").Select\n    Selection.Copy\n    Workbooks.Open Filename:= _\n        \"_FileName_.xls\"\n    Windows(\"_FileName_.xls\").Activate\n    Range(\"H10\").Paste\n\nEnd Sub\n</code></pre>\n\n<p>When I run the macro as is, I get a </p>\n\n<blockquote>\n  <p>Run-time error '438': \"Object doesn't support this property or method\"</p>\n</blockquote>\n\n<p>and the debugger shows that the issue is with the last line <code>Range(\"H10\").Paste</code></p>\n\n<p>I can't unprotect the sheet (compliance), and I can obviously get round this by just running the macro and then CTRL+V but (as this allows me to paste....), but I would rather that this was automated. Do I need a different syntax for the paste command due to the sheet being protected?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1500459232, "post_id": 45187475, "comment_id": 77342216, "body": "Try using Set when you assign Table1 and Table 2 (as you did for sht) as I guess they are range variables (don&#39;t seem to be declared)."}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 0, "creation_date": 1500461525, "post_id": 45187578, "comment_id": 77343767, "body": "First, thank you for your help. How would i go and tackle the error 91 I am getting now?"}, {"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 1, "creation_date": 1500463576, "post_id": 45187578, "comment_id": 77345265, "body": "Nevermind, found out by perstistence and trial and error. Thank you for your help."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1500463654, "last_edit_date": 1500463654, "creation_date": 1500459435, "answer_id": 45187578, "question_id": 45187475, "link": "https://stackoverflow.com/questions/45187475/find-in-vba-between-datasets-on-different-worksheets/45187578#45187578", "title": ".Find in VBA between Datasets on different Worksheets", "body": "<p>As <code>SJR</code> mentioned - you are not using Set for the Tables.\nHowever, in general, try to write your code, writing <code>Option Explicit</code> on top - then you should be forced to declare all variables.</p>\n\n<p>Thus, you would need something like this:</p>\n\n<pre><code>Dim Table2 as Range\nDim Table1 as Range\n</code></pre>\n\n<p>Then, once they are defined as ranges, the error would be more visible and would be <code>91</code>:</p>\n\n<pre><code>Option Explicit    \nPublic Sub TestMe()        \n    Dim Table1 As Range\n    Table1 = Range(\"A1:A5\")    \nEnd Sub\n</code></pre>\n\n<p>Error 91 is fixed by adding <code>Set Table1 = Range(\"A1:A5\")</code></p>\n"}], "owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 45187578, "answer_count": 1, "score": 0, "last_activity_date": 1500463654, "creation_date": 1500459135, "question_id": 45187475, "link": "https://stackoverflow.com/questions/45187475/find-in-vba-between-datasets-on-different-worksheets", "title": ".Find in VBA between Datasets on different Worksheets", "body": "<p>Fellow fans of StackOverflow,</p>\n\n<p>I'm trying to use .Find with VBA but keep getting a rather annoying error. To be precise, it's error 424, object required.</p>\n\n<p>Trying to learn, but have been struggling with this error for over 24 hours now and just can't seem to find my fault. I've added also some screenshots below so you can see the data for yourself.</p>\n\n<p>Explanation of screenshots: Screenshot1 is my first Dataset, in which i want Column H populated by Column F from Screenshot2, my common caller is found in Column D in the first Dataset and in Column B in the second Dataset.</p>\n\n<p>Summary of my problem: Been having error 424, object required with data below. Please help me find what I'm doing wrong, since I want to learn from this and have been struggling with this error for over 24 hours now.</p>\n\n<pre><code>Dim sht As Worksheet, sht2 As Worksheet\nSet sht = Sheets(\"16-Compliancy-Rebuild\")\nSet sht2 = Sheets(\"OpmerkingBackup\")\nDim Dept_Row As Long\nDim Dept_Clm As Long\nDim rng As Range\nTable1 = sht.Range(\"D85:D750\")\nTable2 = sht2.Range(\"B3:B750\")\nDept_Row = sht.Range(\"H85\").Row\nDept_Clm = sht.Range(\"H85\").Column\nFor Each cl In Table1\nSet rng = Table2.Find(cl, SearchDirection:=xlPrevious, LookAt:=xlWhole)\nIf Not rng Is Nothing Then\n    sht.Cells(Dept_Row, Dept_Clm) = sht2.Cells(rng.Row, 6).Value\nEnd If\n  Dept_Row = Dept_Row + 1\nNext cl\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TRyKI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TRyKI.png\" alt=\"First dataset where i want to populate Column H\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/D15OV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D15OV.png\" alt=\"Second Dataset where i want to take column F and populate Column H in first Dataset\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1500458216, "post_id": 45186951, "comment_id": 77341490, "body": "SELECT INTO will create the table if possible, you need an INSERT INTO once the table exists."}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1500458299, "post_id": 45187109, "comment_id": 77341555, "body": "I was first you know :)"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1500458566, "post_id": 45187109, "comment_id": 77341749, "body": "I know. :) But <i>&quot;Avoid answering questions in comments.&quot;</i>"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1500458261, "creation_date": 1500458261, "answer_id": 45187109, "question_id": 45186951, "link": "https://stackoverflow.com/questions/45186951/select-into-inserts-only-the-last-row-vba-access-2000/45187109#45187109", "title": "SELECT INTO inserts only the last row - VBA, Access 2000?", "body": "<p><code>SELECT INTO</code> is a \"Create table\" query, it will overwrite the target table each time you run it.</p>\n\n<p>Once the table exists you need <code>INSERT INTO</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2591, "user_id": 885838, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/kYqCd.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/885838/vlad"}, "is_accepted": false, "score": 1, "last_activity_date": 1500468033, "creation_date": 1500468033, "answer_id": 45190933, "question_id": 45186951, "link": "https://stackoverflow.com/questions/45186951/select-into-inserts-only-the-last-row-vba-access-2000/45190933#45190933", "title": "SELECT INTO inserts only the last row - VBA, Access 2000?", "body": "<p>Well, I used this sort of SQL query</p>\n\n<pre><code>INSERT INTO table1 (col1, col2, ..., coln) SELECT col1, col2,..., coln FROM table2 WHERE condition GROUP BY colx;\n</code></pre>\n"}], "owner": {"reputation": 2591, "user_id": 885838, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/kYqCd.png?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/885838/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 45187109, "answer_count": 2, "score": 0, "last_activity_date": 1500468033, "creation_date": 1500457834, "question_id": 45186951, "link": "https://stackoverflow.com/questions/45186951/select-into-inserts-only-the-last-row-vba-access-2000", "title": "SELECT INTO inserts only the last row - VBA, Access 2000?", "body": "<p>I have this SQL string which I create in a Loop:</p>\n\n<pre><code>\"SELECT '\" &amp; Trim(Str(j)) &amp; \"' AS cpa, Count(Val('\" &amp; rsCPANezbirni(\"tipprod\") &amp; \"')) AS BrojProd, Sum(Val('\" &amp; rsCPANezbirni(\"povrsina\") &amp; \"')) AS p, Sum(Val('\" &amp; rsCPANezbirni(\"pmagacin\") &amp; \"')) AS pm INTO T14_KPD_CPA_samo_podatoci FROM CPA_nezbirni WHERE (t4k\" &amp; Trim(Str(j)) &amp; \"&lt;&gt;'' Or t4k\" &amp; Trim(Str(j)) &amp; \" Is Not Null);\"\n</code></pre>\n\n<p>And the loop I use is:</p>\n\n<pre><code>Dim j As Integer\nj = 1\nDo While j &lt;= 3\n    cpaSelectSQL = \"SELECT '\" &amp; Trim(Str(j)) &amp; \"' AS cpa, Count(Val('\" &amp; rsCPANezbirni(\"tipprod\") &amp; \"')) AS BrojProd, Sum(Val('\" &amp; rsCPANezbirni(\"povrsina\") &amp; \"')) AS p, Sum(Val('\" &amp; rsCPANezbirni(\"pmagacin\") &amp; \"')) AS pm INTO T14_KPD_CPA_samo_podatoci FROM CPA_nezbirni WHERE (t4k\" &amp; Trim(Str(j)) &amp; \"&lt;&gt;'' Or t4k\" &amp; Trim(Str(j)) &amp; \" Is Not Null);\"\n    Debug.Print \"j = \" &amp; Str(j) &amp; \", cpa select SQL: \" &amp; cpaSelectSQL\n    DoCmd.RunSQL cpaSelectSQL, True\n\n    On Error GoTo ErrorHandler\n    j = j + 1\nLoop\n</code></pre>\n\n<p>The problem I have, only the last generated row gets copied in T14_KPD_CPA_samo_podatoci i.e cpa = 3</p>\n\n<p>I want to copy each for for the value of cpa 1 to 3.</p>\n\n<p>What do I do wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500457160, "post_id": 45186638, "comment_id": 77340683, "body": "It is definitely possible. Try to do the following -&gt; 1. Filter the dates. 2. Create a new sheet. 3. Paste the dates on the new sheet."}, {"owner": {"reputation": 69, "user_id": 8256713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da5c5595467a75284612cd435cc0c699?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8256713/mark"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500457400, "post_id": 45186638, "comment_id": 77340880, "body": "My_Range.AutoFilter Field:=FieldNum, Criteria1:=&quot;=&quot; what should I put on criteria regarding this? Thanks."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500457589, "post_id": 45186638, "comment_id": 77341024, "body": "Simply record a macro and check it out -&gt; It would be there."}, {"owner": {"reputation": 69, "user_id": 8256713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da5c5595467a75284612cd435cc0c699?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8256713/mark"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500458237, "post_id": 45186638, "comment_id": 77341509, "body": "ActiveSheet.Range(&quot;$A$1:$V$31647&quot;).AutoFilter Field:=13, Operator:= _         xlFilterValues, Criteria2:=Array(1, &quot;1/31/2017&quot;) - this what macro return. I&#39;ll be needing all months so I guess it should loop from January-December."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500458294, "post_id": 45186638, "comment_id": 77341551, "body": "You are doing good, Mark! :)"}, {"owner": {"reputation": 69, "user_id": 8256713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da5c5595467a75284612cd435cc0c699?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8256713/mark"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500458575, "post_id": 45186638, "comment_id": 77341757, "body": "So you mean I need to record macro for all the months?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500458665, "post_id": 45186638, "comment_id": 77341819, "body": "You can do it. Then you can compare the differences in the code and think what you can do to make it better. Then read about Loops and how they function. <a href=\"https://www.google.com/search?q=loop+vba&amp;oq=loop+vba&amp;aqs=chrome.0.0l2j69i60l3j0.1416j0j7&amp;sourceid=chrome&amp;ie=UTF-8\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}], "owner": {"reputation": 69, "user_id": 8256713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da5c5595467a75284612cd435cc0c699?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8256713/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 389, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500457054, "creation_date": 1500457054, "question_id": 45186638, "link": "https://stackoverflow.com/questions/45186638/vba-to-filter-all-months-w-year-in-date-column", "title": "VBA to filter all months w/ year in date column", "body": "<p>I am on this project that I need to filter out all the months with year in the date column. For example, all the January 2017 dates are filtered out and copy to new sheet, all February 2017 dates are filtered out and copy to new sheet, and so on. Is it possible in VBA? I don't have code yet. Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500458503, "post_id": 45187072, "comment_id": 77341701, "body": "Well thanks for your answer, but I didn&#39;t want to use a formula because I wanted to use the code for other purposes/cases in the same spreadsheet (but the philosophy is the same). I described my problem in a simple way, but for example in column A I can have more than 2 genders, like M, F, jrM, jrF, and so on. That would create a massive if. Or more than sizes, materials. Like different materials have different sizes, etc.."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500640807, "post_id": 45187072, "comment_id": 77441631, "body": "@ZedA. - I&#39;ve added VBA solution, see edit in my answer."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 2, "last_activity_date": 1500640731, "last_edit_date": 1500640731, "creation_date": 1500458169, "answer_id": 45187072, "question_id": 45186445, "link": "https://stackoverflow.com/questions/45186445/excel-vba-select-a-value-from-a-list-in-another-sheet-based-on-a-condition/45187072#45187072", "title": "excel VBA select a value from a list (in another sheet) based on a condition", "body": "<p>Enter the following formula in <code>Cell C2</code> of <code>Selection</code> sheet</p>\n\n<pre><code>=IFERROR(IF(A2=\"M\",INDEX(Sizes!$A$3:$A$10,MATCH(TRUE,Sizes!$A$3:$A$10&gt;B2,0)),INDEX(Sizes!$B$3:$B$10,MATCH(TRUE,Sizes!$B$3:$B$10&gt;B2,0))),\"Not Available\")\n</code></pre>\n\n<p>This is an array formula so commit it by pressing <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>. Drag/Copy down as required.</p>\n\n<p>See image for reference</p>\n\n<p><a href=\"https://i.stack.imgur.com/1lGED.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1lGED.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>EDIT :</em></strong></p>\n\n<hr>\n\n<p>Following is VBA solution:</p>\n\n<pre><code>Sub Demo()\n    With Application\n        .ScreenUpdating = False             'stop screen flickering\n        .Calculation = xlCalculationManual  'prevent calculation while execution\n    End With\n\n    Dim selectionSht As Worksheet, sizeSht As Worksheet\n    Dim selectionLR As Long, sizeLR As Long, lastColumn As Long\n    Dim dict As Object\n    Dim rng As Range, cel As Range, genderRng As Range, valueRng As Range\n    Dim key As Variant\n    Dim colName As String\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    Set selectionSht = ThisWorkbook.Sheets(\"Selection\") 'Selection sheet\n    Set sizeSht = ThisWorkbook.Sheets(\"Sizes\")  'Sizes sheet\n    selectionLR = selectionSht.Cells(selectionSht.Rows.Count, \"A\").End(xlUp).Row    'last row in Selection sheet\n    sizeLR = sizeSht.Cells(sizeSht.Rows.Count, \"A\").End(xlUp).Row   'last row in Sizes sheet\n    lastColumn = sizeSht.Cells(2, sizeSht.Columns.Count).End(xlToLeft).Column   'last column in Sizes sheet using row 2\n    Set valueRng = selectionSht.Range(\"B2:B\" &amp; selectionLR) 'data with value in Selection sheet\n\n    'storing all genders and corresponding column number from Sizes sheet in a dictionary\n    With sizeSht\n        Set rng = .Range(.Cells(2, 1), .Cells(2, lastColumn))\n        For Each cel In rng\n            dict.Add cel.Value, cel.Column\n        Next cel\n    End With\n\n    With selectionSht\n        For Each cel In .Range(.Cells(2, 3), .Cells(selectionLR, 3)) '3 is column no for results to be displayed\n            colName = Replace(.Cells(1, dict(CStr(cel.Offset(0, -2)))).Address(True, False), \"$1\", \"\")  'get column name from column 2\n            Set genderRng = sizeSht.Range(colName &amp; \"3:\" &amp; colName &amp; sizeLR)    'set column for index/match formula\n            cel.FormulaArray = \"=IFERROR(INDEX(Sizes!\" &amp; genderRng.Address &amp; \",MATCH(TRUE,Sizes!\" &amp; genderRng.Address &amp; \"&gt;\" &amp; cel.Offset(0, -1) &amp; \",0)),\"\"Not Available\"\")\"\n            cel.Value = cel.Value\n        Next cel\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\nEnd Sub\n</code></pre>\n\n<p>Let me know if anything is not clear.</p>\n"}, {"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1500458666, "post_id": 45187146, "comment_id": 77341820, "body": "@ZedA this formula can easily handle as many &quot;genders&quot; as you want. After entering it you can &quot;insert&quot; columns in the &quot;sizes&quot; sheet and it will adjust automatically."}, {"owner": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "edited": false, "score": 0, "creation_date": 1500459316, "post_id": 45187146, "comment_id": 77342281, "body": "what if the size is not a number? let&#39;s say that for values from 100 to 200, the corresponding size is S, from 201 to 300 the size is M, etc."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1500458348, "creation_date": 1500458348, "answer_id": 45187146, "question_id": 45186445, "link": "https://stackoverflow.com/questions/45186445/excel-vba-select-a-value-from-a-list-in-another-sheet-based-on-a-condition/45187146#45187146", "title": "excel VBA select a value from a list (in another sheet) based on a condition", "body": "<p>You can use this (normal) formula in <code>C2</code> and fill down:</p>\n\n<pre><code>C2:\n=IFERROR(AGGREGATE(15,6,Sizes!$A$3:$B$10\n  /(Sizes!$A$2:$B$2=A2)/(Sizes!$A$3:$B$10&gt;=B2),1), \"Not Available!\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mLapU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mLapU.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 7739627, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CxcPO.jpg?s=128&g=1", "display_name": "Zed A.", "link": "https://stackoverflow.com/users/7739627/zed-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 45187072, "answer_count": 2, "score": 0, "last_activity_date": 1500640731, "creation_date": 1500456598, "question_id": 45186445, "link": "https://stackoverflow.com/questions/45186445/excel-vba-select-a-value-from-a-list-in-another-sheet-based-on-a-condition", "title": "excel VBA select a value from a list (in another sheet) based on a condition", "body": "<p>In sheet \"Selection\" I input a Gender (M or F) in column A, and a corresponding value in column B.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ophj7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ophj7.png\" alt=\"enter image description here\"></a></p>\n\n<p>In sheet \"Sizes\", I have lists of the available sizes for each gender, like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RuqSH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RuqSH.png\" alt=\"enter image description here\"></a></p>\n\n<p>In sheet \"Selection\", I want it to write on Column C the corresponding size (that must be always be higher than column B). If there is not an available size, it must write \"Not available!\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/DC3dH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DC3dH.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["windows", "excel", "file", "filesystems", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500457463, "post_id": 45186374, "comment_id": 77340931, "body": "The <code>~$</code> files are just temporary locking files created when you open a workbook (or when someone else opens the workbook).  They should be deleted again when the workbook is closed, but sometimes they get left in existence if Excel crashes or something similar.  (Note: the temporary files are just dummy files, or maybe they contain the userid of who has the file open, but they are not Excel workbooks - so a <code>Open</code> of them will fail.)"}, {"owner": {"reputation": 151, "user_id": 7216019, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VFDRl2B2Fww/AAAAAAAAAAI/AAAAAAAAAbc/seo5W3HY-ww/photo.jpg?sz=128", "display_name": "kjbergman", "link": "https://stackoverflow.com/users/7216019/kjbergman"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500546081, "post_id": 45186374, "comment_id": 77389822, "body": "Okay, so I take it when I iterate over each File in Folder.Files Windows is temporarily creating a lock for that file? Thus, when finding a match in the rest of the file name that&#39;s the name returned."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500579400, "post_id": 45186374, "comment_id": 77413709, "body": "No - the lock file would only be created if the file is currently open in Excel (such as the file your macro is in), or was previously open in Excel but not closed correctly.  Your code is just iterating over the files in the directory without actually opening the files - so you should just be seeing the same files as you would if you looked at the folder in Windows Explorer (assuming WE has &quot;show hidden files&quot; enabled)."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1500580051, "creation_date": 1500580051, "answer_id": 45223966, "question_id": 45186374, "link": "https://stackoverflow.com/questions/45186374/excel-vba-open-file-error-1004-after-prefixing/45223966#45223966", "title": "Excel VBA Open File Error 1004 After prefixing &quot;~$&quot;", "body": "<p>If you want to ignore hidden files (such as the lock files generated by Office applications when you open a document), it might be best to modify your line saying</p>\n\n<pre><code>If (InStr(1, LCase(File.name), firstString) &gt; 0) And (InStr(1, LCase(File.name), secondString) &gt; 0) Then\n</code></pre>\n\n<p>to also test that the file is not hidden, e.g.</p>\n\n<pre><code>If (InStr(1, LCase(File.name), firstString) &gt; 0) And _\n   (InStr(1, LCase(File.name), secondString) &gt; 0) And _\n   Not (File.Attributes And vbHidden) Then\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 7216019, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VFDRl2B2Fww/AAAAAAAAAAI/AAAAAAAAAbc/seo5W3HY-ww/photo.jpg?sz=128", "display_name": "kjbergman", "link": "https://stackoverflow.com/users/7216019/kjbergman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500580051, "creation_date": 1500456415, "last_edit_date": 1531161705, "question_id": 45186374, "link": "https://stackoverflow.com/questions/45186374/excel-vba-open-file-error-1004-after-prefixing", "title": "Excel VBA Open File Error 1004 After prefixing &quot;~$&quot;", "body": "<p>I am writing some VBA to optimise workflows in Excel 2013 and I am using a Windows 10 machine.\nI use a simple recursive procedure to traverse the file structure looking for specific content in file names as per below:</p>\n\n<pre><code>Function filePathToList(fileStart As String, firstString As String, secondString As String) As String\nDim FileSystem As Object\nDim HostFolder As String\n\nHostFolder = fileStart\nSet FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n\nfilePathToList = DoFolder(FileSystem.GetFolder(HostFolder), LCase(firstString), LCase(secondString))\nEnd Function\n\nFunction DoFolder(Folder, firstString As String, secondString As String) As String\nDim SubFolder\nFor Each SubFolder In Folder.SubFolders\n    DoFolder = DoFolder(SubFolder, firstString, secondString)\nNext\nDim File\nFor Each File In Folder.Files\n    If (InStr(1, LCase(File.name), firstString) &gt; 0) And (InStr(1, LCase(File.name), secondString) &gt; 0) Then\n        DoFolder = Folder.Path &amp; \"\\\" &amp; File.name\n        Debug.Print DoFolder\n        Debug.Print File.name\n        Debug.Print File\n        Exit Function\n    End If\nNext\nEnd Function\n</code></pre>\n\n<p>I have made some debugging to figure out what happens, and I'll be d*mned but VBA decides to add \"~$\" as a prefix to my found file: </p>\n\n<pre><code>X:\\05_Sputnik\\T\\Pony\\_New_building_YYYYpp_\\~$Komplettlista_Mamma mu.xlsx\n~$Komplettlista_Mamma mu.xlsx\nX:\\05_Sputnik\\T\\Pony\\_New_building_YYYYpp_\\~$Komplettlista_Mamma mu.xlsx\n</code></pre>\n\n<p>The way I see it the complete path is:\nX:\\05_Sputnik\\T\\Pony_New_building_YYYYpp_\\Komplettlista_Mamma mu.xlsx\nAnd VBA agrees with me since it complains about not finding it when trying to open it.</p>\n\n<p>I can solve this by doing a substring extraction but imo it's not very neat. My question is however;</p>\n\n<p><strong>Why does this happen?</strong></p>\n\n<p>I find the file exactly where it is expected to be and there are no hidden files with similar names. Is Windows playing a trick on me?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500456749, "post_id": 45186366, "comment_id": 77340382, "body": "<a href=\"https://stackoverflow.com/questions/20697706/how-to-add-a-named-sheet-at-the-end-of-all-excel-sheets\" title=\"how to add a named sheet at the end of all excel sheets\">stackoverflow.com/questions/20697706/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 7693700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c35b5e0f54de8cc549518a9954c24e60?s=128&d=identicon&r=PG&f=1", "display_name": "HKU_Johnny_QFin", "link": "https://stackoverflow.com/users/7693700/hku-johnny-qfin"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1500456982, "post_id": 45186366, "comment_id": 77340548, "body": "thanks@Vityata , But I would like to save the analytical stuff every time I run the macro. For example, I run the codes for 3 times, then I would like to have 3 sheets saving my previous analytical stuff"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7693700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c35b5e0f54de8cc549518a9954c24e60?s=128&d=identicon&r=PG&f=1", "display_name": "HKU_Johnny_QFin", "link": "https://stackoverflow.com/users/7693700/hku-johnny-qfin"}, "edited": false, "score": 0, "creation_date": 1500459744, "post_id": 45187489, "comment_id": 77342582, "body": "thank you very much for your help. Actually, every time when I run the macro, there would be a sheet coming out. If I do not save the sheet, I run the macro again, then the results would show in the same sheet covering previous results. I would like to save the result to a new sheet every time I run the code,"}], "tags": [], "owner": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "is_accepted": false, "score": 0, "last_activity_date": 1500459182, "creation_date": 1500459182, "answer_id": 45187489, "question_id": 45186366, "link": "https://stackoverflow.com/questions/45186366/vba-to-save-macro-results-in-a-new-sheet-every-time/45187489#45187489", "title": "vba to save macro results in a new sheet every time", "body": "<p>You could just start adding this to your code, which generate a new tab and call it with \"R_\" and the current date/time:</p>\n\n<pre><code>Sheets.Add.Name = ActiveSheet.Name = \"R_\" &amp; Format(Date, \"ddmmyy\") &amp; \"_\" &amp; Format(Time, \"hhmmss\") \n</code></pre>\n\n<p>then you have to edit your code and print all results in this sheet. It is really hard to help you in this second part, because you didn't show us the code you're using.</p>\n"}], "owner": {"reputation": 11, "user_id": 7693700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c35b5e0f54de8cc549518a9954c24e60?s=128&d=identicon&r=PG&f=1", "display_name": "HKU_Johnny_QFin", "link": "https://stackoverflow.com/users/7693700/hku-johnny-qfin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500459182, "creation_date": 1500456398, "question_id": 45186366, "link": "https://stackoverflow.com/questions/45186366/vba-to-save-macro-results-in-a-new-sheet-every-time", "title": "vba to save macro results in a new sheet every time", "body": "<p>I currently have my own vba to take data from some website, I also imposed some codes to do analytical stuff. </p>\n\n<p>The thing is that I would like to save the analytical results in a new sheet every time I run the macro. </p>\n\n<p>How should I deal with the code?</p>\n"}, {"tags": ["vba", "excel", "autofill"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1500455918, "post_id": 45186124, "comment_id": 77339793, "body": "You do not assign a value to F so it will be zero."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1500456039, "post_id": 45186124, "comment_id": 77339884, "body": "I think you meant to use your lastRow variable instead of F"}], "owner": {"reputation": 11, "user_id": 7936035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/941d7cadb4cfb5b9fc81d0cf84edc554?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7936035/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500455832, "creation_date": 1500455832, "question_id": 45186124, "link": "https://stackoverflow.com/questions/45186124/run-time-error-1004-application-defined-or-object-defined-error", "title": "Run-time error &#39;1004&#39;: Application-Defined or Object defined error", "body": "<p>I'm pretty new to VBA and am having some issues regarding my Autofill lines.<br>\nSpecifically, I'm having issues with this line: </p>\n\n<p>Worksheets(\"Batches\").Range(\"C2\").AutoFill Destination:=Worksheets(\"Batches\").Range(\"C2:C\" &amp; F) </p>\n\n<p>My full code is below and if anyone could help, that would be greatly appreciated!</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\n\nWorksheets(\"Batches\").Activate\n\n\nDim F As Long\nlastRow = Worksheets(\"Batches\").Range(\"A\" &amp; Rows.Count).End(xlDown).Row\nWorksheets(\"Batches\").Range(\"C2\").AutoFill Destination:=Worksheets(\"Batches\").Range(\"C2:C\" &amp; F)\nWorksheets(\"Batches\").Range(\"D2\").AutoFill Destination:=Worksheets(\"Batches\").Range(\"D2:D\" &amp; F)\n\n\nWorksheets(\"Batches\").Range(\"A:A\").Copy\nWorksheets(\"Batches\").Range(\"G:G\").PasteSpecial (xlPasteValues)\nWorksheets(\"Batches\").Range(\"D:D\").Copy\nWorksheets(\"Batches\").Range(\"H:H\").PasteSpecial (xlPasteValues)\n\nColumns(\"G:H\").Select\nApplication.CutCopyMode = False\nActiveWorkbook.Worksheets(\"Batches\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Batches\").Sort.SortFields.Add Key:=Range( _\n    \"H2:H1048576\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Batches\").Sort\n    .SetRange Columns(\"G:H\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\n\n\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\nApplication.EnableEvents = True\nActiveSheet.DisplayPageBreaks = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1500455429, "post_id": 45185792, "comment_id": 77339440, "body": "So you want to select 6 rows and all columns to the left of the cell in column A? Is it always six rows?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1500456614, "post_id": 45185792, "comment_id": 77340270, "body": "How do you define the place holder? What we need to understand is what will be placed in the found range where <code>Product&#47;URL</code> is found."}, {"owner": {"reputation": 11, "user_id": 8016911, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728099144149904/picture?type=large", "display_name": "Jade Bowen", "link": "https://stackoverflow.com/users/8016911/jade-bowen"}, "edited": false, "score": 0, "creation_date": 1500508570, "post_id": 45185792, "comment_id": 77372803, "body": "@SJR- No not really, new columns will be added for the dates every week."}, {"owner": {"reputation": 11, "user_id": 8016911, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728099144149904/picture?type=large", "display_name": "Jade Bowen", "link": "https://stackoverflow.com/users/8016911/jade-bowen"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1500508762, "post_id": 45185792, "comment_id": 77372853, "body": "@L42 - Product/URL is just the marker where the range selection will offset. In the image, Product/URL in A1 is where the selection offset to the right and select Range between KW up the last Date but not including the Row for the next Product/URL in A7."}], "owner": {"reputation": 11, "user_id": 8016911, "user_type": "registered", "profile_image": "https://graph.facebook.com/1728099144149904/picture?type=large", "display_name": "Jade Bowen", "link": "https://stackoverflow.com/users/8016911/jade-bowen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500456436, "creation_date": 1500455020, "last_edit_date": 1500456436, "question_id": 45185792, "link": "https://stackoverflow.com/questions/45185792/loop-and-add-range-in-a-place-holder", "title": "Loop and Add Range in a place holder", "body": "<p><img src=\"https://i.stack.imgur.com/LwTZo.png\" alt=\"Add Range in a place holder\"></p>\n\n<p>Hello, </p>\n\n<p>First of all, thanks for everyone who's helped me with my previous concern. I have another loop issue though. What I'm trying to do is store a certain range on a place holder and use for Charts. My code loops through column A to check cells that contain <code>Product/URL</code> and if found, will offset to the next column and will store the range highlighted on a place holder. </p>\n\n<p>What I was able to do so far is to just select the cell with content in-line with cell with <code>Product/URL</code>. Here's my code so far.</p>\n\n<pre><code>Dim ProdCell as Range\n\nFor Each ProdCell in [A:A].SpecialCells(xlCellTypeConstants)\n    If Not IsEmpty(Prodcell) and Prodcell.Cells.Value = [A1] Then\n        ProdCell.Offset(0,1).Cells.End(xlToRight).Select\n    End if\nNext ProdCell\n</code></pre>\n\n<p>I believe that if I can find a way to highlight the range using VBA coding, I will be able to loop through it. Please help. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1500454525, "post_id": 45185339, "comment_id": 77338836, "body": "&quot;... but can&#39;t get anymore to work with this code.&quot;  What happens when you try?"}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500454959, "post_id": 45185339, "comment_id": 77339113, "body": "nothing, my excel code for the change by value is as below, but I have two other cells which will be used to run up to four different macro&#39;s - depending on the selection criteria.  The macros are all pretty simple - if cell =1, cut and paste something, else if cell =2, cut and paste something else type code.  have seen on various places online that one only change by value code can be used, surely there is a way round this which is simple enough for a novice like me?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500457131, "post_id": 45185339, "comment_id": 77340659, "body": "A <code>Worksheet_Change</code> event is just like any other piece of code.  You can easily program it to do either one thing or many things, dependent on what cells were changed (e.g. if cell D1 was changed, do something, else if a cell in column H was changed, do something else, etc).  Why don&#39;t you post <b>in your question</b> what you tried, and we should be able to work out how to help you fix it so that it <b>does</b> do something.  (Well, someone else will help you - I&#39;m calling it a night now.)"}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500459207, "post_id": 45185339, "comment_id": 77342201, "body": "OK I will do later today"}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500639243, "post_id": 45185339, "comment_id": 77440396, "body": "This is the code I am using in the page"}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500639670, "post_id": 45185339, "comment_id": 77440725, "body": "This is the First subroutine code I am using in the page      Sheets(&quot;2.2 Report&quot;).Select     If ActiveSheet.Range(&quot;E12&quot;).Value = &quot;&quot; Then         Application.Run (&quot;move_cursor_to_second_item&quot;)     ElseIf ActiveSheet.Range(&quot;E12&quot;).Value = &quot;1&quot; Then         Application.Run (&quot;Baker_ISTO&quot;)     ElseIf ActiveSheet.Range(&quot;E12&quot;).Value = &quot;2&quot; Then         Range (D14)     End If"}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500639715, "post_id": 45185339, "comment_id": 77440757, "body": "The next two subs follow on from the one above and are  Sheets(&quot;Support&quot;).Select     Range(&quot;Q2:S3&quot;).Select     Selection.Copy     Sheets(&quot;2.2 Report&quot;).Select     Range(&quot;G12&quot;).Select     ActiveSheet.Paste     Range(&quot;A18:C18&quot;).Select   and  Range(&quot;A17&quot;).Select     ActiveCell.FormulaR1C1 = &quot;PLEASE RECHECK SCREEN ORDER STATUS BEFORE PROCEDING&quot;  I have two others which work fine, but none of the above will work"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1500666657, "post_id": 45185339, "comment_id": 77457395, "body": "Please paste the code into the question itself (it&#39;s nearly impossible to read in comments), including the <code>Sub</code> statement itself for each of the subroutines, and ensure you include the <code>Worksheet_Change</code> subroutine that you are using."}], "owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517925976, "creation_date": 1500453817, "last_edit_date": 1531164843, "question_id": 45185339, "link": "https://stackoverflow.com/questions/45185339/excel-macro-to-run-automatically-for-change-in-cells-at-different-times-independ", "title": "Excel Macro to run automatically for change in cells at different times independent of each other", "body": "<p>I have a spreadsheet which will be used as a form by a number of users, and based on a few pull down boxes selection, a number of cells will change value (Independently of each other).</p>\n\n<p>I have several macros which I want to run when the cells change (again independently, not collectively)</p>\n\n<p>I already have one which runs using worksheet change by target value within the worksheet, but can't get anymore to work with this code.</p>\n\n<p>A bit of a novice when it comes to this sort of stuff and need some help - using latest version of excel.</p>\n"}, {"tags": ["string", "vba", "search", "ms-word", "find"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 1, "creation_date": 1500455459, "post_id": 45185417, "comment_id": 77339465, "body": "Thank you @Vityata This works great. Now what I have to do is to try insert it the right way in my code. Thank you again for your time. I was asking myself how the code would turn out if we could just find and highlight the words in the sentence even if there are separated by multiple words!? Do you think you can help with that?"}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 1, "creation_date": 1500456766, "post_id": 45185417, "comment_id": 77340399, "body": "Works great @Vityata You&#39;re awesome! Thank you for your time and your responsiveness :D. I will go on that."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1500456056, "last_edit_date": 1500456056, "creation_date": 1500454024, "answer_id": 45185417, "question_id": 45185159, "link": "https://stackoverflow.com/questions/45185159/find-matching-strings-in-text-even-string-seperated-by-one-word-using-vba-office/45185417#45185417", "title": "Find matching strings in text even string seperated by one word using vba office word", "body": "<p>The strings, separated by word are easy to be found - try to split the string and then count the units in the array. In general, assuming that you can achieve that easily and summarizing your problem to <strong>find a match when I have two words with a random word in between</strong> this would pretty much do what you need:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim strText         As String\n    Dim arrMatches      As Variant\n\n    Dim arrIn        As Variant\n    Dim myArr1          As Variant\n    Dim myArr2          As Variant\n    Dim lngC            As Long\n\n    arrMatches = Array(Array(\"lorem\", \"ipsum\"), Array(\"of\", \"the\"))\n\n    strText = \"lorem my ipsum is simply dummy text of fu the printing \" &amp; _\n                    \"and typesetting industry.\"\n\n    arrIn = Split(strText)\n\n    'we need to check always 2 less:\n    For lngC = LBound(arrIn) To UBound(arrIn) - 2\n        For Each myArr1 In arrMatches\n            If myArr1(0) = arrIn(lngC) And myArr1(1) = arrIn(lngC + 2) Then\n                Debug.Print arrIn(lngC) &amp; \" \" &amp; arrIn(lngC + 1) &amp; \" \" &amp; arrIn(lngC + 2)\n            End If\n        Next myArr1\n    Next lngC\n\nEnd Sub\n</code></pre>\n\n<p>It is probably difficult to understand what it does, thus change the <code>arrMatches</code> a few times and the <code>strText</code> as well. Then debug with <code>F8</code>. In this case it returns in the immediate window the following:</p>\n\n<pre><code>lorem my ipsum\nof fu the\n</code></pre>\n\n<p>This is because we have 2 arrMatches <code>Array(Array(\"lorem\", \"ipsum\"), Array(\"of\", \"the\"))</code> and the only strings in the text, where these matches are present with a word between them are the one above. </p>\n\n<p>Edit: If you want to make it working for more than 1 word in between, check it like this:</p>\n\n<pre><code>Option Explicit\nPublic Sub TestMe()\n\n    Dim strText         As String\n    Dim strPrint        As String\n    Dim arrMatches      As Variant\n    Dim arrInput        As Variant\n    Dim myArr1          As Variant\n    Dim myArr2          As Variant\n    Dim lngC            As Long\n    Dim lngC2           As Long\n    Dim lngC3           As Long\n\n    arrMatches = Array(Array(\"lorem\", \"ipsum\"), Array(\"of\", \"the\"))\n    strText = \"lorem my ipsum is simply dummy text of fu the printing \" &amp; _\n               \"ipsum and typesetting industry.\"\n\n    arrInput = Split(strText)\n    For lngC = LBound(arrInput) To UBound(arrInput)\n        For Each myArr1 In arrMatches\n            For lngC2 = lngC To UBound(arrInput)\n                If myArr1(0) = arrInput(lngC) And myArr1(1) = arrInput(lngC2) Then\n                    strPrint = \"\"\n                    For lngC3 = lngC To lngC2\n                        strPrint = strPrint &amp; \" \" &amp; arrInput(lngC3)\n                    Next lngC3\n                    Debug.Print strPrint\n                End If\n            Next lngC2\n        Next myArr1\n    Next lngC\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "is_accepted": false, "score": 0, "last_activity_date": 1500635880, "last_edit_date": 1500635880, "creation_date": 1500630566, "answer_id": 45234488, "question_id": 45185159, "link": "https://stackoverflow.com/questions/45185159/find-matching-strings-in-text-even-string-seperated-by-one-word-using-vba-office/45234488#45234488", "title": "Find matching strings in text even string seperated by one word using vba office word", "body": "<p>Here is the solution to the problem as I stated it. It is more specific and more scalable than the solution provided by <strong>@Vityata</strong> but which was helpfull as I get a bit of the logic from it.</p>\n\n<pre><code>Sub HighlightMatches()\n    Dim phraseRange As Object\n    Dim phraseIndex As Long\n    Dim i As Long\n    Dim wordsArray() As Variant\n    Dim splitedList As Variant\n    Dim keywords As String\nwordsArray = Array(\"Faux Texte\", \"Lorem Ipsum\")\nFor i = 0 To UBound(wordsArray)\n    Set phaseRange = ActiveDocument.Sentences\n    splitedList = Split(Trim(wordsArray(i)))\n    If UBound(splitedList) &gt; 0 Then\n        For phraseIndex = 1 To ActiveDocument.Sentences.Count\n            keywords = \"\"\n            Set phraseRange = ActiveDocument.Sentences(phraseIndex)\n            With phraseRange.Find\n                For t = 0 To UBound(splitedList)\n                    keywords = keywords + \"(\" &amp; splitedList(t) &amp; \")(*)\"\n                Next\n                'MsgBox keywords\n                .Text = keywords\n                .Format = True\n                .MatchWildcards = True\n                    If .Execute(Forward:=True) = True Then\n                        'MsgBox \"It Works\"\n                        phraseRange.HighlightColorIndex = wdYellow\n                    End If\n            End With\n        Next\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>That's all. I hope this will save time to others.</p>\n"}], "owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 45185417, "answer_count": 2, "score": 1, "last_activity_date": 1500635880, "creation_date": 1500453332, "last_edit_date": 1500454425, "question_id": 45185159, "link": "https://stackoverflow.com/questions/45185159/find-matching-strings-in-text-even-string-seperated-by-one-word-using-vba-office", "title": "Find matching strings in text even string seperated by one word using vba office word", "body": "<p>I need your help on this problem. I'm trying to write a VBA Macro in Office Word that will search for defined strings in the document text. That was straightforward for me to achieve.\n<strong>The particularity now is</strong> If in the text some strings are separated by a word, then make a match.</p>\n\n<p>Here is the basic code to find matching strings in the doc but I'm struggling to figure out how to make a match on one word separated strings.</p>\n\n<pre><code>Sub HighlightMatches()\n    Dim range As range\n    Dim i As Long\n    Dim wordsArray\n\nwordsArray = Array(\"Lion\", \"Hello\", \"Cat\", \"Lorem Ipsum\")\nFor i = 0 To UBound(wordsArray)\n    Set range = ActiveDocument.range\n\n    With range.Find\n    .Text = wordsArray(i)\n    .Format = True\n    .MatchCase = False\n        Do While .Execute(Forward:=True) = True\n            range.HighlightColorIndex = wdYellow\n        Loop\n    End With\n\nNext\nEnd Sub\n</code></pre>\n\n<p><strong>What I'm trying to achieve:</strong> If in the document text there is a sentence like \"Lorem is Ipsum and that's all\"; I would like the search to highlight \"Lorem is Ipsum\" even if \"lorem is Ipsum\" is not in the wordsArray.</p>\n\n<p>I will be thankfull if you guys can help me with this. Thanks in advance for your time.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1500453732, "post_id": 45185012, "comment_id": 77338246, "body": "What have you tried so far, can you post your attempts and why not suitable.  You can use <code>transferspreadsheet</code> to a new table, then use SQL to derive the subsets of data you require by using an <code>inner join</code> and a <code>left join</code>   Use SQL here, and built in functions, would be my advice.  Even skipping the import and using the Excel file in the SQL."}, {"owner": {"reputation": 15, "user_id": 8330197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211620896212921/picture?type=large", "display_name": "Terek Li", "link": "https://stackoverflow.com/users/8330197/terek-li"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1500454412, "post_id": 45185012, "comment_id": 77338754, "body": "Hi I have been trying to use &#39;loop up query&#39; and &#39;aggregate function&#39; to achieve my final goal, but so far it seems like query is not powerful enough for my need."}], "answers": [{"tags": [], "owner": {"reputation": 478, "user_id": 5866094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eaiuw.jpg?s=128&g=1", "display_name": "Bug", "link": "https://stackoverflow.com/users/5866094/bug"}, "is_accepted": true, "score": 1, "last_activity_date": 1500455589, "last_edit_date": 1500455589, "creation_date": 1500453822, "answer_id": 45185341, "question_id": 45185012, "link": "https://stackoverflow.com/questions/45185012/import-excel-file-into-access-table/45185341#45185341", "title": "import excel file into access table", "body": "<p>Access is far more structured than excel so doing searches and data validation is easier to accomplish. To import from excel with vba while validating each record the best method I have found is to do a blanket import into a temp access table and then loop through the temp table validating the data and adding it to the target table as required instead of trying to query the data while still in an excel spread sheet. Hope this helps</p>\n\n<pre><code>Dim SQL As String\nDim rs As Recordset\n\nSQL = \"SELECT field1,field2 FROM tempTable\"\n\nSet rs = CurrentDb.OpenRecordset(SQL)\nDo While Not rs.EOF\n\n    'YOUR VALIDATION CODE HERE\n\n\n    rs.MoveNext\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1500455918, "last_edit_date": 1500455918, "creation_date": 1500455397, "answer_id": 45185949, "question_id": 45185012, "link": "https://stackoverflow.com/questions/45185012/import-excel-file-into-access-table/45185949#45185949", "title": "import excel file into access table", "body": "<p>You can use <code>transferspreadsheet</code> to a new table, then use SQL to derive the subsets of data you require by using an inner join and a left join Use SQL here, and built in functions, would be my advice. Even skipping the import and using the Excel file in the SQL.</p>\n\n<p>Something like this, where new table is the import and db orders would be the existing table.  This handles the inserting.  Changing the join to an INNER JOIN and removing the WHERE clause will give you a sub-set to apply logic to of the existing records.</p>\n\n<p>I need to check the SQL fully with some dummy data, but this is a good start.  </p>\n\n<p>Use the DB to do these sort of jobs.</p>\n\n<p><code>INSERT INTO [tbl_DB_ORDERS] ([ORDER_NO]) \nSELECT NT.[ORDER_NO] FROM [NEW_TABLE] as NT LEFT JOIN [tbl_DB_ORDERS] AS ORD ON NT.[ORDER_NO]=ORD.[ORDER_NO] WHERE ORD.[ORDER_NO] IS NULL</code></p>\n"}], "owner": {"reputation": 15, "user_id": 8330197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211620896212921/picture?type=large", "display_name": "Terek Li", "link": "https://stackoverflow.com/users/8330197/terek-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 0, "accepted_answer_id": 45185341, "answer_count": 2, "score": 1, "last_activity_date": 1500455918, "creation_date": 1500452922, "last_edit_date": 1500454341, "question_id": 45185012, "link": "https://stackoverflow.com/questions/45185012/import-excel-file-into-access-table", "title": "import excel file into access table", "body": "<p>I am creating an Access database and some help with VBA would be much appreciated.</p>\n\n<p>Help is what I need to do,</p>\n\n<p>I have an Excel worksheet containing data that needs to be added to the existing table in Access. Is there a way in VBA to add the data in excel row by row?</p>\n\n<p>For every row in Excel I need to:</p>\n\n<p><strong>1st</strong>: check if the sample_number already exist in Access table, then do some action if it exist.</p>\n\n<p><strong>2nd</strong>: if the sample_number doesn't already exist then copy and paste this row from excel to Access table.</p>\n\n<p>Right now I am stuck on how to process the excel spreadsheet row by row rather than importing the whole sheet at once.</p>\n\n<p>Helps are much appreciated!\nThanks</p>\n"}, {"tags": ["excel", "vba", "worksheet"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1500452579, "creation_date": 1500452579, "answer_id": 45184891, "question_id": 45184756, "link": "https://stackoverflow.com/questions/45184756/vba-worksheet-change-is-not-working-properly/45184891#45184891", "title": "VBA Worksheet Change is not working properly?", "body": "<p>You can use <code>Worksheet_SelectionChange</code> instead.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"DistMatrix\")) Is Nothing Then\n        Dim out1() As Double\n        out1 = OutStat(bucket(Target), Range(\"RegScale\"))\n        FwdOut = outright(bucket(Target), Range(\"RegScale\"))\n        Call NewScatter(FwdOut, out1)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8235988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d467ca8e579d6fc7bb36671cc973f3f6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8235988/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 45184891, "answer_count": 1, "score": 0, "last_activity_date": 1500452579, "creation_date": 1500452268, "question_id": 45184756, "link": "https://stackoverflow.com/questions/45184756/vba-worksheet-change-is-not-working-properly", "title": "VBA Worksheet Change is not working properly?", "body": "<p>I wrote the following code in my worksheet and all ranges are in this same sheet.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"DistMatrix\")) Is Nothing Then\n    Dim out1() As Double\n    out1 = OutStat(bucket(Target), Range(\"RegScale\"))\n    FwdOut = outright(bucket(Target), Range(\"RegScale\"))\n    Call NewScatter(FwdOut, out1)\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I want to run a called sub if I choose a cell in the range DistMatrix.</p>\n\n<p>This is partly working. I have to click on a cell in the range as if I want to write in it and then afterwards pick another one for the called sub to run.</p>\n\n<p>I want however the sub to run as soon as I pick the cell. I don't want to go have to double click it as if it were to edit it and then pick another one for it to run.</p>\n"}]