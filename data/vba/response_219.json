[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1553121328, "post_id": 55271020, "comment_id": 97273495, "body": "Do you mean you want to loop through multiple sheets in the same workbook and apply the same logic?"}, {"owner": {"reputation": 1, "user_id": 11231220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d54d4a7f18ef1b8e6db2036c5c4631?s=128&d=identicon&r=PG&f=1", "display_name": "J.HarJ", "link": "https://stackoverflow.com/users/11231220/j-harj"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1553121703, "post_id": 55271020, "comment_id": 97273594, "body": "@BradDixon hey brad, no. The goal is to have a macro saved in an excel file. The user saves another file into a folder. This user will then open the excel file with the macro, run it. which will run a macro on the file in the folder."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1553121962, "post_id": 55271020, "comment_id": 97273677, "body": "ok, understood, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": false, "score": 0, "last_activity_date": 1553123782, "last_edit_date": 1553123782, "creation_date": 1553122804, "answer_id": 55271370, "question_id": 55271020, "link": "https://stackoverflow.com/questions/55271020/subscript-out-of-range-error-macro-that-runs-through-all-files-in-a-folder/55271370#55271370", "title": "subscript out of range error, macro that runs through all files in a folder", "body": "<p>See if this gets you going ...</p>\n\n<pre><code>Public Sub OpenOtherWorkbooksAndProcess()\n    Dim objDlg As FileDialog, strFolder As String, objFSO As Scripting.FileSystemObject\n    Dim objFolder As Scripting.Folder, objFile As Scripting.File, objBook As Workbook\n\n    Set objFSO = New Scripting.FileSystemObject\n    Set objDlg = Application.FileDialog(msoFileDialogFolderPicker)\n\n    objDlg.Show\n\n    If objDlg.SelectedItems.Count &gt; 0 Then\n        strFolder = objDlg.SelectedItems(1)\n\n        Set objFolder = objFSO.GetFolder(strFolder)\n\n        Application.ScreenUpdating = False\n\n        For Each objFile In objFolder.Files\n            ' You may want to change this to check for the type of files.\n            ' The assumption is that all files within the selected folder are excel files.\n            Set objBook = Excel.Workbooks.Open(objFile.Path)\n\n            ' --------------------------------------------------------------------------\n            ' ADD YOU LOGIC USING objBook AS YOUR SOURCE WORKBOOK\n            ' --------------------------------------------------------------------------                \n\n            objBook.Save\n            objBook.Close\n        Next\n\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>... does that help?</p>\n\n<p>It may need tweaks to cater for your exact scenario but it's the baseline for doing what (I think) you want.</p>\n\n<p>You will need to add a reference to the library as shown below ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/yHEGf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yHEGf.jpg\" alt=\"Microsoft Scripting Runtime\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11231220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d54d4a7f18ef1b8e6db2036c5c4631?s=128&d=identicon&r=PG&f=1", "display_name": "J.HarJ", "link": "https://stackoverflow.com/users/11231220/j-harj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553134542, "creation_date": 1553120460, "last_edit_date": 1553134542, "question_id": 55271020, "link": "https://stackoverflow.com/questions/55271020/subscript-out-of-range-error-macro-that-runs-through-all-files-in-a-folder", "title": "subscript out of range error, macro that runs through all files in a folder", "body": "<p>Can I please receive an assistance in rewriting the code attached below so that I can avoid using the <strong>ws As Worksheet ws = ThisWorkbook.Sheets(\"newreport\") 'change the name of the sheet to the one you are doing the code</strong></p>\n\n<pre><code>Dim arrData As Variant, LastRow As Long, i As Long, ws As Worksheet\n\n    Set ws = ThisWorkbook.Sheets(\"newreport\") 'change the name of the sheet to the one you are doing the code\n\n    With ws\n        LastRow = .Cells(.Rows.Count, 3).End(xlUp).Row\n        arrData = .Range(\"A2\", .Cells(LastRow, \"C\")).Value\n        For i = 1 To UBound(arrData)\n            If arrData(i, 3) Like \"Bus*\" Then\n                arrData(i, 1) = \"XX XXX\"\n            Else\n                arrData(i, 1) = \"XXX XX\"\n            End If\n            If arrData(i, 3) Like \"CSI*\" Or arrData(i, 3) = vbNullString Then\n                arrData(i, 2) = vbNullString\n            Else\n                arrData(i, 2) = Right(arrData(i, 3), Len(arrData(i, 3)) - 12)\n            End If\n        Next i\n        .Range(\"A2\", .Cells(LastRow, \"C\")).Value = arrData\n    End With\n\n  For Each cell In Range(\"B2\", Range(\"B605536\").End(xlUp))\nIf Not IsEmpty(cell) Then\ncell.Value = Right(cell, Len(cell) - 2)\nEnd If\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "vba", "compiler-errors", "conditional-statements"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "edited": false, "score": 1, "creation_date": 1553119787, "post_id": 55270886, "comment_id": 97272998, "body": "Remove <code>End If</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1553119788, "post_id": 55270886, "comment_id": 97272999, "body": "remove the <code>End If</code>"}, {"owner": {"reputation": 25, "user_id": 11234611, "user_type": "registered", "profile_image": "https://graph.facebook.com/2410001339012814/picture?type=large", "display_name": "Daniel Armand Velazquez", "link": "https://stackoverflow.com/users/11234611/daniel-armand-velazquez"}, "edited": false, "score": 0, "creation_date": 1553119917, "post_id": 55270886, "comment_id": 97273044, "body": "Thank you, i tried it it does not give error anymore but still won&#39;t delete rows containing .jpg,.JPG,.gif."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553120015, "post_id": 55270886, "comment_id": 97273079, "body": "Step through your code with <code>F8</code>, and make sure that Column F&#39;s cells do have that value.  Also, FYI, you can just do <code>Cells(r, &quot;F&quot;)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1553120137, "post_id": 55270886, "comment_id": 97273117, "body": "Select case does not allow the use of wildcard matching."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1553120811, "last_edit_date": 1553120811, "creation_date": 1553120179, "answer_id": 55270966, "question_id": 55270886, "link": "https://stackoverflow.com/questions/55270886/multiple-conditions-in-an-if-statement-in-excel-vba-end-if-without-block-if/55270966#55270966", "title": "Multiple conditions in an IF statement in Excel VBA &quot;end if without block if&quot;&quot;", "body": "<p>To use a wildcard with <code>Select Case</code>, you can use <code>Like</code>:</p>\n\n<pre><code>Sub clean() \nDim r As Long, endRow As Long, pasteRowIndex As Long\n\n' I assume your column F has the most data\nendRow = Cells(Rows.Count, \"F\").End(xlUp).Row \n\nFor r = endRow To 1 Step -1  \n  Select Case True\n        Case Cells(r, \"F\").Value Like \"*.jpg*\" or Cells(r, \"F\").Value Like \"*.JPG*\" or Cells(r, \"F\").Value Like \"*.gif*\"\n            Rows(r).Delete\n        Case Else\n            ' Do nothing...\n    End Select\n Next r\nEnd Sub\n</code></pre>\n\n<p>Edit: There's likely a better way, by putting the values you want to find in an Array, then search the array, but the above should work with the current method.</p>\n"}], "owner": {"reputation": 25, "user_id": 11234611, "user_type": "registered", "profile_image": "https://graph.facebook.com/2410001339012814/picture?type=large", "display_name": "Daniel Armand Velazquez", "link": "https://stackoverflow.com/users/11234611/daniel-armand-velazquez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 55270966, "answer_count": 1, "score": 0, "last_activity_date": 1553134567, "creation_date": 1553119719, "last_edit_date": 1553134567, "question_id": 55270886, "link": "https://stackoverflow.com/questions/55270886/multiple-conditions-in-an-if-statement-in-excel-vba-end-if-without-block-if", "title": "Multiple conditions in an IF statement in Excel VBA &quot;end if without block if&quot;&quot;", "body": "<p>im total beginner in VBA, i'm working on cleaning web logs from unnecessary data (rows containing .jpg, .gif, ...) I've found code which does exactly what i need to do, but i get ERROR \"compile error: end if without block if\"</p>\n\n<pre><code>Sub clean() \nDim r As Long, endRow As Long, pasteRowIndex As Long\n\nendRow = 321085 \n\nFor r = endRow To 1 Step -1  \n  Select Case Cells(r, Columns(\"F\").Column).Value\n        Case \"*.jpg*\", \"*.JPG*\", \"*.gif*\"\n            Rows(r).Delete\n        Case Else\n            ' Do nothing...\n\n    End Select\n\n    End If\n Next r\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553117154, "post_id": 55270411, "comment_id": 97272038, "body": "Can you show a sample sheet of what you are trying to do?"}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553117399, "post_id": 55270411, "comment_id": 97272130, "body": "@urdearboy, updated!"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553117442, "post_id": 55270411, "comment_id": 97272155, "body": "Where are you assigning the <code>preCol</code> variable?"}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553117509, "post_id": 55270411, "comment_id": 97272175, "body": "@GMalc, far above this snippet. preCol works fine for the other eight sheets this macro is updating. I will toss it in too."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553117597, "post_id": 55270411, "comment_id": 97272227, "body": "So you just need help having the 10 Week Total column calculate the previous 10 columns every time you run the macro?"}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553117686, "post_id": 55270411, "comment_id": 97272265, "body": "@urdearboy, exactly."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1553117887, "post_id": 55270411, "comment_id": 97272353, "body": "This can be done with a formula.  The formula can allow the adding of columns and still only look at the last 10 columns before it."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1553118056, "post_id": 55270411, "comment_id": 97272416, "body": "@ScottCraner, how? I am trying it and the formula references stay in the same position while the column moves."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1553118264, "post_id": 55270411, "comment_id": 97272481, "body": "<code>=SUM(INDEX(8:8,COLUMN()-1):INDEX(8:8,COLUMN()-10))</code>  Since there are no column references it will always look at the last 10 columns in row 8.  The <code>8:8</code> will change to the next row as it is dragged down."}, {"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1553118397, "post_id": 55270411, "comment_id": 97272527, "body": "@ScottCraner, that is beautiful! I really appreciate the help! If you want to make it an answer, I will mark it as accepted."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1553118997, "last_edit_date": 1553118997, "creation_date": 1553118374, "answer_id": 55270668, "question_id": 55270411, "link": "https://stackoverflow.com/questions/55270411/how-do-i-sum-a-variable-range/55270668#55270668", "title": "How do I sum a variable range?", "body": "<p>This seems to be working for me</p>\n\n<pre><code>Option Explicit\n\nSub Dynamic_Duo()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\nDim LC As Long, LR As Long, SumRange As String\n\nLC = ws.Cells(6, ws.Columns.Count).End(xlToLeft).Offset.Column\nLR = ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Offset(-2).Row\n\nws.Cells(6, LC + 1) = \"10 Week\"\nws.Cells(7, LC + 1) = \"Total\"\n    SumRange = ws.Range(ws.Cells(8, LC - 9), ws.Cells(8, LC)).Address(False, False)\n    ws.Range(ws.Cells(8, LC + 1), ws.Cells(LR, LC + 1)).Formula = \"=Sum(\" &amp; SumRange &amp; \")\"\n\nMsgBox \"@Scott Craner's solution is better\", vbCritical\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "edited": false, "score": 0, "creation_date": 1553120010, "post_id": 55270698, "comment_id": 97273077, "body": "I cannot believe I am just now learning about <code>index</code>. This opens up a whole new world."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1553118547, "creation_date": 1553118547, "answer_id": 55270698, "question_id": 55270411, "link": "https://stackoverflow.com/questions/55270411/how-do-i-sum-a-variable-range/55270698#55270698", "title": "How do I sum a variable range?", "body": "<p>Put this in Row 8 and copy down:</p>\n\n<pre><code>=SUM(INDEX(8:8,COLUMN()-1):INDEX(8:8,COLUMN()-10))\n</code></pre>\n\n<p>Since there are no column references it will always look at the last 10 columns in row 8. The 8:8 will change to the next row as it is dragged down.</p>\n"}], "owner": {"reputation": 170, "user_id": 9473732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CneyD.jpg?s=128&g=1", "display_name": "CATSandCATSandCATS", "link": "https://stackoverflow.com/users/9473732/catsandcatsandcats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55270698, "answer_count": 2, "score": 0, "last_activity_date": 1553134595, "creation_date": 1553117000, "last_edit_date": 1553134595, "question_id": 55270411, "link": "https://stackoverflow.com/questions/55270411/how-do-i-sum-a-variable-range", "title": "How do I sum a variable range?", "body": "<p>I have a macro which imports weekly data into a new column and then runs a number of operations on it. I am having great difficulty with trying to sum the past ten weeks' data. Obviously formulae do not work since every week when I insert a new column, the formulae would not move to include the new column and drop the eleventh column.</p>\n\n<p>The code I wrote to take this is:</p>\n\n<pre><code>        Dim h As Range\n        Dim preCol As Long\n            With wsBOS.Rows(7)\n            Set h = .Find(\"Total\", LookIn:=xlValues)\n                If Not h Is Nothing Then\n                    preCol = h.Column - 1\n                End If\n            End With\n\n        For jCombo = 1 To 175\n        Dim siteCombo As String\n        siteCombo = ThisWorkbook.Sheets(\"Results Sheet\").Cells(jCombo, 3)\n            If ((siteCombo = \"Bone &amp; Connective Tissue\") Or (siteCombo = \"Brain/CNS\") Or (siteCombo = \"Breast\") Or (siteCombo = \"GI\") Or (siteCombo = \"Gland/Lymphatic\") Or (siteCombo = \"GYN\") _\n                Or (siteCombo = \"Head &amp; Neck\") Or (siteCombo = \"Leukemia Lymphoma\") Or (siteCombo = \"Lung\") Or (siteCombo = \"Gu\") Or (siteCombo = \"GU\") Or (siteCombo = \"Male\") _\n                Or (siteCombo = \"Metastasis Genital Organ\") Or (siteCombo = \"Other\") Or (siteCombo = \"Skin\")) Then\n                        ThisWorkbook.Sheets(\"Results Sheet\").Cells(jCombo, preCol - 2).Value = Application.Sum(Range(Cells(jCombo, preCol - 11), (Cells(jCombo, preCol - 3))))\n            End If\n        Next jCombo\n</code></pre>\n\n<p>where jCombo increments rows downwards and preCol refers to the newly created column. </p>\n\n<p>For whatever reason, this snippet is simply doing nothing when run. It does not throw any errors, it just leaves all 175 rows of preCol untouched. I am stumped and am turning to you for help.</p>\n\n<p>If anyone has any ideas and wants to share them, I will be beyond appreciative. Thank you!!</p>\n\n<p><a href=\"https://i.stack.imgur.com/r3H5T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r3H5T.png\" alt=\"Sample of Results Sheet\"></a></p>\n\n<p>preCol refers to Column OL.</p>\n\n<p>I am trying to get the value to populate in column OJ.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1553117406, "post_id": 55270408, "comment_id": 97272135, "body": "Application.OnTime ... that might help you."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 1, "creation_date": 1553117408, "post_id": 55270408, "comment_id": 97272136, "body": "Could you post your code and tell us if its in a standard module or in the <code>Worksheet_Change</code> event please."}, {"owner": {"reputation": 131, "user_id": 7570275, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/726799117854bd28ea3cc4408f679a27?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/7570275/martin"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553117884, "post_id": 55270408, "comment_id": 97272352, "body": "@ZackE I think it&#39;s a standard module, how do I add it to this event you speak of?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553118538, "post_id": 55270408, "comment_id": 97272585, "body": "In order for the function to work you will need to refer to the function in the Worksheet Object when a cell or range of cell changes that way the function runs every time the cell color changes.  The Worksheet Objects are located in VBA under the Microsoft Excel Objects (There will be a list of Sheet1, Sheet2 etc etc."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 7570275, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/726799117854bd28ea3cc4408f679a27?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/7570275/martin"}, "edited": false, "score": 0, "creation_date": 1553151970, "post_id": 55275112, "comment_id": 97280809, "body": "Already tried this. It makes the cell be recalculated whenever any other cell on the sheet is calculated. This does not include things like changing the background color of a cell."}], "tags": [], "owner": {"reputation": 773, "user_id": 11158132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836d70ae291879b732a8bc21190f10a9?s=128&d=identicon&r=PG&f=1", "display_name": "JLCH", "link": "https://stackoverflow.com/users/11158132/jlch"}, "is_accepted": false, "score": -1, "last_activity_date": 1553150864, "creation_date": 1553150864, "answer_id": 55275112, "question_id": 55270408, "link": "https://stackoverflow.com/questions/55270408/how-can-i-calculate-sheet-automatically-when-changing-color-of-cell-or-at-a-cert/55275112#55275112", "title": "How can I calculate sheet automatically when changing color of cell or at a certain interval?", "body": "<p>I have a similar function in one of my files, worked with</p>\n\n<pre><code> Application.Volatile \n</code></pre>\n\n<p>Below your Dim definition. \nSlows down the file, but if it's not too big, it does the trick.</p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 7570275, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/726799117854bd28ea3cc4408f679a27?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/7570275/martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1553165348, "last_edit_date": 1553165348, "creation_date": 1553163016, "answer_id": 55278021, "question_id": 55270408, "link": "https://stackoverflow.com/questions/55270408/how-can-i-calculate-sheet-automatically-when-changing-color-of-cell-or-at-a-cert/55278021#55278021", "title": "How can I calculate sheet automatically when changing color of cell or at a certain interval?", "body": "<p>There are two ways to solve this. </p>\n\n<p>The first way is to simply recalculate the entire sheet automatically at an interval: <a href=\"https://www.mrexcel.com/forum/excel-questions/505713-calculating-sheet-every-2-minutes.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/505713-calculating-sheet-every-2-minutes.html</a></p>\n\n<p>The second way is to use <code>Worksheet_SelectionChange</code> and if any of the dependents of the previous selection uses the <code>SumByColor</code> function then calculate them. You could also just call <code>Application.CalculateFull</code>, but this is expensive and could be annoying if you navigate the spreadsheet with the arrow keys.</p>\n\n<pre><code>Public PreviousActiveCell As Range\nPublic Locked As Boolean\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Locked Then\n        Exit Sub\n    End If\n    If Not PreviousActiveCell Is Nothing Then\n        'If PreviousActiveCell has no dependents this will raise an error.\n        'There is no way to check if PreviousActiveCell has dependents without triggering the error.\n        On Error GoTo SetPrevious\n        'DirectDependents will call this function, avoid endless recursion\n        Locked = True\n        For Each dependent In PreviousActiveCell.DirectDependents\n            If InStr(dependent.Formula, \"SumByColor\") Then\n                dependent.Dirty\n            End If\n        Next dependent\n    End If\nSetPrevious:\n    Locked = False\n    Set PreviousActiveCell = Target\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 7570275, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/726799117854bd28ea3cc4408f679a27?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/7570275/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 55278021, "answer_count": 2, "score": 0, "last_activity_date": 1553165348, "creation_date": 1553116992, "last_edit_date": 1553152458, "question_id": 55270408, "link": "https://stackoverflow.com/questions/55270408/how-can-i-calculate-sheet-automatically-when-changing-color-of-cell-or-at-a-cert", "title": "How can I calculate sheet automatically when changing color of cell or at a certain interval?", "body": "<p>I followed this guide: <a href=\"https://www.exceltrick.com/how_to/sum-cells-based-on-background-color/\" rel=\"nofollow noreferrer\">https://www.exceltrick.com/how_to/sum-cells-based-on-background-color/</a>?</p>\n\n<p>It works, but when I change the color of a cell the formulas are not calculated automatically. This is because Excel only calculates when changing a value in a cell or when manually prompted to do so.</p>\n\n<p>So is there a way to calculate sheet automatically when changing color of cell or calculate it at a certain interval?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p><code>Application.Volatile</code> only makes the function be called when any cell is recalculated.</p>\n\n<p><code>Worksheet_Change</code> event is only called when any cell is recalculated.</p>\n\n<p>Code:</p>\n\n<pre><code>Function SumByColor(CellColor As Range, rRange As Range)\nDim cSum As Long\nDim ColIndex As Integer\nColIndex = CellColor.Interior.ColorIndex\nFor Each cl In rRange\n  If cl.Interior.ColorIndex = ColIndex Then\n    cSum = WorksheetFunction.Sum(cl, cSum)\n  End If\nNext cl\nSumByColor = cSum\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1553117420, "post_id": 55270280, "comment_id": 97272145, "body": "What do you mean by &quot;<i>this is the code that does not work</i>&quot;? Do you get an error? What&#39;s the error?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1553119404, "post_id": 55270280, "comment_id": 97272859, "body": "Your understanding is correct, there is no reason why your first code should not work but the second would. I would investigate on the usage of <code>InStr()</code> - your second condition: this function returns a number indicating the position of the searched substring inside the string, but you&#39;re using it as if it would return a boolean. Are you missing a <code>InStr() &gt; 0</code> instead?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1553120176, "post_id": 55270280, "comment_id": 97273127, "body": "I concur with Matteo, ` Instr` is used incorrectly in the first code snippet."}, {"owner": {"reputation": 1, "user_id": 11234426, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-u7W4Ldggblw/AAAAAAAAAAI/AAAAAAAAARs/G9-upL1k7w0/photo.jpg?sz=128", "display_name": "i.m", "link": "https://stackoverflow.com/users/11234426/i-m"}, "edited": false, "score": 0, "creation_date": 1553179300, "post_id": 55270280, "comment_id": 97295767, "body": "Instr is used correctly and in the same way in both code snippets."}], "owner": {"reputation": 1, "user_id": 11234426, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-u7W4Ldggblw/AAAAAAAAAAI/AAAAAAAAARs/G9-upL1k7w0/photo.jpg?sz=128", "display_name": "i.m", "link": "https://stackoverflow.com/users/11234426/i-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553157496, "creation_date": 1553116388, "last_edit_date": 1553120098, "question_id": 55270280, "link": "https://stackoverflow.com/questions/55270280/how-to-use-multiple-conditions-in-vba", "title": "How to use multiple conditions in VBA", "body": "<p>In the following code I am trying to look for a text box in an open word document. Once that text box has been found I would also like to check to make sure the correct text is inside. This is the code that does not work and I could not figure out why.</p>\n\n<pre><code>Dim i as Integer\n\nfor i = 1 to Application.ActiveDocument.Shapes.Count\n    if Application.ActiveDocument.Shapes(i).Name = \"Text Box 2\" and _\n    instr(Application.ActiveDocument.Shapes(i).TextFrame.TextRange.Text, \"[Grab your reader\") then\n            ` Execute\n    end if\nnext i\n</code></pre>\n\n<p>Now if I replace the <em>and</em> with another <em>if</em> statement it works.</p>\n\n<pre><code>Dim i as Integer\n\nfor i = 1 to Application.ActiveDocument.Shapes.Count\n    if Application.ActiveDocument.Shapes(i).Name = \"Text Box 2\" then\n        if instr(Application.ActiveDocument.Shapes(i).TextFrame.TextRange.Text, \"[Grab your reader\") then\n            ` Execute\n        end if\n    end if\nnext i\n</code></pre>\n\n<p>From what I understand the <em>and</em> should work exactly the same as adding a new if statement. If anyone could tell me why this happens that would be great. </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553116783, "post_id": 55269937, "comment_id": 97271895, "body": "Are you extracting Windows Compression zip folders? Don&#39;t really need a 3rd party tool for that."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553117409, "post_id": 55269937, "comment_id": 97272138, "body": "A bunch of my users (contractor in India) do not have the built-in Windows ZIP function available - for whatever reason."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553117806, "post_id": 55269937, "comment_id": 97272322, "body": "The Windows Compression tool is probably there somewhere. Happened to me once, lost it and had to somehow restore it. Just don&#39;t remember what I had to do. On another occasion I had WinZip (long time ago when it was free) and that somehow overrode WindowsCompression. I removed WinZip and WC became available. Sorry, since I am not interested in downloading tool, can&#39;t test and no idea why your code fails."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553118200, "post_id": 55269937, "comment_id": 97272460, "body": "June7, frustrations of 3rd party vendor.  Been thru this discussion with them, thus the use of the external utility.  My AccessDB detects if installed and grabs from FTP if missing from any user machines at time of use - no install, no registry concerns.  Been a good approach for nearly 8 years,  Just not sure what is up this week."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553122570, "post_id": 55269937, "comment_id": 97273844, "body": "I am suspecting my issue is with the PATHS used to locate the UNZIP utility, the ZIP file and then wherever the resulting csv will land.   I can use ANY BOGUS value for these paths and I do not see a complaint."}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1553163526, "post_id": 55271753, "comment_id": 97286186, "body": "For a solution without 3rd party utilities, check of my <a href=\"https://github.com/GustavBrock/VBA.Compress\" rel=\"nofollow noreferrer\">Compression and decompression methods for VBA</a>"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1553167752, "post_id": 55271753, "comment_id": 97288611, "body": "Gustav, very interesting.  I will wade thru to see what might be workable for me.  Are there an identifiable subset of functions I can reduce to narrowly support ZIP and UNZIP only?   I&#39;ve let my ExpertsExchange sub lapse."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1553169539, "post_id": 55271753, "comment_id": 97289590, "body": "Indeed: <i>Zip</i> and (surprise) <i>UnZip</i>."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1553172522, "post_id": 55271753, "comment_id": 97291279, "body": "Gustav, I have a couple questions. Can we take them offline via StackOverflow?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1553178473, "post_id": 55271753, "comment_id": 97295207, "body": "Sure. You could post them on <a href=\"https://github.com/GustavBrock/VBA.Compress/issues\" rel=\"nofollow noreferrer\">GitHub</a> or leave comments to the linked article at <a href=\"https://www.experts-exchange.com/articles/31130/Zip-and-unzip-files-and-folders-with-VBA-the-Windows-Explorer-way.html\" rel=\"nofollow noreferrer\">Experts Exchange</a>."}], "tags": [], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "is_accepted": true, "score": 0, "last_activity_date": 1553125519, "creation_date": 1553125519, "answer_id": 55271753, "question_id": 55269937, "link": "https://stackoverflow.com/questions/55269937/msaccess-vba-shell-unzip/55271753#55271753", "title": "MSAccess VBA Shell: UNZIP", "body": "<p>The following works.  My original fShellRun was customized for other purposes long ago and not compatible with this task.</p>\n\n<p>The following is very simple and functional, runs silently:</p>\n\n<pre><code>Private Sub UnzipTest_Click()\n\nDim oShell\nDim strFile As String\nDim strPath As String\nDim strPathUtil As String\n\nSet oShell = CreateObject(\"WScript.shell\")\n\nstrFile = Me!txtFilename\nstrPath = CurrentProject.Path &amp; \"\\Backend_Databases\\\"\nstrPathUtil = CurrentProject.Path &amp; \"\\Backend_Databases\\DB_Utilities\\\"\n\nstrCMD = strPathUtil &amp; \"UNZIP.exe -o \" &amp; strPath &amp; strFile &amp; \" -d \" &amp; strPath\n\noShell.Run strCMD, 0, True\n\nSet oShell = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Note:  This points to a 3rd party UNZIP utility, vs the std Windows ZIP utility.  The UNZIP.exe is kept in my \"...\\DB_Utilities\" folder. \n <a href=\"http://infozip.sourceforge.net/\" rel=\"nofollow noreferrer\">http://infozip.sourceforge.net/</a></p>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55271753, "answer_count": 1, "score": 0, "last_activity_date": 1553125519, "creation_date": 1553114911, "last_edit_date": 1553115977, "question_id": 55269937, "link": "https://stackoverflow.com/questions/55269937/msaccess-vba-shell-unzip", "title": "MSAccess VBA Shell: UNZIP", "body": "<p>I am using a simple ZIP/UNZIP utility (<a href=\"http://infozip.sourceforge.net/\" rel=\"nofollow noreferrer\">http://infozip.sourceforge.net/</a>) called from a WScript.Shell.</p>\n\n<pre><code>strPath = CurrentProject.Path &amp; \"\\Backend_Databases\\\"\nstrPathUtil = CurrentProject.Path &amp; \"\\Backend_Databases\\DB_Utilities\\\"\n\nChDir strPath\nstrCMD = strPathUtil &amp; \"UNZIP.exe -o Item_4892.zip\"\nfShellRun (strCMD)\n</code></pre>\n\n<p>I get NO result &amp; no complaint with this approach.  The resulting strCMD looks like this:</p>\n\n<pre><code>C:\\Users\\Mark\\Desktop\\Backend_Databases\\DB_Utilities\\UNZIP.exe -o Item_4892.zip\n</code></pre>\n\n<p>This line works from a Command Window exactly as expected.  fShellRun works as expected for other Shell Commands in use in my AccessDB.</p>\n\n<p>Note:  I could swear this was working like last week during initial testing, but I just cannot seem to figure this out now; it is making me completely batty!  Maybe I am just too close to this and I am missing something obvious.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1553230999, "post_id": 55269881, "comment_id": 97314946, "body": "Expect feedback on posted answer."}], "answers": [{"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1553137477, "creation_date": 1553137477, "answer_id": 55273164, "question_id": 55269881, "link": "https://stackoverflow.com/questions/55269881/how-do-i-copy-my-outlook-emails-within-a-specific-time-period-to-excel/55273164#55273164", "title": "How do I copy my outlook emails (within a specific time period) to excel?", "body": "<p>Try This. Added 2 date variables <code>date1</code> and <code>date2</code>. Adjust these as per your requirements.</p>\n\n<pre><code>Option Explicit\n\nSub GetMail()\n\nDim OLApp As Object\nDim olFolder As Object\nDim olMailItem As Object\nDim date1 As Date\nDim date2 As Date\nDim strTo As String\nDim strFrom As String\nDim dateSent As Variant\nDim dateReceived As Variant\nDim strSubject As String\nDim strBody As String\n\nDim loopControl As Variant\nDim mailCount As Long\nDim totalItems As Long\n '-------------------------------------------------------------\ndate2 = Now()\ndate1 = Now() - 3\nApplication.ScreenUpdating = False\nRange(\"A1:F1\").Value = Array(\"To\", \"From\", \"Subject\", \"Body\", \"Sent (from Sender)\", \"Received (by Recipient)\")\n\nColumns(\"E:F\").EntireColumn.NumberFormat = \"DD/MM/YYYY HH:MM:SS\"\nSet OLApp = CreateObject(\"Outlook.Application\")\nSet olFolder = OLApp.GetNamespace(\"MAPI\").PickFolder\ntotalItems = olFolder.Items.Count\nmailCount = 0\n\nFor Each loopControl In olFolder.Items\n     '//If loopControl is a mail item then continue\n    If TypeName(loopControl) = \"MailItem\" Then\n\n        mailCount = mailCount + 1\n\n        Application.StatusBar = \"Reading email no. \" &amp; mailCount &amp; \" of \" &amp; totalItems\n\n        Set olMailItem = loopControl\n\n        With olMailItem\n            strTo = .To\n\n            If Left(strTo, 1) = \"=\" Then strTo = \"'\" &amp; strTo\n            strFrom = .Sender\n            If InStr(1, strFrom, \"@\") &lt; 1 Then strFrom = strFrom &amp; \" - &lt; \" &amp; .SenderEmailAddress &amp; \" &gt;\"\n            dateSent = .body\n            dateReceived = .ReceivedTime\n            strSubject = .Subject\n        End With\n\n       If dateReceived &lt;= date2 And dateReceived &gt;= date1 Then\n        With Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n            .Value = strTo\n            .Offset(0, 1).Value = strFrom\n            .Offset(0, 2).Value = strSubject\n\n            If InStr(0, strBody, \"From:\") &gt; 0 Then\n                 '//If exists, copy start of email body, up to the position of \"From:\"\n                .Offset(0, 3).Value = Mid(strBody, 1, InStr(1, strBody, \"From:\") - 1)\n            Else\n                .Offset(0, 3).Value = strBody\n            End If\n\n            .Offset(0, 4).Value = dateSent\n            .Offset(0, 5).Value = dateReceived\n\n        End With\n        End If\n        Set olMailItem = Nothing\n\n    End If\nNext loopControl\n\nSet olFolder = Nothing\nSet OLApp = Nothing\nApplication.ScreenUpdating = True\nApplication.StatusBar = False\nMsgBox mailCount &amp; \" messages copied successfully.\", vbInformation, \"Complete\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11234292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59aa5a05444038c0f00c4a7603108f4?s=128&d=identicon&r=PG&f=1", "display_name": "Arualcw", "link": "https://stackoverflow.com/users/11234292/arualcw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553137477, "creation_date": 1553114713, "question_id": 55269881, "link": "https://stackoverflow.com/questions/55269881/how-do-i-copy-my-outlook-emails-within-a-specific-time-period-to-excel", "title": "How do I copy my outlook emails (within a specific time period) to excel?", "body": "<p>New to VBA, attempting to list my outlook emails in excel given a specific time period. Found code to list my emails, but can't figure out how to restrict it to a time period, any ideas?</p>\n\n<pre><code>Sub GetMail()\n\nDim OLApp As Object\nDim olFolder As Object\nDim olMailItem As Object\n\nDim strTo As String\nDim strFrom As String\nDim dateSent As Variant\nDim dateReceived As Variant\nDim strSubject As String\nDim strBody As String\n\nDim loopControl As Variant\nDim mailCount As Long\nDim totalItems As Long\n '-------------------------------------------------------------\nApplication.ScreenUpdating = False\nRange(\"A1:F1\").Value = Array(\"To\", \"From\", \"Subject\", \"Body\", \"Sent (from Sender)\", \"Received (by Recipient)\")\n\nColumns(\"E:F\").EntireColumn.NumberFormat = \"DD/MM/YYYY HH:MM:SS\"\nSet OLApp = CreateObject(\"Outlook.Application\")\nSet olFolder = OLApp.GetNamespace(\"MAPI\").PickFolder\ntotalItems = olFolder.items.Count\nmailCount = 0\n\nFor Each loopControl In olFolder.items\n     '//If loopControl is a mail item then continue\n    If TypeName(loopControl) = \"MailItem\" Then\n\n        mailCount = mailCount + 1\n\n        Application.StatusBar = \"Reading email no. \" &amp; mailCount &amp; \" of \" &amp; totalItems\n\n        Set olMailItem = loopControl\n\n        With olMailItem\n            strTo = .To\n\n            If Left(strTo, 1) = \"=\" Then strTo = \"'\" &amp; strTo\n            strFrom = .Sender\n            If InStr(1, strFrom, \"@\") &lt; 1 Then strFrom = strFrom &amp; \" - &lt; \" &amp; .SenderEmailAddress &amp; \" &gt;\"\n            dateSent = .Body\n            dateReceived = .ReceivedTime\n            strSubject = .Subject\n        End With\n\n        With Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n            .Value = strTo\n            .Offset(0, 1).Value = strFrom\n            .Offset(0, 2).Value = strSubject\n\n            If InStr(0, strBody, \"From:\") &gt; 0 Then\n                 '//If exists, copy start of email body, up to the position of \"From:\"\n                .Offset(0, 3).Value = Mid(strBody, 1, InStr(1, strBody, \"From:\") - 1)\n            Else\n                .Offset(0, 3).Value = strBody\n            End If\n\n            .Offset(0, 4).Value = dateSent\n            .Offset(0, 5).Value = dateReceived\n\n        End With\n\n        Set olMailItem = Nothing\n\n    End If\nNext loopControl\n\nSet olFolder = Nothing\nSet OLApp = Nothing\nApplication.ScreenUpdating = True\nApplication.StatusBar = False\nMsgBox mailCount &amp; \" messages copied successfully.\", vbInformation, \"Complete\"\n\nEnd Sub\n</code></pre>\n\n<p>New to VBA, attempting to list my outlook emails in excel given a specific time period. Found code to list my emails, but can't figure out how to restrict it to a time period, any ideas?</p>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1553114796, "post_id": 55269858, "comment_id": 97270946, "body": "Are you talking about the <code>Set ws</code> line? That&#39;s saying there is no worksheet named &quot;newreport&quot; in the active workbook. I&#39;d recommend changing that to <code>Set ws = wb.Sheets(&quot;newreport&quot;)</code> at the very least, since you&#39;re looping through workbooks and <code>wb</code> is your iterator..."}, {"owner": {"reputation": 1, "user_id": 11231220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d54d4a7f18ef1b8e6db2036c5c4631?s=128&d=identicon&r=PG&f=1", "display_name": "J.HarJ", "link": "https://stackoverflow.com/users/11231220/j-harj"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1553118923, "post_id": 55269858, "comment_id": 97272690, "body": "@dwirony Hey, yes I am. I&#39;m sorry I do not follow.  So I tested my code directly on the file. Then I tried it via the other code."}, {"owner": {"reputation": 1, "user_id": 11231220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d54d4a7f18ef1b8e6db2036c5c4631?s=128&d=identicon&r=PG&f=1", "display_name": "J.HarJ", "link": "https://stackoverflow.com/users/11231220/j-harj"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1553119188, "post_id": 55269858, "comment_id": 97272779, "body": "@dwirony please see the new edit. It&#39;s the last code."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1553119745, "post_id": 55269858, "comment_id": 97272980, "body": "And what is the problem with your new code now?"}], "owner": {"reputation": 1, "user_id": 11231220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d54d4a7f18ef1b8e6db2036c5c4631?s=128&d=identicon&r=PG&f=1", "display_name": "J.HarJ", "link": "https://stackoverflow.com/users/11231220/j-harj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553134619, "creation_date": 1553114622, "last_edit_date": 1553134619, "question_id": 55269858, "link": "https://stackoverflow.com/questions/55269858/macro-to-run-through-folder-returns-subscript-out-of-range-error", "title": "Macro to run through folder, returns subscript out of range error", "body": "<p>Setup - I have a macro that's in an excel file, when I click a button it will 1) go to a folder 2) Run the code for all xlsx files. </p>\n\n<p>Problem - I tested parts of the code and it works but when I do the entire thing it doesnt.  Debugging highlights a section which I will show shortly.</p>\n\n<pre><code>Sub CommandButton1_Click()\n'PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xlsx*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n        'Set variable equal to opened workbook\n          Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n        'Ensure Workbook has opened before moving on to next line of code\n          DoEvents\n\n        'Change First Worksheet's Background Fill Blue\n\n\n\n     'This code below gave us the first column but if clicked twice we have a problem'\n\n    ActiveSheet.Columns(\"A\").Insert Shift:=xlToRight\n\n    ActiveSheet.Columns(\"A\").Insert Shift:=xlToLeft\n    'Added the title Source 2 to A1'\n\n    Range(\"A1\").Value = \"XX\"\n\n    Range(\"B1\").Value = \"XX\"\n\n\n\n\n    'Perform the Find/Replace All'\n\n        Columns(\"I\").Replace What:=\"XX\", _\n                                Replacement:=\"XX\", _\n                                LookAt:=xlPart, _\n                                SearchOrder:=xlByRows, _\n                                MatchCase:=False, _\n                                SearchFormat:=False, _\n                                ReplaceFormat:=False\n\n     'Solution to the columns A and B\n\n    **Dim arrData As Variant, LastRow As Long, i As Long, ws As Worksheet\n\n        Set ws = ThisWorkbook.Sheets(\"newreport\") 'change the name of the sheet to the one you are doing the code**\n\n        With ws\n            LastRow = .Cells(.Rows.Count, 3).End(xlUp).Row\n            arrData = .Range(\"A2\", .Cells(LastRow, \"C\")).Value\n            For i = 1 To UBound(arrData)\n\n    'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Ensure Workbook has closed before moving on to next line of code\n      DoEvents\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>There's one line of code that is the problem, </p>\n\n<pre><code>**Dim arrData As Variant, LastRow As Long, i As Long, ws As Worksheet\n\n    Set ws = ThisWorkbook.Sheets(\"newreport\")\n</code></pre>\n\n<p>How can I get through this problem?</p>\n\n<p>I think I need to rewrite this code </p>\n\n<pre><code>Dim arrData As Variant, LastRow As Long, i As Long, ws As Worksheet\n\n    Set ws = ThisWorkbook.Sheets(\"report1538393886588\") 'change the name of the sheet to the one you are doing the code\n\n        With ws\n            LastRow = .Cells(.Rows.Count, 3).End(xlUp).Row\n            arrData = .Range(\"A2\", .Cells(LastRow, \"C\")).Value\n            For i = 1 To UBound(arrData)\n                If arrData(i, 3) Like \"XXX*\" Then\n                    arrData(i, 1) = \"XX XXX\"\n                Else\n                    arrData(i, 1) = \"XXX XXX\"\n                End If\n                If arrData(i, 3) Like \"CSI*\" Or arrData(i, 3) = vbNullString Then\n                    arrData(i, 2) = vbNullString\n                Else\n                    arrData(i, 2) = Right(arrData(i, 3), Len(arrData(i, 3)) - 12)\n                End If\n            Next i\n            .Range(\"A2\", .Cells(LastRow, \"C\")).Value = arrData\n        End With\n\n      For Each cell In Range(\"B2\", Range(\"B605536\").End(xlUp))\n    If Not IsEmpty(cell) Then\n    cell.Value = Right(cell, Len(cell) - 2)\n    End If\n    Next cell\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "paragraph"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553114000, "post_id": 55269633, "comment_id": 97270508, "body": "Before Writing any code you should check your document to see what styles are used. If normal paragraphs have a distinctive style then this is a trivial task.  Otherwise you need to defined some rules to define paragraphs that you don&#39;t want the extra text to appear before."}, {"owner": {"reputation": 1, "user_id": 7679899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoNFy.jpg?s=128&g=1", "display_name": "TunaBooties", "link": "https://stackoverflow.com/users/7679899/tunabooties"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1553114461, "post_id": 55269633, "comment_id": 97270768, "body": "All of my paragraphs use the Style normal, which is why I am unsure why the SAMPLE text is only appearing at the beginning of some of the paragraphs. If all the paragraphs are Normal shouldn&#39;t this condition be applied to all of them? Not just the first one at the beginning of a new section?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1553116285, "post_id": 55269633, "comment_id": 97271655, "body": "@TunaBooties So how did you get your Title page, Table of Contents and Headings etc. all to use the Normal Style?"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1553117528, "post_id": 55269633, "comment_id": 97272187, "body": "Have you checked that your \u201cparagraphs\u201d ARE actually paragraphs? Turn on \u201cShow formatting marks\u201d and make sure the paragraphs end with a paragraph mark rather than a manual line break."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1553145278, "creation_date": 1553145278, "answer_id": 55274177, "question_id": 55269633, "link": "https://stackoverflow.com/questions/55269633/macro-for-adding-text-to-begining-of-every-paragraph/55274177#55274177", "title": "Macro for Adding Text To Begining of Every Paragraph", "body": "<p>Provided your Title, Table of Contents and Headings etc. don't use the Normal Style - as they shouldn't - you really don't need a macro for this - all you need is a <em>wildcard</em> Find/Replace where:</p>\n\n<pre><code>Find = [!^13]*^13\nReplace = SAMPLE: ^&amp;\n</code></pre>\n\n<p>and you specify the Normal Style as a Find formatting parameter. You could, of course, record the above as a macro, but that seems overkill unless you're doing this often.</p>\n"}], "owner": {"reputation": 1, "user_id": 7679899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoNFy.jpg?s=128&g=1", "display_name": "TunaBooties", "link": "https://stackoverflow.com/users/7679899/tunabooties"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582953545, "creation_date": 1553113649, "last_edit_date": 1582953545, "question_id": 55269633, "link": "https://stackoverflow.com/questions/55269633/macro-for-adding-text-to-begining-of-every-paragraph", "title": "Macro for Adding Text To Begining of Every Paragraph", "body": "<p>I am trying to create a Word macro that will go through a large document that I have and add the text \"SAMPLE\" to the beginning of every paragraph.\nThe document contains a Title page, Table of Contents and Headings throughout and I would prefer none of these have the \"SAMPLE\" text on them, just the paragraphs.</p>\n\n<p>Below is some macro code I have found on various sites and kind of pieced together to do somewhat of what I want. It does place the \"SAMPLE\" text at the beginning of some paragraphs but not all, usually only the first paragraph of a new section within my document. And it also places it at the end of the Table of Contents and Beginning of the Title page. \nI am brand new to macros in Word so any help is appreciated or if there is a better way of doing this perhaps? There might even be some unnecessary bits in this code since it is pieced together from other samples. </p>\n\n<pre><code>Sub SAMPLE()\n\nApplication.ScreenUpdating = False\nDim Par As Paragraph, Rng As Range\nFor Each Par In ActiveDocument.Paragraphs\n\n  If Par.Style = \"Normal\" Then\n    If Rng Is Nothing Then\n      Set Rng = Par.Range\n    Else\n      Rng.End = Par.Range.End\n    End If\n  Else\n    Call RngFmt(Rng)\n  End If\n\n  If Par.Range.End = ActiveDocument.Range.End Then\n    Call RngFmt(Rng)\n  End If\n\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n\nSub RngFmt(Rng As Range)\nIf Not Rng Is Nothing Then\n  With Rng\n    .End = .End - 1\n    .InsertBefore \"SAMPLE\"\n\n  End With\n  Set Rng = Nothing\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553113240, "post_id": 55269436, "comment_id": 97270141, "body": "On a form,  or on a worksheet?"}, {"owner": {"reputation": 3, "user_id": 11234217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd6e89c4080fc6898d132a34941bf34?s=128&d=identicon&r=PG&f=1", "display_name": "VBAcode1923", "link": "https://stackoverflow.com/users/11234217/vbacode1923"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553123646, "post_id": 55269436, "comment_id": 97274162, "body": "@TimWilliams It would be on a worksheet"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553124832, "post_id": 55269436, "comment_id": 97274513, "body": "Do the group boxes and/or option buttons (boxes?) have a consistent naming scheme?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553129358, "post_id": 55269436, "comment_id": 97275581, "body": "...asking because it&#39;s not too clear how you&#39;d identify the 5th option button."}, {"owner": {"reputation": 3, "user_id": 11234217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd6e89c4080fc6898d132a34941bf34?s=128&d=identicon&r=PG&f=1", "display_name": "VBAcode1923", "link": "https://stackoverflow.com/users/11234217/vbacode1923"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553172996, "post_id": 55269436, "comment_id": 97291594, "body": "@TimWilliams Not really, I am thinking I can just go through and uncheck them all. Not necessarily the functionality I was looking for, but it serves the same purpose in general"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553185874, "post_id": 55269436, "comment_id": 97300096, "body": "If your option buttons are grouped (so that only one in each group can be &quot;on&quot;) then it seems like you couldn&#39;t uncheck them all..."}], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 8915442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc45c0b53c904a48d002e2ebc301c4f5?s=128&d=identicon&r=PG", "display_name": "Arjun", "link": "https://stackoverflow.com/users/8915442/arjun"}, "is_accepted": true, "score": 1, "last_activity_date": 1553159300, "last_edit_date": 1553159300, "creation_date": 1553158888, "answer_id": 55276839, "question_id": 55269436, "link": "https://stackoverflow.com/questions/55269436/parsing-through-group-boxes-form-controls/55276839#55276839", "title": "Parsing through Group Boxes (Form Controls)", "body": "<p>From What I understood you want the last option button in all the groupboxes to be checked. Then I think you dont have to 'explicitly' write a loop through all the group boxes but just a loop through the options buttons and set the value to 1.</p>\n\n<pre><code>Dim Option_Button As OptionButton\n\nFor Each Option_Button In Worksheets(\"Sheet1\").OptionButtons\n    Option_Button.Value = 1\nNext Option_Button\n</code></pre>\n\n<p>Not sure if its the best approach but I hope it helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 11234217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd6e89c4080fc6898d132a34941bf34?s=128&d=identicon&r=PG&f=1", "display_name": "VBAcode1923", "link": "https://stackoverflow.com/users/11234217/vbacode1923"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55276839, "answer_count": 1, "score": 0, "last_activity_date": 1553159300, "creation_date": 1553112779, "last_edit_date": 1553134658, "question_id": 55269436, "link": "https://stackoverflow.com/questions/55269436/parsing-through-group-boxes-form-controls", "title": "Parsing through Group Boxes (Form Controls)", "body": "<p>I've been searching through StackOverflow and all over the internet for hours now and can't find anything.</p>\n\n<p>I am trying to parse through about 100 Form Control Group Boxes. Within each Group Box are 5 Option Boxes. I'm trying to do a \"reset\" for the questionnaire so I'm trying to set each Group Box  of Option Boxes to the final option box.</p>\n\n<p>How do I see whether each option box in the group box is checked and then set each row to the fifth option box?</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553112749, "post_id": 55269205, "comment_id": 97269870, "body": "The TOP number cannot be dynamic in query object so you have answered your own question. Use VBA."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1553114438, "creation_date": 1553114438, "answer_id": 55269804, "question_id": 55269205, "link": "https://stackoverflow.com/questions/55269205/select-top-x-in-ms-access-query-based-on-form-field/55269804#55269804", "title": "SELECT TOP x in MS Access query based on form field?", "body": "<p><a href=\"https://stackoverflow.com/a/30082530/77335\">Access does not support using a parameter for SELECT TOP.</a></p>\n\n<p>Revise the <em>Record Source</em> SQL in the <em>After Update</em> event of that <code>[Forms]![fdlgQualityHistory]![MaxProblems]</code> control.  </p>\n"}, {"comments": [{"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "edited": false, "score": 0, "creation_date": 1553116175, "post_id": 55269933, "comment_id": 97271598, "body": "Forgive my ignorance, but I&#39;m having trouble wrapping my brain around this query.  Would it return the x <i>most recent</i> records?  Or just <i>any</i> x records?  I would think the <code>ORDER BY</code> would need to go in the subquery to have an effect.  Also, I think there is a typo in this line since there are two aliases: <code>LEFT JOIN tblProblems sub_p AS p ON pt.PA = p.PantagNo</code>.  I&#39;m not quite sure how to fix it myself."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "edited": false, "score": 0, "creation_date": 1553116905, "post_id": 55269933, "comment_id": 97271938, "body": "Correct on typos and I needed an inequality <code>&lt;=</code>. No <code>ORDER BY</code> is needed. The correlated subquery is creating an integer ranking by descending <i>ComplaintDate</i> and <code>WHERE</code> filters to all ranks until the form&#39;s control (i.e., all 1 - 20 if form control is 20)."}, {"owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "edited": false, "score": 0, "creation_date": 1553118208, "post_id": 55269933, "comment_id": 97272463, "body": "Ah, ok I understand it now.  I&#39;m not going to use it because the report is already slow, but it&#39;s interesting (+1).  I edited the answer to fix the remaining issues I saw: fixed table aliases and removed <code>ORDER BY</code> since Access reports ignore it and <code>TOP</code> (which had needed it) is now gone."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1553118070, "last_edit_date": 1553118070, "creation_date": 1553114902, "answer_id": 55269933, "question_id": 55269205, "link": "https://stackoverflow.com/questions/55269205/select-top-x-in-ms-access-query-based-on-form-field/55269933#55269933", "title": "SELECT TOP x in MS Access query based on form field?", "body": "<p>Alternatively, since the <code>TOP</code> number cannot be parameterized and hence use form fields, consider creating a running count by descending dates that you can then filter. But just be forewarned that for larger tables, this correlated subquery can pose performance challenges. </p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \n    pt.PA,\n    pt.SpfCode\nFROM\n    PtHead AS pt\n    LEFT JOIN tblProblems AS p ON pt.PA = p.PantagNo\nWHERE\n     pt.PA = [Forms]![fdlgQualityHistory]![PA]\n AND p.ComplaintDate &gt;= [Forms]![fdlgQualityHistory]![StartDate]\n AND (SELECT Count(*) \n      FROM PtHead sub_pt\n      LEFT JOIN tblProblems AS sub_p ON sub_pt.PA = sub_p.PantagNo\n      WHERE sub_p.ComplaintDate &gt;= p.ComplaintDate) &lt;= [Forms]![fdlgQualityHistory]![MaxProblems];\n</code></pre>\n\n<p>Maybe one day MS Access will support window functions and join the others in RDBMS world to avoid the correlated subquery:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>ROW_NUMBER() OVER (ORDER BY pt.ComplaintDate DESC)\n</code></pre>\n"}], "owner": {"reputation": 9217, "user_id": 5405967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2644961bd7b6e044fdbd48bbcf8d0f?s=128&d=identicon&r=PG&f=1", "display_name": "MarredCheese", "link": "https://stackoverflow.com/users/5405967/marredcheese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 55269804, "answer_count": 2, "score": 2, "last_activity_date": 1553118070, "creation_date": 1553111889, "last_edit_date": 1553114552, "question_id": 55269205, "link": "https://stackoverflow.com/questions/55269205/select-top-x-in-ms-access-query-based-on-form-field", "title": "SELECT TOP x in MS Access query based on form field?", "body": "<p>I have an Access report whose <code>Record Source</code> references a couple of fields on a form.  It works fine.  This is it, minus a bunch fields in the <code>SELECT</code> clause for simplicity:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT\n    pt.PA,\n    pt.SpfCode\nFROM\n    PtHead AS pt\n    LEFT JOIN tblProblems AS p ON pt.PA = p.PantagNo\nWHERE\n    pt.PA = [Forms]![fdlgQualityHistory]![PA] AND\n    p.ComplaintDate &gt;= [Forms]![fdlgQualityHistory]![StartDate];\n</code></pre>\n\n<p>I want to upgrade this report so that it only shows the most recent records.  This works fine:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT TOP 20  -- NEW PART\n    pt.PA,\n    pt.SpfCode\nFROM\n    PtHead AS pt\n    LEFT JOIN tblProblems AS p ON pt.PA = p.PantagNo\nWHERE\n    pt.PA = [Forms]![fdlgQualityHistory]![PA] AND\n    p.ComplaintDate &gt;= [Forms]![fdlgQualityHistory]![StartDate]\nORDER BY p.ComplaintDate DESC;  -- NEW PART\n</code></pre>\n\n<p>However, I don't want it to be hard-coded to <code>TOP 20</code>.  I want it to be <code>TOP x</code>, based on another field on that same form.  The following fails:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT TOP [Forms]![fdlgQualityHistory]![MaxProblems]  -- FAILS HERE\n    pt.PA,\n    pt.SpfCode\nFROM\n    PtHead AS pt\n    LEFT JOIN tblProblems AS p ON pt.PA = p.PantagNo\nWHERE\n    pt.PA = [Forms]![fdlgQualityHistory]![PA] AND\n    p.ComplaintDate &gt;= [Forms]![fdlgQualityHistory]![StartDate]\nORDER BY p.ComplaintDate DESC;\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>The SELECT statement includes a reserved word or an argument name that is misspelled or missing, or the punctuation is incorrect.</p>\n</blockquote>\n\n<p>Can I alter the syntax to make this work?  If not, what can I do?  Do I have to overwrite the entire query text each time the report is run via VBA instead?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5757, "user_id": 255243, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XEHjT.png?s=128&g=1", "display_name": "raddevus", "link": "https://stackoverflow.com/users/255243/raddevus"}, "edited": false, "score": 0, "creation_date": 1553111757, "post_id": 55269045, "comment_id": 97269388, "body": "Add some data and I&#39;ll try it here. I need PivotTable4 data."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11229427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157313514618760/picture?type=large", "display_name": "Victor Aguirre Vargas", "link": "https://stackoverflow.com/users/11229427/victor-aguirre-vargas"}, "is_accepted": false, "score": 0, "last_activity_date": 1553112590, "creation_date": 1553112590, "answer_id": 55269395, "question_id": 55269045, "link": "https://stackoverflow.com/questions/55269045/excel-vba-filter-specific-data-in-pivot-table/55269395#55269395", "title": "Excel VBA - Filter specific data in Pivot Table", "body": "<p>After reading about the properties of the class, I finally got to what I wanted.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub filterpivot()\r\n\r\n\r\nDim pi As PivotItem\r\nDim pt As PivotTable\r\nDim first As String\r\nDim second As String\r\nDim third As String\r\nDim fourth As String\r\n\r\nfirst = Range(\"a26\").Value\r\nsecond = Range(\"a27\").Value\r\nthird = Range(\"a28\").Value\r\nfourth = Range(\"a29\").Value\r\n\r\nSet pt = Worksheets(\"Lowest Scores\").PivotTables(\"PivotTable4\")\r\n\r\n    With pt.PivotFields(\"Nombre conjunto\")\r\n        For Each pi In pt.PivotFields(\"Nombre conjunto\").PivotItems\r\n        \r\n        \r\n            If pi.Name = first Or pi.Name = second Or pi.Name = third Or pi.Name = fourth Then\r\n                pi.Visible = True\r\n            Else\r\n                pi.Visible = False\r\n            End If\r\n        Next pi\r\n    End With\r\n\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>This bases the applied filter on specific cell values. My apologies if anyone was working on this already, I was on a crunch at work and needed the answer.</p>\n"}], "owner": {"reputation": 1, "user_id": 11229427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157313514618760/picture?type=large", "display_name": "Victor Aguirre Vargas", "link": "https://stackoverflow.com/users/11229427/victor-aguirre-vargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553134670, "creation_date": 1553111201, "last_edit_date": 1553134670, "question_id": 55269045, "link": "https://stackoverflow.com/questions/55269045/excel-vba-filter-specific-data-in-pivot-table", "title": "Excel VBA - Filter specific data in Pivot Table", "body": "<p>I tried using the code that appeared to have helped the poster at </p>\n\n<p><a href=\"https://stackoverflow.com/questions/42505991/excel-vba-privot-table-filter-multiple-criteria\">Excel VBA - Privot table filter multiple criteria</a> </p>\n\n<p>But I keep on getting the following error: Unable to get the PIvtoFields property of the PIvotTable Class.</p>\n\n<pre><code>Sub FilterPivotItems()\n\n    Dim PT          As PivotTable\n    Dim PTItm       As PivotItem\n    Dim FiterArr()  As Variant\n\n    ' use an array to select the items in the pivot filter you want to keep visible\n    FiterArr = Array(\"MC. Santa Clara\", \"MC. Plaza Am\u00e9ricas\", \"MC. El Frutal\")\n\n    ' set the Pivot Table\n    Set PT = ActiveSheet.PivotTables(\"PivotTable4\")\n\n    ' loop through all Pivot Items in \"Value\" Pivot field\n    For Each PTItm In PT.PivotFields(\"Value\").PivotItems\n        If Not IsError(Application.Match(PTItm.Caption, FiterArr, 0)) Then ' check if current item is not in the filter array\n            PTItm.Visible = True\n        Else\n            PTItm.Visible = False\n        End If\n    Next PTItm\n\nEnd Sub\n</code></pre>\n\n<p>What can I do?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553110568, "post_id": 55268804, "comment_id": 97268819, "body": "What version of Excel are you using?"}, {"owner": {"reputation": 93, "user_id": 612163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca397645567181a27d548cd8622d4223?s=128&d=identicon&r=PG", "display_name": "Jody Highroller", "link": "https://stackoverflow.com/users/612163/jody-highroller"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553115638, "post_id": 55268804, "comment_id": 97271342, "body": "I am using Excel 2016, should have added that to the initial post."}], "owner": {"reputation": 93, "user_id": 612163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca397645567181a27d548cd8622d4223?s=128&d=identicon&r=PG", "display_name": "Jody Highroller", "link": "https://stackoverflow.com/users/612163/jody-highroller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553160577, "creation_date": 1553110148, "last_edit_date": 1553160577, "question_id": 55268804, "link": "https://stackoverflow.com/questions/55268804/run-time-error-1004-when-applying-pivot-table-filter", "title": "Run-Time Error 1004 when applying Pivot Table Filter", "body": "<p>I get a Run-time error '1004': Application-defined or object-defined error whenever executing this piece of code:</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Dashboard\")\nApplication.ScreenUpdating = False\n\nIf wb.SlicerCaches(\"Slicer_Inspection_Status\").SlicerItems(\"In Queue\").Selected = True Then\n    ws.PivotTables(\"IN_QUEUE_PIVOT\").PivotFields(\"LAST UPDATE\").ClearAllFilters\nElseIf wb.SlicerCaches(\"Slicer_Inspection_Status\").SlicerItems(\"In Queue\").Selected = False Then\n    ws.PivotTables(\"IN_QUEUE_PIVOT\").PivotFields(\"LAST UPDATE\").ClearAllFilters\n    ws.PivotTables(\"IN_QUEUE_PIVOT\").PivotFields(\"LAST UPDATE\").PivotFilters.Add2 Type:=xlDateToday\nEnd If\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This is the error line:</p>\n\n<pre><code>ws.PivotTables(\"IN_QUEUE_PIVOT\").PivotFields(\"LAST UPDATE\").PivotFilters.Add2 Type:=xlDateToday\n</code></pre>\n\n<p>The weird thing is the filter applies even with the error popping, and if I put in an \"On Error Resume Next\" statement everything works fine.  </p>\n\n<p>\"LAST UPDATE\" is in the Rows section of my Pivot Table, and my pivot table is comprised entirely of rows, no filters, columns, or values.</p>\n\n<p>Edit:  I am running Excel 2016 on Windows 10.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1553109525, "post_id": 55268389, "comment_id": 97268310, "body": "&quot;I think this problem needs a fresh unbiased approach&quot; - it&#39;s always best if you post your code and describe exactly what problem(s) you had modifying it.  Non-one here really wants to rewrite your working code, in order to add a small modification."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553111038, "post_id": 55268389, "comment_id": 97269027, "body": "..if that sounds harsh it&#39;s not intended to be: posting code is the best way to get a response here. What you want is likely a one-line addition to your existing (working) code."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11237053, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8d47b3a9e584b052d6efa112e2d97569?s=128&d=identicon&r=PG", "display_name": "Edward Babcock", "link": "https://stackoverflow.com/users/11237053/edward-babcock"}, "is_accepted": false, "score": -1, "last_activity_date": 1553168523, "last_edit_date": 1553168523, "creation_date": 1553165681, "answer_id": 55278823, "question_id": 55268389, "link": "https://stackoverflow.com/questions/55268389/inserting-the-value-in-a1-of-each-worksheet-in-the-workbook-into-column-b-of-the/55278823#55278823", "title": "Inserting the value in A1 of each worksheet in the WorkBook into column B of the Table of Contents", "body": "<p>Use the following code:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Activate()\n\n'Runs every time the sheet is activated by the user.\n\n  'Create Table of Contents\n  Call TOC_Column_A\n\nEnd Sub\n\nSub TOC_Column_A()\n\n'Create Table of Contents on this TOC sheet\n\nDim ws As Worksheet\n\nDim wsTOC As Worksheet\n\nDim i As Long\n\nDim wsTitle As String\n\n\n  Application.ScreenUpdating = False\n\n  ActiveSheet.Cells.Font.Name = \"Comic Sans MS\"\n\n  Rows(1).RowHeight = 30\n\n  Rows(2).RowHeight = 24\n\n  Rows(\"3:30\").RowHeight = 18\n\n  Columns(\"A\").ColumnWidth = 1\n\n  Columns(\"B\").ColumnWidth = 9\n\n  Columns(\"C\").ColumnWidth = 39\n\n  Columns(\"D\").ColumnWidth = 60\n\n  Columns(\"E\").ColumnWidth = 90\n\n\n  'Set variables\n\n  Const bSkipHidden As Boolean = False 'Change this to True to NOT list hidden sheets\n\n  Const sTitle As String = \"C1\"\n\n  Const sHeader As String = \"B2\"\n\n  Set wsTOC = Me 'can change to a worksheet ref if using in a regular code module\n\n  'Clear Cells\n\n  wsTOC.Cells.Clear\n\n  ActiveSheet.Cells.Font.Color = RGB(0, 32, 96)\n\n  ActiveSheet.Cells.Font.Name = \"Comic Sans MS\"\n\n  'Title\n  With wsTOC.Range(sTitle)\n\n    .Value = \"Table of Contents\"\n\n    .Font.Bold = True\n\n    .Font.Size = .Font.Size + 6\n\n    Range(\"C1\").HorizontalAlignment = xlCenter\n    'List header\n\n    ActiveSheet.Range(\"C2:E2\").Select\n\n    With Selection\n\n       .VerticalAlignment = xlCenter\n\n       .HorizontalAlignment = xlCenter\n\n       .Font.Bold = True\n\n       .Font.Size = .Font.Size + 4\n\n    End With\n\n    .Offset(1, -1).Value = \"#\"\n\n    .Offset(1, 0).Value = \"Sheet Name\"\n\n    .Font.Size = .Font.Size + 4\n\n    .Offset(1, 1).Value = \"Sheet Title\"\n\n    .Offset(1, 2).Value = \"Notes\"\n\n\n  End With\n\n  With wsTOC.Range(sHeader)\n\n'===================== Begin =====================\n\n'Description:       Adds a new sheet with a Table of Contents that\n\n'                   includes thumbnail image tiles of each sheet\n\n'                   in the workbook.  Each image is a clickable\n\n'                   link to the worksheet.\n\n\n'Running the macro: The macro runs on the ActiveWorkbook.\n\n\n'                   Changes cannot be undone, so save a copy\n\n'                   of the file before running.\n\n\n'Author:            Jon Acampora, Excel Campus\n\n'Source:            https://www.excelcampus.com/vba/table-of-contents-gallery/\n\n\n    For Each ws In ThisWorkbook.Worksheets\n\n        'Skip TOC sheet\n\n        If ws.Name &lt;&gt; wsTOC.Name Then\n\n          'Skipping hidden sheets can be toggled in the variable above\n\n          If bSkipHidden Or ws.Visible = xlSheetVisible Then\n\n            .Offset(i).Value = i\n\n            wsTOC.Hyperlinks.Add Anchor:=.Offset(i, 1), _\n\n                                  Address:=\"\", _\n\n                                  SubAddress:=\"'\" &amp; ws.Name &amp; \"'!A1\", _\n\n                                  TextToDisplay:=ws.Name\n\n\n            i = i + 1\n\n          End If\n\n        End If\n\n    Next ws\n\n'===================== End =====================\n\n    ActiveSheet.Cells.Font.Color = RGB(0, 32, 96)\n\n  End With\n\n  Columns(\"A:B\").EntireColumn.Hidden = True\n\n  Range(\"c3:E30\").Select\n\n  Selection.HorizontalAlignment = xlLeft\n\n  Range(\"c3:E30\").IndentLevel = 1\n\n  Range(\"C1:E1\").Merge\n\n  ActiveCell.Select\n\n\n  Call Color_Borders\n\n  Call Insert_Copyright\n\n  Call Format_Cols\n\n  ActiveWindow.SmallScroll Up:=36\n\n  Range(\"D3\").Select\n\n  Call Copy_data\n\nEnd Sub\n\nSub Color_Borders()\n'\n' Insert worksheet and cell borders\n\n' \n'\n\n   Dim rng As Range, cel As Range\n\n   Set rng = Range(\"C3:e30\")\n\n   For Each cel In rng\n\n       cel.Borders.Color = RGB(191, 191, 191)\n\n   Next cel\n\n\n    Range(\"C1:E30\").Select\n\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n\n    With Selection.Borders(xlEdgeLeft)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    With Selection.Borders(xlEdgeTop)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    With Selection.Borders(xlEdgeBottom)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    With Selection.Borders(xlEdgeRight)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    ActiveWindow.SmallScroll Down:=-18\n\n    Range(\"C1:E1\").Select\n\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n\n    With Selection.Borders(xlEdgeLeft)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    With Selection.Borders(xlEdgeTop)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    With Selection.Borders(xlEdgeBottom)\n\n        .LineStyle = xlDash\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThin\n\n    End With\n\n    With Selection.Borders(xlEdgeRight)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    Selection.Borders(xlInsideVertical).LineStyle = xlNone\n\n    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone\n\n    Range(\"C2:E2\").Select\n\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n\n    With Selection.Borders(xlEdgeLeft)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    With Selection.Borders(xlEdgeTop)\n\n        .LineStyle = xlDash\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThin\n\n    End With\n\n    With Selection.Borders(xlEdgeBottom)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlMedium\n\n    End With\n\n    With Selection.Borders(xlEdgeRight)\n\n        .LineStyle = xlContinuous\n\n        .Color = -10477568\n\n        .TintAndShade = 0\n\n        .Weight = xlThick\n\n    End With\n\n    Selection.Borders(xlInsideVertical).LineStyle = xlNone\n\n    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone\n\nEnd Sub\n\nSub Insert_Copyright()\n\n'\n' Insert Copyright info, etc\n'\n'\n\n    ActiveWindow.SmallScroll Down:=21\n\n    Range(\"C32:D32\").Select\n\n    ActiveCell.FormulaR1C1 = \"Copyright \u00a9 2019  - All Rights Reserved.\"\n\n    Selection.Font.Size = 8\n\n    Range(\"C32:D32\").Select\n\n    Selection.Merge\n\n    With Selection\n\n        .HorizontalAlignment = xlGeneral\n\n        .VerticalAlignment = xlCenter\n\n        .WrapText = False\n\n        .Orientation = 0\n\n        .AddIndent = False\n\n        .IndentLevel = 0\n\n        .ShrinkToFit = False\n\n        .ReadingOrder = xlContext\n\n        .mergeCells = True\n\n    End With\n\n    With Selection\n\n        .HorizontalAlignment = xlLeft\n\n        .VerticalAlignment = xlCenter\n\n        .WrapText = False\n\n        .AddIndent = False\n\n        .IndentLevel = 0\n\n        .ShrinkToFit = False\n\n        .ReadingOrder = xlContext\n\n        .mergeCells = True\n\n    End With\n\n    Selection.InsertIndent 1\n\n\n    Range(\"C34\").Select\n\n    ActiveCell.FormulaR1C1 = \"Filename:\"\n\n    Range(\"C35\").Select\n\n    ActiveCell.FormulaR1C1 = \"Path\"\n\n    Range(\"C36\").Select\n\n    ActiveCell.FormulaR1C1 = \"Created by:\"\n\n    Range(\"C37\").Select\n\n    ActiveCell.FormulaR1C1 = \"Created date:\"\n\n    Range(\"C38\").Select\n\n    ActiveCell.FormulaR1C1 = \"Last modified by:\"\n\n    Range(\"C39\").Select\n\n    ActiveCell.FormulaR1C1 = \"Last modified date:\"\n\n    Selection.InsertIndent 1\n\n    Range(\"C34:C39\").Select\n\n    With Selection\n\n        .HorizontalAlignment = xlRight\n\n        .VerticalAlignment = xlBottom\n\n        .WrapText = False\n\n        .Orientation = 0\n\n        .AddIndent = False\n\n        .IndentLevel = 1\n\n        .ShrinkToFit = False\n\n        .ReadingOrder = xlContext\n\n        .mergeCells = False\n\n    End With\n\n    Range(\"D34\").Select\n\n    ActiveCell.FormulaR1C1 = \"=FileTitle()\"\n\n    Range(\"D35\").Select\n\n    ActiveCell.FormulaR1C1 = \"=CurrentPathName()\"\n\n    Range(\"D36\").Select\n\n    ActiveCell.FormulaR1C1 = \"=CreatedBy()\"\n\n    Range(\"D37\").Select\n\n    Selection.NumberFormat = \"yyyy-mmm-dd (ddd) h:mm AM/PM\"\n\n    ActiveCell.FormulaR1C1 = \"3/19/2019\"\n\n    Range(\"D38\").Select\n\n    ActiveCell.FormulaR1C1 = \"=LastModifiedBy()\"\n\n    Range(\"D39\").Select\n\n    ActiveCell.FormulaR1C1 = \"=LastModifiedDate()\"\n\n    Selection.InsertIndent 1\n\n    Range(\"D34:D39\").Select\n\n    With Selection\n\n        .HorizontalAlignment = xlLeft\n\n        .VerticalAlignment = xlCenter\n\n        .WrapText = False\n\n        .Orientation = 0\n\n        .AddIndent = False\n\n        .IndentLevel = 1\n\n        .ShrinkToFit = False\n\n        .ReadingOrder = xlContext\n\n        .mergeCells = False\n\n    End With\n\n\nEnd Sub\n\nSub Format_Cols()\n'\n' Formats columns D &amp; E rows 3 through 30\n'\n'\n\n    Range(\"D3:E30\").Select\n\n    Selection.NumberFormat = \"General\"\n\n    With Selection\n\n        .NumberFormat = \"General\"\n\n        .HorizontalAlignment = xlLeft\n\n        .VerticalAlignment = xlCenter\n\n        .WrapText = False\n\n        .Orientation = 0\n\n        .AddIndent = False\n\n        .IndentLevel = 1\n\n        .ShrinkToFit = False\n\n        .ReadingOrder = xlContext\n\n        .mergeCells = False\n\n    End With\n\n\nEnd Sub\n\nSub Copy_data()\n\n' Copy data from Cell A1 in each worksheet to Column B, Row WS Name\n'\n'\n'\nDim i As Long\n\nDim ws As Worksheet\n\nDim wsTOC As Worksheet\n\n\n\n'Set variables\n\nConst bSkipHidden As Boolean = False \n\nSet wsTOC = Me \n\n\ni = 1\n\n   For Each ws In ThisWorkbook.Worksheets\n\n        'Skip TOC sheet\n\n        If ws.Name &lt;&gt; wsTOC.Name Then\n\n          'Skipping hidden sheets can be toggled in the variable above\n\n          If bSkipHidden Or ws.Visible = xlSheetVisible Then\n\n'  I do not understand how to walk through the workbook sheet by sheet\n\n'  and copy the value in cell A1 into Column B where value\n\n'  in column a of the table of contents = ws.Name\n\n'\n            Sheets(\"Sheet1\").Range(\"A1\").Copy \n\nDestination:=Sheets(\"Sheet2\").Range(\"B????\")\n\n\n            i = i + 1\n\n          End If\n\n        End If\n\n    Next ws\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11233929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beaafc058c987a49d055d26f1670249?s=128&d=identicon&r=PG&f=1", "display_name": "EMBWayne", "link": "https://stackoverflow.com/users/11233929/embwayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553168523, "creation_date": 1553108616, "last_edit_date": 1553109436, "question_id": 55268389, "link": "https://stackoverflow.com/questions/55268389/inserting-the-value-in-a1-of-each-worksheet-in-the-workbook-into-column-b-of-the", "title": "Inserting the value in A1 of each worksheet in the WorkBook into column B of the Table of Contents", "body": "<p>I have created a VBA macro to create a refresh the Table of Contents worksheet every time the Table of Contents is selected.  ( I borrowed this code from an example I found on the web and inserted a comment to give the author credit.)</p>\n\n<p>The macro inserts the worksheet tab name in column A and creates a hyperlink that selects that worksheet when the user clicks on that cell.</p>\n\n<p>The macro also sizes rows &amp; columns, defines fonts, font colors &amp; font sizes, border line weight &amp; colors and adds such function , such as, filename, location, creator, date created, last modifier &amp; last date modified.</p>\n\n<p>I have nor been able to create  For each loop that accesses cell A1 in worksheet other than the Table of Contents and inserts the value in sheet # in column B of the appropriate row. </p>\n\n<pre><code>Sheet Name (Col A)                     Sheet Title (Col B)\nAudible\nAudible (GW)\nBattery Inventory &amp; Useage\nMobile  Devices\nMajor Household Items\neBay Auction Sales\nRed Oak\nPlywood Inventory\nStorage Locations\nDining Room Wall\n</code></pre>\n\n<p>I am so confused that I'm posting any coding I have tried. I think this problem needs a fresh unbiased approach.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553108843, "post_id": 55268349, "comment_id": 97267928, "body": "<code>ReDim Preserve table3(0 To UBound(table3, 1), UBound(table3, 2) + 1)</code>"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553110569, "post_id": 55268349, "comment_id": 97268820, "body": "I already tried it before i post and it fails. I tried also 0 to ubound(table3,1)-1 didn&#39;t work."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553111220, "post_id": 55268349, "comment_id": 97269123, "body": "You can write a small utility function to transpose an array without changing its lower bounds...  You don&#39;t need to use <code>Application.Transpose</code>   Or write a function to directly perform the resizing without any transpose.  <a href=\"https://stackoverflow.com/questions/13183775/excel-vba-how-to-redim-a-2d-array\" title=\"excel vba how to redim a 2d array\">stackoverflow.com/questions/13183775/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553111775, "post_id": 55268349, "comment_id": 97269394, "body": "@user11217663 -  Transpose does change the bounds (if the original lower bound is not 1)  The output lower bound is always 1"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553111904, "post_id": 55268349, "comment_id": 97269470, "body": "How is <code>table3</code> declared and populated?"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1553114916, "post_id": 55268349, "comment_id": 97271004, "body": "What does matter the way the Array is first populated? Can&#39;t see what it has to do with my problem."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1553115196, "post_id": 55268349, "comment_id": 97271131, "body": "Regarding what you are saying you confirm that transpose change the base from 0 to 1 right? And the only why to solve my problem to create my own utility? By the way i never said i want the transpose, i said i used the transpose because the redim pr&#233;serve does work on the last dimension only."}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1553160188, "post_id": 55272851, "comment_id": 97284396, "body": "Thanks a lot your function works perfectly and does the job."}], "tags": [], "owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "is_accepted": true, "score": 2, "last_activity_date": 1566483107, "last_edit_date": 1566483107, "creation_date": 1553134701, "answer_id": 55272851, "question_id": 55268349, "link": "https://stackoverflow.com/questions/55268349/vba-error-with-redim-preserve-and-application-transpose-changing-array-base/55272851#55272851", "title": "VBA Error with Redim Preserve and Application.Transpose changing array base", "body": "<p>Perhaps this would help you:</p>\n\n<pre><code>'********************************************************************************************************************\n' To re-dimension the first dimension of a two-dimension array without getting Excel errors\n' Also possible to re-dimension the second dimension\n' Usage: myArray = reDimPreserve(myArray, UBound(myArray, 1) + x, UBound(myArray, 2) + y)\n' Where x and y are the increments to get to the desired new dimensions\n' Returns an empty array if there was an error\n'********************************************************************************************************************\nPublic Function reDimPreserve(ByVal aArray As Variant, ByVal newFirstUBound As Long, ByVal newLastUBound As Long) As Variant\nDim tmpArr As Variant, nOldFirstUBound As Long, nOldLastUBound As Long, nFirst As Long, nLast As Long\n\nIf Not IsArray(aArray) Then\n    reDimPreserve = Array(Empty)\nElseIf newFirstUBound &lt; UBound(aArray, 1) Or newLastUBound &lt; UBound(aArray, 2) Then\n    reDimPreserve = Array(Empty)\nElse\n    ReDim tmpArr(newFirstUBound, newLastUBound)\n    nOldFirstUBound = UBound(aArray, 1)\n    nOldLastUBound = UBound(aArray, 2)\n    For nFirst = LBound(aArray, 1) To newFirstUBound\n        For nLast = LBound(aArray, 2) To newLastUBound\n            If nOldFirstUBound &gt;= nFirst And nOldLastUBound &gt;= nLast Then\n                tmpArr(nFirst, nLast) = aArray(nFirst, nLast)\n            End If\n        Next nLast\n    Next nFirst\n    reDimPreserve = tmpArr\n    Erase tmpArr\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 55272851, "answer_count": 1, "score": 0, "last_activity_date": 1566483107, "creation_date": 1553108483, "last_edit_date": 1553134735, "question_id": 55268349, "link": "https://stackoverflow.com/questions/55268349/vba-error-with-redim-preserve-and-application-transpose-changing-array-base", "title": "VBA Error with Redim Preserve and Application.Transpose changing array base", "body": "<p>I have a 2 dimensional array.\nI wanted to make a redim preserve on it's first dimension but I know that redim preseve works only on the last dimension.\nI tried to use transpose function, but it seems that the transpose is changing my array from base 0 to base 1, is it normal ? if yes how to set it back to base 0 ? or how to solve my problem to preserve my array while changing it's first dimension ?\nI want to add 2 elements to my array</p>\n\n<p>here is a part of my code where I get the problem : </p>\n\n<pre><code>    table3 = Application.Transpose(table3)\n    ReDim Preserve table3(Ubound(table3,1), Ubound(table3,2) +2)\n    table3 = Application.Transpose(table3)\n</code></pre>\n\n<p>I noticed that before the Transpose the array is base 0 and after the transpose it's base 1, and I think that's the main problem. I don't want to change the base from 0 to 1 because I use the same array elsewhere in my code and I don't want to change the whole code.</p>\n\n<p>The following line of code will give me an error </p>\n\n<p><strong>\u201cSubscript Out of Range\u201d</strong></p>\n\n<pre><code>ReDim Preserve table3(Ubound(table3,1), Ubound(table3,2) +2) \n</code></pre>\n\n<p>if I change it by the following line </p>\n\n<pre><code>ReDim Preserve table3(1 To UBound(table3, 1), UBound(table3, 2) + 2)\n</code></pre>\n\n<p>it will work but my array will become a based 1 array which not what I want, I want to keep my indexes starts from 0 not from 1</p>\n\n<p><strong>BEFORE TRANSPOSE</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/9WN0b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9WN0b.png\" alt=\"BEFORE TRANSPOSE\"></a></p>\n\n<p><strong>AFTER TRANSPOSE</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/s0kx5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s0kx5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1553115331, "post_id": 55268185, "comment_id": 97271200, "body": "If you are using the same ribbon XML you won&#39;t get your XL context menu to work in WD. You need to find the correct idMso for the context menu in WD that you want to add your menu to. You can get the control ids here: <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=50745\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=50745</a>"}, {"owner": {"reputation": 45, "user_id": 7663788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/klPBQ.jpg?s=128&g=1", "display_name": "Richard Barnes", "link": "https://stackoverflow.com/users/7663788/richard-barnes"}, "reply_to_user": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1553119118, "post_id": 55268185, "comment_id": 97272759, "body": "Thanks...that did it. Word has a lot of Context menu types....Now how do I flag this as solved???"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1553120530, "post_id": 55268185, "comment_id": 97273244, "body": "Please mark the answer below as the solution."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7663788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/klPBQ.jpg?s=128&g=1", "display_name": "Richard Barnes", "link": "https://stackoverflow.com/users/7663788/richard-barnes"}, "edited": false, "score": 0, "creation_date": 1553210929, "post_id": 55271018, "comment_id": 97310646, "body": "Thanks, from my previous reading on the subject I assumed that the &quot;idMso&quot; was a user defined text, like the &quot;dynamicMenu id&quot; or the &quot;button id&quot;. It makes sense and now all is working just fine. And, now I am able to control the Row and Column context menus, too."}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 0, "last_activity_date": 1553120458, "creation_date": 1553120458, "answer_id": 55271018, "question_id": 55268185, "link": "https://stackoverflow.com/questions/55268185/cannot-get-the-custom-ui-context-menus-working-in-word-2016/55271018#55271018", "title": "Cannot get the Custom UI context menus working in Word 2016", "body": "<p>If you are using the same ribbon XML you won't get your XL context menu to work in WD. You need to find the correct idMso for the context menu in WD that you want to add your menu to. You can get the control ids here: <a href=\"http://microsoft.com/en-us/download/details.aspx?id=50745\" rel=\"nofollow noreferrer\">Office 2016 control ids</a></p>\n"}], "owner": {"reputation": 45, "user_id": 7663788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/klPBQ.jpg?s=128&g=1", "display_name": "Richard Barnes", "link": "https://stackoverflow.com/users/7663788/richard-barnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 55271018, "answer_count": 1, "score": 0, "last_activity_date": 1553120458, "creation_date": 1553107908, "question_id": 55268185, "link": "https://stackoverflow.com/questions/55268185/cannot-get-the-custom-ui-context-menus-working-in-word-2016", "title": "Cannot get the Custom UI context menus working in Word 2016", "body": "<p>I have written several custom UI Ribbon menus for both Excel and Word. I have working custom context (right click) menus with my Excel apps, but cannot seem to get them to work in Word. I used the same coding as with my working menus in Excel and wrote the XML using the \"Custom UI Editor for Microsoft Office\" so there should be no issue.</p>\n\n<p>I will post my code. The real question is will this type of custom menu work in Word at all?</p>\n\n<p>The XML in the ribbon code is (showing the last lines only):</p>\n\n<pre><code>&lt;/tabs&gt;\n&lt;/ribbon&gt;\n\n    &lt;contextMenus&gt;\n            &lt;contextMenu idMso=\"ContextMenuCell\"&gt;\n                    &lt;dynamicMenu id=\"mnuMain\" label= \"BidSmart Contract\" imageMso=\"DocumentTemplate\" getContent=\"GetContent\" insertBeforeMso=\"Cut\"/&gt;\n            &lt;/contextMenu&gt;\n        &lt;/contextMenus&gt;\n</code></pre>\n\n<p></p>\n\n<p>The getContent sub, \"GetContent\" looks like this:</p>\n\n<pre><code>Sub GetContent(control As IRibbonControl, ByRef returnedVal)\n</code></pre>\n\n<p>Dim xml As String</p>\n\n<pre><code>xml = \"&lt;menu xmlns=\"\"http://schemas.microsoft.com/office/2009/07/customui\"\"&gt;\" &amp; _\n    \"&lt;button id=\"\"mnuCtxtEmail\"\" label=\"\"Send and Email\"\" imageMso=\"\"TableSharePointListsRefreshList\"\" screentip=\"\"Send an Email to the Client, Designer or Contractor...\"\" onAction=\"\"mnuEmail\"\"/&gt;\" &amp; _\n    \"&lt;button id=\"\"mnuCtxtEnvelope\"\" label=\"\"Print an Envelope\"\" imageMso=\"\"WhatIfAnalysisMenu\"\" screentip=\"\"Create an Envelope addressed to the Client, Designer or Contractor...\"\" onAction=\"\"mnuEnvelope\"\"/&gt;\" &amp; _\n    \"&lt;/menu&gt;\"\n\nreturnedVal = xml\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553108348, "post_id": 55268159, "comment_id": 97267702, "body": "First, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">don&#39;t use <code>ActiveCell</code>/<code>.Activate</code>/<code>.Select</code></a>, second, do you perhaps mean to use <code>...Value = Selection.Value</code>?"}, {"owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1553108858, "post_id": 55268159, "comment_id": 97267934, "body": "Alright, thanks! I&#39;ve tried selection.value but get an &quot;automation error&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1553109041, "post_id": 55268159, "comment_id": 97268042, "body": "When you are trying to debug something, it is not a bad idea to use hardcoded values. E.g. <code>.Value = &quot;Some test&quot;</code> to see where the problem is and to eliminate possible reasons."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553112887, "post_id": 55268159, "comment_id": 97269958, "body": "your error is because .value isn&#39;t a property of the element collection which is what you have if you remove the index e.g. 0.  Are you trying to paste data from a range (number of rows) into a single element? Or do you need a loop over rows to assign to different elements?"}, {"owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553117958, "post_id": 55268159, "comment_id": 97272375, "body": "@QHarr, I&#39;ve got a data set in excel with a filter set up and all rows of the 1st column are automatically copied. This is the data that I&#39;d like to paste into the text box in the webpage essentially."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1553108585, "creation_date": 1553108585, "answer_id": 55268374, "question_id": 55268159, "link": "https://stackoverflow.com/questions/55268159/how-to-copy-paste-data-from-excel-to-a-webpage-vba/55268374#55268374", "title": "How to copy/paste data from excel to a webpage (VBA)?", "body": "<p>This is some code of mine that works:</p>\n\n<pre><code>Sub FillOutInvoice(Account As Account)\n\n    Dim ie As InternetExplorer\n    Dim elem As HTMLLinkElement\n\n    Set ie = New InternetExplorer\n    ie.Visible = True\n    ie.navigate Settings.ErpAddress\n\n    Do While ie.Busy Or ie.readyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n    With ie.document\n        .getElementsByClassName(Settings.InputClass)(0).innerText = Account.InvoiceNumber\n        .getElementsByClassName(Settings.InputClass)(1).innerText = Day(Account.InvoiceDate)\n    End With\n\n    Do While ie.Busy Or ie.readyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n    Application.Wait Now + #12:00:02 AM#\n    ie.Quit\n\nEnd Sub\n</code></pre>\n\n<p>As you see, the needed property is <code>.InnerText</code> and not <code>.Value</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1553118947, "creation_date": 1553118947, "answer_id": 55270766, "question_id": 55268159, "link": "https://stackoverflow.com/questions/55268159/how-to-copy-paste-data-from-excel-to-a-webpage-vba/55270766#55270766", "title": "How to copy/paste data from excel to a webpage (VBA)?", "body": "<p>Here is an example of sending a range of rows text to a textarea element using the clipboard</p>\n\n<pre><code>Option Explicit\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\n\nPublic Sub InsertData()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.google.com/search?q=google+translate&amp;rlz=1C1GCEB_enGB815GB815&amp;oq=google+tran&amp;aqs=chrome.0.0j69i57j0l4.2057j0j7&amp;sourceid=chrome&amp;ie=UTF-8\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim clipboard As Object\n        Set clipboard = CreateObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n\n        ActiveSheet.Range(\"A1:A3\").Copy\n\n        With clipboard\n            .GetFromClipboard\n            ie.document.getElementsByTagName(\"textarea\")(1).innerText = .GetText\n        End With\n        Application.CutCopyMode = False\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Contents of Range(\"A1:A3\")</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/8alKK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8alKK.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1606, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553134815, "creation_date": 1553107785, "last_edit_date": 1553134815, "question_id": 55268159, "link": "https://stackoverflow.com/questions/55268159/how-to-copy-paste-data-from-excel-to-a-webpage-vba", "title": "How to copy/paste data from excel to a webpage (VBA)?", "body": "<p>So I'm trying to copy/paste data from excel into a webpage text box using VBA. However, my problem is that if I have, for example 3 or 4 rows of data copied, when pasting the values into the webpage using vba, only 1 row will be copied rather than all the rows.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>.Document.getElementsByTagName(\"textarea\")(0).Value = ActiveCell.Value\n</code></pre>\n\n<p>Any ideas? If I take out the (0) I get an error: </p>\n\n<blockquote>\n  <p>object doesn't support this property or method.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553107236, "post_id": 55267985, "comment_id": 97267149, "body": "Why is the conditional formatting compromised? If it is set to these two rows and you have not used locked cell references, the formatting should expand as needed without compromise. I don&#39;t think you need VBA for this - can you share your current conditional formatting rule?"}, {"owner": {"reputation": 3, "user_id": 11233713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0eac897ab587f7790be343a8928cea9?s=128&d=identicon&r=PG&f=1", "display_name": "user11233713", "link": "https://stackoverflow.com/users/11233713/user11233713"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1553108255, "post_id": 55267985, "comment_id": 97267652, "body": "The &quot;Applies to&quot; that is getting compromised.  When I put in the dynamic range it converts to the actual address.  Then when I add more records and update the query the applies to does not update properly"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11233713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0eac897ab587f7790be343a8928cea9?s=128&d=identicon&r=PG&f=1", "display_name": "user11233713", "link": "https://stackoverflow.com/users/11233713/user11233713"}, "edited": false, "score": 0, "creation_date": 1553120292, "post_id": 55269446, "comment_id": 97273164, "body": "Greg,  I added another picture that shows the screen shots of the conditional formatting rules manager.  When I start I apply the format to the entire row.  Then when the data set changes from a smaller set(less rows and columns) to a larger set the applies to changes"}, {"owner": {"reputation": 148, "user_id": 11092430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af024eb9cd9d2ba1f0f405a6306a781?s=128&d=identicon&r=PG&f=1", "display_name": "Greg_D", "link": "https://stackoverflow.com/users/11092430/greg-d"}, "reply_to_user": {"reputation": 3, "user_id": 11233713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0eac897ab587f7790be343a8928cea9?s=128&d=identicon&r=PG&f=1", "display_name": "user11233713", "link": "https://stackoverflow.com/users/11233713/user11233713"}, "edited": false, "score": 0, "creation_date": 1553190101, "post_id": 55269446, "comment_id": 97302403, "body": "Amended my answer. Hopefully this is a solution that will work for you."}], "tags": [], "owner": {"reputation": 148, "user_id": 11092430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af024eb9cd9d2ba1f0f405a6306a781?s=128&d=identicon&r=PG&f=1", "display_name": "Greg_D", "link": "https://stackoverflow.com/users/11092430/greg-d"}, "is_accepted": true, "score": 0, "last_activity_date": 1553190039, "last_edit_date": 1553190039, "creation_date": 1553112810, "answer_id": 55269446, "question_id": 55267985, "link": "https://stackoverflow.com/questions/55267985/change-format-of-a-row-of-cells-based-on-comparing-each-cell-in-2-rows/55269446#55269446", "title": "Change format of a row of cells based on comparing each cell in 2 rows", "body": "<p>Without more details it's hard to know what \"compromised\" is. I'm guessing that the range of the conditional formatting is either not including the new records or being changed by the additional records. Would modifying the range for the conditional formatting to include the whole rows fix the issue? e.g. change <code>$A$1:$B$5</code> to <code>$A:$B</code></p>\n\n<p>EDIT:\nOK. Try a VBA that clears and resets the conditional formatting every time.</p>\n\n<pre><code>Sub Format()\n  With ActiveSheet.Rows(\"$2:$2\") ''Select rows your working with\n    .FormatConditions.Delete  '' Clear out exising Conditional Formatting in selection\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=(A$1&gt;A$2)\"  ''Formula where condition is true\n    .FormatConditions(.FormatConditions.Count).Interior.Color = 65535 ''Set formatting you color yellow\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11233713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0eac897ab587f7790be343a8928cea9?s=128&d=identicon&r=PG&f=1", "display_name": "user11233713", "link": "https://stackoverflow.com/users/11233713/user11233713"}, "is_accepted": false, "score": 0, "last_activity_date": 1553201444, "last_edit_date": 1553201444, "creation_date": 1553196587, "answer_id": 55288012, "question_id": 55267985, "link": "https://stackoverflow.com/questions/55267985/change-format-of-a-row-of-cells-based-on-comparing-each-cell-in-2-rows/55288012#55288012", "title": "Change format of a row of cells based on comparing each cell in 2 rows", "body": "<p>Greg_D I just found a solution and seen you just posted a solution.  I tried yours and it worked.  I went down another path.</p>\n\n<pre><code>Sub Inventory_format()Dim cell As Range\n</code></pre>\n\n<p>For Each cell In Range(\"SeqInv\")</p>\n\n<p>'compair inventory to qtyneeded\n'inventory *90% is less than what is required than warning by highlighting in red\n'using the named range low_limit so can be changed in the gen setpoints worksheet</p>\n\n<p>If cell.Value * (1 - Range(\"Low_limit\")) &lt; cell.Offset(-1, 0) Then</p>\n\n<p>cell.Interior.Color = VBA.ColorConstants.vbRed</p>\n\n<p>'inventory *70% is less than what is required than warning by yellow</p>\n\n<p>ElseIf cell.Value * (1 - Range(\"High_limit\")) &lt; cell.Offset(-1, 0) Then\ncell.Interior.Color = VBA.ColorConstants.vbYellow\nElse\ncell.Interior.Color = VBA.ColorConstants.vbWhite\nEnd If\nNext cell</p>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 3, "user_id": 11233713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0eac897ab587f7790be343a8928cea9?s=128&d=identicon&r=PG&f=1", "display_name": "user11233713", "link": "https://stackoverflow.com/users/11233713/user11233713"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 55269446, "answer_count": 2, "score": -2, "last_activity_date": 1553201444, "creation_date": 1553107130, "last_edit_date": 1553134825, "question_id": 55267985, "link": "https://stackoverflow.com/questions/55267985/change-format-of-a-row-of-cells-based-on-comparing-each-cell-in-2-rows", "title": "Change format of a row of cells based on comparing each cell in 2 rows", "body": "<p>In excel 2016 I am using a query to gather data.  In this data both the current inventory and the amount needed for the next 2 days of production.  I want to highlight when the inventory is less than the amount needed.  When I use conditional formatting it looks good initially but then when I update with more data the range of the Conditional format is compromised.  What would be a good way to do this using VBA?</p>\n\n<p><a href=\"https://i.stack.imgur.com/HPb1C.png\" rel=\"nofollow noreferrer\">sample data</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Sv1Et.png\" rel=\"nofollow noreferrer\">here is conditional format formula </a></p>\n\n<p><a href=\"https://i.stack.imgur.com/TDECn.png\" rel=\"nofollow noreferrer\">Conditional Format changing</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1553106908, "post_id": 55267389, "comment_id": 97266943, "body": "Are the ranges you&#39;re calculating always 14 cells?"}, {"owner": {"reputation": 23, "user_id": 8529900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/511fe396245686db26d1d72159fd8595?s=128&d=identicon&r=PG&f=1", "display_name": "Aprnaa", "link": "https://stackoverflow.com/users/8529900/aprnaa"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553139602, "post_id": 55267389, "comment_id": 97277771, "body": "@SJR yes..I will always be calculating variance of 14 cells"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8529900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/511fe396245686db26d1d72159fd8595?s=128&d=identicon&r=PG&f=1", "display_name": "Aprnaa", "link": "https://stackoverflow.com/users/8529900/aprnaa"}, "edited": false, "score": 0, "creation_date": 1553144702, "post_id": 55268204, "comment_id": 97278778, "body": "In the code, lc, lr and ns pertains to sheet1 and sheet2 has different number of rows than sheet1. So the for loop is ideal for computing variance but not for pasting. So I would have to replace &#39;i&#39; in sheets(2).cells(i,j).value with another variable. How do I do that?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 23, "user_id": 8529900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/511fe396245686db26d1d72159fd8595?s=128&d=identicon&r=PG&f=1", "display_name": "Aprnaa", "link": "https://stackoverflow.com/users/8529900/aprnaa"}, "edited": false, "score": 0, "creation_date": 1553188563, "post_id": 55268204, "comment_id": 97301632, "body": "@Aprnaa for sheet 2, do you only have as many rows as you have sets of variances?  that&#39;s how i was treating sheet 2, which is why you have ns (number of sets)  being the maximum, starting in row 3 (just realized i need &quot;ns+3&quot; as the maximum for i.  the use of lr (last row on sheet 1) would be used to find ns, which would dictate the use of rows on sheet 1 up and until the last row."}, {"owner": {"reputation": 23, "user_id": 8529900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/511fe396245686db26d1d72159fd8595?s=128&d=identicon&r=PG&f=1", "display_name": "Aprnaa", "link": "https://stackoverflow.com/users/8529900/aprnaa"}, "edited": false, "score": 0, "creation_date": 1553769230, "post_id": 55268204, "comment_id": 97511057, "body": "Sorry for the late reply. Haven&#39;t tried the edited code but it makes sense. Will let you know the result soon."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1553188599, "last_edit_date": 1553188599, "creation_date": 1553108011, "answer_id": 55268204, "question_id": 55267389, "link": "https://stackoverflow.com/questions/55267389/increment-rows-and-columns-to-find-variance-and-paste-values-in-excel-vba/55268204#55268204", "title": "Increment rows and columns to find variance and paste values in Excel VBA", "body": "<p>I believe you want to figure out a separate number than your current i for rows... you will need to find the number of varp sets to iterate through, similar to (untested):</p>\n\n<pre><code>dim lr as long, lc as long, i as long, j as long, k as long, ns as long\nwith sheets(1)\n    lc = .cells(1,.columns.count).end(xltoleft).column\n    lr = .cells(.rows.count,1).end(xlup).row\n    ns = application.rounddown(lr/14.01) 'uses 14.01 to divide so you start the 15th row on a separate set\n    for j = 3 to lc -2 step -2\n        for i = 3 to ns+3 'just added the plus 3 as edit1\n            k = i*14+3  'starts on row 3\n            sheets(2).cells(i,j).value = varp(.range(.cells(k,j),.cells(k+13,j))\n        next i\n    next j\nend with\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8529900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/511fe396245686db26d1d72159fd8595?s=128&d=identicon&r=PG&f=1", "display_name": "Aprnaa", "link": "https://stackoverflow.com/users/8529900/aprnaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553188599, "creation_date": 1553104813, "last_edit_date": 1553134759, "question_id": 55267389, "link": "https://stackoverflow.com/questions/55267389/increment-rows-and-columns-to-find-variance-and-paste-values-in-excel-vba", "title": "Increment rows and columns to find variance and paste values in Excel VBA", "body": "<p>I have two worksheets. Sheet1 contains data in B3:W296 and Sheet2 contains data in alternate columns B3:B23, D3:D23,..,T3:T23. Now I am supposed to fill up the empty alternate columns in Sheet2(C3:C23, E3:E23,..,U3:U23) </p>\n\n<p>Sheet2 values are supposed to be filled like,</p>\n\n<p>Sheet2.C3.value = VARP(\"Sheet1\".Range(C3:C16))\n...</p>\n\n<p>Sheet2.U3.value = VARP(\"Sheet1\".Range(U3:U16))</p>\n\n<p>For the row4 in Sheet2, the formula should be changed like,</p>\n\n<p>Sheet2.C4.value = VARP(\"Sheet1\".Range(C17:C30))\n...</p>\n\n<p>Sheet2.U4.value = VARP(\"Sheet1\".Range(U17:U30))</p>\n\n<p>I have to do this in different files, so the number of rows and columns in both the sheets might vary. So I can't give the row and column numbers explicitly.</p>\n\n<p>I have started writing the following code but I am stuck,</p>\n\n<pre><code>Dim lRow, lRow2 As Long\nDim lCol, lCol2 As Long\nDim i, j As Integer\n\nlRow = ThisWorkbook.Worksheets(\"Sheet2\").Cells.Find(What:=\"*\", After:=Range(\"A1\"), LookAt:=xlPart, _\nLookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\nlCol = ThisWorkbook.Worksheets(\"Sheet2\").Cells.Find(What:=\"*\", After:=Range(\"A1\"), LookAt:=xlPart, _\nLookIn:=xlFormulas, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False).Column\nlRow2 = ThisWorkbook.Worksheets(\"Sheet1\").Cells.Find(What:=\"*\", After:=Range(\"A1\"), LookAt:=xlPart, _\nLookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\nlCol2 = ThisWorkbook.Worksheets(\"Sheet1\").Cells.Find(What:=\"*\", After:=Range(\"A1\"), LookAt:=xlPart, _\nLookIn:=xlFormulas, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False).Column\n\nFor i = 3 To lRow\n    For j = 3 To lCol - 2 Step 2\n            ThisWorkbook.Worksheets(\"Sheet2\").Range(j &amp; i).Value = VarP(ThisWorkbook.Worksheets(\"Sheet1\").Range())\n    Next j\nNext i\n</code></pre>\n\n<p>I am not sure how to proceed with the for loop for this case.</p>\n\n<p>Any help would be appreciated greatly. Thanks in advance. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1553103343, "post_id": 55266922, "comment_id": 97265181, "body": "Use a decision &quot;throw&quot; of the randowmizer to decide for white, e.g. <code>If ((Int(Rnd()) Mod 3) &lt;&gt; 0) Then color= White</code> gives 30% chance of white."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553106468, "post_id": 55266922, "comment_id": 97266732, "body": "@PaulOgilvie - using this example, the chance for White is exactly <code>0.46</code>. Which is <code>0.3+1&#47;6</code>. This is because in the other cases the white still has 1/6 chance."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1553106567, "post_id": 55266922, "comment_id": 97266775, "body": "<code>Int(Rnd() * 5) + 2</code> gives random between <code>[2,3,4,5,6,7]</code>."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1553106679, "post_id": 55266922, "comment_id": 97266827, "body": "This depends on how often you want each color to appear. You could create an array of color integers and fill the array proportionately. Then select a random number from the size of the array, round it to an integer, and pull that value out of the array."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1553107251, "post_id": 55266922, "comment_id": 97267164, "body": "Actually <code>0.47</code>, not <code>0.46</code> :)"}, {"owner": {"reputation": 67, "user_id": 10691328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0dbe62f08c0d2aa931deff603948fe?s=128&d=identicon&r=PG&f=1", "display_name": "silentwraith", "link": "https://stackoverflow.com/users/10691328/silentwraith"}, "edited": false, "score": 1, "creation_date": 1553141092, "post_id": 55266922, "comment_id": 97278039, "body": "@Viyata <code>Int(Rnd() * 5) + 2</code> doesn&#39;t this give a random number between 2 and 6? Since Rnd() function returns [0,1). Which, in turn, makes a total of 5 total chances."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1553181276, "post_id": 55266922, "comment_id": 97297140, "body": "@silentwraith - <b>no</b>. Run it about 50 times, you would see the <code>[2,7]</code>. Or copy+paste my code, it runs 1 million times, but you should wait about 10 seconds."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1553106375, "last_edit_date": 1553106375, "creation_date": 1553104250, "answer_id": 55267216, "question_id": 55266922, "link": "https://stackoverflow.com/questions/55266922/generating-random-colors-with-a-bias-to-one-color-using-excel-vba/55267216#55267216", "title": "Generating random colors with a bias to one color using Excel VBA", "body": "<p>It is a probably a good idea to separate the randomization logic and the logic, which forces a given color to be created more often. E.g., this one works quite ok, giving equal chances to each number:</p>\n\n<pre><code>randomColor = CLng(rnd() * 5) + 2\n</code></pre>\n\n<p>However, once you obtain the randomColor, it could be changed based on some percentage, named <code>priorityPercentage</code> in the function:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim counter As Long\n    Dim randomColor As Long\n\n    With Worksheets(1)\n        .Cells.Clear\n        For counter = 1 To 1000000\n            randomColor = CLng(rnd() * 5) + 2\n            .Cells(counter, 1) = GenerateColor(randomColor, 2, (0.4 - 0.4 * 1 / 6))\n        Next\n        .Cells(1, 2).Formula = \"=COUNTIF(A:A,2)\"\n    End With\n\nEnd Sub\n\nPublic Function GenerateColor(randomColor As Long, _\n                    priorityColor As Long, _\n                    priorityPercentage As Double) As Long\n\n\n    If rnd() &lt;= priorityPercentage Then\n        GenerateColor = priorityColor\n        Exit Function\n    End If        \n    GenerateColor = CLng(rnd() * 5) + 2\n\nEnd Function\n</code></pre>\n\n<p>This example runs 1 million times and it writes in <code>B2</code> the count of the <code>2</code>. The reason to pass <code>0.4 - 0.4 * 1.6</code> in the parameter, is to make sure, that the chance for <code>2</code> is exactly 40%. We have 1/6 for each of the possible 6 numbers - <code>[2,3,4,5,6,7]</code>. Thus, the times when we do not enter in <code>If rnd() &lt;= priorityPercentage</code> are also taken into account.</p>\n"}], "owner": {"reputation": 67, "user_id": 10691328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0dbe62f08c0d2aa931deff603948fe?s=128&d=identicon&r=PG&f=1", "display_name": "silentwraith", "link": "https://stackoverflow.com/users/10691328/silentwraith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 55267216, "answer_count": 1, "score": 2, "last_activity_date": 1553106375, "creation_date": 1553103117, "last_edit_date": 1553103754, "question_id": 55266922, "link": "https://stackoverflow.com/questions/55266922/generating-random-colors-with-a-bias-to-one-color-using-excel-vba", "title": "Generating random colors with a bias to one color using Excel VBA", "body": "<p>I am trying to generate random colors (2,6) using the following code below; however, my end goal is to generate white color (2) more than the rest of the colors. Would appreciate if someone could help. Thank you.</p>\n\n<pre><code>GenerateColor = Int(Rnd() * 5) + 2\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1553115735, "post_id": 55266884, "comment_id": 97271395, "body": "Maybe because I&#39;m a newbie but I tried to incorporate your code and couldn&#39;t figure out exactly how to apply it effectively. I ended up creating a new sheet then creating a fake table on it then pasted my data there. Thanks for the help."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1553119494, "post_id": 55266884, "comment_id": 97272889, "body": "@Craig - copy and paste my code completely did not work?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1553102979, "creation_date": 1553102979, "answer_id": 55266884, "question_id": 55266716, "link": "https://stackoverflow.com/questions/55266716/attempt-to-create-table-gives-error-1004-after-copy-and-paste/55266884#55266884", "title": "Attempt to create table gives error 1004 after copy and paste", "body": "<p>I am guessing, that the problem is that the table already exists, thus, it is not ok to make a new one. Try this piece of code, changing \"Table1\" to the name of your table:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim newTable As Object\n    Dim someRange As Range\n\n    With ThisWorkbook.Worksheets(1)\n        Set someRange = .Range(\"A1:F\" &amp; 10)\n        If Not TableExists(\"Table1\", .Cells.Parent) Then\n            Set newTable = .ListObjects.Add(xlSrcRange, someRange, , xlYes)\n        End If\n    End With\n\nEnd Sub\n\nPublic Function TableExists(tableName As String, ws As Worksheet) As Boolean\n\n    On Error GoTo TableExists_Error\n    If ws.ListObjects(tableName).Name = vbNullString Then\n    End If\n    TableExists = True\n\n    On Error GoTo 0\n    Exit Function\n\nTableExists_Error:\n    TableExists = False\n\nEnd Function\n</code></pre>\n\n<p>Or simply open a new Excel file and run it. The <code>A1:F10</code> range would be formatted. </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/38097134/vba-excel-check-if-a-particular-table-exist-using-table-name\">VBA Excel check if a particular table exist using table name</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "is_accepted": false, "score": 0, "last_activity_date": 1553115659, "creation_date": 1553115659, "answer_id": 55270116, "question_id": 55266716, "link": "https://stackoverflow.com/questions/55266716/attempt-to-create-table-gives-error-1004-after-copy-and-paste/55270116#55270116", "title": "Attempt to create table gives error 1004 after copy and paste", "body": "<p>To make this work I had to create a fake, blank table as soon as the sheet was created then paste the data over to it.</p>\n"}], "owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553115659, "creation_date": 1553102423, "last_edit_date": 1553103406, "question_id": 55266716, "link": "https://stackoverflow.com/questions/55266716/attempt-to-create-table-gives-error-1004-after-copy-and-paste", "title": "Attempt to create table gives error 1004 after copy and paste", "body": "<p>I have a workbook (A) that pulls up another (B), copies values from wb B and pastes values to wb A (no table, no formulas; just data).</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A1:F\" &amp; lonTempWBLastRow).Copy shtNewMonth.Range(\"A1\") \n</code></pre>\n\n<p>I then attempt to create a table with:</p>\n\n<pre><code>Set NewMonthTable = wbPDRC.ListObjects.Add(xlSrcRange, Range(\"A1:F\" &amp; lonTempWBLastRow), , xlYes)\n</code></pre>\n\n<p>but get error 1004: a table cannot overlap a range that contains a PivotTable, query results, protected cells, or another table. I delete the named range from the sheet so it's not a named range issue. There's no Pivot, query results, protected cells, or table. I even tried to run a loop on unlisting all tables from the sheet but the loop immediately exits as it doesn't see a table on the sheet. I also attempted to run the table code first on wb B then transfer it as a table VS values but I get the same error on that sheet when attempting this way. If I try to make the table in Excel without VBA, the Format As Table dialog box stays put after hitting \"OK\" a number of times. There is a connection in wb B which I delete via code prior to transferring the data and have verified once it pastes to wb A that the connection is not there. Ideas?</p>\n"}, {"tags": ["excel", "vba", "method-call"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1553102326, "post_id": 55266228, "comment_id": 97264635, "body": "<code>Call</code> needs a function that is known at compile time. <code>Application.Run</code> takes a string argument identifying the function by name."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1553192716, "post_id": 55266228, "comment_id": 97303653, "body": "<code>Call</code> is deprecated. No need to use it."}], "answers": [{"comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1553101292, "post_id": 55266334, "comment_id": 97263987, "body": "Yeah I was dumming down the names, but running them through an array would cut down on the guff in the code too"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1553101539, "post_id": 55266334, "comment_id": 97264144, "body": "I will never get the idea why subroutines should have names like <code>sub1</code>... And you move the check if a Subroutine exists from compile time to runtime."}, {"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1553101732, "post_id": 55266334, "comment_id": 97264253, "body": "I didn&#39;t know you could use the call function with strings.... I thought the whole purpose of the <code>application.run</code> was to be able to pass the sub as a string.  I will have to test out how you do it."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1553102009, "post_id": 55266334, "comment_id": 97264431, "body": "I posted an answer without reading this so deleted and am just backing it up. <code>Application.Run(x)</code>, where x can be a <code>vbaproject.method</code> path, handles calling where the routine to be run is decided later, during the code runtime. E.g. I could have three buttons that pass a different string each, to a method which has <code>Application.Run(string)</code>... whereas <code>Call Sub1</code> is just plain hard-coded"}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": false, "score": 5, "last_activity_date": 1553101197, "creation_date": 1553101197, "answer_id": 55266334, "question_id": 55266228, "link": "https://stackoverflow.com/questions/55266228/difference-between-calling-a-sub-and-application-run/55266334#55266334", "title": "Difference between Calling a Sub and Application.Run", "body": "<p>You can pass parameters through application.run as well.  I use it when I am looping through macros. in your above example instead of having to write this:</p>\n\n<pre><code>Sub button()\n  Call sub1()\n  Call sub2()\n  Call sub3()\n  Call sub4()\nEnd Sub\n</code></pre>\n\n<p>you could write this:</p>\n\n<pre><code>for i = 1 to 4\n  application.run(\"sub\" &amp; i)\nnext i\n</code></pre>\n\n<p>if the subs took in a str parameter you could do this:</p>\n\n<pre><code>for i = 1 to 4\n  application.run(\"sub\" &amp; i, strVariable)\nnext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 1, "creation_date": 1553102611, "post_id": 55266713, "comment_id": 97264788, "body": "Great answer! A good use of <code>Application.Run()</code>. What if your general approach was that all <code>Sub</code>s are public? Based on the only users touching Macros being the creators"}, {"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "reply_to_user": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1553107787, "post_id": 55266713, "comment_id": 97267438, "body": "Call would probably be the best since your not making VBA evaluate strings. You can find a decent amount of info on this through google"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1553192817, "post_id": 55266713, "comment_id": 97303697, "body": "<code>Call</code> is deprecated. Should not be using that word. just use <code>priv()</code>."}, {"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 2, "creation_date": 1553193949, "post_id": 55266713, "comment_id": 97304235, "body": "@AJD @Badja yes you can avoid using <code>Call</code> but since OP mentioned that he is looking to make his code readable, it does aid in that endeavor. Omission could cause some confusion for those inexperienced in VBA"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1553194433, "post_id": 55266713, "comment_id": 97304484, "body": "@Dude_Scott - use of <code>Call</code> highlights someone who is either inexperienced in VBA (just copying code without knowing what it does) or is stuck in the past and not kept up. In terms of &quot;making code readable&quot;, that is what sensible function/subroutine names are for. <code>Call</code> does absolutely nothing in those terms - and is deprecated. In other words, in any future release of the VBA engine, support for that term could just disappear."}], "tags": [], "owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "is_accepted": true, "score": 2, "last_activity_date": 1553102657, "last_edit_date": 1553102657, "creation_date": 1553102418, "answer_id": 55266713, "question_id": 55266228, "link": "https://stackoverflow.com/questions/55266228/difference-between-calling-a-sub-and-application-run/55266713#55266713", "title": "Difference between Calling a Sub and Application.Run", "body": "<p>I use <code>Application.Run</code> if I\u2019m trying to run a sub that is private in another module. If I have a some kind of template where I want to hide the macros from the users I will declare it as private so they can\u2019t run/see the macro from there macros dialog box. </p>\n\n<p>In module1 I have </p>\n\n<pre><code>Private Sub priv()\n  MsgBox \u201cPrivate\u201d\nEnd Suv\n</code></pre>\n\n<p>In module2 the below will give you a <code>Sub or Function not defined</code> error. </p>\n\n<pre><code>Sub callPriv()\n  Call priv()\nEnd Sub\n</code></pre>\n\n<p>But in module2 this will run and display the message box</p>\n\n<pre><code>Sub callPriv()\n  Application.Run \u201cpriv\u201d\nEnd Sub\n</code></pre>\n\n<p>It\u2019s also useful to use Application.Run if you are calling a sub in your sheet or thisWorkbook modules. </p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "is_accepted": false, "score": 0, "last_activity_date": 1579431988, "last_edit_date": 1579431988, "creation_date": 1579431517, "answer_id": 59809370, "question_id": 55266228, "link": "https://stackoverflow.com/questions/55266228/difference-between-calling-a-sub-and-application-run/59809370#59809370", "title": "Difference between Calling a Sub and Application.Run", "body": "<p>I am posting some of this as an  answer, because I cannot comment.</p>\n\n<p>@ Badja : You said \u2026.\u201d <em>I understand that if your sub has no arguments, then Application.Run has a use \u2013</em> \u2026\u201d  I am not sure if you are possibly implying that Application Run can have no arguments?  - That is not the case. In principal , you can use arguments with Application.Run just as you can with Call. The syntax and general working of it can be a bit more difficult  to understand than with Call. I agree with you , that documentation on Application.Run is very sparse. </p>\n\n<p>@Hasib_Ibradzic : I was not aware that you can use the Call function with strings. ??\nAs far as I know, it is one of the advantages of Application.Run over using Call, that the macro name part of the argument is taken as a sting, so that you can build that string up with variables. So you are not limited to hard coding, as I think is the case with  using Call</p>\n\n<p>@Dude_Scott : In your example, I think it is advisable to suggest/ note  that including the module code name could be  advisable. Without this, you could experience problems if you had Sub routines with the same name in different modules.\nIn your example, this could be advisable to do </p>\n\n<pre><code>Sub callPriv()\n  Application.Run \"Module1.priv\"\nEnd Sub \n</code></pre>\n\n<p>_._____________</p>\n\n<p><strong>Some other things that might be useful to Note:</strong></p>\n\n<p>If you have a macro in another module which is Public, then you can Call it from another module</p>\n\n<p>For example. In my ( German ) Excel I have in my first normal module , code name <code>Modul1</code> , ( In English Excel, I think that would typically be by default <code>Module1</code> ), this</p>\n\n<pre><code>Public Sub PbicModule1() '\n MsgBox \"Pubic Modul1\"\nEnd Sub\n</code></pre>\n\n<p>And in my first worksheet class code module, code name <code>Tabelle1</code> ( In English Excel I think that would typically be by default <code>Sheet1</code> ) ,  I have this</p>\n\n<pre><code>Public Sub PbicTabelle1() '\n MsgBox \"Pubic Tabelle1\"\nEnd Sub\n</code></pre>\n\n<p>And in my ThisWorkbook class  code , code name <code>DieseArbeitsmappe</code> ( In English Excel , I think that would typically be by default <code>ThisWorkbook</code> ), I have this</p>\n\n<pre><code>Public Sub PbicThisWorkbook() '\n MsgBox \"Pubic ThisWorkbook\"\nEnd Sub\n</code></pre>\n\n<p>The following macro will work when it is in  any module</p>\n\n<pre><code>Private Sub CallMePubics()   '    https://stackoverflow.com/questions/55266228/difference-between-calling-a-sub-and-application-run\n Call Modul1.PbicModule1\n Call Tabelle1.PbicTabelle1\n Call DieseArbeitsmappe.PbicThisWorkbook\nEnd Sub\n</code></pre>\n\n<p>That last macro would fail if the called macros were Private. </p>\n\n<p>This following  macro equivalent using  Application.Run , would work regardless of whether the called macros were Public or Private</p>\n\n<pre><code>Private Sub AppRunMePubics()\n Application.Run Macro:=\"Modul1.PbicModule1\"\n Application.Run Macro:=\"Tabelle1.PbicTabelle1\"\n Application.Run Macro:=\"DieseArbeitsmappe.PbicThisWorkbook\"\nEnd Sub\n</code></pre>\n\n<p>So , the conclusion from that is adding slightly to  what Dude_Scott said:\nApplication.Run allows you to run,  from anywhere,  both  Private subs and Public subs that are  anywhere. \nCall only allows you to run from anywhere, Public subs that are anywhere </p>\n\n<pre><code>Ref:\nhttps://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime\nhttp://excelmatters.com/2017/04/07/passing-arguments-byref-using-run/\nExample Workbook with my coding: MainFile.xls :  https://app.box.com/s/prqhroiqcb0qccewz5si0h5kslsw5i5h \nhttp://www.tushar-mehta.com/publish_train/xl_vba_cases/1022_ByRef_Argument_with_the_Application_Run_method.shtml\n</code></pre>\n"}], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12036, "favorite_count": 0, "accepted_answer_id": 55266713, "answer_count": 3, "score": 3, "last_activity_date": 1579431988, "creation_date": 1553100910, "question_id": 55266228, "link": "https://stackoverflow.com/questions/55266228/difference-between-calling-a-sub-and-application-run", "title": "Difference between Calling a Sub and Application.Run", "body": "<p>In my business, we have a few teams that work on very simple macros. I'm trying to make them all readable to each other and in somewhat of a similar format, so new joiners can start working on the data.</p>\n\n<p>I mention simple macros, because no one will be using Subs with arguments - most are derived from Macro Recorder anyway</p>\n\n<p>Half of the teams use:</p>\n\n<pre><code>Sub button()\n\nCall sub1()\nCall sub2()\nCall sub3()\nCall sub4()\n\nEnd Sub\n</code></pre>\n\n<p>And the other half use </p>\n\n<pre><code>Sub button()\n\nApplication.Run(\"sub1\")\nApplication.Run(\"sub2\")    \nApplication.Run(\"sub3\")    \nApplication.Run(\"sub4\")\n\nEnd Sub\n</code></pre>\n\n<p>I understand that if your sub has no arguments, then Application.Run has a use - but being as there's barely any notation on it - is there a reason people still use <code>Application.Run(\"\")</code>?</p>\n\n<p>Can every use of it be beaten in speed and process by <code>Call</code>?</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "sumproduct"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1553101408, "post_id": 55266029, "comment_id": 97264066, "body": "Just one remark (not related to your problem): If writing a formula in VBA, use <code>Cell.Formula = ...</code>, not <code>Cell.Value = ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9725293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c4eeb3502516fc31a1bd1bcfeb7d3e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9725293/andrew"}, "edited": false, "score": 0, "creation_date": 1553523633, "post_id": 55266274, "comment_id": 97404876, "body": "I ended up going with this instead of losing my mind over making evaluate work."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1553101042, "creation_date": 1553101042, "answer_id": 55266274, "question_id": 55266029, "link": "https://stackoverflow.com/questions/55266029/value-evaluatesumproduct-returning-value-but-value-sumproduct-work/55266274#55266274", "title": ".Value = Evaluate(&quot;SUMPRODUCT&quot;) returning #VALUE but .Value = &quot;=SUMPRODUCT&quot; works correctly?", "body": "<p>Not addressing your question about Evaluate, but you can still use an in-cell formula and then replace the formula with the result </p>\n\n<pre><code>With Cell\n   .Formula = \"=SUMPRODUCT((data!...  etc etc\"\n   DoEvents\n   .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9725293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c4eeb3502516fc31a1bd1bcfeb7d3e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9725293/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 55266274, "answer_count": 1, "score": 0, "last_activity_date": 1553101042, "creation_date": 1553100294, "last_edit_date": 1553100389, "question_id": 55266029, "link": "https://stackoverflow.com/questions/55266029/value-evaluatesumproduct-returning-value-but-value-sumproduct-work", "title": ".Value = Evaluate(&quot;SUMPRODUCT&quot;) returning #VALUE but .Value = &quot;=SUMPRODUCT&quot; works correctly?", "body": "<p>I've got a script that generates reports from a data set. The data set relates to a customer support log of tickets/tracking numbers, with basic ticket info such as when the ticket was opened, who the ticket was assigned to and what the main issue/workload was. My goal is to create a report that already exists but is completed manually with pivot tables (that almost nobody knows how to use) and avoids using formulas.</p>\n\n<p>The basic report is how many of each workload was completed by each employee per month. Easily doable with a pivot table, except most people don't know how. This excel formula gets what I want for January, <code>=SUMPRODUCT((data!Column1=\"Employee1\")*(data!Column2=\"Workload A\")*(data!Column3&gt;=DATEVALUE(\"2019-1\"))*(data!Column3&lt;DATEVALUE(\"2019-2\")))</code>. The drawback of the data is that the dates are date values that are formatted as short dates. The solution I have in VBA:</p>\n\n<pre><code>Cell.Value = \"=SUMPRODUCT((data!\" &amp; AssigneeCol.Address &amp; \"=\"\"\" &amp; Assignee.Value &amp; \"\"\")*(data!\" &amp; WorkloadCol.Address &amp; \"=\"\"\" &amp; Workload.Value &amp; \"\"\")*(data!\" &amp; DateCol.Address &amp; \"&gt;=DATEVALUE(\"\"\" &amp; Worksheet.Name &amp; \"\"\"))*(data!\" &amp; DateCol.Address &amp; \"&lt;DATEVALUE(\"\"\" &amp; Year &amp; Month2 &amp; \"\"\")))\"\n</code></pre>\n\n<p>This leaves a gigantic formula in excel which is referenced to the <code>data</code> worksheet which will not be included in the report (though I suppose it could be hidden). I'd prefer to use values to make the sheet easier to handle by management. I tried using Evaluate, but it makes the cell value <code>#VALUE!</code></p>\n\n<pre><code>CheckCell.Value = Evaluate(\"=SUMPRODUCT((data!\" &amp; AssigneeCol.Address &amp; \"=\"\"\" &amp; Assignee.Value &amp; \"\"\")*(data!\" &amp; WorkloadCol.Address &amp; \"=\"\"\" &amp; Workload.Value &amp; \"\"\")*(data!\" &amp; DateCol.Address &amp; \"&gt;=DATEVALUE(\"\"\" &amp; Worksheet.Name &amp; \"\"\"))*(data!\" &amp; DateCol.Address &amp; \"&lt;DATEVALUE(\"\"\" &amp; Year &amp; Month2 &amp; \"\"\")))\")\n</code></pre>\n\n<p>Is this because of an inherent limitation with Evaluate(), ie: <code>DATEVALUE</code> within <code>SUMPRODUCT</code>? As far as I can tell it should work, but I have no idea.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553104579, "post_id": 55265953, "comment_id": 97265826, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17868484/assign-a-stored-procedure-return-value-to-a-vba-variable\">Assign a stored procedure return value to a VBA variable</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553108553, "post_id": 55265953, "comment_id": 97267792, "body": "@June7 That doesn&#39;t answer how to do it asynchronously. Returning a value from an asynchronously ran stored procedure is substantially more complicated."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1553111161, "post_id": 55265953, "comment_id": 97269099, "body": "More complicated or impossible. Only thing I can find involves Android <a href=\"https://stackoverflow.com/questions/15739635/how-to-return-value-from-async-task-in-android\" title=\"how to return value from async task in android\">stackoverflow.com/questions/15739635/&hellip;</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1553112247, "post_id": 55265953, "comment_id": 97269633, "body": "Certainly not impossible. Returning values from asynchronously called procedures can be kind-of trivial, that&#39;s probably why there aren&#39;t a lot of answers about them, but VBA doesn&#39;t really do asynchronous stuff so not that much info on it here either. I&#39;ll see if I have the time to write up and test an answer later"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1553114022, "post_id": 55265953, "comment_id": 97270522, "body": "I&#39;ve managed a small cheat to this problem.  The SP creates a temporary file on the FTP site that gets removed JUST before the SP completes.  I am testing for the presence of the Temp file - when I find it missing, I consider the SP complete.  Not ideal, but seems reliable via testing so far, large and small files."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1553114604, "post_id": 55265953, "comment_id": 97270851, "body": "@MarkPelletier That seems like a pretty horrible workaround. I&#39;ve shared an answer."}], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1553117304, "post_id": 55269838, "comment_id": 97272094, "body": "Eric, thanks for this outline.  I&#39;m not clear on the last &quot;separate function&quot; piece.  This is external to the function that calls the SP in the first place, correct?  I&#39;m not sure how the 2nd function would have those variables in-scope."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1553150205, "post_id": 55269838, "comment_id": 97280208, "body": "Yup, globals are required to persist the command after the function ends. Did this work?"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1553115231, "last_edit_date": 1553115231, "creation_date": 1553114553, "answer_id": 55269838, "question_id": 55265953, "link": "https://stackoverflow.com/questions/55265953/msaccess-run-stored-proc-asynchronously-w-return-syntax/55269838#55269838", "title": "MSAccess: Run Stored Proc Asynchronously w/Return - Syntax?", "body": "<p>Depending on your exact config, you can return parameters quite easily.</p>\n\n<p>Assume you have the following SP:</p>\n\n<pre><code>CREATE PROCEDURE TestSP \n    @Param1 INT OUT\nAS\n    WAITFOR DELAY '00:00:03';\n    SET @Param1 = 5;\n</code></pre>\n\n<p>Then, declare globally in your module:</p>\n\n<pre><code>Dim conn As ADODB.Connection\nDim cmd As ADODB.Command\n</code></pre>\n\n<p>And then, in your function:</p>\n\n<pre><code>Set cnn = New ADODB.Connection\ncnn.Open = \"Some connectionstring\"\nSet cmd = New ADODB.Command\ncmd.CommandType = adCmdStoredProc\ncmd.CommandText = \"TestSP\"\nDim p As ADODB.Parameter\nSet p = cmd.CreateParameter(\"@Param1\", adInteger, adParamOutput, 8)\ncmd.Parameters.Append p\nSet cmd.ActiveConnection = conn\ncmd.Execute Options:=adAsyncExecute\n</code></pre>\n\n<p>Then, in a separate function, test if the command is done and if so return the value</p>\n\n<pre><code>If cmd.State &lt;&gt; adStateExecuting Then\n      returnValue = cmd.Parameters(\"@Param1\").Value 'Returns 5 when done\nEnd If\n'Because of the global scope, cleanup is required\nconn.Close\nSet conn = Nothing\nSet cmd = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553115231, "creation_date": 1553100045, "question_id": 55265953, "link": "https://stackoverflow.com/questions/55265953/msaccess-run-stored-proc-asynchronously-w-return-syntax", "title": "MSAccess: Run Stored Proc Asynchronously w/Return - Syntax?", "body": "<p>I have had good success in past running single threaded SPs, waiting for a \"0\" or \"-1\" reply to indicate success, using:</p>\n\n<pre><code>Set cnn = New ADODB.Connection\ncnn.CursorLocation = adUseClient\ncnn.ConnectionString = \"driver={SQL Server};server=\" &amp; TempVars!my_ip &amp; \";Trusted_Connection=no;Database=\" &amp; TempVars!my_Database &amp; \";UID=username;PWD=password\"\ncnn.CommandTimeout = 0\ncnn.Open\n\nstrSQL = \"ExportToCSVZip 'myTable', '\\\\192.168.242.147\\InventoryProcessing\\Exports\\', 'ProdCIVProcess', 'Y';\"\n\nSet rs = cnn.Execute(strSQL)\n\n'SP Result -1 = Success, 0 = Fail\nIf rs.Fields(0) = -1 Then\n    msgbox \"Done\"\nElse\n    msgbox \"Fail\"\nEnd If\n</code></pre>\n\n<p>I can run this asynchronously using:</p>\n\n<pre><code>cnn.Execute strSQL, adExecuteNoRecords, adAsyncExecute\n</code></pre>\n\n<p>But I am unclear the proper syntax in this form to determine the Return flag.  My attempts have returned an 'ordinal' error. </p>\n\n<p>Suggestions?</p>\n"}, {"tags": ["vba", "hp-quality-center", "hp-alm"], "comments": [{"owner": {"reputation": 657, "user_id": 3631077, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/OKf4s.png?s=128&g=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/3631077/gaurav"}, "edited": false, "score": 0, "creation_date": 1559797819, "post_id": 55265091, "comment_id": 99533221, "body": "in hp, comment is not a log field. Its just a simple text where on clicking add comment button, it puts text at the end. If you get comment from that field then you will get all the comments. You mentioned that you need just last comment."}, {"owner": {"reputation": 13, "user_id": 3653638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf3b6da9c3d0e4cc963264e5b1ef571?s=128&d=identicon&r=PG&f=1", "display_name": "Durga_Prasad_Patro", "link": "https://stackoverflow.com/users/3653638/durga-prasad-patro"}, "reply_to_user": {"reputation": 657, "user_id": 3631077, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/OKf4s.png?s=128&g=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/3631077/gaurav"}, "edited": false, "score": 0, "creation_date": 1559901163, "post_id": 55265091, "comment_id": 99572855, "body": "Correct, I get the all the comments and put in Excel. Then I extract the last comment from it. The issue is sometimes I get random html tags instead of the actual comment."}], "owner": {"reputation": 13, "user_id": 3653638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf3b6da9c3d0e4cc963264e5b1ef571?s=128&d=identicon&r=PG&f=1", "display_name": "Durga_Prasad_Patro", "link": "https://stackoverflow.com/users/3653638/durga-prasad-patro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553144680, "creation_date": 1553097395, "last_edit_date": 1553144680, "question_id": 55265091, "link": "https://stackoverflow.com/questions/55265091/ota-defect-comments-field-value-returns-with-html-tag", "title": "OTA-Defect comments field value returns with HTML tag", "body": "<p>I have written a macro to get the last comments of all open defects in HP ALM.It works fine most of the time but sometimes for few specific defects instead of fetching the defect comments, it gets some random HTML tag. I am already using \"TDConnection.IgnoreHtmlFormat=true\" but still facing issue. Kindly help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1553099438, "post_id": 55264999, "comment_id": 97262910, "body": "Where will you put the result? Overwrite, next to or to another worksheet or an array?"}, {"owner": {"reputation": 55, "user_id": 8429894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c4b0deb9ba6c7b2c73f288eb3131be?s=128&d=identicon&r=PG", "display_name": "katipra", "link": "https://stackoverflow.com/users/8429894/katipra"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1553100328, "post_id": 55264999, "comment_id": 97263403, "body": "@VBasic2008 put to new worksheet"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1553105521, "post_id": 55264999, "comment_id": 97266300, "body": "<i>But I am not allowed to use external DB</i> ... Note: with Excel for Windows you can run SQL on workbooks."}, {"owner": {"reputation": 55, "user_id": 8429894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c4b0deb9ba6c7b2c73f288eb3131be?s=128&d=identicon&r=PG", "display_name": "katipra", "link": "https://stackoverflow.com/users/8429894/katipra"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1553107051, "post_id": 55264999, "comment_id": 97267017, "body": "@Parfait Would I be able to do that through VBA ? Because the input file I presented in the above question is the output of a merger of several excel files obtained by using a vba script . So if possible I would like to include the SQL query inside the code"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1553109478, "post_id": 55264999, "comment_id": 97268281, "body": "I&#39;m almost finished, but this bothers me: Why is the result in CD column D,C,C,D when you said that D is for values less than 0. Shouldn&#39;t all values be C?"}, {"owner": {"reputation": 55, "user_id": 8429894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c4b0deb9ba6c7b2c73f288eb3131be?s=128&d=identicon&r=PG", "display_name": "katipra", "link": "https://stackoverflow.com/users/8429894/katipra"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1553114229, "post_id": 55264999, "comment_id": 97270647, "body": "@VBasic2008 I think I didn&#39;t do a good enough job for explaining that part. Its not that if value &gt; 0 then C(for credit) but more like if its C(credit) I convert them to +ve and if its D(debit) I convert them to -ve so that if A has 15|50|C and 5|60|D then net is 50-60= -10 =&gt; A|20|10|D (debit)"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1553103602, "creation_date": 1553103602, "answer_id": 55267059, "question_id": 55264999, "link": "https://stackoverflow.com/questions/55264999/vba-sum-and-group-by-without-using-sql-adodb/55267059#55267059", "title": "vba-sum and group by without using sql-adodb", "body": "<p>Probably something like that:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SpecialSum()\n    Dim wsData As Worksheet\n    Set wsData = ThisWorkbook.Worksheets(\"data\")\n\n    Dim wsOutput As Worksheet\n    Set wsOutput = ThisWorkbook.Worksheets(\"output\")\n\n    Dim AllNames As Variant\n    AllNames = wsData.Range(\"A2\", wsData.Cells(wsData.Rows.Count, \"A\").End(xlUp)).Value\n\n    Dim UniqueNames As Object\n    Set UniqueNames = CreateObject(\"Scripting.Dictionary\")\n\n    Dim iRow As Long\n    For iRow = 1 To UBound(AllNames, 1)\n        If AllNames(iRow, 1) &lt;&gt; \"DGPS\" And AllNames(iRow, 1) &lt;&gt; \"PART\" And AllNames(iRow, 1) &lt;&gt; \"\" Then\n            If Not UniqueNames.Exists(AllNames(iRow, 1)) Then\n                UniqueNames.Add AllNames(iRow, 1), 1\n            End If\n        End If\n    Next iRow\n\n    ReDim AllNames(1 To UniqueNames.Count, 1 To 1) As String\n    iRow = 1\n    Dim Key As Variant\n    For Each Key In UniqueNames.Keys\n        AllNames(iRow, 1) = Key\n        iRow = iRow + 1\n    Next Key\n\n    wsOutput.Rows(1).Value = wsData.Rows(1).Value\n    wsOutput.Range(\"A2\").Resize(RowSize:=UniqueNames.Count).Value = AllNames\n    wsOutput.Range(\"B2\").Resize(RowSize:=UniqueNames.Count).Formula = \"=SUMIF('\" &amp; wsData.Name &amp; \"'!A:A,'\" &amp; wsOutput.Name &amp; \"'!A:A,'\" &amp; wsData.Name &amp; \"'!B:B)\"\n    wsOutput.Range(\"C2\").Resize(RowSize:=UniqueNames.Count).Formula = \"=ABS(SUMIFS('\" &amp; wsData.Name &amp; \"'!C:C,'\" &amp; wsData.Name &amp; \"'!A:A,\"\"=\"\"&amp;A2,'\" &amp; wsData.Name &amp; \"'!D:D,\"\"=C\"\")-SUMIFS(data!C:C,'\" &amp; wsData.Name &amp; \"'!A:A,\"\"=\"\"&amp;A2,'\" &amp; wsData.Name &amp; \"'!D:D,\"\"=D\"\"))\"\n    wsOutput.Range(\"D2\").Resize(RowSize:=UniqueNames.Count).Formula = \"=IF(SUMIFS('\" &amp; wsData.Name &amp; \"'!C:C,'\" &amp; wsData.Name &amp; \"'!A:A,\"\"=\"\"&amp;A2,'\" &amp; wsData.Name &amp; \"'!D:D,\"\"=C\"\")-SUMIFS(data!C:C,'\" &amp; wsData.Name &amp; \"'!A:A,\"\"=\"\"&amp;A2,'\" &amp; wsData.Name &amp; \"'!D:D,\"\"=D\"\")&lt;0,\"\"D\"\", \"\"C\"\")\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1553108905, "creation_date": 1553108905, "answer_id": 55268463, "question_id": 55264999, "link": "https://stackoverflow.com/questions/55264999/vba-sum-and-group-by-without-using-sql-adodb/55268463#55268463", "title": "vba-sum and group by without using sql-adodb", "body": "<p>Consider using SQL if using Excel for Windows. Below shows connection strings with driver using ODBC and provider using OLEDB. However, your current SQL which looks to be Oracle dialect must be translated to the Jet/ACE SQL dialect (very engine of MS Access). Also, below assumes your data maintains headers and begins in top leftmost cell at A1 and blank worksheet named <em>RESULTS</em> for query output.</p>\n\n<p><strong>SQL</strong> <em>(used in VBA string further below, adjust SheetName in <code>FROM</code>)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT agg.[name], \n       agg.sum_count AS [count], \n       agg.sum_net AS [net],\n       IIF(sub.sum_net &gt; 0, 'C', \n           IIF(sub.sum_net &lt; 0, 'D', '0')\n          ) AS [CD]\nFROM\n  (SELECT s.[name], \n          SUM(s.[count]) AS sum_count,\n          SUM(IIF(CD = 'C', ROUND(net,2), ROUND(net,2) * -1)) AS sum_net\n   FROM [SheetName$] s\n   WHERE INSTR(s.[name], 'DGPS') = 0 OR INSTR(s.[name], 'PART') = 0\n   GROUP BY s.[name]\n ) AS agg\n\nORDER BY UCASE(agg.[name]);\n</code></pre>\n\n<p><strong>VBA</strong> <em>(no loops or if logic)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RunSQL() \n   Dim conn As Object, rst As Object \n   Dim strConnection As String, strSQL As String\n   Dim LastRow As Integer\n\n   Set conn = CreateObject(\"ADODB.Connection\") \n   Set rst = CreateObject(\"ADODB.Recordset\")\n\n   ' TWO CONNECTION STRINGS FOR DRIVER OR PROVIDER\n   ' strConnection = \"DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _ \n   '                  &amp; \"DBQ=\" &amp; ThisWorkbook.FullName &amp; \";\" \n   strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" _ \n                    &amp; \"Data Source='\" &amp; ThisWorkbook.FullName &amp; \"';\" _ \n                    &amp; \"Extended Properties=\"\"Excel 12.0;HDR=YES;\"\";\"\n\n   ' OPEN DB CONNECTION \n   conn.Open strConnection\n\n   ' OPEN QUERY RECORDSET \n   strSQL = \"SELECT agg.[name], \" _\n            &amp; \"     agg.sum_count AS [count],  \" _\n            &amp; \"     agg.sum_net AS [net], \" _\n            &amp; \"     IIF(sub.sum_net &gt; 0, 'C',  \" _\n            &amp; \"         IIF(sub.sum_net &lt; 0, 'D', '0')  \" _\n            &amp; \"         ) AS [CD]  \" _\n            &amp; \" FROM  \" _\n            &amp; \"     (SELECT s.[name],  \" _\n            &amp; \"             SUM(s.[count]) AS sum_count,  \" _\n            &amp; \"             SUM(IIF(CD = 'C', ROUND(net,2), ROUND(net,2) * -1)) AS sum_net  \" _\n            &amp; \"      FROM [SheetName$] s  \" _\n            &amp; \"      WHERE INSTR(s.[name], 'DGPS') = 0 OR INSTR(s.[name], 'PART') = 0  \" _\n            &amp; \"      GROUP BY s.[name]  \" _\n            &amp; \"    ) AS agg  \" _\n            &amp; \"   ORDER BY UCASE(agg.[name]);\"\n\n   rst.Open strSQL, conn\n\n   ' COPY DATA TO WORKSHEET \n   Worksheets(\"RESULTS\").Range(\"A2\").CopyFromRecordset rst \n\n   rst.Close: conn.Close\n   Set rst = Nothing: Set conn = Nothing\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553152674, "post_id": 55269161, "comment_id": 97281075, "body": "This should be possible a lot shorter and with a lot less loops. If you could combine some of the loops that would improve your code and make it a lot faster."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 55, "user_id": 8429894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c4b0deb9ba6c7b2c73f288eb3131be?s=128&d=identicon&r=PG", "display_name": "katipra", "link": "https://stackoverflow.com/users/8429894/katipra"}, "edited": false, "score": 0, "creation_date": 1553176258, "post_id": 55269161, "comment_id": 97293706, "body": "@katipra: I&#39;ve edited my answer. Read the text and adjust appropriately."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1553176632, "last_edit_date": 1553176632, "creation_date": 1553111718, "answer_id": 55269161, "question_id": 55264999, "link": "https://stackoverflow.com/questions/55264999/vba-sum-and-group-by-without-using-sql-adodb/55269161#55269161", "title": "vba-sum and group by without using sql-adodb", "body": "<h1>Magic Sort</h1>\n\n<ul>\n<li>The code is written to create the <strong>Target Worksheet</strong> (\"<code>Result</code>\")\nin <code>ThisWorkbook</code> i.e. the workbook that contains this code.</li>\n<li>Carefully adjust the values in the constants (<code>Const</code>) section.</li>\n<li>Added <strong>CSV Enabler</strong>. If you want to copy the data from <code>CSV</code> you\nhave to set <code>cEnableCSV</code> to <code>True</code> and change <code>cCsv</code> to the name of\nthe <strong>open</strong> <code>CSV</code> file including the extension e.g. \"<strong>Sum\nGroup.csv</strong>\".</li>\n<li>If you run into trouble with <code>CSV</code>, check out my post <a href=\"https://stackoverflow.com/questions/54941935/excel-vba-macro-clearcontents-in-column-if-value-smaller-than-10000-open-save-i/54947403#54947403\"><strong>CSV\nNightmare</strong></a>.</li>\n</ul>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub MagicSort()\n\n    ' Note: Do not remove the first comma, because it will include \"\" into\n    ' the array.\n    Const cExceptions As String = \",DGPS,PART\" ' Exception List\n    Const cSheet As String = \"Sheet1\"         ' Source Worksheet Name\n    Const cTarget As String = \"Result\"        ' Target Worksheet Name\n    Const cCols As String = \"A:D\"             ' Source Columns Range Address\n    Const cHeaders As Long = 1                ' Source Header Row Number\n    Const cFcell As String = \"A1\"             ' Target First Cell Address\n    ' CSV\n    Const cCsv As String = \"Sum Group.csv\"    ' Source CSV Name\n    Const cEnableCSV As Boolean = False       ' CSV Enabler, True: enable CSV.\n\n    Dim wsT As Worksheet  ' Target Worksheet\n    Dim rng As Range      ' Init Last Used Cell Range,\n                          ' Init Range\n    Dim dict As Object    ' Source Dictionary\n    Dim key As Variant    ' Dictionary Key\n    Dim vntI As Variant   ' Init Array\n    Dim vntE As Variant   ' Exception Array\n    Dim vntS As Variant   ' Source Array\n    Dim NorI As Long      ' Init Number of Rows\n    Dim Noe As Long       ' Number of Exceptions - 1 (0-based array)\n    Dim NorS As Long      ' Source Number of Rows\n    Dim NorT As Long      ' Target Number of Rows\n    Dim Noc As Long       ' (Init/Source) Number of Columns\n    Dim i As Long         ' Init Row Counter\n    Dim j As Long         ' Column Counter\n    Dim k As Long         ' Source Row Counter\n    Dim m As Long         ' Exception Element Counter\n    Dim currV As Variant  ' Current Value (in 1st, 2nd Column)\n\n    ' Task: Copy all data sorted to Init Array.\n\n    With ThisWorkbook\n        ' Delete Target Worksheet if it exists.\n        Application.DisplayAlerts = False\n        On Error Resume Next\n        .Worksheets(cTarget).Delete\n        On Error GoTo 0\n        Application.DisplayAlerts = True\n        ' Check value of CSVEnabler.\n        If cEnableCSV Then\n            ' Create a copy of Source CSV as Target Worksheet.\n            Windows(cCsv).ActiveSheet.Copy After:=.Worksheets(.Sheets.Count)\n          Else\n            ' Create a copy of Source Worksheet as Target Worksheet.\n            .Worksheets(cSheet).Copy After:=.Worksheets(.Sheets.Count)\n        End If\n        ' Create a reference to Target Worksheet.\n        Set wsT = ActiveSheet\n        ' Rename Target Worksheet.\n        wsT.Name = cTarget\n    End With\n\n    ' In Target Worksheet\n    With wsT.Columns(cCols)\n        ' Calculate and create a reference to Source Last Used Cell Range.\n        Set rng = .Resize(, 1).Find(\"*\", , xlFormulas, , , xlPrevious)\n        ' Calculate and create a reference to Init Range.\n        Set rng = .Rows(cHeaders).Resize(rng.Row - cHeaders + 1)\n        ' Sort Init Range.\n        rng.Sort Key1:=Range(\"A2\"), Order1:=xlAscending, Header:=xlYes\n    End With\n\n    ' Write number of rows in Init Range to Init Number of Rows.\n    NorI = rng.Rows.Count\n    ' Write number of columns in Init Range to Number of Columns.\n    Noc = rng.Columns.Count\n    ' Copy Init Range to Init Array.\n    vntI = rng\n\n    ' Task: Count Source Number of Rows.\n\n    ' Write Exception List to Exception Array.\n    vntE = Split(cExceptions, \",\")\n    ' Write number of elements in Exception Array to Number of Exceptions - 1.\n    Noe = UBound(vntE)\n    ' Loop through rows in 1st column of Init Array.\n    For i = 1 To NorI\n        ' Write current element of Init Array to Current Value.\n        currV = Trim(vntI(i, 1))\n        ' Loop through elements of Exception Array.\n        For m = 0 To Noe\n            ' Check if value of current element in Init Array is different\n            ' than value of current element in Exception Array.\n            If currV = vntE(m) Then Exit For\n        Next\n        ' Check if match was not found.\n        If m = Noe + 1 Then\n            ' Count Source Row.\n            k = k + 1\n        End If\n    Next\n    ' Write current value of Source Row Counter to Source Number of Rows.\n    NorS = k\n\n    ' Task: Write 'cleaned' data to Source Array.\n\n    ' Resize Source Array to Source Number of Rows by Number of Columns.\n    ReDim vntS(1 To NorS, 1 To Noc)\n    ' Reset Source Row Counter\n    k = 0\n    ' Loop through rows of Init Array.\n    For i = 1 To NorI\n        ' Write current element of Init Array to Current Value.\n        currV = Trim(vntI(i, 1))\n        ' Loop through elements of Exception Array.\n        For m = 0 To Noe\n            ' Check if value of current element in Init Array is different\n            ' than value of current element in Exception Array.\n            If currV = vntE(m) Then Exit For\n        Next\n        ' Check if match was not found.\n        If m = Noe + 1 Then\n            ' Count Source Row.\n            k = k + 1\n            ' Loop through columns (of Init/Source Array).\n            For j = 1 To Noc\n                ' Write current value from Init Array to current element\n                ' of Source Array.\n                vntS(k, j) = vntI(i, j)\n            Next\n        End If\n    Next\n    ' Erase not needed arrays.\n    Erase vntI\n    Erase vntE\n\n    ' Task: Perform calculations and write to Target Array.\n\n    For k = 1 To NorS\n        If Trim(vntS(k, 4)) = \"D\" Then vntS(k, 3) = -vntS(k, 3)\n    Next\n\n    ' Create a reference to Source Dictionary.\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n   ' Loop through elements (rows) of Source Array.\n    For k = 2 To NorS\n        ' Write element in current row (i) in 2nd column of Source Array (vntS)\n        ' to Current Value.\n        currV = vntS(k, 2)\n        ' Check if Current Value (CurV) is NOT a number.\n        If Not IsNumeric(currV) Then\n            ' Assign 0 to Current Value.\n            currV = 0\n        End If\n        ' Add current element (row) in Source Array (vntS) and Current Value\n        ' to the Dictionary. If the key to be added is new (not existing),\n        ' the new key and the item will be added. But if the key exists, then\n        ' the existing item will be increased by the value of the new item.\n        ' This could be called \"The Dictionary SumIf Feature\".\n        dict(vntS(k, 1)) = dict(vntS(k, 1)) + currV\n    Next\n\n    ' Write Number of keys in Source Dictionary + 1 for Headers to Target\n    ' Number of Rows.\n    NorT = dict.Count + 1 ' + 1 for headers.\n\n    ' Resize Target Array to Target Number of Rows and Number of Columns.\n    ReDim vntT(1 To NorT, 1 To Noc)\n\n    ' Write Headers from Source to Target Array's first row.\n    For j = 1 To Noc\n        vntT(1, j) = vntS(1, j)\n    Next\n\n    ' Reset Dictionary (Row) Counter.\n    i = 1\n    For Each key In dict.Keys\n        ' Count Dictionary Key.\n        i = i + 1\n        ' Write Dictionary Key to 1st column Target Array.\n        vntT(i, 1) = key\n        ' Write Dictionary Value to 2nd column Target Array.\n        vntT(i, 2) = dict(key)\n    Next\n\n    ' Clear Source Dictionary.\n    dict.RemoveAll\n\n   ' Loop through elements (rows) of Source Array.\n    For k = 2 To NorS\n        ' Write element in current row (i) in 2nd column of Source Array (vntS)\n        ' to Current Value.\n        currV = vntS(k, 3)\n        ' Check if Current Value (CurV) is NOT a number.\n        If Not IsNumeric(currV) Then\n            ' Assign 0 to Current Value.\n            currV = 0\n        End If\n        ' Add current element (row) in Source Array (vntS) and Current Value\n        ' to the Dictionary. If the key to be added is new (not existing),\n        ' the new key and the item will be added. But if the key exists, then\n        ' the existing item will be increased by the value of the new item.\n        ' This could be called \"The Dictionary SumIf Feature\".\n        dict(vntS(k, 1)) = dict(vntS(k, 1)) + currV\n    Next\n\n    ' Erase not needed arrays.\n    Erase vntS\n\n    ' Reset Dictionary (Row) Counter.\n    i = 1\n    For Each key In dict.Keys\n        ' Count Dictionary Key.\n        i = i + 1\n        ' Write Dictionary Key to 1st column Target Array.\n        vntT(i, 1) = key\n        ' Write Dictionary Value to 2nd column Target Array.\n        vntT(i, 3) = dict(key)\n    Next\n\n    ' Clear Source Dictionary.\n    dict.RemoveAll\n\n    ' Calculate 3rd and 4th column.\n    For k = 2 To NorT\n        If vntT(k, 3) &gt; 0 Then\n            vntT(k, 4) = \"C\"\n          Else\n            vntT(k, 4) = \"D\"\n            vntT(k, 3) = -vntT(k, 3)\n        End If\n    Next\n\n'    For j = 1 To Noc\n'        For i = 1 To NorT\n'            Debug.Print vntT(i, j)\n'        Next\n'    Next\n\n    With ThisWorkbook.Worksheets(cTarget)\n        .Cells.ClearContents\n        Set rng = .Range(cFcell).Resize(NorT, Noc)\n    End With\n\n    rng.Value = vntT\n\n    ' Apply Formatting\n    With rng\n        ' Apply formatting to whole Target Range.\n        .Columns.AutoFit\n\n'        ' Apply formatting to Headers only:\n'        With .Rows(1)\n'\n'        End With\n'        ' Apply formatting to Body (Data) only:\n'        With .Rows(1).Offset(1).Resize(Rows.Count - 1)\n'\n'        End With\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8429894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c4b0deb9ba6c7b2c73f288eb3131be?s=128&d=identicon&r=PG", "display_name": "katipra", "link": "https://stackoverflow.com/users/8429894/katipra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1553176632, "creation_date": 1553097127, "last_edit_date": 1553100951, "question_id": 55264999, "link": "https://stackoverflow.com/questions/55264999/vba-sum-and-group-by-without-using-sql-adodb", "title": "vba-sum and group by without using sql-adodb", "body": "<p>I have the following data in excel:</p>\n\n<pre><code>+------+-------+-------+----+\n| name | count | net   | CD |\n+------+-------+-------+----+\n| c1   | 125   | 12500 | D  |\n| c2   | 55    | 3500  | C  |\n| c3   | 80    | 2599  | C  |\n| c4   | 30    | 1500  | D  |\n| DGPS | 45    | 1000  | D  |\n|      |       |       |    |\n| PART | 51    | 1560  | C  |\n| DGPS | 20    | 1990  | D  |\n| c2   | 25    | 1325  | C  |\n|      |       |       |    |\n| c3   | 15    | 4500  | C  |\n| c1   | 25    | 6300  | D  |\n|      |       |       |    |\n+------+-------+-------+----+\n</code></pre>\n\n<p>I don't need the rows which start with DGPS,PART or is null.So I have to remove them. Then I need to perform sum and group by. First I need to convert net to -net if CD = D. Then try to get name,sum(count),sum(net) group by name. Then finally perform a check on if sum(net) > 0 then CD=C and if sum(net)&lt;0 then CD=D.</p>\n\n<p>I could use the following query in sql:</p>\n\n<pre><code>select name,sum(count),to_char(ABS(ROUND(sum(net),2))),CASE when sum(net) &gt; 0 then 'C' when sum(net) &lt; 0 then 'D' when sum(net) = 0 then '0' END AS CD\nFROM\n(SELECT name,count,CASE WHEN CD = 'C' THEN to_char(ROUND(net,2)) ELSE to_char(ROUND(-net,2)) END AS net\nFROM tb1 \n)\ngroup by name order by upper(name);\n</code></pre>\n\n<p>But I am not allowed to use external DB or lib, so cannot use sql-adodb. But I am hopeful that since this is a simple sum and group by ,we can achieve it by only vba without using sql.</p>\n\n<p>EDIT: SAMPLE FINAL OUTPUT format</p>\n\n<pre><code>+------+-------+-------+----+\n| name | count | net   | CD |\n+------+-------+-------+----+\n| c1   | 150   | 18800 | D  |\n| c2   | 80    | 4825  | C  |\n| c3   | 95    | 7099  | C  |\n| c4   | 30    | 1500  | D  |\n+------+-------+-------+----+\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1553098079, "post_id": 55264957, "comment_id": 97261995, "body": "I&#39;d just reply and say that you don&#39;t recognize the ID number till they get it right. The best way is to fix the issue at its source."}, {"owner": {"reputation": 157, "user_id": 575212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c60df881f8e57ee01aed9eb2337661?s=128&d=identicon&r=PG", "display_name": "Lord Dust", "link": "https://stackoverflow.com/users/575212/lord-dust"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1553098439, "post_id": 55264957, "comment_id": 97262238, "body": "@K.Davis Indeed, this strategy has been discussed at this end, and we <i>SHALL NOT</i> (emphasis not mine) be pursuing such a direction. Politics and bureaucracy are not fun."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1553099684, "post_id": 55264957, "comment_id": 97263060, "body": "Are you just asking how to edit a received email  in outlook?  It&#39;s pretty straightforward: Message Ribbon &gt;&gt; Actions &gt;&gt; edit message.   Save and close when done."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1553100690, "post_id": 55264957, "comment_id": 97263619, "body": "If you want these &quot;inserts or replacements&quot; to be done automatically (&quot;hands off&quot;) by outlook, you are going to need VBA my friend."}, {"owner": {"reputation": 157, "user_id": 575212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c60df881f8e57ee01aed9eb2337661?s=128&d=identicon&r=PG", "display_name": "Lord Dust", "link": "https://stackoverflow.com/users/575212/lord-dust"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553529446, "post_id": 55264957, "comment_id": 97408515, "body": "@Tim Williams, yes, that&#39;s exactly what I mean. I know it had to be there, but I couldn&#39;t find the option and Google kept getting subverted by ways to charge the subject line (arrrghghgh). It&#39;s so aggravating when you can&#39;t discover basic menu items."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 575212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c60df881f8e57ee01aed9eb2337661?s=128&d=identicon&r=PG", "display_name": "Lord Dust", "link": "https://stackoverflow.com/users/575212/lord-dust"}, "edited": false, "score": 0, "creation_date": 1553529726, "post_id": 55266564, "comment_id": 97408691, "body": "Sadly, it needs to be manual. Because some of the ID numbers are being recycled into other, different departments and will still be in use, it is occasionally the context of WHY I&#39;m being sent an email that determines wheter the number is being used to identify the old or new department."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 2, "last_activity_date": 1553101901, "creation_date": 1553101901, "answer_id": 55266564, "question_id": 55264957, "link": "https://stackoverflow.com/questions/55264957/how-can-i-rewrite-the-body-of-an-email-i-have-received-in-outlook-without-using/55266564#55266564", "title": "How can I rewrite the body of an email I have received in Outlook without using VBA?", "body": "<p>The best way is to handle the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.application.newmailex\" rel=\"nofollow noreferrer\">NewMailEx</a> event of the <code>Application</code> class which is fired when a new item is received in the Inbox. The <code>NewMailEx</code> event fires when a new message arrives in the Inbox and before client rule processing occurs. You can use the Entry ID returned in the EntryIDCollection array to call the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.namespace.getitemfromid\" rel=\"nofollow noreferrer\">NameSpace.GetItemFromID</a> method and process the item.</p>\n\n<p>The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow noreferrer\">Body</a>.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow noreferrer\">HTMLBody</a>.</li>\n<li>The Word editor. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow noreferrer\">WordEditor</a> property of the Inspector class returns an instance of the Word Document which represents the message body. So, you can use the Word object model do whatever you need with the message body. </li>\n</ol>\n\n<p>If you still want to do that manually, see the following screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pOhbH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pOhbH.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 157, "user_id": 575212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c60df881f8e57ee01aed9eb2337661?s=128&d=identicon&r=PG", "display_name": "Lord Dust", "link": "https://stackoverflow.com/users/575212/lord-dust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 55266564, "answer_count": 1, "score": 0, "last_activity_date": 1592688660, "creation_date": 1553097022, "last_edit_date": 1592688660, "question_id": 55264957, "link": "https://stackoverflow.com/questions/55264957/how-can-i-rewrite-the-body-of-an-email-i-have-received-in-outlook-without-using", "title": "How can I rewrite the body of an email I have received in Outlook without using VBA?", "body": "<p>I have a number of informational emails containing department ID numbers. Recently, a corporate-level decision was made to alter ALL of these ID numbers. However, SOME departments have decided that they won't bother to use the new numbers when issuing these informational emails, much to our chagrin.</p>\n\n<p>Until corporate starts enforcing the new rules, when I receive an email from these non-compliant departments, I'd like to be able to insert the new ID number beside the old one in the email body, without creating a new email. For preference, I'd like to do this without VBA, in much the same way as <a href=\"https://support.office.com/en-us/article/edit-an-email-subject-line-08d60328-2a27-473e-8227-0b42a1ff2ce6\" rel=\"nofollow noreferrer\">changing the subject line</a>. The side-effect of the visible difference between what was sent and what I want to read would actually be very helpful.</p>\n\n<p>That article says it's possible to alter the body, but doesn't say how. I'll be darned if I can find anything about altering the body of received emails, other than formatting.</p>\n\n<p>Is it possible to do this without VBA? How would I do so?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1553096964, "post_id": 55264866, "comment_id": 97261190, "body": "Have you got some VBA already working on for &quot;Sales*&quot;? Please post it so we can have a tinker"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553096980, "post_id": 55264866, "comment_id": 97261205, "body": "When you perform a Find in Excel there is an option to <i>Match entire cell contents</i>. VBA would have the equivalent to this property."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553096995, "post_id": 55264866, "comment_id": 97261216, "body": "<code>*</code> stands for anything prior or after the word, <code>?</code> stands for one character. &quot;Sales ?????????&quot; Would find Sales Operations if there are no more words with that length"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553097057, "post_id": 55264866, "comment_id": 97261274, "body": "* doesn&#39;t mean &quot;prior&quot;, it means any sequence of characters from that position."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553097150, "post_id": 55264866, "comment_id": 97261345, "body": "Andy with prior i mean <code>*Sales</code>prior the word Sales <code>Sales*</code> after the word Sales."}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1553097169, "post_id": 55264866, "comment_id": 97261360, "body": "You could use <code>Instr</code>"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1553097195, "post_id": 55264866, "comment_id": 97261384, "body": "Is there a symbol to cut off the find? Like the opposite of * or ?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553097336, "post_id": 55264866, "comment_id": 97261491, "body": "@Chris2015 you need to use <code>?</code> stands for 1 character Sales1, Sales2, Sales3,... Sales10. If you use <code>Sales?</code> only the first Sales1-9 will be found. And using if statements with wild cards need <code>Like</code> instead <code>=</code>. Using <code>Like</code> makes it Case Sensitive."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1553097423, "post_id": 55264866, "comment_id": 97261546, "body": "I don&#39;t fully understand what your issue would be when filtering, something along the lines of <code>ActiveSheet.Range(&quot;$A$1:$A$4&quot;).AutoFilter Field:=1, Criteria1:=&quot;=Sales&quot;</code> would not return <code>Sales Operations</code>, but only exact matches of <code>Sales</code>"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1553097482, "post_id": 55264866, "comment_id": 97261588, "body": "I am using an Advanced Filter so it is more like Criteria1:=fl.Range(&quot;filter&quot;)"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1553097521, "post_id": 55264866, "comment_id": 97261618, "body": "So, if there is a way to make the range equivalent to &quot;=Sales&quot; that would work also, but I didn&#39;t know that route either"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553097532, "post_id": 55264866, "comment_id": 97261629, "body": "So your question is about Advanced Filter, not the Find or Replace feature?"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1553097602, "post_id": 55264866, "comment_id": 97261678, "body": "I think either could provide a solution"}], "answers": [{"tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1553097375, "creation_date": 1553097375, "answer_id": 55265083, "question_id": 55264866, "link": "https://stackoverflow.com/questions/55264866/is-there-a-way-to-use-wildcard-characters-to-find-an-exact-match/55265083#55265083", "title": "Is there a way to use wildcard characters to find an exact match?", "body": "<p>You do not need to use the wildcard feature. If you record a macro use the Replace feature, and choose Options and tick <code>Match entire cell contents</code> you will see code like this.</p>\n\n<pre><code>Sub Macro2()\n\n    Cells.Find(What:=\"Sales\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate\n    ActiveCell.Replace What:=\"Sales\", Replacement:=\"Foo\", LookAt:=xlWhole, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n    Cells.FindNext(After:=ActiveCell).Activate\nEnd Sub\n</code></pre>\n\n<p>It is <code>LookAt:=xlWhole</code> that achieves the entire match.</p>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1553114567, "creation_date": 1553114567, "answer_id": 55269841, "question_id": 55264866, "link": "https://stackoverflow.com/questions/55264866/is-there-a-way-to-use-wildcard-characters-to-find-an-exact-match/55269841#55269841", "title": "Is there a way to use wildcard characters to find an exact match?", "body": "<h1>Replace Trouble</h1>\n\n<p>You haven't said it explicitly anywhere, but I'm assuming that you used your code:</p>\n\n<pre><code>With Thisworkbook.Sheets(\"Sheet1\")\n    If .Range(\"A2\").Value = \"Sales\" Then\n        .Range(\"A2\").Replace \"Sales\", \"Sales?\"\n    End If\nEnd With\n</code></pre>\n\n<p>and the result was that it replaced e.g. <code>Sales Operations</code> with <code>Sales? Operations</code> which you didn't want to happen.</p>\n\n<p>The <code>Replace</code> method has 8 arguments while you were using only the obvious first two:</p>\n\n<p><code>What</code> and <code>Replacement</code></p>\n\n<p>The reason behind your grief was that due to the last <code>Find</code> or <code>Replace</code> operation you performed, the 3rd argument <code>LookAt</code> was set to <code>xlPart</code> which means that it will find or replace any occurrence in a cell containing your <code>What</code> parameter, \"Sales\". This is easily fixed by changing your line to:</p>\n\n<pre><code>.Range(\"A2\").Replace \"Sales\", \"Sales?\", xlWhole\n</code></pre>\n\n<p>Now, like <code>LookAt</code>, there are two more important arguments which <strong>are saved each time a Replace or Find is performed</strong>: </p>\n\n<p><code>SearchDirection</code> and <code>MatchCase</code> </p>\n\n<p>which are also best set each time a <code>Replace</code> or <code>Find</code> is performed.</p>\n\n<p>You should carefully study those two methods, because they are not as simple (easy) as one might think.</p>\n"}], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553114567, "creation_date": 1553096780, "last_edit_date": 1553097464, "question_id": 55264866, "link": "https://stackoverflow.com/questions/55264866/is-there-a-way-to-use-wildcard-characters-to-find-an-exact-match", "title": "Is there a way to use wildcard characters to find an exact match?", "body": "<p>I understand the wildcard character can be used to find additional characters on top of a word when filtering. For example, if I am filtering on the word \"Sales\" I can replace my filter to \"Sales*\" to find additional characters beyond the first five. Is there a way to use a character to stop and filter on exactly \"Sales\" i.e. so that results \"Sales Operations\" would not be included?</p>\n\n<p>I tried this, and i thought it was working, but came to realize it was not.</p>\n\n<pre><code>With Thisworkbook.Sheets(\"Sheet1\")\n    If .Range(\"A2\").Value = \"Sales\" Then\n        .Range(\"A2\").Replace \"Sales\", \"Sales?\"\n    End If\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1553096598, "post_id": 55264745, "comment_id": 97260934, "body": "When you debug it do you know which line you get that error on?"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1553096884, "creation_date": 1553096884, "answer_id": 55264898, "question_id": 55264745, "link": "https://stackoverflow.com/questions/55264745/how-to-hide-certain-userform-fields-during-initialization/55264898#55264898", "title": "How to Hide certain userform fields during initialization?", "body": "<p>Note that you can reduce the code like below. Replace <code>True</code> with <code>togbHAZOP.Value</code> and <code>False</code> with <code>Not togbHAZOP.Value</code> in the <code>If togbHAZOP = True</code> part. So you don't need to repeat the whole code.</p>\n\n<pre><code>Private Sub togbHAZOP_Click()\n    Sheets(\"Updated Hours EST\").Rows(\"6:27\").EntireRow.Hidden = Not togbHAZOP.Value\n    Sheets(\"SCOPE\").Rows(\"31:37\").EntireRow.Hidden = Not togbHAZOP.Value\n    Sheets(\"SUMMARY\").Rows(\"5:8\").EntireRow.Hidden = Not togbHAZOP.Value\n    Frame5.Enabled = togbHAZOP.Value\n    Frame5.Visible = togbHAZOP.Value\n    Frame6.Enabled = togbHAZOP.Value\n    Frame6.Visible = togbHAZOP.Value\n    Frame7.Enabled = togbHAZOP.Value\n    Frame7.Visible = togbHAZOP.Value\n    HazOp.Enabled = togbHAZOP.Value\n    HazOp.Visible = togbHAZOP.Value    \nEnd Sub\n</code></pre>\n\n<p>Since <code>togbHAZOP</code> is a toggle it does not have a frame <code>togbHAZOP.Frame5</code> that's probably the issue here. It should probably be something like: </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    WizardProp.MultiPage1.Value = 0\n    Me.MultiPage1.Style = fmTabStyleNone\n    Me.Frame5.Enabled = False\n    Me.Frame5.Visible = False\n    Me.Frame6.Enabled = False\n    Me.Frame6.Visible = False\n    Me.Frame7.Enabled = False\n    Me.Frame7.Visible = False\n    Me.HazOp.Enabled = False\n    Me.HazOp.Visible = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 2441245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/597c2fb23331c21662e5c22674ced342?s=128&d=identicon&r=PG", "display_name": "GoldFusion", "link": "https://stackoverflow.com/users/2441245/goldfusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 55264898, "answer_count": 1, "score": 1, "last_activity_date": 1553096884, "creation_date": 1553096465, "question_id": 55264745, "link": "https://stackoverflow.com/questions/55264745/how-to-hide-certain-userform-fields-during-initialization", "title": "How to Hide certain userform fields during initialization?", "body": "<p>So I have a userform that consist of <code>Multipages</code>and one of the pages contain <code>togglebuttons</code> which hide and unhide fields on the Userform as well as on the excel worksheet. The picture below shows the togglebutton page.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SrWhm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SrWhm.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code for HAZOP/ SIL &amp; LOPA is the same except which fields it hides is different. Below is the code for HAZOP togglebutton.</p>\n\n<pre><code>Private Sub togbHAZOP_Click()\n\n    If togbHAZOP = True Then\n\n        Sheets(\"Updated Hours EST\").Rows(\"6:27\").EntireRow.Hidden = False\n        Sheets(\"SCOPE\").Rows(\"31:37\").EntireRow.Hidden = False\n        Sheets(\"SUMMARY\").Rows(\"5:8\").EntireRow.Hidden = False\n        Frame5.Enabled = True\n        Frame5.Visible = True\n        Frame6.Enabled = True\n        Frame6.Visible = True\n        Frame7.Enabled = True\n        Frame7.Visible = True\n        HazOp.Enabled = True\n        HazOp.Visible = True\n\n    Else\n        Sheets(\"Updated Hours EST\").Rows(\"6:27\").EntireRow.Hidden = True\n        Sheets(\"SCOPE\").Rows(\"31:37\").EntireRow.Hidden = True\n        Sheets(\"SUMMARY\").Rows(\"5:8\").EntireRow.Hidden = True\n        Frame5.Enabled = False\n        Frame5.Visible = False\n        Frame6.Enabled = False\n        Frame6.Visible = False\n        Frame7.Enabled = False\n        Frame7.Visible = False\n        HazOp.Enabled = False\n        HazOp.Visible = False\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Code for Initialization at the moment but it doesn't work, gives an error saying <code>\"Run-time error 438: Object doesn't support this property or method\"</code></p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    WizardProp.MultiPage1.Value = 0\n    Me.MultiPage1.Style = fmTabStyleNone\n    togbHAZOP.Frame5.Enabled = False\n    togbHAZOP.Frame5.Visible = False\n    togbHAZOP.Frame6.Enabled = False\n    togbHAZOP.Frame6.Visible = False\n    togbHAZOP.Frame7.Enabled = False\n    togbHAZOP.Frame7.Visible = False\n    togbHAZOP.HazOp.Enabled = False\n    togbHAZOP.HazOp.Visible = False\n\nEnd Sub\n</code></pre>\n\n<p>The issue I am having is <strong>how do I hide certain fields within the userform at the beginning of the code</strong> and based upon the user's selection using the <code>togglebuttons</code>will hide/unhide because at the moment I have to click on the togglebuttons then unclick to get it where the linked fields are hidden and doing that everytime during initialization can be a nuisance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 7, "last_activity_date": 1553096087, "creation_date": 1553096087, "answer_id": 55264602, "question_id": 55264584, "link": "https://stackoverflow.com/questions/55264584/cannot-set-range-variable-in-vba/55264602#55264602", "title": "Cannot set range variable in VBA", "body": "<p>Here:</p>\n\n<pre><code>Sub Test()\n    Dim DataRange As Range\n    Set DataRange = Workbooks(\"Rooms.csv\").Sheets(1).Range(\"A3\", \"AK17068\")\nEnd Sub\n</code></pre>\n\n<p><code>Object</code>Variables are Set with <code>Set</code></p>\n"}, {"tags": [], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "is_accepted": false, "score": 4, "last_activity_date": 1553096097, "creation_date": 1553096097, "answer_id": 55264606, "question_id": 55264584, "link": "https://stackoverflow.com/questions/55264584/cannot-set-range-variable-in-vba/55264606#55264606", "title": "Cannot set range variable in VBA", "body": "<p>You need to set the data range</p>\n\n<p><code>Set DataRange = Workbooks(\"Rooms.csv\").Sheets(1).Range(\"A3\", \"AK17068\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1553103157, "creation_date": 1553103157, "answer_id": 55266938, "question_id": 55264584, "link": "https://stackoverflow.com/questions/55264584/cannot-set-range-variable-in-vba/55266938#55266938", "title": "Cannot set range variable in VBA", "body": "<p>Using <em>With Statement</em> referring to the workbook &amp; worksheet we are getting the advantage of not repeating workbook &amp; worksheet names if you are planning to set more ranges. See below:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim DataRange As Range, DataRange2 As Range\n\n    With Workbooks(\"Rooms.csv\").Worksheets(\"Sheet1\") '&lt;- Using *With Statement* referring to the workbook &amp; worksheet\n        Set DataRange = .Range(\"A3\", \"AK17068\")\n        Set DataRange2 = .Range(\"A1\") '&lt;- For example purpoces\n    End With\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 3391556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b53ce444f7a08cdd3aa4b94c9d2178?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/3391556/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 55264602, "answer_count": 3, "score": 0, "last_activity_date": 1553103157, "creation_date": 1553096037, "question_id": 55264584, "link": "https://stackoverflow.com/questions/55264584/cannot-set-range-variable-in-vba", "title": "Cannot set range variable in VBA", "body": "<p>I'm brand new to VBA and trying to learn variables. I have a simple piece of code that <em>should</em> set a variable to a range:</p>\n\n<pre><code>Sub Test()\n    Dim DataRange As Range\n    DataRange = Workbooks(\"Rooms.csv\").Sheets(1).Range(\"A3\", \"AK17068\")\nEnd Sub\n</code></pre>\n\n<p>When I run I get <code>Run-time error '91': Object variable or With block variable not set</code> which.... isn't that what I did with the <code>Dim</code> statement? What is this referring to?</p>\n\n<p>I saw <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/error-messages/object-variable-or-with-block-variable-not-set\" rel=\"nofollow noreferrer\">in the MS docs</a> that in certain cases (I don't fully understand when) I should use <code>Option Strict On</code> but when I try to use this I get a syntax error (<code>Expected: Base or Compare or Explicit or Private</code>). I think I am fundamentally misunderstanding how this should work (am C++ dev by training)</p>\n"}, {"tags": ["excel", "vba", "forms", "copy-paste"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553097929, "post_id": 55264540, "comment_id": 97261878, "body": "Hello DaniloS, i&#39;m not actually sure what is your goal here. You said you need to copy one row from every sheet with matching criteria. Where would the criteria be? In column C is only 1 row that will match the criteria you are looking for?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553099408, "post_id": 55264540, "comment_id": 97262891, "body": "So your criteria is &gt;0, and for each sheet, 1 to 5, you want to check each cell to the last row, and if the cell contains a value &gt;0, then copy the row and paste to the first empty row in sheet6. right?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553099846, "post_id": 55264540, "comment_id": 97263137, "body": "Do you only have the 6 woksheets?"}, {"owner": {"reputation": 13, "user_id": 11079378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b64f33f22b635aeb9323df6339faf71?s=128&d=identicon&r=PG&f=1", "display_name": "DaniloS", "link": "https://stackoverflow.com/users/11079378/danilos"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553119041, "post_id": 55264540, "comment_id": 97272737, "body": "Hello @Damian It is foreseen to &quot;manually&quot; move through the Excel sheets, for example: in sheet 4 I found 5 el. parts which I want to order -&gt; I will put the amount into column C -&gt; click on the button to add those rows to sheet 6 where I have &quot;Order list&quot;. Than I go for example to sheet 2 and there I will choose 7 el. parts also with puting amount into the column C, and than again click on the button to add entire row to &quot;order list&quot; (Sheet 6)."}, {"owner": {"reputation": 13, "user_id": 11079378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b64f33f22b635aeb9323df6339faf71?s=128&d=identicon&r=PG&f=1", "display_name": "DaniloS", "link": "https://stackoverflow.com/users/11079378/danilos"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553119399, "post_id": 55264540, "comment_id": 97272855, "body": "Hello @GMalc,  no, I dont do check at the same time. I just go through the excel sheets and first search for the parts which I need to order and than I enter value in column C. And yes, I only have 6 sheets"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553169879, "post_id": 55264540, "comment_id": 97289754, "body": "How you prepare your worksheet was not the question; when you are ready to click the button is the process identified in the comment, what you were asking to do. was the point of my question."}], "answers": [{"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553101114, "post_id": 55266126, "comment_id": 97263887, "body": "You don&#39;t need the first <code>DestLastRow</code> it just needs to be within the For statement. The only reason i mentioned it is that i was going to suggest the same code, except i prefer to use <code>Filter</code> and <code>SpecialCells</code>. Also, <code>ws1.Cells(Rows.Count, 5).End(xlUp).Row</code> should be a 1 not 5"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553101339, "post_id": 55266126, "comment_id": 97264021, "body": "@GMalc True, but if it is removed, the second one would have to be moved above the copy,paste line otherwise the first copy/paste will fail"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553102782, "post_id": 55266126, "comment_id": 97264881, "body": "If you place the DestLastRow above the previous line, then you don&#39;t need the line in the beginning. Also, you need to add +1 or else you will be rewriting over the last used row."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1553104066, "post_id": 55266126, "comment_id": 97265563, "body": "@GMalc Edited to eliminate redundant variable declaration"}, {"owner": {"reputation": 13, "user_id": 11079378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b64f33f22b635aeb9323df6339faf71?s=128&d=identicon&r=PG&f=1", "display_name": "DaniloS", "link": "https://stackoverflow.com/users/11079378/danilos"}, "edited": false, "score": 0, "creation_date": 1553119566, "post_id": 55266126, "comment_id": 97272912, "body": "Thank you @Darrell H, I will try it tomorrow when I get to work. I am not 100% sure, but if I can to attach my exel file here, I would gladly do that, so you can better understand what is my question."}, {"owner": {"reputation": 13, "user_id": 11079378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b64f33f22b635aeb9323df6339faf71?s=128&d=identicon&r=PG&f=1", "display_name": "DaniloS", "link": "https://stackoverflow.com/users/11079378/danilos"}, "edited": false, "score": 0, "creation_date": 1553238814, "post_id": 55266126, "comment_id": 97317439, "body": "Hello @Darrell H, I&#180;ve tried your code, but sadly it doesn&#180;t works. Somehow it is copied into the header of the order list (not to / from row 14, but to row 11). Here are the screenshots: <a href=\"http://imgur.com/E6mtjNh\" rel=\"nofollow noreferrer\">imgur.com/E6mtjNh</a> <a href=\"http://imgur.com/GtaCV9w\" rel=\"nofollow noreferrer\">imgur.com/GtaCV9w</a>"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "reply_to_user": {"reputation": 13, "user_id": 11079378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b64f33f22b635aeb9323df6339faf71?s=128&d=identicon&r=PG&f=1", "display_name": "DaniloS", "link": "https://stackoverflow.com/users/11079378/danilos"}, "edited": false, "score": 0, "creation_date": 1553255575, "post_id": 55266126, "comment_id": 97326362, "body": "@DaniloS Ah yes, you are using three rows for your header and only populating the top one.  I would use one and make the row size bigger.  The other option is to move the populated cell in the header to the bottom (row 13).  I also added a plus one to the <code>DestLastRow</code>.  Part of automating tasks successfully is designing sheets that allow for repeatable actions to be taken.  You may have to modify the code to suit, but the concept of looping and pasting should be absorbed here."}, {"owner": {"reputation": 13, "user_id": 11079378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b64f33f22b635aeb9323df6339faf71?s=128&d=identicon&r=PG&f=1", "display_name": "DaniloS", "link": "https://stackoverflow.com/users/11079378/danilos"}, "edited": false, "score": 0, "creation_date": 1553256681, "post_id": 55266126, "comment_id": 97326984, "body": "@Darrell H Thank you very much for prompt answer. I will try / modify your edited code now. Yes, I know what you are meaning, the problem is that I am not the one who was defined this form. It is form which suits to import in SAP system in my company. That basically means that I have not to much space to play around. :)"}, {"owner": {"reputation": 13, "user_id": 11079378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b64f33f22b635aeb9323df6339faf71?s=128&d=identicon&r=PG&f=1", "display_name": "DaniloS", "link": "https://stackoverflow.com/users/11079378/danilos"}, "edited": false, "score": 0, "creation_date": 1553258984, "post_id": 55266126, "comment_id": 97328263, "body": "@Darrell H I think I have the solution! I will just insert word &quot;DRAFT&quot; into 13. row (no matter wich cell - in my / your code it was cell (13,5), but I can modify that). Than, when I have filled order list, I would add one more command button - to which I would click and create new FINAL ORDER Sheet / Table, in which would be automatically deleted word DRAFT from row 13 and just copied all filled el. parts. Thant means - I need to search now for code to creating new sheet or table. :) Thank you a lot for your spent time and for an ingenious and simple solution!"}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1553255376, "last_edit_date": 1553255376, "creation_date": 1553100619, "answer_id": 55266126, "question_id": 55264540, "link": "https://stackoverflow.com/questions/55264540/copy-entire-row-to-the-next-empty-row-in-another-worksheet-which-begins-from-spe/55266126#55266126", "title": "Copy entire row to the next empty row in another worksheet which begins from specific row", "body": "<p>This assumes you only have the 6 worksheets in the workbook.  Some of the variable names have been changed, but hopefully understood.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim ws As Worksheet\n    Dim ws1 As Worksheet\n    Dim DestLastRow As Long\n    Dim LastRow As Long\n    Dim i As Long\n\n    Set ws1 = Sheets(\"St\u00fcckliste\")\n\n    For Each ws In Worksheets\n        If ws.Name &lt;&gt; \"St\u00fcckliste\" Then\n            LastRow = ws.Cells(Rows.Count, 5).End(xlUp).Row\n            For i = 14 To LastRow\n                If ws.Cells(i, 3).Value &gt; 0 Then\n                    DestLastRow = ws1.Cells(Rows.Count, 5).End(xlUp).Row + 1\n                    ws.Rows(i).Copy ws1.Rows(DestLastRow)\n                End If\n            Next i\n        End If\n    Next ws\n\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11079378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b64f33f22b635aeb9323df6339faf71?s=128&d=identicon&r=PG&f=1", "display_name": "DaniloS", "link": "https://stackoverflow.com/users/11079378/danilos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 55266126, "answer_count": 1, "score": 1, "last_activity_date": 1553255376, "creation_date": 1553095919, "question_id": 55264540, "link": "https://stackoverflow.com/questions/55264540/copy-entire-row-to-the-next-empty-row-in-another-worksheet-which-begins-from-spe", "title": "Copy entire row to the next empty row in another worksheet which begins from specific row", "body": "<p>I have tried to search for an answer in this forum, I\u00b4ve also tried to modify the code to suit my requirement but still without success. Could someone please help me?</p>\n\n<p>I have an excel document with 6 sheets. <strong>All sheets have an identical (fixed) form</strong>. First 5 sheets are basically databases where I have electrical parts from 5 different projects, and 6th Sheet is an empty form, which should be used as an order list.</p>\n\n<p>What I need is a code that will copy the entire row from sheet 1/2/3/4/5 to the Sheet 6 if the criteria is met. The criteria is an entered quantity (different from 0) in column C (Sheets 1/2/3/4/5). That what is the main problem, I need to copy entire row to the next empty row in Sheet 6 \u2013 but form begins from the row 14 (A14), above is a header.</p>\n\n<p>Now I have code for command button which works only if I am working in one sheet and trying to copy rows to Sheet 6 (Order list). \nIf I am working in Sheet 5 and I jump for example to Sheet 3, and if I try to add some more parts to order list from Sheet 3, it will just copy all over the existing parts in order list, which I already copied from Sheet 5.</p>\n\n<p>Here is the code which I have so far (in this example I used only Sheet 5 - \"Gemeinsam\"):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    a = Worksheets(\"Gemeinsam\").Cells(Rows.Count, 5).End(xlUp).Row\n    b = 14\n    For i = 14 To a\n\n       If Worksheets(\"Gemeinsam\").Cells(i, 3).Value &gt; 0 Then\n\n          Worksheets(\"Gemeinsam\").Rows(i).Copy\n          Worksheets(\"St\u00fcckliste\").Activate\n          Worksheets(\"St\u00fcckliste\").Cells(b, 1).Select\n          ActiveSheet.Paste\n          Worksheets(\"Gemeinsam\").Activate\n       b = b + 1\n       End If\n    Next\n\nApplication.CutCopyMode = False\n\nThisWorkbook.Worksheets(\"Gemeinsam\").Cells(14, 1).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1553100329, "post_id": 55264587, "comment_id": 97263404, "body": "Use <code>DateSerial</code> to generate dates, otherwise this will not work in different localizations. Never use strings when handling dates (unless for displaying purpose)."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 1, "creation_date": 1553158378, "post_id": 55264587, "comment_id": 97283502, "body": "This will result in dates greater than 12. January  in many localizations. Also, afaik, in most localizations <code>&#47;</code> is not an acceptable date-delimiter."}], "tags": [], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "is_accepted": false, "score": 0, "last_activity_date": 1553096048, "creation_date": 1553096048, "answer_id": 55264587, "question_id": 55264472, "link": "https://stackoverflow.com/questions/55264472/how-do-i-automate-this-date-code-so-i-dont-have-to-change-it-every-year/55264587#55264587", "title": "How do I automate this date code so I don&#39;t have to change it every year?", "body": "<p>I am pretty sure you can do this.  I don't have access to test, but it works in VBA:</p>\n\n<pre><code>where (Load_Date) &gt;= \"12/01/\" &amp; Year(date())-1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 5, "last_activity_date": 1553098908, "creation_date": 1553098908, "answer_id": 55265594, "question_id": 55264472, "link": "https://stackoverflow.com/questions/55264472/how-do-i-automate-this-date-code-so-i-dont-have-to-change-it-every-year/55265594#55265594", "title": "How do I automate this date code so I don&#39;t have to change it every year?", "body": "<p>Never use string handling for dates in VBA when it can be avoided.</p>\n\n<pre><code>where Load_Date &gt;= DateSerial(Year(Date()) - 1, 12, 1)\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1564296140, "creation_date": 1553095729, "last_edit_date": 1564296140, "question_id": 55264472, "link": "https://stackoverflow.com/questions/55264472/how-do-i-automate-this-date-code-so-i-dont-have-to-change-it-every-year", "title": "How do I automate this date code so I don&#39;t have to change it every year?", "body": "<p>How do I automate this date code so I don't have to change it every year?</p>\n\n<pre><code>where (Load_Date) &gt;= #12/01/2018#\n</code></pre>\n\n<p>I need dates greater than or equal to Dec of last year.</p>\n\n<p>For example in 2019 I need dates of Dec 2018 and greater. In 2020 I will need dates of Dec 2019 and greater.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 428, "user_id": 10569362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9c61d2dbd18a14e34005ab752e682e?s=128&d=identicon&r=PG&f=1", "display_name": "patel", "link": "https://stackoverflow.com/users/10569362/patel"}, "edited": false, "score": 2, "creation_date": 1553097351, "post_id": 55264407, "comment_id": 97261499, "body": "I don&#39;t see any function, a sub does not return anytthing"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553100086, "post_id": 55264407, "comment_id": 97263274, "body": "Every time you hit <code>All_Folder</code> you reset <code>Counter</code> to zero, so each time through you&#39;re just writing to the same array locations."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1553100109, "post_id": 55264407, "comment_id": 97263290, "body": "If you want to run <code>All_Folder</code> more than once then make your <code>Counter</code> a global variable too: <code>Public Counter As Long</code> and remove <code>Dim Counter As Integer: Counter = 0</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553100219, "post_id": 55264407, "comment_id": 97263353, "body": "Your method of checking the file type is also a bit off - all it does is check whether there&#39;s at least one txt file in the folder being processed."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553100501, "post_id": 55264407, "comment_id": 97263499, "body": "Since you&#39;re using FSO you could use the <code>GetExtensionName</code> method to check the file type."}, {"owner": {"reputation": 311, "user_id": 11226789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPSOV.jpg?s=128&g=1", "display_name": "medicine_man", "link": "https://stackoverflow.com/users/11226789/medicine-man"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553101017, "post_id": 55264407, "comment_id": 97263822, "body": "Thank you @TimWilliams and @PeH. All I needed was to set my <code>Counter</code> as a global variable."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1553101034, "post_id": 55264407, "comment_id": 97263837, "body": "Make an array local to the module (above your subs) when calling the function recursively (calls itself without any idea how many calls will be made, until a condition is met) add your directory:filename or the full path to the array as a string.  In recursion it will be built from the bottom up.  You could always just loop this in a directory path until there are no more files and avoid the recursion.  But if you do not know how many files or folders are in a directory it would be a good case for recursion (think tree structure)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553101262, "post_id": 55264407, "comment_id": 97263977, "body": "See here for an example of how to do this non-recursively - <a href=\"https://stackoverflow.com/questions/54227570/convert-spreadsheets-from-folder-to-pdf-save-to-different-location/54227683#54227683\" title=\"convert spreadsheets from folder to pdf save to different location\">stackoverflow.com/questions/54227570/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 11226789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPSOV.jpg?s=128&g=1", "display_name": "medicine_man", "link": "https://stackoverflow.com/users/11226789/medicine-man"}, "is_accepted": true, "score": 0, "last_activity_date": 1553101709, "creation_date": 1553101709, "answer_id": 55266498, "question_id": 55264407, "link": "https://stackoverflow.com/questions/55264407/return-array-in-self-calling-function-in-vba/55266498#55266498", "title": "Return Array in Self-Calling Function in VBA", "body": "<p>As <a href=\"https://stackoverflow.com/users/478884/tim-williams\">Tim Williams</a> and <a href=\"https://stackoverflow.com/users/3219613/p%E1%B4%87%CA%9C\">PeH</a> suggested, I had not set my <code>Counter</code> as a global variable. Here would be the updated code:</p>\n\n<pre><code>Public file_locations() As String\nPublic Counter As Integer\nSub Some_Subroutine()\n    Dim pathway As String: pathway = \"C:\\Users\"\n    Counter = 0\n    Dim FileSystem As Object\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    All_Folder FileSystem.GetFolder(pathway)\n\n    ...\n\nEnd Sub\nPublic Sub All_Folder(Folder)\n    Dim filetype as string: filetype = \"*.txt\"\n    Dim SubFolder: Dim File\n    For Each SubFolder in Folder.SubFolders\n        All_Folder SubFolder\n    Next\n    For Each File in Folder.Files\n        If Dir(Folder &amp; \"\\\" &amp; filetype) &lt;&gt; \"\" Then\n            ReDim Preserve file_locations(Counter)\n            file_locations(Counter) = CallByName(File, Path, VbGet)\n            Counter = Counter + 1\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Thanks to you two for helping me out.</p>\n"}], "owner": {"reputation": 311, "user_id": 11226789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPSOV.jpg?s=128&g=1", "display_name": "medicine_man", "link": "https://stackoverflow.com/users/11226789/medicine-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 55266498, "answer_count": 1, "score": 1, "last_activity_date": 1555078600, "creation_date": 1553095541, "last_edit_date": 1555078600, "question_id": 55264407, "link": "https://stackoverflow.com/questions/55264407/return-array-in-self-calling-function-in-vba", "title": "Return Array in Self-Calling Function in VBA", "body": "<p>I am trying to figure out how to return a string array in a function that calls itself. It is a function that looks through all folders and subfolders within a specific path to generate a list of text files and where they are located. Right now, the subroutine is <code>All_Folder</code>. I have previously tried making <code>All_Folder</code> a function, and trying to return the value from the function, but that has gotten me nowhere. This is my code now:</p>\n\n<pre><code>Public file_locations() As String\nSub Some_Subroutine()\n    Dim pathway As String: pathway = \"C:\\Users\"\n    Dim FileSystem As Object\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    All_Folder FileSystem.GetFolder(pathway)\n\n    ...\n\nEnd Sub\nPublic Sub All_Folder(Folder)\n    Dim filetype as string: filetype = \"*.txt\"\n    Dim Counter As Integer: Counter = 0\n    Dim SubFolder: Dim File\n    For Each SubFolder in Folder.SubFolders\n        All_Folder SubFolder\n    Next\n    For Each File in Folder.Files\n        If Dir(Folder &amp; \"\\\" &amp; filetype) &lt;&gt; \"\" Then\n            ReDim Preserve file_locations(Counter)\n            file_locations(Counter) = CallByName(File, Path, VbGet)\n            Counter = Counter + 1\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>My problem is that every time this function is ran, the output in <code>file_locations</code> is always overwritten by what is in the next called directory. </p>\n\n<p>I have the list by the end of the subroutine <code>All_Folder</code>, I just need to be able to store/append it to the current <code>file_locations</code> list.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553095570, "post_id": 55264346, "comment_id": 97260194, "body": "so your code with your variables is <code>OptionButton1.BackColor = DGn</code> for example?"}, {"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553095673, "post_id": 55264346, "comment_id": 97260271, "body": "Yes, that&#39;s what I&#39;m looking for. I&#39;ll edit my question to be more concise"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1553095788, "post_id": 55264346, "comment_id": 97260358, "body": "Try: <code>DGn = 5215744</code>"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553095816, "post_id": 55264346, "comment_id": 97260387, "body": "You will need to add those to the <code>Worksheet_Activate</code> event on the worksheet that the buttons are found on."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553095865, "post_id": 55264346, "comment_id": 97260420, "body": "@Nick i&#39;ve tried that code within a cell and both ways works, using the <code>RGB()</code>or the variable."}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1553096395, "post_id": 55264346, "comment_id": 97260786, "body": "Do your variables ever change? ie Could you create them as constants? If you&#39;ve stopped your code at any point in testing it&#39;s possibly removed the values assigned. Try entering ?DGn in the immediate window and see what value it returns"}, {"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553096479, "post_id": 55264346, "comment_id": 97260842, "body": "@ZackE Sadly doesn&#39;t seem to work either. I also tried @cybernetic.nomad &#39;s approach using the windows colour equivalent <code>5215744</code>. And neither did that."}, {"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "reply_to_user": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1553097068, "post_id": 55264346, "comment_id": 97261284, "body": "@Dave No I doubt they would change so using them as constants wouldn&#39;t be an issue. Just gave it a try though and apparently VBA doesn&#39;t allow RGB as constants."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553097955, "post_id": 55264346, "comment_id": 97261893, "body": "The only other thing I can think of is using <code>vbGreen</code> instead of <code>RGB</code>  Also you have the Sub set as <code>Private</code>, which will only apply to code in the <code>Workbook_Open</code> event and not in any other modules."}, {"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553099578, "post_id": 55264346, "comment_id": 97262990, "body": "@ZackE Thanks a lot for taking the time to make all these suggestions, sadly nothing has worked so far. I&#39;ll play around with it some more in the morning and hopefully I&#39;ll find a solution. Regarding your comments i sadly can&#39;t use <code>vbGreen</code> because the colours are pre-set and I&#39;m not allowed to change them. Also yes I had already changed <code>private sub</code> to <code>public sub</code> because I noticed that mistake too. Will edit the question to reflect."}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1553103428, "post_id": 55264346, "comment_id": 97265226, "body": "Try to put your variables as &#39;Public&#39; in different module than ThisWorkbook"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553104055, "post_id": 55264346, "comment_id": 97265557, "body": "Do you have <code>Option Explicit</code> at the top of every code module?  If you don&#39;t then add it and see if anything changes."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1553115043, "post_id": 55268337, "comment_id": 97271050, "body": "Great answer Tim - I experimented with trying to set a <code>Const</code> to the BackColor value displayed in the properties window, which is something like <code>&amp;H80000005&amp;</code> - just out of curiosity, is there anyway this could be used in place of the <code>Long</code> value somehow?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1553119378, "post_id": 55268337, "comment_id": 97272847, "body": "No expert in this but I think &amp;H80000005 is an index into the system palette - if you want more flexibility then an RGB-derived Long might be more useful.  EDIT: here you go - <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/139131-userform-color-to-rgb-values\" rel=\"nofollow noreferrer\">ozgrid.com/forum/forum/help-forums/excel-general/&hellip;</a>"}, {"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "edited": false, "score": 0, "creation_date": 1553135480, "post_id": 55268337, "comment_id": 97276885, "body": "@TimWilliams you&#39;re an absolute darling! Works perfectly, so I take it the error was two-fold. First I used a variable in which the assigned values were removed and secondly I used RGB instead of  windows colour. Is that right?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553137464, "post_id": 55268337, "comment_id": 97277316, "body": "Using RGB is fine but setting the variables in the workbook open routine makes your code a little vulnerable to errors which end up resetting your variables."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1553108434, "creation_date": 1553108434, "answer_id": 55268337, "question_id": 55264346, "link": "https://stackoverflow.com/questions/55264346/changing-background-colours-of-active-x-option-buttons-through-variables-turns-t/55268337#55268337", "title": "Changing background colours of active x option buttons through variables turns them black", "body": "<p>At the top of a regular module:</p>\n\n<pre><code>Public Const DGn As Long = 5215744   'RGB(0, 150, 79)\nPublic Const LGn As Long = 3262858   'RGB(138, 201, 49)\nPublic Const Ylw As Long = 387833    'RGB(249, 234, 5)\n</code></pre>\n\n<p>You can't directly use <code>RGB()</code> in a constant because a constant's value needs to be known at <em>compile time</em> and <code>RBG()</code> doesn't execute until <em>runtime</em>.</p>\n\n<p>To convert the values, go to the Immediate pane in the VB editor and type (eg) <code>? RGB(138, 201, 49)</code> and hit enter - you will get the Long result which you can then use in your constant.</p>\n"}], "owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55268337, "answer_count": 1, "score": 1, "last_activity_date": 1553108434, "creation_date": 1553095327, "last_edit_date": 1553099631, "question_id": 55264346, "link": "https://stackoverflow.com/questions/55264346/changing-background-colours-of-active-x-option-buttons-through-variables-turns-t", "title": "Changing background colours of active x option buttons through variables turns them black", "body": "<p>I have some odd (as in I don't understand it) behaviour in excel.\nI have quite a few <code>optionbuttons</code> that I want to change the background colour of. In total there's something like 15 buttons and 3 (possibly 4) colours.\nThis works perfectly if I simply assign them the RGB code itself.</p>\n\n<pre><code>Private Sub OptionButton1_Click()\n\nOptionButton1.BackColor = RGB(0, 150, 79) 'Dark Green\nActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=4\n\nEnd Sub\n</code></pre>\n\n<p>however when I try to create variables containing the RGB codes like this:  </p>\n\n<pre><code> Private Sub OptionButton1_Click()\n\n    OptionButton1.BackColor = DGn 'Dark Green\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=4\n\n End Sub\n</code></pre>\n\n<p>the buttons turn black like so:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/BN3o7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BN3o7.png\" alt=\"enter image description here\"></a>  </p>\n\n<p>Since there are quite a few buttons I'd love to just assign the colours once and then simply type DGn or Ylw instead of having to constantly CTRL-C, CTRL-V</p>\n\n<p>Code is in <code>ThisWorkbook</code></p>\n\n<pre><code>Dim DGn As Long\nDim LGn As Long\nDim Ylw As Long\n\n\nPublic Sub Workbook_Open()\nDGn = RGB(0, 150, 79)\nLGn = RGB(138, 201, 49)\nYlw = RGB(249, 234, 5)\nEnd Sub\n</code></pre>\n\n<p>Any suggestions are appreciated! Have a nice nice day/evening.</p>\n"}, {"tags": ["excel", "vba", "sum", "range"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553095318, "post_id": 55264289, "comment_id": 97260042, "body": "Why don&#39;t you go to the total cell on the last workbook and star writting <code>=</code> and then you can go workbook after workbook selecting the cell you need and in between using the <code>+</code> that would end your problem. Thought to update the result you&#39;d need to open all the workbooks every time."}, {"owner": {"reputation": 1, "user_id": 11232822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156238114402993/picture?type=large", "display_name": "Jordan Martin", "link": "https://stackoverflow.com/users/11232822/jordan-martin"}, "edited": false, "score": 0, "creation_date": 1553095672, "post_id": 55264289, "comment_id": 97260270, "body": "There are lots of workbooks, and I would like it to be dynamic and done by code as need to do this quite regularly. I would like to pull the list of workbooks to be summed from another workbok."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1553096030, "post_id": 55264289, "comment_id": 97260529, "body": "Then as Carlos said, @JordanMartin you should provide us with some work of yours. I&#39;d recommend you starting with the <code>Record Macro</code> feature and then check what VBA gives you."}], "owner": {"reputation": 1, "user_id": 11232822, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156238114402993/picture?type=large", "display_name": "Jordan Martin", "link": "https://stackoverflow.com/users/11232822/jordan-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553096710, "creation_date": 1553095125, "last_edit_date": 1553096710, "question_id": 55264289, "link": "https://stackoverflow.com/questions/55264289/summing-a-range-of-cells-across-different-workbooks", "title": "Summing a range of cells across different workbooks", "body": "<p>struggling to conquer this one myself. The essence of the problem is as follows:</p>\n\n<p>I have a list of workbooks that have identically named and identically structured worksheets within them. I would like to take a particular cell from within each workbook, sum across the workbooks, and place the total in the same cell of another identically structured workbook.</p>\n\n<p>The list of workbooks to sum across is quite long. I do not need to do it for all cells, but there will be about 15 different ranges on 15 different sheets that I do need to do it for. </p>\n\n<p>If possible I would also like the links to be added rather than the numbers. For example in cellA1 of the total workbook it would read \n<code>= [workbook(1)]1!A1 + [workbook(2)]1!A1 + ...</code> although I am not sure this can be done.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1553095801, "post_id": 55264115, "comment_id": 97260373, "body": "This could be because of a number of reasons. E.g. you could be importing forms with objects that require a reference without having set up the reference first, or there could be a version mismatch (see <a href=\"https://stackoverflow.com/q/54328256/7296893\">this question</a>). To narrow it down, please try to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. If  you can reproduce this on a relatively simple form, you could include the contents of the text file."}, {"owner": {"reputation": 5, "user_id": 11019220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e83f2bc7295461dc1f8c791e3353?s=128&d=identicon&r=PG&f=1", "display_name": "Wyntile", "link": "https://stackoverflow.com/users/11019220/wyntile"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1553103392, "post_id": 55264115, "comment_id": 97265208, "body": "@ErikA Oh okay. I have provided both the full function and example text file."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1553105454, "post_id": 55264115, "comment_id": 97266264, "body": "Try to delete the entire blocks, not just their content. So including the begin and end stuff"}, {"owner": {"reputation": 5, "user_id": 11019220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e83f2bc7295461dc1f8c791e3353?s=128&d=identicon&r=PG&f=1", "display_name": "Wyntile", "link": "https://stackoverflow.com/users/11019220/wyntile"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1553107003, "post_id": 55264115, "comment_id": 97266991, "body": "@ErikA ....Huh. So it ended up being a parser function problem instead. I had to create another version of it since the previous version had errors, and since the new one had no problems I assumed it was the above function. But thank you, with those removed there were no problems!"}], "owner": {"reputation": 5, "user_id": 11019220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1081e83f2bc7295461dc1f8c791e3353?s=128&d=identicon&r=PG&f=1", "display_name": "Wyntile", "link": "https://stackoverflow.com/users/11019220/wyntile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553103253, "creation_date": 1553094573, "last_edit_date": 1553103253, "question_id": 55264115, "link": "https://stackoverflow.com/questions/55264115/method-loadfromtext-of-object-application-failed", "title": "Method &#39;LoadFromText&#39; of Object &#39;Application&#39; Failed", "body": "<p>So I've been at days now trying to solve this bug. After having all functions for Access objects exported, removing binary data from <a href=\"https://riptutorial.com/ms-access/example/26373/remove-binary-data-from-form\" rel=\"nofollow noreferrer\">specified fields</a>, and importing Access objects to fresh database, this is the error I'm still having issues with.</p>\n\n<blockquote>\n  <p>Run-time error '-2147417851 (80010105)': <br><br>\n  Method 'LoadFromText' of object '_Application' failed.</p>\n</blockquote>\n\n<p><strong>Edit:</strong><br>\nAs requested, here is the full function code that handles the import. The error is caused in the \"Form\" LoadFromText line:</p>\n\n<pre><code>Private Sub Setup_New_Database_File(ByVal srcFileName As String, ByVal destPath As String, ByVal txtDumpPath As String)\n\n' srcFileName: Name of the old datbase file\n' destPath: Destination path of where new Access object is created at\n' txtDumpPath: Directory housing all exported Access text files\nDim accApp As Access.Application\nSet accApp = New Access.Application\n\n' Creating a new Access object\niDate = \" (\" &amp; Format(Date, \"mm-dd-yy\") &amp; \")\"\nnewDBName = destPath &amp; srcFileName &amp; iDate &amp; \".accdb\"\n\n' Auto-delete existing file with same name\nIf Dir(newDBName) &lt;&gt; \"\" Then\n    SetAttr newDBName, vbNormal\n    Kill newDBName\nEnd If\n\nWith accApp\n\n    .DBEngine.CreateDatabase newDBName, DB_LANG_GENERAL, dbVersion120\n    .OpenCurrentDatabase (newDBName)\n    .Visible = False\n    .Echo False             ' Hide any other Access windows apart from current\n    .UserControl = False\n\n    ' --------------------------------------------------------------------------------------------\n    'On Error GoTo Err_SetupNewDatabaseFile\n\n    ' Iterate through the directory containing textfile versions of Access objects created previously from SaveAsText,\n    ' and write back to new Access DB file instance\n    Dim dirObject As Variant\n    fp = txtDumpPath &amp; \"\\\" &amp; \"*.txt\"\n    dirObject = Dir(fp)\n\n    Do While Len(dirObject) &gt; 0\n\n        cFilePath = txtDumpPath &amp; \"\\\" &amp; dirObject\n\n        ' Extract the text file type: [Form_, Module_, Query_, Report_, Script_, Table_]\n        ' Every naming convention only has one \"_\" character.\n        fTarget = InStr(dirObject, \"_\")\n        fStart = fTarget + 1\n        cfLength = Len(dirObject)\n\n        cFileName = Mid(dirObject, fStart, cfLength)      ' E.G: objectname.txt\n\n        pTarget = InStrRev(cFileName, \".\")\n        pEnd = pTarget - 1\n\n        If dirObject = \"Database Linked Tables.txt\" Then\n\n            ' Our Linked Tables are large in data, so opted to add them in via connection.\n            Dim fso As Object, oFile As Object, cLine As String\n            Set fso = CreateObject(\"Scripting.FileSystemObject\")\n            Set oFile = fso.OpenTextFile(cFilePath, ForReading, False)\n\n            Do Until oFile.AtEndOfStream\n\n                cLine = oFile.ReadLine\n\n                If cLine = \"\" Or cLine = Null Then\n                    GoTo Next_Iteration   'Moving on...\n                Else\n\n                   ' Need to check for Driver sources\n                   If cLine = \"xResults Local\" And Special_Character_Match(cLine, \"xResults\") = True Then\n                       tPath = DLookup(\"[Database Path]\", \"[Tables List]\", \"[Table Name] = 'xResults'\")\n                       accApp.DoCmd.TransferDatabase acLink, \"Microsoft Access\", tPath, acTable, cLine, cLine, False\n                   ElseIf cLine &lt;&gt; \"\" Or cLine &lt;&gt; Null Then\n\n                       ' Local vs ODBC:::\n                       option1_path = DLookup(\"[Database Path]\", \"[Tables List]\", \"[Table Name] = '\" &amp; cLine &amp; \"'\")\n                       option2_path = DLookup(\"[Connect]\", \"[Tables List]\", \"[Table Name] = '\" &amp; cLine &amp; \"'\")\n\n                        If option1_path &lt;&gt; \"\" Or option1_path &lt;&gt; Null Then\n                            accApp.DoCmd.TransferDatabase acLink, \"Microsoft Access\", option1_path, acTable, cLine, cLine, False\n                        ElseIf option2_path &lt;&gt; \"\" Or option2_path &lt;&gt; Null Then\n\n                            option2_source = DLookup(\"[MySQL Name]\", \"[Tables List]\", \"[Table Name] = '\" &amp; cLine &amp; \"'\")\n                            option2_setTableNameTo = cLine\n                            connectString = \"ODBC;\" &amp; option2_path &amp; \";\"\n\n                            accApp.DoCmd.TransferDatabase acLink, \"ODBC Database\", connectString, acTable, option2_source, option2_setTableNameTo\n                        End If\n                   End If\n\n                End If   'End of cLine = \"\" check\n Next_Iteration:\n            Loop\n\n            oFile.Close\n            Set fso = Nothing\n            Set oFile = Nothing\n            '-----------------------------------------------------------------------------------------------------------------\n        Else\n\n            ' Add all textfiles in txtdump dir to new Access file\n            accObjectType = Left(dirObject, fTarget - 1)  ' E.G: Form\n            accObjectName = Left(cFileName, pEnd)         ' E.G: objectname\n\n            ' Reconvert accObjectName to its original state\n\n            Select Case accObjectType\n                Case \"Form\"\n                    MsgBox \"File Name: [\" &amp; accObjectName &amp; \"], Form Name: [\" &amp; cFilePath &amp; \"]\"\n                    'On Error Resume Next\n                    accApp.LoadFromText acForm, accObjectName, cFilePath\n                Case \"Module\"\n                    accApp.LoadFromText acModule, accObjectName, cFilePath\n                Case \"Query\"\n                    accApp.LoadFromText acQuery, accObjectName, cFilePath\n                Case \"Report\"\n                    accApp.LoadFromText acReport, accObjectName, cFilePath\n                Case \"Script\"\n                    accApp.LoadFromText acMacro, accObjectName, cFilePath\n                Case \"Table\"\n                    accApp.DoCmd.TransferText acImportDelim, , accObjectName, cFilePath, True\n            End Select\n        End If\n\n        ' Next file iteration\nNextFileIteration:\n        dirObject = Dir\n    Loop\nEnd With\n\n' ---------------------------------------------------------------------------------------------\n' Variable Cleanup\naccApp.Echo True\naccApp.Quit\nSet accApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>And where an example Form text file (with the necessary data removed) is <a href=\"https://www.dropbox.com/s/tv58qjm0sm0smm2/Form_Basics%20-%20File%20Path.txt?dl=0\" rel=\"nofollow noreferrer\">here</a><br></p>\n\n<p>Where to differentiate the objects, files in cFilePath follow \"\\dir...\\Form_FormName.txt\" format, while accObjectName is just \"FormName\". The issue I'm having is importing Access forms. <br></p>\n\n<p><strong>Things I have tried:</strong><br>\n- I have removed the \"NoSaveCTIWhenDisabled =1\" lines from the form files, since in old mdb formats this was causing import issues. (Even with this line on still caused import issues)<br>\n- I have also tried removing all blank lines from the text files, in case the command had issues with reading them.</p>\n\n<p>While a small subset of form objects to get imported, not all of them do, resulting in this error. Checking the files themselves to see why, I can't make sense of them since the format looks relatively the same for all of them. What would be a reason for this automation error to occur? All other export/parsing functions seem to run fine...</p>\n"}, {"tags": ["vba", "replace", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1553094660, "post_id": 55264050, "comment_id": 97259569, "body": "What did you already try?  There are dozens of questions here on SO about deleting rows which match a criteria, so maybe start by looking at those, then post back with what you tried and the problem you ran into (of course it may just work, in which case feel free to post that as an answer)   <a href=\"https://stackoverflow.com/search?q=%5Bvba%5D+delete+rows\">stackoverflow.com/search?q=%5Bvba%5D+delete+rows</a>"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1553094759, "post_id": 55264050, "comment_id": 97259650, "body": "Additionally, it sounds like there possibility exists that a PRI might be duplicated multiple times. Do you want to remove all duplicated PRI values, and replace them once with the new information? Or do you want to replace each of the duplicated PRI values with the new information?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553094950, "post_id": 55264050, "comment_id": 97259769, "body": "Without a lot more code to manage resolving matches, it would be simplest to remove all the existing rows, and add new rows to the end of the table."}, {"owner": {"reputation": 13, "user_id": 10202889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2407946ad1a69927e97bc8e3bf9cc576?s=128&d=identicon&r=PG&f=1", "display_name": "excel rookie", "link": "https://stackoverflow.com/users/10202889/excel-rookie"}, "edited": false, "score": 0, "creation_date": 1553095879, "post_id": 55264050, "comment_id": 97260428, "body": "see what I tried above"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553095885, "post_id": 55264050, "comment_id": 97260433, "body": "I agree @TimWilliams. Unless he simply wants to overwrite each instance with the new data, in which case there is no deletion to worry about."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553096930, "post_id": 55264050, "comment_id": 97261163, "body": "@excelrookie since  i&#39;ve discovered the synergy between <code>arrays</code> and Dictionaries I am a fan. You could beforehand input your worksheet data into one array <code>arrData = ws.Range(&quot;C:C&quot;).Value</code> and then loop through adding all the values into a dictionary. then your code to look for duplicates would be <code>If DictDuplicates.Exists(Me.TxtPRI.Value) Then...</code> this way is way faster than finding everytime on the worksheet what you are supposed  to because dictionaries have the keys indexed and there is no need to loop through to find the item for each key (in this case, they key could be the row number)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553099408, "post_id": 55264050, "comment_id": 97262890, "body": "All you need to do is create a standalone sub to which you pass a PRI, which then deletes all existing rows with that same PRI.  Call that just before you insert the new rows."}, {"owner": {"reputation": 13, "user_id": 10202889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2407946ad1a69927e97bc8e3bf9cc576?s=128&d=identicon&r=PG&f=1", "display_name": "excel rookie", "link": "https://stackoverflow.com/users/10202889/excel-rookie"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553346662, "post_id": 55264050, "comment_id": 97355202, "body": "@Tim.... thanks Tim. Prior to creating the loop that you helped me with. I had the coding that would search for duplicates (see above) but I am unable to adapt it to the coding (loop) that you showed me. Can you provide some assistance with that?"}], "owner": {"reputation": 13, "user_id": 10202889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2407946ad1a69927e97bc8e3bf9cc576?s=128&d=identicon&r=PG&f=1", "display_name": "excel rookie", "link": "https://stackoverflow.com/users/10202889/excel-rookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553095850, "creation_date": 1553094402, "last_edit_date": 1553095850, "question_id": 55264050, "link": "https://stackoverflow.com/questions/55264050/searching-for-duplicates", "title": "searching for duplicates", "body": "<p>I presently have a UserForm that feeds into a spreadsheet. I require that once the information is entered into the UserForm that a search is done within the spreadsheet for rows that match the same PRI, if so the previous information is deleted and the new information populated in the sheet. It is important that only the matching PRI numbers are removed and if the new submission as additional options than the previous it doesn't overwrite other rows. This is my present coding: </p>\n\n<pre><code> Private Sub CmdAdd_Click()\n    Dim ws As Worksheet\n    Dim info\n    Dim rw As Range\n    Dim n As Long\n    Dim r As Range\n\n Const strPwd As String = \"Transfer19\"\n\n ThisWorkbook.Unprotect Password:=strPwd\n\n Set ws = Worksheets(\"Inventory\")\n\nWith ws\n\n'get all the tombstone info into an array\ninfo = Array(Me.TxtFirst.Value, Me.TxtLast.Value, _\n            Me.TxtPRI.Value, Me.TxtGR.Value, _\n            Me.TxtLV.Value, Me.TxtLinguistic.Value, _\n            Me.TxtEmail.Value, Me.TxtResumeNum.Value, _\n            Me.TxtReason.Value, Me.TxtDate.Value)\n\n.Unprotect Password:=\"Transfer19\"\n\n'get the first empty row...\nSet rw = .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).EntireRow\n\n'loop over the province and city controls\nFor n = 1 To 10\n     'get province and city values\n     p = Me.Controls(\"ListProv\" &amp; n).Value\n     c = Me.Controls(\"ListCity\" &amp; n).Value\n\n    If n = 1 Or p &lt;&gt; \"\" Then\n        rw.Cells(1).Resize(1, 10).Value = info\n        rw.Cells(11).Value = p\n        rw.Cells(12).Value = c\n        Set rw = rw.Offset(1, 0)\n    End If\nNext n\n\n.Protect Password:=\"Transfer19\"\n\nEnd With\n\nThisWorkbook.Protect Password:=strPwd\n\nThisWorkbook.Save\n\nEnd Sub\n</code></pre>\n\n<p>This is what I tried which partially works. It finds the duplicates and replaces with the new information but it doesn't work with the present loop</p>\n\n<pre><code> 'searching for duplicates\n  Set r = ws.Range(\"C:C\").Find(Me.TxtPRI.Value, LookIn:=xlValues, lookat:=xlWhole)\n              If Not r Is Nothing Then\n    MsgBox \"Duplicate entry. The record is deleted and the new data is placed\"\n    iRow = r.Row\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553094070, "post_id": 55263870, "comment_id": 97259127, "body": "<code>Application.Trim</code> I believe works for VBA. Instead using the replace, after the Trim you could use <code>Split(STR, &quot; &quot;)</code>and finally <code>Join(arrSTR, &quot;_&quot;)</code>"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 3, "creation_date": 1553094258, "post_id": 55263870, "comment_id": 97259289, "body": "<code>Trim()</code> works. Use it first, before replacing the remaining spaces."}, {"owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "edited": false, "score": 0, "creation_date": 1553100523, "post_id": 55263870, "comment_id": 97263515, "body": "I see what i was doing wrong. I had the <code>Mid</code> length too long and it was picking up a period from the next column that i wasn&#39;t seeing, and why it looked like my <code>Trim</code> wasn&#39;t working."}], "answers": [{"comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1553094480, "post_id": 55264024, "comment_id": 97259428, "body": "Why split and join when you can just replace?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553094789, "post_id": 55264024, "comment_id": 97259668, "body": "Thought replace is a worksheetfunction, so doing that was faster?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553095042, "post_id": 55264024, "comment_id": 97259835, "body": "@Damian Well there is the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.replace\" rel=\"nofollow noreferrer\">WorksheetFunction.Replace method</a> (<i>Replaces part of a text string, based on the number of characters you specify, with a different text string.</i>) and the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/replace-function\" rel=\"nofollow noreferrer\">Replace function</a> (<i>Returns a string, in which a specified substring has been replaced with another substring</i>), but they do completely different things if you compare the documentation carefully."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553095054, "post_id": 55264024, "comment_id": 97259846, "body": "I wouldn&#39;t know without investigating."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553095146, "post_id": 55264024, "comment_id": 97259911, "body": "@P\u1d07\u029c i&#39;ve checked, yes... the worksheetfunction works for cells and the replace function works for a single string. There is something i&#39;ve learn today"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553095448, "post_id": 55264024, "comment_id": 97260122, "body": "@Damian actually that&#39;s not correct. The worksheetfunction substitutes a specific amount of characters in a specific position of a string (dosn&#39;t need to be a cell). It is not a &quot;search/replace&quot; like the replace function is. See the example in the link of the worksheetfunction. \u2022 The replace function searches for a specific substring and replaces it by another."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553095675, "post_id": 55264024, "comment_id": 97260274, "body": "@Damian Don&#39;t mix it up with the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.substitute\" rel=\"nofollow noreferrer\">WorksheetFunction.Substitute method</a>. \u2022 And yes, the names of these worksheetfunctions are indeed very confusing. ;)"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553095934, "post_id": 55264024, "comment_id": 97260465, "body": "As I was answering here i&#39;ve answered myself, I was refereing to <code>Cells.Replace</code> sorry."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553097540, "post_id": 55264024, "comment_id": 97261634, "body": "@Damian Well, yet another replace method ^^ didn&#39;t have had this one in mind."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1553094321, "creation_date": 1553094321, "answer_id": 55264024, "question_id": 55263870, "link": "https://stackoverflow.com/questions/55263870/using-replace-to-only-replace-a-small-portion-of-a-string/55264024#55264024", "title": "Using Replace to only replace a small portion of a string", "body": "<p>This way works fine:</p>\n\n<pre><code>Sub Test()\n\n    Dim STR As String, arrSTR\n\n    STR = \"89NL 10ETH A    \"\n    arrSTR = Split(Application.Trim(STR), \" \")\n    MsgBox Join(arrSTR, \"_\")\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553095130, "post_id": 55264059, "comment_id": 97259893, "body": "There is RTrim as well but the difference is probably minuscule."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553095260, "post_id": 55264059, "comment_id": 97259991, "body": "@AndyG Yes but just in case the OP needs to trim both. I would use <code>LTrim</code> or <code>RTrim</code> only in the rare cases where either left or right spaces should <b>not</b> be removed."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1553094415, "creation_date": 1553094415, "answer_id": 55264059, "question_id": 55263870, "link": "https://stackoverflow.com/questions/55263870/using-replace-to-only-replace-a-small-portion-of-a-string/55264059#55264059", "title": "Using Replace to only replace a small portion of a string", "body": "<p>Just <code>Trim</code> before you <code>Replace</code>:</p>\n\n<pre><code>Sub TrimTest()\n\n    Dim InputString As String\n    InputString = \"  89NL 10ETH A    \"\n\n    Debug.Print Replace$(Trim$(InputString), \" \", \"_\")\n\nEnd Sub\n</code></pre>\n\n<p><code>Trim</code> removes the spaces from <code>\"  89NL 10ETH A    \"</code> in the beginning and end <code>\"89NL 10ETH A\"</code> so the spaces in between can be replaced by underscore <code>\"89NL_10ETH_A\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "edited": false, "score": 0, "creation_date": 1553100698, "post_id": 55264737, "comment_id": 97263624, "body": "This correct. It is what I already had in place, but the <code>Mid</code> length was too long and i was picking up a period that I did not see, which gave the illusion that <code>Trim()</code> wasn&#39;t working."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 1, "last_activity_date": 1553096444, "creation_date": 1553096444, "answer_id": 55264737, "question_id": 55263870, "link": "https://stackoverflow.com/questions/55263870/using-replace-to-only-replace-a-small-portion-of-a-string/55264737#55264737", "title": "Using Replace to only replace a small portion of a string", "body": "<p>As @AndyG stated, you can use Replace() with Trim().</p>\n\n<p>You can use it with a text string</p>\n\n<pre><code>getProduct = Replace(Trim(\"89NL 10ETH A           \"), \" \", \"_\")\nMsgBox getProduct \n</code></pre>\n\n<p>Or, with a cell value</p>\n\n<pre><code>getProduct = Replace(Trim(Range(\"A1\").Value), \" \", \"_\")\nMsgBox getProduct \n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55264737, "answer_count": 3, "score": 1, "last_activity_date": 1553096444, "creation_date": 1553093913, "last_edit_date": 1553094205, "question_id": 55263870, "link": "https://stackoverflow.com/questions/55263870/using-replace-to-only-replace-a-small-portion-of-a-string", "title": "Using Replace to only replace a small portion of a string", "body": "<p>I am reading data from an text file, and I am trying to format it to match a Defined Name for a cell. The defined name is <code>89NL_10ETH_A</code> and the string is <code>89NL 10ETH A</code> but with a bunch of spaces after it. I used <code>Replace()</code> to convert spaces into \"_\", but all of the spaces at the end are converted to underscores. How can I trim the spaces off of a fixed length, mind you <code>Trim()</code> did not work because of the fixed length?</p>\n\n<p>This is how I am currently doing it</p>\n\n<pre><code>getProduct = Replace(Replace(Mid(Ln, 40, 24), \"#\", \"\"), \"%\", \"\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "32bit-64bit", "userform"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 9603644, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aABA7tMahX8/AAAAAAAAAAI/AAAAAAAAVBI/ASK5fKW8vK4/photo.jpg?sz=128", "display_name": "Delmar Silva", "link": "https://stackoverflow.com/users/9603644/delmar-silva"}, "edited": false, "score": 1, "creation_date": 1553270525, "post_id": 55264944, "comment_id": 97335551, "body": "I&#39;ll try out the ListGrid from the link you provided. thanks for the info."}, {"owner": {"reputation": 113, "user_id": 9603644, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aABA7tMahX8/AAAAAAAAAAI/AAAAAAAAVBI/ASK5fKW8vK4/photo.jpg?sz=128", "display_name": "Delmar Silva", "link": "https://stackoverflow.com/users/9603644/delmar-silva"}, "edited": false, "score": 0, "creation_date": 1553280486, "post_id": 55264944, "comment_id": 97340473, "body": "I noticed this: my PC has Win10 + Office16 both 64bit. When I check for the used references of my project, Ms Win Common Controls location shows up as in System32 as show in this image <a href=\"https://ibb.co/gPNVD46\" rel=\"nofollow noreferrer\">ibb.co/gPNVD46</a> and its Working fine... Now on another computer with a different office version, 10 also 64bit, I tried to register it on System32 without sucess, but I was able to register it on SysWOW64...and the Reference for Ms Win Common Controls Shows up on the list but I can&#39;t activate the control, it gives the error I previously posted..."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 113, "user_id": 9603644, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aABA7tMahX8/AAAAAAAAAAI/AAAAAAAAVBI/ASK5fKW8vK4/photo.jpg?sz=128", "display_name": "Delmar Silva", "link": "https://stackoverflow.com/users/9603644/delmar-silva"}, "edited": false, "score": 1, "creation_date": 1553284047, "post_id": 55264944, "comment_id": 97341933, "body": "Note that even Office versions allowing 64-bit, are frequently <i>installed</i> as <i>32bit version</i>. SysWOW64 stands for <i>System Windows(32-bit) on Windows(64-bit)</i>. 32-bit program trying to install their 32-bit lib files into <code>C:\\Windows\\System32</code>, will be redirected to <code>C:\\Windows\\SysWOW64</code>. If the other pc&#39;s Office actually is installed as 64 bit version, AFAIK there&#39;s no chance - cf. lit b) in answer - @DelmarSilva"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1553103492, "last_edit_date": 1553103492, "creation_date": 1553096989, "answer_id": 55264944, "question_id": 55263533, "link": "https://stackoverflow.com/questions/55263533/i-get-an-error-800a9cf1-while-adding-a-listview-control-to-a-userform/55264944#55264944", "title": "I get an error 800a9cf1 while adding a listview control to a userform", "body": "<p><code>a)</code> PC's with 32 bit Windows will run into issues with distributed files saved in 64 bit windows as the libraries are registered in different folders (System32 vs SysWOW64).\nYou could try to goto Excel, delete the library reference on a 32-bit-Office pc manually, re-enter a renewed ListView reference and re-save the project locally. \n<code>b)</code> Furthermore the Treeview control represents no native MSForms control and cannot be used at all, if Office is installed as 64 bit version. \nThere exist professional solutions, such as a <a href=\"https://www.jkp-ads.com/Articles/treeview.asp\" rel=\"nofollow noreferrer\">MSForms (all VBA) treeview</a> <em>(offering even a free code demo in a simplified version)</em>.</p>\n"}], "owner": {"reputation": 113, "user_id": 9603644, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aABA7tMahX8/AAAAAAAAAAI/AAAAAAAAVBI/ASK5fKW8vK4/photo.jpg?sz=128", "display_name": "Delmar Silva", "link": "https://stackoverflow.com/users/9603644/delmar-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 55264944, "answer_count": 1, "score": 1, "last_activity_date": 1553103492, "creation_date": 1553093047, "last_edit_date": 1592644375, "question_id": 55263533, "link": "https://stackoverflow.com/questions/55263533/i-get-an-error-800a9cf1-while-adding-a-listview-control-to-a-userform", "title": "I get an error 800a9cf1 while adding a listview control to a userform", "body": "<p>I have several userforms that use ListView Control, but it doesn't load in some of our pcs with Windows 10 / Office 10.\nI found out that the reference Microsoft Windows Common Controls 6.0 (SP6) was missing and then I learned how to register it using regsvr32.\nNow that i have the reference correctly registered, I can see the listview control in the adittional controls list, and was able to activate it, but when I try to add the control to a form, the error in the Picture below shows up...\nDoes anyone know whats going on?</p>\n<p><a href=\"https://i.stack.imgur.com/fuSjh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fuSjh.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1553092999, "post_id": 55263433, "comment_id": 97258312, "body": "To give meaningful help we need more background about what you&#39;re currently doing to solve this problem. However, this article might be of use <a href=\"https://www.contextures.com/xlDataVal02.html\" rel=\"nofollow noreferrer\">contextures.com/xlDataVal02.html</a>"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1553095474, "post_id": 55263433, "comment_id": 97260137, "body": "if you select Unit, Date and one of the elements, you end up with just one number. What kind of chart do you want to build with that? Mock up the desired outcome manually and post that into your question."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1553097021, "post_id": 55263433, "comment_id": 97261243, "body": "Not sure if that can all be done in one step in Excel formulas.  You could however break it into parts potentially.  Build a list off to the side or another sheet that filters via formula for the information you are looking for.  Then turn around and make a named dynamic range where your filtered information is that you can use for graphing.  VBA you can program this all behind the scenes"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 5054115, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-cPjHWFxWhto/AAAAAAAAAAI/AAAAAAAAAEU/nj0UhLvWWI8/photo.jpg?sz=128", "display_name": "Dallas Walker", "link": "https://stackoverflow.com/users/5054115/dallas-walker"}, "is_accepted": true, "score": 0, "last_activity_date": 1562778408, "creation_date": 1562778408, "answer_id": 56975517, "question_id": 55263433, "link": "https://stackoverflow.com/questions/55263433/dynamic-excel-chart-from-dataset/56975517#56975517", "title": "Dynamic Excel Chart From Dataset", "body": "<p>Just to let everyone know I had to put the data in a sqlite db and pull it from there</p>\n"}], "owner": {"reputation": 27, "user_id": 5054115, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-cPjHWFxWhto/AAAAAAAAAAI/AAAAAAAAAEU/nj0UhLvWWI8/photo.jpg?sz=128", "display_name": "Dallas Walker", "link": "https://stackoverflow.com/users/5054115/dallas-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56975517, "answer_count": 1, "score": 0, "last_activity_date": 1562778408, "creation_date": 1553092817, "last_edit_date": 1553093541, "question_id": 55263433, "link": "https://stackoverflow.com/questions/55263433/dynamic-excel-chart-from-dataset", "title": "Dynamic Excel Chart From Dataset", "body": "<p>I have a dataset with different units and dates for each unit that come back with readings of stuff in the oil and i'm trying to make a dynamic chart that I can do a drop down of said unit and a drop down for the date and element and for it to populate a chart.  I can't seem to get it right at all due to the third piece of data.  Does anyone have a suggestion?  </p>\n\n<p>an example is below\n<a href=\"https://i.stack.imgur.com/WpkPe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WpkPe.png\" alt=\"Data Set\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 0, "creation_date": 1553091843, "post_id": 55262924, "comment_id": 97257414, "body": "make sure that the computer does not have a <code>PERSONAL.XLSB</code> workbook - it gets loaded when Excel starts. try to check in <code>C:\\Users\\&lt;username&gt;\\Roaming\\Microsoft\\Excel\\XLSTART\\PERSONAL&zwnj;&#8203;.XLSB</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 0, "creation_date": 1553091911, "post_id": 55262924, "comment_id": 97257461, "body": "if you add <code>Debug.Assert False</code> line in your <code>Workbook_Open</code> (or better make a new workbook with just that as it&#39;s <code>Workbook_Open</code>) it will break any running macros. This can help you spot what is happening."}, {"owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "edited": false, "score": 0, "creation_date": 1553092295, "post_id": 55262924, "comment_id": 97257727, "body": "Thanks I will try those out, so I am assuming I should delete Personal.XLSB on that computer?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553092457, "post_id": 55262924, "comment_id": 97257855, "body": "What is <code>&quot;*FilePath*&quot;</code>?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553092772, "post_id": 55262924, "comment_id": 97258126, "body": "Set a breakpoint a <code>Set x</code> and at <code>End Sub</code> and run the whole thing from the debugger. See where/when <code>y</code> is closed. Do not use the Step command; that can produce different results."}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "is_accepted": false, "score": 0, "last_activity_date": 1553262617, "creation_date": 1553262617, "answer_id": 55301077, "question_id": 55262924, "link": "https://stackoverflow.com/questions/55262924/any-idea-why-xlsm-file-automatically-closes-on-open-only-on-one-computer-on-netw/55301077#55301077", "title": "Any idea why XLSM File automatically closes on open only on one computer on network?", "body": "<p>The problem was fixed by opening the file in safe mode and saving it.</p>\n"}], "owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553262617, "creation_date": 1553091425, "last_edit_date": 1553091983, "question_id": 55262924, "link": "https://stackoverflow.com/questions/55262924/any-idea-why-xlsm-file-automatically-closes-on-open-only-on-one-computer-on-netw", "title": "Any idea why XLSM File automatically closes on open only on one computer on network?", "body": "<p>We have over 10 computers on our network and everyone's computer opens up the file with no issue. Even this one computer that is having it automatically close on open used to have it work without a problem until this morning. I created a copy of the file to see if it was the file that was corrupted but when the copy is opened the same thing happens. Does anyone have any idea why this would start happening, I do not see any problems with the code. The computers are operating on windows 10 pro. Here is the code that runs on open, it is only supposed to close workbook x but it is closing y as well only on his computer starting today.</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim x As Workbook\nDim y As Workbook\nDim z As Integer\nSet x = Workbooks.Open(Filename:=\"*FilePath*\", ReadOnly:=True)\nSet y = Workbooks(\"MonthlyLog\")\nx.Sheets(\"Distribution Lists\").Range(\"A2:F1200\").Copy\ny.Sheets(\"Distribution Lists\").Range(\"A124:F1322\").PasteSpecial\nApplication.CutCopyMode = False\nx.Close\nIf month(Now) = 1 Then\n    z = 12\nElse\n    z = month(Now) - 1\nEnd If\nSheets(MonthName(z)).Activate\n\nApplication.Calculation = xlManual\n\nEnd Sub\n</code></pre>\n\n<p>It isn't asking to repair anything just prompting to save right upon opening and if Save or Do Not Save are chosen then it closes, only when cancel is clicked it stays open.</p>\n"}, {"tags": ["excel", "vba", "countdown"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1553091806, "post_id": 55262398, "comment_id": 97257379, "body": "I would go with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.ontime\" rel=\"nofollow noreferrer\">Application.OnTime</a> rather than trying to do something recursively (with concerns about the call stack)."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1553092181, "post_id": 55262398, "comment_id": 97257645, "body": "Like Andy mentions, using <code>Application.Wait</code> is holding you back since it locks everything down while it runs. <a href=\"https://www.myonlinetraininghub.com/timer-stopwatch-excel-vba\" rel=\"nofollow noreferrer\">This site has an interesting implementation</a> that includes <code>DoEvents</code> instead"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5580927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bQV6A.jpg?s=128&g=1", "display_name": "ellebaek", "link": "https://stackoverflow.com/users/5580927/ellebaek"}, "is_accepted": false, "score": 0, "last_activity_date": 1553091566, "creation_date": 1553091566, "answer_id": 55262983, "question_id": 55262398, "link": "https://stackoverflow.com/questions/55262398/problem-with-building-count-down-timer-in-excel-using-vba/55262983#55262983", "title": "Problem with building count down timer in Excel using VBA", "body": "<p>Your entire code is working fine for me (also including the <code>[a2]</code> part). I'm on Windows 7 with Excel 2013.</p>\n\n<p>I suggest you include a stopping condition to <code>abc()</code> like</p>\n\n<pre><code>If [a1] &gt; 0 Then\n   Call def\nEnd If\n</code></pre>\n\n<p>Please provide some more information.</p>\n"}, {"tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1553092079, "last_edit_date": 1553092079, "creation_date": 1553091723, "answer_id": 55263042, "question_id": 55262398, "link": "https://stackoverflow.com/questions/55262398/problem-with-building-count-down-timer-in-excel-using-vba/55263042#55263042", "title": "Problem with building count down timer in Excel using VBA", "body": "<p>Why not create a function btw? Does it work for you?</p>\n\n<pre><code>Function wait(seconds As Long)\n\n    Dim originalStatusBar As String, i As Long\n    originalStatusBar = Application.StatusBar\n\n    For i = seconds To 0 Step -1\n        Application.wait (Now + TimeValue(\"0:00:01\"))\n        Application.StatusBar = \"Start in \" &amp; i &amp; \" seconds\"\n    Next\n\n    Application.StatusBar = originalStatusBar\n\nEnd Function\n</code></pre>\n\n<p>Then in your sub you just call it like so:</p>\n\n<pre><code>wait 5 'waits 5 seconds and updates status bar with remaining time\n</code></pre>\n\n<p>or</p>\n\n<pre><code>wait [a1]-1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553092954, "post_id": 55263199, "comment_id": 97258280, "body": "I realized that the reason why my code first worked and then failed must have something to do with &quot;call stack&quot; you mentioned, although I&#39;m not exactly sure what does it mean, but I feel it&#39;s like something is taking up the memory that kind of stuff, because when I try to run my other program, it also return the error message of interruption! So what exactly did my countdown program do in the background so that caused this problem?"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 1, "creation_date": 1553093280, "post_id": 55263199, "comment_id": 97258545, "body": "Roughly, each time a procedure is called some space/ data structure is allocated for it to store its state; think about this as storing local variables. Because the procedure calls itself, another such block is created, and another. Until the whole sequence exits (unwinds) this storage accumulates, potentially leading to a <i>stack overflow</i>. OnTime avoids this because the procedure exits each time; it just calls it again after a second."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553093408, "post_id": 55263199, "comment_id": 97258635, "body": "&quot;Code execution has been interrupted.&quot;, though, suggests that the code was interrupted by pressing Stop or Ctrl-Break, rather than indicating a problem with the stack. (You would have to interrupt it because you don&#39;t have an escape clause.)"}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553120413, "post_id": 55263199, "comment_id": 97273208, "body": "Thank you so much! So did you mean that in the MyTimer sub, as soon as Application.OnTime is executed, the sub ends because it takes far less than a second for the program to reach and execute the End Sub line, and computer only needs to allocate space for one program actually. So in other word, suppose the time interval assigned to OnTime is smaller than it takes to run the rest of the code until End Sub is reaches, then it will recursively call the other Sub and cause call stack problem again? If I understood correctly?"}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553120680, "post_id": 55263199, "comment_id": 97273294, "body": "I also tried within one Sub to add Application.wait inside a Do While Loop, but also return the execution was interrupted error message, not quite understand what is it now in this case where there\u2019s only one Sub, so shouldn\u2019t be call stack, just try to \u201cslow down\u201d the loop."}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553121230, "post_id": 55263199, "comment_id": 97273465, "body": "And in a scenario for example, now it is 4:55pm and I wish to count down to 5pm, and also at 5pm to run another VBA program using another Application.OnTime. I\u2019m concern that at exactly 5pm, there will be two programs running, because the timer will have say Now is 4:59:59, so plus TimeValue(\u201c00:00:01\u201d) will then make it 5pm. Will there actually be any conflict? I heard that only one program can be run at a time. Also, how to cancel manually before the timer reaches the end? I tried clicking the stop button in VBE both inside Timer Sub and Button1_Click Sub, but the countdown just don\u2019t stop."}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553121725, "post_id": 55263199, "comment_id": 97273603, "body": "And you mentioned that until the whole sequence exits this storage accumulates, so is there any way to release the space/ data structure without a reboot? Even after I closed Excel and reopen, my other program still couldn\u2019t be run, I have to log off. Shouldn\u2019t everything be emptied and released after Sub is ended? Sorry for these many questions."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553158588, "post_id": 55263199, "comment_id": 97283605, "body": "Application.OnTime sets Excel to do something when the time arises. This instruction then no longer has anything to do with the current procedure that is running. It has no influence on when the current procedure exits or its stack is cleared. [Well, I suppose that is not entirely accurate, because the time could arise before the procedure exits.] Anyway, extended secondary discussions are not encouraged in the forum."}, {"owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553196915, "post_id": 55263199, "comment_id": 97305599, "body": "Alright, so just wanted to ask to turn off the timer manually before it reaches 0, do I just add \u201cFalse\u201d to the command: Application.OnTime Now + TimeValue(&quot;00:00:01&quot;), &quot;MyTimer&quot;? Thanks!"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "edited": false, "score": 0, "creation_date": 1553244272, "post_id": 55263199, "comment_id": 97319855, "body": "Set what to false??! Not sure where you got that from. My added code in the answer stops setting OnTime when the value reaches 0, so nothing further will happen."}], "tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1553092159, "creation_date": 1553092159, "answer_id": 55263199, "question_id": 55262398, "link": "https://stackoverflow.com/questions/55262398/problem-with-building-count-down-timer-in-excel-using-vba/55263199#55263199", "title": "Problem with building count down timer in Excel using VBA", "body": "<p>Rather than trying to do this recursively, with concerns about the call stack, I would use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.ontime\" rel=\"nofollow noreferrer\">Application.OnTime</a>.</p>\n\n<pre><code>Sub Button1_Click()\n    Call MyTimer\n\nEnd Sub\n\nSub MyTimer()\n    [a1] = [a1] - 1\n\n    Application.OnTime Now + TimeValue(\"00:00:01\"), \"MyTimer\"\nEnd Sub\n</code></pre>\n\n<p>I suppose this is still 'recursive' in a fashion, but the procedure exits each time. Only after 1 second has elapsed does it execute the procedure again.</p>\n\n<p>But, either way, you should include some means of stopping the process. For example,</p>\n\n<pre><code>Sub MyTimer()\n    [a1] = [a1] - 1\n\n    If [a1] &gt; 0 Then\n        Application.OnTime Now + TimeValue(\"00:00:01\"), \"MyTimer\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9177576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b447053507c02094068f3f55e52829f?s=128&d=identicon&r=PG", "display_name": "Passer-by", "link": "https://stackoverflow.com/users/9177576/passer-by"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 55263199, "answer_count": 3, "score": 0, "last_activity_date": 1553092159, "creation_date": 1553089938, "last_edit_date": 1553091768, "question_id": 55262398, "link": "https://stackoverflow.com/questions/55262398/problem-with-building-count-down-timer-in-excel-using-vba", "title": "Problem with building count down timer in Excel using VBA", "body": "<p>I was trying to build a count down timer using VBA, and the result can be dynamically output to an Excel cell. I let procedure abc and def recursively call each other (did not set a stop point just for testing), and it worked. However, later with this exact same code I ran again, it failed, and error message was: </p>\n\n<blockquote>\n  <p>Code execution has been interrupted. </p>\n</blockquote>\n\n<p>Just can't figure out why, I didn't change anything, how could it work and then fail? </p>\n\n<p>I tried <code>On Error Resume Next</code> and <code>Application.DisplayAlert = False</code>, both don't stop the error message popping up and the interruption of the code execution. And if I step through the procedures, it seems fine...</p>\n\n<p>Also I wish to add a dynamic text like \"start in how many seconds\" like in the comment in another cell. Can it be realized in this way? </p>\n\n<p>Thank you!</p>\n\n<pre><code>Sub abc()\n\n    [a1] = [a1] - 1\n    ' [a2] = \"Start in \" &amp; [a1] &amp; \" seconds.\"\n    Call def\n\nEnd Sub\n\n\nSub def()\n\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n    Call abc\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553090287, "post_id": 55262391, "comment_id": 97256298, "body": "Do they all return different data?"}, {"owner": {"reputation": 505, "user_id": 9571463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f1892c8482f2534cfced75736c97c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coldchain9", "link": "https://stackoverflow.com/users/9571463/coldchain9"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553090387, "post_id": 55262391, "comment_id": 97256348, "body": "Yes. They return 2 columns and in the same format but have been categorized differently. They will not share values."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553090518, "post_id": 55262391, "comment_id": 97256425, "body": "Sounds like it is your logic that dictates you have three SELECT statments that accidently have the same format. You&#39;ll just have to do all three of them."}, {"owner": {"reputation": 505, "user_id": 9571463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f1892c8482f2534cfced75736c97c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coldchain9", "link": "https://stackoverflow.com/users/9571463/coldchain9"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553090791, "post_id": 55262391, "comment_id": 97256622, "body": "@PaulOgilvie I need them to be returned to different tables because someone has to do a mail merge off of each table (Different e-mail template for each table&#39;s results)"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1553091254, "post_id": 55262391, "comment_id": 97257006, "body": "So do three queries. They need to return different pieces of data and used in different processes."}, {"owner": {"reputation": 505, "user_id": 9571463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f1892c8482f2534cfced75736c97c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coldchain9", "link": "https://stackoverflow.com/users/9571463/coldchain9"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1553091505, "post_id": 55262391, "comment_id": 97257177, "body": "@SeanLange Yes that is what I currently have I was just wondering if there is a way to make it return multiple select statements from a single query into separate tables. That was the gist of my whole post."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1553091674, "post_id": 55262391, "comment_id": 97257293, "body": "No that isn&#39;t possible. A query returns a single result set. You could create a stored procedure that can return multiple result sets but I doubt it is going to be worth the effort. The performance from the sql side of things would be no different. It would still have to execute three queries. I would just stick with what you have right now as any change in the direction you are thinking is going to result in a lot of work with no benefit."}, {"owner": {"reputation": 505, "user_id": 9571463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f1892c8482f2534cfced75736c97c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coldchain9", "link": "https://stackoverflow.com/users/9571463/coldchain9"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1553091792, "post_id": 55262391, "comment_id": 97257364, "body": "@SeanLange Got it. The query run for a pretty small amount of time each so it isn&#39;t too bad to run them all separately, I was just thinking if it was possible to optimize."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1553091867, "post_id": 55262391, "comment_id": 97257430, "body": "You seem to be selecting all columns and all rows from three different tables. There is nothing to optimize there. ;)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553092037, "post_id": 55262391, "comment_id": 97257539, "body": "<i>&quot;multiple select statements from a single query&quot;</i> Well, since the semi-colon is the SQL statement terminator, you could try to concatenate the three Select queries into one string and run that SQL &quot;query&quot; but I would have no idea what/which querie the server returns, so tellling it where to put which result remains a mistery to me."}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 9571463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f1892c8482f2534cfced75736c97c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coldchain9", "link": "https://stackoverflow.com/users/9571463/coldchain9"}, "edited": false, "score": 0, "creation_date": 1553187347, "post_id": 55285215, "comment_id": 97300896, "body": "The SELECT * statements are coming from a large query that I have stored in an Excel tab for microsoft query to take as command text. I then have 3 temp tables that I create in that query that I would like to return the data from. How would this vba code know to take from that large query?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 505, "user_id": 9571463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f1892c8482f2534cfced75736c97c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coldchain9", "link": "https://stackoverflow.com/users/9571463/coldchain9"}, "edited": false, "score": 0, "creation_date": 1553187674, "post_id": 55285215, "comment_id": 97301105, "body": "Sorry can&#39;t help on that part - ADO will return the data but I&#39;ve no idea how Excel does connections."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1553186149, "creation_date": 1553186149, "answer_id": 55285215, "question_id": 55262391, "link": "https://stackoverflow.com/questions/55262391/how-to-return-multiple-select-statements-from-vba-excel/55285215#55285215", "title": "How to return multiple SELECT statements from VBA Excel", "body": "<p>It's perfectly possible to return multiple recordsets from a single query - that's what the ADO command NextRecordset is for. The full details are <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/nextrecordset-method-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">here</a>  but briefly just join the queries using :   \"SELECT * FROM table1;SELECT * FROM table2\".  However the multiple recordsets have to be on the same connection.</p>\n\n<pre><code> Dim rs as new recordset\n set rs = connections(1).execute(\"Select * from table1:select * from table2)\n msgbox rs(0)\n rs.nextrecordset\n msgbox rs(0)\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 9571463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f1892c8482f2534cfced75736c97c8b?s=128&d=identicon&r=PG&f=1", "display_name": "Coldchain9", "link": "https://stackoverflow.com/users/9571463/coldchain9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 622, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553186149, "creation_date": 1553089908, "last_edit_date": 1553089968, "question_id": 55262391, "link": "https://stackoverflow.com/questions/55262391/how-to-return-multiple-select-statements-from-vba-excel", "title": "How to return multiple SELECT statements from VBA Excel", "body": "<p>I have a VBA procedure setup within Excel to take some text inserted into an Excel tab and send it in as command text for a SQL query to complete.</p>\n\n<p>However, in my query I have 3 different tables that I want to return separately (hence the 3 different connections in my VBA code).</p>\n\n<p>Is there a way to use my query to return the three different tables so I don't have to run the query 3 separate times just to grab a different select statement at the end?</p>\n\n<p>End of Query code:</p>\n\n<pre><code>SELECT * FROM #MailMergeFormatStep1\nSELECT * FROM #MailMergeFormatStep2\nSELECT * FROM #MailMergeFormatStep3\n</code></pre>\n\n<p>I want the results from each of these select statements to be ran and returned into a separate table connection in Excel.</p>\n\n<p>Code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub UploadCheckerQuery()\n\nActiveWorkbook.Connections(\"UploadCheckerConnection1\").ODBCConnection.CommandText = Sheets(\"SQL1\").Range(\"A5:A400\").Value\nActiveWorkbook.Connections(\"UploadCheckerConnection1\").Refresh\n\nActiveWorkbook.Connections(\"UploadCheckerConnection2\").ODBCConnection.CommandText = Sheets(\"SQL2\").Range(\"A5:A400\").Value\nActiveWorkbook.Connections(\"UploadCheckerConnection2\").Refresh\n\nActiveWorkbook.Connections(\"UploadCheckerConnection3\").ODBCConnection.CommandText = Sheets(\"SQL3\").Range(\"A5:A400\").Value\nActiveWorkbook.Connections(\"UploadCheckerConnection3\").Refresh\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 0, "creation_date": 1553087488, "post_id": 55261540, "comment_id": 97254447, "body": "Did you try CHR()? There&#39;s also vbCrLf which might work."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 0, "creation_date": 1553087800, "post_id": 55261540, "comment_id": 97254647, "body": "chr()? what? @MichaelMurphy"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 5, "last_activity_date": 1553088476, "last_edit_date": 1553088476, "creation_date": 1553088145, "answer_id": 55261756, "question_id": 55261540, "link": "https://stackoverflow.com/questions/55261540/insert-a-line-break-altenter-with-vba/55261756#55261756", "title": "Insert a line break (Alt+Enter) with VBA", "body": "<p>The <code>vbLf</code> or <code>Chr(10)</code> is the equivalent of a line break whithin a cell. So the following should work:</p>\n\n<pre><code>Call CharactersReplace(xRg, \"Test1\", vbLf, True)\n</code></pre>\n\n<p>Also make sure that <code>.WrapText</code> of that cell is <code>True</code>.</p>\n\n<p>eg: <code>Range(\"A1\").WrapText = True</code> otherwise you will insert a line break but won't see it.</p>\n"}], "owner": {"reputation": 15, "user_id": 8914550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9cb938a88452784e1bff0367bdd4a2?s=128&d=identicon&r=PG&f=1", "display_name": "Michelozzo8", "link": "https://stackoverflow.com/users/8914550/michelozzo8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1700, "favorite_count": 0, "accepted_answer_id": 55261756, "answer_count": 1, "score": 0, "last_activity_date": 1553157220, "creation_date": 1553087415, "last_edit_date": 1553157220, "question_id": 55261540, "link": "https://stackoverflow.com/questions/55261540/insert-a-line-break-altenter-with-vba", "title": "Insert a line break (Alt+Enter) with VBA", "body": "<p>I have a VBA Macro for relacing a word with another one in Excel.</p>\n\n<pre><code>Call CharactersReplace(xRg, \"Test1\", \"Test2\", True)\n</code></pre>\n\n<p>It is working nicely but I want to do <kbd>Alt</kbd>+<kbd>Enter</kbd> on the cell of Excel (instead of Test2).  </p>\n\n<p>Literally I want to do the line wrap within the cell.</p>\n\n<p>Example:</p>\n\n<pre><code>From: Hey How are you? Test1 Bla Bla\nTo: Hey How are you?\nBla Bla\n</code></pre>\n\n<p>There is a code on VBA to do it? I tried to do CHA(10) etc. but they are not working.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553086276, "post_id": 55261025, "comment_id": 97253720, "body": "VBA Projects cannot stay opened if their file gets closed, because VBA is a part of the workbook. If you close a workbook and its VBA remains open that means your workbook did not close proplerly and you should fix that instead of trying to workaround. \u2022 Also note that <code>.Visible = False</code> does not close anything but hide. That means it remains open."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 4, "creation_date": 1553086386, "post_id": 55261025, "comment_id": 97253800, "body": "<code>On Error Resume Next</code> (with no attempt to test for and respond to errors) is already an indication that you are doing something problematic."}, {"owner": {"reputation": 1, "user_id": 11232004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vd4ovzpJQ3s/AAAAAAAAAAI/AAAAAAABZuM/4RaVeGQvr-Y/photo.jpg?sz=128", "display_name": "Darrell Mee", "link": "https://stackoverflow.com/users/11232004/darrell-mee"}, "edited": false, "score": 0, "creation_date": 1553086498, "post_id": 55261025, "comment_id": 97253862, "body": "Thanks for your advise!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553086801, "post_id": 55261025, "comment_id": 97254061, "body": "@DarrellMee I think you are up the wrong tree. Can you improve (<a href=\"https://stackoverflow.com/posts/55261025/edit\">edit</a>) your question and add more information about how are your workbooks opened/closed (manually or by code). Because I think this is a <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">X/Y-Problem</a> and you asked just the wrong question. Your actual issue is something else, but we need more details on what is actually going on to really help you. \u2022 Best would be if you could provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to illustrate your actual issue. Sounds like you got a memory leak somewhere else."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1553088280, "post_id": 55261025, "comment_id": 97254937, "body": "<i>&quot;[snip]to stop the memory error appearing.&quot;</i>  What memory error?  There is no mention of one earlier in the question..."}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 6727791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kNiVW.jpg?s=128&g=1", "display_name": "justtrying", "link": "https://stackoverflow.com/users/6727791/justtrying"}, "is_accepted": false, "score": 0, "last_activity_date": 1553086326, "creation_date": 1553086326, "answer_id": 55261207, "question_id": 55261025, "link": "https://stackoverflow.com/questions/55261025/vba-to-force-close-on-protected-project/55261207#55261207", "title": "vba to force close on protected project", "body": "<p>Have you tried adding \"Set Application.ThisWorkbook = Nothing\" after closing in vba?</p>\n\n<p><code>Workbooks.Open ThisWorkbook.FullName</code></p>\n\n<p><code>ThisWorkbook.Close False</code></p>\n\n<p><code>Set Application.ThisWorkbook = Nothing</code></p>\n\n<p>This has helped me with a similar issue in the past of VBA remaining after closing a workbook out.</p>\n"}], "owner": {"reputation": 1, "user_id": 11232004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vd4ovzpJQ3s/AAAAAAAAAAI/AAAAAAABZuM/4RaVeGQvr-Y/photo.jpg?sz=128", "display_name": "Darrell Mee", "link": "https://stackoverflow.com/users/11232004/darrell-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553086326, "creation_date": 1553085657, "last_edit_date": 1553086193, "question_id": 55261025, "link": "https://stackoverflow.com/questions/55261025/vba-to-force-close-on-protected-project", "title": "vba to force close on protected project", "body": "<p>We use this to force close vba projects that stay open after closing the Excel workbook;</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    On Error Resume Next\n    If Not (Application.VBE.MainWindow.Visible) Then\n        Application.VBE.MainWindow.Visible = True\n        Application.VBE.MainWindow.Visible = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>It works fine until you protect the project. Once you protect the project it stays open again even when you close the Excel workbook.</p>\n\n<p>Our only workaround is to periodically close all Excel instances a few times a day to stop the memory error appearing.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553088129, "post_id": 55260788, "comment_id": 97254854, "body": "For the first issue; I dont see that you defined what <code>FileInZip</code> is.  For the second issue you havent defined what <code>Shell</code> is.  VBA is looking for the object reference for both of those."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1553088722, "post_id": 55260788, "comment_id": 97255231, "body": "@ZackE Thank you for the reply. <code>FileInZip</code>, as my understanding goes, will simply be an element of what is in the <code>ZipFile</code>. Similar to how <code>FileInFolder</code> is not defined, but fills the gap of a file variable in the base folder.See this line <code>FileInFolder In FSO.GetFolder(x).Files</code>. The second issue with not having defined <code>Shell</code> is that 1) In every example I found, no one has &quot;defined&quot; <code>Shell</code>, they simply reference it like referencing any other data type. 2) If there is a reference to be added, I don&#39;t know about it and I cannot seem to find one either."}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1553089535, "post_id": 55262035, "comment_id": 97255774, "body": "Thank you for your answer :) First of all, THANK YOU SO MUCH for telling me which reference to use for <code>Shell</code>. Then secondly, I don&#39;t get any errors but with that said, the <code>If Statement</code> doesn&#39;t seem to find a match, even though there is a <code>.xls</code> file in the zip folder."}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 1, "last_activity_date": 1553089015, "creation_date": 1553089015, "answer_id": 55262035, "question_id": 55260788, "link": "https://stackoverflow.com/questions/55260788/open-zipfile-look-for-specific-file-type-and-save-file-name/55262035#55262035", "title": "Open ZipFile, Look for Specific File Type And Save File Name", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\n\n' Just to test CheckZipFolder\nSub TestZip()\n\n    Dim sZipFold As String: sZipFold = \"C:\\Temp\\MyZip.zip\"      ' Change this to the path to your zip file\n    CheckZipFolder sZipFold\n\nEnd Sub\n\n\nSub CheckZipFolder(ByVal sZipFold As String)\n\n    Dim oSh As New Shell        ' For this, you need to add reference to 'Microsoft Shell Controls and Automation'\n    Dim oFi As Object\n\n    ' Loop through all files in the folder\n    For Each oFi In oSh.Namespace(sZipFold).Items\n\n        ' Checking for file type (excel file in this case)\n        If oFi.Type = \"Microsoft Excel Worksheet\" Then\n            MsgBox oFi.Name\n            '..... Add your actions here\n        End If\n\n        ' This will make the UDF recursive. Remove this code if not needed\n        If oFi.IsFolder Then\n            CheckZipFolder oFi.Path\n        End If\n    Next\n\n    ' Clear object\n    Set oSh = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1553089867, "post_id": 55262105, "comment_id": 97255999, "body": "THANK YOU SO MUCH!!! Thank you for the advice as well, I was planning to go through the code later to fix it and make it more cleaner and efficient, but you have at least given some advice on where to get started. Thank you so so much, my brain is sore from trying to figure it out already. This works 100%!!! :)"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1553089214, "creation_date": 1553089214, "answer_id": 55262105, "question_id": 55260788, "link": "https://stackoverflow.com/questions/55260788/open-zipfile-look-for-specific-file-type-and-save-file-name/55262105#55262105", "title": "Open ZipFile, Look for Specific File Type And Save File Name", "body": "<p>Your main problem is a really simple one: Your path <code>\"C:\\Users\\UserName\\Desktop\\Today\\MyFolder\\\"</code> contains already a trailing backslash, and when you set your <code>ZipFile</code>-variable, you are adding another one between path and filename. This will cause the <code>shell</code>-command to fail and <code>ZipFile</code> is <code>nothing</code>.</p>\n\n<p>There are some minor problems with the code. I would recommend to use the <code>GetExtensionName</code> of your FileSystemObject to get the extension and convert this to lowercase so that you catch all files, no matter if they are <code>.PNG</code>, <code>.png</code> or <code>.Png</code> </p>\n\n<pre><code>   For Each FileInFolder In FSO.GetFolder(x).Files\n        Dim fileExt As String\n        fileExt = LCase(FSO.GetExtensionName(FileInFolder.Name))\n\n        If fileExt = \"png\" Then\n            CountContents = CountContents + 1\n            Debug.Print \"unzipped \" &amp; FileInFolder.Name\n        ElseIf fileExt = \"zip\" Then\n\n            Dim ZipFileName As String, ZipFile, fileInZip\n            Set sh = CreateObject(\"Shell.Application\")\n            ZipFileName = x &amp; FileInFolder.Name\n            Set ZipFile = sh.Namespace(CVar(ZipFileName))\n\n            For Each fileInZip In ZipFile.Items\n                If LCase(FSO.GetExtensionName(fileInZip)) = \"png\" Then\n                    CountContents = CountContents + 1\n                    Debug.Print \"zipped in \" &amp; FileInFolder.Name &amp; \": \" &amp; fileInZip\n                End If\n            Next\n        End If\n    Next FileInFolder\n</code></pre>\n\n<p>Additionally the strong advice to use <code>Option Explicit</code> and define all your variables. And split commands into smaller pieces. This costs you only a few seconds of typing the extra lines but helps you when debugging your code:</p>\n\n<pre><code>' Instead of\n' Set ZipFile = sh.Namespace(CVar(x &amp; \"\\\" &amp; FileInFolder.Name)) \n' write\nDim fName as string\nfName = x &amp; \"\\\" &amp; FileInFolder.Name; ' Now you can check fName and see the problem.\nSet ZipFile = sh.Namespace(CVar(fName))\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 55262105, "answer_count": 2, "score": 2, "last_activity_date": 1553089214, "creation_date": 1553084831, "last_edit_date": 1553085337, "question_id": 55260788, "link": "https://stackoverflow.com/questions/55260788/open-zipfile-look-for-specific-file-type-and-save-file-name", "title": "Open ZipFile, Look for Specific File Type And Save File Name", "body": "<p>So I posted a question here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/55177263/vba-find-specific-sub-folders-by-name-identifiers\">VBA - Find Specific Sub Folders by Name Identifiers</a></p>\n\n<p>This question was very broad, but I was facing specific issues I needed help identifying and resolving. Now, I managed to resolve those issues in the original post, however, there is still a good portion of the question unanswered and I would like to close the question only when I am able to post the full result.</p>\n\n<p>Currently, what I still need to do, it the last 4 steps:</p>\n\n<ol>\n<li>Open ZipFile</li>\n<li>Look for .png extenstion</li>\n<li>Grab the name of the .png file</li>\n<li>Put the name in a cell in excel</li>\n</ol>\n\n<p>The issue I am facing, is that of properly opening the zip file. I been through so many posts on this but NOTHING seems to work for me.</p>\n\n<p>The closest I have come to accomplishing the task is what I found here:</p>\n\n<p><a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/109333-how-to-count-number-of-items-in-zip-file-with-vba-2007\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/help-forums/excel-general/109333-how-to-count-number-of-items-in-zip-file-with-vba-2007</a></p>\n\n<p>I figure, if at the very least, I am able to enter the zip file, I can then work from there. But alas, I am still stuck at simply trying to open the file.</p>\n\n<p>Here is the code I have (Using from the link above):</p>\n\n<pre><code>Sub CountZipContents()\n\n    Dim zCount As Double, CountContents As Double\n    Dim sh As Object, fld As Object, n As Object\n    Dim FSO As Object\n\n    CountContents = 0\n    zCount = 0\n\n    x = \"C:\\Users\\UserName\\Desktop\\Today\\MyFolder\\\"\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    If FSO.FolderExists(x) Then\n\n        For Each FileInFolder In FSO.GetFolder(x).Files\n\n            If Right(FileInFolder.Name, 4) = \".png\" Then\n\n                CountContents = CountContents + 1\n\n            ElseIf Right(FileInFolder.Name, 4) = \".Zip\" Then\n\n                Set sh = CreateObject(\"Shell.Application\")\n                Set ZipFile = sh.Namespace(CVar(x &amp; \"\\\" &amp; FileInFolder.Name))\n\n                Debug.Print FileInFolder.Name\n\n                For Each fileInZip In ZipFile.Items\n\n                    If LCase(fileInZip) Like LCase(\"*.png\") Then\n\n                        CountContents = CountContents + 1\n\n                    End If\n\n                Next\n\n            End If\n\n        Next FileInFolder\n\n    End If\n\n    Set sh = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The issue I get is on this line:</p>\n\n<pre><code>For Each fileInZip In ZipFile.Items\n</code></pre>\n\n<p>Error Message:</p>\n\n<blockquote>\n  <p>Object variable or With block not set</p>\n</blockquote>\n\n<p>Whenever I tried to use <code>Shell</code>, like below:</p>\n\n<pre><code>Dim oShell As New Shell\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>User-defined type not defined</p>\n</blockquote>\n\n<p>With the below:</p>\n\n<p>Link <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb776890(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/bb776890(v=vs.85).aspx</a></p>\n\n<pre><code>Dim oApp As Object\n\nSet oApp = CreateObject(\"WScript.Shell\")\n\n'get a shell object\nSet oApp = CreateObject(\"Shell.Application\")\n\nIf oApp.Namespace(ZipFile).Items.count &gt; 0 Then\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>Object doesn't support this property or method</p>\n</blockquote>\n\n<p>On this line:</p>\n\n<pre><code>If oApp.Namespace(ZipFile).Items.count &gt; 0 Then\n</code></pre>\n\n<p>References to links I have tried:</p>\n\n<p><a href=\"https://wellsr.com/vba/2015/tutorials/open-and-close-file-with-VBA-Shell/\" rel=\"nofollow noreferrer\">https://wellsr.com/vba/2015/tutorials/open-and-close-file-with-VBA-Shell/</a>\n<a href=\"http://www.vbaexpress.com/forum/showthread.php?38616-quot-shell-quot-not-work-in-Excel\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?38616-quot-shell-quot-not-work-in-Excel</a>\n<a href=\"https://stackoverflow.com/questions/35757699/excel-vba-read-txt-from-zip-files\">Excel VBA - read .txt from .zip files</a></p>\n\n<p>I just don't understand why this step is taking so much time to complete. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1553084290, "post_id": 55260510, "comment_id": 97252446, "body": "Can you not just add current domain to whitelist ?"}, {"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553086905, "post_id": 55260510, "comment_id": 97254117, "body": "Unfortunately adding a trusted site is greyed out by our IT department :("}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553087693, "post_id": 55260510, "comment_id": 97254584, "body": "Can IT add it for you?"}, {"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553088111, "post_id": 55260510, "comment_id": 97254840, "body": "Hopefully! I&#39;m waiting on a response now about that."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1553087427, "post_id": 55260615, "comment_id": 97254416, "body": "Still no luck with changing the settings. I&#39;ll take a look at the registry solution someone came up with in that link."}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1553085635, "last_edit_date": 1553085635, "creation_date": 1553084256, "answer_id": 55260615, "question_id": 55260510, "link": "https://stackoverflow.com/questions/55260510/vba-macro-no-longer-working-with-ie-protected-mode/55260615#55260615", "title": "VBA Macro No Longer Working with IE Protected Mode", "body": "<p>Try to enable \"Websites with less privileged web content zone can navigate into this zone\" ins browser's settings, or add website to \"Trusted sites\". Also you can try to create an instance of Internet Explorer running at a medium integrity level: <code>Set IE = New InternetExplorerMedium</code></p>\n\n<p>If that doesn't work, <a href=\"https://stackoverflow.com/questions/20642519/getting-or-setting-internet-explorer-options-with-vba\">this</a> might help you.</p>\n"}], "owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553089812, "creation_date": 1553083963, "last_edit_date": 1553089812, "question_id": 55260510, "link": "https://stackoverflow.com/questions/55260510/vba-macro-no-longer-working-with-ie-protected-mode", "title": "VBA Macro No Longer Working with IE Protected Mode", "body": "<p>So I've used this code for years to copy data from Excel into text box fields of a website using internet explorer. Recently I upgraded to Windows 10 and it's no longer working. </p>\n\n<p>However it will work when I turn off Protected Mode in the security settings of Internet explorer. The problem is I have to leave this mode on for security concerns.</p>\n\n<p>Does anyone know if it's possible to turn Protected Mode off and then back on using VBA code? </p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1553084258, "post_id": 55260196, "comment_id": 97252422, "body": "Most odd. I can&#39;t replicate this error. Code works fine for me. Is it possible that one of your .xls files contains macros that are interfering?"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1553089345, "post_id": 55260196, "comment_id": 97255636, "body": "Those files don&#39;t have any macros... I don&#39;t really know what&#39;s wrong."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553092803, "post_id": 55260196, "comment_id": 97258152, "body": "Are you able to debug and step through your code and discover when it fails? Try executing it just with a single .xls file, perhaps with a single worksheet. Do the workbooks contain any other sheet types than just Worksheet? You could also try manually copying some sheets to see if an error arises."}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553092949, "post_id": 55260196, "comment_id": 97258276, "body": "Thanks @AndyG, I already solved the problem, after a lot of effort..."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "is_accepted": false, "score": 0, "last_activity_date": 1553092896, "creation_date": 1553092896, "answer_id": 55263471, "question_id": 55260196, "link": "https://stackoverflow.com/questions/55260196/import-excel-97-2003-worksheets-to-active-workbook/55263471#55263471", "title": "Import Excel 97-2003 worksheets to active workbook", "body": "<p>Solved  :)</p>\n\n<pre><code>Sub GetSheets1()\n\n    Application.ScreenUpdating = False\n\n    Dim fPath As String, fName As String\n    Dim destWB As Workbook, currentWB As Workbook\n    Dim i As Long\n\n    Set destWB = ActiveWorkbook\n    fPath = \"C:\\Users\\francisca.cambra\\Dropbox\\Faculdade\\Thesis\\MS-Project\\MacroTest\\\"\n    fName = Dir(fPath &amp; \"*.xls\")\n    Do While fName &lt;&gt; \"\"\n        If fName &lt;&gt; \"Blank.xlsm.xlsm\" Then\n            Set currentWB = Workbooks.Open(Filename:=fPath &amp; fName)\n            For i = 1 To currentWB.Sheets.Count\n                currentWB.Sheets(i).Copy After:=destWB.Sheets(destWB.Sheets.Count)\n            Next i\n            currentWB.Close SaveChanges:=False\n        End If\n        fName = Dir()\n    Loop\n\n    Application.ScreenUpdating = True\n    Sheets(\"Sheet1\").Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556414983, "creation_date": 1553082937, "last_edit_date": 1556414983, "question_id": 55260196, "link": "https://stackoverflow.com/questions/55260196/import-excel-97-2003-worksheets-to-active-workbook", "title": "Import Excel 97-2003 worksheets to active workbook", "body": "<p>The following code imports Excel files (\".xlsx\") in the defined path into my active workbook.</p>\n\n<pre><code>Sub GetSheets1()\n\n    Application.ScreenUpdating = False\n\n    Dim fPath As String, fName As String\n    Dim destWB As Workbook, currentWB As Workbook\n    Dim i As Long\n\n    Set destWB = ActiveWorkbook\n    fPath = \"C:\\Users\\francisca.cambra\\Dropbox\\Faculdade\\Thesis\\MS-Project\\MacroTest\\\"\n    fName = Dir(fPath &amp; \"*.xlsx\")\n    Do While fName &lt;&gt; \"\"\n        Set currentWB = Workbooks.Open(Filename:=fPath &amp; fName, ReadOnly:=True)\n        For i = 1 To currentWB.Sheets.Count\n            currentWB.Sheets(i).Copy After:=destWB.Sheets(destWB.Sheets.Count)\n        Next i\n        currentWB.Close SaveChanges:=False\n        fName = Dir()\n    Loop\n\n    Application.ScreenUpdating = True\n    Sheets(\"Sheet1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>For Excel 97-2003 files, when I change the <code>fName = Dir(fPath &amp; \"*.xlsx\")</code> to <code>fName = Dir(fPath &amp; \"*.xls\")</code>, the workbook becomes empty, without the macros and data.</p>\n\n<p>The macro imports the Excel 97-2003 files when I comment the <code>currentWB.Close SaveChanges:=False</code> line, and it copies twice the first Excel workbook it gets. I think the currentWB is once the ActiveBook, and when the macro is run, the ActiveBook is closed, but I don't know why since the ActiveBook has a different extension from the others, so the loop shouldn't store the ActiveBook.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1553083176, "post_id": 55260139, "comment_id": 97251755, "body": "Are you certain it is that line? Are targetSheet and sourceSheet pointing to the correct sheets? Does targetWorkbook have at least 14 sheets? Is the target worksheet, or are the cells, protected? Are you able to set the values manually?"}, {"owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1553084107, "post_id": 55260139, "comment_id": 97252318, "body": "Thank you. The file was too big, and by deleting more cells it worked."}], "owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553240928, "creation_date": 1553082751, "last_edit_date": 1553240928, "question_id": 55260139, "link": "https://stackoverflow.com/questions/55260139/vba-error-extracting-data-from-another-worksheet", "title": "VBA error extracting data from another worksheet", "body": "<p>I have been running the same code over several subs, but just one of them that is exactly the same has been giving me this error and I don't know why:\nVBA - Run Time Error 1004 'Application Defined or Object Defined Error' </p>\n\n<p>This is the code and I made a comment where the error refers to:</p>\n\n<pre><code>Sub Copy()\n\nDim customerBook As Workbook\nDim filter As String\nDim caption As String\nDim customerFilename As String\nDim customerWorkbook As Workbook\nDim targetWorkbook As Workbook\n\n' make weak assumption that active workbook is the target\nSet targetWorkbook = Application.ActiveWorkbook\n\n' get the customer workbook\nfilter = \"Text files (*.xlsx),*.xlsx\"\ncaption = \"Please select an input file \"\ncustomerFilename = Application.GetOpenFilename(filter, , caption)\n\nSet customerWorkbook = Application.Workbooks.Open(customerFilename)\n' copy data from customer to target workbook\nDim targetSheet As Worksheet\nSet targetSheet = targetWorkbook.Worksheets(14)\nDim sourceSheet As Worksheet\nSet sourceSheet = customerWorkbook.Worksheets(1)\n\n'the line below is where the error refers to\ntargetSheet.Range(\"A1\", \"CA50000\").Value = sourceSheet.Range(\"A1\", \"CA50000\").Value\n\n' Close customer workbook\ncustomerWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "background-color"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11231709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sVwFXcJBuFc/AAAAAAAAAAI/AAAAAAAAAfo/FWHVVtWaFAE/photo.jpg?sz=128", "display_name": "Zena Bebee", "link": "https://stackoverflow.com/users/11231709/zena-bebee"}, "edited": false, "score": 0, "creation_date": 1553092816, "post_id": 55260256, "comment_id": 97258164, "body": "Thank you so much not only have you fixed my problem its actually speeded up now too! You&#39;re a star!!"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 3, "user_id": 11231709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sVwFXcJBuFc/AAAAAAAAAAI/AAAAAAAAAfo/FWHVVtWaFAE/photo.jpg?sz=128", "display_name": "Zena Bebee", "link": "https://stackoverflow.com/users/11231709/zena-bebee"}, "edited": false, "score": 0, "creation_date": 1553093575, "post_id": 55260256, "comment_id": 97258760, "body": "That&#39;s great :) - If your question is now solved please click the tick next to the correct answer :)"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1553085747, "last_edit_date": 1553085747, "creation_date": 1553083130, "answer_id": 55260256, "question_id": 55259938, "link": "https://stackoverflow.com/questions/55259938/change-background-colour-for-partial-row-dependant-on-1-cell/55260256#55260256", "title": "change background colour for partial row dependant on 1 Cell", "body": "<p>You're addressing the wrong range. The way you're attempting to do it effectively acts as an <code>Offset</code> from the referenced <code>Cell</code>. A better of way of writing it as well would be the following:</p>\n\n<pre><code>Public Sub ChangeColour()\n    Dim PC As Range, LastRow As Range\n    Dim ColorIndexValue As Long\n    Dim cell\n\n    ' Set your desired range - Should reference Relevant worksheet as well\n    Set PC = Range(\"A7:H1000\")\n\n    ' Find last used row in that range - This will help limit the number of loops on a fixed range and speed up execution\n    Set LastRow = PC.Find(what:=\"*\", _\n                          after:=Cells(PC.Row, PC.Column), _\n                          lookat:=xlWhole, _\n                          LookIn:=xlValues, _\n                          searchorder:=xlByRows, _\n                          searchdirection:=xlPrevious)\n\n    If Not LastRow Is Nothing Then\n        ' Resize PC to actual used range instead of working on entire sheet\n        Set PC = PC.Cells(1).Resize(LastRow.Row, PC.Columns.Count)\n\n        ' Loop through all cells in range in Column D\n        For Each cell In PC.Columns(\"D\").Cells\n            ' Set ColorIndexValue variable based on cell value\n            Select Case cell.Value2\n                Case \"GBBRS\", \"GBLPL\", \"GBSOU\": ColorIndexValue = 35\n                Case \"FIHNO\", \"SEGOT\": ColorIndexValue = 36\n                Case \"BEANR\", \"DEBRH\": ColorIndexValue = 37\n                Case \"FRLEH\": ColorIndexValue = 38\n                Case \"BEZEE\", \"NLRTM\": ColorIndexValue = 40\n                Case \"ZADUR\", \"ZAELS\", \"ZAPLZ\": ColorIndexValue = 45\n                Case Else: ColorIndexValue = 0\n            End Select\n            ' Set cell Color. Skip 0 as assume cell is 0 by default\n            If ColorIndexValue &gt; 0 Then\n                ' Calculates applicable range from cell and PC context\n                With Range(cell.Offset(0, PC.Cells(1).Column - cell.Column), cell.Offset(0, PC.Cells(1, PC.Columns.Count).Column - cell.Column))\n                    .Interior.ColorIndex = ColorIndexValue\n                End With\n            End If\n        Next cell\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1553083759, "creation_date": 1553083759, "answer_id": 55260448, "question_id": 55259938, "link": "https://stackoverflow.com/questions/55259938/change-background-colour-for-partial-row-dependant-on-1-cell/55260448#55260448", "title": "change background colour for partial row dependant on 1 Cell", "body": "<p>I think you could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim Lastrow As Long, i As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Lastrow = .Cells(.Rows.Count, \"D\").End(xlUp).Row\n\n        For i = 1 To Lastrow\n\n            If .Range(\"D\" &amp; i).Value = \"BEZEE\" Or .Range(\"D\" &amp; i).Value = \"BEANR\" Or .Range(\"D\" &amp; i).Value = \"NLRTM\" Then\n                .Range(\"A\" &amp; i &amp; \":H\" &amp; i).Interior.ColorIndex = 40\n            ElseIf .Range(\"D\" &amp; i).Value = \"DEBRH\" Then\n                .Range(\"A\" &amp; i &amp; \":H\" &amp; i).Interior.ColorIndex = 37\n            ElseIf .Range(\"D\" &amp; i).Value = \"FRLEH\" Then\n                .Range(\"A\" &amp; i &amp; \":H\" &amp; i).Interior.ColorIndex = 38\n            ElseIf .Range(\"D\" &amp; i).Value = \"GBBRS\" Or .Range(\"D\" &amp; i).Value = \"GBLPL\" Or .Range(\"D\" &amp; i).Value = \"GBSOU\" Then\n                .Range(\"A\" &amp; i &amp; \":H\" &amp; i).Interior.ColorIndex = 35\n            ElseIf .Range(\"D\" &amp; i).Value = \"FIHNO\" Or .Range(\"D\" &amp; i).Value = \"SEGOT\" Then\n                .Range(\"A\" &amp; i &amp; \":H\" &amp; i).Interior.ColorIndex = 36\n            ElseIf .Range(\"D\" &amp; i).Value = \"ZADUR\" Or .Range(\"D\" &amp; i).Value = \"ZAELS\" Or .Range(\"D\" &amp; i).Value = \"ZAPLZ\" Then\n                .Range(\"A\" &amp; i &amp; \":H\" &amp; i).Interior.ColorIndex = 45\n            End If\n\n        Next i\n\n    End With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11231709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sVwFXcJBuFc/AAAAAAAAAAI/AAAAAAAAAfo/FWHVVtWaFAE/photo.jpg?sz=128", "display_name": "Zena Bebee", "link": "https://stackoverflow.com/users/11231709/zena-bebee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55260256, "answer_count": 2, "score": 0, "last_activity_date": 1553085747, "creation_date": 1553082077, "last_edit_date": 1553083346, "question_id": 55259938, "link": "https://stackoverflow.com/questions/55259938/change-background-colour-for-partial-row-dependant-on-1-cell", "title": "change background colour for partial row dependant on 1 Cell", "body": "<p>So I'm at the last hurdle with my VBA coding. I'm creating a schedule for several different countries and need the background for cells A7:H300 to colour automatically depending on a value within the same specific row being the country code. </p>\n\n<p>I know I could use conditional formatting but the colours do not copy and paste into a separate sheet using that method.</p>\n\n<p>The code I have below works but it colours D:K instead of the expected A:H - The value is in Row D so I'm guessing that's the problem but I can't workout a way around it.</p>\n\n<p>Thank you for you help :)</p>\n\n<pre><code>Sub ChangeColour()\n\nSet PC = Range(\"A:H\")\nFor Each cell In PC\nIf cell.Value = \"BEZEE\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 40\nIf cell.Value = \"BEANR\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 40\nIf cell.Value = \"DEBRH\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 37\nIf cell.Value = \"FRLEH\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 38\nIf cell.Value = \"GBBRS\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 35\nIf cell.Value = \"GBLPL\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 35\nIf cell.Value = \"GBSOU\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 35\nIf cell.Value = \"NLRTM\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 40\nIf cell.Value = \"FIHNO\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 36\nIf cell.Value = \"SEGOT\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 36\nIf cell.Value = \"ZADUR\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 45\nIf cell.Value = \"ZAELS\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 45\nIf cell.Value = \"ZAPLZ\" Then cell.Columns(\"A:H\").Interior.ColorIndex = 45\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "import"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1553082119, "post_id": 55259646, "comment_id": 97251073, "body": "What line is giving you the error?"}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1553082185, "post_id": 55259646, "comment_id": 97251113, "body": "<code>With ws.QueryTables.Add(Connection:= _             &quot;TEXT;N:\\etc\\etc\\etc\\FMSQRY.CSV&quot;, Destination:= _             ws.Range(Cells(lastRow, 3)))</code> is where the error is. If I have the range as a Absolute range, it works fine"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1553082394, "post_id": 55259646, "comment_id": 97251232, "body": "Have you tried, <code>ws.cells(lastRow,3)</code> ?"}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1553082629, "post_id": 55259646, "comment_id": 97251399, "body": "So stupid I didn&#39;t think to remove the range"}], "answers": [{"comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1553082642, "post_id": 55260069, "comment_id": 97251408, "body": "Thanks - I just didn&#39;t think to remove the range"}], "tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1553082514, "creation_date": 1553082514, "answer_id": 55260069, "question_id": 55259646, "link": "https://stackoverflow.com/questions/55259646/use-long-as-the-start-of-a-range/55260069#55260069", "title": "Use Long as the start of a Range", "body": "<p>Try this code. Check that you don't need the range before cells:</p>\n\n<pre><code>Dim ws As Worksheet, lastRow As Long\n\nSet ws = Worksheets(\"Hoja1\")\nlastRow = ws.Cells(ws.Rows.Count, 3).End(xlUp).Row + 1 ' bottom populated cell of Column \"C\", plus 1\n\n\n    With ws.QueryTables.Add(Connection:= _\n            \"TEXT;N:\\etc\\etc\\etc\\FMSQRY.CSV\", Destination:= _\n            ws.Cells(lastRow, 3))\n        'Data Import here\n    End With\n</code></pre>\n"}], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 55260069, "answer_count": 1, "score": 0, "last_activity_date": 1553082514, "creation_date": 1553081092, "last_edit_date": 1553082228, "question_id": 55259646, "link": "https://stackoverflow.com/questions/55259646/use-long-as-the-start-of-a-range", "title": "Use Long as the start of a Range", "body": "<p>I have a spreadsheet that needs to pull data once a day when a new file comes in.</p>\n\n<p>It's responsibilities are:</p>\n\n<ul>\n<li><p>Start at the bottom populated row (of Column C)</p></li>\n<li><p>Fill the Date for today and make it static</p></li>\n<li><p>Delete data at the top of the sheet over 2 months old</p></li>\n</ul>\n\n<p>I'm sure I can work out the other two tasks, but I'm struggling pulling the lastrow as the point in the range </p>\n\n<pre><code>Dim ws As Worksheet, lastRow As Long\n\nSet ws = Worksheets(\"Report\")\nlastRow = ws.Cells(ws.Rows.Count, 3).End(xlUp).Row + 1 ' bottom populated cell of Column \"C\", plus 1\n\n   'Error on this \"line\" below\n    With ws.QueryTables.Add(Connection:= _\n            \"TEXT;N:\\etc\\etc\\etc\\FMSQRY.CSV\", Destination:= _\n            ws.Range(Cells(lastRow, 3)))\n        'Data Import here\n    End With\n</code></pre>\n\n<p>Classic error 1004 - range of object worksheet failed</p>\n\n<p>But when I use the same method to use lastRow for the selection of <code>N2:N</code> in a different workbook (and different project) it works fine </p>\n\n<pre><code>LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row                  'Finds the bottom populated row\n\nWith ws.Range(ws.Cells(2, 14), ws.Cells(LastRow, 14))               'Selects N2:N\n    'magical formula\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "msgbox"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1553080217, "post_id": 55259180, "comment_id": 97249968, "body": "It is easier to loop with <code>Cells</code> (e.g. <code>Range(&quot;A4&quot;)</code> is <code>Cells(4,1)</code>, and <code>Range(&quot;D6&quot;)</code> is <code>Cells(6,4)</code>) - and if you only want 1 message box then you can use <code>Exit For</code> once you have a &quot;hit&quot;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1553081499, "post_id": 55259180, "comment_id": 97250696, "body": "You can use <code>MATCH</code> in the column A on iButtons to find the row to a variable, say <code>lngRow</code>, based on <code>activesheet.name</code> then use <code>Cells(lngRow,4)</code> as suggested."}, {"owner": {"reputation": 53, "user_id": 8542035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d45ca6b15c9b5e9b54e73de4b59f8ed?s=128&d=identicon&r=PG&f=1", "display_name": "tboo132", "link": "https://stackoverflow.com/users/8542035/tboo132"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1553164384, "post_id": 55259180, "comment_id": 97286686, "body": "@Chronocidal That approach worked exactly as I needed, converted all the Ranges to Cells and wrote a loop to incrementally increase the values per loop. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1553088375, "creation_date": 1553088375, "answer_id": 55261823, "question_id": 55259180, "link": "https://stackoverflow.com/questions/55259180/looping-within-vba-msgbox/55261823#55261823", "title": "Looping within VBA MsgBox", "body": "<p>A programmatic aproach could be (sorry my VB is a bit rusty today, so generic description only):</p>\n\n<p>Make a global array of information about each button and <em>initialize</em> the array with the informaton about each button (the information seems standard, so you can use an array of user defined <code>Type</code>).</p>\n\n<p>With each button that is added or removed from the sheet, only update this array.</p>\n\n<p>Have a procedure to process all buttons. It has a loop that goes from the first entry of the array (a button) to the last button in the array and performs a generic processing.</p>\n"}], "owner": {"reputation": 53, "user_id": 8542035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d45ca6b15c9b5e9b54e73de4b59f8ed?s=128&d=identicon&r=PG&f=1", "display_name": "tboo132", "link": "https://stackoverflow.com/users/8542035/tboo132"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553088375, "creation_date": 1553079647, "last_edit_date": 1553080727, "question_id": 55259180, "link": "https://stackoverflow.com/questions/55259180/looping-within-vba-msgbox", "title": "Looping within VBA MsgBox", "body": "<p>I have some back-end code that produces a MsgBox depending on the content of a front-end user editable sheet (\"iButtons\"). The below code works fine and pretty quickly but I am conscious of the fact that as the \"iButtons\" sheet grows I will need to unnecessarily manage this code over time. </p>\n\n<p>Could I easily write this into a loop that quickly scans the iButtons sheet for all rows on the sheet that has content (up until an empty row has been reached)? Would the loop be fast enough to be run passively in the background or would the response of the MsgBox pop-up be excessively slow given the amount of code that will need to be run?</p>\n\n<pre><code>Public Sub iButtons(ByVal Target As Range)\n\n'Pulls content from the iButtons sheet\n     If (ActiveSheet.Name = Worksheets(\"iButtons\").Range(\"A4\")) And Not Intersect(Target, Target.Parent.Range(Worksheets(\"iButtons\").Range(\"B4\"))) Is Nothing Then\n        MsgBox Worksheets(\"iButtons\").Range(\"D4\"), vbInformation, Worksheets(\"iButtons\").Range(\"C4\")\n        ActiveSheet.Range(\"A1\").Select\n    End If\n\n     If (ActiveSheet.Name = Worksheets(\"iButtons\").Range(\"A5\")) And Not Intersect(Target, Target.Parent.Range(Worksheets(\"iButtons\").Range(\"B5\"))) Is Nothing Then\n        MsgBox Worksheets(\"iButtons\").Range(\"D5\"), vbInformation, Worksheets(\"iButtons\").Range(\"C5\")\n        ActiveSheet.Range(\"A1\").Select\n    End If\n\n     If (ActiveSheet.Name = Worksheets(\"iButtons\").Range(\"A6\")) And Not Intersect(Target, Target.Parent.Range(Worksheets(\"iButtons\").Range(\"B6\"))) Is Nothing Then\n        MsgBox Worksheets(\"iButtons\").Range(\"D6\"), vbInformation, Worksheets(\"iButtons\").Range(\"C6\")\n        ActiveSheet.Range(\"A1\").Select\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "edited": false, "score": 1, "creation_date": 1553115656, "post_id": 55269216, "comment_id": 97271355, "body": "Thanks for a great answer. I agree that what I have isn&#39;t a namespace, but that it sort of simulates one. While you say &quot;If you find yourself making empty classes you should rethink your design&quot;, I guess my counter question is: Why would I ever want a module file instead of an empty class? It seems to me that converting modules with e.g. utility functions to &quot;empty&quot; classes would really help clean up my global namespace, and making it a lot easier to have shorter function names that are equally descriptive through the class qualifier. I.e. how a namespace works in languages that support them."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "edited": false, "score": 2, "creation_date": 1553116143, "post_id": 55269216, "comment_id": 97271582, "body": "@JonasGlesaaen I don&#39;t think we have the same definition for &quot;empty&quot; =) ...if your class has properties and methods, it&#39;s legit (rule of thumb)"}, {"owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "edited": false, "score": 1, "creation_date": 1553116406, "post_id": 55269216, "comment_id": 97271698, "body": "What I mean by &quot;empty&quot; is a class that solely exists so that it can scope it&#39;s member functions. I.e. it can entirely be replaced by a module, and it&#39;s only reason for existing is to make sure its member functions do not leak out into the global namespace."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "edited": false, "score": 1, "creation_date": 1553116698, "post_id": 55269216, "comment_id": 97271846, "body": "@Jonas I don&#39;t think it&#39;s inherently bad, but I&#39;d try to structure things so that it looks &amp; feels like an object hierarchy/model."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1553111919, "creation_date": 1553111919, "answer_id": 55269216, "question_id": 55258448, "link": "https://stackoverflow.com/questions/55258448/using-predeclared-classes-in-vba-as-namespaces/55269216#55269216", "title": "Using predeclared classes in VBA as namespaces", "body": "<p>It costs you an object pointer, is all. I wouldn't call it a <em>namespace</em> though.</p>\n\n<p>Every single <code>UserForm</code> module you've ever worked with has a <code>VB_PredeclaredId</code> attribute set to <code>True</code>. This instance is automatically created, as you noticed, and while you can explicitly destroy it, the next time it's referenced it'll be automatically (silently) re-created again... with whatever the original state is/was... pretty much like an auto-instantiated object, aka an <code>As New</code> declaration.</p>\n\n<p>So what you have there is more like an object hierarchy than a namespace structure - very, very similar to how you can drill down the Excel object model starting with <code>Application</code>, and go do this:</p>\n\n<pre><code>Set someCell = Excel.Application.Workbooks(1).Worksheets(1).Range(\"A1\")\n</code></pre>\n\n<p>Here the \"namespace\" is the <code>Excel</code> library, <code>Application</code> is the root object, and the rest of that expression is all member access - property getters, named after classes.</p>\n\n<p>But the classes aren't in \"namespaces\"... the <code>Worksheets</code> collection <em>type</em> (class) exists on its own, under the <code>Excel</code> library: there being a <code>Worksheets</code> property on the <code>Application</code> class does not in any way, shape, or form, shield the class from a \"name collision\": if your user code has a class module named <code>Worksheets</code> (and it very well can), then as per how VBA resolves identifier references, <code>Dim foo As Worksheet</code> is going to be an instance of <em>that</em> custom class: the only valid qualifier is the library name (<code>Excel</code>, or <code>MyVBAProject</code>).</p>\n\n<p>So, what you have there is a reasonable approach for building a relatively complex object model structure - but it won't (can't) replace or simulate a namespace. If you find yourself making \"empty\" classes, reconsider your design.</p>\n\n<p>As for the last question, I don't see how having 100 predeclared custom objects might be any different than a project with 100 userforms: in both cases I'd wonder if there'd be a way to trim that down and generalize/reuse components, whether they be forms or classes.</p>\n\n<p>What you want to avoid, is a predeclared object that holds state - because that state is effectively global now, and you have no control over what gets to change that state, where, and when: <code>Application.Calculation</code> is a prime example of this.</p>\n"}], "owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 4, "accepted_answer_id": 55269216, "answer_count": 1, "score": 6, "last_activity_date": 1553111919, "creation_date": 1553077395, "last_edit_date": 1553077851, "question_id": 55258448, "link": "https://stackoverflow.com/questions/55258448/using-predeclared-classes-in-vba-as-namespaces", "title": "Using predeclared classes in VBA as namespaces", "body": "<p>One of my biggest issues with coding in VBA is a total lack of namespaces making it difficult to ensure things like scoping and selecting the right function when every function of the same name is in the global namcespace. I know you can prefix your function calls with the module name it is in, but it seems to me that this is also possible by replacing all your modules by predeclared classes. A namespace would look something like this:</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"MyNamespace\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = True\nAttribute VB_Exposed = False\n'@Folder(\"Project.Namespace\")\nOption Explicit\n\nPublic Function Foo() As String\n    Foo = \"bar\"\nEnd Function\n\n' Opionally make sure users do not use this as a class\nPrivate Sub Class_Initialize()\n    If Not Me Is MyNamespace Then\n        Err.Raise 512, _\n            Source:=\"MyNamespace.Initialize\", _\n            Description:=\"Cannot create an instance of a namespace.\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thus if you ever want to call <code>Foo</code> in this namespace you have to write</p>\n\n<pre><code>MyNamespace.Foo()\n</code></pre>\n\n<p>While simply calling <code>Foo()</code> will not work.</p>\n\n<p>My question is this:</p>\n\n<p>Is there any reason you wouldn't want to do this? As far as I can see the class' constructor is only called the first time you call any of its functions after you open your project, so I can't see any overhead there, but there could be something sneaky I am not aware of. Of course this is in no way an ideal way of addressing this lack of functionality, but it is not as if VBA programmers aren't already using the language in roundabout ways to provide lacking functionality.</p>\n\n<p>Also, I see that this is basically the same as <a href=\"https://stackoverflow.com/questions/14944666/are-there-any-pitfalls-in-using-class-modules-as-namespaces-in-vba\">this</a> question, however I'd further want to know whether there are any specific issues with having a ton of predeclared \"empty\" classes in your code. Say you replace 100 modules with 100 predeclared classes, will that have any significant impact on e.g. performance/stability/etc...?</p>\n"}, {"tags": ["excel", "vba", "dictionary", "collections"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553076246, "post_id": 55257996, "comment_id": 97247620, "body": "Each time col is a new collection so it won&#39;t exist in your dictionary."}, {"owner": {"reputation": 387, "user_id": 3227830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935376e1d436d541981377474a2524e2?s=128&d=identicon&r=PG&f=1", "display_name": "bgarrood", "link": "https://stackoverflow.com/users/3227830/bgarrood"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553076562, "post_id": 55257996, "comment_id": 97247821, "body": "Its a new collection each time, but contains the same data..  Doesnt that make it the same?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1553076799, "post_id": 55257996, "comment_id": 97247960, "body": "Why are you storing the collection as the <code>Key</code>? Store your collection as the <code>Value</code> and your <code>Value</code> as the <code>Key</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1553077039, "post_id": 55257996, "comment_id": 97248092, "body": "Objects are equal when they are identical. For example, <code>Range(&quot;A1&quot;)</code> isn&#39;t the same as <code>Range(&quot;A2&quot;)</code> even if <code>Range(&quot;A1&quot;).Value = Range(&quot;A2&quot;).Value</code>. Collections are objects."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1553077374, "post_id": 55257996, "comment_id": 97248272, "body": "@JohnColeman - I&#39;m having a moment - was my comment correct?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1553078051, "post_id": 55257996, "comment_id": 97248654, "body": "@SJR I think so, though you could experiment. Personally, I never use a VBA dictionary with keys that are neither strings nor numbers, precisely because the semantics are a bit unintuitive. I am not 100% sure how a collection is hashed to get a key. <a href=\"https://stackoverflow.com/q/32760830/4996248\">This question</a> discusses it."}, {"owner": {"reputation": 387, "user_id": 3227830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935376e1d436d541981377474a2524e2?s=128&d=identicon&r=PG&f=1", "display_name": "bgarrood", "link": "https://stackoverflow.com/users/3227830/bgarrood"}, "edited": false, "score": 0, "creation_date": 1553081485, "post_id": 55257996, "comment_id": 97250686, "body": "Thanks guys.  I think that confirms my suspicions.  I get your example with range, because range has other properties (styles etc) but a collection, I thought, was different.  Reason for using key was it is a quick way to see if that combination of values already exists in the collection.  But turns out that is too lazy."}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 3227830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935376e1d436d541981377474a2524e2?s=128&d=identicon&r=PG&f=1", "display_name": "bgarrood", "link": "https://stackoverflow.com/users/3227830/bgarrood"}, "edited": false, "score": 0, "creation_date": 1553081608, "post_id": 55259634, "comment_id": 97250764, "body": "Great answer.  Thank you!"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1553081061, "creation_date": 1553081061, "answer_id": 55259634, "question_id": 55257996, "link": "https://stackoverflow.com/questions/55257996/microsoft-scripting-runtime-dictionary-using-collection-as-key/55259634#55259634", "title": "Microsoft scripting runtime dictionary using collection as key", "body": "<p>As discussed in the comments, two objects (eg two Collections or two Ranges) are not identically, even when they have the same value(s), and your <code>dic.Exists(col)</code> will always fail.</p>\n\n<p>I would suggest to put the collections as <em>Value</em> and to write a kind of hash as <em>key</em>. If the collections does not contain too much data, simply concatenate all elements of the collection and put this as key, but if you want it a bit more sophisticated, you can calculate a real hash first. </p>\n\n<p>The following code gives you an idea. The hashing routine is copied from <a href=\"https://en.wikibooks.org/wiki/Visual_Basic_for_Applications/String_Hashing_in_VBA\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Visual_Basic_for_Applications/String_Hashing_in_VBA</a></p>\n\n<pre><code>...\ndim hash as string\nhash = getHash(col)\nIf Not dic.Exists(hash) Then dic.Add hash, col\n...\n\nFunction getHash(c As Collection)\n\n    Dim s As String, i As Long\n    For i = 1 To c.Count\n        s = s &amp; c(i) &amp; \"@@@\"\n    Next i\n    ' Simple: \n    '   getHash = s\n    ' Use a real hash:\n    getHash = MD5(s)\n\nEnd Function\n\nFunction MD5(ByVal sIn As String) As String\n\n    Dim oT As Object, oMD5 As Object\n    Dim TextToHash() As Byte\n    Dim bytes() As Byte\n\n    Set oT = CreateObject(\"System.Text.UTF8Encoding\")\n    Set oMD5 = CreateObject(\"System.Security.Cryptography.MD5CryptoServiceProvider\")\n\n    TextToHash = oT.GetBytes_4(sIn)\n    bytes = oMD5.ComputeHash_2((TextToHash))\n\n    MD5 = ConvToHexString(bytes)\n\n    Set oT = Nothing\n    Set oMD5 = Nothing\n\nEnd Function\n\n\nPrivate Function ConvToHexString(vIn As Variant) As Variant\n\n    Dim oD As Object\n\n    Set oD = CreateObject(\"MSXML2.DOMDocument\")\n\n      With oD\n        .LoadXML \"&lt;root /&gt;\"\n        .DocumentElement.DataType = \"bin.Hex\"\n        .DocumentElement.nodeTypedValue = vIn\n      End With\n    ConvToHexString = Replace(oD.DocumentElement.Text, vbLf, \"\")\n\n    Set oD = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 3227830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935376e1d436d541981377474a2524e2?s=128&d=identicon&r=PG&f=1", "display_name": "bgarrood", "link": "https://stackoverflow.com/users/3227830/bgarrood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 55259634, "answer_count": 1, "score": 0, "last_activity_date": 1553081061, "creation_date": 1553075817, "question_id": 55257996, "link": "https://stackoverflow.com/questions/55257996/microsoft-scripting-runtime-dictionary-using-collection-as-key", "title": "Microsoft scripting runtime dictionary using collection as key", "body": "<p>I have a series of data where each item has a number of values associated with it.  Blocks of items will share these values, then for other items these will change.</p>\n\n<p>I am transferring over the data between databases.  In the old one each item has all of its values stored separately.  In the new database I want to take advantage of the fact that large numbers of items share the same values by storing these sets of values as a configuration.  I am doing this in vba for excel.</p>\n\n<p>To identify what the unique sets of values are I wanted to use a dictionary where the key is a collection.  I got lulled into a false sense of security by it allowing me to do this, however it doesnt manage to identify where keys are identical.</p>\n\n<p>Example code as follows.  Should add just two items to the dictionary but adds all 3.  Am I missing something or just expecting too much of the dictionary?  Would save me a little time if I didnt manually have to compare all the sets.</p>\n\n<pre><code>Sub CollectionAsKeyTest()\nDim dic As New Dictionary\nDim col As Collection\nDim i As Integer\n\ndic.CompareMode = BinaryCompare\n\n'Create a collection to add to dictionary:\nSet col = New Collection\nFor i = 1 To 10\n    col.Add i * 1\nNext i\ndic.Add col, \"item 1\"\n\n'Create a different collection and add as key to dictionary:\nSet col = New Collection\nFor i = 1 To 10\n    col.Add i * 2\nNext i\nIf Not dic.Exists(col) Then dic.Add col, \"item 2\"\n\n'Create a collection which is the same as the first, and try to add to dictionary:\nSet col = New Collection\nFor i = 1 To 10\n    col.Add i * 1\nNext i\nIf Not dic.Exists(col) Then dic.Add col, \"item 3\"\n\n'All three collections are added:\nDebug.Print \"Number of collections added = \" &amp; dic.count\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dynamic", "full-text-search", "partial"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553075364, "post_id": 55257762, "comment_id": 97247012, "body": "Perhaps easier to use the <code>Find</code> method which has a partial/whole argument."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1553076467, "creation_date": 1553076467, "answer_id": 55258180, "question_id": 55257762, "link": "https://stackoverflow.com/questions/55257762/dynamic-searching-for-exact-and-partial-matches-in-excel-using-option-buttons/55258180#55258180", "title": "Dynamic Searching for exact and partial matches in excel using option buttons", "body": "<p>Modify and try the below:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n    Dim SearchValue As String, FullReport As String\n    Dim rng As Range, cell As Range\n\n    'What i m looking for\n    SearchValue = \"Test\"\n\n    'Where to look for\n    Set rng = ThisWorkbook.Worksheets(\"Sheet1\").UsedRange\n\n    For Each cell In rng\n\n        If cell.Value = SearchValue Then\n            If FullReport = \"\" Then\n                FullReport = \"The word \" &amp; SearchValue &amp; \" appears in \" &amp; \"Column \" &amp; cell.Column &amp; \", Row \" &amp; cell.Row &amp; \".\"\n            Else\n                FullReport = FullReport &amp; vbNewLine &amp; \"The word \" &amp; SearchValue &amp; \" appears in \" &amp; \"Column \" &amp; cell.Column &amp; \", Row \" &amp; cell.Row &amp; \".\"\n            End If\n        End If\n\n    Next cell\n\n    MsgBox FullReport\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "edited": false, "score": 0, "creation_date": 1553087373, "post_id": 55258253, "comment_id": 97254390, "body": "okay sorry to be a bother - would you mind helping me modify the code to implement? Not super sure in implementing the above"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "edited": false, "score": 0, "creation_date": 1553087922, "post_id": 55258253, "comment_id": 97254724, "body": "Pretty straightforward: <b>(1)</b> Remove the if-else part where you set the searchStr. <b>(2)</b> Add the call to the new function above the <code>Filter Data</code> - statements. <b>(3)</b> Copy&amp;Paste the function somewhere in your module <b>(4)</b> Modify the <code>ElseIf</code>-Part of the function so that it checks for all your fields where you want to use partial search."}, {"owner": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "edited": false, "score": 0, "creation_date": 1553088889, "post_id": 55258253, "comment_id": 97255334, "body": "Thanks I get the process, but seem to get an error when calling the above    searchStr = getSearchString(mySearch, ButtonName) as variable not found. I amended this to SearchString which just threw another error this time in the fuction for mySearch"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "edited": false, "score": 0, "creation_date": 1553089541, "post_id": 55258253, "comment_id": 97255777, "body": "Sorry, did a mistake when copying the code from the VBA editor. Could you retry?"}, {"owner": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "edited": false, "score": 0, "creation_date": 1553091096, "post_id": 55258253, "comment_id": 97256887, "body": "thanks managed to get it to work. There is one thing however - there is a column that has numbers/letters in it which I wanted a partial match on, however when put numbers in nothing appears. Not too much of an issue but curious if there is a workaround?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "edited": false, "score": 0, "creation_date": 1553091233, "post_id": 55258253, "comment_id": 97256992, "body": "Maybe change the order: Take the <code>ElseIf</code>-Part as <code>If</code> and the <code>IsNumeric(searchVal)</code> as <code>ElseIf</code>"}, {"owner": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "edited": false, "score": 0, "creation_date": 1553092123, "post_id": 55258253, "comment_id": 97257603, "body": "Hmm did the following:               If searchFieldName = &quot;Portfolio Number&quot; _         Or searchFieldName = &quot;Portfolio Name&quot; _        Then         getSearchString = &quot;=*&quot; &amp; searchVal &amp; &quot;*&quot;     ElseIf IsNumeric(searchVal) Then              getSearchString = &quot;=&quot; &amp; searchVal                  Else      getSearchString = &quot;=&quot; &amp; searchVal              End If     No luck it is okay dont think it is going to be a quick fix"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1553089480, "last_edit_date": 1553089480, "creation_date": 1553076715, "answer_id": 55258253, "question_id": 55257762, "link": "https://stackoverflow.com/questions/55257762/dynamic-searching-for-exact-and-partial-matches-in-excel-using-option-buttons/55258253#55258253", "title": "Dynamic Searching for exact and partial matches in excel using option buttons", "body": "<p>If you have a fixed list of columns, then simply move the code where you set the SearchString below the part where you determine which column you want to search and check the selected field against this list. However, I would suggest to put this is a separate function:</p>\n\n<pre><code>Function getSearchString(searchVal as variant, searchFieldName as string)\n    If IsNumeric(searchVal) Then\n        getSearchString = \"=\" &amp; searchVal \n    ElseIf searchFieldName = \"MyField1\" _\n        Or searchFieldName = \"MyField2\" _\n        Or (... List all fields where you want to search partial) Then\n        getSearchString = \"=*\" &amp; searchVal &amp; \"*\"\n    Else\n        getSearchString = \"=\" &amp; searchVal\n    End If\nEnd Function\n</code></pre>\n\n<p>You call the function after setting the var <code>ButtonName</code>.</p>\n\n<pre><code>    searchStr = getSearchString(mySearch, ButtonName)\n</code></pre>\n\n<p>(you can of course think about a more sophisticated way to determine if or if not to use partial searching - or maybe add a CheckBox to let the user choose)</p>\n"}], "owner": {"reputation": 19, "user_id": 10674609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ab11a2b6603ee0db9f7d07263bd42e?s=128&d=identicon&r=PG&f=1", "display_name": "dsound", "link": "https://stackoverflow.com/users/10674609/dsound"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 55258180, "answer_count": 2, "score": 0, "last_activity_date": 1569779676, "creation_date": 1553075147, "question_id": 55257762, "link": "https://stackoverflow.com/questions/55257762/dynamic-searching-for-exact-and-partial-matches-in-excel-using-option-buttons", "title": "Dynamic Searching for exact and partial matches in excel using option buttons", "body": "<p>I have the following code that allows me to search through the data on a table by using the option buttons I created that match the table headings. I can set the search criteria to be exact matches or partial. However, what I would like is to be able to search through different columns in the table without always having to go into the VBA code to toggle this option on and off. i.e some columns I would like an exact match, others I would like partial. </p>\n\n<p>Any help on where I can amend the code below?</p>\n\n<pre><code>Sub SearchBox()\n\nDim myButton As OptionButton\nDim SearchString As String\nDim ButtonName As String\nDim sht As Worksheet\nDim myField As Long\nDim DataRange As Range\nDim mySearch As Variant\n\n'Load Sheet into A Variable\n  Set sht = ActiveSheet\n\n'Unfilter Data (if necessary)\n  On Error Resume Next\n    sht.ShowAllData\n  On Error GoTo 0\n\n'Filtered Data Range (include column heading cells)\n  'Set DataRange = sht.Range(\"E5:H200\") 'Cell Range\n   Set DataRange = sht.ListObjects(\"Table1\").Range 'Table\n\n'Retrieve User's Search Input\n  'mySearch = sht.Shapes(\"UserSearch\").TextFrame.Characters.Text 'Control Form\n  mySearch = sht.OLEObjects(\"Hello\").Object.Text 'ActiveX Control\n  'mySearch = sht.Range(\"A1\").Value 'Cell Input\n\n'Determine if user is searching for number or text\n  If IsNumeric(mySearch) = True Then\n    SearchString = \"=\" &amp; mySearch\n  Else\n\n  'change this to =* if you want to search for anything that containts mysearch rather than just mysearch\n    SearchString = \"=*\" &amp; mySearch &amp; \"*\"\n\n    End If\n\n'Loop Through Option Buttons\n  For Each myButton In sht.OptionButtons\n    If myButton.Value = 1 Then\n      ButtonName = myButton.Text\n      Exit For\n    End If\n  Next myButton\n\n'Determine Filter Field\n  On Error GoTo HeadingNotFound\n    myField = Application.WorksheetFunction.Match(ButtonName, DataRange.Rows(1), 0)\n  On Error GoTo 0\n\n'Filter Data\n  DataRange.AutoFilter _\n    Field:=myField, _\n    Criteria1:=SearchString, _\n    Operator:=xlAnd\n\n'Clear Search Field\n  'sht.Shapes(\"UserSearch\").TextFrame.Characters.Text = \"\" 'Control Form\n  sht.OLEObjects(\"Hello\").Object.Text = \"\" 'ActiveX Control\n  'sht.Range(\"A1\").Value = \"\" 'Cell Input\n\nExit Sub\n\n'ERROR HANDLERS\nHeadingNotFound:\n  MsgBox \"The column heading [\" &amp; ButtonName &amp; \"] was not found in cells \" &amp; DataRange.Rows(1).Address &amp; \". \" &amp; _\n    vbNewLine &amp; \"Please check for possible typos.\", vbCritical, \"Header Name Not Found!\"\n\nEnd Sub\n\n\nSub ClearFilter()\n'PURPOSE: Clear all filter rules\n\n'Clear filters on ActiveSheet\n  On Error Resume Next\n  ActiveSheet.ListObjects(1).AutoFilter.ShowAllData\n\n  On Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "onerror"], "comments": [{"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 1, "creation_date": 1553076368, "post_id": 55257739, "comment_id": 97247692, "body": "Just pointing two things: if you&#39;re addressing <code>ws</code> everywhere you need it, you don&#39;t need to use <code>With... End</code> and you could delete the line <code>GoTo Continue_Next</code> inside the first <code>If</code>."}, {"owner": {"reputation": 57, "user_id": 2784767, "user_type": "registered", "profile_image": "https://graph.facebook.com/565961996/picture?type=large", "display_name": "Rene Hanschke", "link": "https://stackoverflow.com/users/2784767/rene-hanschke"}, "reply_to_user": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1553080333, "post_id": 55257739, "comment_id": 97250039, "body": "Thanks @Pspl. Yes, the code is running without the <code>With</code> as you suggested. However, the Run Time Error still occurs. Any other ideas?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1553080772, "post_id": 55257739, "comment_id": 97250295, "body": "What error do you expect after line:                 On Error GoTo Continue_Next    ?"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1553084556, "post_id": 55257739, "comment_id": 97252640, "body": "@ReneHanschke, I copied the code to my machine (without the edition lines) and didn&#39;t get any error. If you&#39;re careful enough you can use labels inside a <code>For... Next</code> statement. However you should avoid that (like suggested by @Daniel). I can&#39;t pinpoint any <code>Runtime Error</code> on the procedure."}, {"owner": {"reputation": 57, "user_id": 2784767, "user_type": "registered", "profile_image": "https://graph.facebook.com/565961996/picture?type=large", "display_name": "Rene Hanschke", "link": "https://stackoverflow.com/users/2784767/rene-hanschke"}, "edited": false, "score": 0, "creation_date": 1553165032, "post_id": 55257739, "comment_id": 97287053, "body": "Thanks for your comments, folks!"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 2784767, "user_type": "registered", "profile_image": "https://graph.facebook.com/565961996/picture?type=large", "display_name": "Rene Hanschke", "link": "https://stackoverflow.com/users/2784767/rene-hanschke"}, "edited": false, "score": 0, "creation_date": 1553165124, "post_id": 55259483, "comment_id": 97287100, "body": "Thanks a lot, @Daniel! The code works as expected now. And - also thanks for your explanation! - I now understand the logic and error handling much better. What an enlightment ;-)"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 57, "user_id": 2784767, "user_type": "registered", "profile_image": "https://graph.facebook.com/565961996/picture?type=large", "display_name": "Rene Hanschke", "link": "https://stackoverflow.com/users/2784767/rene-hanschke"}, "edited": false, "score": 0, "creation_date": 1553168825, "post_id": 55259483, "comment_id": 97289229, "body": "No worries, it&#39;s very important to understand how error handling works, there&#39;s a bit more to it! :) For example, expected error enables error handling procedure, which must handle error before another one occurs. Therefore it&#39;s important to handle and reset expected errors in strategic places. Anyway, I suggest you read more about it on google and familiarise with err.clear, on error goto -1 and 0, resume etc"}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1553081719, "last_edit_date": 1553081719, "creation_date": 1553080567, "answer_id": 55259483, "question_id": 55257739, "link": "https://stackoverflow.com/questions/55257739/cant-solve-run-time-error-92-for-loop-not-initialized-any-idea/55259483#55259483", "title": "Can&#39;t solve Run-time error 92: For loop not initialized. Any idea?", "body": "<p>The problem is using labels inside the loop. Change the logic of your code and get rid of them. FYI you need to reset error handling procedure when you goto label on error, but again, you want to get rid of labels anyway.</p>\n\n<p>/e: to be more precise, <code>on error goto Continue_Next</code> goes to the label that's outside of the loop and I believe this is causing an error. If you're expecting error here, place <code>On Error Resume Next</code> on top, test your error then <code>If Err.Number &gt; 0 then Exit For</code> - don't need the label. Remember to clear error and error handling procedure. Try something like this:</p>\n\n<pre><code>For Each ws In ThisWorkbook.Worksheets\n\n    Debug.Print ws.Range(\"A1\").Parent.Name\n    colNo = ws.Cells(8, Columns.count).End(xlToLeft).Column\n    vCol = Application.WorksheetFunction.Transpose(ws.Range(Cells(8, 1).Address, Cells(10, colNo).Address).Value2)\n\n    If colNo &gt; 1 Then\n        For coli = LBound(vCol, 1) To UBound(vCol, 1)\n            On Error Resume Next\n            'test your error\n            If Err.number &gt; 0 Then Exit For\n            On Error GoTo 0\n            If IsDate(vCol(coli, 1)) = True Then vCol(coli, 1) = Year(vCol(coli, 1))\n            If vCol(coli, 1) = YearBC Then\n                If vCol(coli, 2) = MonthBC Then\n                    If vCol(coli, 3) = Phase Then\n                        colBC = coli\n                        ws.Range(Cells(1, colBC + 1).Address).EntireColumn.Insert\n                        ws.Range(Cells(1, colBC).Address, Cells(Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).row, colBC).Address).Copy\n                        ws.Range(Cells(1, colBC + 1).Address).PasteSpecial Paste:=xlPasteValues\n                        ws.Range(Cells(11, 10).Address, Cells(Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).row, 10).Address).Copy\n                        ws.Range(Cells(11, colBC).Address).PasteSpecial Paste:=xlPasteFormulas\n                    End If\n                End If\n            End If\n        Next coli\n        On Error GoTo 0\n    End If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 2784767, "user_type": "registered", "profile_image": "https://graph.facebook.com/565961996/picture?type=large", "display_name": "Rene Hanschke", "link": "https://stackoverflow.com/users/2784767/rene-hanschke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3815, "favorite_count": 0, "accepted_answer_id": 55259483, "answer_count": 1, "score": 0, "last_activity_date": 1553081719, "creation_date": 1553075072, "question_id": 55257739, "link": "https://stackoverflow.com/questions/55257739/cant-solve-run-time-error-92-for-loop-not-initialized-any-idea", "title": "Can&#39;t solve Run-time error 92: For loop not initialized. Any idea?", "body": "<p><br>\nI have a small loop to check all the worksheets and past and copy a column if certain criteria are met. However, after all worksheets are completed, I'm running into \"Run-time error 92: For loop not initialized\". I understand, <code>Next ws</code> will be addressed as long as the loop is running (until the very last worksheet) or if an error occurs. I don't get why <code>Next ws</code> is used after the loop is finished.<br>\nDo you have any ideas what I'm doing wrong?<br>\nMany thanks in advance!</p>\n\n<pre><code>Dim MonthBC As String\nDim YearBC As String\nDim Phase As String\nDim colBC As Long\nDim colNo As Long\nDim vCol As Variant\nDim coli As Long\n\nMonthBC = Form_Start_Update.ComboBox_Month.Value\nYearBC = Form_Start_Update.ComboBox_Year.Value\nPhase = \"Plan\"\n\nFor Each ws In ThisWorkbook.Worksheets\n    With ws\n        Debug.Print ws.Range(\"A1\").Parent.Name\n        colNo = ws.Cells(8, Columns.Count).End(xlToLeft).Column\n        vCol = Application.WorksheetFunction.Transpose(ws.Range(Cells(8, 1).Address, Cells(10, colNo).Address).Value2)\n        If colNo = 1 Then\n        GoTo Continue_Next\n        Else\n            For coli = LBound(vCol, 1) To UBound(vCol, 1)\n                On Error GoTo Continue_Next\n                If IsDate(vCol(coli, 1)) = True Then\n                    vCol(coli, 1) = Year(vCol(coli, 1))\n                End If\n                If vCol(coli, 1) = YearBC Then\n                    If vCol(coli, 2) = MonthBC Then\n                        If vCol(coli, 3) = Phase Then\n                        colBC = coli\n                        ws.Range(Cells(1, colBC + 1).Address).EntireColumn.Insert\n                        ws.Range(Cells(1, colBC).Address, Cells(Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row, colBC).Address).Copy\n                        ws.Range(Cells(1, colBC + 1).Address).PasteSpecial Paste:=xlPasteValues\n                        ws.Range(Cells(11, 10).Address, Cells(Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row, 10).Address).Copy\n                        ws.Range(Cells(11, colBC).Address).PasteSpecial Paste:=xlPasteFormulas\n                        End If\n                    End If\n                End If\n            Next coli\n        End If\n    End With\n\nContinue_Next:\n    Next ws\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "edited": false, "score": 0, "creation_date": 1553076491, "post_id": 55258091, "comment_id": 97247780, "body": "No, this opens the template. I want a new workbook based on a template."}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "edited": false, "score": 2, "creation_date": 1553079225, "post_id": 55258091, "comment_id": 97249360, "body": "I was looking it up, but it seems that Microsoft didn&#39;t provide a direct way to do it. Maybe because they thought that it&#39;s not practical to lock a template with a password. One possible solution that pops to my mind is to create a copy of the template and then opening it."}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "edited": false, "score": 0, "creation_date": 1553191495, "post_id": 55258091, "comment_id": 97303135, "body": "Can you accept my answer, since you used my solution to solve the issue? Thank you."}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": true, "score": 1, "last_activity_date": 1553191364, "last_edit_date": 1553191364, "creation_date": 1553076132, "answer_id": 55258091, "question_id": 55257597, "link": "https://stackoverflow.com/questions/55257597/is-it-possible-to-add-a-new-workbook-based-on-a-locked-template/55258091#55258091", "title": "Is it possible to add a new workbook based on a locked template", "body": "<p>This code should work for you, since you can supply the password during the call:</p>\n\n<pre><code>Public Sub AddTemplatedWB()\n    Workbooks.Open Filename:=\"C:\\VssBOX\\Generic Projects\\PMC2\\template.xlsm\", _\n        Password:=\"YourPassword\"\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong>:</p>\n\n<p>I was looking it up, but it seems that Microsoft didn't provide a direct way to do it. Maybe because they thought that it's not practical to lock a template with a password. </p>\n\n<blockquote>\n  <p>One possible solution that pops to my mind is to create a copy of the\n  template and then opening it.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "is_accepted": false, "score": 0, "last_activity_date": 1553158766, "creation_date": 1553158766, "answer_id": 55276798, "question_id": 55257597, "link": "https://stackoverflow.com/questions/55257597/is-it-possible-to-add-a-new-workbook-based-on-a-locked-template/55276798#55276798", "title": "Is it possible to add a new workbook based on a locked template", "body": "<p>No, there doesn't seem to be any way to do this.</p>\n\n<p>What I ended up doing instead is copying the template to a temporary file, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open\" rel=\"nofollow noreferrer\">Opening</a> with the password.\nThen I made sure that the temporary file was deleted after I was done with it.</p>\n"}], "owner": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 55258091, "answer_count": 2, "score": 1, "last_activity_date": 1553191364, "creation_date": 1553074586, "last_edit_date": 1553076118, "question_id": 55257597, "link": "https://stackoverflow.com/questions/55257597/is-it-possible-to-add-a-new-workbook-based-on-a-locked-template", "title": "Is it possible to add a new workbook based on a locked template", "body": "<p>I've got the following VBA code which <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.add\" rel=\"nofollow noreferrer\">Adds</a> a new workbook based on a template.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddTemplatedWB()\n    Workbooks.Add ( _\n        \"C:\\VssBOX\\Generic Projects\\PMC2\\template.xlsm\" _\n    )\nEnd Sub\n</code></pre>\n\n<p>This works except when the template is locked. Then I get the usual password prompt:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XWpcW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XWpcW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Clicking Cancel gives me an error in VBA:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E3yVr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E3yVr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there any way to supply the password directly when adding the workbook? (This seems particularly weird since you can supply a password when <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open\" rel=\"nofollow noreferrer\">Opening</a> a file.)</p>\n\n<p>If not, is there any other way to achieve what I'm looking for, i.e. creating a new file in memory based on a locked file?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1553075201, "post_id": 55257458, "comment_id": 97246921, "body": "Have you tried Application.ScreenUpdating = False ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 1, "creation_date": 1553075225, "post_id": 55257458, "comment_id": 97246941, "body": "@Shmukko did you read the title? Or the third line of the code? ;)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553075248, "post_id": 55257458, "comment_id": 97246954, "body": "@Poetoe This question might better fit to: <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1553075466, "post_id": 55257458, "comment_id": 97247078, "body": "I highly recommend to refactor your code and get all the <code>GoTo</code> removed and replaced by other logic. Using <code>GoTo</code> is a very bad practice and your code gets hard to maintain. Also using functions/procedures for similar code (like your loops) would tidy up your code a lot and make it more reliable. For now it looks a bit (actually a lot) messy (sorry I have to say that)."}, {"owner": {"reputation": 41, "user_id": 11230892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1lEq6onQIA0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHNKU715ykmPLZ78HJHgPxyHAL3A/mo/photo.jpg?sz=128", "display_name": "Poetoe", "link": "https://stackoverflow.com/users/11230892/poetoe"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553162013, "post_id": 55257458, "comment_id": 97285359, "body": "@P\u1d07\u029c could you help with the code for tidy up my code? I already try to remove go to but still same problem, any idea what cause that problem?"}], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1553075477, "post_id": 55257825, "comment_id": 97247083, "body": "That&#39;s not going to solve the problem, plus there is &#39;Exit Sub&#39; before &#39;End Sub&#39; in his code so that won&#39;t do anything ;)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1553075617, "post_id": 55257825, "comment_id": 97247179, "body": "Actually Nick is right that this code is never run after a <code>GoTo Export</code> and therefore should be moved (somewhere else). But this answer is not the solution to the question. The code has a lot more issues than what Nick mentioned."}, {"owner": {"reputation": 773, "user_id": 11158132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836d70ae291879b732a8bc21190f10a9?s=128&d=identicon&r=PG&f=1", "display_name": "JLCH", "link": "https://stackoverflow.com/users/11158132/jlch"}, "edited": false, "score": 1, "creation_date": 1553075789, "post_id": 55257825, "comment_id": 97247296, "body": "Nick is right, if none of the goto catch on, the application-screen is true and does all the export and protect part of the script with screen flickering"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 773, "user_id": 11158132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836d70ae291879b732a8bc21190f10a9?s=128&d=identicon&r=PG&f=1", "display_name": "JLCH", "link": "https://stackoverflow.com/users/11158132/jlch"}, "edited": false, "score": 0, "creation_date": 1553075926, "post_id": 55257825, "comment_id": 97247403, "body": "@Jo.lass Ah, well you are right! All these <code>GoTo</code> got me too confused actually. The OP should really go to <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a> and get this whole code refactored. \u2022 But the <code>Exit Sub</code> in the end should still be removed then."}], "tags": [], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "is_accepted": false, "score": 2, "last_activity_date": 1553075325, "creation_date": 1553075325, "answer_id": 55257825, "question_id": 55257458, "link": "https://stackoverflow.com/questions/55257458/excel-screenupdating-false-and-still-flickering-on-copy-paste-to-another-workshe/55257825#55257825", "title": "Excel ScreenUpdating false and still flickering on Copy Paste to another worksheet", "body": "<p>You need to move this code :</p>\n\n<pre><code>With Application\n    .ScreenUpdating = True\n    .Calculation = xlCalculationAutomatic\nEnd With\n</code></pre>\n\n<p>to the end, just before <code>End Sub</code></p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1553166190, "last_edit_date": 1553166190, "creation_date": 1553165702, "answer_id": 55278831, "question_id": 55257458, "link": "https://stackoverflow.com/questions/55257458/excel-screenupdating-false-and-still-flickering-on-copy-paste-to-another-workshe/55278831#55278831", "title": "Excel ScreenUpdating false and still flickering on Copy Paste to another worksheet", "body": "<p>I could not test it but this should work:</p>\n\n<p>My main changes explained:</p>\n\n<ul>\n<li>Unprotect the sheet as late as possible, eg right before export (so we don't need to reprotect it if we actually do not export).</li>\n<li>Same for <code>ScreenUpdating</code> and <code>Calculation</code> we don't need to deactivate them unless the exports start.</li>\n<li>I used a loop to check the columns <code>CheckColumns = Array(\"S\", \"X\", \"Y\", \"AB\", \"AA\", \"AC\")</code></li>\n<li>I added a procedure <code>ProcessTable</code> that handles your multiple loops. Always use procedures to re-use the same code (istead of copying the code).</li>\n<li>I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <em>Tools</em> \u203a <em>Options</em> \u203a <em><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></em>.</li>\n<li>You must always specify in which worksheet a <code>Range</code> or <code>Cells</code> etc. is otherwise Excel guesses and might be wrong.</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Const SHEET_PASSWORD As String = \"pass\" 'define your password here!\n\nPublic Sub ExportDataImproved()\n    Dim wsCopy As Worksheet\n    Set wsCopy = Workbooks(\"Book 1.xlsm\").Worksheets(\"Sheet 1\")\n\n    Dim wsDest As Worksheet\n    Set wsDest = Workbooks(\"Book 2.xls\").Worksheets(\"Sheet 1\")\n\n    Dim wsDest2 As Worksheet\n    Set wsDest2 = Workbooks(\"Book 2.xls\").Worksheets(\"Sheet 2\")\n\n    Dim CopyLastRow As Long\n    CopyLastRow = wsCopy.Range(\"J10:J16\").Find(what:=\"\", LookIn:=xlValues).Offset(-1).Row\n\n    Dim DestNextFreeRow As Long\n    DestNextFreeRow = wsDest.Cells(wsDest.Rows.Count, \"J\").End(xlUp).Offset(1).Row\n\n    Dim Dest2NextFreeRow As Long\n    Dest2NextFreeRow = wsDest2.Cells(wsDest2.Rows.Count, \"A\").End(xlUp).Offset(1).Row\n\n\n    'Perform some checks \u2026\n    Dim CheckColumns() As String\n    CheckColumns = Array(\"S\", \"X\", \"Y\", \"AB\", \"AA\", \"AC\")\n\n    Dim CheckColumn As Variant\n    Dim iRow As Long\n    For iRow = 10 To 15\n        If wsCopy.Cells(iRow, \"W\").Value &lt;&gt; vbNullString Then\n            For Each CheckColumn In CheckColumns\n                If wsCopy.Cells(iRow, CheckColumn).Value = vbNullString Then\n                    MsgBox \"Please fill column \" &amp; CheckColumn, vbExclamation\n                    'probably Exit Sub here if this should cancel the export\n                End If\n                Exit For\n            Next CheckColumn\n        End If\n    Next iRow\n\n    If wsCopy.Cells(10, \"W\").Value &lt;&gt; vbNullString And wsCopy.Cells(10, \"AD\").Value = vbNullString Then\n        MsgBox \"Please fill column \" &amp; CheckColumn, vbExclamation\n        'probably Exit Sub here if this should cancel the export\n    End If\n\n\n    If WorksheetFunction.CountIf(wsDest2.Range(\"B10:B\" &amp; Dest2NextFreeRow - 1), wsCopy.Range(\"B10\")) &gt; 0 Then\n        If MsgBox(\"Double?\", vbQuestion + vbYesNo, \"Double data\") &lt;&gt; vbYes Then\n            Exit Sub\n        End If\n    ElseIf wsCopy.Range(\"Q5\").Value &lt;&gt; vbNullString Then\n        If MsgBox(\"Sure?\", vbQuestion + vbYesNo, \"Manual override\") &lt;&gt; vbYes Then\n            Exit Sub\n        End If\n    End If\n\n\n    'Export starts now \u2026\n    Application.ScreenUpdating = False\n    Application.Calculation = xlManual 'sometimes excel calculates values before saving files\n\n    wsCopy.Unprotect SHEET_PASSWORD\n    On Error GoTo REPROTECT 'In case of an error make sure the sheet is not left unprotected\n\n    Dim Cell As Range\n    For Each Cell In wsCopy.Range(\"AB10:AB15\")\n        Cell.Value = UCase$(Cell.Value)\n    Next Cell\n\n    wsDest.Rows(DestNextFreeRow &amp; \":\" &amp; DestNextFreeRow + CopyLastRow - 10).Insert shift:=xlShiftDown\n    wsDest.Range(\"A\" &amp; DestNextFreeRow) = WorksheetFunction.Max(wsDest.Range(\"A10:A\" &amp; DestNextFreeRow)) + 1\n\n    wsDest.Range(\"L\" &amp; DestNextFreeRow - 1).Copy\n    wsDest.Range(\"L\" &amp; DestNextFreeRow).Resize(CopyLastRow - 9, 1).PasteSpecial Paste:=xlPasteFormulas\n\n    wsDest.Range(\"R\" &amp; DestNextFreeRow - 1).Copy\n    wsDest.Range(\"R\" &amp; DestNextFreeRow).Resize(CopyLastRow - 9, 1).PasteSpecial Paste:=xlPasteFormulas\n\n    wsCopy.Range(\"B10:K\" &amp; CopyLastRow).Copy\n    wsDest.Range(\"B\" &amp; DestNextFreeRow).PasteSpecial Paste:=xlPasteValues\n\n    wsCopy.Range(\"B10:K\" &amp; CopyLastRow).Copy\n    wsDest.Range(\"B\" &amp; DestNextFreeRow).PasteSpecial Paste:=xlPasteValues\n\n    wsCopy.Range(\"M10:Q\" &amp; CopyLastRow).Copy\n    wsDest.Range(\"M\" &amp; DestNextFreeRow).PasteSpecial Paste:=xlPasteValues\n\n    wsCopy.Range(\"S10:AF\" &amp; CopyLastRow).Copy\n    wsDest.Range(\"S\" &amp; DestNextFreeRow).PasteSpecial Paste:=xlPasteValues\n\n    For Each Cell In wsDest.Range(\"B\" &amp; DestNextFreeRow &amp; \":B\" &amp; DestNextFreeRow + CopyLastRow - 10)\n        Cell.Value = wsCopy.Range(\"B10\").Value\n    Next Cell\n\n\n    'Copy data for wsDest2\n    wsDest2.Rows(Dest2NextFreeRow).Insert shift:=xlShiftDown\n    wsDest2.Range(\"A\" &amp; Dest2NextFreeRow) = wsDest2.Range(\"A\" &amp; Dest2NextFreeRow - 1).Value + 1\n\n    wsCopy.Range(\"B10:C10\").Copy\n    wsDest2.Range(\"B\" &amp; Dest2NextFreeRow).PasteSpecial Paste:=xlPasteValues\n\n    wsCopy.Range(\"E10:Z10\").Copy\n    wsDest2.Range(\"E\" &amp; Dest2NextFreeRow).PasteSpecial Paste:=xlPasteValues\n\n    wsCopy.Range(\"AD10:AF10\").Copy\n    wsDest2.Range(\"AD\" &amp; Dest2NextFreeRow).PasteSpecial Paste:=xlPasteValues\n\n\n    ProcessTable wsCopy.Range(\"D10:D\" &amp; CopyLastRow), wsDest2.Range(\"D\" &amp; Dest2NextFreeRow)\n    ProcessTable wsCopy.Range(\"AC10:AC\" &amp; CopyLastRow), wsDest2.Range(\"AC\" &amp; Dest2NextFreeRow)\n    ProcessTable wsCopy.Range(\"AA10:AA\" &amp; CopyLastRow), wsDest2.Range(\"AA\" &amp; Dest2NextFreeRow)\n    ProcessTable wsCopy.Range(\"AB10:AB\" &amp; CopyLastRow), wsDest2.Range(\"AB\" &amp; Dest2NextFreeRow)\n\n\n    wsDest.Activate\n    wsDest.Parent.Save 'save book 2\n\n    'no exit sub here!\nREPROTECT:\n    wsCopy.protect SHEET_PASSWORD, _\n        AllowFormattingCells:=True, _\n        DrawingObjects:=True, _\n        contents:=True, _\n        Scenarios:=True\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\n    'Rise the actual error if one occurs\n    If Err.Number &lt;&gt; 0 Then\n        Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\n    End If\nEnd Sub\n\n\n\nPrivate Sub ProcessTable(ByVal TableRange As Range, ByVal ResultRange As Range)\n    Dim TextTable As String\n\n    Dim iRow As Long\n    For iRow = 1 To TableRange.Rows.Count\n        TextTable = TextTable &amp; IIf(iRow = 1, vbNullString, \"&amp; \") &amp; Trim$(TableRange.Cells(iRow, 1).Text)\n    Next iRow\n\n    ResultRange.Value = ResultRange.Value &amp; TextTable\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11230892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1lEq6onQIA0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHNKU715ykmPLZ78HJHgPxyHAL3A/mo/photo.jpg?sz=128", "display_name": "Poetoe", "link": "https://stackoverflow.com/users/11230892/poetoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553166190, "creation_date": 1553074159, "last_edit_date": 1553074970, "question_id": 55257458, "link": "https://stackoverflow.com/questions/55257458/excel-screenupdating-false-and-still-flickering-on-copy-paste-to-another-workshe", "title": "Excel ScreenUpdating false and still flickering on Copy Paste to another worksheet", "body": "<p>I am beginner and still learn about programming on macro VBA excel. I need help from community to solve my problem on macro code on excel</p>\n\n<pre><code>Sub export_data()\n\nWith Application\n    .ScreenUpdating = False\n    .Calculation = xlManual 'sometimes excel calculates values before saving files\nEnd With\n\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim wsDest2 As Worksheet\nDim lCopyLastRow As Long\nDim lDestLastRow As Long\nDim lDestLastRow2 As Long\nDim i As Long\nDim check As Long\n\n  'Set variables for copy and destination sheets\n  Set wsCopy = Workbooks(\"Book 1.xlsm\").Worksheets(\"Sheet 1\")\n  Set wsDest = Workbooks(\"Book 2.xls\").Worksheets(\"Sheet 1\")\n  Set wsDest2 = Workbooks(\"Book 2.xls\").Worksheets(\"Sheet 2\")\n\n  '1. Find last used row in the copy range based on data in column A\n  lCopyLastRow = wsCopy.Range(\"J10:J16\").Find(what:=\"\", LookIn:=xlValues).Offset(-1).Row\n\n  '2. Find first blank row in the destination range based on data in column A\n  'Offset property moves down 1 row\n  lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"J\").End(xlUp).Offset(1).Row\n  lDestLastRow2 = wsDest2.Cells(wsDest2.Rows.Count, \"A\").End(xlUp).Offset(1).Row\n\n  wsCopy.Unprotect \"pass\"\n\n  For i = 10 To 15\n  If Range(\"W\" &amp; i) &lt;&gt; \"\" And Range(\"S\" &amp; i) = \"\" Then\n         MsgBox \"please fill column S\"\n    GoTo protect\n\n  ElseIf Range(\"K\" &amp; i) &lt;&gt; \"\" And Range(\"X\" &amp; i) = \"\" Then\n         MsgBox \"please fill column X\"\n    GoTo protect\n\n  ElseIf Range(\"W\" &amp; i) &lt;&gt; \"\" And Range(\"Y\" &amp; i) = \"\" Then\n         MsgBox \"please fill column Y\"\n    GoTo protect\n\n  ElseIf Range(\"W\" &amp; i) &lt;&gt; \"\" And Range(\"AB\" &amp; i) = \"\" Then\n         MsgBox \"please fill column AB\"\n    GoTo protect\n\n  ElseIf Range(\"W\" &amp; i) &lt;&gt; \"\" And Range(\"AA\" &amp; i) = \"\" Then\n         MsgBox \"please fill column AA\"\n    GoTo protect\n\n  ElseIf Range(\"W\" &amp; i) &lt;&gt; \"\" And Range(\"AC\" &amp; i) = \"\" Then\n         MsgBox \"please fill column AC\"\n    GoTo protect\n  End If\n  Next i\n\n  If Range(\"W\" &amp; 10) &lt;&gt; \"\" And Range(\"AD\" &amp; 10) = \"\" Then\n         MsgBox \"please fill column AD\"\n    GoTo protect\n  End If\n\n\n  If WorksheetFunction.CountIf(wsDest2.Range(\"B10:B\" &amp; lDestLastRow2 - 1), wsCopy.Range(\"B10\")) &gt; 0 Then\n    check = MsgBox(\"Double?\", _\n      vbQuestion + vbYesNo, \"Double data\")\n      If check = vbYes Then\n        GoTo export\n      Else\n        GoTo protect\n      End If\n   Else\n        GoTo export\n  End If\n\n  If Range(\"Q5\") &lt;&gt; \"\" Then\n    check = MsgBox(\"sure?\", _\n      vbQuestion + vbYesNo, \"Manual override\")\n      If check = vbYes Then\n        GoTo export\n      Else\n        GoTo protect\n      End If\n   Else\n        GoTo export\n  End If\n\n\nWith Application\n    .ScreenUpdating = True\n    .Calculation = xlCalculationAutomatic\nEnd With\n\n\n\nexport:\n\n  '3. Copy &amp; Paste Data\n        For Each cell In wsCopy.Range(\"AB10:AB15\")\n            cell.Value = UCase(cell.Value)\n        Next cell\n\n    wsDest.Rows(lDestLastRow &amp; \":\" &amp; lDestLastRow + lCopyLastRow - 10).Insert shift:=xlShiftDown\n    wsDest.Range(\"A\" &amp; lDestLastRow) = WorksheetFunction.Max(wsDest.Range(\"A10:A\" &amp; lDestLastRow)) + 1\n    wsDest.Range(\"L\" &amp; lDestLastRow - 1).Copy\n        wsDest.Range(\"L\" &amp; lDestLastRow).Resize(lCopyLastRow - 9, 1).PasteSpecial Paste:=xlPasteFormulas\n    wsDest.Range(\"R\" &amp; lDestLastRow - 1).Copy\n        wsDest.Range(\"R\" &amp; lDestLastRow).Resize(lCopyLastRow - 9, 1).PasteSpecial Paste:=xlPasteFormulas\n    wsCopy.Range(\"B10:K\" &amp; lCopyLastRow).Copy\n        wsDest.Range(\"B\" &amp; lDestLastRow).PasteSpecial Paste:=xlPasteValues\n    wsCopy.Range(\"B10:K\" &amp; lCopyLastRow).Copy\n        wsDest.Range(\"B\" &amp; lDestLastRow).PasteSpecial Paste:=xlPasteValues\n    wsCopy.Range(\"M10:Q\" &amp; lCopyLastRow).Copy\n        wsDest.Range(\"M\" &amp; lDestLastRow).PasteSpecial Paste:=xlPasteValues\n    wsCopy.Range(\"S10:AF\" &amp; lCopyLastRow).Copy\n        wsDest.Range(\"S\" &amp; lDestLastRow).PasteSpecial Paste:=xlPasteValues\n\n\n    For Each cell In wsDest.Range(\"B\" &amp; lDestLastRow &amp; \":B\" &amp; lDestLastRow + lCopyLastRow - 10)\n        cell.Value = wsCopy.Range(\"B10\").Value\n    Next cell\n\n   'COPY DATA for book 2 sheet 2\n    wsDest2.Rows(lDestLastRow2).Insert shift:=xlShiftDown\n\n    wsDest2.Range(\"A\" &amp; lDestLastRow2) = wsDest2.Range(\"A\" &amp; lDestLastRow2 - 1).Value + 1\n\n    wsCopy.Range(\"B10:C10\").Copy\n    wsDest2.Range(\"B\" &amp; lDestLastRow2).PasteSpecial Paste:=xlPasteValues\n\n    wsCopy.Range(\"E10:Z10\").Copy\n    wsDest2.Range(\"E\" &amp; lDestLastRow2).PasteSpecial Paste:=xlPasteValues\n\n    wsCopy.Range(\"AD10:AF10\").Copy\n    wsDest2.Range(\"AD\" &amp; lDestLastRow2).PasteSpecial Paste:=xlPasteValues\n\n    Dim r As Range, tabel As Range, xTabel As Range\n    Dim x As Integer, xMax As Long\n    'y As Long, yMax As Long\n    Dim textTabel As String\n    Set tabel = wsCopy.Range(\"d10:d\" &amp; lCopyLastRow)\n    Set r = wsDest2.Range(\"d\" &amp; lDestLastRow2)\n\n    xMax = tabel.Rows.Count\n    For x = 1 To xMax\n        Set xTabel = tabel.Range(Cells(x, 1), Cells(x, 1))\n        textTabel = Trim(xTabel.Text)\n        If x = 1 Then\n            textTabel = textTabel\n            'r.Offset(x - 1, 0).ClearContents\n        Else\n            textTabel = \"&amp; \" &amp; textTabel\n        End If\n        r = r &amp; textTabel\n     Next x\n\n\n    Dim r2 As Range, tabel2 As Range, xTabel2 As Range\n    Dim x2 As Integer, xMax2 As Long\n    'y As Long, yMax As Long\n    Dim textTabel2 As String\n    Set tabel2 = wsCopy.Range(\"AC10:AC\" &amp; lCopyLastRow)\n    Set r2 = wsDest2.Range(\"AC\" &amp; lDestLastRow2)\n\n    xMax2 = tabel2.Rows.Count\n    For x2 = 1 To xMax2\n        Set xTabel2 = tabel2.Range(Cells(x2, 1), Cells(x2, 1))\n        textTabel2 = Trim(xTabel2.Text)\n        If x2 = 1 Then\n            textTabel2 = textTabel2\n            'r.Offset(x - 1, 0).ClearContents\n        Else\n            textTabel2 = \"&amp; \" &amp; textTabel2\n        End If\n        r2 = r2 &amp; textTabel2\n     Next x2\n\n\n    Dim r3 As Range, tabel3 As Range, xTabel3 As Range\n    Dim x3 As Integer, xMax3 As Long\n    'y As Long, yMax As Long\n    Dim textTabel3 As String\n    Set tabel3 = wsCopy.Range(\"AA10:AA\" &amp; lCopyLastRow)\n    Set r3 = wsDest2.Range(\"AA\" &amp; lDestLastRow2)\n\n    xMax3 = tabel3.Rows.Count\n    For x3 = 1 To xMax3\n        Set xTabel3 = tabel3.Range(Cells(x3, 1), Cells(x3, 1))\n        textTabel3 = Trim(xTabel3.Text)\n        If x3 = 1 Then\n            textTabel3 = textTabel3\n            'r.Offset(x - 1, 0).ClearContents\n        Else\n            textTabel3 = \"&amp; \" &amp; textTabel3\n        End If\n        r3 = r3 &amp; textTabel3\n     Next x3\n\n\n    Dim r4 As Range, tabel4 As Range, xTabel4 As Range\n    Dim x4 As Integer, xMax4 As Long\n    'y As Long, yMax As Long\n    Dim textTabel4 As String\n    Set tabel4 = wsCopy.Range(\"AB10:AB\" &amp; lCopyLastRow)\n    Set r4 = wsDest2.Range(\"AB\" &amp; lDestLastRow2)\n\n    xMax4 = tabel4.Rows.Count\n    For x4 = 1 To xMax4\n        Set xTabel4 = tabel4.Range(Cells(x4, 1), Cells(x4, 1))\n        textTabel4 = Trim(xTabel4.Text)\n        If x4 = 1 Then\n            textTabel4 = textTabel4\n            'r.Offset(x - 1, 0).ClearContents\n        Else\n            textTabel4 = \"&amp; \" &amp; textTabel4\n        End If\n        r4 = r4 &amp; textTabel4\n     Next x4\n\n\n  'Optional - Select the destination sheet\n   wsDest.Activate\n   GoTo protect\n\n\nprotect:\n  wsCopy.protect \"pass\", _\n    AllowFormattingCells:=True, _\n    DrawingObjects:=True, _\n    contents:=True, _\n    Scenarios:=True\n\n    Workbooks(\"Book 2.xls\").Save\n    Exit Sub\n\n\nEnd Sub\n</code></pre>\n\n<p>I using microsoft office 2016, when i running the code is running well but still flickering. It's disturbing and I afraid it will slow process of the code.</p>\n\n<p>Any idea to stop the flickering when code is running?</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 1, "creation_date": 1553078517, "post_id": 55257725, "comment_id": 97248960, "body": "Same answer I was going to give. +1. You should also be able to check security settings via your vba"}, {"owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "edited": false, "score": 0, "creation_date": 1553078566, "post_id": 55257725, "comment_id": 97248990, "body": "I&#39;m sorry, I do not have enough knowledge. Could you give me step-by-step instructions to do what you ask?"}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "edited": false, "score": 0, "creation_date": 1553079273, "post_id": 55257725, "comment_id": 97249388, "body": "@germangp which part do you not understand? On error, debug the code and type &quot;?IE.hwnd&quot; in immediate window to see if it returns any value. If it doesn&#39;t, browser&#39;s security settings are the problem"}, {"owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "edited": false, "score": 0, "creation_date": 1553082225, "post_id": 55257725, "comment_id": 97251132, "body": "Thank you for your patience, I have little knowledge of vba. Once I have given the error, I have written &quot;? IE.hwnd&quot; in the immediate window. A window opens that says Error 462, the server computer does not exist or is not available."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1553082716, "post_id": 55257725, "comment_id": 97251452, "body": "Right, that&#39;s a good sign - it just confirms that there&#39;s a problem with your browser&#39;s security settings. Did you try to check &quot;Enable Protected Mode&quot; in &quot;Internet&quot; and &quot;Local intranet&quot; zones, in security tab?"}, {"owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "edited": false, "score": 0, "creation_date": 1553083645, "post_id": 55257725, "comment_id": 97252018, "body": "I have been to &quot;Internet Explorer / Internet Options / Security / Internet / Enable Protected Mode&quot;. It was marked so I left it like that. Then in &quot;Internet Explorer / Internet Options / Security / Local Intranet / Enable Protected Mode&quot;. It was unchecked so I have marked it and I have left Internet Explorer. I have run the macro and Runtime Error 2147417848 has come out again. I have put the window immediately &quot;? IE.hwnd&quot; and again I get &quot;Error 462, the server does not exist or is not available&quot;."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1553083992, "post_id": 55257725, "comment_id": 97252241, "body": "Did you restart IE? There is another setting that you might need to change, click &quot;Custom level...&quot; and enable &quot;Websites with less privileged web content zone can navigate into this zone&quot; - again, enable this in both zones. It that doesn&#39;t work, try to set both zones to the same security level."}, {"owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "edited": false, "score": 0, "creation_date": 1553084490, "post_id": 55257725, "comment_id": 97252583, "body": "I have done both. First I checked &quot;Websites with less privileged web content zone can navigate into this zone&quot;. It was activated. I have executed the macro and the error continues. Then I put the two in low security, I have executed the macro and the error continues."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1553084739, "post_id": 55257725, "comment_id": 97252768, "body": "That&#39;s odd. I have one other idea. Try &quot;Set IE = New InternetExplorerMedium&quot; instead of what you&#39;ve got in the code."}, {"owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "edited": false, "score": 0, "creation_date": 1553085368, "post_id": 55257725, "comment_id": 97253162, "body": ":-) Perfect, that was the problem. It works now. Thank you very much for your help."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1553085445, "post_id": 55257725, "comment_id": 97253202, "body": "That&#39;s great! I&#39;ll edit my original post to include it. Don&#39;t forget to mark this as correct response please :)"}, {"owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "edited": false, "score": 0, "creation_date": 1553087323, "post_id": 55257725, "comment_id": 97254362, "body": "One last thing, could you recommend me manuals on vba and how to copy data from web pages to Excel? I would like to improve my knowledge on these subjects."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1553087644, "post_id": 55257725, "comment_id": 97254557, "body": "There are quite a lot good tutorials on google - I can&#39;t recommend you anything specific, you can google &quot;web scraping with vba&quot;. You&#39;ll need some basic html knowledge as well, check out w3schools. Then if you hit a brick wall, post your question on SO :)"}, {"owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "edited": false, "score": 0, "creation_date": 1553087726, "post_id": 55257725, "comment_id": 97254602, "body": "I will look where you tell me. Thank you."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553087930, "post_id": 55257725, "comment_id": 97254730, "body": "<a href=\"https://www.youtube.com/watch?v=ZrPEAljQjRM&amp;list=PLNIs-AWhQzcl3xKvF8sVL4sWRWICj_clM\" rel=\"nofollow noreferrer\">youtube.com/&hellip;</a>"}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1553085566, "last_edit_date": 1553085566, "creation_date": 1553075016, "answer_id": 55257725, "question_id": 55257273, "link": "https://stackoverflow.com/questions/55257273/vba-macro-runs-on-home-computer-and-gets-error-2147417848-on-work-computer/55257725#55257725", "title": "Vba macro runs on home computer and gets error 2147417848 on work computer", "body": "<p>Debug the code and when the error occurs, check if <code>IE.hwnd</code> returns any value. If it doesn't there is a problem with your IE's security settings, afaik IE opens a new browser when it navigates to website that's in different security zone (for example from local intranet to Internet). Try enabling protected mode for both of these, or/and set the same security level.</p>\n\n<p>/e: If none of the settings mentioned in comments below make any difference, create an instance of Internet Explorer running at a medium integrity level: <code>Set IE = New InternetExplorerMedium</code></p>\n"}], "owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 55257725, "answer_count": 1, "score": 2, "last_activity_date": 1553085566, "creation_date": 1553073565, "last_edit_date": 1553078281, "question_id": 55257273, "link": "https://stackoverflow.com/questions/55257273/vba-macro-runs-on-home-computer-and-gets-error-2147417848-on-work-computer", "title": "Vba macro runs on home computer and gets error 2147417848 on work computer", "body": "<p>With the help of the forum, I created a macro that connects to the web of my bank, fill in the username and password and enter my account. The macro copies the account balance and pastes it into Excel.</p>\n\n<p>On my home computer, it works without problems. However, the work computer does not work. In my workplace, the macro opens the web but does not fill in the user or the password. It stops in the line <code>While. Busy Or.readyState &lt;4</code> and the error <code>Runtime Error 2147417848</code> comes out.</p>\n\n<p>I added \"activobank.com\" to the trusted sites of Explorer and the error follows.</p>\n\n<p>I have checked <code>Explorer&gt; Tools&gt; Internet Options&gt; Connections&gt; LAN settings&gt; Detect settings selected</code> and it is selected. My workplace do not run proxy scripts.</p>\n\n<p>If I enter Manually in Internet Explorer without using macro and I put the user and password, I can enter without problems.</p>\n\n<p>What can be the problem for the macro to work on my home computer and not on my work computer?</p>\n\n<pre><code>'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub SaldoActivo()\n    Dim IE As InternetExplorer\n    Set IE = New InternetExplorer\n\n    With IE\n        .Visible = True\n        \u2018Navigate first web\n        .Navigate2 \"https://www.activobank.com/cs/Satellite/BC/\"\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        .document.querySelector(\"[name=userDNI]\").Value = \"123456789\"\n        .document.querySelector(\"[name=pinNif]\").Value = \"123456789\"\n        .document.querySelector(\"#button1\").Click\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        ' Navigate second page\n        .Navigate2 \"https://www.activobank.com/activobank/CUGlobalPositionNew.init.bs\"\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n    End With\n\n\u2018Code to copy the account balance data\nApplication.Wait (Now + TimeValue(\"00:00:04\"))\n\nCells(1, 1) = IE.document.getElementsByTagName(\"td\")(39).innerText\n\nIE.Quit\nSet IE = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553069773, "post_id": 55256167, "comment_id": 97244005, "body": "I think you misunderstood this website. Because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}, {"owner": {"reputation": 7, "user_id": 9239663, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212873920540731/picture?type=large", "display_name": "J&#252;rgen Lambrecht", "link": "https://stackoverflow.com/users/9239663/j%c3%bcrgen-lambrecht"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553070111, "post_id": 55256167, "comment_id": 97244154, "body": "added my code that i have for the moment"}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1553082569, "post_id": 55256167, "comment_id": 97251348, "body": "How are the time/date stamps added to your sheet? Are they added only to the columns on the left (indicated by your red and grey arrows) or does a separate sub apply the time/date values? What does <code>man</code> and <code>oto</code> do at the start and end of your <code>Sub</code>? Did you want to sum the time values with code and write it somewhere to your sheet or return a value as part of this/another sub? It might make things a bit easier to understand what you want where if you edit your image to include some references to row/column references and adjust your question to reflect these rather than drawings."}], "owner": {"reputation": 7, "user_id": 9239663, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212873920540731/picture?type=large", "display_name": "J&#252;rgen Lambrecht", "link": "https://stackoverflow.com/users/9239663/j%c3%bcrgen-lambrecht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553084716, "creation_date": 1553069565, "last_edit_date": 1553084716, "question_id": 55256167, "link": "https://stackoverflow.com/questions/55256167/get-value-from-2-differend-for-each-ranges-in-a-filtered-worksheet-with-hidden", "title": "get value from 2 differend for each ranges, in a filtered worksheet with hidden colums and rows", "body": "<p>It's not simple to get the values, don't know where to start to write a code</p>\n\n<p>I added a picture with markings that will make it possible to explain the situation</p>\n\n<p><a href=\"https://i.stack.imgur.com/T4kPy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T4kPy.jpg\" alt=\"sample of worksheet\"></a></p>\n\n<p>so here I tell what I trying</p>\n\n<p>the timevalues of red column with red arrow has to be in range al \"hh:mm:ss\"\nbut has also to stay in the original column as short date visible full value of original cel contains \"dd:mm:yyyy hh:mm:ss\" value also the first line in the filtered range rows\"15:80015\" must be skipped </p>\n\n<p>second is the same of gray  column with gray arrow has to be in am \"hh:mm:ss\"\nbut here the first cell has not to be skipped so that i can sum al-am timevalues and see when it has a difference of more than 10minutes </p>\n\n<p>hope this helps to write code or is there a easy way to do this. that column S cell value +1 row sums column t cell value and put the value in range al am or an </p>\n\n<p>when use column t is hidden, but now i put it visible to explain \nso this must work when column t is hidden </p>\n\n<p>code that i have for the moment is this</p>\n\n<pre><code>Private Sub CheckBox7_Click()\n    Call man\n    Dim rng As Range, cll As Range, i As Integer, al(80015) As Variant\n    'Dim i As Long\n    Dim cll2 As Range\n    Dim i2 As Long\n    'Dim lijnen As Range\n    'Dim lijnen2 As Range\n    Dim lijnen As String\n    Dim lijnen2 As String\n    Dim lstijd As String\n    Dim lstijd2 As String\n    Dim lstot As String\n    Dim lslijn As String\n    lijnen = \"t15:t\" &amp; Range(\"t15\").End(xlDown).Row\n    lijnen2 = \"s16:s\" &amp; Range(\"s16\").End(xlDown).Row\n\n\n    Application.ScreenUpdating = False\n    For Each cll In Range(lijnen).SpecialCells(xlCellTypeVisible)\n        If cll.Value &lt;&gt; \"\" Then\n            For Each cll2 In Range(lijnen2).SpecialCells(xlCellTypeVisible)\n                lstijd = Range(\"s\" &amp; cll.Row + cll2.Row - cll.Row)\n                Range(\"am\" &amp; cll.Row) = cll.Value\n                Range(\"al\" &amp; cll.Row) = lstijd\n            Next\n        End If\n    Next\n\n    lstijd = \"\"\n\n    Application.ScreenUpdating = True\n    Call oto\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sorting", "filter", "combobox"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553070115, "post_id": 55256081, "comment_id": 97244158, "body": "Please be more specific what you mean by <i>&quot;<b>if blank</b> then don&#39;t apply any filter on <b>that column</b>&quot;</i>."}, {"owner": {"reputation": 21, "user_id": 11193137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdf8527bc8a00c1a7e38f08d0d4151e?s=128&d=identicon&r=PG&f=1", "display_name": "LimaWhiskey", "link": "https://stackoverflow.com/users/11193137/limawhiskey"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553070483, "post_id": 55256081, "comment_id": 97244324, "body": "Hi @P\u1d07\u029c If the user doesn&#39;t want to apply a site filter then it will show all sites. The current code seems to hide them all."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553070761, "post_id": 55256081, "comment_id": 97244451, "body": "What &quot;site filter&quot;? This word does not appear in your question. You need to be much more specific. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> then <a href=\"https://stackoverflow.com/posts/55256081/edit\">edit</a> your question. You will need more than one sentence to improve it ard make it more clear."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1553072242, "post_id": 55256081, "comment_id": 97245188, "body": "Sounds to me that you are trying to replicate the autofilter functionality. Why cant the user just use the filters provided in Excel instead of using a form to do exactly the same thing?"}], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 8915442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc45c0b53c904a48d002e2ebc301c4f5?s=128&d=identicon&r=PG", "display_name": "Arjun", "link": "https://stackoverflow.com/users/8915442/arjun"}, "is_accepted": true, "score": 1, "last_activity_date": 1553072952, "last_edit_date": 1553072952, "creation_date": 1553072431, "answer_id": 55256930, "question_id": 55256081, "link": "https://stackoverflow.com/questions/55256081/userform-combobox-search-but-clear-if-blank/55256930#55256930", "title": "Userform Combobox search but clear if blank", "body": "<p>You could write a simple If statement to check if the combox has a value if yes then set the table with a filter else omit the Criteria1 argument.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofilter\" rel=\"nofollow noreferrer\">More Information on Criteria1 Argument of Range Autofilter method can be found here</a> </p>\n\n<p>Try something like this:</p>\n\n<pre><code>If UserForm1.ComboBox1.Value &lt;&gt; \"\" Then\n    Worksheets(\"Sheet1\").ListObjects(\"Table1\").Range.AutoFilter field:=1, _\n    Criteria1:=UserForm1.ComboBox1.Value\nElse\n    Worksheets(\"Sheet1\").ListObjects(\"Table1\").Range.AutoFilter field:=1\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11193137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdf8527bc8a00c1a7e38f08d0d4151e?s=128&d=identicon&r=PG&f=1", "display_name": "LimaWhiskey", "link": "https://stackoverflow.com/users/11193137/limawhiskey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 55256930, "answer_count": 1, "score": 0, "last_activity_date": 1553072952, "creation_date": 1553069199, "last_edit_date": 1553069872, "question_id": 55256081, "link": "https://stackoverflow.com/questions/55256081/userform-combobox-search-but-clear-if-blank", "title": "Userform Combobox search but clear if blank", "body": "<p>I have a userform where the user inputs selection's from a dropdown box and once the command button is pressed it filters and sorts the sheet to show them just what is needed.</p>\n\n<p>However, I'm struggling to find a solution which states if blank then don't apply any filter on that column. </p>\n\n<p>Can anyone assist? </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    ThisWorkbook.Sheets(\"Employee List\").Visible = True\n    ThisWorkbook.Sheets(\"Employee List\").Select\n\n    Sheets(\"Employee List\").CommandButton1.Visible = False\n    Sheets(\"Employee List\").CommandButton2.Visible = False\n    Sheets(\"Employee List\").CommandButton3.Visible = True\n    Sheets(\"Employee List\").CommandButton4.Visible = True\n\n    Worksheets(\"Employee List\").ListObjects(\"Employee_List\").Range.AutoFilter Field:=7, Criteria1:=ComboBox1.Value, Operator:=xlAnd\n    Worksheets(\"Employee List\").ListObjects(\"Employee_List\").Range.AutoFilter Field:=8, Criteria1:=ComboBox2.Value, Operator:=xlAnd\n    Worksheets(\"Employee List\").ListObjects(\"Employee_List\").Range.AutoFilter Field:=12, Criteria1:=\"True\", Operator:=xlAnd\n    Worksheets(\"Employee List\").ListObjects(\"Employee_List\").Range.AutoFilter Field:=30, Criteria1:=\"&lt;=\" &amp; Me.ComboBox3.Value, Operator:=xlAnd\n    Worksheets(\"Employee List\").ListObjects(\"Employee_List\").Range.AutoFilter Field:=31, Criteria1:=\"Yes\", Operator:=xlAnd\n    Worksheets(\"Employee List\").ListObjects(\"Employee_List\").Range.AutoFilter Field:=32, Criteria1:=\"No\"\n\n    Worksheets(\"Employee List\").Columns(\"E:E\").EntireColumn.Hidden = True\n    Worksheets(\"Employee List\").Columns(\"I:P\").EntireColumn.Hidden = True\n    Worksheets(\"Employee List\").Columns(\"R:S\").EntireColumn.Hidden = True\n    Worksheets(\"Employee List\").Columns(\"T:T\").EntireColumn.Hidden = True\n    Worksheets(\"Employee List\").Columns(\"V:AF\").EntireColumn.Hidden = True\n\n    Me.Hide\n    ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1553068862, "post_id": 55255957, "comment_id": 97243605, "body": "Your line <code>.ScreenUpdating = Fales</code> should be <code>.ScreenUpdating = False</code>. If it&#39;s not that... There is nothing else on your code that would make excel to show you the procedure."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1553068895, "post_id": 55255957, "comment_id": 97243611, "body": "I recommend always to activate <code>Option Explicit</code> to avoid such typos: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>."}, {"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553069341, "post_id": 55255957, "comment_id": 97243812, "body": "@Damian That&#39;s small typo. When I use this my pasting code doesnt work. I&#39;m getting a blank email with no content.  I have used Option Explicit"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1553069533, "post_id": 55255957, "comment_id": 97243900, "body": "That happens to me too, you can&#39;t have <code>ScreenUpdate = False</code> when pasting images... I turn it on, but then you can see how the procedure is done, because I don&#39;t use <code>Select</code> or <code>Activate</code> doing the images my procedure only shows a small move on every image. Turn on your screenupdating and don&#39;t use select, is not that big of a problem if there are few images."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1553076177, "post_id": 55255957, "comment_id": 97247581, "body": "Please explain if what you want is that Excel sends the email with outlook closed or without displaying the outlook window. Anyway, check the code from Ron de Bruin to have a different approach: <a href=\"https://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s1/outlook/bmail2.htm</a>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1553109196, "post_id": 55255957, "comment_id": 97268122, "body": "Outlook does not have <code>ScreenUpdating = False</code>"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "edited": false, "score": 0, "creation_date": 1553069384, "post_id": 55256069, "comment_id": 97243835, "body": "When I use this my pasting code doesn&#39;t work. I&#39;m getting a blank email with no content."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1553075253, "post_id": 55256069, "comment_id": 97246960, "body": "This raises an error as OutApp is an object that doesn&#39;t have those properties."}], "tags": [], "owner": {"reputation": 1, "user_id": 11230757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3401aff44e475e5f195b0e65bc22b0dc?s=128&d=identicon&r=PG", "display_name": "Peasodecesar", "link": "https://stackoverflow.com/users/11230757/peasodecesar"}, "is_accepted": false, "score": 0, "last_activity_date": 1553069133, "creation_date": 1553069133, "answer_id": 55256069, "question_id": 55255957, "link": "https://stackoverflow.com/questions/55255957/pasting-to-outlook-from-excel-outlook-screen-updating/55256069#55256069", "title": "Pasting to Outlook from Excel - Outlook Screen Updating", "body": "<pre><code>Dim OutApp As Object\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nWith Application  &lt;&lt;&lt;---- change to OutApp\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "edited": false, "score": 0, "creation_date": 1553070303, "post_id": 55256219, "comment_id": 97244242, "body": "I didn&#39;t understand this"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "edited": false, "score": 0, "creation_date": 1553070551, "post_id": 55256219, "comment_id": 97244359, "body": "I&#39;m using a procedure to create and temporary store the images attached to the mail, on this procedure I reenable both <code>ScreenUpdating</code> and <code>EnableEvents</code> just before doing the copy and paste of the image. It&#39;s my way to do it."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1553069784, "creation_date": 1553069784, "answer_id": 55256219, "question_id": 55255957, "link": "https://stackoverflow.com/questions/55255957/pasting-to-outlook-from-excel-outlook-screen-updating/55256219#55256219", "title": "Pasting to Outlook from Excel - Outlook Screen Updating", "body": "<p>If your problem is that you don't want to see the whole procedure of the mail, but turning the <code>ScreenUpdating</code> to false shows you a blank image, here is my code for dealing this:</p>\n\n<pre><code>            Call AhorroMemoria(False)\n            Imagen.CopyPicture xlScreen, xlBitmap\n            With wsM.ChartObjects.Add(Imagen.Left - Imagen.Left * 0.15, Imagen.Top - Imagen.Top * 0.15, _\n            Imagen.Width - Imagen.Width * 0.15, Imagen.Height - Imagen.Height * 0.15)\n                .Activate\n                wsM.Shapes(\"Gr\u00e1fico 1\").Line.Visible = msoFalse\n                .Chart.Paste\n                .Chart.Export wb.Path &amp; \"\\\" &amp; Servicio &amp; Contador &amp; \".jpg\", \"JPG\"\n            End With\n            Call AhorroMemoria(True)\n</code></pre>\n\n<p><code>Call AhorroMemoria(False)</code> turns on everything, screenupdating, enablevents and so... I do that just when copying the image as you can see on the code, then I turn it all off again on the <code>Call AhorroMemoria(True)</code>.</p>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1553079810, "post_id": 55258654, "comment_id": 97249712, "body": "Though you have submitted your answer and closed the issue please give a try to my answer posted a few minutes ago just to share your viewpoint on the approach adopted by me."}], "tags": [], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "is_accepted": true, "score": 0, "last_activity_date": 1553077985, "creation_date": 1553077985, "answer_id": 55258654, "question_id": 55255957, "link": "https://stackoverflow.com/questions/55255957/pasting-to-outlook-from-excel-outlook-screen-updating/55258654#55258654", "title": "Pasting to Outlook from Excel - Outlook Screen Updating", "body": "<p>Thanks all for helping me out. All your codes helped in some way. But i have found more simpler code from Microsoft <a href=\"https://support.microsoft.com/en-in/help/816644/how-to-send-a-range-of-cells-in-an-e-mail-message-by-using-visual-basi\" rel=\"nofollow noreferrer\">here</a>.  I'm not sure which versions will support this and it has any other challenges. For now this works for me in <strong>Office 2016</strong>. </p>\n\n<p>I'm getting an email envelope for brief amount of time in excel but no issues as the accidental edit can't be done in this method. In the original method accidental edit was possible during the paste function is running. </p>\n\n<p>Also this code seamlessly emailing charts on the excel sheet.</p>\n\n<pre><code>Option Explicit    \nSub Send_Range()\n\n       ' Select the range of cells on the active worksheet.\n       ActiveSheet.Range(\"A1:B5\").Select\n\n       ' Show the envelope on the ActiveWorkbook.\n       ActiveWorkbook.EnvelopeVisible = True\n\n       ' Set the optional introduction field thats adds\n       ' some header text to the email body. It also sets\n       ' the To and Subject lines. Finally the message\n       ' is sent.\n       With ActiveSheet.MailEnvelope\n          .Introduction = \"This is a sample worksheet.\"\n          .Item.To = \"E-Mail_Address_Here\"\n          .Item.Subject = \"My subject\"\n          .Item.Send\n       End With\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1553097020, "last_edit_date": 1553097020, "creation_date": 1553079543, "answer_id": 55259150, "question_id": 55255957, "link": "https://stackoverflow.com/questions/55255957/pasting-to-outlook-from-excel-outlook-screen-updating/55259150#55259150", "title": "Pasting to Outlook from Excel - Outlook Screen Updating", "body": "<p>I think you can not suppress display of e-mail creation screen display by invoking <code>Word Editor</code> approach. If you go through previous SO Posts and comments of experienced experts it gets amply clear that  you can not suppress display of e-mail creation screen display.</p>\n\n<p>In order to totally disable e-mail creation screen display please take reference from programs at <a href=\"https://www.rondebruin.nl/win/s1/outlook/mail.htm\" rel=\"nofollow noreferrer\">roundebruin</a> which covers all types of possibilities of sending emails without displaying email creation screen. Here is a slight variation to your code which works for me and posted, if someone finds it useful for similar situation.</p>\n\n<pre><code>Public Sub Emails()\nDim str As String\nDim outlook As Object\nDim newEmail As Object\nDim xInspect As Object\nDim pageEditor As Object\n\nWith Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\nSet outlook = CreateObject(\"Outlook.Application\")\nSet newEmail = outlook.CreateItem(0)\nSet ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\nstr = ws1.Range(\"A5\").Value\nWith newEmail\n    .To = \"xxx.xxx.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = str\n    .body = \"\"\n    .display\n\n    Set xInspect = newEmail.GetInspector\n    Set pageEditor = xInspect.WordEditor\n\n   'Set ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\n    ws1.Range(\"A5\").Copy\n    pageEditor.Application.Selection.Paste xlValues\n    ws1.Range(\"A5:W20\").Copy\n    pageEditor.Application.Selection.Paste xlValues\n\n    .send\n    Set pageEditor = Nothing\n    Set xInspect = Nothing\nEnd With\n\nSet newEmail = Nothing\nSet outlook = Nothing\nWith Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 6648980, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh4.googleusercontent.com/-coRItLVaGHE/AAAAAAAAAAI/AAAAAAAAE_k/7jnzDP_cUWw/photo.jpg?sz=128", "display_name": "Manu Mohan", "link": "https://stackoverflow.com/users/6648980/manu-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 55258654, "answer_count": 4, "score": 1, "last_activity_date": 1592688681, "creation_date": 1553068726, "last_edit_date": 1592688681, "question_id": 55255957, "link": "https://stackoverflow.com/questions/55255957/pasting-to-outlook-from-excel-outlook-screen-updating", "title": "Pasting to Outlook from Excel - Outlook Screen Updating", "body": "<p>I have found the code to paste a chart from excel to outlook <a href=\"https://stackoverflow.com/questions/49093838/pasting-chart-into-outlook-email-from-excel\">here</a> on stack over flow.</p>\n\n<p>This works fine but The issue is the outlook creating new email and pasting procedure is getting displayed on the screen. Is there any way to disable or make this to background?</p>\n\n<pre><code>Sub Mail_Range()\n    Dim Sht As Excel.Worksheet\n    Set Sht = ThisWorkbook.ActiveSheet\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Dim rng As Range\n    Set rng = Sht.Range(\"A5:W20\")\n        rng.Copy\n\n    Dim OutApp As Object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n\n    Dim OutMail As Object\n    Set OutMail = OutApp.CreateItem(0)\n\n    Dim vInspector As Object\n    Set vInspector = OutMail.GetInspector\n\n    Dim wEditor As Object\n    Set wEditor = vInspector.WordEditor\n\n    With OutMail\n        .TO = \"xxx.xxx.com\"\n        .CC = \"\"\n        .Subject = Sht.Range(\"A5\").Value\n        .GetInspector\n         wEditor.Paragraphs(1).Range.Text = \"This is an auto generated e-mail\" &amp; vbCr\n         wEditor.Paragraphs(2).Range.Paste\n        .send\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\n    Application.CutCopyMode = False\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>When I'm using </p>\n\n<pre><code>With Application\n            .ScreenUpdating = False\n            .EnableEvents = False\n        End With\n</code></pre>\n\n<p>after outlook application creation my pasting code doesn't work. Im getting an email with no content. </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553068579, "post_id": 55255867, "comment_id": 97243472, "body": "How would vba know where to input the new string within the existing one?"}, {"owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553069319, "post_id": 55255867, "comment_id": 97243804, "body": "I will input the cursor using mouse. Then the new caption should be inserted on my cursor position."}], "answers": [{"comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1553070508, "post_id": 55256319, "comment_id": 97244339, "body": "I think <code>Selstart</code> keeps its value even after the edit box lost foucs - so no need to keep it in a global var."}, {"owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "edited": false, "score": 0, "creation_date": 1553072491, "post_id": 55256319, "comment_id": 97245322, "body": "Thanks Gustav, it works for inserting values on cursor point. But now, even if I type a new text, it also starts from left and every new word gets typed on the left end in the form &quot;CBA&quot; whereas, by default it should have been &quot;ABC&quot; if I type A, B and C in order."}, {"owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "edited": false, "score": 0, "creation_date": 1553082083, "post_id": 55256319, "comment_id": 97251051, "body": "Actually, it does not work without declaring LastPosition variable in MS Access 2016. I found the solution to my problem. Let me post here."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1553084721, "post_id": 55256319, "comment_id": 97252755, "body": "Don&#39;t know what you do. The solution posted is tested and works here."}, {"owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "edited": false, "score": 0, "creation_date": 1553103847, "post_id": 55256319, "comment_id": 97265437, "body": "Yes, that might be working for editing records only when a cursor is placed. However, when I add a new record without clicking anywhere, in that case, I had to adjust your code a bit to avoid issues."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1553104608, "post_id": 55256319, "comment_id": 97265843, "body": "OK, but not easy to guess, as you wrote: <i>I will input the cursor using mouse. Then the new caption should be inserted on my cursor position.</i>"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1553070166, "creation_date": 1553070166, "answer_id": 55256319, "question_id": 55255867, "link": "https://stackoverflow.com/questions/55255867/how-to-insert-new-text-within-existing-text-in-a-textbox-using-command-buttons/55256319#55256319", "title": "How to insert new text within existing text in a textbox using Command buttons?", "body": "<p>Store the cursor position using a variable when leaving the textbox:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate LastPosition    As Long\n\nPrivate Sub CmdBtn_Click()\n\n    Dim Text    As String\n\n    Text = Me!TargetBox.Value\n\n    ' Insert source text at the stored position.\n    Me!TargetBox.Value = Left(Text, LastPosition) &amp; Me!SourceBox.Value &amp; Mid(Text, LastPosition + 1)\n\nEnd Sub\n\nPrivate Sub UserName_LostFocus()\n\n    ' Store cursor position.\n    LastPosition = Me!UserName.SelStart\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "is_accepted": false, "score": 0, "last_activity_date": 1553084828, "last_edit_date": 1553084828, "creation_date": 1553082615, "answer_id": 55260109, "question_id": 55255867, "link": "https://stackoverflow.com/questions/55255867/how-to-insert-new-text-within-existing-text-in-a-textbox-using-command-buttons/55260109#55260109", "title": "How to insert new text within existing text in a textbox using Command buttons?", "body": "<p>The solution below works perfectly for inputting text at any position of TextBox. Let me know if someone has a better solution than this.</p>\n\n<pre><code>Private LastPosition as Long\nPrivate Text as String\n\nPrivate Sub TextBox_LostFocus()\n        If LastPosition = 0 and IsNull(Me!TextBox.Value) Then\n              Me!TextBox = \" \" + Me.ActiveControl.Caption\n              LastPosition = LastPosition + Len(Me.ActiveControl.Caption)\n        ElseIf \n              LastPosition &gt;= AND Not IsNull(Me!TextBox.Value) Then\n              Text = Me!TextBox.Value\n\n              Me!TextBox.Value = Left( Text, LastPosition) &amp; \" \" &amp; _\n              Me.ActiveControl.Caption &amp; Mid(Text, LastPosition + 1)\n\n              LastPosition = LastPosition + Len(Me.ActiveControl.Caption)\n\n        Else  \n              Me!TextBox.Value = Me!TextBox.Value + \" \" + Me.ActiveControl.Caption\n\n        End If\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 11215796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79586beb01377f08722a1ae373f7c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Lone", "link": "https://stackoverflow.com/users/11215796/lone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594620678, "creation_date": 1553068398, "last_edit_date": 1594620678, "question_id": 55255867, "link": "https://stackoverflow.com/questions/55255867/how-to-insert-new-text-within-existing-text-in-a-textbox-using-command-buttons", "title": "How to insert new text within existing text in a textbox using Command buttons?", "body": "<p>I have a custom calculator whose buttons when pressed, insert their caption into a textbox.</p>\n\n<pre><code>Private Sub CmdBtn_Click()\n   Me.TextBox.Value = Me.TextBox.Value &amp; \" \" &amp; CmdBtn.Caption\nEnd Sub\n</code></pre>\n\n<p>It works fine. However, with this method one cannot insert new text in a text that already exists. For example, if current text is \"abc\" then I want to input \"x\" between \"a\" and \"bc\" to give me end result of \"axbc\". I will put my cursor at the desired position where new text should be placed. Does someone know how can it be achieved?\nThanks,</p>\n"}, {"tags": ["excel", "vba", "merge"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 2656639, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001228990634/picture?type=large", "display_name": "Filip Fr\u0105tczak", "link": "https://stackoverflow.com/users/2656639/filip-fr%c4%85tczak"}, "edited": false, "score": 0, "creation_date": 1553072316, "post_id": 55255462, "comment_id": 97245223, "body": "Edited solution unmerges cells. Still not that."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1553067308, "last_edit_date": 1553067308, "creation_date": 1553066685, "answer_id": 55255462, "question_id": 55254764, "link": "https://stackoverflow.com/questions/55254764/vba-formatting-table-with-merged-cells/55255462#55255462", "title": "VBA formatting table with merged cells", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test1()\n\n    Dim LastColumn As Long, LastRow As Long, i As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        LastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        For i = 2 To LastRow Step 2\n            .Range(Cells(i, 1), .Cells(i, LastColumn)).Interior.Color = vbGreen '&lt;- You could change the color\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Before:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/qdfZF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qdfZF.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>After:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/hVhea.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hVhea.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Edited Solution:</strong></p>\n\n<pre><code>Option Explicit\n\nSub test1()\n\n    Dim rng As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Set rng = .UsedRange\n\n        .ListObjects.Add(xlSrcRange, rng, , xlYes).Name = \"Table1\"\n        .ListObjects(\"Table1\").TableStyle = \"TableStyleLight3\"\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Result:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/91sBt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/91sBt.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 2656639, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001228990634/picture?type=large", "display_name": "Filip Fr\u0105tczak", "link": "https://stackoverflow.com/users/2656639/filip-fr%c4%85tczak"}, "is_accepted": true, "score": 0, "last_activity_date": 1553242172, "creation_date": 1553242172, "answer_id": 55295324, "question_id": 55254764, "link": "https://stackoverflow.com/questions/55254764/vba-formatting-table-with-merged-cells/55295324#55295324", "title": "VBA formatting table with merged cells", "body": "<p>So, after some time I've figured it out by myself. Below is the code:</p>\n\n<pre><code>Dim i As Long, j As Long, k As Long, l As Long, c As Integer\nrow = Cells(Rows.Count, 2).End(xlUp).row\nk = 7\nc = 1\nFor i = 7 To row Step 1\n    If Join(Application.Transpose(Application.Transpose(Range(Cells(i, 1), Cells(i, 3)))), Chr(0)) &lt;&gt; Join(Application.Transpose(Application.Transpose(Range(Cells(i + 1, 1), Cells(i + 1, 3)))), Chr(0)) Then\n      If i &lt;&gt; k Then\n        For j = 1 To 3 Step 1\n              Application.DisplayAlerts = False\n              Range(Cells(i, j), Cells(k, j)).Merge\n              Application.DisplayAlerts = True\n        Next j\n      End If\n    Select Case c\n        Case 0\n            Range(Cells(k, 1), Cells(k, 3)).Interior.Color = xlNone\n            c = 1\n        Case 1\n            For l = 0 To i - k Step 1\n                Range(Cells(k + l, 1), Cells(k + l, 3)).Interior.Color = RGB(217, 225, 242)\n            Next l\n            c = 0\n    End Select\n    k = i + 1\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 2656639, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001228990634/picture?type=large", "display_name": "Filip Fr\u0105tczak", "link": "https://stackoverflow.com/users/2656639/filip-fr%c4%85tczak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 55295324, "answer_count": 2, "score": 0, "last_activity_date": 1553242172, "creation_date": 1553063474, "last_edit_date": 1553064449, "question_id": 55254764, "link": "https://stackoverflow.com/questions/55254764/vba-formatting-table-with-merged-cells", "title": "VBA formatting table with merged cells", "body": "<p>I've got a function which merges cells in table if whole range has the same value (eg. if A1:G1 is equal to A2:B2 it will merge cells like A1&amp;A2, B1&amp;B2 etc. More here: <a href=\"https://stackoverflow.com/questions/55237775/how-to-check-if-two-ranges-value-is-equal\">How to check if two ranges value is equal</a>)\nNow I would like, to change color on table created by that funcion, like first row (doesn't matter if merged or no) filled with color, second blank etc. but I have no idea whether I should color it with merging function or create another which will detect new table with merged rows as one etc. Below is my code:</p>\n\n<pre><code>Sub test()\n\n    Dim i As Long, j As Long, k As Long, row As Long\n    row = Cells(Rows.Count, 2).End(xlUp).row\n    k = 1\n    For i = 1 To row Step 1\n        If Cells(i, 1).Value = \"\" Then Exit For\n        If Join(Application.Transpose(Application.Transpose(Range(Cells(i, 1), Cells(i, 3)))), Chr(0)) &lt;&gt; Join(Application.Transpose(Application.Transpose(Range(Cells(i + 1, 1), Cells(i + 1, 3)))), Chr(0)) Then\n          If i &lt;&gt; k Then\n            For j = 1 To 3 Step 1\n                  Application.DisplayAlerts = False\n                  Range(Cells(i, j), Cells(k, j)).Merge\n                  Application.DisplayAlerts = True\n            Next j\n          End If\n        k = i + 1\n        End If\n    Next i\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "focus", "powerpoint"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1553065562, "post_id": 55254454, "comment_id": 97242217, "body": "<a href=\"https://stackoverflow.com/a/127125/3111149\">How to record a macro in PowerPoint</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11230145, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157188940064697/picture?type=large", "display_name": "Alex Reitz", "link": "https://stackoverflow.com/users/11230145/alex-reitz"}, "edited": false, "score": 0, "creation_date": 1553100739, "post_id": 55257502, "comment_id": 97263649, "body": "Thank you so much ! If i want to open a second file, always in kiosk mode, and i want to focus on either this file or the other, do i need to call SlideShowWindow(i).activate ? What would be the code, to open a second file, and go to a slide, then have this slide displayed on front of screen ?"}], "tags": [], "owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "is_accepted": false, "score": 0, "last_activity_date": 1553074283, "creation_date": 1553074283, "answer_id": 55257502, "question_id": 55254454, "link": "https://stackoverflow.com/questions/55254454/vba-powerpoint-what-is-the-vba-equivalent-to-hyperlink-to-a-different-powerpo/55257502#55257502", "title": "VBA Powerpoint : what is the VBA equivalent to &quot;hyperlink to a different Powerpoint Presentation?", "body": "<p>This Code opens a Presentation goes to Slide Number 5 and starts in Kiosk Mode</p>\n\n<pre><code>Dim PowerPointApp As PowerPoint.Application\nDim myPPT As PowerPoint.Presentation\n\n'Open the Slideshow\nSet myPPT = PowerPointApp.Presentations.Open(FileName:=\"filename.pptx\")\n\nApplication.ActivePresentation.SlideShowSettings.ShowType = ppShowTypeKiosk\n\n'You need this to work\nActivePresentation.SlideShowWindow.View.Exit\nActivePresentation.SlideShowSettings.Run\n\n'Goto Slide number 5\nmyPPT.Windows(1).View.GotoSlide 5\n\n'Start Slide Show\nmyPPT.SlideShowSettings.Run\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11230145, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157188940064697/picture?type=large", "display_name": "Alex Reitz", "link": "https://stackoverflow.com/users/11230145/alex-reitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553074283, "creation_date": 1553061739, "question_id": 55254454, "link": "https://stackoverflow.com/questions/55254454/vba-powerpoint-what-is-the-vba-equivalent-to-hyperlink-to-a-different-powerpo", "title": "VBA Powerpoint : what is the VBA equivalent to &quot;hyperlink to a different Powerpoint Presentation?", "body": "<p>I want to use several slideshows (in kiosk mode if possible), to be able to jump between them, without going back in edit mode... \nNo problem to do it with shapes and \"hyperlink to a different powerpoint presentation\".\nBut i'd need to do it also in VBA macros, in some slides. \nFor example, after a quiz is finished, jump to another slideshowwindow and a given slide, and give focus to that slideshowwindow :\nWhat would be the code like ?\nI'm unable to give focus to the new slideshowwindow...\nI suppose it is the equivalent of what \"hyperlink to a different PPT Presentation does, but i can't figure to do it.\nThank you very much in advance !</p>\n\n<p>Alex</p>\n"}, {"tags": ["vba", "date", "format"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1553061507, "post_id": 55254136, "comment_id": 97240710, "body": "Please provide sample data and the formula that is related. We can&#39;t see what you have and no idea where to begin."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1553065195, "post_id": 55254136, "comment_id": 97242077, "body": "Your cell needs to have text format before: <code>Range.NumberFormat = &quot;@&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 11230125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3d5a1951a925841e680387c8cf85f5?s=128&d=identicon&r=PG&f=1", "display_name": "yashus123", "link": "https://stackoverflow.com/users/11230125/yashus123"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1553161286, "post_id": 55254136, "comment_id": 97284949, "body": "Sorry @PatricK for not being descriptive. I figured above and caught in some other similar to the above problem.:                             Let&#39;s say in one Sheet I&#39;ve Input data in Cells(1,5) = 1 and Cells(5,5) = 2.00 and the concatenate output should be &quot;1 2.00&quot; what I&#39;m getting is &quot;1 2&quot; It is possible to achieve the decimal &quot;.00&quot; when concatenated?                                                    Cells(i + 20, k + 1) = Cells(n, j + 1) &amp; &quot; &quot; &amp; Cells(i + 2, j + 1)   &#39; code i&#39;ve used"}, {"owner": {"reputation": 1, "user_id": 11230125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3d5a1951a925841e680387c8cf85f5?s=128&d=identicon&r=PG&f=1", "display_name": "yashus123", "link": "https://stackoverflow.com/users/11230125/yashus123"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1553161307, "post_id": 55254136, "comment_id": 97284960, "body": "Thanks @Asger for the response"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1553211676, "post_id": 55254136, "comment_id": 97310801, "body": "if you want exactly what is displayed in the cell rather than value, use <code>.Text</code> instead of <code>.Value</code>."}, {"owner": {"reputation": 1, "user_id": 11230125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3d5a1951a925841e680387c8cf85f5?s=128&d=identicon&r=PG&f=1", "display_name": "yashus123", "link": "https://stackoverflow.com/users/11230125/yashus123"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1553227567, "post_id": 55254136, "comment_id": 97314106, "body": "Thanks @PatricK its worked perfectly fine."}], "owner": {"reputation": 1, "user_id": 11230125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3d5a1951a925841e680387c8cf85f5?s=128&d=identicon&r=PG&f=1", "display_name": "yashus123", "link": "https://stackoverflow.com/users/11230125/yashus123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553211321, "creation_date": 1553059935, "last_edit_date": 1553211321, "question_id": 55254136, "link": "https://stackoverflow.com/questions/55254136/concatenate-date-format-in-vba", "title": "Concatenate &amp; Date format in VBA", "body": "<p>I have a set of formulae in VBA which automatic concatenates and gives the value something like above \"<code>2 1</code>\".\nWhenever the second no is negative the output changes in date format. Can anyone help to get in the normal format like above?</p>\n\n<p>Let's say in one Sheet I've Input data in Cells(1,5) = 1 and Cells(5,5) = 2.00 and the concatenate output should be \"<code>1 2.00</code>\" what I'm getting is \"<code>1 2</code>\" Is it possible to achieve the decimal \"<code>.00</code>\" when concatenated?\n<code>Cells(i + 20, k + 1) = Cells(n, j + 1) &amp; \" \" &amp; Cells(i + 2, j + 1)</code> ' code i've used:\n<a href=\"https://i.stack.imgur.com/Sg5UA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Sg5UA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1553204961, "post_id": 55253577, "comment_id": 97308756, "body": "Please understand that Stackoverflow isn&#39;t a code-it-for-me service. People here will be generous in helping you fix problems with code you&#39;ve written but they won&#39;t write the code for you."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11229896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a07f26dce8d5f1068afd4c826602c858?s=128&d=identicon&r=PG&f=1", "display_name": "jiadename", "link": "https://stackoverflow.com/users/11229896/jiadename"}, "edited": false, "score": 0, "creation_date": 1553432898, "post_id": 55301404, "comment_id": 97374451, "body": "Thanks medicine_man! I&#39;ll try it out when I get back at work.. this changes the text colour of the whole textbox?"}], "tags": [], "owner": {"reputation": 311, "user_id": 11226789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPSOV.jpg?s=128&g=1", "display_name": "medicine_man", "link": "https://stackoverflow.com/users/11226789/medicine-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1553263666, "creation_date": 1553263666, "answer_id": 55301404, "question_id": 55253577, "link": "https://stackoverflow.com/questions/55253577/powerpoint-vba-to-search-for-and-change-colour-highlight-keywords-in-textbox/55301404#55301404", "title": "Powerpoint VBA to search for and change colour/highlight keywords in textbox", "body": "<p>Since your question is generic, We can only give a generic response.</p>\n\n<p>First thing you need to know about VBA in powerpoint for your issue is that you need to access things like objects. You'll first need to access the current Slide and Shape your textbox is in. In this example, Let's assume the textbox you want to access is in the first slide, in the first shape:</p>\n\n<pre><code>Set oTextbox = ActivePresentation.Slides(1).Shapes(1)\nWith oTextbox\n    text = .TextFrame.TextRange.Characters.Text 'To access the textbox text.\n    If InStr(1,text,\"some_text\")\n        .TextFrame.TextRange.Font.Color.RGB = [255 0 0] 'To change the color of a textbox.\n    End If\nEnd With\n</code></pre>\n\n<blockquote>\n  <p><code>.TextFrame.TextRange.Characters.Text</code> accesses the shape's text.</p>\n  \n  <p>To search for a given text in the textbox, you can use the <code>InStr</code>\n  command to see if the text you want is in your textbox.</p>\n  \n  <p><code>.TextFrame.TextRange.Font.Color.RGB</code> accesses the text's color.</p>\n</blockquote>\n\n<p>This is at least a start for you.</p>\n"}], "owner": {"reputation": 1, "user_id": 11229896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a07f26dce8d5f1068afd4c826602c858?s=128&d=identicon&r=PG&f=1", "display_name": "jiadename", "link": "https://stackoverflow.com/users/11229896/jiadename"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553270419, "creation_date": 1553055841, "last_edit_date": 1553270419, "question_id": 55253577, "link": "https://stackoverflow.com/questions/55253577/powerpoint-vba-to-search-for-and-change-colour-highlight-keywords-in-textbox", "title": "Powerpoint VBA to search for and change colour/highlight keywords in textbox", "body": "<p>I am very new to VB and am exploring this method to simplify mundane manual work process of highlighting certain text in Powerpoint textboxes.\nMy intention is for VBA to search for keywords in the textbox, then changes the colour of this line and also a few other lines. e.g. search for the line that contains the word \"video\", if it returns that line 7 contains this word, I want to change the colour of line 7 and maybe lines 3, 10 and 11 to red colour.</p>\n"}, {"tags": ["c#", "sql", "excel", "vba", "connection-string"], "comments": [{"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1553053201, "post_id": 55253197, "comment_id": 97238658, "body": "Are you not getting any value in <code>workbook_PMR.Connections</code>? Does any thing display on Console?"}, {"owner": {"reputation": 619, "user_id": 1134410, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4fcd2c7ffa565c646a537e7efd519d81?s=128&d=identicon&r=PG", "display_name": "ironman", "link": "https://stackoverflow.com/users/1134410/ironman"}, "reply_to_user": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1553095649, "post_id": 55253197, "comment_id": 97260244, "body": "@ChetanRanpariya Yes in the console I am getting all the connection names (I have 4 connections) and getting them on console."}, {"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1553153755, "post_id": 55253197, "comment_id": 97281444, "body": "So what is the issue you are facing?"}, {"owner": {"reputation": 619, "user_id": 1134410, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4fcd2c7ffa565c646a537e7efd519d81?s=128&d=identicon&r=PG", "display_name": "ironman", "link": "https://stackoverflow.com/users/1134410/ironman"}, "reply_to_user": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1553173626, "post_id": 55253197, "comment_id": 97292014, "body": "I want to modify the connection string and then refresh the excel data with the connections. Here I am not able to get the connection string value and not getting a chance to modify the same."}], "answers": [{"tags": [], "owner": {"reputation": 1994, "user_id": 2117037, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ba92d2cbd6945934f38d5aa952ffcab2?s=128&d=identicon&r=PG", "display_name": "Leo Gurdian", "link": "https://stackoverflow.com/users/2117037/leo-gurdian"}, "is_accepted": false, "score": 0, "last_activity_date": 1614118116, "last_edit_date": 1614118116, "creation_date": 1614059700, "answer_id": 66327795, "question_id": 55253197, "link": "https://stackoverflow.com/questions/55253197/how-to-modify-the-existing-sql-connection-in-excel-workbook-using-c-and-then-re/66327795#66327795", "title": "How to modify the existing SQL connection in excel workbook using c# and then refresh the data", "body": "<p>Update the Microsoft.Office.Interop.Excel.<strong>WorkbookConnection</strong></p>\n<p>Below I'm replacing the database server with a NEW database server.</p>\n<p>It's not a console app but you get the idea.</p>\n<h2>The code:</h2>\n<pre><code>using System.Windows.Forms;\nusing Excel = Microsoft.Office.Interop.Excel;\n\n----\nExcel.Workbook myBook = null;\nExcel.Application myApp = null;\nExcel.WorkbookConnection wbConn = null;\nstring workbook = @&quot;C:\\test\\MCK VA User Level Security.xlsm&quot;;\nstring dbTarget = cboTarget.SelectedValue.ToString();\nmyApp = new Excel.Application();\n\ntry\n{\n    myApp.Visible = false;\n    myBook = myApp.Workbooks.Open(workbook);\n    object index = 1 as object;\n    for (int i = 1; i &lt;= myBook.Connections.Count; i++)\n    {\n        wbConn = myBook.Connections.Item(i);\n        dynamic dbConn = wbConn.OLEDBConnection.Connection;\n        lblDataSource.Text = dbConn.Replace(&quot;oldDBserver&quot;, dbTarget); // display change\n        dbConn = (object)lblDataSource.Text;\n        wbConn.OLEDBConnection.Connection = dbConn; // Update the db connection string\n    }\n    myBook.Application.DisplayAlerts = false;\n    myBook.Save();\n\n}\ncatch (Exception)\n{\n    throw;\n}\nfinally\n{\n    myBook.Close(1);\n    myApp.Quit();\n    if (wbConn != null) Marshal.ReleaseComObject(wbConn); wbConn = null;\n    if (myBook != null) Marshal.ReleaseComObject(myBook); myBook = null;\n    if (myApp != null) Marshal.ReleaseComObject(myApp); myApp = null;\n}\n</code></pre>\n"}], "owner": {"reputation": 619, "user_id": 1134410, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4fcd2c7ffa565c646a537e7efd519d81?s=128&d=identicon&r=PG", "display_name": "ironman", "link": "https://stackoverflow.com/users/1134410/ironman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1614118116, "creation_date": 1553053025, "last_edit_date": 1553067369, "question_id": 55253197, "link": "https://stackoverflow.com/questions/55253197/how-to-modify-the-existing-sql-connection-in-excel-workbook-using-c-and-then-re", "title": "How to modify the existing SQL connection in excel workbook using c# and then refresh the data", "body": "<p>I have Excel file which has SQL connection in workbook to fetch the data from SQL Server, I want to update the connection string using c# program but I am unable to get to the connection string value and can not update that. After first step I want to refresh the data for the same connection.\nWith the below code I am able to get the connection names but I am not able to find the way to modify it after that I can refresh the data with updated connection.</p>\n\n<pre><code>    private static void RefreshTheExcelData()\n    {\n        Application application_PMR = new Application();\n\n        Workbook workbook_PMR = application_PMR.Workbooks.Open(filePath);\n\n        var workBook_Connection = workbook_PMR.Connections;\n\n        foreach (WorkbookConnection cn in workbook_PMR.Connections)\n            Console.WriteLine(cn.Name);\n    }\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11229632, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161792201995556/picture?type=large", "display_name": "Kenneth", "link": "https://stackoverflow.com/users/11229632/kenneth"}, "edited": false, "score": 0, "creation_date": 1564075869, "post_id": 55252902, "comment_id": 100921278, "body": "I have spent quite some time on this. If you have a link to one of the solutions you found on google, I would very much appreciate it. The problem is that the data in your example is listed downwards in the spreadsheet. I have all the data on multiple columns in a single row."}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1553050704, "creation_date": 1553050704, "answer_id": 55252902, "question_id": 55252684, "link": "https://stackoverflow.com/questions/55252684/count-number-of-days-in-multiple-date-ranges-without-counting-the-overlaps/55252902#55252902", "title": "Count number of days in multiple date ranges without counting the overlaps", "body": "<p>You must have searched in a rather haphazard manner if you haven\u2019t found an answer to this question.  Just checked myself and it takes about a minute of Googling.  You also didn\u2019t show your attempt at solving the problem so I\u2019m only going to point you at the right direction without showing you the whole solution.</p>\n\n<p>It's an array formula so has to be entered with Control-Shift-Enter:</p>\n\n<pre><code> =COUNT(MMULT(\n TRANSPOSE(B2:B4^0),\n (TRANSPOSE($A$8+ROW(A1:INDEX($A:$A, $B$8-$A$8+1))-1)&gt;=$A$2:$A$4)*\n (TRANSPOSE($A$8+ROW(A1:INDEX($A:$A, $B$8-$A$8+1))-1)&lt;=B2:B4))^0)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Wlxxj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wlxxj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 11229632, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161792201995556/picture?type=large", "display_name": "Kenneth", "link": "https://stackoverflow.com/users/11229632/kenneth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553067359, "creation_date": 1553048888, "last_edit_date": 1553067359, "question_id": 55252684, "link": "https://stackoverflow.com/questions/55252684/count-number-of-days-in-multiple-date-ranges-without-counting-the-overlaps", "title": "Count number of days in multiple date ranges without counting the overlaps", "body": "<p>I have a table that describes when a some racing cars in a pool of cars are out for modification. The table describes the start and end dates for each modification, and sometimes multiple modifications happen on overlapping dates. I want to know the <strong>total number of days</strong> a <strong>particular car</strong> is unavailable within a <strong>certain year</strong>.</p>\n\n<p><strong><em>Worksheet:</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/vAMva.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vAMva.png\" alt=\"enter image description here\"></a></p>\n\n<p>In the example above, I want to count the days the car is unavailable in 2019 in the <code>AC:AD</code>, <code>AG:AH</code>, <code>AK:AL</code> and <code>AO:AP</code> ranges, without counting overlapping days. The result for Car 1 should be 5 days.</p>\n\n<p>Stackoverflow have many similar problems, but I have yet to find one where you have to count the dates like this.</p>\n"}, {"tags": ["excel", "vba", "formatting", "conditional", "formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "edited": false, "score": 2, "creation_date": 1553048058, "post_id": 55252521, "comment_id": 97237625, "body": "Can you show sample data and indicate which cell should be red?"}, {"owner": {"reputation": 1, "user_id": 11229518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df993ad127e59643da55f34a3753241f?s=128&d=identicon&r=PG&f=1", "display_name": "Gunjani786", "link": "https://stackoverflow.com/users/11229518/gunjani786"}, "edited": false, "score": 0, "creation_date": 1553125215, "post_id": 55252521, "comment_id": 97274624, "body": "@user11217663   I need to have atleast one rest day in a 14day period. From the example below, using the above formula, if  I attend the Gym on 17th March it will highlight in red  cell containing &quot;GYM&quot; on the 4th March indicating I have attended Gym too many consecutive days and I need a rest period in between. This is OK but it means I have to continually scroll up to see if any cell turned red as I input new data. I would rather it warn me as I am entering New data, i.e.In this example, highlight the Cell contain GYM on the 17th March  instaed of the 4th March."}, {"owner": {"reputation": 1, "user_id": 11229518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df993ad127e59643da55f34a3753241f?s=128&d=identicon&r=PG&f=1", "display_name": "Gunjani786", "link": "https://stackoverflow.com/users/11229518/gunjani786"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1553125278, "post_id": 55252521, "comment_id": 97274642, "body": "@Harun24HR   04-Mar\tM\tGym 05-Mar\tT\tGym 06-Mar\tW\tGym 07-Mar\tT\tGym 08-Mar\tF\tGym 09-Mar\tS\tGym 10-Mar\tS\tGym 11-Mar\tM\tGym 12-Mar\tT\tGym 13-Mar\tW\tGym 14-Mar\tT\tGym 15-Mar\tF\tGym 16-Mar\tS\tGym 17-Mar\tS\tGym"}], "owner": {"reputation": 1, "user_id": 11229518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df993ad127e59643da55f34a3753241f?s=128&d=identicon&r=PG&f=1", "display_name": "Gunjani786", "link": "https://stackoverflow.com/users/11229518/gunjani786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553048935, "creation_date": 1553047553, "last_edit_date": 1553048935, "question_id": 55252521, "link": "https://stackoverflow.com/questions/55252521/excel-conditional-formatting-using-formulas", "title": "Excel -Conditional Formatting using Formulas", "body": "<p>I have a table of data. Using the following working formula in Conditional formatting, it highlights correctly in red, from top to bottom, the Starting Cell of the group of cells when the formula is True.</p>\n\n<pre><code>=COUNTA(D8:D21)-COUNTIF(D8:D21,\"OFF\")-COUNTIF(Dt8:D21,\"Leave\")&gt;13\n</code></pre>\n\n<p>However I would like it to highlight in red the last cell in the group. How can this be done. I tried the following with no joy...</p>\n\n<pre><code>=If(COUNTA(D8:D21)-COUNTIF(D8:D21,\"OFF\")-COUNTIF(D8:D21,\"Leave\")&gt;13, (COUNTA(D8:D21)-COUNTIF(D8:D21,\"OFF\")-COUNTIF(D8:D21,\"Leave\")&gt;13)+13, 0)\n\n=Count(D8:D34)+COUNTA(D8:D21)-COUNTIF(D8:D21,\"OFF\")-COUNTIF(D8:D21,\"Leave\")&gt;13\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "is_accepted": false, "score": 1, "last_activity_date": 1553045283, "creation_date": 1553045283, "answer_id": 55252290, "question_id": 55252031, "link": "https://stackoverflow.com/questions/55252031/vba-vlookup-find-value-using-vlookup/55252290#55252290", "title": "VBA Vlookup find value using VLookup", "body": "<p>While it seems counter-intuitive, you cannot catch a worksheet error (e.g. #N/A, #REF!, etc) thrown by Application.WorksheetFunction.VLookup or WorksheetFunction.VLookup into a variant for examin ation with IsError.</p>\n\n<p>You need to use Application.VLookup instead.</p>\n\n<pre><code>    Dim result As Variant\n\n    '...\n\n    result = Application.VLookup(sCostElem, shtSource.Range(OVERHEAD_LOOKUP_RANGE_NAME), 2, False)\n\n    '--Check return value of Vlookup\n    If IsError(result) Then\n        debug.print \"error: \" &amp; result\n    Else\n        debug.print \"match: \" &amp; result\n    End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1553067279, "post_id": 55253275, "comment_id": 97242892, "body": "Note that <code>On Error GoTo 0</code> should happen in <b>any</b> case not only <code>If Err</code>. Otherwise if you have more code after <code>End If</code> you will hide these errors too. \u2022 <code>On Error Resume Next</code> does not only hide the &quot;next&quot; error but all errors until <code>End Sub</code> or <code>On Error Goto 0</code>. The word &quot;next&quot; means that on an error it should proceed with the &quot;next&quot; code line. So <b>always</b> reactivate error reporting with <code>On Error Goto 0</code> not only if an error occured. \u2022 Actually this <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>  is a pretty good resource."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553082351, "post_id": 55253275, "comment_id": 97251203, "body": "@P\u1d07\u029c: Thanks. Can&#39;t believe I missed this. I&#39;ve used the site on many occasions, most recently for collections and dictionaries. I&#39;ve read the article again. There is this <b>On Error Goto -1</b> part that is confusing. Is this a mistake or am I missing something? <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/on-error-statement\" rel=\"nofollow noreferrer\">VB</a>, <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/on-error-statement\" rel=\"nofollow noreferrer\">VBA</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1553084323, "post_id": 55253275, "comment_id": 97252464, "body": "Actually <code>On Error GoTo -1</code> works in VBA too. It clears the error <code>Err</code> end set it to <code>Nothing</code> only (it does not re-activate error reporting). The <code>On Error GoTo 0</code> does the same but also re-activates error reporting. I never came accross a situation to use it."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1553077120, "last_edit_date": 1553077120, "creation_date": 1553053603, "answer_id": 55253275, "question_id": 55252031, "link": "https://stackoverflow.com/questions/55252031/vba-vlookup-find-value-using-vlookup/55253275#55253275", "title": "VBA Vlookup find value using VLookup", "body": "<h1>Minor Error Handling</h1>\n\n<p>If you don't want to change your code you can use this:</p>\n\n<pre><code>    On Error Resume Next\n    result = Application.WorksheetFunction.VLookup(sCostElem, _\n            shtSource.Range(OVERHEAD_LOOKUP_RANGE_NAME), 2, False)\n    '--Check return value of Vlookup\n    If Err Then\n        ' Reset error.\n        On Error GoTo 0\n      Else\n'***********************************************************\n    ' IMPORTANT CORRECTION:\n    ' Added the following line for reasons P\u1d07\u029c pointed out in the comments.\n        ' Reset error.\n        On Error GoTo 0\n'***********************************************************\n        ' Do stuff with 'result' e.g.\n        Debug.Print result\n    End If\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 2378895, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/44614b12eb7d2787b2c7ebb50c69a555?s=128&d=identicon&r=PG", "display_name": "user2378895", "link": "https://stackoverflow.com/users/2378895/user2378895"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1553077120, "creation_date": 1553043011, "last_edit_date": 1553067029, "question_id": 55252031, "link": "https://stackoverflow.com/questions/55252031/vba-vlookup-find-value-using-vlookup", "title": "VBA Vlookup find value using VLookup", "body": "<p>I am trying to create a macro that loops through every row in worksheet named \"source\". It need to look for a matching value in named range \"OverheadResults\".</p>\n\n<p>When I test, I get </p>\n\n<blockquote>\n  <p>error 1004 \"Method 'Range' of object '_Worksheet' failed </p>\n</blockquote>\n\n<p>when I try to use the vlookup (scroll down it's inside the 'Main' loop)</p>\n\n<pre><code>Private Const SOURCE_SHEETNAME = \"source\"\nPrivate Const COLUMN_WBS = 2\nPrivate Const COLUMN_COSTELEM = 9\nPrivate Const COLUMN_COST = 12\nPrivate Const COLUMN_HOURS = 15\nPrivate Const OVERHEAD_LOOKUP_RANGE_NAME = \"OverheadResults\"\n\nSub ConvertSAPActuals()\n    Dim iLastRow As Long\n    Dim iDestRow As Long\n    Dim wb As Workbook\n    Dim wbDest As Workbook\n    Dim shtSource As Worksheet\n    Dim shtDest As Worksheet\n    Dim sCostElem As String\n    Dim result As Variant\n\n\n    '--make sure source sheet exists\n    If Not SheetExists(SOURCE_SHEETNAME) Then\n        MsgBox \"Missing source sheet\", vbCritical\n        Exit Sub\n    End If\n\n    Set wb = ThisWorkbook\n    Set shtSource = wb.Sheets(SOURCE_SHEETNAME)\n\n    '--create destination workbook and sheet\n    Set wbDest = Workbooks.Add\n    Set shtDest = wbDest.Sheets(1)\n\n   '--Find the last row (in column A) with data.\n    iLastRow = shtSource.Range(\"A:A\").Find(\"*\", searchdirection:=xlPrevious).Row\n\n    '--Main Loop\n    iDestRow = 1\n    For iSourceSheetRow = 2 To iLastRow\n        sCostElem = shtSource.Cells(iSourceSheetRow, COLUMN_COSTELEM)\n        result = Application.WorksheetFunction.VLookup(sCostElem, shtSource.Range(OVERHEAD_LOOKUP_RANGE_NAME), 2, False)\n\n        '--Check return value of Vlookup\n        If IsError(result) Then\n        Else\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553051577, "post_id": 55251940, "comment_id": 97238306, "body": "You need to exclude the &quot;consolidated&quot; sheet from the loop where you collect the source ranges."}, {"owner": {"reputation": 1, "user_id": 11194425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ca410712bcc200484c93d963018561?s=128&d=identicon&r=PG&f=1", "display_name": "syed", "link": "https://stackoverflow.com/users/11194425/syed"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553051991, "post_id": 55251940, "comment_id": 97238402, "body": "@TimWilliams can you help with what i need to write in the code to exclude the &quot;consolidated&quot; sheet from the loop where I collect the source ranges"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11194425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ca410712bcc200484c93d963018561?s=128&d=identicon&r=PG&f=1", "display_name": "syed", "link": "https://stackoverflow.com/users/11194425/syed"}, "edited": false, "score": 0, "creation_date": 1553050346, "post_id": 55252139, "comment_id": 97238060, "body": "i have edited the macros as you can see but then it is showing me the error as mentioned please if you could help me how to fix it. what i am wanting to do is to have master sheet within the same workbook called &quot;consolidated&quot; has all 3 tables  in it."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1553044178, "last_edit_date": 1553044178, "creation_date": 1553043821, "answer_id": 55252139, "question_id": 55251940, "link": "https://stackoverflow.com/questions/55251940/tables-in-same-worksheet/55252139#55252139", "title": "Tables in Same worksheet", "body": "<p>if what i understood is correct then replace <code>Set ws2 = wb.Sheets.Add()</code> with the code below in each of the macros</p>\n\n<pre><code>For Each ws2 In wb.Sheets\nIf ws2.Name = \"consolidated\" Then Exit For\nNext\n\n    If ws2 Is Nothing Then\n    Set ws2 = wb.Sheets.Add()\n    ws2.Name = \"consolidated\"\n    End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11194425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ca410712bcc200484c93d963018561?s=128&d=identicon&r=PG&f=1", "display_name": "syed", "link": "https://stackoverflow.com/users/11194425/syed"}, "edited": false, "score": 0, "creation_date": 1553058796, "post_id": 55253586, "comment_id": 97239944, "body": "Thank you very much it works perfect :) thanks heaps"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1553055950, "creation_date": 1553055950, "answer_id": 55253586, "question_id": 55251940, "link": "https://stackoverflow.com/questions/55251940/tables-in-same-worksheet/55253586#55253586", "title": "Tables in Same worksheet", "body": "<p>You can do something like this:</p>\n\n<pre><code>Sub Tester()\n\n    Const SHT_CONS As String = \"consolidated\"\n    Dim wb As Workbook, ws As Worksheet\n    Dim wsCons As Worksheet\n    Dim colSheets As New Collection\n\n    Set wb = ActiveWorkbook\n\n    'add the consolidation sheet if missing\n    On Error Resume Next\n    Set wsCons = wb.Worksheets(SHT_CONS)\n    On Error GoTo 0\n    If wsCons Is Nothing Then\n        Set wsCons = wb.Worksheets.Add(after:=wb.Sheets(wb.Sheets.Count))\n        wsCons.Name = SHT_CONS\n    End If\n\n    'collect the sheet names\n    For Each ws In wb.Worksheets\n        If ws.Name &lt;&gt; SHT_CONS Then colSheets.Add ws.Name\n    Next ws\n\n    'call a sub to create each consolidation\n    DoConsolidate colSheets, \"R1C1:R17C2\", wsCons.Range(\"A1\")\n    DoConsolidate colSheets, \"R24C1:R35C2\", wsCons.Range(\"A24\")\n    DoConsolidate colSheets, \"R39C1:R50C2\", wsCons.Range(\"A39\")\n\nEnd Sub\n\nSub DoConsolidate(sheetNames As Collection, rngR1C1 As String, rngDest As Range)\n    Dim arr(), i, s\n    ReDim arr(0 To sheetNames.Count - 1)\n    i = 0\n    For Each s In sheetNames\n        arr(i) = \"'\" &amp; s &amp; \"'!\" &amp; rngR1C1\n        i = i + 1\n    Next s\n    rngDest.Consolidate arr, xlSum, True, True, False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11194425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ca410712bcc200484c93d963018561?s=128&d=identicon&r=PG&f=1", "display_name": "syed", "link": "https://stackoverflow.com/users/11194425/syed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1553087291, "answer_count": 2, "score": -1, "last_activity_date": 1553065971, "creation_date": 1553042128, "last_edit_date": 1553065971, "question_id": 55251940, "link": "https://stackoverflow.com/questions/55251940/tables-in-same-worksheet", "closed_reason": "Not suitable for this site", "title": "Tables in Same worksheet", "body": "<pre><code>    Option Explicit\n\n    Sub Macro70()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim ws2 As Worksheet\n    Dim sheets_Count As Integer\n    Dim sheets_Name() As String\n    Dim i As Integer\n    sheets_Count = Sheets.Count\n\n    ReDim sheets_Name(0 To sheets_Count - 1)\n\n    For i = 1 To sheets_Count\n       sheets_Name(i - 1) = \"'\" &amp; ActiveWorkbook.Sheets(i).Name &amp; \"'!R1C1:R17C2\"\n    Next i\n\n    Set wb = ThisWorkbook\n    For Each ws2 In wb.Sheets\nIf ws2.Name = \"consolidated\" Then Exit For\nNext\n\n    If ws2 Is Nothing Then\n    Set ws2 = wb.Sheets.Add()\n    ws2.Name = \"consolidated\"\n    End If\n\n    With ws2\n        .Range(\"A1\").Consolidate sheets_Name, xlSum, True, True, False\n    End With\n\n    End Sub\n\n\n    Sub Macro71()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim ws2 As Worksheet\n    Dim sheets_Count As Integer\n    Dim sheets_Name() As String\n    Dim i As Integer\n    sheets_Count = Sheets.Count\n\n    ReDim sheets_Name(0 To sheets_Count - 1)\n\n    For i = 1 To sheets_Count\n       sheets_Name(i - 1) = \"'\" &amp; ActiveWorkbook.Sheets(i).Name &amp; \"'!R24C1:R35C2\"\n    Next i\n\n    Set wb = ThisWorkbook\n    For Each ws2 In wb.Sheets\nIf ws2.Name = \"consolidated\" Then Exit For\nNext\n\n    If ws2 Is Nothing Then\n    Set ws2 = wb.Sheets.Add()\n    ws2.Name = \"consolidated\"\n    End If\nWith ws2\n        .Range(\"A24\").Consolidate sheets_Name, xlSum, True, True, False\n    End With\n\n    End Sub\n\n\n    Sub Macro72()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim ws2 As Worksheet\n    Dim sheets_Count As Integer\n    Dim sheets_Name() As String\n    Dim i As Integer\n    sheets_Count = Sheets.Count\n\n    ReDim sheets_Name(0 To sheets_Count - 1)\n\n    For i = 1 To sheets_Count\n       sheets_Name(i - 1) = \"'\" &amp; ActiveWorkbook.Sheets(i).Name &amp; \"'!R39C1:R50C2\"\n    Next i\n\n    Set wb = ThisWorkbook\n   For Each ws2 In wb.Sheets\nIf ws2.Name = \"consolidated\" Then Exit For\nNext\n\n    If ws2 Is Nothing Then\n    Set ws2 = wb.Sheets.Add()\n    ws2.Name = \"consolidated\"\n    End If\nWith ws2\n        .Range(\"A39\").Consolidate sheets_Name, xlSum, True, True, False\n    End With\n\n    End Sub     \n</code></pre>\n\n<p>I have replaced it now when i run macro 71 &amp; 72 has Run-Time Error '1004' Source Reference overlaps Destination Area, i am not sure where i am doing something wrong. Please assist.</p>\n"}, {"tags": ["sql", "ms-access", "module", "vba", "format"], "owner": {"reputation": 11, "user_id": 11228743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f192b64b32da204b4d18337a6c5919f?s=128&d=identicon&r=PG&f=1", "display_name": "CourtR", "link": "https://stackoverflow.com/users/11228743/courtr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553300074, "creation_date": 1553038584, "last_edit_date": 1553300074, "question_id": 55251495, "link": "https://stackoverflow.com/questions/55251495/improve-access-module-and-eliminate-query", "title": "Improve Access Module and Eliminate Query", "body": "<p>I am creating a procedure for identifying the detailed lines from <code>tbl_a</code> that are creating an abnormal balance at the <code>tbl_a.LevelA</code> level and inserting identified lines into <code>tbl_d</code>. </p>\n\n<p>Once a month, I import the closing account balances into <code>tbl_a.LevelA</code>, <code>tbl_a.LevelB</code>, <code>tbl_a.AMOUNT</code>.  </p>\n\n<p>From there, I have code set up to determine whether the current balance is a debit or credit, update the normal balance from a reference table (<code>tbl_b</code>), and identify whether the detail line balance is abnormal.  </p>\n\n<p>I also have had to create a separate select query to identify whether the balance is abnormal at the <code>LevelA</code> level.  I use this information to identify all line items that are abnormal at <code>LevelA</code> and <code>LevelB</code>.</p>\n\n<p>My import, code, query, and desired output is given below:</p>\n\n<p><strong>Import</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/e7dhZ.png\" alt=\"Import\"></p>\n\n<p><strong>Code</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Edit()\n\nDim MsgTitleImport As String\n\nMsgTitleImport = \"xxx\"\n\nSet MyDb = CurrentDb()\n\nDoCmd.Hourglass False\nDoCmd.SetWarnings False\n\n'qry_a\nMySQL = \"UPDATE tbl_a \" &amp; _\n        \"INNER JOIN tbl_b ON tbl_a.LEVELA = tbl_b.LEVELA \" &amp; _\n        \"SET tbl_a.NORMAL = tbl_b.NORMAL \" &amp; _\n        \"WHERE tbl_a.LEVELA Is Not Null;\"\nMyDb.Execute MySQL\n\n'qry_b\nMySQL = \"UPDATE tbl_a \" &amp; _\n        \"SET tbl_a.CURRENT = iif([tbl_a.AMOUNT]&gt;=0,'POSITIVE','NEGATIVE') \" &amp; _\n        \"WHERE tbl_a.LEVELA Is Not Null;\"\nMyDb.Execute MySQL\n\n'qry_c\nMySQL = \"UPDATE tbl_a \" &amp; _\n        \"SET tbl_a.ABNORMAL_B = iif([tbl_a.CURRENT]=[tbl_a.NORMAL],'N','Y') \" &amp; _\n        \"WHERE tbl_a.LEVELA Is Not Null;\"\nMyDb.Execute MySQL\n\n'qry_d\nMySQL = \"INSERT INTO tbl_c (LEVELA, AMOUNT) \" &amp; _\n        \"SELECT qry_d.LEVELA, qry_d.AMOUNT \" &amp; _\n        \"FROM qry_d;\"\nMyDb.Execute MySQL\n\n'qry_e\nMySQL = \"UPDATE tbl_c \" &amp; _\n        \"INNER JOIN tbl_b ON tbl_c.LEVELA = tbl_b.LEVELA \" &amp; _\n        \"SET tbl_c.NORMAL = tbl_b.NORMAL \" &amp; _\n        \"WHERE tbl_c.LEVELA Is Not Null;\"\nMyDb.Execute MySQL\n\n'qry_f\nMySQL = \"UPDATE tbl_c \" &amp; _\n        \"SET tbl_c.CURRENT = iif([tbl_c.AMOUNT]&gt;=0,'POSITIVE','NEGATIVE') \" &amp; _\n        \"WHERE tbl_c.LEVELA Is Not Null;\"\nMyDb.Execute MySQL\n\n'qry_g\nMySQL = \"UPDATE tbl_c \" &amp; _\n        \"SET tbl_c.ABNORMAL_A = iif([tbl_c.CURRENT]=[tbl_c.NORMAL],'N','Y') \" &amp; _\n        \"WHERE tbl_c.LEVELA Is Not Null;\"\nMyDb.Execute MySQL\n\n'qry_h\nMySQL = \"UPDATE tbl_a \" &amp; _\n        \"INNER JOIN tbl_c ON tbl_a.LEVELA = tbl_c.LEVELA \" &amp; _\n        \"SET tbl_a.ABNORMAL_A = tbl_c.ABNORMAL_A \" &amp; _\n        \"WHERE tbl_a.LEVELA Is Not Null;\"\nMyDb.Execute MySQL\n\n'qry_i\nMySQL = \"INSERT INTO tbl_d (LEVELA, LEVELB, AMOUNT, CURRENT, NORMAL, ABNORMAL_A, ABNORMAL_B) \" &amp; _\n        \"SELECT tbl_a.LEVELA, tbl_a.LEVELB, tbl_a.AMOUNT, tbl_a.CURRENT, tbl_a.NORMAL, tbl_a.ABNORMAL_A, tbl_a.ABNORMAL_B \" &amp; _\n        \"FROM tbl_a \" &amp; _\n        \"WHERE tbl_a.ABNORMAL_A = 'Y' AND tbl_a.ABNORMAL_B = 'Y';\"\nMyDb.Execute MySQL\n\nDoCmd.Hourglass False\n\nMsgBox \"xxx\", vbOKOnly, MsgTitleImport\n\nDoCmd.SetWarnings True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Query</strong></p>\n\n<pre><code>SELECT tbl_b.LEVELA, Sum(tbl_a.AMOUNT) AS AMOUNT\nFROM tbl_a INNER JOIN tbl_b ON tbl_a.LEVELA = tbl_b.LEVELA\nWHERE (((tbl_b.LEVELA) Is Not Null))\nGROUP BY tbl_b.LEVELA;\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/fTvb1.png\" alt=\"Output\"></p>\n\n<p>I had a couple questions:</p>\n\n<ol>\n<li><p>Is there any way to add the separate query (<code>qry_d</code>) to the module code?</p></li>\n<li><p>Is there a better format to use for this code?  This is the first database that I have built, so I am not sure how this should look if done \"properly\".</p></li>\n</ol>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["html", "excel", "vba", "reactjs", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1553040664, "post_id": 55251395, "comment_id": 97236047, "body": "Is selenium vba an option?"}, {"owner": {"reputation": 23, "user_id": 6147187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7780427bcd894fbdcee565d31c4e83?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Sebastian", "link": "https://stackoverflow.com/users/6147187/matt-sebastian"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553099881, "post_id": 55251395, "comment_id": 97263163, "body": "Sure! Any idea how to do it with selenium vba?"}, {"owner": {"reputation": 23, "user_id": 6147187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7780427bcd894fbdcee565d31c4e83?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Sebastian", "link": "https://stackoverflow.com/users/6147187/matt-sebastian"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553183213, "post_id": 55251395, "comment_id": 97298389, "body": "Thank you so much!  Let me give it a shot."}, {"owner": {"reputation": 23, "user_id": 6147187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7780427bcd894fbdcee565d31c4e83?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Sebastian", "link": "https://stackoverflow.com/users/6147187/matt-sebastian"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553727066, "post_id": 55251395, "comment_id": 97497118, "body": "I tried following the steps below, but I&#39;m very new to selenium VBA and don&#39;t have much experience with java script unfortunately.  How can I identify the javascript that has the range of possible values?  I used this website as an example, but I&#39;ll have to apply what I learn to a different secure website.  Also, if you get a chance, could you please translate the python script to VBA?  Thank you so much for your help!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553728730, "post_id": 55251395, "comment_id": 97497646, "body": "We may have to spend some time in a stackoverflow chat room discussing this as I will have to walk you through the steps I would take and you will need to lead me somewhat blindly as I won\u2019t be able to test with the actual site."}, {"owner": {"reputation": 23, "user_id": 6147187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7780427bcd894fbdcee565d31c4e83?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Sebastian", "link": "https://stackoverflow.com/users/6147187/matt-sebastian"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553730464, "post_id": 55251395, "comment_id": 97498096, "body": "I was able to test your code below with Chrome and it works great!  How would I do this with IE?  Is there an IE driver that I would need to place inside the selenium folder?"}, {"owner": {"reputation": 23, "user_id": 6147187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7780427bcd894fbdcee565d31c4e83?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Sebastian", "link": "https://stackoverflow.com/users/6147187/matt-sebastian"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553816186, "post_id": 55251395, "comment_id": 97537197, "body": "I tried accepting the answer, but it won&#39;t allow me to change it publicly with less than 15 reputation points.  I will certainly accept this as an answer as soon as I gain reputation.  Thanks again!"}, {"owner": {"reputation": 23, "user_id": 6147187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7780427bcd894fbdcee565d31c4e83?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Sebastian", "link": "https://stackoverflow.com/users/6147187/matt-sebastian"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1554763917, "post_id": 55251395, "comment_id": 97863751, "body": "QHarr, how did you know that the css element was &quot;.Select-menu div&quot;?  I tried searching the html but didn&#39;t find that element."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553586466, "post_id": 55282146, "comment_id": 97428019, "body": "Let me know if you need help with this"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1553181400, "last_edit_date": 1553181400, "creation_date": 1553176793, "answer_id": 55282146, "question_id": 55251395, "link": "https://stackoverflow.com/questions/55251395/selecting-html-dropdown-with-reactjs-in-vba/55282146#55282146", "title": "Selecting HTML dropdown with ReactJS in VBA", "body": "<p>It was actually a lot easier than I thought. The following uses selenium basic. Install <a href=\"https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\" rel=\"nofollow noreferrer\">selenium basic</a>, ensure latest chromedriver.exe is in selenium folder, vbe > tools > references > add reference to selenium type library</p>\n\n<p>I show grabbing all the option values into a dictionary. Also, selecting an item from the dropdown. </p>\n\n<p>The key here is that the option menu is not a traditional <code>select</code> element, with child <code>option</code>s,  but uses <a href=\"https://jedwatson.github.io/react-select/\" rel=\"nofollow noreferrer\">React Select</a>. The range of possible values are pulled via Ajax from <a href=\"https://jedwatson.github.io/react-select/app.js\" rel=\"nofollow noreferrer\">this script</a>. </p>\n\n<p>I show how you could also retrieve the possible values from that script direct, at the end, using python, but am happy to translate to vba if you really are interested. Once the dropdown is clicked the list of available values can be collected.</p>\n\n<p>If you want to go down the IE route you can use the same approach but need to trigger the events that will open the dropdown. These are also detailed in the js \nscript I think.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nPublic Sub MakeSelection()\n    Dim d As WebDriver, i As Long, dropDownOptions As Object\n    Const URL = \"https://jedwatson.github.io/react-select/\"\n\n    Set d = New ChromeDriver\n    Set dropDownOptions = CreateObject(\"Scripting.Dictionary\")\n\n    With d\n        .Start \"Chrome\"\n        .get URL\n        .FindElementByCss(\"button:nth-of-type(2)\").Click\n        .FindElementByCss(\".Select-arrow-zone\").ClickAndHold\n\n        Dim item As Object\n        For Each item In .FindElementsByCss(\".Select-menu div\") 'put list of options in dictionary\n            dropDownOptions(item.Text) = i\n            i = i + 1\n        Next\n\n        For Each item In .FindElementsByCss(\".Select-menu div\") 'loop to select an option\n            If item.Text = \"Victoria\" Then       'If item.Text = dropDownOptions.item(3)  etc....\n                item.Click\n                Exit For\n            End If\n        Next\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Python script to parse possible dropdown values from json:</p>\n\n<p>This shows the 3 different element parts which are updated through the dropdown (labels, classes and values)</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import requests\nimport re\nimport json\n\nr = requests.get('https://jedwatson.github.io/react-select/app.js')\ns = str(r.content)\np1 = re.compile('t\\.AU=(.*)')\np2 = re.compile('.+?(?=,\\[\\d+\\])')\ndata1 = re.findall(p1, s)[0]\ndata2 = re.findall(p2, data1)[0].replace(',disabled:!0','')\n\nreplacements = ['value:','label:','className:']\n\nfor item in replacements:\n    data2 = re.sub(item, '\"' + item[:-1] + '\":' , data2)\n\nfinals = data2.split(',t.US=')\nfinalAus = json.loads(finals[0])\n# finalUs = json.loads(finals[1])\n\nd = {}\ni = 0\nfor item in finalAus:\n    d[item['label']] = i\n    # item['label']\n    # item['value']\n    # item['className']\n    i+=1\n\nprint(d)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6147187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7780427bcd894fbdcee565d31c4e83?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Sebastian", "link": "https://stackoverflow.com/users/6147187/matt-sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 55282146, "answer_count": 1, "score": 2, "last_activity_date": 1553181400, "creation_date": 1553037877, "last_edit_date": 1553072423, "question_id": 55251395, "link": "https://stackoverflow.com/questions/55251395/selecting-html-dropdown-with-reactjs-in-vba", "title": "Selecting HTML dropdown with ReactJS in VBA", "body": "<p>I'm trying to use VBA to select a dropdown item from an HTML website that uses ReactJS.  For this example, we can use the following website:</p>\n\n<p><a href=\"https://jedwatson.github.io/react-select/\" rel=\"nofollow noreferrer\">https://jedwatson.github.io/react-select/</a>  </p>\n\n<pre><code>&lt;span class=\"Select-value-label\" role=\"option\" aria-selected=\"true\" id=\"react-select-2--value-item\"&gt;New South Wales&lt;/span&gt;\n</code></pre>\n\n<p>If an HTML page lists all the select options on the dropdown, I can easily set the <code>elementID</code> to one of the dropdown values.  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set ie = CreateObject(\"InternetExplorer.Application\") \nWith ie\n    .Visible = True\n    .Navigate \"about:blank\"\n    'with for page load\n    ieWaitForURL\n\n    .Navigate \"https://jedwatson.github.io/react-select/\"\n\n    ie.Document.getelementbyid(\"react-select-2--value-item\").Value = \"Victoria\"\n</code></pre>\n\n<p>But the HTML of the ReactJS website doesn't list all the options of the dropdown, and the value of the innertext changes as I make a different selection. </p>\n\n<p>Is there a way to select from a ReactJS dropdown using VBA if all the options aren't listed in the HTML?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 2, "creation_date": 1553035640, "post_id": 55251005, "comment_id": 97234691, "body": "I think you need to look at what value is actually stored in the cells that aren&#39;t going green. I&#39;m particularly looking at the value being something like <code>0.2999</code>, but it displays as <code>0.3</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "edited": false, "score": 0, "creation_date": 1553036683, "post_id": 55251005, "comment_id": 97234950, "body": "Is there conditional formatting that is overriding the rogue cells?"}, {"owner": {"reputation": 56, "user_id": 11068028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34320943c84e2ea922fe64767b8d611a?s=128&d=identicon&r=PG&f=1", "display_name": "TinMan464", "link": "https://stackoverflow.com/users/11068028/tinman464"}, "edited": false, "score": 0, "creation_date": 1553038706, "post_id": 55251005, "comment_id": 97235579, "body": "What is the value that is shown in the &#39;Formula Bar&#39; for the cells that are misbehaving?"}], "answers": [{"comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1553035755, "post_id": 55251065, "comment_id": 97234723, "body": "I would have thought that the OP&#39;s code would have worked if the cell contains a numeric value. Did you test the OP&#39;s code before offering an alternative?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1553035953, "post_id": 55251065, "comment_id": 97234763, "body": "If the op had <code>&quot;0.3&quot;</code> in a cell, that is always alphabetically larger than <code>0.3</code> as a number. You&#39;re thinking that the cell value changes from text to a number depending on what it is compared to; that&#39;s not the case. Either the cell value is text or a number anf if it is text the latter pat of the op&#39;s two-fold comparison will always be true."}, {"owner": {"reputation": 11, "user_id": 11024679, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OZgnFcdXS94/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNK6hQ2qksb8CgmygLmkoHTfUZ_9g/mo/photo.jpg?sz=128", "display_name": "Jake Kurdys", "link": "https://stackoverflow.com/users/11024679/jake-kurdys"}, "edited": false, "score": 0, "creation_date": 1553036194, "post_id": 55251065, "comment_id": 97234838, "body": "This is just the most recent version of the code as I was out of ideas. I&#39;ve tried numerically and as a string individually, neither worked. The cell values that are not being colored are small numbers with many decimals (ex. 0.6512442834805)."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1553036225, "post_id": 55251065, "comment_id": 97234848, "body": "&quot;You&#39;re thinking that the cell value changes from text to a number&quot; - No, I&#39;m not. I&#39;m thinking that the OP has numbers throughout all of their cells but they have panicked and added the string comparison to try and debug"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "edited": false, "score": 0, "creation_date": 1553036387, "post_id": 55251065, "comment_id": 97234884, "body": "Well, I guess that is why a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is recommended as part of the original question. It tends to avoid Whack-a-Mole games in the response area as well as extended comment exchanges.."}, {"owner": {"reputation": 11, "user_id": 11024679, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OZgnFcdXS94/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNK6hQ2qksb8CgmygLmkoHTfUZ_9g/mo/photo.jpg?sz=128", "display_name": "Jake Kurdys", "link": "https://stackoverflow.com/users/11024679/jake-kurdys"}, "edited": false, "score": 0, "creation_date": 1553036616, "post_id": 55251065, "comment_id": 97234937, "body": "And exactly correct Enigmativity, started as just numerical and it didnt work, adding the string comparizon was just a way to see if it would work.... it didn&#39;t."}, {"owner": {"reputation": 11, "user_id": 11024679, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OZgnFcdXS94/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNK6hQ2qksb8CgmygLmkoHTfUZ_9g/mo/photo.jpg?sz=128", "display_name": "Jake Kurdys", "link": "https://stackoverflow.com/users/11024679/jake-kurdys"}, "edited": false, "score": 0, "creation_date": 1553036923, "post_id": 55251065, "comment_id": 97235007, "body": "I used the example code given just to be sure. The cell value 0.621583957861 is still not being colored as green, even though it is greater than 0.3"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "is_accepted": false, "score": 1, "last_activity_date": 1553035775, "last_edit_date": 1553035775, "creation_date": 1553035611, "answer_id": 55251065, "question_id": 55251005, "link": "https://stackoverflow.com/questions/55251005/if-cell-value-greater-than-function-not-working-to-color-cells/55251065#55251065", "title": "If Cell.Value &gt; (Greater Than) function not working to color cells", "body": "<p>You cannot combine string and numerical comparisons like that for <em>greater than/less than</em> comparisons. A string might not be greater than <code>\"0.3\"</code> as a string but it will always be sorted higher than <code>0.3</code> as a number.` A combination string and numerical comparison might work on a strictly <em>equals to</em> basis.</p>\n\n<p>Take the numerical value of either a string or a mixed number and use that for coparison.</p>\n\n<pre><code>Dim iRowCq As Range Set iRowCq = Range(\"B2:DJ26\")\n\nFor Each Cell In iRowCq\n\n    If val(Cell.Value) &gt; 0.3 Then\n         Cell.Interior.Color = RGB(0, 255, 0)\n    End If\n\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1553065925, "last_edit_date": 1553065925, "creation_date": 1553065623, "answer_id": 55255216, "question_id": 55251005, "link": "https://stackoverflow.com/questions/55251005/if-cell-value-greater-than-function-not-working-to-color-cells/55255216#55255216", "title": "If Cell.Value &gt; (Greater Than) function not working to color cells", "body": "<p>You could try the below:</p>\n\n<pre><code>Option Explicit\n\nSub test1()\n\n    Dim rng As Range, cell As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\") '&lt;- It s better practise to specify the worksheet\n\n        Set rng = .Range(\"B2:DJ26\") '&lt;- This range does not cover your whole spreadsheet. As i can see from the image the last column IS NOT \"D\" BUT \"S\" and the last row IS NOT 26 BUT 25. Setting range to *.Range(\"B2:SJ25\")* we cover your range.\n\n        For Each cell In rng\n\n            If CDec(cell.Value) &gt; 0.3 Then '&lt;- Convert the cell value into decimal in order to compare with decimal\n                cell.Interior.Color = RGB(0, 255, 0)\n            End If\n\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 1, "last_activity_date": 1553073628, "creation_date": 1553073628, "answer_id": 55257292, "question_id": 55251005, "link": "https://stackoverflow.com/questions/55251005/if-cell-value-greater-than-function-not-working-to-color-cells/55257292#55257292", "title": "If Cell.Value &gt; (Greater Than) function not working to color cells", "body": "<p>Why are you re-inventing conditional formatting? It can be done in a very simple way, without needing VBA:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QHC6q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QHC6q.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 11024679, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OZgnFcdXS94/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNK6hQ2qksb8CgmygLmkoHTfUZ_9g/mo/photo.jpg?sz=128", "display_name": "Jake Kurdys", "link": "https://stackoverflow.com/users/11024679/jake-kurdys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1553073628, "creation_date": 1553035134, "last_edit_date": 1553037203, "question_id": 55251005, "link": "https://stackoverflow.com/questions/55251005/if-cell-value-greater-than-function-not-working-to-color-cells", "title": "If Cell.Value &gt; (Greater Than) function not working to color cells", "body": "<p>The code that Im currently using. </p>\n\n<pre><code>Dim iRowCq As Range\nSet iRowCq = Range(\"B2:DJ26\")\n\nFor Each Cell In iRowCq\n\n    If Cell.Value &gt; \"0.3\" or cell.value &gt; 0.3 Then\n        Cell.Interior.Color = RGB(0, 255, 0)\n    End If\n\nNext\n</code></pre>\n\n<p>I want to color cells that are greater than 0.3 green. Yet while 99% of the cells work, there are sometimes cells that are greater than 0.3 and are not colored. Ive even tried rounding the data to two decimal points before which did not work. Could someone please help?</p>\n\n<p><a href=\"https://i.stack.imgur.com/yTTel.png\" rel=\"nofollow noreferrer\">Screen shot of excel sheet</a></p>\n"}, {"tags": ["excel", "vba", "web", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1553066673, "post_id": 55250883, "comment_id": 97242649, "body": "Comments are not for extended discussion or debugging sessions; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/190344/discussion-on-answer-by-qharr-copy-with-vba-to-excel-the-balance-of-my-current-a\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1553038379, "last_edit_date": 1553038379, "creation_date": 1553034431, "answer_id": 55250883, "question_id": 55250830, "link": "https://stackoverflow.com/questions/55250830/copy-with-vba-to-excel-the-balance-of-my-current-account-from-a-web-page/55250883#55250883", "title": "Copy with vba to Excel the balance of my current account from a web page", "body": "<p>Based on full html</p>\n\n<pre><code>ie.document.getElementsByClassName(\"septd\")(5).getElementsByTagName(\"span\")(1).innerText\n</code></pre>\n\n<p>Also,</p>\n\n<pre><code>ie.document.getElementsByTagName(\"td\")(39).innerText\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11170687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86afc37fd6df530c460ed27acf6d2b98?s=128&d=identicon&r=PG&f=1", "display_name": "germangp", "link": "https://stackoverflow.com/users/11170687/germangp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 55250883, "answer_count": 1, "score": 0, "last_activity_date": 1553038379, "creation_date": 1553034081, "last_edit_date": 1553034428, "question_id": 55250830, "link": "https://stackoverflow.com/questions/55250830/copy-with-vba-to-excel-the-balance-of-my-current-account-from-a-web-page", "title": "Copy with vba to Excel the balance of my current account from a web page", "body": "<p>With the help of the forum I created a macro vba to connect to the web of my bank, put the username and password and make the login correctly.\nOnce I have logged in with the macro of vba, I go to another page where the balance of my bank account is and those are the data that I want to copy to Excel. The data I want is where it says 999.99 in the html code that I put below.</p>\n\n<p>What do I have to add to the vba code to do it?</p>\n\n<p>Here is the code of the macro.</p>\n\n<pre><code>'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub SaldoActivo()\n    Dim ie As InternetExplorer\n    Set ie = New InternetExplorer\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.activobank.com/cs/Satellite/BC/\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.querySelector(\"[name=userDNI]\").Value = \"123456789\"\n        .document.querySelector(\"[name=pinNif]\").Value = \"123456789\"\n        .document.querySelector(\"#button1\").Click\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n       \u2018 Navigate second page with \n        .Navigate2 \"https://www.activobank.com/activobank/CUGlobalPositionNew.init.bs\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n    End With\n\n\u2018Here I need the code to copy the account balance data\n\nie.Quit\nSet ie = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Here is the code to copy the account balance data</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!-- /1. Ahorro Inversi\u00f3n --&gt;         \r\n&lt;!-- ELEMENTOS DEL BLOQUE --&gt;\r\n&lt;table border=\"0\" width=\"494\" cellpadding=\"0\" cellspacing=\"1\" bgcolor=\"white\" style=\"margin-bottom:10px\"&gt;\r\n&lt;tr  class=apartado &gt;\r\n&lt;td width=\"20\" class=\"a12\" height=\"10\" align=\"right\"&gt;\r\n&lt;a href='javascript:plegarDesplegar(\"1\",\"CC\");' &gt;\r\n&lt;img id=\"_CC\" src=\"/neti/images/AB/expandir.gif\" border=\"0\"&gt;\r\n&lt;/a&gt;\r\n&lt;/td&gt;\r\n&lt;td class=\"a12\" width=\"354\" height=\"15\" valign=\"center\" align=\"left\"&gt;&lt;b&gt;&amp;nbsp;Cuentas a la vista\r\n&lt;/b&gt;\r\n&lt;/td&gt;\r\n&lt;td width=\"120\" height=\"15\" valign=\"center\" align=\"right\"&gt;\r\n&lt;!-- MILLORA --&gt;\r\n&lt;span class=\"a12b\"&gt;999,99\r\n&amp;euro;\r\n&lt;/span&gt;\r\n&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/table&gt;\r\n\r\n&lt;div id=\"_CC0\" style=\"display:none\"&gt;\r\n&lt;table border=\"0\" width=\"494\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"white\"&gt;\r\n&lt;!-- JV-18725 A\u00f1adimos CI --&gt;\r\n&lt;tr class=\"fila1\"&gt;\r\n&lt;!--  Boton edicion cuenta --&gt;\r\n&lt;td class=\"a11\" width=\"195\" height=\"15\" align=\"left\" valign=\"top\" nowrap&gt;\r\n&lt;table class=\"septd2\"&gt;\r\n&lt;tr&gt;\r\n&lt;td style=\"padding-left:20px\" valign=\"center\" align=\"left\" width=\"10\"&gt;\r\n&lt;a href='javascript:mostrarEdicion(\"_CC0\");' &gt;\r\n&lt;img id=\"_BtEdicion__CC0\" name=\"_BtEdicion\" src=\"/neti/images/AB/Lapiz-11x11.png\" border=0&gt;\r\n&lt;/a&gt;\r\n&lt;/td&gt;\r\n&lt;td align=\"left\" class=\"a11\"&gt;\r\n&lt;div id=\"_CC0_CC\"&gt;\r\nCUENTA ACTIVA\r\n&lt;/div&gt;\r\n&lt;div id=\"_CC0_M\" style=\"display:none;\"&gt;\r\n&lt;span class=\"returnicon\"&gt;\r\n&lt;script&gt;\r\nfunction validate_CC0(){\r\nvar valueInput = document.getElementById(\"_CC0_IN\").value;\r\nvalueInput = valueInput.replace(/[^A-Za-z0-9\\u002e\\s\\u002c\\u003a\\u003b\\u003f\\u0021\\u002d\\u005f\\u00A1\\u00BF\\u002D\\u00E4\\u00E1\\u00E0\\u00E7\\u00EB\\u00E9\\u00E8\\u00ED\\u00EC\\u00EF\\u00F1\\u00F6\\u00F3\\u00F2\\u00FA\\u00F9\\u00FC\\u00C4\\u00C1\\u00C0\\u00C7\\u00CB\\u00C9\\u00C8\\u00CD\\u00CC\\u00CF\\u00D1\\u00D3\\u00D2\\u00D6\\u00DA\\u00D9\\u00DC\\u00A1\\u00BF]/g,\"\");\r\ndocument.getElementById(\"_CC0_IN\").value = valueInput;\r\ndocument.getElementById(\"_CC0_CC\").innerHTML = valueInput;\r\n}\r\n&lt;/script&gt;\r\n&lt;input id=\"_CC0_IN\" type=\"text\" maxlength=\"25\" onblur='validate_CC0();timeNameAccountAuto(\"/activobank/\",\"_CC0_IN\",\"xxxxx\",\"CUENTA ACTIVA\",\"2\",\"La descripci\u00f3n debe contener como m\u00ednimo 3 caracteres\",\"La descripci\u00f3n debe contener como m\u00e1ximo 25 caracteres\");' onkeydown='return validateExit(event)' onKeyPress='validate_CC0();return validateKeyPress(event,\"xxxxxxx\",\"/activobank/\",\"La descripci\u00f3n debe contener como m\u00ednimo 3 caracteres\",\"2\",\"CUENTA ACTIVA\",\"La descripci\u00f3n debe contener como m\u00e1ximo 25 caracteres\")'/&gt;\r\n&lt;a href='javascript:getNameAccount(\"_CC0\",\"xxxxx\",\"/activobank/\",\"CUENTA ACTIVA\",\"2\");' &gt;\r\n&lt;img src=\"/neti/images/AB/Borrar-9x9.png\" border=0 &gt;\r\n&lt;/a&gt;\r\n&lt;/span&gt;\r\n&lt;/div&gt;\r\n&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;tr&gt;\r\n&lt;td style=\"padding-left:20px\" valign=\"center\" align=\"left\" width=\"10\"&gt;&amp;nbsp;&lt;/td&gt;\r\n&lt;td class=\"a11\" width=\"230\" height=\"15\" align=\"left\" valign=\"center\" colspan=\"2\"&gt;\r\n&lt;input type=\"hidden\" value=\"\" name=\"alias_cc_2</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "drag-and-drop", "simulate"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 1, "creation_date": 1553032186, "post_id": 55249878, "comment_id": 97233526, "body": "Read the website source/elements and find the id/input/tag that updates the file path and name when you drag and drop it. Dragging and dropping is nothing but a shortcut to a file select dialog, which goes into a form or an input, find that in the html code, use VBA to update the value of that ID with the file path and use VBA to &quot;submit&quot; to the next page. Unless this website is a Java applet, it should be doable, a Java applet is much more complex and sometimes just not possible to manipulate."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553035117, "post_id": 55249878, "comment_id": 97234514, "body": "I don&#39;t see anything like an &#39;input&#39; tag anywhere in the HTML. It does have a fair amount of scripting - about 500 lines out of 600 total are script.  Would that mean API programming? That is also on my list of things I need to learn, but haven&#39;t yet."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553037005, "post_id": 55249878, "comment_id": 97235037, "body": "I also notice now that they have a some clickable elements that lead to a standard file selection dialog. But I do not see the labels on the control anywhere in the page&#39;s source code. Is there some way to remotely activate those? That would serve just as well."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553037447, "post_id": 55249878, "comment_id": 97235176, "body": "<code>iedoc.getelementsbyclassname(&quot;shitem si-importXML&quot;)(0).click</code> The problem is that you will have to paste the file name and path on the selection dialog. not pretty but doable."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553093750, "post_id": 55249878, "comment_id": 97258898, "body": "Thank you, but I&#39;m afraid I still don&#39;t understand. The clickable button on the map seems to be generated by JAVA, as  it is not in the HTML anywhere. A minor popup menu appears on the map when this is clicked, then that as one option opens a file select dialog. There is nothing in the source code with the text &#39;XML&#39;, &#39;GPX&#39;, &#39;Input&#39; or anything else that I have been able to identify as belonging to this functionality."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553099322, "post_id": 55249878, "comment_id": 97262831, "body": "The HTML source will probably not have any of that, it probably brings all that from other files or Javascript, so the main source will not have it. You have to inspect the elements and you can find much more that the source doesnt show. The class name i gave you on my previous post is the one you have to click on and it will open the file dialog."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553100107, "post_id": 55249878, "comment_id": 97263288, "body": "<a href=\"https://imgur.com/a/WP20dAi\" rel=\"nofollow noreferrer\">imgur.com/a/WP20dAi</a> this is in google Chrome. but it also works in IE 11 with inspect element."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553202189, "post_id": 55249878, "comment_id": 97307772, "body": "Okay, that is some progress. I ran code that opened the page and tried this iedoc...click line, but got an error. I went back and manually clicked the button that opened the popup window and executed the line again, and the file dialog window opened!  So, many thanks - that has gotten me onto a functioning track. I still need to get the popup open in the first place, and then I need to load the file path and name, but I&#39;m miles ahead of where I was. I&#39;ll post back with my progress as I go."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553207306, "post_id": 55249878, "comment_id": 97309563, "body": "in that case it means that you have to click the &quot;Tools&quot; button first in the page. <code>iedoc.getelementsbyclassname(&quot;icon tools&quot;)(0).click</code>"}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553249589, "post_id": 55249878, "comment_id": 97322957, "body": "That works perfectly - you&#39;re a wizard. How do you know what to pick out of the web page so accurately, and what commands to execute to get it done? And what do you think is the best way to now load the path and filename? Would you use SendKeys, or is there a more elegant way to get the information into the page and click the Open button in the Select File dialog?"}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553271288, "post_id": 55249878, "comment_id": 97335962, "body": "With this approach, send keys would be the easiest way. Add a timer of 2 or 3 seconds to let the dialog open and then send keys the whole path."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553273313, "post_id": 55249878, "comment_id": 97337106, "body": "Copy and Paste may also work. Try copying the value of a cell and pasting it on the dialog. Or using Object Forms to copy to the clipboard and paste it."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553291555, "post_id": 55249878, "comment_id": 97344654, "body": "Thought I was there, with this:  ieDoc.getelementsbyclassname(&quot;icon tools&quot;)(0).Click ieDoc.getelementsbyclassname(&quot;shitem si-importXML&quot;)(0).Click  but when I execute the second statement, the code hangs, waiting for a response from that dialog box, and refuses to go further until I do something manually to dismiss that dialog."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553292767, "post_id": 55249878, "comment_id": 97345032, "body": "It seems like there should be a way to force in whatever text the dialog box brings back in normal use, but I&#39;m not having any luck locating where something like that would be."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553293200, "post_id": 55249878, "comment_id": 97345136, "body": "One of the things that occurred to me is to start a vbscript process that would execute the SendKeys command into this dialog, but that seems like an extremely ugly way to do it."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553293836, "post_id": 55249878, "comment_id": 97345297, "body": "Just tried it, and the VBScript code SendKeys command does send in the proper text and closes the dialog box, but I can&#39;t believe there isn&#39;t a better way of doing it. For one thing, there is no equivalent of DoEvents in VBScript, so I would have to activate the script before calling the importXML click command and let it run at 100% while continually scanning for this dialog box to appear. That&#39;s just gross."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553535127, "post_id": 55249878, "comment_id": 97411786, "body": "Yup, it&#39;s not pretty to deal with a Dialog Box from another App/Program in VBA. Digging more into the website code can eventually get you to the point where the dialog box is not needed, but this means you have to dig into reading the javascript to get to the function that submits the filename. You may also end up at a dead end where there is no function to process the file and it&#39;s all server handled, wasting time reading the javascript."}, {"owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1553542131, "post_id": 55249878, "comment_id": 97415002, "body": "Well, thank you for the help to this point. I don&#39;t like it, but I may have to just live with my VBScript gremlin - at least it works.  Can you point me to some resources that might help me dig through the website&#39;s code? You obviously know a good deal about it, since you were so easily able to identify the necessary points in the code to activate the dialog. I&#39;d like to at least try for a while, to see if I can make any more progress - I hate just giving up."}], "owner": {"reputation": 150, "user_id": 226594, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/035d41302ea4973ac76aef9ac30305d3?s=128&d=identicon&r=PG", "display_name": "Pete Danes", "link": "https://stackoverflow.com/users/226594/pete-danes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553044580, "creation_date": 1553029114, "last_edit_date": 1553044580, "question_id": 55249878, "link": "https://stackoverflow.com/questions/55249878/simulate-drag-drop-file-to-website-in-vba", "title": "Simulate drag &amp; drop file to website in VBA", "body": "<p>I have an Access database that uses VBA code to generate a GPX map file. That works fine. I then want the contents of the GPX file to be displayed on a website, <a href=\"https://mapy.cz\" rel=\"nofollow noreferrer\">https://mapy.cz</a>\nThe method that the site authors intend is for users to open the site, then manually drag and drop GPX files onto the site, at which point the contents are read in and displayed by the website. This also works fine.</p>\n\n<p>What I want to do is NOT require my database user to open a browser, locate the file and drag it onto the browser by hand. I want my VBA code to not only create this GPX file, but also open the user's default browser, direct it to this mapping site (all this also works okay), but then SIMULATE or FORCE the drag and drop action FROM MY VBA CODE. That is the part that on which I'm floundering. I've looked up things like using VBA's IE.Document object, and it seems to me that it should be in there somewhere, but I can't find anything that makes sense to me.</p>\n\n<p>I've done similar things in the past, with SendKeys to simulate the user typing, and AutoIT to code-control a running DOS application, including reading the programs responses from the DOS screen and forcing in commands, all from VBA. It seems to me that this should be possible, and not even all that uncommon a requirement, but I've not located anything helpful in all my searching, and I've done a lot. Maybe I'm simply phrasing my searches wrong, but at this point, I'm just flat stuck.</p>\n"}, {"tags": ["python", "excel", "vba", "win32com"], "owner": {"reputation": 71, "user_id": 11228449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ebd662025156fe6729eae97fef741f?s=128&d=identicon&r=PG&f=1", "display_name": "BoniPhila", "link": "https://stackoverflow.com/users/11228449/boniphila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553066749, "creation_date": 1553028283, "last_edit_date": 1553066749, "question_id": 55249692, "link": "https://stackoverflow.com/questions/55249692/copying-and-pasting-multiple-excel-files-with-python-and-win32com", "title": "Copying and pasting multiple Excel files with python and win32com", "body": "<p>Please excuse me as I am really new to this. I got a folder of .csv files which I am trying to format for analysis. The point is to delete some rows and then format one column using the text formula and the copying the values of that formula to either a new or same column so it can be read with another app as text. The logic continues the following pattern. First I convert the files to .xlsx in a loop using glob. Next I define the worksheets using openpyxl inside that loop:</p>\n\n<pre><code>wb2 = openpyxl.Workbook()\nws2 = wb2.active\nsheet2 = wb2.worksheets[0]\n</code></pre>\n\n<p>After this I use the following loop inside the other loop to copy and paste an excel formula into a new column:</p>\n\n<pre><code>i = \"=TEXT(D2:D20,432)\"\nfor row, celo in enumerate(list(sheet2.columns)[4]):\n    celo.value = i\n</code></pre>\n\n<p>Everything works fine until I get to the win32com part:</p>\n\n<pre><code>    exc = Dispatch(\"Excel.Application\")\n    exc.Visible = 1\n    source = exc.Workbooks.Open()\n    exc.Range(\"E1:E20\").Select()\n    exc.Selection.Copy()\n    exc.Selection.PasteSpecial(Paste=constants.xlPasteValues\n</code></pre>\n\n<p>Code works fine for one excel file that has its path defined but I have no idea how to use the <code>source = exc.Workbooks.Open()</code> to open a folder full of csv/xlsx files and paste the special values to every excel file in that folder. I tried using wb2,ws2, sheet2 in the parenthesis but nothing. I have very limited vba knowledge (started today). I am trying to do all of this in Python.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-data-macro"], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 6499897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be4d08531f54bea993f0a9d666dadfb?s=128&d=identicon&r=PG&f=1", "display_name": "PAHTDC", "link": "https://stackoverflow.com/users/6499897/pahtdc"}, "edited": false, "score": 0, "creation_date": 1553042788, "post_id": 55251857, "comment_id": 97236541, "body": "Thx for checking in Albert!  If I &#39;type out loud&#39; here.... Because I want to keep business rules in queries for maintenance reasons, if I pass in all the data for row just created, then on the vba side insert the data passed in as a row into a temp table, and then either have the queries based on that temp table or read in the querydef and change the source table to that temp table through recordsets etc... in the vba code, that should give me the output from the queries in a form that can be inserted directly to the final table.... I think that could solve this... will update in a few minutes"}, {"owner": {"reputation": 40, "user_id": 6499897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be4d08531f54bea993f0a9d666dadfb?s=128&d=identicon&r=PG&f=1", "display_name": "PAHTDC", "link": "https://stackoverflow.com/users/6499897/pahtdc"}, "edited": false, "score": 0, "creation_date": 1553045112, "post_id": 55251857, "comment_id": 97237049, "body": "After several fits and starts, I have a minimally working example using the pathway of having the queries based on a temp table, and using the &#39;new row data&#39; being passed in to populate the temp table within the vba.    For anyone else who finds this, I had to create the row in the temp table within the vba - using the &#39;createrecord&#39; functionality (applied to the temptable) within the datamacro had the same problem - the created row was not visible once inside the vba code.  Thanks again for the help, and yes will keep in mind the endless loop pitfall."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 1, "last_activity_date": 1553041336, "creation_date": 1553041336, "answer_id": 55251857, "question_id": 55249521, "link": "https://stackoverflow.com/questions/55249521/referencing-just-added-record-when-using-call-to-vba-in-afterinsert-datamaco/55251857#55251857", "title": "Referencing Just Added Record When Using Call to VBA in AfterInsert DataMaco", "body": "<p>Well, while calling VBA from the macro after insert event can\u2019t get the row just inserted, that VBA routine can read + update as many OTHER rows as you please. And if that new row or data you write out in VBA has to include the data from the row just inserted?</p>\n\n<p>Well pass the columns to the VBA routine. So it now can go add up all the other rows, and THEN include the values just passed from the data macro.</p>\n\n<p>So the data macro (after insert) can look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CSABE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CSABE.png\" alt=\"enter image description here\"></a></p>\n\n<p>And the VBA code thus can look like this:</p>\n\n<pre><code>Public Function AfterU(vid As Variant, Amount As Variant)\n\n  Debug.Print vid, Amount\n\n  Dim rst     As DAO.Recordset\n  ' open table, sum data\n  ' add Amount passed.\n\n  ' write out data to some table.\n  ' caution - don't add reocrds to this table that has the trigger\n  ' else you wind up in a endless loop\n\n\nEnd Function\n</code></pre>\n\n<p>The above of course has to be placed in a standard code module (not forms), and has to be defined as public as per above.</p>\n\n<p>So while you find that the record JUST added is not yet committed to the table (it is about to be), you can still run + call some VBA code. You just not get your hands on the record just (about to be) inserted. </p>\n\n<p>However, since you can pass the needed columns such as amount etc. to include in the final total? Then you are free to write as much VBA update and insert code as you wish. So you can pull some records, build a total, and now update some existing record, or even add a new record. Just include the new amount passed also. </p>\n\n<p>As noted, you don\u2019t want to \u201ctangle\u201d up writing to a table that has such a trigger with VBA inserts since you can easy get stuck a endless loop.</p>\n\n<p>However, for adding up, or updating, or inserting to another table, you should be fine to do what you please in the VBA code. </p>\n"}], "owner": {"reputation": 40, "user_id": 6499897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be4d08531f54bea993f0a9d666dadfb?s=128&d=identicon&r=PG&f=1", "display_name": "PAHTDC", "link": "https://stackoverflow.com/users/6499897/pahtdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55251857, "answer_count": 1, "score": -1, "last_activity_date": 1553183292, "creation_date": 1553027568, "last_edit_date": 1553183292, "question_id": 55249521, "link": "https://stackoverflow.com/questions/55249521/referencing-just-added-record-when-using-call-to-vba-in-afterinsert-datamaco", "title": "Referencing Just Added Record When Using Call to VBA in AfterInsert DataMaco", "body": "<p>Access 2016, table with a AfterInsert datamacro.</p>\n\n<p>In a comment to a previous question that I can no longer find, Albert D. Kallal (user:10527) noted that if one uses the Set LocalVar approach to call a user-defined function in vba, that vba \"session\" does not see the newly inserted record.  </p>\n\n<p>Even if one passes in the identity of the newly added record, any queries referencing the table where the record was just added won't see the newly inserted record.</p>\n\n<p>Has anyone developed a work around so that for example in building a closure-table, the newly added record is visible or can be used?</p>\n\n<p>This is very similar to the problem Alberta Kallal has nicely shared solutions for of copying over an existing record using the \"after update\" approach to get around being unable to create a record within a for each loop.  However, in this case I would like to use the result of a query as the basis for copying / inserting, not just copying over an existing row or 'hard coding' the business logic for the modifications into the datamacro (hence would be easy to do if vba approach could see the just added row).</p>\n\n<p>Specific use case is trying to create a way of inserting \"induced\" records in an accounting application.  One earns some money that has no tax deducted, so it is nice to have an automatic journal entry created showing a future liability to pay the tax.  In other words, the presence of a record in a table should automatically generate additional records - and the business logic of those additional records is defined through queries.</p>\n\n<p>Even more specifically, given a \"transactions\" table with fields RegisterID, AccountID, Amount, TrDate, and a \"Induced Transaction Queries\" table that specifies the queries to provide the induced transactions with fields AutoNumberId, QueryThatDefinesAdditionalTransactions (and multiple rows, e.g. \"Query That adds self\", \"Query That Adds Tax Liability\", \"Query That Computes Sales Tax Portion\"), </p>\n\n<p><strong>how can a datamacro create rows in a \"Transactions For Analysis\" Table based on iterating over the \"Induced Transaction Queries\" table and inserting the results of the query in each row applied to the newly added row in the original \"transactions table\"</strong></p>\n\n<p>Thx </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 3, "creation_date": 1553025652, "post_id": 55249060, "comment_id": 97230884, "body": "Since we don&#39;t know what you <b>do</b> intend this macro to do, it would also be helpful if you could post what the <i>expected</i> outcome was supposed to be."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1553028004, "post_id": 55249060, "comment_id": 97231937, "body": "I&#39;m still not following what this is supposed to do (or what&#39;s wrong with the &quot;after&quot; output). Can you explain what you expect it to do and explain why what it&#39;s currently doing is wrong. &quot;ate&quot; isn&#39;t very descriptive."}, {"owner": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1553031346, "post_id": 55249060, "comment_id": 97233233, "body": "Now I added link to my drive and explanations to screenshots"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553040565, "post_id": 55249060, "comment_id": 97236024, "body": "Every time you write data to <code>vntT</code> you increment <code>r</code> <i>except</i> for the last instance under <code>If komz &gt; kom</code>  - is that intentional ?"}, {"owner": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "edited": false, "score": 0, "creation_date": 1553061192, "post_id": 55249060, "comment_id": 97240631, "body": "Yes it moves to the next element in table ,the whole thing with this macro is that (in my opininon) while checking NOT printed elements in table (when all are printed) then it should go once again(so all printed data goes through ifs in macro) for all elements PRINTED"}], "owner": {"reputation": 17, "user_id": 11091502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrDuUQRGMXQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOnwxMZjkDpUzoyAvc5VPCevt9geg/mo/photo.jpg?sz=128", "display_name": "Frost23", "link": "https://stackoverflow.com/users/11091502/frost23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553159527, "creation_date": 1553025324, "last_edit_date": 1553159527, "question_id": 55249060, "link": "https://stackoverflow.com/questions/55249060/does-anyone-know-why-this-sub-omits-my-data", "title": "Does anyone know why this sub omits my data?", "body": "<p>I've been trying to write this macro for a long time and I'm still constantly battling with this (in various categories actually) and now this macro kind of omits my data.</p>\n\n<p>Here is the code (comments are used to describe what is what for me):</p>\n\n<pre><code>Sub testro()\n    Const cSheet As String = \"Procenty\"\n    Const cRange As String = \"A2:D71\"\n    Const cel As Long = 4\n    Const cCol As Variant = \"A\"\n\n\n    Dim vntS As Variant\n    Dim vntT As Variant\n    Dim i As Long, r As Long\n    Dim emptyRow As Long\n\n    Dim kom As Double, komz As Double, kredyt As Double\n    Dim roz As Double, komr As Double, komn As Double\n    Dim dz As Date, dw As Date\n\n    vntS = ThisWorkbook.Worksheets(cSheet).Range(cRange).Value\n    ReDim vntT(1 To 3 * UBound(vntS), 1 To cel + 1)\n    kredyt = 0\n\n    r = 1\n\n    For i = 1 To UBound(vntS)\n\n        dz = vntS(i, 1) \n        komz = vntS(i, 2)\n        dw = vntS(i, 3)\n        kom = vntS(i, 4)\n\n        If komz &gt; kom Then\n\n            If CStr(vntT(r, 1)) = \"\" Then\n               vntT(r, 1) = dz\n               vntT(r, 2) = komz 'debt\n            End If\n\n            vntT(r, 3) = dw\n            vntT(r, 4) = kom 'payment\n            vntT(r, 5) = \" komz&gt;kom\"\n\n            r = r + 1\n\n            komz = komz - kom\n\n            vntT(r, 1) = dz\n            vntT(r, 2) = komz ' Debt\n            vntT(r, 3) = dw\n            vntT(r, 4) = kom  '  payment\n            vntT(r, 5) = \" .. komz &gt; kom\"\n\n        ElseIf komz &lt; kom Then\n\n            komn = kom - komz\n\n            vntT(r, 1) = dz\n            vntT(r, 2) = komz\n            vntT(r, 3) = dw\n            vntT(r, 4) = kom\n            vntT(r, 5) = \" .. A\"\n\n            r = r + 1\n\n            vntT(r, 3) = dw\n            vntT(r, 4) = komn  ' Overpaid\n            vntT(r, 5) = \" .. komz &lt; kom\"\n\n            r = r + 1\n\n        ElseIf komz = kom Then\n            vntT(r, 1) = dz\n            vntT(r, 2) = komz  ' debt\n            vntT(r, 3) = dw\n            vntT(r, 4) = kom   ' payment\n            vntT(r, 5) = \" .. komz = kom\"\n\n            r = r + 1\n\n        End If\n\n\n    Next\n\n    With ThisWorkbook.Worksheets(cSheet)\n        emptyRow = .Columns(cCol).Find(\"*\", , xlFormulas, xlWhole, xlByColumns, xlPrevious).Row + 1\n        .Cells(emptyRow, cCol).Resize(UBound(vntT), UBound(vntT, 2)) = vntT\n        .Cells(emptyRow, cCol) = kredyt\n    End With\nEnd Sub\n</code></pre>\n\n<p>Here I post a screenshots of data before using macro:\n<a href=\"https://i.stack.imgur.com/Fa2zU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fa2zU.png\" alt=\"before\"></a></p>\n\n<p>and after:\n<a href=\"https://i.stack.imgur.com/CQw0k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CQw0k.png\" alt=\"after\"></a></p>\n\n<p>Here's a <a href=\"https://drive.google.com/open?id=1fSbm92R79kcklHz9YCclFDx_BBnBODUi\" rel=\"nofollow noreferrer\">link</a> to my Google Drive with all screenshots including the one with what this macro should do (labeled good) link.</p>\n\n<p>Color red is for data that's omitted (leftside columns) and the ones that should be assigned to it (in same row).</p>\n\n<p>In the blue color section in the good screenshot you can see how it should be done.</p>\n"}, {"tags": ["html", "vba", "web-scraping", "mailto", "scrape"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553025303, "post_id": 55249007, "comment_id": 97230735, "body": "where is you coding attempt? What isn&#39;t working?"}, {"owner": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553027557, "post_id": 55249007, "comment_id": 97231715, "body": "I&#39;ve made plenty, but i am unable to find any was to target that particular href."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553027605, "post_id": 55249007, "comment_id": 97231741, "body": "Add in your current attempt"}, {"owner": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553027712, "post_id": 55249007, "comment_id": 97231791, "body": "&#39;Set my_data = IE.Document.getElementsByClassName(&quot;anyclass&quot;) Set mail = IE.Document.getElementsByTagName(&quot;a&quot;)(0) ActiveSheet.Cells(i, 2).Value = mail.href"}, {"owner": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553027769, "post_id": 55249007, "comment_id": 97231823, "body": "I am always targeting classes first... but this time, it seems that the href is out of any class"}, {"owner": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553027962, "post_id": 55249007, "comment_id": 97231920, "body": "I am also not particularly skilled in web scraping, this is quite out of place of my usual work ..."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1553027989, "creation_date": 1553027989, "answer_id": 55249618, "question_id": 55249007, "link": "https://stackoverflow.com/questions/55249007/how-to-scrape-mailto-from-following-page-using-vba/55249618#55249618", "title": "How to scrape mailto from following page using VBA", "body": "<p>Use a css attribute = value selector with ^ starts with operator</p>\n\n<pre><code>Debug.Print ie.document.querySelector(\"[href^='mailto:']\").href\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7840685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d992ba894d63ad311918efcc07e5309?s=128&d=identicon&r=PG&f=1", "display_name": "Shiwers", "link": "https://stackoverflow.com/users/7840685/shiwers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 55249618, "answer_count": 1, "score": 0, "last_activity_date": 1553033938, "creation_date": 1553025108, "last_edit_date": 1553033938, "question_id": 55249007, "link": "https://stackoverflow.com/questions/55249007/how-to-scrape-mailto-from-following-page-using-vba", "title": "How to scrape mailto from following page using VBA", "body": "<p>i am trying to scrape mailto (href) from a html file, but i am unable to \"hit\" it.</p>\n\n<p>Any advice is welcome.</p>\n\n<pre><code>       &lt;div class=\"exhibitor-contact\"&gt;\n            &lt;div class=\"col\"&gt;\n                &lt;h3&gt;\n                whatever           &lt;/h3&gt;\n      &lt;p&gt;\n                    MLW &lt;br /&gt;            whatever&lt;br /&gt;            75008             Paris              - France          &lt;/p&gt;\n      &lt;p&gt;\n                    &lt;a class='inverse-a-span' href='#tel' id='tel' onclick=\"return xt_click(this,'C', xtn2, xtpage.replace(/\\w*$/, 'exhibitor::tel').replace(/^Exhibitors::/, ''), 'A')\"&gt;Show Phone Number&lt;/a&gt;&lt;span style='display:none;'&gt;whatever&lt;/span&gt;&lt;br /&gt;                        &lt;a href='mailto:whatever@whatever.com' onclick=\"return xt_click(this,'C',xtn2, xtpage.replace(/\\w*$/, 'exhibitor::email').replace(/^Exhibitors::/, ''), 'A')\"&gt;Send an Email&lt;/a&gt;&lt;br /&gt;                      &lt;/p&gt;\n    &lt;/div&gt;\n          &lt;/div&gt;\n\n\n\n&lt;/section&gt;\n</code></pre>\n\n<p></p>\n\n<p></p>\n\n<p>Code:</p>\n\n<pre><code>Set my_data = IE.Document.getElementsByClassName(\"anyclass\") \nSet mail = IE.Document.getElementsByTagName(\"a\")(0) ActiveSheet.Cells(i, 2).Value = mail.href\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553025148, "post_id": 55248801, "comment_id": 97230649, "body": "Edit your question"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11226888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b726883ae115cd1b404e670c0d9c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "KarenW", "link": "https://stackoverflow.com/users/11226888/karenw"}, "edited": false, "score": 0, "creation_date": 1553026499, "post_id": 55249225, "comment_id": 97231276, "body": "Thank you , but it is still pasting values over all sheets. I am not having a problem with any part of the code (messy as it is) except for the pasting over all sheets. Please help me with that."}, {"owner": {"reputation": 1, "user_id": 11226888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b726883ae115cd1b404e670c0d9c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "KarenW", "link": "https://stackoverflow.com/users/11226888/karenw"}, "edited": false, "score": 0, "creation_date": 1553034542, "post_id": 55249225, "comment_id": 97234323, "body": "Hi - I am getting a runtime error 9. subscript out of range error."}, {"owner": {"reputation": 189, "user_id": 10597114, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000595196681/picture?type=large", "display_name": "Peicong Chen", "link": "https://stackoverflow.com/users/10597114/peicong-chen"}, "reply_to_user": {"reputation": 1, "user_id": 11226888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b726883ae115cd1b404e670c0d9c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "KarenW", "link": "https://stackoverflow.com/users/11226888/karenw"}, "edited": false, "score": 0, "creation_date": 1553035108, "post_id": 55249225, "comment_id": 97234509, "body": "Could you tell which line? The way I remove On error resume next is assuming all those sheet names are existed in those excel files. if they are not the case you can add the On error resume next back to the code."}, {"owner": {"reputation": 1, "user_id": 11226888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b726883ae115cd1b404e670c0d9c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "KarenW", "link": "https://stackoverflow.com/users/11226888/karenw"}, "edited": false, "score": 0, "creation_date": 1553035345, "post_id": 55249225, "comment_id": 97234597, "body": "Hi Peicong, All of the workbooks have that sheet.  I think this is the line with the error:   LsWb.Sheets(LsFileSh).Activate"}, {"owner": {"reputation": 1, "user_id": 11226888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b726883ae115cd1b404e670c0d9c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "KarenW", "link": "https://stackoverflow.com/users/11226888/karenw"}, "edited": false, "score": 0, "creation_date": 1553036063, "post_id": 55249225, "comment_id": 97234794, "body": "Hi Peicong, First - THANK YOU for your patience and spending the time with me. IT WORKS!!! I am not quite sure what you changed, but it&#39;s working now. I will clean up my code and move on to the next one. Have a great evening!!"}, {"owner": {"reputation": 189, "user_id": 10597114, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000595196681/picture?type=large", "display_name": "Peicong Chen", "link": "https://stackoverflow.com/users/10597114/peicong-chen"}, "reply_to_user": {"reputation": 1, "user_id": 11226888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b726883ae115cd1b404e670c0d9c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "KarenW", "link": "https://stackoverflow.com/users/11226888/karenw"}, "edited": false, "score": 0, "creation_date": 1553632817, "post_id": 55249225, "comment_id": 97455292, "body": "Much appreciate if you like my solution and upvote my answer. :)"}], "tags": [], "owner": {"reputation": 189, "user_id": 10597114, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000595196681/picture?type=large", "display_name": "Peicong Chen", "link": "https://stackoverflow.com/users/10597114/peicong-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1553031612, "last_edit_date": 1553031612, "creation_date": 1553026145, "answer_id": 55249225, "question_id": 55248801, "link": "https://stackoverflow.com/questions/55248801/in-vba-copy-all-worksheet-data-to-a-specific-sheet-in-another-workbook/55249225#55249225", "title": "In VBA copy all worksheet data to a specific sheet in another workbook", "body": "<p>I have tested the below code and it works for me. The way you use on error resume next is not a good idea since your code return lots of error. I removed it and fixed the error and my own test run is successful.\nif you run the code let me know if you encounters any error. and what the error is.</p>\n\n<pre><code>Sub Summarize_Reports()\n'Mar 18, 2019\n\n\nConst shN = \"Sheet Format\"                               '&lt;&lt; summary workbook sheet name\nConst LsFileSh = \"1. Summary for Reporting \"             '&lt;&lt; summary workbook sheet name\n\nDim wb As Workbook\nSet MySumWb = ActiveWorkbook                               '&lt;&lt; The summary WB\nDim SumWs As Worksheet\nSet SumWs = ActiveWorkbook.Sheets(shN)                     '&lt;&lt; The summary workbook sheet, \"Summary Format\"\n\n\nDim CountSh As Long, r As Long, c As Long\nDim A As Long\nDim myPath As String\nDim myFile As String\nDim LsWb As Workbook        '&lt;&lt; This is the leasing file WB identifierDim fldr As FileDialog\nDim LsFileName As String\n\nApplication.ScreenUpdating = False\n\n'***********************************This With statement selects the folder\n\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n.Title = \"Please select the folder where the Capital lease files are, then press OK to continue\"\n.AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then\n    Set fldr = Nothing\n    Else\n    myPath = .SelectedItems(1)\n    End If\n\n    If Right(myPath, 1) &lt;&gt; \"\\\" Then\n    myPath = myPath &amp; \"\\\"\n    End If\nEnd With\n\nmyFile = Dir(myPath &amp; \"*capital*.xl*\")\n\n'MsgBox mysumwb.Name\n'MsgBox mysumwb.Worksheets.Count\nCountSh = MySumWb.Worksheets.Count\n'MsgBox CountSh\n\nDo While myFile &lt;&gt; \"\"\n\n\n    MySumWb.Worksheets(\"Summary Format\").Select                      '&lt;&lt;&lt;&lt;&lt;&lt; copy the tab in the sumwp file\n    MySumWb.Worksheets(\"Summary Format\").Copy After:=Sheets(CountSh)\n\n    'mysumwb.SumWs.Select\n    'mysumwb.SumWs.Copy After:=mysumwb.workheets(CountSh)\n\n    Set LsWb = Workbooks.Open(myPath &amp; myFile)           '&lt;&lt;&lt; establish the open leasing file's name\n    LsFileName = Left(LsWb.Name, Len(LsWb.Name) - 4)     '&lt;&lt;&lt; move the filename to a string\n    MySumWb.Sheets(CountSh + 1).Name = LsFileName\n\n    LsWb.Sheets(LsFileSh).Activate\n    LsWb.Sheets(LsFileSh).Cells.Copy\n\n    MySumWb.Sheets(LsFileName).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n\n\n'    MsgBox ActiveWorkbook.Name\n'    mysumwb.Sheets(LsFileName).Select\n'    MsgBox ActiveWorkbook.Worksheets(CountSh + 1).Name\n'\n'\n'\n'    mysumwb.Sheets(LsFileName).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n\n    Application.CutCopyMode = False\n\n\n    LsWb.Close False\n    myFile = Dir()\n    MySumWb.Save\nLoop\n\n\nActiveWorkbook.Save\nApplication.ScreenUpdating = True\nMsgBox A\nMsgBox \"All Done!\"\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11226888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b726883ae115cd1b404e670c0d9c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "KarenW", "link": "https://stackoverflow.com/users/11226888/karenw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553031612, "creation_date": 1553024143, "last_edit_date": 1553025406, "question_id": 55248801, "link": "https://stackoverflow.com/questions/55248801/in-vba-copy-all-worksheet-data-to-a-specific-sheet-in-another-workbook", "title": "In VBA copy all worksheet data to a specific sheet in another workbook", "body": "<p>Please help. Been looking at this and searching sites for 2 days. I have a file that is the summary file \"mysumwb.\" I am opening all files in a folder. \"LsWb\" represents the open file. Searching for a particular sheet named \"LsFileSh.\" and copy/paste value of the entire sheet \"LsFileSh\" into the last sheet in the summary file. What is actually happening is the sheet is being copied onto <strong>ALL</strong> of the sheets in the target/summary file \"mysumwb.\"</p>\n\n<p>Here is the code. Sorry for all the comments. And thank you.</p>\n\n<pre><code> Sub Summarize_Reports()\n'Mar 18, 2019\nOn Error Resume Next\n\nConst shN = \"Sheet Format\"                               '&lt;&lt; summary workbook sheet name\nConst LsFileSh = \"1. Summary for Reporting \"             '&lt;&lt; summary workbook sheet name\n\nDim wb As Workbook\nSet mysumwb = ThisWorkbook                               '&lt;&lt; The summary WB\nDim SumWs As Worksheet\nSet SumWs = ThisWorkbook.Sheets(shN)                     '&lt;&lt; The summary workbook sheet, \"Summary Format\"\n\n\nDim CountSh As Long, r As Long, c As Long\nDim A As Long\nDim myPath As String\nDim myFile As String\nDim LsWb As Workbook        '&lt;&lt; This is the leasing file WB identifierDim fldr As FileDialog\nDim LsFileName As String\n\nApplication.ScreenUpdating = False\n\n'***********************************This With statement selects the folder\n\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n.Title = \"Please select the folder where the Capital lease files are, then press OK to continue\"\n.AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then\n    Set fldr = Nothing\n    Else\n    myPath = .SelectedItems(1)\n    End If\n\n    If Right(myPath, 1) &lt;&gt; \"\\\" Then\n    myPath = myPath &amp; \"\\\"\n    End If\nEnd With\n\nmyFile = Dir(myPath &amp; \"*capital*.xl*\")\n\n'MsgBox mysumwb.Name\n'MsgBox mysumwb.Worksheets.Count\nCountSh = mysumwb.Worksheets.Count\n'MsgBox CountSh\n\nDo While myFile &lt;&gt; \"\"\n\n\n    Sheets(\"Summary Format\").Select                      '&lt;&lt;&lt;&lt;&lt;&lt; copy the tab in the sumwp file\n    Sheets(\"Summary Format\").Copy After:=Sheets(CountSh)\n\n    'mysumwb.SumWs.Select\n    'mysumwb.SumWs.Copy After:=mysumwb.workheets(CountSh)\n\n    Set LsWb = Workbooks.Open(myPath &amp; myFile)           '&lt;&lt;&lt; establish the open leasing file's name\n    LsFileName = Left(LsWb.Name, Len(LsWb.Name) - 4)     '&lt;&lt;&lt; move the filename to a string\n    mysumwb.Sheets(CountSh + 1).Name = LsFileName\n\n    LsWb.Sheets(LsFileSh).Activate\n '   LsWb.Sheets(LsFileSh).Cells.Copy\n '   mysumwb.Sheets(Worksheets.Count).Cells.Value = LsWb.Sheets(LsFileSh).Cells.Value\n\n    With mysumwb\n\n        CountSh = mysumwb.Worksheets.Count\n        MsgBox CountSh\n        .Sheets(CountSh).Name = LsFileName\n        .Sheets(LsFileName).Activate\n        .Sheets(LsFileName).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n        MsgBox LsFileName\n    End With\n\n'    MsgBox ActiveWorkbook.Name\n'    mysumwb.Sheets(LsFileName).Select\n'    MsgBox ActiveWorkbook.Worksheets(CountSh + 1).Name\n'\n'\n'\n'    mysumwb.Sheets(LsFileName).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n\n    Application.CutCopyMode = False\n\n\n    LsWb.Close False\n    myFile = Dir()\n    mysumwb.Save\nLoop\n\n\nActiveWorkbook.Save\nApplication.ScreenUpdating = True\nNoFilesProcessed.Value = \"Lease Files Processed = \" &amp; A\nMsgBox A\nMsgBox \"All Done!\"\n\n\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553029682, "post_id": 55248805, "comment_id": 97232649, "body": "Am I able to respond with more examples? This comment box doesn&#39;t have  much formatting capability. I can&#39;t even seem to work out how to start a new line!?"}, {"owner": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553030806, "post_id": 55248805, "comment_id": 97233047, "body": "Thanks for that recent update - I actually type the extra punctuation into the cell so that it is pulled through to the link by the sub"}, {"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "reply_to_user": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553030999, "post_id": 55248805, "comment_id": 97233114, "body": "Oh okay. Does my update help you with Ranges? Do you need me to take out the extra punctuation?"}, {"owner": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553031178, "post_id": 55248805, "comment_id": 97233175, "body": "Wow that was quick. Well done. That would be mega helpful. I am a bit confused by your response though, how do I use this in a sub? Do I need to &quot;Dim i as Integer&quot; before hand?"}, {"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "reply_to_user": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553031549, "post_id": 55248805, "comment_id": 97233307, "body": "I added the sub name and the integer declaration. It\u2019s good practices to explicitly declare your variables, but unless you have <code>Option Explicit</code> at the top of your module, isn\u2019t required."}, {"owner": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553032018, "post_id": 55248805, "comment_id": 97233456, "body": "Legend. Is there a way to send messages on this to users."}, {"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "reply_to_user": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553032203, "post_id": 55248805, "comment_id": 97233534, "body": "Nah I don\u2019t think so. <a href=\"https://meta.stackexchange.com/questions/57537/how-do-i-contact-other-users\">Found this</a>"}, {"owner": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553033028, "post_id": 55248805, "comment_id": 97233814, "body": "Yes It works. Except you were right by saying &#39;You need to make sure it the reference is setup like a sheet range reference.&#39; it worked without in my original code, but not in the new without this addition."}], "tags": [], "owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "is_accepted": true, "score": 1, "last_activity_date": 1553033122, "last_edit_date": 1553033122, "creation_date": 1553024147, "answer_id": 55248805, "question_id": 55248635, "link": "https://stackoverflow.com/questions/55248635/vba-loop-to-update-a-hyperlink-for-each-cell-in-a-column/55248805#55248805", "title": "VBA Loop to update a hyperlink for each cell in a column", "body": "<p>You could have an error in your code to perform the hyperlink if this isn\u2019t addressed in the cell value. You need to make sure it the reference is setup like a sheet range reference. </p>\n\n<pre><code>SubAddress:= Range(\"Z118\") &amp; Range(\"AD105\")\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>SubAddress:= \"'\" &amp; Range(\"Z118\") &amp;\"'!\" &amp; Range(\"AD105\")\n</code></pre>\n\n<p>But since this is handled in you cell values, you have a couple options from here. But here is a For loop like you asked for (see TinMan464 for a While loop):</p>\n\n<pre><code>Sub foo() \nDim i as integer \n\n  For i = 118 to 200 \u2018change the last number to what you need \n     Range(\"AB\"&amp;i).Select\n     ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= \"'\" &amp; Range(\"Z\"&amp;i) &amp;\"'!\" &amp;  Range(\"AD105\")\n  Next i\n\nEnd sub\n</code></pre>\n\n<p>But I would avoid using <a href=\"https://riptutorial.com/excel-vba/example/9292/avoid-using-select-or-activate\" rel=\"nofollow noreferrer\">select</a></p>\n\n<pre><code>Sub foo()\nDim i as integer\n\n  For i = 1 to 3 \u2018change the last number to what you need \n      ActiveSheet.Hyperlinks.Add Anchor:= Range(\"AB\"&amp;i), Address:=\"\", SubAddress:= \"'\" &amp; Range(\"Z\"&amp;i) &amp;\"'!\" &amp;  Range(\"AD105\")\n  Next i\n\nEnd sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 11068028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34320943c84e2ea922fe64767b8d611a?s=128&d=identicon&r=PG&f=1", "display_name": "TinMan464", "link": "https://stackoverflow.com/users/11068028/tinman464"}, "is_accepted": false, "score": 2, "last_activity_date": 1553164259, "last_edit_date": 1553164259, "creation_date": 1553024382, "answer_id": 55248857, "question_id": 55248635, "link": "https://stackoverflow.com/questions/55248635/vba-loop-to-update-a-hyperlink-for-each-cell-in-a-column/55248857#55248857", "title": "VBA Loop to update a hyperlink for each cell in a column", "body": "<p>You can use the following Sub to cycle through Column \"B\" and \"C\" until one of them is empty.  This will populate Column \"A\" with the values from \"B\" and \"C\" until there are no more contiguous values left.</p>\n\n<pre><code>Private Sub NewLink()\n    Dim i As Integer\n    i = 1\n    Do Until IsEmpty(Range(\"B\" &amp; i).Value) Or IsEmpty(Range(\"C\" &amp; i).Value)\n        Range(\"A\" &amp; i).Select\n        ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n        Range(\"B\" &amp; i) &amp; Range(\"C\" &amp; i)\n        i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Just use the following to call this function wherever you need it/want it to run.</p>\n\n<pre><code>Call NewLink\n</code></pre>\n\n<p>Following Dude_Scott's recommendation for .Select, use the following.</p>\n\n<pre><code>Private Sub NewLink()\n    Dim i As Integer\n    i = 1\n    Do Until IsEmpty(Range(\"B\" &amp; i).Value) Or IsEmpty(Range(\"C\" &amp; i).Value)\n        ActiveSheet.Hyperlinks.Add Anchor:=Range(\"A\" &amp; i), Addreess:=\"\", SubAddress:= _\n        Range(\"B\" &amp; i) &amp; Range(\"C\" &amp; i)\n        i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>EDIT: To assist readers in selecting a proper solution for their needs.</p>\n\n<p>The pros to the 'Do While' loop are that you can add additional, consecutive rows without having to update your macro/sub.</p>\n\n<p>The cons are that columns \"B\" and \"C\" are essentially reserved for creating links in column \"A\".</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553034868, "post_id": 55250804, "comment_id": 97234425, "body": "When I run this, I get &quot;Runtime error 450. Wrong number of arguments or invalid property assigned.&quot;"}, {"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "edited": false, "score": 0, "creation_date": 1553038976, "post_id": 55250804, "comment_id": 97235654, "body": "I believe you\u2019re getting an error with the anchor. Your are trying to reference a cell with the WorkingCell object. I think for this to work it should read <code>Anchor:= WorkingCell</code>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "edited": false, "score": 0, "creation_date": 1553071587, "post_id": 55250804, "comment_id": 97244860, "body": "@MattCann Sorry, I forgot that <code>Address</code> is a mandatory Parameter, even when it is not used.  I have added <code>Address:=&quot;&quot;, </code> to the code"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "edited": false, "score": 0, "creation_date": 1553071954, "post_id": 55250804, "comment_id": 97245043, "body": "@Dude_Scott As <code>WorkingCell</code> is a 1-cell range, <code>WorkingCell</code>, <code>WorkingCell.Cells(1,1)</code> and <code>WorkingCell.Range</code> are all equivalent.  Because this is in a <code>With</code>, we can drop the <code>WorkingCell</code> (I used <code>.Cells(1,1)</code> because thought <code>Anchor:=.Range</code> might be less clear to beginners trying to learn from the example)"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1553071477, "last_edit_date": 1553071477, "creation_date": 1553033941, "answer_id": 55250804, "question_id": 55248635, "link": "https://stackoverflow.com/questions/55248635/vba-loop-to-update-a-hyperlink-for-each-cell-in-a-column/55250804#55250804", "title": "VBA Loop to update a hyperlink for each cell in a column", "body": "<p>We already have an accepted answer using a standard <code>For</code> loop, but here is a version using <code>For Each</code>, <code>With</code>, and <code>Offset</code> for reference:</p>\n\n<pre><code>Dim WorkingCell As Range\n\nFor Each WorkingCell In ActiveSheet.Range(\"AB118:AB171\").Cells\n    With WorkingCell\n        .Hyperlinks.Add Anchor:=.Cells(1,1), Address:=\"\", _\n            SubAddress:=.Offset(0,-2).Value &amp; ActiveSheet.Range(\"AD105\").Value\n    End With\nNext WorkingCell\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10544748, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156540014186287/picture?type=large", "display_name": "Matt Cann", "link": "https://stackoverflow.com/users/10544748/matt-cann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "accepted_answer_id": 55248805, "answer_count": 3, "score": 1, "last_activity_date": 1553164259, "creation_date": 1553023533, "last_edit_date": 1553030581, "question_id": 55248635, "link": "https://stackoverflow.com/questions/55248635/vba-loop-to-update-a-hyperlink-for-each-cell-in-a-column", "title": "VBA Loop to update a hyperlink for each cell in a column", "body": "<p>I have edited this question because I made a small mistake and decided not to dumb down the cell references I am using to simple ones.</p>\n\n<p>I have chosen to update a hyperlink in a specific cell by running a macro. </p>\n\n<pre><code>Range(\"AB118\").Select\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\nRange(\"Z118\") &amp; Range(\"AD105\")\n</code></pre>\n\n<p>So basically: </p>\n\n<p>Column AB contains the final hyperlink Eg. Home!AB118</p>\n\n<p>Column Z contains the name of the sheet Eg. Home!</p>\n\n<p>Cell AD105 contains the cell which you will land Eg. AB118</p>\n\n<p>I have written the macro to update the hyperlink one cell/row at a time.</p>\n\n<pre><code> 'Update \"Sheet 1\" Link\n    Range(\"AB118\").Select\n    ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n    Range(\"Z118\") &amp; Range(\"AD105\")\n\n'Update \"Sheet 2\" Link\n    Range(\"AB119\").Select\n    ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n    Range(\"Z119\") &amp; Range(\"AD105\")\n\n'Update \"Sheet 3\" Link\n    Range(\"AB120\").Select\n    ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n    Range(\"Z120\") &amp; Range(\"AD105\")\n</code></pre>\n\n<p>Is there a way to use \"For Each\" or similar, to shorten this macro which goes through each line combining column Z &amp; cell AD105 into a hyperlink which appears in Column AB.</p>\n\n<p>Hopefully this will make sense, I'm quite experienced with excel and VBA, but new to the forum. </p>\n\n<p>The table of this information starts at row 118 and ends at row 171, So I am not sure if I need to tell it to start on a specific row and end on a specific row. </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1553022433, "post_id": 55248318, "comment_id": 97229386, "body": "<i>Problem appears once some data are input outside of the table</i>  What problem?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "edited": false, "score": 1, "creation_date": 1553022825, "post_id": 55248318, "comment_id": 97229595, "body": "There are numerous posts detailing various methods of finding the &#39;last cell&#39; with the benefits and caveats of each method."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1553023518, "post_id": 55248318, "comment_id": 97229881, "body": "use another column or row to count by,  Restrict entry of information below the Table in column A or addin information to the right in row 1"}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "edited": false, "score": 0, "creation_date": 1553116006, "post_id": 55250440, "comment_id": 97271538, "body": "That works good in an VBA code but if I define a named range in Excel by using this formula then it I run it in the Immediate window I get this result:   <code>? Range(&quot;table&quot;).address $A$1:$XFC$1048570</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "edited": false, "score": 0, "creation_date": 1553119189, "post_id": 55250440, "comment_id": 97272780, "body": "If I define a named range &quot;MyTable&quot; with <i>Refers To</i> as <code>=FullTable(Sheet1!$A$1)</code> (where range A1:F12 on Sheet1 has content) then in the Immediate pane <code>? Range(&quot;MyTable&quot;).Address</code> gives the output <code>$A$1:$F$12</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1553031866, "creation_date": 1553031866, "answer_id": 55250440, "question_id": 55248318, "link": "https://stackoverflow.com/questions/55248318/defining-named-range-by-formula-or-udf/55250440#55250440", "title": "Defining Named Range by Formula or UDF", "body": "<p>Something like this could work, but would be dependent on having no \"interfering\" content on the sheet:</p>\n\n<pre><code>' \"rng\" is the top-left corner of the table you want to return\nFunction FullTable(rng As Range) As Range\n    Dim lastCol As Long, lastRow As Long\n\n    With rng.Parent\n        lastRow = .Cells(.Rows.Count, rng.Column).End(xlUp).Row\n        lastCol = .Cells(rng.Row, .Columns.Count).End(xlToLeft).Column\n        Set FullTable = .Range(rng, .Cells(lastRow, lastCol))\n    End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553066265, "creation_date": 1553022142, "last_edit_date": 1553066265, "question_id": 55248318, "link": "https://stackoverflow.com/questions/55248318/defining-named-range-by-formula-or-udf", "title": "Defining Named Range by Formula or UDF", "body": "<p>I would like to ask about your experience with defining a named range in Excel.</p>\n\n<p>I'm normally using this formula:</p>\n\n<pre><code>=OFFSET(Sheet!$A$1;0;0;COUNTA(Sheet!$A:$A);COUNTA(DATA!$1:$1))\n</code></pre>\n\n<p>This works great for a dynamic range. It modifies once you add rows or columns to the original table. Problem appears once some data are input outside of the table in column A or row 1 in this case.</p>\n\n<p>Then I thought <code>Range(\"A1\").CurrentRegion.Address</code> in a UDF will do the job. But this command is skiped in a UDF... as it doesn't work only with the cell which contains the formula, I guess.</p>\n\n<p>Anyone using some formula or UDF which is more robust?</p>\n"}, {"tags": ["excel", "vba", "copy", "compare", "difference"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1553022438, "post_id": 55248074, "comment_id": 97229392, "body": "Why a macro when a simple Excel function in a helper column or two can provide the same result a lot easier?"}, {"owner": {"reputation": 1, "user_id": 11228172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db7356ee297588e25e35766e6e8e191b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Doe", "link": "https://stackoverflow.com/users/11228172/jack-doe"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1553023186, "post_id": 55248074, "comment_id": 97229748, "body": "Can you write the formulas for my sample sheets? I need results like i mentioned in my messages. This type of format may not be possible with formulas."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1553023804, "post_id": 55248074, "comment_id": 97230010, "body": "You can have a try yourself, and then we can help with specific issues - SO is not a code writing service. As a hint, consider <code>=IF(...)</code>, equality between cells and <code>ISBLANK</code> as a starting point."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1553034013, "post_id": 55248074, "comment_id": 97234161, "body": "It&#39;s not clear exactly what the rules are for the comparison, so it would help you get answers if you could provide a detailed explanation of how the result sheets are compiled.  Don&#39;t make us guess..."}], "owner": {"reputation": 1, "user_id": 11228172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db7356ee297588e25e35766e6e8e191b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Doe", "link": "https://stackoverflow.com/users/11228172/jack-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553421355, "creation_date": 1553021207, "last_edit_date": 1553421355, "question_id": 55248074, "link": "https://stackoverflow.com/questions/55248074/compare-2-excel-sheets-through-id-and-copy-differences-and-missing-datas", "title": "Compare 2 Excel Sheets through ID and copy differences and missing datas", "body": "<p>I have two Excel files and I need to compare two excels based on \"ID\"+(Other columns)\". I need different values on both sides and missing values column by column in sepaerated Excel sheets/files for every compare.</p>\n\n<p>I need to see what data change in which side, which difference is exist on which side.</p>\n\n<p>Please find a sample output;</p>\n\n<p><strong>Sheet1:</strong> </p>\n\n<pre><code> ID    BranchID   Name\n 7790     2   \n 7792     2\n 77793    1\n 7794     1\n 77795    1        0\n 7796     100\n</code></pre>\n\n<p><strong>Sheet2:</strong> </p>\n\n<pre><code>ID  BRANCHID    NAME\n7790    2   \n7790    2   \n7792    2   \n7793    100     0\n7794    1   \n7795    100     Name\n7796    2   \n</code></pre>\n\n<p><strong>Result1:</strong> </p>\n\n<pre><code>ID  BRANCHID    ID1 BRANCHID1\n7790    2      7790       2\n0       0      7790       2\n7792    2      7792       2\n7793    1      0          0\n0       0      7793      100\n7794    1      7794      1\n7795    1      0          0\n0       0      7795      100\n0       0      7796       2\n7796    100    0          0\n</code></pre>\n\n<p><strong>Result2:</strong> </p>\n\n<pre><code>ID    NAME  ID1     NAME1\n7790        7790    \n0           7790    \n7792        7792    \n7793        0   \n0           7793     0\n7794        7794    \n7795   0    0   \n0           7795     Name\n7796        7796    \n</code></pre>\n\n<p>Could you please help with an excel macro VBA?</p>\n"}, {"tags": ["excel", "vba", "advanced-filter"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1553021788, "post_id": 55248063, "comment_id": 97229049, "body": "I cannot reproduce your problem given the limited information you have provided. Please read <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and imagine that I cannot see what is on your worksheet!"}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 1, "last_activity_date": 1553021803, "creation_date": 1553021803, "answer_id": 55248231, "question_id": 55248063, "link": "https://stackoverflow.com/questions/55248063/how-can-i-used-advanced-filter-to-find-exact-match/55248231#55248231", "title": "How can I used Advanced Filter to find exact match?", "body": "<p>Not according to the docs(<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.advancedfilter\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.advancedfilter</a>). </p>\n\n<p>I'd just use autofilter and copy the visible cells: <code>pl.UsedRange.SpecialCells(xlCellTypeVisible).Copy</code></p>\n"}], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553066204, "creation_date": 1553021175, "last_edit_date": 1553066204, "question_id": 55248063, "link": "https://stackoverflow.com/questions/55248063/how-can-i-used-advanced-filter-to-find-exact-match", "title": "How can I used Advanced Filter to find exact match?", "body": "<p>I am trying to understand how to find only exact matches within an Advanced Filter. For example, in the code below my range \"filter\" includes \"Ford\" and \"Ford Escort\" and when filtering on \"Ford\" I return on the values for \"Ford Escort\". Is there way I can return values only exactly matching \"Ford\"?</p>\n\n<pre><code>pl.Range(\"myNamedRange\").AdvancedFilter Action:=xlFilterCopy, criteriarange:=fl.Range(\"filter\"), copytorange:=hd.Range(\"A1\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553021450, "post_id": 55247973, "comment_id": 97228877, "body": "Are you remembering the const flag at the top?"}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1553021502, "post_id": 55247973, "comment_id": 97228904, "body": "Sorry, yes, the const flag is at the top of my module. I just didn&#39;t want to include all the unnecessary bits of that first part of the code."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1553022523, "post_id": 55248153, "comment_id": 97229434, "body": "I swear my code looked so close to yours that I can&#39;t figure out why what I had wasn&#39;t working but your code, at least, is working. I sincerely appreciate it. One last thing, could you tell me the purpose of debug.print DownloadFile? I never knew you could use debug.print in this manner or why we would. Why debug.print over Call or Run DownloadFile?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 1, "creation_date": 1553022604, "post_id": 55248153, "comment_id": 97229483, "body": "It is only because I wanted to return the final download name of the file. You can re-write to run as a sub and not return anything.  Debug.Print writes to the immediate window Ctrl + G"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1554452727, "post_id": 55248153, "comment_id": 97765743, "body": "Please remember to accept if this has answered the question. <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1553021516, "creation_date": 1553021516, "answer_id": 55248153, "question_id": 55247973, "link": "https://stackoverflow.com/questions/55247973/using-variables-for-site-when-trying-to-download-untrusted-certificate-file-via/55248153#55248153", "title": "Using variables for site when trying to download untrusted certificate file via WinHttp.WinHttpRequest.5.1", "body": "<p>Try the following (ensuring const flag is present)</p>\n\n<pre><code>Option Explicit\nConst IGNORE_SSL_ERROR_FLAG As Long = 13056\nPublic Sub test()\n    GetFile \"https://www.defensetravel.dod.mil/Docs/perdiem/browse/Allowances/Per_Diem_Rates/Text_Only/OCONUS-Overseas/2019/ovs19-03.xls\"\nEnd Sub\nPublic Sub GetFile(ByVal downloadURL As String)\n    Debug.Print DownloadFile(\"C:\\Users\\craig\\Raw DOD Files\\\", downloadURL)\nEnd Sub\n\nPublic Function DownloadFile(ByVal downloadFolder As String, ByVal downloadURL As String) As String\n    Dim http As Object, tempArr As Variant\n    Set http = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    http.Open \"GET\", downloadURL, False\n    http.Option(4) = IGNORE_SSL_ERROR_FLAG\n    http.send\n    On Error GoTo errhand\n    With CreateObject(\"ADODB.Stream\")\n        .Open\n        .Type = 1\n        .write http.responseBody\n        tempArr = Split(downloadURL, \"/\")\n        tempArr = tempArr(UBound(tempArr))\n        .SaveToFile downloadFolder &amp; tempArr, 2  '&lt; \"/\" on enter of downloadFolder. 2 for overwrite which is Ok if no file modifications.\n        .Close\n    End With\n    DownloadFile = downloadFolder &amp; tempArr\n    Exit Function\nerrhand:\n    If Err.Number &lt;&gt; 0 Then\n        Debug.Print Err.Number, Err.Description\n        MsgBox \"Download failed\"\n    End If\n    DownloadFile = vbNullString\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553066181, "creation_date": 1553020849, "last_edit_date": 1553066181, "question_id": 55247973, "link": "https://stackoverflow.com/questions/55247973/using-variables-for-site-when-trying-to-download-untrusted-certificate-file-via", "title": "Using variables for site when trying to download untrusted certificate file via WinHttp.WinHttpRequest.5.1", "body": "<p>I'm trying to access a DoD file with a certificate that's untrusted. I'm able to use code found in this <a href=\"https://stackoverflow.com/questions/55188751/assign-the-2nd-tab-of-ie-to-an-object-variable/55189497#55189497\">Original Post</a> but need to modify it to allow variables. </p>\n\n<p>The web address/file is:\n<a href=\"https://www.defensetravel.dod.mil/Docs/perdiem/browse/Allowances/Per_Diem_Rates/Text_Only/OCONUS-Overseas/2019/ovs19-03.xls\" rel=\"nofollow noreferrer\">https://www.defensetravel.dod.mil/Docs/perdiem/browse/Allowances/Per_Diem_Rates/Text_Only/OCONUS-Overseas/2019/ovs19-03.xls</a></p>\n\n<p>The part in the sub that first calls the GetFile sub I have:</p>\n\n<pre><code>downloadURL = \"https://www.defensetravel.dod.mil/Docs/perdiem/browse/Allowances/Per_Diem_Rates/Text_Only/OCONUS-Overseas/2019/ovs\" &amp; strTwoDigitYear &amp; \"-\" &amp; strTwoDigitMonth &amp; \".xls\"\n</code></pre>\n\n<p>Both variables in the URL change dependent upon month and year (as the web address/file is named). Then my GetFile sub is:</p>\n\n<pre><code>Public Sub GetFile(ByVal downloadURL As String)\nDebug.Print DownloadFile(\"C:\\Users\\craig\\Raw DOD Files\\\", downloadURL)\nEnd Sub\n</code></pre>\n\n<p>The Public function then runs but gets an error on line: http.Send. The error is \"Run-time error '-2147012851 (80072f0d)': The certificate authority is invalid or incorrect.\" The variable still has scope and the link is correct so I'm curious to know whether there's something with the WinHttp that would prevent using variables as I'm not experience with using WinHttp.</p>\n\n<pre><code>Public Function DownloadFile(ByVal downloadFolder As String, ByVal downloadURL As String) As String\n    Dim http As Object, tempArr As Variant\n    Set http = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    http.Open \"GET\", downloadURL, False\n    http.Option(4) = intSslErrorIgnoreFlags\n    http.Send\n    On Error GoTo errhand\n    With CreateObject(\"ADODB.Stream\")\n        .Open\n        .Type = 1\n        .write http.responseBody\n        tempArr = Split(downloadURL, \"/\")\n        tempArr = tempArr(UBound(tempArr))\n        .SaveToFile downloadFolder &amp; tempArr, 2  '&lt; \"/\" on enter of downloadFolder. 2 for overwrite which is Ok if no file modifications.\n        .Close\n    End With\n    DownloadFile = downloadFolder &amp; tempArr\n    Exit Function\nerrhand:\n    If Err.Number &lt;&gt; 0 Then\n        Debug.Print Err.Number, Err.Description\n        MsgBox \"Download failed\"\n    End If\n    DownloadFile = vbNullString\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 3, "last_activity_date": 1553020963, "creation_date": 1553020963, "answer_id": 55248002, "question_id": 55247889, "link": "https://stackoverflow.com/questions/55247889/where-are-office-macros-stored/55248002#55248002", "title": "Where are Office macros stored?", "body": "<p>When you make the file a zip file, you can pull out the vbAProject.bin section...</p>\n\n<p>1)  Make a copy of your file</p>\n\n<p>2)  Rename your copied file extension to .zip</p>\n\n<p>3)  Go into the .zip file</p>\n\n<p>4)  Go into xl folder</p>\n\n<p>5)  Find vbaProject.bin</p>\n\n<p>You can actual create a separate workbook, do the zip thing, and paste in the .bin file... after that, change the extension back to the desired extension and open it.</p>\n\n<p>Similar thing can be done for Word.</p>\n"}], "owner": {"reputation": 77, "user_id": 9329272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638a025af9206ac7d1e9b02099ef69ee?s=128&d=identicon&r=PG&f=1", "display_name": "Crumblez", "link": "https://stackoverflow.com/users/9329272/crumblez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 55248002, "answer_count": 1, "score": 0, "last_activity_date": 1553065990, "creation_date": 1553020498, "last_edit_date": 1553065990, "question_id": 55247889, "link": "https://stackoverflow.com/questions/55247889/where-are-office-macros-stored", "title": "Where are Office macros stored?", "body": "<p>I'm looking to extract Office macros from a malicious .docx file, but I don't want to open the file, even with macros disabled. I'm looking to read the macro from a supplied file and output it to text.</p>\n\n<p>I've seen the OLETools program, but I can't find how they are getting the macros from the file. </p>\n\n<p>Any help on where the macros are located in the file structure would be much appreciated.</p>\n"}, {"tags": ["excel", "vba", "range", "move"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1553020231, "post_id": 55247742, "comment_id": 97228277, "body": "Welcome to SO. Your code looks fine, I suspect the problem lies elsewhere. Is there more code? By how much does the file size increase? Have you tried the usual bloat removing tricks? e.g. <a href=\"https://www.techrepublic.com/blog/microsoft-office/how-to-recover-from-excel-workbook-bloat/\" rel=\"nofollow noreferrer\">techrepublic.com/blog/microsoft-office/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11217663"}, "edited": false, "score": 0, "creation_date": 1553020820, "post_id": 55247742, "comment_id": 97228581, "body": "Why aren&#39;t you inserting (with CopyOrigin:=xlFormatFromRightOrBelow)  31 new columns for each new month?"}, {"owner": {"reputation": 1, "user_id": 11029971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3a07f54d28dff96d92f83b54f1a89b?s=128&d=identicon&r=PG&f=1", "display_name": "Shreesha Sanjaya", "link": "https://stackoverflow.com/users/11029971/shreesha-sanjaya"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1553021231, "post_id": 55247742, "comment_id": 97228790, "body": "@Absinthe Thanks for the welcome! That is the majority of my code... I have a few extra lines on copying everything into a separate tab first for my &quot;undo&quot; code to use. File sizes start off around 100kb initially and reaches 300-400kb when it starts to crawl to a halt. Its not just the code that slows down, the whole spreadsheet gets very hard to use."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1553021494, "post_id": 55247742, "comment_id": 97228898, "body": "Best to post all your code, just in case - very often problems are caused by sections of code that appear unrelated. Are there many formulas in the workbook? Does turning off automatic calculation help? And are you using xlsm or xls file format?"}, {"owner": {"reputation": 1, "user_id": 11029971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3a07f54d28dff96d92f83b54f1a89b?s=128&d=identicon&r=PG&f=1", "display_name": "Shreesha Sanjaya", "link": "https://stackoverflow.com/users/11029971/shreesha-sanjaya"}, "edited": false, "score": 0, "creation_date": 1553021585, "post_id": 55247742, "comment_id": 97228951, "body": "@user11217663 The spreadsheet itself was created by someone else and includes a lot of formulas that go over my head, so I&#39;m trying to not mess with the layout more than I have to. From what I understand a running count for the past year of sick days is desired therefore my idea of shuffling the data back one month rather than inserting new columns."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1553021607, "post_id": 55247742, "comment_id": 97228964, "body": "Try using the Variant Array approach ie <code>DestRange.Value = SourceRange.Valie</code>"}, {"owner": {"reputation": 1, "user_id": 11029971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3a07f54d28dff96d92f83b54f1a89b?s=128&d=identicon&r=PG&f=1", "display_name": "Shreesha Sanjaya", "link": "https://stackoverflow.com/users/11029971/shreesha-sanjaya"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1553022632, "post_id": 55247742, "comment_id": 97229501, "body": "@Absinthe I updated the original post with the rest of my code. @chris neilsen I think I already tried what you are talking about. I tried doing <code>Sheets(1).Range(C1 &amp; &quot;:&quot; &amp; C7).Value = Sheets(1).Range(C2 &amp; &quot;:&quot; &amp; C8).Value</code> . The problem with that is it did not also copy over the comments and formatting like the above code does."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11029971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3a07f54d28dff96d92f83b54f1a89b?s=128&d=identicon&r=PG&f=1", "display_name": "Shreesha Sanjaya", "link": "https://stackoverflow.com/users/11029971/shreesha-sanjaya"}, "is_accepted": true, "score": 0, "last_activity_date": 1554213073, "creation_date": 1554213073, "answer_id": 55476512, "question_id": 55247742, "link": "https://stackoverflow.com/questions/55247742/excel-vba-range-copy-increasing-filesize-and-causing-slowdowns/55476512#55476512", "title": "Excel VBA - Range.Copy Increasing filesize and causing slowdowns", "body": "<p>Thanks to all the help I got from the answers to this post and some extra analysis of the spreadsheet I was working on, I believe I've found a way to achieve the desired results without the slowdown and file size increase I was experiencing. I figured it would be a good idea to post my results here in case anyone else faces the same problems.</p>\n\n<p>The root problem causing the slowdown and file size increase was not the code itself but the way the spreadsheet itself was laid out, like @Absinthe suggested. There was conditional formatting rules in the data entry section of the calendar to color in dates that were weekends, holidays etc. The problems I was facing stemmed from the fact that the initial code in the original post was copying everything including the conditional formatting rules back 31 cells. </p>\n\n<p>Since it looked like the copy command was overwriting data in the first month, I thought it would be redundant to delete the contents of that month, however the conditional formatting rules were just stacking on top of each other every time the code was run. This lead to a snowball effect since the number of conditional formatting rules in the starting months would increase exponentially. This did not strike me as being an issue, since I was not fully aware of how the formatting rules worked and was under the assumption that they were tied to a cell and would not be copied by the copy command.</p>\n\n<p>To get around this issue, I used a combination of <code>sheets.range.value=sheets.range.value</code> and <code>sheets.range.copy</code> <code>sheets.range.paste special xlPasteComments</code> to result in the following code. (C1 to C8 are corner points of the calendar which is illustrated in the photo attached to the original post)</p>\n\n<pre><code>With Application\n.ScreenUpdating = False\n.EnableEvents = False\n.Calculation = xlCalculationManual\nEnd With\n\n'Copying entire calender into undo tab for the undo subroutine to use\nSheets(4).Range(C1 &amp; \":\" &amp; C8).ClearContents\nSheets(4).Range(C1 &amp; \":\" &amp; C8).ClearComments\nSheets(4).Range(C1 &amp; \":\" &amp; C8).Value = Sheets(1).Range(C1 &amp; \":\" &amp; C8).Value\nSheets(1).Range(C1 &amp; \":\" &amp; C8).Copy\nSheets(4).Range(C1).PasteSpecial xlPasteComments\nApplication.CutCopyMode = False\n\n'Moving the \"moving zone\" months 31 cells to the left\nSheets(1).Range(C1 &amp; \":\" &amp; C6).ClearContents\nSheets(1).Range(C1 &amp; \":\" &amp; C6).ClearComments\nSheets(1).Range(C2 &amp; \":\" &amp; C8).Copy\nSheets(1).Range(C1).PasteSpecial xlPasteValues\nSheets(1).Range(C2 &amp; \":\" &amp; C8).Copy\nSheets(1).Range(C1).PasteSpecial xlPasteComments\nApplication.CutCopyMode = False\n\n'Clearing the last month to make room for new information\nSheets(1).Range(C3 &amp; \":\" &amp; C8).ClearContents\nSheets(1).Range(C3 &amp; \":\" &amp; C8).ClearComments\n\nWith Application\n.ScreenUpdating = True\n.EnableEvents = True\n.Calculation = xlCalculationAutomatic\nEnd With\n</code></pre>\n\n<p>The with loops at the start and end is something that seems to speed up code by not updating the screen while the code is running. </p>\n\n<p>I'm certain that this is very sloppy code, but in its current form it only copies the values and comments while leaving the conditional formatting rules untouched. I've tested running the subroutine a few dozen times and the execution time and file size don't change significantly from run to run.</p>\n"}], "owner": {"reputation": 1, "user_id": 11029971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3a07f54d28dff96d92f83b54f1a89b?s=128&d=identicon&r=PG&f=1", "display_name": "Shreesha Sanjaya", "link": "https://stackoverflow.com/users/11029971/shreesha-sanjaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 55476512, "answer_count": 1, "score": 0, "last_activity_date": 1554213073, "creation_date": 1553019992, "last_edit_date": 1553022291, "question_id": 55247742, "link": "https://stackoverflow.com/questions/55247742/excel-vba-range-copy-increasing-filesize-and-causing-slowdowns", "title": "Excel VBA - Range.Copy Increasing filesize and causing slowdowns", "body": "<p>From the title my problem may sound obvious, but hear me out.</p>\n\n<p>I'm working on a spreadsheet that tracks sick days for employees and its laid out with the rows being employee name and the columns being each day of the year. </p>\n\n<p>I'm working on a macro that shifts the data back by one month allowing for new data to be entered. My current order of operations is to copy the data (2nd month to last month) and move it one month to the left, then clear the data in the last month. This <a href=\"https://i.stack.imgur.com/oH4a7.png\" rel=\"nofollow noreferrer\">photo</a> might explain it better.</p>\n\n<p>Due to this layout, I'm moving an array of data that is roughly 50 rows by 330 columns. So far I've been using the following code and functionality wise, it is working as intended:</p>\n\n<p>(C1 to C8 are corner points of the calendar as illustrated in the photo)</p>\n\n<p>Main subroutine:</p>\n\n<pre><code>'Copying entire calender into undo tab for the undo subroutine to use\nSheets(1).Range(C1 &amp; \":\" &amp; C8).Copy Sheets(5).Range(C1)\n\n'Moving the \"moving zone\" months 31 cells to the left\nSheets(1).Range(C2 &amp; \":\" &amp; C8).Copy Sheets(1).Range(C1)\n\n'Clearing the last month to make room for new information\nSheets(1).Range(C3 &amp; \":\" &amp; C8).ClearContents\nSheets(1).Range(C3 &amp; \":\" &amp; C8).ClearComments\n</code></pre>\n\n<p>\"Undo\" subroutine:</p>\n\n<pre><code>'Copies information from undo tab back into sheet 1\nSheets(5).Range(C1 &amp; \":\" &amp; C8).Copy Sheets(1).Range(C1)\n</code></pre>\n\n<p>The problem is every time the code is run, the file size gets bigger and the code runs slower. From what I'm aware of this type of Range.Copy does not require the \"Application.CutCopyMode=False\" flag and it did not seem to make a difference when I used it anyways.</p>\n\n<p>The reason I'm using the copy function rather than the cut function is because I want to leave the formatting (borders, colors, etc) untouched at the very right of the calendar. </p>\n\n<p>Would there be a better way of achieving my results, because right now it seems like there is some hidden data as a result of the code execution that's piling up somewhere I cant see.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 2, "creation_date": 1553020133, "post_id": 55247499, "comment_id": 97228227, "body": "Since you&#39;re using this as a teaching tool, why not expose some of the spreadsheet logic to the students as well? You can use a cell as an integer counter (increments by one every time the functions are run, so two per button press), and then use the <code>Offset</code> <a href=\"https://support.office.com/en-us/article/offset-function-c8de19ae-dd79-4b9b-a14e-b4d906d11b66\" rel=\"nofollow noreferrer\">function</a> to set the new values into the column according to the value in the integer counter cell."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 1, "creation_date": 1553020534, "post_id": 55247499, "comment_id": 97228449, "body": "Welcome to SO. Search the web for &#39;Excel VBA find last used row&#39; or similar e.g. <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/7/7/&hellip;</a>. Alternatively as SmrtGrunt suggests use a counter e.g. nextRow = nextRow + 1 after each generation. Use like: &#39;Range(&quot;M&quot; &amp; nextRow) = NewRandom()"}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 2, "last_activity_date": 1553020481, "creation_date": 1553020481, "answer_id": 55247882, "question_id": 55247499, "link": "https://stackoverflow.com/questions/55247499/creating-a-record-for-generated-numbers-in-vba/55247882#55247882", "title": "Creating a record for generated numbers in VBA", "body": "<p>This is just a matter of finding the last row and pasting to it...</p>\n\n<pre><code>dim lr as long\nlr = cells(rows.count,\"U\").end(xlup).row\ncells(lr+1,\"U\").value = randomnumber1\ncells(lr+1,\"V\").value = randomnumber2\n</code></pre>\n\n<p>Assumes you are always having U/V paired together, so only need 1 last row</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 11068028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34320943c84e2ea922fe64767b8d611a?s=128&d=identicon&r=PG&f=1", "display_name": "TinMan464", "link": "https://stackoverflow.com/users/11068028/tinman464"}, "is_accepted": true, "score": 2, "last_activity_date": 1553021653, "last_edit_date": 1553021653, "creation_date": 1553020972, "answer_id": 55248004, "question_id": 55247499, "link": "https://stackoverflow.com/questions/55247499/creating-a-record-for-generated-numbers-in-vba/55248004#55248004", "title": "Creating a record for generated numbers in VBA", "body": "<p>The subroutine below will find the next empty row based on the \"U\" column of your sheet.\nXLROW signifies the row in which you want to begin your search for an empty row.\nOnce the empty row is found, the two random values that you have passed to the subroutine will be entered into the first available empty row.</p>\n\n<p>Make sure to change \"Sheet1\" to the name, if you have one, of the sheet that you are using in excel. </p>\n\n<pre><code>Public Sub NEXTEMPTY(VAL1 As Integer, VAL2 As Integer)\nDim XLROW As Integer\nXLROW = 7\nDo Until Sheet1.Range(\"U\" &amp; XLROW) = \"\"\n    XLROW = XLROW + 1\nLoop\nSheet1.Range(\"U\" &amp; XLROW).Value = VAL1\nSheet1.Range(\"V\" &amp; XLROW).Value = VAL2\nEnd Sub\n</code></pre>\n\n<p>Then you can just call the sub anywhere you'd like using:</p>\n\n<pre><code>Call NEXTEMPTY(RANDOM1, RANDOM2)\n</code></pre>\n\n<p>EDIT:  You can also use this in the Do Until.  This is more preferable.</p>\n\n<pre><code>Do Until IsEmpty(Sheet1.Range(\"U\" &amp; XLROW))\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 9773078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f77a045f9ef556bdd67a5a59a6980c8?s=128&d=identicon&r=PG&f=1", "display_name": "ElementX", "link": "https://stackoverflow.com/users/9773078/elementx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55248004, "answer_count": 2, "score": 0, "last_activity_date": 1556174671, "creation_date": 1553019126, "last_edit_date": 1556174671, "question_id": 55247499, "link": "https://stackoverflow.com/questions/55247499/creating-a-record-for-generated-numbers-in-vba", "title": "Creating a record for generated numbers in VBA", "body": "<p>I'm building an Excel sheet to help me with teaching.</p>\n\n<p>My objective is a sheet to create two random numbers, calculate their arithmetic means and geometric means, and compare them. This part I have finished.</p>\n\n<p>I created a macro and two functions that generates random numbers, then input the numbers to the desired cells:</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"L1\").Value = NewRandom()\n\nSheets(\"Sheet1\").Range(\"M1\").Value = NewRandom2()\n</code></pre>\n\n<p>I created a button to execute the macro.</p>\n\n<p>How could I make a record of what I have been generating, in designated area U7:V200, on the same sheet?</p>\n\n<p>My aim: The first time I click the button, two generated numbers will be recorded on U7 and V7, respectively. The second time I click, two generated numbers will be recorded on U8 and V8, and so on.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553020275, "post_id": 55247485, "comment_id": 97228302, "body": "I thought that a list of values was an array. If I&#39;m wrong, my apologies, and I&#39;ll remove references to that.  Checking your link, now, also."}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553021322, "post_id": 55247485, "comment_id": 97228835, "body": "Stepping through, Access still shows the control as null  Dim frm As Form Dim ctl As Control Dim s As Variant Set frm = Forms!ReportForm Set ctl = frm!CITY  I also don&#39;t know why it&#39;s capitalizing CITY. It&#39;s proper case on the form. Either way, it&#39;s skipping over the For Each, because the control is still reading as Null."}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553021940, "post_id": 55247485, "comment_id": 97229137, "body": "Error - You entered an expression that has an invalid reference to the property ItemsSelected. Now why would it think the reference is invalid?"}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553022283, "post_id": 55247485, "comment_id": 97229298, "body": "It returns type ListBox"}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553023014, "post_id": 55247485, "comment_id": 97229676, "body": "Apologies, the <i>actual</i> name is COUNTY. I just used &quot;City&quot; to be obscure. But, being obscure is too much of a headache to maintain. That said Yes, TypeName(Forms!ReportForm!COUNTY) is listbox, and Forms!ReportForm!COUNTY.ItemsSelected.Count complains ItemsSelected is invalid there?"}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553023716, "post_id": 55247485, "comment_id": 97229959, "body": "I have not. I&#39;m reviewing your link, now. I won&#39;t be able to get back to this until tomorrow. Thanks for your help so far."}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1553082334, "post_id": 55247485, "comment_id": 97251195, "body": "Thanks for your efforts, though. Back at it, today."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1553087893, "post_id": 55247485, "comment_id": 97254703, "body": "@JuniperSquared Are you using the report in conjunction with the form, or is it a separate product that you generate afterwards? If you&#39;re displaying the report on the form, it may be easier to filter it in the form after the user updates their selections in the list box using the <code>Report.Filter</code> and <code>Report.FilterOn</code> parameters."}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "edited": false, "score": 0, "creation_date": 1553090436, "post_id": 55247485, "comment_id": 97256372, "body": "It&#39;s a separate product that I generate afterwards. The form is used to compile the list of parameters - in vba - which gets stored in a variable. That variable is plugged into the code for the &quot;GenerateReport - OnClick()&quot; event."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "is_accepted": true, "score": 2, "last_activity_date": 1575418732, "last_edit_date": 1575418732, "creation_date": 1553096628, "answer_id": 55264802, "question_id": 55247485, "link": "https://stackoverflow.com/questions/55247485/ms-access-retrieve-values-from-listbox/55264802#55264802", "title": "MS Access Retrieve Values from ListBox", "body": "<p>THIS took a LOT of breadcrumbs to get me here!</p>\n\n<p>Solution:</p>\n\n<pre><code>Dim s As Variant\nDim i As Integer\nDim ctl As Control\nSet ctl = Me.Counties\n\nIf ctl.ItemsSelected.Count &lt;&gt; 0 Then\n    For Each s In ctl.ItemsSelected\n        t.WhereCondition = ctl.ItemData(s) &amp; \" = -1\"\n    Next s\nEnd If\n</code></pre>\n\n<ol>\n<li><p>I had to rename the control from County to Counties. Looks like the former was part of the report, and screwing everything else up. I did this after initially deleting &amp; re-adding the control.</p></li>\n<li><p>The comments here <em>really</em> helped. I just needed to figure out how to work with the properties in order to get what I wanted.</p></li>\n<li><p>I have to compare 70 yes/no fields to the data, pulling out only those that return True. Hence the -1.</p></li>\n</ol>\n\n<p>It compiles. It runs. Fingers crossed for data accuracy.</p>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2622, "favorite_count": 0, "accepted_answer_id": 55264802, "answer_count": 1, "score": 1, "last_activity_date": 1594278618, "creation_date": 1553019075, "last_edit_date": 1594278618, "question_id": 55247485, "link": "https://stackoverflow.com/questions/55247485/ms-access-retrieve-values-from-listbox", "title": "MS Access Retrieve Values from ListBox", "body": "<p>UPDATE: 3/20/2019\nAfter subthread conversation (below), I renamed the ListBox. ItemsSelected property WORKS. Value still returning NULL int he code</p>\n\n<hr>\n\n<p>This is my first time dealing with multi-select lists in Access. I have a report form with some dropdowns, checkboxes, and a listbox. The listbox contains almost 70 items - Let's call them \"Cities\".</p>\n\n<p>The ListBox allows multiple selections. In VBA, I'm taking each of the parameters - from the other controls on the form, to create a giant WHERE condition that feeds my report.</p>\n\n<p>The problem is that Access is not reading the values selected from the ListBox. When I step through that line of code, the value is NULL.</p>\n\n<p>So far:</p>\n\n<pre><code>Dim s As Variant\ns = Me.City.Value &amp; \"\" \n</code></pre>\n\n<p>This is where I know I wrong-turned, but, not having dealt with a multi-select ListBox before, I don't know the syntax to get the values read.</p>\n\n<p>Next: Check for whether or not values are selected in List \"s\":</p>\n\n<pre><code>If s &lt;&gt; \"\" Then\n</code></pre>\n\n<p>Check for other parameters in the current WHERE condition. IF none exist, THEN</p>\n\n<pre><code>If c.WhereCondition = \"\" Then\nc.WhereCondition =\n</code></pre>\n\n<p>Set WHERE Condition by comparing List values (which are Strings) to the Yes/No values of equivalent fields in Source table. </p>\n\n<p>I have to compare the List values to the 70 fields in the table - to pull out those records that match. </p>\n\n<p>No, there's not 1 field - say Cities, with 70 possible values. Instead, each of the 70 possible Cities is its own Yes/No field. I inherited this DB. It's how it was built.</p>\n\n<p>Currently, my attempt at this looks like:</p>\n\n<pre><code>c.WhereCondition = \"( City1 = -1 OR City2 = -1 OR City3 = -1 OR .....)\n</code></pre>\n\n<p>`IF there are parameters in the current WHERE clause, THEN compare values in List to Source table, AND APPEND result to WHERE condition with \"AND\"</p>\n\n<pre><code>ELSE\n       c.WhereCondition = c.WhereCondition &amp; \" AND (City1 = -1 OR City2 = -1, OR ...)\n\n    End If\n    End If\n</code></pre>\n\n<p>I hope I was able to explain this well enough. The 1st problem is getting the values read. I won't know if my attempt at comparison is right or wrong without that.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1553017892, "post_id": 55246828, "comment_id": 97227135, "body": "What is the qualification for the dot notation?  i would assume you have workbook.worksheet.shapes.chart... which means that your re-use of workbook.worsheet is an issue"}, {"owner": {"reputation": 3, "user_id": 11227769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffcdb4c36c17d2b33bb3f2d3a890028e?s=128&d=identicon&r=PG&f=1", "display_name": "lea", "link": "https://stackoverflow.com/users/11227769/lea"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1553071861, "post_id": 55246828, "comment_id": 97244990, "body": "Thank you for your answer. I have a with block <code>With MySlide.Shapes.Item(&quot;CHT_1&quot;)</code>. Is it wrong ?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11227769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffcdb4c36c17d2b33bb3f2d3a890028e?s=128&d=identicon&r=PG&f=1", "display_name": "lea", "link": "https://stackoverflow.com/users/11227769/lea"}, "edited": false, "score": 0, "creation_date": 1553095738, "post_id": 55262119, "comment_id": 97260315, "body": "I don&#39;t want to use the value of B1 and C1 cells. I was trying to rewrite them because it seems to be these headers used as series names. My chart data are not coming from an excel file. It&#39;s an embedded chart in powerpoint. I don&#39;t have any error when running both scenarii. Tell me if something is unclear."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 3, "user_id": 11227769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffcdb4c36c17d2b33bb3f2d3a890028e?s=128&d=identicon&r=PG&f=1", "display_name": "lea", "link": "https://stackoverflow.com/users/11227769/lea"}, "edited": false, "score": 0, "creation_date": 1553099108, "post_id": 55262119, "comment_id": 97262675, "body": "@lea you&#39;re trying to overwrite Excel cell values with the names of the series?  I&#39;ll fix that code to go in the opposite direction."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1553099444, "last_edit_date": 1553099444, "creation_date": 1553089246, "answer_id": 55262119, "question_id": 55246828, "link": "https://stackoverflow.com/questions/55246828/update-several-chart-series-name/55262119#55262119", "title": "Update several chart series name", "body": "<p>This may not be your full answer, but may help with understanding the request.</p>\n\n<p>lea, your with block seems correct for working within PPT, though your use of Excel has... some issues.  From what you're writing, there is a signfiicant breakdown:  </p>\n\n<pre><code>.Chart.ChartData.Workbook.Worksheets(1).Range(\"B1\").Value = \"Name 1\"\n</code></pre>\n\n<p>My assumption is that you want Excel range B1 to be the name for Series 1, and C1 to be Series 2.  I believe you want to work with the series collection:</p>\n\n<pre><code>.SeriesCollection(1).Name = fpath &amp; \"\\\" &amp; \"[WorkbookName.xlsx]Sheet1!B1\"\n.SeriesCollection(2).Name = fpath &amp; \"\\\" &amp; \"[WorkbookName.xlsx]Sheet1!C1\"\n</code></pre>\n\n<p>Where fpath is the folder path for the workbook.</p>\n\n<p>I would wonder why you're not getting an error on #2 (or are you?  if so, please state the error code), unless you have On Error Resume Next in your code, or some other type of error handling.</p>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Fixing the Excel file to overwrite a value based on the series name of the chart Series name (assumes Excel file is open, otherwise open it):</p>\n\n<pre><code>Workbooks(\"NAme\").Sheets(\"Name\").Range(\"B1\").Value = .SeriesCollection(1).Name\nWorkbooks(\"NAme\").Sheets(\"Name\").Range(\"C1\").Value = .SeriesCollection(2).Name\n</code></pre>\n\n<p>Regarding selecting/modifying the source data using the Presentation, can you please post your related code for generation of the series data into your post?  Depending on how it is being generated may be an issue (e.g., if you use \"new series (1)\" twice, that could be a problem, etc.).</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11227769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffcdb4c36c17d2b33bb3f2d3a890028e?s=128&d=identicon&r=PG&f=1", "display_name": "lea", "link": "https://stackoverflow.com/users/11227769/lea"}, "is_accepted": false, "score": 0, "last_activity_date": 1553163585, "creation_date": 1553163585, "answer_id": 55278207, "question_id": 55246828, "link": "https://stackoverflow.com/questions/55246828/update-several-chart-series-name/55278207#55278207", "title": "Update several chart series name", "body": "<p>Here is an example (just add a barchart in a presentation pptm) :</p>\n\n<pre><code>Sub main()\n\nWith ActivePresentation.Slides(1).Shapes(\"CHT\").chart\n    .ChartData.Workbook.worksheets(1).Range(\"B4\") = 999\n    .ChartData.Workbook.worksheets(1).Range(\"B1\").Value = \"Name 1\"\n    .ChartData.Workbook.worksheets(1).Range(\"C1\").Value = \"Name 2\"\nEnd With\n\nActivePresentation.Save\n\nEnd Sub\n</code></pre>\n\n<p>After that if you try to click to select data, it doesn't work (just waiting cursor). \nNot sure (maybe i'm just doing something the wrong way, that's the point), but it looks like a bug to me because i tried to run it again and had an error message \"Method workbook object chartdata failed\"... Chartdata window seems to be unavailable.</p>\n"}], "owner": {"reputation": 3, "user_id": 11227769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffcdb4c36c17d2b33bb3f2d3a890028e?s=128&d=identicon&r=PG&f=1", "display_name": "lea", "link": "https://stackoverflow.com/users/11227769/lea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553163585, "creation_date": 1553016543, "last_edit_date": 1553017708, "question_id": 55246828, "link": "https://stackoverflow.com/questions/55246828/update-several-chart-series-name", "title": "Update several chart series name", "body": "<p>I'm trying to update a series name in a chart legend with VBA. I have tried 2 ways and both work. But a problem occurs when I try to select or modify data with click mode in my presentation.</p>\n\n<p>1.</p>\n\n<pre><code>.Chart.SeriesCollection(1).Name = \"Name 1\"\n.Chart.SeriesCollection(2).Name = \"Name 2\"\n</code></pre>\n\n<p>When I click to modify data, legend is automatically changed by <code>Serie1</code> and <code>Serie2</code>. This doesn't happen when only one serie is set with VBA (i.e. one line is commented out).</p>\n\n<p>2.</p>\n\n<pre><code>.Chart.ChartData.Workbook.Worksheets(1).Range(\"B1\").Value = \"Name 1\"\n.Chart.ChartData.Workbook.Worksheets(1).Range(\"C1\").Value = \"Name 2\"\n</code></pre>\n\n<p>This time, I can't open Excel data window. Nothing happens (no errors or messages but wait cursor briefly appear).</p>\n"}, {"tags": ["vba", "matlab"], "comments": [{"owner": {"reputation": 587, "user_id": 5489190, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tjkTd.png?s=128&g=1", "display_name": "Karls", "link": "https://stackoverflow.com/users/5489190/karls"}, "edited": false, "score": 0, "creation_date": 1553016246, "post_id": 55246700, "comment_id": 97226250, "body": "What&#39;s your input and desired output? Give us some details. MATLAB support strings so you don&#39;t need to turn anything."}, {"owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "edited": false, "score": 0, "creation_date": 1553670795, "post_id": 55246700, "comment_id": 97465589, "body": "The question is drafted carelessly. No info given"}, {"owner": {"reputation": 311, "user_id": 11226789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPSOV.jpg?s=128&g=1", "display_name": "medicine_man", "link": "https://stackoverflow.com/users/11226789/medicine-man"}, "edited": false, "score": 0, "creation_date": 1553780731, "post_id": 55246700, "comment_id": 97518583, "body": "It&#39;s a simple question, not much information is needed to answer."}], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 9864503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5356b5bd50ddc927b72e659f83bcdf64?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/9864503/robert"}, "edited": false, "score": 0, "creation_date": 1555963032, "post_id": 55247003, "comment_id": 98269512, "body": "If I&#39;m not mistaken, the <code>contains</code> function does not accept wildcards like &#39;?&#39;, or other regular expression syntax."}], "tags": [], "owner": {"reputation": 311, "user_id": 11226789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPSOV.jpg?s=128&g=1", "display_name": "medicine_man", "link": "https://stackoverflow.com/users/11226789/medicine-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1555953527, "last_edit_date": 1555953527, "creation_date": 1553017221, "answer_id": 55247003, "question_id": 55246700, "link": "https://stackoverflow.com/questions/55246700/vbas-like-function-in-matlab/55247003#55247003", "title": "VBA&#39;s &quot;Like&quot; function in MATLAB", "body": "<p>The MATLAB function <a href=\"https://www.mathworks.com/help/matlab/ref/contains.html\" rel=\"nofollow noreferrer\">contains</a> is what can be used as <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference//operators/like-operator\" rel=\"nofollow noreferrer\">Like</a> is used in VBA.</p>\n\n<p><em>Do note that</em> <code>contains</code> <em>was introduced into MATLAB 2016b.</em></p>\n"}, {"tags": [], "owner": {"reputation": 555, "user_id": 9864503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5356b5bd50ddc927b72e659f83bcdf64?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/9864503/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1555962940, "last_edit_date": 1592644375, "creation_date": 1555962940, "answer_id": 55800322, "question_id": 55246700, "link": "https://stackoverflow.com/questions/55246700/vbas-like-function-in-matlab/55800322#55800322", "title": "VBA&#39;s &quot;Like&quot; function in MATLAB", "body": "<p>You may want to look at string matching with <a href=\"https://www.mathworks.com/help/matlab/ref/regexp.html\" rel=\"nofollow noreferrer\">regular expressions</a> (&quot;regexp&quot;).  Note that the regexp syntax used by Matlab differs from the one used in VBA.  In your example, the '.' takes the role of the '?' wildcard, so that you could do</p>\n<pre><code>str1 = 'aabb'; % Match\nstr2 = 'abab'; % No match\n\nif isempty(regexp(str1, '.ab.'))\n  disp('str1 is no match');\nelse\n  disp('str1 is a match');\nend\n\nif isempty(regexp(str2, '.ab.'))\n  disp('str2 is no match');\nelse\n  disp('str2 is a match');\nend\n</code></pre>\n<p>and the output you should get is</p>\n<blockquote>\n<p>str1 is a match</p>\n<p>str2 is no match</p>\n</blockquote>\n"}], "owner": {"reputation": 9, "user_id": 11227885, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VK6ti822FdY/AAAAAAAAAAI/AAAAAAAAAFY/u36vewyrppk/photo.jpg?sz=128", "display_name": "joe", "link": "https://stackoverflow.com/users/11227885/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55247003, "answer_count": 2, "score": -3, "last_activity_date": 1555962940, "creation_date": 1553016082, "question_id": 55246700, "link": "https://stackoverflow.com/questions/55246700/vbas-like-function-in-matlab", "title": "VBA&#39;s &quot;Like&quot; function in MATLAB", "body": "<p>How would i turn something such as </p>\n\n<p>str1 Like \"?<em>ab</em>?\" </p>\n\n<p>into MATLAB?</p>\n"}, {"tags": ["excel", "vba", "autofill", "real-time-updates"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553015827, "post_id": 55246602, "comment_id": 97226056, "body": "Where should VBA find the year?"}, {"owner": {"reputation": 91, "user_id": 10294974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_MjbvICZ58I/AAAAAAAAAAI/AAAAAAAAAZY/E2T1RnoiLtw/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/10294974/max"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553016236, "post_id": 55246602, "comment_id": 97226247, "body": "Could it be referenced from a given cell ? Something like &quot;typed number&quot; &amp; &quot;cell reference for month (eg. 1)&quot; &amp; &quot;cell reference for year (eg. 2019)&quot;. I&#39;m quite new to vba so besides the logic, I can&#39;t say if it&#39;s really achievable."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1553027120, "post_id": 55246602, "comment_id": 97231536, "body": "Did you just give up on <a href=\"https://stackoverflow.com/a/55033639/9245853\">my answer</a> to the same <a href=\"https://stackoverflow.com/questions/55032836/autofill-date-by-referring-only-one-number-with-excel-vba\">question</a> you previously asked :) ?"}, {"owner": {"reputation": 91, "user_id": 10294974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_MjbvICZ58I/AAAAAAAAAAI/AAAAAAAAAZY/E2T1RnoiLtw/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/10294974/max"}, "edited": false, "score": 0, "creation_date": 1553028634, "post_id": 55246602, "comment_id": 97232225, "body": "Oh. I actually forgot I already posted about that!! You can see how much I have missed this feature. Indeed I couldn&#39;t figure out your answer due to my basic skills and could not overcome some errors."}], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553016453, "post_id": 55246724, "comment_id": 97226369, "body": "I&#39;m sorry but aren&#39;t you hardcoding the month? shouldn&#39;t it take the month from the sheet index, name or whatever?"}, {"owner": {"reputation": 91, "user_id": 10294974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_MjbvICZ58I/AAAAAAAAAAI/AAAAAAAAAZY/E2T1RnoiLtw/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/10294974/max"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553016685, "post_id": 55246724, "comment_id": 97226499, "body": "Impressive. I agree with @Damian, this could improve flexibility for users with different needs than mine, but it&#39;s a great start. Also, when I change another cell in the sheet, macro has an error at the line =&gt; If Not AffectedRange Then. Any idea why it&#39;s affecting range outside of &quot;A:A&quot; ?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1553027247, "post_id": 55246724, "comment_id": 97231585, "body": "If I can suggest one simplification - <code>Target.Parent</code> is the same as <code>Me</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553031219, "post_id": 55246724, "comment_id": 97233190, "body": "@Damian Yes, I hard coded the month, I thought the idea was pretty clear and the OP was pretty unclear about how the sheet was named. So I decided to leave it like that."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1553031304, "post_id": 55246724, "comment_id": 97233209, "body": "@Asger &amp; Max Yes you are right, thanks. I was in a rush when posting it. I accepted the edit."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1553031367, "post_id": 55246724, "comment_id": 97233243, "body": "@BigBen Yes, of course that would make sense too ;)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1553031392, "last_edit_date": 1553031392, "creation_date": 1553016158, "answer_id": 55246724, "question_id": 55246602, "link": "https://stackoverflow.com/questions/55246602/fill-date-jj-mm-yyyy-only-by-entering-the-day-jj/55246724#55246724", "title": "Fill date (jj/mm/yyyy) only by entering the day (jj)", "body": "<pre><code>Option Explicit    \n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim AffectedRange As Range\n    Set AffectedRange = Application.Intersect(Me.Range(\"A:A\"), Target)\n\n    If Not AffectedRange Is Nothing Then\n        Dim Cell As Range\n        For Each Cell In AffectedRange.Cells\n            If Cell.Value &gt;= 1 And Cell.Value &lt;= 31 Then\n                Application.EnableEvents = False\n                Cell.Value = DateSerial(2019, 1, Cell.Value)\n                Cell.NumberFormat = \"YYYY-MM-DD\"\n                Application.EnableEvents = True\n            End If\n        Next Cell\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1553016225, "creation_date": 1553016225, "answer_id": 55246743, "question_id": 55246602, "link": "https://stackoverflow.com/questions/55246602/fill-date-jj-mm-yyyy-only-by-entering-the-day-jj/55246743#55246743", "title": "Fill date (jj/mm/yyyy) only by entering the day (jj)", "body": "<p>Try</p>\n\n<pre><code>If Target.value2 &gt; 0 and Target.value2 &lt;= 31 Then\n   Target.Value2 = dateSerial(year(now), month(now), Target.Value2)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 10294974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_MjbvICZ58I/AAAAAAAAAAI/AAAAAAAAAZY/E2T1RnoiLtw/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/10294974/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 55246724, "answer_count": 2, "score": 0, "last_activity_date": 1553031392, "creation_date": 1553015680, "last_edit_date": 1553015693, "question_id": 55246602, "link": "https://stackoverflow.com/questions/55246602/fill-date-jj-mm-yyyy-only-by-entering-the-day-jj", "title": "Fill date (jj/mm/yyyy) only by entering the day (jj)", "body": "<p>I have 12 sheets for 12 months with random monthly dates to manually enter in column A. Let's take the month of January as an example:</p>\n\n<p>When I enter the number <strong><em>25</em></strong> in cell A1, I'd like the cell to automatically return <strong><em>25/01/2019</em></strong> in A1 (!) (or 01/25/2019, as you like). Excel autofill features can't do that to my knowledge even with custom settings, so I guess : VBA ? </p>\n\n<p>I think the code should look something like this (with change event):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range, cell As Range\n    Set rng = Range(\"A:A\")\n    If Not Application.Intersect(rng, Range(Target.Address)) _\n           Is Nothing Then\n\n           '???\n           'If cell entered in range is a number Then\n           'change value to \"number\" &amp; \"/01/2019\" \n\n    End If\nEnd Sub\n</code></pre>\n\n<p>That's where I am at. I'm pretty sure this could be a useful piece of code for people working with month and entering many dates. I'm I far from the truth ? Is it even do-able ? I understand it might be more complicated than it sounds. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553013718, "post_id": 55245976, "comment_id": 97224943, "body": "You haven&#39;t defined <code>cell</code>. Do you mean <code>hotel</code>?"}, {"owner": {"reputation": 75, "user_id": 9612168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37eba351f0f42c3098dee8666f7b4cd7?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriela", "link": "https://stackoverflow.com/users/9612168/gabriela"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553013995, "post_id": 55245976, "comment_id": 97225086, "body": "Which cell do you mean? I am trying to find the location of the MonthCell variable in another workbook and will offset from there"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1553014095, "post_id": 55245976, "comment_id": 97225132, "body": "@Gabriela <code>coll.Add cell.Value, CStr(cell.Value)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553014107, "post_id": 55245976, "comment_id": 97225134, "body": "<code>coll.Add cell.Value, CStr(cell.Value)</code>. Your On Errors are just masking problems."}, {"owner": {"reputation": 75, "user_id": 9612168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37eba351f0f42c3098dee8666f7b4cd7?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriela", "link": "https://stackoverflow.com/users/9612168/gabriela"}, "edited": false, "score": 0, "creation_date": 1553014301, "post_id": 55245976, "comment_id": 97225248, "body": "sorry for my dumb question, but how would i incorporate this into my code?"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1553014381, "post_id": 55245976, "comment_id": 97225292, "body": "You should avoid using VBA commands as variables,i.e. <code>Month</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1553015001, "post_id": 55245976, "comment_id": 97225621, "body": "Incorporate what into your code?"}, {"owner": {"reputation": 75, "user_id": 9612168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37eba351f0f42c3098dee8666f7b4cd7?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriela", "link": "https://stackoverflow.com/users/9612168/gabriela"}, "edited": false, "score": 0, "creation_date": 1553015023, "post_id": 55245976, "comment_id": 97225635, "body": "coll.Add cell.Value, CStr(cell.Value)"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1553015446, "post_id": 55245976, "comment_id": 97225858, "body": "@Gabriela It&#39;s <i>already</i> in your code, between <code>On Error Resume Next</code> and <code>On Error GoTo 0</code> - but you haven&#39;t assigned any value to <code>cell</code>, so it is <code>Nothing</code>.  Add the line <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a> to the top of your module, then go &quot;Debug&quot; &gt; &quot;Compile VBA Project&quot; in the menu.  <b>Then</b> go &quot;Tools&quot; &gt; &quot;Options&quot; &gt; &quot;Require Variable Declaration&quot; and never turn that setting off.  (Also, you seem to have some lines of code that are cut up funny, or squashed into each other)"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1553028222, "creation_date": 1553028222, "answer_id": 55249674, "question_id": 55245976, "link": "https://stackoverflow.com/questions/55245976/finding-dynamic-variable-in-a-list-vba/55249674#55249674", "title": "Finding Dynamic Variable in a list VBA", "body": "<p>The below code loop all sheets and search for variable called SearchValue. At the end populate a message box with all relevant matches.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n    Dim SearchValue As String, FullReport As String\n    Dim Position As Range\n\n    SearchValue = \"Test\"\n\n    For Each ws In ThisWorkbook.Worksheets\n\n        Set Position = ws.UsedRange.Find(SearchValue)\n\n        If Not Position Is Nothing Then\n            If FullReport = \"\" Then\n                FullReport = \"The word \" &amp; SearchValue &amp; \" appears in \" &amp; ws.Name &amp; \", \" &amp; \"Column \" &amp; Position.Column &amp; \" and row \" &amp; Position.Row &amp; \".\"\n            Else\n                FullReport = FullReport &amp; vbNewLine &amp; \"The word \" &amp; SearchValue &amp; \" appears in \" &amp; ws.Name &amp; \", \" &amp; \"Column \" &amp; Position.Column &amp; \" and row \" &amp; Position.Row &amp; \".\"\n            End If\n        End If\n\n    Next ws\n\n    MsgBox FullReport\n\nEnd Sub\n</code></pre>\n\n<p><strong>Results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/JxTDV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JxTDV.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 75, "user_id": 9612168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37eba351f0f42c3098dee8666f7b4cd7?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriela", "link": "https://stackoverflow.com/users/9612168/gabriela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553028222, "creation_date": 1553013589, "last_edit_date": 1553013875, "question_id": 55245976, "link": "https://stackoverflow.com/questions/55245976/finding-dynamic-variable-in-a-list-vba", "title": "Finding Dynamic Variable in a list VBA", "body": "<p>I am trying to find the value of a variable (MonthCell) in a different workbook. The variable I am trying to find is within a list. When I run the below code the Month variable remains empty, even though there should be a match. What am I doing wrong?</p>\n\n<pre><code>Sub CreateAList()\n\nDim ws As Worksheet\nDim wb As Workbook\nDim LastRow As Long\nDim coll As Collection\nDim Hotel As Excel.Range\nDim arr() As String\nDim i As Long\nDim MyFiles As String, ThisMonth As String\nDim startPath As String\nDim WhereCell As Range\nDim Month As Range\n\nSet ws = Application.Workbooks(\"Booking Pace - Test \nTool.xlsm\").Sheets(\"Forecast\") startPath = \n\"C:\\Users\\gborner\\Documents\\Projects\\\"\n\nWith ws\nLastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nSet coll = New Collection\nFor Each Hotel In .Range(\"A6:A\" &amp; LastRow)\n    On Error Resume Next\n    coll.Add cell.Value, CStr(cell.Value)\n    On Error GoTo 0\n\n    Set WhereCell = ThisWorkbook.ActiveSheet.Range(\"A6:A200\").Find(Hotel, \n    LookAt:=xlPart)\n    Set MonthCell = ThisWorkbook.ActiveSheet.Range(\"B3\")\n\n    MyFiles = Dir(startPath &amp; \"*\" &amp; Hotel &amp; \"*.*\")\n\n    'Do While MyFiles &lt;&gt; \"\"\n\n        On Error Resume Next\n    Application.AskToUpdateLinks = False\n    Application.DisplayAlerts = False\n    Workbooks.Open startPath &amp; MyFiles\n\n    Set Month = ThisWorkbook.Sheets(\"Budget\").Find(MonthCell, \n    LookIn:=xlValues)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1553013952, "post_id": 55245957, "comment_id": 97225062, "body": "In your example, what is the sheet name that you would use instead of SDLC?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1553013994, "post_id": 55245957, "comment_id": 97225085, "body": "Simple solution would be to: everytime you add a sheet, add the name to a <code>dictionary</code>. Then just before you attempt to add a sheet, check the <code>dictionary</code> for the name and if it exists, don&#39;t add it"}, {"owner": {"reputation": 1544, "user_id": 1928597, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/oArrE.jpg?s=128&g=1", "display_name": "Jishan", "link": "https://stackoverflow.com/users/1928597/jishan"}, "reply_to_user": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "edited": false, "score": 0, "creation_date": 1553014230, "post_id": 55245957, "comment_id": 97225211, "body": "@Daniel Actually, I will have repeating genres, so making them unique does not make sense."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 1, "creation_date": 1553021228, "post_id": 55245957, "comment_id": 97228786, "body": "Need a bit more info I think. can you only use genre for sheet names? Do you want to add all entries as sheets or do you want to avoid duplicates? Can you not just suffix the query id to the genre?"}, {"owner": {"reputation": 1544, "user_id": 1928597, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/oArrE.jpg?s=128&g=1", "display_name": "Jishan", "link": "https://stackoverflow.com/users/1928597/jishan"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1553025264, "post_id": 55245957, "comment_id": 97230713, "body": "@Absinthe I want to avoid duplicates and I can only use genres as sheet names."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1553032791, "last_edit_date": 1553032791, "creation_date": 1553025823, "answer_id": 55249156, "question_id": 55245957, "link": "https://stackoverflow.com/questions/55245957/unique-node-values-using-oxmlfile-selectnodes/55249156#55249156", "title": "Unique Node Values using oXMLFile.SelectNodes", "body": "<p>Update your sheet creation code so it doesn't try to create duplicate sheets:</p>\n\n<pre><code>Private Sub CreateSheet(sheetName)\n    Dim ws As Worksheet\n\n    On Error Resume Next '&lt;&lt; ignore error if sheet doesn't exist\n    Set ws = ThisWorkbook.Sheets(sheetName)\n    On Error Goto 0      '&lt;&lt; stop ignoring errors\n\n    If ws Is Nothing Then \n        'sheet doesn't exist, so create it.\n        Set ws = ThisWorkbook.Sheets.Add(after:= _\n                 ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n        ws.Name = sheetName\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1544, "user_id": 1928597, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/oArrE.jpg?s=128&g=1", "display_name": "Jishan", "link": "https://stackoverflow.com/users/1928597/jishan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55249156, "answer_count": 1, "score": 0, "last_activity_date": 1553032791, "creation_date": 1553013512, "last_edit_date": 1553013553, "question_id": 55245957, "link": "https://stackoverflow.com/questions/55245957/unique-node-values-using-oxmlfile-selectnodes", "title": "Unique Node Values using oXMLFile.SelectNodes", "body": "<p>So I m dynamically generating my sheet names using the following code, by reading an XML File:</p>\n\n<pre><code>Set GenreNodes = oXMLFile.SelectNodes(\"/catalog/query/genre/text()\")\n.\n.\nPrivate Sub CreateSheet(sheetName)\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets.Add(after:= _\n             ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n    ws.Name = sheetName\nEnd Sub\n</code></pre>\n\n<p>Works perfectly when using XML without repeaing similar genre tags like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;catalog&gt;\n   &lt;query id=\"bk101\"&gt;\n      &lt;question&gt;Do we have cloud security&lt;/question&gt;\n      &lt;answer&gt;Yes&lt;/answer&gt;\n      &lt;genre&gt;Cloud&lt;/genre&gt;\n   &lt;/query&gt;\n   &lt;query id=\"bk102\"&gt;\n      &lt;question&gt;Do we have locks on the door&lt;/question&gt;\n      &lt;answer&gt;No&lt;/answer&gt;\n      &lt;comment&gt;We have fingerprint access.&lt;/comment&gt;\n      &lt;genre&gt;Physical Security&lt;/genre&gt;\n   &lt;/query&gt;\n&lt;/catalog&gt;\n</code></pre>\n\n<p>Problem is, when I have repetitions in genre (SDLC) in this example, like :</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;catalog&gt;\n   &lt;query id=\"bk101\"&gt;\n      &lt;question&gt;Do we have cloud security&lt;/question&gt;\n      &lt;answer&gt;Yes&lt;/answer&gt;\n      &lt;genre&gt;Cloud&lt;/genre&gt;\n   &lt;/query&gt;\n   &lt;query id=\"bk103\"&gt;\n      &lt;question&gt;What SDLC Priciple is follwed?&lt;/question&gt;\n      &lt;answer&gt;None&lt;/answer&gt;\n      &lt;comment&gt;We have code ninjas.&lt;/comment&gt;\n      &lt;genre&gt;SDLC&lt;/genre&gt;\n   &lt;/query&gt;\n   &lt;query id=\"bk104\"&gt;\n      &lt;question&gt;Do you have OSWP status?&lt;/question&gt;\n      &lt;answer&gt;None&lt;/answer&gt;\n      &lt;comment&gt;We plan to do next year.&lt;/comment&gt;\n      &lt;genre&gt;SDLC&lt;/genre&gt;\n   &lt;/query&gt;\n&lt;/catalog&gt;\n</code></pre>\n\n<p>Excel gives me the <code>Name already exists</code> error. How do I extract unique node names that I don't have this error?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1553019623, "post_id": 55246284, "comment_id": 97227984, "body": "I think this is what I needed... I am testing it right now to see if it works... I suspected I needed something like &quot;Application.EnableEvents = False&quot;... Just to be clear... I just need &quot;Application.DisplayAlerts = False&quot; once not twice, right?"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1553020920, "post_id": 55246284, "comment_id": 97228632, "body": "That did not work... I still got the message about not being able to find the file... Now I am trying it with &quot;Application.EnableEvents = False&quot; and &quot;Application.DisplayAlerts = False&quot; listed right after the &quot;On Error GoTo ErrHandler&quot; line... I am thinking the message is popping up before it gets to the ErrHandler"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1553022340, "post_id": 55246284, "comment_id": 97229333, "body": "ok... looks like adding &quot;Application.EnableEvents = False&quot; and &quot;Application.DisplayAlerts = False&quot; right after the &quot;On Error GoTo ErrHandler&quot; line is working... I am a little confused as to whether it is still going to my &quot;ErrHandler&quot; when the error occurs but I think it is... I will do some more checking to make sure..."}], "tags": [], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "is_accepted": true, "score": 0, "last_activity_date": 1553014501, "creation_date": 1553014501, "answer_id": 55246284, "question_id": 55245734, "link": "https://stackoverflow.com/questions/55245734/excel-vba-error-handler-cannot-find-file-how-to-skip-it/55246284#55246284", "title": "Excel VBA Error handler cannot find file... how to skip it?", "body": "<p>If you don't want to click 'OK' and are happy with the risk</p>\n\n<pre><code>ErrHandler:\n\nApplication.DisplayAlerts = False       \nApplication.EnableEvents = False        \n\nWorkbooks.Open Filename:=\"S:\\PED (Production Engineering Department)\\bla...bla...bla...\\Error_Log.xlsx\"\n\nSet ErrorLog = ActiveWorkbook\nErrorLog.Activate\nunusedRow = Cells.SpecialCells(xlCellTypeLastCell).Offset(1, 0).Row\nRange(\"A\" &amp; unusedRow).Value = currentData_filePath\nApplication.DisplayAlerts = False\nErrorLog.Saved = True\nErrorLog.Save\nWorkbooks.Close\n\nApplication.DisableAlerts = True\nApplication.EnableEvents = True\n\nResume Next\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 0, "last_activity_date": 1553014551, "creation_date": 1553014551, "answer_id": 55246302, "question_id": 55245734, "link": "https://stackoverflow.com/questions/55245734/excel-vba-error-handler-cannot-find-file-how-to-skip-it/55246302#55246302", "title": "Excel VBA Error handler cannot find file... how to skip it?", "body": "<p>If you want your program to never stop, no matter what, you can simply change the type of error handling from this:</p>\n\n<pre><code>On Error GoTo ErrHandler\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>On Error Resume Next\n</code></pre>\n\n<p>So the final code will look like this:</p>\n\n<pre><code>Dim ArrNames\n    Dim wkbTemp As Workbook\n    Dim Table As Workbook\n\n    ArrNames = Array(\"X-Axis\", \"Y-Axis\", \"Z-Axis\", \"Flatness\", _\n        \"Length-X\", \"Length-Y\", \"Length-Z\", \"Length_X\", \"Length_Y\", _\n        \"Length_Z\", \"Length\", \"Angle\", \"Angle-XY\", \"Angle-XZ\", \"Angle-YX\", _\n        \"Angle-YZ\", \"Angle-ZX\", \"Angle-ZY\", \"Radius\", \"Diameter\", \"Flatness\", _\n        \"Straightness\", \"Parallelism\", \"Perpendicular\", \"Circularity\")\n\n    currentData_filePath = Path\n\n    On Error Resume Next\n\n    Workbooks.Open Filename:=currentData_filePath\n    Set wkbTemp = ActiveWorkbook\n\n\n    watchFolders_list = \"S:\\PED (Production Engineering Department)\\bla...bla...bla...\\RT_CMM_Data_File_Paths.xlsx\"\n    Workbooks.Open Filename:=watchFolders_list\n    Set watchFolders_list = ActiveWorkbook\n\n    watchFolders_list.Activate\n\n    lastShtRow = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\n    Table_Path = WorksheetFunction.VLookup(Left_dataPath, ActiveSheet.Range(\"A2:C\" &amp; lastShtRow), 3, False)\n\n    Workbooks.Open Filename:=Table_Path\n    Set Table = ActiveWorkbook     \n\n    'Add here somenthing to check if there were errors\n\n    Application.DisplayAlerts = False\n    wkbTemp.Saved = True\n    Table.SaveAs Filename:=Table_Path\n    Table.Close SaveChanges:=False\n\n    Workbooks.Close\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 55246284, "answer_count": 2, "score": 0, "last_activity_date": 1553014551, "creation_date": 1553012764, "last_edit_date": 1553013420, "question_id": 55245734, "link": "https://stackoverflow.com/questions/55245734/excel-vba-error-handler-cannot-find-file-how-to-skip-it", "title": "Excel VBA Error handler cannot find file... how to skip it?", "body": "<p>A file path is sent as a string to my code below from a program written in C# and my code below runs.</p>\n\n<p>My code below looks up a different file path in column C of an excel workbook called \"RT_CMM_Data_File_Paths.xlsx\"</p>\n\n<p>My code below throws an error when the file path in column C is mis-typed. Specifically, the file extension was mistyped as \".xlxs\" instead of \".xlsx\"</p>\n\n<p>I basically don't want my program to ever stop. So I tried to make an error handler that will record the file path that caused the error and then close out my macro so that the C# program can send the next file path.</p>\n\n<p>However, instead, my code displays a message box \"cannot find the file path\" or something... When I click ok... my program finishes (basically doing nothing else) and closes and the C# program successfully sends the next file path just like i need it to... I don't want to click ok... how do I fix this?</p>\n\n<pre><code>Sub RT_CMM_DATA_COMPILER(Path As String)\n\n    Dim ArrNames\n    Dim wkbTemp As Workbook\n    Dim Table As Workbook\n\n    ArrNames = Array(\"X-Axis\", \"Y-Axis\", \"Z-Axis\", \"Flatness\", _\n        \"Length-X\", \"Length-Y\", \"Length-Z\", \"Length_X\", \"Length_Y\", _\n        \"Length_Z\", \"Length\", \"Angle\", \"Angle-XY\", \"Angle-XZ\", \"Angle-YX\", _\n        \"Angle-YZ\", \"Angle-ZX\", \"Angle-ZY\", \"Radius\", \"Diameter\", \"Flatness\", _\n        \"Straightness\", \"Parallelism\", \"Perpendicular\", \"Circularity\")\n\n    currentData_filePath = Path\n\n    On Error GoTo ErrHandler\n\n    Workbooks.Open Filename:=currentData_filePath\n    Set wkbTemp = ActiveWorkbook\n\n\n    watchFolders_list = \"S:\\PED (Production Engineering Department)\\bla...bla...bla...\\RT_CMM_Data_File_Paths.xlsx\"\n    Workbooks.Open Filename:=watchFolders_list\n    Set watchFolders_list = ActiveWorkbook\n\n    watchFolders_list.Activate\n\n    lastShtRow = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\n    Table_Path = WorksheetFunction.VLookup(Left_dataPath, ActiveSheet.Range(\"A2:C\" &amp; lastShtRow), 3, False)\n\n    Workbooks.Open Filename:=Table_Path\n    Set Table = ActiveWorkbook     \n\n\n    Application.DisplayAlerts = False\n    wkbTemp.Saved = True\n    Table.SaveAs Filename:=Table_Path\n    Table.Close SaveChanges:=False\n\n    Workbooks.Close\n\nExit Sub\n\nErrHandler:\n\n    Workbooks.Open Filename:=\"S:\\PED (Production Engineering Department)\\bla...bla...bla...\\Error_Log.xlsx\"\n\n    Set ErrorLog = ActiveWorkbook\n    ErrorLog.Activate\n    unusedRow = Cells.SpecialCells(xlCellTypeLastCell).Offset(1, 0).Row\n    Range(\"A\" &amp; unusedRow).Value = currentData_filePath\n    Application.DisplayAlerts = False\n    ErrorLog.Saved = True\n    ErrorLog.Save\n    Workbooks.Close\n\n    Resume Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1553012036, "post_id": 55245484, "comment_id": 97223976, "body": "A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is required, see <a href=\"https://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a> if you&#39;re struggling."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553012041, "post_id": 55245484, "comment_id": 97223979, "body": "Can you post the code? Someone will edit your code so it fits."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1553012842, "post_id": 55245484, "comment_id": 97224400, "body": "You have a red line on the procedure calling because there are a lot of <code>&quot;</code> so it&#39;s taking more strings than it should."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1553026656, "post_id": 55245484, "comment_id": 97231340, "body": "You&#39;ve got an issue with quotes. See <a href=\"https://stackoverflow.com/questions/9024724/how-do-i-put-double-quotes-in-a-string-in-vba\">how do I put double quotes in a string in vba</a>"}, {"owner": {"reputation": 15, "user_id": 8914550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9cb938a88452784e1bff0367bdd4a2?s=128&d=identicon&r=PG&f=1", "display_name": "Michelozzo8", "link": "https://stackoverflow.com/users/8914550/michelozzo8"}, "edited": false, "score": 0, "creation_date": 1553072292, "post_id": 55245484, "comment_id": 97245214, "body": "Hi guys, I figured it out with this line of code:  Call CharactersReplace(xRg, &quot;Test1&quot;, &quot;Test2&quot;, True)  Is working properly, but I have a question: instead of &quot;Test2&quot;, I want to do ALT+ENTER on the Line of Excel. There is a code on VBA to do it?  Thank you very much."}, {"owner": {"reputation": 825, "user_id": 1898524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6C9A.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1898524/ben"}, "edited": false, "score": 0, "creation_date": 1596727474, "post_id": 55245484, "comment_id": 111909890, "body": "Keep in mind that this code will not make any changes if a cell has more than 255 characters."}], "answers": [{"tags": [], "owner": {"reputation": 825, "user_id": 1898524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6C9A.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1898524/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1596723518, "creation_date": 1596723518, "answer_id": 63285591, "question_id": 55245484, "link": "https://stackoverflow.com/questions/55245484/how-to-find-and-replace-text-then-preserve-formatting-in-excel/63285591#63285591", "title": "How To Find And Replace Text Then Preserve Formatting In Excel?", "body": "<p>The last line of code should be:</p>\n<pre><code>Call CharactersReplace(xRg, &quot;&lt;span style=&quot;&quot;background-color: #ffff00;&quot;&quot;&gt;KK&lt;/span&gt;&quot;&quot;, &quot;&quot;&lt;span style=&quot;&quot;background-color: #ffff00;&quot;&quot;&gt;Kutools&lt;/span&gt;&quot;, True)\n</code></pre>\n<p>Where every <code>&quot;</code> inside the outermost quotes is doubled.</p>\n<p>To answer the question you posted in the comments, <strong>Alt+Enter</strong> is equivalent to <code>vbLf</code> or <code>Chr(10)</code> in VBA.</p>\n"}], "owner": {"reputation": 15, "user_id": 8914550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9cb938a88452784e1bff0367bdd4a2?s=128&d=identicon&r=PG&f=1", "display_name": "Michelozzo8", "link": "https://stackoverflow.com/users/8914550/michelozzo8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 592, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1596723518, "creation_date": 1553011976, "last_edit_date": 1553012577, "question_id": 55245484, "link": "https://stackoverflow.com/questions/55245484/how-to-find-and-replace-text-then-preserve-formatting-in-excel", "title": "How To Find And Replace Text Then Preserve Formatting In Excel?", "body": "<p>on Excel I'm trying to \"Find and Replace\" some text (the text is the same for every cell) and change it to multiple cells (600+ cells). The problem is that when I do it excel removes the formatting from the text.</p>\n\n<p>I searched something and apparently you can do it via VBA, so I found this VBA Macro:</p>\n\n<pre><code>Sub CharactersReplace(Rng As Range, FindText As String, ReplaceText As String, Optional MatchCase As Boolean = False)\n  'UpdatebyExtendoffice20160711\n    Dim I As Long\n    Dim xLenFind As Long\n    Dim xLenRep As Long\n    Dim K As Long\n    Dim xValue As String\n    Dim M As Long\n    Dim xCell As Range\n    xLenFind = Len(FindText)\n    xLenRep = Len(ReplaceText)\n    If Not MatchCase Then M = 1\n    For Each xCell In Rng\n        If VarType(xCell) = vbString Then\n            xValue = xCell.Value\n            K = 0\n            For I = 1 To Len(xValue)\n              If StrComp(Mid$(xValue, I, xLenFind), FindText, M) = 0 Then\n                xCell.Characters(I + K, xLenFind).Insert ReplaceText\n                K = K + xLenRep - xLenFind\n              End If\n            Next\n        End If\n    Next\nEnd Sub\n\nSub Test_CharactersReplace()\n    Dim xRg As Range\n    Dim xTxt As String\n    Dim xCell As Range\n    On Error Resume Next\n    If ActiveWindow.RangeSelection.Count &gt; 1 Then\n      xTxt = ActiveWindow.RangeSelection.AddressLocal\n    Else\n      xTxt = ActiveSheet.UsedRange.AddressLocal\n    End If\n    Set xRg = Application.InputBox(\"Select a range:\", \"Kutools for Excel\", xTxt, , , , , 8)\n    If xRg Is Nothing Then Exit Sub\n    Call CharactersReplace(xRg, \"&lt;span style=\"background-color: #ffff00;\"&gt;##&lt;/span&gt;\", \"&lt;span style=\"background-color: #ffff00;\"&gt;asdasd&lt;/span&gt;\", True)\nEnd Sub\n</code></pre>\n\n<p>(I posted a picture because I dont know how to paste the entire code with the CTRL+K command).\nThe code seems ok but is red on the last line of Code (on the line where I have to decide which word it will be changed).</p>\n\n<p>Any suggestion ?</p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553013629, "post_id": 55245440, "comment_id": 97224889, "body": "Your description doesn&#39;t tell us what the actual problem is? Is it that you cannot figure out how to complete the task? or is the code throwing an error? please be more specific regarding your issue"}, {"owner": {"reputation": 31, "user_id": 6518017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-haOyLIUOqak/AAAAAAAAAAI/AAAAAAAAB_I/PBFztVMHMLI/photo.jpg?sz=128", "display_name": "Alex H", "link": "https://stackoverflow.com/users/6518017/alex-h"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1553014902, "post_id": 55245440, "comment_id": 97225567, "body": "@Zac Apologies, I can&#39;t figure out how to complete the task. The code I put in my request is where I have got to in my process but I am now stuck."}], "answers": [{"tags": [], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "is_accepted": false, "score": 0, "last_activity_date": 1553016282, "creation_date": 1553016282, "answer_id": 55246760, "question_id": 55245440, "link": "https://stackoverflow.com/questions/55245440/index-information-from-many-workbooks-against-a-unique-id/55246760#55246760", "title": "Index information from many workbooks against a unique ID", "body": "<p><code>Worksheets(\"Source\").Columns(\"A:D\").Copy Destination:=Worksheets(\"Target\").Range(\"a1\")</code></p>\n\n<p>Have a look at the above. This code moves from the first sheet to the second. No need to copy+paste, and much simpler method</p>\n\n<p>Apply it to your code as needed</p>\n"}], "owner": {"reputation": 31, "user_id": 6518017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-haOyLIUOqak/AAAAAAAAAAI/AAAAAAAAB_I/PBFztVMHMLI/photo.jpg?sz=128", "display_name": "Alex H", "link": "https://stackoverflow.com/users/6518017/alex-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553016282, "creation_date": 1553011834, "last_edit_date": 1553014832, "question_id": 55245440, "link": "https://stackoverflow.com/questions/55245440/index-information-from-many-workbooks-against-a-unique-id", "title": "Index information from many workbooks against a unique ID", "body": "<p>I have a list of unique ID's in a spreadsheet and each (but not all) of the IDs has a single related spreadsheet, all stored in the same location. I need to extract a number from each xlsx. file (in the same cell in each file) and match it to the list of unique IDs. All the files have the same naming convention of 'UniqueID_Otherinformation.xlxs' All unique IDs are 6 figures.</p>\n\n<pre><code>Sub OpenFile()\n    Dim sPath As String\n    Dim sFil As String\n    Dim strName As String\n    Dim twbk As Workbook\n    Dim owbk As Workbook\n    Dim ws As Worksheet\n\n    Set twbk = ActiveWorkbook\n    sPath = \"C:\\Data Folder\\\" \n    sFil = Dir(sPath &amp; \"*.xls\")\n\n    Do While sFil &lt;&gt; \"\"\n        strName = sPath &amp; sFil\n        Set owbk = Workbooks.Open(strName)\n        Set ws = owbk.Sheets(1)\n        ws.Range(\"A1\", Range(\"A\" &amp; Row.Count).End(xlUp)).Copy\n        twbk.Sheets(1).Range(\"A65536\").End(xlUp)(2).PasteSpecial xlPasteValues\n        owbk.Close False \n        sFil = Dir\n    Loop\n\ntwbk.Save\nEnd Sub\n</code></pre>\n\n<p>I made a start but got very lost very quickly.</p>\n\n<p>Edit: Apologies, not clear about my needs. I'm not sure how to solve the problem. I made a start with code above but it is not very close to what I am intending so am hoping for your expertise here as I am unsure how to proceed.</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 133, "user_id": 11227352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a65c4f34a9e1565c3143c0d060daa2?s=128&d=identicon&r=PG", "display_name": "FrazzleUK", "link": "https://stackoverflow.com/users/11227352/frazzleuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1553011391, "creation_date": 1553011391, "question_id": 55245300, "link": "https://stackoverflow.com/questions/55245300/selecting-combobox-on-userform-from-one-workbook-causes-problems-with-activated", "title": "Selecting Combobox on Userform from one workbook causes problems with activated sheet", "body": "<p>I have two workbooks, MacroBook.xlsm has code and userforms contained in it. OtherBook.xlsx has no VBA code and is only acted on by the code.</p>\n\n<p>I have a Userform containing a ComboBox and 2 buttons. Button 1 launches a function that copies data from OtherBook into a temporary sheet in MacroBook, gets all unique items from the range and then deletes the temp sheet. </p>\n\n<pre><code>Function GetListOfEditors(ws As Worksheet) As Variant\n\n    Dim i As Integer\n    i = ufAddToDraftWorking.iEdDestRow\n\n    Dim rng As Range, rng2 As Range\n    Dim data As Variant\n    Dim lRow As Integer\n\n    'Create a temp sheet to store data\n    Call CreateSheet(\"TempSheet\")\n\n    'Copy complete list of editors to temp sheet\n    ws.Range(Cells(2, 4), Cells(i - 1, 5)).Copy ThisWorkbook.Worksheets(\"TempSheet\").Range(\"A1\")\n\n    'Use worksheet function to remove duplicates from both columns\n    Set rng = ThisWorkbook.Worksheets(\"TempSheet\").UsedRange\n    rng.RemoveDuplicates Columns:=Array(1, 2), Header:=xlNo\n\n    ThisWorkbook.Worksheets(\"TempSheet\").Activate\n\n    'Store updated data\n    lRow = ThisWorkbook.Worksheets(\"TempSheet\").UsedRange.Rows.Count\n\n    Set rng2 = ThisWorkbook.Worksheets(\"TempSheet\").Range(Cells(1, 1), Cells(lRow, 2))\n    data = rng2\n\n    'Delete Temp Sheet\n    ThisWorkbook.Worksheets(\"TempSheet\").Delete\n\n    'Return List of Unique Editors\n    GetListOfEditors = data\n\nEnd Function\n</code></pre>\n\n<p>This range is then stored into a ComboBox on the Userform. At this point OtherBook is in focus on the screen. As soon as I select the Userform e.g clicking the ComboBox, MacroBook is now in focus.  </p>\n\n<p>Clicking the next button on the Userform makes some changes onto a sheet in Otherbook. During this MacroBook is still in focus. </p>\n\n<pre><code>Sub AddApprover(ApproverName As String)\n\n    Dim wbDraftPricing As Workbook\n    Dim wsEditorSheet As Worksheet\n\n    Dim i As Integer\n\n    i = ufAddToDraftWorking.iEdDestRow\n\n    Debug.Print Application.ScreenUpdating\n    If FileHandler.IsWorkBookOpen(Globals.DraftWorkingFormulasPath) = True Then\n        Set wbDraftPricing = Workbooks(FileHandler.FileNameFromPath(Globals.DraftWorkingFormulasPath))\n    Else\n        Set wbDraftPricing = OpenDraftWorkingFile()\n    End If\n\n   'OtherBook is still not put into focus here \n    Set wsEditorSheet = wbDraftPricing.Worksheets(\"Editor List\")\n    wbDraftPricing.Activate\n    wsEditorSheet.Activate\n\n    With wsEditorSheet\n\n        'Add Approver from dropdown list on userform\n        .Cells(i, 5) = ApproverName\n        .Cells(i, 12) = .Cells(i, 4)\n        'Add Vlookups to get correct naming from sharepoint\n        .Cells(i, 16).Formula = \"=VLOOKUP(D\" &amp; i &amp; \",V:W,2,FALSE)\"\n        .Cells(i, 17).Formula = \"=VLOOKUP(E\" &amp; i &amp; \",V:W,2,FALSE)\"\n\n    End With\n\n    wbDraftPricing.Activate\n    wsEditorSheet.Select\n\nEnd Sub\n</code></pre>\n\n<p>If I then select OtherBook from the taskbar this obviously comes into focus. Clicking into this sheet however is where the issue lies. If I try and select a cell in OtherBook what is actually selected is a cell in MacroBook. This effect carries over to clicking the close button on OtherBook actually closes MacroBook. </p>\n\n<p>To fix this I have to click into the Userform, then click into MacroBook then I can open OtherBook and select cells as normal. </p>\n\n<p>In the function AddApprover I have marked with a comment where I had expected OtherBook to come into focus but this does not happen. </p>\n\n<p>Any help or explanation why this is happening would be most appreciated. </p>\n"}]