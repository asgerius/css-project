[{"tags": ["excel", "character", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1502324221, "post_id": 45602415, "comment_id": 78164360, "body": "<code>sCharOK</code> are all the chars which are ok. <code>Mid(s, j, 1)</code> is the actual char in the string to check. <code>InStr(sCharOK, Mid(s, j, 1)) = 0</code> =&gt; the character at position <code>j</code> is not valid. <code>replace(s, j, &quot;&quot;)</code> will then replace the numerical value <code>j</code> in the string <code>s</code>... I&#39;m sure you want to run <code>s = replace(s, Mid(s, j, 1), &quot;&quot;)</code> ;)"}, {"owner": {"reputation": 630, "user_id": 607118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c04d16f3ff4b37dbbe9918d752348c2?s=128&d=identicon&r=PG", "display_name": "R Hughes", "link": "https://stackoverflow.com/users/607118/r-hughes"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502324403, "post_id": 45602415, "comment_id": 78164404, "body": "Thanks Dirk, i got so hung up on the formatting issue, my brain took a hard left down the wrong road. Logic was good, Syntax was lacking :)"}], "tags": [], "owner": {"reputation": 630, "user_id": 607118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c04d16f3ff4b37dbbe9918d752348c2?s=128&d=identicon&r=PG", "display_name": "R Hughes", "link": "https://stackoverflow.com/users/607118/r-hughes"}, "is_accepted": false, "score": 2, "last_activity_date": 1502328717, "last_edit_date": 1502328717, "creation_date": 1502323282, "answer_id": 45602415, "question_id": 45602265, "link": "https://stackoverflow.com/questions/45602265/removing-any-non-specified-characters-from-an-excel-spreadsheet-using-a-macro/45602415#45602415", "title": "Removing Any Non-Specified Characters from an Excel Spreadsheet using a Macro", "body": "<p>If it were me, I would use a replace command on the original string every time I find an invalid char, changing that invalid char to null. Then replace the original cell value with the modified string. Something like this...</p>\n\n<p>One possible way (tested)</p>\n\n<pre><code>Sub RemoveInvalidCharacters()\nDim sCharOK As String, s As String\nDim r As Range, rc As Range\nDim j As Long\nDim badchar As Boolean\n\nsCharOK = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789, `~!@#$%^&amp;*()_+-=[]\\{}|;':\"\",./&lt;&gt;?\u2122\u00ae\"\n\nSet r = Worksheets(\"features\").UsedRange.SpecialCells(xlCellTypeConstants, xlTextValues)\n\n' loop through all the cells with text constant values and\n' deletes the invalid characters not in sCharOK from each Value property\nFor Each rc In r\n    badchar = False\n    s = rc.Value\n    For j = 1 To Len(s)\n        If InStr(sCharOK, Mid(s, j, 1)) = 0 Then\n            badchar = True\n            s = Replace(s, Mid(s, j, 1), \"\")\n        End If\n    Next j\n    If badchar Then\n        rc.Value = s\n    End If\nNext rc\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 630, "user_id": 607118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c04d16f3ff4b37dbbe9918d752348c2?s=128&d=identicon&r=PG", "display_name": "R Hughes", "link": "https://stackoverflow.com/users/607118/r-hughes"}, "edited": false, "score": 0, "creation_date": 1502326115, "post_id": 45602658, "comment_id": 78164841, "body": "Slick. way less code and leverages builtin code which should be much faster."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502328884, "post_id": 45602658, "comment_id": 78165447, "body": "What about Unicode characters with codes greater than <code>FF</code>?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502330196, "post_id": 45602658, "comment_id": 78165770, "body": "@RonRosenfeld They can not be there because of &quot;<i>I&#39;m trying to clean up a .CSV file...</i>&quot; and &quot;<a href=\"https://stackoverflow.com/questions/37669373/csv-how-to-include-double-byte-characters\">THIS</a>&quot;"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502331434, "post_id": 45602658, "comment_id": 78166109, "body": "I was one of the upvotes on your answer, because of its simplicity and speed.  Only pointing out a possible limitation, which may not even apply in this particular case.  However, csv files can contain those pesky characters, and they can be imported into Excel given the proper setup."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502332107, "post_id": 45602658, "comment_id": 78166274, "body": "@RonRosenfeld I&#39;m sorry if my comments sound rude or something like that. I&#39;m a very nice guy who isn&#39;t pretty good in speaking (writing) English.  I also upvoted your answer as it does exactly what is asked by the OP."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502332432, "post_id": 45602658, "comment_id": 78166362, "body": "@DirkReichel I did not take yours that way, But I was concerned after writing them that my comments also would not be taken well (and English is my first language) :-)"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502333028, "post_id": 45602658, "comment_id": 78166501, "body": "@RonRosenfeld I want &quot;Comic&quot; and &quot;Terminator&quot; font... that would help me :P"}, {"owner": {"reputation": 386, "user_id": 7293789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iSIcE.png?s=128&g=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/7293789/rudy"}, "edited": false, "score": 0, "creation_date": 1502368220, "post_id": 45602658, "comment_id": 78185881, "body": "The Range.Replace method you posted worked perfectly! Thanks a bunch!"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 3, "last_activity_date": 1502334320, "last_edit_date": 1502334320, "creation_date": 1502325006, "answer_id": 45602658, "question_id": 45602265, "link": "https://stackoverflow.com/questions/45602265/removing-any-non-specified-characters-from-an-excel-spreadsheet-using-a-macro/45602658#45602658", "title": "Removing Any Non-Specified Characters from an Excel Spreadsheet using a Macro", "body": "<p>Another way would be <code>Range.Replace</code> like:</p>\n\n<pre><code>Sub test()\n  Dim sCharOK As String\n  sCharOK = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789, `~!@#$%^&amp;*()_+-=[]\\{}|;':\"\",./&lt;&gt;?\u2122\u00ae\" &amp; Chr(1)\n  Dim i As Long\n  For i = 0 To 255\n    If InStr(sCharOK, Chr(i)) = 0 Then\n      ActiveSheet.Cells.Replace What:=Chr(i), Replacement:=\"\", LookAt:=xlPart, MatchCase:=True, SearchFormat:=False, ReplaceFormat:=False\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>looking at @ryguy72 answer also offers another way if only non-printable characters need to be deleted (at the question something like <code>\u00b5\u00b2\u00e4\u00f6\u00fc\u00df\u00c9\u00f5</code> will be deleted but this code will not) also assuming that there are <strong>no formulas</strong>:</p>\n\n<pre><code>Sub test()\n  With ActiveSheet.UsedRange\n    .Value = Evaluate(\"TRIM(CLEAN(\" &amp; .Address &amp; \"))\")\n  End With\nEnd Sub\n</code></pre>\n\n<p>Or directly run in Immediate window this one-liner:</p>\n\n<pre><code>ActiveSheet.UsedRange.Value = Evaluate(\"TRIM(CLEAN(\" &amp; ActiveSheet.UsedRange.Address &amp; \"))\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502328505, "post_id": 45602927, "comment_id": 78165363, "body": "But running for each cell, may be slower at the end. However, this dependes mainly on the count of cells."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502328721, "post_id": 45602927, "comment_id": 78165407, "body": "@DirkReichel Absolutely correct.  If there were a lot of cells, I&#39;d use VBA arrays.  But using the regex pattern will also remove all non listed characters including Unicode characters."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502331074, "post_id": 45602927, "comment_id": 78165997, "body": "deleted my comment by accident: If the OP really want it (or is just bored enough) he can run my code with <code>ChrW</code> from -32768 to 65535. :P"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502331563, "post_id": 45602927, "comment_id": 78166149, "body": "@DirkReichel And we don&#39;t even know if it is necessary or not.  But I do like the simplicity of your posted solution."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 2, "last_activity_date": 1502327508, "creation_date": 1502327508, "answer_id": 45602927, "question_id": 45602265, "link": "https://stackoverflow.com/questions/45602265/removing-any-non-specified-characters-from-an-excel-spreadsheet-using-a-macro/45602927#45602927", "title": "Removing Any Non-Specified Characters from an Excel Spreadsheet using a Macro", "body": "<p>You could also use regular expressions, thereby avoiding needing to examine each character in a loop.  (Although the regex engine has to do that).</p>\n\n<p>The Regex pattern, explained below, contains your list of characters, and the character class used says match everything that is not listed.</p>\n\n<p>If speed becomes an issue, you can use vba arrays to speed things up.</p>\n\n<pre><code>Option Explicit\nSub ReplaceNonStdChars()\n    Const sPat As String = \"[^\\x20-\\x7E\\x99\\xAE]\"\n    Dim RE As Object\n    Dim R As Range, C As Range\n\nSet R = Worksheets(\"features\").UsedRange.SpecialCells(xlCellTypeConstants, xlTextValues)\n\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Global = True\n    .Pattern = sPat\n    For Each C In R\n        C.Value = .Replace(C.Text, \"\")\n    Next C\nEnd With\nEnd Sub\n</code></pre>\n\n<h2>Explanation of Regex Pattern</h2>\n\n<h2>[^\\x20-\\x7E\\x99\\xAE]</h2>\n\n<pre><code>[^\\x20-\\x7E\\x99\\xAE]\n</code></pre>\n\n<ul>\n<li><a href=\"http://www.regular-expressions.info/charclass.html\" rel=\"nofollow noreferrer\">Match any single character NOT present in the list below</a> <code>[^\\x20-\\x7E\\x99\\xAE]</code>\n\n<ul>\n<li><a href=\"http://www.regular-expressions.info/charclass.html\" rel=\"nofollow noreferrer\">A character in the range between these two characters</a> <code>\\x20-\\x7E</code>\n\n<ul>\n<li><a href=\"http://www.regular-expressions.info/nonprint.html\" rel=\"nofollow noreferrer\">The character \u201c \u201d which occupies position 0x20 (32 decimal) in the character set</a> <code>\\x20</code></li>\n<li><a href=\"http://www.regular-expressions.info/nonprint.html\" rel=\"nofollow noreferrer\">The character \u201c~\u201d which occupies position 0x7E (126 decimal) in the character set</a> <code>\\x7E</code></li>\n</ul></li>\n<li><a href=\"http://www.regular-expressions.info/nonprint.html\" rel=\"nofollow noreferrer\">The character with position 0x99 (153 decimal) in the character set</a> <code>\\x99</code></li>\n<li><a href=\"http://www.regular-expressions.info/nonprint.html\" rel=\"nofollow noreferrer\">The character with position 0xAE (174 decimal) in the character set</a> <code>\\xAE</code></li>\n</ul></li>\n</ul>\n\n<p>Created with <a href=\"http://www.regexbuddy.com/\" rel=\"nofollow noreferrer\">RegexBuddy</a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1502332484, "creation_date": 1502332484, "answer_id": 45603534, "question_id": 45602265, "link": "https://stackoverflow.com/questions/45602265/removing-any-non-specified-characters-from-an-excel-spreadsheet-using-a-macro/45603534#45603534", "title": "Removing Any Non-Specified Characters from an Excel Spreadsheet using a Macro", "body": "<p>I just had to do this today, literally.  The script below worked perfect fine for me.</p>\n\n<pre><code>Sub Clean_and_Trim_Cells()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Dim s As String\n    For Each c In ActiveSheet.UsedRange\n        s = c.Value\n        If Trim(Application.Clean(s)) &lt;&gt; s Then\n            s = Trim(Application.Clean(s))\n            c.Value = s\n        End If\n    Next\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 386, "user_id": 7293789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iSIcE.png?s=128&g=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/7293789/rudy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1624, "favorite_count": 0, "accepted_answer_id": 45602658, "answer_count": 4, "score": 2, "last_activity_date": 1502334320, "creation_date": 1502322240, "last_edit_date": 1531161705, "question_id": 45602265, "link": "https://stackoverflow.com/questions/45602265/removing-any-non-specified-characters-from-an-excel-spreadsheet-using-a-macro", "title": "Removing Any Non-Specified Characters from an Excel Spreadsheet using a Macro", "body": "<p>I'm trying to clean up a .CSV file in Excel by getting rid of any non-standard characters. The only characters I care about keeping are A-Z, 0-9, and a few standard punctuation marks. Any other characters, I'd like to delete. </p>\n\n<p>I've gotten the following macro to delete an entire row when it finds a cell which contains any characters I haven't specified, but I'm not sure how to get it to actually delete the character itself. </p>\n\n<pre><code>Sub Replace()\nDim sCharOK As String, s As String\nDim r As Range, rc As Range\nDim j As Long\n\nsCharOK = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789, `~!@#$%^&amp;*()_+-=[]\\{}|;':\"\",./&lt;&gt;?\u2122\u00ae\"\n\nSet r = Worksheets(\"features\").UsedRange.SpecialCells(xlCellTypeConstants, xlTextValues)\n\n' loop through all the cells with text constant values and deletes the rows with characters not in sCharOK\nFor Each rc In r\n    s = rc.Value\n    For j = 1 To Len(s)\n        If InStr(sCharOK, Mid(s, j, 1)) = 0 Then\n            rc.EntireRow.Delete\n            Exit For\n        End If\n    Next j\nNext rc\n\nEnd Sub\n</code></pre>\n\n<p>I assume there's a fairly simple way to adapt this code to that function, but I'm not familiar enough with VBA to really know how to go about doing that. Any insights are greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "vlookup", "median"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1502322130, "post_id": 45602179, "comment_id": 78163900, "body": "Can you show us what you&#39;ve already tried? And given your points about the complex filtering and fuzzy matching, I&#39;d say it&#39;ll need a VBA solution."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502323570, "post_id": 45602179, "comment_id": 78164247, "body": "median of number in column A or median of date in column C ???"}], "owner": {"reputation": 13, "user_id": 8022338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d3a433bd25233fdb6e9459cf252839?s=128&d=identicon&r=PG&f=1", "display_name": "Diffused", "link": "https://stackoverflow.com/users/8022338/diffused"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529412656, "creation_date": 1502321550, "last_edit_date": 1592644375, "question_id": 45602179, "link": "https://stackoverflow.com/questions/45602179/excel-search-then-find-median-with-filters", "title": "Excel Search then find Median with Filters", "body": "<p>I've spent the better half of a day attempting to resolve a formula/VBA code to sort through some data in excel - I appreciate any and all input!</p>\n<h3>Example Image</h3>\n<p><img src=\"https://i.stack.imgur.com/EyVPK.png\" alt=\"Example Image\" /></p>\n<p>As you may see, in this small sample (my actual sample is ~4000 rows), on Worksheet 1, I have three columns of data. The first two are identifiers and the last is a date.</p>\n<p>In the most simple terms, what I would like to do is search Column A for a value, say 7, then pull the date from Column C. The result of a search for 7 should be two different dates, I would then like to determine the median (I know that a median between two numbers is a strange thing to look for, remember this is just an example).</p>\n<p>Diving a bit further in, the value that I'm searching for is determined from a separate set of data on Worksheet 2. Right now, I'm using the VLOOKUP function and obtaining one result per &quot;Definition,&quot; which does not allow me to perform the median calculation.</p>\n<p>Considering there should be numerous results from one search, I would also like to be able to include some filters/logic. For example, &quot;if Column A includes a positive search result, do not also include the date as a result (for later performing the calculation) from this row in Column B.&quot; Also, if an identifier is slightly different, such as 16.5, 17.5, and 18.5, it would be great to be able to handle that somehow.</p>\n<p>Please let me know whether my problem statement is clear and I appreciate any and all responses pointing me in the right direction!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45, "user_id": 8437431, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa43ae6edbfce5b1c958ae07098a396a?s=128&d=identicon&r=PG&f=1", "display_name": "Mils", "link": "https://stackoverflow.com/users/8437431/mils"}, "edited": false, "score": 0, "creation_date": 1502321326, "post_id": 45602071, "comment_id": 78163707, "body": "Thanks Gary&#39;s Student i&#39;m new to this site if you didn&#39;t guess :)"}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 0, "creation_date": 1502322367, "post_id": 45602071, "comment_id": 78163958, "body": "You miight looking for this? - &quot;<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-pastespecial-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>&quot;"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502324456, "post_id": 45602071, "comment_id": 78164418, "body": "I was hoping that you would be able to use <code>... .Value = ... .Value</code> but the <code>.SpecialCells(xlCellTypeVisible)</code> complicates things, so the answers by Duc Anh Nguyen (using <code>wsInfoFrom</code> and <code>wsInfoTo</code> instead of <code>ActiveSheet</code>) and by Ricardo Rodrigues are probably the easiest to implement."}], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 0, "creation_date": 1502322934, "post_id": 45602156, "comment_id": 78164083, "body": "In my opinion, this topic would like to copy the upper rows value to the lower rows. not from column A to column B. ;) But this is close to the answer anw"}], "tags": [], "owner": {"reputation": 84, "user_id": 7014815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gY1PUNjaRQc/AAAAAAAAAAI/AAAAAAAAEMo/UmZ3c-cIzvU/photo.jpg?sz=128", "display_name": "Ricktron3000", "link": "https://stackoverflow.com/users/7014815/ricktron3000"}, "is_accepted": false, "score": 2, "last_activity_date": 1502321447, "creation_date": 1502321447, "answer_id": 45602156, "question_id": 45602071, "link": "https://stackoverflow.com/questions/45602071/copy-values-instead-of-formulas/45602156#45602156", "title": "Copy values instead of formulas", "body": "<p>Something like this should work</p>\n\n<pre><code>Sheets(\"Sheet1\").Columns(1).Copy\nSheets(\"Sheet2\").Columns(2).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Don't have excel available to me at the moment but I believe you'd use PasteSpecial like this in your example:</p>\n\n<pre><code>wsInfoTo.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 8437431, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa43ae6edbfce5b1c958ae07098a396a?s=128&d=identicon&r=PG&f=1", "display_name": "Mils", "link": "https://stackoverflow.com/users/8437431/mils"}, "edited": false, "score": 0, "creation_date": 1502324411, "post_id": 45602386, "comment_id": 78164406, "body": "This is what I needed but I had to adapt it to pull the data from a different Sheet instead of the Active sheet. Many Thanks Mils"}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "reply_to_user": {"reputation": 45, "user_id": 8437431, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa43ae6edbfce5b1c958ae07098a396a?s=128&d=identicon&r=PG&f=1", "display_name": "Mils", "link": "https://stackoverflow.com/users/8437431/mils"}, "edited": false, "score": 0, "creation_date": 1502324822, "post_id": 45602386, "comment_id": 78164516, "body": ":D, forgot to change back the sheet. I do not have the same workbook so that I have to change the variable to the activesheet. Great to hear that work. And please have a look at the link at the comment for technical detail."}], "tags": [], "owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "is_accepted": true, "score": 1, "last_activity_date": 1502323076, "creation_date": 1502323076, "answer_id": 45602386, "question_id": 45602071, "link": "https://stackoverflow.com/questions/45602071/copy-values-instead-of-formulas/45602386#45602386", "title": "Copy values instead of formulas", "body": "<p>Fist you select the source range\nThen you select the target range\nSet copy to sc and pastespecial to target range and there you go :D</p>\n\n<pre><code>Set copyRange = ActiveSheet.Range(\"A1:A\" &amp; lastrow)\ncopyRange.SpecialCells(xlCellTypeVisible).Copy\nActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nWorksheets(\"View\").Activate\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8437431, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa43ae6edbfce5b1c958ae07098a396a?s=128&d=identicon&r=PG&f=1", "display_name": "Mils", "link": "https://stackoverflow.com/users/8437431/mils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1787, "favorite_count": 0, "accepted_answer_id": 45602386, "answer_count": 2, "score": 2, "last_activity_date": 1502324588, "creation_date": 1502320835, "last_edit_date": 1531164843, "question_id": 45602071, "link": "https://stackoverflow.com/questions/45602071/copy-values-instead-of-formulas", "title": "Copy values instead of formulas", "body": "<p>Could someone help me tweak this slightly so it copies and pastes just the values to the cells and not the formulas?</p>\n\n<pre><code>Set copyRange = wsInfoFrom.Range(\"A1:A\" &amp; lastrow) \ncopyRange.SpecialCells(xlCellTypeVisible).Copy wsInfoTo.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\nWorksheets(\"View\").Activate\n</code></pre>\n\n<p>Regards,\nMils</p>\n"}, {"tags": ["vba", "excel", "sorting", "range"], "comments": [{"owner": {"reputation": 293, "user_id": 754682, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7acaf79765f1f4666b8916dc5ea4a987?s=128&d=identicon&r=PG", "display_name": "wizlog", "link": "https://stackoverflow.com/users/754682/wizlog"}, "edited": false, "score": 0, "creation_date": 1502320009, "post_id": 45601892, "comment_id": 78163362, "body": "@TimWilliams added.  I used generic names for several variables, but I think it&#39;s clear.  Basically, after looping through each value in my array, I then apply the sort field."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502320167, "post_id": 45601892, "comment_id": 78163404, "body": "And what happens when you run that?"}, {"owner": {"reputation": 293, "user_id": 754682, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7acaf79765f1f4666b8916dc5ea4a987?s=128&d=identicon&r=PG", "display_name": "wizlog", "link": "https://stackoverflow.com/users/754682/wizlog"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502320200, "post_id": 45601892, "comment_id": 78163410, "body": "No error message, yet it doesn&#39;t sort.  I looked for ways to determine applied sort fields using the immediate window but came up empty handed."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 754682, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7acaf79765f1f4666b8916dc5ea4a987?s=128&d=identicon&r=PG", "display_name": "wizlog", "link": "https://stackoverflow.com/users/754682/wizlog"}, "edited": false, "score": 0, "creation_date": 1502320590, "post_id": 45602006, "comment_id": 78163522, "body": "I didn&#39;t realize I had to re-reference the sheet within my referenced range.  Thank you."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1502320338, "creation_date": 1502320338, "answer_id": 45602006, "question_id": 45601892, "link": "https://stackoverflow.com/questions/45601892/dynamic-nested-sorts-using-excel-vba/45602006#45602006", "title": "Dynamic nested sorts using Excel VBA", "body": "<p>Try something like:</p>\n\n<pre><code>Dim sht As WorkSheet\n\nSet sht = .Worksheets(\"SalesRep\")\n\nWith sht.Sort\n    .SortFields.Clear  '&lt;&lt;&lt;&lt;&lt; clear any previous\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    for i=1 to myArrayLength\n       SortFields.Add Key:=sht.Range(sht.cells(1,colNumArray(i)), _\n                                     sht.cells(lastRow,colNumArray(i)))\n\n       'maybe cleaner as\n       'SortFields.Add Key:=sht.Cells(1, colNumArray(i)).Resize(lastRow, 1)\n    next i\n    .Apply\nEnd With\n</code></pre>\n\n<p>You don't need the <code>.Address</code> in your range reference, but you do need to add the worksheet qualifier, or your code will fail when any other sheet is active.</p>\n"}], "owner": {"reputation": 293, "user_id": 754682, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7acaf79765f1f4666b8916dc5ea4a987?s=128&d=identicon&r=PG", "display_name": "wizlog", "link": "https://stackoverflow.com/users/754682/wizlog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 45602006, "answer_count": 1, "score": 0, "last_activity_date": 1502320363, "creation_date": 1502319580, "last_edit_date": 1502320363, "question_id": 45601892, "link": "https://stackoverflow.com/questions/45601892/dynamic-nested-sorts-using-excel-vba", "title": "Dynamic nested sorts using Excel VBA", "body": "<p>I've been to this <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-sort-method-excel\" rel=\"nofollow noreferrer\">MSDN page</a> to learn about sorting with multiple sort fields. It basically says to number your keys and set them equal to the sort field. </p>\n\n<p>I want to loop through an N sized integer array to sort a range by the values in the array. For example, if my sheet has 100 columns of data, I might want to sort based on columns 3,18 and 62; so N would be 3. The problem is I can't name the sort keys <code>\"key\" &amp; i</code> as i loops from 1 to N.</p>\n\n<p>What I have so far:</p>\n\n<pre><code> With Worksheets(\"SalesRep\").Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    for i=1 to myArrayLength\n       SortFields.Add Key:=Range(cells(1,colNumArray(i)).address,cells(lastRow,colNumArray(i)).address)\n    next i\n    .Apply\nEnd With\n</code></pre>\n\n<p>What do you recommend?</p>\n"}, {"tags": ["string", "excel", "cell", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "is_accepted": false, "score": 1, "last_activity_date": 1502322779, "creation_date": 1502322779, "answer_id": 45602348, "question_id": 45601792, "link": "https://stackoverflow.com/questions/45601792/excel-vba-delete-string-and-following-line-within-a-cell/45602348#45602348", "title": "Excel VBA-delete string and following line within a cell", "body": "<p>You'll need to find the starting point and ending point in the string using InStr:</p>\n\n<blockquote>\n  <p>InStr( [start], string, substring, [compare] )</p>\n</blockquote>\n\n<p>The starting point is found by searching for \"Subject:\":</p>\n\n<pre><code>startingPoint = InStr( cellValue, \"Subject:\" )\n</code></pre>\n\n<p>The End point is the second vbLf (line feed) character after that, so you want to start the second InStr at the starting point plus the length of the first search string (8) plus one:</p>\n\n<pre><code>endingPoint = Instr ( startingPoint + 8 + 1, cellValue, vbLf )\n</code></pre>\n\n<p>Then put it all together with the Mid function:</p>\n\n<blockquote>\n  <p>Mid(text_string, start_position, Length)</p>\n</blockquote>\n\n<p>The length will be equal to the ending position minus the starting position.</p>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 8350311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W99gl.png?s=128&g=1", "display_name": "Piecevcake", "link": "https://stackoverflow.com/users/8350311/piecevcake"}, "is_accepted": true, "score": 1, "last_activity_date": 1597483788, "last_edit_date": 1597483788, "creation_date": 1502322946, "answer_id": 45602372, "question_id": 45601792, "link": "https://stackoverflow.com/questions/45601792/excel-vba-delete-string-and-following-line-within-a-cell/45602372#45602372", "title": "Excel VBA-delete string and following line within a cell", "body": "<p>This worked in my case!</p>\n<pre><code>Selection.Replace What:=&quot;Subject:&quot; &amp; Chr(13) &amp; &quot;*&quot; &amp; Chr(13) &amp; Chr(10), Replacement:=&quot;&quot;, Lookat:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 8350311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W99gl.png?s=128&g=1", "display_name": "Piecevcake", "link": "https://stackoverflow.com/users/8350311/piecevcake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 45602372, "answer_count": 2, "score": -1, "last_activity_date": 1597483788, "creation_date": 1502318930, "last_edit_date": 1597399769, "question_id": 45601792, "link": "https://stackoverflow.com/questions/45601792/excel-vba-delete-string-and-following-line-within-a-cell", "title": "Excel VBA-delete string and following line within a cell", "body": "<p>I need to delete certain strings (e.g. &quot;SUBJECT:&quot;, there is a line break after this string), <em>and the entire following line, to and including the next line break</em>, from within multiple cells in Excel.</p>\n<p>How can I write a macro for this?</p>\n<p>I am guessing it would be</p>\n<p><code>    Cells.Replace What:=&quot;Subject:&quot; &amp; Chr(10) &amp; &quot;[ANY TEXT]&quot; &amp; Chr(10), Replacement:=&quot;&quot;, Lookat:=xlPart, _ SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _ ReplaceFormat:=False</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 1, "creation_date": 1502319286, "post_id": 45601778, "comment_id": 78163118, "body": "Format Cells -&gt; Date - You don&#39;t need VBA for this - just format the entire column as a date. If you prefer to use vba, you can add: <code>Range(&quot;G2:G&quot; &amp; lastrow).NumberFormat = &quot;mm&#47;dd&#47;yyyy&quot;</code> before your <code>Range(&quot;G2...</code> line"}], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 1, "creation_date": 1502344935, "post_id": 45601902, "comment_id": 78169961, "body": "A.S.H Thank you from the bottom of my heart!!! I was literally desperate the past 2 days trying to figure this out !! you saved me from HUGE trouble!! Thanks again!!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1502319654, "creation_date": 1502319654, "answer_id": 45601902, "question_id": 45601778, "link": "https://stackoverflow.com/questions/45601778/vlookup-for-dates-in-other-sheets/45601902#45601902", "title": "Vlookup for dates in other sheets", "body": "<p>You can set explicitly the format to the dat format you want. i.e.</p>\n\n<pre><code>With Worksheets(\"Tracker1\")\n  lastrow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n  With .Range(\"G2:G\" &amp; lastrow)\n    .Formula = \"=VLOOKUP(B2,'Programare'!C:F,4,FALSE))\"\n    .NumberFormat = \"d/m/yy\"  ' &lt;---------------------- Set the date format explicitly\n  End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 45601902, "answer_count": 1, "score": 1, "last_activity_date": 1502319992, "creation_date": 1502318865, "last_edit_date": 1502319992, "question_id": 45601778, "link": "https://stackoverflow.com/questions/45601778/vlookup-for-dates-in-other-sheets", "title": "Vlookup for dates in other sheets", "body": "<p>I have a problem! Even though my Vlookup for dates seems to be fine, when I run the macro, instead of showing dates, it shows some random numbers! Below is the code for vlookup! I did not include the rest of the code because it has nothing to do with this part! The vlookup is correct as of where it refers to and staff beacuse in the sheets it runs perfectly as a formula.. Only inside a macro is not working!! Should I add anything to the code below to indicate that it is a date so as for the macro to behave differently? please help me :) </p>\n\n<pre><code>Sheets(\"Tracker1\").Select\n    lastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    Range(\"G2:G\" &amp; lastrow).Formula = \"=VLOOKUP(B2,'Programare'!C:F,4,FALSE))\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502317565, "post_id": 45601522, "comment_id": 78162558, "body": "Not sure if it&#39;s a typo here, but you want <code>Set wbSource = xlApp...</code> not just <code>lApp...</code>.  Also, you&#39;re doing <code>Set srcWorksheet = ...</code>  which sets it as a woksheet. The next line you just need <code>srcWorksheet.Activate</code>, calling the worksheet again may result in an error."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502319285, "post_id": 45601627, "comment_id": 78163116, "body": "Actually, I am trying to remotely access an excel spreadsheet and update the existing data on a specific sheet (&quot;NewCycle&quot;)"}, {"owner": {"reputation": 591, "user_id": 7577314, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10212326222534591/picture?type=large", "display_name": "Erik Westwig", "link": "https://stackoverflow.com/users/7577314/erik-westwig"}, "reply_to_user": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502319373, "post_id": 45601627, "comment_id": 78163150, "body": "But do you want to open a separate copy of Excel from the copy that is running your VBA?"}, {"owner": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502320225, "post_id": 45601627, "comment_id": 78163416, "body": "Like I said. This is all new to me. I am learning as I go. This is the situation. We have an excel spreadsheet sitting on a server that, up to now, has been manually updated. I am writing a batch job that I submit to a processor that finds the excel sheet, opens it, updates it, closes it and ends. Thats the basic scenario I am faced with. I appreciate your help. I don&#39;t know if you have accessed an excel spreadsheet in this manner."}, {"owner": {"reputation": 591, "user_id": 7577314, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10212326222534591/picture?type=large", "display_name": "Erik Westwig", "link": "https://stackoverflow.com/users/7577314/erik-westwig"}, "reply_to_user": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502320346, "post_id": 45601627, "comment_id": 78163450, "body": "Ok.  So you have a copy of Excel already open with your VBA code in it.  Then what I said is true.  The &quot;CreateObject&quot; line in your code was telling your VBA code to open a <i>second</i> copy of Excel and do stuff with that.  That is almost never what you want."}, {"owner": {"reputation": 591, "user_id": 7577314, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10212326222534591/picture?type=large", "display_name": "Erik Westwig", "link": "https://stackoverflow.com/users/7577314/erik-westwig"}, "reply_to_user": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502320388, "post_id": 45601627, "comment_id": 78163459, "body": "No worries.  It&#39;s always hard to get started...  I wrote this kind of code for 22 years..."}, {"owner": {"reputation": 591, "user_id": 7577314, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10212326222534591/picture?type=large", "display_name": "Erik Westwig", "link": "https://stackoverflow.com/users/7577314/erik-westwig"}, "reply_to_user": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502320482, "post_id": 45601627, "comment_id": 78163488, "body": "If you have a separate Executable (say running a VB6 program or Access or something else) you would use CreateObject to open a copy of Excel to do your work..."}, {"owner": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502320808, "post_id": 45601627, "comment_id": 78163590, "body": "This spreadsheet was created manually using micrsoft excel. Each week we copy sql tables into it to manually update it. Now I want to automate that process by extracting sql tables into .dat files and reading this data into one of the 2 spreadsheets. I was just experimenting trying to access and update an existing spreadsheet using a batch job. I don&#39;t know if this is a process that many people out there use now or not."}, {"owner": {"reputation": 591, "user_id": 7577314, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10212326222534591/picture?type=large", "display_name": "Erik Westwig", "link": "https://stackoverflow.com/users/7577314/erik-westwig"}, "reply_to_user": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502320972, "post_id": 45601627, "comment_id": 78163631, "body": "Sure... This kind of office automation code is very common."}, {"owner": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "edited": false, "score": 0, "creation_date": 1502321125, "post_id": 45601627, "comment_id": 78163671, "body": "The code I showed you at the beginning was part of a program I used to combine separate spreadheets into a single workbook and it already works. I was hoping to use that concept to open a workbook and update it.... but I don&#39;t know if I am mixing apples and oranges here. I am a 30 year cobol programmer trying to catch up to modern technology"}], "tags": [], "owner": {"reputation": 591, "user_id": 7577314, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10212326222534591/picture?type=large", "display_name": "Erik Westwig", "link": "https://stackoverflow.com/users/7577314/erik-westwig"}, "is_accepted": false, "score": 0, "last_activity_date": 1502318033, "creation_date": 1502318033, "answer_id": 45601627, "question_id": 45601522, "link": "https://stackoverflow.com/questions/45601522/open-and-update-an-existing-workbook-with-2-worksheets/45601627#45601627", "title": "Open and update an existing workbook with 2 worksheets", "body": "<p>If you are in Excel VBA, this isn't quite what you want.  This code was written for an external app (say written in VB6) to open Excel remotely and then do stuff to that copy of Excel.  If you are already in Excel/VBA you obviously don't need to do that.</p>\n\n<p>In VBA, the equivalent code would be something like this:</p>\n\n<pre><code>Public Sub MyCode()\n    Dim wb as Workbook\n    Dim ws as Worksheet \n\n    Set wb = Application.Workbooks.Open(\"X:\\GCIXCycleCompare_test_auto.xlsx\")\n    Set ws = wb.Worksheets(\"NewCycle\")\n\n    ws.Rows(1).Delete\nEnd Sub\n</code></pre>\n\n<p>If you run this code (by click F5 from inside VBA ... or by run macro in Excel) it should open up the test file off the X: drive, and then delete the first row of it.</p>\n"}], "owner": {"reputation": 1, "user_id": 8442208, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669720496371959/picture?type=large", "display_name": "Paul S", "link": "https://stackoverflow.com/users/8442208/paul-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502318033, "creation_date": 1502317302, "question_id": 45601522, "link": "https://stackoverflow.com/questions/45601522/open-and-update-an-existing-workbook-with-2-worksheets", "title": "Open and update an existing workbook with 2 worksheets", "body": "<p>This may be simplistic to most of you. I just started using VBA to create and update excel workbooks. I found some code on the internet to open and update an existing workbook and worksheet. Like I said, I am brand new at this.  Does this code even make sense? I just need to know how to open an existing workbook and all the examples I have found aren't working in our environment.Thanks for any help I can get </p>\n\n<pre><code>Dim wbSource, xlApp, srcWorksheet \n\n 'initialize\n Set xlApp = CreateObject(\"Excel.Application\")\n\n 'open source and target files\n Set wbSource = lApp.Workbooks.Open(\"X:\\GCIXCycleCompare_test_auto.xlsx\")\n set srcWorksheet = wbSource.Worksheets(\"NewCycle\")\n srcWorksheet.sheets(\"NewCycle\").Activate\n\n srcWorksheet.Rows(\"1:1\").Delete \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 3, "creation_date": 1502317512, "post_id": 45601385, "comment_id": 78162538, "body": "For a start, move the statement <code>prices.Range(&quot;A:A&quot;).Offset(0, col).Copy stockreturns.Range(&quot;A:A&quot;).Offset(0, 2 * col + 1)</code> to before the loop on <code>n</code>. This will boost tour code by a lot. You were uselessly copying the same column to the same place 260 times."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1502319997, "post_id": 45601385, "comment_id": 78163353, "body": "Why are you coping the cells?   Do you need copy the cells formats? Or just their values?"}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1502323884, "post_id": 45601385, "comment_id": 78164304, "body": "@A.S.H I think the same, not only slow down the code but also might reset the answer."}, {"owner": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "edited": false, "score": 0, "creation_date": 1502368766, "post_id": 45601385, "comment_id": 78186337, "body": "I did move that copy out of the n loop, haven;t tested the code on the full 975 col values yet. Copying the cells just to get the dates and values, as I&#39;m using them to calculate returns on the index."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "edited": false, "score": 0, "creation_date": 1502368620, "post_id": 45602716, "comment_id": 78186218, "body": "Duc, I tested the code with 9 col loops as opposed to 975 and it works. How do I upload the workbook for you to take a look at?"}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "reply_to_user": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "edited": false, "score": 0, "creation_date": 1502435015, "post_id": 45602716, "comment_id": 78217060, "body": "How fun it&#39;s this one down voted. If you want to faster your code hundreds time faster than all solution above then somehow upload your code so I can help you with an optimized method which I studied from this article:<a href=\"http://www.clearlyandsimply.com/clearly_and_simply/2017/04/excel-vba-read-and-write-performance-test.html\" rel=\"nofollow noreferrer\">clearlyandsimply.com/clearly_and_simply/2017/04/&hellip;</a>"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1502556748, "post_id": 45602716, "comment_id": 78263672, "body": "It got downvoted before your edit since it wasn&#39;t an answer in the first place. How funny is it that you actually gave an answer after that happened. Let me give you an upvote since now you actually answered the question."}], "tags": [], "owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1502438253, "last_edit_date": 1502438253, "creation_date": 1502325640, "answer_id": 45602716, "question_id": 45601385, "link": "https://stackoverflow.com/questions/45601385/what-makes-my-code-run-so-slowly/45602716#45602716", "title": "What makes my code run so slowly?", "body": "<p>Before we move on the optimization, let's make sure at least it works. Please check where I comment.\nAssume that code above is correct. And in your code, you just modify to 260 rows so that I set last row to 260. I think this will need deeper debug to work. but if you follow this way, it will end up your program finish much faster (like hundreds of time faster than all normal methods above)\nThe concept is similar.\n1. Dump all data to memory ( array \"stockdata and \"pricedata\")\n2. Play with data in memory\n3. write back to file\n4. add format if required.</p>\n\n<pre><code>Sub fast()\nDim stockdata,pricedata As Variant\n\n    Application.ScreenUpdating = False\n    ' Stop Excel from recalculating the workbook every time a cell value changes\n    Application.Calculation = xlCalculationManual\n    Dim prices As Worksheet, stockreturns As Worksheet, index As Worksheet\n    ' Fully qualify your sheets by specifying the workbook\n    With ThisWorkbook\n        Set index = .Sheets(\"IndexPrices\")\n        Set prices = .Sheets(\"HistPrices\")\n        Set stockreturns = .Sheets(\"Sheet1\")\n    End With\n    ' Assign some last row number so you don't have to be copying the value of tens of thousands of rows\n    ' Previously every values copy was on the entire column, wasting a lot of time!\n    ' Could get this value by a cleverer, more dynamic method, but that depends on needs.\n    Dim lastrow As Long: lastrow = 260\n\n    ' Assign values, don't use copy/paste. Avoiding the clipboard speeds things up\n    stockreturns.Range(\"A1:B\" &amp; lastrow).Value = index.Range(\"A1:B\" &amp; lastrow).Value\n    pricedata = prices.Range(\"A1\",prices.Cells(lastrow,975))\n    redim stockdata(1 to lastrow, 1 to 1952)    \n    For col = 1 To 975\n        'stockreturns.Range(\"A1:A\" &amp; lastrow).Offset(0, 2 * col + 1).Value = prices.Range(\"A1:A\" &amp; lastrow).Offset(0, col).Value\n        for n = 1 to lastrow\n        'offset so that +1\n            stockdata(n,col*2+1+1)  = pricedata(n,col+1)\n        next n\n    next col\n    'done with that\n\n    'check value and change if need\n    For col = 1 To 975\n\n        For n = 2 To 260\n            If stockdata(n + 1, 2 * col) = Null Or IsEmpty(stockdata(n + 1, 2 * col)) Then\n                stockdata(n, 2 * col + 1) = Null\n            Else\n                stockdata(n, 2 * col + 1).Formula = stockdata(n, 2 * col) / stockdata(n + 1, 2 * col) - 1\n                'stockdata(n, 2 * col + 1).NumberFormat = \"0.00%\"\n            End If\n         Next n\n    Next col\n    stockreturns.Range(\"A1\",stockreturns.Cells(lastrow,1952)) = stockdata\n    Dim rng As Range\n    Set rng = stockreturns.Range(\"B1:B\" &amp; lr)\n    For col = 2 To 975\n        Set rng = Union(rng, Range(stockreturns.Cells(1,2*col + 1),stockreturns.Cells(lr,2*col + 1),)\n    next n\n    rng.NumberFormat = \"0.00%\"\n    ' Reset Application settings\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "edited": false, "score": 0, "creation_date": 1502372183, "post_id": 45607607, "comment_id": 78189283, "body": "Wolfie, thanks for this. You&#39;re right about the speed-up. Appreciate the answer."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "edited": false, "score": 0, "creation_date": 1502372978, "post_id": 45607607, "comment_id": 78190013, "body": "Yeah I understand that, happy coding :)"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 0, "last_activity_date": 1502351489, "creation_date": 1502351489, "answer_id": 45607607, "question_id": 45601385, "link": "https://stackoverflow.com/questions/45601385/what-makes-my-code-run-so-slowly/45607607#45607607", "title": "What makes my code run so slowly?", "body": "<p>Assuming your code did what you want, the below redrafting should be much quicker.</p>\n\n<ol>\n<li>Avoid using <code>.Copy</code> wherever possible. Instead directly assign the <code>.Value</code> of cells.</li>\n<li>Make sure your lines of code are within the correct loops to avoid running code more often than it has to be run.</li>\n<li>Stop doing every operation on entire columns, that's <strong>a lot</strong> of cells you're copying, of which 99% will be blank! I've taken the most basic approach possible and chosen to just use the first 1000 rows, improve this as suits - possibly by <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">finding the actual last row</a>.</li>\n<li>Disable the automatic <code>Calculation</code> as well as the <code>ScreenUpdating</code>.</li>\n</ol>\n\n<p>See code comments for details.</p>\n\n<pre><code>Sub fast()\n    Application.ScreenUpdating = False\n    ' Stop Excel from recalculating the workbook every time a cell value changes\n    Application.Calculation = xlCalculationManual\n    Dim prices As Worksheet, stockreturns As Worksheet, index As Worksheet\n    ' Fully qualify your sheets by specifying the workbook\n    With ThisWorkbook\n        Set index = .Sheets(\"IndexPrices\")\n        Set prices = .Sheets(\"HistPrices\")\n        Set stockreturns = .Sheets(\"Sheet1\")\n    End With\n    ' Assign some last row number so you don't have to be copying the value of tens of thousands of rows \n    ' Previously every values copy was on the entire column, wasting a lot of time!\n    ' Could get this value by a cleverer, more dynamic method, but that depends on needs.   \n    Dim lastrow As Long: lastrow = 1000\n    ' Assign values, don't use copy/paste. Avoiding the clipboard speeds things up\n    stockreturns.Range(\"A1:B\" &amp; lastrow).Value = index.Range(\"A1:B\" &amp; lastrow).Value\n    For col = 1 To 975\n        ' This line isn't affected by the value of n, so move it outside the n loop! Again, use .Value not copy\n        stockreturns.Range(\"A1:A\" &amp; lastrow).Offset(0, 2 * col + 1).Value = prices.Range(\"A1:A\" &amp; lastrow).Offset(0, col).Value\n        For n = 2 To 260            \n            If stockreturns.Cells(n + 1, 2 * col).Value = Null Or IsEmpty(stockreturns.Cells(n + 1, 2 * col).Value) Then\n                stockreturns.Cells(n, 2 * col + 1) = Null\n            Else\n                stockreturns.Cells(n, 2 * col + 1).Formula = Cells(n, 2 * col) / Cells(n + 1, 2 * col) - 1\n                stockreturns.Cells(n, 2 * col + 1).NumberFormat = \"0.00%\"\n            End If\n         Next n\n    Next col\n    ' Reset Application settings\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "edited": false, "score": 0, "creation_date": 1502366815, "post_id": 45609520, "comment_id": 78184803, "body": "Rick, thanks so much for this detailed answer. I will have to try this code out to make sure it fits my data, but it looks much better than what I currently have. If someone could let me know how to upload the workbook here, I&#39;d like to do that so you guys can get an idea of what I&#39;m attempting to do with the code."}, {"owner": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "edited": false, "score": 0, "creation_date": 1502372272, "post_id": 45609520, "comment_id": 78189379, "body": "@Rik Sportel whoops I didn&#39;t notify you on the last one"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502372313, "post_id": 45609520, "comment_id": 78189405, "body": "@Rik, good breakdown of the task to speed things up. You should also avoid <code>.Copy</code> operations - see my answer."}, {"owner": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502372506, "post_id": 45609520, "comment_id": 78189585, "body": "@Wolfie, where can I upload it so that people can see what my end goal is?"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502372940, "post_id": 45609520, "comment_id": 78189981, "body": "Dropbox, Google Drive... wherever you like that you can link to. You&#39;ll be lucky to find someone who wants to invest time looking through your workbook though, I would think most of the speed improvements have been mentioned on this page already!"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502374440, "post_id": 45609520, "comment_id": 78191263, "body": "@Wolfie Depends. If he only needs the values, then value assignment is faster. If he needs the markup as well, then copying is faster. The key is to access the Objects in the Worksheet(s) as little as possible, since VBA will do an IO operation for each nested object.  I didn&#39;t write it in the Answer, but using <code>With</code> is also an optimization in that respect, since the worksheet itself will be in memory during that code block."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502376372, "post_id": 45609520, "comment_id": 78192870, "body": "Yeah well if we were going really crazy about avoiding IO then we need to leverage arrays, but I don&#39;t think this process can be <i>that</i> slow! ;)"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1502356931, "creation_date": 1502356931, "answer_id": 45609520, "question_id": 45601385, "link": "https://stackoverflow.com/questions/45601385/what-makes-my-code-run-so-slowly/45609520#45609520", "title": "What makes my code run so slowly?", "body": "<p><strong>Main issue:</strong></p>\n\n<p>This nested loop of yours executes 975 * 260 = 253.500 times:</p>\n\n<pre><code>For col = 1 To 975\n    For n = 2 To 260\n        prices.Range(\"A:A\").Offset(0, col).Copy stockreturns.Range(\"A:A\").Offset(0, 2 * col + 1)\n        If stockreturns.Cells(n + 1, 2 * col).Value = Null Or IsEmpty(stockreturns.Cells(n + 1, 2 * col).Value) Then\n            stockreturns.Cells(n, 2 * col + 1) = Null\n        Else\n            stockreturns.Cells(n, 2 * col + 1).Formula = Cells(n, 2 * col) / Cells(n + 1, 2 * col) - 1\n            stockreturns.Cells(n, 2 * col + 1).NumberFormat = \"0.00%\"\n        End If\n     Next n\nNext col\n</code></pre>\n\n<p><strong>Summary of what you're doing, according to code in the question:</strong></p>\n\n<p>Basically, what you're doing is get column B, C, D, etc. and copy them to D, E, G, etc. using the offset. Next you check in the stockreturns worksheet what the value of the copied cell in the next row is (e.g. you check D3, then D4 etc.) and based on that populate E2, E3, etc. with nulls, or, alternatively you take ((D2 / D3) - 1) as a value there. The initial check is to avoid division by zero errors, I assume.</p>\n\n<p><strong>Note:</strong> \nIn those lines in your code you refer to <code>Cells(n, 2 * col)</code> so that would always be the <code>ActiveSheet</code>, whereas I assume you want to populate the worksheet <code>stockreturns</code> with those values. I.e. if you run the formula with worksheet <code>prices</code> activated, the formula's won't give the desired output.</p>\n\n<p><strong>Working towards solution:</strong></p>\n\n<p>For sure it would be way faster to not do 253.500 loops, but to populate everything at once for as far as possible. Since the column number varies everytime, we'll leave that loop in, but the nested 260 loops we can easily get rid of:</p>\n\n<p><strong>Optimization to do 975 loops instead of 253.500:</strong></p>\n\n<pre><code>With stockreturns\n    For col = 1 To 975\n        prices.Range(\"A:A\").Offset(0, col).Copy .Range(\"A:A\").Offset(0, 2 * col + 1)\n        'Now we fill up the entire 260 rows at once using a relative formula:\n        .Range(.Cells(2, 2 * col + 1), .Cells(260, 2 * col + 1)).FormulaR1C1 = \"=IF(R[+1]C[-1]=\"\"\"\",\"\"\"\",(RC[-1]/R[+1]C[-1])-1)\"\n        'If you want a value instead of a formula, we replace the formula's with the value. If calculation is set to manual, you'll have to add an Application.Calculate here.\n        .Range(.Cells(2, 2 * col + 1), .Cells(260, 2 * col + 1)).Value = .Range(.Cells(2, 2 * col + 1), .Cells(260, 2 * col + 1)).Value\n        .Range(.Cells(2, 2 * col + 1), .Cells(260, 2 * col + 1)).NumberFormat = \"0.00%\"\n    Next col\nEnd With\n</code></pre>\n\n<p>This will already save major execution time. However, we can also save ourselves 975 calculate actions, by turning off calculations and only replacing the formulas with the values at the very end:</p>\n\n<p><strong>Second optimization to avoid calculations during execution:</strong></p>\n\n<pre><code>Application.Calculation = xlCalculationManual\nWith stockreturns\n    For col = 1 To 975\n        prices.Range(\"A:A\").Offset(0, col).Copy .Range(\"A:A\").Offset(0, 2 * col + 1)\n        'Now we fill up the entire 260 rows at once using a relative formula:\n        .Range(.Cells(2, 2 * col + 1), .Cells(260, 2 * col + 1)).FormulaR1C1 = \"=IF(R[+1]C[-1]=\"\"\"\",\"\"\"\",(RC[-1]/R[+1]C[-1])-1)\"\n        .Range(.Cells(2, 2 * col + 1), .Cells(260, 2 * col + 1)).NumberFormat = \"0.00%\"\n    Next col\nEnd With\nApplication.Calculate\nstockreturns.UsedRange.value = stockreturns.UsedRange.value\n</code></pre>\n\n<p>This last version runs in seconds.\nIf it is acceptable for you to alter the <code>stockreturns</code> worksheet layout and use a continuous range to copy to at once, you won't need those 975 loops either but you can achieve the desired result with the following actions:</p>\n\n<ul>\n<li>Copy prices range</li>\n<li>Add the formula in another range</li>\n<li>Calculate</li>\n<li>Replace formulas with values</li>\n<li>Set numberformat</li>\n</ul>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 43, "user_id": 8414763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc7ada09b6fe5149420e3e41b29dfac?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/8414763/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 45607607, "answer_count": 3, "score": 0, "last_activity_date": 1502438253, "creation_date": 1502316525, "last_edit_date": 1531164843, "question_id": 45601385, "link": "https://stackoverflow.com/questions/45601385/what-makes-my-code-run-so-slowly", "title": "What makes my code run so slowly?", "body": "<p>As I said in the title, I'm wondering if someone can help me figure out why my code is running so slowly (Ran for an hour with no result). I'm very new when it comes to writing in VBA, but I don't see a reason why it would take so long. Here is the code in question: </p>\n\n<pre><code>Sub fast()\nApplication.ScreenUpdating = False\n\nDim prices As Worksheet\nDim stockreturns As Worksheet\nDim index As Worksheet\nDim stockprices As Range\n\nSet index = Worksheets(\"IndexPrices\")\nSet prices = Worksheets(\"HistPrices\")\nSet stockreturns = Worksheets(\"Sheet1\")\n\nindex.Range(\"A:B\").Copy stockreturns.Range(\"A:B\")\n\nFor col = 1 To 975\n    For n = 2 To 260\n        prices.Range(\"A:A\").Offset(0, col).Copy stockreturns.Range(\"A:A\").Offset(0, 2 * col + 1)\n        If stockreturns.Cells(n + 1, 2 * col).Value = Null Or IsEmpty(stockreturns.Cells(n + 1, 2 * col).Value) Then\n            stockreturns.Cells(n, 2 * col + 1) = Null\n        Else\n            stockreturns.Cells(n, 2 * col + 1).Formula = Cells(n, 2 * col) / Cells(n + 1, 2 * col) - 1\n            stockreturns.Cells(n, 2 * col + 1).NumberFormat = \"0.00%\"\n        End If\n     Next n\nNext col\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I'd be happy to post the workbook if anyone wants to see what I'm trying to accomplish in the sheet and potentially suggest a different or more efficient way of doing it. Thanks.</p>\n"}, {"tags": ["vba", "session", "sap"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502321443, "post_id": 45601267, "comment_id": 78163733, "body": "Would help you get suggestions if you include your code."}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1502371401, "post_id": 45601267, "comment_id": 78188548, "body": "First, let us know how it came about with your question and the solution before.: Different Script (SAP GUI) Codes for the same process in two different Computers"}, {"owner": {"reputation": 5, "user_id": 8366198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9104610e11d28e6338902cee0e516ce?s=128&d=identicon&r=PG&f=1", "display_name": "user8366198", "link": "https://stackoverflow.com/users/8366198/user8366198"}, "edited": false, "score": 0, "creation_date": 1502372399, "post_id": 45601267, "comment_id": 78189484, "body": "ScriptMan, could&#180;t follow those steps that appear when I google it, not sure if it&#39;s because I don&#39;t have permission (I am not the adminsitrator) or it is just that I am not searching the right way in SAP."}], "answers": [{"tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": true, "score": 0, "last_activity_date": 1504190262, "creation_date": 1504190262, "answer_id": 45984142, "question_id": 45601267, "link": "https://stackoverflow.com/questions/45601267/sap-gui-macro-doesnt-work-when-i-had-more-than-one-session-open-at-the-same-time/45984142#45984142", "title": "SAP GUI Macro doesnt work when I had more than one session open at the same time", "body": "<p>You could test the following workaround:</p>\n\n<pre><code>&gt; Sub SAP()\n\n'Macro desarrollada por Marketing\nDim application\nDim connection\n\n\nIf Not IsObject(application) Then\n Set SapGuiAuto  = GetObject(\"SAPGUI\")\n Set application = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(connection) Then\n Set connection = application.Children(0)\nEnd If\n\nmsgbox \"Please select a session within the next 5 seconds\"\nwscript.sleep 5000\nset session = application.ActiveSession\nif session is nothing then Set session = connection.Children(0)\n\n\nSheets(\"Carga\").Select\n. . .\n</code></pre>\n\n<p>This link could also be of interest to you:</p>\n\n<p><a href=\"https://archive.sap.com/discussions/thread/1730563\" rel=\"nofollow noreferrer\">https://archive.sap.com/discussions/thread/1730563</a></p>\n\n<p>Regards,\nScriptMan</p>\n"}], "owner": {"reputation": 5, "user_id": 8366198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9104610e11d28e6338902cee0e516ce?s=128&d=identicon&r=PG&f=1", "display_name": "user8366198", "link": "https://stackoverflow.com/users/8366198/user8366198"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1840, "favorite_count": 0, "accepted_answer_id": 45984142, "answer_count": 1, "score": 0, "last_activity_date": 1504190262, "creation_date": 1502315874, "last_edit_date": 1502376397, "question_id": 45601267, "link": "https://stackoverflow.com/questions/45601267/sap-gui-macro-doesnt-work-when-i-had-more-than-one-session-open-at-the-same-time", "title": "SAP GUI Macro doesnt work when I had more than one session open at the same time", "body": "<p>I had develop a macro which search some information in SAP(SAP GUI)and copy it in a excel worksheet, but sadly it only works if I had open ONLY ONE session.\nEven if I try to create a new session by code(\"session.createSession\"), the next steps(the important ones) are done in the first session that had been open before, for instance, it enters a code in a text box that doesn't exist in that screen and as a consecuence it appears an error.\nI know I can solve this by closing all sessions before run this macro, but I do believe that there is a better option for this. Hope you guys can help me with this.</p>\n\n<p>This is the macro:</p>\n\n<pre><code>&gt; Sub SAP()\n\n'Macro desarrollada por Marketing\nDim application\nDim connection\n\nIf Not IsObject(application) Then\n   Set SapGuiAuto = GetObject(\"SAPGUI\")\n   Set application = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(connection) Then\n   Set connection = application.Children(0)\nEnd If\nIf Not IsObject(session) Then\n   Set session = connection.Children(0)\nEnd If\nIf IsObject(WScript) Then\n   WScript.ConnectObject session, \"on\"\n   WScript.ConnectObject application, \"on\"\n\n\nEnd If\nSheets(\"Carga\").Select\nRange(\"A2\", Range(\"P\" &amp; Rows.Count).End(xlUp).Address).Sort Key1:=[K2], Order1:=xlAscending, Header:=xlYes\n\nSheets(\"Carga\").Select\nRange(\"a2\").Select\nSelection.Copy\nSheets(\"Consulta\").Select\nRange(\"c5\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\nSheets(\"Carga\").Select\nRange(\"m2\").Select\nSelection.Copy\nSheets(\"Consulta\").Select\nRange(\"c6\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n'C\u00f3digo y producto\n    Sheets(\"Consulta\").Select\n    Range(\"B9\").Select\n    Sheets(\"Carga\").Select\n    Range(\"b2:C2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Consulta\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n'lote y paquete\n    Sheets(\"Carga\").Select\n    Range(\"e2:F2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Consulta\").Select\n    Range(\"g9\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n'Peso y Unidad\nSheets(\"Carga\").Select\n    Range(\"G2:H2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Consulta\").Select\n    Range(\"i9\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n'Entrega\nSheets(\"Carga\").Select\n    Range(\"k2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"Consulta\").Select\n    Range(\"D9\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n'Sheets(\"Carga\").Select\n '   Range(\"M2\").Select\n  '  Range(Selection, Selection.End(xlDown)).Select\n   ' Selection.Copy\n    'Sheets(\"Consulta\").Select\n    'Range(\"I9\").Select\n    'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\n'Copiar todos los valores de las remesas y eliminar los que se repiten\nSheets(\"Consulta\").Select\nRange(\"d9\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"BusquedaSAP\").Select\n    Range(\"A2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n'Eliminar las remesas duplicadas\n\nActiveSheet.Range(\"A:A\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n\n'Comenzar la b\u00fasqueda de Factura SAP a partir de las remesas\n\nSheets(\"BusquedaSAP\").Select\nFor K = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n\n'Si no hay datos, parar la macro\n\nIf IsEmpty(Range(\"A\" &amp; K)) Then\n\n'Volver a la p\u00e1gina de inicio de SAP\n\nsession.findById(\"wnd[0]/tbar[0]/btn[12]\").press\n\nExit Sub\n\nSheets(\"Consulta\").Select\n\nEnd If\n\nsession.findById(\"wnd[0]\").maximize\nsession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"VL03N\"\nsession.findById(\"wnd[0]\").sendVKey 0\nsession.findById(\"wnd[0]/usr/ctxtLIKP-VBELN\").Text = Sheets(\"BusquedaSAP\").Range(\"A\" &amp; K).Text\nsession.findById(\"wnd[0]\").sendVKey 0\n'Click en Flujo de Documentos(F7)\nsession.findById(\"wnd[0]/tbar[1]/btn[7]\").press\n'la segunda siempre es la remesa\nsession.findById(\"wnd[0]/usr/shell/shellcont[1]/shell[1]\").selectItem \"          2\", \"&amp;Hierarchy\"\nsession.findById(\"wnd[0]/tbar[1]/btn[8]\").press\nsession.findById(\"wnd[0]/tbar[1]/btn[8]\").press\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\07\").Select\nguiasider = session.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\07/ssubSUBSCREEN_BODY:SAPMV50A:2110/txtLIKP-XBLNR\").Text\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\07/ssubSUBSCREEN_BODY:SAPMV50A:2110/txtLIKP-XBLNR\").SetFocus\nWorksheets(\"BusquedaSAP\").Range(\"C\" &amp; K) = guiasider\nsession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\nsession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\n\n'Click en Bot\u00f3n buscar\nsession.findById(\"wnd[0]/usr/shell/shellcont[1]/shell[0]\").pressButton \"&amp;FIND\"\n'Ingresar \"Documento Contable en el campo de b\u00fasqueda\nsession.findById(\"wnd[1]/usr/txtLVC_S_SEA-STRING\").Text = \"GT - Factura\"\n'Dar click en aceptar varias veces\nsession.findById(\"wnd[1]/tbar[0]/btn[0]\").press\nsession.findById(\"wnd[1]/tbar[0]/btn[0]\").press\nsession.findById(\"wnd[1]\").Close\nsession.findById(\"wnd[0]/tbar[1]/btn[8]\").press\n\n'Buscar numero de Factura SAP\nfacturaSAP = session.findById(\"wnd[0]/usr/ctxtVBRK-VBELN\").Text\nsession.findById(\"wnd[0]/usr/ctxtVBRK-VBELN\").SetFocus\nWorksheets(\"BusquedaSAP\").Range(\"B\" &amp; K) = facturaSAP\nsession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\n'Si es la primera remesa que busque todos los datos\nIf K = 2 Then\n'Click en la lupa\n\nsession.findById(\"wnd[0]/usr/shell/shellcont[1]/shell[1]\").selectItem \"          1\", \"&amp;Hierarchy\"\nsession.findById(\"wnd[0]/tbar[1]/btn[8]\").press\nsession.findById(\"wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/btnBT_HEAD\").press\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\07\").Select\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\07/ssubSUBSCREEN_BODY:SAPMV45A:4352/subSUBSCREEN_PARTNER_OVERVIEW:SAPLV09C:1000/cmbGV_FILTER\").SetFocus\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\07/ssubSUBSCREEN_BODY:SAPMV45A:4352/subSUBSCREEN_PARTNER_OVERVIEW:SAPLV09C:1000/cmbGV_FILTER\").Key = \"PAREH\"\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\07/ssubSUBSCREEN_BODY:SAPMV45A:4352/subSUBSCREEN_PARTNER_OVERVIEW:SAPLV09C:1000/tblSAPLV09CGV_TC_PARTNER_OVERVIEW/txtGVS_TC_DATA-REC-NAME1[2,0]\").SetFocus\nsession.findById(\"wnd[0]\").sendVKey 2\n'Tomar valor de cliente\ncliente = session.findById(\"wnd[1]/usr/subGCS_ADDRESS:SAPLSZA1:0300/subCOUNTRY_SCREEN:SAPLSZA1:0301/txtADDR1_DATA-NAME1\").Text\nsession.findById(\"wnd[1]/usr/subGCS_ADDRESS:SAPLSZA1:0300/subCOUNTRY_SCREEN:SAPLSZA1:0301/txtADDR1_DATA-NAME1\").SetFocus\ncliente1 = session.findById(\"wnd[1]/usr/subGCS_ADDRESS:SAPLSZA1:0300/subCOUNTRY_SCREEN:SAPLSZA1:0301/txtADDR1_DATA-NAME2\").Text\nsession.findById(\"wnd[1]/usr/subGCS_ADDRESS:SAPLSZA1:0300/subCOUNTRY_SCREEN:SAPLSZA1:0301/txtADDR1_DATA-NAME2\").SetFocus\nsession.findById(\"wnd[1]/tbar[0]/btn[0]\").press\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\07/ssubSUBSCREEN_BODY:SAPMV45A:4352/subSUBSCREEN_PARTNER_OVERVIEW:SAPLV09C:1000/tblSAPLV09CGV_TC_PARTNER_OVERVIEW/txtGVS_TC_DATA-REC-NAME1[2,3]\").SetFocus\nsession.findById(\"wnd[0]\").sendVKey 2\ndestinatario = session.findById(\"wnd[1]/usr/subGCS_ADDRESS:SAPLSZA1:0300/subCOUNTRY_SCREEN:SAPLSZA1:0301/txtADDR1_DATA-NAME1\").Text\nsession.findById(\"wnd[1]/usr/subGCS_ADDRESS:SAPLSZA1:0300/subCOUNTRY_SCREEN:SAPLSZA1:0301/txtADDR1_DATA-NAME1\").SetFocus\ndestinatario1 = session.findById(\"wnd[1]/usr/subGCS_ADDRESS:SAPLSZA1:0300/subCOUNTRY_SCREEN:SAPLSZA1:0301/txtADDR1_DATA-NAME2\").Text\nsession.findById(\"wnd[1]/usr/subGCS_ADDRESS:SAPLSZA1:0300/subCOUNTRY_SCREEN:SAPLSZA1:0301/txtADDR1_DATA-NAME2\").SetFocus\nsession.findById(\"wnd[0]/tbar[0]/btn[12]\").press\nsession.findById(\"wnd[0]/tbar[0]/btn[12]\").press\n'tomar valor de empresa de transportes\nsession.findById(\"wnd[0]/usr/shell/shellcont[1]/shell[1]\").selectItem \"          3\", \"&amp;Hierarchy\"\nsession.findById(\"wnd[0]/tbar[1]/btn[8]\").press\n'En esta parte se selecciona la empresa de transporte, pero no todos lo tienen y arroja un error, por eso no se considera\n'session.findById(\"wnd[0]/usr/tabsHEADER_TABSTRIP1/tabpTABS_OV_PR/ssubG_HEADER_SUBSCREEN1:SAPMV56A:1021/btnB_PR_ADR\").press\n'empresatransporte = session.findById(\"wnd[1]/usr/txtADDR1_DATA-NAME1\").Text\n'session.findById(\"wnd[1]/usr/txtADDR1_DATA-NAME1\").SetFocus\n'empresatransporte1 = session.findById(\"wnd[1]/usr/txtADDR1_DATA-NAME2\").Text\n'session.findById(\"wnd[1]/usr/txtADDR1_DATA-NAME2\").SetFocus\n'session.findById(\"wnd[0]/tbar[0]/btn[12]\").press\n'Selecciona el nombre del transportista\ntransportista = session.findById(\"wnd[0]/usr/tabsHEADER_TABSTRIP1/tabpTABS_OV_PR/ssubG_HEADER_SUBSCREEN1:SAPMV56A:1021/ctxtVTTK-EXTI1\").Text\nsession.findById(\"wnd[0]/usr/tabsHEADER_TABSTRIP1/tabpTABS_OV_PR/ssubG_HEADER_SUBSCREEN1:SAPMV56A:1021/ctxtVTTK-EXTI1\").SetFocus\n\n\nWorksheets(\"BusquedaSAP\").Range(\"d2\") = cliente &amp; \" \" &amp; cliente1\nWorksheets(\"BusquedaSAP\").Range(\"e2\") = destinatario &amp; \" \" &amp; destinatario1\nWorksheets(\"BusquedaSAP\").Range(\"f2\") = empresatransporte &amp; \" \" &amp; empresatransporte1\nWorksheets(\"BusquedaSAP\").Range(\"g2\") = transportista\nsession.findById(\"wnd[0]/tbar[0]/btn[15]\").press\nsession.findById(\"wnd[0]/tbar[0]/btn[15]\").press\nsession.findById(\"wnd[0]/tbar[0]/btn[15]\").press\nEnd If\n\n\nsession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\nsession.findById(\"wnd[0]/tbar[0]/btn[12]\").press\nsession.findById(\"wnd[0]/tbar[0]/btn[12]\").press\n\n\nNext K\n\n\nSheets(\"Consulta\").Activate\n\nRange(\"e9\").Select\nSelection.Copy\n\nFor i = 9 To Cells(Rows.Count, 4).End(xlUp).Row\n\n\nIf Range(\"B\" &amp; i) &lt;&gt; Empty Then\n\nIf i = 9 Then\n\nRange(\"A\" &amp; i) = 1\n\n\nElse\n\n\nRange(\"A\" &amp; i) = Range(\"A\" &amp; i - 1) + 1\nRange(\"e9\").Select\nSelection.Copy\nRange(\"E\" &amp; i).Select\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\nRange(\"f9\").Select\nSelection.Copy\nRange(\"f\" &amp; i).Select\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n\nEnd If\nEnd If\n\nNext i\n\nSheets(\"Consulta\").Activate\nRange(\"O16\").Select\n\n Selection.Copy\nRange(Cells(Rows.Count, 5).End(xlUp).Offset(1, -4), Cells(39, 13)).Select\nSelection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n Range(\"a9:m9\").Select\nSelection.Copy\nRange(Cells(10, 1), Cells(Rows.Count, 5).End(xlUp).Offset(0, 8)).Select\nSelection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nRange(\"a10\").Select\n\n'application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>Cheers </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1502314965, "post_id": 45601001, "comment_id": 78161535, "body": "Are you trying to match against a field named <code>xyz</code>? Or are you trying to match against the string value <code>&quot;xyz&quot;</code>? If the latter, then you need to escape quotation marks within the expression: <code>DCount(&quot;[Squadron]&quot;, &quot;tblIGEMS&quot;, &quot;[Squadron] = &#39;xyz&#39;&quot;)</code>, or <code>DCount(&quot;[Squadron]&quot;, &quot;tblIGEMS&quot;, &quot;[Squadron] = &quot;&quot;xyz&quot;&quot;&quot;)</code> (see <a href=\"https://github.com/zspitz/VBA-content/blob/eef7d8a5ad1a24f7f66c64b129d96de7d5580032/VBA/Language-Reference-VBA/articles/string-data-type.md\" rel=\"nofollow noreferrer\">here</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8442129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e73fc24e69f8ac1490514d89f41ba5d?s=128&d=identicon&r=PG&f=1", "display_name": "Huey462", "link": "https://stackoverflow.com/users/8442129/huey462"}, "edited": false, "score": 0, "creation_date": 1502393482, "post_id": 45607372, "comment_id": 78203703, "body": "Thank you very much!  &quot;XYZ&quot; is the text I will change for the different units, your solution worked perfectly"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1502350751, "creation_date": 1502350751, "answer_id": 45607372, "question_id": 45601001, "link": "https://stackoverflow.com/questions/45601001/dcount-in-access-vba/45607372#45607372", "title": "DCount in Access VBA", "body": "<p>If xyz is fixed:</p>\n\n<pre><code>DCount(\"*\", \"tblIGEMS\", \"[Squadron] = 'xyz'\")\n</code></pre>\n\n<p>If xyz is a variable in code:</p>\n\n<pre><code>DCount(\"*\", \"tblIGEMS\", \"[Squadron] = '\" &amp; xyz &amp; \"'\")\n</code></pre>\n\n<p>If xyz is a field:</p>\n\n<pre><code>DCount(\"*\", \"tblIGEMS\", \"[Squadron] = '\" &amp; [xyz] &amp; \"'\")\n</code></pre>\n\n<p>If xyz is a control on a form:</p>\n\n<pre><code>DCount(\"*\", \"tblIGEMS\", \"[Squadron] = '\" &amp; [Forms]![YourFormName]![xyz] &amp; \"'\")\n</code></pre>\n\n<p>If Squadron is numeric, remove the single-quotes.</p>\n"}], "owner": {"reputation": 1, "user_id": 8442129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e73fc24e69f8ac1490514d89f41ba5d?s=128&d=identicon&r=PG&f=1", "display_name": "Huey462", "link": "https://stackoverflow.com/users/8442129/huey462"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5654, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593588277, "creation_date": 1502314572, "last_edit_date": 1593588277, "question_id": 45601001, "link": "https://stackoverflow.com/questions/45601001/dcount-in-access-vba", "title": "DCount in Access VBA", "body": "<p>I have a table that I would like to perform a counting operation to summarize its contents.  The DCount function should work, but I cannot get the syntax correct even though it appears to match examples that I have found online.\nTable: tblIGEMS\nField to Sum from: Squadron</p>\n\n<p>VBA Formula:</p>\n\n<pre><code>DCount(\"[Squadron]\", \"tblIGEMS\", \"[Squadron] = xyz\")\n</code></pre>\n\n<p>Any help would be greatly appreciated</p>\n"}, {"tags": ["html", "vba", "xmlhttprequest", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1502363760, "post_id": 45601329, "comment_id": 78182445, "body": "Thanks, and also how do I upload/save the updated document to the actual document on the server?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "edited": false, "score": 0, "creation_date": 1502369898, "post_id": 45601329, "comment_id": 78187255, "body": "@Steven if you are going to save it in local drive you can save it as html file like <code>ActiveDocument.SaveAs Filename:=path FileFormat:=xlHtml</code> But it is not that simple. I am not professional about this but any images, CSS files, other attachments etc. also should be saved. However there is no need to do that if you are going to upload it to server. You can <a href=\"https://officetricks.com/ftp-server-file-transfer-with-excel-macro/\" rel=\"nofollow noreferrer\">transfer the file to server though FTP</a> to the best of my knowledge."}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": true, "score": 2, "last_activity_date": 1502316228, "creation_date": 1502316228, "answer_id": 45601329, "question_id": 45600980, "link": "https://stackoverflow.com/questions/45600980/how-to-edit-html-files-with-word-vba-xmlhttp-object/45601329#45601329", "title": "How to edit HTML files with Word VBA XMLHTTP object", "body": "<p>For latest versions of MS Office you can use <code>Microsoft XML, v 6.0</code> and <code>Microsoft HTML Object Library</code></p>\n\n<p>In VBA window, select <code>Tools -&gt; References -&gt; Microsoft XML, v 6.0</code> and \n<code>Tools -&gt; References -&gt; Microsoft HTML Object Library</code></p>\n\n<p>Try the following code:</p>\n\n<pre><code>Sub parse()\nDim http As New MSXML2.XMLHTTP60\nDim html As New HTMLDocument\nDim htmlread As String\n\nWith CreateObject(\"MSXML2.serverXMLHTTP\")\n    .Open \"GET\", \"http://www.google.com\", False\n    .send\n    htmlread = .responseText\nEnd With\n\nhtml.body.innerHTML = htmlread 'raw full source code\nDebug.Print html.body.innerHTML\n\n'..{htmlread string is modified using VBA methods like Replace}...\n\nhtml.body.innerHTML = htmlread 'edited source code\nDebug.Print html.body.innerHTML\n\nSet html = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 8098332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e88e220e4eba627ef9abf0cf71768da0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8098332/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 45601329, "answer_count": 1, "score": 1, "last_activity_date": 1502319909, "creation_date": 1502314490, "last_edit_date": 1502319909, "question_id": 45600980, "link": "https://stackoverflow.com/questions/45600980/how-to-edit-html-files-with-word-vba-xmlhttp-object", "title": "How to edit HTML files with Word VBA XMLHTTP object", "body": "<p>I'm writing a Word VBA macro that ultimately creates a HTML file equivalent. After this HTML file is created, I want to put it's bare HTML code in a string for further editing (in the same macro script). All my files I'm dealing with are accessed with HTTP requests to a local server, not to a local drive. \nHere's some code I have:</p>\n\n<pre><code>...{other code}...\nDim httpreq as Object\nDim htmlread as String\nSet httpreq = CreateObject(\"MSXML.XMLHTTP\")\n...{other code}...\nActiveDocument.SaveAs2 FileName := HTMLFilePath, FileFormat: wdFormatFilteredHTML\nhttpreq.Open \"POST\", HTMLFilePath, False\nhttpreq.send\nhtmlread = httpreq.responseText\n\n..{htmlread string is modified using VBA methods like Replace}...\n</code></pre>\n\n<p>How do I overwrite HTMLFilePath file with modified string using HTTP methods?</p>\n"}, {"tags": ["vba", "excel", "nonblank"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502314483, "post_id": 45600927, "comment_id": 78161331, "body": "<code>.PasteSpecial xlPasteValues</code> ? or maybe <code>xlPasteValuesAndNumberFormats</code>.."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502316514, "post_id": 45600927, "comment_id": 78162182, "body": "you could use <code>Range.Find</code> to get the first cell with <code>&quot;&quot;</code> in a set range like <code>Columns(1)</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502316907, "post_id": 45600927, "comment_id": 78162329, "body": "@DirkReichel - How? I keep trying that, but it skips the <code>=&quot;&quot;</code> rows and goes to the first literally empty cell."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1502320489, "post_id": 45600927, "comment_id": 78163491, "body": "@BruceWayne Were you looking in <code>xlValues</code> or <code>xlFormulas</code>?  (e.g. <code>Columns(3).Find(What:=&quot;&quot;, LookIn:=xlValues, LookAt:=xlWhole)</code> should work - it does for me.)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502327554, "post_id": 45600927, "comment_id": 78165176, "body": "@YowE3K - ...Well, I didn&#39;t specify, so I suppose it was <code>xlValues</code>. Let me revisit what I was trying and report back. I&#39;d like to make my answer better, and not just loop through cells.  In my mind this could be a two-liner at most."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1502327892, "last_edit_date": 1502327892, "creation_date": 1502317257, "answer_id": 45601513, "question_id": 45600927, "link": "https://stackoverflow.com/questions/45600927/first-blank-cell-in-column-with-if-formula/45601513#45601513", "title": "First blank (&quot;&quot;) cell in column with IF formula", "body": "<p>After trying to be fancy with <code>SpecialCells()</code>, or using <code>Find()</code> or something I couldn't get it ...so here's a rather \"dirty\" way to do it:</p>\n\n<pre><code>Sub test()\nDim lastRow As Long, lastFormulaRow As Long\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nDim i As Long\nFor i = lastRow To 1 Step -1\n    If Cells(i, 1).Formula &lt;&gt; \"\" And Cells(i, 1).Value = \"\" Then\n        lastFormulaRow = i\n        Exit For\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Edit2:  Here's one using <code>.SpecialCells()</code>. Granted I <em>think</em> we can whittle this down more, I like it better:</p>\n\n<pre><code>Sub lastRow()\nDim tempLastRow As Long\ntempLastRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row \n\nDim lastRow As Range\nSet lastRow = Columns(3).SpecialCells(xlCellTypeFormulas).Find(What:=\"\", LookIn:=xlValues, LookAt:=xlWhole, searchdirection:=xlPrevious, after:=Range(\"C\" &amp; tempLastRow))\nDebug.Print lastRow.Row\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ERtQI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ERtQI.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>It returns <code>10</code> as the row.</p>\n\n<p>Edit: <strong>Be sure</strong> to add the sheet references before <code>Range()</code> and <code>Cells()</code> to get the last row. Otherwise, it's going to look at your active sheet to get the info.</p>\n"}], "owner": {"reputation": 31, "user_id": 8441990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c0111189c7257194b1d16a8051c63e?s=128&d=identicon&r=PG&f=1", "display_name": "KJohn", "link": "https://stackoverflow.com/users/8441990/kjohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 634, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1502327892, "creation_date": 1502314242, "last_edit_date": 1502320089, "question_id": 45600927, "link": "https://stackoverflow.com/questions/45600927/first-blank-cell-in-column-with-if-formula", "title": "First blank (&quot;&quot;) cell in column with IF formula", "body": "<p>I have a macro that exactly copies one sheet's data into another.</p>\n\n<pre><code>Sub QuickViewRegMgmt()\n\n    (\"Reg Management\").Select\n    Cells.Select\n    Selection.Copy\n    Sheets(\"Quick View Reg Mgmt\").Select\n    Cells.Select\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>I would like for this macro to also go to the last non-blank cell in Column C (or first blank, I really don't care either way). I tried simple end/offset code, e.g.</p>\n\n<pre><code>Range(\"A1\").End(xldown).Offset(1,0).Select \n</code></pre>\n\n<p>My problem, however, is that the direct copy macro also copies the underlying formulas, which for Column C is an IF formula. Therefore, no cell in the column is actually empty, but rather they all have an IF formula resulting in a true/false value (respectively, a \"\" or VLOOKUP).</p>\n\n<pre><code>=IF(VLOOKUP('Reg Management'!$Y260,'Reg Guidance'!$A:$V,3,FALSE)=0,\"\",VLOOKUP('Reg Management'!$Y260,'Reg Guidance'!$A:$V,3,FALSE))\n</code></pre>\n\n<p>That means the end/offset code goes to the last cell in the column with the formula (C1000) instead of going to the first cell that has a value of \"\" (which is currently C260).</p>\n\n<p>What code can I add to this macro to select the first cell that contains an IF formula resulting in a value of \"\" ---- which has the appearance of being blank?</p>\n"}, {"tags": ["vba", "web-crawler"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1502313660, "post_id": 45600774, "comment_id": 78160968, "body": "Is it by IE object?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8401417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4e88c260085fb386e86af5d074104d?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8401417/den"}, "edited": false, "score": 0, "creation_date": 1502314016, "post_id": 45600846, "comment_id": 78161116, "body": "Thank you, I will try this."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502314459, "post_id": 45600846, "comment_id": 78161327, "body": "@Tehscript, just to clarify for readers, the <i>search</i> and  <i>search-disabled</i> are both class names, and each could be found by the <code>getElementsByClassName</code> method. the code snippet looks for the class name that is always there (<i>search</i>) and checks if the second class name is assigned to the node that is found"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502314649, "post_id": 45600846, "comment_id": 78161405, "body": "@jsotola indeed, thank you for clarification. I am not good at technically explaining things."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502315095, "post_id": 45600846, "comment_id": 78161592, "body": "@Tehscript, me too. i had to double check on the web before i  posted the comment"}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": true, "score": 0, "last_activity_date": 1502313802, "creation_date": 1502313802, "answer_id": 45600846, "question_id": 45600774, "link": "https://stackoverflow.com/questions/45600774/how-to-detect-if-button-is-disabled-in-source/45600846#45600846", "title": "How to detect if button is disabled in source", "body": "<p>The first word before space is the class name you should go for (<code>search</code> and <code>reset</code>). You can extract the current class name by `className property and check if it has the keyword you are looking for. Supposing that you are using IE object and it is the first element in the source code, a sample code should look like this:</p>\n\n<pre><code>Set btn = ie.document.getElementsByClassName(\"search\")(0)\nIf InStr(1, btn.className, \"search-disabled\", vbTextCompare) Then\n    'your code when button is disabled\nElse\n    'your code when button is enabled\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8401417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4e88c260085fb386e86af5d074104d?s=128&d=identicon&r=PG&f=1", "display_name": "Den", "link": "https://stackoverflow.com/users/8401417/den"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 45600846, "answer_count": 1, "score": 1, "last_activity_date": 1502313802, "creation_date": 1502313434, "question_id": 45600774, "link": "https://stackoverflow.com/questions/45600774/how-to-detect-if-button-is-disabled-in-source", "title": "How to detect if button is disabled in source", "body": "<p>I want to scrape a website. It has dropdown menus. When nothing is selected in the dropdown menus, the search button is greyed-out/non-clickable. The source code of the button is like this:</p>\n\n<pre><code>&lt;br&gt;\n&lt;span class=\"search search-disabled\" id=\"by_item\"&gt;Search&lt;/span&gt;\n&lt;span class=\"reset search-disabled\" id=\"reset_item\"&gt;Reset&lt;/span&gt;\n&lt;div class=\"clear\"&gt;\n::before\n::after\n&lt;/div&gt;\n&lt;br&gt;\n</code></pre>\n\n<p>When the dropdown menus are populated, the button is enabled and the source code is like this:</p>\n\n<pre><code>&lt;br&gt;\n&lt;span class=\"search\" id=\"by_item\"&gt;Search&lt;/span&gt;\n&lt;span class=\"reset\" id=\"reset_item\"&gt;Reset&lt;/span&gt;\n&lt;div class=\"clear\"&gt;\n::before\n::after\n&lt;/div&gt;\n&lt;br&gt;\n</code></pre>\n\n<p>For example, for the search button: I would like to check if the button is disabled or enabled, so that I can move on with my code. I need to find it by class name, id is not working for my code. But when I try to find \"search search-disabled\", sometimes I get an error. </p>\n\n<p>How can I check if the button is enabled or disabled?</p>\n"}, {"tags": ["excel", "variables", "range", "external", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502313332, "post_id": 45600695, "comment_id": 78160844, "body": "Not sure if it&#39;s a typo here, but in the <code>With SP</code> you should add the &quot;anchor&quot; to the <code>Range(),</code> ie <code>.Range(...)</code>  Also in the main code, you anchor the <code>.Range(&quot;A1&quot;).End(xlDown)</code> to ...what? There&#39;s no <code>With</code> statement showing."}, {"owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "edited": false, "score": 0, "creation_date": 1502314020, "post_id": 45600695, "comment_id": 78161121, "body": "It seems like you mostly need to start referring to each range explicitly, including its sheet. This will work regardless which sheet is active. In this example I also include a reference to the code workbook. You could drop that out if not relevant, but I leave it in in case workbook is also required to be explicitly referenced: <code>Set rng = Workbooks(ThisWorkbook.Name).Sheets(&quot;Sheet2&quot;).Range(&quot;A1&quot;, Workbooks(ThisWorkbook.Name).Sheets(&quot;Sheet2&quot;).Range(&quot;A1&quot;).En&zwnj;&#8203;d(xlDown))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 934, "user_id": 2946006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79ab52aa469c475f27ae6b16d5b87b8?s=128&d=identicon&r=PG&f=1", "display_name": "DMM", "link": "https://stackoverflow.com/users/2946006/dmm"}, "is_accepted": false, "score": -1, "last_activity_date": 1502362686, "creation_date": 1502362686, "answer_id": 45611835, "question_id": 45600695, "link": "https://stackoverflow.com/questions/45600695/setting-multiple-external-workbook-ranges-as-variables-for-current-workbook-rang/45611835#45611835", "title": "Setting multiple external workbook ranges as variables for current workbook Range.Find macro", "body": "<p>You can only use <code>Range.Select</code> when the <code>Range</code> you want to select is on the active worksheet.</p>\n\n<p>In the code below, there are two workbooks: <code>TestMaster.xlsm</code> and <code>TestSlave.xlsx</code> and both are open. Both macros fail on their second <code>masterRng.Select</code> statement.</p>\n\n<pre><code>Option Explicit\n\nSub testRange_SameBook_DifferentSheets()\n    Dim masterRng As Range\n    Workbooks(\"TestMaster.xlsm\").Worksheets(\"Sheet1\").Activate\n    Set masterRng = Range(\"A1:B5\")\n    masterRng.Select 'Works\n    Worksheets(\"Sheet2\").Activate\n    masterRng.Select 'Fails: Run-time error 1004\nEnd Sub\n\nSub testRange_DifferentBooks()\n    Dim masterRng As Range\n    Workbooks(\"TestMaster.xlsm\").Worksheets(\"Sheet1\").Activate\n    Set masterRng = Range(\"A1:B5\")\n    masterRng.Select 'Works\n    Workbooks(\"TestSlave.xlsx\").Worksheets(\"Sheet1\").Activate\n    masterRng.Select 'Fails: Run-time error 1004\nEnd Sub\n</code></pre>\n\n<p>In both macros, a <code>Range</code> object called <code>masterRng</code> is defined as cells <code>A1:B5</code> on worksheet <code>Sheet1</code> of workbook <code>TestMaster.xlsm</code>.</p>\n\n<p>Whilst worksheet <code>Sheet1</code> of <code>TestMaster.xlsm</code> remains the active worksheet the (first) <code>masterRng.Select</code> is executed successfully. However, once this condition changes the (second) call to the method fails.</p>\n\n<p>In macro <code>testRange_SameBook_DifferentSheets()</code> the active worksheet is switched to a different worksheet in the same workbook as <code>masterRng</code>. In the second macro <code>testRange_DifferentBooks()</code> the active worksheet is in a different workbook.</p>\n\n<p>I suspect most users who are relatively new to VBA stumble across methods such as <code>Activate</code>, <code>Select</code>, etc because that is what they get from the macro recorder. Generally, these methods are not a good idea - see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this post</a>.  </p>\n"}], "owner": {"reputation": 1, "user_id": 8441948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1b94da081e6958d184fdb141732dfc2?s=128&d=identicon&r=PG&f=1", "display_name": "W S", "link": "https://stackoverflow.com/users/8441948/w-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 823, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502362686, "creation_date": 1502313059, "last_edit_date": 1531161705, "question_id": 45600695, "link": "https://stackoverflow.com/questions/45600695/setting-multiple-external-workbook-ranges-as-variables-for-current-workbook-rang", "title": "Setting multiple external workbook ranges as variables for current workbook Range.Find macro", "body": "<p>I've been trying to create code to compare entries in a list from one workbook to two lists on another workbook (a master list). The end goal is to have a macro which would run and mark if an entry in the list is found in one of the two master lists, called \"Statistical\" and \"Non-statistical\" (sheets 1 and 2 respectively) and then labelled accordingly. In order to do this, I need to define the two ranges of the master list workbook as variables for use in the Range.Find method, or any other method which would work.</p>\n\n<p>The lists are set up as such:</p>\n\n<ol>\n<li>In the original list which is having a check run against it (and also where the code resides), there is an output of typically around 150 entries, filtered (by pre-determined criteria) such so that only maybe 100 are visible, with the number changing for each day's output on a sheet labelled \"Changes\"</li>\n<li>The \"Master Statistical List\" workbook is set up with two sheets that I have another macro populating and adding entries to. Sheet1 is named \"Statistical\" and contains all entries that are deemed \"Statistical\" and Sheet2 is named \"Non-statistical\" and contains all entries deemed Non-statistical. The lists are in the thousands of rows, so I try to avoid using the .Select function.</li>\n<li>The two master lists are both stored in column A starting from A1, while the \"Changes\" list being checked starts from A2 (due to a header).</li>\n</ol>\n\n<p>Here is what I have so far for <strong>just the range references code</strong>:</p>\n\n<pre><code>'Establish the list references\nDim MSL As Workbook 'Master Statistical List\nDim SP As Worksheet 'Statistical Properties\nDim NSP As Worksheet 'Non-statistical Properties\nDim TWS As Workbook 'This Worksheet - the original one in which this code resides\n\nSet MSL = Workbooks.Open(Filename:=\"Filepath\\Master Statistical List.xlsm\")\nSet SP = MSL.Worksheets(\"Statistical\") 'Alternatively .Worksheets(1)\nSet NSP = MSL.Worksheets(\"Non-statistical\") 'Alternatively .Worksheets(2)\nSet TWS = ThisWorkbook\n\n'Establish the Range references\n'Statistical Properties List\nSP.Activate\nDim rngStat As Range\nSet rngStat = Range(\"A1\", .Range(\"A1\").End(xlDown))\n\n'check if it actually worked\nrngStat.Select 'it seems to work\nRange(\"B1\").Select 'select random cell so we know if selecting it again actually works (I run through this line-by-line to debug)\nTWS.Activate 'Lets go back to the current workbook and then see if it still works!\nrngStat.Select 'Here be errors\n</code></pre>\n\n<p>I would be running similar Dim-set combos for both the \"Changes\" range and the Non-statistical one.</p>\n\n<p>I've tried several different solutions, including using a With parameter as such:</p>\n\n<pre><code>With SP\n    Set rngStat = Range(\"A1\", SP.Range(\"A1\").End(xlDown))\nEnd With\n</code></pre>\n\n<p>Or putting SP in front of the .Range function as shown above, but nothing works once the Active sheet is changed.</p>\n\n<p>Is there a way to set rngStat as being universally-referring to the list of entries from A1 of its sheet down to the final entry in such a way that it can be used in whatever loops or functions later on in the macro? It is important that the range not be to a set cell but rather the last entry in the column A, as the count of entries is always changing on the source sheet and increasing on the master list.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502313224, "post_id": 45600673, "comment_id": 78160801, "body": "you can rightclick a cell and add a comment.... but to set the text dynamically will need a bit of vba... please show what you have tried so far"}, {"owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "edited": false, "score": 0, "creation_date": 1502313403, "post_id": 45600673, "comment_id": 78160877, "body": "Are the comments of string value? and are the comments being pulled from cells or comment boxes in the other sheet?"}, {"owner": {"reputation": 115, "user_id": 8411961, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fb61e9d19de4e98756a1f7ca1c5b7052?s=128&d=identicon&r=PG&f=1", "display_name": "studentofarkad", "link": "https://stackoverflow.com/users/8411961/studentofarkad"}, "edited": false, "score": 0, "creation_date": 1502314507, "post_id": 45600673, "comment_id": 78161350, "body": "The comments are of string value. Basically, I have a range of cells in Sheet 1, let&#39;s say A1:A5 and I need comments to pop-up when I hover over them and pull from Sheet 2 range B1:B5.  The reason why I won&#39;t do it manually is because the contents of Sheet 2 change every day."}, {"owner": {"reputation": 934, "user_id": 2946006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79ab52aa469c475f27ae6b16d5b87b8?s=128&d=identicon&r=PG&f=1", "display_name": "DMM", "link": "https://stackoverflow.com/users/2946006/dmm"}, "edited": false, "score": 0, "creation_date": 1502364752, "post_id": 45600673, "comment_id": 78183184, "body": "There is no built-in hover event (try seeing what happens when you use the macro recorder to hover over a commented cell - the comment shows in Excel&#39;s interface but nothing gets added to the recorded macro). So, you will likely need a macro that looks pairwise at cells in your source and target ranges and sets the <code>Comment</code> property of the target cell to be that of the source cell."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1502313981, "post_id": 45600853, "comment_id": 78161097, "body": "<code>On Error Resume Next</code>, really?? That doesn&#39;t &quot;skip&quot; anything, it just happily runs to completion, in an error state that you&#39;re persisting all the way through to <code>End Sub</code>. <code>If Not Range(&quot;E6&quot;).Comment Is Nothing Then Range(&quot;E6&quot;).Comment.Delete</code> says what it does, and does what it says."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502314954, "post_id": 45600853, "comment_id": 78161531, "body": "@Mat&#39;sMug, this is only for the example code for the OP to draw from. if you run  the code on a clean sheet, then you will get an error on the delete command, because there is no comment to delete ... i did not want to include any more code than necessary.  ....   i hate the 5 minute time limit on comment updates ... lol"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502315163, "post_id": 45600853, "comment_id": 78161615, "body": "There, fixed it for you."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1502323847, "post_id": 45600853, "comment_id": 78164297, "body": "@Mat&#39;sMug, it was bugging you that much, eh ???  .... lol    .... you are right, after all. i should be thinking about the people that are learning, and provide examples that follow &quot;good&quot; programming practices."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 4, "last_activity_date": 1528347064, "last_edit_date": 1528347064, "creation_date": 1502313845, "answer_id": 45600853, "question_id": 45600673, "link": "https://stackoverflow.com/questions/45600673/add-comments-to-cells-using-vba/45600853#45600853", "title": "Add comments to cells using VBA", "body": "<p>hovering over any cell, that contains a comment, shows that cell's comment</p>\n\n<p>this is how you add a comment to a cell and how you update the comment text</p>\n\n<pre><code>Sub aaa()\n    With Range(\"E6\")\n        If Not .Comment Is Nothing Then .Comment.Delete\n        .AddComment \"this is a comment\"\n        .Comment.Text \"abc123\" 'No need the assignment sign \"=\" after .Comment.Text             \n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502399837, "post_id": 45601164, "comment_id": 78206792, "body": "which Range(&quot;E1:E10&quot;) is on an undetermined worksheet"}], "tags": [], "owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1502315458, "last_edit_date": 1502315458, "creation_date": 1502315415, "answer_id": 45601164, "question_id": 45600673, "link": "https://stackoverflow.com/questions/45600673/add-comments-to-cells-using-vba/45601164#45601164", "title": "Add comments to cells using VBA", "body": "<p>This code will refresh the contents of the comments every time you open the workbook. It is based on ranges of both destination as well as source. Make sure to first add a comment for the cell range first. You won't need VBA for that. </p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim ws As Worksheet\n    Dim rg As Range\n    Dim comment As String\n    Dim i As Integer\n\ni = 1\nSet rg = Range(\"E1:E10\") 'set range of where the comments will be seen\nSet ws = Sheets(\"Sheet1\")\n\n\nFor Each c In rg\ncomment = ws.Cells(i, 2).Value 'set location of comments you are grabbing from\nc.comment.Text Text:=comment\ni = i + 1\nNext c\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 8411961, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fb61e9d19de4e98756a1f7ca1c5b7052?s=128&d=identicon&r=PG&f=1", "display_name": "studentofarkad", "link": "https://stackoverflow.com/users/8411961/studentofarkad"}, "edited": false, "score": 0, "creation_date": 1502486622, "post_id": 45604417, "comment_id": 78247307, "body": "Unfortunately, I get &quot;variable&quot; not defined as the error message."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 115, "user_id": 8411961, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fb61e9d19de4e98756a1f7ca1c5b7052?s=128&d=identicon&r=PG&f=1", "display_name": "studentofarkad", "link": "https://stackoverflow.com/users/8411961/studentofarkad"}, "edited": false, "score": 0, "creation_date": 1502517277, "post_id": 45604417, "comment_id": 78252802, "body": "@studentofarkad,  i as integer  missed."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1502517223, "last_edit_date": 1502517223, "creation_date": 1502338834, "answer_id": 45604417, "question_id": 45600673, "link": "https://stackoverflow.com/questions/45600673/add-comments-to-cells-using-vba/45604417#45604417", "title": "Add comments to cells using VBA", "body": "<p>Try this code.</p>\n\n<pre><code>Sub test()\n    Dim rngDB As Range, rngComent As Range\n    Dim rng As Range\n    Dim cm As Comment, i as integer\n    Set rngComent = Sheets(1).Range(\"a1:a5\")\n    Set rngDB = Sheets(2).Range(\"b1:b5\")\n\n    For Each rng In rngComent\n        i = i + 1\n        If Not rng.Comment Is Nothing Then\n            rng.Comment.Delete\n        End If\n        Set cm = rng.AddComment\n        With cm\n            .Visible = False\n            .Text Text:=rngDB(i).Value\n        End With\n    Next rng\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 8411961, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fb61e9d19de4e98756a1f7ca1c5b7052?s=128&d=identicon&r=PG&f=1", "display_name": "studentofarkad", "link": "https://stackoverflow.com/users/8411961/studentofarkad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15004, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1528347064, "creation_date": 1502312958, "last_edit_date": 1502314521, "question_id": 45600673, "link": "https://stackoverflow.com/questions/45600673/add-comments-to-cells-using-vba", "title": "Add comments to cells using VBA", "body": "<p>Is there a way to activate a comment on a cell by hovering over it? I have a range of cells that I would like to pull respective comments from another sheet when hovered over each individual cell. The hover event would pull the comments from their respective cells in the other sheet.</p>\n\n<p>The comments are of string value. Basically, I have a range of cells in Sheet 1, let's say A1:A5 and I need comments to pop-up when I hover over them and pull from Sheet 2 range B1:B5. The reason why I won't do it manually is because the contents of Sheet 2 change every day. That is why I am trying to see if there is a VBA solution. </p>\n"}, {"tags": ["excel", "vba", "ms-word", "formatting"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 8285660, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/1836150466401525/picture?type=large", "display_name": "Philip", "link": "https://stackoverflow.com/users/8285660/philip"}, "edited": false, "score": 0, "creation_date": 1502370932, "post_id": 45600959, "comment_id": 78188141, "body": "How would I define a new table though? I haven&#39;t set it as a table, so I think that part is giving me an error. Or Could I do it without defining a table."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 81, "user_id": 8285660, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/1836150466401525/picture?type=large", "display_name": "Philip", "link": "https://stackoverflow.com/users/8285660/philip"}, "edited": false, "score": 0, "creation_date": 1502467067, "post_id": 45600959, "comment_id": 78238053, "body": "In my hands, the first <code>wdapp.Selection.PasteAndFormat</code> creates a table with one row; each subsequent <code>wdapp.Selection.PasteAndFormat</code> adds another row to the table. Then <code>ActiveDocument.Tables(1).Rows.Alignment = wdAlignRowCenter</code> centers the table on the page. Without knowing what sort of data you&#39;re copying or what error you&#39;re getting, it&#39;s hard to help."}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 0, "last_activity_date": 1502314407, "creation_date": 1502314407, "answer_id": 45600959, "question_id": 45600611, "link": "https://stackoverflow.com/questions/45600611/center-table-to-word-doc-from-excel-vba/45600959#45600959", "title": "Center table to word doc from excel vba", "body": "<p>Try something like:</p>\n\n<pre><code>ActiveDocument.Tables(1).Rows.Alignment = wdAlignRowCenter\n</code></pre>\n\n<p>You can fiddle with <code>ActiveDocument.Tables(1)</code> to select which tables to center.</p>\n\n<p>Hope that help.</p>\n"}], "owner": {"reputation": 81, "user_id": 8285660, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/1836150466401525/picture?type=large", "display_name": "Philip", "link": "https://stackoverflow.com/users/8285660/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1613, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502319883, "creation_date": 1502312656, "last_edit_date": 1502319883, "question_id": 45600611, "link": "https://stackoverflow.com/questions/45600611/center-table-to-word-doc-from-excel-vba", "title": "Center table to word doc from excel vba", "body": "<p>Trying to center the table but this doesn't seem to be working. Looking for some sort of \"wdtablecenter\" reference. </p>\n\n<pre><code>Dim equip As Integer\nequip = 11\nDo While Sheet2.Cells(equip, 4).Value &lt;&gt; 0\n    wdapp.Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter\n    Sheet2.Rows(equip).Copy\n    wdapp.Selection.PasteAndFormat wdFormatOriginalFormatting\n    wdapp.Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter\n    equip = equip + 1\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1502312048, "post_id": 45600383, "comment_id": 78160271, "body": "Usually when you hit debug, the highlighted line is where the error is"}, {"owner": {"reputation": 1, "user_id": 8441932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b41bc6c01fcd812c173eab7eb9a898a?s=128&d=identicon&r=PG&f=1", "display_name": "M.Jop", "link": "https://stackoverflow.com/users/8441932/m-jop"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1502312221, "post_id": 45600383, "comment_id": 78160355, "body": "I get the common 1004 run time error. Copy method of range class failed..."}, {"owner": {"reputation": 1, "user_id": 8441932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b41bc6c01fcd812c173eab7eb9a898a?s=128&d=identicon&r=PG&f=1", "display_name": "M.Jop", "link": "https://stackoverflow.com/users/8441932/m-jop"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1502312336, "post_id": 45600383, "comment_id": 78160411, "body": "Do you have any ideas on how I could clearly identify the range?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502312557, "post_id": 45600383, "comment_id": 78160519, "body": "Remove the <code>.value</code> from <code>Destination:=DashSh.Range(&quot;E4&quot;).value</code>"}, {"owner": {"reputation": 1, "user_id": 8441932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b41bc6c01fcd812c173eab7eb9a898a?s=128&d=identicon&r=PG&f=1", "display_name": "M.Jop", "link": "https://stackoverflow.com/users/8441932/m-jop"}, "edited": false, "score": 0, "creation_date": 1502312923, "post_id": 45600383, "comment_id": 78160681, "body": "We are on to something here. A.S.H. The destination goes onto the cell with the data point vs. the already created sheet with the same data point name."}, {"owner": {"reputation": 1, "user_id": 8441932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b41bc6c01fcd812c173eab7eb9a898a?s=128&d=identicon&r=PG&f=1", "display_name": "M.Jop", "link": "https://stackoverflow.com/users/8441932/m-jop"}, "edited": false, "score": 0, "creation_date": 1502313310, "post_id": 45600383, "comment_id": 78160831, "body": "Any ideas on how I can get the pivoting data point to interact with the filter copy and paste code?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502313605, "post_id": 45600383, "comment_id": 78160945, "body": "I&#39;m not getting it, but, is this what you want: <code>Destination:=Worksheets(DashSh.Range(&quot;E4&quot;).value).Range(&quot;A1&quot;&zwnj;&#8203;)</code>   ?"}, {"owner": {"reputation": 1, "user_id": 8441932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b41bc6c01fcd812c173eab7eb9a898a?s=128&d=identicon&r=PG&f=1", "display_name": "M.Jop", "link": "https://stackoverflow.com/users/8441932/m-jop"}, "edited": false, "score": 0, "creation_date": 1502313934, "post_id": 45600383, "comment_id": 78161076, "body": "That&#39;s the 1! Thank you for your help!!!"}], "owner": {"reputation": 1, "user_id": 8441932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b41bc6c01fcd812c173eab7eb9a898a?s=128&d=identicon&r=PG&f=1", "display_name": "M.Jop", "link": "https://stackoverflow.com/users/8441932/m-jop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502312007, "creation_date": 1502311668, "last_edit_date": 1531164843, "question_id": 45600383, "link": "https://stackoverflow.com/questions/45600383/excel-vba-is-there-something-simple-causeing-the-error-1004", "title": "Excel VBA: Is there something simple causeing the error 1004?", "body": "<pre><code>  Sub copyFilteredData2()\n\n    Dim employee As String\n    Dim AutoFiltrng As Range\n    Dim rng As Range\n    Dim FilterSh As Worksheet\n    Dim DashSh As Worksheet\n    Dim FilterRng As Range\n    Set FilterSh = ActiveWorkbook.Sheets(\"Report\")\n    Set DashSh = ActiveWorkbook.Sheets(\"Metrics Page\")\nSet FilterRng = FilterSh.Range(\"A1\")\nDim Cell As Range\n\n\n            FilterRng.AutoFilter field:=19, Criteria1:=DashSh.Range(\"E4\").value\n\n                    With FilterSh.AutoFilter.Range\n                    On Error Resume Next\n\n            Set AutoFiltrng = .Offset(1, 0).Resize(.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible)\n                    On Error GoTo 0\n            End With\n\n            If AutoFiltrng Is Nothing Then\n            MsgBox \"No data for that Engineer!\"\n\n            Else\n\n            Worksheets(DashSh.Range(\"E4\").value).Cells.Clear\n\n            Set rng = FilterSh.AutoFilter.Range\n            rng.Offset(1, 0).Resize(rng.Rows.Count - 1).Copy Destination:=DashSh.Range(\"E4\").value\n\n            End If\n\n            End Sub\n</code></pre>\n\n<p>My goal with this code is to use a data set with data validation to filter information based on a value and then copy the information and paste it to a spread sheet that is named the same value. Ultimately I plan to build the code to loop through range E4:E25.</p>\n"}, {"tags": ["vba", "excel", "type-mismatch"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 3, "creation_date": 1502310259, "post_id": 45600014, "comment_id": 78159413, "body": "You&#39;ll need to do a For Each loop to go through each cell in Selection.  That way it will work regardless of whether or not you have a single cell or multiple cells selected."}, {"owner": {"reputation": 23, "user_id": 5852978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150e2a4f232176db4a9fab3f9e6509ab?s=128&d=identicon&r=PG&f=1", "display_name": "yingying", "link": "https://stackoverflow.com/users/5852978/yingying"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1502310697, "post_id": 45600014, "comment_id": 78159646, "body": "Thank you so much! But how would I do that?"}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1502310898, "post_id": 45600014, "comment_id": 78159735, "body": "@tigeravatar this should be an Answer, not a Comment"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502312613, "post_id": 45600014, "comment_id": 78160551, "body": "what is the point of using <code>Selection.Value = Selection.Value</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502311689, "post_id": 45600376, "comment_id": 78160086, "body": "Note: will blow up with a <i>type mismatch</i> or something else, depending on what <code>Selection</code> is (it could be anything from a <code>Chart</code> to a <code>Range</code> or a <code>Shape</code>)."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502312774, "post_id": 45600376, "comment_id": 78160616, "body": "do not use <code>Selection</code> ... refer to cells directly. for example:  <code>For Each Cell In Sheets(&quot;Sheet1&quot;).Range(&quot;a1:b7&quot;)</code>"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 1, "last_activity_date": 1502311638, "creation_date": 1502311638, "answer_id": 45600376, "question_id": 45600014, "link": "https://stackoverflow.com/questions/45600014/excel-type-mismatch-error-13-in-vba-when-selecting-multiple-cells/45600376#45600376", "title": "Excel - type mismatch error 13 in VBA when selecting multiple cells", "body": "<p>Per tigeravatar's suggestion, here is how you would use a for each to loop through the cells in a selection</p>\n\n<pre><code>Sub Asterisk()\nDim Cell As Range\n    For Each Cell In Selection\n        If Cell.Value = \"&lt;.0001\" Then\n            Cell.Value = 0.0001\n        Else\n            Cell.Value = Cell.Value\n                If (Cell.Value &lt; 0.001) Then\n                    Cell.Value = \"***\"\n                ElseIf (Cell.Value &gt;= 0.001) And (Cell.Value &lt; 0.01) Then\n                    Cell.Value = \"**\"\n                ElseIf (Cell.Value &gt;= 0.01) And (Cell.Value &lt; 0.05) Then\n                    Cell.Value = \"*\"\n                Else\n                    Cell.Value = \"Not significant\"\n                End If\n        End If\n    Next Cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5852978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150e2a4f232176db4a9fab3f9e6509ab?s=128&d=identicon&r=PG&f=1", "display_name": "yingying", "link": "https://stackoverflow.com/users/5852978/yingying"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 45600376, "answer_count": 1, "score": 2, "last_activity_date": 1502311638, "creation_date": 1502310201, "question_id": 45600014, "link": "https://stackoverflow.com/questions/45600014/excel-type-mismatch-error-13-in-vba-when-selecting-multiple-cells", "title": "Excel - type mismatch error 13 in VBA when selecting multiple cells", "body": "<p>I an new to VBA and I've encountered a small problem. The code works fine when I select only one cell. But when I try to select multiple cells, it says type mismatch. \nI appreciate any help :) and here is the code: </p>\n\n<pre><code>Sub Asterisk()\nDim Cell As Range\nIf Selection.Value = \"&lt;.0001\" Then\n    Selection.Value = 0.0001\nElse\n    Selection.Value = Selection.Value\n        If (Selection.Value &lt; 0.001) Then\n            Selection.Value = \"***\"\n        ElseIf (Selection.Value &gt;= 0.001) And (Selection.Value &lt; 0.01) Then\n            Selection.Value = \"**\"\n        ElseIf (Selection.Value &gt;= 0.01) And (Selection.Value &lt; 0.05) Then\n            Selection.Value = \"*\"\n        Else\n            Selection.Value = \"Not significant\"\n        End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8441404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d784f3e738ca29936c721bf20a895c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Amber Simone", "link": "https://stackoverflow.com/users/8441404/amber-simone"}, "edited": false, "score": 0, "creation_date": 1502309328, "post_id": 45599725, "comment_id": 78158960, "body": "that was an error in typing the coding on here, in access there is no extra space, I just edited my original question."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1502309130, "creation_date": 1502309130, "answer_id": 45599725, "question_id": 45599640, "link": "https://stackoverflow.com/questions/45599640/ms-access-module/45599725#45599725", "title": "MS Access Module", "body": "<p>you have a double space in filepath  between <code>and</code> and <code>Settings</code>  in \"Documents and \n Settings\"</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8441404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d784f3e738ca29936c721bf20a895c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Amber Simone", "link": "https://stackoverflow.com/users/8441404/amber-simone"}, "edited": false, "score": 0, "creation_date": 1502312140, "post_id": 45600022, "comment_id": 78160313, "body": "Thank you very much for taking the time.  The issue, I think, is that we kind of need to use a variable &quot;cnty = Left(Right(CurrentDb.Name, 7), 3)&quot;  that represents a county number (e.g., 001, 101, 203).  This is being pulled from the database name... and then used in the DoCmd.  A simple insert works, but we need to be able to incorporate the variable piece.  So, the following code works insert into TBLCNTY001 (UI, RU, Year, Month, County, NAICS, Owner, MEEI, Emp, AdjCnty, AdjNAICS, ADJEMP) \tSelect UI, RU, Year, Month, County, NAICS, Owner, MEEI, Emp, AdjCnty,AdjNAICS,AdjEMP  \tfrom CNTY001;"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1502310236, "creation_date": 1502310236, "answer_id": 45600022, "question_id": 45599640, "link": "https://stackoverflow.com/questions/45599640/ms-access-module/45600022#45600022", "title": "MS Access Module", "body": "<p>Consider a pure SQL solution as Access can query from other Access databases with inline calls. No need for DoCmd.* commands. Also, be sure to escape reserved words like <em>Month</em> and <em>Year</em>. Please fill in placeholders below:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO myLocalTable (UI, RU, [Year], [Month], County, NAICS, Owner, MEEI, Emp, \n                          AdjCnty, AdjNAICS, ADJEMP)\nSELECT UI, RU, [Year], [Month], County, NAICS, Owner, MEEI, Emp, AdjCnty, AdjNAICS, AdjEMP \nFROM [C:\\Path\\To\\External\\Database.accdb].[myExternalTable] \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8441404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d784f3e738ca29936c721bf20a895c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Amber Simone", "link": "https://stackoverflow.com/users/8441404/amber-simone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1502310236, "creation_date": 1502308844, "last_edit_date": 1502309225, "question_id": 45599640, "link": "https://stackoverflow.com/questions/45599640/ms-access-module", "title": "MS Access Module", "body": "<p>Hello I am fairly new to VBA coding in MS Access and I keep running into an issue with a data transfer module. I believe the issue is with the 'DoCmd.RunSQL line' however I cannot pinpoint how to fix it. The code is as follow: </p>\n\n<pre><code>    Public Function runit()\n\n    DoCmd.TransferDatabase acLink, \"Microsoft Access\", \"C:\\Documents and Settings\\LChristi\\Desktop\\Projections Sep 2013\\2-Transpose and Break into Counties\\2c-BreakIntoCountiesTransposed.mdb\", acTable, \"CNTY999\", \"CNTY999\"\n\n    cnty = Left(Right(CurrentDb.Name, 7), 3)\n\n    DoCmd.RunSQL \"insert into TBLCNTY\" &amp; cnty &amp; \" (UI, RU, Year, Month, County, NAICS, Owner, MEEI, Emp, AdjCnty, AdjNAICS, ADJEMP)Select UI, RU, Year, Month, County, NAICS, Owner, MEEI, Emp, AdjCnty,AdjNAICS,AdjEMP from CNTY\" &amp; cnty &amp; \"';\"\n\n    DoCmd.DeleteObject acTable, \"CNTY\" &amp; cnty &amp; \"\"\n\n    End Function\n</code></pre>\n\n<p>When I attempt to run said module, I get an Error '3024' could not find file message back. This data base has been moved from one computer to mine. I was wondering if anyone knows how I could go about resolving this issue.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8233748, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/43cc9cdb2aa802c95002376797d373a7?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Bird", "link": "https://stackoverflow.com/users/8233748/oliver-bird"}, "edited": false, "score": 0, "creation_date": 1502371749, "post_id": 45599763, "comment_id": 78188861, "body": "So <code>AskToUpdateLinks</code> is a dialog box to ask me if you wanna update or not. Although I chose <code>FALSE</code>, which means I <b>turn off the dialog box</b>, Macro still update the links no matter what. To fix that, I need to shut down the workbook object to prevent automatically download. Thanks!!! It&#39;s really clear now."}], "tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": true, "score": 4, "last_activity_date": 1502309260, "creation_date": 1502309260, "answer_id": 45599763, "question_id": 45599597, "link": "https://stackoverflow.com/questions/45599597/difference-in-asktoupdatelinks-false-and-updatelinks-0/45599763#45599763", "title": "Difference in AskToUpdateLinks=False and UpdateLinks:=0", "body": "<p>If Application.AskToUpdateLinks is set to False, then Excel will automatically update the links (or try to update but fail and display an error message).</p>\n\n<p>If the UpdateLinks parameter is 0 then the links will not be updated, not even tried, and no question will be asked. (BTW, if you want it to update the links you have to set this parameter to 3, not to 1).</p>\n\n<p>Moreover, the first example changes the property of the Application object, while the second is a Method parameter, so if you open another Workbook after this, the first code will have an influence on it, whereas the second will not.</p>\n"}], "owner": {"reputation": 115, "user_id": 8233748, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/43cc9cdb2aa802c95002376797d373a7?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Bird", "link": "https://stackoverflow.com/users/8233748/oliver-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4468, "favorite_count": 0, "accepted_answer_id": 45599763, "answer_count": 1, "score": 0, "last_activity_date": 1502382449, "creation_date": 1502308678, "last_edit_date": 1531161705, "question_id": 45599597, "link": "https://stackoverflow.com/questions/45599597/difference-in-asktoupdatelinks-false-and-updatelinks-0", "title": "Difference in AskToUpdateLinks=False and UpdateLinks:=0", "body": "<p>I have a situation as running Excel Macro. \nI tried to get rid of the dialog box of this: <a href=\"https://i.stack.imgur.com/DyqWy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DyqWy.png\" alt=\"https://drive.google.com/open?id=0BzzXkoIWuMAHOF9oV1o5dmFhcWc\"></a></p>\n\n<p>As I was poking around, I got it fixed that the dialog wouldn't periodically pop up so that I wouldn't need to hit the cancel bottom every single time. </p>\n\n<p>Previously, part of the code were this:</p>\n\n<pre><code> Application.AskToUpdateLinks = False\n Application.DisplayAlerts = False\n Workbooks.Open Filename:=FullFileName\n</code></pre>\n\n<p>The successful code was this:</p>\n\n<pre><code> Application.DisplayAlerts = False\n Workbooks.Open Filename:=FullFileName, UpdateLinks:=0\n</code></pre>\n\n<p>So what is the difference <strong>Application.DisplayAlerts = False</strong> and put the <strong>updatelinks:=0</strong> at the end of the workbook object?</p>\n\n<p><strong><em>New Edited(8/10/2017):</em></strong></p>\n\n<p>I got an error somehow as I ran the macro again!!!</p>\n\n<p>I have </p>\n\n<pre><code>Application.Calculation = xlCalculationManual\nApplication.AskToUpdateLinks = False\nApplication.ScreenUpdating = False\nWorkbooks.Open FileName:=FullFileName, UpdateLinks:=0\n</code></pre>\n\n<p>and Macro throw me an Error</p>\n\n<p><strong>Run-time error '9': Subscript out of range</strong></p>\n\n<p>I don't know why.</p>\n\n<p>When I removed <code>UpdateLinks:=0</code>, it went through and yet it forced me to click cancel as the dialog popped up.</p>\n\n<p>I knew where I got wrong. The variable of the destination file name was misplaced with no reason!</p>\n"}, {"tags": ["arrays", "vba", "dictionary", "compare", "ms-access-2010"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502308985, "post_id": 45599382, "comment_id": 78158792, "body": "There isn&#39;t a dedicated function for this. You need to loop on your array and check each item for <code>dict.Exists(...)</code>"}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502310376, "post_id": 45599382, "comment_id": 78159462, "body": "thanks. I think I am going to avoid the dictionary all together.  I made a table of the limited key/value pairs, so I can just loop through the array and do a dlookup to that table. My remaining challenge is when I&#39;m adding items to an array, only add it if the item isn&#39;t already in the array, so I don&#39;t get dupes."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1502310620, "post_id": 45599382, "comment_id": 78159587, "body": "FWIW, you can use a dictionary as your <i>final</i> array. Put your values as keys and finally get the <code>dict.keys</code> as an array of unique values."}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502366567, "post_id": 45599382, "comment_id": 78184597, "body": "That&#39;s what I was looking into, but I was struggling to find the right syntax, for what I need to do.  I am filling an array, and now working on looping through it, so I can do a dlookup, find the view I need to add to my from/join statement, and then continue. 1 part is I want to only add an item to an array, if it&#39;s not already in there. The next part is, I made the array as Dim selFields() As String, and then I loop through selected items in a list box, and add the items to the loop as selFields(i) = lbo.Column(0, i). I need that syntax to only do that if it isn&#39;t in there, and then loop it"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502369865, "post_id": 45599382, "comment_id": 78187228, "body": "If you post a skeleton code where you fill your array of values without the uniqueness constraint, it will be easy to help modify it to use a dictionary so that the values are unique."}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502382389, "post_id": 45599382, "comment_id": 78197292, "body": "Thanks, i figured out all that (been working all morning).  Now I&#39;m fighting with Access being a PITA, when I have to include multiple joins in the dynamic sql statement.  I have to use all these darn parenthesis, which makes the SQL string I have working, not work because I&#39;m running it in access.  So frustrating!"}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502383452, "post_id": 45599382, "comment_id": 78197893, "body": "I updated my original post, with the code I now have.  1 last challenge, and I should have my solution!"}], "answers": [{"tags": [], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "is_accepted": false, "score": 0, "last_activity_date": 1502388032, "creation_date": 1502388032, "answer_id": 45620589, "question_id": 45599382, "link": "https://stackoverflow.com/questions/45599382/access-vba-compare-an-array-to-a-dictionary/45620589#45620589", "title": "Access VBA - Compare an Array to a Dictionary?", "body": "<p>OK, I got it all working.  Even though someone voted down my original post, I found it helpful to talk out my questions in the comments.  I thought I would post my final solution here.  This is a set up of the following:\na dynamic build your own report form in Access.<br>\nlist boxes for filtering, the report\n1 listbox for selecting the fields to go into the report, and a subform control, which will be set to a query. The query will be set to the sql that is dynamically generated, based on the report form's listbox choices made, on the fly.</p>\n\n<p>If anyone wants the public functions called with in this code, which is on-click to run the report, comment and I will post it for you.</p>\n\n<pre><code>Private Sub cmdSummary_Click()\n    Dim Mysql As String\n    Dim strFields As String\n    Dim strFrom As String\n    Dim strCriteria As String\n    Dim strQuery As String\n    Dim lbo As ListBox\n    Dim itm\n    Dim i As Long\n    Dim x As Integer\n    Dim y As Integer\n    Dim selFieldsViewList As String\n    Dim selFieldsView() As String\n    Dim selFieldsViewU() As String\n    Dim FView As String\n    Dim selCriteriaViews() As String\n    Dim AllViewsJoin() As String\n\n\n'DETERMINE ANY CRITERIA LISTBOXES WITH SELECTIONS, SO CORRESPONDING VIEW CAN BE ADDED TO FROM/JOIN\n\n    selCriteriaViews = BYOR_ConCriteriaViews()\n\n'Debug.Print \"selCriteriaViews:\"\n'Debug.Print Join(selCriteriaViews, vbCrLf)\n\n    strQuery = \"Qry_AnyStandardQuery\"\n\n'GATHER SUMMARY FIELDS FOR SELECT AND GROUP BY\n    Set lbo = Me.lstFields\n    If Me.lstFields.ItemsSelected.Count = 0 Then\n        MsgBox \"You have not chosen any fields.\" &amp; vbCrLf &amp; _\n        \"Attempting to run a report with all fields will be too much!\" &amp; vbCrLf &amp; _\n        \"Please select the summary fields you would like in your report, and run again.\" &amp; vbCrLf &amp; _\n        \"Thank you!\", vbCritical, \"Must Select Fields for Report\"\nExit Sub\n    Else\n        For Each itm In lbo.ItemsSelected\n'CREATE , LIST OF FIELDS FOR SELECT AND GROUP BY OF FINAL SQL\n            FView = DLookup(\"sqlView\", \"tblBYOR_ConFieldViews\", \"FieldName = '\" &amp; lbo.ItemData(itm) &amp; \"'\")\n            strFields = strFields &amp; \"[\" &amp; FView &amp; \"].[\" &amp; lbo.ItemData(itm) &amp; \"], \"\n'ADD VALUES TO ARRAY OF SELECTED FIELDS FOR IDENTIFYING VIEWS TO INCLUDE IN FINAL SQL\n            FView = DLookup(\"sqlView\", \"tblBYOR_ConFieldViews\", \"FieldName = '\" &amp; lbo.ItemData(itm) &amp; \"'\")\n            selFieldsViewList = selFieldsViewList &amp; \",\" &amp; FView\n        Next\n        strFields = Left(strFields, Len(strFields) - 2)\n        selFieldsView = Split(mid(selFieldsViewList, 2), \",\")\n    End If\n\n'Debug.Print \"selFieldsView:\"\n'Debug.Print Join(selFieldsView, vbCrLf)\n'Debug.Print \"selCriteriaViews:\"\n'Debug.Print Join(selCriteriaViews, vbCrLf)\n\n    AllViewsJoin = Split(Join(selFieldsView, \",\") &amp; \",\" &amp; Join(selCriteriaViews, \",\"), \",\")\n'Debug.Print \"AllViewsJoin:\"\n'Debug.Print Join(AllViewsJoin, vbCrLf)\n\n'MAKE VIEW ARRAY UNIQUE, SO WE ONLY JOIN IT ONCE\n    selFieldsViewU() = UArray(AllViewsJoin())\n\n'Debug.Print \"selFieldsViewU:\"\n'Debug.Print Join(selFieldsViewU, vbCrLf)\n\n\n 'COUNT HOW MANY JOINS, SO THE RIGHT AMOUNT OF OPENING PARENTHESES WILL BE ADDED TO THE FROM CLAUSE\n JoinCount = UBound(selFieldsViewU) + 1\n'BUILD THE FROM/JOIN SECTION OF THE SQL\n     strFrom = \" FROM \" &amp; String(JoinCount, \"(\") &amp; \"vw_BYOR_CMCIDs \"\n\n    For x = LBound(selFieldsViewU) To UBound(selFieldsViewU)\n        Select Case selFieldsViewU(x)\n            Case \"vw_BYOR_ConView1\"\n                strFrom = strFrom &amp; \" Left Join \" &amp; selFieldsViewU(x) &amp; \" On vw_BYOR_CMCIDs.CID = \" &amp; selFieldsViewU(x) &amp; \".CID) \"\n            Case \"vw_BYOR_ConView3\"\n                strFrom = strFrom &amp; \" Left Join \" &amp; selFieldsViewU(x) &amp; \" On vw_BYOR_CMCIDs.CID = \" &amp; selFieldsViewU(x) &amp; \".CID) \"\n            Case \"vw_BYOR_ConView8\"\n                strFrom = strFrom &amp; \" Left Join \" &amp; selFieldsViewU(x) &amp; \" On vw_BYOR_CMCIDs.MID = \" &amp; selFieldsViewU(x) &amp; \".MID) \"\n            Case Else\n                strFrom = strFrom &amp; \" Left Join \" &amp; selFieldsViewU(x) &amp; \" On vw_BYOR_CMCIDs.FKMC = \" &amp; selFieldsViewU(x) &amp; \".FKMC) \"\n        End Select\n    Next x\n\n'Debug.Print \"final strFrom\" &amp; vbCrLf &amp; strFrom\n\n'BUILD THE CRITERIA FOR THE SQL, BASED ON ALL LISTBOX FILTER OPTIONS CHOSEN, IF ANY\n    strCriteria = \"1=1 \"\n    strCriteria = strCriteria &amp; _\n        \"BLAH BLAH BLAH\"\n\n'CREATE THE FINAL SQL, BY CONTATENTATING THE SELECTED FIELDS, THE FROM/JOIN, THE CRITERIA, AND GROUPING BY SELECTED FIELDS\n    Mysql = \"SELECT \" &amp; vbCrLf &amp; strFields &amp; vbCrLf &amp; strFrom &amp; vbCrLf &amp; \" WHERE \" &amp; vbCrLf &amp; strCriteria &amp; vbCrLf &amp; \" GROUP BY \" &amp; vbCrLf &amp; strFields\n    Debug.Print Mysql\n    CurrentDb.QueryDefs(strQuery).SQL = Mysql\n    Me.frmReports_BYOR_SubformQRY.SourceObject = \"QUERY.\" &amp; strQuery\n    Me.frmReports_BYOR_SubformQRY.Visible = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1502388032, "creation_date": 1502307841, "last_edit_date": 1502383420, "question_id": 45599382, "link": "https://stackoverflow.com/questions/45599382/access-vba-compare-an-array-to-a-dictionary", "title": "Access VBA - Compare an Array to a Dictionary?", "body": "<p>So I think I can set up a key/value pair dictionary in access vba.  </p>\n\n<p>That is the first part of this thing I want to do.  </p>\n\n<pre><code>Dim dict as Object 'Declare the Dictionary object\nSet dict = CreateObject(\"Scripting.Dictionary\") 'Create the Dictionary\n\nDim key, val\nkey = \"SomeKey\": val = \"SomeValue\"\n'Add item to VBA Dictionary\nIf Not dict.Exists(key) Then \n    dict.Add key, val\nEnd If \n</code></pre>\n\n<p>What I need to do next, is take all selected items from a listbox, and make an array.  Then I want to loop through that array, and for each item in the array, check the keys in the dictionary. If there is a match, I will add that key's value to a new array.  Once I have the new array, I will sort it and make it unique, and then I can go from there, to use that array of \"needed values\"</p>\n\n<p>Does this make sense?</p>\n\n<p>I can explain in more detail, but I doubt it will be necessary as this should be able to be applied in a pretty universal way.</p>\n\n<p>Anyone who can help me with how to write this, I would greatly appreciate it!</p>\n\n<p>Thank you</p>\n\n<hr>\n\n<h2>EDIT</h2>\n\n<p>I have worked through all the code to do what I am trying.  My last remaining issue, is that I can't get my final SQL string (Mysql) to run properly, as a record source, for a subform control's source object.  In the below code, I put a comment with \"'XXX THIS IS WHERE MY ISSUE IS\" to denote where the issue is.  The below code compiles a few things:\nlist of fields to select\nlist of views to join to the From statement, with a left join *** (this is the issue)\nlist of criteria\nlist of fields to group by</p>\n\n<p>I have been doing a debug.print mysql and it runs in SSMS.  It's valid SQL.  But Access wants all those stupid parentheses when there are multiple joins.  That will complicate this even more, as i will need to know how many parentheses I need to add to the strFrom part of the sql concatenation string.  Here's the code.  The strfrom is where I compile the constant From string with as many Left Join (s) as I need, based on what is run at the time:</p>\n\n<pre><code>Private Sub cmdSummary_Click()\n    Dim Mysql As String\n    Dim strFields As String\n    Dim strFrom As String\n    Dim strCriteria As String\n    Dim strQuery As String\n    Dim lbo As ListBox\n    Dim itm\n    Dim i As Long\n    Dim x As Integer\n    Dim y As Integer\n    Dim selFieldsViewList As String\n    Dim selFieldsView() As String\n    Dim selFieldsViewU() As String\n    Dim FView As String\n    Dim selCriteriaViews() As String\n    Dim AllViewsJoin() As String\n\n\n'DETERMINE ANY CRITERIA LISTBOXES WITH SELECTIONS, SO CORRESPONDING VIEW CAN BE ADDED TO FROM/JOIN\n\n    selCriteriaViews = BYOR_ConCriteriaViews()\n\n'Debug.Print \"selCriteriaViews:\"\n'Debug.Print Join(selCriteriaViews, vbCrLf)\n\n    strQuery = \"Qry_AnyStandardQuery\"\n\n'GATHER SUMMARY FIELDS FOR SELECT AND GROUP BY\n    Set lbo = Me.lstFields\n    If Me.lstFields.ItemsSelected.Count = 0 Then\n        MsgBox \"You have not chosen any fields.\" &amp; vbCrLf &amp; _\n        \"Attempting to run a report with all fields will be too much!\" &amp; vbCrLf &amp; _\n        \"Please select the summary fields you would like in your report, and run again.\" &amp; vbCrLf &amp; _\n        \"Thank you!\", vbCritical, \"Must Select Fields for Report\"\nExit Sub\n    Else\n        For Each itm In lbo.ItemsSelected\n'CREATE , LIST OF FIELDS FOR SELECT AND GROUP BY OF FINAL SQL\n            FView = DLookup(\"sqlView\", \"tblBYOR_ConFieldViews\", \"FieldName = '\" &amp; lbo.ItemData(itm) &amp; \"'\")\n            strFields = strFields &amp; \"[\" &amp; FView &amp; \"].[\" &amp; lbo.ItemData(itm) &amp; \"], \"\n'ADD VALUES TO ARRAY OF SELECTED FIELDS FOR IDENTIFYING VIEWS TO INCLUDE IN FINAL SQL\n            FView = DLookup(\"sqlView\", \"tblBYOR_ConFieldViews\", \"FieldName = '\" &amp; lbo.ItemData(itm) &amp; \"'\")\n            selFieldsViewList = selFieldsViewList &amp; \",\" &amp; FView\n        Next\n        strFields = Left(strFields, Len(strFields) - 2)\n        selFieldsView = Split(mid(selFieldsViewList, 2), \",\")\n    End If\n\n'Debug.Print \"selFieldsView:\"\n'Debug.Print Join(selFieldsView, vbCrLf)\n'Debug.Print \"selCriteriaViews:\"\n'Debug.Print Join(selCriteriaViews, vbCrLf)\n\n    AllViewsJoin = Split(Join(selFieldsView, \",\") &amp; \",\" &amp; Join(selCriteriaViews, \",\"), \",\")\n'Debug.Print \"AllViewsJoin:\"\n'Debug.Print Join(AllViewsJoin, vbCrLf)\n\n'MAKE VIEW ARRAY UNIQUE, SO WE ONLY JOIN IT ONCE\n    selFieldsViewU() = UArray(AllViewsJoin())\n\n'Debug.Print \"selFieldsViewU:\"\n'Debug.Print Join(selFieldsViewU, vbCrLf)\n\n'BUILD THE FROM/JOIN SECTION OF THE SQL\n    strFrom = \" FROM vw_BYOR_CMCIDs\"\n'XXX THIS IS WHERE MY ISSUE IS - I HAVE TO DEAL WITH THE JOIN PARENTHESES THAT ACCESS REQUIRES, BECAUSE IT CAN'T TAKE STANDARD SQL\n'GRRRR XXX\n\n    For x = LBound(selFieldsViewU) To UBound(selFieldsViewU)\n        Select Case selFieldsViewU(x)\n            Case \"vw_BYOR_ConView1\"\n                strFrom = strFrom &amp; \" Left Join \" &amp; selFieldsViewU(x) &amp; \" On vw_BYOR_CMCIDs.CID = \" &amp; selFieldsViewU(x) &amp; \".CID \"\n            Case \"vw_BYOR_ConView3\"\n                strFrom = strFrom &amp; \" Left Join \" &amp; selFieldsViewU(x) &amp; \" On vw_BYOR_CMCIDs.CID = \" &amp; selFieldsViewU(x) &amp; \".CID \"\n            Case \"vw_BYOR_ConView8\"\n                strFrom = strFrom &amp; \" Left Join \" &amp; selFieldsViewU(x) &amp; \" On vw_BYOR_CMCIDs.MID = \" &amp; selFieldsViewU(x) &amp; \".MID \"\n            Case Else\n                strFrom = strFrom &amp; \" Left Join \" &amp; selFieldsViewU(x) &amp; \" On vw_BYOR_CMCIDs.FKMC = \" &amp; selFieldsViewU(x) &amp; \".FKMC \"\n        End Select\n    Next x\n\n'Debug.Print \"final strFrom\" &amp; vbCrLf &amp; strFrom\n\n'BUILD THE CRITERIA FOR THE SQL, BASED ON ALL LISTBOX FILTER OPTIONS CHOSEN, IF ANY\n    strCriteria = \"1=1 \"\n    strCriteria = strCriteria &amp; _\n        \"BLAH BLAH BLAH\"\n\n'CREATE THE FINAL SQL, BY CONTATENTATING THE SELECTED FIELDS, THE FROM/JOIN, THE CRITERIA, AND GROUPING BY SELECTED FIELDS\n    Mysql = \"SELECT \" &amp; vbCrLf &amp; strFields &amp; vbCrLf &amp; strFrom &amp; vbCrLf &amp; \" WHERE \" &amp; vbCrLf &amp; strCriteria &amp; vbCrLf &amp; \" GROUP BY \" &amp; vbCrLf &amp; strFields\n    Debug.Print Mysql\n    CurrentDb.QueryDefs(strQuery).SQL = Mysql\n    Me.frmReports_BYOR_SubformQRY.SourceObject = \"QUERY.\" &amp; strQuery\n    Me.frmReports_BYOR_SubformQRY.Visible = True\nEnd Sub\n</code></pre>\n\n<p>If anyone has any thoughts on how to track the count of joins, add the beginning parens ( to the From string, between From and the main query, and then a closing parens ) after each join.  Just not sure how to do that, on the fly, at that point in the code.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1502307869, "post_id": 45599114, "comment_id": 78158265, "body": "You need space before and after SQL commands <code>SET</code> and <code>WHERE</code>."}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1502308695, "creation_date": 1502308695, "answer_id": 45599599, "question_id": 45599114, "link": "https://stackoverflow.com/questions/45599114/access-vba-update-one-table-multiple-fields/45599599#45599599", "title": "access vba update one table, multiple fields", "body": "<p>Consider the safer, cleaner, and more maintainable version with <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194892.aspx\" rel=\"nofollow noreferrer\">querydef parameterziation</a>. No quotes or string concatenation is required. </p>\n\n<p>Simply bind parameter values to a prepared SQL statement which alternatively can be a saved query in database instead of VBA string.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Approve_Btn_Click()\n    Dim qdef As QueryDef\n\n    sql = \"PARAMETERS idparam LONG, statusparam TEXT(255), carregparam TEXT(255), resultidparam LONG;\" _\n           &amp; \" UPDATE PARKING SET parking_id = [idparam], parking_status = [statusparam],\" _\n           &amp; \"                    car_reg_num = [carregparam], result_id = [resultidparram]\" _\n           &amp; \" WHERE parking_id = [idparam]\"\n\n    ' assign prepared statement to qdef object\n     Set qdef = CurrentDb.CreateQueryDef(\"\", sql)  'OR Set qdef = CurrentDb.QueryDefs(\"mySavedQuery\")\n\n     ' bind named parameters\n     qdef!idparam = Me.lot_num_dropdown \n     qdef!statusparam = \"UPDATED\"\n     qdef!carregparam = Me.car_reg_num_dropdown  \n     qdef!resultidparam = Me.result_id_dropdown\n\n     ' execute action query\n     qdef.Execute dbFailOnError\n\n     Set qdef = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8441726, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wqVlLmoJUho/AAAAAAAAAAI/AAAAAAAADfU/0DzTynNuhz4/photo.jpg?sz=128", "display_name": "Syamil Fuad", "link": "https://stackoverflow.com/users/8441726/syamil-fuad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2744, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502308695, "creation_date": 1502306820, "last_edit_date": 1502307814, "question_id": 45599114, "link": "https://stackoverflow.com/questions/45599114/access-vba-update-one-table-multiple-fields", "title": "access vba update one table, multiple fields", "body": "<p>Help, i want to update my table <em>PARKING</em> with the field <em>PARKING_STATUS</em> value <em>UPDATED</em> but I got error. I fetch everything from the same table. All fields at the form are from the same table <em>PARKING</em>, with PK and FK with other table. This is the code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Approve_Btn_Click()\n\n    'update data into table(s)\n     CurrentDb.Execute \"UPDATE PARKING\" \n    \"SET(parking_id= '\" &amp; Me.lot_num_dropdown &amp; \"', parking_status = '\" &amp; \"UPDATED\" &amp; \"', car_reg_num = '\" &amp;    Me.car_reg_num_dropdown &amp; \"', result_id = '\" &amp; Me.result_id_dropdown &amp; \"')\" &amp; _\n    \"WHERE parking_id = '\" &amp; Me.lot_num_dropdown &amp; \"'\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1502306985, "creation_date": 1502306985, "answer_id": 45599156, "question_id": 45599064, "link": "https://stackoverflow.com/questions/45599064/how-i-make-my-worksheet-change-react-after-the-2nd-entry/45599156#45599156", "title": "How I make my Worksheet_change react after the 2nd entry?", "body": "<p><code>Target</code> in that subroutine parameter is the Range (cell) that had the change that triggered the <code>worksheet_change()</code> event. Just test that target to see if it is the cell you want to track. The most common way to do this is using the <code>INTERSECT()</code> function:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"G555\")) Is Nothing Then\n      If Range(\"G557\") &lt;&gt; Range(\"G555\") Then    \n        MsgBox \"It has to be equal\"    \n      End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Now the rest of your code will only execute if G555 was changed.</p>\n"}, {"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1502307652, "last_edit_date": 1502307652, "creation_date": 1502307108, "answer_id": 45599198, "question_id": 45599064, "link": "https://stackoverflow.com/questions/45599064/how-i-make-my-worksheet-change-react-after-the-2nd-entry/45599198#45599198", "title": "How I make my Worksheet_change react after the 2nd entry?", "body": "<p>Just add additional condition to your <code>If</code> statement:</p>\n\n<pre><code>If Range(\"G557\") &lt;&gt; Range(\"G555\") And Range(\"G557\") &lt;&gt; \"\" And Range(\"G555\") &lt;&gt; \"\" Then\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 45599156, "answer_count": 2, "score": 0, "last_activity_date": 1502307652, "creation_date": 1502306656, "last_edit_date": 1531164843, "question_id": 45599064, "link": "https://stackoverflow.com/questions/45599064/how-i-make-my-worksheet-change-react-after-the-2nd-entry", "title": "How I make my Worksheet_change react after the 2nd entry?", "body": "<p>I want to my macro to send a message just when the second cell have a value. For now the seconde I put something in the first cell my msgBox pop up!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Range(\"G557\") &lt;&gt; Range(\"G555\") Then\n\n        MsgBox \"It has to be equal\"\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1502307458, "post_id": 45599032, "comment_id": 78158067, "body": "please post the code that is failing and indicate in the code where it is failing (use a code remark)"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1502315947, "post_id": 45599032, "comment_id": 78161939, "body": "Microsoft has <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa446839.aspx\" rel=\"nofollow noreferrer\">example code for C/C++</a>, but it really does look like the method was omitted from the scripting API."}], "owner": {"reputation": 21, "user_id": 8441604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c0fc70ac06e47b5ef171919e89ab926?s=128&d=identicon&r=PG&f=1", "display_name": "Kent", "link": "https://stackoverflow.com/users/8441604/kent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1502315431, "creation_date": 1502306530, "last_edit_date": 1502315431, "question_id": 45599032, "link": "https://stackoverflow.com/questions/45599032/getruntimes-method-in-microsoft-task-scheduler-schedule-service", "title": "GetRuntimes Method in Microsoft Task Scheduler &quot;Schedule.service&quot;", "body": "<p>I am working on code in VBA trying to determine when the next several scheduled tasks will run.  I am using the Task Scheduler COM object (<code>Schedule.Service</code>).  I can enumerate all the tasks, all their triggers, and even show the next run time by using the <code>NextRunTime</code> property.  What I am after is the next several runtimes.  Microsoft has the <code>GetRunTimes</code> method <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa380759.aspx\" rel=\"nofollow noreferrer\">documented</a>, which sounds like what I am after. But anytime I try to use the method I get the error that the object doesn't support the  property method.</p>\n\n<p>I have tried in VBA, VBS, and PowerShell all with the same results.  I have tried on two Windows&nbsp;7 PCs, Windows&nbsp;2008&nbsp;R2, and Windows&nbsp;2012 and all have the same results.  On one Windows&nbsp;7 PC the <code>Get-Member</code> shows that method, but gives the error \"Cannot find an overload for GetRunTimes\".  COM object browsers don't show the method either.</p>\n\n<p>I have never encountered this before but I don't code all the time.  It is as if Microsoft documented it but left it out.  Has anyone successfully used the <code>GetRunTimes</code> method of the Task Scheduler object?</p>\n\n<p>The error I get in VBA is</p>\n\n<blockquote>\n  <p>Run-time error '438': Object doesn't support this property or method</p>\n</blockquote>\n\n<p>This happens as soon as it gets to the <code>GetRunTimes</code> line</p>\n\n<p>Here is a portion of the code:</p>\n\n<pre><code>Set objTS = CreateObject(\"Schedule.Service\")\nobjTS.Connect (strComputer)\n\nSet rootFolder = objTS.GetFolder(\"\\\")\nSet ColTasks = rootFolder.GetTasks(0)\n\nIf ColTasks.Count = 0 Then\n    tmpArray(0) = \"\"\nElse\n    For Each task In ColTasks\n        With task\n            If .Name = \"RebootSchedule\" Then\n                Set triggers = task.Definition.triggers\n                'This next line generates the error, everything else works)\n                Set runtimes = .GetRunTimes(\"8/1/2017\", \"9/1/2017\")\n                ...\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502323554, "post_id": 45598992, "comment_id": 78164238, "body": "&quot;The code runs with no errors&quot;  - you told it to ignore any errors.  What happens if you comment out the <code>On Error Resume Next</code>?  The &quot;working&quot; link is pretty different from the one in your code (even ignoring the space &gt;&gt; %20 differences) - do you really have leading spaces as shown?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502324296, "post_id": 45598992, "comment_id": 78164381, "body": "Also - your post title has &quot;Open + Edit&quot; - you cannot edit and save [back to the original location] if you open the file via HTTP"}], "owner": {"reputation": 25, "user_id": 6320502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c4f033120170e2764e85256ed6ff2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6320502/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1674, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502323502, "creation_date": 1502306397, "last_edit_date": 1531164843, "question_id": 45598992, "link": "https://stackoverflow.com/questions/45598992/open-edit-excel-file-from-sharepoint", "title": "Open + Edit Excel file from Sharepoint", "body": "<p>I am trying to open an excel file from a sharepoint library bearing the same name via VBA. Here are variables</p>\n\n<p>Define Variables:</p>\n\n<pre><code>Private Master_File As String\nPrivate Master_FileLocation As String\nPrivate Master_Open As Workbook\n</code></pre>\n\n<p>Assign_Variables:</p>\n\n<pre><code>Master_File = \"Master Data.xlsx\"\nMaster_FileLocation = \"http://sharepoint/page\"\n\n\nSub Open_Master()\n\n    Application.ScreenUpdating = False\n    Application.AskToUpdateLinks = False\n    Application.DisplayAlerts = False\n\n    On Error Resume Next\n    Set Master_Open = Workbooks.Open(Master_File)\n\n    If Master_Open Is Nothing Then\n\n         Workbooks.Open FileName:=Master_FileLocation &amp; \"/\" &amp; Master_File, ReadOnly:=False\n\n    End If\n\n  End Sub\n</code></pre>\n\n<p>The code runs with no errors yet no excel file is opened. When I click on the file and copy the \"shortcut\" directly from my internet explorer browser, this is what appears:</p>\n\n<pre><code>   http://sharepoint/org/%20Master%20Data/%20Master%20Data.xlsx\n</code></pre>\n\n<p>When I copy this path and paste it into a folder search bar I am able to open the folder. Therefore, I know the file + folder exists. I also understand some functions such as ChDir and GetOpenFileName don't work with HTTP. That said, my function is pretty simple and doesn't require those functions. Any help would be appreciated.</p>\n"}, {"tags": ["vba", "email", "ms-access"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1502307027, "post_id": 45598987, "comment_id": 78157826, "body": "Welcome to Stack Overflow!  SO questions are best when they ask a specific question rather than general programming help or guidance. See <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask?</a>.  If you&#39;re only asking about filtering via VBA then use <code>Report.Filter</code> and <code>Report.FilterOn</code> methods.  There are various ways to export and/or email, but you should research and attempt those as separate topics.  I&#39;m certain those topics have been covered before on SO and probably on the web in tutorials and other forums.  Good luck."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1502307504, "post_id": 45598987, "comment_id": 78158097, "body": "A search right here on Stack Overflow for <code>[ms-access] open and filter report</code> returns at least a couple answers with good hints and even usable code."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1502307635, "post_id": 45598987, "comment_id": 78158164, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13863958/access-form-button-to-generate-and-filter-existing-report\">Access form button to generate and filter existing report</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1502313045, "post_id": 45598987, "comment_id": 78160736, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11498794/splitting-a-multi-page-ms-access-report-into-individual-pdf-files-based-on-a-cus\">Splitting a Multi-Page MS Access report into individual pdf files based on a Customer ID?</a>"}, {"owner": {"reputation": 35, "user_id": 2755403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550fd8bca9d7a893a921dae72f7b1acc?s=128&d=identicon&r=PG&f=1", "display_name": "RedRooster", "link": "https://stackoverflow.com/users/2755403/redrooster"}, "edited": false, "score": 0, "creation_date": 1502387056, "post_id": 45598987, "comment_id": 78200078, "body": "I actually did do a lot of research before asking my question, and learned about Report.Filter and FilterOn, as well as the other methods listed in the things you cited (thank you for also doing research for me), but I was unclear on whether OutputTo would then take the currently opened form (I also wasn&#39;t relishing having to sit there and watch multiple reports open and close as it went through the procedure, but is that&#39;s what it takes...)"}], "owner": {"reputation": 35, "user_id": 2755403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550fd8bca9d7a893a921dae72f7b1acc?s=128&d=identicon&r=PG&f=1", "display_name": "RedRooster", "link": "https://stackoverflow.com/users/2755403/redrooster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502306372, "creation_date": 1502306372, "question_id": 45598987, "link": "https://stackoverflow.com/questions/45598987/ms-access-report-filtered-emailed-via-vba", "title": "MS Access Report filtered, emailed via VBA", "body": "<p>I have built a task-tracking database for my department. Tasks are assigned to staff in the \"Assignee\" field of the tasks table, which is actually a reference to the Staff table.</p>\n\n<p>Once a week, I need to send out a report to each person, each report personalized to filter only those tasks they are assigned to.  Simple enough for me to create manually, but creating one for each person is time-consuming and tedious. I have found code for outputting and/or emailing a report, but neither allows me to filter the reports via VBA. Ideally, I would simply create a loop that would fire these reports off one by one, applying the filter and sending the email to the corresponding staffer (the Staff table also contains their emails). I'm open to an intermediate step where the report is first saved somewhere if this makes it easier.</p>\n\n<p>I cannot find a way to filter a report via VBA as I am exporting or emailing it.  I have contemplated just creating the pre-filtered reports in advance and simply emailing these out, but this is not a dynamic method as it will not automatically account for staff changes, and I do not expect my successor to be VBA-friendly.</p>\n\n<p>Help is much appreciated.</p>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502306471, "post_id": 45598673, "comment_id": 78157537, "body": "This would be easier (for me, at least) if the boxes and the items were 2 different tables in MS Access. Can I use Access for my answer, or are you only interested in Excel answers?"}, {"owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502306868, "post_id": 45598673, "comment_id": 78157748, "body": "I only have access to excel, unfortunately. If it needs to be broken up that&#39;s fine. I just did it like this for ease of explanation."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502307227, "post_id": 45598673, "comment_id": 78157934, "body": "Can an item be reoriented (e.g. can an 8x5x3 item fit in an 6x10x4 box)?"}, {"owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502307287, "post_id": 45598673, "comment_id": 78157978, "body": "length and width can but not height. They have to sit flat."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502307938, "post_id": 45598673, "comment_id": 78158292, "body": "you also can not turn the box?"}, {"owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "edited": false, "score": 0, "creation_date": 1502308084, "post_id": 45598673, "comment_id": 78158361, "body": "The length could become the width but the height needs to stay the height."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1502308197, "post_id": 45598673, "comment_id": 78158406, "body": "If there were two boxes of similar size that the object would fit into, how would you choose between them? Smallest area (length X width) maybe, or smallest volume?"}, {"owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "edited": false, "score": 0, "creation_date": 1502308400, "post_id": 45598673, "comment_id": 78158509, "body": "At that point it wouldn&#39;t really matter. The closest fit is the best fit. Those box sizes listed are the actual sizes so they aren&#39;t incredibly close."}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502308826, "post_id": 45599519, "comment_id": 78158709, "body": "Was working on a similar answer. Note that you can just calculate shortest and longest length in an different column simply, by  using <code>=IF(G2&lt;H2; G2; H2)</code> for shortest length/width, and <code>=IF(G2&lt;H2; H2; G2)</code> for longest length/width"}, {"owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "edited": false, "score": 0, "creation_date": 1502308837, "post_id": 45599519, "comment_id": 78158713, "body": "Thanks so much! This one looks like it&#39;s going to do everything i needed it to do. I really appreciate it."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502309439, "post_id": 45599519, "comment_id": 78159018, "body": "@ErikvonAsmuth using helper cells it would be much easier... but i&#39;ll avoid them if possible... another way would be the change of the both <code>((B$2:B$5&gt;=F2)*(C$2:C$5&gt;=G2)*</code> to <code>(((B$2:B$5&gt;=F2)*(C$2:C$5&gt;=G2)+(B$2:B$5&gt;=G2)*(C$2:C$5&gt;=F2))*</code>.&zwnj;&#8203;.. no sorting needed and also no helper cells... (for the second formula) :P"}, {"owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "edited": false, "score": 0, "creation_date": 1502309599, "post_id": 45599519, "comment_id": 78159084, "body": "As an addition: any way we can get this to display &quot;  &quot; if there is no data in the source cells? I&#39;m going to have a sheet full of these and it seems to default to the smallest box size when &#39;0&#39; is detected."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502309727, "post_id": 45599519, "comment_id": 78159152, "body": "Yes, of course. I usually answer with helper cells (as it&#39;s more clear exactly what my code is doing), and implement without them if i&#39;m going to use the code, but it&#39;s nice that you do avoid them altogether."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "edited": false, "score": 0, "creation_date": 1502309887, "post_id": 45599519, "comment_id": 78159225, "body": "@mystic_muffin use <code>=IF(ISERROR([first formula]),&quot;&quot;,[second formula])</code>... unfortunately, the second formula will not error out because of the <code>MIN</code>-part... but the first formula will do the trick :D"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 2, "last_activity_date": 1502312804, "last_edit_date": 1502312804, "creation_date": 1502308351, "answer_id": 45599519, "question_id": 45598673, "link": "https://stackoverflow.com/questions/45598673/finding-which-of-the-4-boxes-best-hold-the-dimensions-of-item-x/45599519#45599519", "title": "Finding which of the 4 boxes best hold the dimensions of item X", "body": "<p>I've switched item 4444 length and width (so always <code>length &gt;= width</code>).</p>\n\n<p>for a simple \"first box to fit in\" you can use:</p>\n\n<pre><code>=INDEX(A$2:A$5,MATCH(1,(B$2:B$5&gt;=F2)*(C$2:C$5&gt;=G2)*(D$2:D$5&gt;=H2),0))\n</code></pre>\n\n<p>to get the \"box with the least waste of space\" you can use:</p>\n\n<pre><code>=INDEX(A$2:A$5,MATCH(MIN(IF((B$2:B$5&gt;=F2)*(C$2:C$5&gt;=G2)*(D$2:D$5&gt;=H2),B$2:B$5*C$2:C$5*D$2:D$5-PRODUCT(F2:H2),1E+100)),IF((B$2:B$5&gt;=F2)*(C$2:C$5&gt;=G2)*(D$2:D$5&gt;=H2),B$2:B$5*C$2:C$5*D$2:D$5-PRODUCT(F2:H2),1E+100),0))\n</code></pre>\n\n<blockquote>\n  <p>This are array formulas and need to be confirmed with <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd>!</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/Eo1By.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Eo1By.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>The table to the right is just for showing the unused space and is not used</em><br>\n<em>All formulas are written for <code>I2</code> and can be copied down</em></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>without sorting and the case where no box fits, it gets a bit complex and looks like this:</p>\n\n<pre><code>=IFERROR(INDEX(A$2:A$5,MATCH(MIN(IF(((B$2:B$5&gt;=G2)*(C$2:C$5&gt;=H2)+(B$2:B$5&gt;=H2)*(C$2:C$5&gt;=G2))*(D$2:D$5&gt;=I2),B$2:B$5*C$2:C$5*D$2:D$5,1E+100),1E+99),IF(((B$2:B$5&gt;=G2)*(C$2:C$5&gt;=H2)+(B$2:B$5&gt;=H2)*(C$2:C$5&gt;=G2))*(D$2:D$5&gt;=I2),B$2:B$5*C$2:C$5*D$2:D$5,1E+100),0)),\"\")\n</code></pre>\n\n<p>But if you can set the order of the boxes from smallest volume to largest, then this will do:</p>\n\n<pre><code>=IFERROR(INDEX(A$2:A$5,MATCH(TRUE,((B$2:B$5&gt;=G2)*(C$2:C$5&gt;=H2)+(B$2:B$5&gt;=H2)*(C$2:C$5&gt;=G2))*(D$2:D$5&gt;=I2)&gt;0,0)),\"\")\n</code></pre>\n\n<p>And if you set the order of the boxes from smallest volume to largest while also having always <code>length &gt;= width</code>, then this will do:</p>\n\n<pre><code>=IFERROR(INDEX(A$2:A$5,MATCH(1,(B$2:B$5&gt;=G2)*(C$2:C$5&gt;=H2)*(D$2:D$5&gt;=I2),0)),\"\")\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 45599519, "answer_count": 1, "score": 1, "last_activity_date": 1502312804, "creation_date": 1502305096, "last_edit_date": 1502306086, "question_id": 45598673, "link": "https://stackoverflow.com/questions/45598673/finding-which-of-the-4-boxes-best-hold-the-dimensions-of-item-x", "title": "Finding which of the 4 boxes best hold the dimensions of item X", "body": "<p>Friends;</p>\n\n<p>So lets say I have 4 box sizes with their dimension in a list. I also have an array of objects to fit in the boxes with their own dimensions. I only want to fit one item in one box so i want the box that fits the item the best.</p>\n\n<p>Under my \"box that fits\" column, I would like a formula or something that can look down the item dimensions and compare them to the box dimensions and find whatever box works best with item, then display the name from column A.</p>\n\n<p>So if i have an item that 9x9x9 and a box that is 10x10x10, my sheet will choose that box because the item is just less than the box size. </p>\n\n<p>This chart is an example of how I kinda have things set up.</p>\n\n<p><img src=\"https://i.stack.imgur.com/yUt8M.jpg\" alt=\"\"></p>\n\n<p>Can anyone help me out with this?</p>\n\n<p>I appreciate any assistance. Let me know if i need to clear anything up.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502305834, "post_id": 45598590, "comment_id": 78157195, "body": "A <code>Sub</code> procedure doesn&#39;t return a value. Make it a <code>Function</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502306845, "post_id": 45598590, "comment_id": 78157742, "body": "BTW <code>Call</code> is absolutely redundant. Remove it and to <code>wdApp.Run ...</code> instead (no parens) ..to invoke a <code>Sub</code>. What you&#39;ll want is <code>result = wdApp.Run(...)</code> (with the parens)."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1502307050, "creation_date": 1502307050, "answer_id": 45599181, "question_id": 45598590, "link": "https://stackoverflow.com/questions/45598590/returning-data-from-an-external-sub-in-word-called-using-run-in-excel-vba/45599181#45599181", "title": "returning data from an external sub (in word) called using .Run in excel vba", "body": "<p><code>Sub</code> procedures don't return anything. You need a <code>Function</code>.</p>\n\n<pre><code>Public Function GetFoo(ByVal bar As Long) As Long\n    GetFoo = bar * 42 'assign to the function's identifier to set return value\nEnd Function\n</code></pre>\n\n<p>Then you can get its return value:</p>\n\n<pre><code>Dim result As Long\nresult = wdApp.Run(\"GetFoo\", 10)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8434801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897e40cc2dc83bedecf04c6769b8f5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Bridging the Gap BtG", "link": "https://stackoverflow.com/users/8434801/bridging-the-gap-btg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502307838, "creation_date": 1502304853, "last_edit_date": 1502307838, "question_id": 45598590, "link": "https://stackoverflow.com/questions/45598590/returning-data-from-an-external-sub-in-word-called-using-run-in-excel-vba", "title": "returning data from an external sub (in word) called using .Run in excel vba", "body": "<p>Having failed to resolve the problem I had running Word VBA routine from within an Excel VBA routine. I opted to run the sub externally in word by using <code>Call wdApp.Run(.....</code> and passing the values to the Word <code>sub</code> from the Excel <code>sub</code>. </p>\n\n<p>The macro in Word searches for certain phrases. It works but..    The problem now is how to pass the outcome of the search back to the Excel <code>Sub</code>.</p>\n"}, {"tags": ["arrays", "vba", "excel", "variable-declaration"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1502304407, "post_id": 45598410, "comment_id": 78156384, "body": "FYI: <code>Dim array</code> is a compile error."}, {"owner": {"reputation": 3, "user_id": 8364248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yXYFT.png?s=128&g=1", "display_name": "Quentin Moran", "link": "https://stackoverflow.com/users/8364248/quentin-moran"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502304631, "post_id": 45598410, "comment_id": 78156523, "body": "yeah, it was just a generalizer for whatever array name"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8364248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yXYFT.png?s=128&g=1", "display_name": "Quentin Moran", "link": "https://stackoverflow.com/users/8364248/quentin-moran"}, "edited": false, "score": 0, "creation_date": 1502304786, "post_id": 45598425, "comment_id": 78156613, "body": "A for loop is small and simple enough, it&#39;s likely what i&#39;ll have to do. I just wish vb was more flexible with its syntax."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 3, "last_activity_date": 1502304321, "creation_date": 1502304321, "answer_id": 45598425, "question_id": 45598410, "link": "https://stackoverflow.com/questions/45598410/declaring-property-of-multiple-elements-in-an-array/45598425#45598425", "title": "Declaring Property of Multiple Elements in An Array", "body": "<p>No avoiding a loop I don't think</p>\n\n<pre><code>for i=0 to 4\n  array(i)=1\nnext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": -1, "last_activity_date": 1502304516, "creation_date": 1502304516, "answer_id": 45598487, "question_id": 45598410, "link": "https://stackoverflow.com/questions/45598410/declaring-property-of-multiple-elements-in-an-array/45598487#45598487", "title": "Declaring Property of Multiple Elements in An Array", "body": "<p>Dim is as a variant, and then assign an array to it like this:</p>\n\n<pre><code>Dim a As Variant\na = Array(1, 1, 1, 1, 1, 1, 1, 1, 1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8364248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yXYFT.png?s=128&g=1", "display_name": "Quentin Moran", "link": "https://stackoverflow.com/users/8364248/quentin-moran"}, "edited": false, "score": 0, "creation_date": 1502305188, "post_id": 45598604, "comment_id": 78156846, "body": "Most excellent, how foolish of me to overlook such a simple solution. Many thanks."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1502304907, "creation_date": 1502304907, "answer_id": 45598604, "question_id": 45598410, "link": "https://stackoverflow.com/questions/45598410/declaring-property-of-multiple-elements-in-an-array/45598604#45598604", "title": "Declaring Property of Multiple Elements in An Array", "body": "<p>Loop is necessary, but just handle the boolean evaluation at the time you instantiate your object array:</p>\n\n<pre><code>For I = 0 To UBound(cb)\n    Set cb(I) = Worksheets(\"SheetName\").CheckBoxes(I)\n    cb(I).Enabled = (I &lt;= 6)\nNext I\n</code></pre>\n\n<p>Actually from the example, you don't need an array at all:</p>\n\n<pre><code>Sub test()\n\nDim I As Integer\nFor I = 0 To 74\n    Worksheets(\"SheetName\").CheckBoxes(I).Enabled = (I &lt;=6)\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8364248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yXYFT.png?s=128&g=1", "display_name": "Quentin Moran", "link": "https://stackoverflow.com/users/8364248/quentin-moran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 45598604, "answer_count": 3, "score": 0, "last_activity_date": 1502305249, "creation_date": 1502304250, "last_edit_date": 1502305249, "question_id": 45598410, "link": "https://stackoverflow.com/questions/45598410/declaring-property-of-multiple-elements-in-an-array", "title": "Declaring Property of Multiple Elements in An Array", "body": "<p>So when initializing an array you can use:</p>\n\n<pre><code>Dim array(0 to 9) As Integer\n</code></pre>\n\n<p>What i would like to do is be able to then declare the values like this:</p>\n\n<pre><code>array(0 to 4) = 1\n</code></pre>\n\n<p>But this errors out. So is there any short simple way to do this without having to write a declaring line for each element like this:</p>\n\n<pre><code>array(0) = 1\narray(1) = 1\narray(2) = 1\narray(3) = 1\narray(4) = 1\n</code></pre>\n\n<p>This is just a general inquire if syntax exists to simplify such a procedure.\nMy specific need is roughly this:</p>\n\n<pre><code>Sub test()\nDim cb(0 to 74) As CheckBox\nDim I As Integer\nFor I = 0 To UBound(cb)\n    cb(I) = Worksheets(\"SheetName\").CheckBoxes(I)\nNext I\ncb(0 to 6).Enabled = True\ncb(7 to 74).Enabled = False\nEnd Sub\n</code></pre>\n\n<p>I'll be using this code to enable/disable different check box groups on a form, and i'd much rather not have to declare all 75 individually each time.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502305159, "post_id": 45598408, "comment_id": 78156824, "body": "at which line does the popup appear, and what does it actually ask you for/say?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502308147, "post_id": 45598408, "comment_id": 78158386, "body": "Unless you&#39;re providing a <i>full path</i> to the <code>InputBox</code>, you&#39;re just giving it a filename and the <code>SaveAs</code> will put it in the <i>current</i> directory. So it absolutely <i>is</i> saving the file, it&#39;s just not saving it to the <code>D:\\...</code> path that you think it is."}, {"owner": {"reputation": 29, "user_id": 8441384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b10fee614cb6f4bd8561da9c84ac84?s=128&d=identicon&r=PG&f=1", "display_name": "SamRosignoli", "link": "https://stackoverflow.com/users/8441384/samrosignoli"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502310459, "post_id": 45598408, "comment_id": 78159497, "body": "The popup appears after   <code>strFil = InputBox(&quot;D:\\LocalData\\xl02926\\Documents\\Samuel\\AutoCockpit\\&zwnj;&#8203;test.xlsx&quot;, &quot;Export Messages to Excel&quot;)</code>"}, {"owner": {"reputation": 29, "user_id": 8441384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b10fee614cb6f4bd8561da9c84ac84?s=128&d=identicon&r=PG&f=1", "display_name": "SamRosignoli", "link": "https://stackoverflow.com/users/8441384/samrosignoli"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502310799, "post_id": 45598408, "comment_id": 78159675, "body": "It doesn&#39;t ask anything, it just shows the path I&#39;ve specified in the code"}, {"owner": {"reputation": 29, "user_id": 8441384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b10fee614cb6f4bd8561da9c84ac84?s=128&d=identicon&r=PG&f=1", "display_name": "SamRosignoli", "link": "https://stackoverflow.com/users/8441384/samrosignoli"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502310997, "post_id": 45598408, "comment_id": 78159772, "body": "I&#39;m using <code>InputBox</code> because it already came with the code, I didn&#39;t write anything, I&#39;ve never used VBA before. So, if you say it&#39;s definitely saving somewhere, how can I save in the right folder?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502311612, "post_id": 45598408, "comment_id": 78160035, "body": "You need to tell it where to save it. Right now, your InputBox is <i>not</i> doing that. And, unless you have a screenshot to the contrary, I suspect that the &quot;popup&quot; <b>IS</b> the <code>InputBox</code> which is displaying the path to <code>D:\\...</code>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1502341752, "post_id": 45598408, "comment_id": 78168788, "body": "XXXXXXXX - is it always 8 digits?"}, {"owner": {"reputation": 29, "user_id": 8441384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b10fee614cb6f4bd8561da9c84ac84?s=128&d=identicon&r=PG&f=1", "display_name": "SamRosignoli", "link": "https://stackoverflow.com/users/8441384/samrosignoli"}, "edited": false, "score": 0, "creation_date": 1502369148, "post_id": 45598408, "comment_id": 78186632, "body": "Yes, it&#39;s always 8 digits"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8441384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b10fee614cb6f4bd8561da9c84ac84?s=128&d=identicon&r=PG&f=1", "display_name": "SamRosignoli", "link": "https://stackoverflow.com/users/8441384/samrosignoli"}, "edited": false, "score": 0, "creation_date": 1502369343, "post_id": 45600489, "comment_id": 78186779, "body": "Thanks!! It was just a matter of understanding the code. So I wasn&#39;t providing the full path and it was saving elsewhere. Now I can save in the right folder and it works like a charm! Thanks a lot!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1502312038, "creation_date": 1502312038, "answer_id": 45600489, "question_id": 45598408, "link": "https://stackoverflow.com/questions/45598408/specify-folder-to-save-excel-file/45600489#45600489", "title": "Specify folder to save Excel file", "body": "<p>Unless you're providing a <em>full path</em> to the <code>InputBox</code>, you're just giving it a filename and the <code>SaveAs</code> will put it in the <em>current</em> directory. </p>\n\n<p><a href=\"https://i.stack.imgur.com/EM0qM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EM0qM.png\" alt=\"enter image description here\"></a></p>\n\n<p>The <code>InputBox</code> above is displaying the <em>Prompt</em> which you gave it, not a <em>Default</em> or initial value. Then, when you get to the <code>SaveAs</code>, when you save a file without a full path, it will be saved in the current directory, which probably differs from the path you have hard-coded in the <code>InputBox</code> prompt.</p>\n\n<p>So it absolutely <em>is</em> saving the file, it's just not saving it to the <code>D:\\...</code> path that you think it is.</p>\n\n<p>Your inputbox function should probably be like:</p>\n\n<pre><code>strFile = InputBox(Prompt:=\"Specify file location for export.\", _\n    Default:=\"D:\\LocalData\\xl02926\\Documents\\Samuel\\AutoCockpit\\test.xlsx\", _\n    Title:=\"Export Messages to Excel\")\n</code></pre>\n\n<p>Above, we've given a Prompt, a Default value, and a Title. The Default value fills the text-entry field of the <code>InputBox</code>, and you can change it if you'd like.</p>\n\n<p>NB: of course you should ensure that user provided a valid path, and that the file doesn't already exist, and if either of those potential error situations arise, you should write code that manages those errors, but that's outside the scope of this question.</p>\n"}], "owner": {"reputation": 29, "user_id": 8441384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b10fee614cb6f4bd8561da9c84ac84?s=128&d=identicon&r=PG&f=1", "display_name": "SamRosignoli", "link": "https://stackoverflow.com/users/8441384/samrosignoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 45600489, "answer_count": 1, "score": 1, "last_activity_date": 1593074316, "creation_date": 1502304240, "last_edit_date": 1593074316, "question_id": 45598408, "link": "https://stackoverflow.com/questions/45598408/specify-folder-to-save-excel-file", "title": "Specify folder to save Excel file", "body": "<p>Every day I receive about 100 emails in Outlook with similar subjects \"Dealer Sales Cockpit - XXXXXXXX\", being XXXXXXXX a variable number.</p>\n\n<p>I need to get the numbers at the end of the email subject and write them in a column in an Excel spreadsheet (or in a .txt file, if it's not possible in Excel).</p>\n\n<p>This is code I've found. Problem is, it never writes in \"test.xlsx\". I can't solve it having never really worked with VBA.</p>\n\n<pre><code>Sub ExportMessagesToExcel()\nDim olkMsg As Object, _\n    excApp As Object, _\n    excWkb As Object, _\n    excWks As Object, _\n    lngRow As Long, _\n    lngCnt As Long, _\n    intPos As Integer, _\n    strFil As String\nstrFil = InputBox(\"D:\\LocalData\\xl02926\\Documents\\Samuel\\AutoCockpit\\test.xlsx\", \"Export Messages to Excel\")\nIf strFil &lt;&gt; \"\" Then\n    Set excApp = CreateObject(\"Excel.Application\")\n    Set excWkb = excApp.Workbooks.Add()\n    Set excWks = excWkb.ActiveSheet\n    'Write Excel Column Headers\n    With excWks\n        .Cells(1, 1) = \"Computer\"\n    End With\n    lngRow = 2\n    'Write messages to spreadsheet\n    For Each olkMsg In Application.ActiveExplorer.CurrentFolder.Items\n        'Only export messages, not receipts or appointment requests, etc.\n        If olkMsg.Class = olMail Then\n            'Add a row for each field in the message you want to export\n            intPos = InStrRev(olkMsg.Subject, \" \")\n            excWks.Cells(lngRow, 1) = Mid(olkMsg.Subject, intPos + 1)\n            lngRow = lngRow + 1\n            lngCnt = lngCnt + 1\n        End If\n    Next\n    Set olkMsg = Nothing\n    excWkb.SaveAs strFil\n    excWkb.Close\nEnd If\nSet excWks = Nothing\nSet excWkb = Nothing\nSet excApp = Nothing\nMsgBox \"Process complete.  A total of \" &amp; lngCnt &amp; \" messages were \nexported.\", vbInformation + vbOKOnly, \"Export messages to Excel\"\nEnd Sub\n</code></pre>\n\n<p>When I run it, a pop-up appears and I think it asks for a name for the spreadsheet, but any name I choose seems to already exist, so  nothing is created. It still scans my Inbox, as it counts my emails and says \"A total of X messages were exported\". X varies with the number of emails in my Inbox.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1502303918, "post_id": 45598272, "comment_id": 78156107, "body": "You must refer to the <code>Sheets</code> collection rather than <code>Worksheets</code> if you want to delete charts too (if you mean chart sheets)."}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1502303937, "post_id": 45598272, "comment_id": 78156124, "body": "Hello, Josh, are you saying sometimes it deletes the charts on other sheets and sometimes it doesn&#39;t ? or there is some sort of error initiated if it doesn&#39;t find a chart?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502304386, "post_id": 45598272, "comment_id": 78156376, "body": "To add to @SJR post. There are 3 <i>types</i> of sheets in Excel. <b>1) ** Worksheets (standard tab that loads on startup). **2)</b> Chart Sheets (charts   set up as a separate tab. <b>3)</b> Macro sheets (sheets that only have vba attached. <code>Worksheets</code> collection refers <b>only</b> to worksheets. <code>Sheets</code> collection refers to all sheets, regardless of type."}, {"owner": {"reputation": 77, "user_id": 7559218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/waziC.jpg?s=128&g=1", "display_name": "joshjayse", "link": "https://stackoverflow.com/users/7559218/joshjayse"}, "edited": false, "score": 0, "creation_date": 1502314648, "post_id": 45598272, "comment_id": 78161404, "body": "When I change WS from Worksheet to Sheets, ws.Name results in &quot;Compile error: Method or data member not found&quot;... You are correct that I am trying to delete ChartSheets."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 7559218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/waziC.jpg?s=128&g=1", "display_name": "joshjayse", "link": "https://stackoverflow.com/users/7559218/joshjayse"}, "edited": false, "score": 0, "creation_date": 1502314019, "post_id": 45598597, "comment_id": 78161119, "body": "I think I should have clarified that the CHARTS are CHARTSHEETS, when I run this, it seems that the ChartSheets are still present. Should I just replace with SHEET?"}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "reply_to_user": {"reputation": 77, "user_id": 7559218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/waziC.jpg?s=128&g=1", "display_name": "joshjayse", "link": "https://stackoverflow.com/users/7559218/joshjayse"}, "edited": false, "score": 0, "creation_date": 1502363185, "post_id": 45598597, "comment_id": 78182053, "body": "I&#39;m not near a pc for a few hours. But no my guess is if you just change the type to sheet you&#39;ll have other problems.  If you haven&#39;t figured it out I&#39;ll have  ago later..."}], "tags": [], "owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "is_accepted": false, "score": 0, "last_activity_date": 1502307489, "last_edit_date": 1502307489, "creation_date": 1502304886, "answer_id": 45598597, "question_id": 45598272, "link": "https://stackoverflow.com/questions/45598272/vba-excel-deleting-all-charts-and-graphs-in-a-workbook-except-one/45598597#45598597", "title": "VBA Excel: Deleting all charts and graphs in a workbook, except one", "body": "<pre><code>Option Explicit\n\nSub AllSheetsAndcharts()\n\n  Dim AChart As ChartObject\n  Dim ASheet As Worksheet\n  Application.DisplayAlerts = False\n  For Each ASheet In ActiveWorkbook.Worksheets\n     If UCase(ASheet.Name) &lt;&gt; \"HOME\" Then\n\n       For Each AChart In ASheet.ChartObjects\n         AChart.Delete\n       Next\n       ASheet.Delete\n     End If\n  Next\n  Application.DisplayAlerts = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "is_accepted": true, "score": 1, "last_activity_date": 1502378548, "creation_date": 1502378548, "answer_id": 45617735, "question_id": 45598272, "link": "https://stackoverflow.com/questions/45598272/vba-excel-deleting-all-charts-and-graphs-in-a-workbook-except-one/45617735#45617735", "title": "VBA Excel: Deleting all charts and graphs in a workbook, except one", "body": "<pre><code>Option Explicit\n\nSub GetRid()\n  Dim ASheet As Worksheet\n  Dim AChart As Chart\n\n\n  Application.DisplayAlerts = False\n  Application.ScreenUpdating = False\n\n  '** first scan for and delete all non HOME worksheets ***\n  For Each ASheet In ActiveWorkbook.Worksheets\n    If UCase(ASheet.Name) &lt;&gt; \"HOME\" Then\n      ASheet.Delete\n    End If\n  Next\n\n  '** Now scan and delete any ChartSheets ****\n  For Each AChart In ActiveWorkbook.Charts\n    AChart.Delete\n  Next\n\n  Application.DisplayAlerts = True\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7559218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/waziC.jpg?s=128&g=1", "display_name": "joshjayse", "link": "https://stackoverflow.com/users/7559218/joshjayse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6642, "favorite_count": 0, "accepted_answer_id": 45617735, "answer_count": 2, "score": 0, "last_activity_date": 1502378548, "creation_date": 1502303707, "question_id": 45598272, "link": "https://stackoverflow.com/questions/45598272/vba-excel-deleting-all-charts-and-graphs-in-a-workbook-except-one", "title": "VBA Excel: Deleting all charts and graphs in a workbook, except one", "body": "<p>I have a macro that generates a lot of worksheets and charts. There's also various subroutines that run so the names and quantity of each worksheet/chart generated is never the same. What is constant is my HOME worksheet which is the UI for the user and I want it to be unaffected.</p>\n\n<p>I found a similar question here about deleting all worksheets except the one you are working with (i.e. HOME). Here's what I have so far.</p>\n\n<pre><code>Sub ZRESET()\n\nDim ws As Worksheet, wb As Workbook\nSet wb = ActiveWorkbook\n\n    Sheets(\"HOME\").Select\n\n    Application.DisplayAlerts = False\n        For Each ws In wb.Worksheets\n            If ws.Name &lt;&gt; \"HOME\" Then\n                ws.Delete\n            End If\n            If Chart.Name = \"\" Then\n                Charts.Delete\n            End If\n        Next\n    Application.DisplayAlerts = True\n\n    Range(\"B5:E5,B9:E9,B13:E13,B14:E14\").ClearContents\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>The worksheets delete fine, the hang up I have is the charts. I tried various attempts to remove charts and sometimes they work (i.e placing Charts.Delete outside of a FOR loop and IF statement). But this requires me to actually have a chart in the workbook. Sometime the user can just develop worksheets but no charts.</p>\n\n<p>Any advice to continue my goal of deleting SHEETS <strong>and/or</strong> CHARTS, while keeping my HOME sheet intact?</p>\n"}, {"tags": ["excel", "vba", "checkbox", "userform"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502303833, "post_id": 45598220, "comment_id": 78156058, "body": "What do you mean by &quot;seperate analysis command box&quot;?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1502303942, "post_id": 45598220, "comment_id": 78156128, "body": "Try using CheckBox1.Value =True, however on the way you are making the code, you already call the functions, normally you would create a button that checks all the Checkboxes and then call the functions"}, {"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502304001, "post_id": 45598220, "comment_id": 78156158, "body": "Sorry, Bad wording on my part. In the picture attached, there is a command button called Analyze. It is this button that should be activated to run the macros associated with the checked off boxes."}, {"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502304223, "post_id": 45598220, "comment_id": 78156297, "body": "Thats a good point dantakeshi, its gets to the root of my question. That is, how do you recognize which boxes have been selected by the user, then run only those &quot;checked&quot; macros. There are some macros that will go un-used because certain users might not need them for there analyses."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502304344, "post_id": 45598379, "comment_id": 78156352, "body": "Is this saying: &quot;If CheckBox 1 has been checked, do graph_...&quot;?"}, {"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502304370, "post_id": 45598379, "comment_id": 78156368, "body": "If none of the boxed are checked would it just do nothing?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502304397, "post_id": 45598379, "comment_id": 78156381, "body": "Yes. Note that Then is on the same line as If. You don&#39;t need to specify <code>=True</code> and your Else was redundant as far as I could see."}, {"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502304603, "post_id": 45598379, "comment_id": 78156502, "body": "Aha. Many thanks SJR. I know what I need from my code, but have very little expertise with VBA syntax."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502304795, "post_id": 45598379, "comment_id": 78156620, "body": "To save space you can write <code>If CheckBox1 Then Graph_Duration</code> on a single line and dispense with the <code>End If</code>. If it answers your question, perhaps you could accept it?"}, {"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 1, "creation_date": 1502305144, "post_id": 45598379, "comment_id": 78156814, "body": "Yes I will accept. Just out of curiosity, what does that give to your profile?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502305258, "post_id": 45598379, "comment_id": 78156886, "body": "I get 15 points I think, and you get some points but I don&#39;t know how many - presumably you should get a notification. I&#39;m sure it&#39;s all explained somewhere."}, {"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502382436, "post_id": 45598379, "comment_id": 78197315, "body": "After trying this solution I have found it does not work. When I press the analyze button in the userform none of the macros enabled by the checkbox work. I believe you must call them in the If statements after all"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502388499, "post_id": 45598379, "comment_id": 78200920, "body": "Are you saying it did work and stopped working, or it never worked (in which case why did you accept it as an answer?) In any case, I don&#39;t know what you mean by the macros don&#39;t work. More details needed."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1502304135, "creation_date": 1502304135, "answer_id": 45598379, "question_id": 45598220, "link": "https://stackoverflow.com/questions/45598220/how-to-execute-macro-associated-with-a-check-box-in-a-userform/45598379#45598379", "title": "How to execute macro associated with a check box in a UserForm", "body": "<p>Perhaps you mean something like this - it should be attached to your button. If you had lots of checkboxes then this will become inefficient.</p>\n\n<pre><code>Private Button_Click()\n\n    If CheckBox1 Then\n        Graph_Duration\n    End If\n\n    If CheckBox2 Then\n        Graph_ram\n    End If\n    'etc\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1797, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1605097010, "creation_date": 1502303546, "last_edit_date": 1605097010, "question_id": 45598220, "link": "https://stackoverflow.com/questions/45598220/how-to-execute-macro-associated-with-a-check-box-in-a-userform", "title": "How to execute macro associated with a check box in a UserForm", "body": "<p>I am working on an analysis template with a UserForm.<br />\nI have macros associated with checkboxes. I want to activate them by clicking the separate analysis command box. The macros are called: graph_dur, graph_ram, dur_calc, ram_calc.</p>\n<p>The UserForm allows users to check off the analyses they want, then run calculations with an &quot;Analysis&quot; command button.</p>\n<p><a href=\"https://i.stack.imgur.com/EsSQd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EsSQd.png\" alt=\"enter image description here\" /></a></p>\n<p>Any boxes that are not checked should not run their macros when &quot;Analyze&quot; is clicked.</p>\n<p><strong>I understand</strong> that when a checkbox is &quot;checked&quot; then it returns &quot;True&quot;.<br />\n<strong>I don't know</strong> how to associate the True return with the run of a macro when &quot;Analyze&quot; is activated.</p>\n<p>This code is not correct, but attempts to highlight my basic layout.</p>\n<pre><code>Private Sub CheckBox1_Click() \n    If CheckBox1 = True\n        Then Call.Graph_duration\n    Else CheckBox1 = False\n    End If \nEnd Sub\n\nPrivate Sub CheckBox2_Click()\n    If CheckBox2 = True\n        Then Call.Graph_ram\n        Else CheckBox2 = False\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1502303615, "post_id": 45598037, "comment_id": 78155951, "body": "Are you declaring Sheet1 As Worksheet? &quot;ThisWorkbook.Worksheets(&quot;Sheet1&quot;).&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1502305636, "post_id": 45598037, "comment_id": 78157094, "body": "Event handlers are <code>Private</code> by default for a reason: they&#39;re not meant to be invoked manually like this, see <a href=\"https://stackoverflow.com/a/45598326/1188513\">braX&#39;s answer</a>. @danieltakeshi <code>Sheet1</code> would be the <code>CodeName</code> identifier, a free, global-scope object variable identifier VBA creates for every worksheet in an Excel project. No need to declare it and fetch it from <code>ThisWorkbook</code> every time. Also fetching a worksheet by name is extremely frail, since users can rename sheets on a whim."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502369702, "post_id": 45598037, "comment_id": 78187078, "body": "@Mat&#39;sMug I didn&#39;t know! Thanks for the explanation."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502306471, "post_id": 45598326, "comment_id": 78157538, "body": "Pretty sure the event handlers <i>do</i> get invoked. OP&#39;s IDE probably isn&#39;t breaking in class modules, which hides the real problem. But kudos for making Excel invoke the events rather than explicitly calling them."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 2, "last_activity_date": 1502303918, "creation_date": 1502303918, "answer_id": 45598326, "question_id": 45598037, "link": "https://stackoverflow.com/questions/45598037/vba-error-424-object-required-on-call-to-sub-in-workbook-open/45598326#45598326", "title": "VBA Error 424 Object Required on call to sub in Workbook_Open", "body": "<p>Just change it to <code>Sheet1.Activate</code> and that event will be called.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1502306153, "creation_date": 1502306153, "answer_id": 45598932, "question_id": 45598037, "link": "https://stackoverflow.com/questions/45598037/vba-error-424-object-required-on-call-to-sub-in-workbook-open/45598932#45598932", "title": "VBA Error 424 Object Required on call to sub in Workbook_Open", "body": "<p>You shouldn't be invoking event handlers manually, but that's not why you're having that error; by making the method <code>Public</code> you've exposed it onto <code>Sheet1</code>'s interface, making these calls perfectly \"legal\" - so the methods <em>do</em> get invoked, no doubt.</p>\n\n<p>Go to Tools / Options / General / Error Trapping, and set it to <em>Break on Unhandled Errors</em>.</p>\n\n<p>Then you should have a better idea of exactly which statement is blowing up, most likely located somewhere in one of these:</p>\n\n<pre><code>Me.initReqLink\nMe.initVersion\nMe.initCbApplicaiton\n</code></pre>\n\n<p>..which you haven't posted.</p>\n\n<p>Side note, <code>Call</code> doesn't make a difference, because it's an obsolete syntax that hasn't had a purpose since the advent of the <em>implicit call syntax</em> way back when. You never <em>need</em> an explicit <code>Call</code> statement. Never.</p>\n"}], "owner": {"reputation": 55, "user_id": 6641909, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/535105433356916/picture?type=large", "display_name": "smooky.secrets", "link": "https://stackoverflow.com/users/6641909/smooky-secrets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 45598932, "answer_count": 2, "score": 1, "last_activity_date": 1502306153, "creation_date": 1502302928, "question_id": 45598037, "link": "https://stackoverflow.com/questions/45598037/vba-error-424-object-required-on-call-to-sub-in-workbook-open", "title": "VBA Error 424 Object Required on call to sub in Workbook_Open", "body": "<p>I am very new to vba. I am getting a 424 Ojbect required error when I open the document. I tried using Call subName but that made no difference. </p>\n\n<p>Please let me know what else I can send or explain.</p>\n\n<p>Code found in ThisWorkbook:</p>\n\n<pre><code>Private Sub Workbook_Open()\n   Sheet1.Worksheet_Activate//&lt;- Object Required\n   Sheet2.Worksheet_Activate\n   Sheet3.Worksheet_Activate\n   Sheet4.Worksheet_Activate\n   Sheet5.Worksheet_Activate\n   Sheet6.Worksheet_Activate\n   Sheet7.Worksheet_Activate\n...\n</code></pre>\n\n<p>Code found in Sheet1:</p>\n\n<pre><code>'INITIAL SETUP OF THE SHEET\nPublic Sub Worksheet_Activate()\n    If Sheet9.Range(\"B1\").Text = \"TRUE\" Then\n    'RUN INIT FUNCTIONS HERE\n    Me.initReqLink\n    Me.initVersion\n    Me.initCbApplicaiton\n\n    Sheet9.Range(\"B1\").Text = \"FALSE\"\n\n  End If\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "variables", "repeat"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1502303093, "post_id": 45597986, "comment_id": 78155662, "body": "It&#39;s most likely due to wrong format of your reference. You have to add <code>\\ </code> after the path and before the <code>[filename]</code>"}, {"owner": {"reputation": 21, "user_id": 8441377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8c2159cf7e6b08d4202e50d33993a4?s=128&d=identicon&r=PG&f=1", "display_name": "Khaug", "link": "https://stackoverflow.com/users/8441377/khaug"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502308479, "post_id": 45597986, "comment_id": 78158544, "body": "That&#39;s just how stack overflow formatted it, I didn&#39;t notice it when I posted so added a space so the \\ would show up. It is in the correct format on my workbook. However, that&#39;s not what I was asking about."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502308841, "post_id": 45597986, "comment_id": 78158717, "body": "What is the layout of your consolidated workbook? For example, is it a different row for each day of the year? or is it a different worksheet? what is the range of cells you copy from each worksheet? I suggest you add these details."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502312567, "post_id": 45597986, "comment_id": 78160527, "body": "How often do the &quot;day&quot; workbooks change?  I.e. are they just created and, after that, never changed again, or do people go in and change the contents on later dates?  (A workbook that is linked to 365 other, un-opened, workbooks is potentially going to be sloooooow to use so, if the data you are retrieving is static, it would probably be better to put the values into your workbook rather than constantly linking to the information in other workbooks.)"}], "answers": [{"tags": [], "owner": {"reputation": 5041, "user_id": 523144, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/111055402ae29758a8e32ce797380e23?s=128&d=identicon&r=PG&f=1", "display_name": "PeterE", "link": "https://stackoverflow.com/users/523144/petere"}, "is_accepted": false, "score": 1, "last_activity_date": 1502313499, "last_edit_date": 1502313499, "creation_date": 1502311844, "answer_id": 45600432, "question_id": 45597986, "link": "https://stackoverflow.com/questions/45597986/changing-a-file-location-for-10-000-cells-in-excel/45600432#45600432", "title": "Changing a file location for 10,000+ cells in Excel", "body": "<p>To summarize: You want to create addresses in the stated format by string manipulation and then query their value. </p>\n\n<p>There is in fact a function for this, it is called <code>INDIRECT</code>. Unfortunately it requires the source file to be open for external references, so I'm not sure if it is any help to you. I have never tried to open 365 excel files at once. \nSee also <a href=\"https://stackoverflow.com/questions/28461672/referencing-value-in-a-closed-excel-workbook-using-indirect\">this question on that topic</a>.</p>\n\n<p>If you do not wish to open all the files by hand you will probably have to fall back on VBA (or perhaps JavaScript if you use Office 2016). It shouldn't be to difficult to create a macro which generates the references for you.</p>\n\n<p>Here is a starting point for such a macro:</p>\n\n<pre><code>Sub Makro1()\n    Dim day As Integer\n\n    For day = 1 To 365\n        Cells(day, 1).FormulaR1C1 = \"='[BASENAME\" &amp; day &amp; \".xlsx]SHEETNAME'!R1C1\"\n    Next i\nEnd Sub\n</code></pre>\n\n<p>One more thing: After that your workbook will be linked to all those day-files. As such it will reflect changes as they occur in the day-files. If that is not required it would probably be best to sever the connections and replace each reference with its value. You can do that via <code>Data-&gt;Queries&amp;Connections-&gt;Manage Links-&gt;sever connection</code> (I'm translating from my localized excel version so the exact names may vary) OR you can just copy every thing and then paste only values.</p>\n"}], "owner": {"reputation": 21, "user_id": 8441377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8c2159cf7e6b08d4202e50d33993a4?s=128&d=identicon&r=PG&f=1", "display_name": "Khaug", "link": "https://stackoverflow.com/users/8441377/khaug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1502313499, "creation_date": 1502302745, "last_edit_date": 1502312148, "question_id": 45597986, "link": "https://stackoverflow.com/questions/45597986/changing-a-file-location-for-10-000-cells-in-excel", "title": "Changing a file location for 10,000+ cells in Excel", "body": "<p>I'm creating a workbook in Excel, and need it to reference other workbooks. I am pulling information from about 30 cells for each day of the year. Each day of the year is a separate workbook. So, I have over 10,000 cells that I need to change if I just copy and paste the formulas for each day.</p>\n\n<p>The reference I have right now is something like this:</p>\n\n<p><code>='C:\\user\\data\\year\\[day.xlsx]Sheet1'!A1)</code></p>\n\n<p>Where that A1 will be replaced by 30 other cells, and the day.xlsx will be replaced with all of the days in a year. For everything I've tried so far Excel has asked me to manually locate each file per cell.</p>\n\n<p>Is there any way to make this process quicker than manually changing the file name for every single one of these cells? Maybe be able to set the date in the file name to a variable that will link to a cell?</p>\n\n<p>Any guidance would be appreciated. Thank you.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 21, "user_id": 8401711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b85127ebec5e41ddb2cb4aa556eb459?s=128&d=identicon&r=PG&f=1", "display_name": "Chip Stewart", "link": "https://stackoverflow.com/users/8401711/chip-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 545, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1502307539, "creation_date": 1502302681, "last_edit_date": 1502307539, "question_id": 45597967, "link": "https://stackoverflow.com/questions/45597967/vba-document-body-createtextrange-execcommand-copy-run-time-error", "title": "VBA .document.body.createtextrange.execCommand &quot;Copy&quot; run-time error", "body": "<p>When I use the below code to render HTML in cells, I receive a <code>\"Run-time error '438': Object doesn't support this property or method\"</code> on the line\n<code>.document.body.createtextrange.execCommand \"Copy\".</code>  </p>\n\n<p>Does anyone know of a fix or work-around?</p>\n\n<pre><code>Sub FormatHtmlViaIE()\nDim ie As Object, tr, c As Range\n\nSet ie = CreateObject(\"internetexplorer.application\")\nSet tr = Range(\"B2:F500\")\nWith ie\n    .Visible = False\n    .Navigate \"about:blank\"\n    Do While .busy\n    Loop\n\n    For Each c In tr\n        .document.body.innerHTML = c.Value\n        .document.body.createtextrange.execCommand \"Copy\"\n        Selection.Parent.Paste Destination:=c\n    Next c\n    .Quit\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1543, "user_id": 2142248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/F2o9H.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/2142248/adam"}, "is_accepted": true, "score": 1, "last_activity_date": 1502302177, "creation_date": 1502302177, "answer_id": 45597827, "question_id": 45597826, "link": "https://stackoverflow.com/questions/45597826/how-do-i-show-the-ln-and-col-numbers-in-the-visual-basic-editor/45597827#45597827", "title": "How do I show the Ln and Col numbers in the Visual Basic editor?", "body": "<p>The Visual Basic editor does have this functionality.</p>\n\n<ul>\n<li>The Ln and Col display is the last widget on the 'Standard' toolbar. You can right click on the menu bar or any toolbar and check the box next to 'Standard'.</li>\n<li>If the toolbar is enabled, but you cannot see the Ln/Col display then the tool bar placement has caused the VBE to truncate the toolbar; try moving your toolbars around.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1502304937, "creation_date": 1502304937, "answer_id": 45598618, "question_id": 45597826, "link": "https://stackoverflow.com/questions/45597826/how-do-i-show-the-ln-and-col-numbers-in-the-visual-basic-editor/45598618#45598618", "title": "How do I show the Ln and Col numbers in the Visual Basic editor?", "body": "<p><a href=\"https://stackoverflow.com/a/45597827/1188513\">As already noted</a> that basic functionality is part of the [Standard] toolbar.</p>\n\n<p>With <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (an actively maintained, open-source VBE add-in project I manage), you get <em>much</em> more than that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hGKRn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hGKRn.png\" alt=\"Context selection status\"></a></p>\n\n<p>The [Rubberduck] toolbar dwarfs the VBE's line/column display, which only shows the <em>start</em> of the current selection. Rubberduck's context-sensitive toolbar displays:</p>\n\n<ul>\n<li>L1C1-style current selection for single-character selections</li>\n<li>L1C1-L1C1-style current selection for multiple-character selections</li>\n</ul>\n\n<p>But also context-sensitive information about the selected <em>declaration</em>:</p>\n\n<ul>\n<li>The name of the type library it's located in;</li>\n<li>The fully-qualified module/member name;</li>\n<li>The type of declaration (whether it's a function, a property, etc.);</li>\n<li>The declared/return type, when applicable;</li>\n<li>If the declaration has a <em>docstring</em>, a <code>VB_Description</code> attribute, or a Rubberduck <code>@Description</code> annotation, that description appears in the toolbar;</li>\n<li>The number of references to that identifier <em>across the entire project</em>.</li>\n</ul>\n\n<hr>\n\n<p>The latest/current pre-release/CI build apparently has a <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/3235\" rel=\"nofollow noreferrer\">bug that prevents the L1C1 selection from being displayed</a>. Will be fixed shortly. We're also working on fixing an annoying glitch that makes the reported number of references in the toolbar be off (clicking the button brings up the correct number of references in a <em>Search Results</em> toolwindow tab though). You may want to try v2.0.13 instead of the latest 2.1 prerelease/CI builds.</p>\n"}], "owner": {"reputation": 1543, "user_id": 2142248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/F2o9H.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/2142248/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 45597827, "answer_count": 2, "score": 0, "last_activity_date": 1502304937, "creation_date": 1502302177, "question_id": 45597826, "link": "https://stackoverflow.com/questions/45597826/how-do-i-show-the-ln-and-col-numbers-in-the-visual-basic-editor", "title": "How do I show the Ln and Col numbers in the Visual Basic editor?", "body": "<p>Most IDEs have a display that tells the user what line (Ln) and column (Col) position the cursor is currently located at. Is this function available in the Visual Basic Editor?</p>\n"}, {"tags": ["excel", "vba", "loops", "formatting"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502307450, "post_id": 45597778, "comment_id": 78158064, "body": "What&#39;s <code>i</code>?  How/where do you declare and define that?"}, {"owner": {"reputation": 510, "user_id": 5750238, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f8c528289be7ce55285c205cbfedfa65?s=128&d=identicon&r=PG&f=1", "display_name": "CapnShanty", "link": "https://stackoverflow.com/users/5750238/capnshanty"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502371351, "post_id": 45597778, "comment_id": 78188493, "body": "It&#39;s defined elsewhere in the code and used to get the column, i functions as it should"}], "answers": [{"tags": [], "owner": {"reputation": 195, "user_id": 7779562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a15c7becb72fdd9c81c817aa4b693ff?s=128&d=identicon&r=PG&f=1", "display_name": "AdzzzUK", "link": "https://stackoverflow.com/users/7779562/adzzzuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1502376977, "creation_date": 1502376977, "answer_id": 45617153, "question_id": 45597778, "link": "https://stackoverflow.com/questions/45597778/trying-to-get-vba-code-to-copy-over-bold-formatting/45617153#45617153", "title": "Trying to get VBA code to copy over bold formatting?", "body": "<p>Because you're copying and pasting values elsewhere, it's generally a good idea to clear the clipboard after each copy.  This may also affect the performance (in a positive way).</p>\n\n<p>Add the following code to immediately after your <code>PasteSpecial</code> line:</p>\n\n<p><code>Application.CutCopyMode = False</code></p>\n\n<p>Does the sheet contain any conditional formatting rules that may break?</p>\n"}], "owner": {"reputation": 510, "user_id": 5750238, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f8c528289be7ce55285c205cbfedfa65?s=128&d=identicon&r=PG&f=1", "display_name": "CapnShanty", "link": "https://stackoverflow.com/users/5750238/capnshanty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502376977, "creation_date": 1502302036, "last_edit_date": 1502376250, "question_id": 45597778, "link": "https://stackoverflow.com/questions/45597778/trying-to-get-vba-code-to-copy-over-bold-formatting", "title": "Trying to get VBA code to copy over bold formatting?", "body": "<p>Here is my current implementation (this is a small section of a much longer script):</p>\n\n<pre><code>Dim j As Integer, q As Integer\nq = 2\nFor j = 1 To 300\n    If Sheet2.Cells(j, i).Value = \"X\" Then\n    Sheet1.Cells(q, 4).Value = Sheet2.Cells(j, 3).Value\n        If Cells(j, 3).Font.Bold = True Then\n            Sheet2.Cells(j, 3).Copy\n            Sheet1.Cells(q, 4).PasteSpecial (xlPasteFormats)\n        End If\n     q = q + 1\n    End If\nNext j\n</code></pre>\n\n<p>This code is looping through a range and finding values that have an X in another column, that's for something else. But I am trying to also get it to copy over specifically the bold formatting. This implementation \"works\" in that it runs, but confusingly, it only picks up on the bold formatting sometimes, and usually only the first bold entry in a group of bold entries. </p>\n\n<p>I can't have it just copy over every single one, because while that works, it also runs slowly and is generally ugly. Maybe if I included a DoEvents = false it wouldn't be so bad, but still.</p>\n"}, {"tags": ["excel", "google-apps-script", "vba"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 3, "creation_date": 1502301635, "post_id": 45597593, "comment_id": 78154808, "body": "You just call it like this <code>example1()</code>. Using <code>call</code> to call a function is just a quirk only VBA has. And would not even be required in your case if it was VBA. <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/call-statement\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/language-reference-vba/articles&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 67, "user_id": 8174172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/217bcc4e31b7da2f8765a65b4d85d073?s=128&d=identicon&r=PG&f=1", "display_name": "Plaidpenguinhat", "link": "https://stackoverflow.com/users/8174172/plaidpenguinhat"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502379614, "post_id": 45597593, "comment_id": 78195430, "body": "Thanks, I knew it had to be something simple."}], "answers": [{"tags": [], "owner": {"reputation": 1295, "user_id": 3460432, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/9VqwC.jpg?s=128&g=1", "display_name": "OblongMedulla", "link": "https://stackoverflow.com/users/3460432/oblongmedulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1502305504, "creation_date": 1502305504, "answer_id": 45598783, "question_id": 45597593, "link": "https://stackoverflow.com/questions/45597593/equivalent-to-call-command/45598783#45598783", "title": "Equivalent to &quot;call&quot; command", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function example1(){\r\ncalc.getRange('G3:G15').clearContent()\r\n\r\n}\r\n\r\n\r\nfunction ClearFields(){\r\ncalc.getRange('A3:C15').clearContent()\r\nexample1(); // This will execute the function\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 67, "user_id": 8174172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/217bcc4e31b7da2f8765a65b4d85d073?s=128&d=identicon&r=PG&f=1", "display_name": "Plaidpenguinhat", "link": "https://stackoverflow.com/users/8174172/plaidpenguinhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502305504, "creation_date": 1502301326, "last_edit_date": 1531164843, "question_id": 45597593, "link": "https://stackoverflow.com/questions/45597593/equivalent-to-call-command", "title": "Equivalent to &quot;call&quot; command", "body": "<p>I'm sure this is a dumb question, but I can't find the answer anywhere. In Apps Script, is there an equivalent to the VBA \"Call\" command? I want to call one Function from within another Function, by the name as a string.</p>\n\n<pre><code>function ClearFields(){\ncalc.getRange('A3:C15').clearContent()\n\"Call\" function example1\n}\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1502301782, "post_id": 45597578, "comment_id": 78154880, "body": "You don&#39;t actually have a period at the end of your formula do you?  The formula (sans period) works just fine and calculates for me successfully.  Is your workbook set to Automatic calculation?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1502301842, "post_id": 45597578, "comment_id": 78154905, "body": "Also, the VBA line is wholly unnecessary and not actually used or referenced by the formula."}, {"owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "edited": false, "score": 0, "creation_date": 1502303466, "post_id": 45597578, "comment_id": 78155874, "body": "File &gt; Options &gt; Formulas &gt; Workbook Calculation = Automatic. You can also check this when you are expecting cells to calculate and they aren&#39;t."}, {"owner": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "edited": false, "score": 0, "creation_date": 1502306645, "post_id": 45597578, "comment_id": 78157621, "body": "No, I don&#39;t have a period at the end of the formula lol. Sorry for that. Also, the workbook calculation is already set to Automatic. In VB, would PI automatically reference the Global Const, although it&#39;s being used in the formula? And if it&#39;s working on your end, I have no clue why it isn&#39;t on mine..."}, {"owner": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "edited": false, "score": 0, "creation_date": 1502307272, "post_id": 45597578, "comment_id": 78157969, "body": "And it says &quot;A value used in the formula is of the wrong data type&quot;. Isn&#39;t this referring to the formatting of the cells? All cells are formatted as numeric values. I am lost..."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1502309901, "post_id": 45597578, "comment_id": 78159231, "body": "if you copy it to a new sheet or workbook, still same issue?"}, {"owner": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "edited": false, "score": 0, "creation_date": 1502311108, "post_id": 45597578, "comment_id": 78159822, "body": "Yes. Same issue. Is there a way to make sure that Events are enabled?"}, {"owner": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "edited": false, "score": 0, "creation_date": 1502312727, "post_id": 45597578, "comment_id": 78160594, "body": "I figured it out. The &quot;empty&quot; cells have to have a 0 for numeric value, vs can be blank if formatted as General. Thanks for all the help!"}], "owner": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502301282, "creation_date": 1502301282, "question_id": 45597578, "link": "https://stackoverflow.com/questions/45597578/reference-cell-not-calculating", "title": "Reference cell not calculating", "body": "<p>I am having an issue with a cell that has a formula in it, but it's not calculating. I am using Excel 2013 and the data is as follows:\nI have 12 cells(z14:ab17) the user will place a numeric value in. The formulated cell has a formula that uses the numeric cells to calculate a value, but all the cell displays is #VALUE!. The formula is </p>\n\n<pre><code>=IF((ISNUMBER(SUM(Z14:AB17))),PI()/4/32^2*(Z14^2+AA14^2+AB14^2+Z15^2+AA15^2+AB15^2+Z16^2+AA16^2+AB16^2+Z17^2+AA17^2+AB17^2),0).\n</code></pre>\n\n<p>In the VBA side, I have </p>\n\n<pre><code>Global Const PI = 3.1415927\n</code></pre>\n\n<p>All the user input cells are formatted for numeric values, and the formulated cell is also formulated to calculate and display a numeric value. Can anyone help with why the cells is not calculating? This did work at one time, but now it doesn't and I have no idea what could have happened. Thanks in advance</p>\n"}, {"tags": ["excel", "offset", "vba"], "answers": [{"comments": [{"owner": {"reputation": 695, "user_id": 6282032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a41a28da2c170872722d2cbc8082424f?s=128&d=identicon&r=PG&f=1", "display_name": "Tox", "link": "https://stackoverflow.com/users/6282032/tox"}, "edited": false, "score": 0, "creation_date": 1502300819, "post_id": 45597399, "comment_id": 78154324, "body": "Yes I understand that, but since it will eventually be used in a larger tool that I am building I want everything to be calculated by vba."}], "tags": [], "owner": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "is_accepted": false, "score": 1, "last_activity_date": 1502305008, "last_edit_date": 1502305008, "creation_date": 1502300656, "answer_id": 45597399, "question_id": 45597356, "link": "https://stackoverflow.com/questions/45597356/excel-vba-offset-function/45597399#45597399", "title": "Excel VBA offset function", "body": "<ol>\n<li><p>You don't need to use VBA for this. Simply type =sum(A1:B1) in cell D1 and then <a href=\"http://www.pryor.com/blog/copy-excel-formulas-down-to-fill-a-column/\" rel=\"nofollow noreferrer\">fill it down</a>.</p></li>\n<li><p>If you're going to use VBA anyway, use this:</p>\n\n<pre><code>Sub checkOffset()\nDim example As Range\nDim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nSet example = Range(\"A1:A1\")\n\nFor i = 1 To LastRow\n    example.Offset(i - 1, 3).Formula = \"=SUM(A\" &amp; i &amp; \":B\" &amp; i &amp; \")\"\nNext i\n\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>The way <code>offset</code> works is with row offset, column offset. You want the column to always be fixed at 3 to the right.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1502300703, "creation_date": 1502300703, "answer_id": 45597415, "question_id": 45597356, "link": "https://stackoverflow.com/questions/45597356/excel-vba-offset-function/45597415#45597415", "title": "Excel VBA offset function", "body": "<p>Using the <code>Offset(Row, Column)</code>, you want to offset with the increment of row (<code>i -1</code>), and 3 columns to the right (from column \"A\" to column \"D\")</p>\n\n<p>Try the modified code below:</p>\n\n<pre><code>Set example = Range(\"A1\")\n\nFor i = 1 To LastRow\n    example.Offset(i - 1, 3).Formula = \"=SUM(A\" &amp; i &amp; \":B\" &amp; i &amp; \")\"\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 3, "last_activity_date": 1502302261, "last_edit_date": 1502302261, "creation_date": 1502301783, "answer_id": 45597717, "question_id": 45597356, "link": "https://stackoverflow.com/questions/45597356/excel-vba-offset-function/45597717#45597717", "title": "Excel VBA offset function", "body": "<p>One way of outputting the formula in one step, without looping, to the entire range, is to use the R1C1 notation:</p>\n\n<p><strong><em>Edit: Code modified to properly qualify worksheet references</em></strong></p>\n\n<pre><code>Option Explicit\nSub checkOffset()\n\nDim example As Range\nDim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\n\nWith sht\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Set example = .Range(.Cells(1, 1), .Cells(LastRow, 1))\nEnd With\n\nexample.Offset(columnoffset:=3).FormulaR1C1 = \"=sum(rc[-3],rc[-2])\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 695, "user_id": 6282032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a41a28da2c170872722d2cbc8082424f?s=128&d=identicon&r=PG&f=1", "display_name": "Tox", "link": "https://stackoverflow.com/users/6282032/tox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17032, "favorite_count": 0, "accepted_answer_id": 45597415, "answer_count": 3, "score": 1, "last_activity_date": 1502305008, "creation_date": 1502300517, "last_edit_date": 1531161705, "question_id": 45597356, "link": "https://stackoverflow.com/questions/45597356/excel-vba-offset-function", "title": "Excel VBA offset function", "body": "<p>I have an Excel file with information in column A and column B. Since these columns could vary in the number of rows I would like to use the function <strong>offset</strong> so that I could print the formula in one time as an array rather than looping over the formula per cell (the dataset contains almost 1 million datapoints).</p>\n\n<p><a href=\"https://i.stack.imgur.com/chMZg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/chMZg.png\" alt=\"My data is as follow:\"></a></p>\n\n<p>My code is actually working the way I want it to be I only can't figure out how to print the code in Range(D1:D5). The outcome is now printed in Range(D1:H1). Anybody familiar how to use this offset within a for statement?</p>\n\n<pre><code>Sub checkOffset()\n\nDim example As Range\nDim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nSet example = Range(\"A1:A1\")\n\nFor i = 1 To LastRow\n    example.Offset(0, i + 2).Formula = \"=SUM(A\" &amp; i &amp; \":B\" &amp; i &amp; \")\"\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502300479, "post_id": 45597257, "comment_id": 78154121, "body": "do <code>prog.Range(&quot;C12&quot;).Select</code> and check if the expected cell is selected. i suspect that <i>prog</i> is not a worksheet object"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502300752, "post_id": 45597257, "comment_id": 78154283, "body": "the issue &quot;outside&quot; may be a vba-error which is reset by doing a vba-reset... then all variables will be &quot;forgotten&quot; and <code>prog</code> isn&#39;t a pointer to a sheet anymore... or something similar..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502323115, "post_id": 45597257, "comment_id": 78164127, "body": "Is the sheet protected?"}, {"owner": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "edited": false, "score": 0, "creation_date": 1502364454, "post_id": 45597257, "comment_id": 78182955, "body": "Yes the sheet is protected, but there is code in the sub that unprotected it. I found that the problem was that I had &quot;sheet&quot; code that was running any time a cell would change on the worksheet and it would protect the sheet after the first line of code had ran. I specified the &quot;sheet&quot; code to only run when certain cells changed and the code above will now work. Thank you all for your help."}], "owner": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502300212, "creation_date": 1502300212, "question_id": 45597257, "link": "https://stackoverflow.com/questions/45597257/issue-outside-of-code-is-causing-problems-inside-code", "title": "issue outside of code is causing problems inside code", "body": "<p>Excel is giving me problems with the following code</p>\n\n<pre><code>'Updates the \"5001 Prog\" sheet with the new data\n    prog.Range(\"C12\").Value = (y &amp; \"'' Ream\")\n\n    prog.Range(\"D12\").Value = count * 31.5\n\n    prog.Range(\"E12\").Value = daily * 31.5\n</code></pre>\n\n<p>It does not matter what I change after the \"=\" sign, or before the \"=\" sign I get the </p>\n\n<p>\"Run-time error '1004' Application-defined or object-defined error\" </p>\n\n<p>What could cause this error outside of the VBA code? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1502300245, "post_id": 45597228, "comment_id": 78153987, "body": "Yes, VLOOKUP is the correct function. Either manually type in the correct return column numbers (the third argument of the formula), or use a MATCH function.  Probably combine with IFERROR so you can check both sheets for the header."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8441137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5464a26dbe240cff0d53c205872bf3b5?s=128&d=identicon&r=PG&f=1", "display_name": "sneha99", "link": "https://stackoverflow.com/users/8441137/sneha99"}, "edited": false, "score": 0, "creation_date": 1502302665, "post_id": 45597637, "comment_id": 78155391, "body": "Thank you very much! The B2 cell shows #N/A but I know where to go now. I can fix the rest by myself. Thanks again!"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1590908464, "last_edit_date": 1590908464, "creation_date": 1502301511, "answer_id": 45597637, "question_id": 45597228, "link": "https://stackoverflow.com/questions/45597228/match-columns-in-two-different-sheets-and-return-multiple-columns-excel/45597637#45597637", "title": "Match columns in two different sheets and return multiple columns [Excel]", "body": "<p>Using your provided sample data, I created the following solution.</p>\n\n<p>In Sheet \"Sheet Soln\" cell J1 (can be any cell and can be hidden if preferred) is this formula to identify how many matching codes are in both sheets: <code>=SUMPRODUCT(COUNTIF(Sheet2!A:A,Sheet1!A2:A7))</code>  Adjust the <code>A2:A7</code> to match your actual range.  This is done so that this calculation is only performed once and then referenced later to cut down on formula calculations (increasing workbook efficiency).</p>\n\n<p>Then in your Sheet Soln, cell A2 use this formula and copy down to get only the codes that are present in both sheets: <code>=IF(ROW(A1)&gt;$J$1,\"\",INDEX(Sheet1!$A$2:$A$7,MATCH(1,INDEX((COUNTIF(A$1:A1,Sheet1!$A$2:$A$7)=0)*COUNTIF(Sheet2!$A:$A,Sheet1!$A$2:$A$7),),0)))</code></p>\n\n<p>And in cell B2 use this formula and copy over and down to get the values for that code for their respective headers: <code>=IF($A2=\"\",\"\",IFERROR(VLOOKUP($A2,Sheet1!$A:$E,MATCH(B$1,Sheet1!$A$1:$E$1,0),FALSE),VLOOKUP($A2,Sheet2!$A:$E,MATCH(B$1,Sheet2!$A$1:$E$1,0),FALSE)))</code></p>\n"}], "owner": {"reputation": 3, "user_id": 8441137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5464a26dbe240cff0d53c205872bf3b5?s=128&d=identicon&r=PG&f=1", "display_name": "sneha99", "link": "https://stackoverflow.com/users/8441137/sneha99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 45597637, "answer_count": 1, "score": 0, "last_activity_date": 1590908464, "creation_date": 1502300104, "last_edit_date": 1502302813, "question_id": 45597228, "link": "https://stackoverflow.com/questions/45597228/match-columns-in-two-different-sheets-and-return-multiple-columns-excel", "title": "Match columns in two different sheets and return multiple columns [Excel]", "body": "<p>So this question looks simple but is rather complicated but I'll try my luck anyways. </p>\n\n<p>There are two sheets, both have a similar first column (Code). The Code is the \"master key\" if you will - Each code has a lot of different information (around 200-300 columns of data) in each sheet. Also, these codes are not the same and are randomly clustered. Some of these codes do match. I've highlighted codes which match in yellow in my sample image. </p>\n\n<p>So what I'm trying to do is to add all the columns of data which match with the first column (Code) to a new sheet. My sample sheets and the ideal solution would look something like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/q0T25.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q0T25.png\" alt=\"Sheet Sample and Solution\"></a></p>\n\n<p>I have tried to solve this using several =vLookup functions but I keep getting stuck. I do have several columns of data so I'm not even sure if =vLookup is something I should be using. I'm fairly new to Excel as well so I'd be glad if someone showed me in the right direction.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1502300661, "post_id": 45597305, "comment_id": 78154223, "body": "Can you explain this formula to me? I&#39;ll have to change slightly how it&#39;s applied. What do A2 and D2 represent? Those values will not apply to all records in the sheet."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1502300759, "post_id": 45597305, "comment_id": 78154286, "body": "@Steven <code>A2</code> and <code>D2</code> will apply to the first record. Since they are <b>relative</b>, they will be shifted with each record (A3 and D3 will aply to row 3 and so on). The formula checks if there is at least one <code>source</code> record with the same <code>ID</code> and <code>SSN</code>."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 1, "creation_date": 1502300851, "post_id": 45597305, "comment_id": 78154351, "body": "I believe I can actually leave A2 alone and just change D2 to E2, F2 and so on as I progress to the other columns. It seems to be working, so thank you!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1502301294, "post_id": 45597305, "comment_id": 78154613, "body": "@Steven, that&#39;s right. But you can even make it simpler, sorry I didn&#39;t notice you want it for all columns. You can make only one CF: select the range <code>B2:E7</code> and change the formula to: <code>=COUNTIFS($A:$A,$A2,B:B,B2,$F:$F, &quot;source&quot;)=0</code>. Notice that we <b>fix</b> the columns <code>A</code> and <code>F</code> using <code>$</code>, and make the others movable."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1502301476, "last_edit_date": 1502301476, "creation_date": 1502300342, "answer_id": 45597305, "question_id": 45597117, "link": "https://stackoverflow.com/questions/45597117/apply-formatting-to-a-cell-if-its-values-dont-match-that-of-another-cell-or-gr/45597305#45597305", "title": "Apply formatting to a cell if its values don&#39;t match that of another cell (or group of cells)", "body": "<p>Select the column <code>D</code> from <code>D2</code> downward, and enter this custom conditional formatting formula:</p>\n\n<pre><code>=COUNTIFS(A:A,A2,D:D,D2,F:F,\"source\")=0\n</code></pre>\n\n<p>and set the format/fill to yellow.</p>\n\n<hr>\n\n<p>To apply the same rule to all column <code>B</code> through <code>E</code>, select the range <code>B2:E7</code> and use the CF formula:</p>\n\n<pre><code>=COUNTIFS($A:$A,$A2,B:B,B2,$F:$F, \"source\")=0\n</code></pre>\n\n<p>Notice that we <strong>fix</strong> the columns <code>A</code> and <code>F</code> using <code>$</code>, and make the others movable</p>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 45597305, "answer_count": 1, "score": 1, "last_activity_date": 1502301476, "creation_date": 1502299732, "last_edit_date": 1531161705, "question_id": 45597117, "link": "https://stackoverflow.com/questions/45597117/apply-formatting-to-a-cell-if-its-values-dont-match-that-of-another-cell-or-gr", "title": "Apply formatting to a cell if its values don&#39;t match that of another cell (or group of cells)", "body": "<p><a href=\"https://i.stack.imgur.com/SRIRz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SRIRz.png\" alt=\"Excel snapshot\"></a></p>\n\n<p>I have an Excel document that is formatted similarly to the one pictured above. It is, however, very large. The ID and Flag fields are proprietary and will <em>never</em> change between SSN's.</p>\n\n<p>I basically need to use ID to compare the 'OLD' records to the 'Source' records. If the column value of the 'OLD' record doesn't match any of the column values for the 'Source' record(s), fill that cell yellow.</p>\n\n<p>I'm familiar with Access VBA but I've never written it in Excel and I'm not sure where to start, or if this is even possible. I've tried to include examples in my image. </p>\n\n<p>You'll notice, for example, that Amy Winer's OLD SSN does not match up to either of her source SSNs, so that cell is yellow.</p>\n\n<p>Where to start?</p>\n"}, {"tags": ["excel", "vba", "outlook", "advanced-search"], "comments": [{"owner": {"reputation": 4665, "user_id": 1035345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wcV3D.gif?s=128&g=1", "display_name": "twoleggedhorse", "link": "https://stackoverflow.com/users/1035345/twoleggedhorse"}, "edited": false, "score": 0, "creation_date": 1502298760, "post_id": 45596795, "comment_id": 78153130, "body": "Why are you using VBA in Excel to do this?"}, {"owner": {"reputation": 63, "user_id": 8374965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b0eb7cfe9671ba774a1b532d66f9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Trs", "link": "https://stackoverflow.com/users/8374965/trs"}, "reply_to_user": {"reputation": 4665, "user_id": 1035345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wcV3D.gif?s=128&g=1", "display_name": "twoleggedhorse", "link": "https://stackoverflow.com/users/1035345/twoleggedhorse"}, "edited": false, "score": 0, "creation_date": 1502298944, "post_id": 45596795, "comment_id": 78153226, "body": "Because this will be part of an Excel Workbook that will be distributed to several users so it should be self-contained"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8468981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b57261e1b8e05ee8f4b43a0a3b8bae?s=128&d=identicon&r=PG", "display_name": "koram", "link": "https://stackoverflow.com/users/8468981/koram"}, "is_accepted": false, "score": 0, "last_activity_date": 1502826298, "creation_date": 1502826298, "answer_id": 45700381, "question_id": 45596795, "link": "https://stackoverflow.com/questions/45596795/displaying-the-items-of-advanced-search-without-saving-in-folder-outlook-vba/45700381#45700381", "title": "displaying the items of advanced search without saving in folder outlook vba", "body": "<p>You don't need to save the search. When advanced search is done the Outlook.Application object is raising an event:\n<a href=\"https://msdn.microsoft.com/VBA/Outlook-VBA/articles/application-advancedsearch-method-outlook\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/VBA/Outlook-VBA/articles/application-advancedsearch-method-outlook</a></p>\n"}], "owner": {"reputation": 63, "user_id": 8374965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b0eb7cfe9671ba774a1b532d66f9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Trs", "link": "https://stackoverflow.com/users/8374965/trs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 723, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502826298, "creation_date": 1502298540, "last_edit_date": 1502298870, "question_id": 45596795, "link": "https://stackoverflow.com/questions/45596795/displaying-the-items-of-advanced-search-without-saving-in-folder-outlook-vba", "title": "displaying the items of advanced search without saving in folder outlook vba", "body": "<p>I want to run an advance search in outlook through excel vba, in order to find some emails and create an automatic reply to one of them.</p>\n\n<p>My problem is that I don't know how to deal with the results of the search as a group of Items, ordering them by date and replying to the most recent one WITHOUT saving them in any Search Folder.</p>\n\n<p>So far, I was only able to run the advanced search and save the results of the search into a folder: </p>\n\n<pre><code>    Sub test()\n        Dim Outl As Object\n        Dim TESTEfolder As Object\n        Dim Search As Object\n\n        Set Outl = CreateObject(\"Outlook.Application\")\n        Set TESTEfolder = Outl.GetNamespace(\"MAPI\").GetDefaultFolder(6).Folders(\"TESTE\")\n        Set Search = Outl.AdvancedSearch(\"'\" &amp; TESTEfolder.FolderPath &amp; \"'\")\n        Search.Save (\"TESTEcopy\") 'I want to skip this and handle the Items inside Search directly\n\n    End Sub\n</code></pre>\n\n<p>Notes: I have to use LATE binding and the Advanced Search rather than Find/Restrict/InStr </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1502297046, "post_id": 45596279, "comment_id": 78152158, "body": "<code>without a problem</code> - but there is a problem. You are converting a date to string. Is that in fact what you found doing your web search?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1502297078, "post_id": 45596279, "comment_id": 78152177, "body": "Simpler to <code>if hour(time) &gt; 13 and hour(time) &lt; 18</code> ?"}, {"owner": {"reputation": 660, "user_id": 5338595, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ueeGL.jpg?s=128&g=1", "display_name": "rohitanand", "link": "https://stackoverflow.com/users/5338595/rohitanand"}, "edited": false, "score": 0, "creation_date": 1502297083, "post_id": 45596279, "comment_id": 78152179, "body": "<a href=\"http://www.freevbcode.com/ShowCode.asp?ID=8259\" rel=\"nofollow noreferrer\">freevbcode.com/ShowCode.asp?ID=8259</a>"}, {"owner": {"reputation": 19, "user_id": 8440881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8e4dd48f175a0e1772cf00cda7665a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Heikkila", "link": "https://stackoverflow.com/users/8440881/thomas-heikkila"}, "edited": false, "score": 0, "creation_date": 1502297466, "post_id": 45596279, "comment_id": 78152401, "body": "Yes those snippets of code are from web searchs."}, {"owner": {"reputation": 19, "user_id": 8440881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8e4dd48f175a0e1772cf00cda7665a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Heikkila", "link": "https://stackoverflow.com/users/8440881/thomas-heikkila"}, "edited": false, "score": 0, "creation_date": 1502297495, "post_id": 45596279, "comment_id": 78152424, "body": "&quot;if hour(time) &gt; 13 and hour(time) &lt; 18 &quot; does not work"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1502298167, "post_id": 45596279, "comment_id": 78152765, "body": "It should work fine.  What is the value if you print <code>hour(time)</code> ?"}, {"owner": {"reputation": 19, "user_id": 8440881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8e4dd48f175a0e1772cf00cda7665a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Heikkila", "link": "https://stackoverflow.com/users/8440881/thomas-heikkila"}, "edited": false, "score": 0, "creation_date": 1502298779, "post_id": 45596279, "comment_id": 78153139, "body": "Private Sub Form_Open(Cancel As Integer)  lbShiftNum.Caption = Hour(Time) End Sub returns 12 which it currently is."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1502298887, "post_id": 45596279, "comment_id": 78153202, "body": "Then <code>if hour(time) &gt; 13 and hour(time) &lt; 18</code> is going to be <code>false</code>."}, {"owner": {"reputation": 19, "user_id": 8440881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8e4dd48f175a0e1772cf00cda7665a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Heikkila", "link": "https://stackoverflow.com/users/8440881/thomas-heikkila"}, "edited": false, "score": 0, "creation_date": 1502299446, "post_id": 45596279, "comment_id": 78153503, "body": "I know. I adjusted my code"}, {"owner": {"reputation": 19, "user_id": 8440881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8e4dd48f175a0e1772cf00cda7665a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Heikkila", "link": "https://stackoverflow.com/users/8440881/thomas-heikkila"}, "edited": false, "score": 0, "creation_date": 1502299823, "post_id": 45596279, "comment_id": 78153709, "body": "If Hour(Time) &gt; 11 Then lbShiftNum.Caption = &quot;SHIFT 1&quot; works like it should based on my current time."}, {"owner": {"reputation": 19, "user_id": 8440881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8e4dd48f175a0e1772cf00cda7665a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Heikkila", "link": "https://stackoverflow.com/users/8440881/thomas-heikkila"}, "edited": false, "score": 0, "creation_date": 1502301366, "post_id": 45596279, "comment_id": 78154669, "body": "Your code works Alex K."}], "owner": {"reputation": 19, "user_id": 8440881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8e4dd48f175a0e1772cf00cda7665a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Heikkila", "link": "https://stackoverflow.com/users/8440881/thomas-heikkila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1796, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502296863, "creation_date": 1502296725, "last_edit_date": 1502296863, "question_id": 45596279, "link": "https://stackoverflow.com/questions/45596279/vba-code-to-determine-if-current-time-is-within-a-time-range", "title": "VBA code to determine if current time is within a time range", "body": "<p>I need to determine if the current time falls between a time range in VBA. I have seen many ways to do this and none have worked. I can get the current time without a problem.</p>\n\n<pre><code>lbShiftNum.Caption = Time()\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Dim sTime As String\nsTime = Time()\nlbShiftNum.Caption = sTime\n</code></pre>\n\n<p>I have worked with variations of the following code to determine if the time falls within a range. I know the examples I am giving may have issues. These are examples I found doing a web search.</p>\n\n<pre><code>Dim sTime As String\nsTime = Time()\nIf sTime &gt; #1:00:00 PM# And sTime &lt; #6:00:00 PM# Then ....\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If Time &gt; TimeValue(\"00:01:00\") And Time &lt; TimeValue(\"06:50:00\") Then ....\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528826992, "post_id": 45596268, "comment_id": 88651617, "body": "I&#39;m not sure I understand why the user is able to edit the template itself? A macro-enabled template, when clicked by an &quot;end user&quot; should open itself as a separate, plain workbook with no macros in it. The only time the macros in the template are available are when it is being created. If it is to be changed often I don&#39;t think it makes sense that it is a template"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528928474, "post_id": 45596268, "comment_id": 88697665, "body": "@Marcucciboy2 I don&#39;t know if this depends on some settings, but on my PC, when I double-click on a macro-enabled template workbook, the new file that is created still contains the vba code from the template."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1528951391, "post_id": 45596268, "comment_id": 88702238, "body": "@DecimalTurn i wonder if i had it in a module instead of ThisWorkbook when I tried it"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1529105101, "post_id": 45596268, "comment_id": 88769495, "body": "You may just create new workbook, copy worksheets, save it and close."}], "answers": [{"comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1529108422, "post_id": 50791420, "comment_id": 88769967, "body": "If we only take into account the title and the first 5 words of the question, this answer is perfect. However, it does not take into account the context provided in the question."}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1529294222, "post_id": 50791420, "comment_id": 88804781, "body": "DecimalTurn, could you please explain what exactly you think is not being taken into account? I&#39;m missing it... Thx!"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1529298841, "post_id": 50791420, "comment_id": 88805673, "body": "The question is about making things easier for end users to save the new file. So, I think an answer should make use of an event macro (eg. Workbook_BeforeSave) as mentioned in the question. This way, users don&#39;t have to run the macros by themselves which would go against the initial objective."}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1529299519, "post_id": 50791420, "comment_id": 88805827, "body": "You may argue on that as the question was how to prevent the error message from showing, but I think I got your point now, taking this one step further."}], "tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": false, "score": 3, "last_activity_date": 1528697655, "creation_date": 1528697655, "answer_id": 50791420, "question_id": 45596268, "link": "https://stackoverflow.com/questions/45596268/saving-new-excel-document-as-macro-free-workbook-without-prompt/50791420#50791420", "title": "Saving new Excel document as macro-free workbook without prompt", "body": "<p>I cannot test on Excel 2010, but at least for 2016, it's working fine:</p>\n\n<pre><code>Sub SaveAsRegularWorkbook()\n\n    Dim wb As Workbook\n    Dim Path As String\n\n    Set wb = ThisWorkbook\n    Path = \"T:\\he\\Path\\you\\prefer\\\"\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n    wb.SaveAs Filename:=Path &amp; \"Test.xlsx\", FileFormat:=51\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Give it a try.</p>\n"}, {"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528825821, "post_id": 50809442, "comment_id": 88651008, "body": "isn&#39;t <code>isWorkbookOpen</code> the same as <code>isFileOpen</code> ?"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1528900801, "post_id": 50809442, "comment_id": 88683718, "body": "Not exactly. <code>isWorkbookOpen</code> will return <code>True</code> only when the workbook is open in the current Excel application. And <code>isFileOpen</code> will return <code>True</code> if the file is open in another Excel application on the same computer or by someone else (if the file is on a shared drive)."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": false, "score": 1, "last_activity_date": 1529262994, "last_edit_date": 1529262994, "creation_date": 1528779120, "answer_id": 50809442, "question_id": 45596268, "link": "https://stackoverflow.com/questions/45596268/saving-new-excel-document-as-macro-free-workbook-without-prompt/50809442#50809442", "title": "Saving new Excel document as macro-free workbook without prompt", "body": "<p>For this answer, I'm assuming that by Excel macro-enabled template, you mean a xltm file. I also guess that what you mean by \"new document\" is the document that is generated when a user double-clicks on the xtlm file (hence this new file has no location on since it hasn't been saved yet). </p>\n\n<p>To solve your issue, you could use a <strong>custom SaveAs window</strong> (<code>Application.GetSaveAsFilename</code>) to have more control on how the user saves the file when the <code>Workbook_BeforeSave</code> event macro gets called.</p>\n\n<p>Here is how to implement it:</p>\n\n<p><strong>1</strong> - Copy this code into a new module.  </p>\n\n<pre><code>Option Explicit  \n\nSub SaveAsCustomWindow()  \n\n    Const C_PROC_NAME As String = \"SaveAsCustomWindow\"\n    Dim strFullFileName As String, strPreferedFolder As String, strDefaultName As String\n    Dim UserInput1 As Variant, UserInput2 As Variant\n    Dim isValidName As Boolean, isFileClosed As Boolean, isWorkbookClosed As Boolean\n    Dim strFilename As String, strFilePath As String\n\n\n    'To avoid Warning when overwriting\n    Application.DisplayAlerts = False\n    'Disable events (mostly for the BeforeSave event) to avoid creating infinite loop\n    Application.EnableEvents = False\n    On Error GoTo ErrHandler\n\n    'Customizable section\n    strDefaultName = ThisWorkbook.Name\n    strPreferedFolder = Environ(\"USERPROFILE\")\n\n    Do While isWorkbookClosed = False\n        Do While isFileClosed = False\n            Do While isValidName = False\n                UserInput1 = Application.GetSaveAsFilename(InitialFileName:=strPreferedFolder &amp; \"\\\" &amp; strDefaultName, FileFilter:=\"Excel Workbook (*.xlsx),*.xlsx\")\n\n                If UserInput1 = False Then\n                    GoTo ClosingStatements 'This is important to take care of the case when the user presses cancel\n                Else\n                    strFullFileName = UserInput1\n                End If\n\n                strFilename = Right(strFullFileName, Len(strFullFileName) - InStrRev(strFullFileName, \"\\\"))\n                strDefaultName = strFilename\n\n                strFilePath = Left(strFullFileName, InStrRev(strFullFileName, \"\\\") - 1)\n                strPreferedFolder = strFilePath\n\n                'If the file exist, ask for overwrite permission\n                If Dir(strFullFileName) &lt;&gt; \"\" Then\n                    UserInput2 = MsgBox(strFilename &amp; \" already exists.\" &amp; vbNewLine &amp; \"Do you want to overwrite?\", vbYesNoCancel Or vbExclamation)\n                    If UserInput2 = vbNo Then\n                        isValidName = False\n                    ElseIf UserInput2 = vbYes Then\n                        isValidName = True\n                    ElseIf UserInput2 = vbCancel Then\n                        GoTo ClosingStatements\n                    Else\n                        GoTo ClosingStatements\n                    End If\n                Else\n                    isValidName = True\n                End If\n            Loop\n\n            'Check if file is actually open\n            If isFileOpen(strFullFileName) Then\n                MsgBox \"The workbook you want to overwrite is currently open. Choose a different name, or close the  workbook before saving.\", vbExclamation\n                isValidName = False\n                isFileClosed = False\n            Else\n                isFileClosed = True\n            End If\n        Loop\n\n        'Check if an opened workbook has the same name\n        If isWorkbookOpen(strFilename) Then\n            MsgBox \"You cannot save this workbook with the same name as another open workbook or add-in. Choose a different name, or close the other workbook or add-in before saving.\", vbExclamation\n            isValidName = False\n            isFileClosed = False\n            isWorkbookClosed = False\n        Else\n            isWorkbookClosed = True\n        End If\n    Loop\n\n    ThisWorkbook.SaveAs Filename:=strFullFileName, FileFormat:=xlOpenXMLWorkbook\n\nClosingStatements:\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n    Exit Sub\nErrHandler:\n    Call MsgBox(\"Run-time error '\" &amp; Err.Number &amp; \"': \" &amp; Err.Description &amp; vbNewLine &amp; _\n         \"While running: \" &amp; C_PROC_NAME &amp; IIf(Erl &lt;&gt; 0, vbNewLine &amp; \"Error Line: \" &amp; Erl, \"\")\n    GoTo ClosingStatements\n\nEnd Sub\n\nFunction isFileOpen(ByVal Filename As String) As Boolean\n\n    Dim ff As Long, ErrNo As Long\n\n    On Error Resume Next\n    ff = FreeFile()\n    Open Filename For Input Lock Read As #ff\n    Close ff\n    ErrNo = Err\n    On Error GoTo 0\n\n    Select Case ErrNo\n        Case 0:    isFileOpen = False\n        Case 70:   isFileOpen = True\n    End Select\n\nEnd Function\n\nFunction isWorkbookOpen(ByVal Filename As String) As Boolean\n\n    Dim wb As Workbook, ErrNo As Long\n\n    On Error Resume Next\n    Set wb = Workbooks(Filename)\n    ErrNo = Err\n    On Error GoTo 0\n\n    Select Case ErrNo\n        Case 0:         isWorkbookOpen = True\n        Case Else:      isWorkbookOpen = False\n    End Select\n\nEnd Function\n</code></pre>\n\n<p><strong>Explanation of part 1</strong>: This whole thing might seem a bit overkill, but all the error handling is important here to take into account potential errors and make sure that the setting for <code>Application.EnableEvents</code> is turned back to <code>TRUE</code> even if an error occurs. Otherwise, all event macros will be disabled in your Excel application.</p>\n\n<p><strong>2</strong> - Call the <code>SaveAsCustomWindow</code> procedure inside the Workbook_BeforeSave event procedure like this: </p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    'Your code\n\n    If ThisWorkbook.Path = \"\" Then\n        SaveAsCustomWindow\n        Cancel = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Note that we need to set the variable <em>Cancel = True</em> in order to prevent the default SaveAs window to show up. Also, the if statement is there to make sure that the custom SaveAs window will only be used if the file has <em>never</em> been saved.</p>\n"}, {"comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1528928953, "post_id": 50823905, "comment_id": 88697784, "body": "Maybe you should add an If statement to prevent the code from running when the original template needs to be opened for editing."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1528983055, "post_id": 50823905, "comment_id": 88720064, "body": "@DecimalTurn It&#39;s a thought, though I tend to specifically make any opening of the template a save-as.  I do have a caveat in my similar file where the template is saved with a different name, and as such would have:  <i>If ActiveWorkbook.Name = &quot;_TEMPLATENAME.xlsb&quot; Then</i> which for each subsequent open after the rename does not trigger the save.  I took that out as it didn&#39;t fit the main bill of the question, but I understand where you&#39;re coming from."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1528998116, "post_id": 50823905, "comment_id": 88728672, "body": "I see what you mean. I assumed from the question that Excel macro-enabled template meant a *.xltm file that end-users would double-click on to create a new Excel file based that template. But your suggestion of using a simple macro-enabled workbook and forcing the end-user to save the file with a new name on opening certainly works."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 2, "last_activity_date": 1528990415, "last_edit_date": 1528990415, "creation_date": 1528829317, "answer_id": 50823905, "question_id": 45596268, "link": "https://stackoverflow.com/questions/45596268/saving-new-excel-document-as-macro-free-workbook-without-prompt/50823905#50823905", "title": "Saving new Excel document as macro-free workbook without prompt", "body": "<p>Different approach... when the template is loaded, require the user to save as (I have a workbook/template with a similar situation...).  This should open them up to the user's Documents folder, though you can adjust to save to whatever location.</p>\n\n<p>Inside of the ThisWorkbook module, put:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    Dim loc As Variant\n    Application.DisplayAlerts = False\n    loc = Application.GetSaveAsFilename(FileFilter:=\"Excel Files (*.xlsx), *.xlsx\", Title:=\"Save As...\", InitialFileName:=\"%USERPROFILE%\\Documents\\NAME_OF_FILE\")\n    If loc &lt;&gt; False Then\n        ActiveWorkbook.SaveAs Filename:=loc, FileFormat:=51\n        Exit Sub\n    End If\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Edit1: Adding the if statement using a base-template name, so subsequent saves do not prompt the save-as:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    If ActiveWorkbook.Name = \"_NAME_OF_FILE.xlsb\" Then\n        Dim loc As Variant\n        Application.DisplayAlerts = False \n        loc = Application.GetSaveAsFilename(FileFilter:=\"Excel Files (*.xlsx), *.xlsx\", Title:=\"Save As...\", InitialFileName:=\"%USERPROFILE%\\Documents\\_NAME_OF_FILE\")\n        If loc &lt;&gt; False Then\n            ActiveWorkbook.SaveAs Filename:=loc, FileFormat:=51\n            Exit Sub\n        End If\n        Application.DisplayAlerts = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1529274705, "creation_date": 1529274705, "answer_id": 50900996, "question_id": 45596268, "link": "https://stackoverflow.com/questions/45596268/saving-new-excel-document-as-macro-free-workbook-without-prompt/50900996#50900996", "title": "Saving new Excel document as macro-free workbook without prompt", "body": "<p>To answer your questions:</p>\n\n<p><em>Is it possible to prevent this message from appearing?</em></p>\n\n<p>Yes, using the <code>Application.DisplayAlerts</code> property</p>\n\n<p><em>Is it possible to have Excel assume that the user wants to continue with a macro-free workbook?</em> </p>\n\n<p>No, you have to write the procedure to save the workbook and bypass the <code>SaveAs</code> excel event and save the workbook using the user input (<code>Path</code> &amp; <code>Filename</code>) with the required format.</p>\n\n<p>The following procedure uses a FileDialog to capture the Path and Filename from the user then saves the file without displaying the warning message.\nI have added some explanatory comments nevertheless, let me know of any questions you might have.</p>\n\n<p>Copy these procedures in the <code>ThisWorkbook</code> module:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Cancel = True       'Prevents repetitive Save\n    Call Workbook_BeforeSave_ApplySettings_And_Save\n    End Sub\n\n\nPrivate Sub Workbook_BeforeSave_ApplySettings_And_Save()\nDim fd As FileDialog, sFilename As String\n\n    Rem Sets FileDialog to capture user input\n    Set fd = Application.FileDialog(msoFileDialogSaveAs)\n    With fd\n        .InitialView = msoFileDialogViewDetails\n        .Title = vbNullString               'Resets default value in case it was changed\n        .ButtonName = vbNullString          'Resets default value in case it was changed\n        .AllowMultiSelect = False\n        If .Show = 0 Then Exit Sub          'User pressed the Cancel Button\n        sFilename = .SelectedItems(1)\n    End With\n\n    With ThisWorkbook\n\n        Do While .Connections.Count &gt; 0\n            .Connections.Item(.Connections.Count).Delete\n        Loop\n\n        Application.EnableEvents = False                                'Prevents repetition of the Workbook_BeforeSave event\n        Application.DisplayAlerts = False                               'Prevents Display of the warning message\n        On Error Resume Next                                            'Prevents Events and Display staying disable in case of error\n        .SaveAs Filename:=sFilename, FileFormat:=xlOpenXMLWorkbook      'Saves Template as standard excel using user input\n        If Err.Number &lt;&gt; 0 Then\n            MsgBox \"Run-time error \" &amp; Err.Number &amp; String(2, vbLf) _\n                &amp; Err.Description &amp; String(2, vbLf) _\n                &amp; vbTab &amp; \"Process will be cancelled.\", _\n                vbOKOnly, \"Microsoft Visual Basic\"\n        End If\n        On Error GoTo 0\n        Application.DisplayAlerts = True\n        Application.EnableEvents = True\n\n    End With\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8440797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58c118d3db45e4ce2e0cdfb513aa36e7?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Turner", "link": "https://stackoverflow.com/users/8440797/tom-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16990, "favorite_count": 1, "answer_count": 4, "score": 15, "last_activity_date": 1530111680, "creation_date": 1502296701, "last_edit_date": 1530111680, "question_id": 45596268, "link": "https://stackoverflow.com/questions/45596268/saving-new-excel-document-as-macro-free-workbook-without-prompt", "title": "Saving new Excel document as macro-free workbook without prompt", "body": "<p>I'm using Excel 2010. I have an Excel macro-enabled template that has a data connection to a text file that is set to automatically refresh when a new document is created using this template.</p>\n\n<p>The following macro is within the \"ThisWorkbook\" object to remove the data connection before saving the new document:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Do While ActiveWorkbook.Connections.Count &gt; 0\n        ActiveWorkbook.Connections.Item(ActiveWorkbook.Connections.Count).Delete\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>When a user clicks the save icon / hits ctrl+S, inputs a filename and then clicks save to save as a macro-free Excel workbook (as is the default and required filetype) they are prompted with a message stating:</p>\n\n<blockquote>\n  <p>The following features cannot be saved in macro-free workbooks:</p>\n  \n  <p>\u2022 VB project</p>\n  \n  <p>To save a file with these features, click No, and then choose a\n  macro-enabled file type in the File Type list.</p>\n  \n  <p>To continue saving as a macro-free workbook, click Yes.</p>\n</blockquote>\n\n<p>Is it possible to prevent this message from appearing and have Excel assume that the user wants to continue with a macro-free workbook?</p>\n\n<p>I've searched all over and understand that I may be able to add code to the workbook object that removes itself so that Excel has no VB project to cause this message but this would require each user to change Trust Center Settings (Trust access to the VBA project object model) which I want to avoid.</p>\n\n<p>I've also seen suggestions of using:</p>\n\n<pre><code>Application.DisplayAlerts = False\n</code></pre>\n\n<p>but can't get this to work. Every example of it's use seems to be within a sub that is also handling the saving of the document whereas in my situation the BeforeSave sub ends before the document is saved in the default, non-vba way which is perhaps why it does not work?</p>\n\n<p>Does this property reset to a default True after the sub has ended / before the save actually occurs?</p>\n\n<p>Apologies for any nonsense I may have dispensed, my experience with VBA is very limited.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502297066, "post_id": 45596235, "comment_id": 78152168, "body": "If <code>cellName</code> is a <code>Named Range</code> with workbook scope, then remove the <code>Sheets(s).</code> from the right side."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502297688, "post_id": 45596235, "comment_id": 78152520, "body": "@RonRosenfeld unqualified <code>Range</code> calls implicitly refer to the active worksheet (unless you&#39;re in a worksheet&#39;s code-behind) - that would actually make things <i>worse</i> ;-)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502298475, "post_id": 45596235, "comment_id": 78152958, "body": "@Mat&#39;sMug Not so if it is a <code>Defined Name</code> with Workbook Scope, which is what I wrote."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1502298881, "post_id": 45596235, "comment_id": 78153197, "body": "@RonRosenfeld Fine. But then that would be error 1004, not 438."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502299177, "post_id": 45596235, "comment_id": 78153354, "body": "FWIW accessing defined names should be done via the <code>Workbook.Names</code> collection for workbook-scoped names, and via the <code>Worksheet.Names</code> collection for worksheet-scoped names. <code>Range</code>&#39;s behavior is broken and unintuitive."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502299231, "post_id": 45596235, "comment_id": 78153378, "body": "@Mat&#39;sMug That would depend on the type of sheet and which sheet.  If it is the same worksheet, then it will work; if it happens to be a Chart sheet, then the <code>438</code>, and if it is a different worksheet, then <code>1004</code>.  If it is a <code>Named Range</code> with workbook scope, and you eliminate the <code>Sheets</code> argument, then no errors no matter the active sheet.  Obviously, if it is a cell address, then you need a valid sheet."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1502298159, "last_edit_date": 1502298159, "creation_date": 1502297173, "answer_id": 45596424, "question_id": 45596235, "link": "https://stackoverflow.com/questions/45596235/vba-excel-sheets-range-value-error/45596424#45596424", "title": "vba excel sheets.range.value Error", "body": "<p>Unqualified calls into the <code>Sheets</code> collection implicitly refer to whatever workbook is currently active, and it's important to know that the collection contains <code>Worksheet</code> objects, ...but also <code>Chart</code> objects.</p>\n\n<p>Since you mean to work with a <code>Worksheet</code>, use the <code>Worksheets</code> collection instead.</p>\n\n<p>If you're not getting an \"index out of bounds\" error, then the sheet you asked for does exist. But error 438 points to that sheet not being a <code>Worksheet</code> (and thus not having a <code>Range</code> member).</p>\n\n<p>I bet the active workbook has a chart sheet at index <code>s</code>.</p>\n\n<p>The solution is simply to be explicit.</p>\n\n<p>If you mean to work with the workbook that contains the code that's running, qualify <code>Workbook</code> member calls with <code>ThisWorkbook</code>:</p>\n\n<pre><code>getCellVal = ThisWorkbook.Worksheets(s).Range(cellName).Value\n</code></pre>\n\n<p>If you mean to work with <em>a</em> workbook, then you need to get ahold of the <code>Workbook</code> object when you open it:</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Application.Workbooks.Open(path)\n'...\ngetCellVal = wb.Worksheets(s).Range(cellName).Value\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2685596, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c5b581e6656aff01f8e6a5c3bb8a844d?s=128&d=identicon&r=PG&f=1", "display_name": "mosafattah", "link": "https://stackoverflow.com/users/2685596/mosafattah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1443, "favorite_count": 0, "accepted_answer_id": 45596424, "answer_count": 1, "score": 2, "last_activity_date": 1502298159, "creation_date": 1502296560, "last_edit_date": 1502296611, "question_id": 45596235, "link": "https://stackoverflow.com/questions/45596235/vba-excel-sheets-range-value-error", "title": "vba excel sheets.range.value Error", "body": "<p>So, sometimes when I try to execute this command, it gives me an error. The problem is that it is very inconsistent. In certain cases, it works and in others, it just doesn't.</p>\n\n<p>This is the line from getCellVal function. cellName is a string and s is an integer.</p>\n\n<pre><code>getCellVal = Sheets(s).Range(cellName).Value\n</code></pre>\n\n<p>This time it is giving me:\nRun-time error '438':\nObject doesn't support this property or method</p>\n\n<p>This line actually worked without problems moments ago. I added some other functions that use it and now it's not working anymore.</p>\n\n<p>Any ideas about why?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1502296396, "post_id": 45596102, "comment_id": 78151805, "body": "You do know the file name before hand, then why do you need to loop? Check for the specific user file itself. Also, during save as, you are missing file extension."}, {"owner": {"reputation": 22, "user_id": 8302802, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/473b4769c55ce26da8d401f6f23d70a2?s=128&d=identicon&r=PG&f=1", "display_name": "OrangeHippo", "link": "https://stackoverflow.com/users/8302802/orangehippo"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1502296709, "post_id": 45596102, "comment_id": 78151986, "body": "How do I go about checking for the specific user file? And thanks for pointing out the file extension!"}, {"owner": {"reputation": 22, "user_id": 8302802, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/473b4769c55ce26da8d401f6f23d70a2?s=128&d=identicon&r=PG&f=1", "display_name": "OrangeHippo", "link": "https://stackoverflow.com/users/8302802/orangehippo"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1502297302, "post_id": 45596102, "comment_id": 78152305, "body": "Never mind, I figured it out with your advice! Thanks!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1502297001, "creation_date": 1502297001, "answer_id": 45596361, "question_id": 45596102, "link": "https://stackoverflow.com/questions/45596102/find-if-workbook-for-individual-user-exists-if-workbook-does-not-exist-create/45596361#45596361", "title": "Find if workbook for individual user exists, if workbook does not exist, create a new workbook with template", "body": "<p>The first <code>Dir</code> call sets the parameters and return the first file in the directory.  You need to use the <code>Dir</code> in your <code>Do Loop</code> to return subsequent files.</p>\n\n<p>Note: I added <code>Exit Do</code> to after the condition is met.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/dk008ty4(v=vs.90).aspx\" rel=\"nofollow noreferrer\">MSDN Dir Function</a></p>\n\n<pre><code>Sub StoreToPersonal()\n    Application.ScreenUpdating = False\n    ckIndWkbk = False\n    folderpath = \"\\\\netappa\\Path\\MACRO UPDATE WORKBOOKS\"    'change to suit\n\n    If Right(folderpath, 1) &lt;&gt; \"\\\" Then folderpath = folderpath + \"\\\"\n\n    Filename = Dir(folderpath &amp; \"*.xlsm\")\n    'Look through path length and find if user has an individual Workbook with a Boolean Statement\n\n    Do While Filename &lt;&gt; \"\"\n        If InStr(Filename, Environ(\"Username\")) Then\n            ckIndWkbk = True\n            Exit Do\n        End If\n        Filename = Dir\n    Loop\n\n    If ckIndWkbk = False Then\n        Set wb = Workbooks.Open(\"\\\\netappa\\Path\\MACRO UPDATE WORKBOOKS\\DataFile Master.xlsm\")\n        ws = wb.Sheets.Count\n        For Each ws In wb\n            If ws.Index &gt; 4 Then\n                Application.DisplayAlerts = False\n                ws.Delete\n                Application.DisplayAlerts = True\n            End If\n        Next ws\n\n        wb.SaveAs (\"\\\\netappa\\Path\\MACRO UPDATE WORKBOOKS\\\\DataFile For \" &amp; Environ(\"Username\"))\n\n    End If\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 22, "user_id": 8302802, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/473b4769c55ce26da8d401f6f23d70a2?s=128&d=identicon&r=PG&f=1", "display_name": "OrangeHippo", "link": "https://stackoverflow.com/users/8302802/orangehippo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502310166, "creation_date": 1502296114, "last_edit_date": 1502310166, "question_id": 45596102, "link": "https://stackoverflow.com/questions/45596102/find-if-workbook-for-individual-user-exists-if-workbook-does-not-exist-create", "title": "Find if workbook for individual user exists, if workbook does not exist, create a new workbook with template", "body": "<p>I have a data file that I am trying to make for each person in my work group. The data file needs to be identical to a master file as each persons data will be collected into said master file as well as an individual data file. </p>\n\n<p>So far, I have the following code where I try to identify whether a user already has a workbook. I want the created workbook to have the same first four sheets as the master workbook.</p>\n\n<p>The folder specified only contains the \"DataFile Master\" Workbook so I wouldn't expect the macro to take longer than ~5 seconds. However, when I try to run the macro, the workbook becomes non responsive.</p>\n\n<p>The program does not induce an error report or indicate something to debug.</p>\n\n<p>Does anyone have any ideas? </p>\n\n<pre><code> Sub StoreToPersonal()\n    Application.ScreenUpdating = False\n    ckIndWkbk = False\n    folderpath = \"\\\\netappa\\Path\\MACRO UPDATE WORKBOOKS\" 'change to suit\n\n    If Right(folderpath, 1) &lt;&gt; \"\\\" Then folderpath = folderpath + \"\\\"\n\n    filename = Dir(folderpath &amp; \"*.xlsm\")\n    'Look through path length and find if user has an individual Workbook with a Boolean Statement\n\n    Do While filename &lt;&gt; \"\"\n      If InStr(filename, Environ(\"Username\")) Then\n        ckIndWkbk = True\n      Else\n    End If\n\n    Loop\n\n       If ckIndWkbk = False Then\n            Set wb = Workbooks.Open(\"\\\\netappa\\Path\\MACRO UPDATE WORKBOOKS\\DataFile Master.xlsm\")\n                ws = wb.Sheets.Count\n                    For Each ws In wb\n                        If ws.Index &gt; 4 Then\n                            Application.DisplayAlerts = False\n                                ws.Delete\n                            Application.DisplayAlerts = True\n                        End If\n                    Next ws\n\n            wb.SaveAs (\"\\\\netappa\\Path\\MACRO UPDATE WORKBOOKS\\\\DataFile For \" &amp; Environ(\"Username\"))\n\n        End If\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8440877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7359f2facdb92317bed3a93e15ac32?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Fox", "link": "https://stackoverflow.com/users/8440877/mike-fox"}, "is_accepted": true, "score": 0, "last_activity_date": 1502475943, "last_edit_date": 1502475943, "creation_date": 1502466823, "answer_id": 45639220, "question_id": 45596053, "link": "https://stackoverflow.com/questions/45596053/vba-creating-word-document-from-excel-and-edit-certain-line-to-contain-bold-te/45639220#45639220", "title": "VBA - Creating Word Document from Excel and Edit Certain Line to Contain Bold Text", "body": "<p>I was able to find a work around. Thought I would post it here to help others. Sorry my code isn't as clean as I would like it to be. Copying and pasting didn't quite match up.  </p>\n\n<pre><code>Sub ExceltoWord_TestEnvironment()\n    Dim wApp As Object\n    Dim wDoc As Object\n    Dim strSearchTerm\n    Dim FirstMatch As Range\n    Dim FirstAddress\n    Dim intMyVal As String\n    Dim lngLastRow As Long\n    Dim strRowNoList As String\n    Dim intPlaceHolder As Integer\n\nSet wApp = CreateObject(\"Word.Application\")\nSet wDoc = CreateObject(\"Word.Document\")\nwApp.Visible = True\n\nSet wDoc = wApp.Documents.Add\n\nwDoc.Range.ParagraphFormat.SpaceBefore = 0\nwDoc.Range.ParagraphFormat.SpaceAfter = 0\n\nstrSearchTerm = InputBox(\"Please enter the date to find\", \"Search criteria\")\n\n\nIf strSearchTerm &lt;&gt; \"\" Then\n    Set FirstMatch = ActiveSheet.Cells.Find(strSearchTerm, LookAt:=xlPart, MatchCase:=False)\n\n        If FirstMatch Is Nothing Then\n            MsgBox \"That date could not be found\"\n        Else\n\n            FirstAddress = FirstMatch.Address\n            intMyVal = strSearchTerm\n            lngLastRow = Cells(Rows.Count, \"F\").End(xlUp).Row 'Search Column F, change as required.\n\n        For Each cell In Range(\"F1:F\" &amp; lngLastRow) 'F is column\n            If InStr(1, cell.Value, intMyVal) Then\n                If strRowNoList = \"\" Then\n\n                    strRowNoList = strRowNoList &amp; cell.Row\n                    intPlaceHolder = cell.Row\n     intParaCount = wDoc.Paragraphs.Count\n\n             i = 2\n         Set objParagraph = wDoc.Paragraphs(i).Range\n         With objParagraph\n             .Font.Bold = True\n         End With\n\n        wDoc.Content.InsertAfter \"Group:             \" &amp; Cells(intPlaceHolder, 3) &amp; vbNewLine\n        wDoc.Content.InsertAfter \"ID:         \" &amp; Cells(intPlaceHolder, 2) &amp; vbNewLine\n        wDoc.Content.InsertAfter \"Name:              \" &amp; vbNewLine &amp; vbNewLine\n\n         i = i + 4 'paragraph number\n\nElse\n\n                strRowNoList = strRowNoList &amp; \", \" &amp; cell.Row\n                intPlaceHolder = cell.Row\n\n        wDoc.Content.InsertAfter \"Group:             \" &amp; Cells(intPlaceHolder, 3) &amp; vbNewLine\n        wDoc.Content.InsertAfter \"ID:         \" &amp; Cells(intPlaceHolder, 2) &amp; vbNewLine\n        wDoc.Content.InsertAfter \"Name:              \" &amp; vbNewLine &amp; vbNewLine\n\n            i = i + 4\n\nEnd If\n            Next cell\n            MsgBox strRowNoList\n\nWhile Not FirstMatch Is Nothing\n            Set FirstMatch = ActiveSheet.Cells.FindNext(FirstMatch)\n        If FirstMatch.Address = FirstAddress Then\n            Set FirstMatch = Nothing\n\n\n        End If\n        Wend\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The code utilizes .paragraphs() where 'i' is the paragraph you want to bold: </p>\n\n<pre><code>   i = 2\n     Set objParagraph = wDoc.Paragraphs(i).Range\n     With objParagraph\n         .Font.Bold = True\n     End With\n</code></pre>\n\n<p>And the difference in paragraphs is added after each iteration </p>\n\n<pre><code>i = i + 4 'paragraph number\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8440877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7359f2facdb92317bed3a93e15ac32?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Fox", "link": "https://stackoverflow.com/users/8440877/mike-fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 45639220, "answer_count": 1, "score": 2, "last_activity_date": 1502475943, "creation_date": 1502295956, "last_edit_date": 1531164843, "question_id": 45596053, "link": "https://stackoverflow.com/questions/45596053/vba-creating-word-document-from-excel-and-edit-certain-line-to-contain-bold-te", "title": "VBA - Creating Word Document from Excel and Edit Certain Line to Contain Bold Text", "body": "<p>I am looking to bold every second line entry on a word document that receives input from an excel spreadsheet. In other words, I want the resulting word document to have each line containing 'ID:' to contain bold text. I've looked into other examples but I keep getting errors such as mismatch.  </p>\n\n<pre><code>Sub ExceltoWord_TestEnvironment()\n    Dim wApp As Object\n    Dim wDoc As Object\n    Dim strSearchTerm\n    Dim FirstMatch As Range\n    Dim FirstAddress\n    Dim intMyVal As String\n    Dim lngLastRow As Long\n    Dim strRowNoList As String\n    Dim intPlaceHolder As Integer\n\nSet wApp = CreateObject(\"Word.Application\")\nSet wDoc = CreateObject(\"Word.Document\")\nwApp.Visible = True\n\nSet wDoc = wApp.Documents.Add\n\nwDoc.Range.ParagraphFormat.SpaceBefore = 0\nwDoc.Range.ParagraphFormat.SpaceAfter = 0\n\nstrSearchTerm = InputBox(\"Please enter the date to find\", \"Search criteria\")\n\n\nIf strSearchTerm &lt;&gt; \"\" Then\n    Set FirstMatch = ActiveSheet.Cells.Find(strSearchTerm, LookAt:=xlPart, MatchCase:=False)\n\n        If FirstMatch Is Nothing Then\n            MsgBox \"That date could not be found\"\n        Else\n\n            FirstAddress = FirstMatch.Address\n            intMyVal = strSearchTerm\n            lngLastRow = Cells(Rows.Count, \"F\").End(xlUp).Row 'Search Column F, change as required.\n\n        For Each cell In Range(\"F1:F\" &amp; lngLastRow) 'F is column\n            If InStr(1, cell.Value, intMyVal) Then\n                If strRowNoList = \"\" Then\n\n                    strRowNoList = strRowNoList &amp; cell.Row\n                    intPlaceHolder = cell.Row\n\n        wDoc.Content.InsertAfter \"Group:             \" &amp; Cells(intPlaceHolder, 3) &amp; vbNewLine\n        wDoc.Content.InsertAfter \"ID:         \" &amp; Cells(intPlaceHolder, 2) &amp; vbNewLine\n        wDoc.Content.InsertAfter \"Name:              \" &amp; vbNewLine &amp; vbNewLine\nElse\n\n                strRowNoList = strRowNoList &amp; \", \" &amp; cell.Row\n                intPlaceHolder = cell.Row\n\n        wDoc.Content.InsertAfter \"Group:             \" &amp; Cells(intPlaceHolder, 3) &amp; vbNewLine\n        wDoc.Content.InsertAfter \"ID:         \" &amp; Cells(intPlaceHolder, 2) &amp; vbNewLine\n        wDoc.Content.InsertAfter \"Name:              \" &amp; vbNewLine &amp; vbNewLine\n\nEnd If\n            Next cell\n            MsgBox strRowNoList\n\nWhile Not FirstMatch Is Nothing\n            Set FirstMatch = ActiveSheet.Cells.FindNext(FirstMatch)\n        If FirstMatch.Address = FirstAddress Then\n            Set FirstMatch = Nothing\n\n\n        End If\n        Wend\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Example:</p>\n\n<p>Group: Group A</p>\n\n<p><strong>ID:    123456</strong></p>\n\n<p>Name: Jon Snow</p>\n\n<p>Group: Group B</p>\n\n<p><strong>ID:    789101</strong></p>\n\n<p>Name: Samwell Tarly</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1502296020, "post_id": 45595994, "comment_id": 78151570, "body": "you need to fully qualify your ranges, sheets etc. Like ThisWorkbook.Worksheets or Workbooks(2).Worksheets etc. Same for ws.Range(&quot;C3:I47&quot;).  Copy paste needs to go like this : ws.Range(&quot;C3:I47&quot;).Copy ws.Range(&quot;C3:I47&quot;).Cells(1,1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False"}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1502298402, "post_id": 45595994, "comment_id": 78152910, "body": "@cyboashu this should be an Answer not a Comment."}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1502298461, "post_id": 45595994, "comment_id": 78152949, "body": "@JPR please split this out into multiple Questions, StackOverflow rules say that a Question should not present multiple issues, but a discrete single issue."}, {"owner": {"reputation": 13, "user_id": 8440862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e920bd5671dbd6762b733a14fd1b19?s=128&d=identicon&r=PG&f=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8440862/jpr"}, "reply_to_user": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1502301249, "post_id": 45595994, "comment_id": 78154590, "body": "@Graham my bad. Because I was in a pinch and posted as fast as I could. I&#39;ll make sure to read all rules in detail."}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1502310013, "post_id": 45595994, "comment_id": 78159282, "body": "Consider editing the question so that the accepted answer still makes sense, then move everything else out separately.  Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8440862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e920bd5671dbd6762b733a14fd1b19?s=128&d=identicon&r=PG&f=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8440862/jpr"}, "edited": false, "score": 0, "creation_date": 1502301167, "post_id": 45596761, "comment_id": 78154535, "body": "Thank you so much! This fixed all three issues."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1502301243, "post_id": 45596761, "comment_id": 78154587, "body": "@DavidZemens, you are correct aboutt the <code>And</code> .... the <code>or</code> would be <code>true</code> for all worksheet names .... (&quot;REGION&quot; &lt;&gt; &quot;Legend)&quot;"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1502298450, "creation_date": 1502298450, "answer_id": 45596761, "question_id": 45595994, "link": "https://stackoverflow.com/questions/45595994/vba-newbie-with-error-1004-and-400/45596761#45596761", "title": "VBA newbie with Error 1004 and 400", "body": "<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoid using <code>Select</code> and/or <code>Activate</code> (and related: <code>ActiveSheet</code>, etc.)</a> and while we're at it, rather than <code>Copy/PasteSpecial</code>, just do a direct value-assignment using the range's <code>Value</code> property.</p>\n\n<p>So that this:</p>\n\n<pre><code>Dim ws As Worksheet\n\nFor Each ws In Sheets\nIf ws.Name &lt;&gt; \"REGION\" Or ws.Name &lt;&gt; \"Legend\" Then\nRange(\"C3:I47\").Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\nApplication.CutCopyMode = False\nRange(\"A2\").Select\nEnd If\nActiveSheet.Next.Select\nNext\n</code></pre>\n\n<p>Becomes this (also note the <code>Or</code> should be an <code>And</code>, I think)</p>\n\n<pre><code>Dim ws As Worksheet\nDim rng as Range\nFor Each ws In Sheets\n    'Do not operate on either of Region or Legend worksheets\n    If ws.Name &lt;&gt; \"REGION\" And ws.Name &lt;&gt; \"Legend\" Then\n        Set rng = ws.Range(\"C3:I47\")\n        rng.Value = rng.Value2\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8440862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e920bd5671dbd6762b733a14fd1b19?s=128&d=identicon&r=PG&f=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8440862/jpr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 45596761, "answer_count": 1, "score": 1, "last_activity_date": 1502298450, "creation_date": 1502295786, "last_edit_date": 1531164843, "question_id": 45595994, "link": "https://stackoverflow.com/questions/45595994/vba-newbie-with-error-1004-and-400", "title": "VBA newbie with Error 1004 and 400", "body": "<p>Please go easy on me as I am a total newbie at coding and really trying to learn to improve processes in my team and thus increase efficiency.</p>\n\n<p>I've put together a code to copy data pulled by formulas and then paste it as values within the same sheet. This code, I have applied to multiple workbooks that vary in the amount of worksheets/tabs they contain. </p>\n\n<p><strong>Problem #1:</strong>\nMy first worksheet on every file is called REGION. What's happening is that the code is not executing on the \"REGION\" worksheet as designed but it is also skipping the worksheet immediately after it. </p>\n\n<p><strong>Problem #2</strong>\nDepending on the workbook that I run the code, after 6 worksheets, I get Run-Time Error '1004' and the code stops without performing the function on the rest of the worksheets</p>\n\n<p><strong>Problem #3</strong>\nI am getting Error 400 on workbooks small enough for the code to cycle through all worksheets and not finding any more worksheets where to apply the code. </p>\n\n<p><strong>In sum, I need to:</strong></p>\n\n<p><strong>1.</strong> Figure out what am I doing wrong that the code is skipping the worksheet immediately after the one called REGION (1st Tab)</p>\n\n<p><strong>2.</strong> Figure out how to prevent error '1004' because the program is performing the same function over and over on multiple worksheets (read that I should probably set it to save every few tabs to prevent this but not sure how to do it while looping)</p>\n\n<p><strong>3.</strong> add to the code a line that stops the cycle without throwing an error message.  </p>\n\n<pre><code>Sub COPYPASTE()\n\n    Dim ws As Worksheet\n\n    For Each ws In Sheets\n    If ws.Name &lt;&gt; \"REGION\" Or ws.Name &lt;&gt; \"Legend\" Then\n    Range(\"C3:I47\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Range(\"A2\").Select\n    End If\n    ActiveSheet.Next.Select\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Again, coding in not not my forte but I am trying to better my team and I have 2 team members doing this manually on hundreds of worksheets every month and thus taking them a considerable amount of time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1502295148, "post_id": 45595574, "comment_id": 78151048, "body": "what&#39;s the error message?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502295233, "post_id": 45595574, "comment_id": 78151092, "body": "Try changing <code>Time</code> to <code>Time()</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502295577, "post_id": 45595574, "comment_id": 78151295, "body": "You may be missing a reference to <code>VBA</code> library. Seems odd, but that would cause the problem you&#39;re describing."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502295638, "post_id": 45595574, "comment_id": 78151334, "body": "Does <code>VBA.DateTime.Time</code> and <code>VBA.DateTime.Date</code> give the same errors."}, {"owner": {"reputation": 21, "user_id": 7857085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baab67499d8d50859ed6a4b3ef9896b0?s=128&d=identicon&r=PG&f=1", "display_name": "JK V", "link": "https://stackoverflow.com/users/7857085/jk-v"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502325642, "post_id": 45595574, "comment_id": 78164725, "body": "Thank you guys for your precious comments. I&#39;ve went along @DavidZemens suggestion that reference might be missing. So what I did is clearing the check box for the type library or object library marked as &quot;Missing:&quot; in the VBA editor and it does the tricks!"}], "owner": {"reputation": 21, "user_id": 7857085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baab67499d8d50859ed6a4b3ef9896b0?s=128&d=identicon&r=PG&f=1", "display_name": "JK V", "link": "https://stackoverflow.com/users/7857085/jk-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502295171, "creation_date": 1502294460, "last_edit_date": 1502295171, "question_id": 45595574, "link": "https://stackoverflow.com/questions/45595574/excel-vba-code-not-compatible-in-other-excel-version-later-than-2016", "title": "Excel VBA code not compatible in other excel version later than 2016", "body": "<p>I created a simple user forms and it works well with excel version after 2013. But when runs in excel 2010 version, it keep giving me error.</p>\n\n<p>Here is my user form codes</p>\n\n<pre><code>Private Sub CloseButton_Click()\nUnload Me\nEnd Sub\n\nPrivate Sub ClearButton_Click()\nCall UserForm_Initialize\nEnd Sub\nPrivate Sub UserForm_Initialize()\n'Clear Form\n'Clear ProjectList\nProjectList.Clear\n\n'Fill ProjectList\nWith Worksheets(\"Database\")\n    ProjectList.List = .Range(\"Q3:Q\" &amp; .Range(\"Q\" &amp; .Rows.Count).End(xlUp).Row).Value\nEnd With\n\n'Clear NationalityList\nNationalityList.Clear\n\n'Fill NationalityList\nWith Worksheets(\"Database\")\n    NationalityList.List = .Range(\"H3:H\" &amp; .Range(\"H\" &amp; .Rows.Count).End(xlUp).Row).Value\nEnd With\n\n'Clear NationalityList\nWorkPermitList.Clear\n\n'Fill WorkPermitList\nWith Worksheets(\"Database\")\n    WorkPermitList.List = .Range(\"J3:J\" &amp; .Range(\"J\" &amp; .Rows.Count).End(xlUp).Row).Value\nEnd With\n\n'Clear TransferFromList\nTransferFromList.Clear\n\n'Fill TransferFromList\nWith Worksheets(\"Database\")\n    TransferFromList.List = .Range(\"D3:D\" &amp; .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row).Value\nEnd With\n\n'Clear TransferToList\nTransferToList.Clear\n\n'Fill TransferToList\nWith Worksheets(\"Database\")\n    TransferToList.List = .Range(\"D3:D\" &amp; .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row).Value\nEnd With\n\n'Clear LastPositionList\nLastPositionList.Clear\n\n'Fill LastPositionList\nWith Worksheets(\"Database\")\n    LastPositionList.List = .Range(\"E3:E\" &amp; .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row).Value\nEnd With\n\n'Clear CurrentPositionList\nCurrentPositionList.Clear\n\n'Fill CurrentPositionList\nWith Worksheets(\"Database\")\n    CurrentPositionList.List = .Range(\"F3:F\" &amp; .Range(\"F\" &amp; .Rows.Count).End(xlUp).Row).Value\nEnd With\n\n'Clear Certificates\ncert1list.Clear\ncert2list.Clear\ncert3list.Clear\ncert4list.Clear\ncert5list.Clear\ncert6list.Clear\ncert7list.Clear\n\n'Fill CurrentPositionList\nWith Worksheets(\"Database\")\n    cert1list.List = .Range(\"R3:R\" &amp; .Range(\"R\" &amp; .Rows.Count).End(xlUp).Row).Value\n    cert2list.List = .Range(\"R3:R\" &amp; .Range(\"R\" &amp; .Rows.Count).End(xlUp).Row).Value\n    cert3list.List = .Range(\"R3:R\" &amp; .Range(\"R\" &amp; .Rows.Count).End(xlUp).Row).Value\n    cert4list.List = .Range(\"R3:R\" &amp; .Range(\"R\" &amp; .Rows.Count).End(xlUp).Row).Value\n    cert5list.List = .Range(\"R3:R\" &amp; .Range(\"R\" &amp; .Rows.Count).End(xlUp).Row).Value\n    cert6list.List = .Range(\"R3:R\" &amp; .Range(\"R\" &amp; .Rows.Count).End(xlUp).Row).Value\n    cert7list.List = .Range(\"R3:R\" &amp; .Range(\"R\" &amp; .Rows.Count).End(xlUp).Row).Value\nEnd With\n\n'Clear Action List\nNameText.Value = \" \"\nContactNumber.Value = \" \"\nAge.Value = \" \"\nDOB.Value = \" \"\nNRIC.Value = \" \"\nECSOC.Value = \" \"\nDDJV.Value = \" \"\n\n'Uncheck DataCheckBoxes\nCheckBox1.Value = False\nCheckBox2.Value = False\n\nEnd Sub\nPrivate Sub SubmitButton_Click()\nDim emptyRow As Long\n\n'Make Sheet1 active\nSheet3.Activate\n\nActiveSheet.Unprotect \"eastmarine123\"\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"c:c\")) + 1\n\n'Crew Transfer information\nCells(emptyRow, 5).Value = ProjectList.Value\nCells(emptyRow, 6).Value = NameText.Value\nCells(emptyRow, 7).Value = ContactNumber.Value\nCells(emptyRow, 8).Value = Age.Value\nCells(emptyRow, 9).Value = DOB.Value\nCells(emptyRow, 10).Value = ECSOC.Value\nCells(emptyRow, 11).Value = DDJV.Value\nCells(emptyRow, 12).Value = NationalityList.Value\nCells(emptyRow, 13).Value = WorkPermitList.Value\nCells(emptyRow, 14).Value = TransferFromList.Value\nCells(emptyRow, 15).Value = TransferToList.Value\nCells(emptyRow, 16).Value = NRIC.Value\nCells(emptyRow, 17).Value = LastPositionList.Value\nCells(emptyRow, 18).Value = CurrentPositionList.Value\n\n'OptionBox &amp; CheckBox\nIf OptionButton1.Value = True Then Cells(emptyRow, 19).Value = OptionButton1.Caption\nIf OptionButton2.Value = True Then Cells(emptyRow, 20).Value = OptionButton2.Caption\nIf CheckBox1.Value = True Then Cells(emptyRow, 21).Value = CheckBox1.Caption\nIf CheckBox2.Value = True Then Cells(emptyRow, 22).Value = CheckBox2.Caption\n\n'Certificate List\nCells(emptyRow, 23).Value = cert1list.Value\nCells(emptyRow, 24).Value = cert2list.Value\nCells(emptyRow, 25).Value = cert3list.Value\nCells(emptyRow, 26).Value = cert4list.Value\nCells(emptyRow, 27).Value = cert5list.Value\nCells(emptyRow, 28).Value = cert6list.Value\nCells(emptyRow, 29).Value = cert7list.Value\n\n'Register current date and time\nCells(emptyRow, 3).Value = Date\nCells(emptyRow, 4).Value = Time\n\nActiveSheet.Protect \"eastmarine123\", True, True\nThisWorkbook.Save\n\nEnd Sub\n</code></pre>\n\n<p>When I run the debug, it gives the the error on these two \"Date\"and \"Time\"</p>\n\n<pre><code>Cells(emptyRow, 3).Value = Date\nCells(emptyRow, 4).Value = Time\n</code></pre>\n\n<p>When I delete these two rows , it then runs fine. I thought the Date and Time function suppose to be compatible throughout the office version?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1502299126, "post_id": 45595260, "comment_id": 78153327, "body": "This reference says that you cannot use wildcards with the Mac <code>Dir</code> function:<a href=\"https://www.rondebruin.nl/mac/mac013.htm\" rel=\"nofollow noreferrer\">Ron de Bruin - Loop through Files in Folder on a Mac (Dir for Mac Excel)</a>."}], "owner": {"reputation": 3895, "user_id": 4972716, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a7c5b54d4f13c6bb4d1d4d40ca4d4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/4972716/stacey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502293548, "creation_date": 1502293548, "question_id": 45595260, "link": "https://stackoverflow.com/questions/45595260/running-vba-code-written-in-ms-on-a-mac", "title": "Running VBA code written in MS on a Mac", "body": "<p>I've written some vba to go through a folder and consolidate spreadsheets onto one masterfile.  One of the first things I needed to do was to look for all files in a folder with the extenstion <code>.xl*</code></p>\n\n<p>I wrote this on a windows box, and now someone wants to run this on a mac.</p>\n\n<p>I have changes the line from</p>\n\n<pre><code>Fname = Dir(ThisWorkbook.Path &amp; \"/*.xl*\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Fname = Dir(ThisWorkbook.Path &amp; Application.PathSeparator &amp; \"*.xl*\")\n</code></pre>\n\n<p>but I get a run time error 68 - device not available error</p>\n\n<p>Can anyone offer a solution to get this line running on a mac please?</p>\n\n<p>For reference here is the complete code:</p>\n\n<pre><code>Sub Consolidation()\n  Application.ScreenUpdating = False\n 'find last record in mastersheet\n Set destsheet = ThisWorkbook.Worksheets(\"Consolidated\")\n Set MyRange = Worksheets(\"Consolidated\").Range(\"C\" &amp; \"1\")\n lngLastRow = Cells(Rows.Count, MyRange.Column).End(xlUp).Row\n\n 'looks for files with the follwing extension\n 'Fname = Dir(ThisWorkbook.Path &amp; \"/*.xl*\")\n Fname = Dir(ThisWorkbook.Path &amp; Application.PathSeparator &amp; \"*.xl*\")\n\n 'cycles through the folder\n Do While Fname &lt;&gt; \"\"\n\n        If Fname &lt;&gt; ThisWorkbook.Name Then\n        Application.StatusBar = \"Processing: \" &amp; Fname\n\n        Set wkbkorigin = Workbooks.Open(ThisWorkbook.Path &amp; \"/\" &amp; Fname)\n            Set originsheet = wkbkorigin.Worksheets(\"Sheet1\")\n            n = 0\n            m = 0\n            'adds recods to the next avaibale row\n            'destsheet.Range(\"B4\").Offset(lngLastRow + 1, 1) = originsheet.Range(\"E4\").Value\n            destsheet.Range(\"C\" &amp; lngLastRow + 1) = originsheet.Range(\"E4\").Value\n            destsheet.Range(\"D\" &amp; lngLastRow + 1) = originsheet.Range(\"E5\").Value\n            destsheet.Range(\"E\" &amp; lngLastRow + 1) = originsheet.Range(\"E6\").Value\n            destsheet.Range(\"F\" &amp; lngLastRow + 1) = originsheet.Range(\"E7\").Value\n            destsheet.Range(\"G\" &amp; lngLastRow + 1) = originsheet.Range(\"E8\").Value\n            destsheet.Range(\"H\" &amp; lngLastRow + 1) = originsheet.Range(\"E9\").Value\n            destsheet.Range(\"I\" &amp; lngLastRow + 1) = originsheet.Range(\"E10\").Value\n\n            lngLastRow = lngLastRow + 1\n            wkbkorigin.Close SaveChanges:=False   'close current file\n\n        End If\n        'stips when out of files to import\n        Fname = Dir()\nLoop\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "excel", "multiple-columns", "cells"], "comments": [{"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1502292111, "post_id": 45594700, "comment_id": 78149014, "body": "What is the behavior it is giving you right now?"}, {"owner": {"reputation": 79, "user_id": 8289648, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-z7s1ZySfqP4/AAAAAAAAAAI/AAAAAAAADOg/qaESbEk5pSs/photo.jpg?sz=128", "display_name": "Ronan Garrison", "link": "https://stackoverflow.com/users/8289648/ronan-garrison"}, "edited": false, "score": 0, "creation_date": 1502292566, "post_id": 45594700, "comment_id": 78149348, "body": "Was manually typed, updated as a copied version now."}, {"owner": {"reputation": 79, "user_id": 8289648, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-z7s1ZySfqP4/AAAAAAAAAAI/AAAAAAAADOg/qaESbEk5pSs/photo.jpg?sz=128", "display_name": "Ronan Garrison", "link": "https://stackoverflow.com/users/8289648/ronan-garrison"}, "reply_to_user": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1502292624, "post_id": 45594700, "comment_id": 78149396, "body": "Right now, this doesn&#39;t do anything..."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1502292657, "post_id": 45594700, "comment_id": 78149420, "body": "I just tried this, and it is working for me."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1502293181, "post_id": 45594700, "comment_id": 78149813, "body": "In the future, cases like this are normally figured out using the debugger pretty easily."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1502293767, "post_id": 45594700, "comment_id": 78150217, "body": "@RonanGarrison Why don&#39;t you use a filter ??? Will be much faster"}, {"owner": {"reputation": 79, "user_id": 8289648, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-z7s1ZySfqP4/AAAAAAAAAAI/AAAAAAAADOg/qaESbEk5pSs/photo.jpg?sz=128", "display_name": "Ronan Garrison", "link": "https://stackoverflow.com/users/8289648/ronan-garrison"}, "reply_to_user": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1502298454, "post_id": 45594700, "comment_id": 78152946, "body": "@SandPiper what is the debugger?"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 5, "last_activity_date": 1502292597, "creation_date": 1502292597, "answer_id": 45594914, "question_id": 45594700, "link": "https://stackoverflow.com/questions/45594700/vba-hide-rows-based-on-whether-cell-contains-specific-text/45594914#45594914", "title": "VBA- Hide rows based on whether cell contains specific text", "body": "<pre><code>Sub HideRows()\n\n    Dim rCheck As Range\n    Dim rHide As Range\n    Dim rCheckCell As Range\n\n    Set rCheck = ActiveWorkbook.ActiveSheet.Range(\"B3:B2452\")\n    rCheck.EntireRow.Hidden = False\n\n    For Each rCheckCell In rCheck.Cells\n        If InStr(1, rCheckCell, \"Discontinued\", vbTextCompare) &gt; 0 Then\n            If Not rHide Is Nothing Then Set rHide = Union(rHide, rCheckCell) Else Set rHide = rCheckCell\n        End If\n    Next rCheckCell\n\n    If Not rHide Is Nothing Then rHide.EntireRow.Hidden = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 8289648, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-z7s1ZySfqP4/AAAAAAAAAAI/AAAAAAAADOg/qaESbEk5pSs/photo.jpg?sz=128", "display_name": "Ronan Garrison", "link": "https://stackoverflow.com/users/8289648/ronan-garrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5259, "favorite_count": 1, "accepted_answer_id": 45594914, "answer_count": 1, "score": 2, "last_activity_date": 1502292597, "creation_date": 1502292018, "last_edit_date": 1502292549, "question_id": 45594700, "link": "https://stackoverflow.com/questions/45594700/vba-hide-rows-based-on-whether-cell-contains-specific-text", "title": "VBA- Hide rows based on whether cell contains specific text", "body": "<p>Looking to scan through a whole column to see if the product (in individual cell) may be discontinued. This is true if the word discontinued is in a cell. I want the whole row to be hidden if it is discontinued. Any suggestions?</p>\n\n<pre><code>Sub HideRows()\n    Dim c As Range\n    For Each c In Range(\"B3:B2452\")\n        If InStr(1, c, \"Discontinued\") Or InStr(1, c, \"discontinued\") Then\n            c.EntireRow.Hidden = True\n        End If\n        Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1502291518, "post_id": 45594413, "comment_id": 78148537, "body": "<code>ModelCell.Column</code> is not the column number???"}, {"owner": {"reputation": 1, "user_id": 8334150, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213908980825119/picture?type=large", "display_name": "Chris A. McGough", "link": "https://stackoverflow.com/users/8334150/chris-a-mcgough"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502292488, "post_id": 45594413, "comment_id": 78149287, "body": "Wow, that was simple.  Thanks!"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1502294550, "post_id": 45594413, "comment_id": 78150704, "body": "you are welcome :)"}], "owner": {"reputation": 1, "user_id": 8334150, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213908980825119/picture?type=large", "display_name": "Chris A. McGough", "link": "https://stackoverflow.com/users/8334150/chris-a-mcgough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502292330, "creation_date": 1502291280, "last_edit_date": 1502292330, "question_id": 45594413, "link": "https://stackoverflow.com/questions/45594413/how-to-count-columns-in-for-each-next", "title": "How to count columns in For Each Next", "body": "<p>I am using a For Each loop to check every cell in a range for a value.  If the value is present, I need to be able to identify which column the cell is in, and then set a value to a variable based upon that location to identify which product model was received.  </p>\n\n<p>I have attempted to use columns.count, but it seems VBA does not actually view the cell as active in a For Each loop.</p>\n\n<pre><code>For Each ModelCell In Models 'Checks each cell for partial order             \n  If ModelCell.Value &gt; \"0\" Then\n    CurrentCount = ModelCell.Value\n    TotalReceived = InputBox(\"How many were received?\") 'asks how many were received\n    UpdatedCount = CurrentCount - TotalReceived\n    If UpdatedCount &gt; \"0\" Then\n      PartialOrder = True\n      ModelCell.Value = UpdatedCount\n      Range(Cells(RowNumber, 1), Cells(RowNumber, 22)).Interior.Color = rgbAquamarine \n      'Checks all cells and turns green\n    End If                                               \n  End If\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1502291202, "post_id": 45593969, "comment_id": 78148309, "body": "is <code>firstName</code> supposed to be the first name of a person or the first name in a list of people? Usually, it refers to the &quot;given&quot; or &quot;christian&quot; name of a single person. <i>Naming things is hard</i>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1502291258, "post_id": 45593969, "comment_id": 78148357, "body": "there is probably an <code>AddressList.AddressEntries.Count</code> or something similar - check your count to ensure you&#39;re getting access to more than just yourself. Also, <code>Address2</code> is a <code>String</code>, <code>AddressName</code> and <code>Address</code> are <code>Variant</code>."}, {"owner": {"reputation": 75, "user_id": 8149544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/77b7504a2a1646a1db274a1ea4966565?s=128&d=identicon&r=PG&f=1", "display_name": "wgray", "link": "https://stackoverflow.com/users/8149544/wgray"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1502293879, "post_id": 45593969, "comment_id": 78150291, "body": "@FreeMan sorry about the confusion, I have another variable called secondName that searches the address list a second time so both variables hold different full (Doe, Jane for example) names. I have also tried other names than myself and some do work. I just used myself as an example. I also tried changing address name and address to a string but that made no difference. Address2 is used in the next part of code."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8149544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/77b7504a2a1646a1db274a1ea4966565?s=128&d=identicon&r=PG&f=1", "display_name": "wgray", "link": "https://stackoverflow.com/users/8149544/wgray"}, "edited": false, "score": 0, "creation_date": 1502372623, "post_id": 45597260, "comment_id": 78189693, "body": "Another question about this... If 2 people in the GAL have the same name, I get an error &quot;Cannot resolve recipient&quot;. Is there any way to make this just choose the first user it comes across? I tried using Err.Number after an on error resume next to catch it and use my old way of searching but it gives a different error number every time..."}, {"owner": {"reputation": 75, "user_id": 8149544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/77b7504a2a1646a1db274a1ea4966565?s=128&d=identicon&r=PG&f=1", "display_name": "wgray", "link": "https://stackoverflow.com/users/8149544/wgray"}, "edited": false, "score": 0, "creation_date": 1502373622, "post_id": 45597260, "comment_id": 78190611, "body": "It seems it always gives a negative error number so I&#39;ll just use err.number &lt; 0"}, {"owner": {"reputation": 75, "user_id": 8149544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/77b7504a2a1646a1db274a1ea4966565?s=128&d=identicon&r=PG&f=1", "display_name": "wgray", "link": "https://stackoverflow.com/users/8149544/wgray"}, "edited": false, "score": 0, "creation_date": 1502383053, "post_id": 45597260, "comment_id": 78197656, "body": "Thanks for the update but sadly using redemption is not an option... I think I&#39;ll stick with catching the error and asking the person running the macro to manually find the user&#39;s email. It only happens every once in a while so it shouldn&#39;t be too annoying."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1502391000, "last_edit_date": 1502391000, "creation_date": 1502300213, "answer_id": 45597260, "question_id": 45593969, "link": "https://stackoverflow.com/questions/45593969/automation-error-in-global-address-list-lookup/45597260#45597260", "title": "Automation error in global address list lookup", "body": "<p>Do not loop through all items in GAL - some GALs contain tens of thousand of entries, and you will nto be able to loop through them.</p>\n\n<p>Call <code>Application.Session.CreateRecipient</code> (returns <code>Recipient</code> object), call <code>Recipient.Resolve</code>, then use <code>Recipient.AddressEntry.GetExchangeUser</code>.  </p>\n\n<p><strong>UPDATE</strong>:<bR>\nif the name is ambiguous, you will get back an error from <code>Recipient.Resolve</code> - Outlook Object Model does not let you recover from that - there is no way to get the list of matches and select the one you want. If using <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a> is an option, you can use is <a href=\"http://www.dimastr.com/redemption/rdoaddressbook.htm\" rel=\"nofollow noreferrer\">RDOAddressBook</a>.<code>ResolveNameEx</code> method - it returns a list of matches (of one entry if the name is not ambiguous). You can also use <a href=\"http://www.dimastr.com/redemption/RDOAddressList.htm\" rel=\"nofollow noreferrer\">RDIAddressList</a>.<code>ResolveName</code> / <code>ResolveNameEx</code> if yo uwant to resolve agaist a particular container only (e.g. GAL).</p>\n\n<pre><code> Set o = CreateObject(\"Outlook.Application\")\n ...\n set Session = CreateObject(\"Redemption.RDOSession\")\n Session.MAPIOBJECT = o.Session.MAPIOBJECT\n set AdrrEntries = Session.AddressBook.ResolveNameEx(\"John\")\n MsgBox AdrrEntries.Count &amp; \" names were returned by ResolveNameEx:\"\n for each AE in AdrrEntries\n     MsgBox AE.Name\n next\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8149544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/77b7504a2a1646a1db274a1ea4966565?s=128&d=identicon&r=PG&f=1", "display_name": "wgray", "link": "https://stackoverflow.com/users/8149544/wgray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 45597260, "answer_count": 1, "score": 1, "last_activity_date": 1502391000, "creation_date": 1502290026, "last_edit_date": 1502290376, "question_id": 45593969, "link": "https://stackoverflow.com/questions/45593969/automation-error-in-global-address-list-lookup", "title": "Automation error in global address list lookup", "body": "<p>I'm trying to look up a person's email address using the Outlook global address list. Here is the VBA code I use to do it.</p>\n\n<pre><code>    'Snip\n    If firstName &lt;&gt; \"\" Then\n        Dim o, AddressList, AddressEntry\n        Dim AddressName, Address, Address2 As String\n        Set o = CreateObject(\"Outlook.Application\")\n        Set AddressList = o.Session.AddressLists(\"Global Address List\")\n        AddressName = firstName\n        For Each AddressEntry In AddressList.AddressEntries\n            If AddressEntry.Name = AddressName Then\n                Address = AddressEntry.GetExchangeUser.PrimarySmtpAddress\n                Exit For\n            End If\n        Next AddressEntry\n    End If\n    'Snip\n</code></pre>\n\n<p>The variable \"firstName\" is in the format Last name, first name. This seemingly only works half of the time I try to use it. For example if I put my own name in it work perfectly fine every time but if I put in my co-worker's name I get a little pop up bubble from Outlook saying \"outlook is trying to retrieve data from the Microsoft exchange server *.com\" and then I get an automation error. I couldn't find anything in common between the names that don't work and the same for those that do. Any help would be very much appreciated.</p>\n\n<p>EDIT: Another note I just thought of is that when I hit debug on the error window it highlights the \"Next AddressEntry\" line.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39, "user_id": 2330622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7NG1e.png?s=128&g=1", "display_name": "Alan Marsh", "link": "https://stackoverflow.com/users/2330622/alan-marsh"}, "edited": false, "score": 0, "creation_date": 1597074441, "post_id": 45593868, "comment_id": 112008174, "body": "<a href=\"https://stackoverflow.com/questions/54559743/excel-vba-cant-find-project-or-library/60075328#60075328\" title=\"excel vba cant find project or library\">stackoverflow.com/questions/54559743/&hellip;</a> Scroll to Greg Dodds answer - this works!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8440426, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-FtAnIp4rKN8/AAAAAAAAAAI/AAAAAAAAAGU/grxMavI28v4/photo.jpg?sz=128", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8440426/damian-m"}, "edited": false, "score": 0, "creation_date": 1502290845, "post_id": 45594127, "comment_id": 78148034, "body": "Did this stop this error from happening? I have no &#39;Crystal Analysis Common Controls 1.0&#39; selected and all others that are selected are same as your, except the last one but not using user forms."}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1502290481, "creation_date": 1502290481, "answer_id": 45594127, "question_id": 45593868, "link": "https://stackoverflow.com/questions/45593868/what-causes-cant-find-project-or-library-error-and-how-to-prevent-it-from-hap/45594127#45594127", "title": "What causes &#39;can&#39;t find project or library error&#39; and how to prevent it from happening?", "body": "<p>This worked for me:</p>\n\n<p>In VB go to Tools \u00bb References\n1) Uncheck the library \"Crystal Analysis Common Controls 1.0\". Or any library.\nJust leave these 5 references:\n1) Visual Basic For Applications (This is the library that defines the VBA language.)\n2) Microsoft Excel Object Library (This defines all of the elements of Excel.)\n3) OLE Automation (This specifies the types for linking and embedding documents and for automation of other applications and the \"plumbing\" of the COM system that Excel uses to communicate with the outside world.)\n4) Microsoft Office (This defines things that are common to all Office programs such as Command Bars and Command Bar controls.)\n5) Microsoft Forms 2.0 This is required if you are using a User Form. This library defines things like the user form and the controls that you can place on a form.\nThen Save.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8440426, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-FtAnIp4rKN8/AAAAAAAAAAI/AAAAAAAAAGU/grxMavI28v4/photo.jpg?sz=128", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8440426/damian-m"}, "edited": false, "score": 0, "creation_date": 1502291539, "post_id": 45594397, "comment_id": 78148553, "body": "Hmmm.. I see.. the problem is however that tool might be working absolutely fine for few days and error will happen out of nowhere, I don&#39;t know what triggers it so can&#39;t really test it like that.. and what exactly is the benefit of exporting and reimporting my modules? Is this to be done after error happens or before? Because of after it won&#39;t be possible cause the file just crashes."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 11, "user_id": 8440426, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-FtAnIp4rKN8/AAAAAAAAAAI/AAAAAAAAAGU/grxMavI28v4/photo.jpg?sz=128", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8440426/damian-m"}, "edited": false, "score": 0, "creation_date": 1502294644, "post_id": 45594397, "comment_id": 78150757, "body": "From AppsPro link &#39;During the process of creating VBA programs a lot of junk code builds up in your files. If you don&#39;t clean your files periodically you will begin to experience strange problems caused by this extra baggage. Cleaning a project involves exporting the contents of all its VBComponents to text files, deleting the components and then importing the components back from the text files.&#39;"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1502291244, "creation_date": 1502291244, "answer_id": 45594397, "question_id": 45593868, "link": "https://stackoverflow.com/questions/45593868/what-causes-cant-find-project-or-library-error-and-how-to-prevent-it-from-hap/45594397#45594397", "title": "What causes &#39;can&#39;t find project or library error&#39; and how to prevent it from happening?", "body": "<p>I've had similar nasty issues.  </p>\n\n<p>First thing to do is use the  <a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow noreferrer\">CodeCleaner a free utility from AppsPro</a>\nThis will export your modules and then re-import them, because internally they get a lot of binary \"lint\" which can cause problem.</p>\n\n<p>Second thing to suggest is start breaking up your code base.  So start removing modules to see which module is the offender.  Horrible I know but how can you tell otherwise where the problem is.</p>\n\n<p>Third suggestion is to always fully qualify your functions.  So instead of Len(sMyString) write VBA.Len(sMyString) that helps prevent false negative compile errors.</p>\n"}, {"comments": [{"owner": {"reputation": 2604, "user_id": 3385948, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YJIjJ.png?s=128&g=1", "display_name": "Sean McCarthy", "link": "https://stackoverflow.com/users/3385948/sean-mccarthy"}, "edited": false, "score": 0, "creation_date": 1583766846, "post_id": 52715353, "comment_id": 107217524, "body": "When all else failed, this worked for me. I opened my workbook in Excel online (Office 365, in the browser, which doesn&#39;t support macros anyway), saved it with a new file name (still using .xlsm file extension), and reopened in the desktop software. It worked."}], "tags": [], "owner": {"reputation": 21, "user_id": 10477032, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e36698c2571ce79ed40731d8e268f589?s=128&d=identicon&r=PG", "display_name": "user10477032", "link": "https://stackoverflow.com/users/10477032/user10477032"}, "is_accepted": false, "score": 2, "last_activity_date": 1539069538, "creation_date": 1539069538, "answer_id": 52715353, "question_id": 45593868, "link": "https://stackoverflow.com/questions/45593868/what-causes-cant-find-project-or-library-error-and-how-to-prevent-it-from-hap/52715353#52715353", "title": "What causes &#39;can&#39;t find project or library error&#39; and how to prevent it from happening?", "body": "<p>I have exactly this problem. As stated, once the error occurs, it it results in a permanent \"unfixable\" loop. I use powerquery and linked data and this appears to randomly \"damage\" the file as described - most frequently when excel crashes for some reason.</p>\n\n<p>I have found either of the following to work:\n - Open the file on a different computer that is not on the LAN. This\n   appears to be a key requirement.\n - Open the file with \"Excel Online\"</p>\n\n<p>In each case, simply open the file and save it with a new name. Move the new file back to the work PC and it will once more open perfectly. </p>\n\n<p>On rare occasions (if powerquery is in use), it is necessary to \"refresh all\" data connections before saving the new file.</p>\n\n<p>As a bonus, the new file is often smaller than the original.</p>\n"}], "owner": {"reputation": 11, "user_id": 8440426, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-FtAnIp4rKN8/AAAAAAAAAAI/AAAAAAAAAGU/grxMavI28v4/photo.jpg?sz=128", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8440426/damian-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10115, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1539069538, "creation_date": 1502289791, "question_id": 45593868, "link": "https://stackoverflow.com/questions/45593868/what-causes-cant-find-project-or-library-error-and-how-to-prevent-it-from-hap", "title": "What causes &#39;can&#39;t find project or library error&#39; and how to prevent it from happening?", "body": "<p>I'm having an issue with tool I developed in excel for one of our offices. It is  a big enough file with couple of macros in it, but it works smooth day to day.</p>\n\n<p>However every few days file will through error 'Can't find project or library' and file will crash. I know the standard guides are that when this error appears, it is to go to vba>tools>referneces and uncheck the missing library, however this is not the case in here. Simply when this happens file crashes and restarts and if it will happen once, every other attempt to open back the file will result in same error in crash. I mean file can be absolutely fine, you will save it, go back to it and error happens.  So I always have to recover the file which absolutely destroys it, however I can at least recover from it information uploaded there by the users and copy it into the template.</p>\n\n<p>So 2 questions I have is what is causing this to happen? Both myself and the other office are using the same version of excel so compatibility should not be an issue.</p>\n\n<p>2 questions is is there anything that can be done to prevent this error from happening.   </p>\n"}, {"tags": ["arrays", "vba", "search", "user-defined-types"], "comments": [{"owner": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "edited": false, "score": 2, "creation_date": 1502290198, "post_id": 45593744, "comment_id": 78147466, "body": "Yes. Post your code and what you have tried so far."}, {"owner": {"reputation": 77, "user_id": 8429967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4fb713e81f08ba34c14c2be43d6138d?s=128&d=identicon&r=PG&f=1", "display_name": "Ari Levisohn", "link": "https://stackoverflow.com/users/8429967/ari-levisohn"}, "reply_to_user": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "edited": false, "score": 0, "creation_date": 1502291454, "post_id": 45593744, "comment_id": 78148495, "body": "@coinbird I posted the code for <code>Card</code> above. I am looking for a function like <code>deck.findFirstElementThatQualifies(.number = 7)</code> or something like that, but I haven&#39;t found a way to do it."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8429967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4fb713e81f08ba34c14c2be43d6138d?s=128&d=identicon&r=PG&f=1", "display_name": "Ari Levisohn", "link": "https://stackoverflow.com/users/8429967/ari-levisohn"}, "edited": false, "score": 0, "creation_date": 1502292584, "post_id": 45594773, "comment_id": 78149365, "body": "Thanks. This should work, but I imagine it will take a while if I am doing it many times."}, {"owner": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "reply_to_user": {"reputation": 77, "user_id": 8429967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4fb713e81f08ba34c14c2be43d6138d?s=128&d=identicon&r=PG&f=1", "display_name": "Ari Levisohn", "link": "https://stackoverflow.com/users/8429967/ari-levisohn"}, "edited": false, "score": 0, "creation_date": 1502293397, "post_id": 45594773, "comment_id": 78149952, "body": "@AriLevisohn You&#39;re right, it absolutely will take a long time. There are extremely complex searching and sorting algorithms that would help you do this faster, but you need to learn to use basic searches before the complex ones will make sense. You also need specific goals of your search. If you can perfectly define what you want your program to find, and what to do with that data, you can make your searches faster."}], "tags": [], "owner": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "is_accepted": true, "score": 0, "last_activity_date": 1502292230, "creation_date": 1502292230, "answer_id": 45594773, "question_id": 45593744, "link": "https://stackoverflow.com/questions/45593744/vba-find-object-in-array-with-specific-property/45594773#45594773", "title": "VBA \u2013 Find object in array with specific property", "body": "<p>Searching through data is a massive part of programming. There are countless ways to search depending on your needs. To do a basic linear search you could make a loop to the length of the array, and check each array element to see if it meets your criteria.</p>\n\n<p>Since you haven't tried anything yet, or told us what you want to do with the data you find (or don't find) I'll give you some pseudo code to start you off:</p>\n\n<pre><code>for(counter integer that increments until it is equal to the length of the array)\n{\n    if(array at position[counter] == the color/suit/number your looking for)\n    {\n        //do whatever\n    }\n    else\n    {\n        //do something else\n    }\n}\n</code></pre>\n\n<p>You could make this into a function that takes input, and returns data, so you could call it with whatever data you want to find. </p>\n\n<p>If this doesn't make sense to you, you will need to start by researching loops.</p>\n"}], "owner": {"reputation": 77, "user_id": 8429967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4fb713e81f08ba34c14c2be43d6138d?s=128&d=identicon&r=PG&f=1", "display_name": "Ari Levisohn", "link": "https://stackoverflow.com/users/8429967/ari-levisohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 45594773, "answer_count": 1, "score": 2, "last_activity_date": 1502292230, "creation_date": 1502289451, "last_edit_date": 1502291240, "question_id": 45593744, "link": "https://stackoverflow.com/questions/45593744/vba-find-object-in-array-with-specific-property", "title": "VBA \u2013 Find object in array with specific property", "body": "<p>Let's say I have an object called <code>Card</code> which has several properties like <code>color</code>, <code>number</code>, <code>suit</code>, etc. Then I store a bunch of <code>Card</code>s in an array called <code>deck</code>. Is there a way to search the <code>deck</code> for a <code>Card</code> with a specific property or set of properties?</p>\n\n<p>Thanks!</p>\n\n<p>Theoretical code for <code>Card</code>:</p>\n\n<pre><code>Public color As String\nPublic suit As String\nPublic number As Integer\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502289429, "post_id": 45593694, "comment_id": 78146840, "body": "Have you tried using single quotes around your months instead of double quotes? Doing it the way you are doing it will cause VBA to think that <code>Feb</code> is some sort of variable that is not concatenated correctly."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 3, "creation_date": 1502289762, "post_id": 45593694, "comment_id": 78147112, "body": "Can you detail how your script is not working as expected?"}, {"owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1502290706, "post_id": 45593694, "comment_id": 78147903, "body": "@nbayly I&#39;ve updated the question. I get error 13: type mismatch when I try to put the if function in"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1502290710, "post_id": 45593694, "comment_id": 78147909, "body": "like this.... <code>&quot;=IF(R3C5=&#39;Feb&#39;,A</code>"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1502290731, "post_id": 45593694, "comment_id": 78147933, "body": "You need to escape the double quotes in your formula with another set of double quotes. E.g. <code>SomeCell.Formula = &quot;=IF$E$3=&quot;&quot;Feb&quot;&quot;,RestOfFormulaHere&quot;</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502290866, "post_id": 45593694, "comment_id": 78148051, "body": "You&#39;re trying to <i>multiply</i> a string literal, that won&#39;t work."}, {"owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502291061, "post_id": 45593694, "comment_id": 78148206, "body": "@DavidZemens sorry I am still new to vba and don&#39;t know what that means"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1502291427, "post_id": 45594402, "comment_id": 78148485, "body": "I actually didn&#39;t mean to put a *, I changed that to a plus sign. I am trying to add the value in the last used row of that column to the cell with the if function."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 1, "creation_date": 1502291684, "post_id": 45594402, "comment_id": 78148647, "body": "Like this? <code>....Formula = sLongFormula &amp; &quot;+&quot; &amp; .Cells(OutputLastRow, NextColumn)</code>"}, {"owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1502291958, "post_id": 45594402, "comment_id": 78148883, "body": "Yes exactly like that... Assuming the if statement is correct, which is the other thing I was having trouble with."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1502291968, "post_id": 45594402, "comment_id": 78148898, "body": "Note you can probably also simplify that longass formula with some sort of index/match/lookup or maybe SumIf/SumIfs ."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1502291997, "post_id": 45594402, "comment_id": 78148913, "body": "I can&#39;t possibly help you with the <code>If</code> function. You should figure that out on the worksheet itself, and once you have it working (manually), then move it in to your VBA code :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1502292161, "post_id": 45594402, "comment_id": 78149052, "body": "How on earth do you expect me to do that? Note you&#39;re missing an &quot;Actuals&quot; and a parenthesis in the &quot;OCT&quot; if branch."}, {"owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1502293898, "post_id": 45594402, "comment_id": 78150303, "body": "when I ran your code I got: &quot;Run-time Error 1004: Application defined or object defined error&quot; for <code>.Range(Cells(2, NextColumn), .Cells(2, NextColumn)).Formula = _     sLongFormula &amp; &quot;+&quot; &amp; .Cells(OutputLastRow, NextColumn)</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1502293994, "post_id": 45594402, "comment_id": 78150358, "body": "You mean when you ran <i>your</i> code :)  make sure all of your <code>Cells</code> are properly qualified, at least one of them appears to be missing a leading <code>.</code> which will possibly result in an illegaly-defined range (a range cannot consist of cells spanning multiple worksheets) and that will raise a 1004 EVERY TIME."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "edited": false, "score": 0, "creation_date": 1502294138, "post_id": 45594402, "comment_id": 78150449, "body": "1004 will also raise if the formula itself can&#39;t be evaluated, which may be the case if you haven&#39;t fixed some of the errors I mentioned."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1502294106, "last_edit_date": 1502294106, "creation_date": 1502291254, "answer_id": 45594402, "question_id": 45593694, "link": "https://stackoverflow.com/questions/45593694/how-to-place-if-statement-in-next-available-column-in-excel-vba/45594402#45594402", "title": "How to place IF statement in next available column in Excel VBA?", "body": "<p>You're trying to add a numeric value to a a string literal, that won't work: </p>\n\n<pre><code>.Range(Cells(2, NextColumn), .Cells(2, NextColumn)).Formula = _\n    \"=IF(R3C5=\"\"Feb\"\",Actuals!R133C22,IF(R3C5=\"\"Mar\"\",SUM(Actuals!R133C22:R133C600),IF(R3C5=\"\"Apr\"\",SUM(Actuals!R133C22:R133C24),IF(R3C5=\"\"May\"\",SUM(Actuals!R133C22:R133C25),IF(R3C5=\"\"Jun\"\",SUM(Actuals!R133C22:R133C26),IF(R3C5=\"\"Jul\"\",SUM(Actuals!R133C22:R133C27),IF(R3C5=\"\"Aug\"\",SUM(Actuals!R133C22:R133C28),IF(R3C5=\"\"sep\"\",SUM(Actuals!R133C22:R133C29),IF(R3C5=\"\"Oct\"\",SUM\" &amp; _\n                                                                  \"!R133C22:R133C30),IF(R3C5=\"\"Nov\"\",SUM(Actuals!R133C22:R133C31),IF(R3C5=\"\"Dec\"\",SUM(Actuals!R133C22:R133C32),\"\"\"\")))))))))))\" + .Cells(OutputLastRow, NextColumn)\n</code></pre>\n\n<p>Let's break this down:</p>\n\n<pre><code>Dim sLongFormula$\nsLongFormula = \"=IF(R3C5=\"\"Feb\"\",Actuals!R133C22,IF(R3C5=\"\"Mar\"\",SUM(Actuals!R133C22:R133C600),IF(R3C5=\"\"Apr\"\",SUM(Actuals!R133C22:R133C24),IF(R3C5=\"\"May\"\",SUM(Actuals!R133C22:R133C25),IF(R3C5=\"\"Jun\"\",SUM(Actuals!R133C22:R133C26),IF(R3C5=\"\"Jul\"\",SUM(Actuals!R133C22:R133C27),IF(R3C5=\"\"Aug\"\",SUM(Actuals!R133C22:R133C28),IF(R3C5=\"\"sep\"\",SUM(Actuals!R133C22:R133C29),IF(R3C5=\"\"Oct\"\",SUM\" &amp; _\n                                                                  \"!R133C22:R133C30),IF(R3C5=\"\"Nov\"\",SUM(Actuals!R133C22:R133C31),IF(R3C5=\"\"Dec\"\",SUM(Actuals!R133C22:R133C32),\"\"\"\")))))))))))\"\n</code></pre>\n\n<p>So what you end up with is:</p>\n\n<pre><code>.Range(Cells(2, NextColumn), .Cells(2, NextColumn)).Formula = sLongFormula  + .Cells(OutputLastRow, NextColumn)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/45572454/problems-with-adding-variants-together-vba/45573157#45573157\">You simply can't add numeric values to a string in VBA</a> (using the <code>&amp;</code> concatenator instead of the <code>+</code> would do an implicit type-conversion of numeric => string, however).</p>\n\n<p>What you really need, I think:</p>\n\n<pre><code>.Range(.Cells(2, NextColumn), .Cells(2, NextColumn)).Formula = _\n    sLongFormula &amp; \"+\" &amp; .Cells(OutputLastRow, NextColumn)\n</code></pre>\n\n<p>Note the addition of a leading <code>.</code> in <code>.Cells(2, NextColumn)</code> Previously, you would get a 1004 because you just Activated the pivot sheet, but you're defining a range inside a <code>With</code> block, and it is not possible to construct a range that includes cells spanning multiple worksheets.</p>\n\n<p>__</p>\n\n<p>Your formula looks suspect, if you break it down with more line breaks, you have:</p>\n\n<pre><code>sLongFormula = \"=IF(R3C5=\"\"Feb\"\",Actuals!R133C22,\n            IF(R3C5=\"\"Mar\"\",SUM(Actuals!R133C22:R133C600), _\n            IF(R3C5=\"\"Apr\"\",SUM(Actuals!R133C22:R133C24), _\n            IF(R3C5=\"\"May\"\",SUM(Actuals!R133C22:R133C25), _\n            IF(R3C5=\"\"Jun\"\",SUM(Actuals!R133C22:R133C26), _\n            IF(R3C5=\"\"Jul\"\",SUM(Actuals!R133C22:R133C27), _\n            IF(R3C5=\"\"Aug\"\",SUM(Actuals!R133C22:R133C28), _\n            IF(R3C5=\"\"sep\"\",SUM(Actuals!R133C22:R133C29), _\n            IF(R3C5=\"\"Oct\"\",SUM\" &amp; _\n                                    \"!R133C22:R133C30), _\n            IF(R3C5=\"\"Nov\"\",SUM(Actuals!R133C22:R133C31), _\n            IF(R3C5=\"\"Dec\"\",SUM(Actuals!R133C22:R133C32), _\n            \"\"\"\")))))))))))\"\n</code></pre>\n\n<p>So you're missing an opening parens and the <code>Actuals</code> for the <code>Oct</code> condition:</p>\n\n<pre><code>sLongFormula = \"=IF(R3C5=\"\"Feb\"\",Actuals!R133C22,\n            IF(R3C5=\"\"Mar\"\",SUM(Actuals!R133C22:R133C600), _\n            IF(R3C5=\"\"Apr\"\",SUM(Actuals!R133C22:R133C24), _\n            IF(R3C5=\"\"May\"\",SUM(Actuals!R133C22:R133C25), _\n            IF(R3C5=\"\"Jun\"\",SUM(Actuals!R133C22:R133C26), _\n            IF(R3C5=\"\"Jul\"\",SUM(Actuals!R133C22:R133C27), _\n            IF(R3C5=\"\"Aug\"\",SUM(Actuals!R133C22:R133C28), _\n            IF(R3C5=\"\"sep\"\",SUM(Actuals!R133C22:R133C29), _\n            IF(R3C5=\"\"Oct\"\",SUM(Actuals!R133C22:R133C30), _\n            IF(R3C5=\"\"Nov\"\",SUM(Actuals!R133C22:R133C31), _\n            IF(R3C5=\"\"Dec\"\",SUM(Actuals!R133C22:R133C32), _\n            \"\"\"\")))))))))))\"\n</code></pre>\n\n<p>I also notice that March is C600, but all the other months are indexed from 24, etc. And strangely, February is not a <code>Sum</code> function at all. Both of these quirks might be <em>correct</em> for your usage, but they <em>appear</em> to me inconsistent.</p>\n\n<p>You can probably simplify that monstrous function using some sort of lookup or <code>SumIf</code>/<code>SumIfs</code> function, too.</p>\n"}], "owner": {"reputation": 141, "user_id": 8149095, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6af11f511ae1dce14e0f582ef383382?s=128&d=identicon&r=PG&f=1", "display_name": "cthallofamer", "link": "https://stackoverflow.com/users/8149095/cthallofamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 45594402, "answer_count": 1, "score": 1, "last_activity_date": 1502294106, "creation_date": 1502289299, "last_edit_date": 1502291005, "question_id": 45593694, "link": "https://stackoverflow.com/questions/45593694/how-to-place-if-statement-in-next-available-column-in-excel-vba", "title": "How to place IF statement in next available column in Excel VBA?", "body": "<p>I am trying to place an IF statement in the next available column(dynamic) in row 2. Once the IF statement is in that cell, I want to add in the value from the last used row(dynamic) from that same column. I have been having trouble coding the IF statement into VBA. I also need help with coding it so it adds in the last row from the column into the cell with the IF statement. Here is my code so far: </p>\n\n<pre><code>Sub vlookupF5()\nDim SourceLastRow As Long\nDim OutputLastRow As Long\nDim sourceSheet As Worksheet\nDim outputSheet As Worksheet\n\nDim NextColumn As Long\nDim ColumnStr As String\nDim ColumnStr2 As String\nDim ColumnStr3 As String\nSet sourceSheet = Worksheets(\"Actuals\")\nSet outputSheet = Worksheets(\"Pivot\")\nWith sourceSheet\n    SourceLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nWith outputSheet\n    NextColumn = .Cells(2, Columns.Count).End(xlToLeft).Column + 1\n    If NextColumn + 1 &lt; 27 Then\n        ColumnStr = Chr(64 + NextColumn + 1)\n    Else\n        ColumnStr = Chr(64 + Int((NextColumn + 1) / 26)) &amp; Chr(64 + ((NextColumn + 1) Mod 26))\n    End If\n    If NextColumn - 1 &lt; 27 Then\n        ColumnStr3 = Chr(64 + NextColumn - 1)\n    Else\n        ColumnStr3 = Chr(64 + Int((NextColumn - 1) / 26)) &amp; Chr(64 + ((NextColumn - 1) Mod 26))\n    End If\n    If NextColumn &lt; 27 Then\n        ColumnStr2 = Chr(64 + NextColumn)\n    Else\n        ColumnStr2 = Chr(64 + Int((NextColumn) / 26)) &amp; Chr(64 + ((NextColumn) Mod 26))\n    End If\n    OutputLastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row - 1\n    Worksheets(\"Pivot\").Activate\n    .Range(Cells(2, NextColumn), .Cells(2, NextColumn)).Formula = _\n    \"=IF(R3C5=\"\"Feb\"\",Actuals!R133C22,IF(R3C5=\"\"Mar\"\",SUM(Actuals!R133C22:R133C600),IF(R3C5=\"\"Apr\"\",SUM(Actuals!R133C22:R133C24),IF(R3C5=\"\"May\"\",SUM(Actuals!R133C22:R133C25),IF(R3C5=\"\"Jun\"\",SUM(Actuals!R133C22:R133C26),IF(R3C5=\"\"Jul\"\",SUM(Actuals!R133C22:R133C27),IF(R3C5=\"\"Aug\"\",SUM(Actuals!R133C22:R133C28),IF(R3C5=\"\"sep\"\",SUM(Actuals!R133C22:R133C29),IF(R3C5=\"\"Oct\"\",SUM\" &amp; _\n                                                                  \"!R133C22:R133C30),IF(R3C5=\"\"Nov\"\",SUM(Actuals!R133C22:R133C31),IF(R3C5=\"\"Dec\"\",SUM(Actuals!R133C22:R133C32),\"\"\"\")))))))))))\" * .Cells(OutputLastRow, NextColumn)\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I keep getting </p>\n\n<blockquote>\n  <p>\"Error 13: Type Mismatch\"</p>\n</blockquote>\n\n<p>for this line:</p>\n\n<pre><code>\"=IF(R3C5=\"\"Feb\"\",Actuals!R133C22,IF(R3C5=\"\"Mar\"\",SUM(Actuals!R133C22:R133C600),IF(R3C5=\"\"Apr\"\",SUM(Actuals!R133C22:R133C24),IF(R3C5=\"\"May\"\",SUM(Actuals!R133C22:R133C25),IF(R3C5=\"\"Jun\"\",SUM(Actuals!R133C22:R133C26),IF(R3C5=\"\"Jul\"\",SUM(Actuals!R133C22:R133C27),IF(R3C5=\"\"Aug\"\",SUM(Actuals!R133C22:R133C28),IF(R3C5=\"\"sep\"\",SUM(Actuals!R133C22:R133C29),IF(R3C5=\"\"Oct\"\",SUM\" &amp; _\n            \"!R133C22:R133C30),IF(R3C5=\"\"Nov\"\",SUM(Actuals!R133C22:R133C31),IF(R3C5=\"\"Dec\"\",SUM(Actuals!R133C22:R133C32),\"\"\"\")))))))))))\" + .Cells(OutputLastRow, NextColumn)\n</code></pre>\n\n<p>Can anyone help??</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502289430, "post_id": 45593691, "comment_id": 78146844, "body": "At this line, <code>If IsInArray(ref1(index, 6).Value, ref2) Then</code> ref2 hasn&#39;t been defined or even dimensioned."}, {"owner": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502289636, "post_id": 45593691, "comment_id": 78147015, "body": "ref2 has been initalized as a variant, and the function IsInArray might need to be changed to reflect a 2D array. I&#39;m not really sure how to change it though, since the function originally was made for 1D to check if an element was in the array"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502289750, "post_id": 45593691, "comment_id": 78147101, "body": "No, this line <code>Dim ref1(), ref2() As Variant</code> declares it, but when you declare an array with open brackets you must use Redim in the code to size it."}, {"owner": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502290040, "post_id": 45593691, "comment_id": 78147331, "body": "Could you happen to know how I could go about resizing an array that should have a variable size? I&#39;m not really use to VBA and mainly code in Python, so the limitations on lists/arrays are new to me."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502290425, "post_id": 45593691, "comment_id": 78147653, "body": "If it should be the same size as ref1 then you could do <code>redim ref2(ubound(ref1,1),ubound(ref1,2))</code>, but IsInArray will only work for a 1D array."}, {"owner": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502291064, "post_id": 45593691, "comment_id": 78148211, "body": "I changed the IsInArray, and resized it as shown in my edits and the issue still occurs, what else could the issue be?"}], "owner": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502291204, "creation_date": 1502289293, "last_edit_date": 1502291204, "question_id": 45593691, "link": "https://stackoverflow.com/questions/45593691/iterating-through-a-2d-array-with-a-for-loop", "title": "Iterating through a 2D Array with a for loop", "body": "<p>I'm trying to create an associative table on a sheet that is pulling in data from a different sheet. By associative I mean, if the data is changed in the source data sheet, it would be reflected on the new sheet. I also want to only have the new sheet's table to be contingent on having a certain unique value. In my case, I want to pull up information related to a part number. The original source data will have many rows that contain the same part number, but I only care to display one of them.</p>\n\n<p>So far, this is what I have: </p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n    Dim bDimen As Byte, i As Long\n\n    On Error Resume Next\n    If IsError(UBound(arr, 2)) Then bDimen = 1 Else bDimen = 2\n    On Error GoTo 0\n\n    Select Case bDimen\n    Case 1\n        On Error Resume Next\n        IsInArray = Application.Match(stringToBeFound, arr, 0)\n        On Error GoTo 0\n    Case 2\n        For i = 1 To UBound(arr, 2)\n            On Error Resume Next\n            IsInArray = Application.Match(stringToBeFound, \nApplication.index(arr, , i), 0)\n            On Error GoTo 0\n            If IsInArray = True Then Exit For\n        Next\n    End Select\nEnd Function\n\nSub Part_Separator()\n    Dim Source As Worksheet\n    Set Source = Sheets(\"Part Tracking Scorecard\")\n    Dim ref1(), ref2() As Variant\n    Dim row, index, lastrow, lastcolumn As Integer\n\n    row = 92\n    lastrow = 866\n    lastcolumn = 84\n\n    ref1 = Source.Range(Source.Cells(row, 1), Source.Cells(lastrow, lastcolumn))\n    ReDim ref2(UBound(ref1, 1), UBound(ref1, 2))\n\n    For index = 0 To (lastrow - row)\n        If IsInArray(ref1(index, 6).Value, ref2) Then\n            index = index + 1\n        Else\n            ref2(index) = ref1(index) 'copy the entire row from source to ref2\n            index = index + 1\n        End If\n    Next index\n\n    Dim NewFile As Worksheet\n    Set NewFile = Sheets(\"Unique Parts\")\n\n    Dim ref2dimension_x, ref2dimension_y As Integer 'find dimensions of ref2 array\n    ref2dimension_x = UBound(ref2, 1) - LBound(ref2, 1) + 1\n    ref2dimension_y = UBound(ref2, 2) - LBound(ref2, 2) + 1\n\n    For index = 2 To ref2dimension_x 'go through entire new sheet and set values\n        For index2 = 1 To ref2dimension_y\n            NewFile.Cells(index, index2).Value = ref2(index - 1, index2)\n        Next index2\n    Next index\n\n    Erase ref1()\n    Erase ref2() 'free up the space occupied by these arrays\n\nEnd Sub\n</code></pre>\n\n<p>My issue when I run this, I get an error at the first for loop where I'm trying to iterate through my ref1 array, which is the array with all my source data.  The error says that my subscript is out of range.  This loop is suppose to check if the specific value is in my ref2 array for uniqueness. If the specific value is found, go onto the next row, if not add the row of values associated to the value I'm checking to ref2. </p>\n"}, {"tags": ["ms-access", "vba", "export-to-pdf"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502291260, "post_id": 45593592, "comment_id": 78148362, "body": "Well, what is your problem? Please make an attempt, so we can see the issues you&#39;re running into. There are enough web pages describing how to filter reports, and print reports to pdf. For pointers on how to ask good questions, read <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a>"}, {"owner": {"reputation": 15, "user_id": 8126167, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/25cc3c38799da5e083857ed0c4c6feda?s=128&d=identicon&r=PG&f=1", "display_name": "CPM", "link": "https://stackoverflow.com/users/8126167/cpm"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502291934, "post_id": 45593592, "comment_id": 78148859, "body": "@ErikvonAsmuth  I can output the report to a PDF easy enough...  But it would be one report containing many companies / invoices.  I need to create a routine that outputs one file for each company"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502292030, "post_id": 45593592, "comment_id": 78148944, "body": "Did you read the how to ask piece? Please adjust your question according to the information in there."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1502302515, "post_id": 45593592, "comment_id": 78155298, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11498794/splitting-a-multi-page-ms-access-report-into-individual-pdf-files-based-on-a-cus\">Splitting a Multi-Page MS Access report into individual pdf files based on a Customer ID?</a>"}], "owner": {"reputation": 15, "user_id": 8126167, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/25cc3c38799da5e083857ed0c4c6feda?s=128&d=identicon&r=PG&f=1", "display_name": "CPM", "link": "https://stackoverflow.com/users/8126167/cpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502289066, "creation_date": 1502289066, "question_id": 45593592, "link": "https://stackoverflow.com/questions/45593592/ms-access-segment-report-into-separate-output-files-and-output-report-to-pdf", "title": "MS Access: Segment Report into separate output files and Output Report To PDF", "body": "<p>I know the title of this thread probably doesn't appropriately describes what I am attempting...</p>\n\n<p>I have a report that is grouped by customer and invoice associated to the customer.  The report, as a whole, contains multiple customers and invoices.</p>\n\n<p>I would like to create code to output a PDF file for each customer as a single file, and use the invoice number to name the file.</p>\n\n<p>Customer A within the report would have a PDF file for Invoice #1\nCustomer B within the report would have a PDF file for Invoice #2</p>\n\n<p>and so on...</p>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502289183, "post_id": 45593372, "comment_id": 78146630, "body": "You will want to write to the <code>.Value</code> or <code>.Value2</code> property instead of the <code>.Text</code> property of the cell. That should preserve the formatting."}], "owner": {"reputation": 23, "user_id": 8362879, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154648813457793/picture?type=large", "display_name": "Adam King", "link": "https://stackoverflow.com/users/8362879/adam-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502288472, "creation_date": 1502288472, "question_id": 45593372, "link": "https://stackoverflow.com/questions/45593372/vba-script-in-word-trying-to-replace-a-figure-in-a-table-cell", "title": "VBA script in word -- trying to replace a figure in a table cell", "body": "<p>I have the below table in word that I'm trying to write a script to replace the contents of the below cell with a different customer payment (i.e replace the \u00a31,100 with \u00a32,000). Below is a snippet of my script but the when i write back to the cell it loses all the formatting and the numbered list. </p>\n\n<p>Thank you for your help in advance</p>\n\n<p>ps.I've simplified the contents of the cell to make it easier to read, so the code won't apply to exactly that content</p>\n\n<pre><code>DescPlan = Trim(t1.Cell(2, 2).Range.Text)\n\nDescTest = InStr(1, DescPlan, \"below:\")\n\nfinalString = Left(DescPlan, Len(DescPlan) - DescTest - 14)\n\nt1.Cell(2, 2).Range.Text = Replace(DescPlan, finalString, \"Payment by the customer of \" + Format(v, \"Currency\") + \" will be due upon completion of items below:\" + vbCrLf)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/A9iBm.png\" rel=\"nofollow noreferrer\">Screenshot of table</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/dRhUm.png\" rel=\"nofollow noreferrer\">After running the script</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502288666, "post_id": 45593055, "comment_id": 78146174, "body": "Can you point out which line throws the error? Also, rather than activating the workbooks, try and use the workbook objects you already have. It&#39;s more efficient and guarantees that you are always interacting with correct workbook"}, {"owner": {"reputation": 27, "user_id": 8235988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d467ca8e579d6fc7bb36671cc973f3f6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8235988/j-doe"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502292182, "post_id": 45593055, "comment_id": 78149071, "body": "You have it now commented. Yes maybe you&#39;re right but it&#39;s not that the error"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 8235988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d467ca8e579d6fc7bb36671cc973f3f6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8235988/j-doe"}, "is_accepted": false, "score": 0, "last_activity_date": 1502297376, "creation_date": 1502297376, "answer_id": 45596475, "question_id": 45593055, "link": "https://stackoverflow.com/questions/45593055/error-unable-to-get-worksheet-function-rsq-an-intercept-but-no-issues-with-lines/45596475#45596475", "title": "Error unable to get worksheet function RSq an Intercept but no issues with LINEST ? why ? and how to fix?", "body": "<p>I solved it. The problem was that I the function slope was regressing something on 0 for the first line and so this first row of 0 was giving the error.</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1502298794, "creation_date": 1502298794, "answer_id": 45596863, "question_id": 45593055, "link": "https://stackoverflow.com/questions/45593055/error-unable-to-get-worksheet-function-rsq-an-intercept-but-no-issues-with-lines/45596863#45596863", "title": "Error unable to get worksheet function RSq an Intercept but no issues with LINEST ? why ? and how to fix?", "body": "<p><code>RSq</code> might experience some calculation error, such as a division by zero.</p>\n\n<p>To check that and have your code continue running, try using <code>Application</code> instead: </p>\n\n<pre><code>rmat(i, j) = Application.RSq(out1, Pente)`\n'            ^^^^^^^^^^^\n</code></pre>\n\n<p>After that, verify in the worksheet that you have error results, i.e. <code>#DIV/0!</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 8235988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d467ca8e579d6fc7bb36671cc973f3f6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8235988/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "closed_date": 1502342837, "accepted_answer_id": 45596863, "answer_count": 2, "score": 1, "last_activity_date": 1502298794, "creation_date": 1502287666, "last_edit_date": 1502292289, "question_id": 45593055, "link": "https://stackoverflow.com/questions/45593055/error-unable-to-get-worksheet-function-rsq-an-intercept-but-no-issues-with-lines", "closed_reason": "Not suitable for this site", "title": "Error unable to get worksheet function RSq an Intercept but no issues with LINEST ? why ? and how to fix?", "body": "<pre><code>Sub S_Reg_Matrixes()\nApplication.ScreenUpdating = False\n\nDim i, j As Long\nDim Pente() As Double\nDim vlive As Range\nDim rmat As Range\nDim dmat As Range\nDim betamat As Range\nDim alphamat As Range\nDim gammamat As Range\nDim lout As Range\nDim VV As Range\nDim Rb As Workbook\nSet Rb = Workbooks(\"Tools.xlsm\")\nDim RMW As Workbook\nSet RMW = Workbooks(\"REG_MATRIXES.xlsm\")\n\n' Defining Ranges:\nRb.Activate\nSet vlive = Rb.Worksheets(\"STATISTICS\").Range(\"StatLiveVol\")\nRMW.Activate\nSet rmat = Worksheets(\"SLOPE\").Range(\"SRMatrix\")\nSet dmat = Worksheets(\"SLOPE\").Range(\"SDistMatrix\")\nSet betamat = Worksheets(\"SLOPE\").Range(\"AE6:AO19\")\nSet alphamat = Worksheets(\"SLOPE\").Range(\"AP6:AZ19\")\nSet gammamat = RMW.Worksheets(\"SLOPE\").Range(\"BA6:BK19\")\nSet lout = Worksheets(\"SLOPE\").Range(\"BL6:BV19\")\nSet VV = Worksheets(\"SLOPE\").Range(\"SVarVol\")\n\n'Calculate and Fill R^2 Matrix as well as get dist variables\n\n\nDim out1() As Double\n    For i = 1 To 14\n        For j = 1 To 11\n            out1 = OutStat(bucket(vlive(i, j)), Range(\"SRegScale\"))\n            'MsgBox (out1(UBound(out1) - LBound(out1)) + 1)\n            Pente = slope(bucket(vlive(i, j)), Range(\"SRegScale\"))\n\n            VV(i, j) = Application.WorksheetFunction.Var_P(out1)\n            Call NewScatter_Eliot(Pente, out1)\n            rmat(i, j) = WorksheetFunction.RSq(out1, Pente) ' Is throwing Error\n            betamat(i, j) = WorksheetFunction.LinEst(out1, Pente)\n            alphamat(i, j) = WorksheetFunction.Intercept(out1, Pente) ' Is throwing Error\n            gammamat(i, j) = Pente(UBound(Pente) - LBound(Pente) + 1)\n            lout(i, j) = out1(UBound(out1) - LBound(out1) + 1)\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I am working on a VBA Macro where I regress many times . I don't know why I am getting this error when it is totally okay with Lin Est ?? and I need to fix this error. Pente is an array and out1 too, both have the same length too.</p>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 1238, "user_id": 1518474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/906e9e2286120fdd196fa5aa79087c5d?s=128&d=identicon&r=PG&f=1", "display_name": "Ruchi", "link": "https://stackoverflow.com/users/1518474/ruchi"}, "edited": false, "score": 1, "creation_date": 1502287854, "post_id": 45592966, "comment_id": 78145485, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6863940/how-to-copy-sheets-to-another-workbook-using-vba\">How to copy sheets to another workbook using vba?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1502290269, "creation_date": 1502290269, "answer_id": 45594069, "question_id": 45592966, "link": "https://stackoverflow.com/questions/45592966/how-to-copy-consecutive-sheets-in-excel-using-vba/45594069#45594069", "title": "How to copy consecutive sheets in excel using VBA", "body": "<p>Below code would suffice your requirement. Just make sure you are at the 3rd last sheet of workbook when running it.</p>\n\n<pre><code>Option Explicit\nSub copyConsecutiveSheets()\nDim x As Integer\nDim k As Integer\nDim j As Integer\nDim b As String\n\nx = 1\nk = ActiveSheet.Index\n\nThisWorkbook.Sheets(k).COPY\nFor j = 1 To 2\nb = ActiveWorkbook.Name\nThisWorkbook.Sheets(k + j).COPY After:=Workbooks(b).Worksheets(x)\nx = x + 1\nWorkbooks(b).Activate\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4945252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d6a8e56764297d754ee34b14dd726e?s=128&d=identicon&r=PG&f=1", "display_name": "Teddy", "link": "https://stackoverflow.com/users/4945252/teddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502290269, "creation_date": 1502287427, "question_id": 45592966, "link": "https://stackoverflow.com/questions/45592966/how-to-copy-consecutive-sheets-in-excel-using-vba", "title": "How to copy consecutive sheets in excel using VBA", "body": "<p>I searched multiple posts about how to copy a sheet to another workbook.  In all instances, the sheets names are known.  </p>\n\n<p>If I am on the current sheet, how can I create a vba that copy the current sheet and the next 2 consecutive sheets into a new workbook.  The sheets' names change every week, so the program needs to pick the current active sheet and the next 2 sheets only.  Thank you for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1502287817, "post_id": 45592932, "comment_id": 78145457, "body": "I don&#39;t like using the <code>Kill</code> command but just to clarify, is <code>pathname</code> a variable that holds the file name? If so, try <code>Kill(pathname)</code>"}, {"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 1, "creation_date": 1502287836, "post_id": 45592932, "comment_id": 78145471, "body": "is pathname a variable, or are you actually writing a path in your code?"}, {"owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "edited": false, "score": 0, "creation_date": 1502288025, "post_id": 45592932, "comment_id": 78145629, "body": "I have tried both. I have assigned a String variable with the path name and tried to Kill this. I have also attempted to enter the path name directly in the Kill function. It should also be noted that I&#39;ve attempted to copy working code from online forums and I still get the same error message doing that."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1502288683, "post_id": 45592932, "comment_id": 78146198, "body": "Try <code>VBA.Kill</code>. Sounds like you have a naming conflict somewhere in your code. Does <code>VBA.Kill</code> raise the same error?"}, {"owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "edited": false, "score": 0, "creation_date": 1502288806, "post_id": 45592932, "comment_id": 78146303, "body": "This also doesn&#39;t work. I&#39;ve not reverted to running the simplest macro possible"}, {"owner": {"reputation": 18440, "user_id": 2441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WcvRM.png?s=128&g=1", "display_name": "aphoria", "link": "https://stackoverflow.com/users/2441/aphoria"}, "edited": false, "score": 2, "creation_date": 1502289031, "post_id": 45592932, "comment_id": 78146507, "body": "Are you sure the error is coming from the <code>Kill</code> line?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1502289428, "post_id": 45592932, "comment_id": 78146835, "body": "And what do you mean by &quot;instantly&quot; -- are you stepping through the procedure using F8 key in the VBE debugger to see exactly what line is raising the error? Or when the error raises, enter Debug mode and see which line offends?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502289862, "post_id": 45592932, "comment_id": 78147193, "body": "Sounds stupid, but try rebooting, opening a new instance of Excel with only a blank workbook, and execute the <code>Kill</code> statement from the Immediate pane in VBE. If that doesn&#39;t work, try repairing your install of Excel, because this error strictly should never happen!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502290110, "post_id": 45592932, "comment_id": 78147386, "body": "Also curious, when you type <code>Kill </code> in the VBE, what does intellisense give you as the argument/hint? <a href=\"http://imgur.com/a/RDvEw\" rel=\"nofollow noreferrer\">imgur.com/a/RDvEw</a>"}, {"owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "edited": false, "score": 0, "creation_date": 1502290207, "post_id": 45592932, "comment_id": 78147474, "body": "I get the exact same as you do"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502290621, "post_id": 45592932, "comment_id": 78147829, "body": "Try rebooting :)  Then try repairing Excel ... that&#39;s all I got. Nothing about this code should fail in this context."}, {"owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "edited": false, "score": 0, "creation_date": 1502290755, "post_id": 45592932, "comment_id": 78147955, "body": "I&#39;ve just tried the same thing on a co-workers PC and got exactly the same result. Could it be something to do with permissions do you think?"}, {"owner": {"reputation": 18440, "user_id": 2441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WcvRM.png?s=128&g=1", "display_name": "aphoria", "link": "https://stackoverflow.com/users/2441/aphoria"}, "edited": false, "score": 0, "creation_date": 1502290829, "post_id": 45592932, "comment_id": 78148020, "body": "Is this literally all the code in your workbook?"}, {"owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "edited": false, "score": 0, "creation_date": 1502290896, "post_id": 45592932, "comment_id": 78148076, "body": "This is literally the only thing in there, yes."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "edited": false, "score": 0, "creation_date": 1502288977, "post_id": 45593491, "comment_id": 78146459, "body": "I&#39;ve tried both of these with no success. The same error keeps appearing."}, {"owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "edited": false, "score": 0, "creation_date": 1502289203, "post_id": 45593491, "comment_id": 78146648, "body": "I&#39;m now running this code in a brand new worksheet to help with finding the cause but it still arises even in a new workbook"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502289206, "post_id": 45593491, "comment_id": 78146651, "body": "I thought about the naming error but OP indicates that even explicitly calling <code>VBA.Kill</code> raises the same error..."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502289497, "post_id": 45593491, "comment_id": 78146897, "body": "I&#39;m gobsmacked, @DavidZemens. I didn&#39;t know you could essentially overwrite commands like this. I&#39;ve just created the following: <code>Function chr(f): chr = &quot;E&quot;: End Function</code> which will now completely break any use of the standard <code>Chr</code> function."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1502289555, "post_id": 45593491, "comment_id": 78146941, "body": "@CLR yep, if you do that, you have to explicitly call <code>VBA.Chr</code>, etc. :)"}, {"owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "edited": false, "score": 0, "creation_date": 1502289616, "post_id": 45593491, "comment_id": 78146994, "body": "Screenshots uploaded :)"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1502288983, "last_edit_date": 1502288983, "creation_date": 1502288786, "answer_id": 45593491, "question_id": 45592932, "link": "https://stackoverflow.com/questions/45592932/unable-to-execute-kill-function-vba-run-time-error-13/45593491#45593491", "title": "Unable to execute kill function VBA - Run-time error &#39;13&#39;", "body": "<p>Both of these should work, to delete a file from for instance, your desktop.</p>\n\n<pre><code>Sub killfile1()\n\nDim filetokill As String\nfiletokill = \"C:\\Users\\yourusername\\Desktop\\test.txt\"\nKill filetokill\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub killfile2()\n\nKill \"C:\\Users\\yourusername\\Desktop\\test.txt\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I've had an idea though.. you haven't created a FUNCTION or SUB called <code>Kill</code> have you? I just created one and it didn't disallow it:</p>\n\n<pre><code>Function kill(filename As Integer)\n\nEnd Function\n</code></pre>\n\n<p>If this is present, I get the exact same error (13) as you when running either of my example macros. Check your code for other uses of <code>Kill</code>.</p>\n"}], "owner": {"reputation": 195, "user_id": 8193302, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/24e6dda17e09d01362ad26361fee84a5?s=128&d=identicon&r=PG&f=1", "display_name": "TomB", "link": "https://stackoverflow.com/users/8193302/tomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1379, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502289739, "creation_date": 1502287347, "last_edit_date": 1531161705, "question_id": 45592932, "link": "https://stackoverflow.com/questions/45592932/unable-to-execute-kill-function-vba-run-time-error-13", "title": "Unable to execute kill function VBA - Run-time error &#39;13&#39;", "body": "<p>I'm unable to perform the Kill function using Visual Basic in Excel. When I run the code to Kill, I get </p>\n\n<blockquote>\n  <p>\"Run-time error '13' Type mismatch'</p>\n</blockquote>\n\n<p>Does anybody have any ideas? I've tried </p>\n\n<pre><code>Kill(\"pathname\")\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Kill \"pathname\"\n</code></pre>\n\n<p>I've tried different filetypes in various locations and always end up getting the same error.</p>\n\n<p>Edit-  I've now reverted to attempting the simplest of Macros and I still get the error instantly:</p>\n\n<pre><code>Sub KillFile()\n    Dim filetokill As String\n    filetokill = \"C:\\Users\\thomas.bennett\\Desktop\\test.txt\"\n    VBA.Kill filetokill\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Xs9bh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xs9bh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/qXoX9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qXoX9.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502286765, "post_id": 45592446, "comment_id": 78144574, "body": "Please provide what you have so far so that we can help"}, {"owner": {"reputation": 11, "user_id": 8440179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050567d8047ca66d1900a689f29ff58b?s=128&d=identicon&r=PG&f=1", "display_name": "user8440179", "link": "https://stackoverflow.com/users/8440179/user8440179"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502287057, "post_id": 45592446, "comment_id": 78144832, "body": "I am typing this on a separate laptop so I don&#39;t have the code here but I am using transferspreadsheet"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1502287817, "post_id": 45592446, "comment_id": 78145456, "body": "I am using transferspreadsheet  - Don&#39;t. Retrive the data from inside excel as a recordset and use range.copyfromrecordset instead. That will overwrite the contents of the cells  in your range without messing up your references"}, {"owner": {"reputation": 11, "user_id": 8440179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050567d8047ca66d1900a689f29ff58b?s=128&d=identicon&r=PG&f=1", "display_name": "user8440179", "link": "https://stackoverflow.com/users/8440179/user8440179"}, "edited": false, "score": 0, "creation_date": 1502287975, "post_id": 45592446, "comment_id": 78145595, "body": "&quot;as a recordset&quot; -- what do you mean exactly?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1502294335, "post_id": 45592446, "comment_id": 78150563, "body": "search for opening ADO recordset in vba here (sorry don&#39;t know how to put references here) to see sample code. Run the query in Excel and then use the returned recordset."}], "owner": {"reputation": 11, "user_id": 8440179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050567d8047ca66d1900a689f29ff58b?s=128&d=identicon&r=PG&f=1", "display_name": "user8440179", "link": "https://stackoverflow.com/users/8440179/user8440179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502302825, "creation_date": 1502286151, "last_edit_date": 1502302825, "question_id": 45592446, "link": "https://stackoverflow.com/questions/45592446/excel-access-how-to-export-a-querys-contents-to-a-pre-existing-sheet-without-b", "title": "Excel/Access, how to export a query&#39;s contents to a pre-existing sheet without breaking references?", "body": "<p>So I have this big Excel workbook that has several references to a sheet (in the same workbook), and this sheet has to be updated periodically from a query in an MS Access database (the code for this I am writing in MS Access VBA).</p>\n\n<p>However I don't know how to export the query to that workbook/worksheet without \"replacing\" the sheet and messing up all the references. Is there another way to do it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8439915"}, "reply_to_user": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 2, "creation_date": 1502286686, "post_id": 45592139, "comment_id": 78144519, "body": "@detall ok thank you. I added the code"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1502286687, "post_id": 45592139, "comment_id": 78144522, "body": "Specify <code>Option Explicit</code> at the top of your module, watch VBA start complaining about typos."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8439915"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502286817, "post_id": 45592139, "comment_id": 78144621, "body": "@Mat&#39;sMug thanks for the tipp. I will include this"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502287009, "post_id": 45592139, "comment_id": 78144788, "body": "Also you should avoid numbering the files yourself, and use the <code>FreeFile</code> function to let VBA give you an available file number to use... and you&#39;re not closing the files you&#39;re opening. Add a <code>Close</code> instruction before <code>End Sub</code>. I&#39;d warmly recommend you take a look at <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>, its static code analysis is quickly becoming pretty much flawless =)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8439915"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502287116, "post_id": 45592139, "comment_id": 78144880, "body": "@Mat&#39;sMug how do this work with the FreeFile function? And thanks for the Tipps with the Close function"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1502287209, "post_id": 45592139, "comment_id": 78144945, "body": "<code>Dim handle1 As Long, handle2 As Long</code>, then <code>handle1 = FreeFile</code> and <code>handle2 = FreeFile</code> - and then you <code>Open Filename For Input As #handle1</code> and you can <code>Close #handle1</code> (<code>Close</code> without a file handle closes all open files)."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502287423, "post_id": 45592139, "comment_id": 78145124, "body": "@Mat&#39;sMug nice to know, thanks for the tipp."}], "answers": [{"tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": true, "score": 1, "last_activity_date": 1502285906, "creation_date": 1502285906, "answer_id": 45592353, "question_id": 45592139, "link": "https://stackoverflow.com/questions/45592139/how-to-convert-csv-into-txt-for-matlab-import/45592353#45592353", "title": "How to Convert .csv into .txt for Matlab Import", "body": "<p>You hade a few spelling mistakes like Filnemme with to m.\nAnd you forgot to close the Files after Reading.\nAnd you didn't add the \";\" ad the and of the string if i understand you right</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub csv2mat()\n        Dim Filename As String\n        Dim Filenamenew As String\n        Dim str As String\n        'Change the path to the Files and and create a txt file\n        Filename = \"C:\\Documents and Settings\\user\\Desktop\\as.csv\"\n        Filenamenew = \"C:\\Documents and Settings\\user\\Desktop\\new.txt\"\n        Open Filenamenew For Output As #2\n        Open Filename For Input As #1\n        Do While Not EOF(1)\n            Line Input #1, str\n            str = Replace(str, \";\", \"\"\"\") &amp; \";\"\n            Print #2, str\n        Loop\n        Close #1\n        Close #2\n        End Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8439915"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 45592353, "answer_count": 1, "score": 0, "last_activity_date": 1502285906, "creation_date": 1502285412, "last_edit_date": 1531164843, "question_id": 45592139, "link": "https://stackoverflow.com/questions/45592139/how-to-convert-csv-into-txt-for-matlab-import", "title": "How to Convert .csv into .txt for Matlab Import", "body": "<p>I have a .csv file. I want to convert it into .txt file starting from line the A to the B (A, B are declared at the beginning). The .txt file supposed to have gaps \" \" instead of original semicolons. Moreover, the end of each copied row from the original .csv file should be indicated by a semicolon in the new .txt file (txt file is going to be used as an input matrix for Matlab).</p>\n\n<p>That's what I have till now, but it's not working</p>\n\n<pre><code>   Sub csv2mat()\n        Dim Filename As String\n        Dim Filenamenew As String\n        'Change the path to the Files and and create a txt file\n        Filename = \"C:\\Documents and Settings\\user\\Desktop\\as.csv\"\n        Filenamenew = \"C:\\Documents and Settings\\user\\Desktop\\new.txt\"\n        Open Filenamenew For Output As #2\n        Open Filenamme For Input As #1\n        Do While Not EOF(1)\n            Line Input #1, str\n            str = Replace(str, \";\", \"\"\"\")\n            Print #2, str\n        Loop   \n        End Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "settimeout", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1502284854, "post_id": 45591840, "comment_id": 78142871, "body": "In your case it would <code>cn.CommandTimeout=10</code> (or whatever you want to set timeout time to) since <code>cn</code> is the variable for your connection object and the <code>CommandTimeout</code> is a property of this object. Since you are using early binding, you can see all the properties of the Connection object by typing <code>.</code> after <code>cn</code>."}, {"owner": {"reputation": 55, "user_id": 6914447, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0e0d2a00a822343aa37f4f657d90c04?s=128&d=identicon&r=PG&f=1", "display_name": "Processit", "link": "https://stackoverflow.com/users/6914447/processit"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1502285461, "post_id": 45591840, "comment_id": 78143418, "body": "Perfect - thank you. Do you know how to code a button which would force a quit on the sql script if I set it to 0 and it takes too long?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1502293906, "post_id": 45591840, "comment_id": 78150310, "body": "<i>If I set it to 0 and it takes too long</i> - just set for it whatever time you feel &quot;takes too long&quot; and you&#39;re good. You can also error trap the message if you want to make it cleaner and move on without passing an error to user."}, {"owner": {"reputation": 55, "user_id": 6914447, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0e0d2a00a822343aa37f4f657d90c04?s=128&d=identicon&r=PG&f=1", "display_name": "Processit", "link": "https://stackoverflow.com/users/6914447/processit"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1502382178, "post_id": 45591840, "comment_id": 78197178, "body": "Thanks for your help. That is what I will do"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6914447, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0e0d2a00a822343aa37f4f657d90c04?s=128&d=identicon&r=PG&f=1", "display_name": "Processit", "link": "https://stackoverflow.com/users/6914447/processit"}, "edited": false, "score": 0, "creation_date": 1502382141, "post_id": 45593499, "comment_id": 78197150, "body": "Thanks that makes sense,."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 1, "last_activity_date": 1502288808, "creation_date": 1502288808, "answer_id": 45593499, "question_id": 45591840, "link": "https://stackoverflow.com/questions/45591840/timeout-on-sql-and-vb-script/45593499#45593499", "title": "Timeout on SQL and VB script", "body": "<p>In ADODB you have 2 timeouts: </p>\n\n<ol>\n<li>The Connection timeout as documented <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/connectiontimeout-property-ado\" rel=\"nofollow noreferrer\">here</a> </li>\n<li>The Command timeout as documented <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/commandtimeout-property-ado\" rel=\"nofollow noreferrer\">here</a></li>\n</ol>\n\n<p>Connection timeout triggers when trying to open the connection. \nCommand timeout when you're running the command.</p>\n\n<p>If you're receiving an error on the <code>cn.Open</code> line:\nYou should set <code>cn.ConnectionTimeout = someSeconds</code></p>\n\n<p>If you're receiving it on the <code>rs.Open</code> line:\nYou should set <code>cn.CommandTimeout = someSeconds</code></p>\n"}], "owner": {"reputation": 55, "user_id": 6914447, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d0e0d2a00a822343aa37f4f657d90c04?s=128&d=identicon&r=PG&f=1", "display_name": "Processit", "link": "https://stackoverflow.com/users/6914447/processit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502288808, "creation_date": 1502284680, "last_edit_date": 1531164843, "question_id": 45591840, "link": "https://stackoverflow.com/questions/45591840/timeout-on-sql-and-vb-script", "title": "Timeout on SQL and VB script", "body": "<p>I am trying to avoid a timeout situation happening. At present the script runs 100% on the test environment, but everything is running local. Therefore now installed on the live environment, it does take a little longer. However it would appear VB timeout default is set to 30 secs. However not being 100% familiar with VB unlike with SQL, then I am unsure on the code to set it. Current code is as follows:</p>\n\n<pre><code>Dim strFile As String\nDim strCon As String\nDim strSQL As String\nDim dateRows As Variant\nDim i As Integer\nDim today As Date\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\n\n strFile = Workbooks(1).FullName\n strCon = \"Provider=SQLOLEDB.1; Data Source=ABC;Initial    catalog=ABC;Integrated Security=ABC;\"\n\nSet cn = CreateObject(\"ADODB.Connection\")\nSet rs = CreateObject(\"ADODB.Recordset\")\n range1 = Sheets(\"Line data ( Do not alter )\").Range(\"AA9\")\n cn.Open strCon\n strSQL = \"Select \"order by userid, appointmentdate \"\n rs.Open strSQL, cn\n\n Sheets(\"Line data ( Do not alter )\").Range(\"AA9\").CopyFromRecordset rs\n\ncn.Close\nSet rs = Nothing\nSet cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>I found code which states comm.CommandTimeout=10, but unsure where to put it..</p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 4, "creation_date": 1502284515, "post_id": 45591599, "comment_id": 78142577, "body": "You&#39;ll need to use the <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/worksheet-change-event-excel\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event.  What have you tried so far?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502287218, "post_id": 45591599, "comment_id": 78144952, "body": "What have you tried? There are many ways to do it. One being <code>=IF(COUNTIF(A1:A10,B1)&gt;0,B1&amp;&quot;_&quot;,&quot;&quot;)</code>?"}, {"owner": {"reputation": 3, "user_id": 8439980, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k9ivwnzTWUU/AAAAAAAAAAI/AAAAAAAAA94/mj76WLiVDDU/photo.jpg?sz=128", "display_name": "Amr Nassar", "link": "https://stackoverflow.com/users/8439980/amr-nassar"}, "edited": false, "score": 0, "creation_date": 1502291073, "post_id": 45591599, "comment_id": 78148214, "body": "As a workaround,I added a new column and used the following formula:   =IF(ISERROR(MATCH(UPPER([@[Column name in source]]);Supplements!A:A;0));[@[Column name in source]];CONCATENATE([@[Column name in source]];&quot;_&quot;))  It does what I want, but my question is whether or not I can do it on the same column."}], "owner": {"reputation": 3, "user_id": 8439980, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k9ivwnzTWUU/AAAAAAAAAAI/AAAAAAAAA94/mj76WLiVDDU/photo.jpg?sz=128", "display_name": "Amr Nassar", "link": "https://stackoverflow.com/users/8439980/amr-nassar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502296244, "creation_date": 1502284095, "last_edit_date": 1531161705, "question_id": 45591599, "link": "https://stackoverflow.com/questions/45591599/function-to-add-string-to-an-excel-cell-upon-if-condition-on-the-same-cell", "title": "Function to add string to an excel cell upon if condition on the same cell?", "body": "<p>How can I write a formula in a cell to append an <code>_</code> to the end of the string existing in the cell, if the currently existing string matches a string in another column?</p>\n"}, {"tags": ["python", "vba", "excel", "data-structures"], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "edited": false, "score": 0, "creation_date": 1502283834, "post_id": 45591411, "comment_id": 78142027, "body": "That&#39;s a good idea, python will have no problem reading in either into a data frame or dictionary"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1502283565, "creation_date": 1502283565, "answer_id": 45591411, "question_id": 45591240, "link": "https://stackoverflow.com/questions/45591240/excel-data-to-python-via-web-service-data-structure-for-variable-data/45591411#45591411", "title": "Excel data to Python via web service, data structure for variable data", "body": "<p>I would recommend either JSON or Xml when sending data to a web service, these are the industry standards.  If chooisng JSON then you'd use nested dictionaries and then build a string (plenty of code on internet) when ready .  If using Xml then you could build up the Xml document as you go.  </p>\n\n<p>I do not know how well Python handles JSON so probably I'd opt for XML.</p>\n"}], "owner": {"reputation": 697, "user_id": 1612060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/azymj.png?s=128&g=1", "display_name": "ThatQuantDude", "link": "https://stackoverflow.com/users/1612060/thatquantdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502283565, "creation_date": 1502283148, "question_id": 45591240, "link": "https://stackoverflow.com/questions/45591240/excel-data-to-python-via-web-service-data-structure-for-variable-data", "title": "Excel data to Python via web service, data structure for variable data", "body": "<p>I have an excel spreadsheet which basically acts as an UI, it is used to let the user enter some parameters which are then passed to some python code on a server via a web service, as well as a whole tab full of data. </p>\n\n<p>I am by far no VBA expert but managed to get my data and individual variables submitted. My question is what is the best suited VBA data structure to use, ideally I would like to have something like a dictionary where the keys would be my defined Names for the Excel cells, plus the data which might for some cases will be a single value or a Variant array.</p>\n\n<p>I have to be able to distinguish between keys and their corresponding values in python eventually.</p>\n\n<p>So far I was playing around with collections</p>\n\n<pre><code>Dim Main_tab_vars As Collection\nSet Main_tab_vars = New Collection\nMain_tab_vars.Add Range(\"Start_Date\").Value, \"Start_Date_var\", \"Start_Date_var\" \nMain_tab_vars.Add Range(\"Definitions\").Value, \"Definitions_var\"\n</code></pre>\n\n<p>If I look at the collection in my watches window I can see the values correctly stored in item1 and item2. But it looks like my key information gets lost</p>\n"}, {"tags": ["c#", "ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502283940, "post_id": 45591224, "comment_id": 78142107, "body": "If you want to interact with variables inside VBA by using C#, you should read into <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/interop/how-to-access-office-onterop-objects\" rel=\"nofollow noreferrer\">Office Interop Objects</a>. This would require you to rewrite all code posted in the question, and would probably fix your error in the meantime"}], "answers": [{"comments": [{"owner": {"reputation": 10622, "user_id": 3467532, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWfq5.jpg?s=128&g=1", "display_name": "daniele3004", "link": "https://stackoverflow.com/users/3467532/daniele3004"}, "edited": false, "score": 0, "creation_date": 1502283832, "post_id": 45591333, "comment_id": 78142024, "body": "How get the parameter in Access side?"}, {"owner": {"reputation": 4659, "user_id": 856152, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8271c3ef2813f7b0c57a42a647f47adb?s=128&d=identicon&r=PG", "display_name": "Smartis", "link": "https://stackoverflow.com/users/856152/smartis"}, "reply_to_user": {"reputation": 10622, "user_id": 3467532, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWfq5.jpg?s=128&g=1", "display_name": "daniele3004", "link": "https://stackoverflow.com/users/3467532/daniele3004"}, "edited": false, "score": 0, "creation_date": 1502284062, "post_id": 45591333, "comment_id": 78142214, "body": "@daniele3004 In <code>VBA Code</code>?"}], "tags": [], "owner": {"reputation": 4659, "user_id": 856152, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8271c3ef2813f7b0c57a42a647f47adb?s=128&d=identicon&r=PG", "display_name": "Smartis", "link": "https://stackoverflow.com/users/856152/smartis"}, "is_accepted": true, "score": 2, "last_activity_date": 1502285204, "last_edit_date": 1502285204, "creation_date": 1502283378, "answer_id": 45591333, "question_id": 45591224, "link": "https://stackoverflow.com/questions/45591224/set-command-line-option-for-access-vba/45591333#45591333", "title": "Set command line Option for Access VBA", "body": "<p>You need to combine your Path to MS Access with your DB as Parameter.</p>\n\n<pre><code>string dbPath = @\"c:\\MyProgram.mdb\";\nstring pathToAccess = @\"C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\MSACCESS.EXE\";\n\nProcessStartInfo psiMDB = new ProcessStartInfo(pathToAccess);\npsiMDB.Arguments = dbPath + \" /cmd 1\";\nProcess p = Process.Start(psiMDB);\n</code></pre>\n\n<p>Also don't forget to attach <code>/cmd</code> before you put the next parameter in.</p>\n\n<hr>\n\n<p>Additional VBA Code for reading Startup Arguments</p>\n\n<pre><code>Option Compare Database\n\nDeclare Function GetCommandLine Lib \"kernel32\" Alias \"GetCommandLineW\" () As Long\nDeclare Function lstrlenW Lib \"kernel32\" (ByVal lpString As Long) As Long\nDeclare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (MyDest As Any, MySource As Any, ByVal MySize As Long)\n\nSub PrintStartupArguments()\n    MsgBox CmdLineToStr()\nEnd Sub\n\nFunction CmdLineToStr() As String\n\nDim Buffer() As Byte\nDim StrLen As Long\nDim CmdPtr As Long\n\nCmdPtr = GetCommandLine()\nIf CmdPtr &gt; 0 Then\n  StrLen = lstrlenW(CmdPtr) * 2\n  If StrLen &gt; 0 Then\n    ReDim Buffer(0 To (StrLen - 1)) As Byte\n    CopyMemory Buffer(0), ByVal CmdPtr, StrLen\n    CmdLineToStr = Buffer\n  End If\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 725, "user_id": 471200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4dcbfdaa286e7dbf0bd609e751881011?s=128&d=identicon&r=PG", "display_name": "RicardoSBA", "link": "https://stackoverflow.com/users/471200/ricardosba"}, "is_accepted": false, "score": 0, "last_activity_date": 1502283407, "creation_date": 1502283407, "answer_id": 45591346, "question_id": 45591224, "link": "https://stackoverflow.com/questions/45591224/set-command-line-option-for-access-vba/45591346#45591346", "title": "Set command line Option for Access VBA", "body": "<p>The best way should be finding the associated application to the file type and then launching it with the arguments you need (including the file to be opened).</p>\n\n<p>You can find out how to determine the default application <a href=\"https://stackoverflow.com/questions/162331/finding-the-default-application-for-opening-a-particular-file-type-on-windows\">here</a>.</p>\n"}], "owner": {"reputation": 10622, "user_id": 3467532, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWfq5.jpg?s=128&g=1", "display_name": "daniele3004", "link": "https://stackoverflow.com/users/3467532/daniele3004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 45591333, "answer_count": 2, "score": 2, "last_activity_date": 1502287368, "creation_date": 1502283121, "last_edit_date": 1502287368, "question_id": 45591224, "link": "https://stackoverflow.com/questions/45591224/set-command-line-option-for-access-vba", "title": "Set command line Option for Access VBA", "body": "<p>When I launch process from C# I use the following code:</p>\n\n<pre><code>ProcessStartInfo psi = new ProcessStartInfo(@\"C:\\MyProgram.exe\");\npsi.Arguments = \"1\";\nProcess p = Process.Start(psi);\n</code></pre>\n\n<p>It's possible to set the value of global variable in the VBA code?</p>\n\n<pre><code>ProcessStartInfo psiMDB = new ProcessStartInfo(@\"C:\\MyProgram.mdb\");\npsiMDB.Arguments = \"1\";\nProcess p = Process.Start(psiMDB);\n</code></pre>\n\n<p>If I try to set parameter I have this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OUNXb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OUNXb.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "runtime-error", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502283186, "post_id": 45590977, "comment_id": 78141482, "body": "Try qualifying your worksheets (i.e. <b><code>Dim oW as Worksheet: Set oW = Worksheets(&quot;5001 Prog&quot;)</code></b>). Then use <code>oW.Range...</code>. When you get to the line that throws the error, check <code>oW</code> state and values for your variables. Also, use <code>Option Explicit</code>.. it will help to eliminate undefined variable issues"}, {"owner": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502290676, "post_id": 45590977, "comment_id": 78147876, "body": "If you don&#39;t mind, how do you check the state and values, what do you mean?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502291358, "post_id": 45590977, "comment_id": 78148446, "body": "Qualify you worksheets like this (presuming that your worksheets are in the same workbook): <code>Dim oProg As Worksheet: Set oProg = Thisworkbook.Worksheet(&quot;5001 Prog&quot;)</code>. <code>Dim oDL as Worksheet: Set oDL = Thisworkbook.Worksheet(&quot;Drill Log&quot;)</code>. Now Replace all <b>Worksheets(&quot;5001 Prog&quot;) with oProg and Worksheets(&quot;Drill Log&quot;) with oDL</b>. When you get to the statement that throws the error, right click on <code>oProg</code> and add it to the watch window (do same for <code>oDL</code>). In watch window, check if its an object. Do the same with your variables (add to watch window) and check their values"}], "owner": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502282442, "creation_date": 1502282442, "last_edit_date": 1531161705, "question_id": 45590977, "link": "https://stackoverflow.com/questions/45590977/error-1004-in-excel-vba-but-occasionally-works-fine", "title": "Error &#39;1004&#39; in excel VBA, but occasionally works fine", "body": "<p>I keep getting a </p>\n\n<p>\"Run-time error '1004' \n Application- defined or object defined error.\" </p>\n\n<p>in reference to these lines.</p>\n\n<pre><code>Worksheets(\"5001 Prog\").Range(\"C12\").Value = (y &amp; \"'' Ream\")\n\nWorksheets(\"5001 Prog\").Range(\"D12\").Value = count * 31.5\n\nWorksheets(\"5001 Prog\").Range(\"E12\").Value = daily * 31.5\n</code></pre>\n\n<p>The thing is this code was working before I closed the file and reopened. Also, if I rearrange the lines sometimes they work. I tried changing the \"count\" and \"daily\" variables to equal \"12\" then have them processed in the above code and it still returned the error. </p>\n\n<p>I have looked at multiple answers for this error code, and have tried multiple things mentioned in those posts, but nothing worked. I appreciate all feedback, thank you.</p>\n\n<p>p.s. I am aware that the code in the \"If\" statement is crap, I'm still working on it. but the code did work in the state that the \"if\" statement is in now. </p>\n\n<pre><code>Sub Update_Last()\n\nWorksheets(\"5001 Prog\").Unprotect \"Welcome1\"\nWorksheets(\"Drill Log\").Unprotect \"Welcome1\"\n\nDim w As Integer\nDim x As Integer\nDim y As Integer\nDim z As String\n\n    w = 39\n    x = Worksheets(\"Drill Log\").Range(\"E39\").Value\n    y = Worksheets(\"Drill Log\").Range(\"E39\").Value\n    z = Worksheets(\"Drill Log\").Range(\"D39\").Value\n\nIf z = Worksheets(\"Variables\").Range(\"H10\").Value Then\n\n     Do Until Not x = y\n\n\n            y = Worksheets(\"Drill Log\").Range(\"E\" &amp; w).Value\n\n            w = w + 1\n\n            z = Worksheets(\"Drill Log\").Range(\"D\" &amp; w).Value\n        Loop\nElseIf z = Worksheets(\"Variables\").Range(\"H14\").Value Then\n\n    Do Until Not x = y\n\n\n            y = Worksheets(\"Drill Log\").Range(\"E\" &amp; w).Value\n\n            w = w + 1\n\n            z = Worksheets(\"Drill Log\").Range(\"D\" &amp; w).Value\n        Loop\n\n\nElse\n\n            w = w + 1\n            z = Worksheets(\"Drill Log\").Range(\"D\" &amp; w).Value\n\n\nEnd If\n\n\nDim count As Integer\n    count = Application.WorksheetFunction.CountIfs(Worksheets(\"Drill Log\").Range(\"Drill_Log[Pass Type]\"), \"Ream\", Worksheets(\"Drill Log\").Range(\"Drill_Log[Size]\"), y)\n\n\nDim daily As Integer\n    daily = Application.WorksheetFunction.CountIfs(Worksheets(\"Drill Log\").Range(\"Drill_Log[Pass Type]\"), \"Ream\", Worksheets(\"Drill Log\").Range(\"Drill_Log[Size]\"), y, Worksheets(\"Drill Log\").Range(\"Drill_Log[Foreman]\"), Worksheets(\"5001 Prog\").Range(\"B5\").Value, Worksheets(\"Drill Log\").Range(\"Drill_Log[Date]\"), Worksheets(\"5001 Prog\").Range(\"E4\").Value)\n\n\nWorksheets(\"5001 Prog\").Range(\"C12\").Value = (y &amp; \"'' Ream\")\n\nWorksheets(\"5001 Prog\").Range(\"D12\").Value = count * 31.5\n\nWorksheets(\"5001 Prog\").Range(\"E12\").Value = daily * 31.5\n\n\n\nWorksheets(\"5001 Prog\").Protect \"Welcome1\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1502282419, "post_id": 45590918, "comment_id": 78140831, "body": "most likely you are missing the &quot;\\&quot; seperator between <code>ThisWorkbook.Path</code> and the File name"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1502283179, "post_id": 45590918, "comment_id": 78141478, "body": "What @ShaiRado said. Once you resolve that: <code>Sheets()</code> implicitly references the <code>ActiveWorkbook</code>. The moment you execute <code>Workbooks.Open</code> the newly opened workbook becomes the <code>ActiveWorkbook</code>. Read <a href=\"https://stackoverflow.com/documentation/excel-vba/1576/common-mistakes/5110/qualifying-references\">here</a> for more info. You can also avoid a lot of the issues by reading <a href=\"https://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate\">this</a>. Read quickly, sadly documentation is going away."}, {"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1502286573, "post_id": 45590918, "comment_id": 78144412, "body": "@FreeMan - I know my coding is not as elegant as it should but I am beginner in VBA. The improvements will come next for sure! Thanks! ;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1502286843, "post_id": 45590918, "comment_id": 78144640, "body": "@FreeMan note that <a href=\"https://meta.stackoverflow.com/questions/354217/sunsetting-documentation\">SO is sunsetting documentation</a>; these links will eventually die ;-)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1502287006, "post_id": 45590918, "comment_id": 78144786, "body": "@Mat&#39;sMug - hence <i>Read quickly, sadly documentation is going away.</i> :)"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1502287359, "post_id": 45590918, "comment_id": 78145071, "body": "@FreeMan <a href=\"https://web.archive.org/web/20170809140122/https://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate#t=201708091401221764826\" rel=\"nofollow noreferrer\">archived!</a>"}, {"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1502344739, "post_id": 45590918, "comment_id": 78169867, "body": "@Shai Rado - I did what you porposed but now another issue appeared (plese refer to the updated post of mine, review and advise on it)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1502347851, "post_id": 45590918, "comment_id": 78171518, "body": "@VSE see my answer and code below (I have some questions for you, they are in the code as comments)"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502349561, "post_id": 45606422, "comment_id": 78172629, "body": "About Sheet2 - It is the Sheet2 (Report), according to the VBA Project Objects, in the new opened file which the coding tried to find in the same directory.  About pasting - once I copy the cells from the new opend file, I want to go back to ThisWorkbook, where the macro is located, and to paste the selection in another sheet within the initial excel file (ThisWorkbook). About the &quot;Loop&quot; &amp; &quot;sDir = Dir$&quot; - sorry, I didn&#39;t erase it. It left in the code from my previous tries. Please ignore it!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502349677, "post_id": 45606422, "comment_id": 78172717, "body": "@VSE so what happens when you try the edoted code ? (just edited it)"}, {"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502350414, "post_id": 45606422, "comment_id": 78173203, "body": "@ Shai Rado - when I run the code, you proposed, this message appears: Object doesn&#39;t support this property or method (Error 438)."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502350495, "post_id": 45606422, "comment_id": 78173251, "body": "@VSE without telling me at what line are you getting this error, there is almost nothing I can do"}, {"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502351099, "post_id": 45606422, "comment_id": 78173584, "body": "@ Shai Rado  &quot;oWB.Sheet2.Range(&quot;B27:B30&quot;).Copy&#39; - after it is read"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502351261, "post_id": 45606422, "comment_id": 78173688, "body": "@VSE  but this code doesn&#39;t exist anymore, see edited code"}, {"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502353057, "post_id": 45606422, "comment_id": 78174839, "body": "@ Shai Rado - After revising your solution it works but now I cannot go back to the initial file (ThisWorkbook) and to paste the copied cells as transposed values."}, {"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1502353116, "post_id": 45606422, "comment_id": 78174875, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/151578/discussion-between-vse-and-shai-rado\">continue this discussion in chat</a>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502354911, "post_id": 45606422, "comment_id": 78176124, "body": "@VSE see edited code, let me know if you need further help (I think I halped you with your post, now it&#39;s &quot;extras&quot; )"}, {"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502355613, "post_id": 45606422, "comment_id": 78176640, "body": "I agrre with you totlly that there are some ad hoc/extra doubts. I accep your solution fully. Bu final question related to &#39;Range(&quot;C1&quot;)&quot; where I am pasting the selected - if I want to keep the same row where the macro stoped (and execute the steps for searching file, finding file, coping cells) but to go to Column N (or  Offset(,-11) - how to persorm that action?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1502355749, "post_id": 45606422, "comment_id": 78176761, "body": "@VSE  open a new post, add our latest code, and describe what is not working, and me (and others) will gladly assist"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1502354828, "last_edit_date": 1502354828, "creation_date": 1502347817, "answer_id": 45606422, "question_id": 45590918, "link": "https://stackoverflow.com/questions/45590918/excel-2013-cannot-find-and-open-the-file-in-thisworkbook-directory/45606422#45606422", "title": "Excel 2013 cannot find and open the file in ThisWorkbook directory", "body": "<p>Try the code below, I have my explanation and questions for you in the code (as commnets):</p>\n\n<pre><code>Option Explicit\n\nSub FileFinder()\n\n' Excel variables:\nDim wbResults As Workbook\nDim oWB As Workbook\nDim Sht As Worksheet\nDim RngS As Range\nDim sDir As String\n\nDim LastRow As Long\nDim i As Long, Col As Long\n\nCol = 25\n\n' set ThisWorkbook object\nSet wbResults = ThisWorkbook\n\n' set the worksheet object\nSet Sht = Worksheets(\"Accounts source data\")\nWith Sht\n    ' find last row with data in Column \"Y\" (Col = 25)\n    LastRow = .Cells(.Rows.Count, 25).End(xlUp).Row\n\n    For i = 3 To LastRow\n        If .Cells(i, Col) = \"In scope\" Then\n            ' Set the range directly, no need to use `Select` and `Selection`\n            Set RngS = .Cells(i, Col).Offset(, -22)\n\n            ' Search, in same directory where the file is located, the file with that account (file comes with account number as name)\n            sDir = Dir$(ThisWorkbook.Path &amp; \"\\\" &amp; RngS.Value &amp; \".xlsx\", vbNormal)\n            Set oWB = Workbooks.Open(ThisWorkbook.Path &amp; \"\\\" &amp; sDir)\n\n            oWB.Worksheets(\"Report\").Range(\"B27:B30\").Copy\n\n            ' *** Paste in ThisWorkbook, in my exmaple \"Sheet2\" &lt;-- modify to your needs\n            wbResults.Worksheets(\"Sheet2\").Range(\"C1\").PasteSpecial Paste:=xlPasteAll, Transpose:=True\n\n            oWB.Close SaveChanges:=False\n'            sDir = Dir$\n\n            ' clear objects\n            Set RngS = Nothing\n            Set oWB = Nothing\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 45606422, "answer_count": 1, "score": 2, "last_activity_date": 1502354828, "creation_date": 1502282298, "last_edit_date": 1502349189, "question_id": 45590918, "link": "https://stackoverflow.com/questions/45590918/excel-2013-cannot-find-and-open-the-file-in-thisworkbook-directory", "title": "Excel 2013 cannot find and open the file in ThisWorkbook directory", "body": "<p>The following issue occured to me. I use MS Excel 2013.</p>\n\n<p>With the macro below I tried to find those accounts (which meets the criteria \"In scope\", e.g. account 12345678), to copy them, to search in the same folder (where ThisWorkbook is), to find another excel file which has as name the number of account (e.g. \"12345678.xlsx\") and to open it.</p>\n\n<p>After the proposed corrections below, my macro finds and opens the desired file. But now the problem is that no actions can be performed on it: copy, paste, etc.</p>\n\n<p>Could you please help on this? </p>\n\n<pre><code>Sub FileFinder()\n\n'Excel variables:\nDim RngS As Excel.Range\nDim wbResults As Workbook\n\n'Go to the column with specific text\nWorksheets(\"Accounts source data\").Activate\nX = 3\nY = 25\nWhile Not IsEmpty(Sheets(\"Accounts source data\").Cells(X, Y))\n    Sheets(\"Accounts source data\").Cells(X, Y).Select\n    If ActiveCell = \"In scope\" Then\n        Sheets(\"Accounts source data\").Cells(X, Y - 22).Select\n        'Copy the account in scope\n        Set RngS = Selection\n        Selection.Copy\n        'Search, in same directory where the file is located, the file with that account (file comes with account number as name)\n\n        sDir = Dir$(ThisWorkbook.Path &amp; \"\\\" &amp; RngS &amp; \".xlsx\", vbNormal)\n        Set oWB = Workbooks.Open(ThisWorkbook.Path &amp; \"\\\" &amp; sDir)\n        'Here is where my error occurs \n        '[Run-time error 5: Invalid procedure call or argument]\n        Sheet2.Cells(\"B27:B30\").Copy\n        oWB.Close\n        End If\n    X = X + 1\nWend\n\nEnd Sub   \n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "owner": {"reputation": 11, "user_id": 8424333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee5efcee3ac6b852c9ed212d97f3b1b?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertJohnson", "link": "https://stackoverflow.com/users/8424333/albertjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502318606, "creation_date": 1502281905, "last_edit_date": 1502318606, "question_id": 45590805, "link": "https://stackoverflow.com/questions/45590805/convert-table-to-text-and-match-color-of-separator", "title": "convert table to text and match color of separator", "body": "<p>I have a large table where each cell has a single word that is colored. I want to convert this table to text so I can then perform other functions on it.</p>\n\n<p>The problem is that the separators Word puts in are a default color, so my resulting text will be (blue text)(black separator)(green text)(black separator)(yellow text) and so on.</p>\n\n<p>Is there a way to find/replace each separator with a separator of the same color as the preceeding or following word?</p>\n\n<p>Here is what I have currently:</p>\n\n<pre><code>Sub PrepareTable()\n\nWith Selection\n.WholeStory\n.PasteExcelTable False, False, False\n.Tables.Item(1).Columns(1).Delete\n.Tables(1).Range.Select\n.Rows.ConvertToText Separator:=wdSeparateByDefaultListSeparator, _\n    NestedTables:=True\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502281881, "post_id": 45590790, "comment_id": 78140396, "body": "What code have you tried?"}, {"owner": {"reputation": 11, "user_id": 8439795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980fc1cb7c051461cb156e51051499ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal Ahmed Khalid", "link": "https://stackoverflow.com/users/8439795/bilal-ahmed-khalid"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502282154, "post_id": 45590790, "comment_id": 78140615, "body": "I found many codes. They were mostly focused on a data set within a given sheet or the same data set within multiple sheets. However I could not find anything that would search a specific cell in every sheet and club cells with the same name together into a new sheet with a defined syntax. I have also created a table as follows that might help with a code whereby the code can search the sheets listed in the row and put them into the corresponding file name."}, {"owner": {"reputation": 11, "user_id": 8439795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980fc1cb7c051461cb156e51051499ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal Ahmed Khalid", "link": "https://stackoverflow.com/users/8439795/bilal-ahmed-khalid"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502282166, "post_id": 45590790, "comment_id": 78140624, "body": "The file name formulae is File Name Formulae:  TEXT(NOW(),&quot;YYYYMM&quot;)&amp;&quot; &quot;&amp;B3&amp;&quot; &quot;&amp;C3&amp;&quot;.xlsx&quot;"}, {"owner": {"reputation": 11, "user_id": 8439795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980fc1cb7c051461cb156e51051499ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal Ahmed Khalid", "link": "https://stackoverflow.com/users/8439795/bilal-ahmed-khalid"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502282186, "post_id": 45590790, "comment_id": 78140640, "body": "and the sheets should be arranged thus:"}, {"owner": {"reputation": 11, "user_id": 8439795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980fc1cb7c051461cb156e51051499ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal Ahmed Khalid", "link": "https://stackoverflow.com/users/8439795/bilal-ahmed-khalid"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502282190, "post_id": 45590790, "comment_id": 78140645, "body": "File Name to be used\tShWWt 1\tShWWt 2 201708 W12341170 XZ FU RWviWw Dashboard 2017.xlsx\tW12341170 PL\tW12341170 BS 201708 W12341171 XZ FU RWviWw Dashboard 2017.xlsx\tW12341171 PL\tW12341171 BS 201708 W12341172 XZ FU RWviWw Dashboard 2017.xlsx\tW12341172 PL\tW12341172 BS 201708 W12341173 XZ FU RWviWw Dashboard 2017.xlsx\tW12341173 PL\tW12341173 BS 201708 W12341174 XZ FU RWviWw Dashboard 2017.xlsx\tW12341174 PL\tW12341174 BS 201708 W12341175 XZ FU RWviWw Dashboard 2017.xlsx\tW12341175 PL\tW12341175 BS 201708 W12341176 XZ FU RWviWw Dashboard 2017.xlsx\tW12341176 PL\tW12341176 BS"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502282433, "post_id": 45590790, "comment_id": 78140839, "body": "Why do you not just write your own code then? Coding isnt about &quot;finding&quot;, it&#39;s about &quot;writing&quot;."}, {"owner": {"reputation": 11, "user_id": 8439795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980fc1cb7c051461cb156e51051499ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal Ahmed Khalid", "link": "https://stackoverflow.com/users/8439795/bilal-ahmed-khalid"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502286503, "post_id": 45590790, "comment_id": 78144345, "body": ":(.... I&#39;m an accountant and not a programmer. I would love to learn VBA but this is like learning a whole new langauge. I don&#39;t even know where to begin."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502290508, "post_id": 45590790, "comment_id": 78147717, "body": "The best place to begin is by using the Macro recorder built-in to Excel. Turn it on and do what you want manually, and stop it when you are done. It writes the code for you, and then you can tweak it or paste the results here and ask questions about it."}], "owner": {"reputation": 11, "user_id": 8439795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980fc1cb7c051461cb156e51051499ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal Ahmed Khalid", "link": "https://stackoverflow.com/users/8439795/bilal-ahmed-khalid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502281856, "creation_date": 1502281856, "question_id": 45590790, "link": "https://stackoverflow.com/questions/45590790/splitting-excel-sheets-not-copy-paste-data-range-into-separate-workbooks-with", "title": "Splitting excel sheets (Not copy paste data range) into separate workbooks with a certain name", "body": "<p>I have a workbook with multiple sheets that have a name in column AA3 which might match in 2 or more sheets. The macro needs to search these cells and club all sheets with a similar name in AA3 and then make a new workbook out of them using the same name.</p>\n\n<p>Please advise a solution.</p>\n"}, {"tags": ["excel", "vba", "attachmate-reflection"], "comments": [{"owner": {"reputation": 81, "user_id": 2466447, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a92393ff4548e030454b34387faef182?s=128&d=identicon&r=PG", "display_name": "Maruthi", "link": "https://stackoverflow.com/users/2466447/maruthi"}, "edited": false, "score": 1, "creation_date": 1502462436, "post_id": 45590634, "comment_id": 78235105, "body": "<code>Set pApp = GetObject(&quot;Reflection Workspace&quot;)       Set pFrame = pApp.GetObject(&quot;Frame&quot;)       pFrame.Visible = True       Set pView = pFrame.GetViewByTitleText(&quot;r5250.rd5x&quot;)       Set pTerminal = pView.Control       Set pScreen = pTerminal.Screen       pView.Focus</code>"}, {"owner": {"reputation": 81, "user_id": 2466447, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a92393ff4548e030454b34387faef182?s=128&d=identicon&r=PG", "display_name": "Maruthi", "link": "https://stackoverflow.com/users/2466447/maruthi"}, "edited": false, "score": 0, "creation_date": 1502462501, "post_id": 45590634, "comment_id": 78235147, "body": "Just in case anyone wants to refer, the above solution works good.."}], "owner": {"reputation": 81, "user_id": 2466447, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a92393ff4548e030454b34387faef182?s=128&d=identicon&r=PG", "display_name": "Maruthi", "link": "https://stackoverflow.com/users/2466447/maruthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1537, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593706698, "creation_date": 1502281422, "last_edit_date": 1593706698, "question_id": 45590634, "link": "https://stackoverflow.com/questions/45590634/attachmate-reflections-from-excel-vba", "title": "Attachmate Reflections from Excel VBA", "body": "<p>I have been trying to automate Reflections from an Excel macro, code as below. However, there are 2 sessions open, i have attached screenshot of same for reference. Can anyone please help me how i can switch between the already running sessions.   <a href=\"https://i.stack.imgur.com/SM4I4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SM4I4.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>    Public objFM As Object\n    Set objFM = GetObject(\"RIBM\")  With objFM\n      .WaitForEvent rcEnterPos, \"30\", \"0\", 4, 41\n      .WaitForDisplayString \"code:\", \"30\", 4, 34\n      .TransmitTerminalKey rcIBMResetKey\n      .TransmitANSI \"MTAE\"\n      .TransmitTerminalKey rcIBMEnterKey\n      .WaitForEvent rcKbdEnabled, \"30\", \"0\", 1, 1\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "iframe", "ie-automation"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1529439225, "creation_date": 1529439225, "answer_id": 50936258, "question_id": 45590500, "link": "https://stackoverflow.com/questions/45590500/vba-code-to-trigger-an-iframe-div-class-element/50936258#50936258", "title": "VBA code to trigger an iframe div class element", "body": "<p>Try</p>\n\n<pre><code>doc1 = IE.document.frames(1).Name\nIE.document.frames(doc1).document.getElementId(\"cat-title IDHAA5V0GQBL2AN3HRTMFOSP0OLB90\").Click\n</code></pre>\n\n<p>The element has an id so try using it.</p>\n"}], "owner": {"reputation": 11, "user_id": 8437897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xn4Fu.png?s=128&g=1", "display_name": "Karthik J", "link": "https://stackoverflow.com/users/8437897/karthik-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 528, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1529439225, "creation_date": 1502281063, "last_edit_date": 1531164843, "question_id": 45590500, "link": "https://stackoverflow.com/questions/45590500/vba-code-to-trigger-an-iframe-div-class-element", "title": "VBA code to trigger an iframe div class element", "body": "<p>Please help me with the below IE automation scenario,</p>\n\n<p>I need a vba code to click on a web page label text (Log an Issue) which has been placed inside an iframe, the sample html code is given below,</p>\n\n<pre><code>&lt;iframe name=\"VF304274040_1502270092884IF_1\" title=\"Browse Categories\" id=\"VF304274040_1502270092884IF_1\" src=\"javascript:\"&lt;HTML&gt;&lt;/HTML&gt;\"\" frameBorder=\"0\" scrolling=\"auto\" style=\"background-color: transparent; width: 100%; height: 100%; top: 0px; left: 0px;\" allowTransparency=\"allowtransparency\" onload=\"F(1,304274040).ol()\" arviewbordercolor=\"null\"&gt;\n&lt;head&gt;XXXX\n&lt;body&gt;XXXX\n&lt;div id XXXX&gt;\n.............\n&lt;div id XXXX&gt;\n......\n     &lt;div&gt;\n          &lt;div class=\"categoryTitleLink\"&gt;\n          &lt;label class=\"cursor bold category_title\" id=\"cat-title IDHAA5V0GQBL2AN3HRTMFOSP0OLB90\" level=\"0\" category=\"true\" categoryname=\"Log+an+Issue\" descr=\"#IDHAA5V0GQBL2AN3HRTMFOSP0OLB90\" jQuery15019202206560111384=\"9\"&gt;\n            ....Text - Log an Issue\n&lt;/body&gt;&lt;/head&gt;\n</code></pre>\n\n<p>I've tried the below vba code to parse through the iframe and it's div class inner texts and found the \"Log an Issue\" element, but i couldn't trigger it.</p>\n\n<p>VBA code:</p>\n\n<pre><code>doc1 = IE.document.frames(1).Name\nFor Each div In IE.document.frames(doc1).document.getElementsByTagName(\"div\")\n        class_obj = div.innerText\n        If class_obj = \"Log an Issue\" Then ' the text was found by this loop\n            div.parentElement.Click ' this doesn't works (nothing happening)\n        End If\nNext div\n</code></pre>\n\n<p>Please help!!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "edited": false, "score": 0, "creation_date": 1502283258, "post_id": 45591007, "comment_id": 78141543, "body": "This seems like its heading in the right direction for me. The else function is where I would switch to a new sheet and past in the row data. Rather than copying and pasting in the ref2 array into a new sheet, would there be anyway way it could have an automatic live feed from the source? EDIT: The ref2 is just a structure to help filter out for unique parts?"}, {"owner": {"reputation": 261, "user_id": 8218934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uu1lp.jpg?s=128&g=1", "display_name": "Diveye", "link": "https://stackoverflow.com/users/8218934/diveye"}, "reply_to_user": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "edited": false, "score": 0, "creation_date": 1502284286, "post_id": 45591007, "comment_id": 78142397, "body": "I added the for loop that should allow you to paste into the new sheet. This might need a bit of tweeking as I did not get around to testing it. If you need to do array re-arrangement you can easily do it with ref2 before exporting the values to the the new sheet. For the automatic live feed, you need to call the sub in which you have written this code everytime a modification is applied to your source sheet. Just look for the moment where these modifications are brought about, and call this sub at that moment to apply the changes also to your new sheet."}, {"owner": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "edited": false, "score": 0, "creation_date": 1502287862, "post_id": 45591007, "comment_id": 78145496, "body": "After messing around with your code,  I was wondering how you would fix the for loop for indexing to find unique values. When you place the data into an array, it becomes a 2D array . With that, the index coordinates for values would probably change once you put the original value into ref1. I&#39;m kind of at a loss with how to really create the parameters to iterate through ref1."}, {"owner": {"reputation": 261, "user_id": 8218934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uu1lp.jpg?s=128&g=1", "display_name": "Diveye", "link": "https://stackoverflow.com/users/8218934/diveye"}, "reply_to_user": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "edited": false, "score": 0, "creation_date": 1502350003, "post_id": 45591007, "comment_id": 78172935, "body": "Normally when you put your values in ref1, if, for example, you have a file of 10 rows and 5 columns, and you want to select the values from the 5th column on all the rows, you could loop for it with:  <code>for index = 1 to 10 &#39;first row to last row</code>     <code>uniquevalues = ref1(index, 5)</code> <code>next index</code>  This should only select the values from the 5th column. All you have to do is find the column number corresponding to the unique values and that should do it. Also I made a mistake in my code last night so I modified it (in the first for loop)"}], "tags": [], "owner": {"reputation": 261, "user_id": 8218934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uu1lp.jpg?s=128&g=1", "display_name": "Diveye", "link": "https://stackoverflow.com/users/8218934/diveye"}, "is_accepted": true, "score": 0, "last_activity_date": 1502350044, "last_edit_date": 1502350044, "creation_date": 1502282517, "answer_id": 45591007, "question_id": 45590294, "link": "https://stackoverflow.com/questions/45590294/making-an-associative-table-of-unique-identifiers/45591007#45591007", "title": "Making an Associative Table of Unique Identifiers", "body": "<p>You've had the right reflex tyring to define an array to stock your values. Here are a few tips of how I would get around to doing it (not perfect, but it should help you out):</p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n   IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n\nDim Source as Worksheets\nSet Source = Worksheets(\"Part Tracking Scoreboard\")\nDim ref1(), ref2() As Variant\nDim row, index, index2 As Integer\n\nrow = 92\n\nref1 = Source.Range(Worksheets(Source.Cells(row,1), Source.Cells(lastrow, last column))\n'Start by placing your ENTIRE source sheet in ref1, if your source sheet is big, this will help you win A LOT of time during the looping phase. Notice how I start from row 92 seeing as this is where you started your loop\n'lastrow and lastcolumn represent the position of the last cell in your source file\n\nFor index = row to lastrow\n    If Not IsInArray(ref1(row, 6).Value, ref2) Then  \n        ref2(index) = ref1(index) 'copy the entire row from source to ref2\nNext index\n\nDim NewFile as Worksheet\nSet Newfile = Sheets(\"NewSheetName\")\n\nDim ref2dimension_x, ref2dimension_y as Integer 'find dimensions of ref2 array\nref2dimension_x= UBound(ref2, 1) - LBound(ref2, 1) + 1\nref2dimension_y = UBound(ref2, 2) - LBound(ref2, 2) + 1\n\nFor index = 2 to ref2dimension_x 'go through entire new sheet and set values\n    For index2 = 1 to ref2dimension_y\n        NewFile.Cells(index, index2).Value = ref2(index - 1, index2)\n    Next index2\nNext index\n\nref1() = nothing\nref2() = nothing 'free up the space occupied by these arrays\n</code></pre>\n\n<p>I was not sure about what you were trying to do exactly during the else loop. If you intention is to copy the entire row, this should work. If you want to copy only specific data from the source sheet, you will need to find the indexes of the corresponding columns (hardcode them if they are not going to budge, or use a loop to find them through string comparison otherwise). </p>\n"}, {"tags": [], "owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "is_accepted": false, "score": 0, "last_activity_date": 1502303796, "creation_date": 1502303796, "answer_id": 45598297, "question_id": 45590294, "link": "https://stackoverflow.com/questions/45590294/making-an-associative-table-of-unique-identifiers/45598297#45598297", "title": "Making an Associative Table of Unique Identifiers", "body": "<p>This solution combines some macros that I use frequently (so even if you don't use them now, they might be helpful in the future). It won't work if the data in the unique table needs to be \"live\", but if it'd be sufficient for it to be updated whenever the workbook is opened/closed (or on demand), this is a lot less complicated than the array version.</p>\n\n<p>Basically you just: </p>\n\n<ul>\n<li>Copy the main/unduplicated table to a new sheet</li>\n<li>Remove duplicates by part number</li>\n<li>Remove unnecessary columns from unduplicated table (if applicable)</li>\n</ul>\n\n<p>I'm assuming that your source data is in a formal Excel Table (ListObject). Just swap out \"PartTable\" for whatever your actual table is called.</p>\n\n<pre><code>Sub makeUniqueTable()\n\n    Application.ScreenUpdating = False\n\n    Dim MainWS As Worksheet\n    Set MainWS = ThisWorkbook.Sheets(\"Part Tracking Scorecard\")\n\n    Dim UniqueWS As Worksheet\n    Set UniqueWS = ThisWorkbook.Sheets(\"Unique Parts\")\n\n    UniqueWS.Cells.Clear\n\n    Call cloneTable(MainWS.ListObjects(\"PartTable\"), \"UniquePartTable\", UniqueWS)\n\n    Dim UniquePartTable As ListObject\n    Set UniquePartTable = UniqueWS.ListObjects(\"UniquePartTable\")\n\n    Call removeDuplicates(UniquePartTable, \"Part Number\")\n\n    'Optional: remove unnecessary columns by listing columns to be deleted...\n    'Call deleteColumns(UniquePartTable, Array(\"Unnecessary Column 1\", \"Unnecessary Column 2\"))\n    '...or kept:\n    'Call deleteColumns(UniquePartTable, Array(\"Part Number\", \"Manufacturer\", \"Product Description\"), True)\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nSub cloneTable(tbl As ListObject, newName As String, Optional newWS As Worksheet = Nothing)\n'Copies a table (tbl) to a new worksheet (newWS) and gives it a name (newName)\n'If there is any data in newWS, the new table will be added to the right of the used range\n'If newWS is omitted, new table will be added to same worksheet as original table\n\n    Dim ws As Worksheet\n    Dim lastColumn As Long\n    Dim newRng As Range\n    Dim newTbl As ListObject\n\n    If newWS Is Nothing Then\n        Set ws = tbl.Parent\n        lastColumn = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\n        Set newRng = ws.Range(ws.Cells(1, lastColumn + 2), ws.Cells(1 + tbl.ListRows.Count, lastColumn + tbl.ListColumns.Count + 1))\n    Else\n        Set ws = newWS\n        If ws.ListObjects.Count &gt; 0 Then\n            lastColumn = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\n            Set newRng = ws.Range(ws.Cells(1, lastColumn + 2), ws.Cells(1 + tbl.ListRows.Count, lastColumn + tbl.ListColumns.Count + 1))\n        Else\n            Set newRng = ws.Range(ws.Cells(1, 1), ws.Cells(1 + tbl.ListRows.Count, tbl.ListColumns.Count))\n        End If\n    End If\n\n    tbl.Range.Copy\n    newRng.PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n    Application.CutCopyMode = False\n\n    Set newTbl = ws.ListObjects.Add(xlSrcRange, newRng, , xlYes)\n    newTbl.Name = newName\n\nEnd Sub\nSub removeDuplicates(tbl As ListObject, Optional colName As Variant = \"\")\n'Removes duplicates from a table (tbl) based on column header names (colName()) provided by user\n'If no column names are provided, duplicates will be removed based on all columns in table\n\n    Dim i As Long\n    Dim j As Long\n\n    If Not IsArray(colName) Then\n        If colName = \"\" Then\n            ReDim colNumArr(0 To tbl.ListColumns.Count - 1) As Variant\n            For i = 0 To tbl.ListColumns.Count - 1\n                colNumArr(i) = tbl.ListColumns(i + 1).Range.Column\n            Next\n        Else\n            ReDim colNumArr(0 To 0) As Variant\n            colNumArr(0) = tbl.ListColumns(colName).Range.Column\n        End If\n    Else\n        ReDim colNumArr(0 To UBound(colName) - LBound(colName)) As Variant\n        j = 0\n        For i = LBound(colName) To UBound(colName)\n            colNumArr(j) = tbl.ListColumns(colName(i)).Range.Column\n            j = j + 1\n        Next\n    End If\n\n    tbl.Range.removeDuplicates Columns:=(colNumArr), Header:=xlYes\n\nEnd Sub\nSub deleteColumns(tbl As ListObject, ByVal colName As Variant, Optional invert As Boolean = False, Optional sheetCol As Boolean = True)\n'Deletes column(s) from sheet based on header names (colName) from a table (tbl)\n'Will result in error if provided column contains multiple tables\n'colName can be a String or an array of Strings\n'Inverted mode deletes all columns *except* those in colName\n\n    Dim i As Long\n    Dim j As Long\n    Dim x As Boolean\n\n    If Not IsArray(colName) Then\n        tempStr = colName\n        ReDim colName(1 To 1) As String\n        colName(1) = tempStr\n    End If\n\n    If invert = False Then\n        For i = LBound(colName) To UBound(colName)\n            If sheetCol = True Then\n                tbl.Parent.Columns(tbl.ListColumns(colName(i)).Range.Column).Delete\n            Else\n                tbl.ListColumns(colName(i)).Delete\n            End If\n        Next\n    Else\n        For i = tbl.ListColumns.Count To 1 Step -1\n            x = False\n            For j = LBound(colName) To UBound(colName)\n                If tbl.HeaderRowRange(i).Value = colName(j) Then\n                    x = True\n                    Exit For\n                End If\n            Next\n            If x = False Then\n                If sheetCol = True Then\n                    tbl.Parent.Columns(tbl.ListColumns(i).Range.Column).Delete\n                Else\n                    tbl.ListColumns(i).Delete\n                End If\n            End If\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6500871, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1181713228537698/picture?type=large", "display_name": "Kevin Le", "link": "https://stackoverflow.com/users/6500871/kevin-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 45591007, "answer_count": 2, "score": 1, "last_activity_date": 1502350044, "creation_date": 1502280540, "question_id": 45590294, "link": "https://stackoverflow.com/questions/45590294/making-an-associative-table-of-unique-identifiers", "title": "Making an Associative Table of Unique Identifiers", "body": "<p>I'm trying to create an associative table on a sheet that is pulling in data from a different sheet. By associative I mean, if the data is changed in the source data sheet, it would be reflected on the new sheet. I also want to only have the new sheet's table to be contingent on having a certain unique value. In my case, I want to pull up information related to a part number. The original source data will have many rows that contain the same part number, but I only care to display one of them. </p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n    IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\nDim ref() As Variant\nDim row As Integer\nrow = 92\nWorksheets(\"Part Tracking Scorecard\").Activate\nWhile Cells(row, 6).Value:\n    If IsInArray(Cells(row, 6).Value, ref) Then\n        row = row + 1\n    ElseIf Not IsInArray(Cells(row, 6).Value, ref) Then\n        ReDim Preserve ref(1 To UBound(ref) + 1) As Variant\n        ref(UBound(ref)) = Cells(row, 6).Value\n        Worksheets(\"Unique Parts\").Activate\n        ?????\n        row = row + 1\n</code></pre>\n\n<p>To satisfy my condition to only showcase the unique part numbers, I initialized an empty array called \"ref\". Then, as I iterate through the source sheet, I would check if the part number was in ref with the function \"IsInArray\". If it was in it, it would move onto the next row, if it wasn't add the part number into the empty array and move to the next row.</p>\n\n<p>The portion with the \"????\" is where I'm having most of my issue trying to figure out. That part is supposed to be where I make the new table with the date from the unique part number. The very simple and tedious thing I could do is make some loop to run through the columns of the rows and put in a vlookup function. I was wondering if there may be a more robust or more elegant way in doing this. </p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502365931, "post_id": 45596918, "comment_id": 78184082, "body": "Hi, thanks for the response. This actually solved an entirely different problem I had which I forgot to address in my post which was the alias repeating, but to different users.  The X500 addresses still shows up, but to less users, so some progress has been made. Do you know of any other potential solutions?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502376518, "post_id": 45596918, "comment_id": 78192988, "body": "When you step though your code when processing problematic users, what exactly fails?"}, {"owner": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502393145, "post_id": 45596918, "comment_id": 78203537, "body": "I&#39;m not sure I&#39;m understanding what you&#39;re asking. What do you mean by &quot;step through your code&quot;?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502393649, "post_id": 45596918, "comment_id": 78203787, "body": "When you put a break point in your code, you can execute your code one line at a time while watching the values of the variables."}, {"owner": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502395753, "post_id": 45596918, "comment_id": 78204862, "body": "You mean &quot;Stepping Into&quot; the code right? When I do that all it does is highlight yellow certain lines of code. Also when I hover my cursor over certain lines of code some info pops up. Like when I hover over both olEU.PrimarySMTPAddress and olEU.Alias it says: &lt;Object variable or with block variable not set&gt;."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502395880, "post_id": 45596918, "comment_id": 78204935, "body": "Hit F8 to go to the next line."}, {"owner": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502454881, "post_id": 45596918, "comment_id": 78229753, "body": "Hey, sorry for the delayed reply. So, yeah that&#39;s what I was doing. Every time I hit F8 it would either go to the next line or skip a couple lines. All it would do is highlight yellow the line it was on, and gave additional information when I hover my cursor over any line, not just the highlighted one. Is there something else that this should be doing?"}, {"owner": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502725105, "post_id": 45596918, "comment_id": 78313848, "body": "Is there anywhere you know of where I could find a possible solution? I need this solved asap, and I worry that I will not figure it out. Again, thanks for the help."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "edited": false, "score": 0, "creation_date": 1502727597, "post_id": 45596918, "comment_id": 78315273, "body": "So what is the problem? Your step over code one line at a time and figure out why you get a result different from what you expect. This is basic debugging, I am not sure what you are asking."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1502298965, "creation_date": 1502298965, "answer_id": 45596918, "question_id": 45589446, "link": "https://stackoverflow.com/questions/45589446/x500-address-shows-instead-of-email-address-when-transferring-to-excel-sheet/45596918#45596918", "title": "X500 Address shows instead of email address when transferring to Excel sheet", "body": "<p>You never guard for the fact that GetExchangeUser can return null. And why do you call CreateRecipient? You already have the AddressEntry object\nOff the top of my head:</p>\n\n<pre><code>Sub CopyToExcel()\n Dim xlApp As Object\n Dim xlWB As Object\n Dim xlSheet As Object\n Dim rCount As Long\n Dim bXStarted As Boolean\n Dim enviro As String\n Dim strPath As String\n Dim oAL As Outlook.AddressList\n Dim olAE As Outlook.AddressEntries\n Dim oAE As Outlook.AddressEntry\n\n Dim currentExplorer As Explorer\n Dim Selection As Selection\n Dim olItem As Outlook.MailItem\n Dim obj As Object\n Dim strColB, strColC, strColD As String\n Dim olEU As Outlook.ExchangeUser\n dim olSender As Object\n\n\n\nenviro = CStr(Environ(\"USERPROFILE\"))\n'where to find excel sheet\nstrPath = enviro &amp; \"\\Documents\\EmailList.xlsx\"\n   On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n    If err &lt;&gt; 0 Then\n     Set xlApp = CreateObject(\"Excel.Application\")\n    End If\n\n 'Where to transfer the info\n Set xlWB = xlApp.workbooks.Open(strPath)\n Set xlSheet = xlWB.sheets(\"Sheet1\")\n\n\n'Find the next empty line of the worksheet\n rCount = xlSheet.Range(\"C\" &amp; xlSheet.Rows.Count).End(4000).Row\n\n' where to find the information\nSet currentExplorer = Application.ActiveExplorer\nSet Selection = currentExplorer.Selection\nFor Each obj In Selection\n  Set olItem = obj\n\n  'extract the information\n\n  strColB = olItem.SenderName\n  strColC = olItem.SenderEmailAddress\n  set olSender = olItem.Sender\n  if Not (olSender  Is Nothing) Then\n    set olEU = olSender.GetExchangeUser      \n    if (olEU Is Nothing) Then\n      strColD  = \"\"\n    Else\n      strColC = olEU.PrimarySmtpAddress\n      strColD = olEU.Alias\n    End If\n    'write them in the excel sheet\n     xlSheet.Range(\"B\" &amp; rCount) = strColB\n     xlSheet.Range(\"C\" &amp; rCount) = strColC\n     xlSheet.Range(\"D\" &amp; rCount) = strColD\n\n    'Next row  \n     rCount = rCount + 1\n  End If\nNext\n\n xlWB.Close 1\n If bXStarted Then\n     xlApp.Quit\n End If\n\n Set olItem = Nothing\n Set obj = Nothing\n Set currentExplorer = Nothing\n Set xlApp = Nothing\n Set xlWB = Nothing\n Set xlSheet = Nothing\n</code></pre>\n"}], "owner": {"reputation": 208, "user_id": 8277888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb639ce03e63b2d25db6ba3914b71c9?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Lopez", "link": "https://stackoverflow.com/users/8277888/christian-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 571, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593072223, "creation_date": 1502278249, "last_edit_date": 1593072223, "question_id": 45589446, "link": "https://stackoverflow.com/questions/45589446/x500-address-shows-instead-of-email-address-when-transferring-to-excel-sheet", "title": "X500 Address shows instead of email address when transferring to Excel sheet", "body": "<p>I have been tasked with getting a list of all the users who sent mail to a mailbox in Outlook and transferring it to an excel sheet.  Specifically, the sender's name, email address, as well as retrieving the sender's alias from the GAL address book.</p>\n\n<p>For a somewhat large amount of the users, instead of their email address transferring, the X500 address is what shows up as follows: /O=OREGON STATE UNIVERSITY/OU=EXCHANGE ADMINISTRATIVE GROUP (FYDIBOHF23SPDLT)/CN=RECIPIENTS/CN</p>\n\n<p>This is just an example I found online but the format is exactly the way it shows up in the Excel sheet.</p>\n\n<p>I don't have a large knowledge of VBA, so maybe not getting too technical would be helpful.</p>\n\n<p>Here's the code I have (the majority of which I found online):</p>\n\n<pre><code>Sub CopyToExcel()\n    Dim xlApp As Object\n    Dim xlWB As Object\n    Dim xlSheet As Object\n    Dim rCount As Long\n    Dim bXStarted As Boolean\n    Dim enviro As String\n    Dim strPath As String\n    Dim oAL As Outlook.AddressList\n    Dim olAE As Outlook.AddressEntries\n    Dim oAE As Outlook.AddressEntry\n\n    Dim currentExplorer As Explorer\n    Dim Selection As Selection\n    Dim olItem As Outlook.MailItem\n    Dim obj As Object\n    Dim strColB, strColC, strColD As String\n\n    enviro = CStr(Environ(\"USERPROFILE\"))\n    'where to find excel sheet\n    strPath = enviro &amp; \"\\Documents\\EmailList.xlsx\"\n\n    On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n    If err &lt;&gt; 0 Then\n     Set xlApp = CreateObject(\"Excel.Application\")\n    End If\n\n    'Where to transfer the info\n    Set xlWB = xlApp.workbooks.Open(strPath)\n    Set xlSheet = xlWB.sheets(\"Sheet1\")\n\n    'Find the next empty line of the worksheet\n    rCount = xlSheet.Range(\"C\" &amp; xlSheet.Rows.Count).End(4000).Row\n\n    ' where to find the information\n    Set currentExplorer = Application.ActiveExplorer\n    Set Selection = currentExplorer.Selection\n    For Each obj In Selection\n        Set olItem = obj\n\n        'extract the information\n\n        strColB = olItem.SenderName\n        strColC = olItem.SenderEmailAddress\n        strColD = olItem.Sender.GetExchangeUser.Alias\n\n        'Get the Exchange address\n        Dim olEU As Outlook.ExchangeUser\n        Dim oEDL As Outlook.ExchangeDistributionList\n        Dim recip As Outlook.Recipient\n        Set recip = Application.session.CreateRecipient(strColB)\n\n        If InStr(1, strColC, \"/\") &gt; 0 Then\n            'if exchange, get smtp address\n            Select Case recip.AddressEntry.AddressEntryUserType\n\n            Case OlAddressEntryUserType.olExchangeUserAddressEntry\n                Set olEU = recip.AddressEntry.GetExchangeUser\n                If Not (olEU Is Nothing) Then\n                    strColC = olEU.PrimarySmtpAddress\n                End If\n\n            Case OlAddressEntryUserType.olOutlookContactAddressEntry\n                Set olEU = recip.AddressEntry.GetExchangeUser\n                If Not (olEU Is Nothing) Then\n                    strColC = olEU.PrimarySmtpAddress\n                End If\n\n            Case OlAddressEntryUserType.olExchangeDistributionListAddressEntry\n                Set oEDL = recip.AddressEntry.GetExchangeDistributionList\n                If Not (oEDL Is Nothing) Then\n                    strColC = olEU.PrimarySmtpAddress\n                End If\n\n            End Select\n        End If\n\n       'write them in the excel sheet\n       xlSheet.Range(\"B\" &amp; rCount) = strColB\n       xlSheet.Range(\"C\" &amp; rCount) = strColC\n       xlSheet.Range(\"D\" &amp; rCount) = strColD\n\n    'Next row\n        rCount = rCount + 1\n\n    Next\n\n    xlWB.Close 1\n    If bXStarted Then\n        xlApp.Quit\n    End If\n\n    Set olItem = Nothing\n    Set obj = Nothing\n    Set currentExplorer = Nothing\n    Set xlApp = Nothing\n    Set xlWB = Nothing\n    Set xlSheet = Nothing\n</code></pre>\n"}, {"tags": ["excel", "compare", "tortoisehg", "beyondcompare3", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 1, "last_activity_date": 1502279485, "creation_date": 1502279485, "answer_id": 45589900, "question_id": 45589376, "link": "https://stackoverflow.com/questions/45589376/compare-two-excel-vba-projects/45589900#45589900", "title": "Compare two excel VBA projects", "body": "<p><strong>For the VBA Code:</strong></p>\n\n<p>For code comparison purposes I'd suggest exporting the VBA module(s) and checking in the <code>.bas</code> (regular module) and <code>.cls</code> (class module) files and checking those in next to the <code>.xlsm</code>. \nThose exported VBA modules actually give you plain text versions of the code. Code in Worksheet / Workbook modules can also be exported as <code>.cls</code> files. This will allow TortoiseHG to compare the actual code instead of the Excel file itself.</p>\n\n<p><strong>For the Excel file comparison on itself:</strong></p>\n\n<p>For comparing the actual XLSM, you can consider saving the file, changing the extension to <code>.zip</code> and extracting the zips contents. \nAn Excel file for version 2007 and up is actually an archive containing XMLs that define the whole workbook and a <code>.bin</code> file for the VBA Project.\nYou might want to pull said xmls through XMLLint or a similar tool, since they're not pretty printed by default.</p>\n\n<p><strong>Side note:</strong></p>\n\n<p>You're asking for a <strong>nice and smooth</strong> way - I'd say there is none within Excel itself. You can use VBA to do these Module Exports on <code>Workbook_BeforeClose()</code> event, but you'll run into some security issues - By default you're not allowed to access the VBProject from within.\nOf course there are some 3rd party tools for comparing VBA code without having to extract the modules, however \"what to use\" will be severely opinion based - BeyondCompare is indeed one option.</p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 2101, "user_id": 4871247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxeDz.png?s=128&g=1", "display_name": "Chris Kennedy", "link": "https://stackoverflow.com/users/4871247/chris-kennedy"}, "is_accepted": false, "score": 0, "last_activity_date": 1502313651, "creation_date": 1502313651, "answer_id": 45600814, "question_id": 45589376, "link": "https://stackoverflow.com/questions/45589376/compare-two-excel-vba-projects/45600814#45600814", "title": "Compare two excel VBA projects", "body": "<p>Beyond Compare has an add-on file format to compare VBA code in Excel files. Download the Microsoft Excel Workbooks VBA file format from the <a href=\"http://www.scootersoftware.com/download.php?zz=kb_moreformatsv4\" rel=\"nofollow noreferrer\">Additional File Formats for BC4</a> page.</p>\n"}], "owner": {"reputation": 3, "user_id": 8439450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40444ac9ac8aa0ccdc09347f4a6961a8?s=128&d=identicon&r=PG&f=1", "display_name": "tallner", "link": "https://stackoverflow.com/users/8439450/tallner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4038, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502313651, "creation_date": 1502278034, "last_edit_date": 1531161705, "question_id": 45589376, "link": "https://stackoverflow.com/questions/45589376/compare-two-excel-vba-projects", "title": "Compare two excel VBA projects", "body": "<p>I am writing some VBA macros in Excel 2010.\nSource code is managed with TortoiseHG.\nHowever I cannot find a smooth way of comparing 2 different commits, because the TortoiseHG only shows the complete excelfile and not the different VBA files I'm writing my code in.\nIf anyone have done this in a nice and smooth way I'd be very happy to get some ideas.\nAlso using an external tool like BeyondCompare is possible.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "edited": false, "score": 0, "creation_date": 1502278183, "post_id": 45589228, "comment_id": 78137512, "body": "Have you tried XL.ScreenUpdating = False? (replace XL with the name of your Excel Application Object.) Be careful to set back to True in your error handling else you will be left hanging!"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "reply_to_user": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "edited": false, "score": 0, "creation_date": 1502313403, "post_id": 45589228, "comment_id": 78160876, "body": "Did the hint from @LordPeter work?  Since you&#39;re manipulating code via the VBE object model, I presume the Excel Application object might not effect the VBE windows.  Consider <code>XL.VBE.MainWindow.Visible = False</code> and/or <code>XL.VBE.ActiveVBProject.VBComponents(0).CodeModule.CodePane.W&zwnj;&#8203;indow.Visible = False</code>"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1502313772, "post_id": 45589228, "comment_id": 78161004, "body": "@AngieD Stack Overflow questions are best when they include code examples, assuming the question directly involves code... which yours does.  It provides context that makes it easier to understand what&#39;s going on and less guess work by those who you&#39;re asking for help.  The help page <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask?</a> has further suggestions on how best to share code.  You can edit the question to include such detail."}], "owner": {"reputation": 1, "user_id": 8439413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0ebeb48cfe2ad9dc125268da6d8a7d?s=128&d=identicon&r=PG&f=1", "display_name": "AngieD", "link": "https://stackoverflow.com/users/8439413/angied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502277607, "creation_date": 1502277607, "question_id": 45589228, "link": "https://stackoverflow.com/questions/45589228/writing-module-code-from-access-to-excel-how-do-you-not-display-the-code-window", "title": "Writing module code from Access to Excel: How do you not display the code window?", "body": "<p>I am writing code into a BeforeDoubleClick event in an Excel worksheet from Access.  </p>\n\n<p>It's all working great apart from the fact the VBA window I'm writing the code to flashes up temporarily. I wish to stop this from happening.</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Angie.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 8358457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1afa920c2bb6626837df1ddd5eb3c1e?s=128&d=identicon&r=PG&f=1", "display_name": "B.Germ", "link": "https://stackoverflow.com/users/8358457/b-germ"}, "edited": false, "score": 0, "creation_date": 1502337247, "post_id": 45589730, "comment_id": 78167492, "body": "I didn&#39;t notice that I forget to add &#39;.Fields(0).Value &#39; to the record set! thank you.."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 2, "last_activity_date": 1502279067, "creation_date": 1502279067, "answer_id": 45589730, "question_id": 45589082, "link": "https://stackoverflow.com/questions/45589082/datatype-mismatch-when-reading-recordset-in-vba-access/45589730#45589730", "title": "Datatype mismatch when reading recordset in vba access", "body": "<p>The call to <code>OpenRecordset</code> is returning a <code>RecordSet</code>, not a <code>Double</code>.  You just need to change how you retrieve the data, something like the following:</p>\n\n<pre><code>Set MyRecordSet = CurrentDb.OpenRecordset(\"SELECT \" &amp; _\nToter = MyRecordSet.Fields(0).Value\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 8358457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1afa920c2bb6626837df1ddd5eb3c1e?s=128&d=identicon&r=PG&f=1", "display_name": "B.Germ", "link": "https://stackoverflow.com/users/8358457/b-germ"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 2, "accepted_answer_id": 45589730, "answer_count": 1, "score": 2, "last_activity_date": 1502308424, "creation_date": 1502277175, "last_edit_date": 1502308424, "question_id": 45589082, "link": "https://stackoverflow.com/questions/45589082/datatype-mismatch-when-reading-recordset-in-vba-access", "title": "Datatype mismatch when reading recordset in vba access", "body": "<p>I want to do a calculation depanding on several conditions, so I tried to get the output using </p>\n\n<blockquote>\n  <p>CurrentDb.OpenRecordset</p>\n</blockquote>\n\n<p>Fist I checked the query if it works by creating query in Ms Access and it worked and returned me the answer I want, so I applied the select statement in my VBA code but it did not work, it give me error (type mismatch) on :</p>\n\n<blockquote>\n  <p>TOTER = CurrentDb.OpenRecordset(\"SELECT \" &amp; _ ..est</p>\n</blockquote>\n\n<p>Why  it work perfectly without VBA? what I am missing in my code? \nI put it in a function </p>\n\n<blockquote>\n  <p>GET_TOTER()</p>\n</blockquote>\n\n<p>and called the function from </p>\n\n<blockquote>\n  <p>TABLE_x_NEW()</p>\n</blockquote>\n\n<pre><code>  Option Compare Database\nOption Explicit\n\nPublic cnn As New ADODB.Connection\nPublic db As DAO.Database\n\nPublic Sub SUb_Main()\n    Set db = Access.Application.CurrentDb\n    Set cnn = CurrentProject.Connection\nTABLE_x_NEW\nEnd Sub\n\nPrivate Sub TABLE_x_NEW()\n    Dim sql As String\n    Dim SDATA As New ADODB.Recordset\n    Dim TX As DAO.Recordset\n    Set TX = db.OpenRecordset(\"TABLE_x\")\n\n    sql = \"SELECT * FROM TABLE_z\"\n    SDATA.Open sql, cnn, adOpenStatic\n\n    If SDATA.RecordCount &lt;&gt; 0 Then\n        Do Until SDATA.EOF\n        DoEvents\n            TX.AddNew\n            TX!P_ID = SDATA!P_ID\n            TX!Pdate = SDATA!Pdate\n            TX!W_TOTER = GET_TOTER(TX!Pdate, TX!P_ID)\n            TX.Update\n            SDATA.MoveNext\n            Loop\n        End If\n    End Sub\n\nPrivate Function GET_TOTER(Pdate As Date, PID As String) As Double\n\n    Dim sql As String\n    Dim SDATA As New ADODB.Recordset\n    Dim COUN As Long\n    Dim TOTER As Double  \n             sql = \"SELECT DISTINCT (NID) FROM TABLE_A WHERE P_ID='\" &amp; PID &amp; \"' AND PTYPE IN ('HP','TOS')\"\n             SDATA.Open sql, cnn, adOpenStatic\n\n    If SDATA.RecordCount &lt;&gt; 0 Then\n\n          COUN = CurrentDb.OpenRecordset(\"SELECT COUNT(*)FROM TABLE_B WHERE APId = '\" &amp; SDATA!NID &amp; \"' \" &amp; _\n        \"AND MONTH(W_DATE)=\" &amp; Month(Pdate) &amp; \" AND YEAR(W_DATE)=\" &amp; Year(Pdate) &amp; \"\").Fields(0).Value\n\n        If (0 &gt;= COUN &gt;= 3) Then        \n              TOTER = CurrentDb.OpenRecordset(\"SELECT \" &amp; _\n            \"(DAvg(\"\"[W_RATE]\"\",\"\"TABLE_B\"\",\"\"[APId] = '\" &amp; SDATA!NID &amp; \"' AND MONTH([WELL_TEST_DATE])=' &amp; Month(Pdate) &amp; ' AND YEAR([WELL_TEST_DATE])= ' &amp; Year(Pdate) &amp; ' \"\") \" &amp; _\n           \" -DStDev(\"\"[W_RATE]\"\", \"\"TABLE_B\"\", \"\"[APId] = '\" &amp; SDATA!NID &amp; \"' AND MONTH([WELL_TEST_DATE])=' &amp; Month(Pdate) &amp; ' AND YEAR([WELL_TEST_DATE])= ' &amp; Year(Pdate) &amp; ' \"\"))\" &amp; _\n           \" / DAvg(\"\"[W_RATE]\"\",\"\"TABLE_B\"\",\"\"[APId] = '\" &amp; SDATA!NID &amp; \"' AND MONTH([WELL_TEST_DATE])=' &amp; Month(Pdate) &amp; ' AND YEAR([WELL_TEST_DATE])= ' &amp; Year(Pdate) &amp; ' \"\") *100 \" &amp; _\n           \" +(20 * (1- COUNT(APId)/3)) + 5 \" &amp; _\n           \" FROM TABLE_B\" &amp; _\n           \" WHERE Month(W_DATE) = ' &amp; Month(Pdate) &amp; '  AND Year(W_DATE)= ' &amp; Year(Pdate) &amp; '  AND APId = '\" &amp; SDATA!NID &amp; \"' HAVING  COUNT(APId) BETWEEN 0 AND 3\")\n            GET_TOTER = TOTER     \n           ELSE\n          GET_TOTER=0        \n        End If\n\n             SDATA.Close\n        End If   \nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1502277563, "post_id": 45589057, "comment_id": 78137079, "body": "Are the values in column <b>A</b> <i>Numeric</i> or <i>Text</i> ??"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502277621, "post_id": 45589057, "comment_id": 78137117, "body": "Please remember that this is not a code writing service. Give it a try and we can help with resolving any issues with your code"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1502277754, "post_id": 45589057, "comment_id": 78137205, "body": "Perhaps you need to use an <b><i>OR</i></b> condition rather than an <b><i>AND</i></b> condition.  <b>Post your current code and a sample of your data.</b>"}, {"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1502286659, "post_id": 45589057, "comment_id": 78144496, "body": "hi all, i have figured out it with record macro, thanks!   Selection.AutoFilter     ActiveSheet.Range(&quot;$A$2:$BC$992&quot;).AutoFilter Field:=2, Criteria1:=&quot;=**c**&quot; _         , Operator:=xlOr, Criteria2:=&quot;&gt;30000.00001&quot;"}], "owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502277111, "creation_date": 1502277111, "last_edit_date": 1531161705, "question_id": 45589057, "link": "https://stackoverflow.com/questions/45589057/excel-vba-autofilter-alphanumeric-data-range", "title": "Excel VBA autofilter alphanumeric data range", "body": "<p>I have a data range in column A with five digit alphanumeric, eg. 20000.00001, 30001.00001, ec001.00002, dc001.00001......., I try to do auto filter based on data range selection, eg. Data more than >25000.00001 and contained dc001.xxxxx, but it always come out blank field with auto filter activated.  I set autofilter criteria 1 with \">25000.00001\" and criteria 2 with \"dc*\" but not successful. \n\u200c\nAnyone know what is the correct method to do this with VBA?</p>\n\n<p>Would appreciate your help. Thanks. </p>\n"}, {"tags": ["excel", "split", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 1606637, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ed5b6cac0d241091f3cf8e6c735a58bd?s=128&d=identicon&r=PG", "display_name": "Caroline Allen", "link": "https://stackoverflow.com/users/1606637/caroline-allen"}, "edited": false, "score": 0, "creation_date": 1502293089, "post_id": 45590339, "comment_id": 78149749, "body": "I do usually try to do some of the work myself but in this instance I really struggled to find anything that was anywhere near what I was trying to achieve.  I will try harder next time.  This works beautifully so thank you very much.  I have marked as correct answer."}], "tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": true, "score": 0, "last_activity_date": 1502281330, "last_edit_date": 1502281330, "creation_date": 1502280631, "answer_id": 45590339, "question_id": 45588963, "link": "https://stackoverflow.com/questions/45588963/split-a-single-row-of-data-into-multiple-unique-rows-into-a-new-sheet-to-include/45590339#45590339", "title": "split a single row of data into multiple unique rows into a new sheet to include headers as values and cell contents as values", "body": "<p>Since you are new to coding VBA, i made a simple code with For and If, try to learn this functions.\nI didn't declare every variable, try to declare them and learn about data types.\nlast_row and last_column are variables that can help a lot in Excel VBA, mainly to make dynamic spreadsheets</p>\n\n<pre><code>Sub test()\n'Declare variables here\nDim sht1, sht2 As Worksheet\n\n'sht1 has the data and sht2 is the output Worksheet, you can change the names\nSet sht1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet sht2 = ThisWorkbook.Worksheets(\"Sheet2\")\n\nlast_row1 = sht1.Range(\"A65536\").End(xlUp).Row\nlast_column = sht1.Cells(1, sht1.Columns.Count).End(xlToLeft).Column\nx = 1\n\n'Add header\nsht2.Cells(1, 1) = \"Company\"\nsht2.Cells(1, 2) = \"Country\"\nsht2.Cells(1, 3) = \"Status\"\n'Data add\nFor i = 2 To last_row1\n'Assuming Company is in Column 1 or A\n    For k = 2 To last_column\n        'If cell is different from blank then write data\n        If sht1.Cells(i, k) &lt;&gt; \"\" Then\n        sht2.Cells(x + 1, 1) = sht1.Cells(i, 1)\n        sht2.Cells(x + 1, 2) = sht1.Cells(1, k)\n        sht2.Cells(x + 1, 3) = sht1.Cells(i, k)\n        x = x + 1\n        End If\n    Next k\nNext i\n\nMsgBox \"Data Updated\"\nEnd Sub\n</code></pre>\n\n<p>Next time, try to learn some coding and post your code.</p>\n"}], "owner": {"reputation": 139, "user_id": 1606637, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ed5b6cac0d241091f3cf8e6c735a58bd?s=128&d=identicon&r=PG", "display_name": "Caroline Allen", "link": "https://stackoverflow.com/users/1606637/caroline-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 45590339, "answer_count": 1, "score": 0, "last_activity_date": 1502281330, "creation_date": 1502276860, "last_edit_date": 1531164843, "question_id": 45588963, "link": "https://stackoverflow.com/questions/45588963/split-a-single-row-of-data-into-multiple-unique-rows-into-a-new-sheet-to-include", "title": "split a single row of data into multiple unique rows into a new sheet to include headers as values and cell contents as values", "body": "<p>I have found quite a lot of data splitting VBA code posts but none that splits it by contents and pulls in the header and puts the results into a new sheet (I need the original data to be left in its original state).</p>\n\n<p>I have a spreadsheet that contains values in columns with a country as a header and I need to split each row into new rows in a new sheet with the country listed in a new column and the value from the same country column in the new row.</p>\n\n<p>I want to ignore any country headers where the cell contents are blank as in the example with row 3.</p>\n\n<p>This is a small example of the raw data:\n<a href=\"https://i.stack.imgur.com/qaZ20.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qaZ20.png\" alt=\"Raw Data Example\"></a> </p>\n\n<p>And this is what I need the 3 rows to turn into:\n<a href=\"https://i.stack.imgur.com/qL5Uh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qL5Uh.png\" alt=\"Required Results\"></a></p>\n\n<p>Although I am asking about VBA code I do not yet know how to write VBA and only adjust code that I have found on the internet to fit my scenario. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502276654, "post_id": 45588718, "comment_id": 78136450, "body": "<code>Workbooks(&quot;xxx.xlsm&quot;)</code> is not correct.... a workbook name is not the same as a filename."}, {"owner": {"reputation": 1, "user_id": 8439225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YW1goHP_LYg/AAAAAAAAAAI/AAAAAAAAAHg/j6oVK9JgTbM/photo.jpg?sz=128", "display_name": "Serge", "link": "https://stackoverflow.com/users/8439225/serge"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502276959, "post_id": 45588718, "comment_id": 78136653, "body": "if I remove a .xlsm format, I get the &quot;subject is out of range&quot; error. I have both files open as well..."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502277107, "post_id": 45588718, "comment_id": 78136761, "body": "Not sure why you are using <code>Workbooks(&quot;xxx.xlsm&quot;).Sheets...</code> when you have already qualified object: <code>WBschedule</code>. I would just use <code>WBschedule.Sheets...</code>. Also, is <b>Workbooks(&quot;xxx.xlsm&quot;)</b> already open?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1502277329, "post_id": 45588718, "comment_id": 78136919, "body": "There&#39;s a fair amount wrong with the code:  you need to declare the data type of each variable - <code>y</code> is a range, but the other variables on that line are variants.  Same with <code>wb</code> and <code>ws</code>.  <code>Set ws=Sheets(&quot;Sheet1&quot;)</code> - is that meant to refer to the currently activeworkbook as you&#39;ve not said which book it&#39;s in.  <code>Set dates</code> - you&#39;re setting it to the address value of n  - 3 columns, why not just set it to reference n-3 columns as both refs are on the same sheet:  <code>Set dates = n.Offset(, -3)</code>.  <code>Set x = Range...</code> - does sheet <code>xxx </code> really have a space after it?"}, {"owner": {"reputation": 1, "user_id": 8439225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YW1goHP_LYg/AAAAAAAAAAI/AAAAAAAAAHg/j6oVK9JgTbM/photo.jpg?sz=128", "display_name": "Serge", "link": "https://stackoverflow.com/users/8439225/serge"}, "edited": false, "score": 0, "creation_date": 1502277422, "post_id": 45588718, "comment_id": 78136994, "body": "yeah, I started off using the wbschedule, but then had issues with that, and just switched to using the entire thing, as it&#39;s a very specific set of files and I first wanted to get the basic function working, and optimise later. and yeah, both files are open always"}, {"owner": {"reputation": 1, "user_id": 8439225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YW1goHP_LYg/AAAAAAAAAAI/AAAAAAAAAHg/j6oVK9JgTbM/photo.jpg?sz=128", "display_name": "Serge", "link": "https://stackoverflow.com/users/8439225/serge"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1502277676, "post_id": 45588718, "comment_id": 78137152, "body": "@DarrenBartrup-Cook, righto, the sheet1 bit is from file yyy, I only define that one, as file xxx only has the sheet called &quot;xxx&quot;. Btw, doesn&#39;t have a space, that&#39;s me being trash at replacing all names with xxx. Just to clarify the file name&#39;s XXX.xlsm and the sheet name in the file is XXX, so it&#39;s the same. The yyy.xlsm workbook has a &quot;sheet1&quot; only."}, {"owner": {"reputation": 1, "user_id": 8439225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YW1goHP_LYg/AAAAAAAAAAI/AAAAAAAAAHg/j6oVK9JgTbM/photo.jpg?sz=128", "display_name": "Serge", "link": "https://stackoverflow.com/users/8439225/serge"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1502277855, "post_id": 45588718, "comment_id": 78137278, "body": "@DarrenBartrup-Cook, and regarding the &quot;dates&quot; and &quot;set x =&quot; they&#39;re define in different files, i.e. yyy and xxx respectively. I guess it was just easier for me to define the dates bit, than to refer to it the same  all the time, I&#39;ll try to remove any extra variables and see if it&#39;ll help"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8439225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YW1goHP_LYg/AAAAAAAAAAI/AAAAAAAAAHg/j6oVK9JgTbM/photo.jpg?sz=128", "display_name": "Serge", "link": "https://stackoverflow.com/users/8439225/serge"}, "edited": false, "score": 0, "creation_date": 1502291703, "post_id": 45589286, "comment_id": 78148664, "body": "Thanks for the tips, Darren. I actually updated the text somewhat to go around the particular issue, although it&#39;s technically still there. Lemme explain this a bit - it seems that the find function cannot locate the date value in the date range. I&#39;ve triple checked that the date appears correctly in the date range. I&#39;ve also tried defining the date as long and looking for that, but neither works for some odd reason.The date range is basically 01/01/2017 to 29/12/2017. When I debug the issue I can highlight the variables and see that the long or value is found correctly, but still no luck"}, {"owner": {"reputation": 1, "user_id": 8439225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YW1goHP_LYg/AAAAAAAAAAI/AAAAAAAAAHg/j6oVK9JgTbM/photo.jpg?sz=128", "display_name": "Serge", "link": "https://stackoverflow.com/users/8439225/serge"}, "edited": false, "score": 0, "creation_date": 1502292132, "post_id": 45589286, "comment_id": 78149035, "body": "ps. thanks a lot for sticking with my horrible explanation, I&#39;m well aware of convoluted nature of my explanations, so apologies for that :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1502277765, "creation_date": 1502277765, "answer_id": 45589286, "question_id": 45588718, "link": "https://stackoverflow.com/questions/45588718/excel-vba-trying-to-find-a-date-in-a-row-of-dates-get-object-variable-or-wit/45589286#45589286", "title": "Excel VBA - trying to find a date in a row of dates, get &quot;object variable or with block variable not set&quot; error", "body": "<p>For your specific problem (there are others in your code):</p>\n\n<pre><code>Set y = Range(Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Range(\"J2:NZ2\").Find(dates.Value).Address)\n</code></pre>\n\n<p>If <code>dates.value</code> doesn't exist in your sheet you'll get an <code>Object variable or With block variable not set</code> error.  </p>\n\n<p>This is because you're telling it to find the value and return it's address.  You should try and find the value, check if it's found and then look at the address.  </p>\n\n<p>You also don't need to wrap it in a <code>Range</code> as the <code>FIND</code> function returns a range reference anyway.  </p>\n\n<pre><code>Set y = Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Range(\"J2:NZ2\").Find(dates.Value)\nIf Not y Is Nothing Then\n    MsgBox y.Address\n    'Other code that relies on y.\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8439225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YW1goHP_LYg/AAAAAAAAAAI/AAAAAAAAAHg/j6oVK9JgTbM/photo.jpg?sz=128", "display_name": "Serge", "link": "https://stackoverflow.com/users/8439225/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1502293409, "creation_date": 1502293409, "answer_id": 45595220, "question_id": 45588718, "link": "https://stackoverflow.com/questions/45588718/excel-vba-trying-to-find-a-date-in-a-row-of-dates-get-object-variable-or-wit/45595220#45595220", "title": "Excel VBA - trying to find a date in a row of dates, get &quot;object variable or with block variable not set&quot; error", "body": "<p>So, I just decided to change the range.find function to the \"for each...\" way and found the necessary cell this way. Still no idea why .find didn't work, but the issues is basically not present anymore. For reference: I changed the following </p>\n\n<pre><code> Set y = Range(Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Range(\"J2:NZ2\").Find(dates.Value).Address)\n</code></pre>\n\n<p>to the following: </p>\n\n<pre><code>    For Each d In Workbooks(\"xxx.xlsm\").Sheets(\"xxx\").Range(\"J2:NZ2\")\n    If d = dates.Value Then\n    Set y = d\n    Else: GoTo b\n    End If\nb:         Next\n</code></pre>\n\n<p>Thanks everyone for good tips! </p>\n"}], "owner": {"reputation": 1, "user_id": 8439225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YW1goHP_LYg/AAAAAAAAAAI/AAAAAAAAAHg/j6oVK9JgTbM/photo.jpg?sz=128", "display_name": "Serge", "link": "https://stackoverflow.com/users/8439225/serge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502309448, "creation_date": 1502276126, "last_edit_date": 1502309448, "question_id": 45588718, "link": "https://stackoverflow.com/questions/45588718/excel-vba-trying-to-find-a-date-in-a-row-of-dates-get-object-variable-or-wit", "title": "Excel VBA - trying to find a date in a row of dates, get &quot;object variable or with block variable not set&quot; error", "body": "<p>Here's the summary of what I'm trying to do: \nI have two files, \"yyy\" is an extract from a system keeping track of sicknesses and holidays, \"xxx\" file is where we manually note down those things, so I'm trying to make a macro that would cross check the two and highlight consistency/inconsistency in the extract. </p>\n\n<p>Problem: \nWhen I run the macro, I get an error \"object variable or with block variable not set\" when it gets to the following </p>\n\n<p>Set y = Range(Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Range(\"J2:NZ2\").Find(dates.Value).Address)\nI tried to swap between the dates.value and dateStr as reference for what to find, but get the same error.  </p>\n\n<p>PS. I checked all the ranges over and over and over, everything seem to be correct.\nPPS. I probably have some extra defined bits, which aren't present in the code otherwise, apologies for the untidy code. I'm trying to mover past this error to finish the rest of it...</p>\n\n<p>Many thanks in advance! </p>\n\n<pre><code>Option Explicit\n\nSub sickhol_check()\n\nDim names, dates, schedDates, n, schedName, x, y As Range\n\nDim wb, WBschedule As Workbook\nDim ws, WSschedule As Worksheet\nDim nameStr As String\nDim dateStr As Long\n\nSet wb = Workbooks(\"yyy.xlsm\")\nSet ws = Sheets(\"Sheet1\")\nSet WBschedule = Workbooks(\"xxx.xlsm\")\nSet WSschedule = WBschedule.Sheets(\"xxx\")\nSet names = ThisWorkbook.Sheets(\"Sheet1\").Range(\"D2:D1882\")      \u2018yyy workbook\nSet schedName = Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Range(\"F4:F300\")\nSet schedDates = Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Range(\"J2:NZ2\")\n\nFor Each n In names       \u2018working in yyy workbook\nIf n.Value &lt;&gt; \"\" Then\n    Set dates = ThisWorkbook.Sheets(\"Sheet1\").Range(n.Offset(0, -3).Address)\n    nameStr = n.Value\n    dateStr = dates.Value\n    If n.Value = schedName.Find(n.Value) Then\n        Set x = Range(Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Range(\"F4:F300\").Find(nameStr).Address)\n        Set y = Range(Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Range(\"J2:NZ2\").Find(dates.Value).Address)\n        If n.Offset(0, 11).Value = \"Sick Leave\" Then\n            If Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Cells(x.Row, y.Column).Value = \"Sick\" Or Workbooks(\"xxx.xlsm\").Sheets(\"xxx \").Cells(x.Row, y.Column).Value = \"Sick - pending\" Or Workbooks(\"xxx.xlsm\").Sheets(\"xxx\").Cells(x.Row, y.Column).Value = \"Half-day Sick\" Then\n            With n\n            .Interior.Color = RGB(0, 255, 0)\n            End With\n            Else:\n            With n\n            .Interior.Color = RGB(255, 0, 0)\n            End With\n            GoTo a:\n            End If\n        ElseIf n.Offset(0, 11).Value = \"Holiday Annual Leave\" Then\n            If Workbooks(\"xxx.xlsm\").Sheets(\"xxx\").Cells(x.Row, y.Column).Value = \"Hol. Approved\" Or Workbooks(\"xxx.xlsm\").Sheets(\"xxx\").Cells(x.Row, y.Column).Value = \"Half-day Hol.\" Then\n            With n\n            .Interior.Color = RGB(0, 255, 0)\n            End With\n            Else:\n            With n\n            .Interior.Color = RGB(255, 0, 0)\n            End With\n            GoTo a:\n            End If\n        ElseIf n.Offset(0, 11).Value = \"Leave  - Unpaid\" Then\n            If Workbooks(\"xxx.xlsm\").Sheets(\"xxx\").Cells(x.Row, y.Column).Value = \"TimeOff Approv.\" Or Workbooks(\"xxx.xlsm\").Sheets(\"xxx\").Cells(x.Row, y.Column).Value = \"Unavailable\" Then\n            With n\n            .Interior.Color = RGB(0, 255, 0)\n            End With\n            Else:\n            With n\n            .Interior.Color = RGB(255, 0, 0)\n            End With\n            GoTo a:\n            End If\n        End If\n        MsgBox x.Address &amp; \" \" &amp; y.Address\n        Else: GoTo a:\n    End If\n    Else: GoTo a:\nEnd If\na: Next\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 210, "user_id": 8205970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa718bc0e864734c74c657e23b8f555a?s=128&d=identicon&r=PG&f=1", "display_name": "B Slater", "link": "https://stackoverflow.com/users/8205970/b-slater"}, "reply_to_user": {"reputation": 285, "user_id": 5736199, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0622e2e2e2bdcc4d0ec0935171636704?s=128&d=identicon&r=PG&f=1", "display_name": "SBozhko", "link": "https://stackoverflow.com/users/5736199/sbozhko"}, "edited": false, "score": 0, "creation_date": 1502276533, "post_id": 45588683, "comment_id": 78136367, "body": "No problem at all buddy!"}], "tags": [], "owner": {"reputation": 210, "user_id": 8205970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa718bc0e864734c74c657e23b8f555a?s=128&d=identicon&r=PG&f=1", "display_name": "B Slater", "link": "https://stackoverflow.com/users/8205970/b-slater"}, "is_accepted": true, "score": 1, "last_activity_date": 1502276031, "creation_date": 1502276031, "answer_id": 45588683, "question_id": 45588504, "link": "https://stackoverflow.com/questions/45588504/excel-vba-manual-input-of-data-in-data-validation-cell/45588683#45588683", "title": "Excel VBA - Manual input of data in data validation cell", "body": "<p>You've almost got it in the code you posted, just change <code>.ShowError</code> to false and the user can input anything and not be warned</p>\n\n<pre><code>For u = 1 To SpecDependencies.count\n    SpecDepList = SpecDepList &amp; \",\" &amp; SpecDependencies(u) &amp; \" - \" &amp; SpecDepDate(u)\nNext\n\nWith CRC.Cells(ECURowInCRC, 8).Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=SpecDepList\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputMessage = \"View Spec Dependancies\"\n    '.ErrorMessage = \"No value selected\"\n    .ShowInput = True\n    .ShowError = False\nEnd With\n\nEnd If\n\nSpecDepList = \"\"\nSet SpecDependencies = New Collection\nSet SpecDepDate = New Collection\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 5736199, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0622e2e2e2bdcc4d0ec0935171636704?s=128&d=identicon&r=PG&f=1", "display_name": "SBozhko", "link": "https://stackoverflow.com/users/5736199/sbozhko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 45588683, "answer_count": 1, "score": 0, "last_activity_date": 1502276031, "creation_date": 1502275596, "question_id": 45588504, "link": "https://stackoverflow.com/questions/45588504/excel-vba-manual-input-of-data-in-data-validation-cell", "title": "Excel VBA - Manual input of data in data validation cell", "body": "<p>I have  worksheet which has various validation lists, however for all these lists I need to have the option of users own entry in the cell. </p>\n\n<p>I know you can uncheck the box however because my worksheet gets regenerated on a regular basis I need to achieve this programatically. Anyone have any idea how to do this? Here is the code I have that creates the drop down lists:</p>\n\n<pre><code>    For u = 1 To SpecDependencies.count\n        SpecDepList = SpecDepList &amp; \",\" &amp; SpecDependencies(u) &amp; \" - \" &amp; SpecDepDate(u)\n    Next\n\n    With CRC.Cells(ECURowInCRC, 8).Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n            xlBetween, Formula1:=SpecDepList\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputMessage = \"View Spec Dependancies\"\n        '.ErrorMessage = \"No value selected\"\n        .ShowInput = True\n        '.ShowError = True\n    End With\n\n    End If\n\n    SpecDepList = \"\"\n    Set SpecDependencies = New Collection\n    Set SpecDepDate = New Collection\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502274018, "post_id": 45587756, "comment_id": 78134492, "body": "Agree with Vityata&#39;s point, but I cannot replicate your error. Perhaps you have other code."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 8344651, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1750578798318077/picture?type=large", "display_name": "Daulat Daga", "link": "https://stackoverflow.com/users/8344651/daulat-daga"}, "edited": false, "score": 0, "creation_date": 1502274247, "post_id": 45587880, "comment_id": 78134684, "body": "Welcome, @DaulatDaga :) Feel free to accept the answer, once you can :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1502273910, "creation_date": 1502273910, "answer_id": 45587880, "question_id": 45587756, "link": "https://stackoverflow.com/questions/45587756/i-want-to-clear-a-cell-and-then-assign-the-value-to-it/45587880#45587880", "title": "i want to clear a cell and then assign the value to it", "body": "<p>Here is something that can do the job:</p>\n\n<pre><code>Option Explicit\n\nSub Clear_Table(ct As Range)\n\n    ct.ClearContents\n\nEnd Sub\n\nSub rite()\n\n    Clear_Table Range(\"E10\")\n    Range(\"E10\").Value = \"dwsds\"\n\nEnd Sub\n</code></pre>\n\n<p>Try to avoid Selection as much as you can. See more here - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/35864330#35864330\">How to avoid using Select in Excel VBA</a></p>\n"}], "owner": {"reputation": 13, "user_id": 8344651, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1750578798318077/picture?type=large", "display_name": "Daulat Daga", "link": "https://stackoverflow.com/users/8344651/daulat-daga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 45587880, "answer_count": 1, "score": 0, "last_activity_date": 1502273910, "creation_date": 1502273575, "question_id": 45587756, "link": "https://stackoverflow.com/questions/45587756/i-want-to-clear-a-cell-and-then-assign-the-value-to-it", "title": "i want to clear a cell and then assign the value to it", "body": "<pre><code>Sub Clear_Table(ct)\n    Range(ct).Select\n    'Range(Selection, Selection.End(xlToRight)).Select\n    'Range(Selection, Selection.End(xlDown)).Select\n    Selection.ClearContents\n    Range(ct).Select\nEnd Sub\n\nSub rite()\n\n\n\nClear_Table (\"E10\")\n\nRange(\"E10\").Value = \"dwsds\"\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>getting compile error: Argument not optional\n  (only want to clear value in a cell not the entire range and put the value in that cell. please help)</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1502272384, "post_id": 45587184, "comment_id": 78133291, "body": "What exactly do you mean by &#39;a column for which I would like this process to be automated&#39;? You want columns inserted when something happens?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502274175, "post_id": 45587184, "comment_id": 78134624, "body": "I think both chaps below have got your question while I didn&#39;t, but do you really want lots of rows inserted every time you select a cell in a column? That might get irritating."}], "answers": [{"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1502272566, "creation_date": 1502272566, "answer_id": 45587345, "question_id": 45587184, "link": "https://stackoverflow.com/questions/45587184/applying-vba-for-a-particular-cell-to-a-selection-column-automatically/45587345#45587345", "title": "Applying VBA for a particular cell to a selection/column automatically", "body": "<p>You have to use <code>Events</code>. Insert this code in the module of the sheet where you want this working. It will run every time you select a cell in column C.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"C:C\")) Is Nothing And Target.Value &lt;&gt; \"\" Then '&lt;-Change \"C:C\" to your column\n    Dim i As Integer, n As Integer, m As Long\n    n = Target.Value\n    m = Target.Row\n    For i = 1 To n\n        Rows(m * i + 1).Insert\n    Next i\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1502273738, "creation_date": 1502273738, "answer_id": 45587816, "question_id": 45587184, "link": "https://stackoverflow.com/questions/45587184/applying-vba-for-a-particular-cell-to-a-selection-column-automatically/45587816#45587816", "title": "Applying VBA for a particular cell to a selection/column automatically", "body": "<p>You can use one of the <code>Worksheet</code> events, such as <code>Worksheet_SelectionChange</code> or <code>Worksheet_Change</code> events.</p>\n\n<p>Also, you don't need to have so many variables, you can use the properties of <code>Target</code> object (equivalent to <code>ActiveCell</code>). <strong>Also</strong>, you can add multiple rows at once (there's no need to have a <code>For</code> loop).</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n' modify column \"A\" to your desired column\nIf Not Intersect(Target, Range(\"A:A\")) Is Nothing Then\n    ' make sure the value is numeric, positive, and you select a single cell\n    If Target.Value &gt; 0 And Trim(Target.Value) &lt;&gt; \"\" And IsNumeric(Target.Value) And Target.Cells.Count = 1 Then\n        ' no need for a loop to add 1 row at a time,\n        ' just use the line below to add the number of rows in the Target (acitveCell) at once\n        Range(Cells(Target.Row + 1, 1), Cells(Target.Row + Target.Value, 1)).EntireRow.Insert\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8438499"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1502273738, "creation_date": 1502272109, "question_id": 45587184, "link": "https://stackoverflow.com/questions/45587184/applying-vba-for-a-particular-cell-to-a-selection-column-automatically", "title": "Applying VBA for a particular cell to a selection/column automatically", "body": "<p>I am new to VBA and require some assistance. I have found VBA that will look at the value of the active cell and insert a number of rows equal to the value in the cell. </p>\n\n<p>The problem I have is that this only works for the active cell, I have a column for which I would like this process to be automated for. Would anyone know what I should change in the code below?</p>\n\n<pre><code>Sub InsertSome()\nDim i As Integer, n As Integer, m As Long\nn = ActiveCell.Value\nm = ActiveCell.Row\nFor i = 1 To n\n    Rows(m * i + 1).Insert\nNext i\nEnd Sub\n</code></pre>\n\n<p>Thanks in Advance!</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1502271950, "post_id": 45587025, "comment_id": 78132967, "body": "I can understand you have a problem, but we cannot help without any code."}, {"owner": {"reputation": 1182, "user_id": 3546112, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fde927821f1c1fa92cbe20deabceac15?s=128&d=identicon&r=PG&f=1", "display_name": "Babar", "link": "https://stackoverflow.com/users/3546112/babar"}, "reply_to_user": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1502272102, "post_id": 45587025, "comment_id": 78133071, "body": "@Prisoner Wait I will update it, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1182, "user_id": 3546112, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fde927821f1c1fa92cbe20deabceac15?s=128&d=identicon&r=PG&f=1", "display_name": "Babar", "link": "https://stackoverflow.com/users/3546112/babar"}, "edited": false, "score": 0, "creation_date": 1502272524, "post_id": 45587169, "comment_id": 78133383, "body": "the cmd in question is  ADODB.Command object. which method is used?"}, {"owner": {"reputation": 1182, "user_id": 3546112, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fde927821f1c1fa92cbe20deabceac15?s=128&d=identicon&r=PG&f=1", "display_name": "Babar", "link": "https://stackoverflow.com/users/3546112/babar"}, "edited": false, "score": 0, "creation_date": 1502272880, "post_id": 45587169, "comment_id": 78133644, "body": "One more question, I am referencing the fields directly in query. So I create the parameters with the same naming convention? That is &quot;Forms!form1!textfield&quot;"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1182, "user_id": 3546112, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fde927821f1c1fa92cbe20deabceac15?s=128&d=identicon&r=PG&f=1", "display_name": "Babar", "link": "https://stackoverflow.com/users/3546112/babar"}, "edited": false, "score": 1, "creation_date": 1502272981, "post_id": 45587169, "comment_id": 78133699, "body": "Usually, you can just add parameters in order and it will work, but for <code>ADODB</code>, I&#39;m not entirely sure. I usually just go for <code>?</code> placeholders for parameters in the query."}, {"owner": {"reputation": 1182, "user_id": 3546112, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fde927821f1c1fa92cbe20deabceac15?s=128&d=identicon&r=PG&f=1", "display_name": "Babar", "link": "https://stackoverflow.com/users/3546112/babar"}, "edited": false, "score": 0, "creation_date": 1502273115, "post_id": 45587169, "comment_id": 78133791, "body": "I am accepting your answer since it did help me with the direction, and now it&#39;s a matter of passing the arguments. Thanks, have a good day"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1502273313, "last_edit_date": 1502273313, "creation_date": 1502272082, "answer_id": 45587169, "question_id": 45587025, "link": "https://stackoverflow.com/questions/45587025/access-too-few-parameters/45587169#45587169", "title": "Access: &quot;Too few parameters.&quot;", "body": "<p>When executing a query using VBA, you can't reference open forms. You need to explicitly state all parameters.</p>\n\n<p>If you're executing the query using <code>DoCmd.RunQuery</code>, you can set parameters using <code>DoCmd.SetParameter</code>.</p>\n\n<p>If you're executing the query using <code>QueryDef.Execute</code>, you can set parameters using the <code>QueryDef.Parameters</code> collection.</p>\n\n<p>If you're executing the query using an <code>ADODB.Command</code>, you can set parameters by appending parameters to the <code>Command.Parameters</code> collection, in the following way: </p>\n\n<p><code>Command.Parameters.Append Command.CreateParameter (\"MyParameterName\", adInteger, adParamInput)</code> where <code>adInteger</code> is the type. After that, you still need to set the parameter to a value by setting <code>Command.Parameters(\"MyParameterName\").Value = MyValue</code></p>\n\n<p>Also see <a href=\"https://stackoverflow.com/questions/10352211/vba-ado-connection-and-query-parameters\">this question</a> for info on ADODB parameters. They are a bit more tricky.</p>\n\n<p>All parameters need to be filled in before executing the query.</p>\n"}], "owner": {"reputation": 1182, "user_id": 3546112, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fde927821f1c1fa92cbe20deabceac15?s=128&d=identicon&r=PG&f=1", "display_name": "Babar", "link": "https://stackoverflow.com/users/3546112/babar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 45587169, "answer_count": 1, "score": 0, "last_activity_date": 1502308626, "creation_date": 1502271658, "last_edit_date": 1502308626, "question_id": 45587025, "link": "https://stackoverflow.com/questions/45587025/access-too-few-parameters", "title": "Access: &quot;Too few parameters.&quot;", "body": "<p>I know this is a redundant question but could not find a similar scenario to mine.</p>\n\n<p>I have a stored query which, when executed, picks values from the filters on an opened form and display results. All works.</p>\n\n<p>Here is how the query is called:</p>\n\n<pre><code>cmd.CommandType = adCmdStoredProc\ncmd.CommandText = \"qry\"\nDim rsReport As New ADODB.Recordset\nrsReport.CursorType = adOpenKeyset\nrsReport.CursorLocation = adUseClient\nrsReport.Open cmd\n</code></pre>\n\n<p>I am trying to use the same query from VBA to create Excel files which can be downloaded or emailed and I am getting a \"Too few parameters\" error now (while the form is still open). Can anyone set me in the right direction why this is happening please?</p>\n"}, {"tags": ["javascript", "c#", "vba", "ms-office"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8259467, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-4S4cDyfwokc/AAAAAAAAAAI/AAAAAAAABAY/DDeVgyyLuQQ/photo.jpg?sz=128", "display_name": "Shital Dhumal", "link": "https://stackoverflow.com/users/8259467/shital-dhumal"}, "edited": false, "score": 0, "creation_date": 1502282714, "post_id": 45587060, "comment_id": 78141088, "body": "Hello Vsharper, Shared link mentions nothing about calling Native APIs from within Office Plugin created via JavaScript"}], "tags": [], "owner": {"reputation": 189, "user_id": 5102087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a566791fba917a2d81e89a49839709e9?s=128&d=identicon&r=PG&f=1", "display_name": "vsharper", "link": "https://stackoverflow.com/users/5102087/vsharper"}, "is_accepted": false, "score": 0, "last_activity_date": 1502271752, "creation_date": 1502271752, "answer_id": 45587060, "question_id": 45586985, "link": "https://stackoverflow.com/questions/45586985/can-we-call-native-api-from-javascript-based-office-plugins/45587060#45587060", "title": "Can we call Native API from JavaScript based Office plugins", "body": "<p>Of course you can!</p>\n\n<p>A quick Google search brought this up:</p>\n\n<p><a href=\"https://dev.office.com/reference/add-ins/javascript-api-for-office\" rel=\"nofollow noreferrer\">https://dev.office.com/reference/add-ins/javascript-api-for-office</a></p>\n\n<p>Good Luck!</p>\n"}, {"tags": [], "owner": {"reputation": 5810, "user_id": 232467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1ppg.jpg?s=128&g=1", "display_name": "Slava Ivanov", "link": "https://stackoverflow.com/users/232467/slava-ivanov"}, "is_accepted": false, "score": 0, "last_activity_date": 1502307800, "creation_date": 1502307800, "answer_id": 45599376, "question_id": 45586985, "link": "https://stackoverflow.com/questions/45586985/can-we-call-native-api-from-javascript-based-office-plugins/45599376#45599376", "title": "Can we call Native API from JavaScript based Office plugins", "body": "<p><a href=\"https://dev.office.com/docs/add-ins/overview/office-add-ins#anatomy-of-an-office-add-in\" rel=\"nofollow noreferrer\">Office.js add-ins</a> designed in mind \"write once runs everywhere (where Office supported)\". This is why the technology is based on JavaScript. Assume your JS add-in work and available to end users. What would you call \"native API\" on Windows Desktop, iOS device or OSX? There is no such thing across platform listed, right? Every platform has its own Platform API.</p>\n\n<p>As the conclusion to the point you cannot (should not even try) to call to any platform API functions, instead use what JavaScript and Office.js API offer. </p>\n"}], "owner": {"reputation": 35, "user_id": 8259467, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-4S4cDyfwokc/AAAAAAAAAAI/AAAAAAAABAY/DDeVgyyLuQQ/photo.jpg?sz=128", "display_name": "Shital Dhumal", "link": "https://stackoverflow.com/users/8259467/shital-dhumal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502307800, "creation_date": 1502271522, "last_edit_date": 1502273601, "question_id": 45586985, "link": "https://stackoverflow.com/questions/45586985/can-we-call-native-api-from-javascript-based-office-plugins", "title": "Can we call Native API from JavaScript based Office plugins", "body": "<blockquote>\n  <p>We can develop MS Office add-ins using VBA, .Net and javascript.</p>\n  \n  <p>From VBA, we can call Native API's (i.e  C, C++ functions).</p>\n  \n  <p>But, I am not sure, if it is possible to call native API's from\n  javascript too.</p>\n</blockquote>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1502271585, "post_id": 45586951, "comment_id": 78132693, "body": "Do you want &#39;help&#39; or do you just want someone to do it for you? Have you tried anything? I&#39;m sure a Google search would start you off."}, {"owner": {"reputation": 37, "user_id": 4275160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30968f070615a6c93befd7bc3f5f0b62?s=128&d=identicon&r=PG&f=1", "display_name": "kaliliP", "link": "https://stackoverflow.com/users/4275160/kalilip"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1502272827, "post_id": 45586951, "comment_id": 78133596, "body": "i havt just added my code"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4275160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30968f070615a6c93befd7bc3f5f0b62?s=128&d=identicon&r=PG&f=1", "display_name": "kaliliP", "link": "https://stackoverflow.com/users/4275160/kalilip"}, "edited": false, "score": 0, "creation_date": 1502285012, "post_id": 45589434, "comment_id": 78143031, "body": "Hi Bla2, thnks for your job, but i would like to display   all cells of &quot;personne - type1&quot; after &quot;persoone -type 2&quot; <a href=\"https://i.stack.imgur.com/hO6eA.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/hO6eA.png</a> .. actually i have like result :  cells of &quot;personne - type1&quot; then &quot;personne -type 2&quot; then cells of &quot;personne - type1&quot; after &quot;personne -type 2&quot;"}, {"owner": {"reputation": 61, "user_id": 8437903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3bHwN.jpg?s=128&g=1", "display_name": "Bla2", "link": "https://stackoverflow.com/users/8437903/bla2"}, "reply_to_user": {"reputation": 37, "user_id": 4275160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30968f070615a6c93befd7bc3f5f0b62?s=128&d=identicon&r=PG&f=1", "display_name": "kaliliP", "link": "https://stackoverflow.com/users/4275160/kalilip"}, "edited": false, "score": 0, "creation_date": 1502288493, "post_id": 45589434, "comment_id": 78146036, "body": "Hi KaliliP  I&#39;ve updated my post, hope this one coud correctly answer this time... Best regards."}, {"owner": {"reputation": 37, "user_id": 4275160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30968f070615a6c93befd7bc3f5f0b62?s=128&d=identicon&r=PG&f=1", "display_name": "kaliliP", "link": "https://stackoverflow.com/users/4275160/kalilip"}, "edited": false, "score": 0, "creation_date": 1502291560, "post_id": 45589434, "comment_id": 78148574, "body": "thks lotttttttttttttttttttttt @Bla2   Big (y) (y) (y) (y)"}], "tags": [], "owner": {"reputation": 61, "user_id": 8437903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3bHwN.jpg?s=128&g=1", "display_name": "Bla2", "link": "https://stackoverflow.com/users/8437903/bla2"}, "is_accepted": true, "score": 0, "last_activity_date": 1502288408, "last_edit_date": 1502288408, "creation_date": 1502278203, "answer_id": 45589434, "question_id": 45586951, "link": "https://stackoverflow.com/questions/45586951/vba-copy-cells-variable-number-from-multiple-worksheet-to-one/45589434#45589434", "title": "VBA Copy Cells (variable number) from multiple worksheet to one", "body": "<p>perhaps this one will be better ?</p>\n\n<pre><code>Dim gvWsh1 As Worksheet\nDim gvWsh2 As Worksheet\nDim gvWsh3 As Worksheet\nDim gvDblIndexActuel As Double\n\nPublic Sub MainEntry()\n    Dim dernligne As Double\n    Dim d As Double\n    Dim strUserType As String\n    Dim rowsToAdd As Range\n\n    ' Set the worksheets\n    Set gvWsh1 = ThisWorkbook.Worksheets(\"Feuil1\")\n    Set gvWsh2 = ThisWorkbook.Worksheets(\"Feuil2\")\n    Set gvWsh3 = ThisWorkbook.Worksheets(\"Feuil3\")\n\n    ' Clear the First Woksheet\n    gvWsh1.Cells.ClearContents\n\n    ' copy the content of first Worksheet\n    gvWsh2.Range(\"A1\").CurrentRegion.Copy gvWsh1.Range(\"A1\")\n    ' Get the last pasted line + 1\n    dernligne = gvWsh1.Range(\"A1\").CurrentRegion.Rows.Count + 1\n    ' For each lines from the last to the second\n    Do While dernligne &gt; 2\n        ' GetThe searched Term\n        strUserType = gvWsh1.Range(\"A\" &amp; dernligne).End(xlUp)\n        ' Get the range of third sheet to paste\n        Set rowsToAdd = GetWsh3RowsForType(strUserType)\n        rowsToAdd.Copy\n        ' past it to the lastline\n        gvWsh1.Range(\"A\" &amp; dernligne).Insert , rowsToAdd\n        ' Set lastLine to the type for the next loop\n        dernligne = gvWsh1.Range(\"A\" &amp; dernligne).End(xlUp).Row\n    ' next\n    Loop\n\nEnd Sub\n\nPrivate Function GetWsh3RowsForType(pUserType As String) As Range\n    ' TODO Coder\n    Dim dernligne As Double\n    Dim lastBlockLine As Double\n    Dim firstBlockLine As Double\n    Dim strUserType As String\n\n    ' Get the last line\n    dernligne = gvWsh3.Range(\"A1\").CurrentRegion.Rows.Count + 1\n    lastBlockLine = dernligne - 1\n    ' For each value in Col A\n    Do While dernligne &gt; 2\n        strUserType = gvWsh3.Range(\"A\" &amp; dernligne).End(xlUp)\n        firstBlockLine = gvWsh3.Range(\"A\" &amp; dernligne).End(xlUp).Row + 1\n        ' If value = param\n        If strUserType = pUserType Then\n            ' Get the first and last line of the block\n            ' Set return to Rows of those lines\n            Set GetWsh3RowsForType = gvWsh3.Rows(firstBlockLine &amp; \":\" &amp; lastBlockLine)\n            Exit Function\n        ' sinon\n        Else\n            ' DernLigne = Next value row\n            dernligne = gvWsh3.Range(\"A\" &amp; dernligne).End(xlUp).Row\n            ' Dernier block sera une ligne avant\n            lastBlockLine = dernligne - 1\n        ' endif\n        End If\n    ' Next\n    Loop\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4275160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30968f070615a6c93befd7bc3f5f0b62?s=128&d=identicon&r=PG&f=1", "display_name": "kaliliP", "link": "https://stackoverflow.com/users/4275160/kalilip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 45589434, "answer_count": 1, "score": 0, "last_activity_date": 1521291142, "creation_date": 1502271443, "last_edit_date": 1521291142, "question_id": 45586951, "link": "https://stackoverflow.com/questions/45586951/vba-copy-cells-variable-number-from-multiple-worksheet-to-one", "title": "VBA Copy Cells (variable number) from multiple worksheet to one", "body": "<p>I would like to place VBA code in myworkbook for copying dynamically the range A1:C\"X\" (X number cells variable) from sheet1 and sheet2, to original sheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ioj9k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ioj9k.png\" alt=\"My Sheet1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/O88YP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O88YP.png\" alt=\"My Sheet 2\"></a></p>\n\n<p>Result in the original sheet: </p>\n\n<p><a href=\"https://i.stack.imgur.com/hO6eA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hO6eA.png\" alt=\"My original sheet\"></a></p>\n\n<p>This is my code:  </p>\n\n<pre><code>Sheets(\"sheet1\").Activate\n\nadre1 = Cells.Find(What:=\"Personne - Type1\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Address\n\n\n\ntaille = (65537 - Range(adre1).Row) - Range(Cells(65536, Range(adre1).Column), Cells(65536, Range(adre1).Column).End(xlDown)).Count\n\n\nIf taille &lt;&gt; 0 Then\n\n    Sheets(\"sheet1\").Activate\n    Sheets(sheet1).Range(Range(adre1).Offset(1, 0), Range(adre1).Offset(taille, 3)).Select\n\n    Selection.Copy\n\n   Sheets(\"original\").Activate\n\n    taille2 = (65537 - Range(adre1).Row) - Range(Cells(65536, Range(adre1).Column), Cells(65536, Range(adre1).Column).End(xlUp)).Count\n\n\n    Sheets(original).Range(adre1).Offset(1 + taille2, 0).Select\n\n    ActiveSheet.Paste\n</code></pre>\n\n<p>but I have this result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5yDOI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5yDOI.png\" alt=\"result\"></a></p>\n"}, {"tags": ["vba", "replace"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8438929, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/657efe18164d4252455c54e1c58fc694?s=128&d=identicon&r=PG", "display_name": "amank", "link": "https://stackoverflow.com/users/8438929/amank"}, "is_accepted": false, "score": 0, "last_activity_date": 1502271461, "creation_date": 1502271461, "answer_id": 45586957, "question_id": 45586848, "link": "https://stackoverflow.com/questions/45586848/probably-101-stuff-but-how-do-i-replace-characters-like-and-using-a-word/45586957#45586957", "title": "Probably 101 stuff but... how do I replace characters like % and &quot; using a Word Macro", "body": "<p>That's correct, % and \" are both recognised characters and must be \"escaped\". Use a backslash to escape special symbols like this:</p>\n\n<p>\\\" or \\%</p>\n"}], "owner": {"reputation": 1, "user_id": 8438834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac304cd71b4d998f70bfc3d147cb7a12?s=128&d=identicon&r=PG&f=1", "display_name": "srobinson", "link": "https://stackoverflow.com/users/8438834/srobinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502309335, "creation_date": 1502271212, "last_edit_date": 1502309335, "question_id": 45586848, "link": "https://stackoverflow.com/questions/45586848/probably-101-stuff-but-how-do-i-replace-characters-like-and-using-a-word", "title": "Probably 101 stuff but... how do I replace characters like % and &quot; using a Word Macro", "body": "<p>HI Sorry to bother people with I'm sure a very basic problem. i'm a journalist and i need to change words like percent into % and \" into ' as I pull stories off the website and put it into my magazine. I could try to get the in-house people to help me but it would take a ticket, and six months then, nothing would happen. I've worked out how to do a lot of the replacements/removals using basic Word macro like this:</p>\n\n<pre><code>.Text = \"\u20ac\"\"\"\n        .Replacement.Text = \"^+\"\n        .Text = \"  \"\n        .Replacement.Text = \" \"\n        .Text = \"&lt;sup&gt;\"\n        .Replacement.Text = \"\"\n</code></pre>\n\n<p>but It falls over when I try to replace \"%\" or \"\"\". \nI think it must be because % and \" are special symbols.</p>\n\n<p>any help appreciated.</p>\n"}, {"tags": ["excel", "oracle", "vba", "trustedconnection"], "comments": [{"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "edited": false, "score": 0, "creation_date": 1544176108, "post_id": 45586201, "comment_id": 94191543, "body": "Answer can be found <a href=\"https://stackoverflow.com/questions/3217014/how-to-securely-store-connection-string-details-in-vba\">HERE</a>"}], "owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1502269539, "creation_date": 1502269539, "question_id": 45586201, "link": "https://stackoverflow.com/questions/45586201/oracle-vba-trusted-connection-issue-windows-10-64-bit-ms-excel-64bit", "title": "oracle vba trusted connection issue windows 10 64 bit Ms Excel 64bit", "body": "<pre><code>    Dim con As Object\n    Dim rs As Object\n    Dim cmd As Object\n    Dim query As String\n    Set con = CreateObject(\"ADODB.Connection\")\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    Set cmd = CreateObject(\"ADODB.Command\")\n\n    col = 2\n    strcon = \"Provider=OraOLEDB.Oracle;\" _\n    &amp; \"Data Source= (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = SERVER_IP)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = orcl.Multi-Act.Local))); \" _\n    &amp; \"Initial Catalog=DatabaseName;\" _\n    &amp; \"Trusted_connection=yes\"\n\n    con.Open (strcon)\n</code></pre>\n\n<p>I am getting an error called \n\"Run Time Error'-2147217887 (80040e21)\":\nAutomation Error</p>\n\n<p>Without trusted connection this code works fine. But trusted connection cant establish a connection. I have ODAC122010Xcopy_x64 installed.</p>\n"}, {"tags": ["html", "vba", "checkbox"], "comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1502360392, "post_id": 45586079, "comment_id": 78180157, "body": "can you post a screenshot of the checkbox please? and the surrounding HTML"}, {"owner": {"reputation": 1, "user_id": 8438683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd81ea75c38defba9f97a7b676eab3a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jouke", "link": "https://stackoverflow.com/users/8438683/jouke"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1502442043, "post_id": 45586079, "comment_id": 78221151, "body": "Yes, eee attachement in the question,"}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 0, "last_activity_date": 1502360374, "creation_date": 1502360374, "answer_id": 45610980, "question_id": 45586079, "link": "https://stackoverflow.com/questions/45586079/select-checkbox-on-website-using-vba/45610980#45610980", "title": "Select checkbox on website using VBA", "body": "<p>try IE.document.getElementsByAttribute(\"Type\")(0).checked=\"1\"</p>\n"}], "owner": {"reputation": 1, "user_id": 8438683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd81ea75c38defba9f97a7b676eab3a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jouke", "link": "https://stackoverflow.com/users/8438683/jouke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 870, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502434668, "creation_date": 1502269221, "last_edit_date": 1502434668, "question_id": 45586079, "link": "https://stackoverflow.com/questions/45586079/select-checkbox-on-website-using-vba", "title": "Select checkbox on website using VBA", "body": "<p>I have an piece of VBA-code, to log in to a website. </p>\n\n<p>This was quite easy, looking for the ID of the element, and use the code:</p>\n\n<pre><code>IE.document.getElementById(\"Postponement\").Click\n</code></pre>\n\n<p>But now I get a problem, because the HTML code of a particular checkbox is only: </p>\n\n<pre><code>&lt;input type=\"checkbox\" data-bind=\"checked: selectAll, click: actionAllSelected\"&gt;&lt;/input&gt;\n</code></pre>\n\n<p>This is a checkbox to select all customers on this particular page. I want to select them all. Because there is no ID or NAME, I can not use <code>getElementById</code>.</p>\n\n<p>Here is the <a href=\"https://i.stack.imgur.com/HVXsf.jpg\" rel=\"nofollow noreferrer\">checkbox</a>, and the HTML code. If you want more information then let me know!</p>\n\n<p>Anyone have an idea to select this checkbox with VBA?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1502278221, "post_id": 45585991, "comment_id": 78137536, "body": "Why would you need VBA to create a header on your pages? That&#39;s built in to Word."}], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "is_accepted": false, "score": 0, "last_activity_date": 1502355530, "creation_date": 1502355530, "answer_id": 45608999, "question_id": 45585991, "link": "https://stackoverflow.com/questions/45585991/can-i-create-automatic-headings-in-a-microsoft-word-document-which-has-around-50/45608999#45608999", "title": "Can I create automatic headings in a Microsoft Word document which has around 500 pages?", "body": "<p>Do you have to do this using VBA?</p>\n\n<p>The Advanced Find function let's you highlight all text in your document based on parameters like font and size.</p>\n\n<p>Set these parameters using the \"Format\"-dropdown -> \"Font...\"\nThen use the \"Find In\"-dropdown -> \"Main Document\" to select all text matching your criteria.</p>\n\n<p>See attached screenshot, and then manually set the style for the entire highlighted selection. </p>\n\n<p><a href=\"https://i.stack.imgur.com/fkz0K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fkz0K.png\" alt=\"Advanced Find to highlight text\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6359393, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208615474855844/picture?type=large", "display_name": "Pauline Jeswin", "link": "https://stackoverflow.com/users/6359393/pauline-jeswin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502409655, "creation_date": 1502269005, "last_edit_date": 1502409655, "question_id": 45585991, "link": "https://stackoverflow.com/questions/45585991/can-i-create-automatic-headings-in-a-microsoft-word-document-which-has-around-50", "title": "Can I create automatic headings in a Microsoft Word document which has around 500 pages?", "body": "<p>I need to add headings automatically in a Word document which has 500 pages. All the topics written with the font 'Courier' and Size '24' needs to be given style - 'Heading 1'. Can someone help me write this using VBA?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1459, "user_id": 2302262, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Z6iVa.jpg?s=128&g=1", "display_name": "ElRudi", "link": "https://stackoverflow.com/users/2302262/elrudi"}, "edited": false, "score": 0, "creation_date": 1585774897, "post_id": 45588013, "comment_id": 107885657, "body": "Why the check if the name is unequal <code>&quot;1&quot;</code>? Might there be a &quot;special custom style&quot; with this name?"}], "tags": [], "owner": {"reputation": 66, "user_id": 8427166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501f0909d9f883e0a9c6446550906c9d?s=128&d=identicon&r=PG&f=1", "display_name": "SayaliT", "link": "https://stackoverflow.com/users/8427166/sayalit"}, "is_accepted": true, "score": 0, "last_activity_date": 1502274279, "creation_date": 1502274279, "answer_id": 45588013, "question_id": 45585882, "link": "https://stackoverflow.com/questions/45585882/having-trouble-deleting-custom-styles-in-excel-2016/45588013#45588013", "title": "Having trouble deleting custom styles in Excel 2016", "body": "<p>You can try </p>\n\n<pre><code>Sub clear_all_styles()\n\n Dim styT As Style\n On Error Resume Next\n For Each styT In ActiveWorkbook.Styles\n     If Not styT.BuiltIn Then\n         If styT.Name &lt;&gt; \"1\" Then styT.Delete\n     End If\n Next styT\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 9702212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6688a5f59f3d08215dd74e75e80fdc0?s=128&d=identicon&r=PG&f=1", "display_name": "A.V. Pham", "link": "https://stackoverflow.com/users/9702212/a-v-pham"}, "is_accepted": false, "score": 0, "last_activity_date": 1547203696, "last_edit_date": 1547203696, "creation_date": 1547184017, "answer_id": 54140747, "question_id": 45585882, "link": "https://stackoverflow.com/questions/45585882/having-trouble-deleting-custom-styles-in-excel-2016/54140747#54140747", "title": "Having trouble deleting custom styles in Excel 2016", "body": "<p>just go on deleting like this:</p>\n\n<pre><code>Sub DeleteStyles()\n    For Each sty In ActiveWorkbook.Styles\n        If Not sty.BuiltIn Then\n            sty.Delete\n        End If\n    Next sty\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7505419, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209968451980646/picture?type=large", "display_name": "Darren Gillen", "link": "https://stackoverflow.com/users/7505419/darren-gillen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2526, "favorite_count": 0, "accepted_answer_id": 45588013, "answer_count": 2, "score": 0, "last_activity_date": 1547203696, "creation_date": 1502268685, "question_id": 45585882, "link": "https://stackoverflow.com/questions/45585882/having-trouble-deleting-custom-styles-in-excel-2016", "title": "Having trouble deleting custom styles in Excel 2016", "body": "<p>I use a large workbook in Excel 2016 and it appears that a large number of custom styles have been imported into the workbook and are messing with the formatting of cells in the workbook. I've tried using the following code to delete the custom styles</p>\n\n<pre><code>Sub clear_all_styles()\n\nDim styT As Style\n\nFor Each styT In ActiveWorkbook.Styles\n    If styT.BuiltIn = False Then\n        styT.Locked = False\n        styT.Delete\n    End If\nNext styT\n\nEnd Sub\n</code></pre>\n\n<p>but the styles are still listed in the Styles ribbon when I execute the code. In addition, when I try to manually delete the styles by right-clicking on them, they don't get deleted.</p>\n\n<p>Any ideas what I'm doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1502269112, "post_id": 45585915, "comment_id": 78130901, "body": "I tried this as well, and it dint work"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1502269487, "post_id": 45585915, "comment_id": 78131187, "body": "<code>.ShowAllData</code> method sets the selection of an AutoFilter to &quot;all&quot;, whereas <code>.AutoFilter</code> removes the filter alltogether."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1502269615, "post_id": 45585915, "comment_id": 78131272, "body": "I would like to use .showalldata, while I just like to clear my filter result."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1502269638, "post_id": 45585915, "comment_id": 78131282, "body": "But in the above link also, i was not able to find a solution for my  problem"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1502269767, "post_id": 45585915, "comment_id": 78131359, "body": "is there anyother way to clear the filetr result ?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502276550, "post_id": 45585915, "comment_id": 78136375, "body": "Try This: <a href=\"https://stackoverflow.com/questions/21761027/excel-2013-vba-clear-all-filters-macro\" title=\"excel 2013 vba clear all filters macro\">stackoverflow.com/questions/21761027/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1502268809, "creation_date": 1502268809, "answer_id": 45585915, "question_id": 45585792, "link": "https://stackoverflow.com/questions/45585792/removing-the-autofilter-with-command-button/45585915#45585915", "title": "removing the autofilter with command button", "body": "<p>If you want to remove all filters then try <code>Cells.AutoFilter</code></p>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "closed_date": 1502271680, "answer_count": 1, "score": 0, "last_activity_date": 1502268809, "creation_date": 1502268402, "question_id": 45585792, "link": "https://stackoverflow.com/questions/45585792/removing-the-autofilter-with-command-button", "closed_reason": "Duplicate", "title": "removing the autofilter with command button", "body": "<p>I have an userform designed with 3 listbox and 2 Buttons. </p>\n\n<p>by selecting the item in the listbox and the button1, i get the filetred result of sheet. </p>\n\n<p>With the command button2, i would like to remove the filter used and get back to the original sheet. </p>\n\n<p>I used the below code, </p>\n\n<pre><code>Private Sub CBExit_Click()\nSheets(\"Data\").ShowAllData\nUnload Me\n End Sub\n</code></pre>\n\n<p>with this everytime i get an error message that </p>\n\n<blockquote>\n  <p>showalldata method of worksheet class failed</p>\n</blockquote>\n\n<p>How can I overcome this error ? </p>\n\n<p>I wanted to clear the filter result and get back to the original sheet with the command button.</p>\n\n<p>any lead would be helpful</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6899239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06f3301ce84c9dd603ba93e386ccdee?s=128&d=identicon&r=PG&f=1", "display_name": "La82", "link": "https://stackoverflow.com/users/6899239/la82"}, "edited": false, "score": 0, "creation_date": 1502270088, "post_id": 45585955, "comment_id": 78131587, "body": "Hi Andreas, Thanks for your solution. The problem is that I am displaying the limits, so the limits depicted in the range need to be the actual ones, meaning zero. Can I do this without changing the values in the range?"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 37, "user_id": 6899239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06f3301ce84c9dd603ba93e386ccdee?s=128&d=identicon&r=PG&f=1", "display_name": "La82", "link": "https://stackoverflow.com/users/6899239/la82"}, "edited": false, "score": 0, "creation_date": 1502271335, "post_id": 45585955, "comment_id": 78132512, "body": "@La82 so you need actual numbers in the table but &quot;fake&quot; in the chart? I don&#39;t think you can do that without a second table/sheet."}, {"owner": {"reputation": 37, "user_id": 6899239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06f3301ce84c9dd603ba93e386ccdee?s=128&d=identicon&r=PG&f=1", "display_name": "La82", "link": "https://stackoverflow.com/users/6899239/la82"}, "edited": false, "score": 0, "creation_date": 1502272203, "post_id": 45585955, "comment_id": 78133155, "body": "Yeah pretty much. No figured as much but I was hoping there was a way to store it as a range without plotting the values. I will just have to add another sheet."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 0, "last_activity_date": 1502268911, "creation_date": 1502268911, "answer_id": 45585955, "question_id": 45585461, "link": "https://stackoverflow.com/questions/45585461/plotting-on-log-scale-in-vba-but-have-zero-values/45585955#45585955", "title": "Plotting on log scale in VBA but have zero values", "body": "<p>You could loop through the range and edit the values before making the chart.  </p>\n\n<pre><code>Dim rng As Range\nDim cell As Range\n\nSet rng = Range(\"B7:F7\") ' change to your range\nFor Each cell In rng\n    If cell.Value = 0 Then\n        cell.Value = 0.0000001\n    End If\nNext cell\n\n\nActiveSheet.ChartObjects(\"Chart1\").Activate\n\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(1).Name = \"LSL\"\nActiveChart.FullSeriesCollection(1).XValues = \"=Data!$B$7:$F$7\"\nActiveChart.FullSeriesCollection(1).Values = \"=Data!$B$9:$F$9\"\n</code></pre>\n\n<p>After the code is done this is the result.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/bSV66.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bSV66.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 6899239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06f3301ce84c9dd603ba93e386ccdee?s=128&d=identicon&r=PG&f=1", "display_name": "La82", "link": "https://stackoverflow.com/users/6899239/la82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502275731, "creation_date": 1502267400, "last_edit_date": 1502275731, "question_id": 45585461, "link": "https://stackoverflow.com/questions/45585461/plotting-on-log-scale-in-vba-but-have-zero-values", "title": "Plotting on log scale in VBA but have zero values", "body": "<p>I have a question and there might not be a good solution to it, but I might as well try.</p>\n\n<p>I have plots where I need to use log scale to visualize the data correctly. However, since my limits (also plottet) can contain 0 values Excel errors me out, with good reason. Since the plots are only for the visual comparison I could just plot fx 0.000000001 instead of zero. Is there a way to add an If sentence to the below import code? The zero value will appear in the y-values. </p>\n\n<pre><code>ActiveSheet.ChartObjects(\"Chart1\").Activate\n\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(1).Name = \"LSL\"\nActiveChart.FullSeriesCollection(1).XValues = \"=Data!$B$7:$F$7\"\nActiveChart.FullSeriesCollection(1).Values = \"=Data!$B$9:$F$9\"\n</code></pre>\n\n<p>I could transfer all data to a different sheet and transform the zero's and import from there, but I would very much like to avoid this.</p>\n\n<p>Hope someone knows a solution.</p>\n\n<p>Best Regards\nLonnie</p>\n"}, {"tags": ["excel", "loops", "vba"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1502268024, "post_id": 45585393, "comment_id": 78130121, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35042717/excel-vba-delete-rows\">Excel VBA Delete Rows</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1502267903, "post_id": 45585478, "comment_id": 78130027, "body": "Your alternative solution is not a good option. In that case you will process more rows than from 3 to LR, exactly 1 more row for every deleted row. Check <a href=\"https://stackoverflow.com/a/45568605/5722505\">this</a> answer for more details."}, {"owner": {"reputation": 5, "user_id": 8136811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06aaa4f4688a10dda354330a15c8f2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matt555", "link": "https://stackoverflow.com/users/8136811/matt555"}, "edited": false, "score": 0, "creation_date": 1502268199, "post_id": 45585478, "comment_id": 78130243, "body": "Thanks Rik Worked like a dream!"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1502268804, "post_id": 45585478, "comment_id": 78130664, "body": "@RikSportel It works, but sometimes it works &quot;better than expected&quot;. If you have more data below the range you loop through, you can delete some important rows."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1502269116, "post_id": 45585478, "comment_id": 78130905, "body": "@EganWolf Also true, since you&#39;ll loop until whatever was initially set as the row to loop to whilst changing the indexes of the rows afterwards. When those rows meet the criteria for deletion they&#39;ll be gone of course. It&#39;s also true that when you loop to &quot;lastrow&quot; the last &quot;possible deletions&quot; would be on empty rows. It&#39;s still extra IO operations and thus additional overhead that you don&#39;t want.  There are cases in which you might want to loop over the initial range even if indexes change, but these are rare and usually involve generating extra data on the spot in the first place."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 0, "last_activity_date": 1502268568, "last_edit_date": 1502268568, "creation_date": 1502267441, "answer_id": 45585478, "question_id": 45585393, "link": "https://stackoverflow.com/questions/45585393/vba-loop-and-delete-issue/45585478#45585478", "title": "VBA Loop and delete issue", "body": "<p>When deleting rows, you should invert your loop. With every row deletion the index of the next row has changed.</p>\n\n<p>Alter your loop to:</p>\n\n<pre><code>For I = LR To 3 step -1 'Invert loop!\n    If Cells(I, 6).Value &gt; 5# And Cells(I, 7) = \"Under \u00a35 write off\" Then\n       Cells(I, 1).EntireRow.Delete\n    End If\nNext I\n</code></pre>\n\n<p>Alternatively, you can do:</p>\n\n<pre><code>For I = 3 To LR\n    If Cells(I, 6).Value &gt; 5# And Cells(I, 7) = \"Under \u00a35 write off\" Then\n        Cells(I, 1).EntireRow.Delete\n        I = I - 1 'To avoid skipping rows.\n    End If\nNext I\n</code></pre>\n\n<p>As per comments below this second option works, but is bad practice.</p>\n"}], "owner": {"reputation": 5, "user_id": 8136811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06aaa4f4688a10dda354330a15c8f2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matt555", "link": "https://stackoverflow.com/users/8136811/matt555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 45585478, "answer_count": 1, "score": 0, "last_activity_date": 1502268568, "creation_date": 1502267197, "last_edit_date": 1531164843, "question_id": 45585393, "link": "https://stackoverflow.com/questions/45585393/vba-loop-and-delete-issue", "title": "VBA Loop and delete issue", "body": "<p>I have created some coding which is designed to loop through a data set and delete rows based on the required criteria. I need help as it deletes the first found matching criteria but doesn't loop through the rest of the data. What am I missing? Many Thanks</p>\n\n<pre><code>Sub RemoveFivePoundException()\n\nDim I As Integer\nDim LR As Long\n\nApplication.ScreenUpdating = False\n\n\nSheets(\"Claims\").Select\nLR = Cells(Rows.Count, \"A\").End(xlUp).row\nRange(\"a1\").Select\n\n For I = 3 To LR\n    If Cells(I, 6).Value &gt; 5# And Cells(I, 7) = \"Under \u00a35 write off\" Then\n       Cells(I, 1).EntireRow.Delete\n    End If\n\n  Next I\n\n Application.ScreenUpdating = True\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1502265538, "post_id": 45584762, "comment_id": 78128518, "body": "Have you declared <code>StopMacro</code> at the module level?"}, {"owner": {"reputation": 12368, "user_id": 5924562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lCWoZ.jpg?s=128&g=1", "display_name": "Naren Murali", "link": "https://stackoverflow.com/users/5924562/naren-murali"}, "edited": false, "score": 0, "creation_date": 1502265840, "post_id": 45584762, "comment_id": 78128698, "body": "@mwatters try the last macro in this page <a href=\"http://www.ozgrid.com/forum/showthread.php?t=61450\" rel=\"nofollow noreferrer\">ozgrid.com/forum/showthread.php?t=61450</a>"}, {"owner": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1502269583, "post_id": 45584762, "comment_id": 78131251, "body": "@GSerg Yes StopMacro has been declared as Boolean, apologies for not mentioning that."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 5672150, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JYQrXUj96lM/AAAAAAAAAAI/AAAAAAAAAQ0/1FA9Qu7i4zU/photo.jpg?sz=128", "display_name": "jsscio", "link": "https://stackoverflow.com/users/5672150/jsscio"}, "is_accepted": false, "score": -1, "last_activity_date": 1502268965, "creation_date": 1502268965, "answer_id": 45585977, "question_id": 45584762, "link": "https://stackoverflow.com/questions/45584762/vba-difficulty-interrupting-application-ontime/45585977#45585977", "title": "VBA - Difficulty interrupting Application.OnTime", "body": "<p>Try using the command DoEvents at the end of testup1() to yield control back to the O.S., which should allow the stop button event to occur. It is very easy for VBA to get stuck in loops with timers and/or heavy data processing and ignore other events.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502275104, "post_id": 45586637, "comment_id": 78135300, "body": "Hi CLR, thank you for your comment. The code under 221 definitely takes less than 5 seconds. When I&#39;ve tried your code the StopButton is still failing to do anything sadly, the CommandButton221 code keeps repeating. Also, I&#39;ve no idea if this info is helpful but when I type MsgBox &quot;Hi&quot; after the StopButton&#39;s Application.OnTime.. the message box doesn&#39;t come up."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502275315, "post_id": 45586637, "comment_id": 78135464, "body": "What if you put the &#39;Hi&#39; before? If that still doesn&#39;t work then your button isn&#39;t firing the code."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502276933, "post_id": 45586637, "comment_id": 78136635, "body": "You included the <code>Public Runwhen as Double</code> line?"}, {"owner": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502277600, "post_id": 45586637, "comment_id": 78137105, "body": "Yes that&#39;s included"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502277967, "post_id": 45586637, "comment_id": 78137363, "body": "Really odd. It works for me (I just put some code in that writes the date and time to the status bar) running every 5 seconds and stops when the StopButton is clicked. Now I think about it though, your original code should work too. Perhaps there&#39;s something in your code block that is causing an issue. Sorry I can&#39;t help more."}, {"owner": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502282278, "post_id": 45586637, "comment_id": 78140705, "body": "Hi CLR, thank you for your time. Would you mind posting the code you have written that has the Stop Button work fine? I&#39;ve just tried a new block of code with what you put above, and the same issue of it not stopping is still there."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502288039, "post_id": 45586637, "comment_id": 78145641, "body": "I&#39;ve altered my answer to how I tested this"}, {"owner": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502292578, "post_id": 45586637, "comment_id": 78149359, "body": "Did you put all your above code in the Sheet or the Module? If I only put the code in the Sheet I get the error message &quot;Cannot run the macro &#39;..!CommandButton221_Click&#39;. The macro may not be available in this workbook or all macros may be disabled.&quot; I have made sure to enable all macros via the Trust Centre. But then when I copy paste CommandButton221 and testup into a module it does work."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "edited": false, "score": 0, "creation_date": 1502365667, "post_id": 45586637, "comment_id": 78183880, "body": "If you&#39;re embedding these in the sheet, you&#39;ll need to include the sheet reference when calling the macro using <code>OnTime</code> like so:   <code>Application.OnTime RunWhen, &quot;Sheet1.CommandButton221_Click&quot;, , True</code> - where <code>Sheet1</code> is the name of the tab."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1502287960, "last_edit_date": 1502287960, "creation_date": 1502270685, "answer_id": 45586637, "question_id": 45584762, "link": "https://stackoverflow.com/questions/45584762/vba-difficulty-interrupting-application-ontime/45586637#45586637", "title": "VBA - Difficulty interrupting Application.OnTime", "body": "<p>This should do it, a <em>slightly</em> different method, removing the schedule entirely when hitting the Stop button:</p>\n\n<pre><code>Public RunWhen As Double\n\nPrivate Sub CommandButton221_Click()\n    Application.StatusBar = Now()\n    testup1\nEnd Sub\n\nPublic Sub testup1()\n    RunWhen = Now + TimeValue(\"00:00:05\")\n    Application.OnTime RunWhen, \"CommandButton221_Click\", , True\nEnd Sub\n\nPublic Sub StopButton_Click()\n    On Error Resume Next\n    Application.OnTime EarliestTime:=RunWhen, Procedure:=\"CommandButton221_Click\", Schedule:=False\nEnd Sub\n</code></pre>\n\n<p>Make sure the code you have in 221 doesn't take more than 5 seconds to run!</p>\n"}], "owner": {"reputation": 1, "user_id": 8438391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a922fd2008ec8d011409bb00a1f7904c?s=128&d=identicon&r=PG&f=1", "display_name": "mwatters", "link": "https://stackoverflow.com/users/8438391/mwatters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502287960, "creation_date": 1502265348, "last_edit_date": 1531164843, "question_id": 45584762, "link": "https://stackoverflow.com/questions/45584762/vba-difficulty-interrupting-application-ontime", "title": "VBA - Difficulty interrupting Application.OnTime", "body": "<p>I am having difficult interrupting a looped <code>Application.OnTime</code> command. I have a macro I want to periodically loop every 5 seconds (<code>CommandButton221</code>), but then I want to be able to cut the loop off by pressing <code>StopButton</code>.</p>\n\n<pre><code>Private Sub CommandButton221_Click()\n    If StopMacro = True Then Exit Sub\n    '[Code that I want looping, not relevant to the question]\n    testup1\nEnd Sub\n\nPublic Sub testup1()\n    RunWhen = Now + TimeValue(\"00:00:05\")\n    Application.OnTime RunWhen, \"CommandButton221_Click\", , True\nEnd Sub\n\nPublic Sub StopButton_Click()\n    StopMacro = True\nEnd Sub\n</code></pre>\n\n<p>Any suggestions as how to achieve  this would be hugely appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 3, "creation_date": 1502265852, "post_id": 45584725, "comment_id": 78128704, "body": "Hi, welcome to SO. I&#39;m sorry, but this is not a site where people write code for free. We can help you in solving your problems, but first you have to try to do something by yourself. You can easily find some parts of code you need on this site, like &quot;how to open file with VBA&quot;. And there&#39;s macro recorder in Excel. Use them and come back with things that don&#39;t work."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1502267817, "post_id": 45584725, "comment_id": 78129971, "body": "SO is not a free coding service. Flagged this one as too broad. Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">&quot;How to ask&quot;</a>, start writing code and tell us where you got stuck."}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1502284306, "creation_date": 1502284306, "answer_id": 45591692, "question_id": 45584725, "link": "https://stackoverflow.com/questions/45584725/how-to-import-file-based-on-date-on-excel/45591692#45591692", "title": "how to import file based on date on excel", "body": "<p>First suggestion is move the line of code <code>wbk.Close True</code> after <code>ActiveSheet.Paste</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 8438379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2eed510fe9e94a6727b2f44fd3108ef?s=128&d=identicon&r=PG&f=1", "display_name": "terry", "link": "https://stackoverflow.com/users/8438379/terry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1502284306, "creation_date": 1502265265, "last_edit_date": 1502284173, "question_id": 45584725, "link": "https://stackoverflow.com/questions/45584725/how-to-import-file-based-on-date-on-excel", "title": "how to import file based on date on excel", "body": "<p>Please assist as i am new to vba and excel macro. Thank you very much.\nI need to get the coding for the file and make it run on a daily basis so the process is easier. </p>\n\n<p>Photo of the code requirement i need\n<a href=\"https://i.stack.imgur.com/glUuH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/glUuH.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is what i have done so far but the code does not works</p>\n\n<pre><code>Option Explicit\n\nSub test2()\n    'DECLARE AND SET VARIABLES\n    Dim wbk As Workbook\n    Dim Filename As String\n    Dim Path As String\n    Dim date5 As String\n\n\n    date5 = Sheets(\"Main\").Range(\"C3\")\n    Path = \"D:\\Users\\451269\\Desktop\\MUREX compare\\\\\"\n    Filename = Dir(Path &amp; \"*.csv\")\n    '--------------------------------------------\n    'OPEN EXCEL FILES\n    Do While Len(Filename) &gt; 0  'IF NEXT FILE EXISTS THEN\n    Set wbk = Workbooks.Open(Path &amp; Filename)\n    Cells.Select\n    Selection.Copy\n    wbk.Close True\n    Range(\"A1\").Select\n    Sheet(\"FXSM\").Select\n    ActiveSheet.Paste\n    Filename = Dir\n\n    Loop\nEnd Sub\n</code></pre>\n"}]