[{"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1525305911, "creation_date": 1525305911, "answer_id": 50145172, "question_id": 50144917, "link": "https://stackoverflow.com/questions/50144917/ms-excel-set-value-in-a-unique-id-column-to-value-b-if-multiple-records-for-s/50145172#50145172", "title": "MS Excel: Set value in a unique id column to value &#39;B&#39;,if multiple records for same id also contain value &#39;B&#39; in a different worksheet", "body": "<p>Try,</p>\n\n<pre><code>=if(countifs(sheet2!a:a, a2, sheet2!b:b, \"B\"), \"B\", if(countifs(sheet2!a:a, a2, sheet2!b:b, \"A\"), \"A\", text(,))) \n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 2092493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efa5cab4ec8e46672dd2d12b2ee4abe0?s=128&d=identicon&r=PG", "display_name": "user2092493", "link": "https://stackoverflow.com/users/2092493/user2092493"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525305911, "creation_date": 1525303782, "last_edit_date": 1531161705, "question_id": 50144917, "link": "https://stackoverflow.com/questions/50144917/ms-excel-set-value-in-a-unique-id-column-to-value-b-if-multiple-records-for-s", "title": "MS Excel: Set value in a unique id column to value &#39;B&#39;,if multiple records for same id also contain value &#39;B&#39; in a different worksheet", "body": "<p>I have 2 worksheets with a parent-child like structure.</p>\n\n<p>Worksheet 1:\n<a href=\"https://i.stack.imgur.com/dzouK.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>In worksheet 1, cid column is a unique id column. 'A or B?' column's value is depended on occurrence of A and B values in worksheet 2.</p>\n\n<p>Worksheet 2:\n<a href=\"https://i.stack.imgur.com/O8HvJ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Here, multiple records are associated with Cid and text value column has values A or B. </p>\n\n<p>My question is, for records associated to an id in worksheet 2, if text value contains value 'B' at least once, then the same id in worksheet 1 must be marked as 'B'.</p>\n\n<p>How do I proceed? Thanks</p>\n"}, {"tags": ["vba", "object", "shape"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1525309320, "creation_date": 1525309320, "answer_id": 50145530, "question_id": 50144785, "link": "https://stackoverflow.com/questions/50144785/vba-powerpoint-set-a-shape-as-a-variable/50145530#50145530", "title": "VBA powerpoint. set a shape as a variable", "body": "<p>Some typos in your posted code    </p>\n\n<pre><code>typename(activepresentation.slides(1).shapes(1))\n</code></pre>\n\n<p>will give you what you want i think.</p>\n"}], "owner": {"reputation": 34, "user_id": 9588300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170090a148fbde6f625387e15f0b6437?s=128&d=identicon&r=PG&f=1", "display_name": "Eugenio.Gastelum96", "link": "https://stackoverflow.com/users/9588300/eugenio-gastelum96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 832, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525309320, "creation_date": 1525302590, "question_id": 50144785, "link": "https://stackoverflow.com/questions/50144785/vba-powerpoint-set-a-shape-as-a-variable", "title": "VBA powerpoint. set a shape as a variable", "body": "<p>I have a very simple question, I have searched how to select a powerpoint shape, and the code that I've found as follows.</p>\n\n<pre><code>Presentation.Slide(1).Shape(1)\n</code></pre>\n\n<p>But when I do this </p>\n\n<pre><code>Dim a As Shape\nSet a=Presentation.Slide(1).Shape(1)\n</code></pre>\n\n<p>I get a type mismatch. What object class does the presentation.slide().shape() command returns?. The MSDN site says its a shape object (\" read only \", which I dont know what that means)\n<a href=\"https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/slide-shapes-property-powerpoint\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/slide-shapes-property-powerpoint</a>. </p>\n\n<p>So why does the code above has a mismatch error.</p>\n\n<p>Also, how can I know which class of object a line of code would return. For example, I want to write something like this in a console, to get back the class of the object it produces</p>\n\n<pre><code>Class(Presentantion.Slide(1).Shape(1))\n</code></pre>\n\n<p>(If there is a console)</p>\n"}, {"tags": ["excel", "vlookup", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1525302913, "creation_date": 1525302913, "answer_id": 50144822, "question_id": 50144551, "link": "https://stackoverflow.com/questions/50144551/excel-vba-getting-name/50144822#50144822", "title": "EXCEL VBA -Getting #NAME?", "body": "<p>This is not valid as a formula:</p>\n\n<pre><code>user_id = \"=VLOOKUP(Range(Cells(i, 3)),[RefUser.xlsx]Sheet1!$A:$B,2,FALSE)\"\n</code></pre>\n\n<p>Something like this would work:</p>\n\n<pre><code>user_id = \"=VLOOKUP(C\" &amp; i &amp; \",[RefUser.xlsx]Sheet1!$A:$B,2,FALSE)\"\n</code></pre>\n\n<p>Then set that using <code>.Formula</code> and not <code>.Value</code></p>\n\n<p>You could set all these in one shot though.  Try this:</p>\n\n<pre><code>Dim i As Integer\nDim LastRow As Integer\n\nSub TestAdd()\n\n    With Worksheets(\"Sheet1\")\n        .Range(\"B2\", .Cells(.Rows.Count, 1).End(xlUp).Offset(0,1)).Formula = _\n             \"=VLOOKUP(C2,[RefUser.xlsx]Sheet1!$A:$B,2,FALSE)\"\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "is_accepted": false, "score": 1, "last_activity_date": 1525303025, "creation_date": 1525303025, "answer_id": 50144837, "question_id": 50144551, "link": "https://stackoverflow.com/questions/50144551/excel-vba-getting-name/50144837#50144837", "title": "EXCEL VBA -Getting #NAME?", "body": "<p>To use <code>VLookup</code> you need to provide some values to the function. The signature looks like <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-vlookup-method-excel\" rel=\"nofollow noreferrer\">VLOOKUP(lookup_value,table_array,col_index_num,range_lookup)</a>.</p>\n\n<ul>\n<li><code>lookup_value</code> is the value you are expecting to find.</li>\n<li><code>table_array</code> is the range of cells that has the <code>lookup_value</code> in the leftmost column.</li>\n<li><code>col_index_num</code> is the column number that contains the information you want to return when a match is found.</li>\n<li><code>range_lookup</code> is the match that you're looking for. <code>0</code> can be used as a shorthand for False.</li>\n</ul>\n\n<p>Assuming your <code>lookup_value</code> is in cell <code>C2</code> which corresponds to <code>Cells(i,3)</code> as i starts at 2, and your <code>table_array</code> is in <code>Range(\"M1:N10\")</code>. You can use the formula <code>=VLOOKUP(C2,$M$1:$N$10,2,0)</code>. By omitting the <code>$</code> and leaving <code>C2</code> as a relative reference you can apply it to the range you want the values to be calculated. This is much more efficient then looping through and applying the the same formula to each cell individually.</p>\n\n<pre><code>Sub AddLookupFormula()\n    Dim lastRow As Long\n    lastRow = Worksheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Dim formulaRange As Range\n    Set formulaRange = ActiveSheet.Range(ActiveSheet.Cells(2, \"B\"), ActiveSheet.Cells(lastRow, \"B\"))\n\n    Dim firstLookupCell As String\n    firstLookupCell = formulaRange.Cells(1, 1).Offset(ColumnOffset:=1).Address(False, False)\n\n    Dim completedFormula As String\n    completedFormula = \"=VLOOKUP(\" &amp; firstLookupCell &amp; \",$M$1:$N$10,2,0)\"\n    formulaRange.Formula = completedFormula\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4742807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b9f533d43d09c8dffe7f38ee7bf6c5df?s=128&d=identicon&r=PG&f=1", "display_name": "Aanshi", "link": "https://stackoverflow.com/users/4742807/aanshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525303025, "creation_date": 1525300749, "last_edit_date": 1531164843, "question_id": 50144551, "link": "https://stackoverflow.com/questions/50144551/excel-vba-getting-name", "title": "EXCEL VBA -Getting #NAME?", "body": "<p>I am trying to get user' id fro another excel file. On Main excel file there is only one column with username. I wrote below but it return #Name? instead of id.     </p>\n\n<pre><code>Dim i As Integer\nDim LastRow As Integer\nDim LastColumn As Integer\nDim Client_id As Variant\nDim user_id As String\nDim Contract_id As Variant\n\n\nSub TestAdd()\nLastRow = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n'Next\n\nFor i = 2 To LastRow\nuser_id = \"=VLOOKUP(Range(Cells(i, 3)),[RefUser.xlsx]Sheet1!$A:$B,2,FALSE)\"\nRange(Cells(i, 2), Cells(LastRow, 2)).Value = user_id\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "edited": false, "score": 0, "creation_date": 1525305667, "post_id": 50144716, "comment_id": 87308346, "body": "It says the variable not defined. Sorry a bit new to excel so i am assuming that because you did option is explicit, you need to define all the variables"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "edited": false, "score": 0, "creation_date": 1525306112, "post_id": 50144716, "comment_id": 87308444, "body": "No, I just misspelled xlAscending as ascending. Fixed above."}, {"owner": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "edited": false, "score": 0, "creation_date": 1525307232, "post_id": 50144716, "comment_id": 87308668, "body": "One more thing sorry. It&#39;s giving me an error when i run it - says object not defined for the 2 lines involving LCase                                                                                            LCase(.Cells(i, &quot;A&quot;).Value2) = LCase(.Cells(i - 1, &quot;A&quot;).Value2) And       _                  LCase(.Cells(i, &quot;A&quot;).Value2) &lt;&gt; LCase(.Cells(i + 1, &quot;A&quot;).Value2) Then"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "edited": false, "score": 0, "creation_date": 1525308703, "post_id": 50144716, "comment_id": 87308985, "body": "Quite simply, that shouldn&#39;t happen."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1525306108, "last_edit_date": 1525306108, "creation_date": 1525302045, "answer_id": 50144716, "question_id": 50144432, "link": "https://stackoverflow.com/questions/50144432/copy-pasting-the-cells-when-they-are-equal-to-another-spreadsheet-using-macro/50144716#50144716", "title": "Copy pasting the cells when they are equal to another spreadsheet using Macro", "body": "<p>Given the repetitious action of adding multiple workbooks, I would shovel that operation to a 'helper' sub.</p>\n\n<pre><code>Option Explicit\n\nPublic Const strSA As String = \"C:\\Users\\kentan\\Desktop\\Managed Fund \"\n\nSub iris()\n    Dim i As Long\n    With ActiveSheet\n        With .Range(.Cells(1, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp).Offset(0, 1))\n            .Sort key1:=.Columns(1), order1:=xlAscending , _\n                  key2:=.Columns(2), order2:=xlAscending , _\n                  Header:=xlYes, MatchCase:=False, _\n                  Orientation:=xlTopToBottom, SortMethod:=xlStroke\n        End With\n\n        For i = 2 To .Rows.Count\n            If LCase(.Cells(i, \"A\").Value2) = LCase(.Cells(i - 1, \"A\").Value2) And _\n               LCase(.Cells(i, \"A\").Value2) &lt;&gt; LCase(.Cells(i + 1, \"A\").Value2) Then\n                newiris .Cells(i, \"A\").Value2, .Cells(i, \"B\").Value2\n            End If\n        Next i\n    End With\nEnd Sub\n\nSub newiris(nm As String, nfo As String)\n    Application.DisplayAlerts = false\n    With Workbooks.Add\n        Do While .Worksheets.Count &gt; 1: .Worksheets(2).Delete: Loop\n        .Worksheets(1).Cells(1, \"A\").Resize(1, 2) = Array(nm, nfo)\n        .SaveAs filename:=strSA &amp; nm, FileFormat:=xlOpenXMLWorkbook\n        .Close savechanges:=False\n    End With\n    Application.DisplayAlerts = true\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9732558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118f9c26c2244b0c32a7a45c25e5f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9732558/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 50144716, "answer_count": 1, "score": 1, "last_activity_date": 1525306108, "creation_date": 1525299912, "question_id": 50144432, "link": "https://stackoverflow.com/questions/50144432/copy-pasting-the-cells-when-they-are-equal-to-another-spreadsheet-using-macro", "title": "Copy pasting the cells when they are equal to another spreadsheet using Macro", "body": "<p>I have a work question and i want my macro to do the following</p>\n\n<p>i have two columns (column A and B). Column A has the names and column B contains their info.</p>\n\n<p>I want my macro to find duplicate names and copy both col A and B and paste them into another spreadsheet in the following location </p>\n\n<p>C:\\Users\\kentan\\Desktop\\Managed Fund</p>\n\n<p>Each spreadsheet created must contain the name of that name as the file name</p>\n\n<p>I have create the macro to do the following but it's not giving me the right result</p>\n\n<pre><code>Sub IRIS()\nDim i As Integer\nWith ActiveSheet.Sort\n.SetRange Range(\"A:B\")\n.Header = xlYes\n.MatchCase = False\n.Orientation = xlTopToBottom\n.SortMethod = xlStroke\n.Apply\n End With\n\ni=1\n\nDo Until Len(Cells(i, 1).Value) = 0\nIf Cells(i, 1).Value = Cells(i + 1, 1).Value Then\nRange(Cells(i, 1), Cells(i, 2)).Select\nSelection.Copy\nWorkbooks.Add\nRange(\"A1\").PasteSpecial\n\nActiveWorkbook.SaveAs Filename:= _\n\"C:\\Users\\kentan\\Desktop\\Managed Fund\" &amp; cells(i,1) &amp; \".xls\"\nActiveWorkbook.Close\nElse\n    i = i + 1\nEnd If\nLoop\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "dom", "web-scraping", "htmldoc"], "comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1525314014, "post_id": 50144431, "comment_id": 87310135, "body": "Among multiple problems with this code, the most striking is repeated use of code like this: <code>.getElementsByTagName(&quot;span&quot;).innerText</code>, which will never work, as <code>IHTMLElementCollection</code> doesn&#39;t have <code>innerText</code> property. <code>.getElementsByTagName(&quot;SPAN&quot;)(0).innerText</code> is an example of proper use of <code>innerText</code> after calling <code>GetElementsByTagName</code>. <code>SPAN</code> is upper case as all tags should be in this method. Likewise, you can&#39;t assign to <code>IHTMLElement</code> collections generated by <code>GetElementsByTagName</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525358546, "post_id": 50144431, "comment_id": 87333423, "body": "You have a number of previous questions which don&#39;t have accepted answers or feedback so I hope you will do me the courtesy of responding."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525434963, "post_id": 50144431, "comment_id": 87365541, "body": "Did you try the solution below?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1525374534, "last_edit_date": 1525374534, "creation_date": 1525353597, "answer_id": 50156096, "question_id": 50144431, "link": "https://stackoverflow.com/questions/50144431/why-isnt-my-vba-code-pulling-information-from-a-websites-htmldoc/50156096#50156096", "title": "Why isn&#39;t my VBA code pulling information from a website&#39;s HTMLDoc?", "body": "<p>This extracts the info. You haven't looped all the results pages in your code or mentioned it so I have set this up to show you how to do the first page of results. Let me know how this goes.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub FinalMantaSub()     '&lt;== Can't have ad blocker enabled for this site\n\n    Dim IE As New SHDocVw.InternetExplorer\n    Dim HTMLDoc As MSHTML.HTMLDocument\n\n    IE.Visible = True\n    IE.navigate \"https://www.manta.com/search?search_source=business&amp;search=general+hospitals&amp;search_location=Dallas+TX&amp;pt=32.7825%2C-96.8207\"\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Loop\n\n    Set HTMLDoc = IE.document\n\n    Dim c As Object, i As Long\n\n    Set c = HTMLDoc.querySelectorAll(\"div.media-body\")\n\n    Do While Not c(i) Is Nothing\n        Debug.Print \"Result #\" &amp; i + 1\n        Debug.Print vbNewLine\n        Debug.Print \"Name: \" &amp; c(i).querySelector(\"[itemprop=\"\"name\"\"]\").innerText\n        Debug.Print \"Address: \" &amp; c(i).querySelector(\"[itemprop=\"\"address\"\"]\").innerText\n        Debug.Print \"Phone: \" &amp; c(i).querySelector(\"[itemprop=\"\"telephone\"\"]\").innerText\n        Debug.Print String$(20, Chr$(61))\n        i = i + 1\n    Loop\n    IE.Quit\nEnd Sub\n</code></pre>\n\n<p><strong>Snapshot of output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/zcLCL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zcLCL.png\" alt=\"Snapshot\"></a></p>\n\n<p>Update: </p>\n\n<p>There are a vast number of results but you can have an outer loop as follows. You could then turn the above in to a sub that is called. </p>\n\n<pre><code>    Dim arr() As String, pageNo As Long\n    arr = Split(HTMLDoc.querySelector(\".pagination.pagination-md.mll a\").href, \"&amp;pt\")\n    pageNo = 1\n\n    Do While Err.Number = 0\n\n        On Error GoTo Errhand:\n\n        Dim url As String\n        url = Split(arr(0), \"&amp;\")(0) &amp; \"&amp;pg=\" &amp; pageNo &amp; \"&amp;pt\" &amp; arr(1)\n        Debug.Print url\n        IE.navigate url\n        Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE\n            DoEvents\n        Loop\n        pageNo = pageNo + 1\n    Loop\n\nErrhand:\n    Debug.Print \"Stopped after \" &amp; pageNo &amp; \" pages.\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9143299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625daa1b5c9f5f7e9a680637554d49a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ty B.", "link": "https://stackoverflow.com/users/9143299/ty-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1557430601, "creation_date": 1525299909, "last_edit_date": 1557430601, "question_id": 50144431, "link": "https://stackoverflow.com/questions/50144431/why-isnt-my-vba-code-pulling-information-from-a-websites-htmldoc", "title": "Why isn&#39;t my VBA code pulling information from a website&#39;s HTMLDoc?", "body": "<p>I'm not sure why my code isn't working (returning business names, phone numbers, and contact numbers from a website's HTMLDoc I'm trying to pull information from. Can you help identify what I'm doing incorrectly (most likely with the IHTMLElement and IHTMLElementCollection data types, and/or accessing the HTML through getElementsByTagName, getElementsByClassName, etc). Thank you!!</p>\n\n<pre><code>Option Explicit\n\nSub FinalMantaSub()\nDim IE As New SHDocVw.InternetExplorer\nDim HTMLDoc As MSHTML.HTMLDocument\n\nIE.Visible = False\nIE.navigate \"https://www.manta.com/search?search_source=business&amp;search=general+hospitals&amp;search_location=Dallas+TX&amp;pt=32.7825%2C-96.8207\"\n\nDo While IE.READYSTATE &lt;&gt; READYSTATE_COMPLETE\nDoEvents\nLoop\n\nSet HTMLDoc = IE.document\n\nRange(\"A3\").Value = \"Name\"\nRange(\"B3\").Value = \"Address\"\nRange(\"C3\").Value = \"Phone\"\n\n'variables to output on excel sheet\nDim BusinessNameFinal As String\nDim BusinessAddressFinal As String\nDim BusinessPhoneFinal As String\n\n'variables used to create final BusinessAddress variable\nDim streetAddress As IHTMLElement\nDim addressLocality As IHTMLElement\nDim addressRegion As IHTMLElement\nDim postalCode As IHTMLElement\n\nDim itemprop As String\nDim itemprop2 As String\n\nDim BusinessNameCollection As IHTMLElementCollection\nDim BusinessName As IHTMLElement\nDim BusinessAddressCollection As IHTMLElementCollection\nDim BusinessAddress As IHTMLElement\nDim BusinessPhoneCollection As IHTMLElementCollection\nDim BusinessPhone As IHTMLElement\n\nDim RowNumber As Long\n\n'get ready for business name looping\nRowNumber = 4\nSet BusinessName = HTMLDoc.getElementsByClassName(\"media-heading text-primary h4\")(0).getElementsByTagName(\"strong\").innerText\nSet BusinessNameCollection = BusinessName.all\n\n    'loop for business names\n    For Each BusinessName In BusinessNameCollection\n        Cells(RowNumber, 1).Value = BusinessName\n        RowNumber = RowNumber + 1\n    Next BusinessName\n\n'get ready for business address looping\nRowNumber = 4\nitemprop = HTMLDoc.getElementsByClassName(\"mvm mhn\").getElementsByTagName(\"span\").getAttribute(\"itemprop\")\n    If itemprop = \"streetAddress\" Then\n        Set streetAddress = HTMLDoc.getElementsByClassName(\"mvm mhn\").getElementsByTagName(\"span\").innerText\n    ElseIf itemprop = \"addressLocality\" Then\n        Set addressLocality = HTMLDoc.getElementsByTagName(\"span\").innerText\n    ElseIf itemprop = \"addressRegion\" Then\n        Set addressRegion = HTMLDoc.getElementsByTagName(\"span\").innerText\n    ElseIf itemprop = \"postalCode\" Then\n        Set postalCode = HTMLDoc.getElementsByTagName(\"span\").innerText\n    End If\nSet BusinessAddress = streetAddress &amp; addressLocality &amp; addressRegion &amp; postalCode\nSet BusinessAddressCollection = BusinessAddress.all\n\n    'loop for business addresses\n    For Each BusinessAddress In BusinessAddressCollection\n        BusinessAddress = streetAddress &amp; vbNewLine &amp; addressLocality &amp; \", \" &amp; addressRegion &amp; \" \" &amp; postalCode\n        Cells(RowNumber, 2).Value = BusinessAddress\n        RowNumber = RowNumber + 1\n    Next BusinessAddress\n\n'get ready for business phone looping\nRowNumber = 4\nitemprop2 = HTMLDoc.getElementsByClassName(\"hidden-device-xs\")(0).getAttribute(\"itemprop\")\n    If itemprop2 = \"telephone\" Then\n        BusinessPhone = HTMLDoc.getElementsByClassName(\"hidden-device-xs\")(0).getElementsByTagName(\"strong\").innerText\n    End If\nSet BusinessPhone = HTMLDoc.getElementsByClassName(\"hidden-device-xs\")(0).getElementsByTagName(\"strong\").innerText\nSet BusinessPhoneCollection = BusinessPhone.all\n\n    'loop for business phones\n    For Each BusinessPhone In BusinessPhoneCollection\n        Cells(RowNumber, 3).Value = BusinessPhone\n        RowNumber = RowNumber + 1\n    Next BusinessPhone\n\nRange(\"A1\").Activate\nSet HTMLDoc = Nothing\n\n 'do some final formatting\n Range(\"A3\").CurrentRegion.WrapText = False\n Range(\"A3\").CurrentRegion.EntireColumn.AutoFit\n Range(\"A1:C1\").EntireColumn.HorizontalAlignment = xlCenter\n Range(\"A1:D1\").Merge\n Range(\"A1\").Value = \"Manta.com Business Contacts\"\n Range(\"A1\").Font.Bold = True\n Application.StatusBar = \"\"\n MsgBox \"Done!\"\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525367757, "post_id": 50144128, "comment_id": 87338991, "body": "Try using a RichText type of content control instead of a Picture content control."}], "owner": {"reputation": 11, "user_id": 9732428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b09eac300e98284fa409f7b2aacd0370?s=128&d=identicon&r=PG&f=1", "display_name": "Slugmaster", "link": "https://stackoverflow.com/users/9732428/slugmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525298175, "creation_date": 1525298175, "last_edit_date": 1531164843, "question_id": 50144128, "link": "https://stackoverflow.com/questions/50144128/paste-excel-table-into-word-content-control", "title": "Paste Excel Table into Word Content Control", "body": "<p>I have a macro that will paste an excel table into a word content control.  The excel table is range named dTable2.  The word content control is wTable2.  This works, but the table inside the word content control is hard to format and manipulate.</p>\n\n<pre><code>Application.Goto Sheets(\"Table Pg 2\").Range(\"dTable2\")\nSelection.copy\nwordDoc.SelectContentControlsByTag(\"wTable2\").Item(1).Range.PasteExcelTable _\n      LinkedToExcel:=False, _\n      WordFormatting:=False, _\n      RTF:=False\n</code></pre>\n\n<p>Is it possible to paste an enhanced metafile into the word content control?  For my use it is easier to format, etc.  For some reason this does not work. It will paste outside the content control in word.</p>\n\n<pre><code>wordDoc.SelectContentControlsByTag(\"wTable2\").Item(1).Range.PasteSpecial \nDataType:=EnhancedMetaFile\n</code></pre>\n"}, {"tags": ["ms-access", "stored-procedures", "vba"], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 6416249, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f3f0ce5f7ff1fcc71edd8356b546ca8?s=128&d=identicon&r=PG", "display_name": "Ricardo Villagrana", "link": "https://stackoverflow.com/users/6416249/ricardo-villagrana"}, "edited": false, "score": 0, "creation_date": 1525298750, "post_id": 50144165, "comment_id": 87306666, "body": "Thanks, forgot the possibility of inner join when update"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1525298406, "creation_date": 1525298406, "answer_id": 50144165, "question_id": 50144058, "link": "https://stackoverflow.com/questions/50144058/ms-access-vba-improve-script/50144165#50144165", "title": "MS Access VBA improve script", "body": "<p>You should be able to do this in a single query:</p>\n\n<pre><code>UPDATE Tab_personal_3 t3\nINNER JOIN Tab_personal_2 t2 ON t2.ID = t3.ID\nSET t3.RFC = t2.RFC\n</code></pre>\n\n<p>Of course, you can execute this query through VBA, if you wish. But storing the query allows Access to store the execution plan, and increase the speed on the query.</p>\n"}, {"tags": [], "owner": {"reputation": 241, "user_id": 7297332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VB8cW.jpg?s=128&g=1", "display_name": "jshort", "link": "https://stackoverflow.com/users/7297332/jshort"}, "is_accepted": false, "score": 0, "last_activity_date": 1525298508, "creation_date": 1525298508, "answer_id": 50144174, "question_id": 50144058, "link": "https://stackoverflow.com/questions/50144058/ms-access-vba-improve-script/50144174#50144174", "title": "MS Access VBA improve script", "body": "<p>I believe a single update query will work if the tables share an ID field:</p>\n\n<pre><code>UPDATE Tab_personal_3 INNER JOIN Tab_personal_2 ON Tab_personal_3.ageing_collection = Tab_personal_2.Id SET Tab_personal_3.RFC = Tab_personal_2.RFC;\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 6416249, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f3f0ce5f7ff1fcc71edd8356b546ca8?s=128&d=identicon&r=PG", "display_name": "Ricardo Villagrana", "link": "https://stackoverflow.com/users/6416249/ricardo-villagrana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50144165, "answer_count": 2, "score": 0, "last_activity_date": 1525298508, "creation_date": 1525297862, "last_edit_date": 1525298439, "question_id": 50144058, "link": "https://stackoverflow.com/questions/50144058/ms-access-vba-improve-script", "title": "MS Access VBA improve script", "body": "<p>I have this code in MS Access (I did it in VBA becasue I didn't find the way to create a <strong>procedure</strong> in Access). What it does is simple, it takes a field form a table and replace the value in another table where the ID is the same.</p>\n\n<p>How can I get this faster? It is currently taking 8 minutes more or less to get it done (processor is always under 20%, so it is not about processor power).</p>\n\n<pre><code>Set rst = CurrentDb.OpenRecordset(\"Tab_personal_2\")\n\n rst.MoveFirst\n\n DoCmd.SetWarnings False\n\n Do Until rst.EOF\n    DoCmd.RunSQL (\"UPDATE Tab_personal_3 SET RFC = '\" &amp; rst(\"RFC\") &amp; \"' WHERE Id = \" &amp; rst(\"Id\"))\n    rst.MoveNext\n\n Loop\n</code></pre>\n"}, {"tags": ["excel", "vba", "controls", "activex", "userform"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1538472032, "post_id": 50144020, "comment_id": 92145063, "body": "Came about this post through one of your comments. Makes a great cannonical!"}], "answers": [{"comments": [{"owner": {"reputation": 14124, "user_id": 25197, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/cf458a6960715c6015e5324ef18a9350?s=128&d=identicon&r=PG", "display_name": "GollyJer", "link": "https://stackoverflow.com/users/25197/gollyjer"}, "edited": false, "score": 2, "creation_date": 1573090358, "post_id": 50144021, "comment_id": 103771287, "body": "This is beautiful. Thank you! \ud83c\udf89"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 32, "last_activity_date": 1525297624, "creation_date": 1525297624, "answer_id": 50144021, "question_id": 50144020, "link": "https://stackoverflow.com/questions/50144020/differences-between-excels-form-controls-activex-controls/50144021#50144021", "title": "Differences between Excel&#39;s Form Controls &amp; ActiveX Controls", "body": "<p>There is [eternal] confusion surrounding the <strong>two</strong> types of controls available to Excel \u2014 exacerbated by the contrasting <em>terminology</em> used by different online sources.  </p>\n\n<p>This is only a <strong>general overview of the differences between <em>Form Controls</em> and <em>ActiveX Controls</em></strong> (based on my old notes that helped me finally figure out the differences!) Visit the included links for more detailed information about each control including code and sample projects.  \u263a</p>\n\n<p><sup>(Adapted from my original post <a href=\"https://stackoverflow.com/q/49258380/8112776\"><strong>here</strong></a> \u2014 now closed)</sup></p>\n\n<hr>\n\n<h1>Overview:</h1>\n\n<ul>\n<li><p>There are <strong>two</strong> types of controls: <strong>Form controls</strong> and <strong>ActiveX controls</strong>:</p>\n\n<ul>\n<li><p><strong>Both</strong> types of controls can be used on worksheets but <strong>only ActiveX</strong> controls can be used on <strong>userforms</strong>.</p></li>\n<li><p><strong>Form controls are part of the <em>Shapes</em> collection</strong> (just like Drawing Objects), and thus are referred to like:   <img src=\"https://i.stack.imgur.com/n5Nj2.png\" alt=\"*&lt;code&gt;worksheet&lt;/code&gt;* **&lt;code&gt;.&lt;/code&gt; &lt;code&gt;Shapes(&quot;&lt;/code&gt;** *&lt;code&gt;controlname&lt;/code&gt;* **&lt;code&gt;&quot;)&lt;/code&gt;**\"></p></li>\n<li><p>ActiveX controls are basically part of the worksheet and are therefore referred to like:<br>\n<img src=\"https://i.stack.imgur.com/8RIgF.png\" alt=\"*&lt;code&gt;worksheet&lt;/code&gt;* **&lt;code&gt;.&lt;/code&gt;** *&lt;code&gt;controlname&lt;/code&gt;*\"></p></li>\n<li><p><strong>Both</strong> types of controls can be created, modified and deleted from either the worksheet, or programmatically with VBA, however, the 2 types of controls have slightly varying syntax when using VBA to refer to them.</p></li>\n</ul></li>\n<li><p>Some sites discuss also discuss a <strong>Data Form</strong>. This is <strong>nothing more than a userform</strong> made specifically for data entry/manipulation of data, so it would've made more sense to call them (the more familiar sounding) <strong><em>\"Data Entry Userform\"</em></strong>.</p></li>\n<li><p>Office documentation also occasionally refers to a <strong>worksheet</strong> as a form.  While this is <em>technically</em> correct, don't let this confuse you. Think of the word \"form\" as being used in a <em>general sense</em>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/t3W36.png\" alt=\"dictionary image: form\"></p></li>\n</ul>\n\n<hr>\n\n<h1>Two Types of Controls</h1>\n\n<ol>\n<li><p><strong>Form Controls</strong></p></li>\n<li><p><strong>ActiveX Controls</strong></p></li>\n</ol>\n\n<p>The two look, behave, and are controlled similarly, but not identically. (List <a href=\"https://support.office.com/en-us/article/overview-of-forms-form-controls-and-activex-controls-on-a-worksheet-15ba7e28-8d7f-42ab-9470-ffb9ab94e7c2\" rel=\"noreferrer\">here</a>.)</p>\n\n<p>For example, let's compare the two types of <strong>Combo Boxes</strong>.  In some programming languages, comparable controls are referred to as a <em>\"drop-down menu\"</em> or <em>\"drop-down list\"</em>. In Excel, we have a <em>\"<strong>Form Control Combo Box</strong>\"</em>, and an <em>\"<strong>ActiveX Control Combo Box</strong>\"</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/koo9h.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/koo9h.png\" alt=\"compare control types\"></a>  <sup>(Click image to enlarge.)</sup>  </p>\n\n<p>\u2606 <sub>\"Default name\" applies to controls created <em>manually</em>.  Controls created programmatically do not have (or require) a default name and therefore should have one assigned immediately upon creation. </sub></p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/hSxhw.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/hSxhw.png\" alt=\"differences between controls\"></a></p>\n\n<p><sup>(Source: <a href=\"https://stackoverflow.com/a/48957591/8112776\">my answer</a>)</sup></p>\n\n<hr>\n\n<h2>Control Availability</h2>\n\n<p>This image below shows which common controls are <em>generally</em> available for use in Worksheets and User Forms.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/EZQpB.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/EZQpB.jpg\" alt=\"chart of controls\"></a></p>\n\n<p>Other factors may affect control availability.</p>\n\n<ul>\n<li><p>Office.com : <a href=\"https://support.office.com/article/why-are-form-related-commands-or-controls-on-the-ribbon-disabled-80be06a7-45d9-4582-9544-dfe87ecb9494\" rel=\"noreferrer\">Why are form-related commands or controls on the ribbon disabled?</a></p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/article/overview-of-forms-form-controls-and-activex-controls-on-a-worksheet-15ba7e28-8d7f-42ab-9470-ffb9ab94e7c2\" rel=\"noreferrer\">Overview of forms, Form controls, and ActiveX controls on a worksheet</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/vba/excel-vba/articles/add-controls-to-a-user-form\" rel=\"noreferrer\">Add Controls to a User Form</a></p></li>\n</ul>\n\n<hr>\n\n<blockquote>\n  <h1>About ActiveX controls and related Security Concerns</h1>\n  \n  <p><sup>An ActiveX control is an <em>extension</em> to the VBA Toolbox. You use ActiveX controls just as you would any of the standard built-in controls, such as the CheckBox control. When you add an ActiveX control to an application, it becomes part of the development and run-time environment and provides new functionality for your application.</sup></p>\n  \n  <ul>\n  <li><p><sup>An ActiveX control is implemented as an in-process server (typically a small object) that can be used in any OLE container. Note that the full functionality of an ActiveX control is available only when used within an OLE container designed to be aware of ActiveX controls.</sup></p></li>\n  <li><p><sup>This container type, called a <em>control container</em> or <strong><em>control object</em></strong>, can operate an ActiveX control by using the control\u2019s properties and methods, and receives notifications from the ActiveX control in the form of events. The following figure demonstrates this interaction:</sup></p>\n  \n  <p><img src=\"https://i.stack.imgur.com/cNLE3.gif\" alt=\"example\"><br>\n  <sub><sup>(<strong>Source</strong>: <a href=\"https://msdn.microsoft.com/en-us/library/aa733733(v=vs.60).aspx\" rel=\"noreferrer\">this</a> and <a href=\"https://msdn.microsoft.com/en-us/library/aa268985(v=vs.60).aspx\" rel=\"noreferrer\">this</a>)</sup></sub></p></li>\n  </ul>\n</blockquote>\n\n<p><strong>See also:</strong></p>\n\n<ul>\n<li><p>Wikipedia: <a href=\"https://en.wikipedia.org/wiki/ActiveX\" rel=\"noreferrer\"><strong>ActiveX</strong></a></p></li>\n<li><p>Symantec.com : <a href=\"https://i.stack.imgur.com/n5Nj2.png\" rel=\"noreferrer\"><strong>Discussion of ActiveX Vulnerabilities</strong></a></p></li>\n<li><p>How-To Geek : <a href=\"https://www.howtogeek.com/162282/what-activex-controls-are-and-why-theyre-dangerous/\" rel=\"noreferrer\"><strong>What ActiveX Controls Are and Why They\u2019re Dangerous</strong></a></p></li>\n</ul>\n\n<hr>\n\n<h2>Option Buttons (Radio Buttons)</h2>\n\n<p>In Excel, the two types of radio buttons are actually called <strong>Option Buttons</strong>.  To further confuse matters:</p>\n\n<ul>\n<li><p>the default name for the form control is <code>OptionButton1</code>.</p></li>\n<li><p>the default name for the ActiveX control is <code>Option Button 1</code>.</p></li>\n</ul>\n\n<p>A good way to distinguish them is by opening the control's Properties list (on the ribbon under the Development tab, or by right-clicking the control and choosing <code>Properties</code>, or hitting <kbd>F4</kbd>), because the ActiveX control has many more options that the simpler form control.</p>\n\n<blockquote>\n  <p><strong>Option buttons and checkboxes</strong> can be bound together (so only one option at a time can be selected from the group) by placing them in a shared <strong>Group Box</strong>.</p>\n  \n  <p>Select the group box control and then hold <kbd>Ctrl</kbd> while selecting each of the other controls that you want to group. Right-click the group box control and choose <code>Grouping</code> \u2192 <code>Group</code>.  </p>\n</blockquote>\n\n<p>The first two links below are separate sets of instructions for handling each type of option button.</p>\n\n<hr>\n\n<h1>HANDLING CONTROL EVENTS:</h1>\n\n<h2>Form control events (<code>Click</code> event only)</h2>\n\n<p>Form control events are only able to respond to one event: <strong>the <code>Click</code> event</strong>.  (More info <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/control-events\" rel=\"noreferrer\">here</a>.)  Note that <strong>this section doesn't apply to userforms</strong> since they use only ActiveX controls.</p>\n\n<p><strong>To add a procedure for the <code>Click</code> event:</strong></p>\n\n<ul>\n<li><p>Right-click the control and choose <code>Assign Macro...</code></p></li>\n<li><p>In the 'Assign Macro` Dialog:</p>\n\n<ul>\n<li><p>Select an existing procedure, and click <kbd>OK</kbd>, <em>or,</em></p></li>\n<li><p>Create a new procedure in the VBE by clicking <kbd>New...</kbd>, <em>or,</em></p></li>\n<li><p>Record a new macro by clicking <kbd>Record...</kbd>, <em>or,</em></p></li>\n<li><p>to Remove the assigned event, delete its name from <code>Macro Name</code> field and click <kbd>OK</kbd>.</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/QwGkg.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/QwGkgm.png\" alt=\"assign events\"></a> <sup>(Click image to enlarge.)</sup> </p></li>\n</ul>\n\n<p>To rename, edit or delete existing macros, hit <kbd>Alt</kbd>+<kbd>F8</kbd> to open the <code>Macro</code> interface:</p>\n\n<p><img src=\"https://i.stack.imgur.com/nMZNP.png\" alt=\"Macros dialog\"></p>\n\n<hr>\n\n<h2>ActiveX control events</h2>\n\n<p>ActiveX controls have a <strong>more extensive list</strong> of events to which they can be set up to respond. </p>\n\n<p>To assign events to ActiveX controls, right-click the control and choose <code>View Code</code>.  In the VBE, you can paste in code, or <strong>choose specific events</strong> from the drop-down list at the top-right of the VBE window. </p>\n\n<p><a href=\"https://i.stack.imgur.com/HRMvy.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/HRMvym.png\" alt=\"activeX events\"></a>  <sup>(Click image to enlarge.)</sup> </p>\n\n<h2><strong>Control event handling on a userform:</strong></h2>\n\n<p>Events can also be used in controls on userforms.  Since only ActiveX controls can be placed a userform, you'll have the \"more coding + more functionality\" trade-off.  </p>\n\n<p>ActiveX controls are added to userforms the same way as they are added to a worksheet. Keep in mind that any events assigned to the userform <em>itself</em> (ie., background) will be \"blocked\" in any areas covered up by a control, so you may need to assign the same events to the controls as well as the userform.</p>\n\n<p><strong>For example</strong>, in order to make this userform respond to <code>MouseMove</code> <strong><em>anywhere on the form</em></strong>, the same event code was applied to <em>the userform, textboxes, option buttons and the frame</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vsii3.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/vsii3.gif\" alt=\"A userform with controls responding to events\"></a></p>\n\n<hr>\n\n<h1>VBA EXAMPLES</h1>\n\n<h2>Add/Modify/Delete a form control option button using VBA:</h2>\n\n<pre><code>Sub formControl_add()\n    'create form control\n    Dim ws As Worksheet: Set ws = ActiveSheet\n    With ws.Shapes.AddFormControl(xlOptionButton, 25, 25, 100, 100)\n        .Name = \"cOptionButton1\"  'name control immediately (so we can find it later)\n    End With\nEnd Sub\n\nSub formControl_modify()\n    'modify form control's properties\n    Dim ws As Worksheet: Set ws = ActiveSheet\n    ws.Shapes(\"cOptionButton1\").Select\n    With Selection 'shapes must be Selected before changing\n        .Characters.Text = \"wxyzabcd\"\n   End With\nEnd Sub\n\nSub formControl_delete()\n    'delete form control\n    Dim ws As Worksheet: Set ws = ActiveSheet\n    ws.Shapes(\"cOptionButton1\").Delete\nEnd Sub\n</code></pre>\n\n<ul>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/shapes-addshape-method-excel\" rel=\"noreferrer\">Shapes.AddShape Method (Excel)</a></p></li>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/library/office/dn301031.aspx\" rel=\"noreferrer\">Shape Properties (Excel)</a></p></li>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/characters-object-excel\" rel=\"noreferrer\">Characters Object (Excel)</a></p></li>\n</ul>\n\n<hr>\n\n<h2>Add/Modify/Delete an ActiveX command button using VBA:</h2>\n\n<pre><code>Sub activexControl_add()\n    'create ActiveX control\n    Dim ws As Worksheet: Set ws = ActiveSheet\n    With ws.OLEObjects.Add(\"Forms.CommandButton.1\")\n        .Left = 25\n        .Top = 25\n        .Width = 75\n        .Height = 75\n        .Name = \"xCommandButton1\" 'name control immediately (so we can find it later)\n    End With\nEnd Sub\n\nSub activexControl_modify()\n    ' modify activeX control's properties\n    Dim ws As Worksheet: Set ws = ActiveSheet\n    With ws.OLEObjects(\"xCommandButton1\").Object\n        .Caption = \"abcxyz\"\n        .BackColor = vbGreen\n    End With\nEnd Sub\n\nSub activexControl_delete()\n    ' delete activeX control\n    Dim ws As Worksheet: Set ws = ActiveSheet\n    ws.OLEObjects(\"xCommandButton1\").Delete\nEnd Sub\n</code></pre>\n\n<ul>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/oleobjects-add-method-excel\" rel=\"noreferrer\">OLEObjects.Add Method (Excel)</a></p></li>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/library/aa443172(v=vs.60).aspx\" rel=\"noreferrer\">BackColor, ForeColor Properties (ActiveX Controls)</a></p></li>\n</ul>\n\n<hr>\n\n<h2>Add/Remove items from a form control combo box:</h2>\n\n<pre><code>Sub ComboBox_addRemoveItems_FormControl()\n\n    Dim ws As Worksheet: Set ws = ActiveSheet\n\n    'add item to form control combo box\n    ActiveWorkbook.Sheets(\"Sheet1\").Shapes(\"Drop Down 1\").ControlFormat.AddItem \"abcd\"\n\n    'remove all items from from form control combo bo\n    ActiveWorkbook.Sheets(\"Sheet1\").Shapes(\"Drop Down 1\").ControlFormat.RemoveAllItems\n\nEnd Sub  \n</code></pre>\n\n<hr>\n\n<h2>Add/Remove items from an ActiveX combo box:</h2>\n\n<pre><code>Sub ComboBox_addRemoveItems_ActiveXControl()\n\n    Dim ws As Worksheet: Set ws = ActiveSheet\n\n    'add items to ActiveX combo box\n    ActiveWorkbook.Sheets(\"Sheet1\").ComboBox1.AddItem \"abcd\"\n\n    'remove all items from ActiveX combo box\n    ActiveWorkbook.Sheets(\"Sheet1\").ComboBox1.Clear\n\nEnd Sub  \n</code></pre>\n\n<hr>\n\n<h1>More Information:</h1>\n\n<ul>\n<li><p>Office.com : <a href=\"https://support.office.com/en-us/article/add-a-check-box-or-option-button-form-controls-9f201e46-8f6b-4a9d-a320-f44b28088cb0\" rel=\"noreferrer\">Add a checkbox or option button (<strong>Form controls</strong>)</a></p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/en-us/article/add-a-check-box-option-or-toggle-button-activex-controls-2f0c62f5-af64-49cd-aec6-de018647cae3\" rel=\"noreferrer\">Add a checkbox, option button, or toggle button (<strong>ActiveX controls</strong>)</a></p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/en-us/article/overview-of-forms-form-controls-and-activex-controls-on-a-worksheet-15ba7e28-8d7f-42ab-9470-ffb9ab94e7c2\" rel=\"noreferrer\"><strong>Overview of forms, Form controls, and ActiveX controls on a worksheet</strong></a></p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/en-us/article/enable-selection-through-choice-controls-check-and-list-boxes-c3616c0a-a898-4259-b8cc-06445349956c\" rel=\"noreferrer\"><strong>Enable selection through choice controls</strong> (check and list boxes)</a></p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/article/add-edit-find-and-delete-rows-by-using-a-data-form-17bca0a4-3ba5-444a-983c-a8ce70609374\" rel=\"noreferrer\"><strong>Add, edit, find, and delete rows by using a data form</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/ff193908(v=office.14).aspx\" rel=\"noreferrer\"><strong>VBA Shape Members</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/bb211430(v=office.12).aspx\" rel=\"noreferrer\"><strong>Using ActiveX Controls on Sheets</strong> (Office)</a></p></li>\n<li><p>Exceldemy : <a href=\"https://www.exceldemy.com/how-to-use-form-controls-in-excel/\" rel=\"noreferrer\"><strong>How to Use Form Controls in Excel</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/bb157869.aspx\" rel=\"noreferrer\"><strong>Using Windows Forms Controls on Excel Worksheets</strong> (Visual Studio)</a></p></li>\n<li><p>Microsoft TechNet : <a href=\"https://blogs.technet.microsoft.com/srd/2009/03/03/behavior-of-activex-controls-embedded-in-office-documents/\" rel=\"noreferrer\"><strong>Behaviour of ActiveX controls embedded in Office documents</strong></a></p></li>\n<li><p>Stack Overflow : <a href=\"https://stackoverflow.com/q/15455179/8112776\"><strong>What is the difference between \u201cForm Controls\u201d and \u201cActiveX Control\u201d in Excel 2010?</strong></a></p></li>\n</ul>\n"}], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13397, "favorite_count": 11, "accepted_answer_id": 50144021, "answer_count": 1, "score": 19, "last_activity_date": 1609213936, "creation_date": 1525297624, "last_edit_date": 1604766478, "question_id": 50144020, "link": "https://stackoverflow.com/questions/50144020/differences-between-excels-form-controls-activex-controls", "title": "Differences between Excel&#39;s Form Controls &amp; ActiveX Controls", "body": "<p>Why are there <strong>2 types of controls</strong> available in Excel?  <em>(2 buttons, 2 combo boxes, 2 check box, etc...)</em></p>\n\n<p>What's the difference between  <strong>Forms Controls</strong> and <strong>ActiveX Controls</strong>?  Which one should I use?</p>\n\n<p><img src=\"https://i.stack.imgur.com/0vdDK.png\" height=\"225\"/></p>\n\n<p>Some code samples I find online work with my controls, but others do not.  How come?  </p>\n\n<p>How do I work with each type, and how can I tell the difference? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 6499778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5da87fc9b8542b9d82853a664e21ca?s=128&d=identicon&r=PG&f=1", "display_name": "user46348", "link": "https://stackoverflow.com/users/6499778/user46348"}, "edited": false, "score": 0, "creation_date": 1525301461, "post_id": 50144007, "comment_id": 87307479, "body": "Thanks so much! As I said, I&#39;m just starting to learn, so didn&#39;t even know there was such a thing as a worksheet function. But it makes sense now. Though I&#39;m not sure why there would be a worksheet function that isn&#39;t automatically defined as well in the VBA/Macro universe. But that&#39;s a question for another day."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 103, "user_id": 6499778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5da87fc9b8542b9d82853a664e21ca?s=128&d=identicon&r=PG&f=1", "display_name": "user46348", "link": "https://stackoverflow.com/users/6499778/user46348"}, "edited": false, "score": 0, "creation_date": 1525302194, "post_id": 50144007, "comment_id": 87307638, "body": "Another example might be the ISNUMBER worksheet function that is called IsNumeric in vba or the IsDate function that is native to vba but has no equivalent on the worksheet."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1525297555, "creation_date": 1525297555, "answer_id": 50144007, "question_id": 50143949, "link": "https://stackoverflow.com/questions/50143949/how-to-use-istext-with-vba/50144007#50144007", "title": "How to use IsText with VBA", "body": "<p>IsText is a worksheet function. Use worksheetfunction to apply it within vba.</p>\n\n<pre><code>If worksheetfunction.IsText(ActiveCell) Then\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 6499778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5da87fc9b8542b9d82853a664e21ca?s=128&d=identicon&r=PG&f=1", "display_name": "user46348", "link": "https://stackoverflow.com/users/6499778/user46348"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2359, "favorite_count": 0, "accepted_answer_id": 50144007, "answer_count": 1, "score": 0, "last_activity_date": 1525297555, "creation_date": 1525297258, "question_id": 50143949, "link": "https://stackoverflow.com/questions/50143949/how-to-use-istext-with-vba", "title": "How to use IsText with VBA", "body": "<p>I am learning VBA and am trying to execute the code:</p>\n\n<pre><code>Sub example()\n\n    If IsText(ActiveCell) Then\n\n       MsgBox \"Is Text\"\n\n    Else: MsgBox \"Not Text\"\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>It does not work, and gives me the error, \"Compile Error: Sub or Function not defined\" with the \"IsText\" highlighted. The macro works fine if I exchange \"IsText\" for \"IsNumeric\". Thanks for the help.</p>\n"}, {"tags": ["vba", "go", "datetime-format"], "comments": [{"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 1, "creation_date": 1525297719, "post_id": 50143899, "comment_id": 87306329, "body": "For one, you&#39;re throwing away the errors (<code>_</code>) which should be checked"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 1, "creation_date": 1525297891, "post_id": 50144014, "comment_id": 87306401, "body": "That was just what I needed. Thanks for the help. The time.RFC3339 was exactly right."}], "tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": true, "score": 0, "last_activity_date": 1525297596, "creation_date": 1525297596, "answer_id": 50144014, "question_id": 50143899, "link": "https://stackoverflow.com/questions/50143899/how-to-convert-between-unusual-time-formats-golang/50144014#50144014", "title": "How to convert between unusual time formats golang", "body": "<p>Go time formats are interesting, you always have to put your formats in terms of (per the docs) <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/#Parse</a></p>\n\n<pre><code>01/02 03:04:05PM '06 -0700\n</code></pre>\n\n<p>I changed your formats a bit so you could see what is happening. I also would advise checking error returns. It also seems like <code>time.RFC3339</code> is a good shorthand for what you are looking for on the output side but I may be wrong.</p>\n\n<p><a href=\"https://play.golang.org/p/eYYdV_UE_Pa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eYYdV_UE_Pa</a></p>\n"}], "owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50144014, "answer_count": 1, "score": -2, "last_activity_date": 1525297596, "creation_date": 1525296998, "question_id": 50143899, "link": "https://stackoverflow.com/questions/50143899/how-to-convert-between-unusual-time-formats-golang", "title": "How to convert between unusual time formats golang", "body": "<p>I referenced this post: <a href=\"https://stackoverflow.com/questions/36807596/how-to-convert-date-format-in-golang\">How to convert date format in golang?</a> and have this code on the playground:</p>\n\n<p><a href=\"https://play.golang.org/p/oNFVlDz9JoF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/oNFVlDz9JoF</a></p>\n\n<p>But I can't seem to get it to work. I've padded the month with a 0 and still no dice. The time I'm trying to convert is <strong>4/20/2018 9:08:34 AM</strong> and I want it in this format: <strong>2009-04-20T21:18:44Z</strong> </p>\n\n<pre><code>NewLastDate = CDate(LastModified) 'generates 4/20/2018 9:08:34 AM \n</code></pre>\n\n<p>That's from a VBA script. 'LastModified' is in this format: <strong>dddd.ttttt VB/VBA format</strong></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525297485, "post_id": 50143777, "comment_id": 87306241, "body": "Thanks for the explanation - I dont understand what you mean about After the &quot;Business logic&quot;?"}, {"owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "reply_to_user": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525297670, "post_id": 50143777, "comment_id": 87306308, "body": "@Simon &quot;business logic&quot; is the part of your code, which uses generic functions like <code>UniqRandDigits</code> to do specific functions, in your case, filling rows based on a certain condition. But it&#39;s not important, it was just to separate the two parts of your code."}], "tags": [], "owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "is_accepted": false, "score": 1, "last_activity_date": 1525296417, "creation_date": 1525296417, "answer_id": 50143777, "question_id": 50143719, "link": "https://stackoverflow.com/questions/50143719/random-number-creating/50143777#50143777", "title": "Random number creating", "body": "<p><code>n = Int(Rnd()*10)</code> returns a value between 0 and 9, since <code>Rnd</code> returns a value between 0 and 1 and <code>Int</code> converts it to an integer, aka, a natural number.</p>\n\n<p>Then <code>If InStr(s, n) = 0</code> checks if the random number is already in your result: if not, it adds it using the string concatenation operator <code>&amp;</code>.</p>\n\n<p>This process loops (<code>do</code>) <code>until i = x + 1</code> where <code>x</code> is your input argument, so you get a string of length <code>x</code>. Then the first part just fills rows with these random strings.</p>\n\n<p>N.B. : I explained using the logical order of the code. Your friend function <code>UniqRandDigits</code> is defined after the \"business logic\", but it's the root of the code.</p>\n"}, {"tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1525297232, "creation_date": 1525297232, "answer_id": 50143944, "question_id": 50143719, "link": "https://stackoverflow.com/questions/50143719/random-number-creating/50143944#50143944", "title": "Random number creating", "body": "<p>The code loops from row 2 to 18288 in Worksheet \"arab\". If first 6 characters in 12th column are \"262015\", then in 3rd column macro will fill cell with value \"18\" followed by result of function <code>UniqueRandDigits(5)</code> which generates 5 unique digits (0-9).</p>\n\n<p>About the <code>UniqueRandDigits</code> function, the most important is that <code>Rnd()</code> returns a value lesser than 1 but greater than or equal to zero.</p>\n\n<p><code>Int</code> returns integer value, so <code>Int(Rnd() * 10)</code> will generate a random integer number from 0 to 9.</p>\n\n<p><code>If InStr(s, n) = 0 Then</code> makes sure than generated integer value doesn't exist in already generated digits of this number, because as the function name says, they must be unique.</p>\n"}], "owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525297232, "creation_date": 1525296079, "last_edit_date": 1531164843, "question_id": 50143719, "link": "https://stackoverflow.com/questions/50143719/random-number-creating", "title": "Random number creating", "body": "<p>I got some help from one, and the code works perfectly fine.</p>\n\n<p>What im looking for, is an explanation of the code, since my basic VBA-knowledge does not provide me with it.</p>\n\n<p>Can someone explain what happens from \"Function\" and down?</p>\n\n<pre><code>Sub Opgave8()\n\nFor i = 2 To 18288\n    If Left(Worksheets(\"arab\").Cells(i, 12), 6) = \"262015\" Then\n        Worksheets(\"arab\").Cells(i, 3) = \"18\" &amp; UniqueRandDigits(5)\n    End If\nNext i\nEnd Sub\nFunction UniqueRandDigits(x As Long) As String\nDim i As Long\nDim n As Integer\nDim s As String\nDo\nn = Int(Rnd() * 10)\nIf InStr(s, n) = 0 Then\ns = s &amp; n\ni = i + 1\nEnd If\nLoop Until i = x + 1\n\nUniqueRandDigits = s\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1525295981, "post_id": 50143645, "comment_id": 87305605, "body": "<code>(&quot;S&quot; &amp; LastRow2 + 1 &amp; &quot;:Z&quot; &amp; LastRow2 + 1)</code>"}, {"owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1525297781, "post_id": 50143645, "comment_id": 87306357, "body": "That works perfectly, thank you!"}], "owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525295585, "creation_date": 1525295585, "question_id": 50143645, "link": "https://stackoverflow.com/questions/50143645/formatting-range-column-s-to-z-based-on-lastrow-all-at-once", "title": "Formatting Range Column S to Z based on LastRow all at Once", "body": "<p>Probably a softball for all you VBA wizards out there but...</p>\n\n<p>How can I select the range of S:Z all at once to format without having to select them individually ?  I tried to work with </p>\n\n<p><code>Range(\"S\" &amp; LastRow2 + 1 : \"Z\" &amp; LastRow2 + 1)</code> but that doesn't seem to work.  Pretty sure I'm missing something obvious here.</p>\n\n<pre><code>Range(\"S\" &amp; LastRow2 + 1).NumberFormat = \"$#,##0.0000\"\nRange(\"T\" &amp; LastRow2 + 1).NumberFormat = \"$#,##0.0000\"\nRange(\"U\" &amp; LastRow2 + 1).NumberFormat = \"$#,##0.0000\"\nRange(\"V\" &amp; LastRow2 + 1).NumberFormat = \"$#,##0.0000\"\nRange(\"W\" &amp; LastRow2 + 1).NumberFormat = \"$#,##0.0000\"\nRange(\"X\" &amp; LastRow2 + 1).NumberFormat = \"$#,##0.0000\"\nRange(\"Y\" &amp; LastRow2 + 1).NumberFormat = \"$#,##0.0000\"\nRange(\"Z\" &amp; LastRow2 + 1).NumberFormat = \"$#,##0.0000\"\n</code></pre>\n"}, {"tags": ["excel", "filter", "delete-row", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525704015, "post_id": 50143582, "comment_id": 87450472, "body": "&quot;Doesn&#39;t do anything&quot; Like.. none of that code fires at all. Have you set a breakpoint to see if it reaches any of it? Is your errorhandler being hit instead? Everything looks fine, so this is more of a debugging thing which is difficult to do over the internet."}, {"owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525852269, "post_id": 50143582, "comment_id": 87513602, "body": "Hi JNevill, the code runs to the end and does everything except filter the tables and delete the visible lines."}], "owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525701962, "creation_date": 1525295310, "last_edit_date": 1531161705, "question_id": 50143582, "link": "https://stackoverflow.com/questions/50143582/excel-vba-filter-tables-and-delete-visible-cells-not-working", "title": "Excel VBA filter tables and delete visible cells not working", "body": "<p>I've got the code below, which all worked perfectly fine. I added a section to filter different named tables on their corresponding sheets, delete the visible rows, count the rows and filter and delete again. This section of the code [after \"Next kfp 'Filter tables and Delete\", added a lot of space to find easier] worked as a separate macro on a different workbook but it does not do anything when added to this code (I just added a section of the whole code before and after the problem section. If more is needed I can send the whole code if it helps).</p>\n\n<p>Any help will be appreciated. </p>\n\n<pre><code>For kfp = 0 To UBound(FillPages)\n' Get the page and table information.\nSet sh = Sheets(FillPages(kfp))\nTableName = \"Table_\" &amp; Replace(sh.Name, \" \", \"_\")\nSet tbl = sh.ListObjects(TableName)\n\n'clear out any old data in the table\nClearTable sh.Name, TableName\n\n' Loop through headers on table on the sheet\nFor kth = 1 To tbl.HeaderRowRange.Count\n    HeaderNameT = tbl.HeaderRowRange(kth)\n\n    ' Does the template have a match in the map\n    Set rng = Range(\"Table_Map[Template]\").Find(HeaderNameT, LookIn:=xlValues, lookat:=xlWhole)\n\n    ' If a match is found\n    If Not rng Is Nothing Then\n        HeaderNameD = rng.Offset(0, -1)\n        ' copy the column from data to template\n        Range(\"Table_Data[\" &amp; HeaderNameD &amp; \"]\").Copy Range(TableName &amp; \"[\" &amp; HeaderNameT &amp; \"]\")\n    End If\nNext kth\nNext kfp\n\n\n\n\n\n'Filter tables and Delete\nDim i As Long\n'Filter, delete, count: Out of Stock sheet\n    With Worksheets(\"Out of Stock\").ListObjects(\"Table_Out_of_Stock\")\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"Roster\").Index, Criteria1:=\"&lt;&gt;4\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"RP Type\").Index, Criteria1:=\"=NoRoster\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"SOH\").Index, Criteria1:=\"&lt;&gt;0\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n    End With\n\n' Count Instances and add to cells: Out of Stock sheet\nDim InstVal As Integer\n    InstVal = Worksheets(\"Out of Stock\").ListObjects(\"Table_Out_of_Stock\").ListRows.Count\n    Worksheets(\"Out of Stock\").Range(\"O14\") = InstVal\n\n    With Worksheets(\"Out of Stock\").ListObjects(\"Table_Out_of_Stock\")\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"SOH\").Index, Criteria1:=\"&lt;&gt;0\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n    End With\n\n'Filter, delete, count: Overstock\n    With Worksheets(\"Overstock\").ListObjects(\"Table_Overstock\")\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"Ranging\").Index, Criteria1:=\"&lt;&gt;4\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n    End With\n\n' Count Instances and add to cells: Out of Stock sheet\n    InstVal = Worksheets(\"Overstock\").ListObjects(\"Table_Overstock\").ListRows.Count\n    Worksheets(\"Overstock\").Range(\"P14\") = InstVal\n'Filter, delete, count: Outdated Stock Counts\n    With Worksheets(\"Outdated Stock Counts\").ListObjects(\"Table_Outdated_Stock_Counts\")\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"Ranging\").Index, Criteria1:=\"&lt;&gt;4\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"SOH\").Index, Criteria1:=\"=0\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n    End With\n' Count Instances and add to cells: Outdated Stock Counts\n    InstVal = Worksheets(\"Outdated Stock Counts\").ListObjects(\"Table_Outdated Stock Counts\").ListRows.Count\n    Worksheets(\"Outdated Stock Counts\").Range(\"N14\") = InstVal\n'Filter, delete, count: Dormant Stock\n    With Worksheets(\"Dormant Stock\").ListObjects(\"Table_Dormant_Stock\")\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"Ranging\").Index, Criteria1:=\"&lt;&gt;4\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"SOH\").Index, Criteria1:=\"&lt;=0\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n    End With\n' Count Instances and add to cells: Dormant Stock\n    InstVal = Worksheets(\"Dormant Stock\").ListObjects(\"Table_Dormant_Stock\").ListRows.Count\n    Worksheets(\"Dormant Stock\").Range(\"L14\") = InstVal\n\n    'Filter, delete, count: Negative Stock\n    With Worksheets(\"Negative Stock\").ListObjects(\"Table_Negative_Stock\")\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"Ranging\").Index, Criteria1:=\"&lt;&gt;4\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n    End With\n\n' Count Instances and add to cells: Negative Stock\n    InstVal = Worksheets(\"Negative Stock\").ListObjects(\"Table_Negative_Stock\").ListRows.Count\n    Worksheets(\"Negative Stock\").Range(\"M14\") = InstVal\n\n    With Worksheets(\"Negative Stock\").ListObjects(\"Table_Negative_Stock\")\n        .Range.AutoFilter\n        .Range.AutoFilter Field:=.ListColumns(\"SOH\").Index, Criteria1:=\"&gt;=0\"\n        .Range.Offset(1).EntireRow.Delete\n        .Range.AutoFilter\n    End With\n'Error Handling section.\nErrorHandler:\nSelect Case Err.Number\n        'Common error #1: file path or workbook name is wrong.\n        Case 1004\n            Application.ScreenUpdating = True\n            MsgBox \"The workbook could not be found in the path\" &amp; vbCrLf &amp; MyPath &amp; \".\"\n        Exit Sub\n       'General case: turn screenupdating back on, and exit.\n        Case Else\n            Application.ScreenUpdating = True\n        Exit Sub\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1525294430, "post_id": 50143328, "comment_id": 87304968, "body": "without the url, it&#39;s difficult to help. But in your case, I would do a Loop to check all buttons and try to get the one you want comparing the class attribute or something else. Check the HTML code, because there must be something that helps you to identify that button as unique."}, {"owner": {"reputation": 11, "user_id": 9732321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716fce5b98bb0d08e1c4caf4a3ec0d20?s=128&d=identicon&r=PG&f=1", "display_name": "JonerZ", "link": "https://stackoverflow.com/users/9732321/jonerz"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1525299521, "post_id": 50143328, "comment_id": 87306928, "body": "Heres the website <a href=\"https://www.legacy.com/obituaries/commercialappeal/browse\" rel=\"nofollow noreferrer\">legacy.com/obituaries/commercialappeal/browse</a> I need to press each view obituary button and extract the full description"}, {"owner": {"reputation": 11, "user_id": 9732321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716fce5b98bb0d08e1c4caf4a3ec0d20?s=128&d=identicon&r=PG&f=1", "display_name": "JonerZ", "link": "https://stackoverflow.com/users/9732321/jonerz"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1525299840, "post_id": 50143328, "comment_id": 87307032, "body": "I examined the code a bit further, I believe what dignifies the separation of obituary buttons would be &quot;data react Id&quot; but I think they&#39;re constantly changing with updates to each different death"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1525301528, "post_id": 50143328, "comment_id": 87307494, "body": "There are links connected to each obituary button. So, first parse those relevant links and then create http request to each of those links using <code>xmlhttp</code> request. That&#39;s it."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1525454080, "last_edit_date": 1525454080, "creation_date": 1525446986, "answer_id": 50178174, "question_id": 50143328, "link": "https://stackoverflow.com/questions/50143328/trying-to-web-scrape-from-website-into-excel-then-convert-into-word-doc/50178174#50178174", "title": "Trying to web scrape from website into excel, then convert into word doc", "body": "<p>So this was trickier than expected as I had problems getting the whole results set. In the end I went with <a href=\"http://florentbr.github.io/SeleniumBasic/\" rel=\"nofollow noreferrer\">selenium basic</a> as it handled the initial page load better and I didn't get repeated warnings about cookies and the like. To be honest that may be because I used Chrome Driver! The driver can be changed of course so another supported browser type.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\n'281 Results on 2018-05-04 '16:00\nPublic Sub test()\n\n    Dim d As WebDriver\n    Set d = New ChromeDriver\n\n    With d\n        .Start \"Chrome\"\n        .Get \"https://www.legacy.com/obituaries/commercialappeal/browse?view=name\"\n\n        Dim elements  As List\n        Set elements = d.FindElementsByTag(\"a\").Attribute(\"href\")\n\n        Dim hrefCollection As New Collection, i As Long\n\n        For i = 1 To elements.Count\n            If InStr(elements(i), \"https://www.legacy.com/obituaries/commercialappeal/obituary.aspx?n=\") &gt; 0 Then\n                If i = 1 Then\n                    hrefCollection.Add elements(i)\n                ElseIf i &gt; 1 And elements(i) &lt;&gt; elements(i - 1) Then\n                    hrefCollection.Add elements(i)\n                End If\n            End If\n        Next i\n    End With\n\n    Dim wrdApp As Object, wrdDoc As Object\n    Set wrdApp = CreateObject(\"Word.Application\")\n    wrdApp.Visible = True\n\n    Set wrdDoc = wrdApp.Documents.Add\n\n    With wrdApp.ActiveDocument.PageSetup\n        .Orientation = 1                         'wdOrientLandscape\n        .TopMargin = wrdApp.InchesToPoints(0.98)\n        .BottomMargin = wrdApp.InchesToPoints(0.98)\n        .LeftMargin = wrdApp.InchesToPoints(0.98)\n        .RightMargin = wrdApp.InchesToPoints(0.98)\n    End With\n\n    With wrdDoc\n        .Styles.Add (\"SHeading\")\n        .Styles.Add (\"StdText\")\n\n        With .Styles(\"SHeading\").Font\n            .Name = \"Arial\"\n            .Size = 14\n            .Bold = False\n            .Underline = True\n        End With\n        With .Styles(\"StdText\").Font\n            .Name = \"Arial\"\n            .Size = 8\n            .Bold = False\n            .Underline = False\n        End With\n    End With\n\n    wrdApp.Selection.Collapse Direction:=0       'wdCollapseEnd\n\n    For i = 1 To 2                               '&lt;== Test example to get two results\n        DoEvents\n        wrdApp.Selection.TypeParagraph\n        wrdApp.Selection.Style = wrdDoc.Styles(\"SHeading\")\n        wrdApp.Selection.TypeText Text:=GetInfo(hrefCollection.Item(i), d)\n    Next i\n\n    '   For Each Item In hrefCollection  ''&lt;== use this above to get all results\n    '       DoEvents\n    '       wrdApp.Selection.TypeParagraph\n    '       wrdApp.Selection.Style = wrdDoc.Styles(\"SHeading\")\n    '       wrdApp.Selection.TypeText Text:=GetInfo(hrefCollection.Item(i), d)\n    '   Next Item\n\n    d.Quit\nEnd Sub\n\nPublic Function GetInfo(ByVal url As String, ByVal d As WebDriver) As String\n    With d\n        .Get url\n        GetInfo = d.FindElementByClass(\"ObitTextContent\").Text\n    End With\nEnd Function\n</code></pre>\n\n<p><strong>Note:</strong> </p>\n\n<ol>\n<li>I am not going to show the output as not sure obituaries need to be on this site.</li>\n<li>Credit to <a href=\"https://stackoverflow.com/questions/22569182/writing-formatting-word-document-using-excel-vba?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">@Kyo</a> who's Word code I hijacked. You will need to tidy this into what you need.</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 9732321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716fce5b98bb0d08e1c4caf4a3ec0d20?s=128&d=identicon&r=PG&f=1", "display_name": "JonerZ", "link": "https://stackoverflow.com/users/9732321/jonerz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525454080, "creation_date": 1525294072, "last_edit_date": 1531164843, "question_id": 50143328, "link": "https://stackoverflow.com/questions/50143328/trying-to-web-scrape-from-website-into-excel-then-convert-into-word-doc", "title": "Trying to web scrape from website into excel, then convert into word doc", "body": "<p>So I have been assigned to scrape some information off of a website. The information is pretty heavy, and I need to click individual \"read more\" buttons in order to get the full information. After I click \"read more\" I then need to go back into the previous page, click \"read more\" on the second item. Then rinse and repeat until I have all information I need. Once I have all the information, it then needs to be converted into a word document. </p>\n\n<ol>\n<li>Navigate to URL, I know how to do that</li>\n<li>Click \"button\" that said read more, The problem with that is there are over 70 buttons that say \"read more\" and I don't know how to differentiate between them</li>\n<li>Once I have all information, scrape several pieces of information, how do I get it to excel??</li>\n<li>Once information gathered into excel, how do I convert it into word?</li>\n</ol>\n\n<p>Code example: </p>\n\n<pre><code>'Bring IE up and navigate to page\n      Set ie = New SHDocVw.InternetExplorerMedium\n      ie.Visible = True\n      'Set the URL\n      strURL = \"my url\"\n      'Navigate to url\n      ie.Navigate strURL\n      'Wait for the page to show up\n</code></pre>\n\n<p>button.click?</p>\n\n<p>I am fairly new to Vba's excel option, I'm sure there are easier ways, but this is the way I am supposed to do it. Any help or tips are greatly appreciated.</p>\n\n<p>The URL is <a href=\"https://www.legacy.com/obituaries/commercialappeal/browse\" rel=\"nofollow noreferrer\">https://www.legacy.com/obituaries/commercialappeal/browse</a></p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1525295321, "post_id": 50143280, "comment_id": 87305349, "body": "On the third screen of the text to columns wizard, there is an option to skip any or all result columns."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1525308948, "last_edit_date": 1525308948, "creation_date": 1525308617, "answer_id": 50145430, "question_id": 50143280, "link": "https://stackoverflow.com/questions/50143280/break-out-line-items-in-one-cell-and-separate/50145430#50145430", "title": "Break out line items in one cell and separate", "body": "<p>Use one of the 2 versions bellow</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub ExtractDrCrV1()\n    Dim txt As String, arr As Variant, drcr As Variant, itm As Variant, r As Long\n\n    txt = Sheet1.Range(\"A1\").Value2\n    arr = Split(txt, Chr(10))\n    ReDim drcr(1 To UBound(arr), 1 To 1)\n    For Each itm In arr\n        If InStr(1, itm, \"Dr.\") &gt; 0 Or InStr(1, itm, \"Cr.\") &gt; 0 Then\n            r = r + 1\n            drcr(r, 1) = Trim$(itm)\n        End If\n    Next\n    Sheet1.Range(\"A2:A\" &amp; r + 1) = drcr\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub ExtractDrCrV2()\n\n    Const R1 = \"A1\"\n    Const R2 = \"A2\"\n\n    Application.ScreenUpdating = False\n    With Sheet1\n        .Range(R1).TextToColumns Destination:=.Range(R2), DataType:=xlDelimited, _\n                                 Other:=True, OtherChar:=Chr(10)\n        .UsedRange.Rows(2).Copy\n        .Range(R2).Offset(1).PasteSpecial Transpose:=True: .Range(R1).Select\n        With .UsedRange.Columns(1)\n         .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*Dr.*\", Operator:=xlAnd, Criteria2:=\"&lt;&gt;*Cr.*\"\n          Sheet1.UsedRange.Offset(1).EntireRow.Delete\n         .AutoFilter\n        End With\n        .UsedRange.Offset(1).Columns(1).Replace \" Cr.\", \"Cr.\"\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7242409"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525308948, "creation_date": 1525293822, "last_edit_date": 1525294822, "question_id": 50143280, "link": "https://stackoverflow.com/questions/50143280/break-out-line-items-in-one-cell-and-separate", "title": "Break out line items in one cell and separate", "body": "<p>I have data that has multiple entries in one cell and I needed the individual entries broken on into multiple cells.</p>\n\n<p>For example:</p>\n\n<p>in Cell A1 I have this data:</p>\n\n<pre><code>Corporate\nDr. 1392.9999 Accounts Receivable Reconciled\n Cr. 1092.5921 Other Revenues\n\nBack Office\nDr. 9821.0000 Accounts Payable\n Cr. 4322.9820 Redemptions Payable\n\nNote: These accounts are related to the payments received and sold.\n</code></pre>\n\n<p>I needed all of the Dr. and Cr. line items separated into separate cells.</p>\n\n<p>For example, in Cell A2 I need</p>\n\n<pre><code>Dr. 1392.9999 Accounts Receivable Reconciled\n</code></pre>\n\n<p>And cell A3 to be</p>\n\n<pre><code>Cr. 1092.5921 Other Revenues\n</code></pre>\n\n<p>And cell A4 to be</p>\n\n<pre><code>Dr. 9821.0000 Accounts Payable\n</code></pre>\n\n<p>And Cell A5 to be</p>\n\n<pre><code>Cr. 4322.9820 Redemptions Payable    \n</code></pre>\n\n<p>I tried using text to columns and using line breaks but it breaks out all of the data in the cell but I just need the Dr. and Cr. line items.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1525342244, "last_edit_date": 1525342244, "creation_date": 1525297729, "answer_id": 50144040, "question_id": 50142993, "link": "https://stackoverflow.com/questions/50142993/vba-access-dlookup-login-and-password-from-two-tables/50144040#50144040", "title": "VBA Access Dlookup login and password from two tables", "body": "<p>You can use <code>CurrentDb.OpenRecordset</code> to open recordsets based on SQL queries. You can use <code>.EOF</code> to check if the recordset is at the end of the file, thus contains 0 records.</p>\n\n<p>If you want to query multiple tables at once, you can use a <code>UNION</code> query for that.</p>\n\n<pre><code>If CurrentDb.OpenRecordset(\"SELECT 1 FROM tblMembers WHERE Member_Email = '\" &amp; Me.txtLoginID.Value &amp; \"' And Member_Password = '\" &amp; Me.txtPassword.Value &amp; \"' UNION ALL SELECT 1 FROM tblTrainers WHERE Trainer_Email = '\" &amp; Me.txtLoginID.Value &amp; \"' And Trainer_Password = '\" &amp; Me.txtPassword.Value &amp; \"'\").EOF Then\n</code></pre>\n\n<p>Note that this login code is at risk for SQL injection, and these kind of login forms are fundamentally insecure. You can easily demonstrate SQL injection by entering <code>' OR  1 = 1 OR '' = '</code> as a username, and entering a random character in the password field. That passes as a valid login if there are entries in the table. An easy fix for SQL injection is to <a href=\"https://stackoverflow.com/q/49509615/7296893\">use parameters</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 7776321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b9ef364857cb4967d27c98831bb601?s=128&d=identicon&r=PG&f=1", "display_name": "Thesman106", "link": "https://stackoverflow.com/users/7776321/thesman106"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525342244, "creation_date": 1525292592, "last_edit_date": 1525297153, "question_id": 50142993, "link": "https://stackoverflow.com/questions/50142993/vba-access-dlookup-login-and-password-from-two-tables", "title": "VBA Access Dlookup login and password from two tables", "body": "<p>I'm having issues with a login menu that I am creating for my database. For this database I have the location of the User login email and password in two locations. After I solve this issue, i'll make validate where the login details originated from to dictate which forms open, for now I have one form to open,</p>\n\n<p>For now I just want to confirm if the the user logins and passwords are valid from either table. However it can only validate the user Login and Password from from tblMembers. If I try to enter details from tblTrainers, I would keep getting a mismatch error. I am aware what this error but not too sure how it works here. </p>\n\n<p>However if I get rid off the Or statement close the statement, it works but  of course I cannot use login details from tblTrainers to login. Could anyone offer any suggestions please? Code found below.</p>\n\n<pre><code>Private Sub Command1_Click()\nIf IsNull(Me.txtLoginID) Then\n    MsgBox \"Please Enter LoginID\", vbInformation, \"Required\"\n    Me.txtLoginID.SetFocus\nElseIf IsNull(Me.txtPassword) Then\n    MsgBox \"Please Enter A Password\", vbInformation, \"Required\"\n    Me.txtPassword.SetFocus\nElse\n    If (IsNull(DLookup(\"Member_Email\", \"tblMembers\", \"Member_Email = '\" &amp; Me.txtLoginID.Value &amp; \"' And Member_Password = '\" &amp; Me.txtPassword.Value &amp; \"'\")) Or (DLookup(\"Trainer_Email\", \"tblTrainers\", \"Trainer_Email = '\" &amp; Me.txtLoginID.Value &amp; \"' And Trainer_Password = '\" &amp; Me.txtPassword.Value &amp; \"'\"))) Then\n        MsgBox \"Inccorect LoginID or Password\"\n    Else\n        DoCmd.OpenForm \"mnuMain_Menu\"\n        DoCmd.Close acForm, \"frmLogin\"\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1525292159, "post_id": 50142731, "comment_id": 87303883, "body": "Will there always be text in parentheses?"}], "answers": [{"comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1525292763, "post_id": 50142783, "comment_id": 87304197, "body": "Note: if this is used on a string without parentheses, the second split will give an error (out of bounds). However, that could be solved with an intermediate step of storing <b>all</b> the results of the second split into a variable. Then extract the last item from that array. (You could also do this in one line; however, that gets more complicated.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1525292924, "post_id": 50142783, "comment_id": 87304274, "body": "Good point; expanding the nested splits into individual code lines and adding error control based on the ubound of the result(s) should guarantee success."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1525296112, "post_id": 50142783, "comment_id": 87305669, "body": "or a check <code>If str Like &quot;*(*)*&quot; Then</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1525296493, "post_id": 50142783, "comment_id": 87305822, "body": "Actually, I would probably just append a <code>(</code> to str in which case vbnullstring would be returned if no brackets were found; e.g. <code>str = Split(Split(str, &quot;)&quot;)(0) &amp; &quot;(&quot;, &quot;(&quot;)(1)</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1525292332, "last_edit_date": 1525292332, "creation_date": 1525291813, "answer_id": 50142783, "question_id": 50142731, "link": "https://stackoverflow.com/questions/50142731/store-value-of-string-between-two-characters/50142783#50142783", "title": "Store value of string between two characters", "body": "<p>Try,</p>\n\n<pre><code>dim str as string\nstr = \"I like apples (because I don't like pears).\"\nstr = split(split(str, \")\")(0), \"(\")(1)\ndebug.print str\n</code></pre>\n\n<p>The nested Split (<code>split(str, \")\")(0)</code>) converts the string into a zero based array with two elements; e.g. <code>I like apples (because I don't like pears</code> and <code>.</code> and returns the first of these.</p>\n\n<p>The wrapping Split (<code>split(xxx, \"(\")(1)</code>) converts the return into another zero-based array with two elements; e.g. <code>I like apples</code> and <code>because I don't like pears</code> and returns the second one.</p>\n"}, {"comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1525348921, "post_id": 50154112, "comment_id": 87326673, "body": "FYI: You should probably still check for parentheses. I believe <code>InStr</code> returns a <code>0</code> when it fails; and <code>Mid</code> would error if you try to use a start position of <code>0</code>."}, {"owner": {"reputation": 1, "user_id": 9723839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bart Longeren", "link": "https://stackoverflow.com/users/9723839/bart-longeren"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1525355175, "post_id": 50154112, "comment_id": 87331012, "body": "Your right! I didn&#39;t check that. I&#39;ll check if the parentheses are there using: <code>If Not InStr(1, text, &quot;(&quot;) = 0 And Not InStr(1, text, &quot;(&quot;) = 0 Then MsgBox Mid(text, InStr(1, text, &quot;(&quot;), InStr(1, text, &quot;)&quot;) - InStr(1, text, &quot;(&quot;) + 1)</code>  Thanks @Mistella !"}], "tags": [], "owner": {"reputation": 1, "user_id": 9723839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bart Longeren", "link": "https://stackoverflow.com/users/9723839/bart-longeren"}, "is_accepted": true, "score": 0, "last_activity_date": 1525347328, "creation_date": 1525347328, "answer_id": 50154112, "question_id": 50142731, "link": "https://stackoverflow.com/questions/50142731/store-value-of-string-between-two-characters/50154112#50154112", "title": "Store value of string between two characters", "body": "<p>thanks you for your help!\nFor anyone who's having the same challenge I think I found the simplest sollution.</p>\n\n<pre><code>Sub gettextbetween()\nDim text As String\n\ntext = \"I like apples (because I don't like pears).\"\nMsgBox Mid(text, InStr(1, text, \"(\"), InStr(1, text, \")\") - InStr(1, text, \"(\") + 1)\n\nEnd Sub\n</code></pre>\n\n<p>The <strong>InStr</strong> returns the number at wich the value, in this case \"(\" is found. The <strong>Mid</strong> function can get the value of a string starting at a specific number for x amount of characters.</p>\n\n<p>Again thank you all for your help!</p>\n"}], "owner": {"reputation": 1, "user_id": 9723839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bart Longeren", "link": "https://stackoverflow.com/users/9723839/bart-longeren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 50154112, "answer_count": 2, "score": 0, "last_activity_date": 1525347328, "creation_date": 1525291624, "question_id": 50142731, "link": "https://stackoverflow.com/questions/50142731/store-value-of-string-between-two-characters", "title": "Store value of string between two characters", "body": "<p>I'm searching for a way to store the value between two characters in a string. For example a string like: \"I like apples (because I don't like pears).\".</p>\n\n<p>How would I be able to get \"because I don't like pears\" and store that in a variable?\nIs there a way to get all text between the parentheses?</p>\n\n<p>Thanks for taking the time to read this!</p>\n"}, {"tags": ["vba", "ms-access", "button", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1525293468, "post_id": 50142941, "comment_id": 87304534, "body": "Be aware that this will cause action query confirmation prompts (which you can permanently disable in Access options)."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 1, "last_activity_date": 1525292430, "creation_date": 1525292430, "answer_id": 50142941, "question_id": 50142715, "link": "https://stackoverflow.com/questions/50142715/change-values-of-table-in-access-by-pressing-a-button-on-a-form/50142941#50142941", "title": "Change values of table in Access by pressing a button on a form", "body": "<p>That is because your code looks for a form control named 'CheckBox' not a table field named <code>Checkbox</code>.</p>\n\n<p>If you want to set the <code>Checkbox</code> field of <strong>ALL</strong> records to false, use this instead:</p>\n\n<pre><code>DoCmd.RunSQL \"UPDATE TestTable SET Checkbox=False\"\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 5491045, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bbddfb34ca9f5c5f3cdd2ab13814dd8a?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/5491045/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 50142941, "answer_count": 1, "score": 0, "last_activity_date": 1593955463, "creation_date": 1525291553, "last_edit_date": 1593955463, "question_id": 50142715, "link": "https://stackoverflow.com/questions/50142715/change-values-of-table-in-access-by-pressing-a-button-on-a-form", "title": "Change values of table in Access by pressing a button on a form", "body": "<p>On an Access form I want am trying to create a button where upon pressing it, it will change all of the values in a field within a specified table to false (i.e. uncheck all of the boxes in that field). </p>\n\n<p>My current form name is <code>DataEntry</code>\nThe Button name is <code>Command77</code></p>\n\n<p>The name of the table is <code>TestTable</code>\nThe name of the field in <code>TestTable</code> is <code>CheckBox</code> (which has a Yes/No) format.</p>\n\n<p>I've tried this code but it is not working. The error is Variable Not Defined.</p>\n\n<pre><code>Private Sub Command77_Click()\nTestTable.CheckBox.Value = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "sap", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1525427886, "post_id": 50142711, "comment_id": 87361505, "body": "Maybe it&#39;s not a good idea to use <code>Dim Application As SAPFEWSELib.GuiApplication</code> as <code>Application</code>is usually a reference to Excel itself. Maybe you try <code>Dim GuiAppl As SAPFEWSELib.GuiApplication</code>. But I am guessing because your code is working for me."}, {"owner": {"reputation": 11, "user_id": 8474400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25f56e50104c12b9a90b27463ba5c61e?s=128&d=identicon&r=PG&f=1", "display_name": "josh cunningham", "link": "https://stackoverflow.com/users/8474400/josh-cunningham"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1525899971, "post_id": 50142711, "comment_id": 87542200, "body": "This actually resolved the issue.  Thank you so much for the assistance."}], "owner": {"reputation": 11, "user_id": 8474400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25f56e50104c12b9a90b27463ba5c61e?s=128&d=identicon&r=PG&f=1", "display_name": "josh cunningham", "link": "https://stackoverflow.com/users/8474400/josh-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 833, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525328790, "creation_date": 1525291539, "last_edit_date": 1531164843, "question_id": 50142711, "link": "https://stackoverflow.com/questions/50142711/set-connection-application-openconnection-crashes-excel-for-other-users", "title": "Set Connection = Application.OpenConnection crashes Excel for other users", "body": "<p>I have double checked all references match (they do) and Excel is listed under Applications in SAP; however, when others use the following code, Excel completely crashes.  </p>\n\n<p>If I run the code (pressing the created button), Excel just closes itself.  If I step through, I receive the warning message that is Excel is not responding on the line <code>Set Connection = Application.OpenConnection(\"Production\").</code></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    strVar = InputBox(\"Which Path?\" &amp; vbNewLine &amp; vbNewLine &amp; \"1 - DC to Copack\" &amp; vbNewLine &amp; vbNewLine &amp; \"2 - Copack to DC\" &amp; vbNewLine)\n    Sheet1.Cells.Clear\n\n    Call DeleteRepl\n\n    Dim SapGuiAuto As Object\n    Dim Application As SAPFEWSELib.GuiApplication\n    Dim Connection As SAPFEWSELib.GuiConnection\n    Dim i As Integer\n    Dim Conn As String\n    Dim Flag As Boolean\n\n    Flag = False\n\n    If Not IsObject(SAPguiAPP) Then\n        Set SAPguiAPP = CreateObject(\"Sapgui.ScriptingCtrl.1\")\n    End If\n\n    Set SapGuiAuto = GetObject(\"SAPGUI\")\n    Set Application = SapGuiAuto.GetScriptingEngine\n\n    If Application.Connections.Count() &gt; 0 Then\n        For i = 0 To Application.Connections.Count() - 1\n            Set Connection = Application.Children(i)\n            Conn = Connection.Description()\n            If Conn = \"Production\" Then\n                Flag = True\n                Exit For\n            End If\n        Next\n\n        If Flag = False Then\n            Set Connection = Application.OpenConnection(\"Production\")\n        End If\n\n        If Not IsObject(Session) Then\n            Set osession = Connection.Children(0)\n        End If\n</code></pre>\n\n<p>Further code continues.  </p>\n\n<p>Probably important to note, this is affecting two other users and began on the same day (April 26, 2018) for both of them.  Neither had issues prior to this date.  However, I am having zero issues with the code running for me. Also, \"Production\" is being used in replace of the actual Description.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 9536940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038b77276add349b407c8fc1e69073a4?s=128&d=identicon&r=PG&f=1", "display_name": "toucansame", "link": "https://stackoverflow.com/users/9536940/toucansame"}, "edited": false, "score": 0, "creation_date": 1525720265, "post_id": 50193809, "comment_id": 87459082, "body": "Thank you for the explanation of where I went wrong, much appreciated."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1525552578, "creation_date": 1525552578, "answer_id": 50193809, "question_id": 50142529, "link": "https://stackoverflow.com/questions/50142529/run-time-error-5-excel-date-slicer/50193809#50193809", "title": "Run Time Error 5 - Excel Date Slicer", "body": "<p>The <code>Slicers.Add Method (Excel)</code> Syntax is:</p>\n\n<p><code>expression.Add(SlicerDestination, Level, Name, Caption, Top, Left, Width, Height)</code></p>\n\n<p>You have a <code>PivotTable</code> as the <code>SlicerDestination</code></p>\n\n<p>Replace these lines:</p>\n\n<pre><code>With wb\n    Set SlcCache = .SlicerCaches.Add2(Pvt, \"Date\", \"Date\", xlTimeline)\n    With SlcCache\n        Set Slicer = .Slicers.Add(Pvt, , \"Date\", \"date\", 200, 250, 200, 200)\n    End With\n    With PvtWs\n        .Shapes.Range(Array(\"Date\")).Select\n    End With\nEnd With\n</code></pre>\n\n<p>with these lines:</p>\n\n<pre><code>Set SlcCache = wb.SlicerCaches.Add2(Pvt, \"Date\", \"Date\", xlTimeline)\nSet Slicer = SlcCache.Slicers.Add(PvtWs, , \"Date\", \"date\", 200, 250, 200, 200)\nPvtWs.Shapes.Range(Array(\"Date\")).Select\n</code></pre>\n"}], "owner": {"reputation": 164, "user_id": 9536940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038b77276add349b407c8fc1e69073a4?s=128&d=identicon&r=PG&f=1", "display_name": "toucansame", "link": "https://stackoverflow.com/users/9536940/toucansame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 50193809, "answer_count": 1, "score": 0, "last_activity_date": 1525552578, "creation_date": 1525290866, "last_edit_date": 1531161705, "question_id": 50142529, "link": "https://stackoverflow.com/questions/50142529/run-time-error-5-excel-date-slicer", "title": "Run Time Error 5 - Excel Date Slicer", "body": "<p>I am trying to add a slicer to a pivot table. I'm successfully creating the slicer cache from the pivot table, but the slicer itself gets hung up on either a Run Time Error 483 (Object Doesn't Support this property or method) or a Run Time Error 5 (Invalid Procedure call or Argument).  The latter is occurring with following configuration of the code.  The error occurs with the line <code>Set slicer = .Slicers.Add(pvt, , \"Date\", \"date\", 200, 250, 200, 200)</code></p>\n\n<pre><code>Option Explicit\n\nSub SVBsweep_pivot()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim pvtws As Worksheet\nDim scrcdatar As Range\nDim scrcdatas As String\nDim pvt As PivotTable\nDim pf As PivotField\nDim pvtcache As PivotCache\nDim slccache As SlicerCache\nDim slicer As slicer\n\nSet wb = ActiveWorkbook\nSet ws = ActiveSheet\nws.Name = \"data\"\nSet pvtws = Sheets.Add\npvtws.Name = \"pivot\"\n\nWith ws\nSet scrcdatar = Range(.Cells(1, 1), .Cells.SpecialCells(xlCellTypeLastCell))\nscrcdatas = .Name &amp; \"!\" &amp; scrcdatar.Address(ReferenceStyle:=xlR1C1)\nSet pvtcache = ActiveWorkbook.PivotCaches.Create(xlDatabase, scrcdatas)\nEnd With\n\nSet pvt = pvtcache.CreatePivotTable(pvtws.Range(\"A3\"), \"Payroll\")\n\nWith pvt\n    .PivotFields(\"Transaction\").Orientation = xlColumnField\n    .PivotFields(\"Sweep Product\").Orientation = xlRowField\n    .AddDataField .PivotFields(\"Amount\"), \"SumAmount\", xlSum\n    .DataBodyRange.NumberFormat = \"_(* #,##0.00_);_(* (#,##0.00);_(*  - ??_);_(@_)\"\n    .ColumnGrand = True\n    .RowGrand = False\n\n    For Each pf In pvt.RowFields\n        pf.DrillTo pf.Name\n    Next pf\n    For Each pf In pvt.ColumnFields\n        pf.DrillTo pf.Name\n    Next pf\n\nEnd With\n\nWith wb\n    Set slccache = .SlicerCaches.Add2(pvt, \"Date\", \"Date\", xlTimeline)\n    With slccache    \n        Set slicer = .Slicers.Add(pvt, , \"Date\", \"date\", 200, 250, 200, 200)\n    End With\n    With pvtws\n        .Shapes.Range(Array(\"Date\")).Select\n    End With\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 2, "creation_date": 1525290693, "post_id": 50142464, "comment_id": 87303195, "body": "Add a public module to your project an declare the variable there. There are ways to access the variable the way you are declaring it but unless you have very specific reasons to need it declared within your form&#39;s module, you shouldn&#39;t."}, {"owner": {"reputation": 193, "user_id": 4559128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a454607caef58000fb6cc5e45fe27b?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/4559128/billy"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1525290920, "post_id": 50142464, "comment_id": 87303293, "body": "Basically while the user is logging in on clicking login if it&#39;s successful it takes the user&#39;s ID used which is the thing I need in my next form but I can&#39;t call it"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1525290984, "post_id": 50142464, "comment_id": 87303322, "body": "If you declare the variable in public module you can set/call it from anywhere."}, {"owner": {"reputation": 193, "user_id": 4559128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a454607caef58000fb6cc5e45fe27b?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/4559128/billy"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1525291093, "post_id": 50142464, "comment_id": 87303380, "body": "Call it outside the private sub?"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525291294, "post_id": 50142464, "comment_id": 87303487, "body": "Decalre it outside the form Class Object. Like in a Module, same way you did in the Form."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1525291308, "post_id": 50142464, "comment_id": 87303491, "body": "Yes. If you put the line <code>Public ID_ As String</code> on any module that is not attached to a form/report then you can use <code>ID_</code> anywhere."}, {"owner": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "edited": false, "score": 0, "creation_date": 1525565718, "post_id": 50142464, "comment_id": 87407263, "body": "Aren&#39;t global variables frowned upon because they could accidentally be changed. Maybe a temp table to store it in a table, this means it would take a specific effort to add, change, or delete the ID_ by accident."}], "answers": [{"comments": [{"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "reply_to_user": {"reputation": 193, "user_id": 4559128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a454607caef58000fb6cc5e45fe27b?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/4559128/billy"}, "edited": false, "score": 1, "creation_date": 1525292045, "post_id": 50142746, "comment_id": 87303832, "body": "Sorry, the Project in the screen cap is part of the VBA editor. (You can also use the menu on the VBA editor, from Insert &gt; Module)"}, {"owner": {"reputation": 193, "user_id": 4559128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a454607caef58000fb6cc5e45fe27b?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/4559128/billy"}, "edited": false, "score": 0, "creation_date": 1525292406, "post_id": 50142746, "comment_id": 87303997, "body": "i found that okay, so shall i put the entire login code in there then just call that inside the private sub?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 193, "user_id": 4559128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a454607caef58000fb6cc5e45fe27b?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/4559128/billy"}, "edited": false, "score": 0, "creation_date": 1525292411, "post_id": 50142746, "comment_id": 87304000, "body": "@Billy &lt;Ctrl&gt;-G will get you into the VB Editor"}, {"owner": {"reputation": 193, "user_id": 4559128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a454607caef58000fb6cc5e45fe27b?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/4559128/billy"}, "edited": false, "score": 0, "creation_date": 1525292748, "post_id": 50142746, "comment_id": 87304186, "body": "So what would i define the ID_ as in the module for me to then run it in the actual form? and would i need to call the public variable in each form? how would I call it in another form as well"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1525358267, "post_id": 50142746, "comment_id": 87333237, "body": "Once you have defined your variable as Public in a module, then just use it as a normal variable. You don&#39;t need to do anything special to use it. Just lines like <code>ID_ = Me.CBOUsername.Column(0)</code> will work in any part"}], "tags": [], "owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "is_accepted": true, "score": 3, "last_activity_date": 1525291662, "creation_date": 1525291662, "answer_id": 50142746, "question_id": 50142464, "link": "https://stackoverflow.com/questions/50142464/how-to-create-a-public-variable-in-a-private-module/50142746#50142746", "title": "How to create a public variable in a private module", "body": "<p>It may be a little easier to explain this way.</p>\n\n<p>As an example of a global variable:</p>\n\n<pre><code>Public Global_Variable1 as String\n\nPublic Sub Procedure1()\n    Global_Variable1 = \"Test\"\nEnd Sub\n\nPublic Sub Procedure2()\n    Call Procedure1\n    MsgBox (Global_Variable1)  'return Test\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/GycwW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GycwW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Add the module by right-clicking, and using Insert > Module</p>\n"}], "owner": {"reputation": 193, "user_id": 4559128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a454607caef58000fb6cc5e45fe27b?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/4559128/billy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 50142746, "answer_count": 1, "score": 3, "last_activity_date": 1525291662, "creation_date": 1525290564, "question_id": 50142464, "link": "https://stackoverflow.com/questions/50142464/how-to-create-a-public-variable-in-a-private-module", "title": "How to create a public variable in a private module", "body": "<p>Basically It's a login form and i'm trying to save the ID which is the Me.CBOUsername.Column(0) but I get an error when i try to call it in another form.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nPublic ID_ As String\nPrivate Sub Command4_Click()\n    Dim strCBOPass As String\n    Dim strPassword As String\n\n    strCBOPass = Me.CBOUsername.Column(1)\n    strPassword = Me.txtpassword\n\n    If strCBOPass = strPassword Then\n        MsgBox \"Login Successful!\"\n        DoCmd.OpenForm \"Form1\"\n        DoCmd.Close acForm, Me.Name\n        ID_ = Me.CBOUsername.Column(0)\n\n    Else\n        MsgBox \"login Unsuccessful!\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1525289676, "post_id": 50142209, "comment_id": 87302683, "body": "How have you tried to solve it? Post your attempt(s) please."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6297381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba08b6c7b98a4fd38c79b585f3cff3fa?s=128&d=identicon&r=PG&f=1", "display_name": "Israph", "link": "https://stackoverflow.com/users/6297381/israph"}, "edited": false, "score": 0, "creation_date": 1525294233, "post_id": 50142598, "comment_id": 87304876, "body": "Almost, but can it not be over the same sheet?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1525335998, "post_id": 50142598, "comment_id": 87318384, "body": "@Maldred - I tested it and it did work, are you getting an error or what? And OP Israph - yes it&#39;s on the same sheet but it was very easy to put the word &quot;Sheet2&quot; in front of the last <code>.Cells(nur,c).value2...</code> reference - I have updated the code accordingly."}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1525336175, "last_edit_date": 1525336175, "creation_date": 1525291154, "answer_id": 50142598, "question_id": 50142209, "link": "https://stackoverflow.com/questions/50142209/repeating-values-to-next-column/50142598#50142598", "title": "repeating values to next column", "body": "<p>Try this:</p>\n\n<pre><code>Sub DoIt()\nDim nur As Long: nur = 1\nDim r As Long\nDim c As Long: c = 1\nDim lROW As Long\nWith Sheet1\n    lROW = .Cells(.Rows.Count, 1).End(xlUp).Row\n    For r = 1 To lROW\n        If .Cells(r, 1).Value2 = \"New entry\" Then\n            c = c + 1\n            nur = 1\n        End If\n        Sheet2.Cells(nur, c).Value2 = .Cells(r, 1).Value2\n        nur = nur + 1\n    Next r\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1525544338, "creation_date": 1525544338, "answer_id": 50192679, "question_id": 50142209, "link": "https://stackoverflow.com/questions/50142209/repeating-values-to-next-column/50192679#50192679", "title": "repeating values to next column", "body": "<p>Perspective is the key.\nWhat you are trying to achieve is to split and transpose a range.</p>\n\n<p>This solution post each complaint by columns in a new worksheet, it also has the option to post the complaints as a list (by rows).  </p>\n\n<p>It combines the <code>AutoFilter</code> and <code>SpecialCells</code> methods of the <code>Range</code> object in order to set a <code>Range</code> with one <code>Area</code> per complaint.</p>\n\n<p><em>Procedure:</em></p>\n\n<pre><code>Sub Range_Split_And_Transpose()\nConst kItem As String = \"New Entry\"\nDim iNewEntry As Integer, iRows As Integer\nDim wsSrc As Worksheet, wsTrg As Worksheet\nDim rgData As Range, rgArea As Range\nDim aRcrd As Variant, lRcrds As Long, bItms As Byte\n\n    iNewEntry = MsgBox( _\n        \"Do you want to include the \"\"New Entry\"\" line?\", _\n        vbApplicationModal + vbQuestion + vbYesNoCancel + vbDefaultButton2, _\n        \"Range Split &amp; Transpose\")\n    If iNewEntry = vbCancel Then Exit Sub\n\n    iRows = MsgBox( _\n        \"Do you want to post the output as a List (by rows)?\", _\n        vbApplicationModal + vbQuestion + vbYesNoCancel + vbDefaultButton1, _\n        \"Range Split &amp; Transpose\")\n    If iRows = vbCancel Then Exit Sub\n\n    Rem Set Objects\n    With ThisWorkbook\n        Set wsSrc = .Sheets(\"DATA\")\n        .Worksheets.Add After:=.Sheets(.Sheets.Count)                           'Adds Output Worksheet\n        Set wsTrg = .Worksheets(.Worksheets.Count)\n    End With\n\n    Rem Set Range Data\n    With wsSrc\n        If Not (.AutoFilter Is Nothing) Then .Cells(1).AutoFilter               'Clears AutoFilter\n        Set rgData = .Cells(1).Resize(.Cells(.Rows.Count, 1).End(xlUp).Row, 1)\n    End With\n\n    Rem Split Range Into Areas - One Area per Complaint\n    With rgData\n        .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\" &amp; kItem\n        If .Cells(1).Value2 = kItem Then .Rows(1).EntireRow.Hidden = True\n        Set rgData = .SpecialCells(xlCellTypeVisible)\n        .Rows(1).EntireRow.Hidden = False\n        .Cells(1).AutoFilter\n    End With\n\n    Rem Post New Entry Line\n    bItms = 1\n    If iNewEntry = vbYes Then\n        bItms = 2\n        With wsTrg.Cells(1, 1)\n            If iRows = vbYes Then\n                .Resize(rgData.Areas.Count, 1).Value = kItem\n            Else\n                .Resize(1, rgData.Areas.Count).Value = kItem\n    End If: End With: End If\n\n    Rem Post Output\n    lRcrds = 0\n    For Each rgArea In rgData.Areas\n\n        Rem Record to Array\n        aRcrd = WorksheetFunction.Transpose(rgArea.Value2)\n        If iRows = vbNo Then aRcrd = rgArea.Value2\n\n        Rem Post Record\n        lRcrds = 1 + lRcrds\n\n        If iRows = vbYes Then\n            wsTrg.Cells(lRcrds, bItms).Resize(1, rgArea.Rows.Count).Value2 = aRcrd\n        Else\n            wsTrg.Cells(bItms, lRcrds).Resize(rgArea.Rows.Count, 1).Value2 = aRcrd\n\n    End If:  Next\n\n    wsTrg.UsedRange.Columns.AutoFit\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1525608280, "creation_date": 1525608280, "answer_id": 50199476, "question_id": 50142209, "link": "https://stackoverflow.com/questions/50142209/repeating-values-to-next-column/50199476#50199476", "title": "repeating values to next column", "body": "<p>I would do it this way.</p>\n\n<pre><code>Sub Basic_Example_1()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, Fnum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    'Fill in the path\\folder where the files are\n    MyPath = \"C:\\Users\\Ron\\test\"\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'If there are no Excel files in the folder exit the sub\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n    'Fill the array(myFiles)with the list of Excel files in the folder\n    Fnum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        Fnum = Fnum + 1\n        ReDim Preserve MyFiles(1 To Fnum)\n        MyFiles(Fnum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Add a new workbook with one sheet\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    'Loop through all files in the array(myFiles)\n    If Fnum &gt; 0 Then\n        For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n\n                With mybook.Worksheets(1)\n                    Set sourceRange = .Range(\"A1:C1\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Copy the file name in column A\n                        With sourceRange\n                            BaseWks.cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(Fnum)\n                        End With\n\n                        'Set the destrange\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next Fnum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n\n<p>Also, consider using the AddIn listed below, especially if you need to do this often.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/addins/rdbmerge.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/addins/rdbmerge.htm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6297381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba08b6c7b98a4fd38c79b585f3cff3fa?s=128&d=identicon&r=PG&f=1", "display_name": "Israph", "link": "https://stackoverflow.com/users/6297381/israph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1525608280, "creation_date": 1525289537, "last_edit_date": 1531164843, "question_id": 50142209, "link": "https://stackoverflow.com/questions/50142209/repeating-values-to-next-column", "title": "repeating values to next column", "body": "<p>I have tried to solve this in several ways and have read a lot of different posts, but I am still stuck. I have data that is only in column A on Sheet1 as a list of several hundred entries, but is uneven, so sometimes complaint is several lines or has no resolution (or even no complaint.) However, every set of information starts with the word \"New Entry\". Therefore, I want on Sheet2 starting at column B, it to create a new column each time New Entry is encountered with all the data below it until the next \"New Entry\" is encountered. Thank you a million times over if you can help. </p>\n\n<p>Data currently:</p>\n\n<pre><code>+----+--------------------+\n|    |         A          |\n+----+--------------------+\n|  1 | New Entry          |\n|  2 | Smith, Joe         |\n|  3 | 15362              |\n|  4 | 123-456-7890       |\n|  5 | Company1           |\n|  6 | Complaint          |\n|  7 | Resolution         |\n+----+--------------------+\n|  8 | New Entry          |\n|  9 | Doe, Joe           |\n| 10 | 15361              |\n| 11 | 234-567-8901       |\n| 12 | Company2           |\n+----+--------------------+\n| 13 | New Entry          |\n| 14 | Mary, Joe          |\n| 15 | 15360              |\n| 16 | 123-097-8641       |\n| 17 | Company3           |\n| 18 | Complaint          |\n| 19 | 2nd line complaint |\n| 20 | Resolution         |\n+----+--------------------+\n| 21 | New Entry          |\n| 22 | Doe, Jane          |\n| 23 | 15366              |\n| 24 | 234-567-8910       |\n| 25 | Company4           |\n| 26 | Complaint          |\n| 27 | Resolution         |\n+----+--------------------+\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>+---+--------------+--------------+--------------------+--------------+\n|   |      A       |      B       |         C          |      D       |\n+---+--------------+--------------+--------------------+--------------+\n| 1 | New Entry    | New Entry    | New Entry          | New Entry    |\n| 2 | Smith, Joe   | Doe, Joe     | Mary, Joe          | Doe, Jane    |\n| 3 | 15362        | 15361        | 15360              | 15366        |\n| 4 | 123-456-7890 | 234-567-8901 | 123-097-8641       | 234-567-8910 |\n| 5 | Company1     | Company2     | Company3           | Company4     |\n| 6 | Complaint    |              | Complaint          | Complaint    |\n| 7 | Resolution   |              | 2nd line complaint | Resolution   |\n| 8 |              |              | Resolution         |              |\n+---+--------------+--------------+--------------------+--------------+\n</code></pre>\n\n<p>Code Attempt: (My attempt was at first by row, so I did the following code, which caused issues since the data is uneven. I thought columns might be better, if New Entry was used to start the new column.)</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n    Dim i As Range\n    Dim actualRange As Range\n    Dim tmpString As String\n    Dim dob As Range\n    Dim idn As Range\n    Dim comp As Range\n    Dim dt As Range\n    Dim rsn As Range\n    Dim rsn2 As Range\n    Dim rsn3 As Range\n\nFor Each i In Sheet1.Range(\"A1:A21303\")\n    i.Replace \"Name \", \"Name :\"\ntmpString = i.Value\n    If InStr(i.Value, \"Name :\") &gt; 0 Then\ni.Offset(0, 0).Value = Split(tmpString, \":\")(0)\ni.Offset(1, 0).Value = Split(tmpString, \":\")(1)\nSheet2.Range(\"A\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).EntireRow.Value = i.Offset(1, 0).EntireRow.Value\n    ElseIf i.Value = \"Name\" Then\n        Sheet2.Range(\"A\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).EntireRow.Value = i.Offset(1, 0).EntireRow.Value\n    End If\nNext i\n\nFor Each dob In Sheet1.Range(\"A1:A21303\")\n    If dob.Value = \"DOB\" Then\n        Sheet2.Range(\"B\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).Value = dob.Offset(1, 0).EntireRow.Value\n    End If\nNext dob\n\nFor Each idn In Sheet1.Range(\"A1:A21303\")\n    If idn.Value = \"ID Number\" Then\n        Sheet2.Range(\"C\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).Value = idn.Offset(1, 0).EntireRow.Value\n    End If\nNext idn\n\nFor Each comp In Sheet1.Range(\"A1:A21303\")\n    If comp.Value = \"Company\" Then\n        Sheet2.Range(\"D\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).Value = comp.Offset(1, 0).EntireRow.Value\n    End If\nNext comp\n\nFor Each dt In Sheet1.Range(\"A1:A21303\")\n    If dt.Value = \"Date/Time\" Then\n        Sheet2.Range(\"E\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).Value = dt.Offset(1, 0).EntireRow.Value\n    End If\nNext dt\n\nFor Each rsn In Sheet1.Range(\"A1:A21303\")\n    If rsn.Value = \"Complaint\" Then\n        Sheet2.Range(\"F\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).Value = rsn.Offset(1, 0).EntireRow.Value\n    End If\nNext rsn\n\nFor Each rsn2 In Sheet1.Range(\"A1:A21303\")\n    If rsn2.Value = \"Complaint\" Then\n        Sheet2.Range(\"G\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).Value = rsn2.Offset(2, 0).EntireRow.Value\n    End If\nNext rsn2\n\nFor Each rsn3 In Sheet1.Range(\"A1:A21303\")\n    If rsn3.Value = \"Complaint\" Then\n        Sheet2.Range(\"H\" &amp; Sheet2.Rows.Count).End(xlUp).Offset(1, 0).Value = rsn3.Offset(3, 0).EntireRow.Value\n    End If\nNext rsn3\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 2, "creation_date": 1525290310, "post_id": 50142122, "comment_id": 87302996, "body": "From the looks of the error, the table you are trying to update does not contain those column names (or at least 4 of them). Post the info for your table for additional assistance."}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1525290625, "creation_date": 1525290625, "answer_id": 50142483, "question_id": 50142122, "link": "https://stackoverflow.com/questions/50142122/run-time-error-3061-too-few-parameters-expected-4/50142483#50142483", "title": "Run time error 3061 Too few parameters expected 4", "body": "<p>Just a guess from looking at your SQL and the error - I suspect your 4 field names with two words should likely have spaces between the two words: <code>[FirstName]</code> becomes <code>[First Name]</code>, <code>[Last Name]</code> becomes <code>[Last Name]</code> and so on</p>\n\n<p>So SQL string should actually be</p>\n\n<pre><code>\"UPDATE Customer set [First Name] = \" &amp; Me.FirstName &amp; _\n                                        \" ,[Last Name] = \" &amp; Me.LastName &amp; _\n                                        \" ,[Phone Number] = '\" &amp; Me.PhoneNumber &amp; _\n                                        \"' ,[Address] = '\" &amp; Me.Address &amp; _\n                                        \"' ,[City] = \" &amp; Me.City &amp; _\n                                        \" ,[State] = \" &amp; Me.State &amp; _\n                                        \" ,[Zip Code] = \" &amp; Me.ZipCode &amp; \" WHERE ([E-mail] = '\" &amp; Me.email &amp; \"')\"\n</code></pre>\n\n<p>As @Jiggles32 says - the only way to know for sure is to show us your field names from the Customer table</p>\n"}, {"comments": [{"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1525316021, "post_id": 50143869, "comment_id": 87310574, "body": "Did you accidentally leave &quot;Param&quot; off the name of LastNameParam when calling it in your UPDATE sql/Set command?"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1525355638, "last_edit_date": 1525355638, "creation_date": 1525296843, "answer_id": 50143869, "question_id": 50142122, "link": "https://stackoverflow.com/questions/50142122/run-time-error-3061-too-few-parameters-expected-4/50143869#50143869", "title": "Run time error 3061 Too few parameters expected 4", "body": "<p>Once again, consider SQL parameterization, an industry best practice when working with SQL, which <em>is</em> supported in MS Access using <code>PARAMETERS</code> clause and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193967.aspx\" rel=\"nofollow noreferrer\">QueryDefs</a>. You avoid messy concatenation, quote enclosures (which you are missing quite a bit for your text fields), and possibly SQL injection as such fields are open to users.</p>\n\n<p><strong>SQL</strong> <em>(save as a stored Access query)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS [FirstNameParam] Text(255), [LastNameParam] Text(255),\n           [PhoneNumberParam] Text(255), [AddressParam] Text(255),\n           [CityParam] Text(255), [StateParam] Text(255),\n           [ZipCodeParam] Text(255), [EmailParam] Text(255);\nUPDATE Customer \n   SET [FirstName] = [FirstNameParam],\n       [LastName] = [LastNameParam],\n       [PhoneNumber] = [PhoneNumberParam],\n       [Address] = [AddressParam],\n       [City] = [CityParam],\n       [State] = [StateParam],\n       [ZipCode] = [ZipCodeParam]\nWHERE ([E-mail] = [EmailParam]);\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim qdef As QueryDef\n\nSet qdef = CurrentDb.QueryDefs(\"mySavedParameterQuery\")\n\n' BIND VALUES TO PARAMETER PLACEHOLDERS\nqdef![FirstNameParam] = Me.FirstName\nqdef![LastNameParam] = Me.LastName\nqdef![PhoneNumberParam] = Me.PhoneNumber\nqdef![AddressParam] = Me.Address\nqdef![CityParam] = Me.City\nqdef![StateParam] = Me.State\nqdef![ZipCodeParam] = Me.ZipCode\nqdef![EmailParam] = Me.Email\n\n' EXECUTE ACTION QUERY\nqdef.Execute dbFailOnError\n\nSet qdef = Nothing\n</code></pre>\n"}], "owner": {"reputation": 846, "user_id": 5192646, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-fSAvEgSgNVY/AAAAAAAAAAI/AAAAAAAAAY4/wpqMN1S16n4/photo.jpg?sz=128", "display_name": "Sourabh Agrawal", "link": "https://stackoverflow.com/users/5192646/sourabh-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1062, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525355638, "creation_date": 1525289232, "last_edit_date": 1525290659, "question_id": 50142122, "link": "https://stackoverflow.com/questions/50142122/run-time-error-3061-too-few-parameters-expected-4", "title": "Run time error 3061 Too few parameters expected 4", "body": "<pre><code>CurrentDb.Execute \"UPDATE Customer set [FirstName] = \" &amp; Me.FirstName &amp; _\n                                    \" ,[LastName] = \" &amp; Me.LastName &amp; _\n                                    \" ,[PhoneNumber] = '\" &amp; Me.PhoneNumber &amp; _\n                                    \"' ,[Address] = '\" &amp; Me.Address &amp; _\n                                    \"' ,[City] = \" &amp; Me.City &amp; _\n                                    \" ,[State] = \" &amp; Me.State &amp; _\n                                    \" ,[ZipCode] = \" &amp; Me.ZipCode &amp; \" WHERE ([E-mail] = '\" &amp; Me.email &amp; \"')\"\n</code></pre>\n\n<p>what is wrong with this update query. Please help.</p>\n"}, {"tags": ["excel", "vba", "sap"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1525428381, "post_id": 50142068, "comment_id": 87361794, "body": "I think you have to give us the information what are you doing in SAP. The part of the code you show is okay. I do not see any problem there."}, {"owner": {"reputation": 85, "user_id": 9049645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ad355ee09213e1ffad1d0406f730ed?s=128&d=identicon&r=PG&f=1", "display_name": "M_Delineshev", "link": "https://stackoverflow.com/users/9049645/m-delineshev"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1525760601, "post_id": 50142068, "comment_id": 87471480, "body": "Hi, it is not a problem with my code, i use similar code in other transactions and operations and it works out fine. The problem is with SAP or Excel, as SAP takes too long to complete the operation and Exce gives the error i made a screenshot of. So how can i make Excel not wait for the OLE..."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1525762134, "post_id": 50142068, "comment_id": 87472196, "body": "Then maybe <a href=\"https://stackoverflow.com/questions/44288799/how-to-deal-with-microsoft-excel-is-waiting-for-another-application-to-complete\">this</a> helps"}, {"owner": {"reputation": 85, "user_id": 9049645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ad355ee09213e1ffad1d0406f730ed?s=128&d=identicon&r=PG&f=1", "display_name": "M_Delineshev", "link": "https://stackoverflow.com/users/9049645/m-delineshev"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1525962460, "post_id": 50142068, "comment_id": 87567023, "body": "Thank you Storax!"}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 9049645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ad355ee09213e1ffad1d0406f730ed?s=128&d=identicon&r=PG&f=1", "display_name": "M_Delineshev", "link": "https://stackoverflow.com/users/9049645/m-delineshev"}, "is_accepted": true, "score": 2, "last_activity_date": 1568808535, "last_edit_date": 1568808535, "creation_date": 1525962555, "answer_id": 50275308, "question_id": 50142068, "link": "https://stackoverflow.com/questions/50142068/how-can-i-handle-waiting-for-another-application-sap-to-complete-an-ole-action/50275308#50275308", "title": "How can I handle waiting for another application (SAP) to complete an OLE action?", "body": "<p>Storax above actually gave a link to another topic with the solution of the question.</p>\n\n<p>Code here:</p>\n\n<pre><code>Private Declare Function _\n    CoRegisterMessageFilter Lib \"OLE32.DLL\" _\n    (ByVal lFilterIn As Long, _\n    ByRef lPreviousFilter) As Long\n\nSub KillMessageFilter()  \n    '''Original script Rob Bovey  \n\n    '''https://groups.google.com/forum/?hl=en#!msg/microsoft.public.excel.programming/ct8NRT-o7rs/jawi42S8Ci0J\n    '''http://www.appspro.com/\n\n    Dim lMsgFilter As Long\n\n    ''' Remove the message filter before calling Reflections.\n    CoRegisterMessageFilter 0&amp;, lMsgFilter\n\n    ''' Call your code here....\n\n    ''' Restore the message filter after calling Reflections.\n    CoRegisterMessageFilter lMsgFilter, lMsgFilter\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1537787830, "post_id": 52478062, "comment_id": 91897253, "body": "While this might answer the authors question, it lacks some explaining words and links to documentation. Raw code snippets are not very helpful without some phrases around it. You may also find <a href=\"https://stackoverflow.com/help/how-to-answer\">how to write a good answer</a> very helpful. Please edit your answer."}], "tags": [], "owner": {"reputation": 33, "user_id": 10407532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f638a36b75a12c3ef41d90efada6e921?s=128&d=identicon&r=PG", "display_name": "a_babich", "link": "https://stackoverflow.com/users/10407532/a-babich"}, "is_accepted": false, "score": 1, "last_activity_date": 1537794007, "last_edit_date": 1537794007, "creation_date": 1537787557, "answer_id": 52478062, "question_id": 50142068, "link": "https://stackoverflow.com/questions/50142068/how-can-i-handle-waiting-for-another-application-sap-to-complete-an-ole-action/52478062#52478062", "title": "How can I handle waiting for another application (SAP) to complete an OLE action?", "body": "<p>If you use 64-bit Microsoft Office you should slightly change the code offered by M_Delineshev according to the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/declare-statement\" rel=\"nofollow noreferrer\">Declare Statement</a>. Try to use this version:</p>\n\n<pre><code>Private Declare PtrSafe Function _\n    CoRegisterMessageFilter Lib \"OLE32.DLL\" _\n    (ByVal lFilterIn As Long, _\n    ByRef lPreviousFilter) As LongPtr\n\n\nSub KillMessageFilter() '''Original script Rob Bovey\n\n'''https://groups.google.com/forum/?hl=en#!msg/microsoft.public.excel.programming/ct8NRT-o7rs/jawi42S8Ci0J '''http://www.appspro.com/\n\nDim lMsgFilter As Long\n\n''' Remove the message filter before calling Reflections. CoRegisterMessageFilter 0&amp;, lMsgFilter\n\n''' Call your code here....\n\n''' Restore the message filter after calling Reflections. CoRegisterMessageFilter lMsgFilter, lMsgFilter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 777, "user_id": 1536905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uv8A8.jpg?s=128&g=1", "display_name": "ravichandra vydhya", "link": "https://stackoverflow.com/users/1536905/ravichandra-vydhya"}, "is_accepted": false, "score": 0, "last_activity_date": 1568807648, "creation_date": 1568807648, "answer_id": 57992180, "question_id": 50142068, "link": "https://stackoverflow.com/questions/50142068/how-can-i-handle-waiting-for-another-application-sap-to-complete-an-ole-action/57992180#57992180", "title": "How can I handle waiting for another application (SAP) to complete an OLE action?", "body": "<p>This following code worked for me...</p>\n\n<pre><code>Private Declare PtrSafe Function CoRegisterMessageFilter Lib \"OLE32.DLL\" (ByVal lFilterIn As Long, ByRef lPreviousFilter) As Long\n\nSub IgnoreMessages()\n\nDim lMsgFilter As Long\n\nCoRegisterMessageFilter 0&amp;, lMsgFilter\n\n'Write your code here\n\nCoRegisterMessageFilter lMsgFilter, lMsgFilter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 9049645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ad355ee09213e1ffad1d0406f730ed?s=128&d=identicon&r=PG&f=1", "display_name": "M_Delineshev", "link": "https://stackoverflow.com/users/9049645/m-delineshev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4591, "favorite_count": 0, "accepted_answer_id": 50275308, "answer_count": 3, "score": 2, "last_activity_date": 1604974004, "creation_date": 1525288967, "last_edit_date": 1572257531, "question_id": 50142068, "link": "https://stackoverflow.com/questions/50142068/how-can-i-handle-waiting-for-another-application-sap-to-complete-an-ole-action", "title": "How can I handle waiting for another application (SAP) to complete an OLE action?", "body": "<p>I am trying to automate a process in SAP.</p>\n\n<p>I recorded a series of procedures and pasted the code in a macro sheet. I make Excel read the VBA code with the following commands:</p>\n\n<pre><code>Dim SapGuiAuto As Object\nDim Application As Object\nDim Connection As Object\nDim Session As Object\n\nSet SapGuiAuto = GetObject(\"SAPGUI\")\nSet Application = SapGuiAuto.GetScriptingEngine\nSet Connection = Application.Children(0)\nSet Session = Connection.Children(0)\n</code></pre>\n\n<p>For one of the parts SAP makes a lot of calculations which takes a few minutes and around the middle of it, Excel generates the message:<br>\n<a href=\"https://i.stack.imgur.com/yNyE8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yNyE8.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have to click OK to continue, then it pops-up non-stop and I have to do it like 10-15 times, which removes the point of automation.</p>\n\n<p>When doing it without a macro, SAP does not give me any error.</p>\n\n<p>I tried turning it off with </p>\n\n<pre><code>Application.DisplayAlerts = False\n</code></pre>\n\n<p>It instead gives me:<br>\n<a href=\"https://i.stack.imgur.com/G9W5T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G9W5T.png\" alt=\"enter image description here\"></a></p>\n\n<p>I searched the net and the site, but there was barely any useful info maybe because my question is too specific.</p>\n\n<p>Some additional info:<br>\n1. My laptop is from work and I cannot install any additional software or updates to it without permission.<br>\n2. I tried checking the Excel option for DDE, but it only gives me an error when I try to run the script.<br>\n<a href=\"https://i.stack.imgur.com/I7ygd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I7ygd.png\" alt=\"enter image description here\"></a></p>\n\n<p>My Excel version is 2013.</p>\n\n<p>How can I achieve one of the three solutions I can think of:<br>\n1. Disable the pop up for OLE<br>\n2. Make it automatically click OK every time it appears<br>\n3. Make Excel freeze and wait while SAP does its thing? (Don't know if that makes sense.) Tried with <code>Application.Wait</code>, but without success</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 1, "creation_date": 1525289020, "post_id": 50141985, "comment_id": 87302323, "body": "Wrap everything after <code>Not</code> in parentheses."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1525289314, "post_id": 50142098, "comment_id": 87302491, "body": "Just kidding this works. +1. (I was testing with no value for <code>Last</code> doh)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1525289581, "post_id": 50142098, "comment_id": 87302632, "body": "@dwirony - thanks, if it&#39;s easy to do I tend to check code as never 100% sure it will work. And those Not/Or/And questions make my head hurt."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1525289120, "creation_date": 1525289120, "answer_id": 50142098, "question_id": 50141985, "link": "https://stackoverflow.com/questions/50141985/using-or-logical-operator-for-comparing-strings/50142098#50142098", "title": "Using &quot;OR&quot; Logical Operator For Comparing Strings", "body": "<p>Think you just got your parentheses a little mixed up. You just need one enclosing the whole clause after the Not.</p>\n\n<pre><code>For i = Last To 2 Step -1\n    If Not (Cells(i, \"A\").Value Like \"*exe\" Or Cells(i, \"A\").Value Like \"*dll\" Or Cells(i, \"A\").Value Like \"*ocx\") Then\n        Cells(i, \"A\").EntireRow.Delete\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9732019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c868be18dd2eeab94ed1c06012efe5a?s=128&d=identicon&r=PG&f=1", "display_name": "Kabi", "link": "https://stackoverflow.com/users/9732019/kabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 50142098, "answer_count": 1, "score": 0, "last_activity_date": 1525289120, "creation_date": 1525288652, "last_edit_date": 1531161705, "question_id": 50141985, "link": "https://stackoverflow.com/questions/50141985/using-or-logical-operator-for-comparing-strings", "title": "Using &quot;OR&quot; Logical Operator For Comparing Strings", "body": "<pre><code>For i = Last To 2 Step -1\n    If Not (Cells(i, \"A\").Value) Like \"*exe\" Or (Cells(i, \"A\").Value) Like \"*dll\" Or (Cells(i, \"A\").Value) Like \"*ocx\" Then\n        Cells(i, \"A\").EntireRow.Delete\n    End If\nNext i\n</code></pre>\n\n<p>Hi everyone, I'm a little new to VBA and was wondering if I could get some assistance. What I'm trying to do here is delete any rows that don't end with \"exe\", \"dll\", or \"ocx\". Executing this as is, it will delete all rows that don't end with \"exe\". Not sure if I'm using the right syntax in this case. I'd already tried searching the forum like I usually do but I'm stumped this time ... would appreciate any help and apologies if this has been asked before. Thanks!</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "edited": false, "score": 0, "creation_date": 1525320108, "post_id": 50143159, "comment_id": 87311631, "body": "It seems from the above code that the popup will show for all the emails however I don&#39;t want to see the popup for all the emails. I have a list of 150 people, so the popup will only show when I try to send the emails to the person who is not in the list of 150 people. Is it possible ?"}, {"owner": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "edited": false, "score": 0, "creation_date": 1526124523, "post_id": 50143159, "comment_id": 87627576, "body": "Can someone please help me on this. The code is not working"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "edited": false, "score": 0, "creation_date": 1526198234, "post_id": 50143159, "comment_id": 87643891, "body": "You need to add a condition where you compare the item being sent with your list of items."}, {"owner": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "edited": false, "score": 0, "creation_date": 1526312963, "post_id": 50143159, "comment_id": 87684903, "body": "Thank you for your comment. It would be great if you could please share the code with me."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1525293298, "creation_date": 1525293298, "answer_id": 50143159, "question_id": 50141515, "link": "https://stackoverflow.com/questions/50141515/popup-will-show-in-the-outlook-for-unwanted-recipient/50143159#50143159", "title": "Popup will show in the outlook for unwanted recipient", "body": "<p>Yes, it is. You can handle the <code>ItemSend</code> event of the Application class which is fired whenever an Microsoft Outlook item is sent, either by the user through an <code>Inspector</code> (before the inspector is closed, but after the user clicks the Send button) or when the <code>Send</code> method for an Outlook item, such as <code>MailItem</code> , is used in a program.</p>\n\n<pre><code>Public WithEvents myOlApp As Outlook.Application \n\nPublic Sub Initialize_handler() \n  Set myOlApp = Outlook.Application \nEnd Sub \n\nPrivate Sub myOlApp_ItemSend(ByVal Item As Object, Cancel As Boolean) \n  Dim prompt As String \n  prompt = \"Are you sure you want to send \" &amp;; Item.Subject &amp;; \"?\" \n  If MsgBox(prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then \n    Cancel = True \n  End If \nEnd Sub\n</code></pre>\n\n<p>Instead of simply displaying a message box asking users permissions to send an Outlook item you may check the <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-recipients-property-outlook\" rel=\"nofollow noreferrer\">Recipients</a> collection (see the corresponding property of the Outlook item). It represents all the recipients for the Outlook item. So, you may check them and compare with your list. </p>\n"}], "owner": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1592993921, "creation_date": 1525286842, "last_edit_date": 1592993921, "question_id": 50141515, "link": "https://stackoverflow.com/questions/50141515/popup-will-show-in-the-outlook-for-unwanted-recipient", "title": "Popup will show in the outlook for unwanted recipient", "body": "<p>I have a list of 150 people and I don't want to send any email apart from the list. Is it possible to set a macro in the outlook where if I try to send any email to the email id which is not present in the list, I will get a popup before sending the email ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1525286706, "post_id": 50141088, "comment_id": 87301219, "body": "You know how to write a <code>For...Next</code> loop. Have you tried making one that parameterizes this hard-coded <code>(1)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525355521, "post_id": 50142658, "comment_id": 87331258, "body": "Thank you for this, but I am trying to get all data in all sheets in all selected workbooks pasted into one sheet, rather than having one workbook with multiple sheets."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525357409, "post_id": 50142658, "comment_id": 87332586, "body": "Above code has been modified. Make sure to re-name the sheet where all of the data will be pasted and modify the ranges if needed (both changes on code of course).   You may also want to add something to this to un-hide columns/rows and remove any filters if they exist on any given sheet."}, {"owner": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525362088, "post_id": 50142658, "comment_id": 87335724, "body": "I am getting a syntax error in the line:  <code>ThisWorkbook.Sheets(&quot;Desired sheet name paste range&quot;).Range(&quot;A&quot;&amp;LROW).PasteSpecial Paste:=xlPasteValues, operation:=xlNone, skipblanks _                 Next i</code>  I am not very experienced with VBA, so thank you in advance."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525365898, "post_id": 50142658, "comment_id": 87337998, "body": "Determine the name of the sheet all of your data is being pasted on. On the above line, swap &quot;Desired sheet name paste range&quot; with the actual name of your sheet. The sheet name has to be in quotes."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525368124, "post_id": 50142658, "comment_id": 87339204, "body": "@Andrew is the code doing what you need it to? If so, please hit the check box next to answer :)   If not, let me know what the issue is"}, {"owner": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525368780, "post_id": 50142658, "comment_id": 87339556, "body": "If a sheet name is entered there, an error occurs stating, &quot;Compile error: Expected: named parameter&quot; and the line &quot;Next i&quot; is highlighted."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525379846, "post_id": 50142658, "comment_id": 87344934, "body": "Did you replace the sheet name in both places? Needs to be changed twice within the i loop.   Will test it again, was working on my end earlier :)"}, {"owner": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525445502, "post_id": 50142658, "comment_id": 87372605, "body": "Yes. The moment that the sheet name is changed, a &quot;named parameter&quot; error is prompted and the &quot;Next i&quot; is highlighted."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "edited": false, "score": 0, "creation_date": 1525554223, "post_id": 50142658, "comment_id": 87405190, "body": "When you have Visual Basic editor open, it will show you the sheet names on the left. You may not have a \u201csheet1\u201d"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1525357849, "last_edit_date": 1525357849, "creation_date": 1525291346, "answer_id": 50142658, "question_id": 50141088, "link": "https://stackoverflow.com/questions/50141088/combining-excel-workbooks-but-need-the-all-worksheets-not-just-the-first/50142658#50142658", "title": "Combining Excel workbooks, but need the all worksheets, not just the first", "body": "<p>Opens multiple workbooks (1 by 1), Copies data from all sheets onto one sheet. Make sure you modify the ranges that will work for you (copy range is currently A2 to Z(last row). </p>\n\n<pre><code>Option Explicit\n\nSub MoveSheets()\n\n\nDim IndvFiles As FileDialog\nDim Currentbook As Workbook\nDim x As Integer\nDim i As Integer\nDim CurrentSheets As Integer\nDim BookCount As Integer\n\n'Opens File Dialog to Select Which Files You Want to Consolidate\n    Set IndvFiles = Application.FileDialog(msoFileDialogOpen)\n    With IndvFiles\n        .AllowMultiSelect = True\n        .Title = \"Multi-select target data files:\"\n        .ButtonName = \"\"\n        .Filters.Clear\n        .Show\n    End With\n\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nCurrentSheets = ThisWorkbook.Worksheets.Count\nBookCount = IndvFiles.SelectedItems.Count\nDim LROW as Long\nDIM LROW2 as Long\nDIM Import as Range\n\n        For x = 1 To BookCount\n            On Error GoTo StopHere:\n\n            Set Currentbook = Workbooks.Open(IndvFiles.SelectedItems(X))\n\n                For i = 1 To Currentbook.Worksheets.Count\n                    LROW = thisworkbook.sheets(\"desired sheet name paste\").Range(\"A2\").End(XLdown).Rows\n                    LROW2=currentbook.sheets(i).Range(\"A2\").End(XLdown).Rows\n                         Set Import = currentbook.sheets(i).Range(\"A2:Z\"&amp;LROW2)\n                         Import.Copy\n                              ThisWorkbook.Sheets(\"Desired sheet name paste range\").Range(\"A\"&amp;LROW).PasteSpecial Paste:=xlPasteValues, operation:=xlNone, skipblanks _\n                Next i\n                Currentbook.Close False\n        Next x\n\nStopHere:\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9731242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Andrew ", "link": "https://stackoverflow.com/users/9731242/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525357849, "creation_date": 1525285000, "question_id": 50141088, "link": "https://stackoverflow.com/questions/50141088/combining-excel-workbooks-but-need-the-all-worksheets-not-just-the-first", "title": "Combining Excel workbooks, but need the all worksheets, not just the first", "body": "<p>I found this VBA code that works for combining workbooks in a folder, however, I need to modify it so that <strong>all worksheets in each workbook are copy/pasted</strong> and not just the first worksheet of each workbook. As of now, only the first worksheet in each selected workbook is being copied over. Where can I insert code to find data in all worksheets?</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub MergeSelectedWorkbooks()\nDim SummarySheet As Worksheet\nDim FolderPath As String\nDim SelectedFiles() As Variant\nDim NRow As Long\nDim FileName As String\nDim NFile As Long\nDim WorkBk As Workbook\nDim SourceRange As Range\nDim DestRange As Range\n\n' Create a new workbook and set a variable to the first sheet.\nSet SummarySheet = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\n' Modify this folder path to point to the files you want to use.\nFolderPath = \"S:\\example\"\n\n' Set the current directory to the the folder path.\nChDrive FolderPath\nChDir FolderPath\n\n' Open the file dialog box and filter on Excel files, allowing multiple files\n' to be selected.\nSelectedFiles = Application.GetOpenFilename( _\n    filefilter:=\"Excel Files (*.xl*), *.xl*\", MultiSelect:=True)\n\n' NRow keeps track of where to insert new rows in the destination workbook.\nNRow = 1\n\n' Loop through the list of returned file names\nFor NFile = LBound(SelectedFiles) To UBound(SelectedFiles)\n    ' Set FileName to be the current workbook file name to open.\n    FileName = SelectedFiles(NFile)\n\n    ' Open the current workbook.\n    Set WorkBk = Workbooks.Open(FileName)\n\nDim LastRow As Long\nLastRow = WorkBk.Worksheets(1).Cells.Find(What:=\"*\", _\n             After:=WorkBk.Worksheets(1).Cells.Range(\"A1\"), _\n             SearchDirection:=xlPrevious, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByRows).Row\nSet SourceRange = WorkBk.Worksheets(1).Range(\"A1:Z\" &amp; LastRow)\n\n    ' Set the destination range to start at column A and be the same size as the source range.\n    Set DestRange = SummarySheet.Range(\"A\" &amp; NRow)\n    Set DestRange = DestRange.Resize(SourceRange.Rows.Count, _\n       SourceRange.Columns.Count)\n\n    ' Copy over the values from the source to the destination.\n    DestRange.Value = SourceRange.Value\n\n    ' Increase NRow so that we know where to copy data next.\n    NRow = NRow + DestRange.Rows.Count\n\n    ' Close the source workbook without saving changes.\n    WorkBk.Close savechanges:=False\nNext NFile\n\n' Call AutoFit on the destination sheet so that all data is readable.\nSummarySheet.Columns.AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "iteration"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1525284740, "post_id": 50140901, "comment_id": 87300267, "body": "Do you need to open and close the file for every row you iterate through? Why not open and close/save outside your loop?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1525284951, "post_id": 50140901, "comment_id": 87300368, "body": "Data Validation for the file is <a href=\"https://stackoverflow.com/questions/17022702/excel-found-unreadable-content-data-validation\">corrupt</a>. Either delete the Data Validation rules manually, or fix them. But like BigBen said: there are far more efficient ways to copy the values (that should be your question)"}, {"owner": {"reputation": 23, "user_id": 9625834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8c03428a865daf58dda147aa27fbfd?s=128&d=identicon&r=PG&f=1", "display_name": "marcel", "link": "https://stackoverflow.com/users/9625834/marcel"}, "edited": false, "score": 0, "creation_date": 1525289244, "post_id": 50140901, "comment_id": 87302446, "body": "Thanks for the fast reply!  Some of the cells in the rows contain &#39;Dropdown&#39; lists. So you mean I can&#39;t have that type of data validation while copying? I just want to copy the values basically. @paulbica1"}, {"owner": {"reputation": 23, "user_id": 9625834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8c03428a865daf58dda147aa27fbfd?s=128&d=identicon&r=PG&f=1", "display_name": "marcel", "link": "https://stackoverflow.com/users/9625834/marcel"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1525289378, "post_id": 50140901, "comment_id": 87302536, "body": "I tried that @BigBen but unfortunatelly it did not work -.-"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1525289605, "post_id": 50140901, "comment_id": 87302644, "body": "What errors are you getting? There are plenty of examples on SO of how to do this. Also research <code>xlPasteValues</code>. Post your revised code if needed."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1525297554, "post_id": 50140901, "comment_id": 87306267, "body": "I didn&#39;t get notified about your comment (you appended a <code>1</code> after my userId) - yes, I am referring to the <code>drop-downs</code> - those are created by Data Validation, and that has become corrupt. Not sure what caused the corruption, but if you fix them the copying and pasting shouldn&#39;t create an issue"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1525299845, "last_edit_date": 1525299845, "creation_date": 1525298096, "answer_id": 50144114, "question_id": 50140901, "link": "https://stackoverflow.com/questions/50140901/copy-and-paste-rows-from-one-to-another-worksheet-vba/50144114#50144114", "title": "Copy and paste rows from one to another worksheet VBA", "body": "<p>Data Validation for the file is <a href=\"https://stackoverflow.com/questions/17022702/excel-found-unreadable-content-data-validation\">corrupt</a> (dropdown lists) - either delete Data Validation, or fix it</p>\n\n<p>Once the file is fixed, the code bellow will copy the data without opening the destination file multiple times. It <code>AutoFilters</code> current sheet for empty values in column <code>BK (63)</code>, and copies all visible rows, from columns <code>BC to BK</code>, to the end of the new file (starting at first unused cell in column <code>A</code>)</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub TransferData()\n    Const OLD_COL1 = \"BC\"\n    Const OLD_COL2 = \"BK\"\n    Const NEW_COL1 = \"A\"\n    Dim oldWb As Workbook, oldWs As Worksheet, oldLR As Long\n    Dim newWb As Workbook, newWs As Worksheet, newLR As Long\n\n    On Error Resume Next 'Expected errors: new file not found, new sheet name not found\n\n    Set oldWb = ThisWorkbook\n    Set oldWs = ActiveSheet     'Or: Set oldWs = oldWb.Worksheets(\"Sheet2\")\n    oldLR = oldWs.Cells(oldWs.Rows.Count, OLD_COL1).End(xlUp).Row\n    Application.ScreenUpdating = False\n    Set newWb = Workbooks.Open(Filename:=\"PATH.xlsx\")\n    Set newWs = newWb.Worksheets(\"NewProjects\")\n    If Not newWs Is Nothing Then\n        newLR = newWs.Cells(oldWs.Rows.Count, NEW_COL1).End(xlUp).Row\n        With oldWs.Range(oldWs.Cells(2, OLD_COL2), oldWs.Cells(oldLR, OLD_COL2))\n            .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\"\n            If .SpecialCells(xlCellTypeVisible).Cells.Count &gt; 2 Then\n                oldWs.Range(oldWs.Cells(3, OLD_COL1), oldWs.Cells(oldLR, OLD_COL2)).Copy\n                newWs.Cells(newLR + 1, NEW_COL1).PasteSpecial\n                Application.CutCopyMode = False\n                newWs.Sort.SortFields.Clear\n                newWb.Close SaveChanges:=True\n            Else\n                newWb.Close SaveChanges:=False\n            End If\n            .AutoFilter\n        End With\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9625834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8c03428a865daf58dda147aa27fbfd?s=128&d=identicon&r=PG&f=1", "display_name": "marcel", "link": "https://stackoverflow.com/users/9625834/marcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 50144114, "answer_count": 1, "score": 0, "last_activity_date": 1525299845, "creation_date": 1525284210, "question_id": 50140901, "link": "https://stackoverflow.com/questions/50140901/copy-and-paste-rows-from-one-to-another-worksheet-vba", "title": "Copy and paste rows from one to another worksheet VBA", "body": "<p>I know already a few people had that problem but their solutions did not help me. I am pretty new to VBA and I want to copy a row if the respective first cell is not empty to another file and iterate as long as the data is. </p>\n\n<p>So far so good. My code runs the first time and actually works (for one line). But then the macro does not open the file again and spits out an error. If I want to manually open the target file it says: \"Removed Feature: Data Validation from /xl/worksheets/sheet2.xml part\" (and I think this is the reason why it does not iterate further). Do you have any idea what I can do?</p>\n\n<pre><code>Sub transferData()\n\nDim LastRow As Long, i As Integer, erow As Long\n\nLastRow = ActiveSheet.Range(\"BC\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 3 To LastRow\n\nIf IsEmpty(Cells(i, 63).Value) = False Then\nRange(Cells(i, 55), Cells(i, 63)).Select\nSelection.Copy\n\nWorkbooks.Open Filename:=\"PATH.xlsx\"\nWorksheets(\"NewProjects\").Select\nerow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n\nActiveSheet.Cells(erow, 1).Select\nActiveSheet.PasteSpecial\nActiveSheet.Sort.SortFields.Clear\nActiveWorkbook.Save\nActiveWorkbook.Close SaveChanges:=False\nApplication.CutCopyMode = False\nEnd If\n\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1525284259, "post_id": 50140884, "comment_id": 87300057, "body": "Excel and Access are very different. Spreadsheets and relational table-stores are only superficially similar. Do you mean want to run <code>UPDATE Inventory SET Date = @date WHERE Code = @code</code>?"}, {"owner": {"reputation": 39, "user_id": 8134472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604969559dcff8897c7f84baba8066a7?s=128&d=identicon&r=PG&f=1", "display_name": "Jet813", "link": "https://stackoverflow.com/users/8134472/jet813"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1525285609, "post_id": 50140884, "comment_id": 87300671, "body": "Yes, but how can we make it so that a user can type the item number. Will this function work using forms in Access?"}, {"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 0, "creation_date": 1525292392, "post_id": 50140884, "comment_id": 87303990, "body": "You need to create a form in order for the user to interact with the data and run vba code.  Running code in Access is not the same as running a macro in Excel.  It depends on how you want the user to interact and whether you want them to see the item before marking it as checked.  The simple way is to create a form with a textbox and a button.  Try some code and post it here."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1525354548, "creation_date": 1525354548, "answer_id": 50156426, "question_id": 50140884, "link": "https://stackoverflow.com/questions/50140884/excel-function-implemented-on-access/50156426#50156426", "title": "Excel function Implemented on Access", "body": "<p>Not sure which version of Access so I'll try to be generic:</p>\n\n<p>In Access - find the table and create a form from it (Usually by clicking a button on the toolbar). </p>\n\n<p>Switch to design view in the form, in the header add a combo box using the control wizard and ask it to \"Find a record in my form based....\" - set it to the field \"Item Code\"</p>\n\n<p>Set the visible property of the item code box in the detail section to False</p>\n\n<p>create a macro to set a property - control is \"Date\", property to set is \"Value\", value to set it to is \"=Now()\"\nSave this macro</p>\n\n<p>Add a command button, in the wizard set it to run your saved macro</p>\n"}], "owner": {"reputation": 39, "user_id": 8134472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604969559dcff8897c7f84baba8066a7?s=128&d=identicon&r=PG&f=1", "display_name": "Jet813", "link": "https://stackoverflow.com/users/8134472/jet813"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525354548, "creation_date": 1525284131, "last_edit_date": 1525328102, "question_id": 50140884, "link": "https://stackoverflow.com/questions/50140884/excel-function-implemented-on-access", "title": "Excel function Implemented on Access", "body": "<p>I am working on a \"inventory check\" Excel worksheet that finds the item code and then inserts a timedate in a the date column. </p>\n\n<p>Table has two Columns; 'Item Code' and 'Date'</p>\n\n<p>I have made a macro on Excel that basically asks for item code, and inserts the date in the corresponding cell.</p>\n\n<p>I am trying to implement this in Access. Does anyone have any references?</p>\n"}, {"tags": ["excel", "controls", "userform", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1525283826, "post_id": 50140753, "comment_id": 87299838, "body": "I once fixed a crashing Excel form with <i>many</i> controls by making sure I&#39;m referring to these controls via the <code>Controls</code> collection and never via their code names. It was weird but it worked. Try replacing all your <code>Stb.Cond1.Caption</code> with <code>Me.Controls(&quot;Stb&quot;).etc</code>."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1525289922, "post_id": 50140753, "comment_id": 87302805, "body": "@GSerg anything that could help is welcomed; thanks for the tip!"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1525293376, "post_id": 50140753, "comment_id": 87304491, "body": "@GSerg I think that&#39;s what just saved all of my crashes.  I have one more user to test on (my every time crasher), and if it works, that tip would have fixed the issue... now if we only knew an exact rationale for why that change did it."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 2, "creation_date": 1525372814, "post_id": 50140753, "comment_id": 87341599, "body": "a) I remember a former limitation Excel 2000/2003 of up to 411 UF controls that can be addressed directly by name, b) whereas controls beyond must be addressed as a member of the <b>controls collection</b> (e.g. <code>For each myControl in Me.Controls</code> or via item index). c) Manually <b>deleting</b> controls with a TabIndex property number less than 411 (e.g. labels not used in code) includes the next controls within the mentioned limitation. Note that changing this prop does not change the behavior; the behavior seems to be entirely <b>determined by the order in which the controls were created</b>."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 2, "creation_date": 1525634823, "post_id": 50140753, "comment_id": 87424276, "body": "Rationale: VBA limits <b>direct referencing</b> of UF controls, e.g. <code>Label1.Caption = &quot;...&quot;</code>. -  So you can summarize all possible solutions as follows:  [1.] Use indirect referencing via <code>Controls</code> collection (loop, index or name) [2.] Reduce the number of controls, e.g. by distributing the controls to multiple user forms [3.] Reorganize the order of the controls, e.g. by deleting static labels and adding them again (point c in above comment). - Note: The only  supporting link I knew (<a href=\"https://support.microsoft.com/en-us/kb/177842\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/177842</a>) doesn&#39;t exist any more."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1525789221, "post_id": 50140753, "comment_id": 87489033, "body": "@GSerg That was the fix to this, and TM gave rationale.  If you want to post as an answer, I can accept it.  Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1525292577, "post_id": 50142859, "comment_id": 87304093, "body": "I can probably do the same for some of the other labeling pieces.  Will give this a try then test on a few people&#39;s computers to see if I don&#39;t run into other issues.  Thank you!"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1525293443, "post_id": 50142859, "comment_id": 87304520, "body": "So far in testing, that hasn&#39;t caused issues!  Added this after doing testing with the first tip I was given, which I think resolved my major memory issue.  Will give you the +1, but if the other fellow posts his as an answer, I&#39;ll accept his.  You are very much appreciated for this, it works like a charm!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1525294352, "post_id": 50142859, "comment_id": 87304938, "body": "@Cyril No worries! I didn&#39;t think this would do anything to solve that issue - just wanted to throw this change out there."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1525292096, "creation_date": 1525292096, "answer_id": 50142859, "question_id": 50140753, "link": "https://stackoverflow.com/questions/50140753/not-enough-memory-crash-when-loading-vba-userform/50142859#50142859", "title": "Not enough memory crash when loading VBA userform", "body": "<p>I can't speak to why your Excel is crashing, but you could probably cut down some code by loading some values into an <code>Array</code>, then instead of 6 <code>For v = 0 to 28</code> loops you could have two nested loops, the inner one iterating through your array:</p>\n\n<pre><code>Dim start As Long, z As Long, arr As Variant\n\nstart = 1\narr = Array(\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\")\n\nFor v = 0 To 28\n    For z = 0 To UBound(arr)\n        If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), arr(z), \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; start + v).Value = True\n        start = start + 30\n    Next z\n    start = 1\nNext \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1525795334, "post_id": 50236450, "comment_id": 87493005, "body": "Again, highly appreciated.  Between you and TM&#39;s explanation in comments, I am definitely in a better place for understanding."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1525892606, "post_id": 50236450, "comment_id": 87538738, "body": "I agree that the described behavior is poorly documented. I&#39;m happy having helped by giving a rationale (even 15 years later) and by showing some possible solutions. +)"}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 3, "last_activity_date": 1525790916, "creation_date": 1525790916, "answer_id": 50236450, "question_id": 50140753, "link": "https://stackoverflow.com/questions/50140753/not-enough-memory-crash-when-loading-vba-userform/50236450#50236450", "title": "Not enough memory crash when loading VBA userform", "body": "<p>I once fixed a crashing Excel form with <em>many</em> controls by making sure the code always refers all controls via the <code>Controls</code> collection:</p>\n\n<pre><code>Me.Controls(\"Cond1\").Caption = .Cells(r, c + 1)\n</code></pre>\n\n<p>and never via their code names:</p>\n\n<pre><code>Me.Cond1.Caption = .Cells(r, c + 1)\n</code></pre>\n\n<p>It was weird, but it worked.<br>\nTry replacing all your <code>Stb.Cond1.Caption</code> with <code>Stb.Controls(\"Cond1\").Caption</code> etc.</p>\n\n<hr>\n\n<p>That was about 15 years ago, and up until today it remained unclear to me why it worked and why on Earth I even thought that utilising <code>Controls</code> in this way might have something to do with fixing it. <a href=\"https://stackoverflow.com/questions/50140753/not-enough-memory-crash-when-loading-vba-userform?noredirect=1#comment87341599_50140753\">As I learned today</a>, it is a long standing limitation in Excel on the number of controls that can be addressed directly by their name - a poorly documented limitation, and a poorly implemented one too, as such a limitation must produce a compilation error rather than a runtime error at a random moment.</p>\n"}], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 4, "accepted_answer_id": 50236450, "answer_count": 2, "score": 2, "last_activity_date": 1525790916, "creation_date": 1525283579, "last_edit_date": 1531164843, "question_id": 50140753, "link": "https://stackoverflow.com/questions/50140753/not-enough-memory-crash-when-loading-vba-userform", "title": "Not enough memory crash when loading VBA userform", "body": "<p><strong>Background:</strong></p>\n\n<p>I have a VBA userform with ~1050 checkboxes, and ~100 labels, all populated from the active Sheet.  The labels are taken directly from the sheet, based on the ActiveCell.Row (t and i are the rows of specific information in relation to the ActiveCell, where there are 20 different tables on the same sheet where the userform would be pulled from when double-clicked).</p>\n\n<p>The event to load the userform (\"Stb\") is a doubleclick event which doesn't appear to cause the issue.</p>\n\n<hr>\n\n<p><strong>Issue:</strong></p>\n\n<p>Seemingly random, Excel crashes stating I am using too much memory, that I should use the x64 version if I keep having the issue.  I believe it is tied to the loop in my code.</p>\n\n<p>I have played with the quantity of lines within the loop and it has helped to not have the crash happen on all computers, but some users have older computers that crash more often than others.</p>\n\n<p>All users have 6 GB of RAM in their system (not sure how relevant that is), using Win7 and Office 365 (Office 2016).</p>\n\n<hr>\n\n<p><strong>Question:</strong></p>\n\n<p>Is there anything beyond that loop which appear to cause the memory issue?  To my limited knowledge, the storage of variables/captions has to happen in an initialization prior to the userform loading, since the userform cannot update once it has loaded.  Is my understanding wrong, where I may be able to refresh the userform while/after it is loaded?</p>\n\n<p>I need to keep all of the information in a similar format, but maybe I am missing out on efficiencies... anything to help in that direction would be appreciated (I know that is better suited towards Code Review, though the code does not work if the system crashes).</p>\n\n<hr>\n\n<p><strong>Code in Question:</strong></p>\n\n<p>Sorry this is a bit long.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim r As Long, c As Long, i As Long, t As Long, v As Long\n    r = ActiveCell.Row\n    c = 3\n    Select Case r\n        Case 25 To 44 '1\n            i = 52\n            t = 24\n        Case 115 To 134 '2\n            i = 142\n            t = 114\n        Case 205 To 224 '3\n            i = 232\n            t = 204\n        Case 295 To 314 '4\n            i = 322\n            t = 294\n        Case 385 To 404 '5\n            i = 412\n            t = 384\n        Case 475 To 494 '6\n            i = 502\n            t = 474\n        Case 565 To 584 '7\n            i = 592\n            t = 564\n        Case 655 To 674 '8\n            i = 682\n            t = 654\n        Case 745 To 764 '9\n            i = 772\n            t = 744\n        Case 835 To 854 '10\n            i = 862\n            t = 834\n        Case 925 To 944 '11\n            i = 952\n            t = 924\n        Case 1015 To 1034 '12\n            i = 1042\n            t = 1014\n        Case 1105 To 1124 '13\n            i = 1132\n            t = 1104\n        Case 1195 To 1214 '14\n            i = 1222\n            t = 1194\n        Case 1285 To 1304 '15\n            i = 1312\n            t = 1284\n        Case 1375 To 1394 '16\n            i = 1402\n            t = 1374\n        Case 1465 To 1484 '17\n            i = 1492\n            t = 1464\n        Case 1555 To 1574 '18\n            i = 1582\n            t = 1554\n        Case 1645 To 1664 '19\n            i = 1672\n            t = 1644\n        Case 1735 To 1754 '20\n            i = 1762\n            t = 1734\n    End Select\n    With Sheets(\"Stability\")\n        Stb.Cond1.Caption = .Cells(r, c + 1)\n        Stb.Cond2.Caption = .Cells(r, c + 1)\n        Stb.TP01.Caption = .Cells(t, c + 3)\n        Stb.TP02.Caption = .Cells(t, c + 4)\n        Stb.TP03.Caption = .Cells(t, c + 5)\n        Stb.TP04.Caption = .Cells(t, c + 6)\n        Stb.TP05.Caption = .Cells(t, c + 7)\n        Stb.TP06.Caption = .Cells(t, c + 8)\n        Stb.TP07.Caption = .Cells(t, c + 9)\n        Stb.TP08.Caption = .Cells(t, c + 10)\n        Stb.TP09.Caption = .Cells(t, c + 11)\n        Stb.TP10.Caption = .Cells(t, c + 12)\n        Stb.TP11.Caption = .Cells(t, c + 13)\n        Stb.TP12.Caption = .Cells(t, c + 14)\n        Stb.TP13.Caption = .Cells(t, c + 15)\n        Stb.TP14.Caption = .Cells(t, c + 16)\n        Stb.TP15.Caption = .Cells(t, c + 17)\n        Stb.TP16.Caption = .Cells(t, c + 18)\n        Stb.TP17.Caption = .Cells(t, c + 19)\n        Stb.TP18.Caption = .Cells(t, c + 20)\n        Stb.TP19.Caption = .Cells(t, c + 21)\n        Stb.TP20.Caption = .Cells(t, c + 22)\n        Stb.TP21.Caption = .Cells(t, c + 23)\n        Stb.TP22.Caption = .Cells(t, c + 24)\n        Stb.TP23.Caption = .Cells(t, c + 25)\n        Stb.TP24.Caption = .Cells(t, c + 26)\n        Stb.TP25.Caption = .Cells(t, c + 27)\n        Stb.TP26.Caption = .Cells(t, c + 28)\n        Stb.TP27.Caption = .Cells(t, c + 29)\n        Stb.TP28.Caption = .Cells(t, c + 30)\n        Stb.TP29.Caption = .Cells(t, c + 31)\n        Stb.TP01x.Caption = .Cells(t, c + 3)\n        Stb.TP02x.Caption = .Cells(t, c + 4)\n        Stb.TP03x.Caption = .Cells(t, c + 5)\n        Stb.TP04x.Caption = .Cells(t, c + 6)\n        Stb.TP05x.Caption = .Cells(t, c + 7)\n        Stb.TP06x.Caption = .Cells(t, c + 8)\n        Stb.TP07x.Caption = .Cells(t, c + 9)\n        Stb.TP08x.Caption = .Cells(t, c + 10)\n        Stb.TP09x.Caption = .Cells(t, c + 11)\n        Stb.TP10x.Caption = .Cells(t, c + 12)\n        Stb.TP11x.Caption = .Cells(t, c + 13)\n        Stb.TP12x.Caption = .Cells(t, c + 14)\n        Stb.TP13x.Caption = .Cells(t, c + 15)\n        Stb.TP14x.Caption = .Cells(t, c + 16)\n        Stb.TP15x.Caption = .Cells(t, c + 17)\n        Stb.TP16x.Caption = .Cells(t, c + 18)\n        Stb.TP17x.Caption = .Cells(t, c + 19)\n        Stb.TP18x.Caption = .Cells(t, c + 20)\n        Stb.TP19x.Caption = .Cells(t, c + 21)\n        Stb.TP20x.Caption = .Cells(t, c + 22)\n        Stb.TP21x.Caption = .Cells(t, c + 23)\n        Stb.TP22x.Caption = .Cells(t, c + 24)\n        Stb.TP23x.Caption = .Cells(t, c + 25)\n        Stb.TP24x.Caption = .Cells(t, c + 26)\n        Stb.TP25x.Caption = .Cells(t, c + 27)\n        Stb.TP26x.Caption = .Cells(t, c + 28)\n        Stb.TP27x.Caption = .Cells(t, c + 29)\n        Stb.TP28x.Caption = .Cells(t, c + 30)\n        Stb.TP29x.Caption = .Cells(t, c + 31)\n        Stb.tA.Caption = .Cells(i, c + 1)\n        Stb.tB.Caption = .Cells(i + 1, c + 1)\n        Stb.tC.Caption = .Cells(i + 2, c + 1)\n        Stb.tD.Caption = .Cells(i + 3, c + 1)\n        Stb.tE.Caption = .Cells(i + 4, c + 1)\n        Stb.tF.Caption = .Cells(i + 5, c + 1)\n        Stb.tG.Caption = .Cells(i + 6, c + 1)\n        Stb.tH.Caption = .Cells(i + 7, c + 1)\n        Stb.tI.Caption = .Cells(i + 8, c + 1)\n        Stb.tJ.Caption = .Cells(i + 9, c + 1)\n        Stb.tK.Caption = .Cells(i + 10, c + 1)\n        Stb.tL.Caption = .Cells(i + 11, c + 1)\n        Stb.tM.Caption = .Cells(i + 12, c + 1)\n        Stb.tN.Caption = .Cells(i + 13, c + 1)\n        Stb.teO.Caption = .Cells(i + 14, c + 1)\n        Stb.tP.Caption = .Cells(i + 15, c + 1)\n        Stb.tQ.Caption = .Cells(i + 16, c + 1)\n        Stb.tR.Caption = .Cells(i + 17, c + 1)\n        Stb.tS.Caption = .Cells(i + 18, c + 1)\n        Stb.tT.Caption = .Cells(i + 19, c + 1)\n        Stb.tU.Caption = .Cells(i + 20, c + 1)\n        Stb.tV.Caption = .Cells(i + 21, c + 1)\n        Stb.tW.Caption = .Cells(i + 22, c + 1)\n        Stb.tX.Caption = .Cells(i + 23, c + 1)\n        Stb.tY.Caption = .Cells(i + 24, c + 1)\n        Stb.tZ.Caption = .Cells(i + 25, c + 1)\n        'skip row 78\n        Stb.oA.Caption = .Cells(i + 27, c + 1)\n        Stb.oB.Caption = .Cells(i + 28, c + 1)\n        Stb.oC.Caption = .Cells(i + 29, c + 1)\n        Stb.oD.Caption = .Cells(i + 30, c + 1)\n        Stb.oE.Caption = .Cells(i + 31, c + 1)\n        Stb.oF.Caption = .Cells(i + 32, c + 1)\n        Stb.oG.Caption = .Cells(i + 33, c + 1)\n        Stb.oH.Caption = .Cells(i + 34, c + 1)\n        Stb.oI.Caption = .Cells(i + 35, c + 1)\n        For v = 0 To 28\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"a\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 1 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"b\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 31 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"c\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 61 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"d\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 91 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"e\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 121 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"f\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 151 + v).Value = True\n        Next v\n        For v = 0 To 28\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"g\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 181 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"h\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 211 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"i\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 241 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"j\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 271 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"k\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 301 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"l\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 331 + v).Value = True\n        Next v\n        For v = 0 To 28\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"m\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 361 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"n\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 391 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"o\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 421 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"p\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 451 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"q\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 481 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"r\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 511 + v).Value = True\n        Next v\n        For v = 0 To 28\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"s\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 541 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"t\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 571 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"u\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 601 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"v\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 631 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"w\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 661 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"x\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 691 + v).Value = True\n        Next v\n        For v = 0 To 28\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"y\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 721 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"z\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 751 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"1\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 781 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"2\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 811 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"3\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 841 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"4\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 871 + v).Value = True\n        Next v\n        For v = 0 To 28\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"5\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 901 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"6\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 931 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"7\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 961 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"8\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 991 + v).Value = True\n            If Len(WorksheetFunction.Substitute(.Cells(r, c + 3 + v), \"9\", \"\")) &lt; Len(.Cells(r, c + 3 + v)) Then Controls(\"CheckBox\" &amp; 1021 + v).Value = True\n        Next v\n    End With \nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1525282197, "post_id": 50140327, "comment_id": 87298985, "body": "Try executing the command after the with block. It sounds silly but I think I&#39;ve come across this before."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525283341, "post_id": 50140327, "comment_id": 87299585, "body": "Have you tried <code>CommandType=4</code> with <code>CommandText</code> being just <code>dbo.spInsertDataIntoEmployee</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525283446, "post_id": 50140327, "comment_id": 87299643, "body": "Also <code>.Execute</code> statement should be <code>Set res = .Execute</code> and the recordset shouldn&#39;t be <code>Set</code> before that."}], "answers": [{"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 4, "last_activity_date": 1525282536, "creation_date": 1525282536, "answer_id": 50140483, "question_id": 50140327, "link": "https://stackoverflow.com/questions/50140327/when-executing-the-stored-procedure-from-vba-getting-error-procedure-or-functio/50140483#50140483", "title": "When executing the stored procedure from VBA getting error &quot;Procedure or function expects parameter @empid which is not passed&quot;", "body": "<p>You are running the command in the text mode.<br>\nYour full query is <code>Exec [dbo].[spInsertDataIntoEmployee]</code> which does not include any parameters.</p>\n\n<p><code>CommandType</code> should be <code>adCmdStoredProc</code>, and <code>CommandText</code> should be the procedure name, without <code>exec</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>.CommandType = adCmdStoredProc\n.CommandText = \"[dbo].[spInsertDataIntoEmployee]\"\n</code></pre>\n\n<p>If you want to keep <code>adCmdText</code>, list all parameters in the query:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>.CommandType = adCmdText\n.CommandText = \"exec [dbo].[spInsertDataIntoEmployee] @empid, @empname, @empage, @empsalary\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 3, "creation_date": 1525282826, "post_id": 50140492, "comment_id": 87299308, "body": "Sending everything as a <code>nvarchar</code>, even when it isn&#39;t, sounds like an awful idea."}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 1, "creation_date": 1525290258, "post_id": 50140492, "comment_id": 87302974, "body": "<a href=\"http://sqlblog.com/blogs/aaron_bertrand/archive/2009/10/12/bad-habits-to-kick-using-the-wrong-data-type.aspx\" rel=\"nofollow noreferrer\">Bad habits to kick : choosing the wrong data type</a> - you should always use the <b>most appropriate data type</b> - that&#39;s what they&#39;re there for, after all! Do <b><i>NOT</i></b> just send &quot;everything as nvarchar&quot; - <b>NOPE!</b>"}], "tags": [], "owner": {"reputation": 1, "user_id": 8540225, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929907837050157/picture?type=large", "display_name": "Alfredo Limon", "link": "https://stackoverflow.com/users/8540225/alfredo-limon"}, "is_accepted": false, "score": 0, "last_activity_date": 1525282580, "creation_date": 1525282580, "answer_id": 50140492, "question_id": 50140327, "link": "https://stackoverflow.com/questions/50140327/when-executing-the-stored-procedure-from-vba-getting-error-procedure-or-functio/50140492#50140492", "title": "When executing the stored procedure from VBA getting error &quot;Procedure or function expects parameter @empid which is not passed&quot;", "body": "<p>.CommandText = \"spInsertDataIntoEmployee\"\nAnd try to send everything as nvarchar.</p>\n"}], "owner": {"reputation": 33, "user_id": 4579519, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-wmPgBP-kiug/AAAAAAAAAAI/AAAAAAAAAEY/88PapIiKnwI/photo.jpg?sz=128", "display_name": "Rafi Ansari", "link": "https://stackoverflow.com/users/4579519/rafi-ansari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1525341500, "creation_date": 1525281887, "last_edit_date": 1525341500, "question_id": 50140327, "link": "https://stackoverflow.com/questions/50140327/when-executing-the-stored-procedure-from-vba-getting-error-procedure-or-functio", "title": "When executing the stored procedure from VBA getting error &quot;Procedure or function expects parameter @empid which is not passed&quot;", "body": "<p>I have written a stored procedure to insert the data into a table. When I execute that into SQL Server 2012 it works fine while in VBA throws error</p>\n\n<blockquote>\n  <p>procedure or function expects parameter @empid which was not provided</p>\n</blockquote>\n\n<p>I tried to resolve with different combinations of connection strings, <code>CommandType</code> etc but it does not resolve. While code seems perfectly fine, please assist me to resolve it.</p>\n\n<p>Stored procedure:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE PROCEDURE [dbo].[spInsertDataIntoEmployee]\n    @empid INT,\n    @empname VARCHAR(20),\n    @empage INT,\n    @empsalary DECIMAL(8,2)\nAS\nBEGIN\n    SET NOCOUNT ON\n\n    INSERT INTO [dbo].[employee] (empid, empname, empage, empsalary)\n    VALUES (@empid, @empname, @empage, @empsalary)\nEND\n</code></pre>\n\n<p>VBA code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Exec_StoredProcFromExcel_Click()\n\nDim con As ADODB.Connection\nDim res As ADODB.Recordset\nDim mobjCmd As ADODB.Command\nDim strConn As String\nDim par1 As Object\nDim par2 As Object\nDim par3 As Object\nDim par4 As Object\n'Dim empname As Varchar\n'Dim empage As Integer\n'Dim empsalary As Single\nDim indRecordSetFields As Integer\n\n'Dim strQuery As String\n'con.Close\nSet con = New ADODB.Connection\nSet res = New ADODB.Recordset\nSet mobjCmd = New ADODB.Command\n\nstrConn = \"Driver={SQL Server Native Client 11.0};Server=localhost;Database=test;Trusted_Connection=yes;\"\n'strConn = \"Provider=SQLOLEDB; Data Source=localhost; Initial Catalog=test; Integrated Security=SSPI;\"\ncon.Open strConn, adOpenStatic, adLockOptimistic\n\nSet par1 = mobjCmd.CreateParameter(\"@empid\", adInteger, adParamInput)\nSet par2 = mobjCmd.CreateParameter(\"@empname\", adVarChar, adParamInput, 30)\nSet par3 = mobjCmd.CreateParameter(\"@empage\", adInteger, adParamInput)\nSet par4 = mobjCmd.CreateParameter(\"@empsalary\", adDouble, adParamInput)\n\nWith mobjCmd\n    .ActiveConnection = con\n    .CommandText = \"Exec [dbo].[spInsertDataIntoEmployee]\"\n    .CommandType = 1 'adCmdStoredProc=4 does not work while adCmdText=1 and adCmdUnknown=8 both work for me\n    .CommandTimeout = 45\n\n    .Parameters.Append par1\n    .Parameters(\"@empid\").Value = 111\n    .Parameters.Append par2\n    .Parameters(\"@empname\").Value = \"majid rajih\"\n    .Parameters.Append par3\n    .Parameters(\"@empage\").Value = 34\n    .Parameters.Append par4\n    .Parameters(\"@empsalary\").Value = 200000\n\n    '.Parameters.Append .CreateParameter(\"@empid\", adInteger, adParamInput, 111)\n    '.Parameters.Append .CreateParameter(\"@empname\", adVarChar, adParamInput, 20, \"majid khan\")\n    '.Parameters.Append .CreateParameter(\"@empage\", adInteger, adParamInput, 30)\n    '.Parameters.Append .CreateParameter(\"@empsalary\", adSingle, adParamInput, 250000)\n\n    '.Parameters.Append .CreateParameter(\"@empid\", adInteger, adParamInput, , ThisWorkbook.Sheets(\"employee\").Range(\"A2\").Value)\n    '.Parameters.Append .CreateParameter(\"@empname\", adVarChar, adParamInput, 20, ThisWorkbook.Sheets(\"employee\").Range(\"B2\").Value)\n    '.Parameters.Append .CreateParameter(\"@empage\", adInteger, adParamInput, , ThisWorkbook.Sheets(\"employee\").Range(\"C2\").Value)\n    '.Parameters.Append .CreateParameter(\"@empsalary\", adSingle, adParamInput, , ThisWorkbook.Sheets(\"employee\").Range(\"D2\").Value)\n    ' repeat as many times as you have parameters\n\n    .Execute\nEnd With\n\n'With res\n'res.CursorType = adOpenStatic\n'res.LockType = adLockOptimistic\n'res.Open mobjCmd 'This executed the stored proc\n'End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1525282840, "post_id": 50140117, "comment_id": 87299314, "body": "With what we see of your code, it will look at the check box when you run it, but not on a change in the checkbox&#39;s value. Check out: <a href=\"https://stackoverflow.com/questions/1007164/detecting-changes-to-checkboxes-via-vba\" title=\"detecting changes to checkboxes via vba\">stackoverflow.com/questions/1007164/&hellip;</a>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1525286555, "post_id": 50140117, "comment_id": 87301139, "body": "What is not working? You\u2019ve assigned it to what? (what is the procedure name that calls this sub). Is the checkbox placed on the sheet or on a UserForm? What is the sheet name?"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1525289036, "creation_date": 1525289036, "answer_id": 50142083, "question_id": 50140117, "link": "https://stackoverflow.com/questions/50140117/trying-to-make-a-checkbox-hide-all-rows-where-a-cell-in-that-row-reads-a-specifi/50142083#50142083", "title": "Trying to make a checkbox hide all rows where a cell in that row reads a specific value", "body": "<p>If a CheckBox named <code>\"CheckBox1\"</code> is placed on <strong><code>Sheet1</code></strong>, use this code in Sheet1 module</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub CheckBox1_Click()\n    Dim c As Range\n\n    Application.ScreenUpdating = False\n    With Sheet1\n        For Each c In .Range(\"C2:C\" &amp; .Cells(.Rows.Count, \"C\").End(xlUp).Row).Cells\n            If IsError(c) Then c.Value2 = \"Closed\"  'Hides errors as well\n            c.EntireRow.Hidden = (c.Value = \"Closed\" And .CheckBox1.Value)\n        Next\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>This will hide or unhide rows based on cells in column <code>C</code> containing the word <code>\"Closed\"</code> and the CheckBox being selected or not</p>\n"}], "owner": {"reputation": 21, "user_id": 8490849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7c4cf04415504f3dcfc113bf25b295?s=128&d=identicon&r=PG&f=1", "display_name": "Hubert P Tubbledale", "link": "https://stackoverflow.com/users/8490849/hubert-p-tubbledale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525289036, "creation_date": 1525281143, "last_edit_date": 1525286322, "question_id": 50140117, "link": "https://stackoverflow.com/questions/50140117/trying-to-make-a-checkbox-hide-all-rows-where-a-cell-in-that-row-reads-a-specifi", "title": "Trying to make a checkbox hide all rows where a cell in that row reads a specific value", "body": "<p>So I'm trying to make a checkbox to hide all rows where a cell in that row reads a specific value.</p>\n\n<p>I've assigned the following VBA script to it:</p>\n\n<pre><code>Sub Hide_Rows_Containing_Value()\n\n    If CheckBox1 = True Then\n\n        Dim c As Range\n\n        For Each c In Range(\"C2:C100\").Cells\n            If c.Value = \"Closed\" Then\n                c.EntireRow.Hidden = True\n            End If\n        Next c\n    End If\nEnd Sub\n</code></pre>\n\n<p>And an inverse script assigned to it to unhide those columns when the box was unticked.</p>\n\n<p>However this doesn't seem to work, does anyone have any ideas where I've gone wrong?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "edited": false, "score": 0, "creation_date": 1525281739, "post_id": 50139869, "comment_id": 87298744, "body": "As a workaround I changed the DoCmd to:            DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, &quot;QueryModelDetailAllHistory&quot;, _         fXLSXFile    But if anyone has an idea of what is happening, that would be great."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525287705, "post_id": 50139869, "comment_id": 87301668, "body": "Is that the only code that the process runs or is there something else in there? Based on what you&#39;ve written so far, it should work perfectly fine as it is. But, perhaps there is something else in the rest of the code causing issues?"}, {"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "reply_to_user": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525361419, "post_id": 50139869, "comment_id": 87335313, "body": "For testing I had removed all code that wasn&#39;t required to get to the DoCmd.  It&#39;s very strange, for sure.  Theoretically, the runsavedimportexport should have nothing to do with any other vba code, as it is (or should be) a task that does not interface with code.  It&#39;s only <b>supposed to</b> run the saved process and create the Excel book."}], "owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594635342, "creation_date": 1525280191, "last_edit_date": 1594635342, "question_id": 50139869, "link": "https://stackoverflow.com/questions/50139869/2010-access-docmd-runsavedimportexport-wiping-out-query", "title": "2010 Access DoCmd.RunSavedImportExport wiping out query", "body": "<p>I have a simple statement in my vba:</p>\n\n<pre><code>    DoCmd.RunSavedImportExport \"ExportQueryModelDetailAllHistory\"\n</code></pre>\n\n<p>The export is based on a query (\"QueryModelDetailAllHistory\").  It exports fields to an Excel workbook based on a query that INNER JOINS on table to another, taking fields from both tables.  For example:</p>\n\n<pre><code>Select Table1.Field1, Table1.Field2, Table2.Field2\n   From Table1 INNER JOIN Table2 ON Table1.Field1 = Table2.Field2;\n</code></pre>\n\n<p>When this command executes in vba it creates the workbook and then the saved query becomes:</p>\n\n<pre><code>SELECT;\n</code></pre>\n\n<p>Yet, when I manually run from the ExternalData/SavedExports it works great, running it multiple times.</p>\n\n<p>For testing purposes, I exit the procedure immediately after the DoCmd.</p>\n\n<p>Has anyone seen something like this (possible bug or am I doing something wrong?)?  Is there a workaround?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1525306423, "post_id": 50145011, "comment_id": 87308508, "body": "The Outlook object model is the same for VBA and VB.NET."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1525306782, "post_id": 50145011, "comment_id": 87308569, "body": "True, but lacks Try Catch Finally."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1532992065, "post_id": 50145011, "comment_id": 90172751, "body": "<i>I think OP may recognize helpful pieces of code</i> -- You could have written this in C# or Python with the same hope. Also, you are using .NET classes which are not available in VBA, <a href=\"https://stackoverflow.com/questions/51602735/xmldocument-in-outlook-vba?noredirect=1&amp;lq=1\">as someone has already discovered</a>. It&#39;s unfortunate, because the first half of your answer provides some valuable information."}, {"owner": {"reputation": 27196, "user_id": 18573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/08b7b48e82ea72294df4a3382ac0da9b?s=128&d=identicon&r=PG", "display_name": "Miserable Variable", "link": "https://stackoverflow.com/users/18573/miserable-variable"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1533223371, "post_id": 50145011, "comment_id": 90278060, "body": "I have accepted this answer as I was finally able to adapt it for use with VBA (that someone that @ZevSpitz refers to is me :)). I do believe it was much easier for me to make progress with an example in VB.NET, rather then Python."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1525304627, "creation_date": 1525304627, "answer_id": 50145011, "question_id": 50139841, "link": "https://stackoverflow.com/questions/50139841/programmatically-open-search-view/50145011#50145011", "title": "programmatically open search view", "body": "<p>There are two possible ways to show search results in Outlook:</p>\n\n<ol>\n<li><p>The <code>AdvancedSearch</code> method of the Application class from the Outlook object model allows to perform a search in multiple folders in Outlook. The key benefits of using the <code>AdvancedSearch</code> method in Outlook are:</p>\n\n<ul>\n<li>The search is performed in another thread. You don\u2019t need to run another thread manually since the <code>AdvancedSearch</code> method runs it automatically in the background.</li>\n<li>Possibility to search for any item types: mail, appointment, calendar, notes etc. in any location, i.e. beyond the scope of a certain folder. The Restrict and <code>Find</code>/<code>FindNext</code> methods can be applied to a particular Items collection (see the Items property of the Folder class in Outlook).</li>\n<li>Full support for DASL queries (custom properties can be used for searching too). You can read more about this in the <a href=\"http://msdn.microsoft.com/en-us/library/bb208216%28v=office.12%29\" rel=\"nofollow noreferrer\">Filtering</a> article in MSDN. To improve the search performance, Instant Search keywords can be used if Instant Search is enabled for the store (see the <code>IsInstantSearchEnabled</code> property of the <code>Store</code> class).</li>\n<li>Finally, you can stop the search process at any moment using the Stop method of the Search class.</li>\n</ul>\n\n<p>Admittedly, the <code>Search</code> class allows you to save the results of searching in a search folder (actually, it doesn\u2019t contain any items, only references to items from the scope folders). You just need to call the <code>Save</code> method on the <code>Search</code> object in the <code>AdvanvedSearchComplete</code> event handler.</p></li>\n<li><p>Customize the current view of the Folder or Explorer objects in Outlook. The <a href=\"http://msdn.microsoft.com/en-us/library/office/ff864212(v=office.15).aspx\" rel=\"nofollow noreferrer\">CurrentView</a> property returns an instance of the <code>View</code> class. See <a href=\"https://www.add-in-express.com/creating-addins-blog/2009/03/13/outlook-items-filter-programmatically/\" rel=\"nofollow noreferrer\">HowTo: Use the View.XML property to filter Outlook items</a> for more information. </p></li>\n</ol>\n\n<p></p>\n\n<pre><code> Dim sFilter As String\n Dim CurrentExplorer As Outlook.Explorer = Nothing\n Dim CurrentView As Outlook.View = Nothing\n Dim CurrentXML As XmlDocument = New XmlDocument\n Dim CurrentFilterNodes, CurrentViewNodes As XmlNodeList\n Dim CurrentFilterNode, CurrentParentNode As XmlNode\n\n If TextBox1.Text.Length &gt; 0 Then\n     If rbtSubject.Checked Then\n        sFilter = \"urn:schemas:httpmail:subject LIKE '%\" + _\n        TextBox1.Text.Trim + \"%'\"\n    Else\n        sFilter = \"urn:schemas:httpmail:textdescription LIKE '%\" + _\n        TextBox1.Text.Trim + \"%'\"\n    End If\n\n    CurrentExplorer = TryCast(ExplorerObj, Outlook.Explorer)\n    If (CurrentExplorer IsNot Nothing) Then\n        CurrentView = CurrentExplorer.CurrentView\n        If (CurrentView IsNot Nothing) Then\n            Try\n                CurrentXML.LoadXml(CurrentView.XML)\n                CurrentFilterNodes = _\n                    CurrentXML.GetElementsByTagName(\"filter\")\n                If CurrentFilterNodes.Count &gt; 0 Then\n                    For y As Integer = 0 _\n                        To CurrentFilterNodes.Count - 1\n                        CurrentFilterNode = CurrentFilterNodes(y)\n                        If CurrentFilterNode.HasChildNodes Then\n                            For i As Integer = _\n                            CurrentFilterNode.ChildNodes.Count - 1 _\n                                To 0 Step -1\n                                CurrentFilterNode.RemoveChild( _\n                                    CurrentFilterNode.ChildNodes(i))\n                            Next\n                        End If\n                    Next\n                    CurrentFilterNode = CurrentFilterNodes(0)\n                    CurrentFilterNode.AppendChild( _\n                        CurrentXML.CreateTextNode(sFilter))\n                Else\n                    CurrentViewNodes = CurrentXML. _\n                        GetElementsByTagName(\"view\")\n                    If CurrentViewNodes IsNot Nothing Then\n                        CurrentParentNode = CurrentViewNodes(0)\n                        CurrentFilterNode = CurrentXML. _\n                            CreateElement(\"filter\")\n                        CurrentParentNode.AppendChild( _\n                            CurrentFilterNode)\n                        CurrentFilterNode.AppendChild( _\n                            CurrentXML.CreateTextNode(sFilter))\n                    End If\n                End If\n                CurrentView.XML = CurrentXML.InnerXml\n                CurrentView.Apply()\n            Finally\n                Marshal.ReleaseComObject(CurrentView)\n            End Try\n        End If\n    End If\nEnd If\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 27196, "user_id": 18573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/08b7b48e82ea72294df4a3382ac0da9b?s=128&d=identicon&r=PG", "display_name": "Miserable Variable", "link": "https://stackoverflow.com/users/18573/miserable-variable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 50145011, "answer_count": 1, "score": 0, "last_activity_date": 1592984609, "creation_date": 1525280096, "last_edit_date": 1592984609, "question_id": 50139841, "link": "https://stackoverflow.com/questions/50139841/programmatically-open-search-view", "title": "programmatically open search view", "body": "<p>I am looking for a way to open a search view in outlook for a specified criteria programmatically. I saw other questions such as <a href=\"https://stackoverflow.com/questions/21549938/vba-search-in-outlook\">VBA Search in Outlook</a>, but they are about retrieving search results programmatically. </p>\n\n<p>I am essentially looking for the same functionality as the Ribbon option Message/Editing/Related:</p>\n\n<p>When I open a message by double-clicking on a message and then click on \"Messages in this Conversation\"\n<a href=\"https://i.stack.imgur.com/Q8j31.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q8j31.png\" alt=\"enter image description here\"></a></p>\n\n<p>The list view changes to </p>\n\n<p><a href=\"https://i.stack.imgur.com/3KX9a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3KX9a.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to be able to do the same thing using a VBA Macro but without opening the message and with a different search criteria</p>\n"}, {"tags": ["excel", "function", "timer", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1525279924, "post_id": 50139609, "comment_id": 87297800, "body": "You might be interested in <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=1068\" rel=\"nofollow noreferrer\">MicroTimer function</a>. It is often used to profile vba code with high accuracy."}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1525280896, "post_id": 50139609, "comment_id": 87298280, "body": "Hi, I know about that. But my need was above one.  Easily give me the time in steps..."}], "tags": [], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "is_accepted": true, "score": 0, "last_activity_date": 1525466427, "last_edit_date": 1525466427, "creation_date": 1525279306, "answer_id": 50139609, "question_id": 50139608, "link": "https://stackoverflow.com/questions/50139608/vba-a-timer-function-with-step-by-step-capturing-the-elapsed-times/50139609#50139609", "title": "VBA- A Timer Function, with Step by Step Capturing the elapsed times", "body": "<p>Here is what I developed for that purpose. You have to declare a public object of \"Scripting.Dictionary\" type and also a long variable as ti. </p>\n\n<h1>Late Binding:</h1>\n\n<pre><code>Public d As Object, ti as long\n</code></pre>\n\n<p>and in one you your procedures, prior to calling the function: </p>\n\n<pre><code>Set d = CreateObject(\"Scripting.Dictionary\")\n</code></pre>\n\n<h1>Early Binding</h1>\n\n<p>You can use early binding if you have Microsoft Scripting Runtime already added to your library. Your declaration would be like below: </p>\n\n<pre><code>Dim d As New Scripting.Dictionary, ti as long\n</code></pre>\n\n<p>anyway here is the:</p>\n\n<h1>Function</h1>\n\n<p>Title is a string as a reminder or tag of the stage/step in the code.<br>\n  Newstart should set TRUE, for the first instance of the function.<br>\n  NeedTotal should set true if you want total elapsed time up until that stage. </p>\n\n<pre><code>Public Function gettimer(Optional ByVal Title As String, _\n                     Optional ByVal Newstart As Boolean, _\n                     Optional ByVal NeedTotal As Boolean)\nIf Newstart = True Or ti = 0 Then\n    ti = 0\n    d(\"T0\") = Timer\n    gettimer = ti &amp; vbTab &amp; vbTab &amp; \"0.00\" &amp; vbTab &amp; vbTab &amp; \"Start @ \" _\n    &amp; Format(Time, \"h:mm:ss\") &amp; vbTab &amp; Title\nElse\n    gettimer = ti &amp; vbTab &amp; vbTab &amp; Format(Round(Timer - d(\"T\" &amp; ti - 1), 2), \"0.00\") _\n    &amp; vbTab &amp; vbTab &amp; Title\n    d(\"T\" &amp; ti) = Timer\nEnd If\nIf NeedTotal Then\n    gettimer = gettimer &amp; vbTab &amp; vbTab &amp; vbTab &amp; \"Time elapsed from the start = \" _\n    &amp; vbTab &amp; Round(d(\"T\" &amp; ti) - d(\"T0\"), 4)\nEnd If\nti = ti + 1\nDebug.Print gettimer\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 50139609, "answer_count": 1, "score": 0, "last_activity_date": 1525466427, "creation_date": 1525279306, "last_edit_date": 1531164843, "question_id": 50139608, "link": "https://stackoverflow.com/questions/50139608/vba-a-timer-function-with-step-by-step-capturing-the-elapsed-times", "title": "VBA- A Timer Function, with Step by Step Capturing the elapsed times", "body": "<p>I was looking for a timer function that easily can be embedded in my coeds to show me how many seconds each step is taking. I am doing this with a regular debug.print and several variables which made my code busy and also hard to do subtracting new timer from last recorded step was redundant as well. I am looking for a function to capture the time takes for each step and also finding out the total elapsed time from the first step. </p>\n"}, {"tags": ["vba", "charts"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1525288746, "post_id": 50139292, "comment_id": 87302203, "body": "<code>AddChart2</code> was added in Excel 2013 to make adding charts a little easier (the older <code>AddChart</code> was retained for backwards compatibility)"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1525278811, "creation_date": 1525278811, "answer_id": 50139482, "question_id": 50139292, "link": "https://stackoverflow.com/questions/50139292/renaming-chart-in-vba/50139482#50139482", "title": "Renaming chart in VBA", "body": "<p>Here you go!</p>\n\n<pre><code>Dim MyChart As Shape\nSet MyChart = ActiveSheet.Shapes.AddChart2(419, xlFunnel)\nMyChart.Chart.SetSourceData Source:=Range(\"Sheet1!$F$2:$F$4\")\nMyChart.Name = \"My new chart\"\n</code></pre>\n\n<p>Regarding the AddChart vs AddChart2 question - read more here <a href=\"https://stackoverflow.com/questions/27889579/what-does-the-number-in-the-addchart2-vba-macro-represents\">What does the number in the AddChart2 VBA macro represents?</a></p>\n"}], "owner": {"reputation": 39, "user_id": 9730852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800830871f7a477816e2050e74b38ad4?s=128&d=identicon&r=PG&f=1", "display_name": "lucasnuensfe", "link": "https://stackoverflow.com/users/9730852/lucasnuensfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2323, "favorite_count": 0, "accepted_answer_id": 50139482, "answer_count": 1, "score": 1, "last_activity_date": 1525284362, "creation_date": 1525278131, "last_edit_date": 1525284362, "question_id": 50139292, "link": "https://stackoverflow.com/questions/50139292/renaming-chart-in-vba", "title": "Renaming chart in VBA", "body": "<p>I added a chart using this piece of code:</p>\n\n<pre><code>ActiveSheet.Shapes.AddChart2(419, xlFunnel).Select\n</code></pre>\n\n<p>Now, I wish I could select this graph, so that I can rename it.</p>\n\n<p>PS: What does it mean <code>AddChart2</code>? Is this standard code or not?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1525278299, "post_id": 50139225, "comment_id": 87296974, "body": "you could use a helper column with a simple formula to determine if first or second date is grater <code>=IF(D:D&gt;H:H,1,2)</code> so it outputs a 1 if the first is greater and a 2 if the second. Then use filers to filter for 1 or 2 in this helper column. Of course you could copy the filtered data to another sheet easily. \u2022 Because this is no free code writing service please start on your own and then come back with your code and tell where you got stuck or errors."}, {"owner": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525282023, "post_id": 50139225, "comment_id": 87298900, "body": "@P\u1d07\u029c I edited the post to include my code."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525286786, "post_id": 50139225, "comment_id": 87301256, "body": "Remove the <code>Set</code> from <code>Set Exam_1_Date</code>. The variable is of type date which is just a value not an object. <code>Set</code> is only needed for objects. Also make sure you use <code>Option Explicit</code> and define all your variables correctly. Eg. <code>Dim i As Long</code>. Also <code>k</code> and <code>j</code> seem not to be defined so they are <code>0</code> which makes <code>Range(&quot;F&quot; &amp; k)</code> fail because there is no row <code>0</code>."}, {"owner": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525287539, "post_id": 50139225, "comment_id": 87301596, "body": "@P\u1d07\u029c I made changes and removed Set from the variables. It runs however it does not return the expected data. It is returning only 1 record duplicated on 2 rows. I am expecting much more data to be returned..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525287761, "post_id": 50139225, "comment_id": 87301697, "body": "because you didn&#39;t increase <code>j</code>. You need a <code>j = j + 1</code> everytime data is added otherwise it overwrites always into the same row."}, {"owner": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525288193, "post_id": 50139225, "comment_id": 87301925, "body": "@P\u1d07\u029c Ok I added j = j + 1 just above the End If clause. Now I am getting data returned, however all of it is resulting in the &quot;CAN NOT DETERMINE&quot; logic, when I know that there are dates populated in columns AW and BA.  Thoughts?  Appreciate your help!"}], "answers": [{"comments": [{"owner": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "edited": false, "score": 0, "creation_date": 1525290167, "post_id": 50141960, "comment_id": 87302925, "body": "@Peh Thanks, I am now getting data returned with dates, however I noticed that I have several duplicate rows for my records. For example, one person has 4 rows, 3 of which have the &quot;CAN NOT DETERMINE&quot;, the 4th rows contains the ExamDate. Ideas why this is occuring?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "edited": false, "score": 0, "creation_date": 1525290653, "post_id": 50141960, "comment_id": 87303177, "body": "@nick no because I don&#39;t know how your data looks like. I suggest to go through your code step by step (with F8) and debug what happens (check variable values and which row you are every step)."}, {"owner": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "edited": false, "score": 0, "creation_date": 1525291140, "post_id": 50141960, "comment_id": 87303405, "body": "@Peh thanks, just wasn&#39;t sure if I needed to change anything in the IF statement to be something like Exam_1_Date.Value &gt; Exam_2_Date.Value (As opposed to just Exam_1_Date &gt; Exam_2_Date."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "edited": false, "score": 0, "creation_date": 1525327407, "post_id": 50141960, "comment_id": 87314031, "body": "@Nick just another idea: Remove the last <code>Else</code> block with the <code>CAN NOT DETERMINE</code> completely and move the <code>j = j + 1</code> within the first <code>If</code> AND the <code>ElseIf</code> and see if that fixes your issue."}, {"owner": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "edited": false, "score": 0, "creation_date": 1525353998, "post_id": 50141960, "comment_id": 87330150, "body": "@Peh thanks again, the issue was that I had run the macro several times and each time it kept replicating on the same worksheet, creating the duplicates. Everything looks good now! This was a great exercise for me to get a taste of VBA! Thanks again for your help!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1525288540, "creation_date": 1525288540, "answer_id": 50141960, "question_id": 50139225, "link": "https://stackoverflow.com/questions/50139225/compare-and-get-greatest-date-and-related-fields/50141960#50141960", "title": "Compare and get greatest date and related fields", "body": "<p>use an <code>If \u2026 ElseIf \u2026 Else \u2026 End If</code> statement and increase <code>j</code>.</p>\n\n<pre><code>For i = 2 To lstrow\n    Exam_1_Date = Worksheets(\"Data\").Range(\"AW\" &amp; i)\n    Exam_2_Date = Worksheets(\"Data\").Range(\"BA\" &amp; i)\n\n    If Exam_1_Date &gt; Exam_2_Date Then\n        Worksheets(\"PPDCI\").Range(\"A\" &amp; j &amp; \":C\" &amp; j).Value = Worksheets(\"Data\").Range(\"F\" &amp; i &amp; \":H\" &amp; i).Value\n        Worksheets(\"PPDCI\").Range(\"F\" &amp; j).Value = Exam_1_Date\n    ElseIf Exam_1_Date &lt; Exam_2_Date Then\n        Worksheets(\"PPDCI\").Range(\"A\" &amp; j &amp; \":C\" &amp; j).Value = Worksheets(\"Data\").Range(\"F\" &amp; i &amp; \":H\" &amp; i).Value\n        Worksheets(\"PPDCI\").Range(\"F\" &amp; j).Value = Exam_2_Date\n    Else\n        Worksheets(\"PPDCI\").Range(\"F\" &amp; j).Value = \"CAN NOT DETERMINE\"\n    End If\n    j = j + 1\nNext i\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 4408559, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f825781b038cf776e7e6a16ed727f8ac?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4408559/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 50141960, "answer_count": 1, "score": 0, "last_activity_date": 1525288540, "creation_date": 1525277925, "last_edit_date": 1531164843, "question_id": 50139225, "link": "https://stackoverflow.com/questions/50139225/compare-and-get-greatest-date-and-related-fields", "title": "Compare and get greatest date and related fields", "body": "<p>I am very new to using VBA for Excel and need to develop some code that will retrieve a person's greatest Exam dates and related fields (Exam date, Exam Check Date, Exam Induration) and output to another tab called EXAMCI.</p>\n\n<p>Because of data integrity issues with the date input file, In some instances Exam Date (Column D) will be greater than 2nd Exam Date (Column H), and vice versa; there will be some instances when the 2nd Exam Date (Column H) is greater than the first Exam date (Column D). </p>\n\n<p>Here is some sample data from the file (Columns are A - K, Left to Right):</p>\n\n<pre><code>Userid  Employee Name   DOB             Exam Date       Exam Check Date Exam Induration Exam Negative   2nd Exam Date   2nd Exam Check Date 2nd Exam Induration 2nd Exam Negative\n1234    John Smith      1/1/01          5/22/17         5/24/17         0               Yes             12/6/17         12/8/17             0                   Yes\n6481    Jill Son        2/2/02          11/18/15        11/21/15        0               Yes             2/23/17         2/26/17             0                   Yes\n3271    Cathy John      3/3/03          7/17/17         7/19/17         0               Yes             6/15/16         6/17/16             0                   Yes\n</code></pre>\n\n<p>In the above example data you can see that the first Exam Date is greater than then 2nd Exam Date for John Smith and Cathy John, however the 2nd Exam Date is greater than the first Exam Date for Jill Son. </p>\n\n<p>What I want the program to do is check each row to see whether Exam Date or 2nd Exam Date is the greatest (of the two) and then output Userid, Employee Name, DOB, and either the (Exam Date, Check Date, and Exam Induration) or the (2nd Exam Date, 2nd Exam Check Date, and 2nd Exam Induration) -- depending on which associated date was greater.</p>\n\n<p>So in the example John Smith and Jill Son, I would want to output on the tab EXAMCI the following data (column labels can remain the same, e.g. no need to distinguish between Exam Date and 2nd Exam Date:)</p>\n\n<pre><code>Userid     Employee Name    DOB       Exam Date     Exam Check Date    Exam Induration\n1234       John Smith       1/1/01    5/22/17       5/24/17            0\n3271       Jill Son         3/3/03    2/23/17       2/26/17            0\n</code></pre>\n\n<p>Please let me know if the requirement is not clear, thanks for any feedback!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here is the code I am attempting to add into this already existing program, function is called <strong>Examdate</strong>:</p>\n\n<p>Public lstrow As Long, strDate As Variant, stredate As Variant</p>\n\n<pre><code>Sub importbuild()\n\nApplication.ScreenUpdating = False\n\n'Define last row of exported data\nlstrow = Worksheets(\"Data\").Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n\nWorksheets(\"Data\").Cells.Replace what:=\"=\", Replacement:=\"\", _\nLookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\nSearchFormat:=False, ReplaceFormat:=False\n\n'Run function to build import file for Hepatitis Immunizations\nCall HepLoad(\"O\", \"P\", \"HB1\")\nCall HepLoad(\"Q\", \"R\", \"HB2\")\nCall HepLoad(\"S\", \"T\", \"HB3\")\nCall HepLoad(\"U\", \"V\", \"HB1\")\nCall HepLoad(\"W\", \"X\", \"HB2\")\nCall HepLoad(\"Y\", \"NA\", \"HB3\")\n'Run function for Hepatitis Series Completed\nCall HepSeries(\"Z\", \"AA\")\n'Run function for Titers\nCall Titer(\"AB\", \"AC\", \"HT\")\nCall Titer(\"AD\", \"AE\", \"RT\")\nCall Titer(\"AF\", \"AG\", \"UT\")\nCall Titer(\"AH\", \"AI\", \"VT\")\n'Run functions for Varicella Immunizations\nCall DateOnlyLoad(\"AJ\", \"AK\", \"VAR1\")\nCall DateOnlyLoad(\"AL\", \"NA\", \"VAR2\")\n'Run function for Tetanus Immunizations\nCall TetanusLoad(\"AM\", \"AN\")\n'Run function for MMR Immunizations\nCall DateOnlyLoad(\"AO\", \"AP\", \"MMR1\")\nCall DateOnlyLoad(\"AQ\", \"NA\", \"MMR2\")\n'Call BCGLoad(\"BA\", \"NA\", \"BCG\")\nCall Examdate\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><em>(Other functions omitted)</em></p>\n\n<pre><code>Function Examdate()\n\nDim Exam_1_Date As Variant\nDim Exam_2_Date As Variant\nDim i As Long, j As Long\n\nj = Worksheets(\"PPDCI\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nFor i = 2 To lstrow\n\nExam_1_Date = Worksheets(\"Data\").Range(\"AW\" &amp; i)\nExam_2_Date = Worksheets(\"Data\").Range(\"BA\" &amp; i)\n\nIf Exam_1_Date &gt; Exam_2_Date Then\n   Worksheets(\"PPDCI\").Range(\"A\" &amp; j &amp; \":C\" &amp; j).Value = \nWorksheets(\"Data\").Range(\"F\" &amp; i &amp; \":H\" &amp; i).Value\n   Worksheets(\"PPDCI\").Range(\"F\" &amp; j).Value = Exam_1_Date\nElse\n    If Exam_1_Date &lt; Exam_2_Date Then\n    Worksheets(\"PPDCI\").Range(\"A\" &amp; j &amp; \":C\" &amp; j).Value = \nWorksheets(\"Data\").Range(\"F\" &amp; i &amp; \":H\" &amp; i).Value\n    Worksheets(\"PPDCI\").Range(\"F\" &amp; j).Value = Exam_2_Date\n    End If\nWorksheets(\"PPDCI\").Range(\"F\" &amp; j).Value = \"CAN NOT DETERMINE\"\nEnd If\n\nNext i\n\nEnd Function\n</code></pre>\n\n<p>When I attempt to run the macro, I get an \"Object required\" error. Do I need to specify the variables up where the function is being called? Also does the logic appear to be correct?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525279377, "post_id": 50138944, "comment_id": 87297555, "body": "Is there actually a presentation open? Can you address it in the Immediate Window? Are you able to use SaveAs on it in the user interface? Are you sure all the variables have the expected values and concatenate to a viable file path?"}, {"owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525336617, "post_id": 50138944, "comment_id": 87318731, "body": "The presentation is open, and its the only one open, i can save using the user UI, and I checked the variable and they do give a viable path, not sure exactly what you mean by immediate window though sorry"}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "is_accepted": true, "score": 0, "last_activity_date": 1525337599, "creation_date": 1525337599, "answer_id": 50150832, "question_id": 50138944, "link": "https://stackoverflow.com/questions/50138944/vba-activepresentation-saveas-error-429-activex/50150832#50150832", "title": "VBA Activepresentation.Saveas Error - 429 ActiveX", "body": "<p>I cant claim to understand how this fixed it but i declared </p>\n\n<pre><code>Dim ppApp   As PowerPoint.Application\nDim ppPres  As PowerPoint.Presentation\n</code></pre>\n\n<p>then added in </p>\n\n<pre><code>Set ppApp = New PowerPoint.Application\ni = 1\n\nppApp.Presentations.Open Filename:=myPath\nSet ppPres = ppApp.Presentations.Item(i)\n</code></pre>\n\n<p>finally changing </p>\n\n<pre><code>Activepresentation.saveAs \n</code></pre>\n\n<p>to</p>\n\n<pre><code>ppPres.SaveAs\n</code></pre>\n\n<p>and it worked\nFull code below:</p>\n\n<pre><code>Public Sub SaveNewVersion_PowerPoint()\n'PURPOSE: Save file, if already exists add a new version indicator to filename\n'SOURCE: www.TheSpreadsheetGuru.com/The-Code-Vault\n\nDim FolderPath As String\nDim myPath As String\nDim SaveName As String\nDim SaveExt As String\nDim VersionExt As String\nDim Saved As Boolean\nDim x As Long\nDim TestStr As String\nDim myFileName As String\n\n\nTestStr = \"\"\nSaved = False\nx = 2\n\n'Version Indicator (change to liking)\n  VersionExt = \"_v\"\n\n'Pull info about file\n  On Error GoTo NotSavedYet\n    myPath = \"C:\\Users\\Person\\Desktop\\Test\\Weekly Pack Update.pptx\"\n    myFileName = Mid(myPath, InStrRev(myPath, \"\\\") + 1, InStrRev(myPath, \".\") - InStrRev(myPath, \"\\\") - 1)\n    FolderPath = Left(myPath, InStrRev(myPath, \"\\\"))\n    SaveExt = \".\" &amp; Right(myPath, Len(myPath) - InStrRev(myPath, \".\"))\n  On Error GoTo 0\n\n'Determine if file has ever been saved\n  If FolderPath = \"\" Then\n    MsgBox \"This file has not been initially saved. \" &amp; _\n    \"Cannot save a new version!\", vbCritical, \"Not Saved To Computer\"\n    Exit Sub\n  End If\n\n'Determine Base File Name\n  If InStr(1, myFileName, VersionExt) &gt; 1 Then\n    myArray = Split(myFileName, VersionExt)\n    SaveName = myArray(0)\n  Else\n    SaveName = myFileName\n  End If\n\n'Test to see if file name already exists\n  If FileExist(FolderPath &amp; SaveName &amp; SaveExt) = False Then\n    ActivePresentation.SaveAs FolderPath &amp; SaveName &amp; SaveExt 'Errors Here\n    Exit Sub\n  End If\n\n'Need a new version made\n  Do While Saved = False\n    If FileExist(FolderPath &amp; SaveName &amp; VersionExt &amp; x &amp; SaveExt) = False Then\n      ActivePresentation.SaveAs FolderPath &amp; SaveName &amp; VersionExt &amp; x &amp; SaveExt 'Error Here\n      Saved = True\n    Else\n      x = x + 1\n    End If\n  Loop\n\n'New version saved\n  MsgBox \"New file version saved (version \" &amp; x &amp; \")\"\n\nExit Sub\n\n'Error Handler\nNotSavedYet:\n  MsgBox \"This file has not been initially saved. \" &amp; _\n    \"Cannot save a new version!\", vbCritical, \"Not Saved To Computer\"\n\nEnd Sub  \n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 50150832, "answer_count": 1, "score": 0, "last_activity_date": 1525337599, "creation_date": 1525276983, "last_edit_date": 1525277454, "question_id": 50138944, "link": "https://stackoverflow.com/questions/50138944/vba-activepresentation-saveas-error-429-activex", "title": "VBA Activepresentation.Saveas Error - 429 ActiveX", "body": "<p>I am trying to run the following code and when I get to the ActivePresentation.SaveAs i get the the following error</p>\n\n<p>Error - Run-time error '429': ActiveX component can't create object.</p>\n\n<p>I have googled around the issue and cant seem to find a clear answer, some threads suggest it could be a referencing issue however i have updated my references and the problem has persisted.</p>\n\n<pre><code>Public Sub SaveNewVersion_PowerPoint()\n'PURPOSE: Save file, if already exists add a new version indicator to filename\n'SOURCE: www.TheSpreadsheetGuru.com/The-Code-Vault\n\nDim FolderPath As String\nDim myPath As String\nDim SaveName As String\nDim SaveExt As String\nDim VersionExt As String\nDim Saved As Boolean\nDim x As Long\nDim TestStr As String\nDim myFileName As String\n\n\nTestStr = \"\"\nSaved = False\nx = 2\n\n'Version Indicator (change to liking)\n  VersionExt = \"_v\"\n\n'Pull info about file\n  On Error GoTo NotSavedYet\n    myPath = \"C:\\Users\\Person\\Desktop\\Test\\Weekly Pack Update.pptx\"\n    myFileName = Mid(myPath, InStrRev(myPath, \"\\\") + 1, InStrRev(myPath, \".\") - InStrRev(myPath, \"\\\") - 1)\n    FolderPath = Left(myPath, InStrRev(myPath, \"\\\"))\n    SaveExt = \".\" &amp; Right(myPath, Len(myPath) - InStrRev(myPath, \".\"))\n  On Error GoTo 0\n\n'Determine if file has ever been saved\n  If FolderPath = \"\" Then\n    MsgBox \"This file has not been initially saved. \" &amp; _\n    \"Cannot save a new version!\", vbCritical, \"Not Saved To Computer\"\n    Exit Sub\n  End If\n\n'Determine Base File Name\n  If InStr(1, myFileName, VersionExt) &gt; 1 Then\n    myArray = Split(myFileName, VersionExt)\n    SaveName = myArray(0)\n  Else\n    SaveName = myFileName\n  End If\n\n'Test to see if file name already exists\n  If FileExist(FolderPath &amp; SaveName &amp; SaveExt) = False Then\n    ActivePresentation.SaveAs FolderPath &amp; SaveName &amp; SaveExt 'Errors Here\n    Exit Sub\n  End If\n\n'Need a new version made\n  Do While Saved = False\n    If FileExist(FolderPath &amp; SaveName &amp; VersionExt &amp; x &amp; SaveExt) = False Then\n      ActivePresentation.SaveAs FolderPath &amp; SaveName &amp; VersionExt &amp; x &amp; SaveExt 'Error Here\n      Saved = True\n    Else\n      x = x + 1\n    End If\n  Loop\n\n'New version saved\n  MsgBox \"New file version saved (version \" &amp; x &amp; \")\"\n\nExit Sub\n\n'Error Handler\nNotSavedYet:\n  MsgBox \"This file has not been initially saved. \" &amp; _\n    \"Cannot save a new version!\", vbCritical, \"Not Saved To Computer\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "user-defined-functions", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525277394, "post_id": 50138876, "comment_id": 87296420, "body": "Try using Find And Replace. There are &quot;Options&quot; where you can select &quot;Match Case&quot;. You might have luck there. You may want to propose that you do all lower case to distinguish UDFs from built in functions too... ;)"}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525277504, "post_id": 50138876, "comment_id": 87296491, "body": "I did try that. It helpfully finds and replaces all 384 instances... which then immediately turn back into &quot;GetField&quot; again!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1525277768, "post_id": 50138876, "comment_id": 87296668, "body": "Excel doesn&#39;t care about upper/lower cases in function names therefore both should work anyway. But to change a solution is to rename the UDF in VBA to something different like <code>XXDD</code> and then use replace to change <code>GetField</code> into <code>XXDD</code> then rename the UDF to <code>GETFIELD</code> and replace <code>XXDD</code> to <code>GETFIELD</code>. This should work."}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525278373, "post_id": 50138876, "comment_id": 87297010, "body": "@P\u1d07\u029c - ok let me try that!"}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1525278776, "post_id": 50138876, "comment_id": 87297235, "body": "Worked like a champ, if you make that an answer I&#39;ll upvote it!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1525278897, "post_id": 50138876, "comment_id": 87297304, "body": "@P\u1d07\u029c Nice solution. Definitely worth posting as an answer for future users to refer to."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1525286381, "post_id": 50138876, "comment_id": 87301047, "body": "@dwirony that solution looked too obvious to me, didn&#39;t expect that impact. But you are right, I posted an answer for future readers."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525286486, "post_id": 50138876, "comment_id": 87301106, "body": "@P\u1d07\u029c I&#39;ve had the exact same problem in the past where I&#39;ve had to use a placeholder, but it took me a bit to realize what was going on - I don&#39;t think I&#39;ve seen that placeholder solution posted on here before so I figure it&#39;s a nice addition"}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 9616872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1b0d8abc237debcd8f6480e352cf25?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Sampson", "link": "https://stackoverflow.com/users/9616872/chris-sampson"}, "is_accepted": false, "score": 0, "last_activity_date": 1525279118, "creation_date": 1525279118, "answer_id": 50139556, "question_id": 50138876, "link": "https://stackoverflow.com/questions/50138876/excel-formula-keeps-reverting-to-the-original-udf-name/50139556#50139556", "title": "Excel formula keeps reverting to the original UDF name", "body": "<p>In the VBA IDE check that there isn't a duplicate of the function with the old name such as in the personal xlsb library.</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1525286239, "creation_date": 1525286239, "answer_id": 50141388, "question_id": 50138876, "link": "https://stackoverflow.com/questions/50138876/excel-formula-keeps-reverting-to-the-original-udf-name/50141388#50141388", "title": "Excel formula keeps reverting to the original UDF name", "body": "<p>First of all Excel doesn't care about upper/lower case in function names, therefore both should work no matter what case your UDF has.</p>\n\n<p>But to have it nicely and consistent you can force Excel to a specific upper/lower case change by renaming the UDF to any other name first.</p>\n\n<p>So for Example your original UDF name is <code>GetField</code> and you want to rename it to <code>GETFIELD</code>:</p>\n\n<ol>\n<li>Rename your UDF in VBA from <code>GetField</code> to something else like <code>MyTempName</code></li>\n<li>Find/Replace all formulas from <code>GetField</code> to <code>MyTempName</code></li>\n<li>Rename your UDF in VBA from <code>MyTempName</code> to <code>GETFIELD</code></li>\n<li>Find/Replace all formulas from <code>MyTempName</code> to <code>GETFIELD</code></li>\n</ol>\n"}], "owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 50141388, "answer_count": 2, "score": 1, "last_activity_date": 1525286239, "creation_date": 1525276731, "last_edit_date": 1531161705, "question_id": 50138876, "link": "https://stackoverflow.com/questions/50138876/excel-formula-keeps-reverting-to-the-original-udf-name", "title": "Excel formula keeps reverting to the original UDF name", "body": "<p>I made a UDF called \"GetField\" and made a spreadsheet that called it 384 times. Then the boss noted that, in keeping with Excel's own styles, that should really be GETFIELD. So I changed it. But now I can't change the formulas <em>in the sheet</em> to use the new version of the name.</p>\n\n<p>If I click in the field and delete the \"d\", Excel displays the pop-up with the possible hits, including GETFIELD. If I select that, I can see the editor change it to GETFIELD, but if I return to that field it's changed it back to GetField again. I tried several variations on the theme, including using Search/Replace and re-typing the whole thing, but every time it reverts to the original camel-cased name.</p>\n\n<p>Does anyone know a way to get Excel to update the name?</p>\n"}, {"tags": ["vba", "ms-access", "reference"], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 6499897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be4d08531f54bea993f0a9d666dadfb?s=128&d=identicon&r=PG&f=1", "display_name": "PAHTDC", "link": "https://stackoverflow.com/users/6499897/pahtdc"}, "edited": false, "score": 0, "creation_date": 1525279012, "post_id": 50139230, "comment_id": 87297378, "body": "Hi Gustav - understood re: need to relink/compile from the main application once library file is overwritten.  In my particular use case, I am in development environment and in the process of developing the main app/ library pair in parallel; I often find my main app development work exposes small errors in the library, but then need to shut the whole main app down to go fix an error in the library.  I have a process for dropping and re-adding references, was hoping there was a way to stick with that and not have to shutdown the main app file."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 40, "user_id": 6499897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be4d08531f54bea993f0a9d666dadfb?s=128&d=identicon&r=PG&f=1", "display_name": "PAHTDC", "link": "https://stackoverflow.com/users/6499897/pahtdc"}, "edited": false, "score": 1, "creation_date": 1525284085, "post_id": 50139230, "comment_id": 87299968, "body": "There is no way around this. Setting the reference only indicates that the library file should be read, I guess. I have never worked with library files - it&#39;s faster and simpler just to import the objects needed."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1525277942, "creation_date": 1525277942, "answer_id": 50139230, "question_id": 50138839, "link": "https://stackoverflow.com/questions/50138839/is-there-a-vba-method-of-releasing-a-reference-that-also-immediately-removes-t/50139230#50139230", "title": "Is there a VBA Method of &#39;Releasing&#39; a reference that also immediately removes the ldb (lock file)?", "body": "<p>Even if you could, you shouldn't overwrite the library file as that would leave the main application uncompiled. And it also will, even if you close the main application and then overwrite the library file. </p>\n\n<p>That's one of the limitations of library files.</p>\n\n<p>The only reliable method is to distribute them as a pair: the main application compiled with its library file.</p>\n"}], "owner": {"reputation": 40, "user_id": 6499897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be4d08531f54bea993f0a9d666dadfb?s=128&d=identicon&r=PG&f=1", "display_name": "PAHTDC", "link": "https://stackoverflow.com/users/6499897/pahtdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 50139230, "answer_count": 1, "score": 0, "last_activity_date": 1525277942, "creation_date": 1525276647, "question_id": 50138839, "link": "https://stackoverflow.com/questions/50138839/is-there-a-vba-method-of-releasing-a-reference-that-also-immediately-removes-t", "title": "Is there a VBA Method of &#39;Releasing&#39; a reference that also immediately removes the ldb (lock file)?", "body": "<p><strong>Scenario:</strong></p>\n\n<p>Using a accde (or accdb) file as a library for common code (e.g. source.accde)</p>\n\n<p>Other db's hold a reference to the library file.</p>\n\n<p>I know and am able to remove the reference (either via VBA or \"Tools..References\") and confirm its removal in both the Project Explorer ('References' subfolder disappears) and under the Tools menu).</p>\n\n<p><strong>Challenge:</strong></p>\n\n<p>When the reference is created, a ldb lock file is created in the same directory as the library.  BUT, the lock file does not go away when the reference is removed (by VBA or by Tools menu) and persists until I fully close the database file that was referencing the library.  This means I can't copy over the library file (with e.g. a new version) </p>\n\n<p><strong>Question / Looking for:</strong></p>\n\n<p>Are there vba commands / alternative approaches to getting the lock file released when a reference is removed?  I understand from previous answers that the referenced project will remain in the vbe, and this might be the source of the lock?  Closing just the VBE doesn't change things (project remains until access itself is closed).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525276741, "post_id": 50138803, "comment_id": 87296022, "body": "Change <code>&quot;&quot;&amp; UniqID &amp;&quot;&quot;</code> to <code>&quot;&quot;&quot; &amp; UniqID &amp;&quot;&quot;&quot;</code>  Two double quotes inside the string translates to a single doublequote. So you need one more to end the string so you can concatenate your variable. Then one more to start the string back up and then two more to turn into a literal <code>&quot;</code>. That&#39;s confusing, but it makes sense after you wrap your head around it. You could also do: <code>&quot; &amp; Chr(34) &amp; UniqID &amp; Chr(34) &amp; &quot;</code> where <code>Chr(34)</code> is a double quote."}, {"owner": {"reputation": 25, "user_id": 9730734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d87a0a721b84df08795085827d4cd2?s=128&d=identicon&r=PG&f=1", "display_name": "PGord", "link": "https://stackoverflow.com/users/9730734/pgord"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525276905, "post_id": 50138803, "comment_id": 87296119, "body": "Wow! You don&#39;t know how many different versions of that syntax I&#39;ve tried.  Thanks so much! Can you briefly help me understand the need for the third set of quotes?"}, {"owner": {"reputation": 25, "user_id": 9730734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d87a0a721b84df08795085827d4cd2?s=128&d=identicon&r=PG&f=1", "display_name": "PGord", "link": "https://stackoverflow.com/users/9730734/pgord"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525276939, "post_id": 50138803, "comment_id": 87296138, "body": "Sorry, didn&#39;t see the rest of your response.  Perfect.  Thanks again!"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525277110, "post_id": 50138803, "comment_id": 87296250, "body": "If you have a string like <code>&quot;This is a string, Hi&quot;</code> and you want to put double quotes around &quot;hi&quot; you write it like <code>&quot;This is a string, &quot;&quot;Hi&quot;&quot;&quot;</code> Notice we have two double quotes to mean 1-single-quote. We end the string with another double quote so there are three in a row. It can get kind of nasty looking with lots of quotes and concatenation. Which is why I often use Chr(34). It&#39;s more verbose, but you don&#39;t get into crazy quote-escaping inception."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1525277241, "creation_date": 1525277241, "answer_id": 50139014, "question_id": 50138803, "link": "https://stackoverflow.com/questions/50138803/excel-vba-using-a-variable-value-in-a-selection-formula-statement/50139014#50139014", "title": "Excel VBA || Using a variable value in a Selection.Formula statement", "body": "<p>Change <code>\"\"&amp; UniqID &amp;\"\" to \"\"\" &amp; UniqID &amp;\"\"\"</code></p>\n\n<p>Two double quotes inside the string translates to a single doublequote. So you need one more to end the string so you can concatenate your variable. Then one more to start the string back up and then two more to turn into a literal \". </p>\n\n<p>That's confusing, but it makes sense after you wrap your head around it. You could also do: </p>\n\n<pre><code>\" &amp; Chr(34) &amp; UniqID &amp; Chr(34) &amp; \" \n</code></pre>\n\n<p>where Chr(34) is a double quote.</p>\n"}], "owner": {"reputation": 25, "user_id": 9730734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d87a0a721b84df08795085827d4cd2?s=128&d=identicon&r=PG&f=1", "display_name": "PGord", "link": "https://stackoverflow.com/users/9730734/pgord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 50139014, "answer_count": 1, "score": 1, "last_activity_date": 1525277241, "creation_date": 1525276557, "last_edit_date": 1525276685, "question_id": 50138803, "link": "https://stackoverflow.com/questions/50138803/excel-vba-using-a-variable-value-in-a-selection-formula-statement", "title": "Excel VBA || Using a variable value in a Selection.Formula statement", "body": "<p>I know there are a ton of related questions throughout the site, but for whatever reason I cannot get this macro to produce the correct results... please help!!</p>\n\n<p>Code:</p>\n\n<pre><code>    Sheets(\"Interface Catalogue\").Select\n    Dim UniqID As String\n    UniqID = Trim(ActiveCell.Value)\n\n\n    Sheets(\"Data Elements\").Select\n    LastB = Cells(Rows.Count, \"B\").End(xlUp).Row\n    LastA = Cells(Rows.Count, \"A\").End(xlUp).Row\n    If LastA &gt; LastB Then\n            Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(10).Select\n            Selection.Formula = \"=HYPERLINK(\"\"#\"\"&amp;CELL(\"\"address\"\",INDEX('Interface Catalogue'!F:F,MATCH(\"\"&amp; UniqID &amp;\"\",'Interface Catalogue'!F:F,0))),\"\"&amp; UniqID &amp;\"\")\"\n        Else\n            Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(2).Previous.Select\n            Selection.Formula = \"=HYPERLINK(\"\"#\"\"&amp;CELL(\"\"address\"\",INDEX('Interface Catalogue'!F:F,MATCH(\"\"&amp; UniqID &amp;\"\",'Interface Catalogue'!F:F,0))),\"\"&amp; UniqID &amp;\"\")\"\n\n        End If\nEnd Sub\n</code></pre>\n\n<p>Running the macro should enter a hyperlink in a cell within the 'Data Elements' worksheet (either column A or column B, based on the 'If') that links to the value assigned to the UniqID variable (ActiveCell when the Macro is run) found within the 'Interface Catalogue' worksheet...</p>\n\n<p>I'm almost certain the problem is occurring in how the Formula is interpreting my Variable (\"\" &amp; UniqID &amp; \"\" - - Correct syntax???) ... When I hardcode a value in the formula instead of using the UniqID variable, it works.  When I debug and check the value assigned to the UniqID variable, it is the ActiveCell value (as expected).  What I'm currently getting is a hyperlinked \"#N/A\" in the appropriate 'Data Elements' cell, so the rest of the code appears to be working.  The formula simply isn't finding the value in the 'Interface Catalogue' tab (again, it really seems to be a matter of how the variable is being used in the selection.formula statement, because when I hardcode a value there it works).</p>\n\n<p>To be clear, I'm a complete novice in VBA (as in I just started yesterday)...  Really just hoping to figure this out.  THanks, in advance!!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1525276835, "post_id": 50138718, "comment_id": 87296080, "body": "check out <a href=\"https://stackoverflow.com/questions/10304989/open-windows-explorer-and-select-a-file\" title=\"open windows explorer and select a file\">stackoverflow.com/questions/10304989/&hellip;</a>. Its similar to what you are trying to accomplish"}, {"owner": {"reputation": 69, "user_id": 2039795, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6107ff131db48a21f982455421fab6ff?s=128&d=identicon&r=PG", "display_name": "user2039795", "link": "https://stackoverflow.com/users/2039795/user2039795"}, "reply_to_user": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1525277780, "post_id": 50138718, "comment_id": 87296677, "body": "Thank you ShanayL,  I have updated code and it is working fine. I have multiple tables,so if i add another line like...   DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, &quot;table2&quot;, _            &quot;fd\\table2.xlsx&quot;, True  this is not working. can you please guide me. my requirement is, i will define all table names in script and those should be created as separate excel files or separate tabs in same excel in user defined output folder."}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1525281016, "creation_date": 1525281016, "answer_id": 50140081, "question_id": 50138718, "link": "https://stackoverflow.com/questions/50138718/ms-access-table-export-as-excel-file-to-user-defined-folder/50140081#50140081", "title": "MS Access table export as excel file to user defined folder", "body": "<p>As @Shanayl points out, you can prompt the user to select a folder on their local machines and then pass the result into <code>DoCmd.TransferSpreadsheet</code> since it accepts a string value. Do not simply concatenat <em>fd</em> into file path.</p>\n\n<p>Below modifies <a href=\"https://stackoverflow.com/a/10305150/1422451\">@eabraham's answer</a> to run a folder picker dialog not file picker for user in a VBA function and not a VBA sub to be called later for Excel file.</p>\n\n<p><strong>Function</strong> <em>(place behind form/report in same area as button click event)</em></p>\n\n<pre><code>Private Function GetExcelFolder() As String       \n   Dim fldr As FileDialog\n   Dim txtFileName As String\n\n   ' FOLDER PICKER\n   Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n\n   With fldr\n      .AllowMultiSelect = False\n\n      ' Set the title of the dialog box.\n      .Title = \"Please select folder for Excel output.\"\n\n      ' Show the dialog box. If the .Show method returns True, the\n      ' user picked at least one file. If the .Show method returns\n      ' False, the user clicked Cancel.\n      If .Show = True Then\n        txtFileName = .SelectedItems(1)\n      Else\n        Msgbox \"No File Picked!\", vbExclamation\n        txtFileName = \"\"\n      End If\n   End With\n\n   ' RETURN FOLDER NAME\n   GetExcelFolder = txtFileName       \nEnd Function\n</code></pre>\n\n<p><strong>Button Click Event</strong></p>\n\n<pre><code>Private Sub Command3_Click()\n    Dim user_excel_fldr As String\n\n    ' CALL FUNCTION\n    user_excel_fldr = GetExcelFolder()    \n    If user_excel_fldr = \"\" Then Exit Sub\n\n    ' SPECIFY ONE TABLE\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"myTableName\", _\n       user_excel_fldr &amp; \"\\\" &amp; \"ExcelOutput.xlsx\", True\nEnd Sub\n</code></pre>\n\n<p>And for every table in your database, loop through <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195790.aspx\" rel=\"nofollow noreferrer\">TableDefs</a>, using <em>range</em> argument of MS Access's <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-transferspreadsheet-method-access\" rel=\"nofollow noreferrer\">DoCmd.TransferSpreadsheet</a> method to output each to specific worksheet tab.</p>\n\n<pre><code>Private Sub Command3_Click()\n    Dim user_excel_fldr As String\n    Dim tbldef As TableDef\n\n    ' CALL FUNCTION\n    user_excel_fldr = GetExcelFolder()\n    If user_excel_fldr = \"\" Then Exit Sub\n\n    ' LOOP THROUGH ALL TABLE NAMES\n    For Each tbldef In CurrentDb.TableDefs    \n        If Not tbldef.Name Like \"*MSys*\"    ' AVOID SYSTEM TABLES\n           DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, tbldef.Name, _\n               user_excel_fldr &amp; \"\\\" &amp; \"ExcelOutput.xlsx\", True, tbldef.Name &amp; \"!\"\n        End If\n    Next tbldef\n\n    Set tbldef = Nothing\nEnd Sub\n</code></pre>\n\n<p>By the way, do note <a href=\"https://www.google.com/search?q=Excel+is+not+a+database\" rel=\"nofollow noreferrer\">Excel is not a database</a>. Having to dump an entire MS Access database into an Excel workbook even entire tables may require reconsideration. Maybe your users need tailored and filtered tables or queries (i.e., QueryDefs).  Best practice is to use Excel as the end-use report application and Access as central repository backend.</p>\n"}], "owner": {"reputation": 69, "user_id": 2039795, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6107ff131db48a21f982455421fab6ff?s=128&d=identicon&r=PG", "display_name": "user2039795", "link": "https://stackoverflow.com/users/2039795/user2039795"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5520, "favorite_count": 0, "accepted_answer_id": 50140081, "answer_count": 1, "score": 0, "last_activity_date": 1525281016, "creation_date": 1525276304, "last_edit_date": 1525279042, "question_id": 50138718, "link": "https://stackoverflow.com/questions/50138718/ms-access-table-export-as-excel-file-to-user-defined-folder", "title": "MS Access table export as excel file to user defined folder", "body": "<p>Below code is working fine and exporting access table data into excel file (C:\\temp\\test.xlsx). </p>\n\n<p>But my requirement is instead of defining C:\\temp folder in VBA script, system should ask user to select the output directory. Could you please help me to prepare that VBA script?</p>\n\n<pre><code>Private Sub Command3_Click()\n\n DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Fields\", _\n       \"C:\\temp\\text.xlsx\", True\nEnd Sub\n</code></pre>\n"}, {"tags": ["python-2.7", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 9742641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OxCTi.jpg?s=128&g=1", "display_name": "Charlie B.", "link": "https://stackoverflow.com/users/9742641/charlie-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1525460543, "creation_date": 1525460543, "answer_id": 50181608, "question_id": 50138068, "link": "https://stackoverflow.com/questions/50138068/add-macro-to-excel-using-python-xlswriter-with-data-in-original-excel/50181608#50181608", "title": "add macro to excel using python xlswriter with data in original excel", "body": "<p>Unfortunately, xlsxwriter can't load information from already existing Excel workbooks; it is only used for making new ones. You are overwriting your old workbook with a blank one that has your macros.</p>\n\n<p>If you need to load information, look into <a href=\"https://openpyxl.readthedocs.io/en/stable/\" rel=\"nofollow noreferrer\">openpyxl</a>. It can be used for creating .xlsm files.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 9618695, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9YaUbxzMo1Y/AAAAAAAAAAI/AAAAAAAAAXQ/Shxw7AztHY8/photo.jpg?sz=128", "display_name": "Sam Jinko", "link": "https://stackoverflow.com/users/9618695/sam-jinko"}, "is_accepted": false, "score": 0, "last_activity_date": 1529055720, "creation_date": 1529055720, "answer_id": 50872930, "question_id": 50138068, "link": "https://stackoverflow.com/questions/50138068/add-macro-to-excel-using-python-xlswriter-with-data-in-original-excel/50872930#50872930", "title": "add macro to excel using python xlswriter with data in original excel", "body": "<p>One way around it is to create the macro you want in another Excel so we can execute it to affect the other Excel. Then using win32.com it runs the VBA.</p>\n\n<pre><code>enter code here\n#import win32com.client\n#xl=win32com.client.Dispatch(\"Excel.Application\")\n#xl.Workbooks.Open(Filename=\"C:\\\\macro.xlsm\",ReadOnly=1)\n#xl.Application.Run(\"macro\")\n#xl = 0\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9618695, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9YaUbxzMo1Y/AAAAAAAAAAI/AAAAAAAAAXQ/Shxw7AztHY8/photo.jpg?sz=128", "display_name": "Sam Jinko", "link": "https://stackoverflow.com/users/9618695/sam-jinko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 50181608, "answer_count": 2, "score": 1, "last_activity_date": 1529055720, "creation_date": 1525274183, "last_edit_date": 1531164843, "question_id": 50138068, "link": "https://stackoverflow.com/questions/50138068/add-macro-to-excel-using-python-xlswriter-with-data-in-original-excel", "title": "add macro to excel using python xlswriter with data in original excel", "body": "<p>I'm using the following code to add a Macro to Excel. I notice that the data / other WorkSheets from the original Excel had dropped completely but the Macro is showing.</p>\n\n<p>This is the code that I am using:</p>\n\n<pre><code>import xlsxwriter\nworkbooks = xlsxwriter.Workbook('C:\\\\Users\\\\user\\Desktop\\\\test.xlsm')\nworkbooks.add_vba_project('C:\\\\Users\\\\user\\\\Desktop\\\\vbaProject.bin')\nworkbooks.close()\n</code></pre>\n\n<p>I used the link <a href=\"http://xlsxwriter.readthedocs.io/example_macros.html\" rel=\"nofollow noreferrer\">http://xlsxwriter.readthedocs.io/example_macros.html</a> and it seems to be the same from another page <a href=\"https://redoakstrategic.com/pythonexcelmacro/\" rel=\"nofollow noreferrer\">https://redoakstrategic.com/pythonexcelmacro/</a> </p>\n\n<p>I wondered if there is another library that I should use for this?</p>\n\n<p>I tried the following link <a href=\"https://stackoverflow.com/questions/17197259/use-python-to-inject-macros-into-spreadsheets\">Use Python to Inject Macros into Spreadsheets</a> it seems that here again the data from the original file is overwritten. Not sure if this is a duplicate or not, or if I missed something rather obvious ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vlookup", "worksheet", "vba"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1525274852, "post_id": 50138025, "comment_id": 87294819, "body": "Could it be that you&#39;re attempting your <code>vlookup()</code> in the same <code>ActiveWorkbook</code>&#39;s <code>Sheet1</code>?  I.e., you&#39;re working with 2 different workbooks here, right?  Do you need to distinguish them in this code? Or am I misunderstanding what you&#39;re trying to accomplish?"}], "answers": [{"tags": [], "owner": {"reputation": 292, "user_id": 7501821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb7044faa0544b9c43911120ff60600d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Souza", "link": "https://stackoverflow.com/users/7501821/daniel-souza"}, "is_accepted": false, "score": 0, "last_activity_date": 1525275025, "creation_date": 1525275025, "answer_id": 50138345, "question_id": 50138025, "link": "https://stackoverflow.com/questions/50138025/vlookup-table-to-copy-sheet-to-other-workbook-vba/50138345#50138345", "title": "Vlookup table to copy sheet to other workbook vba", "body": "<p>Probably because you're lacking the last parameter of vlookup, which causes the function to return aproximate values when it doesn't match to your range, so you need to add \", FALSE\" before close your parenthesis</p>\n"}], "owner": {"reputation": 51, "user_id": 4133112, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/509946090/picture?type=large", "display_name": "Michael Martinez", "link": "https://stackoverflow.com/users/4133112/michael-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525701983, "creation_date": 1525274044, "last_edit_date": 1531161705, "question_id": 50138025, "link": "https://stackoverflow.com/questions/50138025/vlookup-table-to-copy-sheet-to-other-workbook-vba", "title": "Vlookup table to copy sheet to other workbook vba", "body": "<p>I am working with two workbooks. In one workbook I have a template and a lookup table. In the other workbook I have many sheets with only a few named alpha. </p>\n\n<p>The lookup table has a column for the alpha sheet names, and two other columns with values to rename the sheet. </p>\n\n<p>I essentially need to copy a template and paste it in the second workbook for each sheet that has alpha in the name and rename the template to the values in the lookup table. I'm currently having a problem getting the vlookup to work. Though ws.name is returning the right values, my \"a\" value is not matching up even to the first column which should be a 1 to 1 match. </p>\n\n<p>Below is my code so far.</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Sheets\n\n    If LCase(ws.Name) Like \"*alpha*\" Then\n\n                a = Application.WorksheetFunction.VLookup(ws.Name, Sheet1.Range(\"A2:D24\"), 1)\n\n                Debug.Print ws.Name\n                Debug.Print a \n     End If\nNext ws\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9659657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f49c9e34774cb19d5adf7be24a4c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Super Dood", "link": "https://stackoverflow.com/users/9659657/super-dood"}, "edited": false, "score": 0, "creation_date": 1525278274, "post_id": 50138117, "comment_id": 87296958, "body": "great stuff bud! can i ask another favour... im looking to add this to multiple cells R35, R37, R39 and R41. can this be added in into line 3 or will i have to create this whole code for each cell?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 9659657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f49c9e34774cb19d5adf7be24a4c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Super Dood", "link": "https://stackoverflow.com/users/9659657/super-dood"}, "edited": false, "score": 0, "creation_date": 1525281303, "post_id": 50138117, "comment_id": 87298495, "body": "@SuperDood - it is doable, I guess. But is probably a good idea to ask it  as a separate question."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1525315463, "post_id": 50138117, "comment_id": 87310454, "body": "Good addition of the Error Catcher, and well explained."}, {"owner": {"reputation": 33, "user_id": 9659657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f49c9e34774cb19d5adf7be24a4c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Super Dood", "link": "https://stackoverflow.com/users/9659657/super-dood"}, "edited": false, "score": 1, "creation_date": 1525338849, "post_id": 50138117, "comment_id": 87320131, "body": "@Vityata thanks mate. im trying to avoid using the same code for each line so youve given me what i need."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1525275583, "last_edit_date": 1525275583, "creation_date": 1525274336, "answer_id": 50138117, "question_id": 50137860, "link": "https://stackoverflow.com/questions/50137860/vba-change-cell-value-when-clicked-from-to-yes-no-for-merged-cells/50138117#50138117", "title": "VBA - Change cell value when clicked from/to yes/no for merged cells", "body": "<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n\n    On Error GoTo Worksheet_SelectionChange_Error\n\n    Application.EnableEvents = False\n    Debug.Print Target.Cells.Count  'just FYI, remove it later\n\n    If Not Intersect(Target.Cells(1), Range(\"R33\").MergeArea) Is Nothing Then\n\n        Select Case Target.Cells(1)\n        Case \"yes\"\n            Target.Cells(1) = vbNullString\n        Case vbNullString\n            Target.Cells(1) = \"yes\"\n        End Select\n\n    End If\n\n    Range(\"A1\").Select\n    Application.EnableEvents = True\n\n   On Error GoTo 0\n   Exit Sub\n\nWorksheet_SelectionChange_Error:\n\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \")\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>The merged cells are a bit evil in Excel, but if you play around a bit you can achieve what you need:</p>\n\n<ul>\n<li><code>Target.Cells.Count</code> is equal to the number of merged cells, thus it is never <code>1</code>. I have deleted it;</li>\n<li><code>Target.Cells(1)</code> is the way to refer the first cell of the <code>MergedArea</code>;</li>\n<li><code>Range(\"R33\").MergeArea</code> is a good way to check the intersect;</li>\n<li>As sometimes while executing <code>_SelectionChange</code> event, you may get an error and then leave the <code>Application.EnableEvents = False</code>, it is a good practice to use an Error Catcher, which sets it back to <code>True</code>;</li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 9659657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f49c9e34774cb19d5adf7be24a4c7c?s=128&d=identicon&r=PG&f=1", "display_name": "Super Dood", "link": "https://stackoverflow.com/users/9659657/super-dood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "accepted_answer_id": 50138117, "answer_count": 1, "score": 1, "last_activity_date": 1525275682, "creation_date": 1525273569, "last_edit_date": 1525275682, "question_id": 50137860, "link": "https://stackoverflow.com/questions/50137860/vba-change-cell-value-when-clicked-from-to-yes-no-for-merged-cells", "title": "VBA - Change cell value when clicked from/to yes/no for merged cells", "body": "<p>I have created a form that will give the user the choice to pick from 7 different options whcih will all be default blank. When they click the cell next to the option it will change from blank to \"yes\" and when clicked again it will remove the text and so on. The issue I have its the cell that is clickable from blank to \"yes\" is merged between R33 and S33. The code works on the cell R33 alone but not when I merge them. Can you help me out with this please?</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n  Application.EnableEvents = False\n  If Target.Cells.Count = 1 Then\n    If Not Intersect(Target, Range(\"R33\")) Is Nothing Then\n      Select Case Target.Value\n      Case \"\"\n        Target.Value = \"yes\"\n      Case \"yes\"\n        Target.Value = \"\"\n      End Select\n      Range(\"A1\").Select\n    End If\n  End If\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5, "user_id": 9730838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barry Lewis", "link": "https://stackoverflow.com/users/9730838/barry-lewis"}, "edited": false, "score": 0, "creation_date": 1525283849, "post_id": 50137357, "comment_id": 87299851, "body": "Thanks!  It was only highlighting starting at Column D, but I modified it to get the whole row.  Now, I just have to do some research to learn more about Dim and &quot;C as range&quot;  Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1525273904, "last_edit_date": 1525273904, "creation_date": 1525273442, "answer_id": 50137825, "question_id": 50137357, "link": "https://stackoverflow.com/questions/50137357/hightlight-entire-row-if-two-columns-match-and-are-not-blank/50137825#50137825", "title": "Hightlight entire row if two columns match and are not blank", "body": "<p>Here is a version you can look at</p>\n\n<pre><code>Sub DoIt()\n\n    Dim Rng As Range, C As Range\n\n    Set Rng = Columns(\"K:K\").SpecialCells(xlCellTypeConstants, 23)\n    Columns(\"K:K\").SpecialCells(xlCellTypeBlanks).EntireRow.Interior.Color = xlNone\n    For Each C In Rng.Cells\n\n        If C.Offset(, -7) = C Then\n\n            Range(Cells(C.Row, \"K\"), Cells(C.Row, \"D\")).Interior.Color = vbYellow\n        Else: Range(Cells(C.Row, \"K\"), Cells(C.Row, \"D\")).Interior.Color = xlNone\n\n        End If\n\n    Next C\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9730838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barry Lewis", "link": "https://stackoverflow.com/users/9730838/barry-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "accepted_answer_id": 50137825, "answer_count": 1, "score": 0, "last_activity_date": 1612728243, "creation_date": 1525272064, "last_edit_date": 1612728243, "question_id": 50137357, "link": "https://stackoverflow.com/questions/50137357/hightlight-entire-row-if-two-columns-match-and-are-not-blank", "title": "Hightlight entire row if two columns match and are not blank", "body": "<p>I looked and although there is likely something here, I'm too new to VBA to make it work.</p>\n<p>I want to sort a range of data, and highlight a row if two particular columns match, as long as one column (K) is not blank.</p>\n<p>More Details:<br />\nIf column D = column K and column K is not blank, then highlight that row.<br />\nThe amount of rows will change depending on the day.<br />\nThe dataset starts at row 3.</p>\n<p>I was thinking to use <code>.end(xlup)</code> to copy the formula.</p>\n<p>This can be accomplished through conditional formatting, but I'm trying to build this in VBA so that it will be a one button solution.</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1525271827, "post_id": 50137188, "comment_id": 87292799, "body": "Shot in the dark - are you missing a library reference?"}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1525271993, "post_id": 50137188, "comment_id": 87292897, "body": "Not that I can see. Again, all the other ones work fine. About 7 other subs in total, all with the same declarations. All work fine."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1525272156, "post_id": 50137188, "comment_id": 87293020, "body": "Where is this subroutine located, in the same module as the others? What about changing it from a <code>Sub</code> to a <code>Public Sub</code>? It looks like <code>.LateLessThan</code> is something created elsewhere."}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1525272370, "post_id": 50137188, "comment_id": 87293143, "body": "I have a module that contains all the SQL queries as individual subs. They are called on button click. I tried adding Public to it but no joy.  LateLessThan is a text box on the userform Reporting."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1525272804, "post_id": 50137188, "comment_id": 87293473, "body": "that&#39;s the issue; not properly referring to <code>Reporting.LateLessThan</code>.  (re: your other comment: When stepping through code, VBA will never stop on variable declaration.)"}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1525273032, "post_id": 50137188, "comment_id": 87293655, "body": "I know you can&#39;t see all the forms but do you have any tips as far as properly referring to it? I&#39;m not sure how I&#39;m not doing it correctly."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1525273729, "post_id": 50137188, "comment_id": 87294117, "body": "Are you sure you&#39;re getting results? After <code>rs.Open...</code> throw in a <code>If not rs.BOF And not rs.EOF</code> - that will ensure you&#39;re only trying to access the contents of the recordset <i>if</i> there are records in it."}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1525276399, "post_id": 50137188, "comment_id": 87295795, "body": "It&#39;s pulling in results. I&#39;ve even just replaced &quot; &amp; Reporting.AgentName.Value &amp; &quot;   with an actual name I know will pull in results and it still skips it over."}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1525282421, "post_id": 50137188, "comment_id": 87299098, "body": "So, I just realized that the cause is me using a textbox instead of a listbox. The code was meant for filling a listbox with the results of a recordset. I didn&#39;t adapt it to filling a textbox with one single result. If anyone else is experiencing anything similar I hope this helps you out! Thanks for taking a look."}], "owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525282471, "creation_date": 1525271486, "last_edit_date": 1525282471, "question_id": 50137188, "link": "https://stackoverflow.com/questions/50137188/vba-sub-seems-to-be-skipping-over-connection-declarations", "title": "VBA Sub seems to be skipping over connection declarations", "body": "<p>Edit: \nIt turns out that the cause is me using a textbox instead of a listbox. The code was meant for filling a listbox with the results of a recordset. I didn't adapt it to filling a textbox with one single result. If anyone else is experiencing anything similar I hope this helps you out! Thanks for taking a look</p>\n\n<p>I have several SQL queries that I run in a VBA project in excel.They are run off of button clicks.  I declare all the connection variables and so on in each Sub then close them when it's done running. Most of them are just copy and paste of the following with the SQL Query variables changed:</p>\n\n<pre><code>Public Sub AgentsReporting()\nDim Cn As ADODB.Connection\nDim Server_Name As String\nDim Database_Name As String\nDim SQLStr As String\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\nServer_Name = \"SDL02-VM25\"\nDatabase_Name = \"PIA\"\nSQLStr = \"select distinct[Agent Name] from dbo.[Master Staffing List] Where [Team] ='\" &amp; Reporting.ChooseTeam.Value &amp; \"'\"\nSet Cn = New ADODB.Connection\nCn.Open \"Driver={SQL Server};Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; vbNullString\nrs.Open SQLStr, Cn, adOpenStatic\nWith Reporting.ChooseAgent\n.Clear\nDo\n.AddItem rs![Agent Name]\nrs.MoveNext\nLoop Until rs.EOF\nEnd With\nrs.Close\nCn.Close\nSet rs = Nothing\nSet Cn = Nothing\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>So far all of them work except for the one below. When I step through it it seems to skip over all the declarations and gives me a \"Method or Data Member not found\" error and highlights the \".clear\" line. </p>\n\n<pre><code>Sub GetLateLessThan()\nDim Cn As ADODB.Connection\nDim Server_Name As String\nDim Database_Name As String\nDim SQLStr As String\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\nServer_Name = \"SDL02-VM25\"\nDatabase_Name = \"PIA\"\nSQLStr = \"select [Weekday Schedule] from dbo.[Master Staffing List] Where [Agent Name] ='\" &amp; Reporting.AgentName.Value &amp; \"'\"\nSet Cn = New ADODB.Connection\nCn.Open \"Driver={SQL Server};Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; vbNullString\nrs.Open SQLStr, Cn, adOpenStatic\nWith Reporting.LateLessThan\n    .Clear\n    Do\n    .AddItem rs![Weekday Schedule]\n    rs.MoveNext\n    Loop Until rs.EOF\nEnd With\nrs.Close\nCn.Close\nSet rs = Nothing\nSet Cn = Nothing\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>I cannot figure out why it's not working. It looks like it should be working fine, I've double checked the with statement, double checked the names of the variables. Does anyone have any idea as to why this particular sub is failing when the other ones seem to work fine?</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1525270980, "post_id": 50136955, "comment_id": 87292182, "body": "You have quotes around your variables... they won&#39;t be treated as variables. What is in <code>Range(&quot;Q4&quot;).value</code> and Q5 that you are storing in those two variables? What are you anticipating <code>Range(&quot;CO_priority&quot; &amp; i)</code> is going to rectify too?"}, {"owner": {"reputation": 145, "user_id": 7468987, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e631c71d841a754cac8af47e0ff55b65?s=128&d=identicon&r=PG&f=1", "display_name": "mabanger", "link": "https://stackoverflow.com/users/7468987/mabanger"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1525271362, "post_id": 50136955, "comment_id": 87292464, "body": "okay, my bad I&#39;m sorry perhaps another coffee would solve my problem. the solution is what you gave me &quot;You have quotes around your variables... they won&#39;t be treated as variables.&quot; thank and sorry"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1525271948, "last_edit_date": 1525271948, "creation_date": 1525271639, "answer_id": 50137235, "question_id": 50136955, "link": "https://stackoverflow.com/questions/50136955/excel-vba-to-delete-rows-based-on-several-criteria/50137235#50137235", "title": "Excel VBA to delete rows based on several criteria", "body": "<p>A faster way will be using a <code>DelRng</code> to merge all rows that pass your 2-criteria, and then delete the entire range at once.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit           \n\nSub DelRows()\n\nDim CO_priority As String\nDim Col_ticketage As String\nDim LR As Long, i As Long\nDim DelRng As Range\n\nCO_priority = Range(\"Q4\").Value\nCol_ticketage = Range(\"Q5\").Value\n\nWith Sheets(\"Inc\")\n    LR = .Range(CO_priority &amp; .Rows.Count).End(xlUp).Row\n    For i = LR To 2 Step -1\n        If (.Range(CO_priority &amp; i).Value = 1 And .Range(Col_ticketage &amp; i).Value &lt; 1) Then\n            If Not DelRng Is Nothing Then\n                Set DelRng = Application.Union(DelRng, .Rows(i))\n            Else\n                Set DelRng = .Rows(i)\n            End If\n        End If\n    Next i\nEnd With\n' make sure DelRng is not nothing &gt;&gt; delete entire rows at one-shot\nIf Not DelRng Is Nothing Then DelRng.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7468987, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e631c71d841a754cac8af47e0ff55b65?s=128&d=identicon&r=PG&f=1", "display_name": "mabanger", "link": "https://stackoverflow.com/users/7468987/mabanger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 50137235, "answer_count": 1, "score": 0, "last_activity_date": 1525271948, "creation_date": 1525270807, "question_id": 50136955, "link": "https://stackoverflow.com/questions/50136955/excel-vba-to-delete-rows-based-on-several-criteria", "title": "Excel VBA to delete rows based on several criteria", "body": "<p>I have the following code </p>\n\n<pre><code>Dim CO_priority As String\nDim Col_ticketage As String\n\nCO_priority = Range(\"Q4\").Value\nCol_ticketage = Range(\"Q5\").Value\n\nSheets(\"Inc\").Select\nLR = Range(\"CO_priority\" &amp; Rows.Count).End(xlUp).Row\nFor i = LR To 2 Step -1\n    If (Range(\"CO_priority\" &amp; i).Value = \"1\" And Range(\"Col_ticketage\" &amp; i).Value &lt; \"1\") Then Rows(i).delete\nNext I\n</code></pre>\n\n<p>I would like this code to delete the rows if in Column given by the variable \"CO_priority\" value is 1 and in the column given by another variable \"Col_ticketage\" value is less than 1. </p>\n\n<p>So lets say if the cell in Column A has the number 1 in it and Column B has a number smaller than 1 this row should be deleted, but in any other case the row should stay.</p>\n\n<p>The code above for is deleting each and every line for some reason.</p>\n\n<p>Could you tell me what's wrong with this code?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "edited": false, "score": 3, "creation_date": 1525269903, "post_id": 50136530, "comment_id": 87291339, "body": "What do you mean by &quot;12 rows from sheet1 to sheet2&quot; - is there any way you could include an example?"}, {"owner": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "reply_to_user": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "edited": false, "score": 0, "creation_date": 1525270341, "post_id": 50136530, "comment_id": 87291680, "body": "In sheet 1 I have 12 rows of data called max score so for example I have a machine number M03 as column hearder  and it has 12 rows of max scores say 1,2,3,4,5,6,7,8,9,10,11,12 and I have M04 as column header in same sheet 1 and the scores will be 2,3,5,4,7,8,9,10,12,13,14,11 so in sheet 2 I have a header Machine number and the rows contain the machine number so what I need is machine number from sheet 2 has to check machine number from sheet 1 and display those 12 scores in sheet 2. Ex: Sheet 2 machine number has to check M03 from sheet 1 and paste all the max scores in machine number sheet 2"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1525270462, "post_id": 50136530, "comment_id": 87291764, "body": "What have you tried? A screenshot would be more useful what with a picture being worth 1000 words."}, {"owner": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "edited": false, "score": 0, "creation_date": 1525270693, "post_id": 50136530, "comment_id": 87291946, "body": "Sub Chapters_Practical()     Application.ScreenUpdating = False     Dim Sht3 As Worksheet     Dim Sht2 As Worksheet     Dim i, j  As IntegerDim LastBlankRow As Long Dim rng As Range Dim cell As Range Set Sht3 = Worksheets(&quot;Chapters&quot;) Set Sht2 = Worksheets(&quot;Practical results&quot;)"}, {"owner": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "edited": false, "score": 0, "creation_date": 1525270865, "post_id": 50136530, "comment_id": 87292077, "body": "If (Sht2.Range(E1)) = &quot;M03&quot; Then Sht3.Range(&quot;I2:I13&quot;).Copy Sht2.Cells(Rows.Count, 9).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues ElseIf (Sht2.Range(E1)) = &quot;M04&quot; Then Sht3.Range(&quot;J2:J13&quot;).Copy Sht2.Cells(Rows.Count, 9).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues End If"}, {"owner": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "edited": false, "score": 0, "creation_date": 1525271123, "post_id": 50136530, "comment_id": 87292290, "body": "I&#39;m confused... You say you want to copy from <code>sheet 1</code> to <code>sheet 2</code> - but your code appears to be dealing with <code>sheet 2</code> and <code>sheet 3</code>. Which sheets are you dealing with?"}, {"owner": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "edited": false, "score": 0, "creation_date": 1525271190, "post_id": 50136530, "comment_id": 87292343, "body": "Sorry I mentioned them as as example as sheet 1 and sheet 2 but in reality they are sht 2 and sht 3 just a name difference"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525271657, "post_id": 50136530, "comment_id": 87292672, "body": "What exactly is the problem with your code as it stands? For one thing it should be <code>Range(&quot;E1&quot;)</code>."}, {"owner": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "edited": false, "score": 0, "creation_date": 1525272571, "post_id": 50136530, "comment_id": 87293288, "body": "If my answer works, please mark it as complete. Otherwise, comment with why it&#39;s not working for you"}, {"owner": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "edited": false, "score": 0, "creation_date": 1525357854, "post_id": 50136530, "comment_id": 87332938, "body": "Any ideas for second code is appriciated"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "edited": false, "score": 0, "creation_date": 1525335003, "post_id": 50136983, "comment_id": 87317775, "body": "Hi Arod, I tried executing your code by changing the sheet names the way I needed, the code is running but I don&#39;t get any data in the sheet. can I know what this line here does machineNum = ws1.Cells(1, i).Value"}, {"owner": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "reply_to_user": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "edited": false, "score": 0, "creation_date": 1525340578, "post_id": 50136983, "comment_id": 87321302, "body": "<code>machineNum=ws1.Cells(1,i).Value</code> gets the machine number from the first worksheet"}, {"owner": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "edited": false, "score": 0, "creation_date": 1525354625, "post_id": 50136983, "comment_id": 87330587, "body": "Hi Arod, Thank you for your efforts, I tried to work with the code but I don&#39;t get any output out of the code which you have provided."}, {"owner": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "reply_to_user": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "edited": false, "score": 0, "creation_date": 1525363411, "post_id": 50136983, "comment_id": 87336587, "body": "Do you know how to place a breakpoint? If so, put one on the line that says <code>Set wb = ActiveWorkbook</code> and then step through it. Debugging commands can be found in the toolbar under <code>Debug</code>"}], "tags": [], "owner": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "is_accepted": false, "score": 0, "last_activity_date": 1525272476, "last_edit_date": 1525272476, "creation_date": 1525270863, "answer_id": 50136983, "question_id": 50136530, "link": "https://stackoverflow.com/questions/50136530/if-else-condition-excel-vba/50136983#50136983", "title": "if else condition excel vba", "body": "<p>Based on your comments, I think this should do the trick...</p>\n\n<pre><code>Public Sub TransferData()\n    Dim wb As Workbook\n    Dim ws1 As Worksheet\n    Dim ws2 As Worksheet\n\n    Set wb = ActiveWorkbook\n\n    Set ws1 = wb.Worksheets(\"Chapters\") ' I'm assuming this is \"Sheet 1\"\n    Set ws2 = wb.Worksheets(\"Practical results\") ' I'm assuming this is \"Sheet 2\"\n\n    Dim k As Range\n    Dim lastCol1 As Integer\n    Dim lastCol2 As Integer\n    Dim i As Integer\n    Dim j As Integer\n    Dim r As Integer\n\n\n    lastCol1 = ws1.Cells.SpecialCells(xlCellTypeLastCell).Column\n    lastCol2 = ws2.Cells.SpecialCells(xlCellTypeLastCell).Column\n    For i = 1 To lastCol1\n        Dim machineNum As String\n        machineNum = ws1.Cells(1, i).Value\n        For j = 1 To lastCol2\n            ' If they match, then print\n            If ws2.Cells(1, j).Value = machineNum Then\n                For r = 2 To 13 ' I am assuming you have one header row, 12 data rows\n                    Set k = ws1.Cells(r, i)\n                    ws2.Cells(r, j).Value = k.Value\n                Next r\n            End If\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 3341851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7778b4a39a35bff0081567da2196cd28?s=128&d=identicon&r=PG&f=1", "display_name": "user3341851", "link": "https://stackoverflow.com/users/3341851/user3341851"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1525357825, "creation_date": 1525269669, "last_edit_date": 1525357825, "question_id": 50136530, "link": "https://stackoverflow.com/questions/50136530/if-else-condition-excel-vba", "title": "if else condition excel vba", "body": "<p>Image 1:<a href=\"https://i.stack.imgur.com/DVGCK.png\" rel=\"nofollow noreferrer\">This image is for machine number if the machine number In practical results sheet matches the data in machine number in chapter sheet the data has to be copied in the sheet practical results</a> \nImage 2:<a href=\"https://i.stack.imgur.com/Yxo9d.png\" rel=\"nofollow noreferrer\">Machine number in Practical sheet</a>[Should paste here in max score if machine number matches] \nImage 3:<a href=\"https://i.stack.imgur.com/q3iKQ.png\" rel=\"nofollow noreferrer\">3</a>I have a small question related to Excel VBA. </p>\n\n<p>I have 3 sheets in a work book:</p>\n\n<ul>\n<li>sheet1: Chapters </li>\n<li>sheet2: Mcq results and </li>\n<li>sheet3: Practical results </li>\n</ul>\n\n<p>My question is how to use <code>if \u2026 else</code> statement in Excel VBA so that I would like to check the machine numbers column in Sheet1 and again cross check the machine number in sheet2 if <code>sheet1.Machinenumber = Sheet2.Machinenumber</code> it has to fill all the 12 rows from sheet1 to sheet2 max score column.</p>\n\n<p>Any ideas would be appreciated.</p>\n\n<pre><code>Dim Sht3 As Worksheet\nDim Sht2 As Worksheet\nDim i, j  As Integer\nDim LastBlankRow As Long\nDim rng As Range\nDim cell As Range\n\n\nSet Sht3 = Worksheets(\"Chapters\")\nSet Sht2 = Worksheets(\"Practical results\")\n\nIf (Sht2.Range(E1)) = \"M03\" Then\nSht3.Range(\"I2:I13\").Copy\nSht2.Cells(Rows.Count, 9).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nElseIf (Sht2.Range(E1)) = \"M04\" Then\nSht3.Range(\"J2:J13\").Copy\nSht2.Cells(Rows.Count, 9).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nEnd If\n</code></pre>\n\n<p>Second code:</p>\n\n<pre><code>Sub Copypaste_Mcq()\nApplication.ScreenUpdating = False\nDim Sht3 As Worksheet\nDim Sht2 As Worksheet\nDim i, j  As Integer\nDim LastBlankRow As Long\nDim rng As Range\nDim cell As Range\n\n\nSet Sht3 = Worksheets(\"Chapters\")\nSet Sht2 = Worksheets(\"Mcq Results\")\n'LastRow = Sht2.Range(\"A\" &amp; Sht2.Rows.Count).End(xlUp).Offset(0).Row\n'LastRow2 = Sht2.Range(\"G\" &amp; Sht2.Rows.Count).End(xlUp).Offset(0).Row\n'NumRows = Sht2.Range(\"A1\", Range(\"A1\").End(xlUp)).Rows.Count\n'Sht2.Activate\n\n\n'LastBlankRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n LastRow = Sht2.Range(\"A\" &amp; Sht2.Rows.Count).End(xlUp).Offset(0).Row\n\nFor i = 1 To LastRow\nDim machineNum As String\n\nLastRow = Sht2.Range(\"E\" &amp; Sht2.Rows.Count).End(xlUp).Offset(0).Row\nLastrow2 = Sht2.Range(\"E\" &amp; Sht2.Rows.Count).End(xlUp).Offset(0, 4).Value\nmachineNum = Sht3.Cells(E1).Value\n\nIf (machineNum = Sht2.Cells(I1)) Then\nSht3.Range(\"I2:I13\").Copy\nSht2.Cells(Rows.Count, 9).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\n'Application.ScreenUpdating = True\nEnd If\n\nIf (Lastrow2 = \"\") Then\nSht3.Range(\"J2:J13\").Copy\nSht2.Cells(Rows.Count, 9).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\n'Application.ScreenUpdating = True\nEnd If\n\n\nNext i\nLastRow = Sht2.Range(\"A\" &amp; Sht2.Rows.Count).End(xlUp).Offset(0).Row\nLastrow2 = Sht2.Range(\"A\" &amp; Sht2.Rows.Count).End(xlUp).Offset(0, 4).Row\n\nIf (LastRow = Lastrow2) Then\n\nExit Sub\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "edited": false, "score": 0, "creation_date": 1525270277, "post_id": 50136529, "comment_id": 87291627, "body": "What exactly is your question? It&#39;s difficult to answer because I can&#39;t tell what you&#39;re trying to ask. Does the script currently work? What problems are you facing?"}, {"owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "reply_to_user": {"reputation": 133, "user_id": 5250021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSWoP.png?s=128&g=1", "display_name": "Arod Ponyboy678", "link": "https://stackoverflow.com/users/5250021/arod-ponyboy678"}, "edited": false, "score": 0, "creation_date": 1525278409, "post_id": 50136529, "comment_id": 87297031, "body": "Yes the script currently works for the first two cases I listed but not the last two cases. The problem I am facing is being able to account for the last two cases (the script currently accounts for the other two).  Another thing which is more of a question than a problem is that I am wondering if there are any better methods or functions for parsing data from file names? This current method is mostly a large number of if statements enclosed in a while loop. If there was another way that didn&#39;t rely on the file name being uniform and using right() or left funtion I would be open to using that."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1525293926, "creation_date": 1525293926, "answer_id": 50143294, "question_id": 50136529, "link": "https://stackoverflow.com/questions/50136529/take-parts-of-subject-matter-from-email-and-input-them-into-excel-tabl/50143294#50143294", "title": "Take parts of subject matter from email and input them into excel tabl", "body": "<p>Based on your examples, this is probably a reasonable approach.\nIt's easier to manage if you split your parsing out into a separate method.</p>\n\n<p>Just parsing texts from a range on a worksheet: </p>\n\n<pre><code>Sub Process()\n    Dim c As Range, op As String, np As String\n\n    For Each c In Range(\"A1:A6\").Cells\n        ParseAddresses c.Value, op, np '&lt;&lt; passing np/op by reference...\n        c.Offset(0, 1).Value = op\n        c.Offset(0, 2).Value = np\n    Next c\n\nEnd Sub\n\n'Parse two addresses from \"t\" into \"op\" and \"np\"\nSub ParseAddresses(ByVal t, ByRef op As String, ByRef np As String)\n    Dim arr\n\n    op = \"\": np = \"\"\n    t = Trim(t)\n    If t Like \"Address Change Circulation -*to*\" Then\n        t = Replace(t, \"Address Change Circulation -\", \"\")\n        t = Replace(t, \"from\", \"\")\n        arr = Split(t, \"to\")\n        op = Trim(arr(0))\n        np = Trim(arr(1))\n        ' \"from\" part is just a number: replace number in \"to\" part\n        If IsNumeric(op) Then\n            arr = Split(np, \" \")\n            arr(0) = op\n            op = Join(arr, \" \")\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1525293926, "creation_date": 1525269665, "last_edit_date": 1525292609, "question_id": 50136529, "link": "https://stackoverflow.com/questions/50136529/take-parts-of-subject-matter-from-email-and-input-them-into-excel-tabl", "title": "Take parts of subject matter from email and input them into excel tabl", "body": "<p>Hello below I have included the current vba script for running thru a file containing multiple emails with specific file names that correspond to address changes discussed in the emails. I want to take the text pertaining to the address change from each of these file names and input the new and old address in an excel table. All the emails in this folder fall into 4 categories of how their title is formatted the following are an example of all four:</p>\n\n<ul>\n<li>\"Address Change Circulation - 14 to 12 Queen Street\"</li>\n<li>\"Address Change Circulation - from 4 to 2 King Street\"</li>\n<li>\"Address Change Circulation - 40 south Street to 1 main Avenue\"</li>\n<li>\"Address Change Circulation - from 4 door street to 2 tenth street\". </li>\n</ul>\n\n<p>As you can see they all start with the same string \"Address change circulation\" however I am having trouble with getting a script that can adapt to all these different scenarios. Below I have included the current iteration of the script If anyone has any suggests or improvements that would be very helpful thank you. </p>\n\n<pre><code>Dim StrFile As String\n'Change this to the directory containing all Address Change Circulation emails\n'This will Pull in a list and, to the best of its ability make two columns that hold the data for\n'the old and the new address\nStrFile = Dir(Range(\"AddressChangeFolderPath\").Value)\nDim Names() As String\nDim StrName\nDo While Len(StrFile) &gt; 0\n    CheckVal = InStr(1, StrFile, \"Address Change Circulation -\", vbTextCompare) + _\n        InStr(1, StrFile, \"Address Change Circulation from \", vbTextCompare)\n    If CheckVal &lt;&gt; 1 Then   'if the email does not fit the standard, just place it in the cell and\n                            'move on to the next entry\n        Selection.Value = StrFile\n        Selection.Interior.Color = RGB(255, 255, 0) 'highlight the cell\n        Selection.Offset(1, 0).Select\n    Else\n        StrName = Right(StrFile, Len(StrFile) - 29) 'trim to the correct size - probably not the\n                                                    'best way to do this but it works\n        If Left(StrName, 4) = \"from\" Then\n            StrName = Right(StrName, Len(StrName) - 5)\n        ElseIf Left(StrName, 2) = \"om\" Then\n StrName = Right(StrName, Len(StrName) - 3)\n        End If\n        StrName = Left(StrName, Len(StrName) - 4)\n        Changes = Split(StrName, \" and \")\n        For Each Change In Changes\n            Names = Split(Change, \" to \")\n\n            If Len(Names(0)) &lt; 5 Then\n                Selection.Value = Names(0) &amp; Right(Names(1), Len(Names(1)) - Len(Names(0)))\n            Else\n                Selection.Value = Names(0)\n            End If\n            If UBound(Names) &gt;= 1 Then 'this is a zero indexed array, checking greater than or\n                                       'equal to 1 will check if there are two or more entries\n                Selection.Offset(0, 1).Value = Names(1) ' in the event that there is no \" to \" in\n                                                'the file name and it hasn't been handeled already\n            End If\n            Selection.Offset(1, 0).Select 'select the next cell to accept the next entry\n        Next\n    End If\n\nloop\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "subquery", "odbc"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 4, "creation_date": 1525268442, "post_id": 50136014, "comment_id": 87290208, "body": "Nobody is ever an accountant at heart, only by persuasion."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1525268477, "post_id": 50136014, "comment_id": 87290247, "body": "More constructively, why can&#39;t you use a pivottable?"}, {"owner": {"reputation": 4517, "user_id": 1970497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OzVV8.jpg?s=128&g=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/1970497/shawn"}, "edited": false, "score": 0, "creation_date": 1525268691, "post_id": 50136014, "comment_id": 87290408, "body": "Do you have an example of what your source data looks like and what your expected return value looks like?"}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1525268788, "post_id": 50136014, "comment_id": 87290476, "body": "In your WHERE clause you have <code>WHERE SLBGDTPF.BGPSDT=&#39;20180420&#39;</code> which should give you the transactions for only April 20. If you want an entire week you will need to do something like <code>WHERE SLBGDTPF.BGPSDT&gt;=&#39;20180420&#39; AND  SLBGDTPF.BGPSDT&lt;&#39;20180428&#39;</code> if I am understanding correctly. You may want to use a field on the Excel sheet for this input (that&#39;s a bit more code though but it will save you from modifying the query every time)."}, {"owner": {"reputation": 23, "user_id": 9730496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c835acba422b39ffa69cce3405759374?s=128&d=identicon&r=PG&f=1", "display_name": "TouringCanary", "link": "https://stackoverflow.com/users/9730496/touringcanary"}, "edited": false, "score": 0, "creation_date": 1525268974, "post_id": 50136014, "comment_id": 87290616, "body": "Ha! The table I&#39;m querying has around 14 million records so squeezing it into a pivot table isn&#39;t an option. I&#39;m expecting there to be around 1,000 jobs with around 4 transactions each job to be returned in total"}, {"owner": {"reputation": 23, "user_id": 9730496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c835acba422b39ffa69cce3405759374?s=128&d=identicon&r=PG&f=1", "display_name": "TouringCanary", "link": "https://stackoverflow.com/users/9730496/touringcanary"}, "edited": false, "score": 0, "creation_date": 1525269086, "post_id": 50136014, "comment_id": 87290698, "body": "Jacob H, confusingly, that date field will only ever have a Friday date hence no need to give it a range"}, {"owner": {"reputation": 23, "user_id": 9730496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c835acba422b39ffa69cce3405759374?s=128&d=identicon&r=PG&f=1", "display_name": "TouringCanary", "link": "https://stackoverflow.com/users/9730496/touringcanary"}, "edited": false, "score": 0, "creation_date": 1525269595, "post_id": 50136014, "comment_id": 87291101, "body": "A quick example of what the output might look like (obviously for many more records (and fields):  ORDNO\tBGDSVL\tBGCD\tADBBG\tBGPSDT 30203743\t60\t10\t3498321\t20180420 30203743\t12.5\t10\t2374720\t20180420 30203743\t12.5\t10\t2374725\t20180406 30203743\t374.4\t10\t2491687\t20180406 30203743\t72\t10\t2313994\t20180126 30221220\t48\t10\t3401111\t20180420 30221220\t40\t10\t2424871\t20180202 30221220\t40\t10\t3401527\t20180202 30221220\t120\t10\t2313994\t20180202 30221220\t80\t10\t3401111\t20171208"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1525271556, "post_id": 50136014, "comment_id": 87292609, "body": "There is no need for this line: <code>&amp; Chr(13) &amp; &quot;&quot; &amp; Chr(10) &amp; _</code>. On the line above and/or below simply include an extra space within the quoted string as a delimiter before <code>FROM</code>, <code>WHERE</code>, and <code>GROUP BY</code>."}, {"owner": {"reputation": 4517, "user_id": 1970497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OzVV8.jpg?s=128&g=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/1970497/shawn"}, "edited": false, "score": 0, "creation_date": 1525275929, "post_id": 50136014, "comment_id": 87295488, "body": "@TouringCanary Can you add that sample output into the question so it can be formatted?"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 9723901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33df4591b2be05bb1fd2e54dcc2a1a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Peters", "link": "https://stackoverflow.com/users/9723901/ian-peters"}, "is_accepted": true, "score": 2, "last_activity_date": 1525271070, "last_edit_date": 1525271070, "creation_date": 1525270741, "answer_id": 50136922, "question_id": 50136014, "link": "https://stackoverflow.com/questions/50136014/sql-noob-nested-subqueires/50136922#50136922", "title": "SQL NOOB - nested/subqueires", "body": "<p>This can be achieved a few ways, but presuming the database can handle subqueries, I would try a WHERE IN term.  I've also made some other cursory edits for clarity.  The ultimate GROUP BY term is redundant in the subquery as there is only a single subquery SELECT field and no aggregation going on.</p>\n\n<pre><code>With Sheet1.QueryTables.Add(Connection:=Array(Array( _\n        \"ODBC;DRIVER={iSeries Access ODBC Driver};SYSTEM=JADE;DBQ=QGPL LIVDTALIB;DFTPKGLIB=QGPL;LANGUAGEID=ENU;PKG=QGPL/DEFAULT(IBM),2,0,1,0,\"), _\n        Array(\"512;QRYSTGLMT=-1;\")), Destination:=Sheet1.Range(\"A1\"))\n        .CommandText = Array( _\n        \"SELECT SLBGDTPF.BGMCU, SLBGDTPF.BGDSDT, SLBGDTPF.ORTYPE, SLBGDTPF.ORDNO, SLBGDTPF.BGDSVL, SLBGDTPF.BGCD, SLBGDTPF.ADBBG, SLBGDTPF.BGRMK\" &amp; vbCrLf &amp; _\n        \"FROM RCHASE5C.LIVDTALIB.SLBGDTPF SLBGDTPF\" &amp; vbCrLf &amp; _\n        \"WHERE SLBGDTPF.ORDNO IN (\" &amp; vbCrLf &amp; _\n            \"SELECT SLBGDTPF.ORDNO\" &amp; vbCrLf &amp; _\n            \"FROM RCHASE5C.LIVDTALIB.SLBGDTPF SLBGDTPF\" &amp; vbCrLf &amp; _\n            \"WHERE SLBGDTPF.BGPSDT='20180420')\")\n    .Name = \"TEST Query\"\n    .FieldNames = True\n    .RefreshStyle = xlOverwriteCells\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "is_accepted": false, "score": 0, "last_activity_date": 1525273097, "creation_date": 1525273097, "answer_id": 50137695, "question_id": 50136014, "link": "https://stackoverflow.com/questions/50136014/sql-noob-nested-subqueires/50137695#50137695", "title": "SQL NOOB - nested/subqueires", "body": "<p>As @IanPeters already mentioned, there are a few ways to handle this in SQL. I would like to add two versions that use a join instead of one of the WHERE clauses. \nYou might want to test  which version performs best on your database. This will depend on the index structure on the database and on how well the query optimizer handles the query.</p>\n\n<p>Subquery in join:</p>\n\n<pre><code>With Sheet1.QueryTables.Add(Connection:=Array(Array( _\n        \"ODBC;DRIVER={iSeries Access ODBC Driver};SYSTEM=JADE;DBQ=QGPL LIVDTALIB;DFTPKGLIB=QGPL;LANGUAGEID=ENU;PKG=QGPL/DEFAULT(IBM),2,0,1,0,\"), _\n        Array(\"512;QRYSTGLMT=-1;\")), Destination:=Sheet1.Range(\"A1\"))\n    .CommandText = Array( _\n        \"SELECT SLBGDTPF.BGMCU, SLBGDTPF.BGDSDT, SLBGDTPF.ORTYPE, SLBGDTPF.ORDNO, SLBGDTPF.BGDSVL, SLBGDTPF.BGCD, SLBGDTPF.ADBBG, SLBGDTPF.BGRMK\" &amp; vbCrLf &amp; _\n        \"FROM RCHASE5C.LIVDTALIB.SLBGDTPF SLBGDTPF\" &amp; vbCrLf &amp; _\n            \"INNER JOIN\" &amp; vbCrLf &amp; _   \n                \"(SELECT S.ORDNO\" &amp; vbCrLf &amp; _\n                \"FROM RCHASE5C.LIVDTALIB.SLBGDTPF S\" &amp; vbCrLf &amp; _\n                \"WHERE WeekOrders.BGPSDT='20180420') WeekOrders\" &amp; vbCrLf &amp; _\n            \"ON SLBGDTPF.ORDNO = WeekOrders.ORDNO\") \n    .Name = \"TEST Query\"\n    .FieldNames = True\n    .RefreshStyle = xlOverwriteCells\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>Condition outside of join:</p>\n\n<pre><code>With Sheet1.QueryTables.Add(Connection:=Array(Array( _\n        \"ODBC;DRIVER={iSeries Access ODBC Driver};SYSTEM=JADE;DBQ=QGPL LIVDTALIB;DFTPKGLIB=QGPL;LANGUAGEID=ENU;PKG=QGPL/DEFAULT(IBM),2,0,1,0,\"), _\n        Array(\"512;QRYSTGLMT=-1;\")), Destination:=Sheet1.Range(\"A1\"))\n    .CommandText = Array( _\n        \"SELECT SLBGDTPF.BGMCU, SLBGDTPF.BGDSDT, SLBGDTPF.ORTYPE, SLBGDTPF.ORDNO, SLBGDTPF.BGDSVL, SLBGDTPF.BGCD, SLBGDTPF.ADBBG, SLBGDTPF.BGRMK\" &amp; vbCrLf &amp; _\n        \"FROM RCHASE5C.LIVDTALIB.SLBGDTPF SLBGDTPF\" &amp; vbCrLf &amp; _\n            \"INNER JOIN RCHASE5C.LIVDTALIB.SLBGDTPF WeekOrders\" &amp; vbCrLf &amp; _\n                \"ON SLBGDTPF.ORDNO = WeekOrders.ORDNO\" &amp; vbCrLf &amp; _\n        \"WHERE WeekOrders.BGPSDT='20180420'\") \n    .Name = \"TEST Query\"\n    .FieldNames = True\n    .RefreshStyle = xlOverwriteCells\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9730496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c835acba422b39ffa69cce3405759374?s=128&d=identicon&r=PG&f=1", "display_name": "TouringCanary", "link": "https://stackoverflow.com/users/9730496/touringcanary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 50136922, "answer_count": 2, "score": 2, "last_activity_date": 1525273097, "creation_date": 1525268189, "question_id": 50136014, "link": "https://stackoverflow.com/questions/50136014/sql-noob-nested-subqueires", "title": "SQL NOOB - nested/subqueires", "body": "<p>I will begin by clearly stating that I am not a programmer, I am an accountant at heart!</p>\n\n<p>I have a need to return into excel all transactions relating to jobs that have had transactions in a given week (i.e. so that I can see an in week amount and total to date amount).</p>\n\n<p>I'm reasonably proficient with VBA in excel (as accountants go anyway!) but I have always just copied and bodged the same old SQL statement. Essentially, what I think I need to do is a sub query in place of the order number of the WHERE statement in the following:</p>\n\n<pre><code>    With Sheet1.QueryTables.Add(Connection:=Array(Array( _\n            \"ODBC;DRIVER={iSeries Access ODBC Driver};SYSTEM=JADE;DBQ=QGPL LIVDTALIB;DFTPKGLIB=QGPL;LANGUAGEID=ENU;PKG=QGPL/DEFAULT(IBM),2,0,1,0,\"), _\n            Array(\"512;QRYSTGLMT=-1;\")), Destination:=Sheet1.Range(\"A1\"))\n            .CommandText = Array( _\n            \"SELECT SLBGDTPF.BGMCU, SLBGDTPF.BGDSDT, SLBGDTPF.ORTYPE, SLBGDTPF.ORDNO, SLBGDTPF.BGDSVL, SLBGDTPF.BGCD, \", _\n            \"SLBGDTPF.ADBBG, SLBGDTPF.BGRMK\" _\n            &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"FROM RCHASE5C.LIVDTALIB.SLBGDTPF SLBGDTPF\" _\n            &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"WHERE (SLBGDTPF.ORDNO='30214884')\")\n        .Name = \"TEST Query\"\n        .FieldNames = True\n        .RefreshStyle = xlOverwriteCells\n        .Refresh BackgroundQuery:=False\n    End With\n</code></pre>\n\n<p>As a standalone query, what the sub-query element looks like is as follows:</p>\n\n<pre><code>    With Sheet2.QueryTables.Add(Connection:=Array(Array( _\n            \"ODBC;DRIVER={iSeries Access ODBC Driver};SYSTEM=JADE;DBQ=QGPL LIVDTALIB;DFTPKGLIB=QGPL;LANGUAGEID=ENU;PKG=QGPL/DEFAULT(IBM),2,0,1,0,\"), _\n            Array(\"512;QRYSTGLMT=-1;\")), Destination:=Sheet2.Range(\"A1\"))\n            .CommandText = Array( _\n            \"SELECT SLBGDTPF.ORDNO\" _\n            &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"FROM RCHASE5C.LIVDTALIB.SLBGDTPF SLBGDTPF\" _\n            &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"WHERE SLBGDTPF.BGPSDT='20180420'\" _\n            &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"GROUP BY SLBGDTPF.ORDNO\")\n        .Name = \"TEST Query\"\n        .FieldNames = True\n        .RefreshStyle = xlOverwriteCells\n        .Refresh BackgroundQuery:=False\n    End With\n</code></pre>\n\n<p>I'm open to all suggestions, including alternate approaches (I did try using IN and referencing a range in a sheet but I need to pass up to 1,000 different job numbers)</p>\n\n<p>Just as an FYI, this is a template that will be sent out to people within the business to update themselves hence the need to build the connection, rather than just have them refresh an existing query(s) within the workbook.</p>\n\n<p>All the best,</p>\n\n<p>Joe</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1525268564, "post_id": 50135893, "comment_id": 87290322, "body": "<i>&quot;not working&quot;</i> is the worst error description you can use. Please instead always <b>describe</b> what happens: Eg. do you get any error messages if so which and what line? What do you expect your code should do and what does it do instead?"}, {"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "edited": false, "score": 0, "creation_date": 1525268668, "post_id": 50135893, "comment_id": 87290390, "body": "Google basic syntax documentation before posting here... <a href=\"https://www.techonthenet.com/excel/formulas/case.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/case.php</a>"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1525273127, "post_id": 50136209, "comment_id": 87293714, "body": "Thanks Scott I will have a look at this and feedback."}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1526918257, "post_id": 50136209, "comment_id": 87918090, "body": "Hi Scott,  I tried you correction, but something else must be awry as I cannot get the two pieces of code to work.  The second section is fine, and in the end I changed my spreadsheet to remove the need for the first bit of code.  Thanks anyway."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1525268747, "creation_date": 1525268747, "answer_id": 50136209, "question_id": 50135893, "link": "https://stackoverflow.com/questions/50135893/code-for-two-worksheet-change-events-which-i-have-combined-not-working/50136209#50136209", "title": "Code for two worksheet change events which I have combined not working", "body": "<pre><code>Case IsNot = Empty\n</code></pre>\n\n<p>is not valid syntax.</p>\n\n<p>Change to </p>\n\n<pre><code>Case Is &lt;&gt; \"\"\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525268747, "creation_date": 1525267768, "question_id": 50135893, "link": "https://stackoverflow.com/questions/50135893/code-for-two-worksheet-change-events-which-i-have-combined-not-working", "title": "Code for two worksheet change events which I have combined not working", "body": "<p>Having looked for an answer to my question, I am at a loss and need some help.  I have two different worksheet change events in the same worksheet which will be triggered by two entirely separate cell's changing condition (one is empty to not empty to trigger an Unlock range event, and the second is a change in value which will trigger a series of hide cell events based on the value it has changed to.  (the second works perfectly on its own, but the first doesn't.) I have obviously missed something or my code is mince, and I need help</p>\n\n<p>here is my code</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address(False, False) = \"D5\" Then\nSelect Case Target.Value\n    Case Is = \"\": Range(\"A6:D115\").Locked = True\n    Case IsNot = Empty: Range(\"C6:D6,A16:D16,C19:D22,D25:D25,D41:D57,B58:D58,C63:D63,C65:D73,C75:D78,C80:D84,D88:D88,A93:D98,D101:D103,B113:B114,D113:D113\").Locked = False\nEnd Select\nEnd If\n\nIf Target.Address(False, False) = \"D25\" Then\nSelect Case Target.Value\n    Case \"Select as appropriate\": Range(\"40:85\").EntireRow.Hidden = False\n    Case \"USA - Breen Road\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"45:45,47:47,53:57,77:78\").EntireRow.Hidden = True\n    Case \"USA - Conroe\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"40:52,77:78,80:80,85:85\").EntireRow.Hidden = True\n    Case \"USA - Lafayette\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"43:43,45:47,49:49,53:57,61:83\").EntireRow.Hidden = True\n    Case \"Europe - Aberdeen\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"40:49,53:57,77:78,80:80\").EntireRow.Hidden = True\n    Case \"Europe - Gateshead\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"53:57\").EntireRow.Hidden = True\n    Case \"Middle East - Dubai\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"43:43,46:47,50:57\").EntireRow.Hidden = True\n    Case \"Middle East - Saudi Arabia\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"43:43,45:47,50:53\").EntireRow.Hidden = True\n    Case \"Middle East - All\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"43:43,46:47,50:57\").EntireRow.Hidden = True\n    Case \"Far East - Singapore - Loyang\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"41:41,44:57,77:78,80:80\").EntireRow.Hidden = True\n    Case \"Far East - Singapore - Tuas\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"40:49,53:57,77:78,80:82\").EntireRow.Hidden = True\n    Case \"Far East - Singapore - All\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"41:41,44:49,53:57,77:78,80:80\").EntireRow.Hidden = True\n    Case \"Far East - Perth - Australia\": Range(\"40:85\").EntireRow.Hidden = False\n         Range(\"41:57,63:63,67:67,72:72,74:83\").EntireRow.Hidden = True\nEnd Select\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I have the cells all set to locked and the sheet protected - to prevent cells I don't want to have data in them, being fiddled with.</p>\n\n<p>Any help will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9697384, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "InfinityCubeInteractive", "link": "https://stackoverflow.com/users/9697384/infinitycubeinteractive"}, "edited": false, "score": 0, "creation_date": 1525327826, "post_id": 50135994, "comment_id": 87314203, "body": "Thanks for your answer Sandeep! :) is there mayby another way to do that? I think my it department don&#39;t that exe file in our intranet :("}, {"owner": {"reputation": 328, "user_id": 9591612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNYpQ.jpg?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/9591612/sandeep"}, "reply_to_user": {"reputation": 7, "user_id": 9697384, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "InfinityCubeInteractive", "link": "https://stackoverflow.com/users/9697384/infinitycubeinteractive"}, "edited": false, "score": 0, "creation_date": 1525330892, "post_id": 50135994, "comment_id": 87315568, "body": "This is free software and do not need any licence. However, if you have programming experience, it would take about 10~20 lines of code to do that. Even you can find code sample online."}], "tags": [], "owner": {"reputation": 328, "user_id": 9591612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNYpQ.jpg?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/9591612/sandeep"}, "is_accepted": true, "score": 0, "last_activity_date": 1525268139, "creation_date": 1525268139, "answer_id": 50135994, "question_id": 50135859, "link": "https://stackoverflow.com/questions/50135859/3rd-party-program-focus/50135994#50135994", "title": "3rd party Program focus", "body": "<p><a href=\"http://www.nirsoft.net/utils/nircmd.html\" rel=\"nofollow noreferrer\">NirCmd</a> from NirSoft is what you need. </p>\n"}], "owner": {"reputation": 7, "user_id": 9697384, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "InfinityCubeInteractive", "link": "https://stackoverflow.com/users/9697384/infinitycubeinteractive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 50135994, "answer_count": 1, "score": 0, "last_activity_date": 1525268139, "creation_date": 1525267685, "question_id": 50135859, "link": "https://stackoverflow.com/questions/50135859/3rd-party-program-focus", "title": "3rd party Program focus", "body": "<p>thanks for your amazing support!</p>\n\n<p>Now i have again a question. To get access to some raw datas (i'm working in a call center) we using a website to get an CSV/xls file from our SQL Database (the IT Department doesnt allow me to get direct access to the SQL database).</p>\n\n<p>For an automatic update of my sheet i use an shell command to trigger chrome with the right parameters in the link (chrome starts the download).</p>\n\n<p>Everything works fine but, when i trigger Chrome per shell, i have to minimize chrome again (otherwise you can't see the Excel screen). So i can't find an command to minimize external windows so i'm using shell to minimize all, after that i maximize excel again, works great, but after excel has done the updates, it should activate \"VLC Media Player\", i tried to use <code>AppActivate</code> for that, but its just blikink orange in the taskbar and dont get focus.</p>\n\n<p>Can you help me?</p>\n\n<p>I can share you the code but it's really just the <code>AppActivate()</code> line that interest you :)</p>\n\n<p>Thanks again!\nBr\nOlvier</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1525266901, "post_id": 50135493, "comment_id": 87289082, "body": "In VBA: <code>Range(&quot;Apple&quot;).Offset(,1).value = 2</code>"}, {"owner": {"reputation": 411, "user_id": 4200051, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d138f4fb8ab7a9fb355c0fae4cf076d7?s=128&d=identicon&r=PG&f=1", "display_name": "&#220;bel Yildmar", "link": "https://stackoverflow.com/users/4200051/%c3%9cbel-yildmar"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1525267652, "post_id": 50135493, "comment_id": 87289615, "body": "Almost good, thanks! This code creates an extra column."}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1525268238, "post_id": 50135493, "comment_id": 87290045, "body": "Is the range &quot;Apple&quot; a complete row, or just the cell that has that name?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1525269256, "post_id": 50135493, "comment_id": 87290835, "body": "So it sounds like your &quot;Apple&quot; named range isn&#39;t just the cell with the value &quot;Apple&quot; but the entire row on the table. @trincot&#39;s first solution should work then."}], "answers": [{"comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1525503377, "post_id": 50136139, "comment_id": 87389990, "body": "Could the downvoter please explain what the issue is with this answer?"}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": -1, "last_activity_date": 1525268549, "creation_date": 1525268549, "answer_id": 50136139, "question_id": 50135493, "link": "https://stackoverflow.com/questions/50135493/how-to-change-the-n-th-value-of-a-named-range-in-excel-vba/50136139#50136139", "title": "How to change the n-th value of a named range in Excel VBA?", "body": "<p>Assuming that the range includes the cells to the right of the main cell, you can do:</p>\n\n<pre><code>Range(\"Apple\")(2) = 123\n</code></pre>\n\n<p><code>(1)</code> would reference the cell with \"Apple\", so you need to start with <code>(2)</code>. This notation is short for:</p>\n\n<pre><code>Range(\"Apple\").Cells(2) = 123\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 4200051, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d138f4fb8ab7a9fb355c0fae4cf076d7?s=128&d=identicon&r=PG&f=1", "display_name": "&#220;bel Yildmar", "link": "https://stackoverflow.com/users/4200051/%c3%9cbel-yildmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525502129, "creation_date": 1525266617, "last_edit_date": 1531161705, "question_id": 50135493, "link": "https://stackoverflow.com/questions/50135493/how-to-change-the-n-th-value-of-a-named-range-in-excel-vba", "title": "How to change the n-th value of a named range in Excel VBA?", "body": "<p>Here's a table about fruits:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9yCna.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9yCna.png\" alt=\"enter image description here\"></a></p>\n\n<p>These fruits are the names of named ranges in Column A, too. For example, if I type the following:</p>\n\n<pre><code>=INDEX(apple, 1, 1)\n</code></pre>\n\n<p>then the result is 1.</p>\n\n<p>My question is: How can I change the n-th value of a named range in Excel VBA? I'd like to add a new value to the first element of named range 'apple', like:</p>\n\n<pre><code>Range(\"apple\",1,1).Value = 2\n</code></pre>\n\n<p>How can I do that? Thank you in advance.</p>\n"}, {"tags": ["excel", "vba", "diacritics", "ignore"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1525264888, "post_id": 50134815, "comment_id": 87287750, "body": "Does the worksheet <code>CodeName</code> property exhibit the same discrepancies with accents/diacritics? NB, your assertion that <code>Sheets(2)</code> selects the <i>third</i> sheet in 2016 is not correct. Sheets are still indexed as a 1-based Collection."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1525265007, "post_id": 50134815, "comment_id": 87287834, "body": "I can&#39;t reproduce the issue, using <b>&#214;sszesz&#225;mol&#225;s</b> (copied and pasted directly from your post). It does not convert when opening in Excel 2016; it keeps the same content. I did nothing to support other languages - my tests were done on a standard O365 installation in English (US) Windows. Also, your assertion that tab indexing changed is incorrect; sheets are still numbered starting at 1, just as they were in prior versions of Excel."}, {"owner": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525265522, "post_id": 50134815, "comment_id": 87288165, "body": "Well that is strange.. I can&#39;t refer to any other people&#39;s experience but mine. I don&#39;t know what am I doing wrong.. I open an excel made in Office 2013 with Office 2016 and it renames the freaking worksheets with removing some specific diactretical marks (like &#214; to O)..  And I think I&#39;ve miswritten that Sheet(2) would select the 3rd worksheet. It selects the 1st worksheet in version 2016 while in version 2013 it selects the 2nd..."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1525265698, "post_id": 50134815, "comment_id": 87288269, "body": "Interesting that it appears that only the &quot;&#214;&quot; seems to have been changed, at least based on your post. Are you certain that it isn&#39;t a font size vs tab height display issue in 2016 that&#39;s just cutting the diacritic off the top, but that it&#39;s actually there?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1525265741, "post_id": 50134815, "comment_id": 87288305, "body": "Do you have code that actually generates an Index Out of Range error? Or are you just guessing that there will be an error?"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1525265993, "post_id": 50134815, "comment_id": 87288476, "body": "Wouldn&#39;t it be more likely that a different locale was used for the Office installation by mistake?"}, {"owner": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525266206, "post_id": 50134815, "comment_id": 87288619, "body": "&#214;, \u0150, &#220;, \u0170 &lt;-- these are the characters that are touched. No, I&#39;ve written the names in cells and it seems that these letters were converted to non diacritic letters."}, {"owner": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525266359, "post_id": 50134815, "comment_id": 87288714, "body": "There is not any error, Sheet(1).Activate activates the 2nd worksheet, like the indexing offset would be set to &quot;0&quot;. So the Sheet(0).Activate activates the 1st worksheet.. I&#39;ve only seen something like this in SQL database or something before.."}], "answers": [{"comments": [{"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "edited": false, "score": 1, "creation_date": 1525265724, "post_id": 50135179, "comment_id": 87288287, "body": "To be clear: It is NOT Sheets(&quot;ThisIsMyVBANameForThisWorksheet&quot;).Activate. That won&#39;t work."}, {"owner": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525265841, "post_id": 50135179, "comment_id": 87288372, "body": "Then the other ones who refers to this specific excel workbook will get an error that VBA couldn&#39;t find the actual worksheet. It&#39;s a big company, I couldn&#39;t do it."}, {"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "reply_to_user": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525266011, "post_id": 50135179, "comment_id": 87288486, "body": "Oh. Then just use Sheet1.Activate, Sheet2.Activate. (Or whatever your language of Office is and whatever you want to do with the sheet.)  Problem with that is that if there are multiple languages of Office, there  will be different names, because the default names are localised."}, {"owner": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525266178, "post_id": 50135179, "comment_id": 87288599, "body": "I&#39;ve already told why indexing like that wouldn&#39;t work... somehow in my case Sheets(1).Select wants to select the 2nd sheet...."}, {"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "reply_to_user": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525266386, "post_id": 50135179, "comment_id": 87288728, "body": "Laczko, Of course I am EXACTLY giving you the opportunity NOT to use that indexing. I can read. ;) Please do read better. I updated the answer as well. There is NO indexing, but the use of DIRECT names.."}, {"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "reply_to_user": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525266473, "post_id": 50135179, "comment_id": 87288785, "body": "The names happen to have a number in them, but that is something COMPLETELY different than indexing."}, {"owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "reply_to_user": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525266756, "post_id": 50135179, "comment_id": 87288998, "body": "Glad it did! Of course, my solution will &#39;Sheet1&#39; and &#39;Sheet2&#39; only work in specific cases where the sheets you want to reference always have been the first and second sheet. If you have three sheets, and remove the second one, in VBA, you will have Sheet1 and Sheet3, equivalent to Worksheets(1) and Worksheets(2). So  Worksheets(2).Name would give &quot;Sheet3. &quot;Ah. Logic. ;) If you are aware of that and it is no problem, you&#39;re good to go."}, {"owner": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "edited": false, "score": 0, "creation_date": 1525266882, "post_id": 50135179, "comment_id": 87289070, "body": "I&#39;ll consider this while working at my projects, Thank you again! Have a nice day!"}], "tags": [], "owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "is_accepted": true, "score": 0, "last_activity_date": 1525266280, "last_edit_date": 1525266280, "creation_date": 1525265668, "answer_id": 50135179, "question_id": 50134815, "link": "https://stackoverflow.com/questions/50134815/is-there-any-possible-way-to-ignore-accents-in-a-worksheets-name-when-youre-tr/50135179#50135179", "title": "Is there any possible way to ignore accents in a worksheet&#39;s name when you&#39;re trying to index/select a worksheet in Excel VBA?", "body": "<p>Go to VBA, and rename the VBA name of the worksheet in the there, and use that name.</p>\n\n<p>So go to VBA,press Ctrl+R, locate the sheet, click once, press F4 if necessary to popup the properties, change the property Name (Not \"(Name)\" but \"Name\").</p>\n\n<p>From now on, you can use that name in your VBA-code to refer to that worksheet-object directly. So if the name you give is \"ThisIsMyVBANameForThisWorksheet\", you can code in VBA with</p>\n\n<pre><code>ThisIsMyVBANameForThisWorksheet.Activate\n</code></pre>\n\n<p>If this is no option, you can use the default VBA names for the sheets. In English office, these are Sheet1, Sheet2, etc. (If you use multiple languages of Office within your company, that is not an option either.)</p>\n\n<p>So </p>\n\n<pre><code>Sheet1.Activate\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 931, "user_id": 2321785, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a972030345263b787ef9154599f65d1?s=128&d=identicon&r=PG", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2321785/roemer"}, "is_accepted": false, "score": 0, "last_activity_date": 1525267779, "last_edit_date": 1525267779, "creation_date": 1525267266, "answer_id": 50135722, "question_id": 50134815, "link": "https://stackoverflow.com/questions/50134815/is-there-any-possible-way-to-ignore-accents-in-a-worksheets-name-when-youre-tr/50135722#50135722", "title": "Is there any possible way to ignore accents in a worksheet&#39;s name when you&#39;re trying to index/select a worksheet in Excel VBA?", "body": "<p>If above doesn't work/suffice I also have a bit more robust solution:</p>\n\n<pre><code>Function ReliableWorksheet(x) As Worksheet\n    Dim W As Worksheet\n    For Each W In ThisWorkbook.Worksheets\n        If W.Index = x Then Set ReliableWorksheet = W\n    Next\nEnd Function\n</code></pre>\n\n<p>And then use </p>\n\n<pre><code>ReliableWorksheet(1).Activate\n</code></pre>\n\n<p>This should work on all office versions, in all languages, but I cannot test it  other than O2013.</p>\n"}], "owner": {"reputation": 3, "user_id": 8915598, "user_type": "registered", "profile_image": "https://graph.facebook.com/1648183738554566/picture?type=large", "display_name": "Laczk&#243; M&#225;t&#233;", "link": "https://stackoverflow.com/users/8915598/laczk%c3%b3-m%c3%a1t%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 50135179, "answer_count": 2, "score": -1, "last_activity_date": 1525267779, "creation_date": 1525264561, "last_edit_date": 1525266403, "question_id": 50134815, "link": "https://stackoverflow.com/questions/50134815/is-there-any-possible-way-to-ignore-accents-in-a-worksheets-name-when-youre-tr", "title": "Is there any possible way to ignore accents in a worksheet&#39;s name when you&#39;re trying to index/select a worksheet in Excel VBA?", "body": "<p>The problem is that when I had MS Office 2013 I could use letters in Excel worksheets' names like \"\u00d3, \u0150, \u0170\" etc. but I had an OS and software update recently at my company (from Win7 to Win10, and from MS Office 2013 to 2016), and now some character with such diacritical marks has been replaced with letters without these marks like \"O, U\".</p>\n\n<p>For example I had a worksheet called: <strong>Sheet1 (\u00d6sszesz\u00e1mol\u00e1s)</strong> in MS Office 2013</p>\n\n<p>Now that worksheet is called: <strong>Sheet1 (Osszesz\u00e1mol\u00e1s)</strong> in MS Office 2016</p>\n\n<p>If I use the lastly mentioned worksheet name when I'm calling a worksheet then the ones who have MS Office 2013 won't be able to operate with the excel (VBA doesn't find the actual sheet). </p>\n\n<p>Indexing with worksheet numbers doesn't work (e.g <strong>Sheets(2).Select</strong>) because MS Office 2013 indexes differently than version 2016. <strong>Sheets(2).Select</strong> selects the 2nd worksheet in MSO 2013 but in 2016 it selects the 3rd one.. </p>\n\n<p>Am I able to make excel ignore the accents so <strong>Sheets(\"Osszeszamolas\")</strong> would be able to select  either <strong>Sheet1 (\u00d6sszesz\u00e1mol\u00e1s)</strong> and <strong>Sheet1 (Osszesz\u00e1mol\u00e1s)</strong> </p>\n\n<p>Note: I've tried to look for language options, but there ain't any options that could handle these specific accents..</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1525265083, "post_id": 50134669, "comment_id": 87287892, "body": "Maybe comment out the error line so you can find out where the error is.Maybe activate the ws right after <code>for each ws in sheets</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1525265123, "post_id": 50134669, "comment_id": 87287915, "body": "\u2460 Never use <code>On Error Resume Next</code> without proper error handling. Using this line as you did just hides error messages, but the errors still occur, you just cannot see them. Remove it completely or implement an error handling instead. Otherwise you cannot debug/fix your code at all. \u2461 <i>&quot;does not seem to work&quot;</i> is almost the worst error description you can use. Instead please always <i>describe</i> what happens. Otherwise that&#39;s a useless information. You wouln&#39;t post here if it would work, but we need to know what you expected and what happened instead, eg. what error messages and where."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "edited": false, "score": 0, "creation_date": 1525268485, "post_id": 50135527, "comment_id": 87290255, "body": "This works, but some of the pictures still break across pages when printed. Is there any way to &quot;force&quot; the pictures to print to one page?"}, {"owner": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "edited": false, "score": 0, "creation_date": 1525268503, "post_id": 50135527, "comment_id": 87290271, "body": "I tried this, but doesn&#39;t work:       For Each xWorksheet In ActiveWorkbook.Worksheets       xWorksheet.PageSetup.Orientation = xlLandscape       xWorksheet.Zoom = False       xWorksheet.PageSetup.PrintTitleRows = &quot;$A$1:$AZ$1&quot;       xWorksheet.PageSetup.FitToPagesWide = 1       xWorksheet.PageSetup.FitToPagesTall = 1       xWorksheet.PageSetup.FitToPagesTall = False"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "edited": false, "score": 0, "creation_date": 1525269060, "post_id": 50135527, "comment_id": 87290682, "body": "I don&#39;t think you can force them to be on a single page automatically. You will have to use some kind of logic to force them to stay away from the danger zone. Easiest way is to move it up (i.e decrease top value) if it is above a threshold value."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1525266708, "creation_date": 1525266708, "answer_id": 50135527, "question_id": 50134669, "link": "https://stackoverflow.com/questions/50134669/resize-all-pictures-in-workbook-to-a-fixed-height-in-excel-vba/50135527#50135527", "title": "Resize all pictures in Workbook to a fixed height in Excel VBA", "body": "<p>Remove the <code>ShapeRange</code>from</p>\n\n<pre><code>pict.LockAspectRatio = msoTrue\npict.Height = 250\n</code></pre>\n\n<p>I'm not sure how that works with grouped objects, but at least you get something.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "edited": false, "score": 0, "creation_date": 1525270282, "post_id": 50136657, "comment_id": 87291632, "body": "I get an &quot;out of range&quot; error on this line:                     Set rngT = Ws.HPageBreaks(n).Location"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "edited": false, "score": 0, "creation_date": 1525270379, "post_id": 50136657, "comment_id": 87291708, "body": "If you have a lot of pictures, increase the range further.  TO  range(&quot;a20000&quot;)"}, {"owner": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "edited": false, "score": 0, "creation_date": 1525279504, "post_id": 50136657, "comment_id": 87297621, "body": "I changed it to &quot;a50000&quot; but same error happens. Any ideas?"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1525270027, "creation_date": 1525270027, "answer_id": 50136657, "question_id": 50134669, "link": "https://stackoverflow.com/questions/50134669/resize-all-pictures-in-workbook-to-a-fixed-height-in-excel-vba/50136657#50136657", "title": "Resize all pictures in Workbook to a fixed height in Excel VBA", "body": "<p>First, set the page view.</p>\n\n<pre><code>ActiveWindow.View = xlPageBreakPreview\n</code></pre>\n\n<p>Second, you need to have data in any cell to do page breaks.</p>\n\n<pre><code>.Range(\"a10000\") = \"d\"\n</code></pre>\n\n<p>Then place the picture in the page break cell.</p>\n\n<pre><code>Sub test()\n'Resize all the pictures to fit the page while maintaining aspect ratio\nDim Ws As Worksheet\n\nActiveWindow.View = xlPageBreakPreview\nWith Application\n    .ScreenUpdating = False\n    Dim pict As Shape\n    Dim rngT As Range\n    'On Error Resume Next\n\n    For Each Ws In Worksheets\n        Ws.Range(\"a10000\") = \"d\"\n        n = 0\n        For Each pict In Ws.Shapes\n            If pict.Type = msoPicture Or pict.Type = msoGraphic Or pict.Type = msoIgxGraphic And pict.Width &gt; 1 And pict.Height &gt; 1 Then\n                Ws.Activate\n                pict.LockAspectRatio = msoTrue\n                If n = 0 Then\n                    Set rngT = Ws.Range(\"a1\")\n                Else\n                    Set rngT = Ws.HPageBreaks(n).Location\n                End If\n                With pict\n                    .Top = rngT.Top\n                    .Left = rngT.Left\n                    .Height = 250\n                End With\n                n = n + 1\n            End If\n        Next pict\n        Ws.Range(\"a10000\") = Empty\n    Next Ws\n\n    MsgBox n &amp; \" pictures were resized to fit the page successfully.\"\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 730, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1525270027, "creation_date": 1525264087, "last_edit_date": 1525265038, "question_id": 50134669, "link": "https://stackoverflow.com/questions/50134669/resize-all-pictures-in-workbook-to-a-fixed-height-in-excel-vba", "title": "Resize all pictures in Workbook to a fixed height in Excel VBA", "body": "<p>I am trying to resize all pictures in a workbook with hundreds of sheets (some that contain jpgs/pngs embedded or charts, some that do not). I want all charts and pictures to have the same width and NOT have a pagebreak in the middle of a figure, but not certain how to do this. Here is my code so far, which does not seem to work...</p>\n\n<pre><code>'Resize all the pictures to fit the page while maintaining aspect ratio\nWith Application\n    .ScreenUpdating = False\n    Dim pict As Shape\n\n    On Error Resume Next\n\n    For Each WS In Worksheets\n        For Each pict In WS.Shapes\n            If pict.Type = msoPicture Or pict.Type = msoGraphic Or pict.Type =     msoIgxGraphic And pict.Width &gt; 1 And pict.Height &gt; 1 Then\n                WS.Activate\n                pict.ShapeRange.LockAspectRatio = msoTrue\n                pict.ShapeRange.Height = 250\n\n                n = n + 1\n            End If\n        Next pict\n    Next WS\n\n    MsgBox n &amp; \" pictures were resized to fit the page successfully.\"\n    .ScreenUpdating = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525264791, "post_id": 50134563, "comment_id": 87287671, "body": "Ahhh This is perfect @Vityata :) Thank you!! I made a small change in your code to accommodate the task.. Instead of &quot;making&quot; the cell in wks3 the same, I did this: myCell.Copy                          wks3.Cells(Rows.Count, 1).End(xlUp).Offset(1, 1).PasteSpecial xlPasteValues ---- This works great, but, could you assist with if I wanted it in column C instead of column A?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525265243, "post_id": 50134563, "comment_id": 87287998, "body": "Nevermind I was being simple. Thank you for your help :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525268604, "post_id": 50134563, "comment_id": 87290351, "body": "I just did a check and I see that its actually not finding differences in the sheets.. Please have a look at the updated code I am using above.."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525269015, "post_id": 50134563, "comment_id": 87290646, "body": "@EitelDagnin - in the code above, if you write <code>Debug.Print myCell</code> instead of <code>myCell.Copy</code> would it print the different values? From there, just give it a small try, it is fun to display these in worksheet 3."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525269381, "post_id": 50134563, "comment_id": 87290929, "body": "@EitelDagnin - where are you looking for the printed values?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525269566, "post_id": 50134563, "comment_id": 87291068, "body": "I don&#39;t actually know where to look.. i have never needed to use this function before.."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1525269841, "post_id": 50134563, "comment_id": 87291291, "body": "@EitelDagnin - <a href=\"https://stackoverflow.com/questions/2916287/where-does-vba-debug-print-log-to\" title=\"where does vba debug print log to\">stackoverflow.com/questions/2916287/&hellip;</a> And change <code>Set firstRange = wks1.Range(&quot;A:A&quot;)</code> to <code>Set firstRange = wks1.usedrange.columns(1).Cells</code>, to save about 1 million checks. Just make sure that you have some values on <code>column A</code> before, otherwise it will take the first column of the first range."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1526374396, "post_id": 50134563, "comment_id": 87707785, "body": "how would I change the range of myCell to copy column A and Column B to the new sheet?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1526384955, "post_id": 50134563, "comment_id": 87714580, "body": "@EitelDagnin - it is probably a good idea to ask this one as a separate question, I am quite sure you would be given some great ideas! :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1525264467, "last_edit_date": 1525264467, "creation_date": 1525263710, "answer_id": 50134563, "question_id": 50134391, "link": "https://stackoverflow.com/questions/50134391/vba-compare-column-on-previous-report-with-new-report-to-find-new-entries/50134563#50134563", "title": "VBA - Compare Column on Previous Report With New Report to Find New Entries", "body": "<p>Let's assume that you have 3 worksheets:</p>\n\n<ul>\n<li><code>worksheet1</code> - to compare with <code>worksheet2</code></li>\n<li><code>worksheet2</code> - to compare with <code>worksheet1</code></li>\n<li><code>worksheet3</code> - to write the values, which are different in <code>worksheet1</code></li>\n</ul>\n\n<p>Then some simple code as this one works quite ok:</p>\n\n<pre><code>Public Sub FindDifferences()\n\n    Dim firstRange As Range\n    Dim secondRange As Range\n\n    Dim wks1 As Worksheet: Set wks1 = Worksheets(1)\n    Dim wks2 As Worksheet: Set wks2 = Worksheets(2)\n    Dim wks3 As Worksheet: Set wks3 = Worksheets(3)\n\n    Set firstRange = wks1.UsedRange\n    Set secondRange = wks2.UsedRange\n\n    Dim myCell  As Range\n\n    For Each myCell In firstRange\n        If myCell &lt;&gt; secondRange.Range(myCell.Address) Then\n            wks3.Range(myCell.Address) = myCell\n        End If\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p>What does it do?</p>\n\n<ul>\n<li>if loops through every cell of the <code>UsedRange</code> in <code>Worksheets(1)</code> and it compares it with the same cell in <code>Worksheets(2)</code>;</li>\n<li>if the comparison is different, then it writes the cell from <code>Worksheets(1)</code> in <code>Worksheets(3)</code>;</li>\n<li>you may consider coloring the cell in <code>Worksheets(1)</code>, if different as well;</li>\n</ul>\n\n<hr>\n\n<p>If your columns are on different places, thus you would like to compare column <code>B</code> with column <code>D</code>, then a bit crunching of the ranges is needed:</p>\n\n<pre><code>Set firstRange = wks1.UsedRange.Columns(2).Cells\nSet secondRange = wks1.UsedRange.Columns(4).Cells\n\nFor Each myCell In firstRange\n    If myCell.Value2 &lt;&gt; secondRange.Cells(myCell.Row, secondRange.Column).Value2 Then\n        wks3.Range(myCell.Address) = myCell.Value2\n    End If\nNext myCell\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 50134563, "answer_count": 1, "score": 1, "last_activity_date": 1525268685, "creation_date": 1525263147, "last_edit_date": 1525268685, "question_id": 50134391, "link": "https://stackoverflow.com/questions/50134391/vba-compare-column-on-previous-report-with-new-report-to-find-new-entries", "title": "VBA - Compare Column on Previous Report With New Report to Find New Entries", "body": "<p>I have 4 sheets in total that need to be used. </p>\n\n<ul>\n<li>ServerList1</li>\n<li>ServerList2</li>\n<li>MachineList1</li>\n<li>MachineList2</li>\n</ul>\n\n<p>The sheet names with a (1) next to them are the reports from last week and the sheet names with a (2) next to them are the reports from this week.</p>\n\n<p>In each sheet, there are multiple columns which I get rid of so that all that remains is the column with either the <strong>Server Name</strong> or the <strong>Machine Name</strong></p>\n\n<p>Essentially, I need to compare last weeks report with this weeks report and see what new servers have been added (if any) and what new machines have been added (if any).</p>\n\n<p>Conversely, I need to do the opposite, check what servers have been removed (if any) and what machines have been removed (if any).. </p>\n\n<p>With the below code, it should be simple to accomplish the second part simply by switching the worksheet names..</p>\n\n<p>I found the below code here: </p>\n\n<p><a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-vba-macros/145223-compare-2-columns-in-different-sheets-and-copy-entire-rows-into-new-sheets\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/help-forums/excel-vba-macros/145223-compare-2-columns-in-different-sheets-and-copy-entire-rows-into-new-sheets</a> </p>\n\n<p>This code does a comparison and copies the new appearances, but there's two issues I am currently experiencing:</p>\n\n<p>1) The code looks like it gets stuck in an infinite loop - I need to exit the code manually</p>\n\n<p>2) On the <strong>New Servers-Machines</strong> sheet, the results are pasted from row A2 instead of A1</p>\n\n<pre><code>Sub compareSheets()\n\n    ThisWorkbook.RefreshAll\n    Dim rng As Range, c As Range, cfind As Range\n\n    Dim ws1 As Worksheet\n\n    Set ws1 = Worksheets(\"New Servers-Machines\")\n\n    On Error Resume Next\n\n    With Worksheets(\"Last Week Servers\")\n\n        Set rng = .Range(.Range(\"A1\"), .Range(\"c1\").End(xlDown))\n\n        For Each c In rng\n            c = Replace(c, \" \", \"\")\n\n            With Worksheets(\"This Week Servers\")\n                Set cfind = .Columns(\"A:A\").Cells.Find(what:=c.Value, lookat:=xlWhole)\n\n                If cfind Is Nothing Then\n                    c.Resize(1, 1).EntireRow.Copy\n                    ws1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n                End If\n            End With\n        Next c\n\n        Application.CutCopyMode = False\n\n    End With\n\n    With Worksheets(\"This Week Servers\")\n\n        Set rng = .Range(.Range(\"A1\"), .Range(\"c1\").End(xlDown))\n\n        For Each c In rng\n            c = Replace(c, \" \", \"\")\n\n            With Worksheets(\"Last Week Servers\")\n                Set cfind = .Columns(\"A:A\").Cells.Find(what:=c.Value, lookat:=xlWhole)\n\n                If cfind Is Nothing Then\n                    c.Resize(1, 1).EntireRow.Copy\n                    ws1.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n                End If\n            End With\n        Next c\n\n        Application.CutCopyMode = False\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<pre><code>Public Sub FindDifferences1()\n\n    Dim firstRange As Range\n    Dim secondRange As Range\n    Dim myCell As Range\n\n    Dim wks1 As Worksheet, wks2 As Worksheet, wks3 As Worksheet\n\n    'Find Removed Wintel Servers\n    Set wks1 = ActiveWorkbook.Sheets(\"Last Week Servers List\")\n    Set wks2 = ActiveWorkbook.Sheets(\"This Week Servers List\")\n    Set wks3 = ActiveWorkbook.Sheets(\"New Servers\")\n\n    Set firstRange = wks1.Range(\"A:A\")\n    Set secondRange = wks2.Range(\"A:A\")\n\n    For Each myCell In firstRange\n        If myCell &lt;&gt; secondRange.Range(myCell.Address) Then\n\n            myCell.Copy\n\n            wks3.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n            wks3.Cells(Rows.Count, 2).End(xlUp).PasteSpecial xlPasteFormats\n\n        End If\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p>Format of the sheets is only one column with a row header <em>Server Name</em></p>\n"}, {"tags": ["vba", "web-scraping", "web-crawler"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1525262391, "post_id": 50133953, "comment_id": 87286187, "body": "<code>large-temp</code> appear to be classes, not tagNames."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1525262479, "post_id": 50133953, "comment_id": 87286232, "body": "AccuWeather very probably forbids crawling their site. Get an API access token and use their API. (This will be much easier to do, as well)."}, {"owner": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1525263328, "post_id": 50133953, "comment_id": 87286717, "body": "Thanks @Tomalak Is there any possibility to crawl using the script?"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1525263767, "post_id": 50133953, "comment_id": 87286979, "body": "Why would you say &quot;thanks&quot; and then directly ask your original question again? Use the API."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1525264197, "post_id": 50133953, "comment_id": 87287259, "body": "It&#39;s quite unclear which portion of information from that page you wanna scrape. Can you show your desired output. Btw, the link you provided above and the one you used within your script are different."}, {"owner": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1525264588, "post_id": 50133953, "comment_id": 87287533, "body": "@SIM I Have added the image in that I want 88 degree as output"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1525265772, "post_id": 50133953, "comment_id": 87288327, "body": "It&#39;s quite unclear what the problem is since you haven&#39;t specified what&#39;s not working."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "edited": false, "score": 0, "creation_date": 1525266352, "post_id": 50135205, "comment_id": 87288708, "body": "Also can you help me how to get this knowledge?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "edited": false, "score": 0, "creation_date": 1525266707, "post_id": 50135205, "comment_id": 87288960, "body": "Knowledge on what? If about  <code>.queySelectorAll()</code> you are talking then I&#39;ve already provided with the link. However, if it is about webscraping then <a href=\"https://www.youtube.com/watch?v=dShR33CdlY8&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5&amp;index=51\" rel=\"nofollow noreferrer\">this link</a> might help. Thanks."}, {"owner": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "edited": false, "score": 0, "creation_date": 1525266902, "post_id": 50135205, "comment_id": 87289083, "body": "Sure I will check. Your help is much appreciated. Thanks"}, {"owner": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "edited": false, "score": 0, "creation_date": 1525326722, "post_id": 50135205, "comment_id": 87313760, "body": "can you help me to scrap the table from below link/ <a href=\"https://www.accuweather.com/en/in/bengaluru/204108/month/204108?view=table\" rel=\"nofollow noreferrer\">accuweather.com/en/in/bengaluru/204108/month/204108?view=tab&zwnj;&#8203;le</a>"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "edited": false, "score": 0, "creation_date": 1525331157, "post_id": 50135205, "comment_id": 87315686, "body": "Create a new post describing your current requirement and drop a link here. I&#39;ll take a look. Thanks."}, {"owner": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "edited": false, "score": 0, "creation_date": 1525333099, "post_id": 50135205, "comment_id": 87316663, "body": "<a href=\"https://stackoverflow.com/questions/50149407/scraping-the-table-data-from-accuweather-website\" title=\"scraping the table data from accuweather website\">stackoverflow.com/questions/50149407/&hellip;</a>"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "edited": false, "score": 0, "creation_date": 1525349973, "post_id": 50135205, "comment_id": 87327337, "body": "I think I should kick out my answer from your suggested url as you have found out your desired solution there @Ragu. Thanks."}, {"owner": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "edited": false, "score": 0, "creation_date": 1525415792, "post_id": 50135205, "comment_id": 87354654, "body": "Thanks @SIM In anyways If you require any help let me know. Happy to help you"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1525265761, "creation_date": 1525265761, "answer_id": 50135205, "question_id": 50133953, "link": "https://stackoverflow.com/questions/50133953/web-crawling-accuweather/50135205#50135205", "title": "Web crawling Accuweather", "body": "<p>Try the below approach to get the information you would like to parse from that page. I used <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\" rel=\"nofollow noreferrer\">.querySelectorAll()</a> within the script to make it concise but more effective. Give it a shot.</p>\n\n<pre><code>Sub GetWeatherInfo()\n    Dim HTTP As New XMLHTTP60, HTML As New HTMLDocument\n    Dim post As Object\n\n    With HTTP\n        .Open \"GET\", \"https://www.accuweather.com/en/in/bengaluru/204108/weather-forecast/204108\", False\n        .send\n        HTML.body.innerHTML = .responseText\n    End With\n\n    Set post = HTML.querySelectorAll(\"#feed-tabs .large-temp\")(0)\n    MsgBox post.innerText\nEnd Sub\n</code></pre>\n\n<p>Reference to add to the library:</p>\n\n<pre><code>Microsoft XML, V6.0 ''or the version you have\nMicrosoft HTML Object Library\n</code></pre>\n\n<p>Btw, before running the script, make sure the url I used is the right one.</p>\n"}], "owner": {"reputation": 3, "user_id": 9368863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bsYFO.jpg?s=128&g=1", "display_name": "Ragu", "link": "https://stackoverflow.com/users/9368863/ragu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 1, "accepted_answer_id": 50135205, "answer_count": 1, "score": 0, "last_activity_date": 1525265761, "creation_date": 1525261653, "last_edit_date": 1525264457, "question_id": 50133953, "link": "https://stackoverflow.com/questions/50133953/web-crawling-accuweather", "title": "Web crawling Accuweather", "body": "<p>I want to capture the current weather (88 in image)information from the website</p>\n\n<p><a href=\"https://i.stack.imgur.com/Hb1Uo.png\" rel=\"nofollow noreferrer\">Check the image</a></p>\n\n<p><a href=\"https://www.accuweather.com/en/in/bengaluru/204108/weather-forecast/204108\" rel=\"nofollow noreferrer\">https://www.accuweather.com/en/in/bengaluru/204108/weather-forecast/204108</a></p>\n\n<p>I have used the following code</p>\n\n<pre><code>Sub Get_Price()\nDim HTTP As New XMLHTTP60, HTML As New HTMLDocument\nDim post As HTMLDivElement\n\nWith HTTP\n.Open \"GET\", \"https://www.accuweather.com/en/in/india-weather\", False\n.send\nHTML.body.innerHTML = .responseText\nMsgBox .responseText\nEnd With\n\nFor Each post In HTML.getElementsByClassName(\"panel-list cityforecast\")\nWith post.getElementsByTagName(\"large-temp\")\n If .Length Then R = R + 1: Cells(R, 1) = .Item(0).innerText\nEnd With\nNext post\nEnd Sub\n</code></pre>\n\n<p>Please help, Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "edited": false, "score": 0, "creation_date": 1526397205, "post_id": 50161397, "comment_id": 87723571, "body": "Thanks Jon, great explanation and this really improved my code, I was forced to use Sleep 50 within each function, but initially i had it waiting a full second so has drastically increased the code speed!"}, {"owner": {"reputation": 242, "user_id": 7856535, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dhRrycPoKSA/AAAAAAAAAAI/AAAAAAAAAEY/Jtr0vjB9stI/photo.jpg?sz=128", "display_name": "Rapwnzel", "link": "https://stackoverflow.com/users/7856535/rapwnzel"}, "edited": false, "score": 0, "creation_date": 1544607541, "post_id": 50161397, "comment_id": 94332680, "body": "Thank you for this. I wasted a few hours because I was not aware of this behaviour of VBA. It is not even mentioned in the documentation..."}, {"owner": {"reputation": 191, "user_id": 4297503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2109b76a518965cda4aeceea5faab78?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/4297503/john"}, "edited": false, "score": 0, "creation_date": 1547011284, "post_id": 50161397, "comment_id": 95039810, "body": "@jonPeltier.    I also had the same problems:  many copies of charts to be pasted as images in another spreadsheet.   I also do not see the error problem documented, but also note that the &#39;subroutine&#39; suggestion, to cause the necessary processing to finish, has no explanation documented.   My question1:  Why does the subroutine force the needed processing? (Is that effect documented anywhere?)   Question 2:  If that does the trick, why do TisButaScratch and JonPeltier include the .waits, anyway ?"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1547826870, "post_id": 50161397, "comment_id": 95338881, "body": "The problem is not documented by Microsoft; it&#39;s sporadic, and you&#39;ll see questions in online forums about it. The &#39;subroutine&#39; explanation is this: I have discovered that identifying out operations that take time and may get VBA out of sync, and breaking them into other procedures, seems to help with these problems. I don&#39;t know why it works, but I surmise it may be because the boundaries of the called procedures force VBA to finish working with objects before entering or leaving these procedures. Makes sense to me, anyway."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1547826978, "post_id": 50161397, "comment_id": 95338943, "body": "I try to avoid using <code>Application.Wait</code> (although I see that I left it in the code sample in my answer, which came from the code sample in the question). <code>DoEvents</code> and calling other procedures keep VBA running, whereas <code>.Wait</code> actually halts VBA. It seems to me that halting VBA would prevent it from catching up with itself."}], "tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": true, "score": 5, "last_activity_date": 1525370893, "creation_date": 1525370893, "answer_id": 50161397, "question_id": 50133777, "link": "https://stackoverflow.com/questions/50133777/error-when-copy-pasting-a-chart-through-vba/50161397#50161397", "title": "Error when copy pasting a chart through VBA", "body": "<p>Often VBA starts working on objects when these objects are still not ready to be worked on. Even copying an object may not be finished (i.e., the whole object is not totally committed to the clipboard) when VBA tries to paste.</p>\n\n<p>I've found that putting certain operations into a separate procedure may be enough to make VBA to wait for one background process to finish before kicking off the next.</p>\n\n<p>For example, in the code below, I've moved the Paste out of the main procedure. This makes VBA wait until the copy is done before pasting, and also until the paste is done before positioning the pasted chart.</p>\n\n<p>In fact, I often have three separate functions which are called by the main sub: copying the chart, pasting the chart, and positioning the chart.</p>\n\n<pre><code>Public Sub CopyPasteHeadcountTopGraph()\n    If PPT Is Nothing Then Exit Sub\n    If PPT_pres Is Nothing Then Exit Sub\n\n    Dim rng As Range\n    Dim mySlide As Object\n    Dim myShape As Object\n    Dim cht As Chart\n\n    Set mySlide = PPT_pres.Slides(6)\n\n    With mySlide\n    .Select\n    Set cht = ThisWorkbook.Worksheets(\"Headcount\").ChartObjects(\"HcChart\").Chart\n\n       cht.CopyPicture Appearance:=xlScreen, Format:=xlPicture, Size:=xlScreen\n\n       '''''''''''''''''''''''''''''''''''\n       '' .Shapes.Paste.Select 'ERROR HERE\n       '''''''''''''''''''''''''''''''''''\n\n       PasteChartIntoSlide mySlide\n\n        PPT_pres.Windows(1).Selection.ShapeRange.Left = 35\n        PPT_pres.Windows(1).Selection.ShapeRange.Top = 110\n        PPT_pres.Windows(1).Selection.ShapeRange.Width = 655\n        PPT_pres.Windows(1).Selection.ShapeRange.Height = 300\n\n        End With\n\n    'Clear The Clipboard\n    Application.CutCopyMode = False\n    Application.Wait (Now + TimeValue(\"00:00:01\"))\n\nEnd Sub\n\nFunction PasteChartIntoSlide(theSlide As Object) As Object\n    theSlide.Shapes.Paste.Select\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11015016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b538a962316bb611ff52ebd0d68680f?s=128&d=identicon&r=PG", "display_name": "Alejandro Vergara", "link": "https://stackoverflow.com/users/11015016/alejandro-vergara"}, "is_accepted": false, "score": 0, "last_activity_date": 1549326250, "last_edit_date": 1549326250, "creation_date": 1549320954, "answer_id": 54525541, "question_id": 50133777, "link": "https://stackoverflow.com/questions/50133777/error-when-copy-pasting-a-chart-through-vba/54525541#54525541", "title": "Error when copy pasting a chart through VBA", "body": "<p>I had to use this code to solve this problem. The call to the function or DoEvents were not enough:</p>\n\n<pre><code>...\nActiveChart.ChartArea.Copy\naplicacion = RUTA &amp; \"\\freemem.vbe\"\nlngErr = ShellExecute(0, \"OPEN\", aplicacion, \"\", \"\", 0)\nCall pegadatos(PPSlide)\n...\n</code></pre>\n\n<p>where the shellexecute function is declared previuously as</p>\n\n<pre><code>Private Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n</code></pre>\n\n<p>freemem.vbe is a text file with an only line: <code>Mystring=(80000000)</code>. You must change the extension to .vbe after creating the .txt file.</p>\n\n<p>And pegadatos:</p>\n\n<pre><code>Sub pegadatos(TheSlide As Object)\nTheSlide.Shapes.Paste.Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 928, "user_id": 250328, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e430c2f1cc5d3671b62c1d96b907daf?s=128&d=identicon&r=PG", "display_name": "OfficeAddinDev", "link": "https://stackoverflow.com/users/250328/officeaddindev"}, "is_accepted": false, "score": 0, "last_activity_date": 1562936068, "creation_date": 1562936068, "answer_id": 57007436, "question_id": 50133777, "link": "https://stackoverflow.com/questions/50133777/error-when-copy-pasting-a-chart-through-vba/57007436#57007436", "title": "Error when copy pasting a chart through VBA", "body": "<p>This error may also be due to an Excel bug that apparently prevents you from copying charts whose data labels are linked to a non-contiguous range of cells, such that you get the \"Clipboard is empty...\" error when you subsequently try to paste.  This bug was reproduced in Excel 2013 and newer, and is additionally described at:</p>\n\n<p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/chart-with-data-labels-will-not-copy-to-clipboard/e60dcb59-8644-464a-8e13-0f5f62c4be76?auth=1\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/all/chart-with-data-labels-will-not-copy-to-clipboard/e60dcb59-8644-464a-8e13-0f5f62c4be76?auth=1</a></p>\n"}], "owner": {"reputation": 143, "user_id": 9602830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a836bb337b79183be9ac3a78bb65bb?s=128&d=identicon&r=PG&f=1", "display_name": "TisButaScratch ", "link": "https://stackoverflow.com/users/9602830/tisbutascratch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3862, "favorite_count": 1, "accepted_answer_id": 50161397, "answer_count": 3, "score": 2, "last_activity_date": 1574846399, "creation_date": 1525261037, "last_edit_date": 1574846399, "question_id": 50133777, "link": "https://stackoverflow.com/questions/50133777/error-when-copy-pasting-a-chart-through-vba", "title": "Error when copy pasting a chart through VBA", "body": "<p>I have been using this code to copy across a number of ranges and charts. However as my code has grown it appears to fall over, having googled around the issue i think it is caused by the chart/range not correctly being copied to/from the clipboard cache. Is there a way to avoid this error?</p>\n\n<blockquote>\n  <p>Error - \" Run-time error '-2147188160 (80048248)': Shapes.PasteSpecial :Invalid request. Clipboard is empty or contains data which may not be pasted here\"</p>\n</blockquote>\n\n<pre><code>Public Sub CopyPasteHeadcountTopGraph()\n    If PPT Is Nothing Then Exit Sub\n    If PPT_pres Is Nothing Then Exit Sub\n\n    Dim rng As Range\n    Dim mySlide As Object\n    Dim myShape As Object\n    Dim cht As Chart\n\n    Set mySlide = PPT_pres.Slides(6)\n\n    With mySlide\n    .Select\n    Set cht = ThisWorkbook.Worksheets(\"Headcount\").ChartObjects(\"HcChart\").Chart\n\n       cht.CopyPicture Appearance:=xlScreen, Format:=xlPicture, Size:=xlScreen\n       .Shapes.Paste.Select 'ERROR HERE\n\n        '''''''''''''''''''''''''''''''''\n        'Paste as Chart and break link. '\n        '''''''''''''''''''''''''''''''''\n        'cht.ChartArea.Copy\n        '.Shapes.Paste.Select\n\n\n    'With .Shapes(\"HcChart\")\n        '.LinkFormat.BreakLink\n    'End With\n\n        PPT_pres.Windows(1).Selection.ShapeRange.Left = 35\n        PPT_pres.Windows(1).Selection.ShapeRange.Top = 110\n        PPT_pres.Windows(1).Selection.ShapeRange.Width = 655\n        PPT_pres.Windows(1).Selection.ShapeRange.Height = 300\n\n        End With\n\n    'Clear The Clipboard\n    Application.CutCopyMode = False\n    Application.Wait (Now + TimeValue(\"00:00:01\"))\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "office365", "powerpoint"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1525258739, "post_id": 50132842, "comment_id": 87283859, "body": "Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>! Have you checked the method&#39;s <a href=\"https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/shape-object-powerpoint\" rel=\"nofollow noreferrer\">documentation</a>?  Also, what/why are you multiplying?  Far left is <code>.Left=0</code>."}, {"owner": {"reputation": 15, "user_id": 9729704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a621c7d8f715c7d49a2f13955b2c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "kaydee", "link": "https://stackoverflow.com/users/9729704/kaydee"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1525259003, "post_id": 50132842, "comment_id": 87284029, "body": "Thanks! Yes - Not many clues unfortunately. .Left is a property of shape objects that simply represents the distance in points from the left edge of the shape&#39;s bounding box to the left edge of the slide. It can either be set with an integer value or return the integer value of a shape&#39;s leftmost position. I&#39;m multiplying as VBA measures in points but I have cm values of where I&#39;d like the position to be and the conversion factor is 28.35"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1525259118, "post_id": 50132842, "comment_id": 87284115, "body": "Without seeing what you have I can&#39;t give much help (or visualize your issue is) but can you place these shapes properly manually?  If so, what is the value of <code>.Left</code> after you do so?"}, {"owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1525259163, "post_id": 50132842, "comment_id": 87284142, "body": "See if pasting as <code>ppPasteEnhancedMetafile</code> helps."}, {"owner": {"reputation": 15, "user_id": 9729704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a621c7d8f715c7d49a2f13955b2c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "kaydee", "link": "https://stackoverflow.com/users/9729704/kaydee"}, "reply_to_user": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1525259679, "post_id": 50132842, "comment_id": 87284476, "body": "@CCM that does seem to fix the positioning issue, but pastes the range as an image rather than a table which isn&#39;t ideal. If it&#39;s the only way to get round it then I can format in Excel and paste as an image but ideally people would be able to copy and paste text from these tables."}, {"owner": {"reputation": 15, "user_id": 9729704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a621c7d8f715c7d49a2f13955b2c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "kaydee", "link": "https://stackoverflow.com/users/9729704/kaydee"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1525259690, "post_id": 50132842, "comment_id": 87284482, "body": "@ashleedawg yes, that&#39;s how I arrived at the 10.56 and 3.83 figures which are being multiplied; they are the .left and .top values when placed manually"}, {"owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1525260036, "post_id": 50132842, "comment_id": 87284706, "body": "@user9729704 ok, I have not worked with tables in ppt. May I suggest a workaround then ? I see you are already using a template so why not add the tables how you want there, then you can either update the data when in the working file or store the initial dimensions in some variables to use later in said working file."}, {"owner": {"reputation": 15, "user_id": 9729704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a621c7d8f715c7d49a2f13955b2c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "kaydee", "link": "https://stackoverflow.com/users/9729704/kaydee"}, "reply_to_user": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1525260704, "post_id": 50132842, "comment_id": 87285168, "body": "@CCM that would be great and my initial thinking was to build the template with formatted tables on each slide and paste values into them, but can&#39;t figure out how to pass information into tables from a range. Would you have to loop through all cells in a table and assign them values individually or something?"}, {"owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1525261413, "post_id": 50132842, "comment_id": 87285645, "body": "@user9729704 As I said before, I have not worked with tables in PowerPoint so no code snippets I&#39;m afraid, but if they act like database tables, I&#39;m pretty sure if you can not easily paste a range there. You have to treat it like a matrix and go via cell/column/row. A quick Google and <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">this</a> is a guide to work with tables in Excel (easier to understand imo) and <a href=\"http://www.pptfaq.com/FAQ00790_Working_with_PowerPoint_tables.htm\" rel=\"nofollow noreferrer\">this</a> is for PowerPoint. Hope it helps!"}, {"owner": {"reputation": 15, "user_id": 9729704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a621c7d8f715c7d49a2f13955b2c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "kaydee", "link": "https://stackoverflow.com/users/9729704/kaydee"}, "reply_to_user": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "edited": false, "score": 0, "creation_date": 1525262104, "post_id": 50132842, "comment_id": 87286035, "body": "@CCM thank you for your help"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9729704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a621c7d8f715c7d49a2f13955b2c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "kaydee", "link": "https://stackoverflow.com/users/9729704/kaydee"}, "edited": false, "score": 0, "creation_date": 1525881482, "post_id": 50235062, "comment_id": 87532970, "body": "Thank you so much for answering this - I was tying myself in knots trying to work out the loops that would get it to work and I&#39;d only succeeded in getting the same value to populate every cell of the table. This is really smart, thanks again!!"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 0, "last_activity_date": 1525786797, "creation_date": 1525786797, "answer_id": 50235062, "question_id": 50132842, "link": "https://stackoverflow.com/questions/50132842/left-positioning-shapes-in-wrong-place-in-powerpoint-2016-vba/50235062#50235062", "title": ".Left positioning shapes in wrong place in PowerPoint 2016 VBA", "body": "<p>You need to loop over the table and the data if you are using a template.\nIf you already have a table (table 2) on slide 3, then you could use this.  just send in the excel file object and the template (path+name)\nit may need some tinkering.</p>\n\n<pre><code>Sub Slide_3(ByRef xlWorkBook, Template)\n\nFor Each oSh In Presentations(Template).Slides(3).Shapes\n        Select Case oSh.Name\n            Case \"Table 2\"\n            For i = 1 To 20\n                For j = 1 To 3\n                    oSh.Table.Cell(i, j).Shape.TextFrame.TextRange.Text = xlWorkBook.Worksheets(24).Cells(105 + i, j + 12).Value\n                Next j\n            Next i\n 'M106:o126\n\n         End Select\n\nNext oSh\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 970, "user_id": 2953077, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GDzjT.jpg?s=128&g=1", "display_name": "Noobster", "link": "https://stackoverflow.com/users/2953077/noobster"}, "edited": false, "score": 0, "creation_date": 1581584561, "post_id": 57056511, "comment_id": 106486642, "body": "It looks like selecting the slide before attempting to reposition the shape / table is the answer in this case. Solved the issue for me."}], "tags": [], "owner": {"reputation": 21, "user_id": 8338010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e1ea087d991f19528c0dbc9c379067?s=128&d=identicon&r=PG&f=1", "display_name": "Spiff", "link": "https://stackoverflow.com/users/8338010/spiff"}, "is_accepted": false, "score": 2, "last_activity_date": 1563277585, "creation_date": 1563277585, "answer_id": 57056511, "question_id": 50132842, "link": "https://stackoverflow.com/questions/50132842/left-positioning-shapes-in-wrong-place-in-powerpoint-2016-vba/57056511#57056511", "title": ".Left positioning shapes in wrong place in PowerPoint 2016 VBA", "body": "<p>I got the same problem and I run a debug message showing the position after inserting and it seems to be correct. But only the thumbnail looks fine, the actual slide is wrong.</p>\n\n<p>I found out that the position of the table will be correct when activating or displaying the slide before pasting the table. Also if several tables need to be inserted I needed to make a short break of 2 seconds between the paste operations.</p>\n\n<p>My workaround is pretty ugly and I am still searching for the reason. It is likely a bug but maybe it also has to do with some kind of offset of the slide in the background.</p>\n"}], "owner": {"reputation": 15, "user_id": 9729704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a621c7d8f715c7d49a2f13955b2c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "kaydee", "link": "https://stackoverflow.com/users/9729704/kaydee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1177, "favorite_count": 0, "accepted_answer_id": 50235062, "answer_count": 2, "score": 1, "last_activity_date": 1563277585, "creation_date": 1525258227, "question_id": 50132842, "link": "https://stackoverflow.com/questions/50132842/left-positioning-shapes-in-wrong-place-in-powerpoint-2016-vba", "title": ".Left positioning shapes in wrong place in PowerPoint 2016 VBA", "body": "<p>I'm trying to copy ranges from an Excel sheet and paste them into slides as tables, then position and resize them. However, when I try to position the shapes in ppt, the .Left method doesn't behave as expected; in the slide thumbnails on the left of the screen the shapes are in the expected positions (centred as in the below code), but when I select the slide the shapes are shifted far to the right of where they ought to be.</p>\n\n<p>I thought it may be using 'centre' as its reference point instead of the left bound of the slide but this doesn't match up with the amount it's offset.</p>\n\n<p>Would really appreciate some help with this - would be good to know if it's a bug in ppt or an error in my code as if it's a bug it has a large impact on the feasibility of this project. For this particular example I could probably use the .Align method as a workaround but for later slides I need to be able to position multiple shapes on the same slide accurately.</p>\n\n<p>I'm using Office 365.</p>\n\n<p>Code below:</p>\n\n<pre><code>Sub PP_export()\n\nDim PPApp As PowerPoint.Application\nDim PPPres As PowerPoint.Presentation\nDim PPSlide As PowerPoint.Slide\nDim XLws As Worksheet\n\nSet PPApp = New PowerPoint.Application\nSet XLws = ActiveSheet\nSet PPPres = PPApp.Presentations.Open(\"Y:\\Research\\PROJECTS\\2018\\Magic Macro\\ppt_template_.potx\")\nPPApp.Visible = True\n\n''Lifestyle Statements\n'By Col%\nSet PPSlide = PPPres.Slides(3)\nDim LSCol As PowerPoint.Shape\n\nXLws.Range(\"M106:o126\").Copy\nPPSlide.Shapes.PasteSpecial ppPasteDefault\n\nSet LSCol = PPSlide.Shapes(\"Table 2\")\nWith LSCol\n    .Left = (28.35 * 10.56)\n    .Top = (28.35 * 3.83)\n    .Height = (28.35 * 13.21)\n    .Width = (28.35 * 12.75)\nEnd With\n\n'By Index\nSet PPSlide = PPPres.Slides(4)\nDim LSIndex As PowerPoint.Shape\n\nXLws.Range(\"Q106:s126\").Copy\nPPSlide.Shapes.PasteSpecial ppPasteDefault\n\nSet LSIndex = PPSlide.Shapes(\"Table 2\")\nWith LSIndex\n    .Left = (28.35 * 10.56)\n    .Top = (28.35 * 3.83)\n    .Height = (28.35 * 13.21)\n    .Width = (28.35 * 12.75)\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1525258861, "post_id": 50132822, "comment_id": 87283945, "body": "When you say <i>&quot;unique digits&quot;</i> do you mean each of the six should appear only once??"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1525259057, "post_id": 50132822, "comment_id": 87284068, "body": "Exactly! Each of the six should only appear in the combination once :)"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1525258275, "creation_date": 1525258275, "answer_id": 50132859, "question_id": 50132822, "link": "https://stackoverflow.com/questions/50132822/if-cells-begin-with-and-create-random-number/50132859#50132859", "title": "IF cells begin with AND Create random number", "body": "<p>Using <code>Left</code> function, you need to specify the <code>String</code>, then the number of characters from the left, and then you check if it's equal to \"262015\".</p>\n\n<p>Try the code below:</p>\n\n<pre><code>For i = 2 To 18288\n    If Left(Worksheets(\"Base\").Cells(i, 12), 6) = \"262015\" Then\n        Worksheets(\"Base\").Cells(i, 3) = \"XXX\"\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525259610, "post_id": 50133172, "comment_id": 87284441, "body": "Does this code replace the cells found in the first part with a new random number? And is it possible to set it to &quot;18XXXXXX&quot; where the X&#39;s are random numbers?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1525260022, "post_id": 50133172, "comment_id": 87284694, "body": "But it does not satisfy the &quot;Each of the six should only appear in the combination once&quot; requirement"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1525260756, "post_id": 50133172, "comment_id": 87285207, "body": "oh, missed that"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525260777, "post_id": 50133172, "comment_id": 87285219, "body": "Nice! How can i make it check that the combination only appear once, since its around 10.000 numbers its creating, which needs to be different? :)"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525261492, "post_id": 50133172, "comment_id": 87285690, "body": "It says that sub/function isnt defined - Where do you put the Sub / End sub tag? :)"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525261767, "post_id": 50133172, "comment_id": 87285832, "body": "I Changed the question to what i&#39;ve written from your post now :)"}, {"owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "edited": false, "score": 0, "creation_date": 1525261971, "post_id": 50133172, "comment_id": 87285955, "body": "Thats my bad - I wrote something wrong in the code... Thank you SO much for your help mate! My last question: Is there anything i can read to understand what you did? I have a good general understanding, but this code seems kind of complex tbh"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1525262350, "post_id": 50133172, "comment_id": 87286169, "body": "Use F8 to step through the code. If you hover your cursor over the variables they should show the current values - (or use the Immediate window to find the values by typing ? and the variable name)  You should be able to work out what&#39;s happening at each loop."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 3, "last_activity_date": 1525261777, "last_edit_date": 1525261777, "creation_date": 1525259245, "answer_id": 50133172, "question_id": 50132822, "link": "https://stackoverflow.com/questions/50132822/if-cells-begin-with-and-create-random-number/50133172#50133172", "title": "IF cells begin with AND Create random number", "body": "<pre><code>For i = 2 To 18288\n    If Left(Worksheets(\"Base\").Cells(i, 12), 6) = \"262015\" Then\n        Worksheets(\"Base\").Cells(i, 3) = \"18\" &amp; Randdigits(6)\n    End If\nNext i\n\nFunction RandDigits(x As Long) As String\nDim i As Long\nDim s As String\nFor i = 1 To x\n    s = s &amp; Int(Rnd() * 10)\nNext i\nRandDigits = s\nEnd Function\n</code></pre>\n\n<p>EDIT: here's one where all digits are different</p>\n\n<pre><code>Function UniqueRandDigits(x As Long) As String\nDim i As Long\nDim n As Integer\nDim s As String\nDo\nn = Int(Rnd() * 10)\nIf InStr(s, n) = 0 Then\ns = s &amp; n\ni = i + 1\nEnd If\nLoop Until i = x + 1\n\nUniqueRandDigits = s\nEnd Function\n</code></pre>\n\n<p>EDIT2: And here is one that forces all numbers to be different</p>\n\n<pre><code>dim n as  string\ndim ok as boolean\nFor i = 2 To 18288\n    If Left(Worksheets(\"Base\").Cells(i, 12), 6) = \"262015\" Then\n        ok = false\n        do\n        n = UniqueRandDigits(6)\n            If Application.WorksheetFunction.CountIf(Worksheets(\"Base\").Range(\"L2:L18288\"), n) = 0 Then\n                Worksheets(\"Base\").Cells(i, 3) = \"18\" &amp; n\n                ok = true\n            end if\n        loop until ok\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9670450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef2451658ebc10388293e02bc22fcd0?s=128&d=identicon&r=PG&f=1", "display_name": "Adem", "link": "https://stackoverflow.com/users/9670450/adem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525261777, "creation_date": 1525258154, "last_edit_date": 1525261747, "question_id": 50132822, "link": "https://stackoverflow.com/questions/50132822/if-cells-begin-with-and-create-random-number", "title": "IF cells begin with AND Create random number", "body": "<p>I want to make a sub, which determines if the cells in the 12th column starts with 262015. If it does start with this, it should create a new random 8-digit number starting with \"18\" and then 6 randomly created unique digits.</p>\n\n<p>My code does not seem to figure out if the cell starts with 262015, and I have not been able to find help on creating the 8-digit number with these requirements. </p>\n\n<p>Hope you can help me!</p>\n\n<pre><code>Sub Opgave8()\n\nFor i = 2 To 18288\n    If Left(Worksheets(\"arab\").Cells(i, 12), 6) = \"262015\" Then\n        Worksheets(\"arab\").Cells(i, 3) = \"18\" &amp; studyid(6)\n    End If\nNext i\n\nFunction UniqueRandDigits(x As Long) As String\nDim i As Long\nDim n As Integer\nDim s As String\nDo\nn = Int(Rnd() * 10)\nIf InStr(s, n) = 0 Then\ns = s &amp; n\ni = i + 1\nEnd If\nLoop Until i = x + 1\n\nUniqueRandDigits = s\nEnd Function\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525258213, "post_id": 50132806, "comment_id": 87283547, "body": "How many characters? There is a cell limit, around 32k."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525258550, "post_id": 50132806, "comment_id": 87283750, "body": "Or perhaps you have a blank cell in the middle. Use end(xlup)."}, {"owner": {"reputation": 1, "user_id": 9689062, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210508773309979/picture?type=large", "display_name": "Patrick O&#39;Malley", "link": "https://stackoverflow.com/users/9689062/patrick-omalley"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525264545, "post_id": 50132806, "comment_id": 87287491, "body": "Your first comment was exactly right. The text exceeded 32k. The text has a bunch of unbreakable spaces so after I substitute out the unbreakable spaces ((Char(160)) the text  goes down from 32k to under 4k."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1525259628, "creation_date": 1525259628, "answer_id": 50133298, "question_id": 50132806, "link": "https://stackoverflow.com/questions/50132806/paste-contents-of-range-into-1-cell-excel-vba/50133298#50133298", "title": "Paste contents of range into 1 cell - Excel VBA", "body": "<p>Putting those two suggestions together</p>\n\n<pre><code>Sub Copy_Paste()\n\nDim rng As Range\nDim i As String\nFor Each rng In range(Range(\"A2\"),Range(\"A\" &amp; activesheet.rows.count).end(xlup))\n    i = i &amp; rng.text &amp; \" \"\nNext rng\nif len(i)&gt;32387 then msgbox \"Too Long\" 'test if too long\nRange(\"E7\").Value = Trim(i)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9689062, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210508773309979/picture?type=large", "display_name": "Patrick O&#39;Malley", "link": "https://stackoverflow.com/users/9689062/patrick-omalley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525259628, "creation_date": 1525258096, "question_id": 50132806, "link": "https://stackoverflow.com/questions/50132806/paste-contents-of-range-into-1-cell-excel-vba", "title": "Paste contents of range into 1 cell - Excel VBA", "body": "<p>I am trying to copy the contents of a range starting in cell A2 and then paste the contents in cell E7.</p>\n\n<p>The code that have written out here has been working for me when my ranges were about 100 rows, but when I am trying it with a larger range (200 rows) it is only pasting about 70% of the content. </p>\n\n<p>Is there a way to fix this so it works every time?  </p>\n\n<pre><code>Sub Copy_Paste()\nRange(\"A2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nDim rng As Range\nDim i As String\nFor Each rng In Selection\ni = i &amp; rng &amp; \" \"\nNext rng\nRange(\"E7\").Value = Trim(i)\n</code></pre>\n"}, {"tags": ["vba", "excel", "date", "find"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1525257634, "post_id": 50132306, "comment_id": 87283183, "body": "I can&#39;t reproduce this. If I have a date with no hidden characters entered with your custom format the following works .Range.Find(Date).Row  I assume that the date you are searching for does appear in the table."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1525258187, "post_id": 50132306, "comment_id": 87283540, "body": "Consider renaming the Date column (at least to exclude it as a problem)"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1525259895, "post_id": 50132306, "comment_id": 87284608, "body": "Format function converts the date to text, which will not match the date (which is a double)"}], "owner": {"reputation": 11, "user_id": 9729658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8afbd4669c5fbe858449b1fb49c02ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Jdoe", "link": "https://stackoverflow.com/users/9729658/jdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525256569, "creation_date": 1525256569, "last_edit_date": 1531164843, "question_id": 50132306, "link": "https://stackoverflow.com/questions/50132306/find-a-date-in-a-table", "title": "Find a date in a Table", "body": "<p>I have a table:</p>\n\n<pre><code>Sheet name: 'DateSheet'\nTable name: 'DateTable'\n\n| Date       | First Field    | Second Field     | ...\n+------------+----------------+------------------+-----\n| 2018-01-01 | ...            | ...              | ...\n| 2018-01-02 | ...            | ...              | ...\n| 2018-01-03 | ...            | ...              | ...\n| 2018-01-04 | ...            | ...              | ...\n</code></pre>\n\n<p>The dates are all in <code>Custom -&gt; YYYY-MM-DD</code> format.</p>\n\n<p>I want to select the row that corresponds to a specific date. I wrote the following code, yet it does not work:</p>\n\n<pre><code>Dim DateTable As Range\nSet DateTable = DateSheet.ListObjects(\"DateTable\").Range\n\nDebug.Print Date                            // Returns \"2018-05-02\", today's date\nDebug.Print DateTable.Address               // Returns \"$B$5:$P$300\", the correct Range address\nDebug.Print DateTable.Find(\"Date\").Address  // Returns \"$B$5\", the correct row\nDebug.Print DateTable.Cells(123,1).Value    // Returns \"2018-05-02\", today's date\n\n// Everything seems to be OK, until now, where I get:\n// Err: \"Object variable or With block variable not set\" :\nDebug.Print DateTable.Find(Date).Address    \nDebug.Print DateTable.Find(CDate(Date)).Address\nDebug.Print DateTable.Find(Format(Date, \"YYYY-MM-DD\")).Address\n</code></pre>\n"}, {"tags": ["vba", "indexing", "range"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4470864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821c99b7635d1c6a31c4e231665cbcbb?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshire", "link": "https://stackoverflow.com/users/4470864/yorkshire"}, "edited": false, "score": 0, "creation_date": 1525267519, "post_id": 50133697, "comment_id": 87289516, "body": "Apologies Sam but I&#39;m not really understanding this, if you can help me that would be much appreciated. So The Company Names are names which are not currently listed on the sourcedata sheet. The first 2 columns are in the source sheet, I want to duplicate each of those rows 4 times and add in the 4 company names (the same 4 all the way down) When I tried your code, it pulled the last Customer name, and then the data in the 3 columns to the right of this in the source data transposed into a column. Do I need to add anything else such as the source data?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 37, "user_id": 4470864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821c99b7635d1c6a31c4e231665cbcbb?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshire", "link": "https://stackoverflow.com/users/4470864/yorkshire"}, "edited": false, "score": 0, "creation_date": 1525268864, "post_id": 50133697, "comment_id": 87290527, "body": "I didn&#39;t put that much effort into understanding the logic you need. A general piece of advice here is to put a breakpoint at the line after <code>For j</code> and examine the values of destIndex and index. Find out what they are at each iteration and figure out what you want them to be. Once you have that understanding you will either know how to solve it, or how to ask a more specific question."}, {"owner": {"reputation": 37, "user_id": 4470864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821c99b7635d1c6a31c4e231665cbcbb?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshire", "link": "https://stackoverflow.com/users/4470864/yorkshire"}, "edited": false, "score": 0, "creation_date": 1525272232, "post_id": 50133697, "comment_id": 87293063, "body": "Oh my life, this took some getting my head around, but finally solved it with a couple of additional variables... thank you.  Final code:"}, {"owner": {"reputation": 37, "user_id": 4470864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821c99b7635d1c6a31c4e231665cbcbb?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshire", "link": "https://stackoverflow.com/users/4470864/yorkshire"}, "edited": false, "score": 0, "creation_date": 1525272722, "post_id": 50133697, "comment_id": 87293413, "body": "it won&#39;t let me add the code now as too many characters and CTRL + K edits the address bar but its sorted... thank you"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1525260795, "creation_date": 1525260795, "answer_id": 50133697, "question_id": 50132251, "link": "https://stackoverflow.com/questions/50132251/how-to-replicate-index-range-for-4-separate-data-elements/50133697#50133697", "title": "How to replicate index range for 4 separate data elements", "body": "<p>You will have to add an inner loop in the for loop. Something like this (untested):</p>\n\n<pre><code>destIndex = 1\nFor index = 1 To sourceDataRowCount\n   For j = 1 to 4\n     dataDest(destIndex, 1).Value = dataSource(index, 1).Value\n     dataDest(destIndex, 2).Value = dataSource(index, j + 1).Value\n     destIndex = destIndex + 1\n   Next j\nNext index\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4470864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821c99b7635d1c6a31c4e231665cbcbb?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshire", "link": "https://stackoverflow.com/users/4470864/yorkshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15, "favorite_count": 0, "accepted_answer_id": 50133697, "answer_count": 1, "score": 0, "last_activity_date": 1525261787, "creation_date": 1525256395, "last_edit_date": 1525261787, "question_id": 50132251, "link": "https://stackoverflow.com/questions/50132251/how-to-replicate-index-range-for-4-separate-data-elements", "title": "How to replicate index range for 4 separate data elements", "body": "<p>I'm using an Index to loop through non blank records in another worksheet and pull through 2 values which works fine.\nI now need to duplicate these rows so each row appears 4 times with a 3rd column containing the 4 company names (Company1, Commpany2, Company3 and Company4).\nWe therefore end up with 4 times the number of records as the source sheet which should look like the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2mjk4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2mjk4.png\" alt=\"enter image description here\"></a></p>\n\n<p>My current code is:</p>\n\n<pre><code>Sub Address_Raw()\n    Dim dataBook As Workbook\n    Dim Address_Raw As Worksheet, Del_Tax As Worksheet\n    Dim dataSource As Range, dataDest As Range\n    Dim sourceDataRowCount As Integer, index As Integer\n\n    Set dataBook = Application.ThisWorkbook\n    Set sheetSource = dataBook.Sheets(\"Address_Raw\")\n    Set sheetDest = dataBook.Sheets(\"Del_Tax\")\n\n    Set dataSource = sheetSource.Range(\"B4\", _\n                    sheetSource.Range(\"B90000\").End(xlUp))\n    sourceDataRowCount = dataSource.Rows.Count\n\n    Set dataDest = sheetDest.Range(\"B13\", \"B\" &amp; _\n                                sourceDataRowCount)\n\n    For index = 1 To sourceDataRowCount\n      dataDest(index, 1).Value = dataSource(index, 1).Value\n      dataDest(index, 2).Value = dataSource(index, 2).Value\n\n    Next index\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting", "hide"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1525256419, "post_id": 50132139, "comment_id": 87282311, "body": "I think you need <code>Autofilter</code>."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1525283742, "creation_date": 1525283742, "answer_id": 50140806, "question_id": 50132139, "link": "https://stackoverflow.com/questions/50132139/sort-column-and-hide-rows-without-specified-text-in-column-using-vba-macro-in-ex/50140806#50140806", "title": "Sort Column and Hide Rows without specified text in column using VBA Macro in Excel", "body": "<p>As mentioned, use <code>AutoFilter</code> to hide rows not containing <code>'MFA'</code></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub SortByName()\n\n    Dim ws As Worksheet\n\n    Set ws = ActiveSheet\n\n    With ws\n\n        .Sort.SortFields.Clear\n        .Sort.SortFields.Add Key:=.Range(\"V:V\"), _\n                             SortOn:=xlSortOnValues, _\n                             Order:=xlAscending, _\n                             CustomOrder:=\"MFA\", _\n                             DataOption:=xlSortNormal\n        .Sort.SetRange .Range(\"A:AA\")\n        .Sort.Header = xlYes\n        .Sort.MatchCase = False\n        .Sort.Orientation = xlTopToBottom\n        .Sort.SortMethod = xlPinYin\n        .Sort.Apply\n\n        .UsedRange.Columns(\"V\").AutoFilter Field:=1, Criteria1:=\"MFA\"\n        'Or: .Range(\"A:AA\").AutoFilter Field:=22, Criteria1:=\"MFA\"\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9729588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-psAxSBHZ0JM/AAAAAAAAAAI/AAAAAAAAAB0/07Dt5NrJUy4/photo.jpg?sz=128", "display_name": "FigBird", "link": "https://stackoverflow.com/users/9729588/figbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525283915, "creation_date": 1525256041, "last_edit_date": 1525283915, "question_id": 50132139, "link": "https://stackoverflow.com/questions/50132139/sort-column-and-hide-rows-without-specified-text-in-column-using-vba-macro-in-ex", "title": "Sort Column and Hide Rows without specified text in column using VBA Macro in Excel", "body": "<p>I'm looking to use a VBA Macro which will 'sort' a column but 'hide' all the other text.</p>\n\n<p>The column is populated with three letter text, i.e. MFA, KDB, OPA etc...</p>\n\n<p>This is the code I currently have found:</p>\n\n<pre><code>Sub SortByName()\n\n    With ActiveSheet\n        .Sort.SortFields.Clear\n        .Sort.SortFields.Add Key:=.Range(\"V:V\"), _\n                             SortOn:=xlSortOnValues, _\n                             Order:=xlAscending, _\n                             CustomOrder:=\"MFA\", _\n                             DataOption:=xlSortNormal\n        .Sort.SetRange .Range(\"A:AA\")\n        .Sort.Header = xlYes\n        .Sort.MatchCase = False\n        .Sort.Orientation = xlTopToBottom\n        .Sort.SortMethod = xlPinYin\n        .Sort.Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>This code works well, but it does not hide the undesired rows with text that is not 'MFA'</p>\n\n<p>Many thanks :)</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1525261324, "last_edit_date": 1525261324, "creation_date": 1525260901, "answer_id": 50133732, "question_id": 50132116, "link": "https://stackoverflow.com/questions/50132116/microsoft-access-vba-combine-text-values-by-using-an-expression/50133732#50133732", "title": "Microsoft Access VBA: Combine text values by using an expression", "body": "<p>Concatenate variables. If fields are text type, parameters need apostrophe delimiters. </p>\n\n<pre><code>isTrainer = DCount(\"TrainerFirstName\", \"tbl4_Trainers\", _\n             \"TrainerEmail = '\" &amp; Me.txtEmail &amp; \"' And TrainerPassword = '\" &amp; Me.txtPassword &amp; \"'\") &gt; 0\nisMember = DCount(\"MemberFirstName\", \"tbl1_Members\", _\n             \"MemberEmail = '\" &amp; Me.txtEmail &amp; \"' And MemberPassword = '\" &amp; Me.txtPassword &amp; \"'\") &gt; 0\n</code></pre>\n\n<p>Need conditional to construct the welcome MsgBox text. Don't use the MsgBox function, just MsgBox OkOnly.</p>\n\n<p><code>MsgBox \"Welcome \" &amp; IIf(isTrainer, [TrainerFirstName] &amp; \" \" &amp; [TrainerLastName], [MemberFirstName] &amp; \" \" &amp; [MemberLastName])</code></p>\n\n<p><code>MsgBox \"Login Failed\"</code></p>\n\n<p>Advise not to use spaces nor punctuation/special characters (underscore only exception) in naming convention. Better form names would be:<br>\nfrm1_MemberTrainerLogin<br>\nfrm2_MemberClassRegistration<br>\nfrm3_MainMenu  </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9727816"}, "edited": false, "score": 0, "creation_date": 1525262510, "post_id": 50134063, "comment_id": 87286262, "body": "thanks for your help, but I kepp recieving the message &quot;Login Failed&quot;. Can you plase help me solve this problem, thanks."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1525264221, "post_id": 50134063, "comment_id": 87287277, "body": "Yes. My logic was wrong - login would fail if either Trainer or Member was not found. Se comments in edited answer, please."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9727816"}, "edited": false, "score": 0, "creation_date": 1525265232, "post_id": 50134063, "comment_id": 87287986, "body": "I can&#39;t thank you enough, you really helped me out a lot, and once again thanks for your help, hope you all the best in the future."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1525264159, "last_edit_date": 1525264159, "creation_date": 1525261994, "answer_id": 50134063, "question_id": 50132116, "link": "https://stackoverflow.com/questions/50132116/microsoft-access-vba-combine-text-values-by-using-an-expression/50134063#50134063", "title": "Microsoft Access VBA: Combine text values by using an expression", "body": "<p>Seems like you miss the full name. Use <em>DLookup</em> for that:</p>\n\n<pre><code>Private Sub Command9_Click()\n\n    Dim Trainer As Variant\n    Dim Member As Variant\n\n    Trainer = DLookup(\"[TrainerFirstName] &amp; ' ' &amp; [TrainerLastName]\", \"tbl4_Trainers\", _\n                 \"TrainerEmail = '\" &amp; [txtEmail] &amp; \"' And TrainerPassword = '\" &amp;[txtPassword] &amp; \"'\")\n    Member = DLookup(\"[MemberFirstName] &amp; ' ' &amp; [MemberLastName]\", \"tbl1_Members\", _\n                 \"MemberEmail = '\" &amp; [txtEmail] &amp; \"' And MemberPassword = '\" &amp;[txtPassword] &amp; \"'\")\n\n    ' To debug:\n    MsgBox \"Trainer: '\" &amp; Trainer &amp; \"'\" &amp; vbCrLf &amp; \"Member: '\" &amp; Member &amp; \"'\"\n    ' Note the revised logic: + -&gt; &amp;\n    If Not IsNull(Trainer &amp; Member) Then\n        MsgBox \"Welcome \" &amp; Nz(Trainer, Member)\n        DoCmd.Close acForm, \"frm1_Member &amp; Trainer Login\"\n\n        If Not IsNull(Trainer) Then\n            DoCmd.OpenForm \"frm3_Main Menu\"\n        Else\n            DoCmd.OpenForm \"frm2_Member Class Registration\"\n        End If\n    Else\n        MsgBox \"Login Failed\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9727816"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 50133732, "answer_count": 2, "score": 1, "last_activity_date": 1525264159, "creation_date": 1525255981, "last_edit_date": 1525256427, "question_id": 50132116, "link": "https://stackoverflow.com/questions/50132116/microsoft-access-vba-combine-text-values-by-using-an-expression", "title": "Microsoft Access VBA: Combine text values by using an expression", "body": "<p>Hi I have built a login form for both trainers and members, they can both login into one form. However I would like to make sure when either the trainer or the member logs in, the message box pops up and should say. \"Welcome =[FirstName] &amp; \" \" &amp; [LastName]\". So basically after welcome the members or the trainers fullname is displayed. </p>\n\n<p>Can someone please help me out, would really appreciate it, Thanks. My code is shown below.</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Command9_Click()\n\n    Dim isTrainer As Boolean, isMember As Boolean\n\n    isTrainer = DCount(\"TrainerFirstName\", \"tbl4_Trainers\", _\n                 \"TrainerEmail = [txtEmail] And TrainerPassword = [txtPassword] \") &gt; 0\n    isMember = DCount(\"MemberFirstName\", \"tbl1_Members\", _\n                 \"MemberEmail = [txtEmail] And MemberPassword = [txtPassword] \") &gt; 0\n\n    If isTrainer Or isMember Then\n        MsgBox (\"Welcome &amp; = [TrainerFirstName] &amp; \" \" &amp; [TrainerLastName] or = [MemberFirstName] &amp; \" \" &amp; [MemberLastName] \")\n        DoCmd.Close acForm, \"frm1_Member &amp; Trainer Login\"\n        If isTrainer Then\n            DoCmd.OpenForm \"frm3_Main Menu\"\n        Else\n            DoCmd.OpenForm \"frm2_Member Class Registration\"\n        End If\n\n    Else\n        MsgBox (\"Login Failed\")\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "move"], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 9616872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1b0d8abc237debcd8f6480e352cf25?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Sampson", "link": "https://stackoverflow.com/users/9616872/chris-sampson"}, "is_accepted": false, "score": 0, "last_activity_date": 1525282452, "creation_date": 1525282452, "answer_id": 50140455, "question_id": 50132073, "link": "https://stackoverflow.com/questions/50132073/how-to-copy-the-header-row-from-initial-sheet-into-newly-create-sheets/50140455#50140455", "title": "How to copy the header row from initial sheet into newly create sheets", "body": "<p>At the start of the sub I'd set a named range covering the overview headers and then in the else section copy that range to the required destination e.g </p>\n\n<p>...\nDim SheetName As String\nDim headings as range </p>\n\n<p>Set headings = Worksheets(\"Overview\").range(A1:G1)</p>\n\n<p>then in else part change the </p>\n\n<p>headings.copy Destination: = </p>\n\n<p>But to do this you'll need to change the point you are inserting the data to leave a blank row for the headers </p>\n"}], "owner": {"reputation": 23, "user_id": 4050693, "user_type": "registered", "profile_image": "https://graph.facebook.com/629930685/picture?type=large", "display_name": "Mark Larigo", "link": "https://stackoverflow.com/users/4050693/mark-larigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525282452, "creation_date": 1525255828, "question_id": 50132073, "link": "https://stackoverflow.com/questions/50132073/how-to-copy-the-header-row-from-initial-sheet-into-newly-create-sheets", "title": "How to copy the header row from initial sheet into newly create sheets", "body": "<p>Hi I have used this code to copy data from my overview sheet into current sheets or if the sheet does not exist to create it.  However I am struggling to work out how to add a line or two in the else bit to copy the header row (A1 - G1) from overview into the new sheets also.</p>\n\n<pre><code>Sub CopyRows()\n\nDim rngMyRange As Range, rngCell As Range\nDim sht As Worksheet\nDim LastRow As Long\nDim SheetName As String\n\n\n\nWith Worksheets(\"Overview\")\nSet rngMyRange = .Range(.Range(\"D2\"), .Range(\"D65536\").End(xlUp))\n\nFor Each rngCell In rngMyRange\n\n    rngCell.EntireRow.Select\n\n    Selection.Copy\n\n    If (WorksheetExists(rngCell.Value)) Then\n        SheetName = rngCell.Value\n        Sheets(SheetName).Select\n        Set sht = ThisWorkbook.Worksheets(SheetName)\n        LastRow = sht.Cells(sht.Rows.Count, \"D\").End(xlUp).Row\n        Rows(LastRow + 1).Select\n        Selection.Insert Shift:=xlDown\n    Else\n        Sheets.Add After:=ActiveSheet\n        Rows(\"1:1\").Select\n        Selection.Insert Shift:=xlDown\n        ActiveSheet.Name = rngCell.Value\n     Sub copyheadernames()\n\n   End Sub\n   End If\n    'Go back to the DATA sheet\n    Sheets(\"Overview\").Select\n    Next\n\nEnd With\n\nEnd Sub\n\nFunction WorksheetExists(sName As String) As Boolean\nWorksheetExists = Evaluate(\"ISREF('\" &amp; sName &amp; \"'!A1)\")\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "eval"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1525255843, "post_id": 50132024, "comment_id": 87281960, "body": "@SMeaden - but with a different behaviour - see the updated question."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525256019, "post_id": 50132024, "comment_id": 87282068, "body": "I&#39;m not sure what you&#39;re asking. If that last formulation doesn&#39;t work it doesn&#39;t work. Given that you have alternatives what are you hoping to find out?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1525256052, "post_id": 50132024, "comment_id": 87282089, "body": "@SJR - trying to find out why it does not work and how to make it work."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1525256121, "post_id": 50132024, "comment_id": 87282124, "body": "Don&#39;t think you can, they&#39;re not quite the same from what I get at the bottom of this: <a href=\"https://msdn.microsoft.com/en-us/library/office/aa223886(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1525256340, "post_id": 50132024, "comment_id": 87282256, "body": "Read further down, it describes the difference (advantage) of each way <i>The advantage of using square brackets is that the code is shorter. The advantage of using Evaluate is that the argument is a string, so you can either construct the string in your code or use a Visual Basic variable.</i> which sort of implies that a string straight in to <code>[]</code> is not the same./"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1525256504, "post_id": 50132024, "comment_id": 87282368, "body": "When using the [] shortcut to Evaluate you cannot build the expression from a string, as your tests demonstrate.   You enter the expression exactly as you would in a cell (minus the =).  To build an expression as a string you must use Application or Worksheett.Evaluate"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1525256538, "post_id": 50132024, "comment_id": 87282387, "body": "Square brackets and Evaluate are not identical as using a string variable <code>[s]</code> works but <code>Evaluate(s)</code> doesn&#39;t."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525257139, "post_id": 50132024, "comment_id": 87282816, "body": "@SJR - I think I am missing your point - <code>[s]</code> is exactly what does not work and <code>Evaluate(s)</code> works for me, when testing. - <a href=\"https://gist.github.com/Vitosh/73a5fd7099e47f4fbd22162de9070c83\" rel=\"nofollow noreferrer\">gist.github.com/Vitosh/73a5fd7099e47f4fbd22162de9070c83</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1525257440, "post_id": 50132024, "comment_id": 87283035, "body": "Funny, behaviour in the immediate window seems different to a module. If you declare a variable as string s=&quot;Fred&quot;, both [s] and Evaluate(s) return error in the immediate window. In a module, the latter errors."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1525266764, "post_id": 50132024, "comment_id": 87289004, "body": "Interestingly <code>inputString = &quot;20&quot; * &quot;300&quot;</code> returns the correct result with [] for evaluation. Anyone know if the <code>+</code> operator is overloaded for addition and string concatenation in Evaluate?"}], "answers": [{"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1525346481, "post_id": 50132475, "comment_id": 87325050, "body": "I have deleted my answer to get behind this answer.  It very definitely is a string argument.  I have demonstrated this is this blog post <a href=\"http://exceldevelopmentplatform.blogspot.com/2018/05/vba-com-dispid-5-gives-vba-square.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/05/&hellip;</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1525430451, "post_id": 50132475, "comment_id": 87362976, "body": "@SMeaden - I guess that we are not going to get the source of the two <code>Evaluate</code> procedures, thus this looks like an acceptable answer."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1525553317, "post_id": 50132475, "comment_id": 87404956, "body": "@Vityata: I think I may have given you a wrong turn with the dual Evaluate, it was just an interesting thing I found in the type libraries that makes square brackets work.  Incidentally, if you want an expression engine then assigning the expression to a cell&#39;s formula works quite well.  C# programmers have no equivalent expression evaluator as Excel&#39;s cell parser."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1525632775, "post_id": 50132475, "comment_id": 87423637, "body": "@SMeaden - something like this (the wrong turn). I thought that the two <code>Evaluate</code> are concerning the <code>[]</code> and the <code>Evaluate</code>."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1525640483, "post_id": 50132475, "comment_id": 87425955, "body": "@Vityata: I actually think the square brackets contents being treated as a string can be a feature.  Some source fragment of other technologies can be inserted into VBA without having to double-up double quotes, <a href=\"http://exceldevelopmentplatform.blogspot.com/2018/05/vba-use-square-brackets-trick-to.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/05/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": true, "score": 2, "last_activity_date": 1525257265, "last_edit_date": 1525257265, "creation_date": 1525257127, "answer_id": 50132475, "question_id": 50132024, "link": "https://stackoverflow.com/questions/50132024/how-to-use-square-brackets-for-a-string-evaluation-in-vba/50132475#50132475", "title": "How to use square brackets for a string evaluation in VBA?", "body": "<p>From <a href=\"https://msdn.microsoft.com/en-us/library/office/aa223886(v=office.11).aspx\" rel=\"nofollow noreferrer\">the link in the comment</a>: \"Using square brackets (for example, \"[A1:C5]\") is identical to calling the Evaluate method with a string argument.\"</p>\n\n<p>I read that to mean:</p>\n\n<p><code>Evaluate(\"20+10\")</code> is equivalent to <code>[20+10]</code> where the Evaluate function takes the string and converts to a literal interpretation before evaluating.</p>\n\n<p>but <code>[\"20+10\"]</code> is just equivalent to evaluating a string <code>\"20+10\"</code></p>\n\n<p>The reason <code>Debug.Print [\"20\"+\"300\"]</code> works is because VBA is great at auto-converting \"20\" to 20.</p>\n"}], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1782, "favorite_count": 2, "accepted_answer_id": 50132475, "answer_count": 1, "score": 5, "last_activity_date": 1525283883, "creation_date": 1525255656, "last_edit_date": 1531164843, "question_id": 50132024, "link": "https://stackoverflow.com/questions/50132024/how-to-use-square-brackets-for-a-string-evaluation-in-vba", "title": "How to use square brackets for a string evaluation in VBA?", "body": "<p>Using square brackets for string evaluation, I am trying to make <code>[inputString]</code> return <code>320</code>. \nAny ideas how to do it?</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim inputString As String\n    inputString = \"20+300\"\n    Debug.Print Application.Evaluate(inputString)   'ok\n    Debug.Print Evaluate([inputString])             'ok\n    Debug.Print [20+300]                            'ok\n    Debug.Print [\"20\"+\"300\"]                        'ok\n    Debug.Print [\"20\"+300]                          'ok\n    Debug.Print [inputString]                       'returns \"20+300\" and not 320\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "web", "web-scraping"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1525255371, "post_id": 50131796, "comment_id": 87281640, "body": "Setting the focus on a control prior to clicking helps."}, {"owner": {"reputation": 65, "user_id": 4127490, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001522278401/picture?type=large", "display_name": "Arran Pritchard", "link": "https://stackoverflow.com/users/4127490/arran-pritchard"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1525263917, "post_id": 50131796, "comment_id": 87287077, "body": "Thank you, that worked !! HTMLDoc.getElementById(&quot;element name&quot;).Focus"}], "owner": {"reputation": 65, "user_id": 4127490, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001522278401/picture?type=large", "display_name": "Arran Pritchard", "link": "https://stackoverflow.com/users/4127490/arran-pritchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525257253, "creation_date": 1525255005, "last_edit_date": 1525257253, "question_id": 50131796, "link": "https://stackoverflow.com/questions/50131796/web-page-scraping-automatic-login-vb", "title": "web page scraping automatic login vb", "body": "<p>The following vb code tries to login to a website :</p>\n\n<pre><code>Dim IE As New SHDocVw.InternetExplorer\nDim HTMLDoc As MSHTML.HTMLDocument\nDim HTMLElement As MSHTML.IHTMLElement\n\nIE.Visible = True\n\nIE.navigate (\"https://www.website.com/login\")\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE: Loop\nSet HTMLDoc = IE.Document\n\nHTMLDoc.all(\"loginForm-email\").Value = \"email@address.com\"\nHTMLDoc.all(\"loginForm-password\").Value = \"password\"\nHTMLDoc.all(\"loginForm-submit\").Click\n</code></pre>\n\n<p>The emails address and password display correctly on the web page, however when pressing the login button, it errors as if there is no data entered, this is because there is some validation that it is not getting triggered by the vb script.</p>\n\n<p>I noticed the attributes of some \"IHTMLElement\" are set by default to :</p>\n\n<pre><code>\"has-feedback form-group has-error pristine untouched ember-view\"\n</code></pre>\n\n<p>... and are changed, when entering the email &amp; password manually, to :</p>\n\n<pre><code>\"has-feedback form-group has-success pristine touched ember-view\"\n</code></pre>\n\n<p>.... but are not changed by the vb script above ?</p>\n\n<p>Any ideas, are most welcome.  </p>\n"}, {"tags": ["vba", "button", "passwords", "private"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1525254665, "post_id": 50131234, "comment_id": 87281160, "body": "What do you mean <i>&quot;<b>won&#39;t run</b>&quot;?</i>  ...so that another section of code won&#39;t call them, or are you trying to prevent users from going into the VBA and running them manually?  If this is a security issue then I should warn you, there&#39;s no such thing as a 100% secure shared Office document; only ways to make it harder for people to do what they want."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9729459, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212471820215312/picture?type=large", "display_name": "Ryan Mao", "link": "https://stackoverflow.com/users/9729459/ryan-mao"}, "edited": false, "score": 1, "creation_date": 1525470128, "post_id": 50134035, "comment_id": 87384291, "body": "Thank you, this works exactly as you described.  One question, once I set the password and exit sub kicks in is there a way to reverse the command?  I tried to create a second command button with a different password to flip override = true, but then my original code doesn&#39;t run.  Thanks again!"}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "reply_to_user": {"reputation": 1, "user_id": 9729459, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212471820215312/picture?type=large", "display_name": "Ryan Mao", "link": "https://stackoverflow.com/users/9729459/ryan-mao"}, "edited": false, "score": 0, "creation_date": 1525515991, "post_id": 50134035, "comment_id": 87393478, "body": "I&#39;m glad it helped!   In your code for the check boxes, add <code>Else</code> to the end of <code>If override = False Then Exit Sub</code>.   For your second command button, copy the exact code for the first command button and change <code>override = False</code> to <code>override = True</code>. If you want a different password for the second button that shouldn&#39;t be an issue at all. Just remember which password is for which button.  If it&#39;s answered your question, be sure to mark the answer as accepted to help other community members if they have the same question."}], "tags": [], "owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "is_accepted": false, "score": 0, "last_activity_date": 1525437890, "last_edit_date": 1525437890, "creation_date": 1525261912, "answer_id": 50134035, "question_id": 50131234, "link": "https://stackoverflow.com/questions/50131234/how-to-stop-a-private-sub-from-running-with-a-password/50134035#50134035", "title": "How to stop a private sub from running with a password", "body": "<p>To 'override' the <code>Private Sub</code> for your check boxes, you could do the following:</p>\n\n<p>In your VBE, create a Module (if you don't already have one) and enter <code>Public override As Boolean</code> on the first line. </p>\n\n<p>For each of your Private Subs for the Check Boxes, add the following above your current <code>If</code> statement: <code>If override = False Then Exit Sub</code> like so: </p>\n\n<pre><code>Private Sub CRM_box_Click()\n\n    If override = False Then Exit Sub\n\n    If CRM_box.Value = True Then\n        RMP_box.Value = False\n        RMP_box.Enabled = False\n    Else\n        RMP_box.Value = False\n        RMP_box.Enabled = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>For the password part of your question you could create a <code>UserForm</code>. </p>\n\n<p>If you're not firmiliar with UserForms, there are a lot of tutorials and instructions on how to create them by searching something like \"How to create a userform in excel\" in Google or equivalent.</p>\n\n<p>I made a simple <code>UserForm</code> with a <code>label</code>, <code>textbox</code> and <code>commandbutton</code>. <a href=\"https://i.stack.imgur.com/3pkFR.png\" rel=\"nofollow noreferrer\">See here.</a></p>\n\n<p>For the <code>commandbutton</code>, you could use the following code: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim pwrd As String\n    Dim setPwrd As String\n\n    pwrd = UserForm1.TextBox1.Text\n    setPwrd = \"abc\" 'Change this string to whatever you want your password to be\n\n        If pwrd = setPwrd Then\n            override = False\n            Unload UserForm1\n        Else\n            MsgBox \"Incorrect Password\" &amp; vbNewLine &amp; \"Please try again.\", vbCritical\n        End If\n    End Sub\n</code></pre>\n\n<p>When you enter your password into the textbox and click the commandbutton, the vba compares your input with the variable <code>setPassword</code>. If it's a match it set's the Public variable <code>override</code> to <code>False</code>. If the password doesn't match you get a message to try again. </p>\n\n<p>If <code>override = False</code> it directs your <code>Private Sub</code> for your check boxes to <code>Exit Sub</code> before executing the code - Your code is 'overridden'.</p>\n\n<p>In summary: </p>\n\n<ol>\n<li>Declare a Public Variable as a Boolean.</li>\n<li>Set an If statement in each Private Sub for your check boxes.</li>\n<li>Create a UserForm to enter a Password.</li>\n<li>Write the code to set a password and for what happens when you submit your password.</li>\n</ol>\n\n<p>You may find <a href=\"https://stackoverflow.com/a/50166285/9663006\">this answer</a> helpful in understanding ways you can prevent other users from getting around your password form. </p>\n"}], "owner": {"reputation": 1, "user_id": 9729459, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212471820215312/picture?type=large", "display_name": "Ryan Mao", "link": "https://stackoverflow.com/users/9729459/ryan-mao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525437890, "creation_date": 1525253229, "question_id": 50131234, "link": "https://stackoverflow.com/questions/50131234/how-to-stop-a-private-sub-from-running-with-a-password", "title": "How to stop a private sub from running with a password", "body": "<p>I have two private subs for active x check boxes. When I click one button another button is locked. I want to create a button that would act as an override, where if I type a password then the two private subs won't run.</p>\n\n<pre><code>Private Sub CRM_box_Click()\nIf CRM_box.Value = True Then\n    CheckBox14.Value = False\n    CheckBox14.Enabled = False\nElse\n    CheckBox14.Value = False\n    CheckBox14.Enabled = True\nEnd If\n\nPrivate Sub RMP_box_Click()\nIf RMP_box.Value = True Then\n    CRM_box.Value = False\n    CRM_box.Enabled = False\nElse\n    CRM_box.Value = False\n    CRM_box.Enabled = True\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1525250549, "creation_date": 1525250549, "answer_id": 50130490, "question_id": 50130327, "link": "https://stackoverflow.com/questions/50130327/vba-to-include-check-boxes-into-userform-that-gets-checked-unchecked-depending-o/50130490#50130490", "title": "VBA to Include Check Boxes into Userform that gets checked/unchecked depending on table value", "body": "<ol>\n<li>Add a checkbox.</li>\n<li>Then check the cell for the value. In my example it is <code>Cells(1,1)</code>:</li>\n<li>Write this:</li>\n</ol>\n\n<p><code>CheckBox1.Value = CBool(Cells(1, 1))</code></p>\n"}], "owner": {"reputation": 239, "user_id": 8150532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89dec06313f6bbc60ebe2f35b6fd0608?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8150532/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525250549, "creation_date": 1525250043, "question_id": 50130327, "link": "https://stackoverflow.com/questions/50130327/vba-to-include-check-boxes-into-userform-that-gets-checked-unchecked-depending-o", "title": "VBA to Include Check Boxes into Userform that gets checked/unchecked depending on table value", "body": "<p><strong>The request: Include a check box in my userform that gets checked/unchecked depending on True/False value in column of table</strong></p>\n\n<p><strong>Current state</strong>:</p>\n\n<p>I have a user form that is used to add edit or delete entries in a table.\nSpecifically the editing works in a way that I have a combo box that corresponds with the mail addresses in column A and text boxes for each column of the table.</p>\n\n<p>When you select a mail address in the combo box the text boxes of the user form get filled in with the data from that row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4wV7A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4wV7A.png\" alt=\"enter image description here\"></a></p>\n\n<p>For the example I would like to add a <strong>check box</strong> that says <strong>\"married\"</strong> and corresponds to a column in the table that has \"True\" or \"False\" values. This check box should now be checked/unchecked automatically depending on the value in the corresponding column.</p>\n\n<p><strong>My code:</strong></p>\n\n<pre><code>Private Sub c_01_Change()\n\n' c_01 is the combo box\n   With c_01\n   ' B_02 is the delete button\n   ' B_03 is the save button\n        B_02.Visible = .ListIndex &gt; -1\n        B_03.Visible = True\n        If .ListIndex = -1 Then Exit Sub\n\n        ' T_0X are the text boxes\n        For j = 0 To UBound(.List, 2)\n            Me(\"T_\" &amp; Format(j, \"00\")).Text = .Column(j)\n            Me(\"T_\" &amp; Format(j, \"00\")).Locked = False\n            If j &gt; 2 Then Me(\"T_\" &amp; Format(j, \"00\")).Text = Format(.Column(j), \"0.00\")\n        Next\n    End With\nEnd Sub\n\nPrivate Sub T_00_Change()\n    M_text 0\n    B_02.Visible = T_00.Text &lt;&gt; \"\"\nEnd Sub\nPrivate Sub T_01_Change()\n    M_text 1\nEnd Sub\nPrivate Sub T_02_Change()\n    M_text 2\nEnd Sub\nPrivate Sub T_03_Change()\n    M_text 3\nEnd Sub\nPrivate Sub T_04_Change()\n    M_text 4\nEnd Sub\nSub M_text(y)\n    If c_01.ListIndex &gt; -1 Then c_01.Column(y) = Me(\"T_\" &amp; Format(y, \"00\")).Text\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525251298, "post_id": 50130108, "comment_id": 87279073, "body": "So each tab in other workbook has one name from the list in column B of sheet (?) of ThisWorkbook in it and when you find a match you want to name the sheet after that match?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1525252860, "post_id": 50130108, "comment_id": 87279971, "body": "Reading between the lines (because I&#39;m not clear as to what it is that you are asking for) and if your question is what @QHarr has outlined, it seems a simple <code>For Each</code> loop with <code>.UsedRange</code> combination should resolve the issue.. but lets see what your response is to QHarr&#39;s question"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1525254991, "post_id": 50130108, "comment_id": 87281379, "body": "You&#39;ve got your <code>i</code> variable used as a row counter and a sheet counter at the same time - try using separate variables for each - the basic code is correct but you&#39;re not going to find row1 name on sheet1 for definite!"}, {"owner": {"reputation": 27, "user_id": 9729158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2454eda4eb3eb463ecc60f55d4396bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Dipanshu", "link": "https://stackoverflow.com/users/9729158/dipanshu"}, "edited": false, "score": 0, "creation_date": 1525256476, "post_id": 50130108, "comment_id": 87282349, "body": "yes i want to do same thing said by QHarr"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525256819, "post_id": 50130108, "comment_id": 87282588, "body": "If each entry in column B is in one of the sheets it might be quicker to loop through the sheets and search for each value in the list. Even quicker if it&#39;s the only cell with a value in the whole sheet."}, {"owner": {"reputation": 27, "user_id": 9729158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2454eda4eb3eb463ecc60f55d4396bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Dipanshu", "link": "https://stackoverflow.com/users/9729158/dipanshu"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525256963, "post_id": 50130108, "comment_id": 87282686, "body": "no other cells also have some values in it @SJR"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525257019, "post_id": 50130108, "comment_id": 87282740, "body": "Are you saying that e.g. sheet2 has a cell containing &quot;arjun&quot; and every other cell is blank?"}, {"owner": {"reputation": 27, "user_id": 9729158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2454eda4eb3eb463ecc60f55d4396bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Dipanshu", "link": "https://stackoverflow.com/users/9729158/dipanshu"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1525257070, "post_id": 50130108, "comment_id": 87282766, "body": "i have changed the variable for row counter as well as for column counter but still i am getting the run time error &#39;91&#39;. i am getting the error in find part of the code @jamheadart"}, {"owner": {"reputation": 27, "user_id": 9729158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2454eda4eb3eb463ecc60f55d4396bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Dipanshu", "link": "https://stackoverflow.com/users/9729158/dipanshu"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525257105, "post_id": 50130108, "comment_id": 87282791, "body": "other cells are not blank @SJR"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9729158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2454eda4eb3eb463ecc60f55d4396bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Dipanshu", "link": "https://stackoverflow.com/users/9729158/dipanshu"}, "edited": false, "score": 0, "creation_date": 1525258220, "post_id": 50132687, "comment_id": 87283551, "body": "can u please tell what you have done here in this line    @SJR                             ==&gt; For Each r In wb2.Sheets(1).Range(&quot;B1&quot;, wb2.Sheets(1).Range(&quot;B&quot; &amp; Rows.Count).End(xlUp))"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9729158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2454eda4eb3eb463ecc60f55d4396bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Dipanshu", "link": "https://stackoverflow.com/users/9729158/dipanshu"}, "edited": false, "score": 0, "creation_date": 1525259046, "post_id": 50132687, "comment_id": 87284061, "body": "Yes it loops through every cell in column B of your second file. The End(xlup) bit finds the last used cell by working up from the bottom of the sheet. Clear?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1525257668, "creation_date": 1525257668, "answer_id": 50132687, "question_id": 50130108, "link": "https://stackoverflow.com/questions/50130108/change-tabs-name-by-using-a-list-and-find-function-in-vba/50132687#50132687", "title": "Change Tabs name by using a list and find function in VBA", "body": "<p>Can you try this? You will get an error if trying to activate a range which does not exist so you need to first check that the value is found.</p>\n\n<pre><code>Sub change_Name_1()\n\nDim wb1 As Workbook, wb2 As Workbook, ws As Worksheet, r As Range, r1 As Range\n\nSet wb1 = Workbooks(\"Book1\") 'change names to suit\nSet wb2 = Workbooks(\"Book2\")\n\nFor Each r In wb2.Sheets(1).Range(\"B1\", wb2.Sheets(1).Range(\"B\" &amp; Rows.Count).End(xlUp))\n    For Each ws In wb1.Worksheets\n        Set r1 = ws.UsedRange.Find(What:=r, LookIn:=xlValues, LookAt:=xlWhole, _\n                                   MatchCase:=False, SearchFormat:=False)\n        If Not r1 Is Nothing Then\n            ws.Name = r\n            Exit For\n        End If\n    Next ws\nNext r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9729158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2454eda4eb3eb463ecc60f55d4396bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Dipanshu", "link": "https://stackoverflow.com/users/9729158/dipanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 50132687, "answer_count": 1, "score": 1, "last_activity_date": 1525257668, "creation_date": 1525249397, "last_edit_date": 1525251171, "question_id": 50130108, "link": "https://stackoverflow.com/questions/50130108/change-tabs-name-by-using-a-list-and-find-function-in-vba", "title": "Change Tabs name by using a list and find function in VBA", "body": "<p>I have a list of names in one workbook in column <code>b</code> and I have to change the name of tabs of a different workbook in which several tabs. </p>\n\n<p>These tabs have that name in it but not in the same place on every sheet. So, I need to find the name in the workbook by using the list, that I have in a different workbook in <code>b column</code>. </p>\n\n<p>Is there any VBA code for that because I am not able to find that particular name in the workbook by using Find in VBA.<br>\nHere is the Code which i am trying to use but not able to get the desired result</p>\n\n<pre><code>Sub change_Name_1 ()\nFor i = 1 To Application.Sheets.Count\n    Windows(\"Book2\").Activate\n    b = Range(\"B\" &amp; i).Value\n    Windows(\"Book1\").Activate\n    Sheets(i).Select\n    Cells.Find(What:=b, After:=ActiveCell, LookIn:=xlValues, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate\n    ActiveCell.Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    ActiveSheet.Select\n    ActiveSheet.Name = b\n    Next\nEnd Sub\n</code></pre>\n\n<p>Image of excel file in which I have the name</p>\n\n<p><a href=\"https://i.stack.imgur.com/mvWNB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mvWNB.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this is the second image in which name is not in particular cell of every tab</p>\n\n<p><a href=\"https://i.stack.imgur.com/yQ7nf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yQ7nf.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "web-scraping", "runtime-error", "getelementsbyclassname"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1525248729, "post_id": 50129886, "comment_id": 87277619, "body": "<code>example.com</code> does not have <code>Portugal 2 - 2 Spain</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525251081, "post_id": 50129886, "comment_id": 87278923, "body": "You should be able to return Portugal, 2-2, Spain. Is there an actual URL to share?"}, {"owner": {"reputation": 1, "user_id": 9100990, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212738067305005/picture?type=large", "display_name": "Spyros Psa", "link": "https://stackoverflow.com/users/9100990/spyros-psa"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1525251598, "post_id": 50129886, "comment_id": 87279228, "body": "@Vityata it&#39;s not the actual url. the actual url is <a href=\"http://www.stoiximan.gr/virtuals/\" rel=\"nofollow noreferrer\">stoiximan.gr/virtuals</a>"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1525267761, "post_id": 50129886, "comment_id": 87289695, "body": "I coouldn&#39;t find <code>Portugal 2 - 2 Spain</code> in that page using the url you have provided in the comment. Try to be more specific about how to populate/find that output manually @Spyros Psa. Thanks."}, {"owner": {"reputation": 1, "user_id": 9100990, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212738067305005/picture?type=large", "display_name": "Spyros Psa", "link": "https://stackoverflow.com/users/9100990/spyros-psa"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1526048817, "post_id": 50129886, "comment_id": 87605410, "body": "@SIM the the names of the team change all the time it was just an example, the struct of the url is always the same the name of the teams change and the score."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538467891, "post_id": 50129886, "comment_id": 92142870, "body": "If you show more HTML it may be that there is a parent frame/iframe to deal with or you may simply need a longer wait before trying to access."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9100990, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212738067305005/picture?type=large", "display_name": "Spyros Psa", "link": "https://stackoverflow.com/users/9100990/spyros-psa"}, "edited": false, "score": 0, "creation_date": 1526048706, "post_id": 50169356, "comment_id": 87605340, "body": "The problem is not the overwiting for the first time my code reaches the game variable it returns &quot;runtime error 91 object variable or with block variable not set&quot;"}], "tags": [], "owner": {"reputation": 70442, "user_id": 1060350, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/XCkw7.jpg?s=128&g=1", "display_name": "Has QUIT--Anony-Mousse", "link": "https://stackoverflow.com/users/1060350/has-quit-anony-mousse"}, "is_accepted": false, "score": 0, "last_activity_date": 1525418437, "creation_date": 1525418437, "answer_id": 50169356, "question_id": 50129886, "link": "https://stackoverflow.com/questions/50129886/using-getelementsbytagname-in-vba-returns-runtime-error-91-object-variable-or-wi/50169356#50169356", "title": "Using getElementsByTagName in vba returns runtime error 91 object variable or with block variable not set", "body": "<p>You <em>overwrite</em> your \"game\" variable.</p>\n\n<p>Then you lose the previous contents.</p>\n"}], "owner": {"reputation": 1, "user_id": 9100990, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212738067305005/picture?type=large", "display_name": "Spyros Psa", "link": "https://stackoverflow.com/users/9100990/spyros-psa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 412, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525418437, "creation_date": 1525248639, "last_edit_date": 1525418372, "question_id": 50129886, "link": "https://stackoverflow.com/questions/50129886/using-getelementsbytagname-in-vba-returns-runtime-error-91-object-variable-or-wi", "title": "Using getElementsByTagName in vba returns runtime error 91 object variable or with block variable not set", "body": "<p>Imagine the following HTML:</p>\n\n<pre><code>            &lt;div class=\"result-row\"&gt;\n                &lt;div class=\"row\"&gt;\n                    &lt;div class=\"col-xs-5 result-score-padding\"&gt;\n                        &lt;div class=\"result-score\" align=\"right\"&gt;Portugal&lt;/div&gt;\n                    &lt;/div&gt;\n                    &lt;div class=\"col-xs-2 result-score-padding\" align=\"center\"&gt;\n                        &lt;div class=\"result-score\"&gt;2 - 2&lt;/div&gt;\n                    &lt;/div&gt;\n                    &lt;div class=\"col-xs-5 result-score-padding\"&gt;\n                        &lt;div class=\"result-score\"&gt;Spain&lt;/div&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n</code></pre>\n\n<p>In the code below, i'm using getElementsByClassName in VBA to get innerText from elements:</p>\n\n<pre><code>Dim IE As New InternetExplorer\nDim doc As HTMLDocument\nDim i As Integer\nDim game As String\n\nIE.navigate \"https://www.example.com\"\nWhile IE.Busy Or IE.ReadyState &lt;&gt; 4: DoEvents: Wend\nSet doc = IE.document\nFor i=0 To 2\n    game = Trim(doc.getElementsByClassName(\"result-score\")(i).innerText)\nNext i\n</code></pre>\n\n<p>However, this code doesn't return the desired outcome as it returns runtime error 91 object variable or with block variable not set</p>\n\n<p>I want to extract \"Portugal 2 - 2 Spain\"</p>\n\n<p>The url is <a href=\"http://www.stoiximan.gr/virtuals/\" rel=\"nofollow noreferrer\">http://www.stoiximan.gr/virtuals/</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "edited": false, "score": 0, "creation_date": 1525249165, "post_id": 50129620, "comment_id": 87277844, "body": "Thanks mate.. it worked great.. I had a wrong belief that Application.Intersect returns bool type. But its Range itself.. isnt it?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "edited": false, "score": 0, "creation_date": 1525249392, "post_id": 50129620, "comment_id": 87277985, "body": "@SandeepThomas  yep, it returns a Range object"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1525247635, "creation_date": 1525247635, "answer_id": 50129620, "question_id": 50129577, "link": "https://stackoverflow.com/questions/50129577/check-whether-a-changed-cell-in-a-named-range-excel-vba/50129620#50129620", "title": "Check whether a changed cell in a named range excel vba", "body": "<p>With slight modification, use the code below:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Application.Intersect(Target, Range(\"bd_main\")) Is Nothing Then\n        MsgBox \"change\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "accepted_answer_id": 50129620, "answer_count": 1, "score": 0, "last_activity_date": 1525247720, "creation_date": 1525247491, "last_edit_date": 1525247720, "question_id": 50129577, "link": "https://stackoverflow.com/questions/50129577/check-whether-a-changed-cell-in-a-named-range-excel-vba", "title": "Check whether a changed cell in a named range excel vba", "body": "<p>I just need to monitor changes in a worksheet, not in the whole worksheet, just inside a named range. So if any kind of change occurs in any cell it should check the change occurs in that named range and if so some function has to do.</p>\n\n<p><strong>Here is my code</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim ir As Boolean\n\n    ir = Application.Intersect(Target.Address, Range(\"bd_main\"))\n    If ir = True Then\n        MsgBox \"change\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>But it triggers an error saying <code>Type Mismatch</code> in the <code>Application.Intersect</code> function for <code>Target.Address</code></p>\n\n<p>What I did wrong there which causes such error.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 2, "creation_date": 1525248111, "post_id": 50129416, "comment_id": 87277269, "body": "What happens if you replace <code>Workbooks(FileName).Sheets(&quot;Sheety&quot;).Delete</code> with <code>myWorkbook.Sheets(&quot;Sheety&quot;).Delete</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1525251258, "post_id": 50129916, "comment_id": 87279047, "body": "<i>However the rest of the macro can still use Workbooks(Filename) without the &quot;AppExcel.&quot; Reference</i> -- even if it seems to work, you should never do this. It can lead to strange behavior (as you have seen), or Excel processes not closing down if you do <code>appExcel.Quit</code>"}], "tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": true, "score": 0, "last_activity_date": 1525248763, "creation_date": 1525248763, "answer_id": 50129916, "question_id": 50129416, "link": "https://stackoverflow.com/questions/50129416/display-alerts-in-excel-from-access/50129916#50129916", "title": "Display Alerts in Excel from Access", "body": "<p>Thanks To Sam's Comment: </p>\n\n<p>it works either by changing </p>\n\n<pre><code>Workbooks(FileName).Sheets(\"Sheety\").Delete\n</code></pre>\n\n<p>into </p>\n\n<pre><code>myWorkbook.Sheets(\"Sheety\").Delete\n</code></pre>\n\n<p>or </p>\n\n<pre><code>AppExcel.Workbooks(FileName).Sheets(\"Sheety\").Delete\n</code></pre>\n\n<p>However the rest of the macro can still use Workbooks(Filename) without the \"AppExcel.\" Reference</p>\n"}], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 50129916, "answer_count": 1, "score": 0, "last_activity_date": 1525248763, "creation_date": 1525246871, "last_edit_date": 1525247479, "question_id": 50129416, "link": "https://stackoverflow.com/questions/50129416/display-alerts-in-excel-from-access", "title": "Display Alerts in Excel from Access", "body": "<p>I am opening an excel workbook from excel and delete a sheet inside. I want to do this without the message from Excel:<br>\n\"Excel will permanently delete this sheet, do you want to continue\"<br>\nHowever I cannot make the \"DisplayAlerts = False\" work correctly. </p>\n\n<pre><code>Public Sub xportQuery()\n\nDim appExcel As Excel.Application\nDim myWorkbook As Excel.Workbook\n\nDim PathDaily, FileName As String\nPathDaily = Forms!Menu!Text69\nFileName = Forms!Menu!Text84\n\nSet appExcel = CreateObject(\"Excel.Application\")\n\nSet myWorkbook = appExcel.Workbooks.Open(PathDaily &amp; FileName)\nappExcel.Visible = True\n'Set appExcel = Nothing\nSet myWorkbook = Nothing\n\nappExcel.DisplayAlerts = False\nWorkbooks(FileName).Sheets(\"Sheety\").Delete\nappExcel.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Writing it this way I get a \"Subscript out of range\" on the <code>Sheets(\"Sheety\").delete</code>\nIf I take of the two DisplayAlerts lines, the code works but with the alert.</p>\n\n<p>How do I write my code correctly to work without any alert message?</p>\n\n<p>Note: DoCmd.SetWarnings didn t work either as the message is displayed in Excel</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1525248711, "post_id": 50129286, "comment_id": 87277608, "body": "With <i>scheduled task</i> you mean the Windows scheduler? Does the task runs as System or as Regular user (as far as I know, Office cannot run as System)? Is Access started at all? Write a logfile to see what is happening, see for example <a href=\"https://stackoverflow.com/a/22663810/7599798\">stackoverflow.com/a/22663810/7599798</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1525257468, "post_id": 50129286, "comment_id": 87283062, "body": "Works for me. Post your code."}, {"owner": {"reputation": 1, "user_id": 9476642, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AuDev", "link": "https://stackoverflow.com/users/9476642/audev"}, "edited": false, "score": 0, "creation_date": 1525307431, "post_id": 50129286, "comment_id": 87308713, "body": "Yes windows scheduled task. Yes access does start. From logging can see that it fails on the graphExp.Export &quot;C:\\Images\\Graph11.jpg&quot;, &quot;jpeg&quot; Does not get past this"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1525259285, "creation_date": 1525259285, "answer_id": 50133191, "question_id": 50129286, "link": "https://stackoverflow.com/questions/50129286/save-graph-image-from-ms-access-when-run-as-scheduled-task/50133191#50133191", "title": "Save graph image from ms access when run as scheduled task", "body": "<p>My code behind form to export graph from form:</p>\n\n<pre><code>Dim graphExp As Object\nSet graphExp = Me.Graph11\ngraphExp.Export \"C:\\Images\\Graph11.jpg\", \"jpeg\"\n</code></pre>\n\n<p>Code is in Open event of form set to open by default when db opens. Then VBScript opens the db. Alternately, modify code for a general module (including opening the form) and VBScript can call that procedure.</p>\n\n<pre><code>accessApp.OpenCurrentDataBase \"yourpath\\yourdb.accdb\"\naccessApp.Run \"Test\"\naccessApp.Quit\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9476642, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AuDev", "link": "https://stackoverflow.com/users/9476642/audev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525259285, "creation_date": 1525246362, "question_id": 50129286, "link": "https://stackoverflow.com/questions/50129286/save-graph-image-from-ms-access-when-run-as-scheduled-task", "title": "Save graph image from ms access when run as scheduled task", "body": "<p>Can anyone help as to how to save a graph in a ms access form / report as an image, WHEN running it from a scheduled task?\nNo problem to do when running access from explorer as normal, and no problem to run access from a scheduled task, but have not been able to do both.</p>\n\n<p>For saving charts as image see <a href=\"https://stackoverflow.com/questions/1262698/exporting-charts-of-access-to-image-format\">Exporting Charts of Access to Image Format?</a>\nThis side of it is working fine, but when running as scheduled task it is not exported. (No issues with running other code when started from task schedule)</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1525248613, "post_id": 50129178, "comment_id": 87277559, "body": "First thing that I can see is that <code>Dim Line As Integer</code> this should be declared as Long, as there are more cells in excel than an Integer can handle."}, {"owner": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1525251020, "post_id": 50129178, "comment_id": 87278893, "body": "Thank you for your answer! I still get the message: &quot;Incompatible types&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1525251095, "post_id": 50129941, "comment_id": 87278932, "body": "Thank you for your answer, like mentioned in my comment above, I still get the message:&quot;incompatible types&quot;."}, {"owner": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1525251290, "post_id": 50129941, "comment_id": 87279068, "body": "The debugger highlights the line: Print #1, Join(Application.Transpose(Application.Transpose(.Range(.Cel&zwnj;&#8203;ls(Line.. When I point at &quot;Line&quot; with my cursor it shows me Line = 78."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1525252036, "post_id": 50129941, "comment_id": 87279468, "body": "@Marius, I get no such error when testing, what kind of data do you have on Row 78?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1525253452, "post_id": 50129941, "comment_id": 87280326, "body": "Might be worth adding a sample of your worksheet in your question.. specially what you have on line 78"}, {"owner": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1525256551, "post_id": 50129941, "comment_id": 87282400, "body": "The line is empty, so I added: &quot;On Error resume next&quot;. Now it works! Thanks!"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "edited": false, "score": 0, "creation_date": 1525257539, "post_id": 50129941, "comment_id": 87283115, "body": "@Marius, I&#39;ve updated my answer to reflect your comments, instead of using On Error Resume Next, I&#39;ve added a couple of lines to check if the Last Column is 1 and whether that cell is empty or not before continuing."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1525257483, "last_edit_date": 1525257483, "creation_date": 1525248857, "answer_id": 50129941, "question_id": 50129178, "link": "https://stackoverflow.com/questions/50129178/iterate-over-whole-excel-file/50129941#50129941", "title": "Iterate over whole Excel File", "body": "<p>Try the following, I believe it should work, there's no need to activate the worksheet before protecting it, so I removed that line, changed the declaration from Integer to Long, and changed the Exit Sub to End Sub at the end:</p>\n\n<pre><code>Sub Rechteck1_KlickenSieAuf()\nDim Zieldatei As String\nDim Line As Long\n'protect file\nThisWorkbook.Worksheets(1).Protect\n\n'Create desired file\nZieldatei = Application.GetSaveAsFilename(FileFilter:=\"AVL (*.rtf), *.rtf\", InitialFileName:=\"AVL.rtf\")\n\n'Open desired file\nOpen Zieldatei For Output As #1\n\n    With ThisWorkbook.Worksheets(1)\n        For Line = 1 To .Cells(.Rows.Count, 1).End(xlUp).Row\n            'Write Read-In Data into target data\n            Print #1, Join(Application.Transpose(Application.Transpose(.Range(.Cells(Line, 1), .Cells(Line, .Columns.Count).End(xlToLeft)).Value)), \"|\")\n        Next\n    End With\n\nClose #1\n\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Instead of using Or Error Resume Next, you could check to see how many columns in the given row, and check if only one column if it has any data in it, before going to the next line, like below:</p>\n\n<pre><code>Sub Rechteck1_KlickenSieAuf()\nDim Zieldatei As String\nDim Line As Long\nDim LineData As String\n'protect file\nThisWorkbook.Worksheets(1).Protect\n\n'Create desired file\nZieldatei = Application.GetSaveAsFilename(FileFilter:=\"AVL (*.rtf), *.rtf\", InitialFileName:=\"AVL.rtf\")\n\n'Open desired file\nOpen Zieldatei For Output As #1\n\n    With ThisWorkbook.Worksheets(1)\n        For Line = 1 To .Cells(.Rows.Count, 1).End(xlUp).Row\n            'Write Read-In Data into target data\n            LastCol = .Cells(Line, .Columns.Count).End(xlToLeft).Column\n            If Not LastCol = 1 And Not .Cells(Line, 1).Value = \"\" Then\n                LineData = Join(Application.Transpose(Application.Transpose(.Range(.Cells(Line, 1), .Cells(Line, .Columns.Count).End(xlToLeft)).Value)), \"|\")\n                Print #1, LineData\n            End If\n\n        Next\n    End With\n\nClose #1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8137381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d762d590cc9e1ec557a16130652c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/8137381/marius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50129941, "answer_count": 1, "score": 0, "last_activity_date": 1525257483, "creation_date": 1525245899, "last_edit_date": 1525248561, "question_id": 50129178, "link": "https://stackoverflow.com/questions/50129178/iterate-over-whole-excel-file", "title": "Iterate over whole Excel File", "body": "<p>I want to iterate over a whole excel file.</p>\n\n<pre><code>Sub Rechteck1_KlickenSieAuf()\n\nDim Zieldatei As String\nDim Line As Integer\n\n'activate and protetct file\n    ThisWorkbook.Worksheets(1).Activate\n    ActiveWorkbook.Protect\n\n    'Create desired file\n    Zieldatei = Application.GetSaveAsFilename(FileFilter:=\"AVL (*.rtf), *.rtf\", InitialFileName:=\"AVL.rtf\")\n\n    'Open desired file\n    Open Zieldatei For Output As #1\n\n     With ThisWorkbook.Worksheets(1)\n\n      For Line = 1 To .Cells(.Rows.Count, 1).End(xlUp).Row\n\n\n\n           'Write Read-In Data into target data\n            Print #1, Join(Application.Transpose(Application.Transpose(.Range(.Cells(Line, 1), .Cells(Line, .Columns.Count).End(xlToLeft)).Value)), \"|\")\n\n\n        Next\n         End With\n\n    Close #1\n\n    Exit Sub\n</code></pre>\n\n<p>This code throws the message: \"incompatible types\".\nI don't know why. I would appreciate every help.</p>\n"}, {"tags": ["vba", "ms-word", "word-2013"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525267865, "post_id": 50129110, "comment_id": 87289775, "body": "Are these pictures inserted in-line with the text or with text wrap formatting? That affects how they can be addressed via the object model (VBA), or via WordOpenXML. FWIW the default with the graphics engine introduced in Word 2013 tries to avoid using IncludePicture - a mistake, in my opinion, but apparently some people find field codes... intimidating."}, {"owner": {"reputation": 11, "user_id": 9728495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e974eca2e53a204771c9938d2678698d?s=128&d=identicon&r=PG&f=1", "display_name": "JKoh", "link": "https://stackoverflow.com/users/9728495/jkoh"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525331884, "post_id": 50129110, "comment_id": 87316033, "body": "Hi Cindy, thanks for the tip and helping out with my first post here. The pictures are with text wrapping around it."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1525365444, "creation_date": 1525365444, "answer_id": 50159979, "question_id": 50129110, "link": "https://stackoverflow.com/questions/50129110/vba-how-to-extract-filename-of-images-linked-and-inserted-word-2013/50159979#50159979", "title": "VBA(?) How to extract filename of images linked and inserted - Word 2013", "body": "<p>Graphics formatted with text wrappping fall into the <code>Shapes</code> collection. These <em>cannot</em> use <code>IncludePicture</code> to manage the link - they \"live\" in a different layer of the document than text and field codes. So the only way to access or manage this information is through the object model (VBA, for example), or through the Word Open XML.</p>\n\n<p>The object model provides the <code>LinkFormat</code> property for the <code>Shape</code> object to query and manage link information. Among other things, there are properties and methods for breaking the link, getting the file name, the file path and the complete file information.</p>\n\n<p>The following loops all <code>Shape</code> objects in the main body of the document and tests whether the type is a linked picture. If it is, the full file information is assigned to <code>sSource</code>.</p>\n\n<pre><code>Sub GetSourceFromLinkedShape()\n    Dim shp As Word.Shape\n    Dim sSource As String\n\n    For Each shp In ActiveDocument.shapes\n      If shp.Type = msoLinkedPicture Then\n        sSource = shp.LinkFormat.SourceFullName\n      End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 2, "last_activity_date": 1527513244, "creation_date": 1527513244, "answer_id": 50567347, "question_id": 50129110, "link": "https://stackoverflow.com/questions/50129110/vba-how-to-extract-filename-of-images-linked-and-inserted-word-2013/50567347#50567347", "title": "VBA(?) How to extract filename of images linked and inserted - Word 2013", "body": "<p>To get a listing of floating and inline linked pictures alike, you might use code like:</p>\n\n<pre><code>Sub Demo()\nDim Shp As Shape, iShp As InlineShape, StrOut As String\nWith ActiveDocument.Range\n  StrOut = \"Linked Shapes:\"\n  For Each Shp In .ShapeRange\n    With Shp\n      If .Type = msoLinkedPicture Then\n        StrOut = StrOut &amp; Chr(11) &amp; Split(.LinkFormat.SourceName, \".\")(0)\n      End If\n    End With\n  Next\n  If InStr(StrOut, Chr(11)) = 0 Then StrOut = StrOut &amp; \" None.\"\n  .InsertAfter vbCr &amp; StrOut\n  StrOut = \"Linked InlineShapes:\"\n  For Each iShp In .InlineShapes\n    With iShp\n      If .Type = wdInlineShapeLinkedPicture Then\n        StrOut = StrOut &amp; Chr(11) &amp; Split(.LinkFormat.SourceName, \".\")(0)\n      End If\n    End With\n  Next\n  If InStr(StrOut, Chr(11)) = 0 Then StrOut = StrOut &amp; \" None.\"\n  .InsertAfter vbCr &amp; StrOut\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Do note that the above code only searches the document body; not headers, footers, etc. The listings are output at the end of the document.</p>\n"}], "owner": {"reputation": 11, "user_id": 9728495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e974eca2e53a204771c9938d2678698d?s=128&d=identicon&r=PG&f=1", "display_name": "JKoh", "link": "https://stackoverflow.com/users/9728495/jkoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527513244, "creation_date": 1525245611, "last_edit_date": 1525267249, "question_id": 50129110, "link": "https://stackoverflow.com/questions/50129110/vba-how-to-extract-filename-of-images-linked-and-inserted-word-2013", "title": "VBA(?) How to extract filename of images linked and inserted - Word 2013", "body": "<p>We insert and link pictures (insert picture from file .emf) in our Word documents (.docx). Our documents and the graphic files are stored on our network drives. We then provide our documents to the authors to be worked on. The pictures in the documents are useful for the authors.</p>\n\n<p>How do I programmatically and globally (document wise, not batch processing documents): Extract the filename (without the file extension) of the pictures linked and inserted?</p>\n\n<p>We have a tool that exports the Word document .docx to .XML.</p>\n\n<p>Ps: I googled for possible/potential VBA solutions. So far, I gather: </p>\n\n<ol>\n<li>there\u2019s no way one can be sure / check that the pictures have been linked and inserted properly / correctly in a .docx </li>\n<li>there\u2019s no way to view the source code (? at least I tried Alt+ F9 / Shift+F9) </li>\n</ol>\n\n<p>Or is macro/ vba not the way to go?</p>\n\n<p><strong>Specs:</strong>\nWord 2013.\n64 bit\nGraphic format. Emf\nGraphic and word documents store on a network drive\nGraphics not inserted and linked via the INCLUDEPICTURE field.</p>\n"}, {"tags": ["excel", "vba", "performance", "loops"], "comments": [{"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 1, "creation_date": 1525245906, "post_id": 50128859, "comment_id": 87276167, "body": "Selecting, copying and pasting slows down the code remarkably. It is obvious that you should do this in order to duplicate a row and then change some values. How about inserting as much as cells in a seperate loop of your arrays ubound (not insert one row for each loop) , then fill in the values within another loop?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9631758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0dc42807de0f2d7780b75697fb2d53a?s=128&d=identicon&r=PG&f=1", "display_name": "Clement", "link": "https://stackoverflow.com/users/9631758/clement"}, "edited": false, "score": 0, "creation_date": 1525250427, "post_id": 50128918, "comment_id": 87278543, "body": "I tried Worksheets(&quot;mySheet&quot;).Range(&quot;A&quot; &amp; startRow &amp; &quot;:A&quot; &amp; startRow + i).Value = myArray but each cell recieve the value of myArray(0)."}, {"owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "reply_to_user": {"reputation": 13, "user_id": 9631758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0dc42807de0f2d7780b75697fb2d53a?s=128&d=identicon&r=PG&f=1", "display_name": "Clement", "link": "https://stackoverflow.com/users/9631758/clement"}, "edited": false, "score": 0, "creation_date": 1525251048, "post_id": 50128918, "comment_id": 87278906, "body": "Perhaps you should use: <code>Application.Transpose(myArray)</code>"}], "tags": [], "owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "is_accepted": false, "score": 1, "last_activity_date": 1525245935, "last_edit_date": 1525245935, "creation_date": 1525244891, "answer_id": 50128918, "question_id": 50128859, "link": "https://stackoverflow.com/questions/50128859/vba-to-write-data-in-cells-very-slow/50128918#50128918", "title": "VBA to write data in cells very slow", "body": "<p>It is quicker to assign an array to a range of cells than to assign to individual cells in a loop. You could try sometihing like: <code>Worksheets(\"MySheet\").Range(\"A1:D100\").Value = myArray</code>. It is because communication between VBA and Excel takes some time. A little bit more on that here: <a href=\"https://stackoverflow.com/questions/6134002/vba-excel-large-data-manipulation-taking-forever?noredirect=1&amp;lq=1\">VBA Excel large data manipulation taking forever</a></p>\n\n<p>Also using <code>Cells</code> instead of <code>Range</code> is aboout 2.6 times faster. Here is a question on that: <a href=\"https://stackoverflow.com/questions/36073943/range-vs-cells-run-times\">Range() VS Cells() - run times</a></p>\n"}, {"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 1, "creation_date": 1525261739, "post_id": 50131655, "comment_id": 87285815, "body": "Please edit your question instead of posting an answer."}], "tags": [], "owner": {"reputation": 13, "user_id": 9631758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0dc42807de0f2d7780b75697fb2d53a?s=128&d=identicon&r=PG&f=1", "display_name": "Clement", "link": "https://stackoverflow.com/users/9631758/clement"}, "is_accepted": false, "score": 0, "last_activity_date": 1525254592, "creation_date": 1525254592, "answer_id": 50131655, "question_id": 50128859, "link": "https://stackoverflow.com/questions/50128859/vba-to-write-data-in-cells-very-slow/50131655#50131655", "title": "VBA to write data in cells very slow", "body": "<p>I cut the script in pieces.\nThis part takes most of the time</p>\n\n<pre><code>    For j = 0 To i - 2\n    Feuil3.Cells(startRow, 5).Value = dict.Item(roomType(j))\n    Feuil3.Cells(startRow, 6).Formula = \"=IFERROR(IF($E\" &amp; startRow &amp; \"=Data!$A$55,,ROUNDUP($B\" &amp; startRow &amp; \"/VLOOKUP($E\" &amp; startRow &amp; \",Data!$A$3:$E$55,4,FALSE),0)),)\"\n    Feuil3.Cells(startRow, 8).Formula = \"=$C$25\"\n    Feuil3.Cells(startRow, 9).Formula = \"=IF($E\" &amp; startRow &amp; \"=Data!$A$55,$B\" &amp; startRow &amp; \"*$E$55,(MAX(F\" &amp; startRow &amp; \",G\" &amp; startRow &amp; \")*H\" &amp; startRow &amp; \"))\"\n    Feuil3.Cells(startRow, 14).Formula = \"=IFERROR(VLOOKUP($K\" &amp; startRow &amp; \",$M$22:$O$26,3,FALSE),)\"\n    Feuil3.Cells(startRow, 15).Formula = \"=IFERROR(IF(ISBLANK(M\" &amp; startRow &amp; \")=TRUE,L\" &amp; startRow &amp; \"*N\" &amp; startRow &amp; \",L\" &amp; startRow &amp; \"*M\" &amp; startRow &amp; \"*N\" &amp; startRow &amp; \"),)\"\n    Feuil3.Cells(startRow, 17).Formula = \"=MAX(I\" &amp; startRow &amp; \",O\" &amp; startRow &amp; \")\"\n    Feuil3.Cells(startRow, 20).Formula = \"=IFERROR(MAX(R\" &amp; startRow &amp; \",S\" &amp; startRow &amp; \")/(B\" &amp; startRow &amp; \"*C\" &amp; startRow &amp; \"),)\"\n\n    startRow = startRow + 1\nNext j\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9631758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0dc42807de0f2d7780b75697fb2d53a?s=128&d=identicon&r=PG&f=1", "display_name": "Clement", "link": "https://stackoverflow.com/users/9631758/clement"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1316, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525254592, "creation_date": 1525244647, "question_id": 50128859, "link": "https://stackoverflow.com/questions/50128859/vba-to-write-data-in-cells-very-slow", "title": "VBA to write data in cells very slow", "body": "<p>I have written a very straightforward script which writes data into excel cells.\nBasically, this is a loop over an array and it writes data into specific cells or formulas.</p>\n\n<p>The problem is that this part of the script is extremly slow.\nAny ideas on how to improve thath?</p>\n\n<p>Thanks.</p>\n\n<pre><code>    For j = 0 To i - 1\n    'Ins\u00e8re nouvelle ligne\n    Rows(startRow &amp; \":\" &amp; startRow).Select\n    Selection.Copy\n    Rows(startRow + 1 &amp; \":\" &amp; startRow + 1).Select\n    Selection.Insert Shift:=xlDown\n\n    'Ins\u00e8re donn\u00e9es\n    If roomType(j) &lt;&gt; \"\" Then\n        Feuil3.Cells(startRow, 1).Value = roomName(j)\n        Feuil3.Cells(startRow, 2).Value = roomSurface(j)\n        Feuil3.Cells(startRow, 7).Value = roomPeople(j)\n        Feuil3.Cells(startRow, 12).Value = roomPeople(j)\n        Feuil3.Cells(startRow, 5).Value = dict.Item(roomType(j))\n        Feuil3.Cells(startRow, 3).Value = roomHeight(j)\n\n        Feuil3.Range(\"F\" &amp; startRow).Formula = \"=IFERROR(IF($E\" &amp; startRow &amp; \"=Data!$A$55,,ROUNDUP($B\" &amp; startRow &amp; \"/VLOOKUP($E\" &amp; startRow &amp; \",Data!$A$3:$E$55,4,FALSE),0)),)\"\n        Feuil3.Range(\"H\" &amp; startRow).Formula = \"=$C$25\"\n        Feuil3.Range(\"I\" &amp; startRow).Formula = \"=IF($E\" &amp; startRow &amp; \"=Data!$A$55,$B\" &amp; startRow &amp; \"*$E$55,(MAX(F\" &amp; startRow &amp; \",G\" &amp; startRow &amp; \")*H\" &amp; startRow &amp; \"))\"\n        Feuil3.Range(\"N\" &amp; startRow).Formula = \"=IFERROR(VLOOKUP($K\" &amp; startRow &amp; \",$M$22:$O$26,3,FALSE),)\"\n        Feuil3.Range(\"O\" &amp; startRow).Formula = \"=IFERROR(IF(ISBLANK(M\" &amp; startRow &amp; \")=TRUE,L\" &amp; startRow &amp; \"*N\" &amp; startRow &amp; \",L\" &amp; startRow &amp; \"*M\" &amp; startRow &amp; \"*N\" &amp; startRow &amp; \"),)\"\n        Feuil3.Range(\"Q\" &amp; startRow).Formula = \"=MAX(I\" &amp; startRow &amp; \",O\" &amp; startRow &amp; \")\"\n        Feuil3.Range(\"T\" &amp; startRow).Formula = \"=IFERROR(MAX(R\" &amp; startRow &amp; \",S\" &amp; startRow &amp; \")/(B\" &amp; startRow &amp; \"*C\" &amp; startRow &amp; \"),)\"\n    End If\n\n    startRow = startRow + 1\nNext j\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["excel", "date-formatting", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "edited": false, "score": 0, "creation_date": 1525245190, "post_id": 50128832, "comment_id": 87275771, "body": "Apologies, but can&#39;t open the file : <code>Sorry, we can&#39;t open your workbook in Excel Online because it exceeds the 5 MB file size limit.</code> Can you just paste a sample format or a screenshot atleast?And what exactly is the error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "edited": false, "score": 0, "creation_date": 1525245531, "post_id": 50128832, "comment_id": 87275954, "body": "Additionally, you can also simplify <code>.Range(&quot;A2:A1048575&quot;)</code> to <code>.Range(&quot;A:A&quot;)</code>"}, {"owner": {"reputation": 25, "user_id": 9622456, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/9622456/tim"}, "edited": false, "score": 0, "creation_date": 1525346233, "post_id": 50128832, "comment_id": 87324881, "body": "Sorry, I&#39;ve updated the link with an Excel file. I don&#39;t know why saving it as .xlsm and including the above macro blows the file size out to 11MB. You just need t copy the above code and run."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9622456, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/9622456/tim"}, "edited": false, "score": 0, "creation_date": 1525346441, "post_id": 50129728, "comment_id": 87325014, "body": "Sorry for the late reply. That didn&#39;t work. It pasted the dates but hasn&#39;t re-formatted them. As I&#39;ve mentioned to the above comment, I&#39;ve updated the link to the sample document if you want to give it a crack yourself"}, {"owner": {"reputation": 25, "user_id": 9622456, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/9622456/tim"}, "edited": false, "score": 0, "creation_date": 1525393459, "post_id": 50129728, "comment_id": 87348840, "body": "It it because the cells are formatted as text? Edit: Nevermind, they input cells are formatting as custom and the output are formatted as general."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1525248060, "creation_date": 1525248060, "answer_id": 50129728, "question_id": 50128832, "link": "https://stackoverflow.com/questions/50128832/date-formatting-error-when-importing-dates-stored-as-text/50129728#50129728", "title": "Date formatting error when importing dates stored as text", "body": "<p>You can loop through each cell, check if the day is within 1 to 12, and then switch the day and month using <code>DateSerial</code>. Then store it in an array (to run faster), and at the end, dump the entire array to \"output\" sheet using <code>Application.Transpose</code>.</p>\n\n<p>More explanation inside the code's comments.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub DateMacro()\n\nDim LastRow As Long, i As Long\nDim DateStr As String\nDim DatesArr() As Double\n\nReDim DatesArr(0)\n\nWith Sheets(\"Input\")\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' get last row with data in column A\n\n    For i = 2 To LastRow ' from 2nd row until last row with data\n        ' === if day  is from 1 though 12 of the month comes \"mm/dd/yyyy\" &gt;&gt; switch month and day ===\n        Select Case Day(.Range(\"A\" &amp; i).Value)\n            Case 1 To 12\n                DateStr = Format(.Range(\"A\" &amp; i).Value, \"dd/mm/yyyy\")\n\n                ' switch month and day\n                DatesArr(UBound(DatesArr)) = DateSerial(Year(DateValue(DateStr)), Day(DateValue(DateStr)), Month(DateValue(DateStr)))\n\n            Case Else\n                DatesArr(UBound(DatesArr)) = DateValue(.Range(\"A\" &amp; i).Value)\n\n        End Select\n\n        ReDim Preserve DatesArr(UBound(DatesArr) + 1) ' keep record and raise array index by 1\n    Next i\nEnd With\n\n' resize array to actual populated size\nReDim Preserve DatesArr((UBound(DatesArr) - 1))\n\nSheets(\"Output\").Range(\"A2:A\" &amp; LastRow).NumberFormat = \"d/mm/yyyy h:mm:ss AM/PM\"\n\n' use Application.Transpose to copy the entire array contents to your range\nSheets(\"Output\").Range(\"A2:A\" &amp; LastRow).Value = Application.Transpose(DatesArr)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 9622456, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/9622456/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1525402464, "creation_date": 1525402464, "answer_id": 50166464, "question_id": 50128832, "link": "https://stackoverflow.com/questions/50128832/date-formatting-error-when-importing-dates-stored-as-text/50166464#50166464", "title": "Date formatting error when importing dates stored as text", "body": "<p>I've found something that works in my case. Just posting in case anyone else needs it. I just need to format the Output range as Text before transferring the data and then convert it back into the date format I want.</p>\n\n<pre><code>Sheets(\"Output\").Range(\"A:A\").NumberFormat = \"@\"\nSheets(\"Input\").Range(\"A:A\").NumberFormat = \"d/mm/yyyy h:mm:ss AM/PM\"\nSheets(\"Output\").Range(\"A:A\").Value = Sheets(\"Input\").Range(\"A:A\").Value\nSheets(\"Output\").Range(\"A:A\").NumberFormat = \"d/mm/yyyy h:mm:ss AM/PM\"\n</code></pre>\n\n<p>Thanks to everyone else for their time/input</p>\n"}], "owner": {"reputation": 25, "user_id": 9622456, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/9622456/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525402464, "creation_date": 1525244533, "last_edit_date": 1531161705, "question_id": 50128832, "link": "https://stackoverflow.com/questions/50128832/date-formatting-error-when-importing-dates-stored-as-text", "title": "Date formatting error when importing dates stored as text", "body": "<p>I have a simple macro (as part of a whole bunch of others in my workbook) that copies the contents of a column in one worksheet into another. This column is a bunch of dates which are stored as text. The issue is, for all dates less that the 12th of the month, it's appropriating the the day as the month and vice versa.</p>\n\n<p>There is a bunch of similar topics on here and other sites but none of them have really worked. I hoping there is a simple fix. </p>\n\n<p><strong>My recent version of the macro</strong></p>\n\n<pre><code>Sub DateMacro()\n\nSheets(\"Output\").Range(\"A2:A1048575\").NumberFormat = \"d/mm/yyyy h:mm:ss AM/PM\"\nSheets(\"Input\").Range(\"A2:A1048575\").NumberFormat = \"d/mm/yyyy h:mm:ss AM/PM\"\nSheets(\"Output\").Range(\"A2:A1048575\").Value = Sheets(\"Input\").Range(\"A2:A1048575\").Value\n\nEnd Sub\n</code></pre>\n\n<p>I've linked a sample workbook <a href=\"https://drive.google.com/open?id=1q5F6mgEzVgrc1nyDzTFcF29FQWxH6VsV\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Additional info:<br/>\nI don't have control about how the dates are formatted when exported from my reporting system so I need to make the changes within my reporting workbook.</p>\n\n<p>Update: I spoke to a colleague and he came up with this:</p>\n\n<pre><code>Sub test()\n\nDim i As Long\nDim RngEnd As Long\n\nDim rng As String\nDim test As String\n\nRngEnd = Range(\"A1\").End(xlDown).Row\n\nFor i = 2 To RngEnd\n\nrng = \"A\" &amp; i\ntest = Sheets(\"Input\").Range(rng).Value\n\nSheets(\"Output\").Range(rng) = DateValue(test) + TimeValue(test)\n\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>This appears to work fine but there is a popup with \"Error 13 Type Mismatch\". Any idea or amendments to this one that you can think of?</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1525246074, "post_id": 50128738, "comment_id": 87276261, "body": "Take a look here <a href=\"https://forums.adobe.com/thread/1025217\" rel=\"nofollow noreferrer\">forums.adobe.com/thread/1025217</a> it may help with what you are trying to do. If you get it working, don&#39;t forget to answer your own question to help anyone looking for a similar answer in the future, unless someone else can help."}, {"owner": {"reputation": 23, "user_id": 9724210, "user_type": "registered", "profile_image": "https://graph.facebook.com/2105550936126253/picture?type=large", "display_name": "Jay Teo", "link": "https://stackoverflow.com/users/9724210/jay-teo"}, "reply_to_user": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1525271963, "post_id": 50128738, "comment_id": 87292880, "body": "sorry i just started coding and the codes in the link you sent looks totally foreign :("}], "owner": {"reputation": 23, "user_id": 9724210, "user_type": "registered", "profile_image": "https://graph.facebook.com/2105550936126253/picture?type=large", "display_name": "Jay Teo", "link": "https://stackoverflow.com/users/9724210/jay-teo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1058, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525244102, "creation_date": 1525244102, "question_id": 50128738, "link": "https://stackoverflow.com/questions/50128738/adding-text-box-to-pdf-generated-by-excel-macro", "title": "Adding text box to PDF generated by Excel macro", "body": "<p>I have a macro to generate excel into PDF. How do i add text box in the PDF at a specific location?</p>\n\n<p>Here are my codes:</p>\n\n<pre><code>Sub Export()\nDim wsA As Worksheet\nDim wsB As Workbook\nDim strPath As String\nDim myFile As Variant\n\nSet wbA = ActiveWorkbook\nSet wsA = ActiveWorksheey\n\nstrPath = wbA.Path\nIf strPath = \"\" Then\nstrPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\n\nmyFile = Application.GetSaveAsFilename _\n(FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\nTitle:=\"Select Folder and FileName to save\")\n\nIf myFile &lt;&gt; \"False\" Then\nwsa.ExportAsFixedFormat _\nType:=xlTypePDF, _\nFilename:=myFile, _\nQuality:=xlQualityStandard,_\nIncludeDocProperties:=True,_\nIgnorePrintAreas:=False,_\nOpenAfterPublish:=True\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "edited": false, "score": 0, "creation_date": 1525240972, "post_id": 50127950, "comment_id": 87273805, "body": "Why double line spacing in VBA code?"}, {"owner": {"reputation": 15, "user_id": 9514085, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpSKyrUfzV4/AAAAAAAAAAI/AAAAAAAAABo/7JkNSf3wJzs/photo.jpg?sz=128", "display_name": "Ash Ketchum", "link": "https://stackoverflow.com/users/9514085/ash-ketchum"}, "reply_to_user": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "edited": false, "score": 0, "creation_date": 1525241169, "post_id": 50127950, "comment_id": 87273878, "body": "Hi, sorry. I am not familiar with the interface of Stackoverflow, so I put the codes in ` ` and separate them with line spacing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1525243120, "post_id": 50127950, "comment_id": 87274744, "body": "Paste your code then select it all and hit ctrl+K."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9514085, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpSKyrUfzV4/AAAAAAAAAAI/AAAAAAAAABo/7JkNSf3wJzs/photo.jpg?sz=128", "display_name": "Ash Ketchum", "link": "https://stackoverflow.com/users/9514085/ash-ketchum"}, "edited": false, "score": 0, "creation_date": 1525245267, "post_id": 50128852, "comment_id": 87275815, "body": "Hi @P\u1d07\u029c, thanks a lot for the response!! Just another quick question, what can I do if I would like to display multiple DGName in the same email?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 9514085, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpSKyrUfzV4/AAAAAAAAAAI/AAAAAAAAABo/7JkNSf3wJzs/photo.jpg?sz=128", "display_name": "Ash Ketchum", "link": "https://stackoverflow.com/users/9514085/ash-ketchum"}, "edited": false, "score": 0, "creation_date": 1525246121, "post_id": 50128852, "comment_id": 87276289, "body": "@AshKetchum I don&#39;t understand what sense that makes. 1 mail address corresponds to 1 name. If not you must be much more specific."}, {"owner": {"reputation": 15, "user_id": 9514085, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpSKyrUfzV4/AAAAAAAAAAI/AAAAAAAAABo/7JkNSf3wJzs/photo.jpg?sz=128", "display_name": "Ash Ketchum", "link": "https://stackoverflow.com/users/9514085/ash-ketchum"}, "edited": false, "score": 0, "creation_date": 1525246416, "post_id": 50128852, "comment_id": 87276448, "body": "Hi @P\u1d07\u029c, sorry for any inconvenience. The variable &quot;DGName&quot; are actually userIDs that is associated with the recipients. So basically, one recipient can have many different DGName registered under the same email. What I wish to achieve is that the reminder I am going to send will consist of the different DGName associated with the same email address. Hopes that will clarify your doubts."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 9514085, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpSKyrUfzV4/AAAAAAAAAAI/AAAAAAAAABo/7JkNSf3wJzs/photo.jpg?sz=128", "display_name": "Ash Ketchum", "link": "https://stackoverflow.com/users/9514085/ash-ketchum"}, "edited": false, "score": 0, "creation_date": 1525246644, "post_id": 50128852, "comment_id": 87276568, "body": "@AshKetchum Well this is a completely different question now. This cannot be answered in a short comment. Nor can it be answered without knowing how your data looks like. Therefore I suggest to ask a new question including sample data or screenshots."}, {"owner": {"reputation": 15, "user_id": 9514085, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpSKyrUfzV4/AAAAAAAAAAI/AAAAAAAAABo/7JkNSf3wJzs/photo.jpg?sz=128", "display_name": "Ash Ketchum", "link": "https://stackoverflow.com/users/9514085/ash-ketchum"}, "edited": false, "score": 0, "creation_date": 1525247215, "post_id": 50128852, "comment_id": 87276852, "body": "Okay. Thank you for the response."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1525244633, "creation_date": 1525244633, "answer_id": 50128852, "question_id": 50127950, "link": "https://stackoverflow.com/questions/50127950/using-macros-to-send-email-to-specific-recipients/50128852#50128852", "title": "Using Macros to send email to specific recipients", "body": "<p>Well, at the moment you send 1 email to multiple addresses (BCC). So you need to change the code to send multiple individual mails (1 mail each address).</p>\n\n<p>Therefore just put the code to send the mail within the for loop:</p>\n\n<pre><code>With OutLookMailItem       \n    For iCounter = 1 To WorksheetFunction.CountA(Columns(16))\n        If Cells(iCounter, 14) = \"\" Then\n            MailDest = Cells(iCounter, 16).Value\n            DGName = Cells(iCounter, 12).Value\n            .To = MailDest\n            .Subject = \"W2K16 update on Cloudworkplace Desktop Group\"\n            .HTMLBody = \"Dear ~Whoever ,\" &amp; \"&lt;br/&gt;&lt;br/&gt;\" &amp; DGName &amp; \"&lt;br/&gt;&lt;br/&gt;\" &amp; \" ~Message\"\n            .send\n        End If\n    Next iCounter\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 9514085, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpSKyrUfzV4/AAAAAAAAAAI/AAAAAAAAABo/7JkNSf3wJzs/photo.jpg?sz=128", "display_name": "Ash Ketchum", "link": "https://stackoverflow.com/users/9514085/ash-ketchum"}, "edited": false, "score": 0, "creation_date": 1525247104, "post_id": 50128929, "comment_id": 87276801, "body": "Hi @Dinesh Pawar. Using the solution you have provided, the emails that are sent out do not have DGName in them. How should I proceed?"}], "tags": [], "owner": {"reputation": 403, "user_id": 8102155, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lXDxu.png?s=128&g=1", "display_name": "Dinesh Vilas Pawar", "link": "https://stackoverflow.com/users/8102155/dinesh-vilas-pawar"}, "is_accepted": false, "score": -1, "last_activity_date": 1525244926, "creation_date": 1525244926, "answer_id": 50128929, "question_id": 50127950, "link": "https://stackoverflow.com/questions/50127950/using-macros-to-send-email-to-specific-recipients/50128929#50128929", "title": "Using Macros to send email to specific recipients", "body": "<p>As I review your code found that DGName variable needs to make blank string after looping again into For 1st loop </p>\n\n<p>I am write this in solution because unable to write a comment.\nthe code something like below</p>\n\n<pre><code>Sub SendReminderMail()\n\nDim OutLookApp As Object\nDim OutLookMailItem As Object\nDim iCounter As Integer\nDim MailDest As String\nDim DGName As String\n\nSet OutLookApp = CreateObject(\"Outlook.application\")\nSet OutLookMailItem = OutLookApp.CreateItem(0)\n\nWith OutLookMailItem\n    MailDest = \"\"\n\n    For iCounter = 1 To WorksheetFunction.CountA(Columns(16))\n    DGName = \"\" 'see here\n\n        If MailDest = \"\" And Cells(iCounter, 14) = \"\" Then\n            MailDest = Cells(iCounter, 16).Value\n            DGName = Cells(iCounter, 12).Value\n        ElseIf MailDest &lt;&gt; \"\" And Cells(iCounter, 14) = \"\" Then\n            MailDest = MailDest &amp; \";\" &amp; Cells(iCounter, 16)\n            DGName = DGName &amp; \";\" &amp; Cells(iCounter, 12)\n        End If\n\n    Next iCounter\n\n    .BCC = MailDest\n    .Subject = \"W2K16 update on Cloudworkplace Desktop Group\"\n    .HTMLBody = \"Dear ~Whoever ,\" &amp; \"&lt;br/&gt;&lt;br/&gt;\" &amp; DGName &amp; \"&lt;br/&gt;&lt;br/&gt;\" &amp; \" ~Message\"\n    .send\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9514085, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpSKyrUfzV4/AAAAAAAAAAI/AAAAAAAAABo/7JkNSf3wJzs/photo.jpg?sz=128", "display_name": "Ash Ketchum", "link": "https://stackoverflow.com/users/9514085/ash-ketchum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 50128852, "answer_count": 2, "score": 1, "last_activity_date": 1525251126, "creation_date": 1525240476, "last_edit_date": 1592644375, "question_id": 50127950, "link": "https://stackoverflow.com/questions/50127950/using-macros-to-send-email-to-specific-recipients", "title": "Using Macros to send email to specific recipients", "body": "<p>I am trying to send email reminder to specific recipient with their associated userIDs stored in an Excel worksheet. The email will only send to the recipient if they have not completed the survey. (Cells(iCounter,3))</p>\n<p>MailDest is where all the recipients' email are located. DGName contains all the associated userIDs of the recipient. One recipient can have more than one userID.</p>\n<p>The problem is that all the userIDs (DGName) of recipients are generated in every single email that is sent to them.</p>\n<p>How should I edit my codes so that it will send the email to the recipients associated email and their userIDs?</p>\n<p><strong>EDIT</strong>\nHere are the codes:</p>\n<pre><code>Sub SendReminderMail()\n\nDim OutLookApp As Object    \nDim OutLookMailItem As Object    \nDim iCounter As Integer    \nDim MailDest As String    \nDim DGName As String\n\nSet OutLookApp = CreateObject(&quot;Outlook.application&quot;)    \nSet OutLookMailItem = OutLookApp.CreateItem(0)\n\nWith OutLookMailItem    \n    MailDest = &quot;&quot;    \n    For iCounter = 1 To WorksheetFunction.CountA(Columns(5))\n\n        If MailDest = &quot;&quot; And Cells(iCounter, 3) = &quot;&quot; Then\n            MailDest = Cells(iCounter, 5).Value\n            DGName = Cells(iCounter, 1).Value\n        ElseIf MailDest &lt;&gt; &quot;&quot; And Cells(iCounter, 3) = &quot;&quot; Then\n            MailDest = MailDest &amp; &quot;;&quot; &amp; Cells(iCounter, 5)\n            DGName = DGName &amp; &quot;;&quot; &amp; Cells(iCounter, 1)\n        End If\n\n    Next iCounter\n\n    .BCC = MailDest\n    .Subject = &quot;W2K16 update on Cloudworkplace Desktop Group&quot;\n    .HTMLBody = &quot;Dear ~Whoever ,&quot; &amp; &quot;&lt;br/&gt;&lt;br/&gt;&quot; &amp; DGName &amp; &quot;&lt;br/&gt;&lt;br/&gt;&quot; &amp; &quot; ~Message&quot;\n    .send\n</code></pre>\n<p>In this sample, if &quot;Feedback&quot; Column is empty, it will trigger the macro to send the reminder email to recipient.</p>\n<p><a href=\"https://i.stack.imgur.com/HyKjQ.png\" rel=\"nofollow noreferrer\">Sample Excel Data</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6924373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd1de819ad8fb1235977fc0138613a?s=128&d=identicon&r=PG&f=1", "display_name": "iphone user", "link": "https://stackoverflow.com/users/6924373/iphone-user"}, "edited": false, "score": 0, "creation_date": 1525239897, "post_id": 50127739, "comment_id": 87273424, "body": "if this is not static then ? and i declare like this  Dim start= 6 this shows an error Compile error : Expected end of statement"}, {"owner": {"reputation": 3, "user_id": 6924373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd1de819ad8fb1235977fc0138613a?s=128&d=identicon&r=PG&f=1", "display_name": "iphone user", "link": "https://stackoverflow.com/users/6924373/iphone-user"}, "edited": false, "score": 0, "creation_date": 1525240509, "post_id": 50127739, "comment_id": 87273630, "body": "and actually this is dummy data my actual data position is different like in exportfile range is 1802 to 1840 .. and in datasheet data where i paste position is 60,88,116,144 ,172,200,228,256,284,312,340,368,396,452,480,508,536,564,592&zwnj;&#8203;,620,648,676,704,732&zwnj;&#8203;,760"}, {"owner": {"reputation": 649, "user_id": 573075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/951e518663b261e3a849eebbeecc71a4?s=128&d=identicon&r=PG", "display_name": "CynicalSection", "link": "https://stackoverflow.com/users/573075/cynicalsection"}, "reply_to_user": {"reputation": 3, "user_id": 6924373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd1de819ad8fb1235977fc0138613a?s=128&d=identicon&r=PG&f=1", "display_name": "iphone user", "link": "https://stackoverflow.com/users/6924373/iphone-user"}, "edited": false, "score": 0, "creation_date": 1525242242, "post_id": 50127739, "comment_id": 87274336, "body": "<code>Dim start as Integer</code> on first line and then <code>start = 6</code>. Now, it doesn&#39;t matter where your data starts and how is structured, by static I meant that is fixed and therefore you can apply a formula as above. I recommend to put the formula on paper and calculated few values to fully understand it. <code>start</code> is used for the first value because <code>I-2</code> equals 0 multiplied by 8 is 0. 8 is the distance between two rows, so <code>(i-2)*8</code> jumps from 6 8 rows each iteration. Just change the variables with the actual data you have in your file."}, {"owner": {"reputation": 3, "user_id": 6924373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd1de819ad8fb1235977fc0138613a?s=128&d=identicon&r=PG&f=1", "display_name": "iphone user", "link": "https://stackoverflow.com/users/6924373/iphone-user"}, "edited": false, "score": 0, "creation_date": 1525242465, "post_id": 50127739, "comment_id": 87274443, "body": "yeah ..i do that.. now  i have data start from 1803 and end at 1840 in export file .. so in Datasheet for A last quarter 31 Dec 2017 position is 60.. so according o forumla =1803 + ((1803-2)*8) this equals to 16211. so this position 16211 position where actual position is 60 .. hope you understand"}, {"owner": {"reputation": 3, "user_id": 6924373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd1de819ad8fb1235977fc0138613a?s=128&d=identicon&r=PG&f=1", "display_name": "iphone user", "link": "https://stackoverflow.com/users/6924373/iphone-user"}, "edited": false, "score": 0, "creation_date": 1525242941, "post_id": 50127739, "comment_id": 87274685, "body": "and in actual data difference is 27 .. so i place 27 instead of 8 ?"}, {"owner": {"reputation": 649, "user_id": 573075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/951e518663b261e3a849eebbeecc71a4?s=128&d=identicon&r=PG", "display_name": "CynicalSection", "link": "https://stackoverflow.com/users/573075/cynicalsection"}, "reply_to_user": {"reputation": 3, "user_id": 6924373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd1de819ad8fb1235977fc0138613a?s=128&d=identicon&r=PG&f=1", "display_name": "iphone user", "link": "https://stackoverflow.com/users/6924373/iphone-user"}, "edited": false, "score": 0, "creation_date": 1525243631, "post_id": 50127739, "comment_id": 87274979, "body": "It&#39;s close. First value of <code>start</code> refers to the first position in your Data sheet, not export, so it&#39;s 60. <code>(i-2)</code> becomes <code>(i-3)</code>, because the iteration starts from 1803, you need to make a 0 on the first loop. Then 8, yes , becomes 27."}], "tags": [], "owner": {"reputation": 649, "user_id": 573075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/951e518663b261e3a849eebbeecc71a4?s=128&d=identicon&r=PG", "display_name": "CynicalSection", "link": "https://stackoverflow.com/users/573075/cynicalsection"}, "is_accepted": true, "score": 0, "last_activity_date": 1525239416, "creation_date": 1525239416, "answer_id": 50127739, "question_id": 50127584, "link": "https://stackoverflow.com/questions/50127584/data-transfer-through-loop-in-excel-vb/50127739#50127739", "title": "data transfer through loop in excel vb", "body": "<p>If the template is static, as described, this is just math. Declare and initialize a variable <code>start</code> outside <code>for</code> with 6 and add a formula inside the loop for j</p>\n\n<pre><code>j = start + ((i-2) *8)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6924373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd1de819ad8fb1235977fc0138613a?s=128&d=identicon&r=PG&f=1", "display_name": "iphone user", "link": "https://stackoverflow.com/users/6924373/iphone-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 50127739, "answer_count": 1, "score": 0, "last_activity_date": 1525241633, "creation_date": 1525238458, "last_edit_date": 1525241633, "question_id": 50127584, "link": "https://stackoverflow.com/questions/50127584/data-transfer-through-loop-in-excel-vb", "title": "data transfer through loop in excel vb", "body": "<p>i have this kind of data in excel file </p>\n\n<p>Exportfile.xlsx</p>\n\n<pre><code>      A        B\n1)    Head  31-Dec-2017\n2)    a         23\n3)    b         45\n4)    c         46\n</code></pre>\n\n<p>Datasheet.xlsx</p>\n\n<p>And in datasheet data like this</p>\n\n<pre><code>1)           **A**  \n2) ***QUARTER          Data***\n3) 31 Mar 2017  \n4) 30 Jun 2017  \n5) 30 Sep 2017  \n6) 31 Dec 2017  \n7)  \n8)  \n9)         **B**    \n10) ***QUARTER          Data***\n11) 31 Mar 2017 \n12) 30 Jun 2017 \n13) 30 Sep 2017 \n14) 31 Dec 2017 \n15) \n16) \n17)         **C**   \n18) ***QUARTER          Data***\n19) 31 Mar 2017 \n20) 30 Jun 2017 \n21) 30 Sep 2017 \n22) 31 Dec 2017 \n</code></pre>\n\n<p>now i want to paste values from exportfile to datasheet and want data like this </p>\n\n<pre><code>1)           **A**  \n2) ***QUARTER          Data***\n3) 31 Mar 2017  \n4) 30 Jun 2017  \n5) 30 Sep 2017  \n6) 31 Dec 2017         23\n7)  \n8)  \n9)         **B**    \n10) ***QUARTER          Data***\n11) 31 Mar 2017 \n12) 30 Jun 2017 \n13) 30 Sep 2017 \n14) 31 Dec 2017          45\n15) \n16) \n17)         **C**   \n18) ***QUARTER          Data***\n19) 31 Mar 2017 \n20) 30 Jun 2017 \n21) 30 Sep 2017 \n22) 31 Dec 2017          46\n</code></pre>\n\n<p>now i do this code </p>\n\n<pre><code>Sub copy_data(File_Name)\n   For i = 2 To 4\nWindows(\"Exportfile.xlsx\").Activate\n    Sheets(\"ESheet\").Select\n         Cells(i, 2).Select\n     Selection.Copy\nWindows(File_Name).Activate\n    Sheets(\"Dsheet\").Select\n   On Error Resume Next\n  **j = '' here what i do** \n    Cells(j, 2).Select\n   On Error Resume Next\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nNext\nEnd Sub\n</code></pre>\n\n<p>now in above code on J line what should i do so values copy from export file and paste in datasheet in quarter 31 Dec 2017 through loop </p>\n\n<p>any solution ?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1525238433, "post_id": 50127460, "comment_id": 87272975, "body": "No way. If you have predefined lists of country then you can get country name from cell."}, {"owner": {"reputation": 5, "user_id": 8620753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f2807ce9cf3d6567c8676cdffdf9555d?s=128&d=identicon&r=PG", "display_name": "user8620753", "link": "https://stackoverflow.com/users/8620753/user8620753"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1525238761, "post_id": 50127460, "comment_id": 87273081, "body": "I will make that list, then how could I extract country names from the data."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1525239059, "post_id": 50127460, "comment_id": 87273156, "body": "Perhap you coild try the find() function..."}, {"owner": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "edited": false, "score": 0, "creation_date": 1525240905, "post_id": 50127460, "comment_id": 87273778, "body": "Have you made the list of countries yet?"}], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 8102155, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lXDxu.png?s=128&g=1", "display_name": "Dinesh Vilas Pawar", "link": "https://stackoverflow.com/users/8102155/dinesh-vilas-pawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1525242901, "creation_date": 1525242901, "answer_id": 50128455, "question_id": 50127460, "link": "https://stackoverflow.com/questions/50127460/how-i-can-get-the-country-names-from-large-data/50128455#50128455", "title": "How i can get the country names from large data?", "body": "<pre><code>    'As far as I know this task can be achieve if we have list of all country.\n'here CountyText.text file contain list of all country.\n'for demo this list collect from internet you can add your own list in this file.\n'This function can be use where compitational time doesn't matter.\n'Before use this function copy paste this code in new module.\n\nFunction FindCountry(cellstring As String) As String\nDim DataLine As String\nDim File As String\nFile = \"D:\\CountyText.txt\" 'Path of county text file\n'(for demo this list collect from internet) you can add your own list in this file\nFindCountry = \"\" 'initial value of function\n\nOn Error Resume Next 'this is for error handling\nClose #1\nOpen File For Input As #1\nOn Error GoTo 0\n\nWhile Not EOF(1) 'while end of file\n    Line Input #1, DataLine ' read in data 1 line at a time\nIf InStr(cellstring, DataLine) Then\nFindCountry = DataLine\nEnd If\nWend\n\nClose #1\nEnd Function\n</code></pre>\n\n<p>to write countryText.txt file format see screenshots</p>\n\n<p><a href=\"https://i.stack.imgur.com/4H8of.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4H8of.png\" alt=\"countryText.txt\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/d7RXh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d7RXh.png\" alt=\"OutPut\"></a></p>\n\n<p>After adding \"USA\" in countryText.txt file it can be identify</p>\n"}, {"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1525243420, "last_edit_date": 1525243420, "creation_date": 1525243077, "answer_id": 50128489, "question_id": 50127460, "link": "https://stackoverflow.com/questions/50127460/how-i-can-get-the-country-names-from-large-data/50128489#50128489", "title": "How i can get the country names from large data?", "body": "<ol>\n<li><p>Suppose you have country list from <code>J1</code> to <code>J5</code> like below screenshot.<br></p>\n\n<p><a href=\"https://i.stack.imgur.com/pbyFy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pbyFy.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>In a module copy and paste the below function. See screenshot.</p>\n\n<pre><code>Option Explicit\n\nPublic Function getCountry(ByVal srtText As String) As String\nDim CountryArray As Variant\nDim i As Long\n\n    Application.Volatile\n    CountryArray = Application.Transpose(Range(\"J1:J5\").Value2)\n    For i = LBound(CountryArray) To UBound(CountryArray)\n        If (InStr(1, srtText, CountryArray(i), 1)) &gt; 0 Then\n            getCountry = CountryArray(i)\n            Exit Function\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/h5rFT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h5rFT.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"3\">\n<li><p>Then use following function in <code>B1</code> cell.</p>\n\n<pre><code>=getCountry(A1)\n</code></pre></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/4v1R9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4v1R9.png\" alt=\"enter image description here\"></a></p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1525243275, "creation_date": 1525243275, "answer_id": 50128535, "question_id": 50127460, "link": "https://stackoverflow.com/questions/50127460/how-i-can-get-the-country-names-from-large-data/50128535#50128535", "title": "How i can get the country names from large data?", "body": "<p>You can use formula in cell <code>B2</code> like below:</p>\n\n<p><code>=LOOKUP(2^15,SEARCH(CountryList,A2,1),CountryList)</code></p>\n\n<blockquote>\n  <p>where <code>CountryList</code> refers to the range holding names of countries you are looking for!</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 8620753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f2807ce9cf3d6567c8676cdffdf9555d?s=128&d=identicon&r=PG", "display_name": "user8620753", "link": "https://stackoverflow.com/users/8620753/user8620753"}, "edited": false, "score": 0, "creation_date": 1525327110, "post_id": 50128671, "comment_id": 87313934, "body": "the country list is not in the manner you showed, it is in haphazard manner."}, {"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "reply_to_user": {"reputation": 5, "user_id": 8620753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f2807ce9cf3d6567c8676cdffdf9555d?s=128&d=identicon&r=PG", "display_name": "user8620753", "link": "https://stackoverflow.com/users/8620753/user8620753"}, "edited": false, "score": 0, "creation_date": 1525327304, "post_id": 50128671, "comment_id": 87313995, "body": "I am not sure what does &quot;haphazard&quot; mean in this sense but you should be somehow organizing your list into columns, into rows or into a CSV format in order to use these list items programatically."}], "tags": [], "owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "is_accepted": false, "score": 1, "last_activity_date": 1525243826, "creation_date": 1525243826, "answer_id": 50128671, "question_id": 50127460, "link": "https://stackoverflow.com/questions/50127460/how-i-can-get-the-country-names-from-large-data/50128671#50128671", "title": "How i can get the country names from large data?", "body": "<p>First make a list of countries -preferably- to another sheet. Below screenshot is a sample list which is on <strong>Sheet2</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LrjR6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LrjR6.png\" alt=\"country list\"></a></p>\n\n<p>Assuming that your data is located as below, write below formula to <code>B1</code> of your <strong>Sheet1</strong> and press <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd> in order to activate the array formula.</p>\n\n<pre><code>=INDEX(Sheet2!$A$1:$A$5,SUMPRODUCT(ISNUMBER(FIND(Sheet2!$A$1:$A$5,A1))*ROW(Sheet2!$1:$5)))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pl9uc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pl9uc.png\" alt=\"data &amp; formula\"></a></p>\n\n<ul>\n<li>If your country list has more than 5 items, then you should be changing your formula's <code>Sheet2!$A$1:$A$5</code> &amp; <code>ROW(Sheet2!$1:$5)</code> parts accordingly.</li>\n</ul>\n"}], "owner": {"reputation": 5, "user_id": 8620753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f2807ce9cf3d6567c8676cdffdf9555d?s=128&d=identicon&r=PG", "display_name": "user8620753", "link": "https://stackoverflow.com/users/8620753/user8620753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 1, "closed_date": 1525244644, "answer_count": 4, "score": -3, "last_activity_date": 1525243826, "creation_date": 1525237539, "last_edit_date": 1531161705, "question_id": 50127460, "link": "https://stackoverflow.com/questions/50127460/how-i-can-get-the-country-names-from-large-data", "closed_reason": "Needs more focus", "title": "How i can get the country names from large data?", "body": "<p>How to extract country names out of the data?</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xhe97.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xhe97.jpg\" alt=\"https://i.stack.imgur.com/Xhe97.jpg\"></a></p>\n"}, {"tags": ["excel", "vba", "document-classification"], "comments": [{"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1525246809, "post_id": 50127383, "comment_id": 87276641, "body": "Have you tried putting <code>Application.EnableEvents = True</code> after save events?"}, {"owner": {"reputation": 19, "user_id": 9593941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sri Rama", "link": "https://stackoverflow.com/users/9593941/sri-rama"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1525304176, "post_id": 50127383, "comment_id": 87308043, "body": "Tried that @TomJohnRiddle it&#39;s not working. I even tried disabling display alerts. None worked"}], "owner": {"reputation": 19, "user_id": 9593941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sri Rama", "link": "https://stackoverflow.com/users/9593941/sri-rama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 454, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576748518, "creation_date": 1525236940, "last_edit_date": 1576748518, "question_id": 50127383, "link": "https://stackoverflow.com/questions/50127383/progress-bar-to-indicate-file-is-being-saved-doesnt-go-away", "title": "Progress bar to indicate file is being saved doesn&#39;t go away", "body": "<p>I have an Excel macro that opens a workbook, does some operations, saves and closes it. It worked for the last 2 years.</p>\n\n<p>TITUS was installed on my work machine and because of this, I have to choose a document classification manually every time code tries to save the workbook.</p>\n\n<p>As a workaround, I use <code>Application.EnableEvents = False</code> before save and close statements. After that, the macro sometimes stops at save bar like shown in this image: <a href=\"http://social.msdn.microsoft.com/Forums/getfile/152104\" rel=\"nofollow noreferrer\">Save bar</a></p>\n\n<p>The workbook is saved but the save bar doesn't close and halts the macro from opening any other workbooks. This occurs randomly for random workbooks. For example, when workbook 3 had this issue, if I run the macro on workbook 3 again, it might or might not cause the trouble.</p>\n"}, {"tags": ["vba", "catia"], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1527697448, "creation_date": 1527697448, "answer_id": 50609460, "question_id": 50127348, "link": "https://stackoverflow.com/questions/50127348/catia-screen-capture-code/50609460#50609460", "title": "Catia Screen Capture Code", "body": "<p>The CATIA method which captures the current window to a file is Window.CaptureToFile:</p>\n\n<pre><code>CATIA.ActiveWindow.ActiveViewer.CaptureToFile catCaptureFormatJPEG,\"C:\\Temp\\Capture.jpg\"\n</code></pre>\n\n<p>This captures the entire window, so to make it 250x250, set the ActiveWindow.Height and .Width to 250 before capturing the image. Then set it back afterwords to it's original size only. Alternatively you can resize the image after you insert it into Excel as a shape.  </p>\n\n<p>If you want the tree off you can also call ActiveWindow.Layout = catWindowGeomOnly </p>\n"}], "owner": {"reputation": 15, "user_id": 8186749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35efcb0db5c8e3fc264b953ef1edd863?s=128&d=identicon&r=PG&f=1", "display_name": "Aatrox The Darkin Blade", "link": "https://stackoverflow.com/users/8186749/aatrox-the-darkin-blade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1349, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527697448, "creation_date": 1525236658, "question_id": 50127348, "link": "https://stackoverflow.com/questions/50127348/catia-screen-capture-code", "title": "Catia Screen Capture Code", "body": "<p>Can someone help me with a code for capturing a 250X250 pixcel screen and copying it into clipboard. I would like to paste the image into an excel i can code that part. I have no clue where to start. I have made a code till reframing on the a point where i need the macro to capture.</p>\n\n<pre><code>Dim objviewer3d as viewer3d\nSelection1.search(\"Name=\"+Textbox1.value+\"*,all\")\n\nCaita.startcommand(\"reframe On\")\nCatia.refreshDisplay=true\n\nSet objviewer3d=catia.activewindow.activeviewer\nObjviewer3d.viewpoint3d.zoom=0.017\nobjviewer3d.update\n</code></pre>\n\n<p>This is the code i have written. I need the capture code. I Have no clue how to do that. And Last thing I know code to capture full screen and capture to file code. I don't want that.\nThank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10897, "user_id": 736172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b2d80f32ba198cf07c5ab0e0af469d?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/736172/ahmad"}, "edited": false, "score": 0, "creation_date": 1525235094, "post_id": 50127133, "comment_id": 87272066, "body": "Any errors are you getting?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8576649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50044d71b6405ab98bc283de4dbd6a3a?s=128&d=identicon&r=PG&f=1", "display_name": "chickflick91", "link": "https://stackoverflow.com/users/8576649/chickflick91"}, "edited": false, "score": 0, "creation_date": 1525273250, "post_id": 50130074, "comment_id": 87293812, "body": "wise and true! truly wise!!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1525260059, "last_edit_date": 1525260059, "creation_date": 1525249288, "answer_id": 50130074, "question_id": 50127133, "link": "https://stackoverflow.com/questions/50127133/how-to-run-a-video-file-when-an-excel-cell-reaches-a-certain-value/50130074#50130074", "title": "how to run a video file when an excel cell reaches a certain value", "body": "<p>When you say e2 = 30, are you referring to a cell in the active sheet? If so you should re-write your code something like below:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"dietdays\")) Is Nothing Then\n        Call diet1\n    End If\nEnd Sub\n\nSub diet1()\nDim Shex As Object:Set Shex = CreateObject(\"Shell.Application\")\n    'ThisWorkbook.Sheets(\"Sheet1\").Range(\"E2\").value = 30 then\n    'consider qualifying the Sheet as above instead of using ActiveSheet\n    If ThisWorkbook.ActiveSheet.Range(\"E2\").Value = 30 Then\n        FName = \"E:\\1\\1.au3\"\n        Shex.Open (FName)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8576649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50044d71b6405ab98bc283de4dbd6a3a?s=128&d=identicon&r=PG&f=1", "display_name": "chickflick91", "link": "https://stackoverflow.com/users/8576649/chickflick91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 50130074, "answer_count": 1, "score": 0, "last_activity_date": 1525260059, "creation_date": 1525234924, "last_edit_date": 1531164843, "question_id": 50127133, "link": "https://stackoverflow.com/questions/50127133/how-to-run-a-video-file-when-an-excel-cell-reaches-a-certain-value", "title": "how to run a video file when an excel cell reaches a certain value", "body": "<p>I have an excel file where I enter my stats. for motivation purposes I want it to play like an achievement video when a certain cell reaches a certain value. like if I stuck to a diet for 30 days to get like a well done! 30 days diet! you are now a diet apprentice! \ndon't really know how to do this code wise. tried:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"dietdays\")) Is Nothing Then\n\nCall diet1\n\n\nEnd If\n\nEnd Sub\n\n\nSub diet1()\n\nIf e2 = 30 Then\n\nCall Shell(\"e:\\1\\1.au3\")\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "concatenation", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3753845, "user_type": "registered", "profile_image": "https://graph.facebook.com/814835180/picture?type=large", "display_name": "user3753845", "link": "https://stackoverflow.com/users/3753845/user3753845"}, "edited": false, "score": 0, "creation_date": 1525270118, "post_id": 50131716, "comment_id": 87291497, "body": "Sorry for the wrong location, was doing some GIS stuff as well !"}, {"owner": {"reputation": 3, "user_id": 3753845, "user_type": "registered", "profile_image": "https://graph.facebook.com/814835180/picture?type=large", "display_name": "user3753845", "link": "https://stackoverflow.com/users/3753845/user3753845"}, "edited": false, "score": 0, "creation_date": 1525270187, "post_id": 50131716, "comment_id": 87291546, "body": "Wow, looking through that, its so much more simple than I had been trying. I&#39;ll have a go but thanks so much for your help"}], "tags": [], "owner": {"reputation": 128, "user_id": 9316769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55f2e1d39abb757b4c40dad9573842e?s=128&d=identicon&r=PG&f=1", "display_name": "RJJoling", "link": "https://stackoverflow.com/users/9316769/rjjoling"}, "is_accepted": true, "score": 1, "last_activity_date": 1525254455, "creation_date": 1525245796, "answer_id": 50131716, "question_id": 50131715, "link": "https://stackoverflow.com/questions/50131715/combine-occurrences-of-c-when-value-of-a-and-b-match-previous-row/50131716#50131716", "title": "Combine occurrences of &quot;C&quot; when value of &quot;A&quot; and &quot;B&quot; match previous row", "body": "<p>This code should do the job; I'm sure this question will be closed for being off-topic (or migrated to Stack Overflow, where it actually belongs):</p>\n\n<pre><code>Sub GatherCountries()\n'''Subroutine to loop through rows of column A and concatenate data of column C to column D,\n'''when row - 1 == row\n\n'Declare local variable types\nDim worksheetName As String\nDim rowNumber, rowEndNumber As Integer\nDim pasteCell As Range\n\n'Declare local variables\nworksheetName = ActiveSheet.Name\nrowEndNumber = FindLastRow(worksheetName) 'Function call to function defined below\n\n'Loop through each row, starting at line 2 as header is line 1\n    For rowNumber = 2 To rowEndNumber\n        With Worksheets(worksheetName) 'Reduce amount of unnecessary repitition\n            'Case where cell Ax and Bx equal Ax-1 and Bx-1\n            If .Cells(rowNumber, 1) = .Cells(rowNumber - 1, 1) And _\n            .Cells(rowNumber, 2) = .Cells(rowNumber - 1, 2) Then\n                pasteCell.Value = pasteCell.Value &amp; \", \" &amp; .Cells(rowNumber, 3) 'Concatenate country to existing string\n            'Case where cell Ax and Bx does not equal Ax-1 and Bx-1, loop will always enter this first\n            Else\n                Set pasteCell = .Cells(rowNumber, 4) 'Set the cell where concatenation should take place\n                pasteCell.Value = .Cells(rowNumber, 3) 'Populate concatenation cell with first entry of country\n            End If\n        End With\n    Next rowNumber\nEnd Sub\n\nFunction FindLastRow(ByVal SheetName As String) As Long\n'''Function to return the last row number of column A\n\n    Dim WS As Worksheet\n\n    On Error Resume Next\n    Set WS = ActiveWorkbook.Worksheets(SheetName)\n    FindLastRow = WS.Cells.Find(What:=\"*\", After:=WS.Cells(1), searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>With some more code it is possible to look up which columns contain the values to check and the values to concatenate, but given the structure of the example in the question, this will do the job as asked:</p>\n\n<p>Input:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ve8Mg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ve8Mg.png\" alt=\"CountriesGatheringExcelInput\"></a></p>\n\n<p>Output, after code has ran:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LfRpH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LfRpH.png\" alt=\"CountriesGatheringExcelOutput\"></a></p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1299486043, "open_beta_date": 1280430000, "closed_beta_date": 1279825200, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/gis/Img/apple-touch-icon@2.png", "twitter_account": "StackGIS", "favicon_url": "https://cdn.sstatic.net/Sites/gis/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/gis/Img/apple-touch-icon.png", "audience": "cartographers, geographers and GIS professionals", "site_url": "https://gis.stackexchange.com", "api_site_parameter": "gis", "logo_url": "https://cdn.sstatic.net/Sites/gis/Img/logo.png", "name": "Geographic Information Systems", "site_type": "main_site"}, "on_date": 1525254784, "question_id": 281504}, "owner": {"reputation": 3, "user_id": 3753845, "user_type": "registered", "profile_image": "https://graph.facebook.com/814835180/picture?type=large", "display_name": "user3753845", "link": "https://stackoverflow.com/users/3753845/user3753845"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 50131716, "answer_count": 1, "score": 0, "last_activity_date": 1525269912, "creation_date": 1525234683, "last_edit_date": 1531161705, "question_id": 50131715, "link": "https://stackoverflow.com/questions/50131715/combine-occurrences-of-c-when-value-of-a-and-b-match-previous-row", "title": "Combine occurrences of &quot;C&quot; when value of &quot;A&quot; and &quot;B&quot; match previous row", "body": "<p>Really hope you can help because i'm going blind on this issue. My spreadsheet has 20 columns and around 20,000 rows. Many rows are duplicates in all but 1 column and I need to Concatenate all the variables from that 1 column, where the rows match. My data is in order, so all duplicate rows are together and currently i have a macro but have to select a range by hand, which is slow.</p>\n\n<p>My question is, can I run a VBA/formula that will match each duplicate partial row within a whole sheet, then concatenate the unique cell of those rows? please see my simplified example.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zUzB5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zUzB5.png\" alt=\"simple example\"></a></p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1525226900, "post_id": 50126123, "comment_id": 87270414, "body": "If you [Debug] the error, the highlighted <code>rs.Open</code> statement tells you that the error happened executing <code>strSQL</code>, and so &quot;Incorrect syntax near &#39;&gt;&gt;&#39;&quot; could only mean that <code>strSQL</code> isn&#39;t valid SQL content ;-) I&#39;d fire up the <i>immediate pane</i> (Ctrl+G), and do <code>?strSQL</code> to get me its literal value, where I&#39;d look for the offending &#39;&gt;&gt;&#39; tokens. Does the .sql file run as-is in SQL Server Management Studio?"}, {"owner": {"reputation": 229, "user_id": 3608262, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Q8bXW.jpg?s=128&g=1", "display_name": "ArsedianIvan", "link": "https://stackoverflow.com/users/3608262/arsedianivan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525230919, "post_id": 50126123, "comment_id": 87271227, "body": "I actually thought it was that initially, but then I replaced strSQL to simply a straight select statement = &quot;Select * from someTable&quot; and I keep seeing the same error message."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525231740, "post_id": 50126123, "comment_id": 87271371, "body": "You do not open the RecorSet, you already opened the Connection. rs = connSQL.Execute(strSQL) Edit: However you do close the rs.Close when done."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525233964, "post_id": 50126123, "comment_id": 87271834, "body": "@RicardoA that is correct, however wouldn&#39;t make a difference; <code>rs.Open</code> is perfectly legal.. there&#39;s just too many ways to do the same thing with ADODB: I&#39;d say you do not execute off the connection, you make a parameterized command ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1525234419, "post_id": 50126123, "comment_id": 87271931, "body": "There&#39;s gotta be a <code>&gt;&gt;</code> <i>somewhere</i>... try <code>for i = 1 to connSQL.Errors.Count - 1 : ?connSQL.Errors(i).Description : next</code> in the immediate pane while in break mode after getting that error. Maybe there&#39;s more information there."}, {"owner": {"reputation": 229, "user_id": 3608262, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Q8bXW.jpg?s=128&g=1", "display_name": "ArsedianIvan", "link": "https://stackoverflow.com/users/3608262/arsedianivan"}, "edited": false, "score": 0, "creation_date": 1525236479, "post_id": 50126123, "comment_id": 87272387, "body": "Yes you are right, for some strange reasons when the SQL file being read into excel, it adds the following leading characters that do not even exist on the SQL script file &quot;&#239;&#187;&#191;&quot;"}, {"owner": {"reputation": 229, "user_id": 3608262, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Q8bXW.jpg?s=128&g=1", "display_name": "ArsedianIvan", "link": "https://stackoverflow.com/users/3608262/arsedianivan"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525237972, "post_id": 50126123, "comment_id": 87272823, "body": "Mathiue and @Ricardo A, I&#39;ve edited this question, the root cause seems to be how Excel VBA reads the SQL statement with these funny leading characters (i.e. &#239;&#187;&#191;) from the .SQL file"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1525238529, "post_id": 50126123, "comment_id": 87273002, "body": "That&#39;s likely a UTF-8 BOM, i.e. you have encoding issues. Open up the .sql file in Notepad++ and change the encoding to ANSI."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1525238973, "post_id": 50126123, "comment_id": 87273135, "body": "Possibly, opening the file in plain old Notepad, deleting the junk, and then saving, might just fix it."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1525245032, "post_id": 50126123, "comment_id": 87275680, "body": "Some context: <a href=\"https://stackoverflow.com/questions/31435662/vba-save-a-file-with-utf-8-without-bom\" title=\"vba save a file with utf 8 without bom\">stackoverflow.com/questions/31435662/&hellip;</a>"}], "owner": {"reputation": 229, "user_id": 3608262, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Q8bXW.jpg?s=128&g=1", "display_name": "ArsedianIvan", "link": "https://stackoverflow.com/users/3608262/arsedianivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594635424, "creation_date": 1525225903, "last_edit_date": 1594635424, "question_id": 50126123, "link": "https://stackoverflow.com/questions/50126123/incorrect-syntax-near-excel-vba-reads-sql-file-with-funny-leading-charact", "title": "Incorrect syntax near &#39;&gt;&gt;&#39;. Excel VBA reads .SQL file with funny leading characters (i.e. &#239;&#187;&#191; select top 100 * from test). Encoding issue", "body": "<p>I am having trouble with this VBA script and it seems to keep adding funny characters (i.e.\u00ef\u00bb\u00bf)  every time it reads the .SQL file. I believe this is due to encoding.</p>\n\n<pre><code> Option Explicit\n\nSub SomeExtract()\n\nWith Application\n    .ScreenUpdating = False: .DisplayAlerts = False: .Calculation = xlCalculationManual: .EnableEvents = False\nEnd With\n\nDim strSQL As String, filePath As String, fileSQL As Integer, row As String\nDim connSQL As ADODB.Connection, serverName As String, databaseName As String, userID As String, userPassword As String, rs As ADODB.Recordset\n\nfileSQL = FreeFile\nstrSQL = \"\"\nfilePath = Application.ThisWorkbook.Path &amp; \"\\somesql.sql\"\n\nOpen filePath For Input As fileSQL\n\nDo Until EOF(fileSQL)\n    Line Input #fileSQL, row\n    strSQL = strSQL &amp; row &amp; vbNewLine\nLoop\n\nClose #fileSQL\n\nserverName = \"someserver\"\ndatabaseName = \"somedb\"\n\nSet connSQL = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\nconnSQL.Open \"Provider=SQLOLEDB;Server=\" &amp; serverName &amp; \";Database=\" &amp; databaseName &amp; _\n\";Trusted_connection=yes;\"\n\nrs.Open strSQL, connSQL, adOpenStatic\n\nWith ThisWorkbook.Sheets(\"test\").Range(\"A1:Z1000000\")\n    .ClearContents\n    .CopyFromRecordset rs\nEnd With\n\nWith Application\n    .ScreenUpdating = True: .DisplayAlerts = True: .Calculation = xlCalculationAutomatic: .EnableEvents = True\nEnd With\n\n ExitPoint:\n    With Application\n       .ScreenUpdating = True: .DisplayAlerts = True: .Calculation = \n       xlCalculationAutomatic: .EnableEvents = True\n   End With\n\n    Set rs = Nothing\n    Exit Sub\n\n\nErrHandler:\n    With ThisWorkbook\n       .Sheets(\"Control\").Range(\"B1\").Value = Err.Description\n        .Sheets(\"Control\").Range(\"C1\").Value = strSQL\n    End With\n\nResume ExitPoint\n\nEnd Sub\n</code></pre>\n\n<p>The error message says \"Run-time error '-2147217900 (80040e14)': Incorrect syntax near '>>';\".  The SQL file doesn't have >> or any other characters as shown on the error message. In fact, I have replaced the .sql to only contain a straight SELECT statement. But I still seeing the funny characters being added when it is being read by Excel VBA (e.g. \u00ef\u00bb\u00bfselect top 100 * from test\" instead of \"select top 100 * from test\").</p>\n"}, {"tags": ["excel", "select", "dynamic", "range", "vba"], "comments": [{"owner": {"reputation": 162, "user_id": 7407449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kfqAS.png?s=128&g=1", "display_name": "Akami Kurai", "link": "https://stackoverflow.com/users/7407449/akami-kurai"}, "edited": false, "score": 0, "creation_date": 1525227000, "post_id": 50125951, "comment_id": 87270427, "body": "so you just want get the last row of each report?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1525227134, "creation_date": 1525227134, "answer_id": 50126247, "question_id": 50125951, "link": "https://stackoverflow.com/questions/50125951/dynamically-select-cell-after-the-end-of-range-of-cells/50126247#50126247", "title": "Dynamically Select Cell after the end of range of cells", "body": "<p>I believe you are looking for the .Offset method.</p>\n\n<p>To put <em>Signature</em> 5 rows down (in the same column),</p>\n\n<pre><code>Range(\"A1\").End(xlDown).offset(5, 0) = \"Signature\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9727978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c2f868f0d03d2a6606dab164e2d417?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/9727978/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 50126247, "answer_count": 1, "score": 0, "last_activity_date": 1525227134, "creation_date": 1525224294, "last_edit_date": 1531161705, "question_id": 50125951, "link": "https://stackoverflow.com/questions/50125951/dynamically-select-cell-after-the-end-of-range-of-cells", "title": "Dynamically Select Cell after the end of range of cells", "body": "<p>I have the following code:</p>\n\n<pre><code>Range(\"A1\").Select\nSelection.End(xlDown).Select\nRange(\"A55\").Select\nActiveCell.FormulaR1C1 = \"Signature\"\n</code></pre>\n\n<p>My Goal is relatively simple.  I have a range of data from A1 to E50, though the rows vary throughout several reports.  I am essentially using a recorded macro to help format a report quickly.  However, since the VBA is pointing at Cell A55 to add a signature line after the end of the data, I wanted to see if anyone has a quick fix to dynamically select X cells after the end of a dynamic range of data.</p>\n\n<p>Thank you in advance for your time in helping me out.</p>\n\n<p>Jesse</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1525220629, "post_id": 50125320, "comment_id": 87269128, "body": "Is it just a Dropdown Control or a whole UserForm with a dropdown? When you select the dropdown, assign the dropdown value to a String and then use it to change the sheet. ThisWorkbook.Sheet(SName).Activate"}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1525292163, "post_id": 50127160, "comment_id": 87303887, "body": "Did this work for you? If yes, please mark the response as so. If not, please share what issue you are having."}, {"owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "edited": false, "score": 0, "creation_date": 1525562497, "post_id": 50127160, "comment_id": 87406772, "body": "Don&#39;t think it worked not sure where you mean where should paste it and have no idea about the cell range."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "edited": false, "score": 0, "creation_date": 1525566541, "post_id": 50127160, "comment_id": 87407385, "body": "Which cell will show the sheet name? &amp; what sheet is that cell on?"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1525235185, "creation_date": 1525235185, "answer_id": 50127160, "question_id": 50125320, "link": "https://stackoverflow.com/questions/50125320/excel-vba-dropdown-menu-to-go-to-specific-sheet/50127160#50127160", "title": "Excel VBA - Dropdown Menu to go to specific sheet", "body": "<p>This needs to be pasted on the sheet where the cell will change (not in a module). Be sure to swap \"Sheet5\" and \"A2\" in the code to the sheet name and cell range on your excel. </p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\n  If Intersect(Target, ThisWorkbook.Sheets(\"Sheet5\").Range(\"A2\")) Is Nothing Then Exit Sub\n        Application.EnableEvents = False\n            On Error GoTo Stopsub:\n            Call ChangeSheet\nStopsub:\nApplication.EnableEvents = True\n\n\nEnd Sub\n\nSub ChangeSheet()\n\n        Dim SelectedSheet As String\n        SelectedSheet = ThisWorkbook.Sheets(\"Sheet5\").Range(\"A2\")\n        ThisWorkbook.Sheets(SelectedSheet).Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1525607059, "creation_date": 1525607059, "answer_id": 50199300, "question_id": 50125320, "link": "https://stackoverflow.com/questions/50125320/excel-vba-dropdown-menu-to-go-to-specific-sheet/50199300#50199300", "title": "Excel VBA - Dropdown Menu to go to specific sheet", "body": "<p>This is a slightly different concept, which uses hyperlinks to navigate through a workbook.  Hope it helps you out.</p>\n\n<pre><code>Sub BuildTOC_A3()\n   Cells(3, 1).Select\n   BuildTOC\nEnd Sub\nSub BuildTOC()\n  'listed from active cell down 7-cols --  DMcRitchie 1999-08-14 2000-09-05\n  Dim iSheet As Long, iBefore As Long\n  Dim sSheetName As String, sActiveCell As String\n  Dim cRow As Long, cCol As Long, cSht As Long\n  Dim lastcell\n  Dim qSht As String\n  Dim mg As String\n  Dim rg As Range\n  Dim CRLF As String\n  Dim Reply As Variant\n  Application.Calculation = xlCalculationManual\n  Application.ScreenUpdating = False\n  cRow = ActiveCell.Row\n  cCol = ActiveCell.Column\n  sSheetName = UCase(ActiveSheet.Name)\n  sActiveCell = UCase(ActiveCell.Value)\n  mg = \"\"\n  CRLF = Chr(10)  'Actually just CR\n  Set rg = Range(Cells(cRow, cCol), Cells(cRow - 1 + ActiveWorkbook.Sheets.Count, cCol + 7))\n  rg.Select\n  If sSheetName &lt;&gt; \"$$TOC\" Then mg = mg &amp; \"Sheetname is not $$TOC\" &amp; CRLF\n  If sActiveCell &lt;&gt; \"$$TOC\" Then mg = mg &amp; \"Selected cell value is not $$TOC\" &amp; CRLF\n  If mg &lt;&gt; \"\" Then\n     mg = \"Warning BuildTOC will destructively rewrite the selected area\" _\n     &amp; CRLF &amp; CRLF &amp; mg &amp; CRLF &amp; \"Press OK to proceed, \" _\n      &amp; \"the affected area will be rewritten, or\" &amp; CRLF &amp; _\n      \"Press CANCEL to check area then reinvoke this macro (BuildTOC)\"\n     Application.ScreenUpdating = True  'make range visible\n     Reply = MsgBox(mg, vbOKCancel, \"Create TOC for \" &amp; ActiveWorkbook.Sheets.Count _\n      &amp; \" items in workbook\" &amp; Chr(10) &amp; \"revised will now occupy up to 10 columns\")\n     Application.ScreenUpdating = False\n     If Reply &lt;&gt; 1 Then GoTo AbortCode\n  End If\n  rg.Clear      'Clear out any previous hyperlinks, fonts, etc in the area\n  For cSht = 1 To ActiveWorkbook.Sheets.Count\n     Cells(cRow - 1 + cSht, cCol) = \"'\" &amp; Sheets(cSht).Name\n     If TypeName(Sheets(cSht)) = \"Worksheet\" Then\n        'hypName = \"'\" &amp; Sheets(csht).Name\n        ' qSht = Replace(Sheets(cSht).Name, \"\"\"\", \"\"\"\"\"\") -- replace not in XL97\n        qSht = Application.Substitute(Sheets(cSht).Name, \"\"\"\", \"\"\"\"\"\")\n        If CDbl(Application.Version) &lt; 8# Then\n          '-- use next line for XL95\n          Cells(cRow - 1 + cSht, cCol + 2) = \"'\" &amp; Sheets(cSht).Name  'XL95\n        Else\n          '-- Only for XL97, XL98, XL2000 -- will create hyperlink &amp; codename\n          Cells(cRow - 1 + cSht, cCol + 2) = \"'\" &amp; Sheets(cSht).CodeName\n\n          '--- excel is not handling lots of objects well ---\n          'ActiveSheet.Hyperlinks.Add Anchor:=Cells(cRow - 1 + cSht, cCol), _\n          '  Address:=\"\", SubAddress:=\"'\" &amp; Sheets(cSht).Name &amp; \"'!A1\"\n          '--- so will use the HYPERLINK formula instead ---\n          '--- =HYPERLINK(\"[VLOOKUP.XLS]'$$TOC'!A1\",\"$$TOC\")\n          ActiveSheet.Cells(cRow - 1 + cSht, cCol).Formula = _\n            \"=hyperlink(\"\"[\" &amp; ActiveWorkbook.Name _\n            &amp; \"]'\" &amp; qSht &amp; \"'!A1\"\",\"\"\" &amp; qSht &amp; \"\"\")\"\n        End If\n     Else\n       Cells(cRow - 1 + cSht, cCol + 2) = \"'\" &amp; Sheets(cSht).Name\n     End If\n     Cells(cRow - 1 + cSht, cCol + 1) = TypeName(Sheets(cSht))\n    ' -- activate next line to include content of cell A1 for each sheet\n    ' Cells(cRow - 1 + csht, cCol + 3) = Sheets(Sheets(csht).Name).Range(\"A1\").Value\n     On Error Resume Next\n     Cells(cRow - 1 + cSht, cCol + 6) = Sheets(cSht).ScrollArea '.Address(0, 0)\n     Cells(cRow - 1 + cSht, cCol + 7) = Sheets(cSht).PageSetup.PrintArea\n     If TypeName(Sheets(cSht)) &lt;&gt; \"Worksheet\" Then GoTo byp7\n     Set lastcell = Sheets(cSht).Cells.SpecialCells(xlLastCell)\n     Cells(cRow - 1 + cSht, cCol + 4) = lastcell.Address(0, 0)\n     Cells(cRow - 1 + cSht, cCol + 5) = lastcell.Column * lastcell.Row\nbyp7: 'xxx\n     On Error GoTo 0\n  Next cSht\n\n  'Now sort the results:  2. Type(D), 1. Name (A), 3. module(unsorted)\n  rg.Sort Key1:=rg.Cells(1, 2), Order1:=xlDescending, Key2:=rg.Cells(1, 1) _\n      , Order2:=xlAscending, Header:=xlNo, OrderCustom:=1, MatchCase:=False, _\n      Orientation:=xlTopToBottom\n  rg.Columns.AutoFit\n  rg.Select           'optional\n  'if cells above range are blank want these headers\n  ' Worksheet,   Type,    codename\n  If cRow &gt; 1 Then\n     If \"\" = Trim(Cells(cRow - 1, cCol) &amp; Cells(cRow - 1, cCol + 1) &amp; Cells(cRow - 1, cCol + 2)) Then\n        Cells(cRow - 1, cCol) = \"Worksheet\"\n        Cells(cRow - 1, cCol + 1) = \"Type\"\n        Cells(cRow - 1, cCol + 2) = \"CodeName\"\n        Cells(cRow - 1, cCol + 3) = \"[opt.]\"\n        Cells(cRow - 1, cCol + 4) = \"Lastcell\"\n        Cells(cRow - 1, cCol + 5) = \"cells\"\n        Cells(cRow - 1, cCol + 6) = \"ScrollArea\"\n        Cells(cRow - 1, cCol + 7) = \"PrintArea\"\n     End If\n  End If\n  Application.ScreenUpdating = True\n  Reply = MsgBox(\"Table of Contents created.\" &amp; CRLF &amp; CRLF &amp; _\n     \"Would you like the tabs in workbook also sorted\", _\n     vbOKCancel, \"Option to Sort \" &amp; ActiveWorkbook.Sheets.Count _\n     &amp; \" tabs in workbook\")\n  Application.ScreenUpdating = False\n  'If Reply = 1 Then SortALLSheets  'Invoke macro to Sort Sheet Tabs\n  Sheets(sSheetName).Activate\nAbortCode:\n  Application.ScreenUpdating = True\n  Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7977215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ea889061458b83edca6cf5a20c723c?s=128&d=identicon&r=PG&f=1", "display_name": "RealHelper", "link": "https://stackoverflow.com/users/7977215/realhelper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1168, "favorite_count": 0, "accepted_answer_id": 50127160, "answer_count": 2, "score": -1, "last_activity_date": 1525607059, "creation_date": 1525218438, "question_id": 50125320, "link": "https://stackoverflow.com/questions/50125320/excel-vba-dropdown-menu-to-go-to-specific-sheet", "title": "Excel VBA - Dropdown Menu to go to specific sheet", "body": "<p>I want to make a dropdown that only contains 5/10 sheets that when i click on the sheet from the dropdown it proceeds to the sheet. At the moment I have a dropdown with all the sheets in it although I don't want them all.</p>\n\n<p>Hopefully someone understands. Please feel free to ask for more information.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "database", "ms-access"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1525218353, "post_id": 50125291, "comment_id": 87268671, "body": "use an <code>ElseIf</code> instead of the second <code>If</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9727816"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1525256722, "post_id": 50125291, "comment_id": 87282519, "body": "Hi again, I have built a login form for both trainers and members, they can both login into one form. However I would like to make sure when either the trainer or the member logs in, the message box pops up and should say. &quot;Welcome =[FirstName] &amp; &quot; &quot; &amp; [LastName]&quot;. So basically after welcome the members or the trainers fullname is displayed.  Can you please help me out, would really appreciate it, Thanks. My code is shown below."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9727816"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1525256754, "post_id": 50125291, "comment_id": 87282539, "body": "Option Compare Database  Private Sub Command9_Click()      Dim isTrainer As Boolean, isMember As Boolean      isTrainer = DCount(&quot;TrainerFirstName&quot;, &quot;tbl4_Trainers&quot;, _                  &quot;TrainerEmail = [txtEmail] And TrainerPassword = [txtPassword] &quot;) &gt; 0     isMember = DCount(&quot;MemberFirstName&quot;, &quot;tbl1_Members&quot;, _                  &quot;MemberEmail = [txtEmail] And MemberPassword = [txtPassword] &quot;) &gt; 0"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9727816"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1525256758, "post_id": 50125291, "comment_id": 87282541, "body": "If isTrainer Or isMember Then         MsgBox (&quot;Welcome &amp; = [TrainerFirstName] &amp; &quot; &quot; &amp; [TrainerLastName] or = [MemberFirstName] &amp; &quot; &quot; &amp; [MemberLastName] &quot;)         DoCmd.Close acForm, &quot;frm1_Member &amp; Trainer Login&quot;         If isTrainer Then             DoCmd.OpenForm &quot;frm3_Main Menu&quot;         Else             DoCmd.OpenForm &quot;frm2_Member Class Registration&quot;         End If      Else         MsgBox (&quot;Login Failed&quot;)     End If  End Sub"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9727816"}, "edited": false, "score": 0, "creation_date": 1525255013, "post_id": 50125601, "comment_id": 87281393, "body": "Thank you, Thank you, Thank you, I am so pleased that you helped me, I am so glad you helped me out Thanks my dear friend."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1525220872, "creation_date": 1525220872, "answer_id": 50125601, "question_id": 50125291, "link": "https://stackoverflow.com/questions/50125291/why-does-msgbox-pop-up-twice/50125601#50125601", "title": "Why does MsgBox pop up twice?", "body": "<pre><code>Private Sub Command9_Click()\n\n    Dim isTrainer As Boolean, isMember As Boolean\n\n    isTrainer = DCount(\"TrainerFirstName\", \"tbl4_Trainers\", _\n                 \"TrainerEmail = [txtEmail] And TrainerPassword = [txtPassword] \") &gt; 0\n    isMember = DCount(\"MemberFirstName\", \"tbl1_Members\", _\n                 \"MemberEmail = [txtEmail] And MemberPassword = [txtPassword] \") &gt; 0\n\n    If isTrainer Or isMember Then\n        MsgBox (\"Welcome\")\n        DoCmd.Close acForm, \"frm1_Member &amp; Trainer Login\"\n        If isTrainer Then\n            DoCmd.OpenForm \"frm3_Main Menu\"\n        Else\n            DoCmd.OpenForm \"frm2_Member Class Registration\"\n        End If\n\n    Else\n        MsgBox (\"Login Failed\")\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 9723901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33df4591b2be05bb1fd2e54dcc2a1a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Peters", "link": "https://stackoverflow.com/users/9723901/ian-peters"}, "is_accepted": true, "score": 0, "last_activity_date": 1525220957, "creation_date": 1525220957, "answer_id": 50125606, "question_id": 50125291, "link": "https://stackoverflow.com/questions/50125291/why-does-msgbox-pop-up-twice/50125606#50125606", "title": "Why does MsgBox pop up twice?", "body": "<p>Your code keeps running after the 1st End If.  It would be better to combine these two separate If statements together using an ElseIf, thereby only generating the failed message when both If statements are untrue.</p>\n\n<pre><code>Private Sub Command9_Click()\n\nIf (DCount(\"MemberFirstName\", \"tbl1_Members\", \"MemberEmail = [txtEmail] And MemberPassword = [txtPassword] \")) &gt; 0 Then\n    MsgBox (\"Welcome\")\n    DoCmd.Close acForm, \"frm1_Member &amp; Trainer Login\"\n    DoCmd.OpenForm \"frm2_Member Class Registration\"\nElseIf (DCount(\"TrainerFirstName\", \"tbl4_Trainers\", \"TrainerEmail = [txtEmail] And TrainerPassword = [txtPassword] \")) &gt; 0 Then\n    MsgBox (\"Welcome\")\n    DoCmd.Close acForm, \"frm1_Member &amp; Trainer Login\"\n    DoCmd.OpenForm \"frm3_Main Menu\"\nElse\n    MsgBox (\"Login Failed\")\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9727816"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 50125606, "answer_count": 2, "score": 1, "last_activity_date": 1605096977, "creation_date": 1525218239, "last_edit_date": 1605096977, "question_id": 50125291, "link": "https://stackoverflow.com/questions/50125291/why-does-msgbox-pop-up-twice", "title": "Why does MsgBox pop up twice?", "body": "<p>I am designing one login form for trainers and members.<br />\nIf a member logs in they are redirected to &quot;frm2_Member Class Registration&quot; form.<br />\nIf a trainer logs in they are redirected to &quot;frm3_Main Menu&quot; form.</p>\n<p>When the login button (Command9_Click) is clicked, the msgbox pops up correctly, but is displayed twice.<br />\nWhen the trainer logs on the msgbox says, Login Successful. Then another msgbox pops up straight away saying &quot;Login failed&quot;, however all the data is displayed correctly.<br />\nIt's just the msgboxes that do not work correctly.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command9_Click()\n    \nIf (DCount(&quot;MemberFirstName&quot;, &quot;tbl1_Members&quot;, &quot;MemberEmail = [txtEmail] And MemberPassword = [txtPassword] &quot;)) &gt; 0 Then\n    MsgBox (&quot;Welcome&quot;)\n    DoCmd.Close acForm, &quot;frm1_Member &amp; Trainer Login&quot;\n    DoCmd.OpenForm &quot;frm2_Member Class Registration&quot;\nElse\n    MsgBox (&quot;Login Failed&quot;)\nEnd If\n     \nIf (DCount(&quot;TrainerFirstName&quot;, &quot;tbl4_Trainers&quot;, &quot;TrainerEmail = [txtEmail] And TrainerPassword = [txtPassword] &quot;)) &gt; 0 Then\n    MsgBox (&quot;Welcome&quot;)\n    DoCmd.Close acForm, &quot;frm1_Member &amp; Trainer Login&quot;\n    DoCmd.OpenForm &quot;frm3_Main Menu&quot;\nElse\n    MsgBox (&quot;Login Failed&quot;)\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-word", "mailmerge", "vba"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1525240930, "post_id": 50125244, "comment_id": 87273786, "body": "did you consider copy-paste action? is it an option in your situation?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1525250472, "post_id": 50125244, "comment_id": 87278569, "body": "Have you considered extracting the tables/ranges from Excel as images and then mail-merging the images into Word?"}, {"owner": {"reputation": 27, "user_id": 9700207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/396812f25dac013b6a1c1d0875cf32aa?s=128&d=identicon&r=PG&f=1", "display_name": "Don Don", "link": "https://stackoverflow.com/users/9700207/don-don"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1525265350, "post_id": 50125244, "comment_id": 87288065, "body": "@Kazimierz Jawor - I am dealing with an excel and word model template. If I used the copy and paste method I believe it will always be linked to the original spreadsheet or is there a way to change this in Word like in Excel (Data, edit links, etc.).."}, {"owner": {"reputation": 27, "user_id": 9700207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/396812f25dac013b6a1c1d0875cf32aa?s=128&d=identicon&r=PG&f=1", "display_name": "Don Don", "link": "https://stackoverflow.com/users/9700207/don-don"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1525265480, "post_id": 50125244, "comment_id": 87288135, "body": "@Xabier - I am interested in this method. Would you be able to send me a link to a website where I can learn more or can you describe how to do this. Thanks."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525277329, "post_id": 50125244, "comment_id": 87296388, "body": "These multiple cell ranges: are we talking about a one-to-many kind of relationship. For example a list of orders for a company?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1525277539, "post_id": 50125244, "comment_id": 87296515, "body": "@DonDon, you can past special in different modes, not only as a linked to excel"}, {"owner": {"reputation": 27, "user_id": 9700207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/396812f25dac013b6a1c1d0875cf32aa?s=128&d=identicon&r=PG&f=1", "display_name": "Don Don", "link": "https://stackoverflow.com/users/9700207/don-don"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525288070, "post_id": 50125244, "comment_id": 87301862, "body": "@Cindy Meister I think so. For example a chart that notes historical and projected profit and loss numbers for multiple years for one company."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1525363647, "post_id": 50125244, "comment_id": 87336702, "body": "Check out the &quot;Special Merges&quot; at this site and tell me which comes closest to what you&#39;re thinking of: <a href=\"http://homepage.swissonline.ch/cindymeister/MergFram.htm\" rel=\"nofollow noreferrer\">homepage.swissonline.ch/cindymeister/MergFram.htm</a>"}, {"owner": {"reputation": 27, "user_id": 9700207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/396812f25dac013b6a1c1d0875cf32aa?s=128&d=identicon&r=PG&f=1", "display_name": "Don Don", "link": "https://stackoverflow.com/users/9700207/don-don"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525381312, "post_id": 50125244, "comment_id": 87345571, "body": "@Cindy Meister - That is an incredible website that you put together. Bravo! I am still trying to figure out what you mean by, &quot;Create a chart for each record in Excel. Add a column to the data table and enter the name of the appropriate chart for each record. Use this merge field in LINK field in the mail merge document.&quot;"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525450078, "post_id": 50125244, "comment_id": 87375302, "body": "As mentioned in the other discussion: I&#39;m not sure we mean the same thing with &quot;chart&quot;..."}, {"owner": {"reputation": 27, "user_id": 9700207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/396812f25dac013b6a1c1d0875cf32aa?s=128&d=identicon&r=PG&f=1", "display_name": "Don Don", "link": "https://stackoverflow.com/users/9700207/don-don"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525798471, "post_id": 50125244, "comment_id": 87494671, "body": "@Cindy Meister - By chart, I meant a table or a group of cells under a named range."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525799316, "post_id": 50125244, "comment_id": 87495085, "body": "Right. Then you do NOT want the section on charts on my website as that&#39;s not applicable. You want the &quot;multiple items&quot; part. Assuming the goal is a one-to-many listing of items for each merge entry."}, {"owner": {"reputation": 27, "user_id": 9700207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/396812f25dac013b6a1c1d0875cf32aa?s=128&d=identicon&r=PG&f=1", "display_name": "Don Don", "link": "https://stackoverflow.com/users/9700207/don-don"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1525800471, "post_id": 50125244, "comment_id": 87495679, "body": "@Cindy Meister - In the section &quot;Group multiple items for a single condition&quot;, The sample file in number #1 does not lead the user to the file. Also, would number 3 or 4 work with excel or only Access?"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 1, "last_activity_date": 1525606825, "creation_date": 1525606825, "answer_id": 50199258, "question_id": 50125244, "link": "https://stackoverflow.com/questions/50125244/excel-to-word-mail-merge-charts-tables-name-ranges-covering-multiple-cell/50199258#50199258", "title": "Excel to Word - Mail Merge - Charts, Tables &amp; name ranges covering multiple cells", "body": "<p>You could use DocVariables for this.</p>\n\n<pre><code>Sub PushToWord()\n\nDim objWord As New Word.Application\nDim doc As Word.Document\nDim bkmk As Word.Bookmark\nsWdFileName = Application.GetOpenFilename(, , , , False)\nSet doc = objWord.Documents.Open(sWdFileName)\n'On Error Resume Next\n\nobjWord.ActiveDocument.variables(\"BrokerFirstName\").Value = Range(\"BrokerFirstName\").Value\nobjWord.ActiveDocument.variables(\"BrokerLastName\").Value = Range(\"BrokerLastName\").Value\nobjWord.ActiveDocument.variables(\"Ryan\").Value = Range(\"Ryan\").Value\n\n\nobjWord.ActiveDocument.Fields.Update\n\n'On Error Resume Next\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>Run the code from Excel.</p>\n\n<pre><code>In the Excel VBA Editor: Tools-&gt;References-&gt;Microsoft Word x\n\nInsert-&gt;Field-&gt;Category:DocumentAutomation-&gt;Field Names:DocVariable-&gt;Field Codes Button-&gt; Then enter the name of the variable.\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9700207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/396812f25dac013b6a1c1d0875cf32aa?s=128&d=identicon&r=PG&f=1", "display_name": "Don Don", "link": "https://stackoverflow.com/users/9700207/don-don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1113, "favorite_count": 0, "accepted_answer_id": 50199258, "answer_count": 1, "score": 0, "last_activity_date": 1525606825, "creation_date": 1525217766, "last_edit_date": 1531161705, "question_id": 50125244, "link": "https://stackoverflow.com/questions/50125244/excel-to-word-mail-merge-charts-tables-name-ranges-covering-multiple-cell", "title": "Excel to Word - Mail Merge - Charts, Tables &amp; name ranges covering multiple cells", "body": "<p>I am trying to figure out the best way to send information from Excel to Word. I am currently using a data source created in excel (.csv) to send information to Word via mail merge. I have only figured out how to mail merge individual referenced cells and my data source has thousands of fields. I was wondering if it is possible to use mail merge or other technology to send either tables or a named ranges referencing multiple cells from Excel into Word. Ideally if I can send multiple cells at once I hopefully would not have to format each field. Any help or ideas would be much appreciated.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 7150108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6275ac0064e7ad3bebdd8eaa196b0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Beth", "link": "https://stackoverflow.com/users/7150108/emily-beth"}, "edited": false, "score": 0, "creation_date": 1525274391, "post_id": 50125524, "comment_id": 87294535, "body": "Same exact behavior.  It works if I step through it, but doesn&#39;t work if I just let the code run."}, {"owner": {"reputation": 126, "user_id": 9335838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7emd.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9335838/mike"}, "reply_to_user": {"reputation": 485, "user_id": 7150108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6275ac0064e7ad3bebdd8eaa196b0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Beth", "link": "https://stackoverflow.com/users/7150108/emily-beth"}, "edited": false, "score": 0, "creation_date": 1526010489, "post_id": 50125524, "comment_id": 87585531, "body": "Sounds like there might be another event triggering?   e.g. the OnCurrent of your subform?   If so, &quot;exit sub&quot; or &quot;exit function&quot; right at the top of the other events VBA code (just add those lines in temporarily, as a test) because the above code quoted above is working fine by itself in the example I mocked up"}], "tags": [], "owner": {"reputation": 126, "user_id": 9335838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7emd.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9335838/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1525220273, "creation_date": 1525220273, "answer_id": 50125524, "question_id": 50125065, "link": "https://stackoverflow.com/questions/50125065/different-access-vba-code-results-depending-on-whether-breakpoint-is-set/50125524#50125524", "title": "Different Access VBA code results depending on whether breakpoint is set", "body": "<p>Create a RecordsetClone using the recordset of the subform</p>\n\n<p>Then after navigating via code inside your cloned recordset, \nset the Bookmark of your subform to equal that of the clone.</p>\n\n<p>e.g.</p>\n\n<pre><code>Dim rsClone As Recordset\nDim intMoveBack As Integer\nDim intCount As Integer\n\nSet rsClone = Me.CaseNotes.Form.RecordsetClone\nintMoveBack = 4\n\n\nIf Not (rsClone.EOF And rsClone.BOF) Then  'there is at least one record in the subform\n\n    rsClone.MoveLast\n\n    For intCount = 1 To intMoveBack - 1\n        If Not (rsClone.BOF) Then\n            rsClone.MovePrevious\n        End If\n    Next\n\n    If rsClone.BOF Then   'we have moved back past the first record, so step forward one\n        rsClone.MoveNext\n    End If\n\n    Me.CaseNotes.SetFocus   'setfocus to the subform\n\n    With Me.CaseNotes.Form\n        .Bookmark = rsClone.Bookmark\n        .AnyControlOnYourSubform.SetFocus   'replace this with the name of a control on your subform\n        .Recordset.AddNew\n    End With\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 7150108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6275ac0064e7ad3bebdd8eaa196b0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Beth", "link": "https://stackoverflow.com/users/7150108/emily-beth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525220273, "creation_date": 1525216468, "question_id": 50125065, "link": "https://stackoverflow.com/questions/50125065/different-access-vba-code-results-depending-on-whether-breakpoint-is-set", "title": "Different Access VBA code results depending on whether breakpoint is set", "body": "<p>I have an odd circumstance related to an Access form.  I have a parent form (shown in Single Form view) with a subform (shown in Continuous Forms view).  The parent form displays records (one at a time) for each project, and the subform display notes (all of them) for each project.</p>\n\n<p>The notes subform can have dozens or hundreds of records for each project record.  And to make it convenient for the users to just start typing notes into the form right when they pull up a record, I have code in the parent form's on current event that \"positions\" the records in the subform to show the bottom four existing records and then one record where they can start entering text.  That code looks like the following:</p>\n\n<pre><code>Dim mymove As Integer\nDim c As Integer\n\n'' Attempt to scroll down in the CaseNotes subform to a convienent location\n'' so that user can read the most recent note and has access to the next\n'' blank note\nWith Me.CaseNotes.Form.Recordset\n\n    ' Load the # of notes for this record\n    c = .RecordCount\n\n    ' The display shows only 5 notes.  Otherwise, you have to scroll.\n    ' If there are more than 4 notes, we want to display just the last\n    ' four and then have a blank line where a new note can be entered.\n    ' The following code makes the moves necessary for this.\n    If c &lt;= 4 Then mymove = c Else mymove = 4\n\n    If mymove &gt; 0 Then\n      .MoveLast\n      .Move -mymove\n    End If\n\n    'move to new record\n    .AddNew\n\nEnd With\n</code></pre>\n\n<p>This code has worked for a million years, and no problems generally with it.  However, recently we added a combobox control to the parent form that allows users to select a data source for the parent form.  The after update event for that combobox changes the parent form's RecordSource according to the value the user selected.</p>\n\n<p>Once we implemented that, our positioning code no longer works right after you change the data source.  So you choose a new data source, it loads the new data on the parent form and on the subforms, and then the notes subform correctly positions itself (using the code above), but then right before it hands over control to the user, it reverts back to the original (bad) position for the notes.  Not clear why.  The positioning code <em>is</em> running (I set a breakpoint and stepped through the code), but it's being undone somehow.</p>\n\n<p>Anyway, to outsmart that, I added some additional code to the combobox's after update event code to re-run the positioning code after the RecordSource is set.  Here's where things get weird.  This code works fine... <em>as long as I step through it manually</em>.  If I do that (set a breakpoint and keep hitting F8), then it goes through the positioning code and leaves me right where I want to be.  But if I don't set a breakpoint and just let the code roll on its own, it doesn't work.  It seems to do the positioning, but then it reverts back to the initial (bad) subform position right before it gives me control of the form back.</p>\n\n<p>There seems to be absolutely no difference there.  In one case I step through manually, and in the other case the code just runs by itself.  It should give the same result, I'd think.  Why might this give different results, and what might I do to address this?</p>\n\n<p>I have some general sense that different events are firing depending on whether I set a breakpoint, but not sure where to even start in terms of debugging.  Any help is super appreciated.</p>\n\n<p>I'm running Access 2013 32 bit, on Windows 7, if it's useful at all.</p>\n"}, {"tags": ["vba", "excel", "offset"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9504090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc01d1712f4c0bcbbf3818b8fb0fa12a?s=128&d=identicon&r=PG", "display_name": "JotHa", "link": "https://stackoverflow.com/users/9504090/jotha"}, "edited": false, "score": 0, "creation_date": 1525214576, "post_id": 50124762, "comment_id": 87267787, "body": "Thanks so much! That got me on the right track. What I used in the end was just a paste step in between and instead of pastespecial it was select.     Range(Selection, Selection.End(xlToRight)).Select     Selection.Cut     ActiveCell.Offset(0, 2).Select     ActiveSheet.Paste"}, {"owner": {"reputation": 31, "user_id": 9504090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc01d1712f4c0bcbbf3818b8fb0fa12a?s=128&d=identicon&r=PG", "display_name": "JotHa", "link": "https://stackoverflow.com/users/9504090/jotha"}, "edited": false, "score": 0, "creation_date": 1525214665, "post_id": 50124762, "comment_id": 87267813, "body": "Already done so! Maybe just add the code I used, to show the additional select and paste steps. The PasteSpecial didn&#39;t work for me."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 31, "user_id": 9504090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc01d1712f4c0bcbbf3818b8fb0fa12a?s=128&d=identicon&r=PG", "display_name": "JotHa", "link": "https://stackoverflow.com/users/9504090/jotha"}, "edited": false, "score": 0, "creation_date": 1525214825, "post_id": 50124762, "comment_id": 87267872, "body": "Done. As soon as I get by any PC I\u2019ll post a solution without all that \u201cselections\u201d"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1525214752, "last_edit_date": 1525214752, "creation_date": 1525213967, "answer_id": 50124762, "question_id": 50124675, "link": "https://stackoverflow.com/questions/50124675/offset-vba-range-based-upon-leftmost-cell/50124762#50124762", "title": "Offset VBA Range based upon leftmost cell", "body": "<p>Try this (untested):</p>\n\n<pre><code>Range(Selection, Selection.End(xlToRight)).Select\nSelection.Cut ActiveCell.Offset(0, 2).Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1525214351, "creation_date": 1525214351, "answer_id": 50124811, "question_id": 50124675, "link": "https://stackoverflow.com/questions/50124675/offset-vba-range-based-upon-leftmost-cell/50124811#50124811", "title": "Offset VBA Range based upon leftmost cell", "body": "<p>Not sure if I've understood correctly, but aren't you just inserting three cells to the right at the ActiveCell?</p>\n\n<p>How about this instead?</p>\n\n<pre><code>Range(ActiveCell, ActiveCell.Offset(0, 2)).Insert Shift:=xlToRight\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9504090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc01d1712f4c0bcbbf3818b8fb0fa12a?s=128&d=identicon&r=PG", "display_name": "JotHa", "link": "https://stackoverflow.com/users/9504090/jotha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 50124762, "answer_count": 2, "score": 0, "last_activity_date": 1525214752, "creation_date": 1525213418, "last_edit_date": 1531164843, "question_id": 50124675, "link": "https://stackoverflow.com/questions/50124675/offset-vba-range-based-upon-leftmost-cell", "title": "Offset VBA Range based upon leftmost cell", "body": "<p>I would like to copy all data to the right of a cell and paste it 3 cells to the right of the first selected cell. I am using the following code, but it keeps on jumping 3 columns to the right of the end of the selection.</p>\n\n<pre><code>Range(Selection, Selection.End(xlToRight)).Select\nSelection.Cut\nRange(ActiveCell.Offset(0, 2)).Select\nActiveSheet.Paste\n</code></pre>\n\n<p>Is there a way to use the first cell of the selection as the reference for the shift?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "edited": false, "score": 0, "creation_date": 1525264249, "post_id": 50124793, "comment_id": 87287297, "body": "Thanks--that works perfectly. I really appreciate the explanation too."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1525214549, "last_edit_date": 1525214549, "creation_date": 1525214242, "answer_id": 50124793, "question_id": 50124511, "link": "https://stackoverflow.com/questions/50124511/excel-vba-macro-to-set-alignment-left-if-a-cell-contains-a-string-in-any-workshe/50124793#50124793", "title": "Excel VBA Macro to Set alignment left if a cell contains a string in ANY worksheet", "body": "<p>The main issue with your code is that you were setting SrchRng only outside the worksheets loop and without any explicit worksheets qualification, so that it was set for the currently \u201cactive\u201d sheet at the moment of its setting and never changed inside the loop</p>\n\n<p>So you may want to use this code:</p>\n\n<pre><code>Dim cel As Range\nDim WS As Worksheet\n\nFor Each WS In Worksheets\n    For Each cel In WS.Range(\"$A1:$AZ200\")\n        If InStr(1, cel.Value, \"Figure\") &gt; 0 Then cel.HorizontalAlignment = xlHAlignLeft\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9727603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb0004b7f170d023d41c9248a0b0b96?s=128&d=identicon&r=PG&f=1", "display_name": "Angiebio", "link": "https://stackoverflow.com/users/9727603/angiebio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2049, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525241642, "creation_date": 1525212380, "last_edit_date": 1525241642, "question_id": 50124511, "link": "https://stackoverflow.com/questions/50124511/excel-vba-macro-to-set-alignment-left-if-a-cell-contains-a-string-in-any-workshe", "title": "Excel VBA Macro to Set alignment left if a cell contains a string in ANY worksheet", "body": "<p>I can get this to work on one worksheet, but not for ALL worksheets. I want to find any cell containing the word \"Figure\" in the cell string and set the alignment of that cell to left justified. What am I doing wrong here?</p>\n\n<p>'If any cell in the worksheet contains the word FIGURE align it to left</p>\n\n<pre><code>Dim SrchRng As Range, cel As Range\n\nSet SrchRng = Range(\"$A1:$AZ200\")\n\nFor Each WS In Worksheets\n     With WS\n\n        For Each cel In SrchRng\n            If InStr(1, cel.Value, \"*Figure*\") &gt; 0 Then\n                cel.HorizontalAlignment = xlHAlignLeft\n            End If\n        Next cel\n\n     End With\nNext WS\n</code></pre>\n"}, {"tags": ["excel", "error-handling", "file-copying", "vba"], "comments": [{"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1525232550, "post_id": 50124166, "comment_id": 87271526, "body": "You can catch and handle the error any way you want, and the way you suggested would probably work fine. Personally I would check the file path in the <code>FileCopy</code> sub with something like <code>If Dir(str1, vbDirectory) = &quot;&quot; Then copy the file Else your msgbox about what to do with the file</code>. This should prevent you from throwing error in the first place. You should still handle Runtime Error 70 in the event something goes awry."}, {"owner": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1525274053, "post_id": 50124166, "comment_id": 87294326, "body": "Hey Tyeler, Thanks. I wound up using:If Len(Dir(Application.ActiveWorkbook.Path &amp; &quot;\\&quot; &amp; Range(&quot;A1&quot;).Value &amp; &quot;.docx&quot;)) = 0 Then ... Else ... Works great. Appreciate it."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1525361603, "post_id": 50124166, "comment_id": 87335418, "body": "Im glad it worked out for you. FYI using Len(Dir()) = 0 or Dir() = &quot;&quot; will both achieve the same thing."}], "owner": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525210453, "creation_date": 1525210453, "last_edit_date": 1531164843, "question_id": 50124166, "link": "https://stackoverflow.com/questions/50124166/filecopy-file-already-exists-runtime-error-70-permission-denied", "title": "FileCopy: File Already Exists - Runtime error &#39;70&#39; Permission Denied&#39;", "body": "<p>trying to set up an error-handling technique on this bit of code I have.</p>\n\n<pre><code>Dim str1 As String\nDim PlanDocTemplate As String\nDim answer1 As String\n\nanswer1 = MsgBox(\"Is this Workbook saved in the appropriate folder?\", vbYesNo + vbQuestion)\n\nIf answer1 = vbNo Then\n    MsgBox (\"Please save this Workbook in the appropriate folder then run again.\")\n    Exit Sub\nElse\n    'do nothing\nEnd If\n\nstr1 = \"C:\\user\\desktop\\document.docx\"\nPlanDocTemplate = Application.ActiveWorkbook.path &amp; \"\\\" &amp; Range(\"A1\").Value &amp; \".docx\"\n\nCall FileCopy(str1, PlanDocTemplate)\n</code></pre>\n\n<p>Now currently this works fine, but if the user runs the macro once, then again without deleting/renaming the doc that was created from the macro, it results in a Runtime error 70. </p>\n\n<p>Wondering what's the best way to handle this error? Can I have vba ask the user Yes/No \"Would you like to delete the original existing document?\" No would End the Sub and Yes would delete the original document and continue with the rest of my code.</p>\n\n<p>Thanks all,\nRich</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9304993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b755e9a517fbb0ee56ec7acb642acc?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus KXCom", "link": "https://stackoverflow.com/users/9304993/marcus-kxcom"}, "edited": false, "score": 1, "creation_date": 1525274944, "post_id": 50125513, "comment_id": 87294872, "body": "Hi, and thanks for a great reply!! This seems like the way into the right direction, but doing this I am running into an issue where (as I have googled) is that ThisWorkbook.Connections(&quot;Myqueryname&quot;) isn&#39;t defined, or is in the wrong workbook. Can this be because of the language in my Excel? In Norwegian, if you would like to perform an if statement (not in VBA as far as I know), you would have to type HVIS() instead of IF(). The error I get is: Subscript out of range. You got any idea on what&#39;s wrong here? The line it&#39;s pointing at is the ThisWorkbook.Connections in the debugger."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "reply_to_user": {"reputation": 65, "user_id": 9304993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b755e9a517fbb0ee56ec7acb642acc?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus KXCom", "link": "https://stackoverflow.com/users/9304993/marcus-kxcom"}, "edited": false, "score": 0, "creation_date": 1525300969, "post_id": 50125513, "comment_id": 87307359, "body": "I didn&#39;t realise that the prefix to the query name might be localised. You could try &quot;Sp&#248;rsm&#229;l - &quot; (which Google suggested as a translation for &quot;query&quot;) followed by your query name. I&#39;ll update the question with some code to list the names of all of the connections in the workbook which should help you find the exact name you need"}, {"owner": {"reputation": 65, "user_id": 9304993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b755e9a517fbb0ee56ec7acb642acc?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus KXCom", "link": "https://stackoverflow.com/users/9304993/marcus-kxcom"}, "edited": false, "score": 1, "creation_date": 1525303625, "post_id": 50125513, "comment_id": 87307920, "body": "That did the trick good sir! Thank you for the amazing help, I would never have gotten this far myself."}, {"owner": {"reputation": 55, "user_id": 2087577, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bc31061490722560189f5fe644149fea?s=128&d=identicon&r=PG", "display_name": "Paul Rathbone", "link": "https://stackoverflow.com/users/2087577/paul-rathbone"}, "edited": false, "score": 0, "creation_date": 1616785600, "post_id": 50125513, "comment_id": 118121577, "body": "Thanks for this, it helped me do something similar."}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 7, "last_activity_date": 1525301871, "last_edit_date": 1525301871, "creation_date": 1525220165, "answer_id": 50125513, "question_id": 50124103, "link": "https://stackoverflow.com/questions/50124103/running-a-web-query-with-parameter-from-a-cell-within-excel/50125513#50125513", "title": "Running a web query with parameter from a cell within Excel", "body": "<p>Adapting from <a href=\"https://stackoverflow.com/a/48956592/2127508\">this answer</a>, this is a two-step process.</p>\n\n<p>Firstly, create a named range for the cell that stores the value you will pass to the query. Details on how to do so are <a href=\"https://support.office.com/en-us/article/define-and-use-names-in-formulas-4d0f13ac-53b7-422e-afd2-abd7ff379c64#bmquickly_name_a_cell_or_range_of_cells\" rel=\"noreferrer\">here</a>. I used \"StationName\" as the name of the range but you can use any name you like.</p>\n\n<p>Secondly, we need to incorporate the named range into the source for the query. To do so:</p>\n\n<ul>\n<li>select any cell in the data table from the current query</li>\n<li>click on the Query tab in the ribbon</li>\n<li>click on Edit</li>\n<li>look for the Query Settings panel at the right of the screen - if it's not there, go to View then click on Query Settings</li>\n<li>the first entry in the Query Settings panel should be Source - click on that entry to select it</li>\n<li>make sure that the formula bar is displayed by going to View then checking Formula Bar</li>\n<li>the entry in the formula bar is too long to display so click on the V symbol at the end of the formula bar to expand it</li>\n<li>edit the formula bar text to the text shown below - make sure to change the name of the Excel range shown at <code>Name=\"StationName\"</code> to whichever name you have used</li>\n</ul>\n\n<p><code>= Xml.Tables(Web.Contents(\"https://www.aviationweather.gov/adds/dataserver_current/httpparam?dataSource=metars&amp;requestType=retrieve&amp;format=xml&amp;stationString=\" &amp; Excel.CurrentWorkbook(){[Name=\"StationName\"]}[Content]{0}[Column1] &amp; \"&amp;hoursBeforeNow=1\"))</code></p>\n\n<p>This picture shows how things should now look:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SxEgb.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/SxEgb.png\" alt=\"The Excel Power Query formula bar showing the formula: = Xml.Tables(Web.Contents(&quot;https://www.aviationweather.gov/adds/dataserver_current/httpparam?dataSource=metars&amp;requestType=retrieve&amp;format=xml&amp;stationString=&quot; &amp; Excel.CurrentWorkbook(){[Name=&quot;StationName&quot;]}[Content]{0}[Column1] &amp; &quot;&amp;hoursBeforeNow=1&quot;))\"></a></p>\n\n<p>Now go to Home and click on Close &amp; Load.</p>\n\n<p>You may get a warning about privacy settings - to fix this, I chose to give both the Excel file and the aviationweather.gov site the \"public\" level of privacy.</p>\n\n<p>You can access the privacy settings by selecting a cell in the data table, going to Query and choosing Edit, going to Home and choosing Data Source Settings, selecting Global Permissions and then using Edit Permissions on the relevant entries.</p>\n\n<p>To make the query automatically refresh when the cell value changes, we need to use some VBA. We will need to know which sheet the cell is on, the name of the named range which refers to that cell and the name of the query we want to refresh. The first two should be straightforward and the name of the query is just \"Query - \" followed by the name shown in the Queries &amp; Connections panel.</p>\n\n<p>Open up the VBA Editor with ALT-F11, double-click on the relevant sheet object in the Project Explorer to open up the related code module and paste in the following code (but change the name of the named range and the name of the query to match your names):</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Application.Intersect(Target, ThisWorkbook.Names(\"StationName\").RefersToRange) _\n    Is Nothing And Target.Cells.Count = 1 Then\n    Application.EnableEvents = False\n    ThisWorkbook.Connections(\"Query - Get station from aviationweather dot gov\").Refresh\n    Application.EnableEvents = True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Now changing the cell value should cause the query to refresh automatically</p>\n\n<hr>\n\n<p>Here's some simple code to list the name of every connection in the workbook. In the VBA editor, use Insert > Module to create a new module and then paste in the following code:</p>\n\n<pre><code>Option Explicit\n\nSub listConnections()\n\nDim c As WorkbookConnection\n\nFor Each c In ThisWorkbook.Connections\n    MsgBox c.Name\nNext c\n\nEnd Sub\n</code></pre>\n\n<p>Each connection name will pop up in a message box like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2XvZ7.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/2XvZ7.png\" alt=\"An Excel message box with the text: Query - Get station from aviationweather dot gov\"></a></p>\n\n<p>and you can just copy the name you need when it pops up. You can copy the message box contents just by hitting CTRL-C but you'll need to edit out some extra stuff when you paste. Copying the message box shown above results in the following text being placed on the clipboard:</p>\n\n<pre><code>---------------------------\nMicrosoft Excel\n---------------------------\nQuery - Get station from aviationweather dot gov\n---------------------------\nOK   \n---------------------------\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1307, "user_id": 5148420, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/6snPk.jpg?s=128&g=1", "display_name": "jhhwilliams", "link": "https://stackoverflow.com/users/5148420/jhhwilliams"}, "edited": false, "score": 0, "creation_date": 1619166304, "post_id": 61267333, "comment_id": 118827630, "body": "How do you create a new connection with type &quot;Web Query&quot;? I can only manage to create a &quot;OLE DB Query&quot; and the Parameters button is disabled."}], "tags": [], "owner": {"reputation": 11, "user_id": 13337745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66926f1bc8be817595eaee14b1a71893?s=128&d=identicon&r=PG&f=1", "display_name": "izvarin", "link": "https://stackoverflow.com/users/13337745/izvarin"}, "is_accepted": false, "score": 1, "last_activity_date": 1587112930, "last_edit_date": 1587112930, "creation_date": 1587112610, "answer_id": 61267333, "question_id": 50124103, "link": "https://stackoverflow.com/questions/50124103/running-a-web-query-with-parameter-from-a-cell-within-excel/61267333#61267333", "title": "Running a web query with parameter from a cell within Excel", "body": "<p>I get daily Exchange Rate data from cbr.ru in this fashion.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5bOMn.png\" rel=\"nofollow noreferrer\">screenshot of the Connection</a></p>\n\n<p><a href=\"http://www.cbr.ru/eng/currency_base/daily/?UniDbQuery.Posted=True&amp;UniDbQuery.To=[\" rel=\"nofollow noreferrer\">http://www.cbr.ru/eng/currency_base/daily/?UniDbQuery.Posted=True&amp;UniDbQuery.To=[</a>\"Ticker\"]</p>\n\n<p>Where i use the date as a variable from an excel cell, in such a way that it refreshes automatically once the cell value changes. \n(named the parameter as Ticker)</p>\n\n<p><a href=\"https://i.stack.imgur.com/tBmjq.png\" rel=\"nofollow noreferrer\">screenshot of the Parameters</a></p>\n\n<p>Hope this uber simple method helps.</p>\n"}], "owner": {"reputation": 65, "user_id": 9304993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b755e9a517fbb0ee56ec7acb642acc?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus KXCom", "link": "https://stackoverflow.com/users/9304993/marcus-kxcom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5207, "favorite_count": 2, "accepted_answer_id": 50125513, "answer_count": 2, "score": 2, "last_activity_date": 1587112930, "creation_date": 1525210167, "last_edit_date": 1531161705, "question_id": 50124103, "link": "https://stackoverflow.com/questions/50124103/running-a-web-query-with-parameter-from-a-cell-within-excel", "title": "Running a web query with parameter from a cell within Excel", "body": "<p>I am trying to do a GET request when I change a value in a cell.</p>\n\n<p>The link here: </p>\n\n<pre><code>https://www.aviationweather.gov/adds/dataserver_current/httpparam?dataSource=metars&amp;requestType=retrieve&amp;format=xml&amp;stationString=(PARAMETER SHOULD BE HERE)&amp;hoursBeforeNow=1\n</code></pre>\n\n<p>So what's in this cell, should change this query.\nIs this possible, and if so, does anyone have a good solution for this?\nBeen trying to google all night but can't seem to find anyone that has done the same thing.\n<a href=\"https://i.stack.imgur.com/4jTnA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4jTnA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "pdf", "sendkeys"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9727175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47377006c2deb98b888a8eb800e135b?s=128&d=identicon&r=PG&f=1", "display_name": "bgg1992", "link": "https://stackoverflow.com/users/9727175/bgg1992"}, "edited": false, "score": 0, "creation_date": 1525280275, "post_id": 50124200, "comment_id": 87297999, "body": "Hi Ricardo, thank you for the code, I checked that changing only BringWindowToTop to AppActivate (as you suggested) makes the code working as well."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "reply_to_user": {"reputation": 13, "user_id": 9727175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47377006c2deb98b888a8eb800e135b?s=128&d=identicon&r=PG&f=1", "display_name": "bgg1992", "link": "https://stackoverflow.com/users/9727175/bgg1992"}, "edited": false, "score": 0, "creation_date": 1525360710, "post_id": 50124200, "comment_id": 87334860, "body": "Glad I helped in some way."}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1525210595, "creation_date": 1525210595, "answer_id": 50124200, "question_id": 50123824, "link": "https://stackoverflow.com/questions/50123824/vba-sendkeys-to-another-window-not-working/50124200#50124200", "title": "VBA SendKeys to another window not working", "body": "<p>Try This approach. Tested and Working. You may change the Wait numbers to make the delay longer. Make sure the PDF files are named properly and there are no extra Spaces on the file name.</p>\n\n<pre><code>Sub switching_pdfs()\n    Dim i As Integer, j As Integer\n    Dim ptr1 As String, ptr2 As String\n    ptr1 = \"Some PDF 1.pdf - Acrobat Reader\"\n    ptr2 = \"Some PDF 2.pdf - Acrobat Reader\"\n\n    For i = 1 To 30\n        For j = 1 To 4\n           AppActivate ptr1\n           Wait 0.5\n           AppActivate ptr2\n           Wait 0.5\n        Next j\n        AppActivate ptr1\n        Send \"{RIGHT}\"\n        Wait 1\n        AppActivate ptr2\n        Send \"{RIGHT}\"\n        Wait 1\n    Next i\nEnd Sub\nFunction Send(pData As String)\n    SendKeys pData, True\n    Wait 0.5\nEnd Function\nFunction Wait(Optional pWaitTime As Single = 0.1)\n    Dim StartTime\n    StartTime = Timer\n    Do While (Timer &lt; StartTime + pWaitTime)\n        DoEvents\n    Loop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9727175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47377006c2deb98b888a8eb800e135b?s=128&d=identicon&r=PG&f=1", "display_name": "bgg1992", "link": "https://stackoverflow.com/users/9727175/bgg1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1198, "favorite_count": 0, "accepted_answer_id": 50124200, "answer_count": 1, "score": 1, "last_activity_date": 1525210595, "creation_date": 1525208717, "question_id": 50123824, "link": "https://stackoverflow.com/questions/50123824/vba-sendkeys-to-another-window-not-working", "title": "VBA SendKeys to another window not working", "body": "<p>I have the following macro which is intended to quickly switch two PDFs. After 8 quick switches macro should go to the next pages of both PDFs and repeat the procedure. Unfortunately, macro scrolls first declared PDF only. Any ideas how to amend it?</p>\n\n<pre><code>Private Declare PtrSafe Function BringWindowToTop Lib \"user32\" (ByVal lngHWnd As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr\n\nPrivate Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMiliseconds As Long)\n\n\nSub switching_pdfs()\n\nDim i As Integer, j As Integer\n\nptr1 = FindWindow(vbNullString, \"Some PDF 1.pdf - Acrobat Reader\")\nptr2 = FindWindow(vbNullString, \"Some PDF 2.pdf - Acrobat Reader\")\n\nFor i = 1 To 30\n    For j = 1 To 4\n       BringWindowToTop (ptr1)\n       Sleep 100\n       BringWindowToTop (ptr2)\n       Sleep 100\n    Next j\nBringWindowToTop (ptr1)\nApplication.SendKeys \"{RIGHT}\": Sleep 500: DoEvents 'should move to the next page in the first PDF\nBringWindowToTop (ptr2)\nApplication.SendKeys \"{RIGHT}\": Sleep 500: DoEvents 'should move to the next page in the second PDF\nNext i\nEnd Sub\n</code></pre>\n\n<p>I also tried to use SendMessage, but it does not want to move any PDF to the next page.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1525207717, "post_id": 50123550, "comment_id": 87265319, "body": "Drop &quot; &amp; &quot; you put in front of VALUES."}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1525207758, "post_id": 50123550, "comment_id": 87265349, "body": "Although I am not 100% sure what your end goal is here. It looks like you may have just added your &quot;VALUES&quot; fields in the wrong place. It probably should look something like <code>CurrentDb.Execute &quot;INSERT INTO Customer &#39;&quot; &amp; Me.FirstName &amp; &quot;&#39; AS FirstName,&#39;&quot; &amp; Me.LastName &amp; &quot;&#39; AS LastName,&#39;&quot; ...</code> etc."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 1, "creation_date": 1525207767, "post_id": 50123550, "comment_id": 87265354, "body": "Would also need to drop the <code>&quot;</code> on either side of the <code>&amp;</code>, in that case, @Rene. It&#39;s extraneous, but not causing an error."}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1525207850, "post_id": 50123635, "comment_id": 87265390, "body": "needed in both the column list and <code>me.Password</code>, I believe."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1525207990, "post_id": 50123635, "comment_id": 87265472, "body": "No - that&#39;s fine, though I would prefer <code>Me!Password.Value</code>."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 3, "last_activity_date": 1525207787, "creation_date": 1525207787, "answer_id": 50123635, "question_id": 50123550, "link": "https://stackoverflow.com/questions/50123550/runtime-error-3134-in-visual-basic/50123635#50123635", "title": "Runtime error 3134 in visual basic", "body": "<p>Password is a reserved word, so use: [Password]</p>\n"}, {"tags": [], "owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "is_accepted": false, "score": 1, "last_activity_date": 1525208629, "last_edit_date": 1525208629, "creation_date": 1525208143, "answer_id": 50123709, "question_id": 50123550, "link": "https://stackoverflow.com/questions/50123550/runtime-error-3134-in-visual-basic/50123709#50123709", "title": "Runtime error 3134 in visual basic", "body": "<p>Actually, I see another issue now. MS Access does not accept E-mail as a column name. Use [E-mail]. Assuming there are no other issues, that will likely solve the problem.</p>\n\n<p>Edit:</p>\n\n<p>As a futher explanation, this is because of the '-' (dash) in E-mail. The same would apply for any column that starts with a number (such as \"1234Column\").</p>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 9600712, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-76tPZx1OIZY/AAAAAAAAAAI/AAAAAAAAAAc/cWsOYpXu3nw/photo.jpg?sz=128", "display_name": "Ronnie Jimenez", "link": "https://stackoverflow.com/users/9600712/ronnie-jimenez"}, "is_accepted": false, "score": 1, "last_activity_date": 1525225709, "creation_date": 1525225709, "answer_id": 50126103, "question_id": 50123550, "link": "https://stackoverflow.com/questions/50123550/runtime-error-3134-in-visual-basic/50126103#50126103", "title": "Runtime error 3134 in visual basic", "body": "<pre><code>CurrentDb.Execute \"INSERT INTO Customer(FirstName, LastName, E-mail, Password, PhoneNumber, Address, City, State, Zipcode) VALUES('\" &amp; Me.FirstName &amp; \"','\" &amp; Me.LastName &amp; \"','\" &amp; Me.E_mail &amp; \"','\" &amp; Me.Password &amp; \"', \" &amp; Me.PhoneNumber &amp; \",'\" &amp; Me.Address &amp; \"','\" &amp; Me.City &amp; \"', '\" &amp; Me.ZipCode &amp; \"')\"\n</code></pre>\n"}], "owner": {"reputation": 846, "user_id": 5192646, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-fSAvEgSgNVY/AAAAAAAAAAI/AAAAAAAAAY4/wpqMN1S16n4/photo.jpg?sz=128", "display_name": "Sourabh Agrawal", "link": "https://stackoverflow.com/users/5192646/sourabh-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1525225709, "creation_date": 1525207379, "question_id": 50123550, "link": "https://stackoverflow.com/questions/50123550/runtime-error-3134-in-visual-basic", "title": "Runtime error 3134 in visual basic", "body": "<p><code>CurrentDb.Execute \"INSERT INTO Customer(FirstName, LastName, E-mail, Password, PhoneNumber, Address, City, State, Zipcode) \" &amp; \" VALUES('\" &amp; Me.FirstName &amp; \"','\" &amp; Me.LastName &amp; \"','\" &amp; Me.E_mail &amp; \"','\" &amp; Me.Password &amp; \"', \" &amp; Me.PhoneNumber &amp; \",'\" &amp; Me.Address &amp; \"','\" &amp; Me.City &amp; \"', '\" &amp; Me.ZipCode &amp; \"')\"</code></p>\n\n<p>I am new to visual basic and access, trying to insert a row on button click in access, could not figure out the syntax error in this visual basic code. </p>\n\n<p>Thanks in advance </p>\n"}]