[{"tags": ["vba", "excel", "userform", "ranged-loops"], "comments": [{"owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "edited": false, "score": 0, "creation_date": 1426724434, "post_id": 29134169, "comment_id": 46495479, "body": "Can the staff member appear multiple times in the data your getting the System and Access for each staff member from?"}, {"owner": {"reputation": 1, "user_id": 4603421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47535178c81a2f9d7ca45370003e968?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/4603421/oliver"}, "reply_to_user": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "edited": false, "score": 0, "creation_date": 1426724578, "post_id": 29134169, "comment_id": 46495520, "body": "Yes, so the data will contain the same staff member information but different system and access information. It might end up being 100+ lines of access, but also sometimes only 1-2 lines of access. Across those lines the staff information will remain the same but system and access will change.  EG (System 1, Access 1) then next line with same staff information (System 1, Access 2). The system can also change as staff can have access to multiple systems. all I want to do is put each system plus access combination that the specific staff member has and autofill the text boxes of the userform"}], "answers": [{"tags": [], "owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "is_accepted": false, "score": 0, "last_activity_date": 1426725618, "creation_date": 1426725618, "answer_id": 29135283, "question_id": 29134169, "link": "https://stackoverflow.com/questions/29134169/loop-through-an-excel-range-and-fill-text-boxes-from-range/29135283#29135283", "title": "Loop through an excel range and fill text boxes from range", "body": "<p>The below should give you the basics to loop through and update a variable with the values of each System and Access cell for the staff member based on their staff number. You'll need to change the values in [] to the named values in your form. It also works off of the original range which you defined 'rngNumber'. I've not tested it, but at a glance it should work. Let me know how it goes.</p>\n\n<pre><code>strSystem = \"\"\nstrAccess = \"\"\nFor Each rngCell In rngNumber.Cells\n     If rngCell.Value = Val(cboStaffNumber.Value) Then\n          strSystem = strSystem &amp; rngCell.Offset(0,10).value &amp; \", \"\n          strAccess = strAccess &amp; rngCell.Offset(0,11).value &amp; \", \"\n     End If\nNext rngCell\nIf len(strSystem) &gt; 0 then\n     strSystem = Left(strSystem, len(strSystem)-1)\nEnd If\nIf len(strAccess) &gt; 0 then\n     strAccess = Left(strAccess , len(strAccess)-1)\nEnd If\nMe.[txtSystemBox] = strSystem \nMe.[txtAccessBox] = strAccess\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4603421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47535178c81a2f9d7ca45370003e968?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/4603421/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1380, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426725618, "creation_date": 1426719011, "question_id": 29134169, "link": "https://stackoverflow.com/questions/29134169/loop-through-an-excel-range-and-fill-text-boxes-from-range", "title": "Loop through an excel range and fill text boxes from range", "body": "<p>I'm currently working on a userform within excel. It currently pulls a list from a database and pastes this into excel then references that data to autofill in textboxes when you select someones name. </p>\n\n<p>What I am having trouble with is I also want to autofill the access to certain systems a staff member will have. Basically the spreadsheet contains all staff within the company and the access they have to certain systems consisting of 2 cells (System and entitlement, columns K and L). I have defined the range I wish to work with but I am now stuck.</p>\n\n<p>How do I get excel to loop through the range and \"Copy and paste\" the data from each cell (eg K2 and l2) into text boxes in the userform. So what I want to happen is select someones name and it will automatically pull through all their access details and autofill some textboxes with that access and entitlement.</p>\n\n<p>Current code I have is as per below.\n    Private Sub cboStaffNumber_Change()</p>\n\n<pre><code>Dim rngCell As Range\nDim rngNumber As Range\nDim lngRow As Long\nDim lngRangeStart As Long\nDim lngRangeEnd As Long\nDim lngLastRow As Long\nDim rngColumn As Range\nDim rngEntitlement As Range\nDim rngAccess As Range\n\nSet rngNumber = Range(\"A2:A\" &amp; lngStaffDataLastRow)\n\n'Fills in the Staff Name, OIA Template, Division, Job Title and WAP Code fields when a staff member is selected\n    If bCboBool = False Then\n        If Me.cboStaffNumber.ListIndex &gt; 0 Then\n            For Each rngCell In rngNumber.Cells\n                If rngCell.Value = Val(cboStaffNumber.Value) Then\n'                    lngRangeStart = rngCell.Row\n                    bCboBool = True\n                    Me.cboStaffName = rngCell.Offset(0, 1)\n                    Me.txtOIATemplate = rngCell.Offset(0, 9)\n                    Me.txtDivision = rngCell.Offset(0, 7)\n                    Me.txtJobTitle = rngCell.Offset(0, 2)\n                    Me.txtWAP = rngCell.Offset(0, 3)\n                    Exit For\n                End If\n            Next rngCell\n        Else\n            Me.cboStaffName.Value = \"\"\n            Me.txtOIATemplate.Value = \"\"\n            Me.txtDivision.Value = \"\"\n            Me.txtJobTitle.Value = \"\"\n            Me.txtWAP.Value = \"\"\n        End If\n    End If\n\nFor lngRow = 2 To lngLastRow\n    If rngNumber.Cells(lngRow, 1).Value = Val(cboStaffNumber.Value) Then\n        lngRangeStart = lngRow\n        Exit For\n    End If\nNext lngRow\n\n'    For lngRow = lngRangeStart To lngLastRow + 1\n'        If rngNumber.Cells(lngRow, 1).Value &lt;&gt; Val(cboStaffNumber.Value) Then\n'            lngRangeEnd = lngRow\n'            Exit For\n'        End If\n'    Next lngRow\n'\n'    If lngRow &lt;&gt; 0 Then\n'        lngRangeEnd = lngRangeEnd - 1\n'    End If\n'\n'    For rngAccess = lngRangeStart To lngRangeEnd\n'        Set rngCell = lngRangeStart.Cells(rngCell, 11)\n'            For Each rngCell In rngAccess\n'                Set txtAccess1 = rngCell\n'                Exit For\n'    Next rngAccess\n\n\n\n    bCboBool = False\n\n\n\n\nEnd Sub`\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4687463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cuipn.jpg?s=128&g=1", "display_name": "WyldStallyn", "link": "https://stackoverflow.com/users/4687463/wyldstallyn"}, "edited": false, "score": 0, "creation_date": 1426803405, "post_id": 29135586, "comment_id": 46532706, "body": "That is great, it definitely recognizes the OS and picks one or the other accordingly.  The issue now is that it still can&#39;t locate the file.  Anything I can try to change about the filepath to get it to work?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 11, "user_id": 4687463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cuipn.jpg?s=128&g=1", "display_name": "WyldStallyn", "link": "https://stackoverflow.com/users/4687463/wyldstallyn"}, "edited": false, "score": 0, "creation_date": 1426803655, "post_id": 29135586, "comment_id": 46532792, "body": "If you ran it on the Mac I just noticed I messed up some of the file path - Have edited it so it should now be correct. If it&#39;s still not working double check your file path(s)."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1426803594, "last_edit_date": 1426803594, "creation_date": 1426727695, "answer_id": 29135586, "question_id": 29133977, "link": "https://stackoverflow.com/questions/29133977/excel-vba-code-opening-file-from-network-folder-pc-vs-mac/29135586#29135586", "title": "Excel VBA Code - Opening file from network folder - PC vs. Mac", "body": "<p>You could use something like 'Application.OperatingSystem'</p>\n\n<p>This would show your environment, then test and set paths accordingly</p>\n\n<pre><code>Dim filename1 As String: Dim Path1 As String: Dim Name1 As String\n\nif instr(1, Application.OperatingSystem, \"Mac\", vbtextcompare) &gt; 0 then\n    Path1 = \"/Volumes/Spr1rfpfil/groupdata/admin/sales/Database\\ Share/Data\\ Files/Misc\\ Archive/\" ' Replace with Mac path\nElse\n    Path1 = \"\\\\Spr1rfpfil\\groupdata\\admin\\sales\\Database Share\\Data Files\\Misc Archive\\\" ' Replace with Windows path\nEnd if\n\nName1 = \"Q4Data.xlsx\"\nfilename1 = Path1 &amp; Name1\nWorkbooks.Open fileName:=filename1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1592505473, "creation_date": 1592505473, "answer_id": 62457148, "question_id": 29133977, "link": "https://stackoverflow.com/questions/29133977/excel-vba-code-opening-file-from-network-folder-pc-vs-mac/62457148#62457148", "title": "Excel VBA Code - Opening file from network folder - PC vs. Mac", "body": "<p>VBA has a conditional compiler constant for detecting the hosting OS which you can use like this:</p>\n\n<pre><code>Dim filename1 As String: Dim Path1 As String: Dim Name1 As String\n\n#If Mac Then\n    Path1 = \"/Volumes/Spr1rfpfil/groupdata/admin/sales/Database\\ Share/Data\\ Files/Misc\\ Archive/\" ' Replace with Mac path\n#Else\n    Path1 = \"\\\\Spr1rfpfil\\groupdata\\admin\\sales\\Database Share\\Data Files\\Misc Archive\\\" ' Replace with Windows path\n#End if\n\nName1 = \"Q4Data.xlsx\"\nfilename1 = Path1 &amp; Name1\nWorkbooks.Open fileName:=filename1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4687463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cuipn.jpg?s=128&g=1", "display_name": "WyldStallyn", "link": "https://stackoverflow.com/users/4687463/wyldstallyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5551, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593562024, "creation_date": 1426718058, "last_edit_date": 1593562024, "question_id": 29133977, "link": "https://stackoverflow.com/questions/29133977/excel-vba-code-opening-file-from-network-folder-pc-vs-mac", "title": "Excel VBA Code - Opening file from network folder - PC vs. Mac", "body": "<p>I am trying to adapt code to work on both PC and Macs and am running into an issue with accessing a file on a network folder.  Below is the code that currently works properly for PC users.  I know the syntax of the filepath is different for Macs but I can't seem to get it right.  Could I ask for assistance with what changes I need to make?</p>\n\n<pre><code>Dim filename1 As String\nDim Path1 As String\nDim Name1 As String\nPath1 = \"\\\\Spr1rfpfil\\groupdata\\admin\\sales\\Database Share\\Data Files\\Misc Archive\\\"\nName1 = \"Q4Data.xlsx\"\nfilename1 = Path1 &amp; Name1\nWorkbooks.Open fileName:=filename1\n</code></pre>\n\n<p>As this is my first posting, please let me know if I should do anything differently in the future.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1426781880, "post_id": 29133668, "comment_id": 46521577, "body": "I apologize pnuts, I am not sure how to go about setting my image/file to a link. If it is easier for everyone I can certainly send an email to someone who can post the image or file here."}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1426783036, "post_id": 29133668, "comment_id": 46522263, "body": "I apologize, I can&#39;t find a site that I can upload with at work (we have a bit of online security). I guess I will have to try to access a site when I get home tonight. Sorry for the delay. Is there anything specifically that I can maybe clear up verbally?"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1426784425, "post_id": 29133668, "comment_id": 46523065, "body": "Yea I didn&#39;t do a very good job about describing my predicament, I was really hoping the picture would clarify! What I was hoping to do was search Column E for a cell using &quot;Total&quot;, then if it does have &quot;Total&quot; in it select the entire row (at which point I would do some formatting). Then continue this process until all &quot;Total&quot;s had been formatted.    I will be sure to try and get a set of pictures to explain my goal tonight tho, thanks for being patient!!"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1426785947, "post_id": 29133668, "comment_id": 46523974, "body": "Oh sorry, I was hoping to do the process using VBA. I was hoping I could get the macro to search Column E for all rows containing &quot;Total&quot; then for each cell containing &quot;Total&quot; select from that cell over to Column M and bold box that range. I could certainly live without including the space between portfolio numbers (it would have just been the icing on the cake :D  )"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1426787660, "post_id": 29133668, "comment_id": 46524887, "body": "I will give that a try. Thanks for your time and insight pnuts, take care!"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "edited": false, "score": 1, "creation_date": 1426793852, "post_id": 29152817, "comment_id": 46528129, "body": "It works perfectly!! Thanks so much I really appreciate your help with this!"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "edited": false, "score": 1, "creation_date": 1426795458, "post_id": 29152817, "comment_id": 46528900, "body": "I&#39;m really sorry to keep bugging you with my issues but could you help me figure out how to replace the green fill with a bold box around the range? I&#39;m am trying to insert the bit from my code above into yours where you fill with green but nothing is happening? Again, thanks so much for your time and insight"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "edited": false, "score": 0, "creation_date": 1426798343, "post_id": 29152817, "comment_id": 46530393, "body": "OK so maybe I am not using the code correctly but I am getting vertical border lines between each cell, is there a way I can re write it to set a border as if the cells from E - M were highlighted together?  Again, sorry to keep pestering you with these questions. I really appreciate the insight"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "edited": false, "score": 0, "creation_date": 1426798368, "post_id": 29152817, "comment_id": 46530412, "body": "No problem, use the final code at the very bottom. Here are my results when using it: <a href=\"http://i.imgur.com/0bm77KH.png\" rel=\"nofollow noreferrer\">i.imgur.com/0bm77KH.png</a>"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "edited": false, "score": 0, "creation_date": 1426798694, "post_id": 29152817, "comment_id": 46530583, "body": "I pasted a &quot;final&quot; version at the very bottom that is the entire macro u can copy and paste. I also added Application.ScreenUpdating = False and True which speeds up execution a lot"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "edited": false, "score": 1, "creation_date": 1426855140, "post_id": 29152817, "comment_id": 46551891, "body": "That works perfectly, thanks so much for taking the time to help me! Once I get a few more reputation points I will be sure to come back and vote up your answer ( I don&#39;t have enough points yet lol ) Thanks and take care"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 0, "last_activity_date": 1426798607, "last_edit_date": 1426798607, "creation_date": 1426791447, "answer_id": 29152817, "question_id": 29133668, "link": "https://stackoverflow.com/questions/29133668/selecting-rows-at-sub-total-breaks/29152817#29152817", "title": "Selecting Rows at Sub-Total Breaks", "body": "<p>Is this what you're looking for?</p>\n\n<p>This uses the find function to search the range for the word \"Total\", selects it and the 9 (I counted 8 but whatever excel) cells to the right of it (E-M), and makes them bold.</p>\n\n<p>You can add additional formatting options under the bold if you want</p>\n\n<pre><code>Sub FormatTotalLines()\nDim SearchRange, First, Finder As Range\nSet SearchRange = Range(\"E:E\") 'Search This Range\nSet Finder = SearchRange.Find(\"Total\")\nIf Finder Is Nothing Then Exit Sub\nFirst = Finder.Address\nDo\n    With Finder.Resize(, 9)\n        .Font.Bold = True\n        'Additional formatting here\n        'Make the row green, for example\n        .Interior.Color = RGB(230, 250, 230)\n    End With\n    Set Finder = SearchRange.FindNext(after:=Finder)\nLoop While Not Finder Is Nothing And Finder.Address &lt;&gt; First\nEnd Sub\n</code></pre>\n\n<p><strong>Before:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/UaUec.png\" alt=\"Before\"></p>\n\n<p><strong>After:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/wpqXX.png\" alt=\"After\"></p>\n\n<p><strong>Edits:</strong></p>\n\n<p>For borders, you can use this to clear them:</p>\n\n<pre><code>.Borders.LineStyle = xlNone\n</code></pre>\n\n<p>Side note, to clear the green coloring:</p>\n\n<pre><code>.Interior.ColorIndex = xlNone\n</code></pre>\n\n<p>Then you can add:</p>\n\n<pre><code>.Borders.LineStyle = xlContinuous\n.Borders.Weight = xlMedium '(or xlThin, or xlThick)\n</code></pre>\n\n<p>If you just want an outside border</p>\n\n<pre><code>.Borders(xlEdgeLeft).LineStyle = xlContinuous \n.Borders(xlEdgeRight).LineStyle = xlContinuous \n.Borders(xlEdgeBottom).LineStyle = xlContinuous \n.Borders(xlEdgeTop).LineStyle = xlContinuous\n</code></pre>\n\n<p>Change the outside weights:</p>\n\n<pre><code>.Borders(xlEdgeLeft).Weight = xlMedium '(or xlThin, or xlThick)\n.Borders(xlEdgeRight).Weight = xlMedium '(or xlThin, or xlThick)\n.Borders(xlEdgeBottom).Weight = xlMedium '(or xlThin, or xlThick)\n.Borders(xlEdgeTop).Weight = xlMedium '(or xlThin, or xlThick)\n</code></pre>\n\n<p>The final code to apply a thick box border (and bold the font) would then become:</p>\n\n<pre><code>With Finder.Resize(, 8)\n    .Font.Bold = True           'Bold the font\n    .Borders.LineStyle = xlNone 'Clear any previous borders - not always necessary\n    .Borders(xlEdgeLeft).LineStyle = xlContinuous\n    .Borders(xlEdgeRight).LineStyle = xlContinuous\n    .Borders(xlEdgeBottom).LineStyle = xlContinuous\n    .Borders(xlEdgeTop).LineStyle = xlContinuous\n    .Borders(xlEdgeLeft).Weight = xlMedium\n    .Borders(xlEdgeRight).Weight = xlMedium\n    .Borders(xlEdgeBottom).Weight = xlMedium\n    .Borders(xlEdgeTop).Weight = xlMedium\nEnd With\n</code></pre>\n\n<p><strong>Just copy and paste this whole macro and use:</strong></p>\n\n<pre><code>Sub FormatTotalLines()\nDim SearchRange, First, Finder As Range\nSet SearchRange = Range(\"E:E\") 'Search This Range\nSet Finder = SearchRange.Find(\"Total\")\nIf Finder Is Nothing Then Exit Sub\nApplication.ScreenUpdating = False 'Speeds it up a lot\nFirst = Finder.Address\nDo\n    With Finder.Resize(, 9)\n        .Font.Bold = True\n        .Borders.LineStyle = xlNone\n        .Borders(xlEdgeLeft).LineStyle = xlContinuous\n        .Borders(xlEdgeRight).LineStyle = xlContinuous\n        .Borders(xlEdgeBottom).LineStyle = xlContinuous\n        .Borders(xlEdgeTop).LineStyle = xlContinuous\n        .Borders(xlEdgeLeft).Weight = xlMedium\n        .Borders(xlEdgeRight).Weight = xlMedium\n        .Borders(xlEdgeBottom).Weight = xlMedium\n        .Borders(xlEdgeTop).Weight = xlMedium\n    End With\n    Set Finder = SearchRange.FindNext(after:=Finder)\nLoop While Not Finder Is Nothing And Finder.Address &lt;&gt; First\nApplication.ScreenUpdating = True 'Speeds it up a lot\nEnd Sub\n</code></pre>\n\n<p>Results: <a href=\"https://i.imgur.com/0bm77KH.png\" rel=\"nofollow noreferrer\">http://i.imgur.com/0bm77KH.png</a></p>\n"}], "owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 29152817, "answer_count": 1, "score": 1, "last_activity_date": 1426798607, "creation_date": 1426716647, "last_edit_date": 1426787618, "question_id": 29133668, "link": "https://stackoverflow.com/questions/29133668/selecting-rows-at-sub-total-breaks", "title": "Selecting Rows at Sub-Total Breaks", "body": "<p>I was hoping to incorporate a formatting script into my VBA macro whenever I hit a subtotaling row. I plan for the code to insert a spacing row between the new port numbers then box from column E to M. </p>\n\n<p>My issue, however, is that the specific port numbers pulled into the spreadsheet are based on a variable previously established in an earlier part of the script and are different each time the macro is ran. </p>\n\n<p>So in short, my question is - Is there a way to code the macro to search column E for each port total row and continue this process until all port total rows have been found?</p>\n\n<p>Thank you for any insight/answers in advance! Please let me know if I need to clarify anything!</p>\n\n<p>*Update - some possible code I have been playing with:</p>\n\n<pre><code>Columns(\"E:E\").Select\n\nSelection.Find(What:=\"Total\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n\n    ActiveCell.Select\n\n   'Here is where I want to select from the current cell in Column E to Column M, the active cell will not consistently be the same so I am not sure how to select the range from Column E to M\n    'It will not always be E14 as shown next \n\n    Range(\"E14:M14\").Select\nSelection.Borders(xlDiagonalDown).LineStyle = xlNone\nSelection.Borders(xlDiagonalUp).LineStyle = xlNone\nWith Selection.Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Selection.Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Selection.Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Selection.Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nSelection.Borders(xlInsideVertical).LineStyle = xlNone\nSelection.Borders(xlInsideHorizontal).LineStyle = xlNone\n\n    'Now I need to repeat the above until all cells in Column E with \"Total\" in them have been formatted. Is there a way to loop it until it finds a previously formatted \"Total\" row?\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "date", "ms-access", "filtering", "pass-through"], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1426715811, "creation_date": 1426715811, "answer_id": 29133462, "question_id": 29132750, "link": "https://stackoverflow.com/questions/29132750/querying-a-pass-through-query-acess/29133462#29133462", "title": "Querying a pass through query Acess", "body": "<p>In a passthru you MUST use the backend's syntax. If the BE is SQL Server then I'd use a syntax like this:</p>\n\n<pre><code>WHERE DocDate = '2015-03-17'\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3669807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d8baf0c5dcc906da18d5861c1175a898?s=128&d=identicon&r=PG&f=1", "display_name": "proudestWarehouse89", "link": "https://stackoverflow.com/users/3669807/proudestwarehouse89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594459077, "creation_date": 1426713076, "last_edit_date": 1594459077, "question_id": 29132750, "link": "https://stackoverflow.com/questions/29132750/querying-a-pass-through-query-acess", "title": "Querying a pass through query Acess", "body": "<p>I'm looking how to run a local query with date filters on a saved pass-through queries in Access. I'm trying to leverage the pass through query as basically a View in my Access database... the local query is constructed dynamically in VBA, and intended to be a clean way to filter my pass through query. I'd like to avoid creating another pass through query, or altering the original, every time i run my Sub Procedure.</p>\n\n<p>My problem is that the normal access date filter format #m/d/yyyy# doesn't seem to work. I've tried both altering the date format as well in the pass through query with 1. Convert(varchar(12),p.startDate,101); 2. Convert(date,p.StartDate,101);\nbut neither will work when the pass through query is queried against locally.</p>\n\n<p>Does anyone know how to do this?</p>\n\n<p>UPDATE - I just checked and Access is reading the field as Text... does anyone know how it can read it as a date? As i mentioned the CONVERT functions don't seem to be working to do this</p>\n"}, {"tags": ["c#", "excel", "visual-studio-2013", "add-in", "vba"], "comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1426710959, "post_id": 29132082, "comment_id": 46490123, "body": "C# is less protected since it has built in reflection."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1426711060, "post_id": 29132082, "comment_id": 46490195, "body": "The most secure thing is to create a Win32 dll, like with C, C++ or Fortran and call it from VBA."}, {"owner": {"reputation": 768, "user_id": 237941, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pGZvF.jpg?s=128&g=1", "display_name": "Walter Williams", "link": "https://stackoverflow.com/users/237941/walter-williams"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 2, "creation_date": 1426711115, "post_id": 29132082, "comment_id": 46490241, "body": "@pnuts: Why would this question be considered off-topic?  This is total programming."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1426712170, "post_id": 29132082, "comment_id": 46490835, "body": "I think he&#39;s taking issue with: <code>Are there any good references on how to do something like this?</code> If you provide a code sample that generates the error, with an indication of where the error is, you&#39;ll A) get on pnuts good side, and B) be more likely to get specific help. Referencing the MS docs and saying you followed them doesn&#39;t help us help you find a typo."}, {"owner": {"reputation": 768, "user_id": 237941, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pGZvF.jpg?s=128&g=1", "display_name": "Walter Williams", "link": "https://stackoverflow.com/users/237941/walter-williams"}, "edited": false, "score": 0, "creation_date": 1426712822, "post_id": 29132082, "comment_id": 46491159, "body": "The code out of context from the article would be useless to repeat it here, and if I could attach a zip I would.  The MSDN sample doesn&#39;t work and I have not been able to find any online information via MSDN or elsewhere on how to set up this kind of thing correctly."}], "answers": [{"tags": [], "owner": {"reputation": 15406, "user_id": 44264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d941e5d68ed49560a678a4f37c2bbb?s=128&d=identicon&r=PG", "display_name": "Govert", "link": "https://stackoverflow.com/users/44264/govert"}, "is_accepted": true, "score": 5, "last_activity_date": 1426715147, "creation_date": 1426715147, "answer_id": 29133326, "question_id": 29132082, "link": "https://stackoverflow.com/questions/29132082/creating-new-excel-formulas-functions-with-c/29133326#29133326", "title": "Creating new Excel formulas/functions with C#", "body": "<p>You're looking for <a href=\"http://excel-dna.net\" rel=\"noreferrer\">Excel-DNA</a>.\nThis open-source library allows you to create managed Excel add-ins, and supports making user-defined functions, but also macros, real-time RTD data sources etc.</p>\n\n<p>Creating an Excel UDF in C# is then as simple as:</p>\n\n<pre><code>[ExcelFunction(Description = \"My first .NET function\")]\npublic static string SayHello(string name)\n{\n    return \"Hello \" + name;\n}\n</code></pre>\n\n<p>and you can call from a cell as:</p>\n\n<pre><code>=SayHello(\"Walter\")\n</code></pre>\n\n<p>For code protection with .NET, you'd need to use an obfuscator - there are a variety of free and paid-for ones available.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 4696585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab7a1e538b9ddceabbcbb29f7ecf138c?s=128&d=identicon&r=PG&f=1", "display_name": "Torben Nygaard", "link": "https://stackoverflow.com/users/4696585/torben-nygaard"}, "is_accepted": false, "score": 0, "last_activity_date": 1426920563, "creation_date": 1426920563, "answer_id": 29180069, "question_id": 29132082, "link": "https://stackoverflow.com/questions/29132082/creating-new-excel-formulas-functions-with-c/29180069#29180069", "title": "Creating new Excel formulas/functions with C#", "body": "<h2>I have also tried this sample, with the same error. I found a solution that worked for me.</h2>\n\n<p>In the ISheet1.cs file, replace the ISheet1 interface declaration with the following code. This code makes the ISheet1 interface public, and it applies the <a href=\"http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comvisibleattribute.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comvisibleattribute.aspx</a> attribute to make the interface visible to COM.</p>\n\n<p>C#</p>\n\n<pre><code>[System.Runtime.InteropServices.ComVisible(true)]\npublic interface ISheet1\n{\n    void CreateVstoNamedRange(Microsoft.Office.Interop.Excel.Range range, string name);\n}\n</code></pre>\n\n<p>Full article her:  <a href=\"http://www.nullskull.com/q/10059408/c-code-to-set-excel-workbook-macro-enabled-and-to-trust-vba-projects.aspx\" rel=\"nofollow\">http://www.nullskull.com/q/10059408/c-code-to-set-excel-workbook-macro-enabled-and-to-trust-vba-projects.aspx</a> </p>\n"}], "owner": {"reputation": 768, "user_id": 237941, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pGZvF.jpg?s=128&g=1", "display_name": "Walter Williams", "link": "https://stackoverflow.com/users/237941/walter-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8336, "favorite_count": 3, "accepted_answer_id": 29133326, "answer_count": 2, "score": 7, "last_activity_date": 1426920563, "creation_date": 1426710736, "last_edit_date": 1531161705, "question_id": 29132082, "link": "https://stackoverflow.com/questions/29132082/creating-new-excel-formulas-functions-with-c", "title": "Creating new Excel formulas/functions with C#", "body": "<p>We are looking to be able to programmatically create an Excel workbook which would call custom code from within a cell.  Cells would look something like:</p>\n\n<pre><code>=MyCode(A1:A10)\n</code></pre>\n\n<p>My first thought was to use VBA, but since the algorithm is proprietary the powers that be want it to be protected.  I can put a password on it, but it is well documented (here on StackOverflow) on how to get around such passwords.</p>\n\n<p>My second thought was to create an Excel 2013 Workbook project in Visual Studio, but I haven't found anything useful on how to expose a function in C# so it can be called like I described.</p>\n\n<p>Next I thought about having VBA call the C#, and found instructions at <a href=\"https://msdn.microsoft.com/en-us/library/bb608613.aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/bb608613.aspx</a>.  I followed those instructions to the letter, but when I try to run the VBA code I get an error with the GetManagedClass function: Object Library Feature not Supported.</p>\n\n<p>Are there any good references on how to do something like this?</p>\n"}, {"tags": ["forms", "vba", "ms-access", "transactions"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1426734134, "post_id": 29131904, "comment_id": 46497864, "body": "Why not just bound the form to a temp table instead of iterating through a VBA recordset? Once validation passes by using the form&#39;s <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835397.aspx\" rel=\"nofollow noreferrer\">BeforeInsert</a> or individual control&#39;s <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822421.aspx\" rel=\"nofollow noreferrer\">BeforeUpdate</a> events (which are often used for data validation) append to final table. Otherwise, your process seems to reinvent the wheel of bounded forms (i.e., binding a recordset to a form) and require some resource overhead."}, {"owner": {"reputation": 340, "user_id": 556651, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/056e02ab015a9d1fb4cecdd3a91dc1fc?s=128&d=identicon&r=PG", "display_name": "Ain Britain", "link": "https://stackoverflow.com/users/556651/ain-britain"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1426790217, "post_id": 29131904, "comment_id": 46526242, "body": "Shouldn&#39;t I keep validation rules at the table design level so that they&#39;re all in one place?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1426879411, "post_id": 29131904, "comment_id": 46566489, "body": "Even better! But in case customized validation requires some calculation, some do it at form level."}], "answers": [{"tags": [], "owner": {"reputation": 340, "user_id": 556651, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/056e02ab015a9d1fb4cecdd3a91dc1fc?s=128&d=identicon&r=PG", "display_name": "Ain Britain", "link": "https://stackoverflow.com/users/556651/ain-britain"}, "is_accepted": false, "score": 0, "last_activity_date": 1426713606, "last_edit_date": 1426713606, "creation_date": 1426713270, "answer_id": 29132807, "question_id": 29131904, "link": "https://stackoverflow.com/questions/29131904/ms-access-vba-closing-transaction-without-destroying-forms-class-module-variab/29132807#29132807", "title": "MS Access VBA: Closing Transaction without destroying Form&#39;s class module variables", "body": "<p>This is not a problem specific to transactions and workspaces, but a more general matter of program structure. You should just make the workspace persist for the duration of the form, and commit to it multiple times. You don't need to make a new workspace for each transaction.</p>\n\n<p>So, treat the workspace just like tempImportRs is treated in the code example. You can both set and close WrkSp in the GoButton_click sub. Don't set or close it in the TryToAddRecords function.</p>\n\n<p>You will also have to make sure to roll back with WrkSp.Rollback if there's an error, add that line to Error_TryToAddRecords.</p>\n\n<pre><code>Public tempImportRs As RecordSet\nDim WrkSp As Workspace\n\n'...\n\nPrivate Sub GoButton_click\n\n    Set tempImportRs = CurrentDb.OpenRecordset(\"tblTempImport\")\n    Set WrkSp = DBEngine.Workspaces(0) 'move this here\n\n    If !tempImportRs.EOF\n        '&lt;populate the form fields with the current '\n        'tempImportRs data here&gt;'\n        TryToAddRecords\n        tempImportRs.MoveNext\n    Else\n        tempImportRs.Close\n        Set tempImportRs = Nothing\n        'close the workspace here when you're done with tempImportRs\n        WrkSp.Close \n        Set WrkSp = Nothing\n        MsgBox \"All records imported\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>PS: Sorry folks for asking and answering this dumb question, I had a mental block and thought the issue was about managing workspaces and not a simpler matter of code design. Maybe this will still help someone someday.</p>\n"}], "owner": {"reputation": 340, "user_id": 556651, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/056e02ab015a9d1fb4cecdd3a91dc1fc?s=128&d=identicon&r=PG", "display_name": "Ain Britain", "link": "https://stackoverflow.com/users/556651/ain-britain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426713606, "creation_date": 1426710000, "last_edit_date": 1426712691, "question_id": 29131904, "link": "https://stackoverflow.com/questions/29131904/ms-access-vba-closing-transaction-without-destroying-forms-class-module-variab", "title": "MS Access VBA: Closing Transaction without destroying Form&#39;s class module variables", "body": "<p>I have an unbound form used to enter constituent data. I can't use subforms because data is spread across multiple tables and linked with foreign keys. Since I want to use the field validation rules to validate, I use a transaction to make sure new records are committed in an all-or-nothing fashion. I don't want names committed without addresses, etc.</p>\n\n<p>The form is designed to iterate over a recordset, \"tempImportRs\", to give the user an opportunity to make sure the data looks OK and to manually correct or skip invalid entries. It works by populating the form's fields with values from tempImportRs for each entry. There's also a subform that searches for similar records and displays them to the user to decide if this is really a new person or if they already exist in the DB with somewhat different info.</p>\n\n<p>I am running into a problem using this \"tempImportRs\" recordset, which persists for the lifetime of the form and is used by various methods in the form, alongside Access's transactions (which I don't understand very well, admittedly). If at any point I close the transaction like</p>\n\n<pre><code>WrkSp.Close\n</code></pre>\n\n<p>then my tempImportRs object will disappear and give me \"Requires object\" type errors. If I don't close the transaction, which is bad practice anyway, my form will work like I want for up to maybe a dozen records before giving me the error \"Could not start transaction; too many transactions already nested.\"</p>\n\n<p><strong>How can I close the transaction cleanly, without destroying \"tempImportRs\"?</strong></p>\n\n<p>Here is a very simplified version of the VBA code for my form:</p>\n\n<pre><code>Public tempImportRs As RecordSet\n\nSub TryToAddRecords()\n'Try to add the data from the now-populated form fields to my tables'\n    On Error GoTo Error_TryToAddRecords\n\n    Dim WrkSp As Workspace\n    Set WrkSp = DBEngine.Workspaces(0)\n    WrkSp.BeginTrans\n\n    'In my real code I use several recordsets to store the imported data'\n    'but I am simplifying here by using just one:'\n\n    Dim someOtherRs As Recordset\n    Set someOtherRs = CurrentDb.OpenRecordset(\"tblNamesAddressesEtc\")\n\n    '...Do stuff using several other recordsets and '\n    'the form fields populated from tempImportRs'\n\n    someOtherRs.Update\n\n    WrkSp.CommitTrans\n\n    Exit_TryToAddRecords:\n\n      someOtherRs.Close\n      'I leave tempImportRs open for now.'\n\n      'WrkSp.Close &lt;--This is what messes up tempImportRs'\n      Set someOtherRs = Nothing\n      Set WrkSp = Nothing\n      Exit Sub\n\n    Error_TryToAddRecords:\n      MsgBox Err.Description &amp; vbNewLine &amp; _\n        \"Please fix the field and try again.\"\n      Resume Exit_TryToAddRecords\n\nEnd Sub\n\nPrivate Sub GoButton_click\n\n    Set tempImportRs = CurrentDb.OpenRecordset(\"tblTempImport\")\n\n    If !tempImportRs.EOF\n        '&lt;populate the form fields with the current '\n        'tempImportRs data here&gt;'\n        TryToAddRecords\n        tempImportRs.MoveNext\n    Else\n        tempImportRs.close\n        Set tempImportRs = Nothing\n        MsgBox \"All records imported\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 4, "creation_date": 1426710183, "post_id": 29131898, "comment_id": 46489648, "body": "do you know how to use arrays?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1426710586, "post_id": 29131898, "comment_id": 46489889, "body": "If you included your <i>actual real working code</i>, this would be a nice question to ask on <a href=\"https://codereview.stackexchange.com\">Code Review</a> =)"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1426711216, "post_id": 29131898, "comment_id": 46490311, "body": "I am waiting for the famous <a href=\"http://thedailywtf.com/articles/The_FOR-CASE_paradigm\" rel=\"nofollow noreferrer\"><code>For-Case</code></a> paradigm to show up as an answer now."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1426711359, "post_id": 29131898, "comment_id": 46490400, "body": "It is never a good idea to have <code>x1,x2,x3...x30</code>, Use arrays instead."}], "answers": [{"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1426729626, "post_id": 29135517, "comment_id": 46496771, "body": "Or:   <code>Dim Films as variant</code>   <code>Films = array(&quot;Lord of the Rings&quot;,&quot;Speed&quot;,&quot;Star Wars&quot;,&quot;The Godfather&quot;,&quot;Pulp Fiction&quot;)</code>   This way the film variant can resize simply by adding or removing values, no need to specify a size."}], "tags": [], "owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "is_accepted": true, "score": 1, "last_activity_date": 1426727278, "creation_date": 1426727278, "answer_id": 29135517, "question_id": 29131898, "link": "https://stackoverflow.com/questions/29131898/how-to-shorten-this-vba-code/29135517#29135517", "title": "How to shorten this VBA code?", "body": "<p>Array are the best solution. First decide whether its one or two dimensional and then you can use it. I beleive yours is a two dimensional array.</p>\n\n<p>You can set X1 to X30 in array and fetch the values. A mock code for both one and two dimensional array is here</p>\n\n<p><strong>1-D Array:</strong></p>\n\n<blockquote>\n<pre><code>Dim Films(1 To 5) As String\n\n Films(1) = \"Lord of the Rings\"\n Films(2) = \"Speed\"\n Films(3) = \"Star Wars\"\n Films(4) = \"The Godfather\"\n Films(5) = \"Pulp Fiction\"\n\n MsgBox Films(4)\n</code></pre>\n</blockquote>\n\n<p><strong>2-D Array</strong></p>\n\n<blockquote>\n<pre><code>Dim Films(1 To 5, 1 To 2) As String\nDim i As Integer, j As Integer\n\nFor i = 1 To 5\n     For j = 1 To 2\n         Films(i, j) = Cells(i, j).Value\n     Next j\nNext i\n\n MsgBox Films(4, 2)\n</code></pre>\n</blockquote>\n\n<p>Please mark it as answer if this help(can help someone too).</p>\n\n<p>Regards,\nMani</p>\n"}], "owner": {"reputation": 13, "user_id": 4687088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75249944577a12b9906e7ecd563b7fca?s=128&d=identicon&r=PG&f=1", "display_name": "lolzzz", "link": "https://stackoverflow.com/users/4687088/lolzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 29135517, "answer_count": 1, "score": 0, "last_activity_date": 1426727278, "creation_date": 1426709989, "last_edit_date": 1426725232, "question_id": 29131898, "link": "https://stackoverflow.com/questions/29131898/how-to-shorten-this-vba-code", "title": "How to shorten this VBA code?", "body": "<p>How can I shorten this code? I want to make this code with <code>If</code> shorter in loop. I tried do something like this <code>Me.Controls(\"x\" &amp; t) = 0</code> , but it's returning a syntax error. I don't know what I can do. Please help.</p>\n\n<pre><code>x = CStr(Int(Rnd() * 16))\nDim x1 As Byte = 0\n...\nDim x30 As Byte = 0\n\nFor t = 0 To 15\nIf x = t And x1 = 0 Then\n...\nEnd If\nIf x = t And x2 = 0 Then\n...\nEnd If\n...\nIf x = t And x30 = 0 Then\n...\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1426713315, "post_id": 29131805, "comment_id": 46491444, "body": "<code>MsgBox Range(&quot;A1&quot;).Text</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1426770656, "post_id": 29131805, "comment_id": 46513546, "body": "Use the Text property of the cell, instead of the Value property. Does that help?"}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1531720480, "post_id": 29131805, "comment_id": 89682950, "body": "@DavidZemens yes, it does. That solved the problem."}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1426712260, "last_edit_date": 1426712260, "creation_date": 1426711335, "answer_id": 29132244, "question_id": 29131805, "link": "https://stackoverflow.com/questions/29131805/changing-decimal-separator-in-vba-not-only-in-excel/29132244#29132244", "title": "Changing decimal separator in VBA (not only in Excel)", "body": "<p>I cannot speak with 100% certainty, but I believe that while <code>Application.DecimalSeparator</code> affects what is displayed in the cell, it appears that <code>MsgBox</code> uses the Windows locale default.</p>\n\n<p>What happens if you try changing it at the Windows level? Also, are you certain that your SQL inserts are not interpreting it correctly?</p>\n\n<p>If needed, a potential <strike>workaround</strike> kludge might be try:</p>\n\n<pre><code>Dim x as Integer\nDim xs as String\nx = 1.5\nxs = replace(cstr(x),\".\", \",\")\nSQLString = Stuff &amp; xs &amp; MoreStuff\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1531750909, "creation_date": 1531750909, "answer_id": 51364014, "question_id": 29131805, "link": "https://stackoverflow.com/questions/29131805/changing-decimal-separator-in-vba-not-only-in-excel/51364014#51364014", "title": "Changing decimal separator in VBA (not only in Excel)", "body": "<p><code>Application.DecimalSeparator</code> affects what's <em>displayed</em> in the cell, and it's a minor, but important distinction that what's <em>displayed</em> in the cell is not always the same as the cell's <code>.Value</code> property, especially if we are tinkering with the way the value is formatted or displayed. This is apparent when using date values, for instance:</p>\n\n<p><a href=\"https://i.stack.imgur.com/S6hrP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S6hrP.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, no matter the format of the cell, the <code>MsgBox</code> function uses my (US) locale to format the date:</p>\n\n<p>The exception, which is not really an exceptions, is if the <code>MsgBox</code> function is passed a string literal:</p>\n\n<pre><code>MsgBox(Format(#6/1/2018#,\"dd-mm-yyyy\"))\n</code></pre>\n\n<p>Here, we're not passing a <em>date</em>, but a string, and <code>MsgBox</code> will display that exactly per the <code>Format</code> function:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5yM0S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5yM0S.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this is kind of the same thing that's going on when you tinker with the <code>DecimalSeparator</code> or other separator properties. You haven't changed the underlying values, only the way that Excel Application represents them in the UI. </p>\n\n<p>You might expect the <code>MsgBox</code> function to use the overrides that you've assigned through <code>Application.DecimalSeparator</code>, but the <code>MsgBox</code> function accepts only a <code>String</code> type for its first argument, so when you pass anything other than a string, there is an implicit conversion to string type, essentially what's happening is:</p>\n\n<pre><code>MsgBox(CStr(Range(\"A1\").Value))\n</code></pre>\n\n<p>The <em>value</em> is still locale-agnostic, and now you're casting that value to a string. The only real logical output is to use the windows/system local to handle that cast.</p>\n\n<p><strong>TL;DR</strong></p>\n\n<p>You can use the cell's <code>Text</code> property to get at what's actually <em>displayed</em> in the cell, rather than the cell's true <em>value</em>.</p>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8236, "favorite_count": 0, "accepted_answer_id": 51364014, "answer_count": 2, "score": 3, "last_activity_date": 1531750909, "creation_date": 1426709664, "question_id": 29131805, "link": "https://stackoverflow.com/questions/29131805/changing-decimal-separator-in-vba-not-only-in-excel", "title": "Changing decimal separator in VBA (not only in Excel)", "body": "<p>Type in A1 cell <code>=1/10</code> </p>\n\n<p>Run this macro:</p>\n\n<pre><code>Sub ChangeDecimalSeparator()\n    Application.DecimalSeparator = \"#\"\n    Application.UseSystemSeparators = False\n    MsgBox Range(\"A1\").Value\nEnd Sub\n</code></pre>\n\n<p>Apparently now in cell A1 you can see that the decimal separator has been changed to new character #. Why on earth VBA still sees it as your default seperator, although you have changed it (I mean the MsgBox).</p>\n\n<p>Why I need it? My default separator is , (comma). I want to insert data to SQL which used . (dot). </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1426709462, "post_id": 29131648, "comment_id": 46489211, "body": "What do you mean &quot;not working properly&quot;?  What are you expecting to happen that isn&#39;t?  What is happening instead?  Have you tried stepping through your code and seeing what values are stored in your variables, and if they are what you are expecting?"}, {"owner": {"reputation": 418, "user_id": 4645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228705acd43eb2c65b8ee34bf81a3a8c?s=128&d=identicon&r=PG&f=1", "display_name": "hpf", "link": "https://stackoverflow.com/users/4645385/hpf"}, "edited": false, "score": 0, "creation_date": 1426726136, "post_id": 29131648, "comment_id": 46495935, "body": "You might find it much easier to use the DateDiff function.  if abs(DateDiff(&quot;h&quot;,timevalue(textbox2.value),time())) &lt;=1 then.... should do the trick for you.  That compares the time in TextBox2 to the current time in hours, and sees if the absolute value is &lt;1 (i.e. 1 hour before or after the current time).  I haven&#39;t tested it, but something like this should work,"}, {"owner": {"reputation": 55, "user_id": 4637262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6984f7b7a8c43b20cc03f2c9290687a1?s=128&d=identicon&r=PG&f=1", "display_name": "TheNoviceAllen", "link": "https://stackoverflow.com/users/4637262/thenoviceallen"}, "reply_to_user": {"reputation": 418, "user_id": 4645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228705acd43eb2c65b8ee34bf81a3a8c?s=128&d=identicon&r=PG&f=1", "display_name": "hpf", "link": "https://stackoverflow.com/users/4645385/hpf"}, "edited": false, "score": 0, "creation_date": 1426730221, "post_id": 29131648, "comment_id": 46496914, "body": "Sorry, I posted this as my shift was ending. The problem should be fully stated now. @hpf, that seems like it just might work! Let me try it tomorrow morning. Thank you again."}], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 4645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228705acd43eb2c65b8ee34bf81a3a8c?s=128&d=identicon&r=PG&f=1", "display_name": "hpf", "link": "https://stackoverflow.com/users/4645385/hpf"}, "edited": false, "score": 0, "creation_date": 1426783277, "post_id": 29145444, "comment_id": 46522417, "body": "Looks good.  Instead of the Range function, you could use the Cells property.  .Range(&quot;E&quot; &amp; currentRows) becomes .Cells(CurrentRows,5).  It does the same thing, but I find it a bit less clunky."}, {"owner": {"reputation": 55, "user_id": 4637262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6984f7b7a8c43b20cc03f2c9290687a1?s=128&d=identicon&r=PG&f=1", "display_name": "TheNoviceAllen", "link": "https://stackoverflow.com/users/4637262/thenoviceallen"}, "reply_to_user": {"reputation": 418, "user_id": 4645385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/228705acd43eb2c65b8ee34bf81a3a8c?s=128&d=identicon&r=PG&f=1", "display_name": "hpf", "link": "https://stackoverflow.com/users/4645385/hpf"}, "edited": false, "score": 0, "creation_date": 1426786984, "post_id": 29145444, "comment_id": 46524542, "body": "Awesome. I&#39;m probably going to do an overhaul soon where I convert a decent chunk of this code into sub programs. I&#39;ll probably do that conversion in the process."}], "tags": [], "owner": {"reputation": 55, "user_id": 4637262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6984f7b7a8c43b20cc03f2c9290687a1?s=128&d=identicon&r=PG&f=1", "display_name": "TheNoviceAllen", "link": "https://stackoverflow.com/users/4637262/thenoviceallen"}, "is_accepted": true, "score": 0, "last_activity_date": 1426770498, "creation_date": 1426770498, "answer_id": 29145444, "question_id": 29131648, "link": "https://stackoverflow.com/questions/29131648/excel-2013-vba-hour-check-inside-a-range-if-statement-not-working-properly/29145444#29145444", "title": "Excel 2013 VBA , hour check inside a range IF statement not working properly", "body": "<p>Thanks hpf! That worked. I made it a sub since I use it three times in the code. I should probably work on creating several other subs for these large bulky programs I've built...</p>\n\n<pre><code>Private Sub TimeCheck(currentRows As Integer)\nIf DateDiff(\"h\", TextBox2.Value, Time()) &gt; 1 Then\n    Worksheets(Sheets.Count).Range(\"E\" &amp; currentRows).Value = TextBox2.Value &amp; \" \" &amp; ComboBox8.Value\nElse\n    Worksheets(Sheets.Count).Range(\"E\" &amp; currentRows).Value = Format(Time, \"h:mm AM/PM\")\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4637262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6984f7b7a8c43b20cc03f2c9290687a1?s=128&d=identicon&r=PG&f=1", "display_name": "TheNoviceAllen", "link": "https://stackoverflow.com/users/4637262/thenoviceallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 29145444, "answer_count": 1, "score": 0, "last_activity_date": 1426770498, "creation_date": 1426709053, "last_edit_date": 1426729918, "question_id": 29131648, "link": "https://stackoverflow.com/questions/29131648/excel-2013-vba-hour-check-inside-a-range-if-statement-not-working-properly", "title": "Excel 2013 VBA , hour check inside a range IF statement not working properly", "body": "<p>I'm working on a bit of code for my Campus Food Shelf. I'm currently trying to prevent users from manually entering the time for normal transactions (mostly because there's a training issue and no one's doing it uniformly). However, I need the time option within this user form, in the case of data loss, so that everything can be reentered quickly.</p>\n\n<p>So with the following code, I'm trying to check if the user is entering a time that's within an hour of the current time. If not, the user form should use the user's input. However, if it is within an hour then it should just use the current time, with the correct format. It runs properly when TextBox2 is empty. However, when I put 1:58:33 at 2:04 PM it still posts 1:58:33 in column E. Have I done the math wrong? I just want it to post the current time when the user tries entering a time that's within an hour.</p>\n\n<pre><code>If TextBox2.Value &lt;&gt; \"\" Then\n            timeCheck1 = Hour(Time) - 1\n            timeCheck2 = Hour(Time)\n            timeValue = Hour(TextBox2.Value)\n            If timeValue &lt; 7 Then\n                timeValue = timeValue + 12\n            End If\n            If timeCheck1 &lt; timeValue And timeValue &lt;&gt; timeCheck2 Then\n                Worksheets(Sheets.Count).Range(\"E\" &amp; currentRows).Value = TextBox2.Value &amp; \" \" &amp; ComboBox8.Value\n            Else\n                Worksheets(Sheets.Count).Range(\"E\" &amp; currentRows).Value = Format(Time, \"h:mm AM/PM\")\n            End If\n        Else\n        Worksheets(Sheets.Count).Range(\"E\" &amp; currentRows).Value = Format(Time, \"h:mm AM/PM\")\n        End If\n</code></pre>\n\n<p>Thank you all for your help in advance!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 4686991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c51f75fbeaf62974ab9ea6e8851ae667?s=128&d=identicon&r=PG&f=1", "display_name": "Gablet", "link": "https://stackoverflow.com/users/4686991/gablet"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1426710536, "post_id": 29131402, "comment_id": 46489862, "body": "Thanks HansUp no it was a mistype and it looks like it helps but Im getting a different error now - Runtime Error 3061 too few parameters. The field ClientCd is text"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1451928002, "last_edit_date": 1451928002, "creation_date": 1451926731, "answer_id": 34596048, "question_id": 29131402, "link": "https://stackoverflow.com/questions/29131402/count-recordset-with-sql-statement-in-access-runtime-error-3075/34596048#34596048", "title": "Count recordset with SQL statement in Access - Runtime Error 3075", "body": "<p>The SqlString should be reconstructed in the following manner:</p>\n\n<pre><code> sqlstring = \"SELECT Question_List.[Questions], Question_List.[Freq] FROM Question_List WHERE Question_List.[ClientCd]= '\" &amp; [Forms].[TestControlCreate].[ComClient] &amp; \"';\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4686991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c51f75fbeaf62974ab9ea6e8851ae667?s=128&d=identicon&r=PG&f=1", "display_name": "Gablet", "link": "https://stackoverflow.com/users/4686991/gablet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451928002, "creation_date": 1426708110, "last_edit_date": 1426711493, "question_id": 29131402, "link": "https://stackoverflow.com/questions/29131402/count-recordset-with-sql-statement-in-access-runtime-error-3075", "title": "Count recordset with SQL statement in Access - Runtime Error 3075", "body": "<p>I'm new to Access and trying to count the number of rows in a dataset and am using the below code. I am getting a runtime error which seems to be because of the SQL statement. I have copied it from a query so am not sure what I am doing wrong. </p>\n\n<pre><code>Function RecordCount()\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim sqlstring As String\nDim x As Integer\nDim FindRecordCount As Integer\n\nsqlstring = \"SELECT Question_List.Questions, Question_List.[Freq] FROM Question_List WHERE (((Question_List.ClientCd)=`\" &amp; [Forms]![TestControlCreate]![ComClient] &amp; \"));\"\n\n\n   Set db = CurrentDb\n\n   Set rst = db.OpenRecordset(sqlstring) \n\n   FindRecordCount = rst.RecordCount\n\nReturn\nEnd Function\n</code></pre>\n"}, {"tags": ["vb.net", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "is_accepted": true, "score": 2, "last_activity_date": 1426706760, "creation_date": 1426706760, "answer_id": 29131005, "question_id": 29130895, "link": "https://stackoverflow.com/questions/29130895/vb-net-copying-excel-range/29131005#29131005", "title": "VB.NET Copying Excel Range", "body": "<p>I think what you are looking for is the <code>Cells</code> property.  From there, your best bet is to do a <code>resize</code></p>\n\n<pre><code>oSheetDestination.Cells(1,1).resize(1,10).Value = _\n     oSheetSource.Cells(1,1).resize(1,10).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9139, "user_id": 927408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b569692de127b2f110ac8c44eae5c06?s=128&d=identicon&r=PG", "display_name": "J&#248;rgen R", "link": "https://stackoverflow.com/users/927408/j%c3%b8rgen-r"}, "edited": false, "score": 0, "creation_date": 1426776437, "post_id": 29140295, "comment_id": 46517704, "body": "While this may answer the question it\u2019s always a good idea to put some text in your answer to explain what you&#39;re doing. Read <a href=\"http://stackoverflow.com/help/how-to-answer\">how to write a good answer</a>."}, {"owner": {"reputation": 472, "user_id": 2269262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ECmyI.jpg?s=128&g=1", "display_name": "CristiC777", "link": "https://stackoverflow.com/users/2269262/cristic777"}, "reply_to_user": {"reputation": 9139, "user_id": 927408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b569692de127b2f110ac8c44eae5c06?s=128&d=identicon&r=PG", "display_name": "J&#248;rgen R", "link": "https://stackoverflow.com/users/927408/j%c3%b8rgen-r"}, "edited": false, "score": 0, "creation_date": 1426853051, "post_id": 29140295, "comment_id": 46550741, "body": "I was in big hurry, if he don&#39;t get the clue, I will give them a full example .. But first I think is personal effort to try and understand .."}], "tags": [], "owner": {"reputation": 472, "user_id": 2269262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ECmyI.jpg?s=128&g=1", "display_name": "CristiC777", "link": "https://stackoverflow.com/users/2269262/cristic777"}, "is_accepted": false, "score": 1, "last_activity_date": 1426755157, "creation_date": 1426755157, "answer_id": 29140295, "question_id": 29130895, "link": "https://stackoverflow.com/questions/29130895/vb-net-copying-excel-range/29140295#29140295", "title": "VB.NET Copying Excel Range", "body": "<p>try:<br></p>\n\n<pre><code>Friend Shared Sub TestRangeCells(myworksheet As Worksheet)\nDim myrange As Range = myworksheet.Range(worksheet.Cells(1, 1), myworksheet.Cells(5, 10))\nMessageBox.Show(myrange.Address)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 2704276, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tNbpT.jpg?s=128&g=1", "display_name": "Zulake", "link": "https://stackoverflow.com/users/2704276/zulake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "accepted_answer_id": 29131005, "answer_count": 2, "score": 0, "last_activity_date": 1426755157, "creation_date": 1426706442, "last_edit_date": 1531161705, "question_id": 29130895, "link": "https://stackoverflow.com/questions/29130895/vb-net-copying-excel-range", "title": "VB.NET Copying Excel Range", "body": "<p>I have used the code below to copy an excel range.</p>\n\n<p><code>oSheetDestination.Range(\"A1:A10\").Value = oSheetSource.Range(\"A1:A10\").Value</code></p>\n\n<p>But I would like to copy the range based on the cell number location using something like this:</p>\n\n<pre><code>oSheetDestination.Range(\"1,1:1,10\").Value = oSheetSource.Range(\"1,1:1,10\").Value\n</code></pre>\n\n<p>Any ideas how I can do that? </p>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 4, "creation_date": 1426708752, "post_id": 29130827, "comment_id": 46488790, "body": "Unfortunately, you are probably going to need to test it in different environments."}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1426713915, "post_id": 29130827, "comment_id": 46491750, "body": "Are you just trying to make sure the code runs without an error dialog even if there is no internet connection?  Try using error catching with either <code>On Error Resume Next</code> or <code>On Error Goto Label</code> to trap the error and display a &quot;No Internet Connection&quot; Msgbox"}, {"owner": {"reputation": 40194, "user_id": 3829407, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DQPor.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3829407/matt"}, "edited": false, "score": 0, "creation_date": 1426717994, "post_id": 29130827, "comment_id": 46493488, "body": "There is <i>no</i> way to guarantee that a certain code will work the same on all systems. Other obstacles could be office versions and os versions. You will simply have to test it and possibly set up error catching to account for issues like can&#39;t reach the website."}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "edited": false, "score": 0, "creation_date": 1426739707, "post_id": 29135827, "comment_id": 46499093, "body": "Thanks guys. I will try and see what happens."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1426729202, "creation_date": 1426729202, "answer_id": 29135827, "question_id": 29130827, "link": "https://stackoverflow.com/questions/29130827/is-this-vba-function-going-to-work-in-any-computer/29135827#29135827", "title": "Is this VBA function going to work in any computer?", "body": "<p>Regarding proxy. If your code should be launched on PC with internet access via proxy, where user connection to internet in IE starts from the dialog like<br><br><img src=\"https://i.stack.imgur.com/oU7Bh.png\" alt=\"authorization dialog\"><br>or<br><img src=\"https://i.stack.imgur.com/peryN.jpg\" alt=\"enter image description here\"><br><br>then you may add user and password in fourth and fifth parameters of <code>objHTTP.Open</code> described in <a href=\"https://msdn.microsoft.com/en-us/library/ms763809.aspx\" rel=\"nofollow noreferrer\">open method article</a>:</p>\n\n<pre><code>objHTTP.Open \"GET\", url, False, user, password\n</code></pre>\n\n<p>Note, you must not store any passwords in your code, to submit credentials you have to prompt user to enter it once at the start of your code.</p>\n\n<p>Also analyzing VBA <code>Err.Number</code> for errors like -2146697211 (800C0005) \"The system cannot locate the resource specified.\", -2147024891 (80070005) \"Access is denied.\", etc, and <code>objHTTP.Status</code> for one from the <a href=\"https://msdn.microsoft.com/en-us/library/ms767625.aspx\" rel=\"nofollow noreferrer\">status property article</a> will help you to find out what is the reason of fault, and handle it, if any:</p>\n\n<pre><code>' ... previous code implementing .open method\nOn Error Resume Next\nobjHTTP.Send (\"\")\nEN = Err.Number\nOn Error Goto 0\n' check if EN is not equal 0 (-2146697211, -2147024891, ..)\nST = objHTTP.Status\n' check if ST is not equal 200\n</code></pre>\n\n<p>First of all you should figure out in your code if internet access is via proxy and need authentication or not. To allow your code work properly on both you may create two functions that return created HttpRequest object: first one for non-proxy internet access, second - for proxy authorization.</p>\n\n<p>Registry keys can also be helpful:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyEnable\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyServer</p>\n\n<p>Generally, as @Degustaf wrote you have to test your code on different PCs to be sure your algorithm for proxy check and authorization works properly.</p>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426729202, "creation_date": 1426706212, "last_edit_date": 1426706463, "question_id": 29130827, "link": "https://stackoverflow.com/questions/29130827/is-this-vba-function-going-to-work-in-any-computer", "title": "Is this VBA function going to work in any computer?", "body": "<p>I am using this VBA function to retrieve data from a website. The function is working fine for me. But I am not sure it will work for the client, who may have internet access restrictions imposed by their company. How can I be sure it will work on every computer? Should I add a proxy? How would I do it? </p>\n\n<pre><code>'func1 and func2 are strings used to compose the URL\n\nFunction cmd(func1 As String, func2 As String)\n   Dim objHTTP\n   Dim aux\n   Dim url As String\n\n   'Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n   Set objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n   url = \"https://www.comdinheiro.com.br/Clientes/ServerToExcel/S2E_TESTANDO001.php?func1=\" &amp; func1 &amp; \"&amp;func2=\" &amp; func2\n   objHTTP.Open \"GET\", url, False\n   objHTTP.SetRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n     'objHTTP.SetProxy 2, \"proxyserver:8080\", \"\"\n   objHTTP.SetProxy HTTPREQUEST_PROXYSETTING_PROXY, \"ProxyServerName\"\n   objHTTP.Send (\"\")\n   aux = objHTTP.responseText\n\n   cmd = Trim(aux)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": true, "score": 1, "last_activity_date": 1426706208, "creation_date": 1426706208, "answer_id": 29130824, "question_id": 29130741, "link": "https://stackoverflow.com/questions/29130741/count-of-unique-values-in-a-column-with-speed-as-a-consideration/29130824#29130824", "title": "count of unique values in a column, with speed as a consideration", "body": "<p>Name the data in your column as a named range. </p>\n\n<p>Save your file. </p>\n\n<p>Go to Data>From Other Sources>From Microsoft Query</p>\n\n<p>Select Excel Files, then navigate to your Excel file. Open it, select your range, and continue and edit in Microsoft Query.</p>\n\n<p>Click the SQL button, and type</p>\n\n<pre><code>SELECT COUNT(DISTINCT rangename.columnheader) FROM rangename rangename \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 4537966, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6a4a6f5e65e036b1cfbc84c404ca8a8?s=128&d=identicon&r=PG", "display_name": "user249611", "link": "https://stackoverflow.com/users/4537966/user249611"}, "edited": false, "score": 0, "creation_date": 1426723825, "post_id": 29132506, "comment_id": 46495310, "body": "Dim Lst As Long Dim Rng As Range  &#39; the last cell in col a that has a value Range(&quot;a65536&quot;).End(xlUp).Select  &#39;save the rowNo Lst = ActiveCell.Row  &#39;Define the range Set Rng = Range(&quot;a1:a&quot; &amp; Lst)  &#39;Go to cell that should contain the sum ThisWorkbook.Sheets(&quot;sheet11&quot;).Select                    &#39;select this worksheet ThisWorkbook.Sheets(&quot;sheet11&quot;).Cells(2, 2).Select        &#39;select column to the right of a1 ThisWorkbook.Sheets(&quot;sheet11&quot;).Cells(-1, 0).Select     &#39;check reference related to 2,2"}, {"owner": {"reputation": 55, "user_id": 4537966, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6a4a6f5e65e036b1cfbc84c404ca8a8?s=128&d=identicon&r=PG", "display_name": "user249611", "link": "https://stackoverflow.com/users/4537966/user249611"}, "edited": false, "score": 0, "creation_date": 1426723849, "post_id": 29132506, "comment_id": 46495315, "body": "Problem: count unique ip address in column A. I have ip addresses in column A labeled IP addresses. Row 2 thru 91 have 7 different ip addresses. I have tried a few different formulas. Most of the the time I get an error #name?. I would like to understand how to deal with this. Yes, the answer would be cool; but i would like to get the understanding of the RC,RC format so that in the future i can programmatically deal with the problem. Currently the last line with the reference .cells(-1,0).select returns application or range error 1004. Help is much appreciated."}, {"owner": {"reputation": 55, "user_id": 4537966, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6a4a6f5e65e036b1cfbc84c404ca8a8?s=128&d=identicon&r=PG", "display_name": "user249611", "link": "https://stackoverflow.com/users/4537966/user249611"}, "edited": false, "score": 0, "creation_date": 1426723879, "post_id": 29132506, "comment_id": 46495324, "body": "I don&#39;t this is correct; but i&#39;ll go with for now. sorry"}], "tags": [], "owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "is_accepted": false, "score": 0, "last_activity_date": 1426712267, "creation_date": 1426712267, "answer_id": 29132506, "question_id": 29130741, "link": "https://stackoverflow.com/questions/29130741/count-of-unique-values-in-a-column-with-speed-as-a-consideration/29132506#29132506", "title": "count of unique values in a column, with speed as a consideration", "body": "<p>For large ranges this formula is longer but faster</p>\n\n<p><code>=SUM(IF(FREQUENCY(IF(range&lt;&gt;\"\",MATCH(range,range,0)),ROW(range)-MIN(ROW(range))),1))</code></p>\n\n<p>confirmed with <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd></p>\n"}], "owner": {"reputation": 55, "user_id": 4537966, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6a4a6f5e65e036b1cfbc84c404ca8a8?s=128&d=identicon&r=PG", "display_name": "user249611", "link": "https://stackoverflow.com/users/4537966/user249611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 29130824, "answer_count": 2, "score": 0, "last_activity_date": 1426712267, "creation_date": 1426705938, "question_id": 29130741, "link": "https://stackoverflow.com/questions/29130741/count-of-unique-values-in-a-column-with-speed-as-a-consideration", "title": "count of unique values in a column, with speed as a consideration", "body": "<p>Is there a faster way to count unique values in a column?\nMy second iteration of the formula uses a range for speed but receives a #NAME? error. Thanks.</p>\n\n<p>I have used the following formula to count the number of unique ip addresses in column 5.  --explained by Jeeped on msdn--</p>\n\n<pre><code>ActiveCell.Formula = \"=sumproduct((ipsheet!C[5]&lt;&gt;\"\"\"\")/ipsheet(ACAS!C[5],ipsheet!C[5]&amp;\"\"\"\"))\"\n</code></pre>\n\n<p>the forumula works BUT it is really slow going over 5000+ entries. I have tried implementing the same formula as</p>\n\n<pre><code>With Sheets(\"ipsheet\")                                                    'create range for ip addresses\n     Set rngOfFindings = .Range(.Range(\"e1\"), .Range(\"e1\").End(xlDown))\nEnd With\n\"=sumproduct((rngOfFindings&lt;&gt;\"\"\"\")/countif(rngOfFindings,rngOfFindings&amp;\"\"\"\"))\"\n</code></pre>\n\n<p>the result is #NAME? </p>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 669, "user_id": 4583548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TvoKo.png?s=128&g=1", "display_name": "Eda190", "link": "https://stackoverflow.com/users/4583548/eda190"}, "edited": false, "score": 0, "creation_date": 1426705434, "post_id": 29130591, "comment_id": 46486876, "body": "just extract one into .sql file and then merge it with the second."}, {"owner": {"reputation": 583, "user_id": 1490858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd728798e8943e5e36127c264ab10369?s=128&d=identicon&r=PG", "display_name": "Dragomir R\u0103zvan", "link": "https://stackoverflow.com/users/1490858/dragomir-r%c4%83zvan"}, "edited": false, "score": 0, "creation_date": 1426705628, "post_id": 29130591, "comment_id": 46486983, "body": "I am affraid that you will have to do the merge in the memory."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4462755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6nEes_XK0S0/AAAAAAAAAAI/AAAAAAAAABc/4rVQZ3fuuUI/photo.jpg?sz=128", "display_name": "zetros", "link": "https://stackoverflow.com/users/4462755/zetros"}, "edited": false, "score": 0, "creation_date": 1426716016, "post_id": 29130915, "comment_id": 46492719, "body": "I want to use this query in vba"}], "tags": [], "owner": {"reputation": 433, "user_id": 3665575, "user_type": "registered", "profile_image": "https://graph.facebook.com/1650173853/picture?type=large", "display_name": "Raushan Kuamr Jha", "link": "https://stackoverflow.com/users/3665575/raushan-kuamr-jha"}, "is_accepted": false, "score": 0, "last_activity_date": 1426706507, "creation_date": 1426706507, "answer_id": 29130915, "question_id": 29130591, "link": "https://stackoverflow.com/questions/29130591/how-to-join-2-tables-from-different-databasess/29130915#29130915", "title": "How to join 2 tables from different databasess", "body": "<p>you can use OpenRowSet() in sql server management studio to access your accessdb database tables</p>\n\n<pre><code>SELECT * From OpenRowset('Microsoft.Jet.OLEDB.4.0',\n';Database=C:\\yourSampleDatabase.mdb;',\n'SELECT * from YourTableName') as linkedQueryToAccess\n</code></pre>\n\n<p>and on this result set you can do the join operation with your table present in mssql database</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4686556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98003eb0af31fed1ef3596c18efea628?s=128&d=identicon&r=PG", "display_name": "Ben Reyes", "link": "https://stackoverflow.com/users/4686556/ben-reyes"}, "is_accepted": false, "score": 0, "last_activity_date": 1426714486, "last_edit_date": 1426714486, "creation_date": 1426709471, "answer_id": 29131748, "question_id": 29130591, "link": "https://stackoverflow.com/questions/29130591/how-to-join-2-tables-from-different-databasess/29131748#29131748", "title": "How to join 2 tables from different databasess", "body": "<p>You could make a linked server in SQL Server between Access and SQL Server and easily query it. But it would be very slow.  </p>\n"}], "owner": {"reputation": 23, "user_id": 4462755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6nEes_XK0S0/AAAAAAAAAAI/AAAAAAAAABc/4rVQZ3fuuUI/photo.jpg?sz=128", "display_name": "zetros", "link": "https://stackoverflow.com/users/4462755/zetros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594645195, "creation_date": 1426705352, "last_edit_date": 1594645195, "question_id": 29130591, "link": "https://stackoverflow.com/questions/29130591/how-to-join-2-tables-from-different-databasess", "title": "How to join 2 tables from different databasess", "body": "<p>Is there any way to join 2 tables from different databases in a query? The first table comes from an MS Access database, and second one come from a SQL Server database</p>\n"}, {"tags": ["arrays", "vba", "excel", "range", "autofilter"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1426706188, "post_id": 29130153, "comment_id": 46487256, "body": "You can use an array. This post of mine may be of interest: <a href=\"http://yoursumbuddy.com/autofilter-vba-operator-parameters/\" rel=\"nofollow noreferrer\">yoursumbuddy.com/autofilter-vba-operator-parameters</a>"}, {"owner": {"reputation": 15, "user_id": 4671559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92ce37350b2353776b5567abd9154a13?s=128&d=identicon&r=PG", "display_name": "Kakeda", "link": "https://stackoverflow.com/users/4671559/kakeda"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1426707328, "post_id": 29130153, "comment_id": 46487942, "body": "i think i am having problem with converting a range to an array as i did make some change and i am still getting an error.Error is Autofilter error of Range Class Failed."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4671559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92ce37350b2353776b5567abd9154a13?s=128&d=identicon&r=PG", "display_name": "Kakeda", "link": "https://stackoverflow.com/users/4671559/kakeda"}, "edited": false, "score": 0, "creation_date": 1426705641, "post_id": 29130570, "comment_id": 46486989, "body": "I have more than 2 fields that i want  to sort through on the same column, that is why i added the range selection dialog box. And the Or command is  tomake sure that all the fields within the slected range are visible in the autofiter. Since the number of criterias is dynamic, does that mean for 100 docs that i want to find, i will have to write criteria 100 times rather than inputing them into an array???"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 15, "user_id": 4671559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92ce37350b2353776b5567abd9154a13?s=128&d=identicon&r=PG", "display_name": "Kakeda", "link": "https://stackoverflow.com/users/4671559/kakeda"}, "edited": false, "score": 0, "creation_date": 1426705833, "post_id": 29130570, "comment_id": 46487088, "body": "Passing an array to the <code>.AutoFilter</code> is not a feature I&#39;m aware of. It also doesn&#39;t seem to fit with the documentation (referenced) for Criteria1: <code>The criteria (a string; for example, &quot;101&quot;).</code> If you have an example of it working, I&#39;d be most interested in seeing that, because it does sound <i>very</i> useful!"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1426705267, "creation_date": 1426705267, "answer_id": 29130570, "question_id": 29130153, "link": "https://stackoverflow.com/questions/29130153/autofilter-by-inputting-array-by-selecting-a-range-of-crieteria-vba-excel/29130570#29130570", "title": "Autofilter by inputting array by selecting a range of crieteria vba excel", "body": "<p>Based on your <code>Operator:=xlOr</code>, I think you'd like to filter on multiple criteria. </p>\n\n<p>According to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884%28v=office.14%29.aspx\" rel=\"nofollow\">Microsoft's docs</a> (for Excel 2010), you can have 2 criteria, and the <code>Operator:=</code> tells it what to do with the two of them. In your case, the code would be:</p>\n\n<pre><code>ActiveSheet.Range(\"$a:$F\").AutoFilter Field:=1, _\n             Criteria1:=Srch_Cr(1), Criteria2:=Srch_Cr(2), Operator:=xlOr\n</code></pre>\n\n<p>You cannot simply pass an array to the Criteria1 parameter and assume the <code>.AutoFilter</code> function will figure out what to do with it.</p>\n"}, {"tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": true, "score": 2, "last_activity_date": 1426772540, "creation_date": 1426772540, "answer_id": 29146191, "question_id": 29130153, "link": "https://stackoverflow.com/questions/29130153/autofilter-by-inputting-array-by-selecting-a-range-of-crieteria-vba-excel/29146191#29146191", "title": "Autofilter by inputting array by selecting a range of crieteria vba excel", "body": "<p>This will do it as long as your selected range contains text, or numbers stored as text:</p>\n\n<pre><code>Sub Hyperlink_opener()\nDim Selrng As Range\nDim srch_cr As Variant\n\nSet Selrng = Application.InputBox(\"Select a range\", \"Obtain Range Object\", Type:=8)\nsrch_cr = Application.WorksheetFunction.Transpose(Selrng)\nSheets(\"DocLog\").Range(\"$A:$F\").AutoFilter Field:=1, Criteria1:=srch_cr, Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>Note that you need to transpose the range to turn it to a single-dimension range. Also, no need to <code>Select</code> the sheet, just refer to it.</p>\n\n<p>If you have numbers that need to be filtered, you can either store them as text in your filter range or convert them to text in the code by parsing the array.</p>\n"}], "owner": {"reputation": 15, "user_id": 4671559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92ce37350b2353776b5567abd9154a13?s=128&d=identicon&r=PG", "display_name": "Kakeda", "link": "https://stackoverflow.com/users/4671559/kakeda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 2, "accepted_answer_id": 29146191, "answer_count": 2, "score": 0, "last_activity_date": 1426772540, "creation_date": 1426703988, "last_edit_date": 1426707424, "question_id": 29130153, "link": "https://stackoverflow.com/questions/29130153/autofilter-by-inputting-array-by-selecting-a-range-of-crieteria-vba-excel", "title": "Autofilter by inputting array by selecting a range of crieteria vba excel", "body": "<p><strong><em>edit # 1</em></strong>\nI am trying to autofilter a sheet based on the criteria as an array, the array values are selected by using the dialog box to select the range.Also, this dialog box's intent is to select multiple unsorted values that need to be sorted.Here is the code:</p>\n\n<pre><code>Sub Hyperlink_opener()\nDim Selrng As Range\nDim srch_cr As Variant\nSet Selrng = Application.InputBox(\"Select a range\", \"Obtain Range Object\", Type:=8)\n\nsrch_cr = Array(Selrng)\nSheets(\"DocLog\").Select\nActiveSheet.Range(\"$A:$F\").AutoFilter Field:=1, Criteria1:=srch_cr, Operator:=xlFilterValues\n'ActiveWindow.SmallScroll Down:=-15\n\nEnd Sub\n</code></pre>\n\n<p>This is currently not searching for the cell that i selected and is giving me an error Autofilter method of range class failed.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1426710889, "post_id": 29130078, "comment_id": 46490079, "body": "Keep <code>Option Explicit</code> and fix the code. You are asking for trouble here by having different code blocks do the same thing depending on a variable declaration."}, {"owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1426880454, "post_id": 29130078, "comment_id": 46566996, "body": "It isn&#39;t my code to &quot;fix&quot;. It&#39;s general code that gets reused for projects that may or may not have the variable defined."}], "answers": [{"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1426710772, "post_id": 29130079, "comment_id": 46490000, "body": "Check every line for the entire code base on each function call. Yikes!"}, {"owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1427119060, "post_id": 29130079, "comment_id": 46633689, "body": "It gets called once, so the overhead is minimal."}], "tags": [], "owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "is_accepted": true, "score": 0, "last_activity_date": 1426703731, "creation_date": 1426703731, "answer_id": 29130079, "question_id": 29130078, "link": "https://stackoverflow.com/questions/29130078/vba-check-if-a-variable-exists/29130079#29130079", "title": "VBA: Check if a Variable Exists", "body": "<p>The alternative is to dive into programming the VBE itself. This function loops through the declaration section of the standard modules in the passed project to find any line that declares the passed variable name. It only checks the declarations section because scope matters and any procedural variables won't be seen by this function anyway.</p>\n\n<pre><code>Private Function DoesVariableExist(book As Workbook, varName As String) As Boolean\n    Const ProcKind As Integer = 0 'sub or function\n    Const vbext_ct_StdModule As Integer = 1 'standard modules only\n    Const DIMSTMNT As String = \"Dim\"\n    Const PUBLICSTMNT As String = \"Public\"\n    Const PRIVATESTMNT As String = \"Private\"\n    Const CONSTSTMNT As String = \"Const\"\n\n    Dim VBProj As Object\n    Dim VBComp As Object\n    Dim codeMod As Object\n    Dim procName As String\n    Dim lineNum As Long\n    Dim lineText As String\n\n    DoesVariableExist = False\n\n    'set object to components within the project\n    Set VBProj = book.VBProject.VBComponents\n\n    'loop through components\n    For Each VBComp In VBProj\n\n        'find standard modules\n        If VBComp.Type = vbext_ct_StdModule Then\n\n            'set object to code module\n            Set codeMod = VBComp.CodeModule\n\n            With codeMod\n\n                'loop through lines of code in the declaration section\n                For lineNum = 1 To .CountOfDeclarationLines\n                    lineText = .Lines(lineNum, 1)\n\n                    'check for declarartion statement and passed variable name (case-insensitive)\n                    If (InStrB(lineText, DIMSTMNT) &gt; 0 Or _\n                        InStrB(lineText, PUBLICSTMNT) &gt; 0 Or _\n                        InStrB(lineText, PRIVATESTMNT) &gt; 0 Or _\n                        InStrB(lineText, CONSTSTMNT) &gt; 0) And _\n                        InStrB(LCase(lineText), LCase(varName)) &gt; 0 Then\n\n                        DoesVariableExist = True\n                        Exit Function\n                    End If\n                Next lineNum\n            End With\n        End If\n    Next VBComp\nEnd Function\n</code></pre>\n\n<p>This comes with its own negatives, of course. You need to trust access to the VBA project object model (found in the Trust Center Settings), which can open you up for malicious code. But in an environment where you are not opening files from unknown sources, the trade-off can be well worth it.</p>\n\n<p>As an aside, I'm using late binding here, so you don't have to set a reference to access the VBE objects.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7492715, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7UUDGETLa0k/AAAAAAAAAAI/AAAAAAAAAsg/KYl1ZxEywhk/photo.jpg?sz=128", "display_name": "Gryphon Steberl", "link": "https://stackoverflow.com/users/7492715/gryphon-steberl"}, "edited": false, "score": 0, "creation_date": 1485828566, "post_id": 41948581, "comment_id": 71077316, "body": "As far as I know, this should work for any other language that supports something that works like If End If. If a language has something analogous to If, End If, but does not have an analogue to If, Else, End If, then do an If, End If for true, and an If, End If for false."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1553621814, "post_id": 41948581, "comment_id": 97450248, "body": "Your answer is <code>VB.NET</code> - the question is regarding <code>VBA</code>, which isn&#39;t the same"}], "tags": [], "owner": {"reputation": 1, "user_id": 7492715, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7UUDGETLa0k/AAAAAAAAAAI/AAAAAAAAAsg/KYl1ZxEywhk/photo.jpg?sz=128", "display_name": "Gryphon Steberl", "link": "https://stackoverflow.com/users/7492715/gryphon-steberl"}, "is_accepted": false, "score": -1, "last_activity_date": 1485828503, "last_edit_date": 1485828503, "creation_date": 1485828154, "answer_id": 41948581, "question_id": 29130078, "link": "https://stackoverflow.com/questions/29130078/vba-check-if-a-variable-exists/41948581#41948581", "title": "VBA: Check if a Variable Exists", "body": "<pre><code>Public Class Form1\n    Dim varExists As Boolean = False ' This should not be placed within a sub. Choose any valid name, preferably one that makes sense, like \"varOneExists,\" as long as you change all instances of it to the new name.\n    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click ' This can be any other sub, just take the code within the sub and place it elsewhere.\n        Dim otherVar As String = \"\" ' Doesn't need to be a string. Any valid name is fine, as long as you change all instances of it to the new name.\n        varExists = True ' Always put this after the code that declares otherVar.\n    End Sub\n    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click ' This can be any other sub, just take the code within the sub and place it elsewhere.\n        If varExists = True Then\n            ' The code here will run if otherVar has been declared. Feel free to add more valid lines, as it will still work.\n        Else\n            ' The code here will run If otherVar has not been declared. Feel free to add more valid lines, as it will still work.\n        End If\n    End Sub\nEnd Class\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8201, "user_id": 599668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5b7d901c39cd592de9c407810715628?s=128&d=identicon&r=PG", "display_name": "slfan", "link": "https://stackoverflow.com/users/599668/slfan"}, "edited": false, "score": 2, "creation_date": 1553623019, "post_id": 55362992, "comment_id": 97450867, "body": "Could you please show the code for your explanation? It would be much easier to understand what you mean"}], "tags": [], "owner": {"reputation": 1, "user_id": 11261937, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fIP7u6SUeiA/AAAAAAAAAAI/AAAAAAAAAdM/1OvoOkMS9TY/photo.jpg?sz=128", "display_name": "Alfonso Galvan", "link": "https://stackoverflow.com/users/11261937/alfonso-galvan"}, "is_accepted": false, "score": 0, "last_activity_date": 1553621190, "creation_date": 1553621190, "answer_id": 55362992, "question_id": 29130078, "link": "https://stackoverflow.com/questions/29130078/vba-check-if-a-variable-exists/55362992#55362992", "title": "VBA: Check if a Variable Exists", "body": "<p>As much of a pain as it is, since you can't tell if a variable exists, double up on it.  When a variable is created, create a bookmark along with it, and check to see if the bookmark exists.  If the bookmark exists, then you know the variable exists.  It's one extra line instead of multiple lines of programming </p>\n"}, {"comments": [{"owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "edited": false, "score": 0, "creation_date": 1553697311, "post_id": 55363292, "comment_id": 97481699, "body": "In general, yes, but my environment is a little odd. This code is part of ThisWorkbook that can be updated for hundreds of Excel spreadsheets automatically, so I need the check to ensure that the functional code of those spreadsheets isn&#39;t broken if the variable doesn&#39;t exist. One of those &quot;exceptions that proves the rule&quot; things."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1553622134, "creation_date": 1553622134, "answer_id": 55363292, "question_id": 29130078, "link": "https://stackoverflow.com/questions/29130078/vba-check-if-a-variable-exists/55363292#55363292", "title": "VBA: Check if a Variable Exists", "body": "<p>fwiw - this isn't a good approach to take for runtime logic with any code. If your code depends on a specific variable, then you should <em>always</em> have that variable declared inside your procedure but with a <strong>default value</strong> which is essentially why we have <code>Optional</code> params. Instead of checking for the variable's existence just check for the default value.</p>\n\n<p>e.g.</p>\n\n<pre><code>Sub Foo(Optional ByVal Bar As Integer = -99)\n    '// My code here....\n    If Bar = -99 Then\n        '// variable wasn't supplied to the procedure\n    Else\n        '// Do something with the variable that WAS supplied\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 162, "user_id": 4403619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8hvt.png?s=128&g=1", "display_name": "phrebh", "link": "https://stackoverflow.com/users/4403619/phrebh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15183, "favorite_count": 0, "accepted_answer_id": 29130079, "answer_count": 4, "score": 0, "last_activity_date": 1553622134, "creation_date": 1426703731, "question_id": 29130078, "link": "https://stackoverflow.com/questions/29130078/vba-check-if-a-variable-exists", "title": "VBA: Check if a Variable Exists", "body": "<p>I have the following function to check for the existence of a variable:</p>\n\n<pre><code>Private Function DoesVariableExist(Optional valuePassed As Variant) As Boolean\n    If Not IsMissing(valuePassed) And Not IsEmpty(valuePassed) Then\n        DoesVariableExist = True\n    End If\nEnd Function\n</code></pre>\n\n<p>The idea being that if the variable doesn't exist, I can run different code than if it does exist.</p>\n\n<p>The code works fine as long as I remove the <code>Option Explicit</code> line from the module. With that line in there, I get a compiler error, \"Variable not defined,\" because, of course, that's what I'm checking for. This is a small module with only a handful of procedures, so I could probably get away with not requiring variable declaration, but that's not good coding practice. So, what's the alternative?</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1426704065, "post_id": 29129976, "comment_id": 46486055, "body": "Could you try to change cont.AddSubcontainer &quot;KeyC&quot;, &quot;C&quot; to cont.AddSubcontainer &quot;KeyB&quot;, &quot;C&quot;"}, {"owner": {"reputation": 67, "user_id": 2414699, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55a78453207de940bef2a7cdd4bb2073?s=128&d=identicon&r=PG", "display_name": "Peter Xu", "link": "https://stackoverflow.com/users/2414699/peter-xu"}, "reply_to_user": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1426708125, "post_id": 29129976, "comment_id": 46488391, "body": "That doesn&#39;t work, nor should I have expected it to. The key is used for identifying the subcontainer that is being added. cont is the container it should be added under. So changing KeyC to KeyB doesn&#39;t make sense."}, {"owner": {"reputation": 65, "user_id": 5052505, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5fa51285e84097d012dabc6211a17190?s=128&d=identicon&r=PG&f=1", "display_name": "J.M", "link": "https://stackoverflow.com/users/5052505/j-m"}, "edited": false, "score": 1, "creation_date": 1553101597, "post_id": 29129976, "comment_id": 97264172, "body": "@Peter, Although this question was posted quite long time ago, I would like to know, if possible, whether it was resolved or not since I am facing the same issue and I am blocked. If it was resolved, can you please share with us the updated solution/code?  Many thanks."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1554228024, "post_id": 29129976, "comment_id": 97671832, "body": "@PeterXu - I too am interested in knowing if you ever got a solution for this problem. Thanks."}], "owner": {"reputation": 67, "user_id": 2414699, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55a78453207de940bef2a7cdd4bb2073?s=128&d=identicon&r=PG", "display_name": "Peter Xu", "link": "https://stackoverflow.com/users/2414699/peter-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593523286, "creation_date": 1426703433, "last_edit_date": 1593523286, "question_id": 29129976, "link": "https://stackoverflow.com/questions/29129976/how-to-add-adjacent-subcontainers-in-visio-vba", "title": "How to add adjacent subcontainers in Visio VBA?", "body": "<p>I am trying to add a hierarchy of nested containers. I want to be able to add a subcontainer (B) to a given container (A), which may have other subcontainers (C), so that B and C will be adjacent to another.</p>\n\n<p>I'm running into an issue where B is being nested in C. What I want is for B and C to be within A, but not within each other.</p>\n\n<p><img src=\"https://i.stack.imgur.com/VtMIX.png\" alt=\"enter image description here\"></p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub Main()\n    Dim shape As Visio.shape\n\n    Dim cont As Container\n    Set cont = New Container\n    cont.InitializeClass \"KeyA\", \"A\"\n\n    cont.AddSubcontainer \"KeyB\", \"B\"\n    cont.AddSubcontainer \"KeyC\", \"C\"\n\nEnd Sub\n</code></pre>\n\n<p>I have a class Container</p>\n\n<pre><code>Option Explicit\nPrivate mName As String\nPrivate mKey As String\nPrivate mContainerShape As Visio.shape\nPrivate mSubcontainers 'Dictionary\nPrivate mX_coord As Double\nPrivate mY_coord As Double\n\n...\n\nPrivate Sub Class_Initialize()\n    Set mContainerShape = createContainer()\n    Set mSubcontainers = CreateObject(\"Scripting.Dictionary\")\nEnd Sub\n\nPublic Sub InitializeClass(pKey As String, pName As String)\n    'Initialize with Setter so that container text title will be set too\n    Me.key = pKey\n    Me.Name = pName\nEnd Sub\n\nPublic Function createContainer(Optional shape As Visio.shape = Nothing) As Visio.shape\n    Dim Container As Visio.shape\n    Dim doc As Visio.Document\n\n    Set doc = Application.Documents.OpenEx(Application.GetBuiltInStencilFile(visBuiltInStencilContainers, visMSUS), visOpenHidden)\n    Set createContainer = Application.ActivePage.DropContainer(doc.Masters.ItemFromID(2), shape)\n\n    doc.Close\nEnd Function\n\nPublic Function AddSubcontainer(subKey As String, subName As String)\n    Dim subcontainerKey As String\n    Dim subcontainer As Container\n    Dim subcontainerShape As Visio.shape\n    Dim subcontainer_row As Integer\n\n    subcontainerKey = mKey &amp; subKey\n    Set subcontainer = New Container\n    subcontainer.InitializeClass subcontainerKey, subName\n    Set subcontainerShape = subcontainer.ContainerShape\n    subcontainer_row = subcontainerShape.AddRow(visSectionProp, visRowLast, visTagDefault)\n\n    With mContainerShape\n        .ContainerProperties.AddMember subcontainerShape, visMemberAddExpandContainer\n        .ContainerProperties.FitToContents\n    End With\n\n    mSubcontainers.Add subcontainerKey, subcontainer\nEnd Function\n</code></pre>\n\n<p>I think the issue is occurring at the AddMember call in AddSubcontainer(). Even though it's adding a member to container A, it seems to be sticking it inside B.</p>\n"}, {"tags": ["excel", "vba", "duplicates", "chain"], "comments": [{"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1426703857, "post_id": 29129889, "comment_id": 46485932, "body": "What have you tried? Also your function description is contradictory, shouldn&#39;t you include 2,4,5,7, and 8 as an output for your first example?"}, {"owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "reply_to_user": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1426705157, "post_id": 29129889, "comment_id": 46486707, "body": "No justly so! I don&#39;t have necessarily all the data of the initial chain in my output; that&#39;s all the difficulty! Otherwise I won&#39;t post my question here.."}, {"owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "reply_to_user": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1426705454, "post_id": 29129889, "comment_id": 46486886, "body": "I have tried to convert my cell into a line in order to sort by cells but I don&#39;t manage to obtain the result that i want. My problem is to compare 2 chains of data and to only keep data which don&#39;t appear in my initial chain, that&#39;s why I don&#39;t have to include 2, 4, 5, 7 and 8 as an output in my first example. So, my is my example clear now ?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "edited": false, "score": 0, "creation_date": 1426845053, "post_id": 29132689, "comment_id": 46546469, "body": "Hi, First thanks for posting this function. It is very nice of you. But I don&#39;t manage to make it work with my case, can you give an example with which you manage to make it work. I tried with the value I mention in my example but the result is #NOM?. Which type of data do we have to use to make it work ? Thanks."}, {"owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "edited": false, "score": 0, "creation_date": 1426848528, "post_id": 29132689, "comment_id": 46548395, "body": "finally, i manage to make it work but it is not what I want, because when I for example use the 2 cells I mention in my example, the result is 2, 4, 5 , 7, 8, 15 wheareas I would like that the function gives as a result 15, am I clear ?"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "edited": false, "score": 0, "creation_date": 1426850515, "post_id": 29132689, "comment_id": 46549362, "body": "Check my edited answer"}, {"owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "edited": false, "score": 0, "creation_date": 1426859269, "post_id": 29132689, "comment_id": 46554556, "body": "It is just PERFECT ! Thank you so much for your help ! I mean really thank you."}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 0, "last_activity_date": 1426850502, "last_edit_date": 1426850502, "creation_date": 1426712826, "answer_id": 29132689, "question_id": 29129889, "link": "https://stackoverflow.com/questions/29129889/isolate-a-non-duplicate-of-a-chain-separated-by-from-another-longer-chain-in/29132689#29132689", "title": "Isolate a non duplicate of a chain separated by &quot;,&quot; from another longer chain in VBA", "body": "<p>This function will work for you </p>\n\n<pre><code> Function ReturnUnique(cell1 As Range, cell2 As Range) As String\n        ReturnUnique = \"\"\n        Dim v1 As Variant, v2 As Variant\n        v1 = Split(cell1.Value, \",\")\n        v2 = Split(cell2.Value, \",\")\n        Dim i As Long, j As Long\n        Dim bool As Boolean\n        For i = LBound(v1, 1) To UBound(v1, 1)\n            bool = True\n            For j = LBound(v2, 1) To UBound(v2, 1)\n                If v2(j) = v1(i) Then\n                    bool = False\n                    Exit For\n                End If\n            Next j\n            If bool Then\n                If ReturnUnique = \"\" Then\n                    ReturnUnique = v1(i)\n                Else\n                    ReturnUnique = ReturnUnique &amp; \", \" &amp; v1(i)\n                End If\n            End If\n        Next i\n\n        For i = LBound(v2, 1) To UBound(v2, 1)\n            bool = True\n            For j = LBound(v1, 1) To UBound(v1, 1)\n                If v1(j) = v2(i) Then\n                    bool = False\n                    Exit For\n                End If\n            Next j\n            If bool Then\n                If ReturnUnique = \"\" Then\n                    ReturnUnique = v2(i)\n                Else\n                    ReturnUnique = ReturnUnique &amp; \", \" &amp; v2(i)\n                End If\n            End If\n        Next i\n    End Function\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Try this function instead</p>\n\n<pre><code>Function ReturnUnique(cell1 As Range, cell2 As Range) As String\n    ReturnUnique = \"\"\n    Dim v1 As Variant, v2 As Variant\n    v1 = Split(Trim(cell1.Value), \",\")\n    v2 = Split(Trim(cell2.Value), \",\")\n    Dim i As Long, j As Long\n    Dim bool As Boolean\n    For i = LBound(v2, 1) To UBound(v2, 1)\n        bool = True\n        For j = LBound(v1, 1) To UBound(v1, 1)\n            If Trim(v1(j)) = Trim(v2(i)) Then\n                bool = False\n                Exit For\n            End If\n        Next j\n        If bool Then\n            If ReturnUnique = \"\" Then\n                ReturnUnique = v2(i)\n            Else\n                ReturnUnique = ReturnUnique &amp; \", \" &amp; v2(i)\n            End If\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1426723151, "accepted_answer_id": 29132689, "answer_count": 1, "score": -4, "last_activity_date": 1426850502, "creation_date": 1426703193, "question_id": 29129889, "link": "https://stackoverflow.com/questions/29129889/isolate-a-non-duplicate-of-a-chain-separated-by-from-another-longer-chain-in", "closed_reason": "Needs more focus", "title": "Isolate a non duplicate of a chain separated by &quot;,&quot; from another longer chain in VBA", "body": "<p>For example if in the celle A1 you have: 1, 2, 3, 4 ,5 ,6 ,7 ,8 ,9\nAnd in A2 you have: 1, 3, 6 ,9 , 15\nI would like to find a VBA function F which will do that:\nF(A1; A2)= 15, what it means that it will give the only character which is not in the chain of data seen in A1\nAnd if we have in B1: 1, 2 ,5 ,8, 15, 20. F will do that:\nF(A1; B2)=15, 20 (separated by \",\" or something else), which are the only 2 characters which don't appear in my cell A1.Etc and etc, if you have 2, 3 or 4 characters which don't appear in the data chain A1.\nSomeone could give me such a code please ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1426706922, "last_edit_date": 1525816189, "creation_date": 1426706922, "answer_id": 29131052, "question_id": 29129629, "link": "https://stackoverflow.com/questions/29129629/use-find-and-select-all-the-results/29131052#29131052", "title": "Use Find and select all the results", "body": "<p>I believe that there is no native VBA functions which will let you select all instances of a search string in a range. Luckily for you, there have been other people before you who has wanted this functionality so some user-created code for it has been made. An example is the <code>FindAll</code>-function presented by Chip Pearson <a href=\"http://www.cpearson.com/excel/findall.aspx\" rel=\"nofollow noreferrer\">here</a>, which I believe you should be able to adapt to your needs quite easily. It returns a <code>range</code>-object containing all the cells containing the search-text, so pasting that range to a column should be fairly trivial.</p>\n"}], "owner": {"reputation": 49, "user_id": 4668703, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153067006256140/picture?type=large", "display_name": "Jorge Molano", "link": "https://stackoverflow.com/users/4668703/jorge-molano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1888, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1426707913, "creation_date": 1426702385, "last_edit_date": 1426707913, "question_id": 29129629, "link": "https://stackoverflow.com/questions/29129629/use-find-and-select-all-the-results", "title": "Use Find and select all the results", "body": "<p>How do I can select all the results of the Find function and then copy and paste in a new column of the same Sheet with a macro</p>\n\n<p>Below is an example</p>\n\n<p><img src=\"https://i.stack.imgur.com/iqhaY.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "oop", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": true, "score": 3, "last_activity_date": 1426703607, "creation_date": 1426703607, "answer_id": 29130026, "question_id": 29129569, "link": "https://stackoverflow.com/questions/29129569/vbe-sees-ambigious-name/29130026#29130026", "title": "VBE sees Ambigious Name", "body": "<p>You have a duplicate declaration of your Private property variable and your let and get public procedure properties. You should name your variable </p>\n\n<pre><code>Private itesting_property As Integer\n</code></pre>\n\n<p>You also have your Let before your Get. You should assign a value before you write it. Also, your Get() should not accept a variable and be dimmed as an integer, and your Let() should accept a variable as an integer and not be dimmed. </p>\n\n<pre><code>Public Property Get testing_property() As Integer\n    MsgBox \"Get Box\"\n    testing_property = itesting_property\nEnd Property\nPublic Property Let testing_property(new_value As Integer)\n    MsgBox \"Let Box\"\n    itesting_property = new_value\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 29130026, "answer_count": 1, "score": 1, "last_activity_date": 1426703607, "creation_date": 1426702198, "question_id": 29129569, "link": "https://stackoverflow.com/questions/29129569/vbe-sees-ambigious-name", "title": "VBE sees Ambigious Name", "body": "<p>Hi So I am just Learning about VB's take on OOP. When testing how <code>Let</code>,<code>Get</code> methods work I created this dummy class <code>Class1</code>, apprarently it cannot be compiled becasue \"Ambigious name detected: ~\" with this error VBE highlights line 2 of the class(one declaring test_property as Integer).</p>\n\n<p>I don't understand what is a ambigious about it?</p>\n\n<p>FYI I experiemented by trying to declare that proterty with <code>Dim</code> &amp; <code>Public</code> none of those methods change anything.</p>\n\n<p>See class <code>Class1</code> bellow:</p>\n\n<pre><code>Option Explicit\nPrivate testing_property As Integer\n\nPublic Property Let testing_property(new_value As Integer)\n    MsgBox \"Let Box\"\n    Let testing = new_value\nEnd Property\n\nPublic Property Get testing_property(new_value As Integer) As Integer\n    MsgBox \"Get Box\"\nEnd Property\n</code></pre>\n\n<p>I am calling it using following test Sub:</p>\n\n<pre><code>Sub Test()\n    Dim test_Class As Class1\n    Set test_Class = New Class1\n    With test_Class\n        .testing_property = \"1\"\n        Debug.Print .testing_property\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "delete-row"], "comments": [{"owner": {"reputation": 2174, "user_id": 2008576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4f8209c20efe49a204fcc7e6e7862d0f?s=128&d=identicon&r=PG", "display_name": "tbur", "link": "https://stackoverflow.com/users/2008576/tbur"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1426701841, "post_id": 29129296, "comment_id": 46484622, "body": "Pro-tip right there, @pnuts. When deleting, always start at the bottom and work to the top."}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1426701984, "post_id": 29129296, "comment_id": 46484709, "body": "Cheers @pnuts. Would have taken me a while to figure that out o_O"}], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1426702537, "post_id": 29129402, "comment_id": 46485081, "body": "Cheers. That makes perfect sense, however I think my original code has far more problems as it still leaves some values &lt;0.501 and not all sheets are sorted descending - I will work on debugging the sheets loop tomorrow."}, {"owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "reply_to_user": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 1, "creation_date": 1426702901, "post_id": 29129402, "comment_id": 46485320, "body": "@squarah - It may be as simple as casting to a double to do the comparisions using the <code>CDbl</code> function. See updated answer."}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1426703348, "post_id": 29129402, "comment_id": 46485614, "body": "That doesn&#39;t seem to change things unfortunately. I see that 0.501 is a double but what exactly is casting to a double? Cheers!"}, {"owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "reply_to_user": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 1, "creation_date": 1426706287, "post_id": 29129402, "comment_id": 46487315, "body": "@squarah - Actually the safest thing to do would be to cast both sides as a decimal. You do this with the <code>CDec</code> function (see updated answer). Double comparison can sometimes be a bit wonky."}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 1, "creation_date": 1426765596, "post_id": 29129402, "comment_id": 46510348, "body": "thanks for your help, that part is working nicely now. I have posted the other problems I am experiencing with the same code to another question <a href=\"http://stackoverflow.com/questions/29143398/vba-sort-decending-not-sorting-unpredictable-looping\">link</a>"}], "tags": [], "owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "is_accepted": true, "score": 1, "last_activity_date": 1426706232, "last_edit_date": 1426706232, "creation_date": 1426701639, "answer_id": 29129402, "question_id": 29129296, "link": "https://stackoverflow.com/questions/29129296/vba-delete-entire-row-if-value-is-less-than-specified-value-deletes-wrong-rows/29129402#29129402", "title": "VBA Delete entire row if value is less than specified value - deletes wrong rows", "body": "<p>You need to traverse your <code>K</code> loop in reverse order. Otherwise rows will be skipped as you delete because they are shifted up by the delete operation and your <code>K</code> value increments over them.</p>\n\n<pre><code>For K = endrow To 2 Step -1\n    If CDec(.Cells(K, 19).Value) &lt; CDec(0.501) Then\n        .Range(\"S\" &amp; K).EntireRow.Delete\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1717, "favorite_count": 0, "accepted_answer_id": 29129402, "answer_count": 1, "score": 0, "last_activity_date": 1426706232, "creation_date": 1426701318, "question_id": 29129296, "link": "https://stackoverflow.com/questions/29129296/vba-delete-entire-row-if-value-is-less-than-specified-value-deletes-wrong-rows", "title": "VBA Delete entire row if value is less than specified value - deletes wrong rows", "body": "<p>I'm attempting to run a small macro that searches column S of a worksheet and if the value in column S is &lt;0.501, it deletes that row.</p>\n\n<p>The code I am running at the moment deletes some rows but appears to do so randomly rather than based on the cell value in s. Can anyone see where my error is coming from?</p>\n\n<pre><code>Sub sort_delete_500cust()\n\n         Dim WS_Count As Integer\n         Dim I, K As Integer\n         Dim endrow As Long\n\n         ' Set WS_Count equal to the number of worksheets in the active\n         ' workbook.\n         WS_Count = Workbooks(\"Standard.xlsx\").Worksheets.count\n\n         ' Begin the loop.\n         For I = 1 To WS_Count\n\n            With Worksheets(I)\n\n                endrow = .Range(\"a\" &amp; .Rows.count).End(xlUp).row ' only works if cells are unmerged\n                Range(\"A2:v2\" &amp; endrow).Sort _\n                Key1:=Range(\"s2\"), Order1:=xlDescending 'key is the sort by column\n\n                                For K = 2 To endrow\n\n                        If .Cells(K, 19).Value &lt; 0.501 Then\n                        .Range(\"S\" &amp; K).EntireRow.Delete\n\n                        End If\n\n                    Next K\n\n            End With\n\n         Next I\n\n      End Sub\n</code></pre>\n\n<p>Cheers!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1426701661, "post_id": 29129220, "comment_id": 46484515, "body": "Could be difficult if an update has occurred. You will get an error that another user has updated the record."}], "tags": [], "owner": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "is_accepted": true, "score": 1, "last_activity_date": 1426701017, "creation_date": 1426701017, "answer_id": 29129220, "question_id": 29128903, "link": "https://stackoverflow.com/questions/29128903/afterupdate-combobox-find-and-replace/29129220#29129220", "title": "AfterUpdate combobox find and replace", "body": "<p>Like this?</p>\n\n<pre><code>Private Sub cmbTest_AfterUpdate()\n\n    CurrentDb.Execute \"update Userdata set Recall_position = 0 where Recall_position = 1\"\n    CurrentDb.Execute \"update Userdata set Recall_position = 1 where ID = \" &amp; Me.cmbTest.Column(0)\n\nEnd Sub\n</code></pre>\n\n<p>The first query updates all records with <code>Recall_position = 1</code> to <code>Recall_position = 0</code>.</p>\n\n<p>The second query updates the record with the ID in the first column of the selected item in the combo box to <code>Recall_position = 1</code>.<br>\n<em>(I assumed that it's a numeric value and that the column in the table is called <code>ID</code>)</em></p>\n"}, {"comments": [{"owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "edited": false, "score": 0, "creation_date": 1426860029, "post_id": 29146387, "comment_id": 46555039, "body": "Found what it&#39;s doing but not what&#39;s causing it. When I select a new name in the box it does everything it&#39;s suppose to do. However, it&#39;s also taking the last name of the first selection in the combo box and changing it to the row count of the name selected. So if I choose the last name of Michaels and it&#39;s the 23rd item on the list, it changes the last name of the first item to 23."}, {"owner": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "edited": false, "score": 0, "creation_date": 1427148675, "post_id": 29146387, "comment_id": 46651719, "body": "Can you show us the generated SQL? <i>(especially the second query)</i>"}, {"owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "reply_to_user": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "edited": false, "score": 0, "creation_date": 1427730401, "post_id": 29146387, "comment_id": 46886626, "body": "I was able to find the problem. My table had a huge gap in ID #. I reset the ID to start back at one with no gaps and it fixed the problem."}], "tags": [], "owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "is_accepted": false, "score": 0, "last_activity_date": 1426772974, "creation_date": 1426772974, "answer_id": 29146387, "question_id": 29128903, "link": "https://stackoverflow.com/questions/29128903/afterupdate-combobox-find-and-replace/29146387#29146387", "title": "AfterUpdate combobox find and replace", "body": "<p>So using that code I have</p>\n\n<pre><code>Private Sub Combo1_AfterUpdate()\n    CurrentDb.Execute \"UPDATE Userdata SET Recall_position = 0 WHERE Recall_position = 10\"\nCurrentDb.Execute \"UPDATE Userdata SET Recall_position = 10 WHERE Lastname = '\" &amp; Me.Combo1.Column(1)  &amp; \"'\"\nEnd Sub\n</code></pre>\n\n<p>Which does clear out the 10 and updates the right row to\n10 as well. However, it is also updating a second row with a random number in the Lastname</p>\n"}], "owner": {"reputation": 118, "user_id": 2002716, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/63eba881cbc82d9e4ba86dc3da5ac0e0?s=128&d=identicon&r=PG", "display_name": "user2002716", "link": "https://stackoverflow.com/users/2002716/user2002716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 29129220, "answer_count": 2, "score": 0, "last_activity_date": 1427304375, "creation_date": 1426700058, "last_edit_date": 1427304375, "question_id": 29128903, "link": "https://stackoverflow.com/questions/29128903/afterupdate-combobox-find-and-replace", "title": "AfterUpdate combobox find and replace", "body": "<p>I'm trying to figure out how to use AfterUpdate on a combo box to have it find a record from table \"Userdata\" where field \"Recall_position\" equals \"1\" and replace it with \"0\". </p>\n\n<p>Then find the record selected in the combobox (that it was updated to) and in \"Userdata\" under \"Recall_position\"  put the number \"1\"</p>\n"}, {"tags": ["sql", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1426795075, "post_id": 29153760, "comment_id": 46528713, "body": "I don&#39;t as how can I use Vlookup to apply filters and then match. Can you give a little idea and then I should be able to do it."}], "tags": [], "owner": {"reputation": 195, "user_id": 4690714, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/498d91afae713f28d7866f8afa9be5d2?s=128&d=identicon&r=PG&f=1", "display_name": "JeffK627", "link": "https://stackoverflow.com/users/4690714/jeffk627"}, "is_accepted": false, "score": 1, "last_activity_date": 1426794858, "creation_date": 1426794858, "answer_id": 29153760, "question_id": 29128414, "link": "https://stackoverflow.com/questions/29128414/cross-worksheet-sql-query-taking-time/29153760#29153760", "title": "Cross worksheet Sql query taking time?", "body": "<p>Why would you use a SQL query within an Excel workbook if you're not querying a database? Wouldn't VLOOKUP be much simpler?</p>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426794858, "creation_date": 1426698639, "last_edit_date": 1531164843, "question_id": 29128414, "link": "https://stackoverflow.com/questions/29128414/cross-worksheet-sql-query-taking-time", "title": "Cross worksheet Sql query taking time?", "body": "<p>I have around 10 thousand records(rows) in one sheet A and around a thousand in sheet B. Both have 5 columns. I need to filter sheet A using column filters and then find everything which is not on sheet B using the ID in both the sheets. Eg: Sheet A has 10 thousand , apply filter and it comes to 1200. Now select the records which are not in Sheet B. I have written a query for it.</p>\n\n<pre><code>  rs.Open \"SELECT * FROM [A$] WHERE ([Class]&lt;&gt;'Other' OR...) AND ([Sub Class]='Good' OR...) AND [ID] NOT IN (SELECT [B$].ID FROM [B$])\"\n</code></pre>\n\n<p>Query runs extremely slow and I don't know if I will even get any answer waiting hours, may be it is wrong too. I checked and found that if I exclude the last AND , the query executes in a second. Any help is appreciated. Thanks.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 4255, "user_id": 967122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d2faafa4de8d69296cc362f56ff944ec?s=128&d=identicon&r=PG", "display_name": "Rymnel", "link": "https://stackoverflow.com/users/967122/rymnel"}, "edited": false, "score": 0, "creation_date": 1426706732, "post_id": 29129435, "comment_id": 46487583, "body": "I am using this as part of a much larger macro which is written in VBA.  So I thank you for including the VBA code."}], "tags": [], "owner": {"reputation": 528, "user_id": 3657197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trSj0.jpg?s=128&g=1", "display_name": "Pupa Rebbe", "link": "https://stackoverflow.com/users/3657197/pupa-rebbe"}, "is_accepted": true, "score": 2, "last_activity_date": 1426701773, "creation_date": 1426701773, "answer_id": 29129435, "question_id": 29128159, "link": "https://stackoverflow.com/questions/29128159/search-for-text-and-add-text-after/29129435#29129435", "title": "Search for text and add text after", "body": "<p>You don't need to use vba to do this find-replace, you can do it with a simple wildcard find-replace.</p>\n\n<p>press CTRL+H, find <code>(-&lt;*&gt;)</code>, Replace with <code>\\1 indicates:</code> (make sure to check \"Use Wildcards\")</p>\n\n<hr>\n\n<p>If you do want to use vba:</p>\n\n<pre><code>Selection.Find.ClearFormatting\nWith Selection.Find\n    .Text = \"(-&lt;*&gt;)\"\n    .Replacement.Text = \"\\1 indicates:\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = True\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n"}], "owner": {"reputation": 4255, "user_id": 967122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d2faafa4de8d69296cc362f56ff944ec?s=128&d=identicon&r=PG", "display_name": "Rymnel", "link": "https://stackoverflow.com/users/967122/rymnel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1913, "favorite_count": 0, "accepted_answer_id": 29129435, "answer_count": 1, "score": 1, "last_activity_date": 1455103121, "creation_date": 1426697908, "last_edit_date": 1455103121, "question_id": 29128159, "link": "https://stackoverflow.com/questions/29128159/search-for-text-and-add-text-after", "title": "Search for text and add text after", "body": "<p>I have a document that contains the following text format that occurs throughout:</p>\n\n<pre><code>5:43-64\n</code></pre>\n\n<p>I want to search and replace so that the text reads like so:</p>\n\n<pre><code>5:43-64 indicates:\n</code></pre>\n\n<p>Fortunately, the <strong><em>-</em></strong> only appears in this type of text. <strong>The numbers change in each instance</strong>. So I don\u00b4t think I have to worry about some complicated search pattern.  I can just search for the <strong>-</strong> character.</p>\n\n<p>I want to then take whatever is after the the <strong>-</strong> and then save it as a variable then insert the text <strong>indicates</strong> afterward.  I need this to loop through the whole document making these changes at any occurrence of the <strong>-</strong>.</p>\n\n<p>Here is the code that I have up to this point that kind of half works:</p>\n\n<pre><code>Sub placeWordAfterDash()\n\nSelection.Find.ClearFormatting\nWith Selection.Find\n   .Text = \"-\"\n   .Forward = True\n   .Wrap = wdFindContinue\n   .Format = False\n   .MatchCase = False\n   .MatchWholeWord = False\n   .MatchWildcards = False\n   .MatchSoundsLike = False\n   .MatchAllWordForms = False\nEnd With\n\nIf Selection.Find.Execute Then\n    Dim selectedString As String\n    Selection.Select\n    selectedString = Selection.Next(Unit:=wdWord, Count:=1).Text\n    Selection.Text = \"-\" &amp; selectedString &amp; \" indicates: \"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This code only makes the change in one instance and also leaves me with:</p>\n\n<pre><code>5:43-64 indicates: 64\n</code></pre>\n\n<p>Which isn\u00b4t quite what I want.   </p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 960, "user_id": 2416794, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/W1wlB.jpg?s=128&g=1", "display_name": "ubaid ashraf", "link": "https://stackoverflow.com/users/2416794/ubaid-ashraf"}, "edited": false, "score": 0, "creation_date": 1426697561, "post_id": 29127872, "comment_id": 46481930, "body": "Do you mean you want to get all the countries which are in both tables"}, {"owner": {"reputation": 6624, "user_id": 1750324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eea6f502a6e4334864b2d0f47181db2?s=128&d=identicon&r=PG", "display_name": "Steve Ford", "link": "https://stackoverflow.com/users/1750324/steve-ford"}, "reply_to_user": {"reputation": 960, "user_id": 2416794, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/W1wlB.jpg?s=128&g=1", "display_name": "ubaid ashraf", "link": "https://stackoverflow.com/users/2416794/ubaid-ashraf"}, "edited": false, "score": 0, "creation_date": 1426758159, "post_id": 29127872, "comment_id": 46505900, "body": "@ubaidashrafmasoody no use the INNER JOIN to get the countries in both and NOT EXISTS to get the country in one table but not the other!"}, {"owner": {"reputation": 5518, "user_id": 1181535, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/add5c7489cf17cde1f02f89579bcfa76?s=128&d=identicon&r=PG", "display_name": "vapcguy", "link": "https://stackoverflow.com/users/1181535/vapcguy"}, "edited": false, "score": 0, "creation_date": 1470231985, "post_id": 29127872, "comment_id": 64864636, "body": "I&#39;d vote up the question, as it is a common issue developers face, but Steve&#39;s right, it needs to have things that have been tried and failed.  I actually tried <code>NOT IN</code> in Oracle before Googling this and that failed dismally (<code>SQL command not properly ended</code>).  <code>NOT EXISTS</code> I think is a SQL version of that and doesn&#39;t compile in Oracle.  I believe <code>INNER JOIN</code> is the opposite of what the OP wanted (and opposite of what I needed, too), but a good conversation starter in order to define what the output should actually be.  <code>MINUS</code> is what I needed."}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426699265, "post_id": 29128062, "comment_id": 46483032, "body": "Thanx JN, gives me syntax error  &quot;Country in Table 1, but not Table 2&quot; as result, missing operator"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426699325, "post_id": 29128062, "comment_id": 46483072, "body": "I think I forgot some commas in there. Just fixed."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426699744, "post_id": 29128062, "comment_id": 46483333, "body": "Change the UNION ALL&#39;s to UNION and it will GROUP BY both columns returned."}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426699769, "post_id": 29128062, "comment_id": 46483349, "body": "Works great, just added at the end"}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426700264, "post_id": 29128062, "comment_id": 46483661, "body": "when i run them 1 by one working fine when i run them all togeather with UNION i get Syntax Error JOIN."}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426703607, "post_id": 29128062, "comment_id": 46485775, "body": "JN please the last one, how can i add an Where another field in both tables is DEC13 &gt;0?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426705282, "post_id": 29128062, "comment_id": 46486788, "body": "Think of each bit seperated by the <code>UNION ALL</code> as a stand alone statement. In the last one you can add <code>WHERE [tb1].[DEC13] &gt; 0 and [tb2].[DEC13] &gt; 0</code> and it should filter the way you want."}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426711581, "post_id": 29128062, "comment_id": 46490525, "body": "anything im doing wrong here?                                                                            SELECT Tb1.Country,  FROM Tb1 LEFT JOIN Tb1.Dc14 ON            Tb1.Dc13 = Tb.Dc14 WHERE Tb1.Dc14 IS NULL AND WHERE  (((Tb1.Dc13)&gt;0) AND ((Tb1.Dc14)&gt;0)) GROUP BY Tb1.Country;"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426714469, "post_id": 29128062, "comment_id": 46492005, "body": "Yep. You can only have a single WHERE clause in a SELECT statement: <code>SELECT Tb1.Country, FROM Tb1 LEFT JOIN Tb1.Dc14 ON Tb1.Dc13 = Tb.Dc14 WHERE Tb1.Dc14 IS NULL AND Tb1.Dc13&gt;0 AND Tb1.Dc14&gt;0 GROUP BY Tb1.Country;</code>  Which still won&#39;t return anything because TB1.DC14 can&#39;t be both NULL and greater than 0. You&#39;ll have to figure out what you really want there though."}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426779351, "post_id": 29128062, "comment_id": 46519861, "body": "Just trying to get the Countries that where removed or added based on values (&gt;0) on De13 and De14."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426779494, "post_id": 29128062, "comment_id": 46519974, "body": "Then you probably don&#39;t need the <code>Tb1.Dc14 IS NULL</code> bit in there. Remove that and you should be golden."}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426877273, "post_id": 29128062, "comment_id": 46565351, "body": "SELECT Tb.Country, FROM Tb LEFT JOIN Tb.Dc14 ON Tb.Dc13 = Tb.Dc14  WHERE (((Tb.Dc13)&gt;0) AND ((Tb.Dc14)&gt;0))  GROUP BY Tb.Country;   Syntax Error"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426877492, "post_id": 29128062, "comment_id": 46565476, "body": "<code>SELECT Tb.Country FROM Tb LEFT JOIN Tb.Dc14 ON Tb.Dc13 = Tb.Dc14 WHERE Tb.Dc13&gt;0 AND Tb.Dc14&gt;0 GROUP BY Tb.Country;</code>  You had an extra comma hanging out after <code>Tb.Country</code>"}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426877645, "post_id": 29128062, "comment_id": 46565549, "body": "sorry, im getting on your nerves, now I get JOIN expression not supported"}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1427197094, "post_id": 29128062, "comment_id": 46669419, "body": "JN with some help based on your logic, just a bit twist                                                                                                 SELECT &quot;Dc13 Only&quot; AS Status, Country  FROM Tb1 AS T1  WHERE Dc13 IS NOT NULL  AND NOT EXISTS      (SELECT *       FROM Tb1 As T2       WHERE T2.Country = T1.Country        AND Dc14 IS NOT NULL)"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1426699311, "last_edit_date": 1426699311, "creation_date": 1426697651, "answer_id": 29128062, "question_id": 29127872, "link": "https://stackoverflow.com/questions/29127872/what-is-the-simplest-query-in-sql-to-get-the-differences-between-2-tables/29128062#29128062", "title": "What is the simplest query in SQL to get the differences between 2 tables?", "body": "<p>You could use a UNION query to do this in Access:</p>\n\n<pre><code>SELECT\n    TB1.Country,\n    \"Country in Table 1, but not Table 2\" as result\nFROM\n    tb1 \n    LEFT JOIN tb2 ON\n        tb1.country = tb2.country\nWHERE tb2.country IS NULL\n\nUNION ALL\n\nSELECT\n    TB2.Country,\n    \"Country in Table 2, but not Table 1\"\nFROM\n    tb2 \n    LEFT JOIN tb1 ON\n        tb2.country = tb1.country\nWHERE tb1.country IS NULL\n\nUNION ALL\n\nSELECT\n    TB2.Country,\n    \"Country is in both tables\"\nFROM\n    tb2 \n    INNER JOIN tb1 ON\n        tb2.country = tb1.country\n</code></pre>\n\n<p>That's three queries that are stuck together with a union. The first finds countries in table 1 that aren't in Table 2. The second finds countries in table 2 that aren't in table 1, and the final query only returns countries that are in both.</p>\n"}, {"comments": [{"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426698402, "post_id": 29128153, "comment_id": 46482465, "body": "Thank you, 33% answer :), now the other 2/3, to Get whats missing from Tb1, and whats missing from Tb2. Desired Result should be Cameroon Tb1 and Angola, Rwanda Sri Lanka Tb2"}, {"owner": {"reputation": 960, "user_id": 2416794, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/W1wlB.jpg?s=128&g=1", "display_name": "ubaid ashraf", "link": "https://stackoverflow.com/users/2416794/ubaid-ashraf"}, "reply_to_user": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426699732, "post_id": 29128153, "comment_id": 46483324, "body": "Check now @user3601458"}, {"owner": {"reputation": 960, "user_id": 2416794, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/W1wlB.jpg?s=128&g=1", "display_name": "ubaid ashraf", "link": "https://stackoverflow.com/users/2416794/ubaid-ashraf"}, "reply_to_user": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426699816, "post_id": 29128153, "comment_id": 46483384, "body": "Union All will give you duplicates also, so use UNION only @user3601458"}, {"owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "edited": false, "score": 0, "creation_date": 1426703188, "post_id": 29128153, "comment_id": 46485508, "body": "Thank you Ubaid. JN was faster :)"}, {"owner": {"reputation": 5518, "user_id": 1181535, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/add5c7489cf17cde1f02f89579bcfa76?s=128&d=identicon&r=PG", "display_name": "vapcguy", "link": "https://stackoverflow.com/users/1181535/vapcguy"}, "edited": false, "score": 0, "creation_date": 1470232416, "post_id": 29128153, "comment_id": 64864977, "body": "When combining result tables, just give the queries above parenthesis and aliases, then do a <code>UNION</code> of the aliased tables.  The combining of results sets is easy."}], "tags": [], "owner": {"reputation": 960, "user_id": 2416794, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/W1wlB.jpg?s=128&g=1", "display_name": "ubaid ashraf", "link": "https://stackoverflow.com/users/2416794/ubaid-ashraf"}, "is_accepted": false, "score": 0, "last_activity_date": 1426699683, "last_edit_date": 1426699683, "creation_date": 1426697899, "answer_id": 29128153, "question_id": 29127872, "link": "https://stackoverflow.com/questions/29127872/what-is-the-simplest-query-in-sql-to-get-the-differences-between-2-tables/29128153#29128153", "title": "What is the simplest query in SQL to get the differences between 2 tables?", "body": "<p>Simple Union will do in your case: </p>\n\n<p>Step1 ) This will give you countries in both the tables, duplicates won't be shown.</p>\n\n<pre><code>SELECT Country FROM Tb1\nUNION\nSELECT Country FROM Tb2\n</code></pre>\n\n<p>Step2) This will give you countries in first table but not in second:</p>\n\n<pre><code>Select  Country from Tb1\nWhere Country Not IN( \nSelect Country from Tb2)\n</code></pre>\n\n<p>Step 3) This will give you countries in 2nd table but not in first</p>\n\n<pre><code>Select  Country from Tb2\nWhere Country Not IN( \nSelect Country from Tb1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5518, "user_id": 1181535, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/add5c7489cf17cde1f02f89579bcfa76?s=128&d=identicon&r=PG", "display_name": "vapcguy", "link": "https://stackoverflow.com/users/1181535/vapcguy"}, "edited": false, "score": 0, "creation_date": 1470231862, "post_id": 29128763, "comment_id": 64864544, "body": "One note on the 2nd one (<code>MINUS</code> or <code>EXCEPT</code> table):  I found if you do this in the wrong order than you intend, it matters immensely.  You need to do the query that gives you the most results <i>first</i>, then do the query that gives you the fewer results set that you want to remove from the first table.  Doing it the other way around will give you an odd result."}, {"owner": {"reputation": 54566, "user_id": 2527905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY8e6.jpg?s=128&g=1", "display_name": "dnoeth", "link": "https://stackoverflow.com/users/2527905/dnoeth"}, "reply_to_user": {"reputation": 5518, "user_id": 1181535, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/add5c7489cf17cde1f02f89579bcfa76?s=128&d=identicon&r=PG", "display_name": "vapcguy", "link": "https://stackoverflow.com/users/1181535/vapcguy"}, "edited": false, "score": 0, "creation_date": 1470233317, "post_id": 29128763, "comment_id": 64865691, "body": "@vapcguy: Of course, that&#39;s why I wrote <i>Get the countries only in the first table</i> and <i>Change the order of the selects to get the countries in t2 not found in t1</i>"}, {"owner": {"reputation": 5518, "user_id": 1181535, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/add5c7489cf17cde1f02f89579bcfa76?s=128&d=identicon&r=PG", "display_name": "vapcguy", "link": "https://stackoverflow.com/users/1181535/vapcguy"}, "edited": false, "score": 0, "creation_date": 1470326647, "post_id": 29128763, "comment_id": 64916024, "body": "@ dnoeth I can read and saw what you put, but that&#39;s exactly what wasn&#39;t clear to me and why I made my comment.  Saying to order the query by doing a &#39;get on one set that isn&#39;t in the other&#39; isn&#39;t very specific, at all - it doesn&#39;t say what goes first or second, and your statement seemed to contradict the code above it.  Should&#39;ve said to do the largest grouping <i>first</i>, minus the smaller set that chips away at the larger set."}, {"owner": {"reputation": 54566, "user_id": 2527905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY8e6.jpg?s=128&g=1", "display_name": "dnoeth", "link": "https://stackoverflow.com/users/2527905/dnoeth"}, "reply_to_user": {"reputation": 5518, "user_id": 1181535, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/add5c7489cf17cde1f02f89579bcfa76?s=128&d=identicon&r=PG", "display_name": "vapcguy", "link": "https://stackoverflow.com/users/1181535/vapcguy"}, "edited": false, "score": 0, "creation_date": 1470327316, "post_id": 29128763, "comment_id": 64916472, "body": "@vapcguy: The first Select doesn&#39;t have to be on the larger set, it&#39;s on the one you want to remove the rows found in the 2nd. So the Except returns the rows only found in the 1st Select"}, {"owner": {"reputation": 5518, "user_id": 1181535, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/add5c7489cf17cde1f02f89579bcfa76?s=128&d=identicon&r=PG", "display_name": "vapcguy", "link": "https://stackoverflow.com/users/1181535/vapcguy"}, "edited": false, "score": 0, "creation_date": 1470331293, "post_id": 29128763, "comment_id": 64918883, "body": "@ dnoeth You&#39;re saying the same thing as what I did. If you have a grouping to remove rows from, that is the same thing as the larger set, and will always be a larger number, just like it will always be a smaller set of exclusions to take away from that group, and why those are 2nd and always need to be 2nd. Just like if you have 2 records in table #1, and want to exclude 1 record using a Select from table #2. 2 records - 1 record = 1. You should not try 1 record - 2 records and get -1 -- so order matters immensely."}], "tags": [], "owner": {"reputation": 54566, "user_id": 2527905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY8e6.jpg?s=128&g=1", "display_name": "dnoeth", "link": "https://stackoverflow.com/users/2527905/dnoeth"}, "is_accepted": false, "score": 2, "last_activity_date": 1426699618, "creation_date": 1426699618, "answer_id": 29128763, "question_id": 29127872, "link": "https://stackoverflow.com/questions/29127872/what-is-the-simplest-query-in-sql-to-get-the-differences-between-2-tables/29128763#29128763", "title": "What is the simplest query in SQL to get the differences between 2 tables?", "body": "<p>There's multiple set operations in Standard SQL, not only UNION, but also EXCEPT and INTERSECT.</p>\n\n<p>Get the countries common in both tables:</p>\n\n<pre><code>select country from t1\nintersect\nselect country from t2\n</code></pre>\n\n<p>Get the countries only in the first table:</p>\n\n<pre><code>select country from t1\nexcept -- Oracle calls this MINUS\nselect country from t2\n</code></pre>\n\n<p>Change the order of the selects to get the countries in t2 not found in t1.</p>\n"}], "owner": {"reputation": 46, "user_id": 3601458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffbf7fa1186617e7a1e0a25ed0ed1e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene L", "link": "https://stackoverflow.com/users/3601458/eugene-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 29128062, "answer_count": 3, "score": 0, "last_activity_date": 1594645203, "creation_date": 1426697205, "last_edit_date": 1594645203, "question_id": 29127872, "link": "https://stackoverflow.com/questions/29127872/what-is-the-simplest-query-in-sql-to-get-the-differences-between-2-tables", "title": "What is the simplest query in SQL to get the differences between 2 tables?", "body": "<p>Have 2 tables with a column <code>Country</code> and I'm trying to get the results one for the same countries in both, one for countries in the first table but not in the second, and one for countries in second table but not in the first.</p>\n\n<p><code>Tb1.Country</code>:</p>\n\n<pre><code>Botswana\nBurkina Faso\nCameroon\nEthiopia\nGhana\nGhana\nGhana\nGhana\nGhana\nMorocco\nNigeria\nNigeria\nNigeria\nSierra Leone\nSouth Africa\nSouth Africa\nSouth Africa\nSouth Africa\nSouth Africa\nSouth Africa\nTanzania\nZambia\nIndia\nIndia\nIndia\nIndia\nIndonesia\nPakistan\nPakistan\nPakistan\nPhilippines\nThailand\nThailand\n</code></pre>\n\n<p><code>TB2.Country</code>:</p>\n\n<pre><code>Angola\nBotswana\nBurkina Faso\nEthiopia\nGhana\nGhana\nGhana\nMorocco\nNigeria\nNigeria\nNigeria\nRwanda\nSierra Leone\nSouth Africa\nSouth Africa\nTanzania\nZambia\nIndia\nIndia\nIndonesia\nPakistan\nPakistan\nPhilippines\nSri Lanka\nThailand\nThailand\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2146, "user_id": 1539189, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1d143d8e21c38971dbf030c374af9b15?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J.", "link": "https://stackoverflow.com/users/1539189/robert-j"}, "edited": false, "score": 0, "creation_date": 1426698601, "post_id": 29128191, "comment_id": 46482569, "body": "so simple, didn&#39;t think of that! Even though it does not fix the whole problem, but it could be some sort of excel bug. thanks!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2146, "user_id": 1539189, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1d143d8e21c38971dbf030c374af9b15?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J.", "link": "https://stackoverflow.com/users/1539189/robert-j"}, "edited": false, "score": 1, "creation_date": 1426698861, "post_id": 29128191, "comment_id": 46482746, "body": "@RobertJ.  <b>Not an Excel bug.</b>  It&#39;s just that Excel is VERY fussy about floating point values........the alternative would be to apply some kind of <b>rounding</b> to avoid values that are very close to 100%, but not exactly 100%."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1426697967, "creation_date": 1426697967, "answer_id": 29128191, "question_id": 29127846, "link": "https://stackoverflow.com/questions/29127846/excel-vba-value-storage-conversion-issue/29128191#29128191", "title": "Excel VBA value storage/conversion issue", "body": "<p>If the cell actually <strong>displays</strong> \"100%\" then:</p>\n\n<pre><code>Sub OneHundredPercent()\n    If ActiveCell.Text = \"100%\" Then\n        MsgBox \"100%\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>will avoid any roundoff or conversion problems:</p>\n\n<p><img src=\"https://i.stack.imgur.com/HUzff.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 2146, "user_id": 1539189, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1d143d8e21c38971dbf030c374af9b15?s=128&d=identicon&r=PG&f=1", "display_name": "Robert J.", "link": "https://stackoverflow.com/users/1539189/robert-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 29128191, "answer_count": 1, "score": 0, "last_activity_date": 1426697967, "creation_date": 1426697124, "question_id": 29127846, "link": "https://stackoverflow.com/questions/29127846/excel-vba-value-storage-conversion-issue", "title": "Excel VBA value storage/conversion issue", "body": "<p>I have a simple table:<img src=\"https://i.stack.imgur.com/x3nmO.jpg\" alt=\"enter image description here\"></p>\n\n<p>The total % are using the following formula:</p>\n\n<blockquote>\n  <p>=SUMIF($Z$23:$AL$23;\"%\";Z24:AL24)</p>\n</blockquote>\n\n<p>Where I am basically summing a value, if it's column header is '%'. Then I have a VBA procedure which simply loops through these % Totals and checks whether they are equal to 1 or not such as following:</p>\n\n<pre><code>If Cells(iRowLoop, 39).Value &lt;&gt; 1 Then ' show user an error message and stop procedure\n</code></pre>\n\n<p>The problem is, that the very first 100% cell (with value of 18 245) claims, that it's value is not equal to 1.\nI tried the following things:</p>\n\n<ul>\n<li>Multiply the value by 10 000 000, but there is nothing else in there, just simple '1'</li>\n<li>Store value as double to see, if by any chance the value is not like '100.00000001' but it returned the value of '1' again.</li>\n</ul>\n\n<p>I have also checked whether the green percentages contain whole numbers (they are manual user input) and they do, so there is no way how the result could be anything else but plain 100%...but excel still tells me (the VBA procedure) that the first number is not 100%.</p>\n\n<p>How to solve this problem? Any help would be appreciated.</p>\n"}, {"tags": ["string", "vba", "excel", "logic"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1426701669, "post_id": 29127618, "comment_id": 46484520, "body": "If you believe my solution or other ones are helpful feel free to upvote and/or mark as <i>the answer</i>. &lt;rant&gt; Answerers are people just like you but when they&#39;ll need answers they usually have to place bounties. &lt;/rant&gt;"}, {"owner": {"reputation": 47, "user_id": 3394026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c24f2acf9f53d2fc0df6d805ee63b9d?s=128&d=identicon&r=PG&f=1", "display_name": "NotGac", "link": "https://stackoverflow.com/users/3394026/notgac"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1426702647, "post_id": 29127618, "comment_id": 46485157, "body": "I would love to upvote or place bounties, but I lack the reputation to do so. :("}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 3394026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c24f2acf9f53d2fc0df6d805ee63b9d?s=128&d=identicon&r=PG&f=1", "display_name": "NotGac", "link": "https://stackoverflow.com/users/3394026/notgac"}, "edited": false, "score": 0, "creation_date": 1426702673, "post_id": 29129209, "comment_id": 46485175, "body": "Oh, that&#39;s very clever! I like it a lot!"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 2, "last_activity_date": 1426701541, "last_edit_date": 1426701541, "creation_date": 1426700990, "answer_id": 29129209, "question_id": 29127618, "link": "https://stackoverflow.com/questions/29127618/vba-convert-string-to-logic-sequence/29129209#29129209", "title": "VBA Convert String to Logic Sequence", "body": "<pre><code>Sub ert()\nLastRow = Worksheets(\"data\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row 'finds the last row with data on the \"data\" sheet\nFor i = 1 To LastRow 'for each row\n    evalstr = \"=\" &amp; Cells(i, 2).Value 'creates a function from the statement in column \"B\" \n    evalstr = Replace(evalstr, \"AND\", \"*\") 'replaces the \"AND\" operator with a logical multiplication \n    evalstr = Replace(evalstr, \"OR\", \"+\") 'replaces the \"OR\" operator with a logical addition\n    For j = 1 To 7 'for each condition\n         evalstr = Replace(evalstr, CStr(j), Cells(i, 2 + j).Value = ActiveWorkbook.Names(\"Criterion_\" &amp; j).RefersToRange.Value) 'replace the reference with the applicable evaluation\n    Next\n    Worksheets(\"data\").Cells(i, 10) = evalstr 'inserts the formula to your \"J\" column\nNext\nEnd Sub\n</code></pre>\n\n<p>Works fine on my <a href=\"https://drive.google.com/file/d/0B-773Ttgo1z6UThSaFlrVndRWlk/view?usp=sharing\" rel=\"nofollow\">test worksheet</a>.</p>\n"}], "owner": {"reputation": 47, "user_id": 3394026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c24f2acf9f53d2fc0df6d805ee63b9d?s=128&d=identicon&r=PG&f=1", "display_name": "NotGac", "link": "https://stackoverflow.com/users/3394026/notgac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 29129209, "answer_count": 1, "score": 0, "last_activity_date": 1426701541, "creation_date": 1426696451, "question_id": 29127618, "link": "https://stackoverflow.com/questions/29127618/vba-convert-string-to-logic-sequence", "title": "VBA Convert String to Logic Sequence", "body": "<p>I am working with a database export with the following type of information:</p>\n\n<pre><code>TestID  | Logic                      | Criterion_1 | Criterion_2 | ... | Criterion N\n---------------------------------------------------------------------------------------\n101     | 1 AND 2                    | Apple       | California  | ... | Space Quest 6\n102     | (1 OR 2) AND (3 OR 5 OR 6) | Banana      | New Jersey  | ... | Scorched Earth\n</code></pre>\n\n<p>My program would then compare this to some data and see if criteria match the data in some pattern that satisfies the logic. In my ideal world, I could take the Logic string and replace the numbers with tests:</p>\n\n<pre><code>(DataElement_1 = Criterion_1) AND (DataElement_2 = Criterion_2)\n</code></pre>\n\n<p>for Test 101. Of course, simply replacing pieces like that does not logic make. Is there some way in VBA to evaluate that as though it were in-code logic? Is there, perhaps, a better way of doing this that I have completely overlooked?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 2, "creation_date": 1426695374, "post_id": 29127043, "comment_id": 46480402, "body": "Could you show where you populate both <code>mydico</code> and <code>categoriesDico</code>"}, {"owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "edited": false, "score": 0, "creation_date": 1426696262, "post_id": 29127043, "comment_id": 46481030, "body": "You might have a look over here: <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow noreferrer\">snb-vba.eu/VBA_Dictionary_en.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 5291603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0caf850f15f9811de944163db88500?s=128&d=identicon&r=PG&f=1", "display_name": "kiden", "link": "https://stackoverflow.com/users/5291603/kiden"}, "is_accepted": false, "score": 4, "last_activity_date": 1472226148, "creation_date": 1472226148, "answer_id": 39170019, "question_id": 29127043, "link": "https://stackoverflow.com/questions/29127043/dictionary-not-returning-the-value-thanks-to-a-key-in-vba/39170019#39170019", "title": "Dictionary not returning the value thanks to a key in vba", "body": "<p>I know this is old, but in case anyone finds their way here like I did...\nI had this problem (i.e. a var as key vs a manually entered string as key, in order to retrieve a value by key from a dictionary - one worked, the other didn't - other way round in my case)\nI fixed it by using the CStr function, i.e. making sure that the key type as stored and the type I was using to retrieve a value by key from the dictionary were the same, i.e.</p>\n\n<pre><code>dict(\"key1\") = \"value1\"\ndict(\"key2\") = \"value2\"\n</code></pre>\n\n<p>etc</p>\n\n<p>and the key is of type string</p>\n\n<p>if I look up \"key1\" like this:</p>\n\n<pre><code>result = dict(\"key1\")\nresult shows as \"value1\"\n</code></pre>\n\n<p>now let's say I have</p>\n\n<pre><code>var=\"key1\"\n</code></pre>\n\n<p>of type string/variant and I want to look it up in the dict and retrieve the corresponding value. if I do this:</p>\n\n<pre><code>result = dict(var)\nresult shows as blank\n</code></pre>\n\n<p>I have to do this</p>\n\n<pre><code>result = dict(CStr(var))\n</code></pre>\n\n<p>then I get the result back as \"value1\" as expected</p>\n"}], "owner": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1417, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472226148, "creation_date": 1426694928, "last_edit_date": 1430481241, "question_id": 29127043, "link": "https://stackoverflow.com/questions/29127043/dictionary-not-returning-the-value-thanks-to-a-key-in-vba", "title": "Dictionary not returning the value thanks to a key in vba", "body": "<p>I am developing a function in vba to create and fill a dictionary.</p>\n\n<p>Keys of the dictionary are the following : </p>\n\n<pre><code>CATEGORY 1\nCATEGORY 2\n</code></pre>\n\n<p>When I try to retrieve the value with the following code, it's not working :</p>\n\n<pre><code>Dim test As String\ntest=mydico(\"CATEGORY 1\")\n</code></pre>\n\n<p>The variable test is empty.</p>\n\n<p>But what I don't understand and that's very strange is that with the following code :</p>\n\n<pre><code>For Each Key In mydico.Keys()\n    Dim test As String\n    test = categoriesDico(key)\nNext\n</code></pre>\n\n<p>When the key is equal to \"CATEGORY 1\", test is filled with the appropriate value, I don't understand why as putting \"CATEGORY 1\" or putting a key (with the value \"CATEGORY 1\") is the same.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "is_accepted": true, "score": 3, "last_activity_date": 1426712803, "last_edit_date": 1426712803, "creation_date": 1426699657, "answer_id": 29128771, "question_id": 29126435, "link": "https://stackoverflow.com/questions/29126435/how-to-run-a-macro-in-word-after-paste/29128771#29128771", "title": "How to run a macro in Word after paste?", "body": "<p>Try this code.</p>\n\n<pre><code>Sub EditPaste()\n    Selection.Paste\n    Selection.WholeStory\n    Selection.Font.Size = 24\nEnd Sub\n</code></pre>\n\n<p><code>EditPaste</code> is an in-built command. You can find it here.</p>\n\n<p><img src=\"https://i.stack.imgur.com/SPlYD.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/SaZYU.png\" alt=\"enter image description here\"></p>\n\n<p>What I did is to overwrite the existing command and added my code into it.</p>\n"}], "owner": {"reputation": 319, "user_id": 2207330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/19acdae0a8973f94bc3f405f98c885ff?s=128&d=identicon&r=PG", "display_name": "Solsiden", "link": "https://stackoverflow.com/users/2207330/solsiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 29128771, "answer_count": 1, "score": 1, "last_activity_date": 1426712803, "creation_date": 1426693399, "last_edit_date": 1426707812, "question_id": 29126435, "link": "https://stackoverflow.com/questions/29126435/how-to-run-a-macro-in-word-after-paste", "title": "How to run a macro in Word after paste?", "body": "<p>How do I make Microsoft Word to run a macro every time every time the user paste text?</p>\n\n<p>I have recorded this macro:</p>\n\n<pre><code>Sub AdjustFontSize()\n'\n' AdjustFontSize Macro\n' Adjusts font size\n'\n    Selection.WholeStory\n    Selection.Font.Size = 24\nEnd Sub\n</code></pre>\n\n<p>This changes the font size of everything in the document, and I want that to happen when the user is pasting text.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1426691642, "post_id": 29125658, "comment_id": 46477581, "body": "I&#39;m not sure what &quot;Is there a way I can alter the path property for contents?&quot; means. Can you clarify your goal? Perhaps add a screen shot of what you&#39;re after."}, {"owner": {"reputation": 93, "user_id": 4317268, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e6fb90539c6f202c7bfdf415009b5572?s=128&d=identicon&r=PG&f=1", "display_name": "Archaimot", "link": "https://stackoverflow.com/users/4317268/archaimot"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1426692869, "post_id": 29125658, "comment_id": 46478537, "body": "I am afraid lack the technical verbage to clarify--nonethless, I will try; is there a way to modify the existing code to retrieve the file contents (given these will be not text files, but other excel files) and paste them to the master sheet? Or can I use the file path names listed and loop through each, tell it to open the specified path,  and copy contents at bottom of master sheet?"}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 0, "creation_date": 1426693032, "post_id": 29125658, "comment_id": 46478655, "body": "What you are asking is indeed possible, but still some unknowns.  You have said the files are excel files, will they only have 1 worksheet per workbook?  Potentially copying the whole sheet from the source workbook to your new workbook is easier and less lines of code, than truly copying the contents and pasting at the bottom, but both certainly doable"}, {"owner": {"reputation": 621, "user_id": 2533944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e51bd2ba24e85ada3874654d411592?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/2533944/julian"}, "edited": false, "score": 0, "creation_date": 1426693191, "post_id": 29125658, "comment_id": 46478769, "body": "I&#39;m not quite sure if this is what you wan&#39;t, so I&#39;m posting it as a comment. Have a look at Workbook.Open function: <a href=\"http://p2p.wrox.com/excel-vba/10510-opening-excel-file-vba.html\" rel=\"nofollow noreferrer\">p2p.wrox.com/excel-vba/10510-opening-excel-file-vba.html</a> edit: if you tell, what exactly you want (which rows and columns you want to copy), someone can prove a &#39;real&#39; answer to your question."}, {"owner": {"reputation": 93, "user_id": 4317268, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e6fb90539c6f202c7bfdf415009b5572?s=128&d=identicon&r=PG&f=1", "display_name": "Archaimot", "link": "https://stackoverflow.com/users/4317268/archaimot"}, "reply_to_user": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 0, "creation_date": 1426693896, "post_id": 29125658, "comment_id": 46479286, "body": "@MarkMoore The files are excel files--essentially copies of the master file but with different file names (but all relevant files under the same folder--master file is separate). There are multiple worksheets in play, but only one from which I will need data. The desired range within the desired sheet (named the same thing every time--we&#39;ll call it Sheet2) could be found with something along the lines of:  <code>Dim LR as long  LR = Range(&quot;I&quot; &amp; Rows.Count).End(xlUp).Row   Range(&quot;A2:AB&quot; &amp; LR).Select</code> (or something along those lines--I know select is sort of dirty)"}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 0, "creation_date": 1426721154, "post_id": 29125658, "comment_id": 46494539, "body": "short answer, try this post on stackoverflow <a href=\"http://stackoverflow.com/questions/5851531/code-for-looping-through-all-excel-files-in-a-specified-folder-and-pulling-data\" title=\"code for looping through all excel files in a specified folder and pulling data\">stackoverflow.com/questions/5851531/&hellip;</a>"}], "owner": {"reputation": 93, "user_id": 4317268, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e6fb90539c6f202c7bfdf415009b5572?s=128&d=identicon&r=PG&f=1", "display_name": "Archaimot", "link": "https://stackoverflow.com/users/4317268/archaimot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 936, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426691384, "creation_date": 1426691384, "last_edit_date": 1531164843, "question_id": 29125658, "link": "https://stackoverflow.com/questions/29125658/given-path-open-file-copy-contents-vba", "title": "Given path, open file, copy contents VBA", "body": "<p>I need to, given a path, open file, copy the contents to the bottom of a master-sheet. Any and all help would be deeply appreciated. I already have a script which goes through a path to a folder and places the file path in a column.</p>\n\n<pre><code>Sub CCR_Files()\nCall Getfiles(\"C:\\pathpathpath\\\")\nEnd Sub\n\nSub Getfiles(ByVal path As String)\n 'Name it\nDim fso As Object, folder As Object, subfolder As Object, file As Object\n\nSheets(\"Sheet1\").Select\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet folder = fso.GetFolder(path)\nFor Each subfolder In folder.SubFolders\n    Getfiles (subfolder.path)\nNext subfolder\n    For Each file In folder.Files\n        Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0) = file.path\n        Next file\n\n Set fso = Nothing\n Set folder = Nothing\n Set subfolder = Nothing\n Set file = Nothing\n\n End Sub\n</code></pre>\n\n<p>Is there a way I can alter the path property for contents? Fevered searches through the MSDN library haven't yielded much. Alternately, is there a way I can teach it to read the column, piece by piece, and open each file and copy/paste contents to the bottom of a different sheet (same workbook) until special cells blank for the given path column? Thank you so much!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 3662472, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/epeTu.jpg?s=128&g=1", "display_name": "Adam Walker", "link": "https://stackoverflow.com/users/3662472/adam-walker"}, "edited": false, "score": 0, "creation_date": 1426692373, "post_id": 29125853, "comment_id": 46478159, "body": "It is always good to know another way to do things as well. Thanks for your help."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1426691909, "creation_date": 1426691909, "answer_id": 29125853, "question_id": 29125606, "link": "https://stackoverflow.com/questions/29125606/visual-basic-add-an-entry-to-a-list-in-another-worksheet/29125853#29125853", "title": "Visual Basic - Add an entry to a list in another worksheet", "body": "<p>In general, the macro recorder will teach you how to do things. However, it does write very obtuse code and always works with <code>Active*</code> (Cell, Range, WorkSheet, etc) by using <code>.select</code>, which you've figured out, isn't very efficient or pretty.</p>\n\n<p>Try this:</p>\n\n<pre><code>ActiveWorkbook.worksheets(\"Form\").range(\"A1\") = \"This goes on the Form sheet\"\nActiveWorkbook.worksheet(\"Data\").range(\"A1\") = \"This goes on the Data sheet\"\n</code></pre>\n\n<p>Of course, that relies on <code>ActiveWorkbook</code>, but you get the idea. </p>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 3662472, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/epeTu.jpg?s=128&g=1", "display_name": "Adam Walker", "link": "https://stackoverflow.com/users/3662472/adam-walker"}, "edited": false, "score": 0, "creation_date": 1426692349, "post_id": 29125897, "comment_id": 46478142, "body": "This gives me what I was looking for. I also appreciate the feedback. I was really struggling to come up with what i had there. Knowing that &quot;form&quot; is ambiguous will help me in trying to explain questions in the future. Thanks!"}], "tags": [], "owner": {"reputation": 176, "user_id": 3938912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oJF4i.jpg?s=128&g=1", "display_name": "Ygor Yansz", "link": "https://stackoverflow.com/users/3938912/ygor-yansz"}, "is_accepted": false, "score": 1, "last_activity_date": 1426692022, "creation_date": 1426692022, "answer_id": 29125897, "question_id": 29125606, "link": "https://stackoverflow.com/questions/29125606/visual-basic-add-an-entry-to-a-list-in-another-worksheet/29125897#29125897", "title": "Visual Basic - Add an entry to a list in another worksheet", "body": "<p>First of all since you're new to vba you learn to declare in the right way so all people can understand what you are saying, when you say form it get to vague, is it a userform or a formula can you understand?</p>\n\n<p>About the reference to another sheet that is not active just declare like this:</p>\n\n<pre><code>Workbooks(\"example.xlsm\").Worksheets(\"Data\").Range(\"A1\").EntireRow.Insert\n</code></pre>\n\n<p>this declaration will insert a new row on the row 1, with that example you can get how to declare wich workbook, worksheet and range you want to work on</p>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 3662472, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/epeTu.jpg?s=128&g=1", "display_name": "Adam Walker", "link": "https://stackoverflow.com/users/3662472/adam-walker"}, "edited": false, "score": 0, "creation_date": 1426692436, "post_id": 29125965, "comment_id": 46478211, "body": "Placing this information here, while it answered this question, also answered a couple of other questions I had. I appreciate you posting this, even though it appears to be a bit overkill for this question. Thank you for taking your time to write this out."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 2, "last_activity_date": 1426692179, "creation_date": 1426692179, "answer_id": 29125965, "question_id": 29125606, "link": "https://stackoverflow.com/questions/29125606/visual-basic-add-an-entry-to-a-list-in-another-worksheet/29125965#29125965", "title": "Visual Basic - Add an entry to a list in another worksheet", "body": "<pre><code>Option Explicit\nSub add_row()\n    Dim wb As Workbook, ws2 As Worksheet\n    Set wb = ThisWorkbook\n    Set ws2 = wb.Sheets(\"Sheet2\")\n    ws2.Rows(1).Insert shift:=xlDown\nEnd Sub\n</code></pre>\n\n<p>The above will add a new row at the top of sheet 2.\nIf you have more than 1 action to perform on a different sheet, you can also use a with statement.</p>\n\n<pre><code>Option Explicit\nSub add_data()\n    Dim wb As Workbook, ws2 As Worksheet\n    Set wb = ThisWorkbook\n    Set ws2 = wb.Sheets(\"Sheet2\")\n    With ws2\n        .Rows(1).Insert shift:=xlDown\n        .Cells(1, 1).Value2 = \"Rows shifted down by 1!\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>I hope this is of help for you.</p>\n"}, {"tags": [], "owner": {"reputation": 5770, "user_id": 661346, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b49ac5bc9adbcba0e306613d16a9ed8c?s=128&d=identicon&r=PG", "display_name": "StoriKnow", "link": "https://stackoverflow.com/users/661346/storiknow"}, "is_accepted": false, "score": 0, "last_activity_date": 1426694706, "creation_date": 1426694706, "answer_id": 29126969, "question_id": 29125606, "link": "https://stackoverflow.com/questions/29125606/visual-basic-add-an-entry-to-a-list-in-another-worksheet/29126969#29126969", "title": "Visual Basic - Add an entry to a list in another worksheet", "body": "<p><strong>Overkill example</strong>: here's the <code>Form</code> sheet with a sample form. The <code>Submit</code> button has been assigned the macro <code>SubmitForm</code>, which is a procedure created in VBA (code to follow).</p>\n\n<p>Named Ranges can be very useful in VBA when looking to retrieve values from a specific cell or cells. By assigning NamedRanges to each field of the form, we can retrieve their values in VBA simply by using <code>Range(\"NamedRangeName\").Value</code></p>\n\n<ul>\n<li>The <code>First</code> field has been assigned the NamedRange <code>FormFirstName</code></li>\n<li>The <code>Last</code> field has been assigned the NamedRange <code>FormLastName</code></li>\n<li>The <code>Email</code> field has been assigned the NamedRange <code>FormEmail</code></li>\n</ul>\n\n<p><img src=\"https://i.stack.imgur.com/vojfA.png\" alt=\"Form\"></p>\n\n<p>Below is what the <code>Data</code> sheet in my example looks like. We have a header row, then blank rows underneath it. As the <code>Submit</code> button on the <code>Form</code> sheet is clicked, a new record (row) will be created here.</p>\n\n<p><strong>Data Sheet Before Submit Clicked</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/2FooA.png\" alt=\"Data Sheet Before\"></p>\n\n<p><strong>Data Sheet After Submit Clicked</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/7Bo6n.png\" alt=\"Data Sheet After\"></p>\n\n<p>And here's the <code>SubmitForm</code> procedure code that goes along with this sample. It does the following when a user submits the form by clicking the button:</p>\n\n<ul>\n<li>Retrieve values from the <code>Form</code> sheet fields via the assigned <code>NamedRanges</code></li>\n<li>Find the next empty row on the <code>Data</code> sheet</li>\n<li>Insert the retrieved values from the form</li>\n</ul>\n\n<p><code></p>\n\n<pre><code>Public Sub SubmitForm()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = XlCalculation.xlCalculationManual\n\nDim userFirstName As String\nDim userLastName As String\nDim userEmail As String\n\n'   get a reference to the Form worksheet\nDim formWorksheet As Worksheet\nSet formWorksheet = ActiveWorkbook.Worksheets(\"Form\")\n\n'   using the named ranges, retrieve the form field values\nuserFirstName = formWorksheet.Range(\"FormFirstName\").Value\nuserLastName = formWorksheet.Range(\"FormLastName\").Value\nuserEmail = formWorksheet.Range(\"FormEmail\").Value\n\nDim dataWorksheet As Worksheet\nDim headerRow As Integer\nDim nextUserRow As Integer\nDim userIdColumn As Integer\nDim firstNameColumn As Integer\nDim lastNameColumn As Integer\nDim emailColumn As Integer\nDim createdDateColumn As Integer\n\n'   get a reference to the Data worksheet\nSet dataWorksheet = ActiveWorkbook.Worksheets(\"Data\")\nheaderRow = 1\n\n'   get the number of used rows (rows that contain data) on this worksheet,\n'   then add one to it. This will be the next empty row where our new\n'   record will live\nnextUserRow = dataWorksheet.UsedRange.Rows.Count + 1\n\n'   set the columns for each field\nuserIdColumn = 1\nfirstNameColumn = 2\nlastNameColumn = 3\nemailColumn = 4\ncreatedDateColumn = 5\n\n'   persist the data retrieved from the Form sheet to the Data sheet row\ndataWorksheet.Cells(nextUserRow, userIdColumn).Value = (nextUserRow - headerRow)\ndataWorksheet.Cells(nextUserRow, firstNameColumn).Value = userFirstName\ndataWorksheet.Cells(nextUserRow, lastNameColumn).Value = userLastName\ndataWorksheet.Cells(nextUserRow, emailColumn).Value = userEmail\ndataWorksheet.Cells(nextUserRow, createdDateColumn).Value = Now\n\nApplication.Calculation = XlCalculation.xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p></code></p>\n"}], "owner": {"reputation": 56, "user_id": 3662472, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/epeTu.jpg?s=128&g=1", "display_name": "Adam Walker", "link": "https://stackoverflow.com/users/3662472/adam-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4339, "favorite_count": 0, "accepted_answer_id": 29125965, "answer_count": 4, "score": 1, "last_activity_date": 1588759448, "creation_date": 1426691223, "last_edit_date": 1531161705, "question_id": 29125606, "link": "https://stackoverflow.com/questions/29125606/visual-basic-add-an-entry-to-a-list-in-another-worksheet", "title": "Visual Basic - Add an entry to a list in another worksheet", "body": "<p>I have a workbook with 2 sheets. Sheet1 is named Form and Sheet2 is named Data. I am trying to have a form on Sheet1 that creates a new row in Sheet2. I am pretty new to VBA and am really just trying to teach myself through Google. My question is, how can you reference a sheet that isnt active and have it codify the information as intended without visually switching tabs?</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Very Respectfully,</p>\n\n<p>Adam Walker</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1426691098, "post_id": 29125526, "comment_id": 46477155, "body": "Do you want to <i>prevent</i> a line from being deleted?"}, {"owner": {"reputation": 3, "user_id": 4685884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f899b2484644b3c9d647001d86f316c?s=128&d=identicon&r=PG&f=1", "display_name": "Benben", "link": "https://stackoverflow.com/users/4685884/benben"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1426691430, "post_id": 29125526, "comment_id": 46477418, "body": "Yes I want to generate an alert each time someone tries to delete a line which isn&#39;t duplicated on the Excel ."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1426691792, "post_id": 29125526, "comment_id": 46477705, "body": "You can do this on sheet by having an array formula that has at least one of its cells in the row that you don&#39;t want to be deleted."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4685884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f899b2484644b3c9d647001d86f316c?s=128&d=identicon&r=PG&f=1", "display_name": "Benben", "link": "https://stackoverflow.com/users/4685884/benben"}, "edited": false, "score": 0, "creation_date": 1426693310, "post_id": 29125954, "comment_id": 46478877, "body": "Thank you for your answer but I&#39;ve tried this before and it wasn&#39;t successful because there is a problem with the excel-vba  on the sheet."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 3, "user_id": 4685884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f899b2484644b3c9d647001d86f316c?s=128&d=identicon&r=PG&f=1", "display_name": "Benben", "link": "https://stackoverflow.com/users/4685884/benben"}, "edited": false, "score": 0, "creation_date": 1426694532, "post_id": 29125954, "comment_id": 46479784, "body": "My guess is that your VBA is trying to update protected cells. If that&#39;s the case, you can unprotect the sheet with VBA, make your changes, then reprotect it. Don&#39;t know if that helps..."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 0, "last_activity_date": 1426692156, "creation_date": 1426692156, "answer_id": 29125954, "question_id": 29125526, "link": "https://stackoverflow.com/questions/29125526/generate-an-alert-when-deleting-a-line-on-excel/29125954#29125954", "title": "Generate an alert when deleting a line on excel", "body": "<p>Since your goal seems to be preventing row deletion, not just popping up a warning message:</p>\n\n<ol>\n<li>Select the entire row(s) you want protected</li>\n<li>Right click, then select <code>Format Cells</code></li>\n<li>Go to the <code>Protection</code> tab and ensure <code>Locked</code> is checked</li>\n<li>On the Ribbon, select <code>Review</code>, then <code>Protect Sheet</code></li>\n<li>Check the box next to <code>Delete Rows</code></li>\n<li>Provide a password &amp; click OK</li>\n</ol>\n\n<p>If you're actually after a warning message, then this won't do it for you.</p>\n"}], "owner": {"reputation": 3, "user_id": 4685884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f899b2484644b3c9d647001d86f316c?s=128&d=identicon&r=PG&f=1", "display_name": "Benben", "link": "https://stackoverflow.com/users/4685884/benben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 29125954, "answer_count": 1, "score": -1, "last_activity_date": 1426692156, "creation_date": 1426691013, "last_edit_date": 1426691820, "question_id": 29125526, "link": "https://stackoverflow.com/questions/29125526/generate-an-alert-when-deleting-a-line-on-excel", "title": "Generate an alert when deleting a line on excel", "body": "<p>Is it possible to generate an alert when deleting a line on Excel?</p>\n\n<p>Do I have to use some coding langage like VBA to do so or can I do it just with Excel? </p>\n\n<p>Thank you </p>\n"}, {"tags": ["sql", "sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1426690677, "post_id": 29125258, "comment_id": 46476868, "body": "You have Days defined as a string in VBA and an int in your sql. I don&#39;t think you can do this type of dynamic sql through VBA. Why not create a stored procedure with a parameter of @Days? Then you can just execute your procedure."}, {"owner": {"reputation": 537, "user_id": 2807403, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4c84f335bf17c2348e20699ef3f8ba58?s=128&d=identicon&r=PG&f=1", "display_name": "OWSam", "link": "https://stackoverflow.com/users/2807403/owsam"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1426690883, "post_id": 29125258, "comment_id": 46477016, "body": "Makes no difference. I have just changed the Days VBA parameter to RepDays to be sure and it does the same."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1426691050, "post_id": 29125258, "comment_id": 46477122, "body": "Right because you should be doing this in a stored procedure. It isn&#39;t about the name, it is about how you are doing it."}, {"owner": {"reputation": 537, "user_id": 2807403, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4c84f335bf17c2348e20699ef3f8ba58?s=128&d=identicon&r=PG&f=1", "display_name": "OWSam", "link": "https://stackoverflow.com/users/2807403/owsam"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1426692234, "post_id": 29125258, "comment_id": 46478057, "body": "I cannot modify the database to insert stored procedures. I have worked it currently by building up the SQL statement in VBA, with the parameters directly inserted in the code"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1426692543, "post_id": 29125258, "comment_id": 46478290, "body": "I don&#39;t know what the actual sql is but building up sql and executing it without parameters is a recipe for sql injection. You should at the very least parameterize your sql. This would fix the problem."}, {"owner": {"reputation": 537, "user_id": 2807403, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4c84f335bf17c2348e20699ef3f8ba58?s=128&d=identicon&r=PG&f=1", "display_name": "OWSam", "link": "https://stackoverflow.com/users/2807403/owsam"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1426693029, "post_id": 29125258, "comment_id": 46478649, "body": "I have edited my main post to add a quick example of the issue, as it&#39;s too long for comments."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1426693271, "post_id": 29125258, "comment_id": 46478836, "body": "Again...add a parameter to your query. That is the proper way to do this sort of thing. Building up the string like that is NOT the right way to go about it. Just hit up your favorite search engine for &quot;VBA parameterized query&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1426698609, "creation_date": 1426698609, "answer_id": 29128407, "question_id": 29125258, "link": "https://stackoverflow.com/questions/29125258/sql-named-variables-in-vba/29128407#29128407", "title": "SQL Named Variables in VBA", "body": "<p>I think the issue is that when you execute the query via ODBC, you cannot declare the temporary variable <code>@Days</code>, like you can when you paste your clipboard contents into SSMS, though I may be wrong there.</p>\n\n<p>As Sean Lange mentioned, this isn't the ideal way of doing it, but you could build your entire query in VBA, then pass that to the server. Something like this:</p>\n\n<pre><code>Dim Days As String\nDim SQLStat As String\nDim RChar As Integer\n\nDays = Sheets(\"Data\").Range(\"A1\").Value\n\n' Gets current Query, and strips off declaration\nSQLStat = ActiveWorkbook.Connections(\"Query\").ODBCConnection.CommandText\nSQLStat = Right(SQLStat, (Len(SQLStat) - (InStr(1, SQLStat, \"Select\") - 1)))\n\n'Build the new query string using the actual value of Days\nSQLStat = Replace(SQLStat, \"@Days\", Days)\n</code></pre>\n\n<p>This will build the entire query string in VBA, thus skipping the need to have the <code>@Days</code> local variable declared on the server. The <code>Replace()</code> does in VBA what the <code>@Days</code> would do on the server.</p>\n"}], "owner": {"reputation": 537, "user_id": 2807403, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4c84f335bf17c2348e20699ef3f8ba58?s=128&d=identicon&r=PG&f=1", "display_name": "OWSam", "link": "https://stackoverflow.com/users/2807403/owsam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1222, "favorite_count": 1, "accepted_answer_id": 29128407, "answer_count": 1, "score": 0, "last_activity_date": 1426698609, "creation_date": 1426690332, "last_edit_date": 1531164843, "question_id": 29125258, "link": "https://stackoverflow.com/questions/29125258/sql-named-variables-in-vba", "title": "SQL Named Variables in VBA", "body": "<p>I have a query that's run in Excel, with a variable parameter that can be changed in the workbook.</p>\n\n<p>This is referenced several times throughout the SQL statement, and so I have declared a variable (@Days) before the Select, and then referenced this throughout the query.</p>\n\n<p>This works fine in management studio.</p>\n\n<p>If I try to execute this in VBA, I get Application-defined or object defined error.</p>\n\n<p>If I uncomment my clipboard code, and paste the result into management studio, it executes no problem.\nIf I stop the VBA before .Refresh, and manually refresh the query it refreshes fine.</p>\n\n<p>VBA is below:</p>\n\n<pre><code>Sub Refresh()\n\n\nDim Days As String\nDim SQLStat As String\nDim RChar As Integer\n\nDays = Sheets(\"Data\").Range(\"A1\").Value\n\n' Gets current Query, and strips off declaration\nSQLStat = ActiveWorkbook.Connections(\"Query\").ODBCConnection.CommandText\nSQLStat = Right(SQLStat, (Len(SQLStat) - (InStr(1, SQLStat, \"Select\") - 1)))\n\n' Adds Declaration with new days value.\nSQLStat = \"Declare @Days integer set @Days = \" &amp; Days &amp; \" \" &amp; Chr(13) &amp; SQLStat\n\n\n' Puts SQL in clipboard for test purposes\n'Dim clipboard As MSForms.DataObject\n'Set clipboard = New MSForms.DataObject\n'clipboard.SetText SQLStat\n'clipboard.PutInClipboard\n\n\nWith ActiveWorkbook.Connections(\"Query\").ODBCConnection\n    .BackgroundQuery = False\n    .CommandText = SQLStat\n    .Refresh\nEnd With\n\nMsgBox \"Refreshed\"\n\nEnd Sub\n</code></pre>\n\n<p>I have split this out into a test scenario. Test1 Fails. The query doesn't update. Test2 Refreshes as you'd expect.</p>\n\n<pre><code>Sub Test1()\nDim SqlStr As String\nDim Days As String\n\nDays = Sheets(\"test\").Range(\"A1\").Value\nSqlStr = \"declare @Days int set @Days = \" &amp; Days &amp; \" select dateadd(day,@days,getdate())\"\n\nWith ActiveWorkbook.Connections(\"Query\").ODBCConnection\n    .CommandText = SqlStr\n    .Refresh\nEnd With\n\nEnd Sub\n\n\nSub Test2()\nDim SqlStr As String\nDim Days As String\n\nDays = Sheets(\"test\").Range(\"A1\").Value\nSqlStr = \"select dateadd(day,\" &amp; Days &amp; \",getdate())\"\n\nWith ActiveWorkbook.Connections(\"Query\").ODBCConnection\n    .CommandText = SqlStr\n    .Refresh\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426690108, "post_id": 29125104, "comment_id": 46476428, "body": "Yes, it would work the same and be less confusing. :)"}, {"owner": {"reputation": 1052, "user_id": 1492284, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8fb77935284841d725aa5cba5c64cde2?s=128&d=identicon&r=PG", "display_name": "mburke05", "link": "https://stackoverflow.com/users/1492284/mburke05"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426690903, "post_id": 29125104, "comment_id": 46477030, "body": "Thanks Rory! Any thoughts on the Range(&quot;A1&quot;) part then and why it still performs the same function?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426691676, "post_id": 29125104, "comment_id": 46477609, "body": "See the answer from @chancea for how it works. As for the why: it&#39;s put there by the macro recorder if you have the &#39;use relative references&#39; option checked when recording a macro."}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1426691253, "post_id": 29125547, "comment_id": 46477279, "body": "Great answer <b>(+1)</b>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426691554, "post_id": 29125547, "comment_id": 46477507, "body": "Of course, <code>Resize()</code> would achieve the same thing and be clearer, IMO. ;)"}, {"owner": {"reputation": 1052, "user_id": 1492284, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8fb77935284841d725aa5cba5c64cde2?s=128&d=identicon&r=PG", "display_name": "mburke05", "link": "https://stackoverflow.com/users/1492284/mburke05"}, "edited": false, "score": 0, "creation_date": 1426703587, "post_id": 29125547, "comment_id": 46485763, "body": "Great answer! Thanks for taking the time. So I think I understand your explanation regarding the &#39;ActiveCell&#39; as opposed to using a range (&#39;Selection()&#39;): we would move a single cell as opposed to a whole range by one row in the two separate scenarios. What I don&#39;t fully understand is why including the Range(&quot;A1&quot;) in the line of code doesn&#39;t alter the outcome of the line. Or moreover what exactly it&#39;s telling the Offset function to do. Thanks again!"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 1052, "user_id": 1492284, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8fb77935284841d725aa5cba5c64cde2?s=128&d=identicon&r=PG", "display_name": "mburke05", "link": "https://stackoverflow.com/users/1492284/mburke05"}, "edited": false, "score": 0, "creation_date": 1426704675, "post_id": 29125547, "comment_id": 46486389, "body": "@mburke05 I tried to update and clarify.  See my edit"}, {"owner": {"reputation": 1052, "user_id": 1492284, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8fb77935284841d725aa5cba5c64cde2?s=128&d=identicon&r=PG", "display_name": "mburke05", "link": "https://stackoverflow.com/users/1492284/mburke05"}, "edited": false, "score": 0, "creation_date": 1426707598, "post_id": 29125547, "comment_id": 46488098, "body": "@chancea so the <code>Offset(x,x).Range()</code> portion is just a definition for the size of whatever array it is you&#39;re going to be fooling around with, not an actual reference to the spot you&#39;ll be selecting? sorry i think you did a really good job explaining i&#39;m just having trouble understanding exactly what <code>Selection.Offset(1, 0).Select</code> vs <code>Selection.Offset(1, 0).Range(&quot;A1&quot;).Select</code> are defining. In python we see <code>open(&quot;file.txt&quot;, &#39;a&#39;)</code> the <code>a</code> is the addend optional definition of the open() function. In VBA is <code>&lt;&lt;Array&gt;&gt;.Offset().xxx.Select</code>, xxx is where he input the <code>Range()</code> and confused me."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 1052, "user_id": 1492284, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8fb77935284841d725aa5cba5c64cde2?s=128&d=identicon&r=PG", "display_name": "mburke05", "link": "https://stackoverflow.com/users/1492284/mburke05"}, "edited": false, "score": 0, "creation_date": 1426708291, "post_id": 29125547, "comment_id": 46488495, "body": "@mburke05 if you think of a <code>Range</code> like a 2D-Array then basically calling <code>.Range(...)</code> on an existing range is like &#39;narrowing&#39; the 2D-Array.  Think of &quot;A1&quot; as like position <code>(0,0)</code>.  So lets say <code>a =[[1,2],[3,4]]</code> if we say <code>a[0][0]</code> we get <code>1</code>.  In your example though, it is morel like <code>a =[[1]]</code> (a 2D-Array that contains only 1 item) so calling <code>a[0][0]</code> in that case would of course result in just <code>1</code>"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1426708586, "post_id": 29125547, "comment_id": 46488686, "body": "To transfer that into excel lets say you have <code>Range(&quot;A2:B4&quot;)</code> selected.  so that in a 2D-Array format would look like <code>[[A2,B2],[A3,B3],[A4,B4]]</code> So lets say we call <code>Range(&quot;A2:B4&quot;).Range(&quot;A1:B1&quot;)</code> that <i>narrows the original array</i> to the <i>first row</i> and <i>first 2 columns</i> so <code>Range(&quot;A2:B4&quot;).Range(&quot;A1:B1&quot;) = [[A2,B2]]</code>"}, {"owner": {"reputation": 1052, "user_id": 1492284, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8fb77935284841d725aa5cba5c64cde2?s=128&d=identicon&r=PG", "display_name": "mburke05", "link": "https://stackoverflow.com/users/1492284/mburke05"}, "edited": false, "score": 0, "creation_date": 1426766438, "post_id": 29125547, "comment_id": 46510841, "body": "perfect, that&#39;s what i had suspected (that utilizing the range(&quot;A1&quot;) basically relocated our select to the &quot;A1&quot; within our newly defined array (be it Selection() or ActiveCell().) awesome explanation, and thanks so much again."}], "tags": [], "owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "is_accepted": true, "score": 12, "last_activity_date": 1426704659, "last_edit_date": 1592644375, "creation_date": 1426691067, "answer_id": 29125547, "question_id": 29125104, "link": "https://stackoverflow.com/questions/29125104/activecell-offset-confusion/29125547#29125547", "title": "ActiveCell.Offset Confusion", "body": "<h3>Short answer</h3>\n<p>Yes <em>in this particular case</em> both do the same.  Removing <code>Range(&quot;A1&quot;)</code> is fine.</p>\n<h3>Long Answer</h3>\n<p>This is due to the fact you are using <code>ActiveCell</code> in this line:</p>\n<pre><code>ActiveCell.Offset(1, 0).Range(&quot;A1&quot;).Select\n</code></pre>\n<p>The <code>ActiveCell</code> is the first cell <em>within the range</em> you have selected.</p>\n<p>Consider the following macro:</p>\n<pre><code>Sub Macro1()\n    Debug.Print ActiveCell.Address\nEnd Sub\n</code></pre>\n<p>Whatever range you select this will print the address of the <em>white cell</em> within the selection.</p>\n<p>i.e.</p>\n<p><img src=\"https://i.stack.imgur.com/ckA3S.png\" alt=\"enter image description here\" /></p>\n<p>The <code>ActiveCell</code> is <code>$A$4</code></p>\n<h3>Example</h3>\n<p>Calling <code>Offset(1,0)</code> on a <em>single cell</em> will only offset <em>that cell</em>.  So if we look at your original code:</p>\n<pre><code>Sub Macro2()\n    Sheets(&quot;Setup&quot;).Select\n    Range(&quot;Start&quot;).Select\n    ActiveCell.Offset(1, 0).Range(&quot;A1&quot;).Select\nEnd Sub\n</code></pre>\n<p>Let us assume that my previous selection shown (<code>A2:B4</code>) is the named range of &quot;Start&quot; and we can walk through exactly what is happening:</p>\n<ol>\n<li><p>In this example <code>Range(&quot;Start&quot;).Select</code> would select range <code>A2:B4</code>.  Thus making <code>ActiveCell</code> equal to <code>A2</code>.</p>\n</li>\n<li><p>Next we call <code>Offset(1,0)</code> on <code>ActiveCell</code> which is equivalent to <code>Range(&quot;A2&quot;).Offset(1,0)</code> putting us at range <code>A3</code> (1 row below A2)</p>\n</li>\n<li><p>Now we call <code>.Range(&quot;A1&quot;)</code> which is going to grab the <em>first cell</em> within the range.  Since the current range is <strong>only</strong> <code>A3</code>, <code>.Range(&quot;A1&quot;)</code> gives us <code>A3</code>.</p>\n</li>\n<li><p>Then of course <code>.Select()</code> is still only selecting <code>A3</code></p>\n</li>\n</ol>\n<h3>When is <code>.Range(&quot;A1&quot;)</code> actually useful?</h3>\n<p>Consider the following example without any <code>Range(&quot;A1&quot;)</code> call:</p>\n<pre><code>Sub Macro3()\n    Sheets(&quot;Setup&quot;).Select\n    Range(&quot;Start&quot;).Select\n    Selection.Offset(1, 0).Select\nEnd Sub\n</code></pre>\n<p>Since we have changed <code>ActiveCell</code> to <code>Selection</code> the <code>Offset(1,0)</code> will select the same dimension range as &quot;Start&quot; just offset-ed by 1 row.</p>\n<p>i.e.:</p>\n<p>If this is the range of &quot;Start&quot;:</p>\n<p><img src=\"https://i.stack.imgur.com/E52bF.png\" alt=\"enter image description here\" /></p>\n<p>We run the example macro:</p>\n<p><img src=\"https://i.stack.imgur.com/iRhTX.png\" alt=\"enter image description here\" /></p>\n<p>We have a new selection of the same dimension.</p>\n<p>However if we change the example macro to include the <code>Range(&quot;A1&quot;)</code>:</p>\n<pre><code>Sub Macro4()\n    Sheets(&quot;Setup&quot;).Select\n    Range(&quot;Start&quot;).Select\n    Selection.Offset(1, 0).Range(&quot;A1&quot;).Select\nEnd Sub\n</code></pre>\n<p><img src=\"https://i.stack.imgur.com/H9TcQ.png\" alt=\"enter image description here\" /></p>\n<p>Only the <em>first</em> cell in the selection is now selected.</p>\n"}], "owner": {"reputation": 1052, "user_id": 1492284, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8fb77935284841d725aa5cba5c64cde2?s=128&d=identicon&r=PG", "display_name": "mburke05", "link": "https://stackoverflow.com/users/1492284/mburke05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52021, "favorite_count": 0, "accepted_answer_id": 29125547, "answer_count": 1, "score": 2, "last_activity_date": 1582452688, "creation_date": 1426689920, "question_id": 29125104, "link": "https://stackoverflow.com/questions/29125104/activecell-offset-confusion", "title": "ActiveCell.Offset Confusion", "body": "<p>I was reading some VBA in a previous module somebody had written and came across something that confused me:</p>\n\n<pre><code>Sheets(\"Setup\").Select\nRange(\"Start\").Select\nActiveCell.Offset(1, 0).Range(\"A1\").Select\n</code></pre>\n\n<p>I was wondering how the ActiveCell.Offset(column,row).Range().Select line worked. In this case the \"Start\" range is a cell, A18, and the offset offsets it by one row, that much I get. But I'm not following how or what the Range(\"A1\") is being inserted to do here. </p>\n\n<p>Wouldn't</p>\n\n<pre><code>Sheets(\"Setup\").Select\nRange(\"Start\").Select\nActiveCell.Offset(1, 0).Select\n</code></pre>\n\n<p>work just the same and be less confusing? Is there any reason the Range(\"A1\") clause is inserted?</p>\n\n<p>Thanks so much, and sorry for the beginner question. </p>\n"}, {"tags": ["database", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1426689721, "post_id": 29124980, "comment_id": 46476154, "body": "Check out DateDiff <a href=\"http://www.techonthenet.com/access/functions/date/datediff.php\" rel=\"nofollow noreferrer\">techonthenet.com/access/functions/date/datediff.php</a>"}, {"owner": {"reputation": 373, "user_id": 2651904, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9c6d21d9c49fb548c9e2407e7e4c8b65?s=128&d=identicon&r=PG", "display_name": "Alph", "link": "https://stackoverflow.com/users/2651904/alph"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1426690197, "post_id": 29124980, "comment_id": 46476498, "body": "@ Fionnula, I saw interval has to be specified in Datediff.  So the age would be either in years or months  or some others. Is it possible to have years and months (Let&#39;s say 10 years and 5 months)  years and months in separate field?"}, {"owner": {"reputation": 373, "user_id": 2651904, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9c6d21d9c49fb548c9e2407e7e4c8b65?s=128&d=identicon&r=PG", "display_name": "Alph", "link": "https://stackoverflow.com/users/2651904/alph"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1426690799, "post_id": 29124980, "comment_id": 46476951, "body": "@ Fionnula, I apologize, I did not look the examples carefully before.  It is calculating  in years, months, and days .  Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1426694781, "creation_date": 1426694781, "answer_id": 29127001, "question_id": 29124980, "link": "https://stackoverflow.com/questions/29124980/calculating-age-in-years-and-months-in-microsoft-access-2010/29127001#29127001", "title": "calculating age in years and months in Microsoft Access (2010)", "body": "<p>It takes a little more to take care of the finer details (as does a year calculation):</p>\n\n<pre><code>Public Function Months( _\n  ByVal datDate1 As Date, _\n  ByVal datDate2 As Date, _\n  Optional ByVal booLinear As Boolean) _\n  As Integer\n\n' Returns the difference in full months between datDate1 and datDate2.\n'\n' Calculates correctly for:\n'   negative differences\n'   leap years\n'   dates of 29. February\n'   date/time values with embedded time values\n'   negative date/time values (prior to 1899-12-29)\n'\n' Optionally returns negative counts rounded down to provide a\n' linear sequence of month counts.\n' For a given datDate1, if datDate2 is decreased stepwise one month from\n' returning a positive count to returning a negative count, one or two\n' occurrences of count zero will be returned.\n' If booLinear is False, the sequence will be:\n'   3, 2, 1, 0,  0, -1, -2\n' If booLinear is True, the sequence will be:\n'   3, 2, 1, 0, -1, -2, -3\n'\n' If booLinear is False, reversing datDate1 and datDate2 will return\n' results of same absolute Value, only the sign will change.\n' This behaviour mimics that of Fix().\n' If booLinear is True, reversing datDate1 and datDate2 will return\n' results where the negative count is offset by -1.\n' This behaviour mimics that of Int().\n\n' DateAdd() is used for check for month end of February as it correctly\n' returns Feb. 28. when adding a count of months to dates of Feb. 29.\n' when the resulting year is a common year.\n'\n' 2010-03-30. Cactus Data ApS, CPH.\n\n  Dim intDiff   As Integer\n  Dim intSign   As Integer\n  Dim intMonths As Integer\n\n  ' Find difference in calendar months.\n  intMonths = DateDiff(\"m\", datDate1, datDate2)\n  ' For positive resp. negative intervals, check if the second date\n  ' falls before, on, or after the crossing date for a 1 month period\n  ' while at the same time correcting for February 29. of leap years.\n  If DateDiff(\"d\", datDate1, datDate2) &gt; 0 Then\n    intSign = Sgn(DateDiff(\"d\", DateAdd(\"m\", intMonths, datDate1), datDate2))\n    intDiff = Abs(intSign &lt; 0)\n  Else\n    intSign = Sgn(DateDiff(\"d\", DateAdd(\"m\", -intMonths, datDate2), datDate1))\n    If intSign &lt;&gt; 0 Then\n      ' Offset negative count of months to continuous sequence if requested.\n      intDiff = Abs(booLinear)\n    End If\n    intDiff = intDiff - Abs(intSign &lt; 0)\n  End If\n\n  ' Return count of months as count of full 1 month periods.\n  Months = intMonths - intDiff\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1426714806, "post_id": 29127913, "comment_id": 46492169, "body": "What you miss is to take leap years into account. That&#39;s the tough part, but DateAdd will handle it."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1426716040, "post_id": 29127913, "comment_id": 46492730, "body": "When I tested the above code with 2012/02/29 it worked as I expected it would. For non-leap years, those with birthdays on 02/29 are still <i>n</i> years old on 02/28, and <i>n+1</i> years old on 03/01. What did I miss?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1426754524, "post_id": 29127913, "comment_id": 46504005, "body": "You miss that the leaplings - those born on Feb. 29th - for example with DOB 2012-02-29 he/she will be 3 years 0 months on the last day of Feb. 2015, the 28th. You can find some references claiming that it will first happen on Mar. 1th. If people feel so, no problem, but most covernments and organisations goes by the rule that the month of your birthday day should match the month of your birthdate."}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 5, "last_activity_date": 1426699495, "last_edit_date": 1426699495, "creation_date": 1426697304, "answer_id": 29127913, "question_id": 29124980, "link": "https://stackoverflow.com/questions/29124980/calculating-age-in-years-and-months-in-microsoft-access-2010/29127913#29127913", "title": "calculating age in years and months in Microsoft Access (2010)", "body": "<p>While the <code>DateDiff()</code> function seems like the logical choice for calculating ages, it unfortunately does not calculate the number of <em>full</em> years or months that have elapsed between two dates. For example, say that a baby was born on December 31, 2014, and was examined exactly 48 hours later, on January 2, 2015. That is,</p>\n\n\n\n<pre class=\"lang-vbs prettyprint-override\"><code>DateOfBirth = DateSerial(2014, 12, 31)\nDateOfExam = DateSerial(2015, 1, 2)\n</code></pre>\n\n<p>If we simply used <code>DateDiff()</code> to calculate her \"age\" in years and months at the time of the exam we would get</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>?DateDiff(\"yyyy\", DateOfBirth, DateOfExam)\n 1 \n?DateDiff(\"m\", DateOfBirth, DateOfExam)\n 1 \n</code></pre>\n\n<p>So, we would report that the baby is 1 year and 1 month old, when really she is just 2 <em>days</em> old.</p>\n\n<p>Proper age calculations need to be more sophisticated than that. The following VBA function will calculate the \"age\" in years and months, returning a string like \"2 years and 1 month\":</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Public Function AgeInYearsAndMonths(StartDate As Variant, EndDate As Variant) As Variant\n    Dim Date1 As Date, Date2 As Date\n    Dim mm1 As Integer, dd1 As Integer, mm2 As Integer, dd2 As Integer\n    Dim ageYears As Integer, ageMonths As Integer, rtn As Variant\n    rtn = Null\n    If Not (IsNull(StartDate) Or IsNull(EndDate)) Then\n        If StartDate &lt;= EndDate Then\n            Date1 = StartDate\n            Date2 = EndDate\n        Else\n            Date1 = EndDate\n            Date2 = StartDate\n        End If\n        mm1 = Month(Date1)\n        dd1 = Day(Date1)\n        mm2 = Month(Date2)\n        dd2 = Day(Date2)\n        ageYears = DateDiff(\"yyyy\", Date1, Date2)\n        If (mm1 &gt; mm2) Or (mm1 = mm2 And dd1 &gt; dd2) Then\n            ageYears = ageYears - 1\n        End If\n        ageMonths = DateDiff(\"m\", Date1, Date2) Mod 12\n        If dd1 &gt; dd2 Then\n            If ageMonths = 0 Then\n                ageMonths = 12\n            End If\n            ageMonths = ageMonths - 1\n        End If\n        If ageYears = 0 And ageMonths = 0 Then\n            rtn = \"less than 1 month\"\n        Else\n            rtn = ageYears &amp; \" year\" &amp; IIf(ageYears = 1, \"\", \"s\") &amp; \" and \" &amp; ageMonths &amp; \" month\" &amp; IIf(ageMonths = 1, \"\", \"s\")\n        End If\n    End If\n    AgeInYearsAndMonths = rtn\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 2651904, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9c6d21d9c49fb548c9e2407e7e4c8b65?s=128&d=identicon&r=PG", "display_name": "Alph", "link": "https://stackoverflow.com/users/2651904/alph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8459, "favorite_count": 0, "accepted_answer_id": 29127913, "answer_count": 2, "score": 1, "last_activity_date": 1426700122, "creation_date": 1426689585, "last_edit_date": 1426700122, "question_id": 29124980, "link": "https://stackoverflow.com/questions/29124980/calculating-age-in-years-and-months-in-microsoft-access-2010", "title": "calculating age in years and months in Microsoft Access (2010)", "body": "<p>I have two fields (Date of Physical Exam and Date of Birth).  I calculated the age in years((Date of Physical Exam- Date of Birth)/365.25).  What I want to do is calculate age in years and months in separate field. I am not sure if it can be done using code builder or some way.</p>\n"}, {"tags": ["vba", "visual-studio-2012", "textbox", "conditional-formatting"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3818365, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/02389707590d10826f46b0ba157d66b4?s=128&d=identicon&r=PG&f=1", "display_name": "GoombaJoe", "link": "https://stackoverflow.com/users/3818365/goombajoe"}, "edited": false, "score": 0, "creation_date": 1426772690, "post_id": 29127083, "comment_id": 46514973, "body": "Left is no longer an valid function in vb; had to use substring."}], "tags": [], "owner": {"reputation": 122, "user_id": 4526564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39057a2eec6bf2de4f9b22c791870cb0?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/4526564/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1426695054, "creation_date": 1426695054, "answer_id": 29127083, "question_id": 29124959, "link": "https://stackoverflow.com/questions/29124959/restricting-input-to-a-textbox-in-visual-basic/29127083#29127083", "title": "Restricting input to a textbox in Visual Basic", "body": "<p>You could do a check that would automatically change the first letter if it was not a b or h. Something like this:</p>\n\n<pre><code>If Not Left(TextBox.Text, 1) = \"b\" Or Not Left(TextBox.Text, 1) = \"h\" Then\n    TextBox.Text = Replace(Left(TextBox.Text, 1), \"b\")\nEnd If\n</code></pre>\n\n<p>That will replace the first letter with a 'b' if it isn't a b or h but you could just as easily display an error message if you would prefer.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 3818365, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/02389707590d10826f46b0ba157d66b4?s=128&d=identicon&r=PG&f=1", "display_name": "GoombaJoe", "link": "https://stackoverflow.com/users/3818365/goombajoe"}, "is_accepted": true, "score": 0, "last_activity_date": 1426773305, "creation_date": 1426773305, "answer_id": 29146502, "question_id": 29124959, "link": "https://stackoverflow.com/questions/29124959/restricting-input-to-a-textbox-in-visual-basic/29146502#29146502", "title": "Restricting input to a textbox in Visual Basic", "body": "<p>Per Chris' suggestion, I used this, since the left and replace functions can no longer be used as they are in his answer as of vba 2010.</p>\n\n<pre><code> If Not acro.Substring(1) = \"u\" Or Not acro.Substring(1) = \"c\" Then\n        txtAcro.Text = acro.Replace(acro.Substring(1), \"u\")\n    End If\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3818365, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/02389707590d10826f46b0ba157d66b4?s=128&d=identicon&r=PG&f=1", "display_name": "GoombaJoe", "link": "https://stackoverflow.com/users/3818365/goombajoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "accepted_answer_id": 29146502, "answer_count": 2, "score": 0, "last_activity_date": 1426773305, "creation_date": 1426689513, "question_id": 29124959, "link": "https://stackoverflow.com/questions/29124959/restricting-input-to-a-textbox-in-visual-basic", "title": "Restricting input to a textbox in Visual Basic", "body": "<p>I need to restrict a user to entering specific data into a text box. The requirements I have are:\n1. The first character must be a lower case b or h.\n2. Only accept letters after that.</p>\n\n<hr>\n\n<p>I have code to only accept letters based on ascii equivalents, but do not know how to restrict only the first letter.</p>\n\n<hr>\n\n<p>I would also accept entering that letter based on the selection of radio buttons, if I could restrict the user from editing the value.</p>\n\n<p>I believe these can also be done using regular expressions, but have not had much experience with them.</p>\n\n<pre><code>Private Sub txtSysName_KeyPress(sender As Object, e As KeyPressEventArgs) Handles txtSysName.KeyPress\n    If Asc(e.KeyChar) &lt; 65 Or Asc(e.KeyChar) &gt; 90 And Asc(e.KeyChar) &lt; 97 Or Asc(e.KeyChar) &gt; 122 Then\n        e.Handled = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vsto", "office-interop", "vba"], "answers": [{"comments": [{"owner": {"reputation": 281, "user_id": 2031644, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/00bd5d1d1b77207e0fdf1cc5b1ac85e8?s=128&d=identicon&r=PG", "display_name": "Fawad Ali Siddiqi", "link": "https://stackoverflow.com/users/2031644/fawad-ali-siddiqi"}, "edited": false, "score": 0, "creation_date": 1426785717, "post_id": 29126454, "comment_id": 46523842, "body": "infact i am using it already. but i could not identify which one can i use to enable Lock Drawing Mode functionality. can u please identify for me?  right now i have implemented it using Shapes custom events.  <a href=\"https://code.msdn.microsoft.com/office/CSExcelNewEventForShapes-0e26b1f2/sourcecode?fileId=73122&amp;pathId=816504209\" rel=\"nofollow noreferrer\">code.msdn.microsoft.com/office/&hellip;</a>   after creating a connector i check for a boolean varialble and re-execute the MSO function untill the user presses escape."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1426693447, "creation_date": 1426693447, "answer_id": 29126454, "question_id": 29124714, "link": "https://stackoverflow.com/questions/29124714/lock-drawing-mode-vsto-4-0/29126454#29126454", "title": "Lock Drawing Mode VSTO 4.0", "body": "<p>You can try to execute the built-in button programmatically. The ExecuteMso method of the CommandBars class allows to run the built-in controls programmatically. See <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=36798\" rel=\"nofollow\">Office 2013 Help Files: Office Fluent User Interface Control Identifiers</a>.</p>\n"}], "owner": {"reputation": 281, "user_id": 2031644, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/00bd5d1d1b77207e0fdf1cc5b1ac85e8?s=128&d=identicon&r=PG", "display_name": "Fawad Ali Siddiqi", "link": "https://stackoverflow.com/users/2031644/fawad-ali-siddiqi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426693447, "creation_date": 1426688808, "last_edit_date": 1531161705, "question_id": 29124714, "link": "https://stackoverflow.com/questions/29124714/lock-drawing-mode-vsto-4-0", "title": "Lock Drawing Mode VSTO 4.0", "body": "<p>i am working on an Excel AddIn Development using Visual Studio Tools for Office (VSTO 4.0). \nthere is an option in Excel <a href=\"http://blog.contextures.com/wp-content/uploads/2012/08/LockDrawing.gif\" rel=\"nofollow\">Lock Drawing mode</a> for specific shape which enable a user to draw a shape multiple times.</p>\n\n<p>my requirement is to enable \"Lock Drawing mode\" (for ElbowConnector) using C#/VB.Net using VSTO 4.0. \n i tried to find a solution to this even in VBA but did not get any luck.</p>\n\n<p>Thank you,</p>\n\n<p>Regards,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 0, "creation_date": 1426687538, "post_id": 29124173, "comment_id": 46474543, "body": "You probably need to set the code in the OnChange part. Have a look at <a href=\"http://stackoverflow.com/questions/409434/automatically-execute-an-excel-macro-on-a-cell-change\">this topic</a>"}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 2, "creation_date": 1426687793, "post_id": 29124173, "comment_id": 46474747, "body": "You appear to have asked basically the same question six times in the last day. <b>Please stop</b>."}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 1, "creation_date": 1426688783, "post_id": 29124173, "comment_id": 46475465, "body": "I <i>didn&#39;t answer</i>, I commented. Whether or not I can (or will!) help is irrelevant; you are <b>not going about asking correctly</b>. Please see <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> and for the love of everything stop posting images of previous questions. If you carry on like this you will likely end up with a <a href=\"http://stackoverflow.com/help/question-bans\">question ban</a>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426690534, "post_id": 29124933, "comment_id": 46476751, "body": "Dear, Many Thanks))) It has to delete just one row once, so I don&#39;t think that I need the loop)))Thanks I&#39;ll try.."}, {"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426693216, "post_id": 29124933, "comment_id": 46478789, "body": "Dim f       As String  f = Worksheets(&quot;Modification&quot;).Range(&quot;A3&quot;) &#39;Since i didn&#39;t got that clear, here above you must create a code to declare &quot;f&quot; as whatever you want  Set c = Worksheets(&quot;Donn&#233;es Enregistr&#233;es&quot;).Range(&quot;A1:A20&quot;).Find(f)  Range(c.Address()).EntireRow.Delete"}, {"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426693338, "post_id": 29124933, "comment_id": 46478900, "body": "I have tried with this code, but very strange it has deleted one row but not the good one. It has deleted the Row in A3 (Sheet1=Modification), and not the row in the sheet 2 = Donn&#233;es Enregistr&#233;es."}, {"owner": {"reputation": 176, "user_id": 3938912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oJF4i.jpg?s=128&g=1", "display_name": "Ygor Yansz", "link": "https://stackoverflow.com/users/3938912/ygor-yansz"}, "reply_to_user": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426695283, "post_id": 29124933, "comment_id": 46480330, "body": "Place a worksheets(2). before the range(c.address())"}, {"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426696738, "post_id": 29124933, "comment_id": 46481352, "body": "Great!!! Many Thanks;) You are so kind to help me;))Can I ask you something more?? :/  In my exemple,  if I put 5(in A3), 5 is not present in the column 1 of the sheet2, and I have an Error (Debog)."}, {"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426696913, "post_id": 29124933, "comment_id": 46481479, "body": "As you have seen, Im really bad:/  I think that I need to make a IF&quot;A3 Value is present in coumn1 Sheet2&quot; Then &quot; (All of Code that you have done) &quot; Else &quot;Nothing&quot;            &lt;----- How can I write that?? Is it the good Idea? Thanks a lot"}, {"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426697573, "post_id": 29124933, "comment_id": 46481936, "body": "If Worksheets(&quot;Modification&quot;).Range(&quot;A3&quot;) = Worksheets(&quot;Donn&#233;es Enregistr&#233;es&quot;).Range(&quot;A:A&quot;) Then  Dim f       As String  f = Worksheets(&quot;Modification&quot;).Range(&quot;A3&quot;) &#39;Since i didn&#39;t got that clear, here above you must create a code to declare &quot;f&quot; as whatever you want  Set c = Worksheets(&quot;Donn&#233;es Enregistr&#233;es&quot;).Range(&quot;A:A&quot;).Find(f)  Worksheets(&quot;Donn&#233;es Enregistr&#233;es&quot;).Range(c.Address()).EntireRow.Delete  End If"}, {"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426697614, "post_id": 29124933, "comment_id": 46481962, "body": "But still an error:/"}], "tags": [], "owner": {"reputation": 176, "user_id": 3938912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oJF4i.jpg?s=128&g=1", "display_name": "Ygor Yansz", "link": "https://stackoverflow.com/users/3938912/ygor-yansz"}, "is_accepted": true, "score": -1, "last_activity_date": 1426689431, "creation_date": 1426689431, "answer_id": 29124933, "question_id": 29124173, "link": "https://stackoverflow.com/questions/29124173/delete-the-entire-row-in-another-worksheet/29124933#29124933", "title": "Delete the entire row in another worksheet", "body": "<p>Ok man this code will do the job for you i think at least on the delete part, but you must adapt to the rest of your code</p>\n\n<p>You wasen't clear about how many time it happens so just build a loop if you need</p>\n\n<pre><code>Dim f       As String\n\nf = Worksheets(1).Range(\"A3\")\n'Since i didn't got that clear, here above you must create \n'a code to declare \"f\" as whatever you want the code will than\n'search that f value on the \"A\" column of Sheets(2) and delete \n'the first that contains that value, build a loop if it happens \n'more than once\n\nSet c = Worksheets(2).Range(\"A:A\").Find(f)\n\nRange(c.address()).EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "closed_date": 1426690326, "accepted_answer_id": 29124933, "answer_count": 1, "score": -2, "last_activity_date": 1426689431, "creation_date": 1426687392, "last_edit_date": 1426687619, "question_id": 29124173, "link": "https://stackoverflow.com/questions/29124173/delete-the-entire-row-in-another-worksheet", "closed_reason": "Duplicate", "title": "Delete the entire row in another worksheet", "body": "<p>In <code>Sheet1</code> there is one number in <code>A3</code> (which is not always the same)</p>\n\n<p><img src=\"https://i.stack.imgur.com/HL5vN.jpg\" alt=\"enter image description here\"></p>\n\n<p>In <code>Sheet2</code>, I want to delete the entire row where column A contains the same value as <code>Sheet1!A3</code> (in blue):</p>\n\n<p><img src=\"https://i.stack.imgur.com/sxY8y.jpg\" alt=\"enter image description here\"></p>\n\n<p>With a different number:</p>\n\n<p><img src=\"https://i.stack.imgur.com/p4zSD.jpg\" alt=\"enter image description here\"></p>\n\n<p>As before, we delete the row:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ALFfF.jpg\" alt=\"enter image description here\"></p>\n\n<p>...and so on.</p>\n\n<p>Here is my code, but nothing happened; no error, but no rows deleted.</p>\n\n<pre><code>Dim rng As Range\n    Dim WB As Workbook\n    Dim i As Integer\n\n      Application.ScreenUpdating = False\n      Set WB = ActiveWorkbook\n      Set rng = WB.Sheets(\"Donn\u00e9es Enregistr\u00e9es\").Range(\"B:B\").Find(What:=WB.Sheets(\"Modification\").Range(\"A3\"), _\n             LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n      While Not rng Is Nothing\n        rng.Rows(\"Modification\").EntireRow.Delete\n        Set rng = WB.Sheets(\"Donn\u00e9es Enregistr\u00e9es\").Range(\"B:B\").Find(What:=WB.Sheets(\"Modification\").Range(\"A3\"), _\n                  LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n      Wend\n\n      Application.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["excel", "collections", "vba"], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 3938912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oJF4i.jpg?s=128&g=1", "display_name": "Ygor Yansz", "link": "https://stackoverflow.com/users/3938912/ygor-yansz"}, "is_accepted": false, "score": 0, "last_activity_date": 1426686939, "creation_date": 1426686939, "answer_id": 29124014, "question_id": 29123664, "link": "https://stackoverflow.com/questions/29123664/paste-range-items-into-columns-vba/29124014#29124014", "title": "Paste range items into columns VBA", "body": "<p>Your problem is that the paste method dosen't work with column, not in the same way as it does with ranges and cells, you must change your code to this:</p>\n\n<p>(make sure you declared the sheet1 variable since her declaration is not in the part of the code you posted)</p>\n\n<pre><code>sheet1.columns(Count).select\n'there is no need to declare the row here just\n\nsheet1.paste\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4682535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca40d394fde175b0b4ba2b476c2658e9?s=128&d=identicon&r=PG&f=1", "display_name": "user4682535", "link": "https://stackoverflow.com/users/4682535/user4682535"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426688697, "creation_date": 1426686041, "last_edit_date": 1531161705, "question_id": 29123664, "link": "https://stackoverflow.com/questions/29123664/paste-range-items-into-columns-vba", "title": "Paste range items into columns VBA", "body": "<p>I have 14 range items in a collection that I am trying to copy and paste into a new sheet one after the other, in different columns.  I have written a for loop below but for some reason it keeps breaking on the line where I select the new column and I am not sure why. Any help would be greatly appreciated!</p>\n\n<pre><code>Set NewBook = Workbooks.Add\n\n    With NewBook\n        .SaveAs Filename:=\"NewReport.xls\"\n    End With\n\nCount = 1\n\nFor Each rngitem In rngcollec\n\nrngitem.Copy\nNewBook.Activate\nSheet1.Columns(0, Count).Select\nrngitem.Paste\n\nCount = Count + 1\n\nNext\n</code></pre>\n"}, {"tags": ["excel", "matrix", "distance", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1426691884, "post_id": 29123645, "comment_id": 46477781, "body": "Take a look here: <a href=\"http://stackoverflow.com/questions/19360440/how-to-parse-json-with-vba-without-external-libraries\" title=\"how to parse json with vba without external libraries\">stackoverflow.com/questions/19360440/&hellip;</a> It has some good clues and conversations about dealing with JSON in VBA, which is what you appear to be doing."}, {"owner": {"reputation": 85, "user_id": 1278642, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/09216d19a2d504cfb34a26e6a51fe52f?s=128&d=identicon&r=PG", "display_name": "kolis29", "link": "https://stackoverflow.com/users/1278642/kolis29"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1427205100, "post_id": 29123645, "comment_id": 46674788, "body": "Thank you. I think I don&#39;t need to deal with json file. If I open it in chrome or mozilla it looks like text on website, so I would like to copy whole content and put in specific cell in excel. Then I&#39;ll run a macro which can extract only particular data. I might be wrong, I&#39;m not very good in this sphere, but I&#39;m learning....:)"}], "owner": {"reputation": 85, "user_id": 1278642, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/09216d19a2d504cfb34a26e6a51fe52f?s=128&d=identicon&r=PG", "display_name": "kolis29", "link": "https://stackoverflow.com/users/1278642/kolis29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1357, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1426749489, "creation_date": 1426686001, "last_edit_date": 1531164843, "question_id": 29123645, "link": "https://stackoverflow.com/questions/29123645/copy-website-from-chrome-to-excel-using-vba", "title": "Copy website from chrome to excel using VBA", "body": "<p>I need to copy entire website (in chrome) and put it in a specific place in excel using VBA. I'm trying to create a distance matrix so I work with files looking as this example:</p>\n\n<pre><code>{\n\"destination_addresses\" : [  \n  \"Bratislava, Slovak republic\"\n   ],\n   \"origin_addresses\" : [\n      \"Vienna, Austria\"\n   ],\n   \"rows\" : [\n      {\n         \"elements\" : [\n            {\n               \"distance\" : {\n                  \"text\" : \"79,1 km\",\n                  \"value\" : 79100\n               },\n               \"duration\" : {\n                  \"text\" : \"0 hours, 54 minutes\",\n                  \"value\" : 3240\n               },\n               \"status\" : \"OK\"\n            }               \n         ]\n      }\n   ],\n   \"status\" : \"OK\"\n}\n</code></pre>\n\n<p>After copying web content I can extract only distance and duration and insert it in a table.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "edited": false, "score": 1, "creation_date": 1426684751, "post_id": 29123142, "comment_id": 46472617, "body": "By the way, in my Ms Access applications I use late binding for any MS Excel procedures because of the mixed environment I am working in.  Mix in the since of MS Officer 2007 and MS Office 2010.  Soon to have MS Office 2013 as well."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1426685351, "post_id": 29123142, "comment_id": 46473042, "body": "You could use <a href=\"https://christopherjmcclellan.wordpress.com/2014/11/21/setting-up-a-debug-environment-for-vba/\" rel=\"nofollow noreferrer\">conditional compilation</a>, but you would still have to modify the constant value."}, {"owner": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1426697560, "post_id": 29123142, "comment_id": 46481928, "body": "That&#39;s is amazing. I had no clue. On the new tricks I am learning today."}], "answers": [{"comments": [{"owner": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "edited": false, "score": 0, "creation_date": 1426689378, "post_id": 29123511, "comment_id": 46475891, "body": "This is a great idea I did not know about but the application.run &quot;Volatile&quot; ends the function before executing the complete function."}, {"owner": {"reputation": 1688, "user_id": 521425, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/58f4e72c995fe9fb7fb93e74f86ac392?s=128&d=identicon&r=PG", "display_name": "CaBieberach", "link": "https://stackoverflow.com/users/521425/cabieberach"}, "reply_to_user": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "edited": false, "score": 0, "creation_date": 1426697139, "post_id": 29123511, "comment_id": 46481631, "body": "Hi @FredWilson.  I Just corrected the code; it is necessary to fully specify the method name;  &quot;Application.Volatile&quot; not just &quot;Volatile&quot;."}, {"owner": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "edited": false, "score": 0, "creation_date": 1426697397, "post_id": 29123511, "comment_id": 46481815, "body": "Thank you CaBieberach. I will work with that and see if it will get me by."}], "tags": [], "owner": {"reputation": 1688, "user_id": 521425, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/58f4e72c995fe9fb7fb93e74f86ac392?s=128&d=identicon&r=PG", "display_name": "CaBieberach", "link": "https://stackoverflow.com/users/521425/cabieberach"}, "is_accepted": true, "score": 1, "last_activity_date": 1426696834, "last_edit_date": 1426696834, "creation_date": 1426685647, "answer_id": 29123511, "question_id": 29123142, "link": "https://stackoverflow.com/questions/29123142/vba-how-to-determine-which-application-is-being-used/29123511#29123511", "title": "VBA how to determine which application is being used", "body": "<p>You can ask for the name of the application:</p>\n\n<pre><code>If Application.Name = \"Microsoft Access\" then\n   'Do Nothing ......Or whatever you need to do.\n\nElseIf Application.Name = \"Microsoft Excel\" then\n    Application.Run \"Application.Volatile\"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "edited": false, "score": 0, "creation_date": 1426689398, "post_id": 29123590, "comment_id": 46475912, "body": "I am not sure I understand the point here. I will have to look up CallByName."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1426689767, "post_id": 29123590, "comment_id": 46476189, "body": "I believe what @Serenity means is: <code>If Application.Name = &quot;Microsoft Excel&quot; Then CallByName Application, &quot;Volatile&quot;, VbMethod, True</code>"}, {"owner": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "edited": false, "score": 0, "creation_date": 1426697368, "post_id": 29123590, "comment_id": 46481790, "body": "Without you guys how does one figure this stuff out? ;-)"}], "tags": [], "owner": {"reputation": 34, "user_id": 4678375, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4678375/serenity"}, "is_accepted": false, "score": 1, "last_activity_date": 1426685844, "creation_date": 1426685844, "answer_id": 29123590, "question_id": 29123142, "link": "https://stackoverflow.com/questions/29123142/vba-how-to-determine-which-application-is-being-used/29123590#29123590", "title": "VBA how to determine which application is being used", "body": "<p>From Help.</p>\n\n<p>Visual Basic for Applications Reference</p>\n\n<p><strong>CallByName Function</strong></p>\n\n<p>Executes a method of an object, or sets or returns a property of an object.</p>\n\n<p>Syntax</p>\n\n<pre><code>CallByName(object, procname, calltype,[args()])\n</code></pre>\n\n<p>The CallByName function syntax has these named arguments:</p>\n\n<pre><code>Part Description \nobject Required; Variant (Object). The name of the object on which the function will be executed. \nprocname Required; Variant (String). A string expression containing the name of a property or method of the object. \ncalltype Required; Constant. A constant of type vbCallType representing the type of procedure being called. \nargs() Optional: Variant (Array). \n</code></pre>\n\n<p><strong>Remarks</strong></p>\n\n<p>The CallByName function is used to get or set a property, or invoke a method at run time using a string name.</p>\n\n<p>In the following example, the first line uses CallByName to set the MousePointer property of a text box, the second line gets the value of the MousePointer property, and the third line invokes the Move method to move the text box:</p>\n\n<pre><code>CallByName Text1, \"MousePointer\", vbLet, vbCrosshair\nResult = CallByName (Text1, \"MousePointer\", vbGet)\nCallByName Text1, \"Move\", vbMethod, 100, 100\n</code></pre>\n\n<hr>\n\n<p>Send feedback to MSDN.Look here for MSDN Online resources. </p>\n"}], "owner": {"reputation": 529, "user_id": 2802437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/3D7mO.jpg?s=128&g=1", "display_name": "acr_scout", "link": "https://stackoverflow.com/users/2802437/acr-scout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 0, "accepted_answer_id": 29123511, "answer_count": 2, "score": 2, "last_activity_date": 1594645208, "creation_date": 1426684628, "last_edit_date": 1594645208, "question_id": 29123142, "link": "https://stackoverflow.com/questions/29123142/vba-how-to-determine-which-application-is-being-used", "title": "VBA how to determine which application is being used", "body": "<p>I have a VBA function I use in MS Access and MS Excel. When used in MS Excel I use Application.Volatile but when it is placed or used in MS Access it will not compile. Is there a way to make this line interchangeable without having to delete it when placed in MS Access?</p>\n\n<p>Thank you,\nFred</p>\n"}, {"tags": ["excel", "csv", "vba"], "comments": [{"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1427310299, "post_id": 29122939, "comment_id": 46730607, "body": "What is the format of each .csv? Is there anything on each line besides the titles/hyperlinks?"}, {"owner": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "reply_to_user": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1427510663, "post_id": 29122939, "comment_id": 46819419, "body": "My .csv files have the respective text (hyperlink and titles) all down column A."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1427604896, "post_id": 29313248, "comment_id": 46842065, "body": "I&#39;m getting an error message: <b>Compile error: Method or data member not found</b> and it highlights <i>.Cells</i> of <b>ThisWorkbook.Cells(i, 1).Formula =</b>"}, {"owner": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1427605103, "post_id": 29313248, "comment_id": 46842100, "body": "also to be clear, on the <b>Do Until wb1.Sheets(&quot;Sheet1Name&quot;).Cells(i, 1).Value = &quot;&quot;</b> I&#39;m entering an integer of how many cells I want it to do this for correct?"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1427606644, "post_id": 29313248, "comment_id": 46842315, "body": "Edited code. And no, you&#39;re not entering anything for the integer. You just need to make sure your paths and sheet names are correct."}, {"owner": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1427608515, "post_id": 29313248, "comment_id": 46842621, "body": "my pathnames are correct, I&#39;m not sure what sheet name needs to be but it&#39;s now giving this error <b>run-time error &#39;9&#39;: subscript out of range</b>"}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1427721067, "post_id": 29313248, "comment_id": 46880019, "body": "Your question is ill-posed. CSV files are text-only and do not permit hyperlinks. There is no way to create a text or CSV file with clickable links. The only way to have a file with a &quot;built-in hyperlink&quot; is if the file&#39;s format is HTML or some other similar format that allows hyperlinks, such as an Excel spreadsheet."}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 0, "last_activity_date": 1427606486, "last_edit_date": 1427606486, "creation_date": 1427512430, "answer_id": 29313248, "question_id": 29122939, "link": "https://stackoverflow.com/questions/29122939/titles-in-one-csv-hyperlinks-in-other-csv-create-new-csv-with-links-built-in/29313248#29313248", "title": "Titles in one CSV, Hyperlinks in other CSV, create new CSV with links built in", "body": "<pre><code>Sub buildlinks()\nDim i As Integer\nDim wb1, wb2 As Workbook\n\nSet wb1 = Application.Workbooks.Open(\"C:/path/Links.csv\")\nSet wb2 = Application.Workbooks.Open(\"C:/path/Titles.csv\")\n\ni = 1\nDo Until wb1.Sheets(\"Sheet1Name\").Cells(i, 1).Value = \"\"\n    ThisWorkbook.Sheets(\"Sheet1Name\").Cells(i, 1).Formula = \"=HYPERLINK(\" &amp; wb1.Sheets(\"Sheet1Name\").Cells(i, 1).Value &amp; \",\" &amp; wb2.Sheets(\"Sheet1Name\").Cells(i, 1).Value &amp; \")\"\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1428045854, "post_id": 29347170, "comment_id": 47026284, "body": "thanks for your help. What you offered helped me learn some VBA for the first time by really looking into it. It&#39;s still not working but I think this is a step in the right direction. Where exactly do I enter the file path for the links and texts (please indicate with something like this -&gt; <b>bold</b>&quot;C:\\Users\\yourpathhere&quot;<b>bold</b> or <b>C:\\yourpathhere</b>"}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "reply_to_user": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1428070205, "post_id": 29347170, "comment_id": 47036912, "body": "You enter the path name in the code that calls <code>BuildLinks</code>. Either from immediate mode (control-G) or by writing another <code>Sub</code> that you then call, for instance <code>BuildLinks &quot;c:\\users\\PathToTitlesFile&quot;, &quot;c:\\users\\PathToLinksFile&quot;, 2</code>"}, {"owner": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1429019047, "post_id": 29347170, "comment_id": 47400829, "body": "in the code above that you submitted, is there somewhere inside that code in which I am supposed to enter the actual paths to my files?"}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "reply_to_user": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1429020433, "post_id": 29347170, "comment_id": 47401836, "body": "No. You have to write another <code>Sub</code> that calls into this <code>Sub</code> with the path as a parameter (or call into this one from immediate mode)."}, {"owner": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1429125256, "post_id": 29347170, "comment_id": 47457286, "body": "It seems inefficient to have a sub call another sub, to then call the 2 path names.  In the example code offered by @nwhaught there are path names within the sub, but that particular one is giving me errors. In any case, would you be able to post the sub needed to call the paths as you suggested? Would launching the inital vbs (or sub) automatically then create the output file I require?"}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "reply_to_user": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "edited": false, "score": 0, "creation_date": 1429133355, "post_id": 29347170, "comment_id": 47462070, "body": "The reason I wrote it that way was so that you could call it with any path names. It&#39;s not &quot;inefficient&quot;. How do you normally call subs? Are you familiar with the Immediate pane (by pressing control-G)? It allows you to call subs by typing their name, whether or not they require parameters."}], "tags": [], "owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "is_accepted": false, "score": 0, "last_activity_date": 1427721188, "creation_date": 1427721188, "answer_id": 29347170, "question_id": 29122939, "link": "https://stackoverflow.com/questions/29122939/titles-in-one-csv-hyperlinks-in-other-csv-create-new-csv-with-links-built-in/29347170#29347170", "title": "Titles in one CSV, Hyperlinks in other CSV, create new CSV with links built in", "body": "<p>Assuming you want to create the hyperlinks in the current spreadsheet instead of creating a separate file.</p>\n\n<p>Since you've said that the inputs are really just text files, one item per line, not comma-separated, it's actually pretty simple to implement using the VBA file handling commands.</p>\n\n<pre><code>Sub BuildLinks(titlesFilePath as String, linksFilePath As String, ByVal rowStart As Long)\n  Dim tf As Long, lf As Long, of As Long\n  tf = FreeFile\n  On Error Goto NO_TITLE_FILE\n  Open titlesFilePath For Input As #tf\n  lf = FreeFile\n  On Error Goto NO_LINKS_FILE\n  Open linksFilePath For Input As #lf\n  On Error Goto 0\n\n  While Not (EOF(tf) Or EOF(lf))\n    Dim curTitle As String, curLink As String\n    Line Input #tf, curTitle\n    Line Input #lf, curLink\n    Cells(rowStart, 1).Formula = \"=HYPERLINK(\"\"\" &amp; curLink &amp; \"\"\",\"\"\" &amp; curTitle &amp; \"\"\")\"\n  Wend\n  Close #tf\n  Close #lf\n  Exit Sub\nNO_TITLE_FILE:\n  MsgBox \"Can't Open Title File\" &amp; titlesFilePath\n  Exit Sub\nNO_LINKS_FILE:\n  MsgBox \"Can't Open Links File\" &amp; linksFilePath\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2921233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e19299d197893f6f71143e885ae01c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Gentile", "link": "https://stackoverflow.com/users/2921233/sergio-gentile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1429125349, "creation_date": 1426684034, "last_edit_date": 1531161705, "question_id": 29122939, "link": "https://stackoverflow.com/questions/29122939/titles-in-one-csv-hyperlinks-in-other-csv-create-new-csv-with-links-built-in", "title": "Titles in one CSV, Hyperlinks in other CSV, create new CSV with links built in", "body": "<p>I have plain text titles in one .csv and hyperlinks for those titles in another .csv</p>\n\n<p>I currently open them in the same work book, put the titles in A, the hyperlinks in H, and use</p>\n\n<pre><code>=HYPERLINK(H1,A1)\n</code></pre>\n\n<p>to get my final output of Titles with hyperlinks built in.</p>\n\n<p>Is there an easy way (Excel VBA or macro) to bypass the manual work and create a new output file with the \"Titles with hyperlinks built in\" from the original two .csv files?</p>\n\n<p>Edit: My two .csv files have the respective text (hyperlink and titles) all down column A.</p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "edited": false, "score": 3, "creation_date": 1426683566, "post_id": 29122175, "comment_id": 46471723, "body": "Hi, the ListBox control has a MultiSelect property"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1426683878, "post_id": 29122175, "comment_id": 46471951, "body": "As Jiminy mentions, there is a MultiSelect property. You can set this to <code>True</code> at Design time in the object&#39;s Properties window, or at runtime using <code>.MultiSelect = True</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1426685052, "post_id": 29122175, "comment_id": 46472845, "body": "If it&#39;s a Listbox, rather than Combobox, what is the &quot;drop down list&quot; to which you refer?"}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426687677, "post_id": 29122175, "comment_id": 46474654, "body": "Good point @Rory, amended question to reflect this."}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426775029, "post_id": 29122175, "comment_id": 46516637, "body": "@Rory. Any idea how to get the selected items in the listbox to populate a column in another sheet? Cheers"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1426775911, "post_id": 29122175, "comment_id": 46517300, "body": "Loop through the items using a counter and test if <code>.Selected(counter)</code> is true - if so, put <code>.List(counter, 0)</code> into the appropriate cell"}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426780835, "post_id": 29122175, "comment_id": 46520882, "body": "@Rory that sounds good, don&#39;t have much experience of counters so any additional tips would be handy - no bother if not. Cheers."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426782024, "post_id": 29122175, "comment_id": 46521679, "body": "Probably worth posting a new question giving details of the control and where you want the output - I&#39;m sure someone will provide some code. :)"}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427105902, "post_id": 29122175, "comment_id": 46625711, "body": "@Rory good plan, <a href=\"http://stackoverflow.com/questions/29207699/vba-multiselect-listbox-populate-column-with-selected-items\">here it is</a>"}], "answers": [{"tags": [], "owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1426687861, "creation_date": 1426687861, "answer_id": 29124334, "question_id": 29122175, "link": "https://stackoverflow.com/questions/29122175/vba-enable-multiple-selections-from-list-box/29124334#29124334", "title": "VBA enable multiple selections from list box", "body": "<p>Solution involves adding one line to the code after the box has been populated. Cheers for the input :)</p>\n\n<pre><code>Worksheets(\"DMA list\").Shapes(\"DMA_listbox\").ControlFormat.MultiSelect = xlSimple\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 636, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426687861, "creation_date": 1426681969, "last_edit_date": 1426687728, "question_id": 29122175, "link": "https://stackoverflow.com/questions/29122175/vba-enable-multiple-selections-from-list-box", "title": "VBA enable multiple selections from list box", "body": "<p>I have created a listbox in Excel that is populated by a list from another sheet as below. I am wondering if there is a way to enable multiple selections from the list so I can then use the multiple selection to populate a new column and run some filters based on them.</p>\n\n<pre><code>Sub FilterUniqueData()\n    Dim Lrow As Long, test As New Collection\n    Dim Value As Variant, temp() As Variant\n    ReDim temp(0)\n    Dim Value1 As Variant\n\n    On Error Resume Next\n    With Workbooks(\"Copy of SWR1304 (Future Development Risk Assessment) Strathaven.xls\").Sheets(\"Non Household Metered Users\")\n        'Lrow = .Range(\"a\" &amp; Rows.count).End(xlUp).Row\n    temp = .Range(\"h:h\").Value\n    End With\n\n\nFor Each Value In temp\n    If Len(Value) &gt; 0 Then test.Add Value, CStr(Value)\nNext Value\n\n    ReDim temp(0)\n    Workbooks(\"DMA_metered_tool.xlsm\").Worksheets(\"DMA list\").Shapes(\"DMA_listbox\").ControlFormat.RemoveAllItems\n\n    For Each Value In test\n         Worksheets(\"DMA list\").Shapes(\"DMA_listbox\").ControlFormat.AddItem Value\n    Next Value\n\n    Set test = Nothing\n\n'Workbooks(\"DMA_metered_tool.xlsm\").Worksheets(\"DMA list\").Shapes(\"DMA_listbox\").ControlFormat.List = Workbooks(\"Copy of SWR1304 (Future Development Risk Assessment) Strathaven.xls\").Sheets(\"Non Household Metered Users\").Range(\"h:h\").Value\nEnd Sub\n</code></pre>\n\n<p>Cheers!</p>\n"}, {"tags": ["excel", "vba", "filter", "pivot-table", "excel-2013"], "comments": [{"owner": {"reputation": 456, "user_id": 2564102, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bb574d1de237954faebb4a27d34024e2?s=128&d=identicon&r=PG", "display_name": "hgeop", "link": "https://stackoverflow.com/users/2564102/hgeop"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1426693555, "post_id": 29121505, "comment_id": 46479049, "body": "Whatever way works really, I&#39;ve added VBA to the tags"}], "answers": [{"comments": [{"owner": {"reputation": 456, "user_id": 2564102, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bb574d1de237954faebb4a27d34024e2?s=128&d=identicon&r=PG", "display_name": "hgeop", "link": "https://stackoverflow.com/users/2564102/hgeop"}, "edited": false, "score": 0, "creation_date": 1426865408, "post_id": 29167694, "comment_id": 46558649, "body": "Thanks for this @mmarie . Is there a way of selecting all the connections without ticking each on individually in the Report Connections?"}], "tags": [], "owner": {"reputation": 5343, "user_id": 2514839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XpyI6.png?s=128&g=1", "display_name": "mmarie", "link": "https://stackoverflow.com/users/2514839/mmarie"}, "is_accepted": true, "score": 1, "last_activity_date": 1426858139, "creation_date": 1426858139, "answer_id": 29167694, "question_id": 29121505, "link": "https://stackoverflow.com/questions/29121505/master-pivottable-filter/29167694#29167694", "title": "Master PivotTable Filter", "body": "<p>You can accomplish this by using a <a href=\"https://support.office.com/en-us/article/Use-slicers-to-filter-PivotTable-data-249f966b-a9d5-4b0f-b31a-12651785d29d\" rel=\"nofollow\">slicer</a>. Slicers are similar to filters, but look a little different and can be associated with multiple pivot tables. This means you might want to make a \"front page\" or similar area with the slicer on it so it is obvious that the one slicer controls the month filter for all pivot tables. </p>\n\n<p>You just insert the slicer on the page, then click on Report Connections and connect it to each pivot table. </p>\n"}], "owner": {"reputation": 456, "user_id": 2564102, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bb574d1de237954faebb4a27d34024e2?s=128&d=identicon&r=PG", "display_name": "hgeop", "link": "https://stackoverflow.com/users/2564102/hgeop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "accepted_answer_id": 29167694, "answer_count": 1, "score": 0, "last_activity_date": 1426858139, "creation_date": 1426680050, "last_edit_date": 1426683054, "question_id": 29121505, "link": "https://stackoverflow.com/questions/29121505/master-pivottable-filter", "title": "Master PivotTable Filter", "body": "<p>I have 6 pivot-charts on many worksheets (each worksheet corresponding to different individuals), all pivot-tables have a Month filter. Instead of clicking on each individual filter to update the pivot-table (and corresponding pivot-chart). Is there a way of creating a 'master' filter button so that all filters are updated? </p>\n\n<p>Let me know if you require further information. </p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 527, "user_id": 2584659, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/5T7jB.jpg?s=128&g=1", "display_name": "Solution Seeker", "link": "https://stackoverflow.com/users/2584659/solution-seeker"}, "edited": false, "score": 0, "creation_date": 1426683668, "post_id": 29122303, "comment_id": 46471786, "body": "Thanks for your reply. Now I&#39;m using the myforward.HTMLBody property. But the problem I&#39;m facing is that on receiving end the whole html email formatting is getting disturbed. To make it clear, I already have one mail in my inbox with all the pictures and formatting. I&#39;m just forwarding that mail using VBA. We don&#39;t need to add any images while sending the mail."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 527, "user_id": 2584659, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/5T7jB.jpg?s=128&g=1", "display_name": "Solution Seeker", "link": "https://stackoverflow.com/users/2584659/solution-seeker"}, "edited": false, "score": 0, "creation_date": 1426683907, "post_id": 29122303, "comment_id": 46471979, "body": "Why do you need to set the BodyFormat property in the code?"}, {"owner": {"reputation": 527, "user_id": 2584659, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/5T7jB.jpg?s=128&g=1", "display_name": "Solution Seeker", "link": "https://stackoverflow.com/users/2584659/solution-seeker"}, "edited": false, "score": 0, "creation_date": 1426684129, "post_id": 29122303, "comment_id": 46472133, "body": "Now I&#39;ve removed that BodyFormat line from my code. I&#39;ve modified it in my question. But still on receiving end it&#39;s completely disturbing the format of my mail. Like All the images it is giving as an attachment."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 527, "user_id": 2584659, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/5T7jB.jpg?s=128&g=1", "display_name": "Solution Seeker", "link": "https://stackoverflow.com/users/2584659/solution-seeker"}, "edited": false, "score": 0, "creation_date": 1426685571, "post_id": 29122303, "comment_id": 46473194, "body": "Make sure that the PR_ATTACH_CONTENT_ID property is set on attachments and you refer to the image through the cid img attribute. See <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/6c063b27-7e8a-4963-ad5f-ce7e5ffb2c64/how-to-embed-image-in-html-body-in-c-into-outlook-mail?forum=vsto\" rel=\"nofollow noreferrer\">how to embed image in html body in c# into outlook mail</a> for more information."}, {"owner": {"reputation": 527, "user_id": 2584659, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/5T7jB.jpg?s=128&g=1", "display_name": "Solution Seeker", "link": "https://stackoverflow.com/users/2584659/solution-seeker"}, "edited": false, "score": 0, "creation_date": 1426686022, "post_id": 29122303, "comment_id": 46473503, "body": "I didn&#39;t get your comment. The existing email is perfect in formatting. Now I&#39;m using VBA code to forward the existing mail. The code works well. But the whole email body is coming with different image attachment on receiving email ID. I want the forwarded mail as it is in the receiving mailbox. I hope I&#39;m clear."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1426682296, "creation_date": 1426682296, "answer_id": 29122303, "question_id": 29121433, "link": "https://stackoverflow.com/questions/29121433/how-to-forward-an-existing-outlook-mail-with-new-values-from-excel-using-vba/29122303#29122303", "title": "How to forward an existing outlook mail with new values from excel using vba", "body": "<p>First of all, don't use multiple dots in the single line of code. I'd recommend breaking the chain of calls and declare each property or method call on separate lines of code.</p>\n\n<pre><code>If objFolder.DefaultItemType = olMailItem Then\n</code></pre>\n\n<p>There is no need to check out the folder's property in the loop each time. I'd suggest moving that condition out of the loop.</p>\n\n<pre><code>objitem.BodyFormat = olFormatHTML\n</code></pre>\n\n<p>Why do you need to set up the BodyFormat property? Did have a chance to check the value before setting the property?</p>\n\n<pre><code>myforward.Body = Replace(myforward.Body, \"xxnamexx\", \"FirstName\", 1, 1)\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a> property is a string representing the clear-text body of the Outlook item. You need to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a> property if you want to preserve the formatting. You can read more about all possible ways of working with item bodies in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>.</p>\n\n<p>Anyway, I don't see the code where you add images and other information to the message body.</p>\n"}], "owner": {"reputation": 527, "user_id": 2584659, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/5T7jB.jpg?s=128&g=1", "display_name": "Solution Seeker", "link": "https://stackoverflow.com/users/2584659/solution-seeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2710, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593070761, "creation_date": 1426679818, "last_edit_date": 1593070761, "question_id": 29121433, "link": "https://stackoverflow.com/questions/29121433/how-to-forward-an-existing-outlook-mail-with-new-values-from-excel-using-vba", "title": "How to forward an existing outlook mail with new values from excel using vba", "body": "<p>I've an existing promotional mail with HTML formatting, colors, bullets etc. I would like to forward this mail to new set of recipients using VBA.</p>\n\n<p>I've an existing mail with following Body:</p>\n\n<hr>\n\n<p>Hi XXnameXX,</p>\n\n<p>Some Picture are present &amp; Lot of colored formatting.</p>\n\n<p>Thanks for registering to our website. Your user id is XXuseridXX.</p>\n\n<p>Thank you.</p>\n\n<hr>\n\n<p>Here XXnameXX should be replaced with FirstName and XXuseridXX with userID</p>\n\n<p>I am able to forward the selected mail from Outlook. But it's not forwarding it with all the images/formatting/bullets. On receiving end its showing a complete different mail with link and all.</p>\n\n<pre><code>Sub ForwardEmail()\n Dim oApp As Outlook.Application\n Dim objFolder As Outlook.MAPIFolder\n Set oApp = New Outlook.Application\n Set objNS = Application.GetNamespace(\"MAPI\")\n Set objFolder = objNS.GetDefaultFolder(olFolderInbox)\n Dim oEmail As Outlook.MailItem\n\n For Each objitem In Application.ActiveExplorer.Selection\n     If objFolder.DefaultItemType = olMailItem Then\n         If objitem.Class = olMail Then\n\n             Set myforward = objitem.Forward\n\n             Set objRecip = myforward.Recipients.Add(\"firstlastname@gmail.com\")\n\n             myforward.HTMLBody = Replace(myforward.HTMLBody, \"xxnamexx\", \"FirstName\", 1, 1)\n\n             myforward.Send\n\n         End If\n     End If\n Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1426682206, "creation_date": 1426682206, "answer_id": 29122266, "question_id": 29121367, "link": "https://stackoverflow.com/questions/29121367/sheet-copying-moving-blank-or-error/29122266#29122266", "title": "Sheet copying moving blank or error", "body": "<p>I think 'bug' is probably fair in this case (does not happen for me but I have not tried with your file as that requires signing up). MS have a workaround <a href=\"https://support.microsoft.com/en-us/kb/210684\" rel=\"nofollow\">here</a> but it seem at least very <em>similar</em> to what you have tried.</p>\n\n<p>Other suggestions include (from <a href=\"http://webmasterfacts.com/runtime-error-1004/\" rel=\"nofollow\">WebmasterFacts</a>):  </p>\n\n<pre><code>You need to stop all the programs that are running currently through Task manager\nNow go the start menu and you will find control panel over there\nLocate Add/ remove programs in there\nNow look for \u2018Microsoft Works\u2019\nWhen you find it, go ahead and remove it and you are good to go\n</code></pre>\n\n<p>Scanning the whole system is important to confiscate various malwares, corrupt files, viruses, etc. and when the cleanup is done you have to mend the Windows Registry with the repair tool available for Registry. Now when you have done all this you will be able to finally get rid of runtime error 1004.  </p>\n\n<p>Alternative Method</p>\n\n<pre><code>Right click on the start menu\n You will find Explore option, select that\nOnce in there  you need to open this directory \u2013 C:\\Program Files\\MSOffice\\Office\\XLSTART\nHere you need to delete \u201cGWXL97.XLA\u201d file\nNow open the excel after you have closed the explorer\nYour Excel will be running fine without giving any runtime error 1004.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1499167579, "post_id": 44903939, "comment_id": 76786198, "body": "Welcome to Stack Overflow! While this might be a valuable hint to solve the problem, a good answer also demonstrates the solution.  Please <a href=\"https://stackoverflow.com/posts/44903939/edit\">edit</a> to provide example code to show what you mean. Alternatively, consider writing this as a comment instead."}], "tags": [], "owner": {"reputation": 9, "user_id": 8253352, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c25e25f81ec97a3f54eff01950b59ca4?s=128&d=identicon&r=PG", "display_name": "Dawajan Ahmadzai", "link": "https://stackoverflow.com/users/8253352/dawajan-ahmadzai"}, "is_accepted": false, "score": 0, "last_activity_date": 1499165360, "creation_date": 1499165360, "answer_id": 44903939, "question_id": 29121367, "link": "https://stackoverflow.com/questions/29121367/sheet-copying-moving-blank-or-error/44903939#44903939", "title": "Sheet copying moving blank or error", "body": "<p>I got your point, as the excel sheet are copying empty with Sheet-1 name is that the name of the sheet what you are trying to copy is 30 or 31 character, and Excel do not accept any sheet more than 31 character so this is why it can not be copied properly, please reduce the name of the sheet and try, I am sure you will be able to copy the sheet to an other location.</p>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2243, "favorite_count": 0, "accepted_answer_id": 29122266, "answer_count": 2, "score": 0, "last_activity_date": 1499165360, "creation_date": 1426679630, "last_edit_date": 1442329107, "question_id": 29121367, "link": "https://stackoverflow.com/questions/29121367/sheet-copying-moving-blank-or-error", "title": "Sheet copying moving blank or error", "body": "<blockquote>\n  <p>Microsoft Excel 2013 (15.0.4675.1000) 32bit</p>\n</blockquote>\n\n<p>When trying to move or copy one of my sheet no matter in same workbook or other I get empty sheet which named as Sheet1 Sheet2 and etc.</p>\n\n<p>When trying do the same thing programmatically with VBA like:</p>\n\n<pre><code>Sheets(\"Invoice\").Select\nSheets(\"Invoice\").Copy Before:=Sheets(1)\n</code></pre>\n\n<p>I also get error <code>Run time Error 1004: Method Copy of class Worksheet failed</code>\nThis happens very often and every time on different sheets.</p>\n\n<p>Maybe it because of many defined ranges on the sheet?  </p>\n\n<p>I tried save and close the workbook after copying but suck.\nWorkbook size is 100Kb only.</p>\n\n<p>After empty sheet is created if I try to remove it Excel going to stop working and crashing.</p>\n\n<p>Is this a Excel bug or what?</p>\n\n<p><a href=\"https://www.sendspace.com/file/w6vlh4\" rel=\"nofollow\">Here is attached file</a>  </p>\n\n<p>Can you duplicate Invoice sheets?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4681576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6c2c9c9889652a8a1221957a7d49c06a?s=128&d=identicon&r=PG&f=1", "display_name": "John Davies", "link": "https://stackoverflow.com/users/4681576/john-davies"}, "edited": false, "score": 0, "creation_date": 1426691490, "post_id": 29122918, "comment_id": 46477458, "body": "This does not prevent the sheet from printing. I have right clicked the sheet in question, clicked on view code and pasted your code in, however by selecting print it still prints the sheet even though I know that the cell value is &quot;&quot;. Please advise if I am doing anything incorrect."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 27, "user_id": 4681576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6c2c9c9889652a8a1221957a7d49c06a?s=128&d=identicon&r=PG&f=1", "display_name": "John Davies", "link": "https://stackoverflow.com/users/4681576/john-davies"}, "edited": false, "score": 1, "creation_date": 1426693378, "post_id": 29122918, "comment_id": 46478928, "body": "@JohnDavies Don&#39;t put the code in the worksheet code. Instead, put it in the <code>ThisWorkbook</code> code. To get there, open the VBE (press ALT+F11). On the left of the window, there should be a tree view box titled Project - VBA. Within this treeview, there should be a <code>ThisWorkbook</code> module. Enter it there."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1426683974, "creation_date": 1426683974, "answer_id": 29122918, "question_id": 29121333, "link": "https://stackoverflow.com/questions/29121333/prevent-sheet-from-printing-unless-certain-cell-is-not-blank/29122918#29122918", "title": "Prevent sheet from printing unless certain cell is not blank", "body": "<p>The workbook object has a <code>BeforePrint</code> event. Access it from the <code>ThisWorkbook</code> code. You would enter code such as below:</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n    If Sheets(\"Sheet1\").Range(\"F23\").Value = \"\" Then\n        Cancel = True\n        MsgBox (\"Please populate F23\")\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4681576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6c2c9c9889652a8a1221957a7d49c06a?s=128&d=identicon&r=PG&f=1", "display_name": "John Davies", "link": "https://stackoverflow.com/users/4681576/john-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3070, "favorite_count": 0, "accepted_answer_id": 29122918, "answer_count": 1, "score": 0, "last_activity_date": 1444234739, "creation_date": 1426679538, "last_edit_date": 1531164843, "question_id": 29121333, "link": "https://stackoverflow.com/questions/29121333/prevent-sheet-from-printing-unless-certain-cell-is-not-blank", "title": "Prevent sheet from printing unless certain cell is not blank", "body": "<p>Is it possible to prevent a spreadsheet from printing if a certain cell eg. F23 in the sheet is blank and get a pop up message to state that the cell needs to be filled in. Please advise how to do this.\nThanks in advance for any help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426678147, "post_id": 29120716, "comment_id": 46468293, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/5387929/vba-macro-to-compare-all-cells-of-two-excel-files\">VBA Macro to compare all cells of two Excel files</a>"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426679442, "post_id": 29120716, "comment_id": 46469078, "body": "Okay using variants makes the code faster, but how do I then use my Offset property? In other words how can I retrieve values from a different cell in the same row?"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426679828, "post_id": 29120716, "comment_id": 46469341, "body": "Try something, then ask a new question about that specific issue. This one is too broad."}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426684288, "post_id": 29120716, "comment_id": 46472261, "body": "Changed it but I get an &quot;Out of memory&quot;-error. I cannot split the dataset. However I will try some more. The variant way is definitely faster."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1426886004, "post_id": 29120716, "comment_id": 46569515, "body": "<code>Dim ipRange As Variant Dim hsRange As Variant </code>-should these not be <code>range</code>  instead of  <code>variant</code>?"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1427981893, "post_id": 29120716, "comment_id": 47001300, "body": "No, that was exactly the idea. Make it faster by loading a range of cells into an array."}], "owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426683563, "creation_date": 1426677737, "last_edit_date": 1426683563, "question_id": 29120716, "link": "https://stackoverflow.com/questions/29120716/looping-through-more-than-5-000-rows-improvements-needed", "title": "Looping through more than 5.000 rows? Improvements needed", "body": "<p>Can I improve the following code or is there another way to accomplish my goals in less time?</p>\n\n<p>My goal is to concatenate countries and categories of unique brand names.</p>\n\n<p>In the current structure one row represents one brand, one category and one country. In my output I want on row per brand, that has a concatenated cell with all countries and a concatenated cell with all categories.</p>\n\n<p>My solution so far:</p>\n\n<p>I have an Excel-Workbook that has three sheets <code>\"HelpSheet\"</code>,<code>\"Input\"</code> and <code>\"Output\"</code>.</p>\n\n<p><code>\"HelpSheet\"</code>contains the list of brand names without duplicates. <code>\"Input\"</code>has the original data (one row, one entry). <code>\"Output\"</code>should be filled with one row per brand name.</p>\n\n<p><code>\"Input\"</code>approx. 25.000 rows.\n<code>\"HelpSheet\"</code>approx. 5.000 rows.</p>\n\n<p><strong>EDITED: Now I am using variants to store my Range to avoid VBA/Worksheet overhead. Now I get an \"Out of memory\"-Error.</strong></p>\n\n<p>In VBA I wrote this:</p>\n\n<pre><code>Sub CellsTogether()\n\nDim ipRange As Variant\nDim hsRange As Variant\nDim countryCount As Long\nDim categoryCount As Long\nDim brandArray() As String\nDim categoryStr As String\nDim countryStr As String\nDim countryArr() As String\nDim categoryArr() As String\nDim identifier As String\nDim i As Long\nDim j As Long\nDim iRow As Long\nDim iCol As Long\nDim k As Long\nDim l As Long\nDim lastRow As Long\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nipRange = Worksheets(\"Input\").Range(\"B3:N29316\")\nhsRange = Worksheets(\"HelpSheet\").Range(\"A1:A4781\")\ncountryCount = 1\ncategoryCount = 1\n\nFor j = LBound(hsRange, 1) To UBound(hsRange, 1)\n    For iRow = LBound(ipRange, 1) To UBound(ipRange, 1)\n        iCol = 1\n        If ipRange(iRow, iCol) = hsRange(j, 1) Then\n\n            ReDim Preserve countryArr(1 To countryCount)\n            ReDim Preserve categoryArr(1 To categoryCount)\n\n            For k = LBound(countryArr) To UBound(countryArr)\n                If countryArr(k) = ipRange(iRow, iCol + 2) Then\n                    Exit For\n                Else\n                    countryArr(UBound(countryArr)) = ipRange(iRow, iCol + 2)\n                    countryCount = countryCount + 1\n                End If\n            Next k\n\n            For l = LBound(categoryArr) To UBound(categoryArr)\n                If categoryArr(l) = ipRange(iRow, iCol + 12) Then\n                    Exit For\n                Else\n                    categoryArr(UBound(categoryArr)) = ipRange(iRow, iCol + 12)\n                    categoryCount = categoryCount + 1\n                End If\n            Next l\n\n            identifier = ipRange(iRow, iCol + 3)\n\n        End If\n    Next iRow\n\n    For k = LBound(countryArr) To UBound(countryArr)\n        countryStr = countryStr &amp; countryArr(k) &amp; Chr(10)\n    Next k\n    For k = LBound(categoryArr) To UBound(categoryArr)\n        categoryStr = categoryStr &amp; categoryArr(k) &amp; Chr(10)\n    Next k\n\n    Worksheets(\"Output\").Cells(j + 2, 3).Value = hsRange(j, 1)\n    Worksheets(\"Output\").Cells(j + 2, 6).Value = countryStr\n    Worksheets(\"Output\").Cells(j + 2, 5).Value = categoryStr\n    Worksheets(\"Output\").Cells(j + 2, 2).Value = identifier\n\nNext j\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>However this takes a very long time to calculate.</p>\n\n<p>Any improvements?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1242, "user_id": 2751947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7812c423a9d78687c21081db57d6a12a?s=128&d=identicon&r=PG&f=1", "display_name": "helrich", "link": "https://stackoverflow.com/users/2751947/helrich"}, "edited": false, "score": 1, "creation_date": 1426677684, "post_id": 29120612, "comment_id": 46468027, "body": "What you&#39;re looking for is a <code>UserForm</code>. You add it to the VBA project by right clicking on the tree on the left side and inserting it."}], "answers": [{"comments": [{"owner": {"reputation": 1016, "user_id": 3757260, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/556876875/picture?type=large", "display_name": "Frank H.", "link": "https://stackoverflow.com/users/3757260/frank-h"}, "edited": false, "score": 0, "creation_date": 1426679262, "post_id": 29120907, "comment_id": 46468974, "body": "Thanks. I AM using the VBA editor, but I wasn&#39;t aware that I added the userform from there. It seems to do what I need."}], "tags": [], "owner": {"reputation": 49, "user_id": 4223033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc71a83b8dca18ae7acf206a5f95f810?s=128&d=identicon&r=PG&f=1", "display_name": "Derono", "link": "https://stackoverflow.com/users/4223033/derono"}, "is_accepted": true, "score": 1, "last_activity_date": 1426679037, "last_edit_date": 1426679037, "creation_date": 1426678290, "answer_id": 29120907, "question_id": 29120612, "link": "https://stackoverflow.com/questions/29120612/vba-output-dialog-window-or-similar-in-excel-2010/29120907#29120907", "title": "VBA output dialog/window or similar in Excel (2010)", "body": "<p>You have to open Visual Basic editor. On menu, choose \"Insert\" -> \"User Form\". Then you can create custom user forms with text fields, labels, check boxes, buttons etc. <a href=\"http://www.excel-easy.com/vba/userform.html\" rel=\"nofollow\">Here you can find basic informations</a>.</p>\n"}], "owner": {"reputation": 1016, "user_id": 3757260, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/556876875/picture?type=large", "display_name": "Frank H.", "link": "https://stackoverflow.com/users/3757260/frank-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 29120907, "answer_count": 1, "score": 0, "last_activity_date": 1442699352, "creation_date": 1426677411, "last_edit_date": 1531161705, "question_id": 29120612, "link": "https://stackoverflow.com/questions/29120612/vba-output-dialog-window-or-similar-in-excel-2010", "title": "VBA output dialog/window or similar in Excel (2010)", "body": "<p>I've little experience with VBA and Office applications.</p>\n\n<p>My goal is to export data from an Excel sheet to another application. But before the export happens, I want a popup dialog or similar to appear when the user presses the \"Export\"-button, so he/she can review the data which will be ecxported. The reason for this is that the exported data is from various places in the sheet (or sheets), so a visual review is a good idea.</p>\n\n<p>MsgBox is, of course, to small. And it's not meant for presenting lots of data.</p>\n\n<p>What's a practical/elegant/effective/easy way of doing this? Ideally the popup window with the preview shoul have a \"Go ahead\"-button too, but this is not strictly necessary.</p>\n"}, {"tags": ["vba", "excel", "filter", "autofilter"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426676209, "post_id": 29119929, "comment_id": 46467121, "body": "Do you have any blank cells in column a of the filter range? Are you sure there are no leading or trailing spaces in the values that aren&#39;t being included in the filter?"}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426676912, "post_id": 29119929, "comment_id": 46467587, "body": "Hi @Rory I have trimmed the data, but there are some blank cells in the list. It seems it is only selecting the first row in the sheet regardless of what <code>filter_val</code> is set too. I filled in the blanks with a value and this had no effect on the end result."}], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1426679196, "post_id": 29120785, "comment_id": 46468917, "body": "Cheers @Rory, this doesn&#39;t change the result and the <code>Lrow</code> value (7740) is correct for this sheet."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 1, "creation_date": 1426679280, "post_id": 29120785, "comment_id": 46468980, "body": "Then I&#39;d have to assume that the other rows don&#39;t exactly match the filter. Just as a test, what if you use: <code>filter_range.AutoFilter Field:=5, Criteria1:=&quot;*&quot; &amp; filter_val &amp; &quot;*&quot;</code> - do you then see the additional rows?"}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1426679741, "post_id": 29120785, "comment_id": 46469279, "body": "Hmm this is a little odd. The filter value is copied and pasted from the list a  a test and your addition of <code>&quot;*&quot;</code> again returns the same result. In addition I&#39;ve noticed that the <code>Lrow .Range(&quot;a&quot; &amp; Rows.Count).End(xlUp).Row</code> is not properly qualified despite using <code>With Billed_xls</code> as when I do not have that sheet selected it returns  runtime error.1004."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 1, "creation_date": 1426680224, "post_id": 29120785, "comment_id": 46469569, "body": "Sorry - I overlooked a full stop before the <code>Rows.Count</code> - I have amended the code now. If it still doesn&#39;t work, can you put the workbook somewhere for me to have a look at?"}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1426681638, "post_id": 29120785, "comment_id": 46470446, "body": "Great, I&#39;d been staring at that for ages. Pesky little &#39;.&#39;. Now when it&#39;s re-run it filters the data in some way but it is unclear how. Some rows are filtered away but multiple instances of some of the names in that column and some blanks remain. Where would you recommend me putting the workbook? Most sharing sites are blocked on this server."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 1, "creation_date": 1426682399, "post_id": 29120785, "comment_id": 46470951, "body": "Just to check, you are filtering on column <b>E</b>, not column H as you said in your original question?"}, {"owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "edited": false, "score": 0, "creation_date": 1426683119, "post_id": 29120785, "comment_id": 46471419, "body": "Ah Ha, typical it would be a typo. Thanks ever so much for your help! Another personI have changed the code to <code>filter_range.AutoFilter Field:=8, Criteria1:=filter_val</code> and it now works. I will edit your answer to reflect this."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1426684167, "last_edit_date": 1426684167, "creation_date": 1426677986, "answer_id": 29120785, "question_id": 29119929, "link": "https://stackoverflow.com/questions/29119929/vba-autofilter-returns-incomplete-list/29120785#29120785", "title": "VBA autofilter returns incomplete list", "body": "<p>It may be that your <code>Lrow</code> calculation is thrown by an existing filter - clear that first:</p>\n\n<pre><code>Sub filter_DMA_2()             '' will be set to the combobox when that's figured out\n\n    Dim filter_val            As String\n    Dim filter_range          As Range\n    Dim Lrow                  As Long\n\n    Set Billed_xls = Workbooks(\"Copy of SWR1304 (Future Development Risk Assessment) Strathaven.xls\").Sheets(\"Non Household Metered Users\")\n    With Billed_xls\n        ' clear any existing filter to get accurate row count\n        .AutoFilterMode = False\n        Lrow = .Range(\"a\" &amp; .Rows.Count).End(xlUp).Row\n        Set filter_range = .Range(\"a2:v2\" &amp; Lrow)\n    End With\n\n    filter_val = Workbooks(\"DMA_metered_tool_v1.xlsm\").Worksheets(\"DMA list\").Range(\"a1\").Value\n\n    filter_range.AutoFilter Field:=8, Criteria1:=filter_val \n\nEnd Sub\n</code></pre>\n\n<p>The wrong column was being referred to before for <code>filter_range.AutoFilter Field:=8, Criteria1:=filter_val</code>. this has been corrected and now the code runs perfectly.</p>\n"}], "owner": {"reputation": 507, "user_id": 3609296, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/brXxR.jpg?s=128&g=1", "display_name": "squar_o", "link": "https://stackoverflow.com/users/3609296/squar-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 29120785, "answer_count": 1, "score": 0, "last_activity_date": 1426684167, "creation_date": 1426675528, "last_edit_date": 1426682019, "question_id": 29119929, "link": "https://stackoverflow.com/questions/29119929/vba-autofilter-returns-incomplete-list", "title": "VBA autofilter returns incomplete list", "body": "<p>I am trying to filter a sheet based on a cell value in another sheet. The corresponding value is a name in column h of my second sheet.</p>\n\n<p>At present It filters the data but only returns 1 row of data relating to the <code>filter_val</code> despite there being 9 rows of data.</p>\n\n<pre><code>   Sub filter_DMA_2()             '' will be set to the combobox when that's figured out\n\n    Dim filter_val As String\n    Dim filter_range As Range\n    Dim Lrow As Long\n\n    Set Billed_xls = Workbooks(\"Copy of SWR1304 (Future Development Risk Assessment) Strathaven.xls\").Sheets(\"Non Household Metered Users\")\n    With Billed_xls\n        Lrow = .Range(\"a\" &amp; Rows.count).End(xlUp).Row\n    End With\n    'Set filter_range = Billed_xls.Sheets(\"Non Household Metered Users\").Range(\"h:v\")\n    Set filter_range = Workbooks(\"Copy of SWR1304 (Future Development Risk Assessment) Strathaven.xls\").Sheets(\"Non Household Metered Users\").Range(\"a2:v2\" &amp; Lrow)\n    'End With\n\n    filter_val = Workbooks(\"DMA_metered_tool_v1.xlsm\").Worksheets(\"DMA list\").Range(\"a1\").Value\n\n    With filter_range\n        .AutoFilter\n        .AutoFilter Field:=5, Criteria1:=filter_val '.Value\n    End With\n\n    End Sub\n</code></pre>\n\n<p>Any idea how to fix this so it returns all 9 rows of data?</p>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "excel", "button", "copy"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426675163, "post_id": 29119685, "comment_id": 46466396, "body": "oh ok - sounds great.. so do I do that for each sub and just adjust the reference. But when I right clikc each of the thousand developer macro buttons will they show each sub to assign to it? Essentially I am looking to label each of the 1000 or 2000 subs it will be"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426675258, "post_id": 29119685, "comment_id": 46466455, "body": "@Jonwhite you need to index all your hardcoded rows (2,3,4 etc.) and put  the body of your macro in the For loop. Always save a copy of your workbook before to run a VBA code (not only a loop), because VBA changes are not reversible"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426675470, "post_id": 29119685, "comment_id": 46466613, "body": "ok sure I will definately save but I am not sure this will do  exactly what I want because I assume I need each sub named to reference them in a button. I want to run the sub at my discretion from a button but this is definately a start. :)"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426675702, "post_id": 29119685, "comment_id": 46466766, "body": "@Jonwhite could you please clarify a bit your question then? I think I misunderstood the part of &quot;each macro assigned to a button&quot;"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426675930, "post_id": 29119685, "comment_id": 46466937, "body": "sure - well I envisioned the only way was to have 1000 trade0001open() and 1000 trade001close() possibly defined as trade0001open() , trade0002open() etc ditto close etc etc in order to right click for each one on a vba developer for control button alligned to each cell AK4 for open button and AM4 for close button so AK8 and AM8 etc etc which is long winded again and Im refraining from assuming a developer button could be alligned to each of those cells frm within vba and assigned to each of the sub at the moment. I guess one workaround might be to configure the j somehow into the sub name .."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426676245, "post_id": 29119685, "comment_id": 46467139, "body": "It is possible, but you need some code re-design. What you ask is complex to answer here, i will give you a tip to get started: use always the same macro but intercept the reference of the cell from which the call starts in order to add dinamically the 4 rows as I showed you above. You don&#39;t need 2000 macros, only 2 that are readapting themselves depending on the caller parent."}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426676564, "post_id": 29119685, "comment_id": 46467355, "body": "ah I see so the button could call them based on something. Sounds difficult. I guess I could paste the vba buttons ( if they&#39;re the same or attached to a unique reference for each row) and take a shortcut in making them and alligning them in vba - can anyone suggest another forum or person to go to."}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426677221, "post_id": 29119685, "comment_id": 46467759, "body": "my conclusion to my original  question is that I&#39;d need a form button which has a sub macro which calls the trade0001open() and another for trade0001close(). And from those two sub&#39;s the other sub calling that sub can use a cell reference to call the part of the sub that contains that value of j AND the HA1 part. my mind is blown LOL"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426679184, "post_id": 29119685, "comment_id": 46468910, "body": "I could probably make a keyboard short cut to do this labour ( press down on keyboard 10 times etc etc then backspace then press 6 or 7 or 8 within vba editor) work a thousand times but it is still a pain in the ass to right click 2000 times assign macro"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1426674820, "creation_date": 1426674820, "answer_id": 29119685, "question_id": 29119489, "link": "https://stackoverflow.com/questions/29119489/how-to-write-thusands-of-sub-vba-code-quickly-changing-references/29119685#29119685", "title": "how to write thusands of sub vba code quickly changing references", "body": "<p>You just need to make every string dinamically redefined and loop 1000 times the same macro. This is an example to get started: </p>\n\n<pre><code>For j = 1 To 1000 '&lt;-- do this 1000 times\n    '...\n    Sheets(\"TRADEDIARY\").Range(\"AO\" &amp; 2 + (j-1)*4).Value = 1 '&lt;-- if j=1 then row = 2, if j=2 then row = 2+4 = 6 etc. \n    '...\nNext j\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427303190, "creation_date": 1426674313, "last_edit_date": 1531164843, "question_id": 29119489, "link": "https://stackoverflow.com/questions/29119489/how-to-write-thusands-of-sub-vba-code-quickly-changing-references", "title": "how to write thusands of sub vba code quickly changing references", "body": "<p>I want a module in my workbook to write about a thousand combinations of the below </p>\n\n<pre><code>Sub trade0001open()\nSheets(\"TRADEDIARY\").Range(\"AO2\").Value = 1\nSheets(\"TRADEDIARY\").Range(\"AD3\").Value = _\nSheets(\"TRADEDIARY\").Range(\"AJ2\").Value\nSheets(\"TRADEDIARY\").Range(\"AD4\").Value = _\nSheets(\"Sheet8\").Range(\"HA1\").Value + 1\nSheets(\"TRADEDIARY\").Range(\"AO3\").Value = 0\nEnd Sub\nSub trade0001close()\nApplication.ScreenUpdating = False\nSheets(\"TRADEDIARY\").Range(\"AI3\").Value = Sheets(\"TRADEDIARY\").Range(\"AI3\").Value + 1                                    \n\nSheets(\"TRADEDIARY\").Range(\"AO3\").Value = 1\nApplication.Wait (Now + 0.000001)\nSheets(\"TRADEDIARY\").Range(\"AO3\").Value = 0\nSheets(\"TRADEDIARY\").Range(\"AO2\").Value = 0\nSheets(\"TRADEDIARY\").Range(\"AI2\").Value = Sheets(\"TRADEDIARY\").Range(\"AI2\").Value + 1\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Changing changing the cell references by a cumulator of four rows down each time. So every AO2 would become AO6 in the next every AD3 becomes AD7. Everything apart from HA1 would change so that includes AO2,AD3,AJ2,AD4,AO3 for the first sub and then that includes AI3, AO3, AO2, AI2 for the second sub. </p>\n\n<p>So since my code above contains the two subs I'd like copied a thousand times - each copy will add 4 rows to each cel reference in each sub. </p>\n\n<p>I am quite new to vba so I guess I am after a similar autofill function like in excel except for my code to do this quickly instead of typing thousands of times unless of course I guess somebody could suggest how to do this differently. hint hint. bare in mind I obviously want all the values pasted without a clipboard so that when those values from where they are copied change, the destination doesn't change. Which is what my above code achieves. </p>\n\n<p>Then I'd like to asign each individual sub within each of the two separately to a developer button control in the spread sheet ( again asigned to change four rows down each time) </p>\n\n<p><strong>@matteo to clarify ''well I envisioned the only way was to have 1000 trade0001open() and 1000 trade001close() possibly defined as trade0001open() , trade0002open() etc ditto close etc etc in order to right click for each one on a vba developer for control button alligned to each cell AK4 for open button and AM4 for close button so AK8 and AM8 etc etc which is long winded again and Im refraining from assuming a developer button could be alligned to each of those cells frm within vba and assigned to each of the sub at the moment. I guess one workaround might be to configure the j somehow into the sub name .''</strong></p>\n\n<p><strong>matteo's reply: ''What you ask is complex to answer here, i will give you a tip to get started: use always the same macro but intercept the reference of the cell from which the call starts in order to add dinamically the 4 rows as I showed you above. You don't need 2000 macros, only 2 that are readapting themselves depending on the caller parent''</strong>\nme : ''so I guess this is more complicated than it seems if I could somehow make form button's alligned to cells to reference the j value within the 2 macros without need for making thousands of  sub macros. As far as I know form buttons in excel can only reference sub functions without reference and not UDFs or anything else or even cell references although I probably am wrong about this. ''</p>\n\n<p>a form button to call the sub based on a cell's reference that is what I need right?</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/843078-loop-visual-basic-applications-sub-call-form-button-each-nth-row-based-cell-value-row-reference.html#post4105072\" rel=\"nofollow noreferrer\">http://www.mrexcel.com/forum/excel-questions/843078-loop-visual-basic-applications-sub-call-form-button-each-nth-row-based-cell-value-row-reference.html#post4105072</a></p>\n\n<p>I don't know for the life of me where to begin <a href=\"https://stackoverflow.com/questions/15969796/trying-to-call-a-sub-with-a-string-vba\">Trying to call a Sub with a String - VBA</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1426674581, "post_id": 29119422, "comment_id": 46466056, "body": "I would guess that your combobox is directly linked to a range. That is not a good idea for precisely this reason. I suggest you use code to populate the control using its List property instead."}, {"owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426679748, "post_id": 29119422, "comment_id": 46469284, "body": "Cool, I&#39;ve replaced the named range for a AddItem procedure and the problem seems solved now. If you put this info in an answer I can mark this problem as solved. Thanks a lot for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1426680136, "creation_date": 1426680136, "answer_id": 29121542, "question_id": 29119422, "link": "https://stackoverflow.com/questions/29119422/vba-range-sort-script-unexpectedly-runs-other-script-it-shouldnt-run/29121542#29121542", "title": "VBA - range.sort script unexpectedly runs other script it shouldn&#39;t run", "body": "<p>I would guess that your combobox is directly linked to a range using the ListFillRange and/or LinkedCell properties. That is not a good idea for precisely this reason. I suggest you use code to populate the control using its <code>.List</code> property instead, which is easier and faster than <code>.AddItem</code>:</p>\n\n<pre><code>Sheets(\"Bestands\u00fcbersicht\").OLEObjects(\"ddBestand\").Object.List = Sheets(\"blah\").Range(\"A2:A100\").Value\n</code></pre>\n\n<p>for example.</p>\n"}], "owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 29121542, "answer_count": 1, "score": 0, "last_activity_date": 1426680136, "creation_date": 1426674095, "last_edit_date": 1531164843, "question_id": 29119422, "link": "https://stackoverflow.com/questions/29119422/vba-range-sort-script-unexpectedly-runs-other-script-it-shouldnt-run", "title": "VBA - range.sort script unexpectedly runs other script it shouldn&#39;t run", "body": "<p>I'm working on a workbook and I'm getting an error which is driving me crazy. I really have no idea what's going wrong here.</p>\n\n<p>On the main worksheet (Bestands\u00fcbersicht) I have a combobox named ddBestand. On the change event of that combobox it runs a script that checks if certain buttons should be enabled or disabled. The code for this is:</p>\n\n<pre><code>Private Sub ddBestand_Change()\n\n    On Error GoTo ExitSub\n    Dim i As Integer\n    i = 3\n    Dim WS As Worksheet\n    Set WS = Sheets(\"Bestands\u00fcbersicht\")\n\n    If ddBestand.Value = \"\" Then GoTo ExitSub\n\n    Do Until WS.Cells(i, 1).Value = ddBestand.Value\n        i = i + 1\n    Loop\n\n    If WS.Cells(i, 13).Value = 0 Or _\n    Right(Sheets(\"Bestands\u00fcbersicht\").Range(\"AL1\").Value, 3) &lt;&gt; \"yes\" Then\n        btnNetwork.Enabled = False\n    Else\n        btnNetwork.Enabled = True\n    End If\n\n    btnChange.Enabled = True\n    btnSpecifics.Enabled = True\n    btnCopy.Enabled = True\n\n    Exit Sub\n\nExitSub:\n    btnChange.Enabled = False\n    btnSpecifics.Enabled = False\n    btnNetwork.Enabled = False\n    btnCopy.Enabled = False\n\nEnd Sub\n</code></pre>\n\n<p>This works totally fine when I use ddBestand. But sometimes when I run other scripts this script unexpectedly starts to run, even though those scripts do not relate to eachother. For example, when I run the initialize even for a userform (which is launched from another worksheet) it starts to run at this range.sort method:</p>\n\n<pre><code>Sheets(\"DB_Network\").Columns(\"A:C\").Sort key1:=Sheets(\"DB_Network\").Range(\"A2\"), _\n    order1:=xlAscending, Header:=xlNo\n</code></pre>\n\n<p>it gives the error 1004 (Unable to set the Enabled propert of the OLEObject class (which is logica, because as we're on another worksheet, the property for those buttons is wrong). As I didn't know how to stop the first script from running, I fixed the script by changing the OLEObjects to this:</p>\n\n<pre><code>    Sheets(\"Bestands\u00fcbersicht\").OLEObjects(\"btnChange\").Object.Enabled = True\n</code></pre>\n\n<p>Solving the symptoms might not be the prettiest solution, but as I couldn't find out what the problem really was, I decided this was a suitable solution. But it got crazier. I'm still using another version of this document as I need it for my work. Somehow the same sort method started running the same script in the other document, which made the same error occur. Now I really want to solve this problem, as I don't want it to unexpectedly run scripts in other documents. Is there anybody out here who can help? Would be much appreciated!</p>\n"}, {"tags": ["vba", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3420865, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6157e3b203d1d5b7cd3c0e1f7b7f0998?s=128&d=identicon&r=PG&f=1", "display_name": "StackUser2014", "link": "https://stackoverflow.com/users/3420865/stackuser2014"}, "edited": false, "score": 0, "creation_date": 1426695330, "post_id": 29125157, "comment_id": 46480370, "body": "Thank you for your response. I am not looking to go through all the subfolders just the top level of folders. There are well over 10,000 folders and files all together within these 100 top level folders"}], "tags": [], "owner": {"reputation": 303, "user_id": 4615693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2e0587b4fcc5c12de197cd0bcb9b73a?s=128&d=identicon&r=PG", "display_name": "Bagger", "link": "https://stackoverflow.com/users/4615693/bagger"}, "is_accepted": false, "score": 1, "last_activity_date": 1426690046, "creation_date": 1426690046, "answer_id": 29125157, "question_id": 29119118, "link": "https://stackoverflow.com/questions/29119118/read-a-csv-file-and-list-of-folders-and-then-compare-in-vb/29125157#29125157", "title": "Read a CSV file and list of folders and then compare in VB", "body": "<p>Run this script to get a base line, it wil create a spreadsheet of the folders files and properties,  Then runt it again copy the sheet in to the baseline work bbok and do a vlookup.  You could also use this as a base line to create a csv and compare the it that way.  Not exactly waht you are looking for but it is a workable solution</p>\n\n<pre><code>  Const ForReading = 1, ForWriting = 2, Forappending = 8   \n 'Option Explicit\n 'DIM Objects\n\n\n 'Dim variabbles\n Dim folderspec\n 'Dim \n\n DIM arrBlk(3) \n DIM arrFLN(3) \n DIM arrInfo(3)\n Set objXL = Wscript.CreateObject(\"Excel.Application\")\n Set ofso = CreateObject(\"Scripting.FileSystemObject\")\n\n\n\n folderspec = InputBox(\"Please enter the path\", \"FileList\", \" \") \n            If folderspec  = \"\"  Then \n              ' if cancel is selected quit the program\n               wscript.quit\n            ElseIf  folderspec  = \" \"  Then\n               ' if nothing is entered give a warning message ang quit the program  \n                 msgbox \"No Directory has been seleted \" &amp; vbCrLf \n                  wscript.quit\n            End If\n\n intRow = 2\n buildsheet() 'Build the XLS spreadsheet\n\n 'folderspec =\"C:\\_epas_5.0\\Web_Server\\ASP\"\n 'folderspec =\"C:\\_epas_5.0\\Web_Server\\COM+ Source\"\n\n strFldrCmp = folderspec\n Set root = ofso.GetFolder(folderspec)\n\n ShowFileList(root)\n For Each oFolder in root.subfolders\n   walkfolder oFolder\n Next\n\n Sub walkfolder(f)\n  ShowFileList(f)\n   For Each sf in f.subfolders\n       walkfolder sf\n   Next\n End Sub\n\n Function ShowFileList(folderspec)\n    Dim oFolder\n    Dim oFiles\n    Dim oFile\n\n    Set oFolder = ofso.GetFolder(folderspec)\n   ' Wscript.echo oFolder.name\n    Set oFiles = oFolder.Files\n   ' If  IsEmpty(oFiles) Then Wscript.echo oFolder.name\n 'i = 0   \n   For Each oFile in oFiles\n    i = 1 + i\n    'If i &lt; 1 Then\n    'Wscript.echo oFolder.name,i\n 'End If\n   Next \n   If i &lt; 1 Then \n\n    Wscript.echo  oFolder.name &amp; \" Null\"\n    ReDim arrB(3)\n    'strPath = Replace(oFolder.path,strFldrCmp,\"\", 1 ,1 ,vbTextCompare)\n        arrB(0) = \"\\\" &amp; Trim(oFolder.Name) 'oFolder.path\n        arrB(1) = \"\"\n        arrB(2) =  \"\"\n        arrB(3) = \"\"\n        AddLineToXLS(arrB)\n   End If     \n\n    For Each oFile in oFiles\n      ReDim arrB(3)\n      srtfldr = oFolder.path\n     ' MsgBox srtfldr&amp; \" \" &amp; strFldrCmp\n 'strPath = Replace(srtfldr,strFldrCmp,\"\", 1 ,1 ,vbTextCompare)\n strPath = Replace(oFolder.path,strFldrCmp,\"\", 1 ,1 ,vbTextCompare)\n 'strPath = Replace(\"C:\\_5Test\\Web_Server\\ASP\\app\\admin\",\"C:\\_5Test\\Web_Server\\ASP\",\"\",,,vbTestCompare)\n        arrB(0) = Trim(strPath) 'oFolder.path\n        arrB(1) = Trim(oFile.name)\n        arrB(2) =  Trim(oFile.Size)\n        arrB(3) = Trim(oFile.DateLastModified)\n           If   LCase(ofso.GetExtensionName(oFile)) &lt;&gt; \"scc\" Then 'skip VSS .scc files\n             AddLineToXLS(arrB)\n           End If\n    Next\n End Function\n\n\n\n Function buildsheet\n  intRow = 1\n       objXL.Visible = True\n       objXL.WorkBooks.Add\n\n     '** Set Row Height\n          objXL.Rows(1).RowHeight = 17\n\n     '** Set Column widths\n          objXL.Columns(1).ColumnWidth = 40.14\n          objXL.Columns(2).ColumnWidth = 33.14\n          objXL.Columns(3).ColumnWidth = 15\n          objXL.Columns(4).ColumnWidth = 23\n          objXL.Columns(5).ColumnWidth = 23\n          objXL.Columns(6).ColumnWidth = 23\n\n\n     '** Set Cell Format for Column Titles ***\n          objXL.Range(\"A1:F1\").Select\n             objXL.Selection.Font.Bold = True\n            ' objXL.Selection.Font.Size = 8\n             objXL.Selection.Interior.ColorIndex = 15\n             objXL.Selection.Interior.Pattern = 1      'xlSolid\n             objXL.Selection.Font.ColorIndex = 1\n             objXL.Selection.WrapText = True\n          objXL.Columns(\"A:T\").Select\n          objXL.Columns.Font.Size = 8\n             objXL.Selection.HorizontalAlignment = 1     'xlCenter\n          objXL.Columns(\"C:C\").Select\n             objXL.Selection.NumberFormat = \"#,###0\"\n          objXL.Columns(\"D:D\").Select\n             objXL.Selection.NumberFormat = \"m/d/yy h:mm AM/PM\"\n\n     '*** Set Column Titles ***\n       Dim arrA(3)\n         arrA(0)= \"File Path\"\n         arrA(1) = \"File Name\"\n         arrA(2) = \"Size(bytes)\"\n         arrA(3) = \"Modified Date/Time\"\n\n\n         AddLineToXLS(arrA)\n\n End Function\n\n Function AddLineToXLS(r)' Writes a line to the spreadsheet  recieves an array as input\n\n      objXL.Cells(intRow, 1).Value = r(0)\n      objXL.Cells(intRow, 2).Value = r(1)\n      objXL.Cells(intRow, 3).Value = r(2)\n      objXL.Cells(intRow, 4).Value = r(3)\n     ' MsgBox r(3)\n     'objXL.Cells(intRow, 5).Value = r(4)\n     'objXL.Cells(intRow, 6).Value = r(5)\n    ' objXL.Cells(intRow, 4).Value = r(3)\n\n      intRow = intRow + 1\n      objXL.Cells(1, 1).Select\n\n End Function\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3420865, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6157e3b203d1d5b7cd3c0e1f7b7f0998?s=128&d=identicon&r=PG&f=1", "display_name": "StackUser2014", "link": "https://stackoverflow.com/users/3420865/stackuser2014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426690046, "creation_date": 1426673174, "question_id": 29119118, "link": "https://stackoverflow.com/questions/29119118/read-a-csv-file-and-list-of-folders-and-then-compare-in-vb", "title": "Read a CSV file and list of folders and then compare in VB", "body": "<p>What I am trying to achieve is I currently have a (main) folder filled with many Sub-folders and these sometimes get drag &amp; dropped into another Sub-folder by accident.</p>\n\n<p>I have an CSV file containing all the names of the current (main) folder list as it should stand and I want to check this against the current version of Sub-folders found in the (main) folder and output a message box with the results of matching files and missing files.</p>\n\n<p>This is the code I have got so far although I am unsure how to check the list of      folders against the CSV file.</p>\n\n<p>Read data from an CSV file.</p>\n\n<pre><code>'Holds Data from CSV file\nDim arrValue As String()\n'create a new TextFieldParser and opens the file\nUsing MyReader As New Microsoft.VisualBasic.FileIO.TextFieldParser(\"C:\\Users\\USERNAME\\Dropbox (Personal)\\IT\\jobs.csv\")\n\n'Define the TextField type and delimiter\nMyReader.TextFieldType = FileIO.FieldType.Delimited\nMyReader.SetDelimiters(\",\")\n\nWhile Not MyReader.EndOfData\n    Dim arrCurrentRow As String() = MyReader.ReadFields()\n            If arrValue Is Nothing Then\n                ReDim Preserve arrValue(0)\n                arrValue(0) = arrCurrentRow(0)\n            Else\n                ReDim Preserve arrValue(arrValue.Length)\n                arrValue((arrValue.Length - 1)) = arrCurrentRow(0)\n            End If\nEnd While\n</code></pre>\n\n<p>Read list of folders</p>\n\n<pre><code>    'check against the Clients folder\n    Set w = WScript.CreateObject(\"WScript.Shell\")\n    w.Popup ShowFolders(\"C:\\Users\\USERNAME\\Dropbox (Innovation PS)\\Clients\")\n    Function ShowFolders(folderName)\n\n    'Setting Variables\n    Dim fs, f, f1, fc, s\n\n    'holds folder name\n    s = \"\"\n\n    'Obtain folder Object\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Set f = fs.GetFolder(folderName)\n\n    'Obtain SubFolders collection within folder\n    Set fc = f.SubFolders\n\n    'Examine each item in the collection\n    For Each f1 in fc\n    s = s &amp; f1.name\n    s = s &amp; (Chr(13) &amp; Chr(10)) ' Chr(13) &amp; Chr(10) = Carriage return\u2013linefeed combination\n    Next\n    ShowFolders = s\n    End Function\n    'See if it matches the .CSV file\n</code></pre>\n\n<p>Thank you in advance. (Also if you could include comments it would be appreciated) </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 2, "creation_date": 1426675136, "post_id": 29118972, "comment_id": 46466376, "body": "You cannot use <code>end</code> as variable name, it&#39;s a reserved word of the compiler. Apart for this, you only need to define the variable as <code>Date</code> rather than string, and make a simple comparison such as <code>day1 &lt; yourDate</code> (will return true or false)"}], "answers": [{"tags": [], "owner": {"reputation": 747, "user_id": 1971371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8917db5e4763fa26534330a0e5710c9e?s=128&d=identicon&r=PG", "display_name": "Benny", "link": "https://stackoverflow.com/users/1971371/benny"}, "is_accepted": false, "score": 3, "last_activity_date": 1426676269, "creation_date": 1426676269, "answer_id": 29120182, "question_id": 29118972, "link": "https://stackoverflow.com/questions/29118972/check-if-a-date-is-between-2-dates-in-vba/29120182#29120182", "title": "Check if a date is between 2 dates in vba", "body": "<pre><code>Function BetweenDates(startDate As String, endDate As String, testDate As String) As Boolean\n    BetweenDates = IIf(CDate(testDate) &gt; CDate(startDate) And CDate(testDate) &lt;= CDate(endDate), True, False)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6458, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426676269, "creation_date": 1426672767, "last_edit_date": 1531164843, "question_id": 29118972, "link": "https://stackoverflow.com/questions/29118972/check-if-a-date-is-between-2-dates-in-vba", "title": "Check if a date is between 2 dates in vba", "body": "<p>I have 4 strings values:</p>\n\n<pre><code>Dim start As String,end As String,day1 As String,day2 As String\nstart=\"15/01/2015\"\nend=\"25/03/2015\"\nday1=\"20/02/2015\"\nday2=\"18/04/2015\"\n</code></pre>\n\n<p>I would like to have a function which test if a day(day1 or day2) is between 2 dates(start and end), for example, it returns me true for day1, and false for day2.</p>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 35, "user_id": 4664667, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/985f5d026e249c93d6e3623a209dc891?s=128&d=identicon&r=PG&f=1", "display_name": "jumbli", "link": "https://stackoverflow.com/users/4664667/jumbli"}, "edited": false, "score": 0, "creation_date": 1426681876, "post_id": 29118693, "comment_id": 46470593, "body": "Thank you. One more question if I have an ifstatmen like this    =IF( A1=B1&quot;OK&quot;;&quot;NOT OK&quot;)  And i also want it to return blank cell if A1 or B1 is empty how do I do it?"}], "answers": [{"tags": [], "owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "is_accepted": false, "score": 0, "last_activity_date": 1426672742, "creation_date": 1426672742, "answer_id": 29118962, "question_id": 29118693, "link": "https://stackoverflow.com/questions/29118693/copy-from-another-workbook/29118962#29118962", "title": "Copy from another workbook", "body": "<p>You can use the <code>VLOOKUP()</code> function for this. Add this formula to the cell in column C and pull it down. Just alter the ranges and names to your exact situation.</p>\n\n<pre><code>=VLOOKUP(B4;[Book2]Sheet1!$A$1:$B$3;2;0)\n</code></pre>\n\n<p>I also have an extra formula that will display nothing if the name isn't found. Otherwise it will display #N/A.</p>\n\n<pre><code>=IFERROR(VLOOKUP(B4;[Book3]Sheet1!$A$1:$B$3;2;0);\"\")\n</code></pre>\n\n<p><strong>EXTRA</strong>: depending on your country settings it's possible you need to change <code>;</code> for <code>,</code></p>\n"}], "owner": {"reputation": 35, "user_id": 4664667, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/985f5d026e249c93d6e3623a209dc891?s=128&d=identicon&r=PG&f=1", "display_name": "jumbli", "link": "https://stackoverflow.com/users/4664667/jumbli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1426672742, "creation_date": 1426671962, "question_id": 29118693, "link": "https://stackoverflow.com/questions/29118693/copy-from-another-workbook", "title": "Copy from another workbook", "body": "<p>I'm very new to excel therefore I have a lot of questions. </p>\n\n<p>I have two workbooks I need to work with. I have a workbook with different names and other information. Each name matches another name in a different workbook. \nWb1:</p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 A \u2551    B       \u2551\n\u2560\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 1 \u2551 Name1      \u2551\n\u2551 2 \u2551 Name2      \u2551\n\u2551 3 \u2551 Name3      \u2551\n\u255a\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre>\n\n<p>Wb2</p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 A     \u2551    B       \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Name1 \u2551 Name5      \u2551\n\u2551 Name2 \u2551 Name6      \u2551\n\u2551 Name3 \u2551 Name7      \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre>\n\n<p>I want the code to loop through workbook 2, and if it finds for example \"Name 1\" it should copy \"Name5\" from columb B into workbook1 Column c. </p>\n"}, {"tags": ["excel", "httpwebrequest", "http-proxy", "winhttp", "vba"], "owner": {"reputation": 93, "user_id": 4450876, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8bb6627537711f2a79258a3864bbf287?s=128&d=identicon&r=PG&f=1", "display_name": "Amelie Peter", "link": "https://stackoverflow.com/users/4450876/amelie-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 752, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1426670790, "creation_date": 1426670790, "last_edit_date": 1531161705, "question_id": 29118226, "link": "https://stackoverflow.com/questions/29118226/vba-winhttp-auto-detect-proxy-settings", "title": "VBA WinHTTP Auto detect proxy settings", "body": "<p>I am trying to send request to a web service from behind a proxy server in excel vba. How can i make my code auto detect proxy settings? </p>\n\n<pre><code>Url = \"www.example.com\"\n\nSet WHTTP = CreateObject(\"WinHTTP.WinHTTPrequest.5.1\")\n\nWHTTP.Open \"GET\", Url, False\n\nWHTTP.Send\n\nMsgBox WHTTP.Status\nMsgBox WHTTP.ResponseText\nMsgBox WHTTP.ResponseBody\nMsgBox WHTTP.GetAllResponseHeaders\n\nSet WHTTP = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "database", "vba"], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 1138750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0qbav.jpg?s=128&g=1", "display_name": "Helmut Hackl", "link": "https://stackoverflow.com/users/1138750/helmut-hackl"}, "is_accepted": false, "score": 0, "last_activity_date": 1426670297, "creation_date": 1426670297, "answer_id": 29118038, "question_id": 29117984, "link": "https://stackoverflow.com/questions/29117984/replacing-data-in-database/29118038#29118038", "title": "Replacing data in database", "body": "<p>Not sure if I fully understand your question, but to replace data you need a key for each row in your sheet.</p>\n\n<p>Than you should </p>\n\n<pre><code>UPDATE &lt;target_table&gt; SET column1 = value1_from_sheet \nWHERE key = key_col_from_sheet\n</code></pre>\n\n<p>REPLACE is a string function in TSQL and you can not use it to replace rows in a table. It is useful to replace some chars inside a string.</p>\n\n<pre><code>DECLARE @string nvarchar(50);\nSET @string = \"someValue\";\n\nSELECT REPLACE(@string,'Va','XX') =&gt; 'someXXlue'\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4684409, "user_type": "registered", "profile_image": "https://graph.facebook.com/722762825877/picture?type=large", "display_name": "rayray", "link": "https://stackoverflow.com/users/4684409/rayray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1426670309, "creation_date": 1426670097, "last_edit_date": 1426670309, "question_id": 29117984, "link": "https://stackoverflow.com/questions/29117984/replacing-data-in-database", "title": "Replacing data in database", "body": "<p>I get a sheet of data that gets updated values daily, I am trying to write the updated data daily into the database to replace the data from the previous day. The database is Mysql. Also is it possible to use the replace function to do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1426669997, "post_id": 29117667, "comment_id": 46463361, "body": "<code>=INDIRECT(E1)</code> will return the value in A1 if E1 contains the text &#39;A1&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 40, "user_id": 3952630, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/56c03a6ca7cf5183653132c118cf40a6?s=128&d=identicon&r=PG&f=1", "display_name": "branden", "link": "https://stackoverflow.com/users/3952630/branden"}, "is_accepted": false, "score": 1, "last_activity_date": 1426686551, "creation_date": 1426686551, "answer_id": 29123861, "question_id": 29117667, "link": "https://stackoverflow.com/questions/29117667/call-a-cell-by-using-a-value-in-another-cell/29123861#29123861", "title": "Call a cell by using a value in another cell", "body": "<p>Using the function: <code>=Indirect([cell])</code> will give you the value in the [cell]. For example, if cell Z1 has the function <code>=Indirect(E1)</code>, and E1 has the value A1, will give you the value of A1 in Z1. Then if E1 changes to, say, A2, then cell Z1 will contain the value from A2. </p>\n"}], "owner": {"reputation": 11, "user_id": 4684179, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153219358669809/picture?type=large", "display_name": "andy88", "link": "https://stackoverflow.com/users/4684179/andy88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6288, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426686551, "creation_date": 1426669082, "last_edit_date": 1426675964, "question_id": 29117667, "link": "https://stackoverflow.com/questions/29117667/call-a-cell-by-using-a-value-in-another-cell", "title": "Call a cell by using a value in another cell", "body": "<p>I am trying to call a simple cell (Eg: =a1) in Excel. However this \"a1\" is available in another cell, let's say in cell 'e1'.  </p>\n\n<p>In another way, what I mean is e1 cell has the value \"a1\" in it and for that reason alone I want to call a1. Finally will in turn populate the value that is actually in a1.</p>\n\n<p>I need to do this is because the cell no. that needs to be populated is retrieved from a formula in e1. That is how the cell a1 comes into the picture.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 537, "user_id": 2807403, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4c84f335bf17c2348e20699ef3f8ba58?s=128&d=identicon&r=PG&f=1", "display_name": "OWSam", "link": "https://stackoverflow.com/users/2807403/owsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1426672595, "creation_date": 1426672595, "answer_id": 29118911, "question_id": 29117631, "link": "https://stackoverflow.com/questions/29117631/looping-sheets-and-refreshing-queries/29118911#29118911", "title": "Looping Sheets and Refreshing Queries", "body": "<p>I have now solved this, by forcing a Do While to delay the code execution for 1 second.\nI think 2013 is executing the code so fast, that it's trying to execute the next line before it's completed what it was doing on screen.</p>\n\n<pre><code>Sub Refresh()\nRefreshQueries\nMsgBox \"Queries Refreshed\"\n\n\nEnd Sub\n\n\n\nSub RefreshQueries()\n\n\n\n\nDim tbl As ListObject\nDim DispatchTarget As String\nDim RepTargets As String\nDim DispatchesSql As String\nDim SalesGPSql As String\nDim RepvTargetSql As String\nDim x As Long\nDim Y As Integer\n\nSet tbl = Sheets(\"Targets\").ListObjects(\"tblMonthlyTargets\")\n\nFor x = 2 To tbl.ListRows.Count + 1\n    If x = tbl.ListRows.Count + 1 Then\n    RepTargets = RepTargets &amp; \"('\" &amp; tbl.Range(x, 1).Value &amp; \"', '\" &amp; tbl.Range(x, 2).Value &amp; \"', '\" &amp; tbl.Range(x, 3) &amp; \"') \"\n    Else\n    RepTargets = RepTargets &amp; \"('\" &amp; tbl.Range(x, 1).Value &amp; \"', '\" &amp; tbl.Range(x, 2).Value &amp; \"', '\" &amp; tbl.Range(x, 3) &amp; \"'), \"\n    End If\nNext x\n\n\nSet tbl = Sheets(\"Targets\").ListObjects(\"tblDespTarget\")\n DispatchTarget = tbl.Range(2, 1).Value\n\nSet tbl = Sheets(\"Targets\").ListObjects(\"tblMonthlyTargets\")\nMonthTarget = tbl.Range(Month(Date) + 1, 2).Value\n\n\n\n' Sets Dispatches Summary Sql\nDispatchesSql = _\n\"Select sum(isnull(((delivery_line_item.dli_qty*(order_line_item.oli_total_margin/order_line_item.oli_qty_required))/order_line_item.oli_price_per),0)) as TotalValue, \" &amp; _\nDispatchTarget &amp; \" as 'Target', \" &amp; _\n\"case WHEN \" &amp; DispatchTarget &amp; \" -sum(isnull(((delivery_line_item.dli_qty*(order_line_item.oli_total_margin/order_line_item.oli_qty_required))/order_line_item.oli_price_per),0)) &gt; 0  \" &amp; _\n\"THEN \" &amp; DispatchTarget &amp; \" -sum(isnull(((delivery_line_item.dli_qty*(order_line_item.oli_total_margin/order_line_item.oli_qty_required))/order_line_item.oli_price_per),0)) \" &amp; _\n\"Else 0.00 End as 'Remainder' \" &amp; _\n\"from delivery_header \" &amp; _\n\"join delivery_line_item on delivery_line_item.dli_dh_id = delivery_header.dh_id \" &amp; _\n\"join order_line_item on order_line_item.oli_id = delivery_line_item.dli_oli_id \" &amp; _\n\"where  dateadd(day,datediff(day,0,delivery_header.dh_datetime),0) = dateadd(day,datediff(day,0,getdate()),0) \"\n\n\n\n' Sets Sales GP SQL\nSalesGPSql = _\n\"Select sum(order_header_total.oht_net) as 'TotalNet', \" &amp; _\n\"sum(order_header_total.oht_total_margin) as 'TotalGP' \" &amp; _\n\"from order_header \" &amp; _\n\"join order_header_total on order_header_total.oht_oh_id = order_header.oh_id \" &amp; _\n\"where order_header.oh_sot_id = 1 \" &amp; _\n\"and dateadd(day,datediff(day,0,order_header.oh_datetime),0) = dateadd(day,datediff(day,0,getdate()),0) \"\n\n\n\n' Sets Rep v Target SQL\n\nRepvTargetSql = _\n\"With SalesPeople as (select X.Person, X.Month, X.Target From (Values    \" &amp; _\nRepTargets &amp; _\n\") as X (Person, Month, Target))   \" &amp; _\n\"SELECT user_detail.ud_username,  \" &amp; _\n\"isnull(TodaysTotal.Net, 0) AS 'Net Total ',  \" &amp; _\n\"CASE WHEN WorkingDaysLeft.DaysLeft = 0 THEN SalesPeople.Target - isnull(MonthTotals.Net, 0) ELSE (SalesPeople.Target - isnull(MonthTotals.Net, 0)) / WorkingDaysLeft.DaysLeft END AS 'Target',  \" &amp; _\n\"CASE WHEN (CASE WHEN WorkingDaysLeft.DaysLeft = 0 THEN SalesPeople.Target - isnull(MonthTotals.Net, 0) ELSE (SalesPeople.Target - isnull(MonthTotals.Net, 0)) / WorkingDaysLeft.DaysLeft END) - isnull(TodaysTotal.Net, 0) &lt; = 0  \" &amp; _\n\"THEN 0 ELSE (CASE WHEN WorkingDaysLeft.DaysLeft = 0 THEN SalesPeople.Target - isnull(MonthTotals.Net, 0) ELSE (SalesPeople.Target - isnull(MonthTotals.Net, 0)) / WorkingDaysLeft.DaysLeft END) - isnull(TodaysTotal.Net, 0) END AS 'Remaining' \"\nRepvTargetSql = RepvTargetSql &amp; _\n\"FROM user_detail \" &amp; _\n\"LEFT JOIN ( \" &amp; _\n    \"SELECT user_detail.ud_id, sum(order_header_total.oht_total_margin) AS Net \" &amp; _\n    \"FROM order_header \" &amp; _\n    \"JOIN order_header_total ON order_header_total.oht_oh_id = order_header.oh_id \" &amp; _\n    \"JOIN order_header_detail ON order_header_detail.ohd_oh_id = order_header.oh_id \" &amp; _\n    \"JOIN user_detail ON user_detail.ud_id = order_header_detail.ohd_sales_rep \" &amp; _\n    \"WHERE dateadd(day, datediff(day, 0, order_header.oh_datetime), 0) = dateadd(day, datediff(day, 0, getdate()), 0) AND order_header.oh_sot_id = 1 \" &amp; _\n    \"GROUP BY user_detail.ud_id ) AS TodaysTotal ON TodaysTotal.ud_id = user_detail.ud_id \" &amp; _\n\"LEFT JOIN ( \" &amp; _\n    \"SELECT user_detail.ud_id, sum(order_header_total.oht_total_margin) AS Net \" &amp; _\n    \"FROM order_header \" &amp; _\n    \"JOIN order_header_total ON order_header_total.oht_oh_id = order_header.oh_id \" &amp; _\n    \"JOIN order_header_detail ON order_header_detail.ohd_oh_id = order_header.oh_id \" &amp; _\n    \"JOIN user_detail ON user_detail.ud_id = order_header_detail.ohd_sales_rep \" &amp; _\n    \"WHERE dateadd(day, datediff(day, 0, order_header.oh_datetime), 0) = dateadd(day, datediff(day, 0, getdate()), 0) AND order_header.oh_sot_id = 1 \" &amp; _\n    \"GROUP BY user_detail.ud_id \" &amp; _\n    \") AS MonthTotals ON MonthTotals.ud_id = user_detail.ud_id \" &amp; _\n\"JOIN (SELECT (DATEDIFF(dd, getdate(), dateadd(day, - 1, dateadd(month, datediff(month, 0, getdate()) + 1, 0))) + 1) - (DATEDIFF(wk, getdate(), dateadd(day, - 1, dateadd(month, datediff(month, 0, getdate()) + 1, 0))) * 2) -  \" &amp; _\n    \"(CASE WHEN DATENAME(dw, getdate()) = 'Sunday' THEN 1 ELSE 0 END) - (CASE WHEN DATENAME(dw, dateadd(day, - 1, dateadd(month, datediff(month, 0, getdate()) + 1, 0))) = 'Saturday' THEN 1 ELSE 0 END) AS DaysLeft \" &amp; _\n    \") AS WorkingDaysLeft ON 1 = 1 \" &amp; _\n\"JOIN SalesPeople on SalesPeople.Person = ud_username and SalesPeople.Month = datename(month,getdate()) \" &amp; _\n\"WHERE user_detail.ud_active = 1 \" &amp; _\n\"ORDER BY user_detail.ud_username \"\n\n' Debug.Print DispatchesSql\n\n With ActiveWorkbook.Connections(\"qryDespatches\").ODBCConnection\n    .BackgroundQuery = False\n    .CommandText = DispatchesSql\n    .Refresh\nEnd With\n\nWith ActiveWorkbook.Connections(\"qrySalesGPToday\").ODBCConnection\n    .BackgroundQuery = False\n    .CommandText = SalesGPSql\n    .Refresh\nEnd With\n\nWith ActiveWorkbook.Connections(\"qryRepDaily\").ODBCConnection\n    .BackgroundQuery = False\n    .CommandText = RepvTargetSql\n    .Refresh\nEnd With\n\n\nWith ActiveWorkbook.Connections(\"qryDespPicksOpenOrders\").ODBCConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\n\n\nEnd Sub\n\n\n\n\n\n\nSub AutoLoad()\nDim tbl As ListObject\nDim LoopTime As String\nDim Start As Single\n\nSet tbl = Sheets(\"Targets\").ListObjects(\"tblTime\")\n LoopTime = tbl.Range(2, 1).Value\n\nLoopTime = Sheets(\"Targets\").Range(\"J2\").Value\n\nDim i As Long\n\nOn Error GoTo err_handler\nApplication.EnableCancelKey = xlErrorHandler\nApplication.ScreenUpdating = True\n\n'sets Sql statements for today in queries\nRefreshQueries\n\n'Refresh Despatch ready for screen showing\nStart = Timer\n'wait 1 sec...\nDo While Start + 1 &gt; Timer\n    DoEvents\nLoop\nRefreshDespatch\n\n\nDo Until 1 = 2\n\nApplication.ScreenUpdating = True\n\n'Loads up Daily Dispatch Figures worksheet\nSheets(\"Daily Dispatch Figures\").Select\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nRange(\"A1:C36\").Select\nActiveWindow.Zoom = True\nRange(\"A1\").Select\nActiveSheet.ChartObjects(\"DailyDespatchChart\").Activate\n\n\n'Refreshes Sales ready for next screen\nStart = Timer\n'wait 1 sec...\nDo While Start + 1 &gt; Timer\n    DoEvents\nLoop\nRefreshSales\n\n\n\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + LoopTime\nWaittime = TimeSerial(newHour, newMinute, newSecond)\n\n\nApplication.Wait Waittime\n\n\n'Loads up \"Sales &amp; GP Today\" worksheet\n\nSheets(\"Sales &amp; GP Today\").Select\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nRange(\"A1:B35\").Select\nActiveWindow.Zoom = True\nRange(\"A1\").Select\nActiveSheet.ChartObjects(\"SalesGPTodayChart\").Activate\n\n'Refresh Daily ready for next screen\nStart = Timer\n'wait 1 sec...\nDo While Start + 1 &gt; Timer\n    DoEvents\nLoop\nRefreshDaily\n\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + LoopTime\nWaittime = TimeSerial(newHour, newMinute, newSecond)\n\nApplication.Wait Waittime\n\n\n\n'Loads up Rep Daily Targets worksheet\n\nSheets(\"Rep Daily Targets\").Select\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nRange(\"A1:B36\").Select\nActiveWindow.Zoom = True\nRange(\"A1\").Select\nActiveSheet.ChartObjects(\"RepDailyChart\").Activate\n\n'Refreshes Live ready for next screen\nStart = Timer\n'wait 1 sec...\nDo While Start + 1 &gt; Timer\n    DoEvents\nLoop\nRefreshLive\n\n\n\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + LoopTime\nWaittime = TimeSerial(newHour, newMinute, newSecond)\n\nApplication.Wait Waittime\n\n\n'Loads up Live Summary worksheet\n\nSheets(\"Live Summary\").Select\nRange(\"A1\").Select\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nRange(\"A1:B4\").Select\nActiveWindow.Zoom = True\nRange(\"A1\").Select\n\n'Refreshes Despatch ready for next screen\nStart = Timer\n'wait 1 sec...\nDo While Start + 1 &gt; Timer\n    DoEvents\nLoop\nRefreshDespatch\n\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + LoopTime\nWaittime = TimeSerial(newHour, newMinute, newSecond)\n\nApplication.Wait Waittime\n\n\n\nLoop\n\n\nerr_handler:\n    If Err.Number = 18 Then\n        EndReport\n        MsgBox \"Report Cancelled\"\n    End If\n\n\nEnd Sub\n\nSub RefreshDespatch()\nWith ActiveWorkbook.Connections(\"qryDespatches\").ODBCConnection\n  .BackgroundQuery = False\n  .Refresh\nEnd With\n\nEnd Sub\n\nSub RefreshSales()\nWith ActiveWorkbook.Connections(\"qrySalesGPToday\").ODBCConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\nEnd Sub\n\nSub RefreshDaily()\nWith ActiveWorkbook.Connections(\"qryRepDaily\").ODBCConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\nEnd Sub\n\nSub RefreshLive()\n\nWith ActiveWorkbook.Connections(\"qryDespPicksOpenOrders\").ODBCConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\nEnd Sub\n\n\nSub EndReport()\n\nApplication.DisplayFullScreen = False\nActiveWindow.DisplayHeadings = True\nApplication.DisplayFormulaBar = True\nApplication.ScreenUpdating = True\nActiveWindow.Zoom = 100\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 2807403, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4c84f335bf17c2348e20699ef3f8ba58?s=128&d=identicon&r=PG&f=1", "display_name": "OWSam", "link": "https://stackoverflow.com/users/2807403/owsam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426675992, "creation_date": 1426668953, "last_edit_date": 1426675992, "question_id": 29117631, "link": "https://stackoverflow.com/questions/29117631/looping-sheets-and-refreshing-queries", "title": "Looping Sheets and Refreshing Queries", "body": "<p>I'm struggling with this, and not sure how to go forward.\nI have a workbook which has 4 \"Display\" sheets.\nThese have data and charts, and are to be shown on a large screen with stats and figures.</p>\n\n<p>The data is database linked queries, which need to refresh throughout the day.\nThe worksheets need to continuously loop around throughout the day.</p>\n\n<p>My code below is the entire code as I thought it would be easier to see the whole picture.</p>\n\n<p>If I step through AutoLoad, it works exactly as I want. It refreshes the query, then loads the worksheet for 5 seconds (as input in J2).</p>\n\n<p>If I execute the code, it loads the first worksheet (\"Daily Dispatch Figures\"), but the chart appears completely black.\nAfter 5 seconds, the 2nd worksheet loads (\"Sales &amp; GP Today\"), but again the chart is completely black.</p>\n\n<p>After this, it never shows anything else on screen. It permanently stays stuck on the \"Sales &amp; GP Today\" worksheet.</p>\n\n<p>If I hit ESC, the code exits, and the worksheet at the point in the loop I broke on is shown, so the code is running in the background.</p>\n\n<p>I have previously tried setting the queries to auto refresh every 1 minute and not even touching the refresh in VBA, but this appears to be ignored whilst any \"looping\" code is running, and only refresh once I stop the code, so whilst the looping worked (using exactly the same methodology as below), the data wasn't updating.</p>\n\n<p>This is Excel 2013.</p>\n\n<pre><code>Sub Refresh()\nRefreshQueries\nMsgBox \"Queries Refreshed\"\n\nEnd Sub\n\n\n\nSub RefreshQueries()\nDim tbl As ListObject\nDim DispatchTarget As String\nDim RepTargets As String\nDim DispatchesSql As String\nDim SalesGPSql As String\nDim RepvTargetSql As String\nDim x As Long\nDim Y As Integer\n\nSet tbl = Sheets(\"Targets\").ListObjects(\"tblMonthlyTargets\")\n\nFor x = 2 To tbl.ListRows.Count + 1\n    If x = tbl.ListRows.Count + 1 Then\n    RepTargets = RepTargets &amp; \"('\" &amp; tbl.Range(x, 1).Value &amp; \"', '\" &amp; tbl.Range(x, 2).Value &amp; \"', '\" &amp; tbl.Range(x, 3) &amp; \"') \"\n    Else\n    RepTargets = RepTargets &amp; \"('\" &amp; tbl.Range(x, 1).Value &amp; \"', '\" &amp; tbl.Range(x, 2).Value &amp; \"', '\" &amp; tbl.Range(x, 3) &amp; \"'), \"\n    End If\nNext x\n\n\nSet tbl = Sheets(\"Targets\").ListObjects(\"tblDespTarget\")\n DispatchTarget = tbl.Range(2, 1).Value\n\nSet tbl = Sheets(\"Targets\").ListObjects(\"tblMonthlyTargets\")\nMonthTarget = tbl.Range(Month(Date) + 1, 2).Value\n\n\n\n' Sets Dispatches Summary Sql\nDispatchesSql = _\n\"Select sum(isnull(((delivery_line_item.dli_qty*(order_line_item.oli_total_margin/order_line_item.oli_qty_required))/order_line_item.oli_price_per),0)) as TotalValue, \" &amp; _\nDispatchTarget &amp; \" as 'Target', \" &amp; _\n\"case WHEN \" &amp; DispatchTarget &amp; \" -sum(isnull(((delivery_line_item.dli_qty*(order_line_item.oli_total_margin/order_line_item.oli_qty_required))/order_line_item.oli_price_per),0)) &gt; 0  \" &amp; _\n\"THEN \" &amp; DispatchTarget &amp; \" -sum(isnull(((delivery_line_item.dli_qty*(order_line_item.oli_total_margin/order_line_item.oli_qty_required))/order_line_item.oli_price_per),0)) \" &amp; _\n\"Else 0.00 End as 'Remainder' \" &amp; _\n\"from delivery_header \" &amp; _\n\"join delivery_line_item on delivery_line_item.dli_dh_id = delivery_header.dh_id \" &amp; _\n\"join order_line_item on order_line_item.oli_id = delivery_line_item.dli_oli_id \" &amp; _\n\"where  dateadd(day,datediff(day,0,delivery_header.dh_datetime),0) = dateadd(day,datediff(day,0,getdate()),0) \"\n\n\n\n' Sets Sales GP SQL\nSalesGPSql = _\n\"Select sum(order_header_total.oht_net) as 'TotalNet', \" &amp; _\n\"sum(order_header_total.oht_total_margin) as 'TotalGP' \" &amp; _\n\"from order_header \" &amp; _\n\"join order_header_total on order_header_total.oht_oh_id = order_header.oh_id \" &amp; _\n\"where order_header.oh_sot_id = 1 \" &amp; _\n\"and dateadd(day,datediff(day,0,order_header.oh_datetime),0) = dateadd(day,datediff(day,0,getdate()),0) \"\n\n\n\n' Sets Rep v Target SQL\n\nRepvTargetSql = _\n\"With SalesPeople as (select X.Person, X.Month, X.Target From (Values    \" &amp; _\nRepTargets &amp; _\n\") as X (Person, Month, Target))   \" &amp; _\n\"SELECT user_detail.ud_username,  \" &amp; _\n\"isnull(TodaysTotal.Net, 0) AS 'Net Total ',  \" &amp; _\n\"CASE WHEN WorkingDaysLeft.DaysLeft = 0 THEN SalesPeople.Target - isnull(MonthTotals.Net, 0) ELSE (SalesPeople.Target - isnull(MonthTotals.Net, 0)) / WorkingDaysLeft.DaysLeft END AS 'Target',  \" &amp; _\n\"CASE WHEN (CASE WHEN WorkingDaysLeft.DaysLeft = 0 THEN SalesPeople.Target - isnull(MonthTotals.Net, 0) ELSE (SalesPeople.Target - isnull(MonthTotals.Net, 0)) / WorkingDaysLeft.DaysLeft END) - isnull(TodaysTotal.Net, 0) &lt; = 0  \" &amp; _\n\"THEN 0 ELSE (CASE WHEN WorkingDaysLeft.DaysLeft = 0 THEN SalesPeople.Target - isnull(MonthTotals.Net, 0) ELSE (SalesPeople.Target - isnull(MonthTotals.Net, 0)) / WorkingDaysLeft.DaysLeft END) - isnull(TodaysTotal.Net, 0) END AS 'Remaining' \"\nRepvTargetSql = RepvTargetSql &amp; _\n\"FROM user_detail \" &amp; _\n\"LEFT JOIN ( \" &amp; _\n    \"SELECT user_detail.ud_id, sum(order_header_total.oht_total_margin) AS Net \" &amp; _\n    \"FROM order_header \" &amp; _\n    \"JOIN order_header_total ON order_header_total.oht_oh_id = order_header.oh_id \" &amp; _\n    \"JOIN order_header_detail ON order_header_detail.ohd_oh_id = order_header.oh_id \" &amp; _\n    \"JOIN user_detail ON user_detail.ud_id = order_header_detail.ohd_sales_rep \" &amp; _\n    \"WHERE dateadd(day, datediff(day, 0, order_header.oh_datetime), 0) = dateadd(day, datediff(day, 0, getdate()), 0) AND order_header.oh_sot_id = 1 \" &amp; _\n    \"GROUP BY user_detail.ud_id ) AS TodaysTotal ON TodaysTotal.ud_id = user_detail.ud_id \" &amp; _\n\"LEFT JOIN ( \" &amp; _\n    \"SELECT user_detail.ud_id, sum(order_header_total.oht_total_margin) AS Net \" &amp; _\n    \"FROM order_header \" &amp; _\n    \"JOIN order_header_total ON order_header_total.oht_oh_id = order_header.oh_id \" &amp; _\n    \"JOIN order_header_detail ON order_header_detail.ohd_oh_id = order_header.oh_id \" &amp; _\n    \"JOIN user_detail ON user_detail.ud_id = order_header_detail.ohd_sales_rep \" &amp; _\n    \"WHERE dateadd(day, datediff(day, 0, order_header.oh_datetime), 0) = dateadd(day, datediff(day, 0, getdate()), 0) AND order_header.oh_sot_id = 1 \" &amp; _\n    \"GROUP BY user_detail.ud_id \" &amp; _\n    \") AS MonthTotals ON MonthTotals.ud_id = user_detail.ud_id \" &amp; _\n\"JOIN (SELECT (DATEDIFF(dd, getdate(), dateadd(day, - 1, dateadd(month, datediff(month, 0, getdate()) + 1, 0))) + 1) - (DATEDIFF(wk, getdate(), dateadd(day, - 1, dateadd(month, datediff(month, 0, getdate()) + 1, 0))) * 2) -  \" &amp; _\n    \"(CASE WHEN DATENAME(dw, getdate()) = 'Sunday' THEN 1 ELSE 0 END) - (CASE WHEN DATENAME(dw, dateadd(day, - 1, dateadd(month, datediff(month, 0, getdate()) + 1, 0))) = 'Saturday' THEN 1 ELSE 0 END) AS DaysLeft \" &amp; _\n    \") AS WorkingDaysLeft ON 1 = 1 \" &amp; _\n\"JOIN SalesPeople on SalesPeople.Person = ud_username and SalesPeople.Month = datename(month,getdate()) \" &amp; _\n\"WHERE user_detail.ud_active = 1 \" &amp; _\n\"ORDER BY user_detail.ud_username \"\n\n' Debug.Print DispatchesSql\n\n With ActiveWorkbook.Connections(\"qryDespatches\").ODBCConnection\n    .BackgroundQuery = False\n    .CommandText = DispatchesSql\n    .Refresh\nEnd With\n\nWith ActiveWorkbook.Connections(\"qrySalesGPToday\").ODBCConnection\n    .BackgroundQuery = False\n    .CommandText = SalesGPSql\n    .Refresh\nEnd With\n\nWith ActiveWorkbook.Connections(\"qryRepDaily\").ODBCConnection\n    .BackgroundQuery = False\n    .CommandText = RepvTargetSql\n    .Refresh\nEnd With\n\n\nWith ActiveWorkbook.Connections(\"qryDespPicksOpenOrders\").ODBCConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\n\n\nEnd Sub\n\n\n\n\n\n\nSub AutoLoad()\nDim tbl As ListObject\nDim LoopTime As String\n\nSet tbl = Sheets(\"Targets\").ListObjects(\"tblTime\")\n LoopTime = tbl.Range(2, 1).Value\n\nLoopTime = Sheets(\"Targets\").Range(\"J2\").Value\n\nDim i As Long\n\nOn Error GoTo err_handler\nApplication.EnableCancelKey = xlErrorHandler\nApplication.ScreenUpdating = True\n\n'sets Sql statements for today in queries\nRefreshQueries\n\n'Refresh Despatch ready for screen showing\nRefreshDespatch\n\nDo Until 1 = 2\n\nApplication.ScreenUpdating = True\n\n'Loads up Daily Dispatch Figures worksheet\nSheets(\"Daily Dispatch Figures\").Select\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nRange(\"A1:C36\").Select\nActiveWindow.Zoom = True\nRange(\"A1\").Select\nActiveSheet.ChartObjects(\"DailyDespatchChart\").Activate\n\n\n'Refreshes Sales ready for next screen\nRefreshSales\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + LoopTime\nWaittime = TimeSerial(newHour, newMinute, newSecond)\n\n\nApplication.Wait Waittime\n\n\n'Loads up \"Sales &amp; GP Today\" worksheet\n\nSheets(\"Sales &amp; GP Today\").Select\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nRange(\"A1:B35\").Select\nActiveWindow.Zoom = True\nRange(\"A1\").Select\nActiveSheet.ChartObjects(\"SalesGPTodayChart\").Activate\n\n'Refresh Daily ready for next screen\nRefreshDaily\n\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + LoopTime\nWaittime = TimeSerial(newHour, newMinute, newSecond)\n\nApplication.Wait Waittime\n\n\n\n'Loads up Rep Daily Targets worksheet\n\nSheets(\"Rep Daily Targets\").Select\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nRange(\"A1:B36\").Select\nActiveWindow.Zoom = True\nRange(\"A1\").Select\nActiveSheet.ChartObjects(\"RepDailyChart\").Activate\n\n'Refreshes Live ready for next screen\nRefreshLive\n\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + LoopTime\nWaittime = TimeSerial(newHour, newMinute, newSecond)\n\nApplication.Wait Waittime\n\n\n'Loads up Live Summary worksheet\n\nSheets(\"Live Summary\").Select\nRange(\"A1\").Select\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nRange(\"A1:B4\").Select\nActiveWindow.Zoom = True\nRange(\"A1\").Select\n\n'Refreshes Despatch ready for next screen\nRefreshDespatch\n\n\nnewHour = Hour(Now())\nnewMinute = Minute(Now())\nnewSecond = Second(Now()) + LoopTime\nWaittime = TimeSerial(newHour, newMinute, newSecond)\n\nApplication.Wait Waittime\n\n\n\nLoop\n\n\nerr_handler:\n    If Err.Number = 18 Then\n        EndReport\n        MsgBox \"Report Cancelled\"\n    End If\n\nEnd Sub\n\nSub RefreshDespatch()\nWith ActiveWorkbook.Connections(\"qryDespatches\").ODBCConnection\n  .BackgroundQuery = False\n  .Refresh\nEnd With\n\nEnd Sub\n\nSub RefreshSales()\nWith ActiveWorkbook.Connections(\"qrySalesGPToday\").ODBCConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\nEnd Sub\n\nSub RefreshDaily()\nWith ActiveWorkbook.Connections(\"qryRepDaily\").ODBCConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\nEnd Sub\n\nSub RefreshLive()\n\nWith ActiveWorkbook.Connections(\"qryDespPicksOpenOrders\").ODBCConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\nEnd Sub\n\n\nSub EndReport()\nApplication.DisplayFullScreen = False\nActiveWindow.DisplayHeadings = True\nApplication.DisplayFormulaBar = True\nApplication.ScreenUpdating = True\nActiveWindow.Zoom = 100\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1426667781, "post_id": 29117022, "comment_id": 46462221, "body": "<code>path2 = Dir(&quot;C:\\pathtofile\\Costs &quot; &amp; YearNo &amp; &quot;-??.xlsx&quot;)</code> should work - do you get an error with it?"}], "answers": [{"comments": [{"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1426677217, "post_id": 29117542, "comment_id": 46467755, "body": "Oh, I thought as it is a wildcard it &quot;works&quot; somewhat like a function, and not as a mere contanenation of a &quot;constant&quot; value. Will try this once I&#39;ve finished my meeting"}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 1, "last_activity_date": 1426668701, "creation_date": 1426668701, "answer_id": 29117542, "question_id": 29117022, "link": "https://stackoverflow.com/questions/29117022/vba-syntax-error-using-dir-having-contentenation-and-wildcards/29117542#29117542", "title": "VBA Syntax error using Dir having contentenation and wildcards", "body": "<p>The <code>??</code> is a litteral string and should be treated as such (and not as a variable). It belongs inside the <code>\"</code>quotes<code>\"</code>.</p>\n\n<pre><code>path2 = Dir(\"C:\\pathtofile\\Costs \" &amp; YearNo &amp; \"-??.xlsx\")\n</code></pre>\n"}], "owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 29117542, "answer_count": 1, "score": 0, "last_activity_date": 1426668701, "creation_date": 1426666668, "last_edit_date": 1426667916, "question_id": 29117022, "link": "https://stackoverflow.com/questions/29117022/vba-syntax-error-using-dir-having-contentenation-and-wildcards", "title": "VBA Syntax error using Dir having contentenation and wildcards", "body": "<p>I want to loop through a series of files having the appearence</p>\n\n<pre><code>  Costs 2015-01 , Costs 2015-02, ..., Costs 2016-12\n</code></pre>\n\n<p>However using</p>\n\n<pre><code>YearNo = Year(Date)\npath2 = Dir(\"C:\\pathtofile\\Costs \" &amp; YearNo &amp; \"-\"&amp; ?? &amp; \".xlsx\")\n</code></pre>\n\n<p>Gives syntax error for the expression for path2. <bR>\nWhat I expected that the expression would yield would be:</p>\n\n<pre><code>C:\\pathtofile\\Costs 2015-(all files having a two digit number after the \"-\").xlsx\n</code></pre>\n\n<p>(Or well, the file names Costs 2015-01... etc at least, since <code>Dir</code> only returns file name)</p>\n\n<p>I've tried to use <code>&amp; YearNo &amp; -?? &amp; \".xlsx\"</code> and <code>&amp; YearNo &amp; \"-??\" &amp; \".xlsx\"</code> and <code>&amp;YearNo -?? &amp;\".xlsx\"</code> but none of them works. Does anyone have a clue regarding this?</p>\n\n<p>EDIT: I'm using <code>YearNo</code> as the folder contains a bunch of files having <em>Costs 2014-...</em> expressions which I do not want to import. Also, using this technique I believe that the program needs to import less data come, for instance, 2022 when it only need to import the files for 2022, and not for 2015 up to 2022.</p>\n"}, {"tags": ["excel", "vba", "rtd"], "comments": [{"owner": {"reputation": 3005, "user_id": 1319248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2Jj2C.jpg?s=128&g=1", "display_name": "Kai Mattern", "link": "https://stackoverflow.com/users/1319248/kai-mattern"}, "edited": false, "score": 2, "creation_date": 1426665807, "post_id": 29116721, "comment_id": 46461384, "body": "So what is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1426666992, "last_edit_date": 1426666992, "creation_date": 1426666668, "answer_id": 29117021, "question_id": 29116721, "link": "https://stackoverflow.com/questions/29116721/rtd-in-excel-vba-need-to-call-data-from-rtd/29117021#29117021", "title": "RTD in Excel VBA ( need to call data from rtd )", "body": "<p>Try this:</p>\n\n<pre><code>Range(\"d1\") = [RTD(\"tickerplantrtdserver\", , 4#2#1#6768#FUTSTK#N1#0#XX#Bid)]\n</code></pre>\n\n<p><code>[]</code> brackets are shortcut for <a href=\"http://www.ozgrid.com/VBA/evaluate.htm\" rel=\"nofollow\"><code>Evaluate</code></a> Function.<br>\nSo it can be written like this as well:</p>\n\n<pre><code>Range(\"d1\") = Evaluate(\"RTD(\"\"tickerplantrtdserver\"\", , 4#2#1#6768#FUTSTK#N1#0#XX#Bid)\")\n</code></pre>\n\n<p>Take note of the double quotes in the <code>\"\"tickerplantrtdserver\"\"</code> part.<bR>\nI have not tried this yet and have no way of testing but <em>Evaluate</em> works on formulas, so I am just assuming it will work the same with <code>RTD</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 420, "user_id": 1641818, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f6e2253bd5e2e3bbbd9bb220094fcc87?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1641818/marc"}, "is_accepted": false, "score": 0, "last_activity_date": 1526321929, "creation_date": 1526321929, "answer_id": 50336650, "question_id": 29116721, "link": "https://stackoverflow.com/questions/29116721/rtd-in-excel-vba-need-to-call-data-from-rtd/50336650#50336650", "title": "RTD in Excel VBA ( need to call data from rtd )", "body": "<p>RTD is designed to return data continuously, but for the current value, try this:</p>\n\n<pre><code>Dim xlApp As New Excel.Application\nSub test()\n   Range(\"D1\") = xlApp.WorksheetFunction.RTD(\"tickerplantrtdserver\", Null, \"4#2#1#6768#FUTSTK#N1#0#XX#Bid\")\nEnd Sub\n</code></pre>\n\n<p>xlApp is slow, so you want to initialize once only</p>\n\n<p>If you get a bad value, the server may not have a value yet, so try again a few seconds later</p>\n\n<p>NB: Windows Excel only (RTD not supported on MAC)</p>\n"}], "owner": {"reputation": 1, "user_id": 4430174, "user_type": "registered", "profile_image": "https://graph.facebook.com/578649701/picture?type=large", "display_name": "Parijat Luthra", "link": "https://stackoverflow.com/users/4430174/parijat-luthra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2321, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1526321929, "creation_date": 1426665334, "last_edit_date": 1426676109, "question_id": 29116721, "link": "https://stackoverflow.com/questions/29116721/rtd-in-excel-vba-need-to-call-data-from-rtd", "title": "RTD in Excel VBA ( need to call data from rtd )", "body": "<p>I was looking for the same answer where I need to call data from a RTD server</p>\n\n<pre><code>Sub Test() \n    Range(\"d1\") = RTD(\"tickerplantrtdserver\", , 4#2#1#6768#FUTSTK#N1#0#XX#Bid)\nEnd Sub\n</code></pre>\n\n<p>When I extract data from Excel</p>\n\n<pre><code>RTD(\"tickerplantrtdserver\", , 4#2#1#6768#FUTSTK#N1#0#XX#Bid)\n</code></pre>\n\n<p>it works fine and gives a number.</p>\n"}, {"tags": ["vba", "outlook", "rules"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "edited": false, "score": 0, "creation_date": 1426750546, "post_id": 29122528, "comment_id": 46502361, "body": "Hi Eugene, if I create rule manually, I have an option to apply the rule to all incoming messages. Is there no way to replicate this in VBA?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1426682918, "creation_date": 1426682918, "answer_id": 29122528, "question_id": 29116273, "link": "https://stackoverflow.com/questions/29116273/outlook-vba-rules-apply-to-all-messages-and-mark-as-read/29122528#29122528", "title": "Outlook VBA Rules Apply to All Messages and Mark as Read", "body": "<p>Outlook rules are based on the conditions. There is no conditions in your case. So, consider handling the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686(v=office.15).aspx\" rel=\"nofollow\">NewMailEx</a> event of the Application class instead. The event is fired when a new item is received in the Inbox.</p>\n\n<p>Also you may handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869609(v=office.15).aspx\" rel=\"nofollow\">ItemAdd</a> event of the Items class. The event is fired when one or more items are added to the specified collection. This event does not run when a large number of items are added to the folder at once (more than 16 - this is a known issue). </p>\n"}], "owner": {"reputation": 149, "user_id": 4201845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bbb3db7428a80707f995b8b268164854?s=128&d=identicon&r=PG&f=1", "display_name": "clippertm", "link": "https://stackoverflow.com/users/4201845/clippertm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1426682918, "creation_date": 1426663537, "question_id": 29116273, "link": "https://stackoverflow.com/questions/29116273/outlook-vba-rules-apply-to-all-messages-and-mark-as-read", "title": "Outlook VBA Rules Apply to All Messages and Mark as Read", "body": "<p>I am creating rules in Outlook through VBA. There is a rule that should apply to all messages, right after they arrive. In a way, there is no condition (this is the difficult part!). I have spent the last hours on MSDN without finding any answer on this. Any idea how to do it?</p>\n\n<p>Also, I am wondering if all messages that arrive can be marked as read. It does not look like it is possible according to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868996.aspx\" rel=\"nofollow\">MSDN</a>, and I wanted to hear your expert advice on this. I was looking for something like:</p>\n\n<pre><code>Dim oRuleNew As Outlook.Rule\nDim oMarkAsReadAction As Outlook.Action\nSet oMarkAsReadAction = oRuleNew.Action.\"mark as un/read type of action\"\nWith oMarkAsReadAction\n    .Enabled = True\n    .UnRead = False\nEnd With\n</code></pre>\n\n<p>Thank you in advance for your support,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 4666378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W8q4VldUm4w/AAAAAAAAAAI/AAAAAAAAAg0/STvBxkWSIx8/photo.jpg?sz=128", "display_name": "Anush Reddy", "link": "https://stackoverflow.com/users/4666378/anush-reddy"}, "edited": false, "score": 0, "creation_date": 1426660838, "post_id": 29115623, "comment_id": 46459349, "body": "I want to pull the all price data to excel from the website  This given code is only working for first price  How can i fetch the all other price list to excel"}, {"owner": {"reputation": 6009, "user_id": 1996783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/m7ztb.gif?s=128&g=1", "display_name": "Mackan", "link": "https://stackoverflow.com/users/1996783/mackan"}, "edited": false, "score": 0, "creation_date": 1426660970, "post_id": 29115623, "comment_id": 46459405, "body": "Please format your code using the tools provided, and add your comment in your question (so it becomes an actual question)."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1426662781, "post_id": 29115623, "comment_id": 46460135, "body": "Loop through &quot;dd&quot; and do the same from 0 to length -1"}, {"owner": {"reputation": 1, "user_id": 4666378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W8q4VldUm4w/AAAAAAAAAAI/AAAAAAAAAg0/STvBxkWSIx8/photo.jpg?sz=128", "display_name": "Anush Reddy", "link": "https://stackoverflow.com/users/4666378/anush-reddy"}, "edited": false, "score": 0, "creation_date": 1426664225, "post_id": 29115623, "comment_id": 46460744, "body": "Can u suggest me syntax"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1426665798, "post_id": 29115623, "comment_id": 46461379, "body": "try to change appropriate line inside the loop into this: <code>dd = doc.getElementsByClassName(&quot;whole-price&quot;)(i-1).innerText</code> and remove similar one before loop which is doing nothing"}, {"owner": {"reputation": 1, "user_id": 4666378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W8q4VldUm4w/AAAAAAAAAAI/AAAAAAAAAg0/STvBxkWSIx8/photo.jpg?sz=128", "display_name": "Anush Reddy", "link": "https://stackoverflow.com/users/4666378/anush-reddy"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1426667185, "post_id": 29115623, "comment_id": 46461955, "body": "Thanks @KazJaw it worked But it is repeating multiple time depending on max i value, I want to end it at the end of HTML page . How can i do it ?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1426667722, "post_id": 29115623, "comment_id": 46462191, "body": "try to count number of elements and loop for that number in this way: <code>doc.getElementsByClassName(&quot;whole-price&quot;).length</code>"}], "owner": {"reputation": 1, "user_id": 4666378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W8q4VldUm4w/AAAAAAAAAAI/AAAAAAAAAg0/STvBxkWSIx8/photo.jpg?sz=128", "display_name": "Anush Reddy", "link": "https://stackoverflow.com/users/4666378/anush-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 773, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426662650, "creation_date": 1426660736, "last_edit_date": 1531164843, "question_id": 29115623, "link": "https://stackoverflow.com/questions/29115623/multiple-elements-from-same-classname-vba", "title": "multiple elements from same classname VBA", "body": "<p>I want to pull the all price data to excel from the website This given code is only working for first price.</p>\n\n<p>How can i fetch the all other price list to excel?</p>\n\n<pre><code>Sub PriceGetting()  \n    Dim IE As New InternetExplorer \n    Dim Element As IHTMLElement  \n    Dim i As Integer    \n\n    IE.navigate \"http://www.junglee.com/dp/B00QG8BS6U\"   \n    IE.Visible = True   \n\n    Do    \n        DoEvents  \n    Loop Until IE.readyState = READYSTATE_COMPLETE    \n\n    Dim doc As HTMLDocument     \n    Set doc = IE.document    \n\n    Dim dd As Variant    \n\n    dd = doc.getElementsByClassName(\"whole-price\")(0).innerText    \n\n    i = 1   \n    Do While i &lt; 20    \n        dd = doc.getElementsByClassName(\"whole-price\")(0).innerText  \n        Range(\"A\" &amp; i + 1) = dd    \n        i = i + 1    \n    Loop    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint", "powerpoint-2013"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1426661823, "post_id": 29115072, "comment_id": 46459745, "body": "And you need to replace everything, both text and shapes? How about the pictures? I believe those are pictures?"}, {"owner": {"reputation": 344, "user_id": 1752213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nFC2W.jpg?s=128&g=1", "display_name": "Henrik S&#246;derlund", "link": "https://stackoverflow.com/users/1752213/henrik-s%c3%b6derlund"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1426671310, "post_id": 29115072, "comment_id": 46464060, "body": "The images are white outlined images/logos, residing inside normal powerpoint shapes with fill/outlines in blue. It is the blue color I want to change. The circle and &quot;spokes&quot; are also normal powerpoint lines that I want new colors on. Basically everything that is blue on that screenshot is what I want to change."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1426695151, "post_id": 29115072, "comment_id": 46480236, "body": "What have you tried so far and what hasn&#39;t worked properly?  What happens that shouldn&#39;t, what doesn&#39;t happen that should?  And as a suggestion:  consider using a theme color rather than an RGB coded color; then in future all you&#39;d need to do is change the them and PPT will automatically recolor anything assigned that theme color."}, {"owner": {"reputation": 344, "user_id": 1752213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nFC2W.jpg?s=128&g=1", "display_name": "Henrik S&#246;derlund", "link": "https://stackoverflow.com/users/1752213/henrik-s%c3%b6derlund"}, "edited": false, "score": 0, "creation_date": 1426732976, "post_id": 29115072, "comment_id": 46497595, "body": "Good idea with the the theme color, thanks for that tip. I will add come VBA code that worked for me up in the answer - thanks for the suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 1752213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nFC2W.jpg?s=128&g=1", "display_name": "Henrik S&#246;derlund", "link": "https://stackoverflow.com/users/1752213/henrik-s%c3%b6derlund"}, "edited": false, "score": 0, "creation_date": 1427183245, "post_id": 29148024, "comment_id": 46661740, "body": "Thanks for helping out. However, the script fails on the following line, complaining &quot;value out or range&quot;:  If .Line.Visible Then"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 344, "user_id": 1752213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nFC2W.jpg?s=128&g=1", "display_name": "Henrik S&#246;derlund", "link": "https://stackoverflow.com/users/1752213/henrik-s%c3%b6derlund"}, "edited": false, "score": 0, "creation_date": 1427208229, "post_id": 29148024, "comment_id": 46677191, "body": "What kind of shape is it processing at that point?  After &quot;With oSh&quot; add &quot;Debug.Print .Name&quot;  (don&#39;t include the quote marks). Press Ctrl+G in the VBA IDE to display the Immediate window before running the code.  The Debug.Print results will appear there."}, {"owner": {"reputation": 344, "user_id": 1752213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nFC2W.jpg?s=128&g=1", "display_name": "Henrik S&#246;derlund", "link": "https://stackoverflow.com/users/1752213/henrik-s%c3%b6derlund"}, "edited": false, "score": 0, "creation_date": 1427272527, "post_id": 29148024, "comment_id": 46705639, "body": "Fantastic, that worked, and I found the culprit being the &quot;Table 1&quot;. I simply removed the few tables I had and the script completed. Would you be able to add color replacements to all &quot;Oval&quot;, &quot;Rectangle&quot; and &quot;Chart&quot; too? Or just all shapes maybe even?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 344, "user_id": 1752213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nFC2W.jpg?s=128&g=1", "display_name": "Henrik S&#246;derlund", "link": "https://stackoverflow.com/users/1752213/henrik-s%c3%b6derlund"}, "edited": false, "score": 0, "creation_date": 1427293068, "post_id": 29148024, "comment_id": 46718817, "body": "This should already work with all of the normal shapes you add from the Insert Shape menu.  Charts are a whole additional level of complexity; possible but far more work than I have time to tackle.  But to prevent other problems, you could add a case selector:  Select Case oSh.Type, then have it ignore shapes of type Chart, Media and so on.  You&#39;d also want to add a test for If oSh.HasChart or oSh.HasTable Then &#39; Skip it, don&#39;t try to recolor"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 9, "last_activity_date": 1426777257, "creation_date": 1426777257, "answer_id": 29148024, "question_id": 29115072, "link": "https://stackoverflow.com/questions/29115072/use-vba-to-change-colors-of-slide-elements-in-powerpoint-2013/29148024#29148024", "title": "Use VBA to change colors of slide elements in Powerpoint 2013", "body": "<p>This should get you a step closer, though I'd probably rewrite it as a function that you could pass lFindColor and lReplaceColor to.</p>\n\n<pre><code>Sub ReplaceColors()\n\n    Dim lFindColor As Long\n    Dim lReplaceColor As Long\n    Dim oSl As Slide\n    Dim oSh As Shape\n    Dim x As Long\n\n    lFindColor = RGB(255, 128, 128)\n    lReplaceColor = RGB(128, 128, 255)\n\n    For Each oSl In ActivePresentation.Slides\n        For Each oSh In oSl.Shapes\n            With oSh\n\n                ' Fill\n                If .Fill.ForeColor.RGB = lFindColor Then\n                    .Fill.ForeColor.RGB = lReplaceColor\n                End If\n\n                ' Line\n                If .Line.Visible Then\n                    If .Line.ForeColor.RGB = lFindColor Then\n                        .Line.ForeColor.RGB = lReplaceColor\n                    End If\n                End If\n\n                ' Text\n                If .HasTextFrame Then\n                    If .TextFrame.HasText Then\n                        For x = 1 To .TextFrame.TextRange.Runs.Count\n                            If .TextFrame.TextRange.Runs(x).Font.Color.RGB = lFindColor Then\n                                .TextFrame.TextRange.Runs(x).Font.Color.RGB = lReplaceColor\n                            End If\n                        Next\n                    End If\n                End If\n            End With\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12801244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b71ea87fc14968fa4481b72e22c09f0?s=128&d=identicon&r=PG&f=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/12801244/guido"}, "is_accepted": false, "score": 0, "last_activity_date": 1580240566, "creation_date": 1580240566, "answer_id": 59955937, "question_id": 29115072, "link": "https://stackoverflow.com/questions/29115072/use-vba-to-change-colors-of-slide-elements-in-powerpoint-2013/59955937#59955937", "title": "Use VBA to change colors of slide elements in Powerpoint 2013", "body": "<p>I'd like to add another solution, not using VBA. It may be a bit hacky, but it works remarkably well. The idea is to get inside the pptx-file and perform a find-and-replace operation on color codes. This will replace <em>all</em> occurences of a specific color in the whole presentation (be it normal text, shading, parts of a graph, borders of a table, you name it).</p>\n\n<p><strong>STEP 1.</strong> Create a back-up of your original Powerpoint file!</p>\n\n<p><strong>STEP 2.</strong> If your presentation has the extension <strong>.ppt</strong>, open it in Powerpoint and save it again as <strong>.pptx</strong>.</p>\n\n<p><strong>STEP 3.</strong> Change the extension <strong>.pptx</strong> to <strong>.zip</strong> (and ignore any warnings by Windows). For example, change \"my_presentation.pptx\" to \"my_presentation.zip\". The reason for this is that a pptx-file is in fact a zip-file. By renaming the file to <strong>.zip</strong> you will be able to extract it.</p>\n\n<p><strong>STEP 4.</strong> Extract the zip-file. You will obtain a folder (and subfolders) that contains a lot of xml-files (and possibly other files). Somewhere in these xml-files there must be color definitions, although we don't know where exactly.</p>\n\n<p><strong>STEP 5.</strong> Determine the hexadecimal codes of the old and the new color. For example, if the old color is turquoise (rgb: 0,176,240), its hexadecimal code will be 00B0F0. If the new color is dark gray (rgb: 71,67,55), its hexadecimal code will be 474337.</p>\n\n<p><strong>STEP 6.</strong> Download, install and open the (free) text editor Notepad++.  (You can find it here: <a href=\"https://notepad-plus-plus.org/\" rel=\"nofollow noreferrer\">https://notepad-plus-plus.org/</a>.)</p>\n\n<p><strong>STEP 7.</strong> Within Notepad++ click \"Search >> Find in Files ...\". This allows you to perform a find-and-replace operation in all extracted (xml-)files at once. Select the correct folder, search for the old color code (00B0F0) and replace it with the new color code (474337). Make sure the search is performed in subfolders as well. <a href=\"https://i.stack.imgur.com/cXhVo.jpg\" rel=\"nofollow noreferrer\">See this screenshot.</a></p>\n\n<p><strong>STEP 8.</strong> Now compress the files again into a zip file. It's important that you select <em>exactly</em> the previously extracted files, <em>without</em> their parent folder. (If you accidentally compress on the level of the parent folder, you will create an extra layer in the folder hierarchy of the zip-file, which will confuse Powerpoint.)</p>\n\n<p><strong>STEP 9.</strong> Change the extension of the newly created zip file into <strong>.pttx</strong> (and ignore any warnings by Windows).</p>\n\n<p><em>WARNING:</em> There is a small probability that the hexadecimal color code you search for in STEP 7, shows up as something completely different as well (say a phone number or whatever). If there is any chance you will mess up your presentation this way, search for <strong>val=\"00B0F0\"</strong> instead of just <strong>00B0F0</strong>.</p>\n"}], "owner": {"reputation": 344, "user_id": 1752213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nFC2W.jpg?s=128&g=1", "display_name": "Henrik S&#246;derlund", "link": "https://stackoverflow.com/users/1752213/henrik-s%c3%b6derlund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18246, "favorite_count": 0, "accepted_answer_id": 29148024, "answer_count": 2, "score": 6, "last_activity_date": 1593677698, "creation_date": 1426658271, "last_edit_date": 1593677698, "question_id": 29115072, "link": "https://stackoverflow.com/questions/29115072/use-vba-to-change-colors-of-slide-elements-in-powerpoint-2013", "title": "Use VBA to change colors of slide elements in Powerpoint 2013", "body": "<p>I have a 150-slide powerpoint presentation that I want to revise due to a company rebranding effort. Our previous turquoise color has been used on text, lines, shapes and shape fills. I would like to build a VBA script that runs across the entire presentation, and in one fell swoop amends all slides and replaces this bluish color with our new dark gray color.</p>\n\n<p>The old corporate color was RGB(0, 176, 240) - turquoise</p>\n\n<p>The new corporate color is RGB(71, 67, 65) - dark gray</p>\n\n<p>I have tried a multitude of different vba's across the internet but can't get it to work properly. Here is a screenshot of a typical slide from the old color - all the blue items should be changed to dark gray:</p>\n\n<p><img src=\"https://i.stack.imgur.com/A7883.png\" alt=\"screenshot\"></p>\n\n<p>This piece of VBA code from a helpful forum member worked really well for shape fills - if this could be re-worked to include any text and shape outlines and lines as well, it would be perfect.</p>\n\n<pre><code>Sub ChangeShapeColor()\n\n    Dim oSh As Shape\n    Dim oSl As Slide\n\n    ' Look at each slide in the current presentation:\n    For Each oSl In ActivePresentation.Slides\n\n        ' Look at each shape on each slide:\n        For Each oSh In oSl.Shapes\n\n            ' IF the shape's .Fill.ForeColor.RGB = turqoise color:\n            If oSh.Fill.ForeColor.RGB = RGB(0, 176, 240) Then\n\n                ' Change it to corporate dark grey:\n            oSh.Fill.ForeColor.RGB = RGB(71, 67, 65)\n\n            End If\n\n        Next oSh\n\n    Next oSl\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["vba", "sorting", "excel"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4554674, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c590fa1ff3fce9a032b8fe6b67527cbe?s=128&d=identicon&r=PG&f=1", "display_name": "3689", "link": "https://stackoverflow.com/users/4554674/3689"}, "edited": false, "score": 0, "creation_date": 1426663848, "post_id": 29115918, "comment_id": 46460577, "body": "Thanks Izzymo, That helps. would it be possible for sorting the table as per  contains in it like I need to sort row which contains T on top and rest on below it. is there any scope of sorting like it ?"}], "tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": true, "score": 1, "last_activity_date": 1426662073, "creation_date": 1426662073, "answer_id": 29115918, "question_id": 29114954, "link": "https://stackoverflow.com/questions/29114954/multiple-sorting-with-vba/29115918#29115918", "title": "Multiple Sorting with VBA", "body": "<p>I have slightly modified your code to include references to the last row</p>\n\n<pre><code>Sub sort_s()\n\nRange(\"A19\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlDown)).Select\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"E20:E\" &amp; Range(\"E\" &amp; Rows.count).end(xlUp).row _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"F20:F\"  &amp; Range(\"F\" &amp; Rows.count).end(xlUp).row _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"G20:G\"  &amp; Range(\"G\" &amp; Rows.count).end(xlUp).row _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"H20:H\" &amp;  &amp; Range(\"H\" &amp; Rows.count).end(xlUp).row _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"I20:I\"  &amp; Range(\"I\" &amp; Rows.count).end(xlUp).row _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n    .SetRange Range(\"A19:J\"  &amp; Range(\"A\" &amp; Rows.count).end(xlUp).row)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nRange(\"A20\").Select\nEnd Sub\n</code></pre>\n\n<p>The relevant line i have added is\n<code>&amp; Range(ColumnName &amp; Rows.count).end(xlUp).Row</code></p>\n"}], "owner": {"reputation": 113, "user_id": 4554674, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c590fa1ff3fce9a032b8fe6b67527cbe?s=128&d=identicon&r=PG&f=1", "display_name": "3689", "link": "https://stackoverflow.com/users/4554674/3689"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 1, "accepted_answer_id": 29115918, "answer_count": 1, "score": 0, "last_activity_date": 1426662073, "creation_date": 1426657713, "question_id": 29114954, "link": "https://stackoverflow.com/questions/29114954/multiple-sorting-with-vba", "title": "Multiple Sorting with VBA", "body": "<p>I have been working on this code for multiple sorting in which I have data from column A to J, I need to sort it till the last row of data. My code consists range values but I need it sort till last row irrespective of whatever range. below is code. Any help is welcome.</p>\n\n<pre><code>Sub sort_s()\n\nRange(\"A19\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlDown)).Select\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"E20:E35\" _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"F20:F45\" _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"G20:G35\" _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"H20:H35\" _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"I20:I35\" _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n    .SetRange Range(\"A19:J35\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nRange(\"A20\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4731, "user_id": 1716866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411da970ac5de2f1a0d66a10741b0e9c?s=128&d=identicon&r=PG", "display_name": "leekaiinthesky", "link": "https://stackoverflow.com/users/1716866/leekaiinthesky"}, "edited": false, "score": 0, "creation_date": 1427195773, "post_id": 29114058, "comment_id": 46668619, "body": "Hi @user2519726, does my answer below address your issue?"}], "answers": [{"tags": [], "owner": {"reputation": 4731, "user_id": 1716866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411da970ac5de2f1a0d66a10741b0e9c?s=128&d=identicon&r=PG", "display_name": "leekaiinthesky", "link": "https://stackoverflow.com/users/1716866/leekaiinthesky"}, "is_accepted": false, "score": 0, "last_activity_date": 1426677583, "last_edit_date": 1426677583, "creation_date": 1426677007, "answer_id": 29120474, "question_id": 29114058, "link": "https://stackoverflow.com/questions/29114058/tooltip-using-empty-hyperlinks/29120474#29120474", "title": "Tooltip using empty hyperlinks", "body": "<p>The Anchor argument that you provide to Hyperlinks.Add should be a Range, not a Value. Try:</p>\n\n<pre><code>Anchor:=ws1.Range(\"B\" &amp; IdentityRow)\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>Anchor:=ws1.Range(\"B\" &amp; IdentityRow).Value\n</code></pre>\n\n<p>You'll also need to correct <code>ws1.Range(\"B\" &amp; IdentityRow).Font.Underline = black</code> to <code>ws1.Range(\"B\" &amp; IdentityRow).Font.Color = black</code> to get the code to run.</p>\n"}], "owner": {"reputation": 99, "user_id": 2519726, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bf95ae9c2094f7bc9c5cb1afb7360271?s=128&d=identicon&r=PG", "display_name": "user2519726", "link": "https://stackoverflow.com/users/2519726/user2519726"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426677583, "creation_date": 1426652371, "last_edit_date": 1531161705, "question_id": 29114058, "link": "https://stackoverflow.com/questions/29114058/tooltip-using-empty-hyperlinks", "title": "Tooltip using empty hyperlinks", "body": "<p>I've been searching around on how to enable an improvised tooltip. I came across a tutorial where the author managed to do it by using empty hyperlinks. I was able to do this on a single column but I need it on a larger scale. I've come up with a for loop but for some reason I'm getting a mismatch error on my if else statement. Here it is: </p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    Dim IdentityRow As Long\n    Dim SpecialIdentifier As String\n    Dim ws1 As Worksheet\n\n    Set ws1 = Sheets(\"Dashboard\")\n\n    For IdentityRow = 15 To 3000\n    SpecialIdentifier = CStr(ws1.Range(\"B\" &amp; IdentityRow).Value)\n\n\n    If SpecialIdentifier = \"Rehire\" Then\n\n         ws1.Range(\"B\" &amp; IdentityRow).Hyperlinks.Add Anchor:=ws1.Range(\"B\" &amp; IdentityRow).Value, _\n         Address:=\" \", _\n         ScreenTip:=\"User is a rehire, please remember to check HRI for current LM details\", _\n         TextToDisplay:=ws1.Range(\"B\" &amp; IdentityRow).Value\n\n\n         ws1.Range(\"B\" &amp; IdentityRow).Font.Underline = xlUnderlineStyleNone\n         ws1.Range(\"B\" &amp; IdentityRow).Font.Underline = black\n\n      End If\n\n   Next IdentityRow\nEnd Sub\n</code></pre>\n\n<p>This is where I'm getting the mismatch issue:</p>\n\n<pre><code>ws1.Range(\"B\" &amp; IdentityRow).Hyperlinks.Add Anchor:=ws1.Range(\"B\" &amp; IdentityRow).Value, _\nAddress:=\" \", _\nScreenTip:=\"User is a rehire, please remember to check HRI for current LM details\", _\nTextToDisplay:=ws1.Range(\"B\" &amp; IdentityRow).Value\n</code></pre>\n\n<p>any ideas? basically i want to convert all entries in a row to an empty hyperlink just for the sake of getting tooltip.</p>\n\n<p>Thanks guys.</p>\n"}, {"tags": ["vba", "outlook", "pseudocode"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1426653466, "creation_date": 1426653466, "answer_id": 29114245, "question_id": 29114004, "link": "https://stackoverflow.com/questions/29114004/vba-sort-through-mailbox-and-move-duplicate-subjects-to-folder/29114245#29114245", "title": "VBA-sort through mailbox and move duplicate subjects to folder", "body": "<p>Firstly, do not use multiple dot notation: <code>inbox.items(i).move otherFolder</code> - each <code>inbox.items(i)</code> will return a brand new COM object.</p>\n\n<p>Secondly, use Items.Find/FindNext or Items.Restrict insrtead of looping through all items in a folder.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 4552480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a890abf112440d0da53b6345617c388?s=128&d=identicon&r=PG&f=1", "display_name": "Sir_Edward", "link": "https://stackoverflow.com/users/4552480/sir-edward"}, "edited": false, "score": 0, "creation_date": 1426722579, "post_id": 29119749, "comment_id": 46495000, "body": "Thanks for more information in regards to restrict/etc. Im just wondering if there was an efficient way to cycle through the emails and get those duplicates keeping in mind the prefix will have to pair, i.e. new - example 1 will have to be paired with closed - example 1"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1426675028, "creation_date": 1426675028, "answer_id": 29119749, "question_id": 29114004, "link": "https://stackoverflow.com/questions/29114004/vba-sort-through-mailbox-and-move-duplicate-subjects-to-folder/29119749#29119749", "title": "VBA-sort through mailbox and move duplicate subjects to folder", "body": "<p>You need to use the <a href=\"http://msdn.microsoft.com/en-us/library/ff869662.aspx\" rel=\"nofollow\">Find</a>/<a href=\"http://msdn.microsoft.com/en-us/library/ff862482.aspx\" rel=\"nofollow\">FindNext</a> or <a href=\"http://msdn.microsoft.com/en-us/library/ff869597.aspx\" rel=\"nofollow\">Restrict</a> methods of the Items class instead of iterating through all items in the folder. For example:</p>\n\n<pre><code>Sub DemoFindNext() \n Dim myNameSpace As Outlook.NameSpace \n Dim tdystart As Date \n Dim tdyend As Date \n Dim myAppointments As Outlook.Items \n Dim currentAppointment As Outlook.AppointmentItem \n\n Set myNameSpace = Application.GetNamespace(\"MAPI\") \n tdystart = VBA.Format(Now, \"Short Date\") \n tdyend = VBA.Format(Now + 1, \"Short Date\") \n Set myAppointments = myNameSpace.GetDefaultFolder(olFolderCalendar).Items \n Set currentAppointment = myAppointments.Find(\"[Start] &gt;= \"\"\" &amp; tdystart &amp; \"\"\" and [Start] &lt;= \"\"\" &amp; tdyend &amp; \"\"\"\") \n While TypeName(currentAppointment) &lt;&gt; \"Nothing\" \n   MsgBox currentAppointment.Subject \n   Set currentAppointment = myAppointments.FindNext \n Wend \nEnd Sub\n</code></pre>\n\n<p>See the following articles for more information and sample code:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/20/outlook-find-findnext-retrieve-mail/\" rel=\"nofollow\">How To: Use Find and FindNext methods to retrieve Outlook mail items from a folder (C#, VB.NET)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/23/outlook-restrict-method-retrieve-mail/\" rel=\"nofollow\">How To: Use Restrict method to retrieve Outlook mail items from a folder</a></li>\n</ul>\n\n<p>Also you may find the <a href=\"http://msdn.microsoft.com/en-us/library/bb219884.aspx\" rel=\"nofollow\">AdvancedSearch</a> method of the Application class helpful. The key benefits of using the AdvancedSearch method are listed below:</p>\n\n<ul>\n<li>The search is performed in another thread. You don\u2019t need to run another thread manually since the AdvancedSearch method runs it automatically in the background.</li>\n<li>Possibility to search for any item types: mail, appointment, calendar, notes etc. in any location, i.e. beyond the scope of a certain folder. The Restrict and Find/FindNext methods can be applied to a particular Items collection (see the Items property of the Folder class in Outlook).</li>\n<li>Full support for DASL queries (custom properties can be used for searching too). You can read more about this in the Filtering article in MSDN. To improve the search performance, Instant Search keywords can be used if Instant Search is enabled for the store (see the IsInstantSearchEnabled property of the Store class).</li>\n<li>You can stop the search process at any moment using the Stop method of the Search class.</li>\n</ul>\n"}], "owner": {"reputation": 5, "user_id": 4552480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a890abf112440d0da53b6345617c388?s=128&d=identicon&r=PG&f=1", "display_name": "Sir_Edward", "link": "https://stackoverflow.com/users/4552480/sir-edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 29119749, "answer_count": 2, "score": 0, "last_activity_date": 1426675028, "creation_date": 1426651982, "question_id": 29114004, "link": "https://stackoverflow.com/questions/29114004/vba-sort-through-mailbox-and-move-duplicate-subjects-to-folder", "title": "VBA-sort through mailbox and move duplicate subjects to folder", "body": "<p>I've run into an issue where i'm writing a macro in Outlook 2013 that goes through an inbox and whenever it comes across duplicate subject lines it moves the 2 emails to a different folder.</p>\n\n<p>These \"duplicates\" have slight differences within the subject line, difference being a \"new\" prefix and a \"closed\" prefix.</p>\n\n<p>I have a general idea on how I can achieve this, but i'm sure there would be a much cleaner and more efficient way to do so as there are 50 different subject lines (without prefix included) .</p>\n\n<p>Currently my thoughts is to have something similar to below:</p>\n\n<pre><code>for i = 1 to inbox.items.count \n    if inbox.items(i) = \"new - example subject 1\" then\n        for x = 1 to inbox.items.count\n            if inbox.items(x) = \"closed - example subject 1\" then\n                inbox.items(x).unread = false\n                inbox.items(x).move otherFolder\n                inbox.items(i).unread = false\n                inbox.items(i).move otherFolder\n                exit for\n            end if\n        next x\n     end if\n\n\n    if inbox.items(i) = \"new - example subject 2\" then\n        for x = 1 to inbox.items.count\n            if inbox.items(x) = \"closed - example subject 2\" then\n                inbox.items(x).unread = false\n                inbox.items(x).move otherFolder\n                inbox.items(i).unread = false\n                inbox.items(i).move otherFolder\n                exit for\n            end if\n        next x\n     end if\n\n\n'repeating 50 times'\n\n\nnext i\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "sum", "elements"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2386878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ad9ba23322f461dacd3630958f618003?s=128&d=identicon&r=PG", "display_name": "user2386878", "link": "https://stackoverflow.com/users/2386878/user2386878"}, "edited": false, "score": 0, "creation_date": 1426717304, "post_id": 29132773, "comment_id": 46493234, "body": "Thanks!  I was beginning to wonder if I would have to implement SAS to do this for me.  I will obtain VB.Net as I am getting to heavy modeling and theoretical hypotheses at work.  I truly appreciate your assistance, and look forward to learning VB.Net!  Your help is invaluable.  I hope you have a great day!  Nick"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1426713151, "creation_date": 1426713151, "answer_id": 29132773, "question_id": 29113758, "link": "https://stackoverflow.com/questions/29113758/how-to-sum-some-elements-of-another-array-into-a-new-one-to-create-a-moving-aver/29132773#29132773", "title": "How to sum some elements of another array into a new one to create a moving average", "body": "<p>The macro below shows how to achieve the result I believe you seek.</p>\n\n<p>I set Cell A1 of worksheet MoveAvg to <code>=Rand() * 1000</code>.  I dragged that down to Cell A1500.  I did a Paste Special of Values only for this range so the random values were fixed.</p>\n\n<p>I set Cell C50 to the average of Cells A1:50.  I dragged that down.</p>\n\n<p>I ran the macro below which creates an array containing the moving averages.  This array is written to column E starting at row 50.</p>\n\n<p>The image below shows that the values calculated by Excel match those calculated by the macro.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Wx5QI.png\" alt=\"Sample test data\"></p>\n\n<p>However, VBA is not the language to use is you are performing \u201cbillions of computations.\u201d</p>\n\n<p>I answered a recent question that involved calculating 8,063 million values and writing them to disk with 1 million values per file.  Calculating and saving 50 million values with VBA took 13 minutes, 15 seconds.  Multiplying up suggests a total time for all 8,063 million values of nearly 14 days, 20 hours.  With VB.Net, calculating and storing all 8,063 million values took 51 minutes.</p>\n\n<p>Reading from and writing to an Excel workbook with VB.Net is slower that with VBA.  But once the data is within VB.Net arrays, calculations are thousands of times faster.</p>\n\n<p>VB.Net is an upgrade of VBA so the learning curve is not steep.  The Express version of VB.Net is free to download and you can distribute any programs you write if you register.</p>\n\n<p>I leave you to think about it. </p>\n\n<pre><code>Option Explicit\nSub CalcMovingAvg()\n\n  Dim MoveAvg() As Double\n  Dim RowTVLast As Long\n  Dim RowTVCrnt As Long\n  Dim TestValues As Variant\n  Dim TotalRunning As Double\n\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculate = False\n\n  With Worksheets(\"MoveAvg\")\n    RowTVLast = .Cells(Rows.Count, 1).End(xlUp).Row\n    TestValues = .Range(.Cells(1, 1), .Cells(RowTVLast, 1)).Value\n  End With\n\n  ReDim MoveAvg(1 To UBound(TestValues, 1) - 49, 1 To 1)\n\n  TotalRunning = 0\n  For RowTVCrnt = 1 To 50\n    TotalRunning = TotalRunning + TestValues(RowTVCrnt, 1)\n  Next\n\n  MoveAvg(1, 1) = TotalRunning / 50\n\n  For RowTVCrnt = 51 To UBound(TestValues, 1)\n    TotalRunning = TotalRunning - TestValues(RowTVCrnt - 50, 1) + TestValues(RowTVCrnt, 1)\n    MoveAvg(RowTVCrnt - 49, 1) = TotalRunning / 50\n  Next\n\n  With Worksheets(\"MoveAvg\")\n    .Range(.Cells(50, 5), .Cells(RowTVLast, 5)).Value = MoveAvg\n  End With\n\n  Application.ScreenUpdating = True\n  Application.EnableEvents = True\n  Application.Calculate = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2386878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ad9ba23322f461dacd3630958f618003?s=128&d=identicon&r=PG", "display_name": "user2386878", "link": "https://stackoverflow.com/users/2386878/user2386878"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3571, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426713151, "creation_date": 1426650085, "question_id": 29113758, "link": "https://stackoverflow.com/questions/29113758/how-to-sum-some-elements-of-another-array-into-a-new-one-to-create-a-moving-aver", "title": "How to sum some elements of another array into a new one to create a moving average", "body": "<p>I have always used range references on worksheets for calculations, but am now starting to use arrays to work with data, due to how much faster they can be. I am going to be dealing with billions of computations, so I need to do as much as possible in memory.  In the provided code snippet, I am trying to get \"SMA_MIN_Array\" to calculate a 50 period moving average of the preceding 50 values of the array named vArray. Does anybody know how to accomplish it? Here is what I have so far, and I cannot get it to work. The \"Sum(vArray(j,j+49)/50) is the culprit. I know that isn't right, but I needed to put down an idea for someone with way more array experience than me to interpret what I actually want.  I just don't know how to translate this into summing items 1 through 50 and dividing the total by 50. And the second element of the SMA_MIN_Array would then calculate the average of elements 2 through 51, etc.  Any ideas? Here is a snippet of some code that I have tried: (If you live in Dallas, I will buy you a drink of your choice for help on this problem!)</p>\n\n<p>Thanks,\n Nick</p>\n\n<pre><code>Option Base 1\nSub Main()\nDim Mainwb As Workbook\nSet Mainwb = ThisWorkbook\n\n\nDim Last_Row As Long\nLast_Row = Mainwb.Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nDim rng As Range\nSet rng = Mainwb.Worksheets(\"Sheet1\").Range(\"F5:F\" &amp; Last_Row)\n\nDim vArray() As Variant\nvArray = rng\n\nDim i As Long\nFor i = LBound(vArray, 1) To UBound(vArray, 1)\nNext\n\n    Dim newWorkbook As Workbook\n    Set newWorkbook = Application.Workbooks.Add\n\n    With newWorkbook.Sheets(\"Sheet1\")\n    .Range(.Cells(5, 8), .Cells(Last_Row, 8)).Value = vArray\n    End With\n\n\nDim SMA_MIN_Array() As Variant\nReDim SMA_MIN_Array(1 To Last_Row - 50, 1 To 1)\nFor j = 1 To Last_Row - 50\nSMA_MIN_Array(j, 1) = Sum(vArray(j, j + 49)) / 50\nNext\n\n\nWith newWorkbook.Sheets(\"Sheet1\")\n.Range(.Cells(55, 10), .Cells(Last_Row, 10)).Value = SMA_MIN_Array\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1426647086, "post_id": 29112745, "comment_id": 46455617, "body": "Please note MS Access has a 255 column limit on tables. Why not just copy your header row, transpose it, then copy value row and transpose that too, then import into Access? No need to pass through an array."}, {"owner": {"reputation": 17, "user_id": 4588786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1723b70d346091cd926d818658124e08?s=128&d=identicon&r=PG&f=1", "display_name": "Wol Verine", "link": "https://stackoverflow.com/users/4588786/wol-verine"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1426650205, "post_id": 29112745, "comment_id": 46456282, "body": "Yes i know of the limit, running it using excel vba I was able to read more than 255, actually 800 columns successfully read and transposed but in one row only using my code. Im trying to read the next rows up to 2000 while maintaining the field values on top as field flag. Doing a transpose in excel means I will do it 2000 times before I can import."}, {"owner": {"reputation": 17, "user_id": 4588786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1723b70d346091cd926d818658124e08?s=128&d=identicon&r=PG&f=1", "display_name": "Wol Verine", "link": "https://stackoverflow.com/users/4588786/wol-verine"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1426871452, "post_id": 29112745, "comment_id": 46562465, "body": "any idea anyone... please help... thanks"}, {"owner": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1427036469, "post_id": 29112745, "comment_id": 46604584, "body": "Split the problem in parts: 1) first be sure that the file is imported somewhere (an Excel file, for example). 2) create two arrays: one to hold the header and the other to hold each data row. 3) read the headers. 4) for each data row, read the row and write it in another place (sheet). Try to solve things in a simple way before complicating yourself."}, {"owner": {"reputation": 17, "user_id": 4588786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1723b70d346091cd926d818658124e08?s=128&d=identicon&r=PG&f=1", "display_name": "Wol Verine", "link": "https://stackoverflow.com/users/4588786/wol-verine"}, "edited": false, "score": 0, "creation_date": 1427305392, "post_id": 29112745, "comment_id": 46727457, "body": "thanks Barranka, yes i will try that with this code"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4588786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1723b70d346091cd926d818658124e08?s=128&d=identicon&r=PG&f=1", "display_name": "Wol Verine", "link": "https://stackoverflow.com/users/4588786/wol-verine"}, "edited": false, "score": 0, "creation_date": 1427093648, "post_id": 29202447, "comment_id": 46620386, "body": "hi parfait, it says Cells is an undefined Sub... how do I fix it? thanks"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 17, "user_id": 4588786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1723b70d346091cd926d818658124e08?s=128&d=identicon&r=PG&f=1", "display_name": "Wol Verine", "link": "https://stackoverflow.com/users/4588786/wol-verine"}, "edited": false, "score": 0, "creation_date": 1427158951, "post_id": 29202447, "comment_id": 46655058, "body": "See edit. I forgot to declare the second workbook&#39;s first worksheet in paste line."}, {"owner": {"reputation": 17, "user_id": 4588786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1723b70d346091cd926d818658124e08?s=128&d=identicon&r=PG&f=1", "display_name": "Wol Verine", "link": "https://stackoverflow.com/users/4588786/wol-verine"}, "edited": false, "score": 0, "creation_date": 1427269924, "post_id": 29202447, "comment_id": 46704401, "body": "hi i parfait, i already included the changes you made, it still have the same error. Do I have to initialize anything? Thanks"}, {"owner": {"reputation": 17, "user_id": 4588786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1723b70d346091cd926d818658124e08?s=128&d=identicon&r=PG&f=1", "display_name": "Wol Verine", "link": "https://stackoverflow.com/users/4588786/wol-verine"}, "edited": false, "score": 0, "creation_date": 1427767307, "post_id": 29202447, "comment_id": 46903017, "body": "hi parfait, it works fine however it only reads one line of data... it wont go to the next lines... i really appreciate all your help... thank you"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1427427687, "last_edit_date": 1427427687, "creation_date": 1427077752, "answer_id": 29202447, "question_id": 29112745, "link": "https://stackoverflow.com/questions/29112745/csv-array-manipulation-transpose-in-ms-access-vba/29202447#29202447", "title": "CSV array manipulation transpose in ms access vba", "body": "<p>Consider looping through rows and transpose them.</p>\n\n<pre><code>Set xlWb1 = xlApp.Workbooks.Open(SourcePathAndName)\nSet xlWb2 = xlApp.Workbooks.Add\n\n    lastrow = xlWb1.Worksheets(1).UsedRange.Rows.Count\n    lastcolum = xlWb1.Worksheets(1).UsedRange.Columns.Count\n\n    ' ITERATES THROUGH 2,000 ROWS\n    For i = 1 to lastrow\n         ' COPIES ENTIRE ROW FROM COLUMNS 1 to 800\n         With xlWb1.Worksheets(1)\n            .Range(.Cells(i, 1), .Cells(i, lastcolumn)).Copy\n         End With\n\n         ' TRANSPOSES TO 2,000 COLUMNS &lt;---- NOTE: TOO WIDE FOR MS ACCESS TABLE\n         xlWb2.Worksheets(1).Cells(1, i).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n    Next i\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4588786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1723b70d346091cd926d818658124e08?s=128&d=identicon&r=PG&f=1", "display_name": "Wol Verine", "link": "https://stackoverflow.com/users/4588786/wol-verine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 29202447, "answer_count": 1, "score": 1, "last_activity_date": 1427427687, "creation_date": 1426642463, "last_edit_date": 1426657277, "question_id": 29112745, "link": "https://stackoverflow.com/questions/29112745/csv-array-manipulation-transpose-in-ms-access-vba", "title": "CSV array manipulation transpose in ms access vba", "body": "<p>I am working on this code already and I need help to transfer values from a csv in transposed form</p>\n\n<hr>\n\n<pre><code>Sub ImportCSV()\n\nDim xlApp As Object 'Excel.Application\nDim xlWb1 As Object 'Excel.Workbook\nDim xlWb2 As Object 'Excel.Workbook\nDim SourcePathAndName As Variant\nDim SourcePath As String\nDim SourceName As String\nDim NewNameAndPath As String\n\nConst xlPasteValues As Long = -4163\nConst xlCSV As Long = 6\n\nSet xlApp = CreateObject(\"Excel.Application\")\nSourcePathAndName = xlApp.GetOpenFilename(\"CSV Files (*.csv), *.csv\", , \"Select source file...\", , False)\nIf SourcePathAndName = False Then\n    MsgBox \"No file selected\", vbCritical, \"Aborting\"\n    GoTo Cleanup\nEnd If\n\nSourcePath = Left(SourcePathAndName, InStrRev(SourcePathAndName, \"\\\"))\nSourceName = Mid(SourcePathAndName, InStrRev(SourcePathAndName, \"\\\") + 1)\nNewNameAndPath = SourcePath &amp; \"Import-\" &amp; SourceName\n\nxlApp.DisplayAlerts = False\nSet xlWb1 = xlApp.Workbooks.Open(SourcePathAndName)\n\nxlWb1.Worksheets(1).UsedRange.Copy\nSet xlWb2 = xlApp.Workbooks.Add\nWith xlWb2.Worksheets(1)\n\n    .[a1:b1] = Array(\"Field\", \"Val\")\n    .[a2].PasteSpecial Paste:=xlPasteValues, Transpose:=True\n\nEnd With\n\nxlWb2.SaveAs NewNameAndPath, xlCSV\nxlWb2.Close False\nxlWb1.Close False\n\nxlApp.DisplayAlerts = True\n\nDoCmd.TransferText acImportDelim, \"ResponseImport\", \"tblQuestionResponses\", NewNameAndPath, True\nKill NewNameAndPath\n\nMsgBox \"Done\" \nCleanup:\nSet xlWb1 = Nothing\nSet xlWb2 = Nothing\nxlApp.Quit\nSet xlApp = Nothing\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>My data is rows is</p>\n\n<pre><code>date | field1 | field2  | field3...|field 800\n\ndate |value   |value    |value ... |value\n</code></pre>\n\n<p>I was looking to change it to</p>\n\n<pre><code>date| Field1| value\n\ndate| Field2| value\n\ndate| field3| value\n</code></pre>\n\n<p>I was only able to read 1 row of the csv file and have the use the date as the grouping value, I have 2000+ rows and 800 columns. I also need not to include null values. Please help me manipulate the array. Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1426641553, "post_id": 29112488, "comment_id": 46454227, "body": "<code>Set sht = ActiveSheet</code>..."}, {"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1426641611, "post_id": 29112488, "comment_id": 46454240, "body": "@DavidZemens, right, that should have been obvious."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1426641658, "post_id": 29112488, "comment_id": 46454251, "body": "You can simply use <code>ActiveSheet</code> here. Remember that to call the macro using any button on any sheet, you&#39;ll have to actually go (select) to that sheet."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1426641616, "creation_date": 1426641616, "answer_id": 29112627, "question_id": 29112488, "link": "https://stackoverflow.com/questions/29112488/how-to-get-the-worksheet-that-a-regular-non-activex-control-is-on/29112627#29112627", "title": "How to get the worksheet that a regular (non-ActiveX) control is on?", "body": "<p><code>Set sht = ActiveSheet</code>...</p>\n\n<p>This of course assumes that the procedure is being invoked manually (i.e., the user is actively clicking the button) rather than being invoked through a <code>Call</code> or <code>Application.Run</code> statement.</p>\n\n<p>The button can only be clicked by the user when the worksheet is active view.</p>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1426642155, "post_id": 29112649, "comment_id": 46454399, "body": "This is not an answer to the question, but a comment requesting clarification. Also, the Form Controls are commonly understood to be &quot;regular&quot; buttons, and ActiveX controls are still most certainly something you can insert as recently as Excel 2010 (I will have to confirm whether the same is true in 2013 -- I just upgraded to that software and not 100% up to speed with it yet)."}, {"owner": {"reputation": 34, "user_id": 4678375, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4678375/serenity"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1426644193, "post_id": 29112649, "comment_id": 46454927, "body": "But form buttons are activex controls?"}, {"owner": {"reputation": 34, "user_id": 4678375, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4678375/serenity"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1426645671, "post_id": 29112649, "comment_id": 46455295, "body": "People need to use formal terminolgy."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1426648054, "post_id": 29112649, "comment_id": 46455816, "body": "This is terminology that is built in to the application&#39;s interface. Even recently (December &#39;14) there was a <a href=\"http://blogs.technet.com/b/the_microsoft_excel_support_team_blog/archive/2014/12/11/forms-controls-stop-working-after-december-2014-updates-.aspx\" rel=\"nofollow noreferrer\">widespread bug affecting -- according to Microsoft themselves both &quot;types&quot; of controls</a>.  It is the only terminology that most people would know or understand.  How do you ordinarily differentiate the two sets of controls available in my Controls toolbox? <a href=\"http://i.imgur.com/LzFN3Iw.png\" rel=\"nofollow noreferrer\">i.imgur.com/LzFN3Iw.png</a>"}, {"owner": {"reputation": 34, "user_id": 4678375, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4678375/serenity"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1426650025, "post_id": 29112649, "comment_id": 46456246, "body": "I don&#39;t. I regard a &quot;regular&quot; button as one created with CreateWindow, ie a non COM button. VB has a private COM for internal objects"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1426650436, "post_id": 29112649, "comment_id": 46456335, "body": "You don&#39;t <i>what</i>? Make a distinction between the two types of controls?  Even though they are different and behave differently? What <i>do</i> you call them?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1426664406, "post_id": 29112649, "comment_id": 46460810, "body": "!<a href=\"http://nebula.wsimg.com/2b18cbc6ee82787b9b334c267628815d?AccessKeyId=21C1C50B7677872F602F&amp;disposition=0&amp;alloworigin=1\" rel=\"nofollow noreferrer\">Form Control &amp; ActiveX control tool box</a> &lt;br/&gt;Why the arguing?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1426683759, "post_id": 29112649, "comment_id": 46471864, "body": "@Davesexcel that is exactly my point -- they are called such in the Toolbox, <i>and</i> of course they also behave differently and have different properties!"}, {"owner": {"reputation": 34, "user_id": 4678375, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4678375/serenity"}, "edited": false, "score": 0, "creation_date": 1426683828, "post_id": 29112649, "comment_id": 46471917, "body": "They are called regular buttons in the toolbox?"}], "tags": [], "owner": {"reputation": 34, "user_id": 4678375, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4678375/serenity"}, "is_accepted": false, "score": -1, "last_activity_date": 1426641752, "creation_date": 1426641752, "answer_id": 29112649, "question_id": 29112488, "link": "https://stackoverflow.com/questions/29112488/how-to-get-the-worksheet-that-a-regular-non-activex-control-is-on/29112649#29112649", "title": "How to get the worksheet that a regular (non-ActiveX) control is on?", "body": "<p>There is no such thing as a regular button. Nor anymore are there ActiveX controls.</p>\n\n<p>ActiveX is a marketing terminology by MS that described controls using COM. It, as a terminology, was retired years ago (the technology is still current).</p>\n\n<p>Therefore it is hard to know what you are referring to.</p>\n\n<p>Use names that HELP uses. List code that specifies the objects/etc that you are using.</p>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 29112627, "answer_count": 2, "score": 0, "last_activity_date": 1426724728, "creation_date": 1426640659, "last_edit_date": 1426724728, "question_id": 29112488, "link": "https://stackoverflow.com/questions/29112488/how-to-get-the-worksheet-that-a-regular-non-activex-control-is-on", "title": "How to get the worksheet that a regular (non-ActiveX) control is on?", "body": "<p>I have a sub that I am calling by clicking a button.  I've chosen to use a regular button (aka Form Control), not an ActiveX one, because I've been seeing the text size on ActiveX controls fluctuating and regular buttons don't have this problem.  I want the sub to be able to use the worksheet that the button is on.  I was thinking of something like this: </p>\n\n<pre><code>   Sub showSheetName()\n\n   Dim sht As Worksheet\n\n   'this would work if the code was in the worksheet's module\n   Set sht = Me\n\n   msgbox sht.Name\n\n   End Sub\n</code></pre>\n\n<p>But this sub is in a shared module, not the worksheet's module, because I want several sheets to be able to use it.  So <code>Me</code> doesn't point to the worksheet, and this approach just gives an <code>Invalid use of Me keyword</code>.</p>\n\n<p>How can I get a reference to the worksheet that the button is on?</p>\n\n<p>EDIT: If it wasn't clear, the reason why it's important that it's not an ActiveX control is because that means there's no <code>myButton_Click()</code> event in the worksheet that I can use to get the worksheet object and pass to a version of <code>showSheetName()</code> that takes a worksheet argument.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2044, "user_id": 1873994, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/8a9fb879fb1d678e369718e2752c1434?s=128&d=identicon&r=PG", "display_name": "Calum", "link": "https://stackoverflow.com/users/1873994/calum"}, "edited": false, "score": 0, "creation_date": 1426640446, "post_id": 29112289, "comment_id": 46453900, "body": "I do not get an error when i run this. selects range A1-D4"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4683183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a02f6715a430cbbabcd84c96fe364f1c?s=128&d=identicon&r=PG&f=1", "display_name": "jt2", "link": "https://stackoverflow.com/users/4683183/jt2"}, "edited": false, "score": 0, "creation_date": 1426640673, "post_id": 29112458, "comment_id": 46453960, "body": "I think your test works as you only have one worksheet, and it is the active one. The sheet I was trying to refer to was inactive, and without the ws.Cells reference, it didn&#39;t know which object to use. Thanks for the answer though....funny that VBA didn&#39;t complain about Worksheet vs. Worksheets..."}, {"owner": {"reputation": 535, "user_id": 2854647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/198e1025a309115c12c98888f46f5e88?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/2854647/maki"}, "reply_to_user": {"reputation": 61, "user_id": 4683183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a02f6715a430cbbabcd84c96fe364f1c?s=128&d=identicon&r=PG&f=1", "display_name": "jt2", "link": "https://stackoverflow.com/users/4683183/jt2"}, "edited": false, "score": 0, "creation_date": 1426640803, "post_id": 29112458, "comment_id": 46454001, "body": "you should active it, and if you want to keep the process in the background just use screenupdating = false"}, {"owner": {"reputation": 61, "user_id": 4683183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a02f6715a430cbbabcd84c96fe364f1c?s=128&d=identicon&r=PG&f=1", "display_name": "jt2", "link": "https://stackoverflow.com/users/4683183/jt2"}, "edited": false, "score": 0, "creation_date": 1426640998, "post_id": 29112458, "comment_id": 46454055, "body": "I&#39;m trying to avoid having to activate all these different worksheets, and I just went through a heck of a time trying to figure out why Range(&quot;A1:B10&quot;)  worked but Cells(1, 1), Cells(4, 4)) didn&#39;t. I finally saw a web page showing how to use ranges on inactive worksheets, and saw that the Cells needed an object qualifier too.... sheesh!"}, {"owner": {"reputation": 535, "user_id": 2854647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/198e1025a309115c12c98888f46f5e88?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/2854647/maki"}, "reply_to_user": {"reputation": 61, "user_id": 4683183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a02f6715a430cbbabcd84c96fe364f1c?s=128&d=identicon&r=PG&f=1", "display_name": "jt2", "link": "https://stackoverflow.com/users/4683183/jt2"}, "edited": false, "score": 0, "creation_date": 1426641153, "post_id": 29112458, "comment_id": 46454101, "body": "well, it seems like you&#39;ve got it now. [thumbs up]"}], "tags": [], "owner": {"reputation": 535, "user_id": 2854647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/198e1025a309115c12c98888f46f5e88?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/2854647/maki"}, "is_accepted": false, "score": 0, "last_activity_date": 1426640416, "creation_date": 1426640416, "answer_id": 29112458, "question_id": 29112289, "link": "https://stackoverflow.com/questions/29112289/problems-with-range/29112458#29112458", "title": "Problems with Range", "body": "<p>I tested with a simple sub like the below and it works. I think your error is coming from missing \"s\" after \"worksheet\".</p>\n\n<p>Set ws = Application.Workbooks(\"ndata.xlsm\").Worksheet(\"conditionsSheet\")\nshould be ...Worksheets....</p>\n\n<pre><code>sub TEST()\n\nDim ws As Worksheet\nDim cond_rng As Range\n\nSet ws = Worksheets(\"sheet1\")\nSet cond_rng = ws.Range(Cells(1, 1), Cells(5, 4))\ncond_rng.Value = 5\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1426640672, "post_id": 29112477, "comment_id": 46453959, "body": "Writing it the original way makes it dependent on the active sheet. It&#39;s equivalent to <code>Set cond_rng = ws.Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(4, 4))</code> If &quot;conditionsSheet&quot; is active then things will be fine whereas if any other sheet is active you will get the error. The two ways shown in your answer remove the dependency on the active sheet"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1426640723, "post_id": 29112477, "comment_id": 46453977, "body": "Up one. You nailed it. You need to explicitly reference your objects. <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">See this post to know more how you&#39;ll directly work with objects</a>. You might want to add @barrowc explanation in your post to improve context."}], "tags": [], "owner": {"reputation": 61, "user_id": 4683183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a02f6715a430cbbabcd84c96fe364f1c?s=128&d=identicon&r=PG&f=1", "display_name": "jt2", "link": "https://stackoverflow.com/users/4683183/jt2"}, "is_accepted": false, "score": 3, "last_activity_date": 1426640860, "last_edit_date": 1426640860, "creation_date": 1426640562, "answer_id": 29112477, "question_id": 29112289, "link": "https://stackoverflow.com/questions/29112289/problems-with-range/29112477#29112477", "title": "Problems with Range", "body": "<p>Ok, well this works:</p>\n\n<pre><code>'this works\nSet cond_rng = ws.Range(ws.Cells(1, 1), ws.Cells(4, 4))\ncond_rng.Select\n</code></pre>\n\n<p>or</p>\n\n<pre><code>With Sheets(\"conditionsSheet\")\n    .Range(.Cells(1, 1), .Cells(4, 4)).Select\nEnd With\n</code></pre>\n\n<p>The <code>.Cells</code> is important, as it won't work with just Cells.</p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1426667620, "last_edit_date": 1426667620, "creation_date": 1426666763, "answer_id": 29117044, "question_id": 29112289, "link": "https://stackoverflow.com/questions/29112289/problems-with-range/29117044#29117044", "title": "Problems with Range", "body": "<p>I believe it is the range.select that is confusing people. you will usually get an error if you are trying to select a range from a non-active worksheet.</p>\n\n<p>If you are trying to get values from that range in another sheet or need to add info into that range, you don't have to select it. For example: the below code will loop through each sheet and copy A1:D4(excluding PasteSheet) and paste it into PasteSheet. \nFor this example make sure you have a sheet named, \"PasteSheet\"</p>\n\n<pre><code>Sub SheetLoop()\n    Dim ws As Worksheet\n    Dim sh As Worksheet\n\n    Set ws = Sheets(\"PasteSheet\")\n\n    For Each sh In Sheets\n        If sh.Name &lt;&gt; ws.Name Then\n            With sh\n                .Range(.Cells(1, 1), .Cells(4, 4)).Copy ws.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n            End With\n        End If\n    Next sh\nEnd Sub\n</code></pre>\n\n<p>You can run this code from any sheet in the workbook because you don't have to select anything.</p>\n\n<p>So if for example Sheet2 A1=2 then sheet1(A1:D4) color is red else it is Blue.</p>\n\n<pre><code>Sub Button2_Click()\n    Dim ws As Worksheet, x\n    Dim sh As Worksheet, rng As Range, Crng As Range\n    Set ws = Sheets(\"Sheet1\")\n    Set sh = Sheets(\"Sheet2\")\n    Set rng = sh.Range(\"A1\")\n    Set Crng = ws.Range(ws.Cells(1, 1), ws.Cells(4, 4))\n\n    x = IIf(rng = 2, vbRed, vbBlue)\n    Crng.Interior.Color = x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4683183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a02f6715a430cbbabcd84c96fe364f1c?s=128&d=identicon&r=PG&f=1", "display_name": "jt2", "link": "https://stackoverflow.com/users/4683183/jt2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1426667620, "creation_date": 1426639469, "last_edit_date": 1426641174, "question_id": 29112289, "link": "https://stackoverflow.com/questions/29112289/problems-with-range", "title": "Problems with Range", "body": "<p>Why doesn't the second format of <code>Range(Cells(),Cells())</code> usage work?</p>\n\n<pre><code>Sub start()\n\n    Dim ws As Worksheet\n    Dim wb As Workbook\n    Dim cond_rng As Range\n\n    Set ws = Application.Workbooks(\"ndata.xlsm\").Worksheet(\"conditionsSheet\")\n\n    ' This works and selects one cell\n    Set cond_rng = ws.Cells(4, 1)\n    cond_rng.Select\n\n    'this works as expected\n    Set cond_rng = ws.Range(\"A1:B10\")\n    cond_rng.Select\n\n    'this fails with error 1004\n    Set cond_rng = ws.Range(Cells(1, 1), Cells(4, 4))\n    cond_rng.Select\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 10410, "user_id": 2450507, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qNPPb.jpg?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/2450507/nicholas"}, "edited": false, "score": 0, "creation_date": 1426639533, "post_id": 29112249, "comment_id": 46453653, "body": "Can you post something you have tried so far?"}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 4636324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153152965999813/picture?type=large", "display_name": "Cr1kk0", "link": "https://stackoverflow.com/users/4636324/cr1kk0"}, "is_accepted": false, "score": 0, "last_activity_date": 1426647355, "creation_date": 1426647355, "answer_id": 29113378, "question_id": 29112249, "link": "https://stackoverflow.com/questions/29112249/copy-and-paste-based-on-cell-value/29113378#29113378", "title": "Copy and paste based on cell value", "body": "<p>How much knowledge of VBA do you have? You could try to change the following code that I've been using for something similar, although it has an input box.</p>\n\n<pre><code>    Option Compare Text\nPublic Sub TeamReport()\n    Dim strFind As String\n    Dim i As Long, j As Long\n    Dim wsFind As Worksheet\n    Dim wsPaste As Worksheet\n\n    strFind = InputBox(\"Enter Team Name Here\")\n\n    Set wsFind = Sheets(\"Complete Listing\")\n\n    Set wsPaste = Sheets(\"Team Report\")\n\n\n    j = 3\n\n\nWorksheets(\"Team Report\").Range(\"A3:DJ300\").ClearContents\n    For i = 2 To wsFind.UsedRange.Rows.Count\n        If wsFind.Range(\"C\" &amp; i) = strFind Then\n            wsFind.Range(i &amp; \":\" &amp; i).Copy Destination:=wsPaste.Range(j &amp; \":\" &amp; j)\n            j = j + 1\n        End If\n    Next i\n\n\nWorksheets(\"Team Report\").Select\nEnd Sub\n</code></pre>\n\n<p>It has a input box to find a specific value, but might be able to get you started.</p>\n"}], "owner": {"reputation": 1, "user_id": 4683145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LdUB99-6jiY/AAAAAAAAAAI/AAAAAAAAAPM/_4ODG8E8WtM/photo.jpg?sz=128", "display_name": "william.michael ", "link": "https://stackoverflow.com/users/4683145/william-michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1456518327, "creation_date": 1426639293, "last_edit_date": 1456518327, "question_id": 29112249, "link": "https://stackoverflow.com/questions/29112249/copy-and-paste-based-on-cell-value", "title": "Copy and paste based on cell value", "body": "<p>I am attempting to loop through various workbooks and paste data into another \"merge\" workbook based on cell values.</p>\n\n<p>Workbook A sheet contains the data I want to loop through and copy along with the adjacent two columns. </p>\n\n<p>Workbook B is where I want to paste the data.  </p>\n\n<p>Workbook A - Column A contains numeric values. I want to copy the cells  A2, B2, C2 of data only if column A2's value is between 1-299. Paste these copied cells in two workbook B- columns A, B, C starting below where the last values where pasted. </p>\n\n<p>Then loop through the next row checking if its value is between 1-299.</p>\n\n<p>I will then apply this to many spreadsheets, but for now I just want to get one copy and paste working so I can understand how to apply it.</p>\n"}, {"tags": ["vba", "excel", "database-connection", "connection-string", "sqlcommand"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1426653557, "post_id": 29112161, "comment_id": 46457077, "body": "With what you want to achieve, you are better off using <code>FileSystemObject</code> (FSO) or mix of FSO and Dir instead of <code>Dir</code> only for the recursive file searching."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4683138"}, "edited": false, "score": 0, "creation_date": 1426703735, "post_id": 29115138, "comment_id": 46485844, "body": "Thank you so much you are so helpful! However for the Command Text, it shows me another connection string, not sql query. Been trying to figure out why is that. The code looks correct though cause it says .CommandText"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4683138"}, "edited": false, "score": 0, "creation_date": 1426724808, "post_id": 29115138, "comment_id": 46495586, "body": "Thank you so much, Patrick. I will take time to study and understand your code. I&#39;m very new to vba. Any tips on how to get good at it? Or do you know a good vba book?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1426726404, "post_id": 29115138, "comment_id": 46496002, "body": "I don&#39;t have any books to refer to, when I want to check on objects, I go to MSDN, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff846392(v=office.14).aspx\" rel=\"nofollow noreferrer\">Excel 2010</a>. You can throw in a lot of other stuff into VBA as well, such as .NET SystemCollections, WshShell,  Objects etc. So, have fun!"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 0, "last_activity_date": 1426713992, "last_edit_date": 1426713992, "creation_date": 1426658565, "answer_id": 29115138, "question_id": 29112161, "link": "https://stackoverflow.com/questions/29112161/macro-vba-code-to-find-workbooks-with-connection/29115138#29115138", "title": "Macro vba code to find workbooks with connection", "body": "<p>I believe after this you will love VBA.</p>\n\n<p>With what you want to achieve, there will be 4 parts (Subs):</p>\n\n<ol>\n<li>A Sub to list all <strong>Connection</strong> and <strong>CommandText</strong> of a Workbook (if any)</li>\n<li>A Sub to get name of all Excel files in a folder</li>\n<li>A Sub to recurse above to every Sub Folder</li>\n<li>A main Sub to initiate above</li>\n</ol>\n\n<p>Consider my code below:</p>\n\n<pre><code>Private Const FILE_FILTER = \"*.xl*\"\nPrivate Const sRootFDR = \"C:\\Users\\lchua\\\" ' Root Folder\n\nPrivate oFSO As Object ' For FileSystemObject\nPrivate oRng As Range, N As Long ' Range object and Counter\n\nSub Main()\n    Application.ScreenUpdating = False\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    N = 0\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        .UsedRange.ClearContents ' Remove previous contents\n        .Range(\"A1:D1\").Value = Array(\"Filename\", \"Connections\", \"Connection String\", \"Command Text\")\n        Set oRng = .Range(\"A2\") ' Initial Cell to start storing results\n    End With\n    ListFolder sRootFDR\n    Application.ScreenUpdating = True\n    Set oRng = Nothing\n    Set oFSO = Nothing\n    MsgBox N &amp; \" Excel files has been checked for connections.\"\nEnd Sub\n\nPrivate Sub ListFolder(ByVal sFDR As String)\n    Dim oFDR As Object\n    ' List the files of this Directory\n    ListFiles sFDR, FILE_FILTER\n    ' Recurse into each Sub Folder\n    For Each oFDR In oFSO.GetFolder(sFDR).SubFolders\n        ListFolder oFDR.Path &amp; \"\\\" ' Need '\\' to ensure the file filter works\n    Next\nEnd Sub\n\nPrivate Sub ListFiles(ByVal sFDR As String, ByVal sFilter As String)\n    Dim sItem As String\n    sItem = Dir(sFDR &amp; sFilter)\n    Do Until sItem = \"\"\n        N = N + 1 ' Increment Counter\n        oRng.Value = sFDR &amp; sItem\n        CheckFileConnections oRng.Value ' Call Sub to Check the Connection settings\n        Set oRng = oRng.Offset(1) ' Move Range object to next cell below\n        sItem = Dir\n    Loop\nEnd Sub\n\nPrivate Sub CheckFileConnections(ByVal sFile As String)\n    Dim oWB As Workbook, oConn As WorkbookConnection\n    Dim sConn As String, sCMD As String\n    Application.StatusBar = \"Opening workbook: \" &amp; sFile\n    Set oWB = Workbooks.Open(Filename:=sFile, ReadOnly:=True)\n    With oWB\n        oRng.Offset(0, 1).Value = .Connections.Count ' 1 column to right (B)\n        For Each oConn In .Connections\n            If Len(sConn) &gt; 0 Then sConn = sConn &amp; vbLf\n            If Len(sCMD) &gt; 0 Then sCMD = sCMD &amp; vbLf\n            sConn = sConn &amp; oConn.ODBCConnection.Connection\n            sCMD = sCMD &amp; oConn.ODBCConnection.CommandText\n        Next\n        oRng.Offset(0, 2).Value = sConn ' 2 columns to right (C)\n        oRng.Offset(0, 3).Value = sCMD ' 3 columns to right (D)\n    End With\n    oWB.Close False ' Close without saving\n    Set oWB = Nothing\n    Application.StatusBar = False\nEnd Sub\n</code></pre>\n\n<p>My test folders does not contain any workbook with connections, so the output is:<br>\n<img src=\"https://i.stack.imgur.com/1coSP.png\" alt=\"Output\"></p>\n\n<p>You should change where to store these information according to your Sheet. And you may want to comment out the <code>MsgBox</code>. Hopefully it won't Error out on Connection related.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4683138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 2, "accepted_answer_id": 29115138, "answer_count": 1, "score": 0, "last_activity_date": 1426713992, "creation_date": 1426638646, "question_id": 29112161, "link": "https://stackoverflow.com/questions/29112161/macro-vba-code-to-find-workbooks-with-connection", "title": "Macro vba code to find workbooks with connection", "body": "<p>I'm trying to scan folders and subfolders for workbooks that have connection strings and sql commands in them but I can't figure out how to do it. The code below is what I have (so far) and I'm stuck. I am very new to macros so I don't know if I'm doing it right. Basically the column headings that I want in my new workbook is the File Path, the Connection String, and the SQL Command. The connection string and SQL Command can be found under Data -> Connections. Right now the code below doesn't write anything so when you run it, it'll open a new workbook but without anything in it. Help me please. :(</p>\n\n<pre><code>Sub ReadDataFromAllWorkbooksInFolder()\n\n    Dim FolderName As String ' folder name\n    Dim wbName As String ' full name of folder and workbook.\n    Dim r As Long 'row number counter\n    ' Dim cValue As Variant ' not needed\n    Dim wbList() As String 'list of excel workbooks\n    Dim wbCount As Integer 'number of excel workbooks\n    Dim i, j As Integer 'counters\n\n    ' Start Folder\n    FolderName = \"C:\\Users\\lchua\\\"\n    ' create list of workbooks in foldername and put them in the spreadsheet\n    wbCount = 0\n    wbName = Dir(FolderName &amp; \"\\\" &amp; \"*.xls\") 'I CAN'T FIGURE OUT HOW TO DO IT IN SUBDIRECTORIES :(    \n    While wbName &lt;&gt; \"\"  'Create list of files and directories\n        wbCount = wbCount + 1\n        ReDim Preserve wbList(1 To wbCount)\n        wbList(wbCount) = FolderName &amp; wbName\n        wbName = Dir\n    Wend\n\n    If wbCount = 0 Then Exit Sub\n    r = 0\n    Workbooks.Add ' Creates a new workbook to put data into\n    Application.ScreenUpdating = False ' turn off the screen updating\n    For i = 1 To wbCount\n        Set wb = Workbooks.Open(wbList(i), True, True)\n        If wb.Connections.Count &gt; 0 Then\n            numconnections = wb.Connections.Count\n            For j = 1 To numconnections\n            ' read information into spreadsheet\n                Query = ActiveWorkbook.Connections(j).ODBCConnection.CommandText\n                ConnectionString = ActiveWorkbook.Connections(j).ODBCConnection.Connection\n            Next j\n        End If\n        wb.Close False ' close the source workbook without saving any changes\n        Set wb = Nothing ' free memory\n'        r = r + 1\n'        cValue = GetInfoFromClosedFile(FolderName, wbList(i), \"Sheet1\", \"A1\")\n'        Cells(r, 1).Formula = wbList(i)\n'        Cells(r, 2).Formula = cValue\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426663795, "post_id": 29112089, "comment_id": 46460552, "body": "Dear,  Many Thanks for your answer.  I&#39;ve tried and modified your code but it still doesn&#39;t work. There is error!           Sheets(&quot;Sheet1&quot;).Row(&quot;10&quot;).Copy         Sheets(&quot;Sheet2&quot;).Row(&quot;1&quot;).PasteSpecial xlPasteValues  And I still need to increment the row in my sheet2..  Thanks to help me))))"}], "tags": [], "owner": {"reputation": 5315, "user_id": 910087, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a64c36afe6bdcbec49d624acef6c018f?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard Powell", "link": "https://stackoverflow.com/users/910087/gerhard-powell"}, "is_accepted": true, "score": 0, "last_activity_date": 1426638083, "last_edit_date": 1495541574, "creation_date": 1426638083, "answer_id": 29112089, "question_id": 29112026, "link": "https://stackoverflow.com/questions/29112026/copy-numbers-with-formula-inside-in-other-sheet/29112089#29112089", "title": "Copy numbers (with formula inside) in other sheet", "body": "<p>Did you try copy/paste Value?</p>\n\n<pre><code>Sub CopyCol()\n    Sheets(\"Sheet1\").Columns(\"A\").Copy\n    Sheets(\"Sheet2\").Columns(\"B\").PasteSpecial xlPasteValues\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/23937684/910087\">Excel VBA Copy Paste Values only( xlPasteValues )</a></p>\n"}], "owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 29112089, "answer_count": 1, "score": -3, "last_activity_date": 1426687914, "creation_date": 1426637627, "last_edit_date": 1426687914, "question_id": 29112026, "link": "https://stackoverflow.com/questions/29112026/copy-numbers-with-formula-inside-in-other-sheet", "title": "Copy numbers (with formula inside) in other sheet", "body": "<p>In <code>Sheet1</code>, I have <code>B10</code> and <code>C10</code> with a formula like: </p>\n\n<pre><code>=SI(B3=0;B6;SI(B6=0;B3;SI(B3&lt;&gt;B6;B6;B3)))\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/konVg.jpg\" alt=\"enter image description here\"></p>\n\n<p>And with the VBA I increment the row and add my number.</p>\n\n<p><img src=\"https://i.stack.imgur.com/3nLiU.jpg\" alt=\"enter image description here\"></p>\n\n<p>But the numbers where they are the formulae is reading <code>#REF</code>.</p>\n\n<p>Here is my VBA Code : </p>\n\n<pre><code>  ThisWorkbook.Worksheets(\"Modification\").Range(\"A10:AL10\").Copy _\n        Destination:=ThisWorkbook.Worksheets(\"Donn\u00e9es Enregistr\u00e9es\").Cells(Rows.Count, 1).End(xlUp).Offset(1)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426636086, "post_id": 29111717, "comment_id": 46452634, "body": "<b>On which line ??</b>"}, {"owner": {"reputation": 3, "user_id": 3139350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7318466fc24c3e0ea8be2031a57fe601?s=128&d=identicon&r=PG&f=1", "display_name": "AussieVBA", "link": "https://stackoverflow.com/users/3139350/aussievba"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426636142, "post_id": 29111717, "comment_id": 46452654, "body": "Apologies, on the line where i define the array ar2"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 3139350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7318466fc24c3e0ea8be2031a57fe601?s=128&d=identicon&r=PG&f=1", "display_name": "AussieVBA", "link": "https://stackoverflow.com/users/3139350/aussievba"}, "is_accepted": false, "score": 0, "last_activity_date": 1426690559, "creation_date": 1426690559, "answer_id": 29125348, "question_id": 29111717, "link": "https://stackoverflow.com/questions/29111717/how-to-set-a-range-based-on-a-user-selected-cell-reference-in-excel-vba/29125348#29125348", "title": "How to Set a Range Based on a User Selected cell reference in Excel VBA", "body": "<p>My solution to the problem is pasted below. In the end what I did was to resize the range that is selected by the user in the input box command and offset it by the number of required rows that the data starts below the heading. This works OK for me because my data is always of a certain fixed length below the selected heading. </p>\n\n<p>The reference for offseting ranges came from <a href=\"https://support.microsoft.com/en-us/kb/291308\" rel=\"nofollow\">Microsoft Support Page on Selecting Range References in VBA</a></p>\n\n<pre><code>Sub test()\n\nDim ar1 As Variant\nDim ar2 As Variant\nDim rng1 As Range\nDim Path As String\nDim j As Long\nDim output As String\n\nPath = ActiveWorkbook.Path\n\nar1 = Worksheets(\"Find Friends\").Range(\"C6:C222\").Value\n\nSet rng1 = Application.InputBox(\"Select data heading from row 5\", _\n            \"Select Indicator\", Type:=8)\n\nar2 = rng1.Offset(1, 0).Resize(rng1.Rows.Count + 215, rng1.Columns.Count)\n\nFor j = 1 To UBound(ar1, 1)\n    output = output &amp; ar1(j, 1) &amp; \",\" &amp; ar2(j, 1) &amp; vbNewLine\nNext\n\nOpen Path &amp; \"\\text_data.txt\" For Output As #1\nPrint #1, output\nClose\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3139350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7318466fc24c3e0ea8be2031a57fe601?s=128&d=identicon&r=PG&f=1", "display_name": "AussieVBA", "link": "https://stackoverflow.com/users/3139350/aussievba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 450, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426690559, "creation_date": 1426635676, "last_edit_date": 1426683591, "question_id": 29111717, "link": "https://stackoverflow.com/questions/29111717/how-to-set-a-range-based-on-a-user-selected-cell-reference-in-excel-vba", "title": "How to Set a Range Based on a User Selected cell reference in Excel VBA", "body": "<p>I am currently running a code where the user selects a cell reference (which is the column heading name) and the code creates a dataset from that selection. The current code creates the data by running a find command on the selected heading string. This has worked really well but it is problematic if the heading appears twice in the same row. What I want to do instead is replace the find string with an offset from the selected row but am having trouble.</p>\n\n<p>The original code, using a find string was:</p>\n\n<pre><code>Sub test()\n\nDim ar1 As Variant\nDim str1 As String\nDim ar2 As Variant\nDim Path As String\nDim j As Long 'counter\nDim output As String\n\nPath = ActiveWorkbook.Path\n\nar1 = Worksheets(\"Sheet1\").Range(\"C6:C222\").Value\n\nstr1 = Application.InputBox(\"Select data heading from row 6\", _\n        \"Obtain String\", Type:=2)\n\nar2 = Range(Range(\"E6:IP6\").Find(str1),Range(\"E6:IP6\").Find(str1).End(xlDown))\n\n\nFor j = 1 To UBound(ar1, 1)\n  output = output &amp; ar1(j, 1) &amp; \",\" &amp; ar2(j, 1) &amp; vbNewLine\nNext\n\nOpen Path &amp; \"\\text_data.txt\" For Output As #1\nPrint #1, output\nClose\nEnd Sub\n</code></pre>\n\n<p>My new code attempt is as follows, however I keep getting a Run time error '1004 - Application defined or object-defined error.L when the code gets to the line where I set the ar2 array</p>\n\n<pre><code>ar2 = Range(rng1.Offset(0, 0), rng1.Offset(216, 0))\n\n\nSub test()\n\nDim ar1 As Variant\nDim rng1 As Range\nDim ar2 As Variant\nDim Path As String\nDim j As Long 'counter\nDim output As String\n\nPath = ActiveWorkbook.Path\n\nar1 = Worksheets(\"Sheet1\").Range(\"C6:C222\").Value\n\nset rng1 = Application.InputBox(\"Select data heading from row 6\", _\n        \"Obtain String\", Type:=8)\n\nar2 = Range(rng1.Offset(0, 0), rng1.Offset(216, 0))\n\nFor j = 1 To UBound(ar1, 1)\n  output = output &amp; ar1(j, 1) &amp; \",\" &amp; ar2(j, 1) &amp; vbNewLine\nNext\n\nOpen Path &amp; \"\\text_data.txt\" For Output As #1\nPrint #1, output\nClose\nEnd Sub\n</code></pre>\n\n<p>Any help is gratefully appreciated</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 722, "user_id": 3480717, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EXE4G.jpg?s=128&g=1", "display_name": "Jacek Kotowski", "link": "https://stackoverflow.com/users/3480717/jacek-kotowski"}, "edited": false, "score": 0, "creation_date": 1426800677, "post_id": 29117591, "comment_id": 46531534, "body": "Thank you very much, Rory. It is great! will try it out."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1426668842, "creation_date": 1426668842, "answer_id": 29117591, "question_id": 29111318, "link": "https://stackoverflow.com/questions/29111318/excel-udf-to-return-array-from-ace-sql-recordset/29117591#29117591", "title": "Excel UDF to return array from ACE SQL recordset", "body": "<p>If you want the field names, you will have to loop through the array from the recordset too:</p>\n\n<pre><code>With rs\n    If Not .EOF Then\n        vData = .getrows()\n\n        ReDim vDataOut(LBound(vData, 2) To UBound(vData, 2) + 1, LBound(vData, 1) To UBound(vData, 1))\n        ' get headers\n        For i = 1 To .Fields.Count\n            vDataOut(0, i - 1) = .Fields(i - 1).Name\n        Next i\n        ' Copy data\n        For x = LBound(vData, 2) To UBound(vData, 2)\n            For y = LBound(vData, 1) To UBound(vData, 1)\n                vDataOut(x + 1, y) = vData(y, x)\n            Next y\n        Next x\n    End If\nEnd With\n</code></pre>\n\n<p>for example.</p>\n"}], "owner": {"reputation": 722, "user_id": 3480717, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EXE4G.jpg?s=128&g=1", "display_name": "Jacek Kotowski", "link": "https://stackoverflow.com/users/3480717/jacek-kotowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 1, "accepted_answer_id": 29117591, "answer_count": 1, "score": 1, "last_activity_date": 1594645212, "creation_date": 1426633246, "last_edit_date": 1594645212, "question_id": 29111318, "link": "https://stackoverflow.com/questions/29111318/excel-udf-to-return-array-from-ace-sql-recordset", "title": "Excel UDF to return array from ACE SQL recordset", "body": "<p>I am trying to use ACE sql to return array from recordset. The  function works well with table ranges.</p>\n\n<p><strong>Problem:</strong> the function  returns the right number of records if the query returns 2 or more records. However if only one record is found, all rows are filled repetitively with this one row. This is wrong but I cannot find the reason why.</p>\n\n<p>In addition, I wish my function would return column names from Recordset. I have no idea how to glue it together with the array returned from recordset. </p>\n\n<p>Here is the code, credits are due to the author of another solution that I am trying to adapt to my needs:  <a href=\"https://stackoverflow.com/questions/19755396/performing-sql-queries-on-an-excel-table-within-a-workbook-with-vba-macro/28879494#28879494\">Performing SQL queries on an Excel Table within a Workbook with VBA Macro</a></p>\n\n<pre><code>Function SQL(dataRange As Range, CritA As String) As Variant\nApplication.Volatile\n\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim currAddress As String\n\ncurrAddress = ActiveSheet.Name &amp; \"$\" &amp; dataRange.Address(False, False)\n\nstrFile = ThisWorkbook.FullName\nstrCon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strFile _\n&amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;IMEX=1\"\";\"\n\nSet cn = CreateObject(\"ADODB.Connection\")\nSet rs = CreateObject(\"ADODB.Recordset\")\n\ncn.Open strCon\n\n\nstrSQL = \"SELECT * FROM [\" &amp; currAddress &amp; \"]\" &amp; _\n         \"WHERE [A] =  '\" &amp; CritA &amp; \"'  \" &amp; _\n         \"ORDER BY 1 ASC\"\n\nrs.Open strSQL, cn\n\n'SQL = rs.GetString\nSQL = Application.Transpose(rs.GetRows)\n\n\nSet rs = Nothing\nSet cn = Nothing\n\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 1079093, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/14f127499bff3cdd17bb0204e55948ac?s=128&d=identicon&r=PG", "display_name": "Hauns TM", "link": "https://stackoverflow.com/users/1079093/hauns-tm"}, "edited": false, "score": 0, "creation_date": 1426632039, "post_id": 29110993, "comment_id": 46451349, "body": "Is tmp really always an integer?"}, {"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "reply_to_user": {"reputation": 1688, "user_id": 1079093, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/14f127499bff3cdd17bb0204e55948ac?s=128&d=identicon&r=PG", "display_name": "Hauns TM", "link": "https://stackoverflow.com/users/1079093/hauns-tm"}, "edited": false, "score": 0, "creation_date": 1426636851, "post_id": 29110993, "comment_id": 46452894, "body": "I have looked on internet and I think so..."}], "owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1426632042, "answer_count": 0, "score": 0, "last_activity_date": 1426688184, "creation_date": 1426631678, "last_edit_date": 1426688184, "question_id": 29110993, "link": "https://stackoverflow.com/questions/29110993/vba-same-number-in-other-sheet-it-will-delete-the-entire-row-other-sheet", "closed_reason": "Duplicate", "title": "VBA Same number in other sheet, it will delete the entire row (other sheet)", "body": "<p>In <code>Sheet1</code> I have one cell <code>A3</code> (containing e.g. <code>52</code>):</p>\n\n<p><img src=\"https://i.stack.imgur.com/1R6i5.jpg\" alt=\"enter image description here\"></p>\n\n<pre><code>Dim wbThis As Workbook\nDim wsThis As Worksheet\nDim wsTarget As Worksheet\nDim tmp As Integer\n\n\n    Set wbThis = ActiveWorkbook\n    Set wsThis = wbThis.Sheets(1)\n    Set wsTarget = wbThis.Sheets(2)\n\n\n\n    For i=1 To 100      \n        wsThis.Activate\n        tmp = wsThis.Cells(3, i).Value\n        For j=3 To 100\n            wsTarget.Activate\n            If Cells(j,1).Value = tmp Then\n                Cells(j,1).EntireRow.Delete\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p>But still have a problem : <code>tmp = wsThis.Cells(3, i).Value----&gt; Error written : Incompatible Type</code> </p>\n\n<p>And I tried another code but it doesn't work, the row is not deleted.</p>\n\n<pre><code>Sub delete_ligne()\nDim rng as Range\nDim WB as Workbook\nDim i As Integer\n\n  Application.ScreenUpdating = False\n  Set WB = 'define your workbook here\n  Set rng = WB.Sheet(2).Range(\"B:B\").Find (What:=WB.Sheet(1).Range(\"A3\"), _\n          LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n  While not Rng is Nothing\n    rng.Rows(1).EntireRow.Delete\n    Set rng = WB.Sheet(2).Range(\"B:B\").Find (What:=WB.Sheet(1).Range(\"A3\"), _\n              LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n  Wend\n\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "character", "contains", "vba"], "comments": [{"owner": {"reputation": 12629, "user_id": 546871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/p1diY.jpg?s=128&g=1", "display_name": "AdrianHHH", "link": "https://stackoverflow.com/users/546871/adrianhhh"}, "edited": false, "score": 2, "creation_date": 1426631986, "post_id": 29110963, "comment_id": 46451329, "body": "Please don&#39;t just ask us to solve the problem for you. Show us how you tried to solve the problem yourself, then show us exactly what the result was, and tell us why you feel it didn&#39;t work. See also the help pages (linked at the top of every page) for how to write a good question."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1426632703, "post_id": 29110963, "comment_id": 46451601, "body": "Probably overkill, but one way is to use <a href=\"http://stackoverflow.com/q/22542834/2521004\">VBA Regex</a>"}], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 4682879, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/y4f9X.png?s=128&g=1", "display_name": "MapEngine", "link": "https://stackoverflow.com/users/4682879/mapengine"}, "edited": false, "score": 0, "creation_date": 1426669968, "post_id": 29111215, "comment_id": 46463343, "body": "This works well, however it returns &quot;Good&quot; when the cell is completely empty."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1426632737, "creation_date": 1426632737, "answer_id": 29111215, "question_id": 29110963, "link": "https://stackoverflow.com/questions/29110963/how-do-i-check-if-a-cell-only-contains-characters-from-a-specific-list/29111215#29111215", "title": "How do I check if a cell only contains characters from a specific list?", "body": "<p>Give this <em>UDF()</em> a try:</p>\n\n<pre><code>Public Function CellTest(sIn As Variant) As String\n    Dim L As Long, i As Long, CH As String\n    L = Len(sIn)\n\n    For i = 1 To L\n        CH = Mid(sIn, i, 1)\n        If IsNumeric(CH) Or CH = \"/\" Then\n        Else\n            CellTest = \"No Good\"\n            Exit Function\n        End If\n    Next i\n\n    CellTest = \"Good\"\nEnd Function\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/OX9IG.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 3, "last_activity_date": 1426634370, "last_edit_date": 1426634370, "creation_date": 1426633208, "answer_id": 29111309, "question_id": 29110963, "link": "https://stackoverflow.com/questions/29110963/how-do-i-check-if-a-cell-only-contains-characters-from-a-specific-list/29111309#29111309", "title": "How do I check if a cell only contains characters from a specific list?", "body": "<p>With a formula (in B1 and copied down if <code>12</code> is in A1):  </p>\n\n<pre><code>=IF(ISNUMBER(VALUE(SUBSTITUTE(A1,\"/\",\"\"))),\"OK\",\"ERROR\")  \n</code></pre>\n\n<p>Adding in exclusion of <code>.</code> makes it a bit longer:  </p>\n\n<pre><code>=IF(AND(ISERROR(FIND(\".\",A1)),ISNUMBER(VALUE(SUBSTITUTE(A1,\"/\",\"\")))),\"OK\",\"ERROR\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1426643655, "creation_date": 1426643655, "answer_id": 29112890, "question_id": 29110963, "link": "https://stackoverflow.com/questions/29110963/how-do-i-check-if-a-cell-only-contains-characters-from-a-specific-list/29112890#29112890", "title": "How do I check if a cell only contains characters from a specific list?", "body": "<p>For a  formula approach, the following <strong>array-entered</strong> formula will return TRUE or FALSE depending on the presence of non-allowed characters.  To confirm the formula, hold down <kbd>ctrl-shift</kbd> while hitting <kbd>enter</kbd> and Excel will place braces <strong>{...}</strong> around the formula.</p>\n\n<pre><code>=AND(CODE(MID(A1,ROW(INDIRECT(\"1:\"&amp;LEN(A1))),1))&gt;=47,CODE(MID(A1,ROW(INDIRECT(\"1:\"&amp;LEN(A1))),1))&lt;=57)\n</code></pre>\n\n<p>You can use this as logical_test in an IF function to return whatever you want.</p>\n"}], "owner": {"reputation": 471, "user_id": 4682879, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/y4f9X.png?s=128&g=1", "display_name": "MapEngine", "link": "https://stackoverflow.com/users/4682879/mapengine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3739, "favorite_count": 0, "accepted_answer_id": 29111215, "answer_count": 3, "score": 2, "last_activity_date": 1426643655, "creation_date": 1426631529, "last_edit_date": 1531161705, "question_id": 29110963, "link": "https://stackoverflow.com/questions/29110963/how-do-i-check-if-a-cell-only-contains-characters-from-a-specific-list", "title": "How do I check if a cell only contains characters from a specific list?", "body": "<p>I'm trying to do a check on a data column to see if its rows only contain specific characters. The characters in question are <code>0</code>-<code>9</code> and <code>/</code>. If only those are present, an <code>OK</code> should be returned, otherwise an error (or 1 and 0, anything distinguishable is fine). It should basically look like this (bold column):</p>\n\n<p><img src=\"https://i.stack.imgur.com/xMnGh.png\" alt=\"https://i.imgur.com/IrJuZ47.png\"></p>\n\n<p>I had limited success with MATCH and VLOOKUP but nothing that employs a range. A formula would be preferred but VBA's cool too. Any ideas?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4682876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7829469fef977089015f3a8775361ec?s=128&d=identicon&r=PG&f=1", "display_name": "Dorostenka", "link": "https://stackoverflow.com/users/4682876/dorostenka"}, "edited": false, "score": 0, "creation_date": 1426660617, "post_id": 29110990, "comment_id": 46459264, "body": "Hi pnuts, thank you for your answer. I tried it but not sure I am reading your instruction correctly.  I would attach my test spreadsheet but not sure if I can on here."}, {"owner": {"reputation": 3, "user_id": 4682876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7829469fef977089015f3a8775361ec?s=128&d=identicon&r=PG&f=1", "display_name": "Dorostenka", "link": "https://stackoverflow.com/users/4682876/dorostenka"}, "edited": false, "score": 1, "creation_date": 1426691595, "post_id": 29110990, "comment_id": 46477545, "body": "fantastic, got it now and it is working perfectly. Thank you so much."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 0, "last_activity_date": 1426679166, "last_edit_date": 1426679166, "creation_date": 1426631666, "answer_id": 29110990, "question_id": 29110827, "link": "https://stackoverflow.com/questions/29110827/recalculate-currency-by-selection-curency-symbol-from-drop-down-box/29110990#29110990", "title": "recalculate currency by selection curency symbol from drop down box", "body": "<p>Add a column for the converted values, calculated as the Euro values (ColumnB) multiplied by say E1:  </p>\n\n<pre><code>=IF(B2&lt;&gt;\"\",B2*E$1,\"\")  \n</code></pre>\n\n<p>with the formula in say D2 and copied down to suit. D1 might hold your drop-down list, driven from a lookup table that next to the currency indicator (immediately to the right) holds the conversion factor. Say that table is H1:I3, then in E1:  </p>\n\n<pre><code>  =VLOOKUP(D1,H1:I3,2,0) \n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/2sx3v.jpg\" alt=\"SO29110827 example\"></p>\n"}], "owner": {"reputation": 3, "user_id": 4682876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7829469fef977089015f3a8775361ec?s=128&d=identicon&r=PG&f=1", "display_name": "Dorostenka", "link": "https://stackoverflow.com/users/4682876/dorostenka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 29110990, "answer_count": 1, "score": 0, "last_activity_date": 1426679166, "creation_date": 1426630823, "last_edit_date": 1531161705, "question_id": 29110827, "link": "https://stackoverflow.com/questions/29110827/recalculate-currency-by-selection-curency-symbol-from-drop-down-box", "title": "recalculate currency by selection curency symbol from drop down box", "body": "<p>I need to recalculate the value every time user selects a currency from drop down box.</p>\n\n<p>Example </p>\n\n<p>column A   column B\nproduct 1  25\nproduct 2  34\nproduct 3  16</p>\n\n<p>lets assume that the value in column B is in Euro, I need to create a drop down box that contains EURO, USD, GBP and so on.\nEvery time I select one of the currency from drop down list I want column B to recalculate based on currency rate between Euro and the selected currency.</p>\n\n<p>Any ideas how to do it?</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 4651719, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/58e3cd661adc7756f3a3ef22c4bc2074?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Abdur Rahim", "link": "https://stackoverflow.com/users/4651719/md-abdur-rahim"}, "edited": false, "score": 0, "creation_date": 1426635472, "post_id": 29110771, "comment_id": 46452481, "body": "its working.thanks a lot.I have another question.If there is values in column D of text in column A in sheet1. According to value I want assign color from white to red( 0 to higher ) and past it into result sheet(sheet2) as a cell background with text according to row and column. could you please help  me?"}, {"owner": {"reputation": 129, "user_id": 4651719, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/58e3cd661adc7756f3a3ef22c4bc2074?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Abdur Rahim", "link": "https://stackoverflow.com/users/4651719/md-abdur-rahim"}, "edited": false, "score": 0, "creation_date": 1426674655, "post_id": 29110771, "comment_id": 46466099, "body": "its working.thanks a lot.I have another question.If there is values in column D of text in column A in sheet1. According to value I want assign color from white to red( 0 to higher ) and past it into result sheet(sheet2) as a cell background with text according to row and column. could you please help me? @vockz"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 129, "user_id": 4651719, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/58e3cd661adc7756f3a3ef22c4bc2074?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Abdur Rahim", "link": "https://stackoverflow.com/users/4651719/md-abdur-rahim"}, "edited": false, "score": 0, "creation_date": 1426682293, "post_id": 29110771, "comment_id": 46470875, "body": "I&#39;ve amended my original answer to incorporate changing the cells colours too. I&#39;m not sure how you would do it aside from using an If statement like I have, there may be a more efficient way. You will have to find out what the colours you want to use &quot;xlThemeColorAccent&quot; number is. Hope that works for you."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1426682221, "last_edit_date": 1426682221, "creation_date": 1426630582, "answer_id": 29110771, "question_id": 29110411, "link": "https://stackoverflow.com/questions/29110411/how-to-copy-text-from-column-of-active-sheet-and-past-it-to-another-sheet-accord/29110771#29110771", "title": "how to copy text from column of active sheet and past it to another sheet according to the specific row and column number which are in active sheet", "body": "<p>This should work for you.</p>\n\n<pre><code>Option Explicit\nSub copy_rng()\n    Dim wb As Workbook, ws1 As Worksheet, ws2 As Worksheet\n    Dim i As Integer\n    Dim lrow As Long\n    Dim myArray() As Variant\n    Set wb = ThisWorkbook\n    Set ws1 = wb.Sheets(\"Sheet1\")\n    Set ws2 = wb.Sheets(\"Sheet2\")\n\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\n    myArray() = ws1.Range(Cells(1, 1), Cells(lrow, 3)).Value\n    ws2.Activate\n    For i = 1 To UBound(myArray)\n        Cells(myArray(i, 2), myArray(i, 3)).Value2 = myArray(i, 1)\n        If myArray(i, 4) = 1 Then\n            Cells(myArray(i, 2), myArray(i, 3)).Interior.ThemeColor = xlThemeColorAccent1 'blue\n        ElseIf myArray(i, 4) = 2 Then\n            Cells(myArray(i, 2), myArray(i, 3)).Interior.ThemeColor = xlThemeColorAccent2 'red\n        ElseIf myArray(i, 4) = 3 Then\n            Cells(myArray(i, 2), myArray(i, 3)).Interior.ThemeColor = xlThemeColorAccent3 'green\n        ElseIf myArray(i, 4) = 4 Then\n            Cells(myArray(i, 2), myArray(i, 3)).Interior.ThemeColor = xlThemeColorAccent6 'orange\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>You can create an array with the data from worksheet 1, and then use the row and column number from the array to copy the data from column A into the correct cells.</p>\n"}], "owner": {"reputation": 129, "user_id": 4651719, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/58e3cd661adc7756f3a3ef22c4bc2074?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Abdur Rahim", "link": "https://stackoverflow.com/users/4651719/md-abdur-rahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 29110771, "answer_count": 1, "score": 0, "last_activity_date": 1593759219, "creation_date": 1426629167, "last_edit_date": 1593759219, "question_id": 29110411, "link": "https://stackoverflow.com/questions/29110411/how-to-copy-text-from-column-of-active-sheet-and-past-it-to-another-sheet-accord", "title": "how to copy text from column of active sheet and past it to another sheet according to the specific row and column number which are in active sheet", "body": "<p>I am new to excel vba. I want to write a macro which can copy text value of a column A of active sheet from first row to last row and past it to another sheet of same wordbook. But the complex part is that I have to paste these text according to specific row and column number which are given in active sheet in column B and C. </p>\n\n<p>This is an example of my data in active sheet:</p>\n\n<pre><code>    column A    column B     column C            \n   text value      row       column\n        aaaa        1         1  \n        aaaa        1         2  \n        bbbb        1         3  \n        bbbb        1         4\n        cccc        1         5\n        cccc        1         6\n        dddd        2         1\n        dddd        2         2\n        dddd        2         3\n        eeee        2         4\n        eeee        2         5\n        ffff        2         6\n</code></pre>\n\n<p>and so on.</p>\n\n<p>The result sheet  should be:</p>\n\n<pre><code>    column A   column B    column C   column D    column E   column F  ..... \n1   aaaa        aaaa        bbbb        bbbb       cccc        cccc\n2   dddd        dddd        dddd        eeee       eeee        ffff\n3\n4\n</code></pre>\n"}, {"tags": ["email", "excel", "outlook", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2817, "user_id": 1963973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5364da37e0b8fcf0af75906ee36b84fd?s=128&d=identicon&r=PG", "display_name": "marianosimone", "link": "https://stackoverflow.com/users/1963973/marianosimone"}, "edited": false, "score": 0, "creation_date": 1426629192, "post_id": 29110295, "comment_id": 46450210, "body": "Try to put the code into a code block in your question, as it&#39;s very hard to read it otherwise: <a href=\"http://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a>"}, {"owner": {"reputation": 14050, "user_id": 1858225, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8afcf8a38024eb5b17c0b0b58ff96d79?s=128&d=identicon&r=PG", "display_name": "Kyle Strand", "link": "https://stackoverflow.com/users/1858225/kyle-strand"}, "edited": false, "score": 0, "creation_date": 1426636397, "post_id": 29110295, "comment_id": 46452737, "body": "Please avoid repeating the same information over and over."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4682623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d4fc4b85f61cce537e246c7b543313?s=128&d=identicon&r=PG&f=1", "display_name": "\u017delim Znati Vi\u0161e", "link": "https://stackoverflow.com/users/4682623/%c5%bdelim-znati-vi%c5%a1e"}, "edited": false, "score": 0, "creation_date": 1426862540, "post_id": 29124580, "comment_id": 46556612, "body": "Hi @Eugene  I&#39;m sure you just wrote me a solution to my problem, but I don&#39;t know exactly how to use these commands.  Please can you write me a VBA code you would use to do what I&#39;m trying to do? These commands you suggested don&#39;t mean much to me beacuse I don&#39;t know how to correctly use them.."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1426688434, "creation_date": 1426688434, "answer_id": 29124580, "question_id": 29110295, "link": "https://stackoverflow.com/questions/29110295/how-to-make-an-excel-table-that-automatically-sends-email-to-someone-on-his-birt/29124580#29124580", "title": "How to make an excel table that automatically sends email to someone on his birthday?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865320(v=office.15).aspx\" rel=\"nofollow\">Recipients</a> property of the MailItem class returns a Recipients collection that represents all the recipients for the Outlook item. </p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866751.aspx\" rel=\"nofollow\">Recipients</a> class provides the the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866951.aspx\" rel=\"nofollow\">Add</a> method to create a new Recipient object and add it to the Recipients object. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863703.aspx\" rel=\"nofollow\">Type</a> property returns or sets the type of recipient. It can be one of the following <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865653.aspx\" rel=\"nofollow\">OlMailRecipientType</a> constants: olBCC, olCC, olOriginator, or olTo.</p>\n\n<p>So, you can send the single email to all people. You just need to add them to the Recipients collection. Or, if you need to have individual message bodies, you can create separate email messages.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869452(v=office.15).aspx\" rel=\"nofollow\">DeferredDeliveryTime</a> property of the MailItem class allows to set a Date indicating the date and time the mail message is to be delivered.</p>\n"}], "owner": {"reputation": 3, "user_id": 4682623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d4fc4b85f61cce537e246c7b543313?s=128&d=identicon&r=PG&f=1", "display_name": "\u017delim Znati Vi\u0161e", "link": "https://stackoverflow.com/users/4682623/%c5%bdelim-znati-vi%c5%a1e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1426688434, "creation_date": 1426628676, "last_edit_date": 1531161705, "question_id": 29110295, "link": "https://stackoverflow.com/questions/29110295/how-to-make-an-excel-table-that-automatically-sends-email-to-someone-on-his-birt", "title": "How to make an excel table that automatically sends email to someone on his birthday?", "body": "<p>I need to write a formula that recognizes when someone's birthday is and trigger www.zapier.com.]</p>\n\n<p>I have a birthday-recognition formula that creates a \"send email\" hyperlink, but I need it to be automatically sent (and delayed to 10am) non-interactively. I also did something in VBA but I only managed to write code that sends that message to 1 person.</p>\n\n<p>Here's the working birthday-recognition formula. Client names are in column C8:C100, emails are in D8:D100, DOBs are in E8:E100 and the \"send mail\" hyperlinks are in F:100.</p>\n\n<pre><code>=IF(TEXT(E13;\"d.m\")=TEXT(TODAY();\"d.m\");HYPERLINK(\"mailto:\"&amp;D13&amp;\"? subject=\"&amp;$D$2&amp;\"&amp;body=\"&amp;SUBSTITUTE(SUBSTITUTE($E$3;\"$\";C13);\"@\";$D$4);\"po\u0161alji \u010destitku\");\"\")\n</code></pre>\n\n<p>\"po\u0161alji \u010destitku\" = send mail (croatian language)</p>\n\n<p>VBA code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nPO\u0160ALJIRO\u0110ENDANSKE\u010cESTITKE\n\nEnd Sub\n\nPublic Function PO\u0160ALJIRO\u0110ENDANSKE\u010cESTITKE()\n\nDim olApp As Outlook.Application\n\nSet olApp = CreateObject(\"Outlook.Application\")\n\n Dim olMail As Outlook.MailItem\n\n Set olMail = olApp.CreateItem(olMailItem)\n\n olMail.To = Cells.Range(\"D8:D1000\")\n\n olMail.subject = \"Sretan ro\u0111endan\"\n\n olMail.Body = \"Po\u0161tovani,\" &amp; vbCrLf &amp; vbCrLf &amp; \"\u017delimo Vam sretan ro\u0111endan\"\n\n&amp; vbCrLf &amp; vbCrLf &amp; \"Sve najbolje,\" &amp; vbCrLf &amp; vbCrLf &amp; \"svinaweb\"\n\n olMail.Send\n\nEnd Function\n</code></pre>\n\n<p>This code just sends the message to one email when I click on the command button, but as I said I want it to be sent to every person that has a birthday today and to delay the sending of the emails to 10am instead of midnight.</p>\n\n<p>I am using Excel 2013.</p>\n"}, {"tags": ["csv", "ms-access", "import", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1426630446, "post_id": 29110225, "comment_id": 46450790, "body": "What have you tried till now? You can use FileCopy command ;) See: <a href=\"https://msdn.microsoft.com/en-us/library/2s1c774y%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/2s1c774y%28v=vs.90%29.aspx</a>"}, {"owner": {"reputation": 31, "user_id": 4682582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c6ca48c129d644aa3fca343eea48cc9?s=128&d=identicon&r=PG&f=1", "display_name": "NGusCar", "link": "https://stackoverflow.com/users/4682582/nguscar"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1426706251, "post_id": 29110225, "comment_id": 46487291, "body": "I have tried some snipplets of code here and there, but nothing comprehensive. You suggestion helps. Thank you. But, how is it different than the NAME OldPathName As NewPathName?"}, {"owner": {"reputation": 31, "user_id": 4682582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c6ca48c129d644aa3fca343eea48cc9?s=128&d=identicon&r=PG&f=1", "display_name": "NGusCar", "link": "https://stackoverflow.com/users/4682582/nguscar"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1426706374, "post_id": 29110225, "comment_id": 46487364, "body": "Also, I think I am more in need of a way (method) to extract the Section number from the file name. This would help in making sure the file is imported as a unique Table in Access with the DoCmd.Transfertext."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4682582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c6ca48c129d644aa3fca343eea48cc9?s=128&d=identicon&r=PG&f=1", "display_name": "NGusCar", "link": "https://stackoverflow.com/users/4682582/nguscar"}, "edited": false, "score": 0, "creation_date": 1426791299, "post_id": 29110808, "comment_id": 46526823, "body": "Thanks! I appreciate this code. I tried it and works, but I also have found something more intricate."}, {"owner": {"reputation": 31, "user_id": 4682582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c6ca48c129d644aa3fca343eea48cc9?s=128&d=identicon&r=PG&f=1", "display_name": "NGusCar", "link": "https://stackoverflow.com/users/4682582/nguscar"}, "edited": false, "score": 0, "creation_date": 1426797913, "post_id": 29110808, "comment_id": 46530160, "body": "I am trying to post my code but it wont happen as easily I as I thought."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1426758354, "last_edit_date": 1426758354, "creation_date": 1426630735, "answer_id": 29110808, "question_id": 29110225, "link": "https://stackoverflow.com/questions/29110225/vba-importing-long-file-names/29110808#29110808", "title": "VBA Importing long file names", "body": "<p>I'd suggest to use <a href=\"https://msdn.microsoft.com/en-us/library/2s1c774y%28v=vs.90%29.aspx\" rel=\"nofollow\">FileCopy function</a> before you start importing data from csv file into MS Access.</p>\n\n<pre><code>Dim OldPathName As String, NewPathName As String\nOldPathName = \"FullPathToVeryVeryLonLongLongFileName.csv\"\nNewPathName = \"FullPathToShortFileName.csv\"\nFileCopy OldPathName, NewPathName  \nDoCmd.TransferText acImport, \"AME_Grades\", strTable, NewPathName, blnHasFieldName\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4682582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c6ca48c129d644aa3fca343eea48cc9?s=128&d=identicon&r=PG&f=1", "display_name": "NGusCar", "link": "https://stackoverflow.com/users/4682582/nguscar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 816, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594652439, "creation_date": 1426628398, "last_edit_date": 1594652439, "question_id": 29110225, "link": "https://stackoverflow.com/questions/29110225/vba-importing-long-file-names", "title": "VBA Importing long file names", "body": "<p>I have a .csv file on my Desktop. The file name is very long and includes special characters such as brackets, e.g.: </p>\n\n<pre><code>[ABCD 012015] ACCT 1117 - Section A10 Grades-20150316_1937-comma_separated.csv\n</code></pre>\n\n<p>where the first 36 characters of the filename are a constant. The remainder of the file name changes upon each instance of a download.\nI have tried VBA to import the file into an Access with a DoCmd.TransferText and I get errors. I have discovered that there is a limit to the length of a filename that the <strong>DoCmd.TransfertText</strong> can handle. \nSo, I need to first rename the file manually, then I can use VBA. Renaming a file is relatively easy with VBA, but I would like to use the info provided in the original filename such as Section A10 (which would make it unique, since there are other Sections labelled A01, A02, etc.) and rename the .csv file as A10.csv, so this means searching for a string AND replacing it. Since the Section can be different, how do I write the code and rename the file then import it with VBA?\nSo, far I have bits and pieces, but cannot put them together:</p>\n\n<pre><code>Name OldPathName As NewPathName\n\nDoCmd.TransferText acImport, \"AME_Grades\", strTable, strPathFile, blnHasFieldNames\n</code></pre>\n\n<p>I am using an import specification AME_Grades to make it cleaner in the Access table.\nAny suggestions? TIA</p>\n"}, {"tags": ["excel", "vba", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1426629252, "last_edit_date": 1426629252, "creation_date": 1426628873, "answer_id": 29110352, "question_id": 29110127, "link": "https://stackoverflow.com/questions/29110127/how-do-i-know-if-my-sort-worked-in-excel-vba/29110352#29110352", "title": "how do I know if my sort worked in excel vba?", "body": "<p>I always use Sheet.Range.Sort not Sheet.Sort </p>\n\n<pre><code> lLastRow = LastUsedRow(shMain)\n\n shMain.Range(\"A1:W\" &amp; lLastRow).SORT Key1:=.Range(\"B2\"), _\n                                      Order1:=xlAscending, _\n                                      Header:=xlYes, _\n                                      OrderCustom:=1, _\n                                      MatchCase:=False, _\n                                      Orientation:=xlTopToBottom, _\n                                      DataOption1:=xlSortNormal\n</code></pre>\n\n<p>Never had a problem with this sorting the range and you can add Key2,Order2 and DataOption2 to sort by multiple columns</p>\n"}], "owner": {"reputation": 6397, "user_id": 1472743, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f205382e9fa00ee4bdf653ec92a34679?s=128&d=identicon&r=PG", "display_name": "dwstein", "link": "https://stackoverflow.com/users/1472743/dwstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426629252, "creation_date": 1426627988, "question_id": 29110127, "link": "https://stackoverflow.com/questions/29110127/how-do-i-know-if-my-sort-worked-in-excel-vba", "title": "how do I know if my sort worked in excel vba?", "body": "<p>I recorded the following macro when sorting data:</p>\n\n<pre><code>Sub sort_sheet_test()\n    ActiveWindow.ScrollRow = 1\n    ActiveWindow.ScrollColumn = 1\n    Range(\"A1:AB40905\").Select\n    ActiveWorkbook.Worksheets(\"flurry_an_output.csv\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"flurry_an_output.csv\").Sort.SortFields.Add Key:= _\n    Range(\"AB2:AB40905\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n    DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"flurry_an_output.csv\").Sort\n        .SetRange Range(\"A1:AB40905\")\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>I then wrote my own function to use generically in other sheets...etc:</p>\n\n<pre><code>Function sort_sheet_last_column(sheet_name As String)\n\n    Dim rows1 As Long\n    rows1 = Get_Rows_Generic(sheet_name, 1) '  get the number of rows in the sheet\n\n    Dim columns1 As Integer\n    columns1 = Range(find_last_column(sheet_name)).column ' get the number of columns in the sheet\n\n    Dim sort_range As Range\n    Dim key_range As Range\n    With Worksheets(sheet_name)\n        Set sort_range = .Range(.Cells(1, 1), .Cells(rows1, columns1)) ' set up range: the whole used portion of the sheet\n        Set key_range = .Range(.Cells(1, columns1), .Cells(rows1, columns1))\n    End With\n\n    With Worksheets(sheet_name).Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=key_range, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .SetRange sort_range\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n\n    End With\n\nEnd Function\n</code></pre>\n\n<p>It seems to reorder the rows based on the right key, but how do I know if my version is 1) working at all (it's hard to know if over 40,000 rows are ordered properly, and 2) how do I know if the rest of the data are in their proper order?</p>\n"}, {"tags": ["excel", "hyperion", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "is_accepted": false, "score": 0, "last_activity_date": 1426688542, "creation_date": 1426688542, "answer_id": 29124620, "question_id": 29110004, "link": "https://stackoverflow.com/questions/29110004/excel-smartview-vb-function-hypconnect-not-working-error-code-100000/29124620#29124620", "title": "Excel SmartView vb function HypConnect not working / error code 100000", "body": "<p>As many times as I checked it yesterday, I had the server name incorrect and couldn't find it.  Today, with fresher eyes, I found the problem and the above code works fine.  Although the problem was actually in the HypCreateConnection line, that function call returned a 0 error code.  Then using HypConnect with an invalid connection caused the error - and returned an undocumented error code.  </p>\n"}], "owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4583, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502807333, "creation_date": 1426627502, "last_edit_date": 1531164843, "question_id": 29110004, "link": "https://stackoverflow.com/questions/29110004/excel-smartview-vb-function-hypconnect-not-working-error-code-100000", "title": "Excel SmartView vb function HypConnect not working / error code 100000", "body": "<p>In the code below, I am trying to automate SmartView retrievals in a number of worksheets.  The code seems to work OK up to the point that I create a connection before I start the loop.  Inside the loop, I want to use HypConnect to use the connection - but it returns an rerror code of 100000 and doesn't connect.  When I test some of the status variables, I see that the conection exists but that the sheet isn't connected.</p>\n\n<p>I've copied in the full smartview.bas file into another module in the same workbook.</p>\n\n<p>At the point when I call HypConnect, all four arguments are defined and have the proper values.</p>\n\n<p>I don't know what else may be wrong.</p>\n\n<pre><code>Sub Retrieval()\n\nURL = Sheets(\"Index\").Range(\"E5\").Value\nServer = Sheets(\"Index\").Range(\"E6\").Value\nApp = Sheets(\"Index\").Range(\"E7\").Value\nDb = Sheets(\"Index\").Range(\"E8\").Value\nUserId = Sheets(\"Index\").Range(\"E10\").Value\npsw = InputBox(\"Password\")\nDSN = \"Source\"\n\nx = HypDisconnectAll()\nIf HypConnectionExists(DSN) Then x = HypRemoveConnection(DSN)\nx = HypCreateConnection( _\n    Empty, _\n    UserId, _\n    psw, _\n    \"Essbase\", _\n    URL, _\n    Server, _\n    App, _\n    Db, _\n    DSN, _\n    \"Connection for retrievals\")\nx = HypSetConnAliasTable(\"Source\", \"Code_and_Desc\")\nx = HypSetGlobalOption(5, 3)     'turn off warnings\nx = HypSetGlobalOption(6, True)  'use thousands separator\nx = HypSetGlobalOption(15, True) 'retain formats\n\nFor Each Sheet In Worksheets\n    Sheet.Activate\n    RR = Range(\"A1\").Value\n    If RR = \"\" Then RR = \"A1\"\n    If RR &lt;&gt; \"Do not retrieve\" Then\n        x = HypConnect(Sheet.Name, UserId, psw, DSN)\n\n        x = HypSetSheetOption(Sheet.Name, 5, 0)\n        x = HypSetSheetOption(Sheet.Name, 6, False)\n        x = HypSetSheetOption(Sheet.Name, 7, False)\n        x = HypSetSheetOption(Sheet.Name, 8, False)\n        x = HypSetSheetOption(Sheet.Name, 13, \"#numericzero\")\n        x = HypSetSheetOption(Sheet.Name, 16, 2)\n\n        x = HypRetrieveRange(Sheet.Name, RR, DSN)\n        End If\n\n    Next Sheet\n\nx = HypSetGlobalOption(5, 2) 'turn warnings back on\nx = HypRemoveConnection(DSN)\nx = HypDisconnectAll()\n\nMsgBox (\"Done\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "web", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1426627942, "post_id": 29110000, "comment_id": 46449621, "body": "Welcome to SO! There are many examples available freely through a little searching on your own that can help you get you started on your own project. If and when you run into trouble, come back and show your original effort, noting where the problem is and what error messages you have received."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 4682749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b275706318f741a652a34279ce72246?s=128&d=identicon&r=PG&f=1", "display_name": "RJk214", "link": "https://stackoverflow.com/users/4682749/rjk214"}, "is_accepted": false, "score": 0, "last_activity_date": 1431692725, "last_edit_date": 1431692725, "creation_date": 1426710139, "answer_id": 29131936, "question_id": 29110000, "link": "https://stackoverflow.com/questions/29110000/extracting-multiple-webpages-1-website-multiple-tabs-to-select-into-excel-wit/29131936#29131936", "title": "Extracting multiple webpages (1 Website, Multiple Tabs to select) into Excel with a macro", "body": "<p>Below is what I have been able to come up with thus so far! I don't know how to get it to loop or be able to get all the data I am looking for.. This is only getting the table for 1 of the many webpages I need...</p>\n\n<pre><code>Sub BasketballStats()\n\n    Dim xmlHttp As Object\n    Dim TR_col As Object, TR As Object\n    Dim TD_col As Object, TD As Object\n    Dim row As Long, col As Long\n\n    Set xmlHttp = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n    xmlHttp.Open \"GET\", \"http://www.foxsports.com/college-basketball/louisiana-tech-bulldogs-team-stats?season=2015&amp;category=SCORING&amp;type=1\", False\n    xmlHttp.setRequestHeader \"Content-Type\", \"text/xml\"\n    xmlHttp.send\n\n    Dim html As Object\n    Set html = CreateObject(\"htmlfile\")\n    html.body.innerHTML = xmlHttp.ResponseText\n\n    Dim tbl As Object\n    Set tbl = html.getElementById(\"curr_table\")\n\n    row = 1\n    col = 1\n\n    Set TR_col = html.getelementsbytagname(\"TR\")\n    For Each TR In TR_col\n        Set TD_col = TR.getelementsbytagname(\"TD\")\n        For Each TD In TD_col\n            Cells(row, col) = TD.innerText\n            col = col + 1\n        Next\n        col = 1\n        row = row + 1\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4682749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b275706318f741a652a34279ce72246?s=128&d=identicon&r=PG&f=1", "display_name": "RJk214", "link": "https://stackoverflow.com/users/4682749/rjk214"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431692725, "creation_date": 1426627486, "last_edit_date": 1531161705, "question_id": 29110000, "link": "https://stackoverflow.com/questions/29110000/extracting-multiple-webpages-1-website-multiple-tabs-to-select-into-excel-wit", "title": "Extracting multiple webpages (1 Website, Multiple Tabs to select) into Excel with a macro", "body": "<p>I am new to learning and understanding macros and am quite eager to learn!</p>\n\n<p>I am trying to extract data in the form of tables from 1 website but from multiple pages. Below is the first webpage</p>\n\n<p>1st Webpage - <a href=\"http://www.foxsports.com/college-basketball/abilene-christian-wildcats-team-stats?season=2014&amp;category=SCORING&amp;type=1\" rel=\"nofollow\">http://www.foxsports.com/college-basketball/abilene-christian-wildcats-team-stats?season=2014&amp;category=SCORING&amp;type=1</a></p>\n\n<p>I am looking to extract just the table from this webpage.. After that has been done, on the right side above the table you can see a drop down box with multiple selections (Teams). I would then like to continue getting the tables for each team (So from Abilene Christian --> Youngstown State)</p>\n\n<p>I hope I have provided enough clarity to be able to receive some help and feedback!</p>\n\n<p>Thank you so much</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1426627054, "post_id": 29109867, "comment_id": 46449215, "body": "you never increment <code>i</code>"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1426627427, "post_id": 29109867, "comment_id": 46449391, "body": "I know this question was to get working code, but you should never rely on  <code>.Activate</code> or <code>.Select</code>. <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 69, "user_id": 4158488, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf63034600ad17190b8ef6276016df4?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/4158488/steven"}, "edited": false, "score": 0, "creation_date": 1426681727, "post_id": 29109867, "comment_id": 46470496, "body": "Why do you never increment <code>i</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4158488, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf63034600ad17190b8ef6276016df4?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/4158488/steven"}, "edited": false, "score": 0, "creation_date": 1426685530, "post_id": 29110137, "comment_id": 46473173, "body": "I tried this solution, and while it populates the first cell with the first name, it doesn&#39;t have any effect on the other cells. Any idea what might be causing this?"}, {"owner": {"reputation": 69, "user_id": 4158488, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf63034600ad17190b8ef6276016df4?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/4158488/steven"}, "edited": false, "score": 0, "creation_date": 1426688726, "post_id": 29110137, "comment_id": 46475420, "body": "So I don&#39;t know why, but it seems that using Offset was the issue. I modified the reference to the target cell to use the same syntax you used to grab the name values, <code>(&quot;A&quot; &amp; I)</code>. Solved the problem. So I guess you cannot use Offset that way (although I used it to clear the very same cells just fine). Thank you!"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 0, "last_activity_date": 1426628019, "creation_date": 1426628019, "answer_id": 29110137, "question_id": 29109867, "link": "https://stackoverflow.com/questions/29109867/copying-cell-values-from-one-workbook-into-another/29110137#29110137", "title": "Copying cell values from one Workbook into another", "body": "<p>Try something like this. It will accomplish the task you are requesting without using <code>.Select</code> or <code>.Activate</code></p>\n\n<pre><code>Sub InitNames()\nDim i As Integer\nDim Wksht as Worksheet\ni = 0\n\nSet Wksht = Workbooks(\"Employee Data.xlsx\").Sheets(\"Employees\")\nFor i = 2 to Wksht.Range(\"A\" &amp; Wksht.Rows.Count).End(xlUp).Row\n    Workbooks(\"Timesheet\").Sheets(\"ST\").Range(\"A9\").Offset((i-2) * 9,0).Value = Wksht.Range(\"A\" &amp; i).Value\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4158488, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dcf63034600ad17190b8ef6276016df4?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/4158488/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 29110137, "answer_count": 1, "score": 0, "last_activity_date": 1426688176, "creation_date": 1426626976, "last_edit_date": 1426688176, "question_id": 29109867, "link": "https://stackoverflow.com/questions/29109867/copying-cell-values-from-one-workbook-into-another", "title": "Copying cell values from one Workbook into another", "body": "<p>I have the following code that I've written to take some names and use them to populate a timesheet.</p>\n\n<pre><code>Sub InitNames()\n    Dim i As Integer\n    i = 0\n    Dim name As String\n\n    Windows(\"Employee Data.xlsx\").Activate\n    Sheets(\"Employees\").Select\n    Range(\"A2\").Select\n    Do Until IsEmpty(ActiveCell)\n        name = ActiveCell.Value\n        Workbooks(\"Timesheet\").Sheets(\"ST\").Range(\"A9\").Offset(i * 9).Value = name\n        ActiveCell.Offset(1, 0).Select\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Basically, the cells in the target sheet are spaced 9 rows away from each other, so the first name would go in cell A9, the second in A18, the third in A27, and so on. I'm sure I'm missing something incredibly simple, but I'm not getting any feedback from Excel whatsoever (no error messages). The cells in the timesheet are merged cells, but I cannot change them (locked by the owner), but I don't think that has anything to do with it.</p>\n\n<p><strong>EDIT</strong>: I added a line: <code>OriginalValue = Workbooks(\"Timesheet\").Sheets(\"ST\").Range(\"A10\").Offset((x - 2) * 9, 0).Value</code> so I could watch to see what values were being overwritten in my Timesheet and I noticed something interesting: OriginalValue only grabs the <em>first</em> cell's text (A9), thereafter, for every cell (A18, A27, etc.) the debugger indicates that OriginalValue = \"\" even though those cells also contain names. However, when I open another worksheet and reference A9, A18, etc., I AM pulling the names. </p>\n\n<p><strong>EDIT 2</strong>: I modified the test line to read <code>Workbooks(\"Timesheet\").Sheets(\"ST\").Range(\"A\" &amp; ((x - 1) * 9)).Value = \"Test\"</code> which <strong>does</strong> change the values in all the target cells. Why would VBA allow me to assign \"Test\" to a cell value but not the names in the other worksheet?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1426626165, "post_id": 29109562, "comment_id": 46448752, "body": "<code>Time()</code> does always give you a date component ... <i>Dec 30, 1899</i>.  Check <code>Format(Time(), &quot;mmm d, yyyy h:nn:ss AMPM&quot;)</code>"}, {"owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1426626653, "post_id": 29109562, "comment_id": 46449012, "body": "But when I enter ?Time() in the Immediate window, I get just the time ex: 2:08:41 PM. Is this different in a VBA module?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1426626859, "post_id": 29109562, "comment_id": 46449113, "body": "There is no &quot;time only&quot; datatype in Access or VBA.  There is only Date/Time.  So there is always a date component --- if you don&#39;t supply that piece, the date component will be zero, which is <i>Dec 30, 1899</i>.  Depending on where and how you display a Date/Time value, the zero components (for date or time) may be hidden ... but they&#39;re still present in the Date/Time value."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1426626950, "post_id": 29109562, "comment_id": 46449165, "body": "Take your sample time value and see what you get when you add 10 hours to it --- look at what <code>DateAdd(&quot;h&quot;, 10, #2:08:41 PM#)</code> shows you in the Immediate window.  The <i>12/31/1899</i> part had to come from somewhere, right?"}, {"owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1426628010, "post_id": 29109562, "comment_id": 46449648, "body": "I think I see what you are saying for variable of type datetime. What I meant is to return a value of type string representing the time. I should clarify my answer."}], "tags": [], "owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "is_accepted": true, "score": 1, "last_activity_date": 1426628456, "last_edit_date": 1426628456, "creation_date": 1426625974, "answer_id": 29109562, "question_id": 29109548, "link": "https://stackoverflow.com/questions/29109548/in-ms-access-vba-what-is-the-function-for-returning-the-time-of-day-not-date/29109562#29109562", "title": "In MS Access VBA, what is the function for returning the time of day? (Not date AND time)", "body": "<p>To retrieve a string value representing time, use the following example:</p>\n\n<pre><code>Dim CurrentTime As String\nCurrentTime = Time()\n</code></pre>\n\n<p>To pull the time value straight from a variable of type datetime:</p>\n\n<pre><code>Dim ExampleDateTime As DateTime\nDim TimeString As String\nExampleDateTime = Now()\nTimeString = Format(ExampleDateTime, \"mmm d, yyyy h:nn:ss AMPM\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "edited": false, "score": 0, "creation_date": 1426702102, "post_id": 29120978, "comment_id": 46484788, "body": "See the edited question above. I tried to clarify what I am doing. Does this change your answer at all?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "edited": false, "score": 0, "creation_date": 1426714604, "post_id": 29120978, "comment_id": 46492060, "body": "Sort of. The original code lines should be deleted."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1426678499, "creation_date": 1426678499, "answer_id": 29120978, "question_id": 29109548, "link": "https://stackoverflow.com/questions/29109548/in-ms-access-vba-what-is-the-function-for-returning-the-time-of-day-not-date/29120978#29120978", "title": "In MS Access VBA, what is the function for returning the time of day? (Not date AND time)", "body": "<p>You should certainly not use a string variable for datetime. Always - no exceptions - use Date:</p>\n\n<pre><code>Dim CurrentTime As Date\nCurrentTime = Time\n</code></pre>\n\n<p>Then, for display or reporting, format this as you like.</p>\n"}], "owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "accepted_answer_id": 29109562, "answer_count": 2, "score": 1, "last_activity_date": 1426702894, "creation_date": 1426625937, "last_edit_date": 1426702027, "question_id": 29109548, "link": "https://stackoverflow.com/questions/29109548/in-ms-access-vba-what-is-the-function-for-returning-the-time-of-day-not-date", "title": "In MS Access VBA, what is the function for returning the time of day? (Not date AND time)", "body": "<p>How do I get the time of the day in Access VBA? I am trying to build a string to name a file that has a time value in it. I don't want the datetime value, but just the time value. Like the Now() function:</p>\n\n<pre><code>CurrentTime = Now()\n</code></pre>\n\n<p>But I only want the current time.</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 476, "user_id": 4479078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d70f554e2d6dc6aa42d1995e0b3b6?s=128&d=identicon&r=PG&f=1", "display_name": "Caio C&#233;sar S. Leonardi", "link": "https://stackoverflow.com/users/4479078/caio-c%c3%a9sar-s-leonardi"}, "edited": false, "score": 0, "creation_date": 1426623250, "post_id": 29108754, "comment_id": 46447156, "body": "you would like to obtain a new variable called <code>rng234567891011121314</code> ? i couldn&#39;t understand your problem"}, {"owner": {"reputation": 3, "user_id": 4682535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca40d394fde175b0b4ba2b476c2658e9?s=128&d=identicon&r=PG&f=1", "display_name": "user4682535", "link": "https://stackoverflow.com/users/4682535/user4682535"}, "reply_to_user": {"reputation": 476, "user_id": 4479078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d70f554e2d6dc6aa42d1995e0b3b6?s=128&d=identicon&r=PG&f=1", "display_name": "Caio C&#233;sar S. Leonardi", "link": "https://stackoverflow.com/users/4479078/caio-c%c3%a9sar-s-leonardi"}, "edited": false, "score": 0, "creation_date": 1426623367, "post_id": 29108754, "comment_id": 46447228, "body": "No, I would like to copy rng2 and paste it somewhere then do the same with rng3 and then rng4 etc."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1426623470, "post_id": 29108754, "comment_id": 46447314, "body": "@user4682535 where are they getting pasted - you&#39;ve not specified a place to paste them to."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1426623505, "post_id": 29108754, "comment_id": 46447334, "body": "you need to add a line <code>Dim rng1 As Range</code> for each of the object variables you are going to use"}, {"owner": {"reputation": 3, "user_id": 4682535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca40d394fde175b0b4ba2b476c2658e9?s=128&d=identicon&r=PG&f=1", "display_name": "user4682535", "link": "https://stackoverflow.com/users/4682535/user4682535"}, "edited": false, "score": 0, "creation_date": 1426623737, "post_id": 29108754, "comment_id": 46447446, "body": "Yes I know that. but how would I concatenate the names in the for loop? In other words how do I append the value of <code>i</code> onto the end of <code>rng</code>?"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1426623999, "post_id": 29108754, "comment_id": 46447574, "body": "@user4682535 you don&#39;t - it is an object variable."}], "answers": [{"tags": [], "owner": {"reputation": 476, "user_id": 4479078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d70f554e2d6dc6aa42d1995e0b3b6?s=128&d=identicon&r=PG&f=1", "display_name": "Caio C&#233;sar S. Leonardi", "link": "https://stackoverflow.com/users/4479078/caio-c%c3%a9sar-s-leonardi"}, "is_accepted": true, "score": 0, "last_activity_date": 1426623778, "creation_date": 1426623778, "answer_id": 29108990, "question_id": 29108754, "link": "https://stackoverflow.com/questions/29108754/concatenate-range-names-in-vba/29108990#29108990", "title": "Concatenate range names in VBA", "body": "<p>if you're not using the variables name anywhere else, you could create a collection of ranges and then use a for each loop, something like this:</p>\n\n<pre><code>Dim rng1 As Range\nDim rngcollec As New Collection\nDim rngitem as Range\n\n\nSet rng1 = FindHeader(\"Category\", \"Detail\")\nSet rng2 = FindHeader(\"RXCUI\", \"Detail\")\nrngcollec.Add rng2\nSet rng3 = FindHeader(\"NDC\", \"Detail\")\nrngcollec.Add rng3\nSet rng4 = FindHeader(\"DDI\", \"Detail\")\nrngcollec.Add rng4\nSet rng5 = FindHeader(\"GPI\", \"Detail\")\nrngcollec.Add rng5\nSet rng6 = FindHeader(\"Med Name\", \"Detail\")\nrngcollec.Add rng6\nSet rng7 = FindHeader(\"Strength\", \"Detail\")\nrngcollec.Add rng7\nSet rng8 = FindHeader(\"Dose Form\", \"Detail\")\nrngcollec.Add rng8\nSet rng9 = FindHeader(\"FORMULARY_TIER\", \"Detail\")\nrngcollec.Add rng9\nSet rng10 = FindHeader(\"QUANTITY_MAX\", \"Detail\")\nrngcollec.Add rng10\nSet rng11 = FindHeader(\"QUANTITY_TIME\", \"Detail\")\nrngcollec.Add rng11\nSet rng12 = FindHeader(\"PA_REQUIRED\", \"Detail\")\nrngcollec.Add rng12\nSet rng13 = FindHeader(\"PA_Group_NAME\", \"Detail\")\nrngcollec.Add rng13\nSet rng14 = FindHeader(\"STEP_THERAPY\", \"Detail\")\nrngcollec.Add rng14\n\nrng1.AutoFilter _\nfield:=1, _\nCriteria1:=Array(\"Immunological Agents\", \"antidepressants\", \"antipsychotics\", \"anticonvulsants\", \"antiretrovirals\", \"antineoplastics\"), _\nOperator:=xlFilterValues\n\n\nFor Each rngitem in rngcollec\n\nrngitem.copy \nrngitem.paste\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4682535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca40d394fde175b0b4ba2b476c2658e9?s=128&d=identicon&r=PG&f=1", "display_name": "user4682535", "link": "https://stackoverflow.com/users/4682535/user4682535"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 29108990, "answer_count": 1, "score": 0, "last_activity_date": 1426623778, "creation_date": 1426622961, "question_id": 29108754, "link": "https://stackoverflow.com/questions/29108754/concatenate-range-names-in-vba", "title": "Concatenate range names in VBA", "body": "<p>I have 14 ranges defined in the macro below.  What I would like to do is copy and paste all of them in one for loop as opposed to individually. I was going to structure my for loop like this but I am not sure of the syntax of how to concatenate the object names and the variable i.  Any help would be greatly appreciated.</p>\n\n<pre><code>Sub GenerateNewReport()\n\nDim rng1 As Range\n\n\nSet rng1 = FindHeader(\"Category\", \"Detail\")\nSet rng2 = FindHeader(\"RXCUI\", \"Detail\")\nSet rng3 = FindHeader(\"NDC\", \"Detail\")\nSet rng4 = FindHeader(\"DDI\", \"Detail\")\nSet rng5 = FindHeader(\"GPI\", \"Detail\")\nSet rng6 = FindHeader(\"Med Name\", \"Detail\")\nSet rng7 = FindHeader(\"Strength\", \"Detail\")\nSet rng8 = FindHeader(\"Dose Form\", \"Detail\")\nSet rng9 = FindHeader(\"FORMULARY_TIER\", \"Detail\")\nSet rng10 = FindHeader(\"QUANTITY_MAX\", \"Detail\")\nSet rng11 = FindHeader(\"QUANTITY_TIME\", \"Detail\")\nSet rng12 = FindHeader(\"PA_REQUIRED\", \"Detail\")\nSet rng13 = FindHeader(\"PA_Group_NAME\", \"Detail\")\nSet rng14 = FindHeader(\"STEP_THERAPY\", \"Detail\")\n\nrng1.AutoFilter _\nfield:=1, _\nCriteria1:=Array(\"Immunological Agents\", \"antidepressants\", \"antipsychotics\", \"anticonvulsants\", \"antiretrovirals\", \"antineoplastics\"), _\nOperator:=xlFilterValues\n\n\nFor i = 2 To 14\n'I know this is string concatenation but I am unsure how to do this for variable names...\n\nrng &amp; i.copy \nrng &amp; i.paste\n\n\nNext i\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 1402319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d260aa7e1323117b621a128432eb86af?s=128&d=identicon&r=PG", "display_name": "Webaphile", "link": "https://stackoverflow.com/users/1402319/webaphile"}, "edited": false, "score": 0, "creation_date": 1427384453, "post_id": 29109884, "comment_id": 46763281, "body": "While I am still having problems with Excel 365/Excel 2010 compatibility, this did exactly what I asked for.  Thank you!"}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 2, "last_activity_date": 1426687804, "last_edit_date": 1426687804, "creation_date": 1426627043, "answer_id": 29109884, "question_id": 29108699, "link": "https://stackoverflow.com/questions/29108699/how-do-i-keep-excel-from-binding-to-the-microsoft-word-15-0-object-library/29109884#29109884", "title": "How do I keep Excel from binding to the Microsoft Word 15.0 Object Library?", "body": "<p>Untested, but putting something like this in your <code>Workbook_BeforeSave</code> event would probably work:</p>\n\n<pre><code>With ThisWorkbook.VBProject.References\n    For i = .Count To 1 Step -1\n        If InStr(.Item(i).Name, \"Word\") &lt;&gt; 0 Then .Remove .Item(i)\n    Next\nEnd With\n</code></pre>\n\n<p>Disclaimer: I don't have Office 365 and don't know why it would automatically add a reference to Word 15.0; anyhow, the above assumes that it does.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 1402319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d260aa7e1323117b621a128432eb86af?s=128&d=identicon&r=PG", "display_name": "Webaphile", "link": "https://stackoverflow.com/users/1402319/webaphile"}, "edited": false, "score": 0, "creation_date": 1427384527, "post_id": 29110059, "comment_id": 46763335, "body": "Thank you for your answer, while I chose the other, this looked like it would have done the job just as well."}], "tags": [], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "is_accepted": false, "score": 1, "last_activity_date": 1426627729, "creation_date": 1426627729, "answer_id": 29110059, "question_id": 29108699, "link": "https://stackoverflow.com/questions/29108699/how-do-i-keep-excel-from-binding-to-the-microsoft-word-15-0-object-library/29110059#29110059", "title": "How do I keep Excel from binding to the Microsoft Word 15.0 Object Library?", "body": "<p>To Remove, place inside module:  I know this dosen't prevent it from happening in the first place but this might help to at least remove it before the next person.</p>\n\n<pre><code>Private Sub RemoveRef()\n     Dim Reference As Object\n     For Each Reference In ThisWorkbook.VBProject.References\n           If Reference.Description = \"Microsoft Word 15.0 Object library\" Then\n                 ThisWorkbook.VBProject.References.Remove Reference\n           End If\n     Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 1402319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d260aa7e1323117b621a128432eb86af?s=128&d=identicon&r=PG", "display_name": "Webaphile", "link": "https://stackoverflow.com/users/1402319/webaphile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2528, "favorite_count": 1, "accepted_answer_id": 29109884, "answer_count": 2, "score": 5, "last_activity_date": 1426687804, "creation_date": 1426622750, "last_edit_date": 1426627089, "question_id": 29108699, "link": "https://stackoverflow.com/questions/29108699/how-do-i-keep-excel-from-binding-to-the-microsoft-word-15-0-object-library", "title": "How do I keep Excel from binding to the Microsoft Word 15.0 Object Library?", "body": "<p>We have a very complex Excel 2010 spreadsheet template. Each new copy of the template needs to pass through several people during its lifetime. </p>\n\n<p>Unfortunately, one of the first people to utilize the template has Office 365 installed. After he has touched it, the spreadsheet appears to bind to the Microsoft Word 15.0 Object library, which is not available on the Excel 2010 PCs. While an individual broken file can be fixed by unchecking the missing Word object library in the VBA Code Tools > References, I need to find a way to prevent this from happening in the first place.</p>\n\n<p>I have reviewed the code in detail and I cannot find any reference to the MS Word Object library, so what is causing Excel to bind to it in the first place? Is there anything I can do to prevent it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8084, "user_id": 512728, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GZ3bk.jpg?s=128&g=1", "display_name": "Jan Doggen", "link": "https://stackoverflow.com/users/512728/jan-doggen"}, "edited": false, "score": 0, "creation_date": 1426625179, "post_id": 29108461, "comment_id": 46448205, "body": "Jen, code should be indented 4 spaces in a question."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4682472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75c285a92cda5fc835401fc69230369?s=128&d=identicon&r=PG&f=1", "display_name": "Jen Jan", "link": "https://stackoverflow.com/users/4682472/jen-jan"}, "edited": false, "score": 0, "creation_date": 1426686201, "post_id": 29108596, "comment_id": 46473614, "body": "Thank you very much Kyle. It is much faster now. Can you please explain what you did in the new line....Sheets(6).Rows(lngRowOutput) = Sheets(2).Rows(lngRow).Value"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 1, "user_id": 4682472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75c285a92cda5fc835401fc69230369?s=128&d=identicon&r=PG&f=1", "display_name": "Jen Jan", "link": "https://stackoverflow.com/users/4682472/jen-jan"}, "edited": false, "score": 0, "creation_date": 1426701896, "post_id": 29108596, "comment_id": 46484648, "body": "Instead of copying the value from <code>Sheet(2).Rows(lngRow)</code> and pasting in <code>Sheets(6).Rows(lngRowOutput)</code>, I directly assign the value of <code>Sheet(2).Rows(lngRow)</code> to the range <code>Sheets(6).Rows(lngRowOutput)</code>. It is a much quicker operation than copy/paste. If this answer works for you, please accept my answer."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1426622378, "creation_date": 1426622378, "answer_id": 29108596, "question_id": 29108461, "link": "https://stackoverflow.com/questions/29108461/taking-too-much-time-to-copy-from-one-excel-sheet-row-matching-rows-to-another/29108596#29108596", "title": "Taking too much time to copy from one excel sheet row (matching rows) to another excel sheet - VBA", "body": "<p>Try the simple change below. Instead of copy paste, reference the values specifically:</p>\n\n<pre><code>Dim lngLastRow As Long Dim lngRow As Long Dim strValue As String Dim lngRowOutput As Long\n\n' getting last row of Material Master data\nlngLastRow = Sheets(2).UsedRange.Rows.Count\n' MsgBox lngLastRow\n\nApplication.ScreenUpdating = False\n\n' Clear down sheet from Row 2. Row 1 is for column headers.\n\n\nSheets(6).Range(\"2:1048570\").Clear  'MM Criticality sheet\n\nlngRowOutput = 2 ' where are we going to write the values to in Sheet2  \n\n\nFor lngRow = 2 To lngLastRow\n     strValue = Sheets(2).Cells(lngRow, 5).Value  ' getting value from column D\n\n    'Checking for particular text in the transactions..\n    If InStr(1, strValue, \"specified in the table \", vbTextCompare) &gt; 0 Then\n        Sheets(6).Rows(lngRowOutput) = Sheets(2).Rows(lngRow).Value\n        lngRowOutput = lngRowOutput + 1\n    Else\n  '    MsgBox Sheets(3).Rows(lngRow).Copy\n    End If\n\nNext lngRow\nApplication.ScreenUpdating = True\n\nWorksheets(6).Activate \nWorksheets(6).Visible = True\nWorksheets(6).Select \nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4682472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75c285a92cda5fc835401fc69230369?s=128&d=identicon&r=PG&f=1", "display_name": "Jen Jan", "link": "https://stackoverflow.com/users/4682472/jen-jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426625179, "creation_date": 1426622032, "last_edit_date": 1426625179, "question_id": 29108461, "link": "https://stackoverflow.com/questions/29108461/taking-too-much-time-to-copy-from-one-excel-sheet-row-matching-rows-to-another", "title": "Taking too much time to copy from one excel sheet row (matching rows) to another excel sheet - VBA", "body": "<p>I am using this code for command click event to copy rows from one sheet with some criteria to another sheet. It is taking too much time to get loaded into the sheet.    </p>\n\n<p>Is there a way to speed this up? I am new to VBA excel and I am learning.</p>\n\n<pre><code>Dim lngLastRow As Long\nDim lngRow As Long\nDim strValue As String\nDim lngRowOutput As Long\n\n' getting last row of Material Master data\nlngLastRow = Sheets(2).UsedRange.Rows.Count\n' MsgBox lngLastRow\n\nApplication.ScreenUpdating = False\n\n' Clear down sheet from Row 2. Row 1 is for column headers.\n\nSheets(6).Range(\"2:1048570\").Clear  'MM Criticality sheet\n\nlngRowOutput = 2 ' where are we going to write the values to in Sheet2  \n\nFor lngRow = 2 To lngLastRow\n     strValue = Sheets(2).Cells(lngRow, 5).Value  ' getting value from column D\n\n    'Checking for particular text in the transactions..\n    If InStr(1, strValue, \"specified in the table \", vbTextCompare) &gt; 0 Then\n         Sheets(2).Rows(lngRow).Copy\n        Sheets(6).Rows(lngRowOutput).PasteSpecial\n        lngRowOutput = lngRowOutput + 1\n    Else\n  '    MsgBox Sheets(3).Rows(lngRow).Copy\n    End If\n\nNext lngRow\n\nApplication.ScreenUpdating = True\n\nWorksheets(6).Activate\nWorksheets(6).Visible = True\nWorksheets(6).Select\nEnd sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2003"], "answers": [{"comments": [{"owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "edited": false, "score": 0, "creation_date": 1426622543, "post_id": 29108602, "comment_id": 46446787, "body": "Can&#39;t break it any worse!  I&#39;ll give that a shot &amp; report back, thanks!"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "edited": false, "score": 0, "creation_date": 1426622628, "post_id": 29108602, "comment_id": 46446834, "body": "Try - logically at a loss to know why the fix suddenly worked once we&#39;d reinstalled the guilty security update but it did. If the security update was not properly installed then why was ActiveX broken?"}, {"owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "edited": false, "score": 0, "creation_date": 1426624339, "post_id": 29108602, "comment_id": 46447764, "body": "Hey, it&#39;s Microsoft, it doesn&#39;t have to make sense, right?  :-)  Okay, dumb question, but in Windows 7, where do I start in order to RE-install an update that Windows Update thinks is okay?  (Updating Windows clearly isn&#39;t my great strength!)"}, {"owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "edited": false, "score": 0, "creation_date": 1426632516, "post_id": 29108602, "comment_id": 46451529, "body": "No joy finding a way to reinstall the update, but Windows Update let me revert to an earlier state, and that worked.  Details in the Answer I posted.  Thanks for coming on &amp; engaging -- got my mind working in the right direction to arrive at the solution that worked."}], "tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 1, "last_activity_date": 1426622404, "creation_date": 1426622404, "answer_id": 29108602, "question_id": 29108355, "link": "https://stackoverflow.com/questions/29108355/excel-2003-active-x-bug-from-dec-2014-update-still-broke-what-else-to-try/29108602#29108602", "title": "Excel 2003: Active-X bug from Dec 2014 &quot;update&quot; -- still broke. What else to try?", "body": "<p>We had a stubborn machine at ours recently - the ActiveX bug would not go away.</p>\n\n<p>I realise this sounds silly but re-install all the updates from MS - all the updates which caused the problem in the first place. Then run the fix again. This fixed ours.</p>\n\n<p>Also did you try both <code>Fixit</code> buttons: <a href=\"https://support.microsoft.com/en-gb/kb/3025036/en-us\" rel=\"nofollow\">https://support.microsoft.com/en-gb/kb/3025036/en-us</a></p>\n"}, {"comments": [{"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "edited": false, "score": 0, "creation_date": 1426824747, "post_id": 29111148, "comment_id": 46538670, "body": "I&#39;m in the same situation, Excel 2003 and Win 7, and none of the fixes have worked for me.  I even uninstalled &amp; re-installed all the updates, to no avail.  Hoping for something soon, as I need to stay with xl2003."}], "tags": [], "owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "is_accepted": true, "score": 0, "last_activity_date": 1426632407, "creation_date": 1426632407, "answer_id": 29111148, "question_id": 29108355, "link": "https://stackoverflow.com/questions/29108355/excel-2003-active-x-bug-from-dec-2014-update-still-broke-what-else-to-try/29111148#29111148", "title": "Excel 2003: Active-X bug from Dec 2014 &quot;update&quot; -- still broke. What else to try?", "body": "<p>What ended up working was going back to a restore point from a few weeks ago.  Completed the restore, rebooted, removed the two .EXD files (dunno if this mattered; abundance of caution), rebooted again, and when I fired up Excel, things worked as expected -- i.e. as they did before the Windows Update.</p>\n\n<p>This episode has me seriously pondering the risk/reward of EVER allowing Windows Update to run on this particular machine... for all of the risky things that I <strong><em>don't</em></strong> do (opening random Office documents from strangers, for instance), it seems like a lot of the benefits of all the updates are pretty far off into the realm of hypothetical, while the risks of another mess like this are quite clearly NOT just hypothetical.</p>\n\n<p>Leave it to Microsoft to break a program that's running perfectly well, and even 3 months later their \"fix\" is neither automated nor comprehensive.  <code>/venting</code></p>\n"}, {"tags": [], "owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "is_accepted": false, "score": 1, "last_activity_date": 1446010363, "creation_date": 1446010363, "answer_id": 33383587, "question_id": 29108355, "link": "https://stackoverflow.com/questions/29108355/excel-2003-active-x-bug-from-dec-2014-update-still-broke-what-else-to-try/33383587#33383587", "title": "Excel 2003: Active-X bug from Dec 2014 &quot;update&quot; -- still broke. What else to try?", "body": "<p>I realize this is an older post, but maybe this will help someone else.  I struggled with this one for quite awhile, finally discovered four (4) Microsoft Office 2010 updates that were causing the Active-X problem with xl2003.  After removing them, everything worked fine.  One or more of these updates have accidentally been installed since, and xl2003 is immediately broken - removing them always sets everything straight again, so I'm quite confident about this.</p>\n\n<p>I'm running Win 7 64 bit.</p>\n\n<p>Here are the updates:</p>\n\n<p>KB2553154<br>\nKB2965291<br>\nKB2920813<br>\nKB3054873</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "is_accepted": false, "score": 1, "last_activity_date": 1579077076, "last_edit_date": 1579077076, "creation_date": 1548343664, "answer_id": 54350074, "question_id": 29108355, "link": "https://stackoverflow.com/questions/29108355/excel-2003-active-x-bug-from-dec-2014-update-still-broke-what-else-to-try/54350074#54350074", "title": "Excel 2003: Active-X bug from Dec 2014 &quot;update&quot; -- still broke. What else to try?", "body": "<p>For over a year, on and off, I wanted to use ActiveX embedded in a worksheet controls in Excel 2003. Almost always they did not work.  I have sorted the problem out on about a dozen machines with operating system of XP, Vista and Win 7. Most had Office 2003, Office 2007 or higher. If you are having issues with ActiveX embedded in a worksheet controls in Excel 2003, then, <strong>starting at the top, deinstall these updates</strong>:</p>\n\n<ul>\n<li>KB3054873 </li>\n<li>KB2965286 </li>\n<li>KB2920813 </li>\n<li>KB4011203 </li>\n<li><p>KB2920794 </p></li>\n<li><p>KB2553154 </p></li>\n<li><p>KB2965291 </p></li>\n<li><p>KB2596744</p></li>\n<li>KB2687441</li>\n<li>KB2817330</li>\n<li>KB3118304</li>\n<li>KB3141535</li>\n<li>KB3191837</li>\n<li>KB3203436</li>\n<li><p>KB3213640</p></li>\n<li><p>KB974554 (possibly leave this last one in initially. It may be OK.)</p></li>\n</ul>\n\n<p>In addition, the updates below stop almost everything from working on XP. If you have XP, then you will almost certainly want to deinstall these  updates: </p>\n\n<ul>\n<li>KB4461522 ( no longer available )</li>\n<li>KB4461614 </li>\n<li>KB4462174 </li>\n<li>KB4462157</li>\n<li>KB4464566</li>\n</ul>\n\n<p>More information: <a href=\"http://www.eileenslounge.com/viewtopic.php?f=21&amp;t=31405#p244958\" rel=\"nofollow noreferrer\">proc entry pt \"GetDataFormEX\" not found in the DLL \"KERNEL32 (eileenslounge.com)</a></p>\n\n<p><a href=\"https://www.eileenslounge.com/viewtopic.php?f=21&amp;t=33872\" rel=\"nofollow noreferrer\">proc entry pt EnumCalendarInfoExEx not found in KERNEL32 (eileenslounge.com)</a></p>\n\n<p>I have a more detailed report on what I have done posted in a few other places, for example:</p>\n\n<ul>\n<li><a href=\"http://www.excelfox.com/forum/showthread.php/2242-Excel-2003-ActiveX-controls-embedded-in-worksheet-not-working-then-can%E2%80%99t-even-insert-them-*SOLVED*?p=10920#post10920\" rel=\"nofollow noreferrer\">Excel 2003. ActiveX controls embedded in worksheet not working, then can\u2019t even insert them. (excelfox.com)</a></li>\n<li><a href=\"http://www.eileenslounge.com/viewtopic.php?f=18&amp;t=31600&amp;p=245201#p245201\" rel=\"nofollow noreferrer\">Microsoft Windows Updates. Deleting. Restoring (eileenslounge.com)</a></li>\n</ul>\n"}], "owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3733, "favorite_count": 0, "accepted_answer_id": 29111148, "answer_count": 4, "score": 1, "last_activity_date": 1579077076, "creation_date": 1426621666, "last_edit_date": 1495542184, "question_id": 29108355, "link": "https://stackoverflow.com/questions/29108355/excel-2003-active-x-bug-from-dec-2014-update-still-broke-what-else-to-try", "title": "Excel 2003: Active-X bug from Dec 2014 &quot;update&quot; -- still broke. What else to try?", "body": "<p>Situation: big huge Excel VBA project, running in <strong>Excel 2003</strong>.  Tons of code, been running for years.  The December 2014 update from Microsoft that broke Active-X controls for everybody, just got installed on my machine, and hey, it broke for me too.  Okay, <a href=\"https://stackoverflow.com/questions/27411399/microsoft-excel-activex-controls-disabled\">StackOverflow to the rescue</a>, found the solution, and deleted the .EXD files.  Reboot.</p>\n\n<p>Small problem: no help.</p>\n\n<p>Partial workaround: I put \"buttons\" (not \"command buttons\" -- which are Active-X controls) on the worksheet, and I can start things running with those.  Problem: when the VBA code goes to change a cell on the worksheet, it gets an Application Error, as if it isn't allowed to do so.  Because this code has run for years &amp; years, I'm pretty certain that it's the December update bug that's killing me here.  Plus, the Active-X buttons still do nothing.</p>\n\n<p><strong>Question: what other steps beyond deleting the .EXD files &amp; rebooting, specific to Excel 2003, need to be taken?</strong>  (\"Remove all VBA code, save, and restore the code\" is a non-starter; far, far too much code to contemplate that, and how much I'd likely break along the way.)</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["excel", "vba", "checkbox"], "comments": [{"owner": {"reputation": 535, "user_id": 2573344, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Xp3V4.jpg?s=128&g=1", "display_name": "JRQ", "link": "https://stackoverflow.com/users/2573344/jrq"}, "edited": false, "score": 1, "creation_date": 1426621520, "post_id": 29108204, "comment_id": 46446197, "body": "Capture the checkbox event: Private Sub Option1Checkbox_Click()"}, {"owner": {"reputation": 535, "user_id": 2573344, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Xp3V4.jpg?s=128&g=1", "display_name": "JRQ", "link": "https://stackoverflow.com/users/2573344/jrq"}, "edited": false, "score": 2, "creation_date": 1426621749, "post_id": 29108204, "comment_id": 46446314, "body": "I think I may have misunderstood your question.  Do you want the macro to trigger WHEN a checkbox is checked, or IF a checkbox is checked?"}, {"owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "reply_to_user": {"reputation": 535, "user_id": 2573344, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Xp3V4.jpg?s=128&g=1", "display_name": "JRQ", "link": "https://stackoverflow.com/users/2573344/jrq"}, "edited": false, "score": 0, "creation_date": 1426688167, "post_id": 29108204, "comment_id": 46474998, "body": "IF the checkbox is checked - the macro works"}, {"owner": {"reputation": 535, "user_id": 2573344, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Xp3V4.jpg?s=128&g=1", "display_name": "JRQ", "link": "https://stackoverflow.com/users/2573344/jrq"}, "edited": false, "score": 0, "creation_date": 1426771853, "post_id": 29108204, "comment_id": 46514363, "body": "In which case, 9Deuce and New2VBA have already given you the correct answers."}], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "is_accepted": false, "score": 0, "last_activity_date": 1426621637, "creation_date": 1426621637, "answer_id": 29108344, "question_id": 29108204, "link": "https://stackoverflow.com/questions/29108204/run-macro-private-sub-when-checkbox-is-checked/29108344#29108344", "title": "Run macro (Private Sub) when checkbox is checked", "body": "<p>Depends on the name of the checkbox you have. But here is what should work if it is CheckBox1</p>\n\n<pre><code>If CheckBox1.Value = True Then\n'do code'\nElse: End If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 669, "user_id": 3525024, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/290e39088447a1e671b08a924b4323e1?s=128&d=identicon&r=PG&f=1", "display_name": "9Deuce", "link": "https://stackoverflow.com/users/3525024/9deuce"}, "is_accepted": false, "score": 0, "last_activity_date": 1426621646, "creation_date": 1426621646, "answer_id": 29108346, "question_id": 29108204, "link": "https://stackoverflow.com/questions/29108204/run-macro-private-sub-when-checkbox-is-checked/29108346#29108346", "title": "Run macro (Private Sub) when checkbox is checked", "body": "<p>You can call the checkbox by it's name, then select the Value property</p>\n\n<pre><code>CheckBoxName.Value\n</code></pre>\n\n<p>This will return true if checked and false if unchecked. So you could call</p>\n\n<pre><code>If CheckBoxName.Value\n    If Target.Column &lt;&gt; 1 Then\n        Exit Sub\n    Else\n        Application.ScreenUpdating = False\n        Cells.Borders.LineStyle = xlLineStyleNone\n        Rows(Target.Row).BorderAround Weight:=xlMedium, ColorIndex:=3\n        Application.ScreenUpdating = True\n\n   End If\nEnd If\n</code></pre>\n\n<p>This should work.</p>\n"}, {"tags": [], "owner": {"reputation": 529, "user_id": 584967, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ccc57756273eba3bc2fcd5c82333ab24?s=128&d=identicon&r=PG", "display_name": "Cryptographic_ICE", "link": "https://stackoverflow.com/users/584967/cryptographic-ice"}, "is_accepted": false, "score": 0, "last_activity_date": 1426621796, "creation_date": 1426621796, "answer_id": 29108396, "question_id": 29108204, "link": "https://stackoverflow.com/questions/29108204/run-macro-private-sub-when-checkbox-is-checked/29108396#29108396", "title": "Run macro (Private Sub) when checkbox is checked", "body": "<p>You should be able to right click on the check box and choose assign macro. </p>\n\n<p><a href=\"http://blog.contextures.com/archives/2014/01/16/click-a-check-box-to-run-a-macro/\" rel=\"nofollow\">http://blog.contextures.com/archives/2014/01/16/click-a-check-box-to-run-a-macro/</a></p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "is_accepted": true, "score": 0, "last_activity_date": 1426688616, "creation_date": 1426688616, "answer_id": 29124647, "question_id": 29108204, "link": "https://stackoverflow.com/questions/29108204/run-macro-private-sub-when-checkbox-is-checked/29124647#29124647", "title": "Run macro (Private Sub) when checkbox is checked", "body": "<p>Thx for your effort and time, but I have found the solution:</p>\n\n<p>If ActiveSheet.Shapes(\"Check Box 1\").ControlFormat.Value = 1 Then</p>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 3193160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/GrsLp.jpg?s=128&g=1", "display_name": "kitarika", "link": "https://stackoverflow.com/users/3193160/kitarika"}, "is_accepted": false, "score": 0, "last_activity_date": 1474418342, "creation_date": 1474418342, "answer_id": 39605792, "question_id": 29108204, "link": "https://stackoverflow.com/questions/29108204/run-macro-private-sub-when-checkbox-is-checked/39605792#39605792", "title": "Run macro (Private Sub) when checkbox is checked", "body": "<p>Not sure how relevant this is, but I've noticed you could assign macro to the checkbox directly...?</p>\n"}], "owner": {"reputation": 29, "user_id": 4453929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b75f633c5e946ed685ce0b46f753764b?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/4453929/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19911, "favorite_count": 1, "accepted_answer_id": 29124647, "answer_count": 5, "score": 0, "last_activity_date": 1474418342, "creation_date": 1426621170, "last_edit_date": 1426621381, "question_id": 29108204, "link": "https://stackoverflow.com/questions/29108204/run-macro-private-sub-when-checkbox-is-checked", "title": "Run macro (Private Sub) when checkbox is checked", "body": "<p>I've got the following macro to select the entire row when the active cell is selected. That's working perfectly! However, I just want to make this macro working when a checkbox is \"checked\"</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nIf Target.Column &lt;&gt; 1 Then\n    Exit Sub\nElse\n    Application.ScreenUpdating = False\n    Cells.Borders.LineStyle = xlLineStyleNone\n    Rows(Target.Row).BorderAround Weight:=xlMedium, ColorIndex:=3\n    Application.ScreenUpdating = True\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 2, "last_activity_date": 1426622045, "last_edit_date": 1495542137, "creation_date": 1426620974, "answer_id": 29108148, "question_id": 29108024, "link": "https://stackoverflow.com/questions/29108024/object-required-error-in-excel-vba-while-trying-to-rename-the-sheet/29108148#29108148", "title": "Object Required Error in excel VBA while trying to rename the sheet", "body": "<p>The problem is in connection with the nesting that you're carrying out. <code>Copy</code> does not return a sheet object, hence your error.</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub CreateSheet()\n  with Excel.thisworkbook\n    .Worksheets(\"Key metrics\").Copy Before:=.Worksheets(1)\n    .activesheet.Name = \"Final\"\n  end with\nEnd Sub\n</code></pre>\n\n<p>Here is a QA that confirms this:<br>\n<a href=\"https://stackoverflow.com/questions/18428762/why-does-worksheet-copy-not-return-a-reference-to-the-new-workbook-created\">Why does Worksheet.Copy not return a reference to the new workbook created</a></p>\n\n<p>If this is going to be a small self-contained <code>helper</code> routine you could make it a function with a worksheet return type:</p>\n\n<pre><code>Sub tst()\n\nDim mySht As Excel.Worksheet\nSet mySht = crtSheet(\"foobar\", \"barfoo\") '&lt;&lt;used via this\n\nEnd Sub\n\nFunction crtSheet(ByVal tgtSheet As String, ByVal newName As String) As Excel.Worksheet\n  Dim s As Excel.Worksheet\n  With Excel.ThisWorkbook\n    .Worksheets(tgtSheet).Copy Before:=.Worksheets(1)\n    Set s = .ActiveSheet\n    s.Name = newName\n  End With\n  Set crtSheet = s\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 1, "creation_date": 1426621355, "post_id": 29108210, "comment_id": 46446108, "body": "Why do you do this?  <code>Set WS = ActiveSheet</code> ... <code>WS</code> does not get used"}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1426621545, "post_id": 29108210, "comment_id": 46446214, "body": "whytheq&#39;s answer is simpler and works. The problem in the OP&#39;s code is caused by the naming of the new sheet. The two WS lines in your code are redundant."}, {"owner": {"reputation": 19, "user_id": 4475104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96b58a6764004263003205850f74ca42?s=128&d=identicon&r=PG&f=1", "display_name": "RJW", "link": "https://stackoverflow.com/users/4475104/rjw"}, "edited": false, "score": 0, "creation_date": 1426621618, "post_id": 29108210, "comment_id": 46446253, "body": "Just written in haste with from a habit of ensuring I am using the correct Sheet I guess. But your right, no need for it."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1426622173, "post_id": 29108210, "comment_id": 46446569, "body": "if you replace <code>ActiveSheet</code> with <code>WS</code> in the last line of your code then it gets used?"}, {"owner": {"reputation": 19, "user_id": 4475104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96b58a6764004263003205850f74ca42?s=128&d=identicon&r=PG&f=1", "display_name": "RJW", "link": "https://stackoverflow.com/users/4475104/rjw"}, "edited": false, "score": 0, "creation_date": 1426622347, "post_id": 29108210, "comment_id": 46446667, "body": "Yes, that&#39;s what I meant. Edited."}], "tags": [], "owner": {"reputation": 19, "user_id": 4475104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96b58a6764004263003205850f74ca42?s=128&d=identicon&r=PG&f=1", "display_name": "RJW", "link": "https://stackoverflow.com/users/4475104/rjw"}, "is_accepted": false, "score": 0, "last_activity_date": 1426622234, "last_edit_date": 1426622234, "creation_date": 1426621182, "answer_id": 29108210, "question_id": 29108024, "link": "https://stackoverflow.com/questions/29108024/object-required-error-in-excel-vba-while-trying-to-rename-the-sheet/29108210#29108210", "title": "Object Required Error in excel VBA while trying to rename the sheet", "body": "<pre><code>Sub CreateSheet()\nDim WS As Worksheet\n\nWorksheets(\"Key metrics\").Copy Before:=Worksheets(1)\nSet WS = ActiveSheet\nWS.Name = \"Final\"\n\nEnd Sub\n</code></pre>\n\n<p>Hope that helps. </p>\n"}], "owner": {"reputation": 1, "user_id": 4682390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aHjVSygkXYA/AAAAAAAAAAI/AAAAAAAAAAA/G1hUmFiZRBk/photo.jpg?sz=128", "display_name": "sharath", "link": "https://stackoverflow.com/users/4682390/sharath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1426622259, "creation_date": 1426620530, "last_edit_date": 1426622259, "question_id": 29108024, "link": "https://stackoverflow.com/questions/29108024/object-required-error-in-excel-vba-while-trying-to-rename-the-sheet", "title": "Object Required Error in excel VBA while trying to rename the sheet", "body": "<p>I am trying to copy a particular sheet and rename it to final. the code is as follows : </p>\n\n<pre><code>Sub CreateSheet()\n  Worksheets(\"Key metrics\").Copy(Before:=Worksheets(1)).Name = \"Final\"\nEnd Sub\n</code></pre>\n\n<p>The program executes till copying the sheet with the contents but then it throws the error and doesn't rename my new sheet to final.</p>\n\n<p>thanks in advance.</p>\n"}, {"tags": ["windows", "excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1426620397, "post_id": 29107892, "comment_id": 46445545, "body": "Ever heard of the <code>Clipboard</code>?"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1426620673, "post_id": 29107892, "comment_id": 46445706, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms648709(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1426620529, "last_edit_date": 1525816098, "creation_date": 1426620529, "answer_id": 29108023, "question_id": 29107892, "link": "https://stackoverflow.com/questions/29107892/what-does-copy-paste-actually-do-where-is-the-copied-information-stored-vba/29108023#29108023", "title": "What does copy/paste actually do? Where is the copied information stored? - VBA", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff837718.aspx\" rel=\"nofollow noreferrer\">The <code>Copy</code> method:</a> </p>\n\n<blockquote>\n  <p>Copies the specified range to the Clipboard.</p>\n</blockquote>\n\n<p>You can easily verify this by copying a range of text (from an email, web browser, Excel spreadsheet, etc.) and then go in to your other document and paste it.</p>\n\n<p>You can <em>access</em> the clipboard from the MSForms.DataObject class:</p>\n\n<p><a href=\"http://www.cpearson.com/excel/Clipboard.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/Clipboard.aspx</a></p>\n\n<pre><code>Dim DataObj As Object ' MSForms.DataObject\nDim S As String\n\nSet DataObj = CreateObject(\"MSForms.DataObject\")\nDataObj.GetFromClipboard\nS = DataObj.GetText\nDebug.Print S\n</code></pre>\n\n<p>Chip Pearson's site has some other examples for working with, manipulating, putting items in, etc., with the Clipboard. </p>\n"}], "owner": {"reputation": 328, "user_id": 3203246, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ff559ad8929b01e3ef1a0c743f670743?s=128&d=identicon&r=PG&f=1", "display_name": "johnzilla", "link": "https://stackoverflow.com/users/3203246/johnzilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 29108023, "answer_count": 1, "score": -1, "last_activity_date": 1426626327, "creation_date": 1426620057, "last_edit_date": 1426626327, "question_id": 29107892, "link": "https://stackoverflow.com/questions/29107892/what-does-copy-paste-actually-do-where-is-the-copied-information-stored-vba", "title": "What does copy/paste actually do? Where is the copied information stored? - VBA", "body": "<p>I'm just wondering exactly what is happening when you do something like </p>\n\n<pre><code>Range(\"test\").Copy\n</code></pre>\n\n<p>Is there some sort of Windows \"Global\" copy/paste space that stores this information? How can you access this? </p>\n"}, {"tags": ["vba", "file-upload", "vbscript", "asp-classic", "winhttp"], "comments": [{"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1426690714, "post_id": 29107404, "comment_id": 46476894, "body": "The error points to <code>Object required: &#39;fields(...)&#39;</code> the provided code shows no mention of the <code>fields</code> collection so I would suggest you&#39;re looking in the wrong place. Did the error not contain a page name and line number?"}, {"owner": {"reputation": 339, "user_id": 2112697, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a2fc82891744f6a6da61d02cba10a3d?s=128&d=identicon&r=PG", "display_name": "luckasx", "link": "https://stackoverflow.com/users/2112697/luckasx"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1426692404, "post_id": 29107404, "comment_id": 46478188, "body": "The error is caused because the result of the function GetUpload at the file upload.inc is empty. Like I posted there is a condition to start the upload (if Fields(&quot;File1&quot;).FileName = &quot;&quot;  do nothing else start the upload)"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1426694516, "post_id": 29107404, "comment_id": 46479775, "body": "I don&#39;t think that will ever work like that, your trying to pass in effect what is binary multipart data as a string. The multipart form post handles all the boundary information you can&#39;t pass that before it&#39;s processed, you&#39;ll just end up with a malformed multipart. Try viewing the request using <a href=\"http://www.telerik.com/fiddler\" rel=\"nofollow noreferrer\">Fiddler</a> to see what the RAW request looks like."}, {"owner": {"reputation": 339, "user_id": 2112697, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a2fc82891744f6a6da61d02cba10a3d?s=128&d=identicon&r=PG", "display_name": "luckasx", "link": "https://stackoverflow.com/users/2112697/luckasx"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1426696383, "post_id": 29107404, "comment_id": 46481112, "body": "I viewed the request with Firebug. And I set the sPostData to be like the request in the browser. I will create a similar page with the same server-side code and then maybe find out something. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 339, "user_id": 2112697, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a2fc82891744f6a6da61d02cba10a3d?s=128&d=identicon&r=PG", "display_name": "luckasx", "link": "https://stackoverflow.com/users/2112697/luckasx"}, "is_accepted": true, "score": 1, "last_activity_date": 1426710443, "creation_date": 1426710443, "answer_id": 29132010, "question_id": 29107404, "link": "https://stackoverflow.com/questions/29107404/vba-upload-text-file/29132010#29132010", "title": "Vba Upload Text File", "body": "<p>I created a copy of the upload page and looked for something wrong. I found out that the boundary reconigzed by the page was <code>\"myboundary\" + ;Charset=UTF-8</code>.</p>\n\n<p>The solution in this case is add the charset in the request header.</p>\n\n<pre><code>With WinHttpReq\n\n'UPLOAD REQUEST\n.Open \"POST\", sUrl, False\n.setRequestHeader \"Content-Type\", \"multipart/form-data; Charset=UTF-8;boundary=\" &amp; STR_BOUNDARY\n.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n.Send (sPostData)\nend with\n</code></pre>\n\n<p>.setRequestHeader \"Content-Type\", \"multipart/form-data; <strong>Charset=UTF-8;</strong> boundary=\" &amp; STR_BOUNDARY</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4419835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7faf063cd9931936c003b5e5562f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "Fiszpan Porcel", "link": "https://stackoverflow.com/users/4419835/fiszpan-porcel"}, "edited": false, "score": 0, "creation_date": 1433442147, "post_id": 30649857, "comment_id": 49365991, "body": "Well... to adapt it to use in Classic ASP, you can follow my response adapting it by removing everything related to Excel. Or just go through its essence: first, load the file in a byte array, then convert this data in a Base64 string, then send this string to the destination page (as a common FORM request, not as in a upload form). The server must be able to decode the base64 String and save it in a file with the same name and extension.  At least, it was tested with small files, including videos. Text files also work very well."}], "tags": [], "owner": {"reputation": 1, "user_id": 4419835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7faf063cd9931936c003b5e5562f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "Fiszpan Porcel", "link": "https://stackoverflow.com/users/4419835/fiszpan-porcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1433438961, "last_edit_date": 1495542732, "creation_date": 1433437045, "answer_id": 30649857, "question_id": 29107404, "link": "https://stackoverflow.com/questions/29107404/vba-upload-text-file/30649857#30649857", "title": "Vba Upload Text File", "body": "<p>Today I discovered I can upload files (either text or binary) from VBA Excel (could be Word, MSAccess or Outlook too) through standard POST (at least it works for small files). \nFirst, it opens a file in a byte array.\nSecond, it converts the byte array to a Base64 String.\nThird, it uses an IE object to fill a form and submit it, with no direct user interaction.</p>\n\n<pre><code>Public Function UploadFileTo(sourceFile As String, uURL As String, nameFieldID As String, dataFieldID As String, formID As String) As Boolean\n    UploadFileTo = False\n    ''---------------------------\n    Dim nome As String, dados64\n    Dim bs() As Byte\n    nome = Dir(sourceFile)\n    If (nome = \"\") Then Exit Function\n    ''\n    bs = ReadFile2(\"\" &amp; sourceFile) ' loads the file into a byte array\n    dados64 = Base64Encode(bs) ' encodes it to base64 and returns as String\n    ''\n    Dim ie As InternetExplorerMedium\n    'Dim ie 'As Object\n    Dim docweb As Object\n    Set ie = New InternetExplorerMedium\n    'Set ie = CreateObject(\"InternetExplorerMedium\")\n    'Set ie = GetObject(\"new:{D5E8041D-920F-45e9-B8FB-B1DEB82C6E5E}\")\n    ie.Navigate2 uURL\n    ie.Visible = True\n    While ie.Busy: DoEvents: Wend\n    While ie.ReadyState &lt;&gt; 4: DoEvents: Wend\n    ''\n    Set docweb = ie.Document\n    docweb.all(nameFieldID).Value = nome\n    docweb.all(dataFieldID).Value = dados64\n    docweb.all(formID).Submit\n    While ie.Busy: DoEvents: Wend\n    While ie.ReadyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n    ''\n    ie.Quit\n    ''---------------------------\n    UploadFileTo = True\nEnd Function\n</code></pre>\n\n<p>For example: to call the following page:</p>\n\n<pre><code>if UploadFileTo(\"C:\\myPath\\myFile.txt\", \"http://www.website.com/page.html\", \"myFileNameField\", \"myFileData\", \"myDistantForm\") then\n    MsgBox \"File Uploaded successfully\"\nelse\n    MsgBox \"Failed.\"\nend if\n</code></pre>\n\n<p>It calls the URL <a href=\"http://www.website.com/page.html\" rel=\"nofollow noreferrer\">http://www.website.com/page.html</a></p>\n\n<pre><code>&lt;html&gt;\n &lt;head&gt;\n  &lt;title&gt;Sending files within POST with base64 encoding&lt;/title&gt;\n &lt;/head&gt;\n &lt;body&gt;\n  &lt;form id=\"myDistantForm\" action=\"teste.cgi\" method=\"POST\"&gt;\n   Name: &lt;input type=\"text\" id=\"finame\" name=\"arq_nome\" value=\"\"&gt;    &lt;br&gt;\n   Data: &lt;textarea name=\"myFileNameField\" id=\"fidata\" rows=\"30\" cols=\"120\"&gt;&lt;/textarea&gt; &lt;br&gt;\n   &lt;input type=\"submit\" name=\"myFileData\" value=\"Send the File\"&gt; &lt;br&gt;\n  &lt;/form&gt;\n &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>IMPORTANT: The server must be able to decode a Base64-encoded string and, then, save the decoded data into a file in the desired server directory, using the given name (or some auto-generated, unique name), no matter if the target server runs ASP, PHP, JSP, CGI/ISAPI or whatever.</p>\n\n<p>To read any file to a Byte array: <a href=\"https://stackoverflow.com/questions/660312/how-can-i-read-a-binary-file-using-vba\">how can I read a binary file using VBA?</a></p>\n\n<p>To encode that array into a Base64 String: <a href=\"https://stackoverflow.com/questions/169907/how-do-i-base64-encode-a-string-efficiently-using-excel-vba\">How do I base64 encode a string efficiently using Excel VBA?</a></p>\n"}], "owner": {"reputation": 339, "user_id": 2112697, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a2fc82891744f6a6da61d02cba10a3d?s=128&d=identicon&r=PG", "display_name": "luckasx", "link": "https://stackoverflow.com/users/2112697/luckasx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5674, "favorite_count": 1, "accepted_answer_id": 29132010, "answer_count": 2, "score": 0, "last_activity_date": 1490279694, "creation_date": 1426618367, "question_id": 29107404, "link": "https://stackoverflow.com/questions/29107404/vba-upload-text-file", "title": "Vba Upload Text File", "body": "<p>I'm trying to upload a plain text file to a classic asp page and getting an error.  </p>\n\n<pre><code>&lt;p&gt;Microsoft VBScript runtime &lt;/font&gt; &lt;font face=\"Arial\" size=2&gt;error '800a01a8'&lt;/font&gt;\n&lt;p&gt;\n&lt;font face=\"Arial\" size=2&gt;Object required: 'fields(...)'&lt;/font&gt;\n</code></pre>\n\n<p>Html Code</p>\n\n<pre><code>&lt;form action=\"upload.asp\" method=post ENCTYPE=\"multipart/form-data\"&gt;\n      File :\n&lt;input type=\"file\" class=\"form_field\" name=\"File1\" accept=\"image/jpeg\"&gt;\n&lt;input type=\"submit\" class=\"form_pb\" Name=\"Action\" value=\"Send File\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Vba Code to set the post variable and send the request.</p>\n\n<pre><code>    Const STR_BOUNDARY  As String = \"a832972453175\"\n    Dim nFile           As Integer\n    Dim baBuffer()      As Byte\n    Dim sPostData       As String\n....\n\n'--- read file\nnFile = FreeFile\nOpen sFileName For Binary Access Read As nFile\n    If LOF(nFile) &gt; 0 Then\n        ReDim baBuffer(0 To LOF(nFile) - 1) As Byte\n        Get nFile, , baBuffer\n        sPostData = StrConv(baBuffer, vbUnicode)\n    End If\nClose nFile\n\nsPostData = \"--\" &amp; STR_BOUNDARY &amp; vbCrLf &amp; _\n        \"Content-Disposition: form-data; name=\"\"File1\"\"; filename=\"\"\" &amp; Mid$(sFileName, InStrRev(sFileName, \"\\\") + 1) &amp; \"\"\"\" &amp; vbCrLf &amp; _\n            \"Content-Type: text/plain\" &amp; vbCrLf &amp; vbCrLf &amp; _\n            sPostData &amp; vbCrLf &amp; vbCrLf &amp; _\n            STR_BOUNDARY &amp; vbCrLf &amp; _\n            \"Content-Disposition: form-data; name=\"\"Action\"\"\" &amp; vbCrLf &amp; _\n             vbCrLf &amp; \"Send File\" &amp; vbCrLf &amp; _\n            \"--\" &amp; STR_BOUNDARY &amp; \"--\"\n\nWith WinHttpReq\n\n'UPLOAD REQUEST\n.Open \"POST\", sUrl, False\n.setRequestHeader \"Content-Type\", \"multipart/form-data; boundary=\" &amp; STR_BOUNDARY\n.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n.Send (sPostData)\nend with\n</code></pre>\n\n<p>I have access to the source code of the page that is a classic asp page and the upload is executed with a vbscript running at the server.</p>\n\n<p>The error is that the File1 argument = \"\" and then the upload doesnt start.</p>\n\n<p>Despite the attribute accept in the html code is only for \"image/jpeg\" I can upload normally when navigating with a browser.</p>\n\n<p>I think is something wrong with my sPostData variable in Vba code.</p>\n\n<p>The file with the upload functions is here: <a href=\"https://www.royalholloway.ac.uk/resources/ASP/PStruh-CZ/1.3/upload.inc\" rel=\"nofollow\">https://www.royalholloway.ac.uk/resources/ASP/PStruh-CZ/1.3/upload.inc</a></p>\n\n<p>Anyone can see what am I doing wrong?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426622048, "post_id": 29107246, "comment_id": 46446483, "body": "Thanks!  I saw that in the documentation, but then when I set the filter equal to the same string I tried to pass using openform it worked, so I thought that maybe there was something else I needed to do to get it to work.  It&#39;s been a long day...."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 2, "creation_date": 1426622413, "post_id": 29107246, "comment_id": 46446714, "body": "Yeah, I investigated further and I think the situation is misleading.  When you give <code>OpenForm</code> a string value for <i>FilterName</i> which does not match the name of a saved query, Access doesn&#39;t complain --- it just proceeds to open the form same as if you&#39;d not supplied a <i>FilterName</i> in the first place.  Seems to me it should alert you that it can&#39;t find the query.  But I really never use <i>FilterName</i>; <i>WhereCondition</i> is the way to go.  ;-)"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1426618209, "last_edit_date": 1426618209, "creation_date": 1426617878, "answer_id": 29107246, "question_id": 29107108, "link": "https://stackoverflow.com/questions/29107108/open-access-form-with-filter-vba/29107246#29107246", "title": "Open Access Form with Filter VBA", "body": "<p>Here is what the <em>DoCmd.OpenForm Method</em> help topic has to say about the <em>FilterName</em> parameter:</p>\n\n<blockquote>\n  <p>A string expression that's the valid name of a query in the current\n  database.</p>\n</blockquote>\n\n<p>But you're not giving it the name of a query.  I think you actually want the <em>WhereCondition</em> parameter instead:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OpenForm FormName:=\"MyForm\", _\n    WhereCondition:=\"[ID] = \" &amp; Me.MyListBox.Column(0), _\n    DataMode:=acFormEdit, _\n    WindowMode:=acDialog\n</code></pre>\n"}], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10681, "favorite_count": 0, "accepted_answer_id": 29107246, "answer_count": 1, "score": 2, "last_activity_date": 1426618209, "creation_date": 1426617389, "last_edit_date": 1426617958, "question_id": 29107108, "link": "https://stackoverflow.com/questions/29107108/open-access-form-with-filter-vba", "title": "Open Access Form with Filter VBA", "body": "<p>I'm having trouble opening a form using a filter.  The code that I am trying to run is this:</p>\n\n<pre><code>DoCmd.OpenForm \"MyForm\", , \"[ID] = \" &amp; Me.MyListBox.Column(0), , acFormEdit, acDialog\n</code></pre>\n\n<p>When I run this line, it opens the form, but does not apply the filter.</p>\n\n<p>The FilterOnLoad property is set to True, and I have verified that it is true in the On Load event.</p>\n\n<p>While in the Form_Load event, Me.FilterOn = False and Me.Filter = \"\".</p>\n\n<p>What happened to the filter?  What am I doing wrong?  I've tried setting the Me.FilterOn property to True via VBA and then saving the form, but when I open the form again, it is reset to False.</p>\n\n<p>If I put the filter in using VBA and then set the Me.FilterOn property to True, the form correctly filters.  I have verified that the correct value is there for \"Me.MyListBox.Column(0)\"</p>\n"}, {"tags": ["excel", "csv", "ms-word", "vba"], "comments": [{"owner": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "edited": false, "score": 0, "creation_date": 1426616715, "post_id": 29106807, "comment_id": 46443525, "body": "Are you sure you&#39;re opening the file you think you&#39;re opening?"}, {"owner": {"reputation": 23, "user_id": 3817333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89866ce46151b13ef388e0b7e597c34?s=128&d=identicon&r=PG&f=1", "display_name": "Xephr", "link": "https://stackoverflow.com/users/3817333/xephr"}, "reply_to_user": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "edited": false, "score": 0, "creation_date": 1426617224, "post_id": 29106807, "comment_id": 46443803, "body": "Not sure what you mean? I opened the csv file in excel and run the vba code from there. which opens a word file to move the csv data into."}, {"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "edited": false, "score": 0, "creation_date": 1426618336, "post_id": 29106807, "comment_id": 46444429, "body": "If its returning 1 you might be calling the wrong workbook. what is <code>WB</code> ? did you try using <code>LastRow = ThisWorkbook.Sheets(1).UsedRange.Rows.Count</code> ?"}, {"owner": {"reputation": 23, "user_id": 3817333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89866ce46151b13ef388e0b7e597c34?s=128&d=identicon&r=PG&f=1", "display_name": "Xephr", "link": "https://stackoverflow.com/users/3817333/xephr"}, "edited": false, "score": 0, "creation_date": 1426618803, "post_id": 29106807, "comment_id": 46444682, "body": "Only 1 WB open and yes i did try thisworkbook. I thought that was the problem so i set set WB to ThisWorkbook."}], "owner": {"reputation": 23, "user_id": 3817333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89866ce46151b13ef388e0b7e597c34?s=128&d=identicon&r=PG&f=1", "display_name": "Xephr", "link": "https://stackoverflow.com/users/3817333/xephr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1426616300, "creation_date": 1426616300, "last_edit_date": 1531164843, "question_id": 29106807, "link": "https://stackoverflow.com/questions/29106807/excel-vba-vba-code-not-picking-up-data-in-csv-file", "title": "Excel VBA: VBA code not picking up data in CSV file", "body": "<p>My current code reads as follows:</p>\n\n<pre><code>LastRow = WB.Sheets(1).UsedRange.Rows.Count  \n'...\nFor irow = 6 To LastRow\n            WordFile.Tables(1).Cell(irow, 7).Range.Text = WB.Sheets(1).Cells(irow, 22)   \nNext\n</code></pre>\n\n<p>My CSV file opens up with data in it's designated columns so i don't need to seperate data. However, my code doesn't seem to be reading any data in my CSV file. Lastrow keeps coming out to 1, no matter what method i use (there's 10 rows of data). When the code runs with no errors, the cells in my word table are still blank. Please help. </p>\n"}, {"tags": ["html", "vba", "excel", "webpage"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1426613943, "post_id": 29105978, "comment_id": 46441849, "body": "<code>Loop Until IE.readyState = READYSTATE_COMPLETE</code> where is variable IE is defined?"}, {"owner": {"reputation": 73, "user_id": 3700469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d717b4c4786d027a88233eca58879f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Panagiotis O.", "link": "https://stackoverflow.com/users/3700469/panagiotis-o"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1426614160, "post_id": 29105978, "comment_id": 46441986, "body": "Opps Sorry...  MyBrowser.readyState = READYSTATE_COMPLETE"}, {"owner": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1426617763, "post_id": 29105978, "comment_id": 46444095, "body": "@PanagiotisO. I tested your sub, and it got to the webpage, and the Number field was filled in as &#39;11&#39; and Suffix was &#39;R&#39;... is this not what you want it to do?"}, {"owner": {"reputation": 73, "user_id": 3700469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d717b4c4786d027a88233eca58879f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Panagiotis O.", "link": "https://stackoverflow.com/users/3700469/panagiotis-o"}, "reply_to_user": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1426620448, "post_id": 29105978, "comment_id": 46445569, "body": "@bsapaka I neither get the fields filled in nor I get entries at the result table at the webpage."}, {"owner": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1426620792, "post_id": 29105978, "comment_id": 46445782, "body": "@PanagiotisO.  I am using IE 11, what are you using? Not sure if that would be a factor but it might"}, {"owner": {"reputation": 73, "user_id": 3700469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d717b4c4786d027a88233eca58879f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Panagiotis O.", "link": "https://stackoverflow.com/users/3700469/panagiotis-o"}, "reply_to_user": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1426620933, "post_id": 29105978, "comment_id": 46445859, "body": "@bsapaka I am using IE 9. I will update it and I will comment again if that will work."}, {"owner": {"reputation": 73, "user_id": 3700469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d717b4c4786d027a88233eca58879f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Panagiotis O.", "link": "https://stackoverflow.com/users/3700469/panagiotis-o"}, "reply_to_user": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1426621998, "post_id": 29105978, "comment_id": 46446458, "body": "@bsapaka I just updated the IE to 11th version. No luck. I don&#39;t know what is wrong."}, {"owner": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1426623914, "post_id": 29105978, "comment_id": 46447538, "body": "@PanagiotisO. try on a different computer"}, {"owner": {"reputation": 73, "user_id": 3700469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d717b4c4786d027a88233eca58879f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Panagiotis O.", "link": "https://stackoverflow.com/users/3700469/panagiotis-o"}, "reply_to_user": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1426834648, "post_id": 29105978, "comment_id": 46541619, "body": "@bsapaka You were right! The problem was my organization&#39;s pc, not the code itself."}], "answers": [{"tags": [], "owner": {"reputation": 1081, "user_id": 1464160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aba121da658c6c428963d05357c502b6?s=128&d=identicon&r=PG", "display_name": "TheDude", "link": "https://stackoverflow.com/users/1464160/thedude"}, "is_accepted": true, "score": 1, "last_activity_date": 1426732561, "creation_date": 1426732561, "answer_id": 29136265, "question_id": 29105978, "link": "https://stackoverflow.com/questions/29105978/fill-a-web-form-via-vba/29136265#29136265", "title": "Fill a web form via VBA", "body": "<p>It's your organizations network blocking the traffic</p>\n\n<p>Try a different computer on a different network</p>\n"}], "owner": {"reputation": 73, "user_id": 3700469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d717b4c4786d027a88233eca58879f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Panagiotis O.", "link": "https://stackoverflow.com/users/3700469/panagiotis-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4227, "favorite_count": 0, "accepted_answer_id": 29136265, "answer_count": 1, "score": 2, "last_activity_date": 1426732561, "creation_date": 1426613816, "last_edit_date": 1495542135, "question_id": 29105978, "link": "https://stackoverflow.com/questions/29105978/fill-a-web-form-via-vba", "title": "Fill a web form via VBA", "body": "<p><em>Intro:</em> I would like first of all to state that I am not comfortable at all when it comes to \"HTML\". I have done an exhausted web-search of how to accomplish the below described task. (e.g. <a href=\"https://stackoverflow.com/questions/18034441/retrieving-data-from-the-web-using-vba\">Retrieving data from the web using vba</a>, <a href=\"https://www.youtube.com/watch?v=kdD2bb4DU6c\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=kdD2bb4DU6c</a>, <a href=\"https://www.youtube.com/watch?v=GswfT0Mrr5M\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=GswfT0Mrr5M</a> )</p>\n\n<p><em>Problem:</em> In summary would like to fill in a website form (about 10^3 times), submit the query and get each result. In order to test it and keep it simple I am testing it for one value. The VBA code that I managed to put together so far is based on what others have done. It opens a new IE window with the desired URL but it does not fill the desired fields with the \"test\" Permit # (11) and Suffix (R).</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim MyBrowser As InternetExplorer\n\nSub Test()\n\nDim MyHTML_Element As IHTMLElement\nDim HTMLDoc As HTMLDocument\nDim MyURL As String\nOn Error GoTo Err_Clear\nMyURL = \"http://www.dwr.state.co.us/wellpermitsearch/\"\n''open new explorer\nSet MyBrowser = New InternetExplorer\nMyBrowser.Silent = True\n''navigate to page\nMyBrowser.navigate MyURL\nMyBrowser.Visible = True\n''wait until ready\nDo\nDoEvents\nLoop Until MyBrowser.readyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = MyBrowser.document\n''enter permit number and suffix in text box\nHTMLDoc.all.txtPermit.Value = \"11\"\nHTMLDoc.all.txtPermitSuf.Value = \"R\"\n'# HTMLDoc.getElementById(\"txtPermit\").attribute.Value = \"11\"\n'# HTMLDoc.getElementById(\"txtPermitSuf\").attribute.Value = \"R\"\nFor Each MyHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\n'# If MyHTML_Element.ID = \"txtPermit\" Then MyHTML_Element.Value = \"11\"\n'# If MyHTML_Element.ID = \"txtPermitSuf\" Then MyHTML_Element.Value = \"R\"\nIf MyHTML_Element.Type = \"submit\" Then MyHTML_Element.Click: Exit For\nNext\nErr_Clear:\n If Err &lt;&gt; 0 Then\n Err.Clear\n Resume Next\n End If\n\nEnd Sub\n</code></pre>\n\n<p>I have also included some commented code \" '# \" that are other ways that a friend suggested me that might work. Does anyone have any idea what am I missing???</p>\n\n<p><strong>Thank you in advance for your help and time! :)</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 206, "user_id": 3727202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7eba6bc8ec53d9c30d48a4f69ab66aa?s=128&d=identicon&r=PG&f=1", "display_name": "tfitzger", "link": "https://stackoverflow.com/users/3727202/tfitzger"}, "edited": false, "score": 0, "creation_date": 1426613769, "post_id": 29105849, "comment_id": 46441748, "body": "What data are you providing as parameters to the function?"}, {"owner": {"reputation": 83, "user_id": 4237187, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/89d331887781719dc3d8068c38ec9837?s=128&d=identicon&r=PG&f=1", "display_name": "kliest0106", "link": "https://stackoverflow.com/users/4237187/kliest0106"}, "reply_to_user": {"reputation": 206, "user_id": 3727202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7eba6bc8ec53d9c30d48a4f69ab66aa?s=128&d=identicon&r=PG&f=1", "display_name": "tfitzger", "link": "https://stackoverflow.com/users/3727202/tfitzger"}, "edited": false, "score": 0, "creation_date": 1426615366, "post_id": 29105849, "comment_id": 46442694, "body": "The data are from excel cell. for example = Get_Tier(ProductA, 150), It works when call by sub - Call Get_Tier2(ProductA, 150), I will get the popup message box return correct Tier."}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1426619549, "post_id": 29105849, "comment_id": 46445060, "body": "Is that exactly how it&#39;s typed in your formula?  &quot;= Get_Tier(ProductA, 150)&quot; if so then it&#39;s looking for a named range.  You&#39;d need &quot;=Get_Tier(&quot;ProjectA&quot;, 150)&quot; in order to pass a string"}, {"owner": {"reputation": 83, "user_id": 4237187, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/89d331887781719dc3d8068c38ec9837?s=128&d=identicon&r=PG&f=1", "display_name": "kliest0106", "link": "https://stackoverflow.com/users/4237187/kliest0106"}, "reply_to_user": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1426627613, "post_id": 29105849, "comment_id": 46449479, "body": "@Sobigen:T he function is referring other cell, so it would be like &quot;=Get_Tier(BB219,M219)&quot;, Cell BB219 Has Value ProductA, Cell M219 has Value 150, I do tried &quot;=Get_Tier(&quot;&quot;&quot;&quot;&amp;BB219&amp;&quot;&quot;&quot;&quot;,M219)&quot; and not work as well"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1426697378, "post_id": 29105849, "comment_id": 46481800, "body": "Very strange, try setting a breakpoint on the top line (Function Get_Tier...) and see where the error occurs. The function should run when the sheet is re-calculated.  Double check what the inputs are coming in as, it seems like it has to be something with the inputs if the sub works."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4237187, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/89d331887781719dc3d8068c38ec9837?s=128&d=identicon&r=PG&f=1", "display_name": "kliest0106", "link": "https://stackoverflow.com/users/4237187/kliest0106"}, "edited": false, "score": 0, "creation_date": 1426643087, "post_id": 29107805, "comment_id": 46454668, "body": ":thank you for your input, I do change the code to -ThisWorkbook.Worksheets(&quot;CIDTier&quot;).Range(&quot;A:A&quot;).UsedRange.R&zwnj;&#8203;ows.Count but still getting the #Value! Error"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1426643926, "post_id": 29107805, "comment_id": 46454867, "body": "How many rows are you working with?  The integer will still overflow if it&#39;s more than 32768 but if it&#39;s working as a sub that&#39;s probably not the case."}, {"owner": {"reputation": 83, "user_id": 4237187, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/89d331887781719dc3d8068c38ec9837?s=128&d=identicon&r=PG&f=1", "display_name": "kliest0106", "link": "https://stackoverflow.com/users/4237187/kliest0106"}, "reply_to_user": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1426696705, "post_id": 29107805, "comment_id": 46481330, "body": "@Sobigen: The rows at CIDTier tab is 5 rows and expected around 100 rows in the future."}], "tags": [], "owner": {"reputation": 206, "user_id": 3727202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7eba6bc8ec53d9c30d48a4f69ab66aa?s=128&d=identicon&r=PG&f=1", "display_name": "tfitzger", "link": "https://stackoverflow.com/users/3727202/tfitzger"}, "is_accepted": false, "score": 0, "last_activity_date": 1426619763, "creation_date": 1426619763, "answer_id": 29107805, "question_id": 29105849, "link": "https://stackoverflow.com/questions/29105849/excel-vba-function-take-2-different-data-type-and-loop-through-collection-of-cla/29107805#29107805", "title": "Excel VBA function take 2 different data type and loop through collection of class module", "body": "<h3>The Culprit</h3>\n\n<pre><code>CIDTierCount = ThisWorkbook.Worksheets(\"CIDTier\").Range(\"A:A\").CurrentRegion.Rows.Count\n</code></pre>\n\n<p>If you throw a debug marker on that line and print what </p>\n\n<pre><code>ThisWorkbook.Worksheets(\"CIDTier\").Range(\"A:A\").CurrentRegion.Rows.Count\n</code></pre>\n\n<p>returns, you get <code>1048576</code>. This will overflow the Integer you are trying to place it in.</p>\n\n<h3>Possible Solution</h3>\n\n<p>From what you are doing, it looks like you want a count of rows, you can try changing the code to the following:</p>\n\n<pre><code>CIDTierCount = Worksheets(\"CIDTier\").UsedRange.Rows.Count\n</code></pre>\n\n<h3>Why this works</h3>\n\n<p>In Excel, each worksheet has a range that is defined as the UsedRange. This range goes from A1 to the farthest right column that is formatted or contains data and the lowest row that is formatted or contains data. </p>\n"}], "owner": {"reputation": 83, "user_id": 4237187, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/89d331887781719dc3d8068c38ec9837?s=128&d=identicon&r=PG&f=1", "display_name": "kliest0106", "link": "https://stackoverflow.com/users/4237187/kliest0106"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1426636276, "creation_date": 1426613433, "last_edit_date": 1426636276, "question_id": 29105849, "link": "https://stackoverflow.com/questions/29105849/excel-vba-function-take-2-different-data-type-and-loop-through-collection-of-cla", "title": "Excel VBA function take 2 different data type and loop through collection of class module", "body": "<p>I have following sub working but get #VALUE! error after change sub into function.\n<br>Working sub as follow</p>\n\n<pre><code>Sub Get_Tier2(ByVal myCategory As String, ByVal myMSRP As Double)\n\nDim ProductTiers As Collection\nDim pt As ProductTier\nDim result As String\nDim CIDTierCount As Integer\nCIDTierCount = ThisWorkbook.Worksheets(\"CIDTier\").Range(\"A:A\").CurrentRegion.Rows.Count\n\nSet ProductTiers = New Collection\n\nFor i = 2 To CIDTierCount\n    Set pt = New ProductTier\n    pt.Category = ThisWorkbook.Worksheets(\"CIDTier\").Rows(i).Columns(\"B\")\n    pt.Tier = ThisWorkbook.Worksheets(\"CIDTier\").Rows(i).Columns(\"C\")\n    pt.MSRP_Low = ThisWorkbook.Worksheets(\"CIDTier\").Rows(i).Columns(\"D\")\n    pt.MSRP_High = ThisWorkbook.Worksheets(\"CIDTier\").Rows(i).Columns(\"E\")\n    ProductTiers.Add pt\nNext\n\n\nFor Each pt In ProductTiers\n\n    If StrComp(pt.Category, myCategory) = 0 And pt.MSRP_Low &lt; myMSRP And myMSRP &lt; pt.MSRP_High Then\n        result = pt.Tier()\n        MsgBox result\n        Exit Sub\n    Else\n        'do nothing\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>When I change the sub to function and try to use in excel, it will return me #VALUE! in excel</p>\n\n<pre><code>Function Get_Tier(ByVal myCategory As String, ByVal myMSRP As Double) As String\n\nDim ProductTiers As Collection\nDim pt As ProductTier\nDim result As String\n\nDim CIDTierCount As Integer\nCIDTierCount = ThisWorkbook.Worksheets(\"CIDTier\").Range(\"A:A\").CurrentRegion.Rows.Count\n\nSet ProductTiers = New Collection\n\nFor i = 2 To CIDTierCount\n    Set pt = New ProductTier\n\n    pt.Category = ThisWorkbook.Worksheets(\"CIDTier\").Rows(i).Columns(\"B\")\n    pt.Tier = ThisWorkbook.Worksheets(\"CIDTier\").Rows(i).Columns(\"C\")\n    pt.MSRP_Low = ThisWorkbook.Worksheets(\"CIDTier\").Rows(i).Columns(\"D\")\n    pt.MSRP_High = ThisWorkbook.Worksheets(\"CIDTier\").Rows(i).Columns(\"E\")\n    ProductTiers.Add pt\nNext\n\nFor Each pt In ProductTiers\n    If StrComp(pt.Category, myCategory) = 0 And pt.MSRP_Low &lt; myMSRP And myMSRP &lt; pt.MSRP_High Then\n        Get_Tier = pt.Tier()\n        Exit Function\n    Else\n        Get_Tier = \"no match\"\n    End If\nNext\n\nEnd Function\n</code></pre>\n\n<p>Class Module ProductTier are as follow</p>\n\n<pre><code>Private pCategory As String\nPrivate pTier As String\nPrivate pMSRP_Low As Double\nPrivate pMSRP_High As Double\n\nPublic Property Get Category() As String\n    Category = pCategory\nEnd Property\n\nPublic Property Let Category(Value As String)\n    pCategory = Value\nEnd Property\n\nPublic Property Get Tier() As String\n    Tier = pTier\nEnd Property\n\nPublic Property Let Tier(Value As String)\n    pTier = Value\nEnd Property\n\nPublic Property Get MSRP_Low() As String\n    MSRP_Low = pMSRP_Low\nEnd Property\n\nPublic Property Let MSRP_Low(Value As String)\n    pMSRP_Low = Value\nEnd Property\n\nPublic Property Get MSRP_High() As String\n    MSRP_High = pMSRP_High\nEnd Property\n\nPublic Property Let MSRP_High(Value As String)\n    pMSRP_High = Value\nEnd Property\n</code></pre>\n\n<p>And the data on CIDTier tab\n<br>Column B: ProductA\n<br>Column C: Tier 1\n<br>Column D: 0\n<br>Column E: 300</p>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 22156, "user_id": 154439, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/63c2ea30cedb0e3a9488df1e1861d1e7?s=128&d=identicon&r=PG", "display_name": "mwolfe02", "link": "https://stackoverflow.com/users/154439/mwolfe02"}, "edited": false, "score": 1, "creation_date": 1426611205, "post_id": 29104830, "comment_id": 46440082, "body": "Can you post your entire code block?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1426611215, "post_id": 29104830, "comment_id": 46440088, "body": "Access doesn&#39;t have an <code>Application.DisplayAlerts</code> property; that&#39;s an Excel thing.  If you&#39;re actually asking about Excel VBA code which interacts with an Access database, please clarify that point.  Thanks."}, {"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1426611277, "post_id": 29104830, "comment_id": 46440133, "body": "I&#39;m in Access. The Application.DisplayAlerts was just bad information I found elsewhere that I thought would work"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1426611458, "post_id": 29104830, "comment_id": 46440264, "body": "In that case, add <code>Option Explicit</code> to the Declarations section of your Access code module.  Then run Debug-&gt;Compile from the VB Editor&#39;s main menu.  Fix anything the compiler complains about."}], "answers": [{"comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1426612644, "post_id": 29105091, "comment_id": 46441065, "body": "I wasn&#39;t able to get it to work. Here is both codes I tried: DoCmd.RunSQL(INSERT INTO temptable (NAME) Select [Spec Use].name from [spec use] where ((([Spec use].use)=yes));)  CurrentDB.Execute(INSERT INTO temptable (NAME) Select [Spec Use].name from [spec use] where ((([Spec use].use)=yes));)"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1426613091, "post_id": 29105091, "comment_id": 46441346, "body": "<code>CurrentDB.Execute &quot;INSERT INTO temptable ([NAME]) Select [Spec Use].name from [spec use] where [Spec use].use=True;&quot;, dbFailOnError</code>"}], "tags": [], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "is_accepted": false, "score": 2, "last_activity_date": 1426611243, "last_edit_date": 1495534207, "creation_date": 1426611243, "answer_id": 29105091, "question_id": 29104830, "link": "https://stackoverflow.com/questions/29104830/vba-access-removing-warning-prompts/29105091#29105091", "title": "VBA/Access: Removing warning prompts", "body": "<p><code>SetWarnings</code> should generally be avoided, since it turns off warnings <em>globally</em>, and you must be very careful to turn them back on, even in the case of errors.</p>\n\n<p>An elegant way to get rid of the warnings is to <em>not</em> use querys to make data changes. Instead, copy the SQL of your INSERT or UPDATE statement to VBA and execute it with <a href=\"https://msdn.microsoft.com/en-us/library/bb243015%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">CurrentDb.Execute</a>:</p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO ...\", dbFailOnError\n</code></pre>\n\n<p>See also:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/11213892/whats-the-difference-between-docmd-setwarnings-and-currentdb-execute\">What&#39;s the difference between DoCmd.SetWarnings and CurrentDB.Execute</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 2, "last_activity_date": 1426617352, "last_edit_date": 1426617352, "creation_date": 1426611914, "answer_id": 29105330, "question_id": 29104830, "link": "https://stackoverflow.com/questions/29104830/vba-access-removing-warning-prompts/29105330#29105330", "title": "VBA/Access: Removing warning prompts", "body": "<p>You have 7 saved queries, <em>Query1</em> thru <em>Query7</em>, which you want to execute in order.  So just execute them without turning <code>SetWarnings</code> off.  Heinzi already explained why you should not turn <code>SetWarnings</code> off.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function Spec_Maker()\n    Dim i As Long\n\nOn Error GoTo spec_Maker_Err\n\n    For i = 1 To 7\n        CurrentDb.Execute \"Query\" &amp; i, dbFailOnError\n    Next\n\nSpec_Maker_Exit:\n    Exit Function\n\nspec_Maker_Err:\n    MsgBox Error$\n    Resume Spec_Maker_Exit\n\nEnd Function\n</code></pre>\n\n<p>Always include <code>Option Explicit</code> in the Declarations sections of all your code modules.  And run Debug->Compile from the VB Editor's main menu.  Fix anything the compiler complains about before proceeding with your troubleshooting efforts.  Had you done that, Access would have alerted you <em>\"Method or data member not found\"</em> at <code>Application.DisplayAlerts</code> because that property is not recognized in Access.</p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2486, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1426617352, "creation_date": 1426610523, "last_edit_date": 1592644375, "question_id": 29104830, "link": "https://stackoverflow.com/questions/29104830/vba-access-removing-warning-prompts", "title": "VBA/Access: Removing warning prompts", "body": "<p>I've built a Macro that runs 7 queries. The macro works exactly like I want, but because they are update and append queries Access prompts the user to approve of the updates and appendages. I would like to use VBA to turn off the warning messages so that the macro runs from beginning to end without interruption.</p>\n<p>I converted the macro to VBA and the code is pretty straightforward. There are 7 DoCmd.OpenQuery commands followed by a &quot;macro name&quot; Exit: and &quot;macro name&quot; Err:.\nI added this code before the first DoCmd.OpenQuery line</p>\n<blockquote>\n<p>DoCmd.SetWarnings False</p>\n<p>Application.DisplayAlerts=False</p>\n</blockquote>\n<p>Then at the end of the code</p>\n<blockquote>\n<p>DoCmd.SetWarnings True</p>\n<p>Application.DisplayAlerts=True</p>\n</blockquote>\n<p>This doesn't turn of the messages though when I try it. Any idea what VBA code I can use to turn off all the update, and append query warnings?</p>\n<p>edit: My VBA is</p>\n<pre><code>Option Compare Database\n\nFunction Spec_Maker()\nOn Error GoTo Spec_Maker_Err\n    DoCmd.SetWarnings False\n    Application.DisplayAlerts=False\n    DoCmd.OpenQuery &quot;Query1&quot;, acViewNormal, acEdit\n    DoCmd.OpenQuery &quot;Query2&quot;, acViewNormal, acEdit\n    DoCmd.OpenQuery &quot;Query3&quot;, acViewNormal, acEdit\n    DoCmd.OpenQuery &quot;Query4&quot;, acViewNormal, acEdit\n    DoCmd.OpenQuery &quot;Query5&quot;, acViewNormal, acEdit\n    DoCmd.OpenQuery &quot;Query6&quot;, acViewNormal, acEdit\n    DoCmd.OpenQuery &quot;Query7&quot;, acViewNormal, acEdit\n    DoCmd.SetWarnings True\n    Application.DisplayAlerts=True\n\nSpec_Maker_Exit:\n    Exit Function\n\nspec_Maker_Err:\n    MsgBox Error$\n    Resume Spec_Maker_Exit\n\nEnd Function\n</code></pre>\n"}]