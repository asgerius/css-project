[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513207597, "post_id": 47803524, "comment_id": 82568707, "body": "That works for me in XL2013."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1513208335, "post_id": 47803524, "comment_id": 82568953, "body": "It worked for me too, you have followed the right path, but I recommend checking the clear error macro itself. Make sure you have used <code>sub</code> and not <code>function</code>. Make sure you have only one button and right click on it and check if the macro has been assigned to it at all or not"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1513209830, "post_id": 47803524, "comment_id": 82569417, "body": "Me too, I see no reason this shouldn&#39;t work, Check your spelling, check the macro itself and avoid all <code>.Select</code>s, <code>.Activate</code>s, <code>ActiveSheet</code>s and <code>ActiveWorkbook</code>s as @K.Davis mentions."}, {"owner": {"reputation": 535, "user_id": 2854647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/198e1025a309115c12c98888f46f5e88?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/2854647/maki"}, "edited": false, "score": 0, "creation_date": 1513215280, "post_id": 47803524, "comment_id": 82570757, "body": "Have you enabled macros (check at Macro Settings)? Is your file saved as .xlsx (excel 2013 and above)?"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1513208382, "creation_date": 1513208382, "answer_id": 47803754, "question_id": 47803524, "link": "https://stackoverflow.com/questions/47803524/how-to-create-a-button-using-a-macro-to-run-a-macro/47803754#47803754", "title": "How to create a button using a macro to run a macro", "body": "<p>You could try to first <code>Set</code> the button to a variable declared as <code>Button</code>.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim Btn As Button, Summary As Worksheet\n    Set Summary = ThisWorkbook.Worksheets(1)\n    Set Btn = Summary.Buttons.Add(1039.8, 60.6, 66.6, 28.8)\n    With Btn\n        .OnAction = \"PERSONAL.XLSB!Clear_Error\"\n        .Characters.Text = \"Clear\"\n        With .Characters(Start:=1, Length:=11).Font\n            .Name = \"Calibri\"\n            .FontStyle = \"Regular\"\n            .Size = 11\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I personally (as well as most of the rest of the VBA community) have a strong dislike of <code>.Select</code>, <code>.Selection</code>, <code>.Activate</code>, etc. So that's usually the first thing I try to get rid of when I help with issues, then move from there.</p>\n\n<p><strong>Note:</strong> I did set <code>Summary</code> to worksheet 1, so that may need to be modified for your needs.</p>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 47803754, "answer_count": 1, "score": 0, "last_activity_date": 1513208382, "creation_date": 1513206761, "last_edit_date": 1513206966, "question_id": 47803524, "link": "https://stackoverflow.com/questions/47803524/how-to-create-a-button-using-a-macro-to-run-a-macro", "title": "How to create a button using a macro to run a macro", "body": "<p>I recorded a macro to help me run code I have written. The code itself works. However, I cannot seem to create a button that will run the code.</p>\n\n<pre><code>With Summary \n        .Buttons.Add(1039.8, 60.6, 66.6, 28.8).Select\n        Selection.OnAction = \"PERSONAL.XLSB!Clear_Error\"\n        Selection.Characters.Text = \"Clear\"\n        With Selection.Characters(Start:=1, Length:=11).Font\n            .Name = \"Calibri\"\n            .FontStyle = \"Regular\"\n            .Size = 11\n\nEnd With\n</code></pre>\n\n<p>Summary is the worksheet.The button is created but the button itself does nothing. Also, When I tried manually assigning the macro to the button, the code still does not work. However, when I run the code, it runs smoothly.</p>\n\n<p>Thanks,</p>\n\n<p>G</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 29, "user_id": 8941231, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e9f195bc2b51a96672e796157090dd94?s=128&d=identicon&r=PG&f=1", "display_name": "J.Ryan", "link": "https://stackoverflow.com/users/8941231/j-ryan"}, "edited": false, "score": 0, "creation_date": 1513261419, "post_id": 47806809, "comment_id": 82592595, "body": "If the answer helped you to solve the problem, please mark it as accepted and upvote, it will help others"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1513313679, "post_id": 47806809, "comment_id": 82614373, "body": "Specifically, see the StackOverflow version of <a href=\"https://meta.stackexchange.com/a/5235\">thanks</a>."}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1513231301, "creation_date": 1513231301, "answer_id": 47806809, "question_id": 47803417, "link": "https://stackoverflow.com/questions/47803417/how-to-fix-run-time-error-3251-with-findfirst-in-access-vba/47806809#47806809", "title": "How to fix run-time error 3251 with .findfirst in Access VBA?", "body": "<p>Try this:</p>\n\n<pre><code>Set rs3 = db.OpenRecordset(\"IsolationPoints\", dbOpenDynaset)\n</code></pre>\n\n<p>Also</p>\n\n<pre><code>Set rs3 = db.OpenRecordset(\"select * from IsolationPoints\")\n</code></pre>\n\n<p>should work</p>\n"}], "owner": {"reputation": 29, "user_id": 8941231, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e9f195bc2b51a96672e796157090dd94?s=128&d=identicon&r=PG&f=1", "display_name": "J.Ryan", "link": "https://stackoverflow.com/users/8941231/j-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2946, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513313710, "creation_date": 1513206177, "last_edit_date": 1513313710, "question_id": 47803417, "link": "https://stackoverflow.com/questions/47803417/how-to-fix-run-time-error-3251-with-findfirst-in-access-vba", "title": "How to fix run-time error 3251 with .findfirst in Access VBA?", "body": "<p>I'm having trouble with <code>.findfirst</code>: </p>\n\n<blockquote>\n  <p>run-time error 3251 (operation is not supported for this type of\n  object).</p>\n</blockquote>\n\n<p>It happens on this line: </p>\n\n<pre><code>rs3.FindFirst \"[IsolationPoints] = '\" &amp; RWPSheetvalues(ii) &amp; \"'\"\n</code></pre>\n\n<p>The code in its entirety is as follows:</p>\n\n<pre><code>Private Sub ImportBOPData_Click()\n    'Declare and set variables for this database\n    Dim db As Database\n    Set db = CurrentDb()\n    'Declare and set variables for \"rwpT\" table\n    Dim rs As Recordset\n    Set rs = db.OpenRecordset(\"rwpT\")\n    'Declare and set variables for the Field \"File\" in \"rwpT\" table\n    Dim File As Field\n    Set File = rs.Fields(\"File\")\n    'Declare and set variables for the Field \"LastCompDate\" in \"rwpT\" table\n    Dim LastCompDate As Field\n    Set LastCompDate = rs.Fields(\"LastCompDate\")\n    Dim ExistingDate As String\n    'Declare and set variables for \"AIP&amp;BOP\" table\n    Dim rs2 As DAO.Recordset\n    Set rs2 = db.OpenRecordset(\"AIP&amp;BOP\")\n    Set File = rs.Fields(\"File\")\n    'Declare and set variables for \"AIP&amp;BOP\" table\n    Dim rs3 As DAO.Recordset\n    Set rs3 = db.OpenRecordset(\"IsolationPoints\")\n    'Declare and set variables for Excel Application, Workbook &amp; Worksheet\n    Dim xls     As Excel.Application\n    Dim wkb     As Excel.Workbook\n    Dim wks     As Excel.Worksheet\n    Set xls = New Excel.Application\n    'Declare and set values for cells, rows in Excell worksheets\n    Dim cellstring As String\n    Dim rownumber As Integer\n    Dim rowstring As String\n    rowstring = CStr(rownumber)\n    'Declare and set variables for looping through variables and row numbers\n    Dim i As Integer\n    Dim ii As Integer\n    'Declare variables for column values in RWP spreadsheets\n    Dim orgSheetCol(7) As String\n        orgSheetCol(0) = \"$A$\" 'Auto Isolation Point\n        orgSheetCol(1) = \"$D$\" 'Customer Minutes Lost\n        orgSheetCol(2) = \"$H$\" '% work plan fix\n        orgSheetCol(3) = \"$E$\" 'Customers in Incident Sustained\n        orgSheetCol(4) = \"$C3$\" 'Plan Title\n        orgSheetCol(5) = \"$B33$\" 'Years of Data\n        orgSheetCol(6) = \"$B37$\" 'Annual Improved CML\n    'Declare variables for cell values attained from RWP spreadsheets\n    Dim RWPSheetvalues(100) As String\n        RWPSheetvalues(0) = \"\" 'Autoisolation Point 1\n        RWPSheetvalues(1) = \"\" 'CML for Point 1\n        RWPSheetvalues(2) = \"\" '% Work Plan Fix\n        RWPSheetvalues(3) = \"\" 'CI For Point 1\n        RWPSheetvalues(4) = \"\" 'Autoisolation Point 2\n        RWPSheetvalues(5) = \"\" 'CML for Point 2\n        RWPSheetvalues(6) = \"\" '% Work Plan Fix\n        RWPSheetvalues(7) = \"\" 'CI For Point 2\n        RWPSheetvalues(8) = \"\" 'Autoisolation Point 3\n        RWPSheetvalues(9) = \"\" 'CML for Point 3\n        RWPSheetvalues(10) = \"\" '% Work Plan Fix\n        RWPSheetvalues(11) = \"\" 'CI For Point 3\n        RWPSheetvalues(12) = \"\" 'Autoisolation Point 4\n        RWPSheetvalues(13) = \"\" 'CML for Point 4\n        RWPSheetvalues(14) = \"\" '% Work Plan Fix\n        RWPSheetvalues(15) = \"\" 'CI For Point 4\n        RWPSheetvalues(16) = \"\" 'Autoisolation Point 5\n        RWPSheetvalues(17) = \"\" 'CML for Point 5\n        RWPSheetvalues(18) = \"\" '% Work Plan Fix\n        RWPSheetvalues(19) = \"\" 'CI For Point 5\n        RWPSheetvalues(20) = \"\" 'Autoisolation Point 6\n        RWPSheetvalues(21) = \"\" 'CML for Point 6\n        RWPSheetvalues(22) = \"\" '% Work Plan Fix\n        RWPSheetvalues(23) = \"\" 'CI For Point 6\n        RWPSheetvalues(24) = \"\" 'Autoisolation Point 7\n        RWPSheetvalues(25) = \"\" 'CML for Point 7\n        RWPSheetvalues(26) = \"\" '% Work Plan Fix\n        RWPSheetvalues(27) = \"\" 'CI For Point 7\n        RWPSheetvalues(28) = \"\" 'Autoisolation Point 8\n        RWPSheetvalues(29) = \"\" 'CML for Point 8\n        RWPSheetvalues(30) = \"\" '% Work Plan Fix\n        RWPSheetvalues(31) = \"\" 'CI For Point 8\n        RWPSheetvalues(32) = \"\" 'Autoisolation Point 9\n        RWPSheetvalues(33) = \"\" 'CML for Point 9\n        RWPSheetvalues(34) = \"\" '% Work Plan Fix\n        RWPSheetvalues(35) = \"\" 'CI For Point 9\n        RWPSheetvalues(36) = \"\" 'Autoisolation Point 10\n        RWPSheetvalues(37) = \"\" 'CML for Point 10\n        RWPSheetvalues(38) = \"\" '% Work Plan Fix\n        RWPSheetvalues(39) = \"\" 'CI For Point 10\n        RWPSheetvalues(40) = \"\" 'Autoisolation Point 11\n        RWPSheetvalues(41) = \"\" 'CML for Point 11\n        RWPSheetvalues(42) = \"\" '% Work Plan Fix\n        RWPSheetvalues(43) = \"\" 'CI For Point 11\n        RWPSheetvalues(44) = \"\" 'Autoisolation Point 12\n        RWPSheetvalues(45) = \"\" 'CML for Point 12\n        RWPSheetvalues(46) = \"\" '% Work Plan Fix\n        RWPSheetvalues(47) = \"\" 'CI For Point 12\n        RWPSheetvalues(48) = \"\" 'Autoisolation Point 13\n        RWPSheetvalues(49) = \"\" 'CML for Point 13\n        RWPSheetvalues(50) = \"\" '% Work Plan Fix\n        RWPSheetvalues(51) = \"\" 'CI For Point 13\n        RWPSheetvalues(52) = \"\" 'Autoisolation Point 14\n        RWPSheetvalues(53) = \"\" 'CML for Point 14\n        RWPSheetvalues(54) = \"\" '% Work Plan Fix\n        RWPSheetvalues(55) = \"\" 'CI For Point 14\n        RWPSheetvalues(56) = \"\" 'Autoisolation Point 15\n        RWPSheetvalues(57) = \"\" 'CML for Point 15\n        RWPSheetvalues(58) = \"\" '% Work Plan Fix\n        RWPSheetvalues(59) = \"\" 'CI For Point 15\n        RWPSheetvalues(60) = \"\" 'Autoisolation Point 16\n        RWPSheetvalues(61) = \"\" 'CML for Point 16\n        RWPSheetvalues(62) = \"\" '% Work Plan Fix\n        RWPSheetvalues(63) = \"\" 'CI For Point 16\n        RWPSheetvalues(64) = \"\" 'Autoisolation Point 17\n        RWPSheetvalues(65) = \"\" 'CML for Point 17\n        RWPSheetvalues(66) = \"\" '% Work Plan Fix\n        RWPSheetvalues(67) = \"\" 'CI For Point 17\n        RWPSheetvalues(68) = \"\" 'Autoisolation Point 18\n        RWPSheetvalues(69) = \"\" 'CML for Point 18\n        RWPSheetvalues(70) = \"\" '% Work Plan Fix\n        RWPSheetvalues(71) = \"\" 'CI For Point 18\n        RWPSheetvalues(72) = \"\" 'Autoisolation Point 19\n        RWPSheetvalues(73) = \"\" 'CML for Point 19\n        RWPSheetvalues(74) = \"\" '% Work Plan Fix\n        RWPSheetvalues(75) = \"\" 'CI For Point 19\n        RWPSheetvalues(76) = \"\" 'Autoisolation Point 20\n        RWPSheetvalues(77) = \"\" 'CML for Point 20\n        RWPSheetvalues(78) = \"\" '% Work Plan Fix\n        RWPSheetvalues(79) = \"\" 'CI For Point 20\n        RWPSheetvalues(80) = \"\" 'Autoisolation Point 21\n        RWPSheetvalues(81) = \"\" 'CML for Point 21\n        RWPSheetvalues(82) = \"\" '% Work Plan Fix\n        RWPSheetvalues(83) = \"\" 'CI For Point 21\n        RWPSheetvalues(84) = \"\" 'Autoisolation Point 22\n        RWPSheetvalues(85) = \"\" 'CML for Point 22\n        RWPSheetvalues(86) = \"\" '% Work Plan Fix\n        RWPSheetvalues(87) = \"\" 'CI For Point 22\n        RWPSheetvalues(88) = \"\" 'Autoisolation Point 23\n        RWPSheetvalues(89) = \"\" 'CML for Point 23\n        RWPSheetvalues(90) = \"\" '% Work Plan Fix\n        RWPSheetvalues(91) = \"\" 'CI For Point 23\n        RWPSheetvalues(92) = \"\" 'Autoisolation Point 24\n        RWPSheetvalues(93) = \"\" 'CML for Point 24\n        RWPSheetvalues(94) = \"\" '% Work Plan Fix\n        RWPSheetvalues(95) = \"\" 'CI For Point 25\n        RWPSheetvalues(96) = \"\" 'Plan Title\n        RWPSheetvalues(97) = \"\" 'File Location\n        RWPSheetvalues(98) = \"\" 'Years of Data\n        RWPSheetvalues(99) = \"\" 'Annual Improved CML\n\n    'Open up each of the Excel Spreadhseet given in the \"File\" field (hyperlink) of the \"rwpT\" table, get appropriate data, close Excel Spreadsheet and populate \"AIT&amp;BOP\" table with data if it isn't already there.\n    Do Until rs.EOF\n        'Open up Excel Workbook (Read Only), \"Benefit of Plan\" spreadsheet\n        Set wkb = xls.Workbooks.Open(File, ReadOnly:=True, UpdateLinks:=False)\n        Set wks = wkb.Worksheets(\"Benefit of Plan\")\n        'Get all of the auto-isolation point info\n        ii = 0\n        For rownumber = 7 To 30\n            rowstring = CStr(rownumber)\n            For i = 0 To 3\n                cellstring = orgSheetCol(i) &amp; rowstring\n                RWPSheetvalues(ii) = wks.Range(cellstring).Value\n                If RWPSheetvalues(ii) = \"\" Then\n                    RWPSheetvalues(ii) = \"0\"\n                ElseIf RWPSheetvalues(ii) = \" \" Then\n                    RWPSheetvalues(ii) = \"0\"\n                End If\n                ii = ii + 1\n            Next i\n        Next rownumber\n        RWPSheetvalues(96) = wks.Range(\"C3\").Value\n        RWPSheetvalues(97) = File\n        RWPSheetvalues(98) = wks.Range(\"B33\").Value\n        RWPSheetvalues(99) = wks.Range(\"K31\").Value\n        'Close workbook without saving\n        wkb.Close False\n        'Insert all isolation points, without duplication, into IsolatPoints Table\n        ii = 0\n        Do Until ii = 96\n            'check IsolationPoints table to see if isolation point is already there\n            tablecheck = DCount(\"IsolationPoints\", \"IsolationPoints\", \"IsolationPoints = '\" &amp; RWPSheetvalues(ii) &amp; \"'\")\n            'If Isolation Point doesn't exist in IsolationPoints table, insert it\n            If (tablecheck = 0 And RWPSheetvalues(ii) &lt;&gt; \"0\") Then\n                rs3.AddNew\n                rs3!IsolationPoints.Value = RWPSheetvalues(ii)\n                rs3!FirstDate.Value = LastCompDate\n                rs3.Update\n            End If\n            'Need to find way to determine if isolation point exists in table then get date for it, then compare to new date &amp; replace with oldest - if necessary\n            If (tablecheck = 1 And RWPSheetvalues(ii) &lt;&gt; \"0\") Then\n                rs3.FindFirst \"[IsolationPoints] = '\" &amp; RWPSheetvalues(ii) &amp; \"'\"\n                ExistingDate = rs3.Fields(\"FirstDate\")\n                If CDate(ExistingDate) &gt; CDate(LastCompDate) Then\n                    rs3!FirstDate.Value = LastCompDate\n                    rs3.Update\n                End If\n            End If\n            ii = ii + 4\n        Loop\n\n        'check AIP &amp; BOP table to see if plan (checks for recurrence of file path) is already there\n        tablecheck = DCount(\"FileLocation\", \"AIP&amp;BOP\", \"FileLocation = '\" &amp; RWPSheetvalues(97) &amp; \"'\")\n        'If plan doesn't exist in AIP&amp;BOP table, insert it\n        If tablecheck = 0 Then\n            rs2.AddNew\n            rs2!PlanTitle.Value = RWPSheetvalues(96)\n            rs2!FileLocation.Value = RWPSheetvalues(97)\n            rs2!YearsofData.Value = RWPSheetvalues(98)\n            rs2!AnnualImprovedCML.Value = RWPSheetvalues(99)\n            rs2!AIP1.Value = RWPSheetvalues(0)\n            rs2!AIP1CML.Value = RWPSheetvalues(1)\n            rs2!AIP1BOP.Value = RWPSheetvalues(2)\n            rs2!AIP1CI.Value = RWPSheetvalues(3)\n            rs2!AIP2.Value = RWPSheetvalues(4)\n            rs2!AIP2CML.Value = RWPSheetvalues(5)\n            rs2!AIP2BOP.Value = RWPSheetvalues(6)\n            rs2!AIP2CI.Value = RWPSheetvalues(7)\n            rs2!AIP3.Value = RWPSheetvalues(8)\n            rs2!AIP3CML.Value = RWPSheetvalues(9)\n            rs2!AIP3BOP.Value = RWPSheetvalues(10)\n            rs2!AIP3CI.Value = RWPSheetvalues(11)\n            rs2!AIP4.Value = RWPSheetvalues(12)\n            rs2!AIP4CML.Value = RWPSheetvalues(13)\n            rs2!AIP4BOP.Value = RWPSheetvalues(14)\n            rs2!AIP4CI.Value = RWPSheetvalues(15)\n            rs2!AIP5.Value = RWPSheetvalues(16)\n            rs2!AIP5CML.Value = RWPSheetvalues(17)\n            rs2!AIP5BOP.Value = RWPSheetvalues(18)\n            rs2!AIP5CI.Value = RWPSheetvalues(19)\n            rs2!AIP6.Value = RWPSheetvalues(20)\n            rs2!AIP6CML.Value = RWPSheetvalues(21)\n            rs2!AIP6BOP.Value = RWPSheetvalues(22)\n            rs2!AIP6CI.Value = RWPSheetvalues(23)\n            rs2!AIP7.Value = RWPSheetvalues(24)\n            rs2!AIP7CML.Value = RWPSheetvalues(25)\n            rs2!AIP7BOP.Value = RWPSheetvalues(26)\n            rs2!AIP7CI.Value = RWPSheetvalues(27)\n            rs2!AIP8.Value = RWPSheetvalues(28)\n            rs2!AIP9CML.Value = RWPSheetvalues(29)\n            rs2!AIP8BOP.Value = RWPSheetvalues(30)\n            rs2!AIP8CI.Value = RWPSheetvalues(31)\n            rs2!AIP9.Value = RWPSheetvalues(32)\n            rs2!AIP9CML.Value = RWPSheetvalues(33)\n            rs2!AIP9BOP.Value = RWPSheetvalues(34)\n            rs2!AIP9CI.Value = RWPSheetvalues(35)\n            rs2!AIP10.Value = RWPSheetvalues(36)\n            rs2!AIP10CML.Value = RWPSheetvalues(37)\n            rs2!AIP10BOP.Value = RWPSheetvalues(38)\n            rs2!AIP10CI.Value = RWPSheetvalues(39)\n            rs2!AIP11.Value = RWPSheetvalues(40)\n            rs2!AIP11CML.Value = RWPSheetvalues(41)\n            rs2!AIP11BOP.Value = RWPSheetvalues(42)\n            rs2!AIP11CI.Value = RWPSheetvalues(43)\n            rs2!AIP12.Value = RWPSheetvalues(44)\n            rs2!AIP12CML.Value = RWPSheetvalues(45)\n            rs2!AIP12BOP.Value = RWPSheetvalues(46)\n            rs2!AIP12CI.Value = RWPSheetvalues(47)\n            rs2!AIP13.Value = RWPSheetvalues(48)\n            rs2!AIP13CML.Value = RWPSheetvalues(49)\n            rs2!AIP13BOP.Value = RWPSheetvalues(50)\n            rs2!AIP13CI.Value = RWPSheetvalues(51)\n            rs2!AIP14.Value = RWPSheetvalues(52)\n            rs2!AIP14CML.Value = RWPSheetvalues(53)\n            rs2!AIP14BOP.Value = RWPSheetvalues(54)\n            rs2!AIP14CI.Value = RWPSheetvalues(55)\n            rs2!AIP15.Value = RWPSheetvalues(56)\n            rs2!AIP15CML.Value = RWPSheetvalues(57)\n            rs2!AIP15BOP.Value = RWPSheetvalues(58)\n            rs2!AIP15CI.Value = RWPSheetvalues(59)\n            rs2!AIP16.Value = RWPSheetvalues(60)\n            rs2!AIP16CML.Value = RWPSheetvalues(61)\n            rs2!AIP16BOP.Value = RWPSheetvalues(62)\n            rs2!AIP16CI.Value = RWPSheetvalues(63)\n            rs2!AIP17.Value = RWPSheetvalues(64)\n            rs2!AIP17CML.Value = RWPSheetvalues(65)\n            rs2!AIP17BOP.Value = RWPSheetvalues(66)\n            rs2!AIP17CI.Value = RWPSheetvalues(67)\n            rs2!AIP18.Value = RWPSheetvalues(68)\n            rs2!AIP18CML.Value = RWPSheetvalues(69)\n            rs2!AIP18BOP.Value = RWPSheetvalues(70)\n            rs2!AIP18CI.Value = RWPSheetvalues(71)\n            rs2!AIP19.Value = RWPSheetvalues(72)\n            rs2!AIP9CML.Value = RWPSheetvalues(73)\n            rs2!AIP19BOP.Value = RWPSheetvalues(74)\n            rs2!AIP19CI.Value = RWPSheetvalues(75)\n            rs2!AIP20.Value = RWPSheetvalues(76)\n            rs2!AIP20CML.Value = RWPSheetvalues(77)\n            rs2!AIP20BOP.Value = RWPSheetvalues(78)\n            rs2!AIP20CI.Value = RWPSheetvalues(79)\n            rs2!AIP21.Value = RWPSheetvalues(80)\n            rs2!AIP21CML.Value = RWPSheetvalues(81)\n            rs2!AIP21BOP.Value = RWPSheetvalues(82)\n            rs2!AIP21CI.Value = RWPSheetvalues(83)\n            rs2!AIP22.Value = RWPSheetvalues(84)\n            rs2!AIP22CML.Value = RWPSheetvalues(85)\n            rs2!AIP22BOP.Value = RWPSheetvalues(86)\n            rs2!AIP22CI.Value = RWPSheetvalues(87)\n            rs2!AIP23.Value = RWPSheetvalues(88)\n            rs2!AIP23CML.Value = RWPSheetvalues(89)\n            rs2!AIP23BOP.Value = RWPSheetvalues(90)\n            rs2!AIP23CI.Value = RWPSheetvalues(91)\n            rs2!AIP24.Value = RWPSheetvalues(92)\n            rs2!AIP24CML.Value = RWPSheetvalues(93)\n            rs2!AIP24BOP.Value = RWPSheetvalues(94)\n            rs2!AIP24CI.Value = RWPSheetvalues(95)\n            rs2.Update\n        End If\n        rs.MoveNext\n\n    Loop\n    rs.Close\n    rs2.Close\n    rs3.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513205385, "post_id": 47803194, "comment_id": 82567988, "body": "Is <code>wsTestScript</code> a Worksheet object? It may be protected and hence fail on  modifying B1. Try Protect worksheets from User only with something like <code>wsTestScript.Protect UserInterfaceOnly:=True</code>."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1513205439, "post_id": 47803194, "comment_id": 82568021, "body": "I guess that <code>wsTestScript</code> is a worksheet, but it is not being <b>Set</b> anywhere in the code."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1513220563, "post_id": 47803194, "comment_id": 82572028, "body": "<code>wsTestScript</code> could be a <code>CodeName</code>."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513220818, "post_id": 47803194, "comment_id": 82572077, "body": "I suspect that you are mixing up the concepts of protecting a workbook and protecting a worksheet (as does @PatricK in his comment). The code will run when you have manually unprotected the worksheet, and it will fail when your code doesn&#39;t do anything about worksheet protection, instead addressing Workbook protection. Read about workbook protection here: <a href=\"https://support.office.com/en-us/article/Protect-a-workbook-7E365A4D-3E89-4616-84CA-1931257C1517\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 7601379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1205724309476825/picture?type=large", "display_name": "mjcallen", "link": "https://stackoverflow.com/users/7601379/mjcallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513205732, "creation_date": 1513204837, "last_edit_date": 1513205732, "question_id": 47803194, "link": "https://stackoverflow.com/questions/47803194/code-working-when-i-step-through-but-not-when-the-macro-is-run", "title": "Code working when I step through but not when the macro is run", "body": "<pre><code>Sub ShowTestScript()\n\nActiveWorkbook.Unprotect\nCCBEdit.Hide\n\nwsTestScript.Visible = True\nwsTestScript.Activate\nwsTestScript.Range(\"A4:B25\").Locked = False\nwsTestScript.Range(\"B1\").Value = CCBEdit.cboCtrlNum.Value\n\nQuery_Run \"select stepno, steptext from testscripts where control = '\" &amp; CCBEdit.cboCtrlNum.Value &amp; \"'\"\nQuery_Paste wsTestScript, \"A4\"\nFormatRows wsTestScript.Range(\"A4\", \"B25\")\n\nActiveWorkbook.Protect\nEnd Sub\n</code></pre>\n\n<p>My issue is with unlocking the cells. When I step through, the cells are unlocked on wsTestScript, but when I run the macro, they are locked.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1513203901, "post_id": 47802981, "comment_id": 82567448, "body": "&quot;Weather Delay&quot; is the literal contents of cell Bi? what do you expect to happen with your &quot;Then error&quot;? do you expect a message box to warn the user? highlight the cells? add &quot;ERROR&quot; on Column C? What have you tried?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1513204370, "post_id": 47802981, "comment_id": 82567605, "body": "If you are looking for a VBA solution then start watching this series:<a href=\"https://www.youtube.com//watch?v=KHO5NIcZAc4&amp;index=1&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 1 - Getting Started in the VB Editor</a>.  It sounds like you want to setup data validation rules.  Here is a list of 44 videos from ExcelIsFun on data validation: <a href=\"https://www.youtube.com/watch?v=fyPA9NK1eX0&amp;list=PL0EB55D99E9CF7E13\" rel=\"nofollow noreferrer\">ExcelIsFun</a>"}], "owner": {"reputation": 1, "user_id": 9091244, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VtgYxkl_e0A/AAAAAAAAAAI/AAAAAAAAAO4/ET7dFqCsc80/photo.jpg?sz=128", "display_name": "Rose Cianni", "link": "https://stackoverflow.com/users/9091244/rose-cianni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513203698, "creation_date": 1513203698, "question_id": 47802981, "link": "https://stackoverflow.com/questions/47802981/excel-limit-cell-input-based-on-other-cells-selection-and-work-down-column", "title": "Excel Limit Cell Input Based On Other Cell&#39;s Selection and Work Down Column", "body": "<p>Very new to VBA so unsure where to start. Most questions only refer to individual cells, but I need this to work for all cells in a column and only have them based off the next column's cell in that row.</p>\n\n<p>Column B is a Data List, so based on the selection of a cell in Column B I want the following limitations on the same row's cell in column A:</p>\n\n<p>If B# = Weather Delay Then Error IF A# > 4</p>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513208308, "post_id": 47802921, "comment_id": 82568943, "body": "it is 3rd and 4th. also edited my question"}], "answers": [{"comments": [{"owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "edited": false, "score": 0, "creation_date": 1513204767, "post_id": 47803035, "comment_id": 82567758, "body": "thanks for your response, actually i also want to check for <code>55</code> instead of just checking for <code>77</code>. how the formula is going to look for that one"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "edited": false, "score": 0, "creation_date": 1513204988, "post_id": 47803035, "comment_id": 82567854, "body": "Just those three?  You should inform the readers that you have other options."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "edited": false, "score": 0, "creation_date": 1513208322, "post_id": 47803035, "comment_id": 82568949, "body": "@meallhour this formula with its table is easier to upkeep if anything changes than hard coding the values in a nested if."}, {"owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "edited": false, "score": 0, "creation_date": 1513208583, "post_id": 47803035, "comment_id": 82569022, "body": "not allowed to change the excel sheet. nested if seems correct solution"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1513208774, "last_edit_date": 1513208774, "creation_date": 1513203970, "answer_id": 47803035, "question_id": 47802921, "link": "https://stackoverflow.com/questions/47802921/creating-a-new-column-in-excel-based-upon-an-existing-column/47803035#47803035", "title": "creating a new column in excel based upon an existing column", "body": "<p>Use this formula:</p>\n\n<pre><code>=INDEX({\"ABC\",\"DCE\",\"ZBA\",\"XYZ\"},MATCH(MID(A2,3,2),{\"77\",\"65\",\"88\",\"99\"},0))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Ykdw8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ykdw8.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "edited": false, "score": 0, "creation_date": 1513207455, "post_id": 47803518, "comment_id": 82568652, "body": "Hi, the hostname can have a different size for every entry. I have edited my question. can you please provide the updated formula. thanks"}, {"owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "edited": false, "score": 0, "creation_date": 1513207761, "post_id": 47803518, "comment_id": 82568775, "body": "I need to compare 4th and 5th values of the hostname string"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "edited": false, "score": 0, "creation_date": 1513207926, "post_id": 47803518, "comment_id": 82568831, "body": "@meallhour then change all the <code>RIGHT()</code> to the appropriate <code>MID()</code> function."}, {"owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "edited": false, "score": 0, "creation_date": 1513208237, "post_id": 47803518, "comment_id": 82568917, "body": "i have tried to change it to <code>=IF(MID(A1,2,2)=&quot;77&quot;,&quot;ABC&quot;,&quot;Error&quot;)</code> but not working"}, {"owner": {"reputation": 135, "user_id": 8296610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c0da71fcf6312d1e54b7268eb9cf1b?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Pratt", "link": "https://stackoverflow.com/users/8296610/brandon-pratt"}, "edited": false, "score": 0, "creation_date": 1513284540, "post_id": 47803518, "comment_id": 82606126, "body": "I went ahead and changed it to MID but I like Scott&#39;s solution better!"}], "tags": [], "owner": {"reputation": 135, "user_id": 8296610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c0da71fcf6312d1e54b7268eb9cf1b?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Pratt", "link": "https://stackoverflow.com/users/8296610/brandon-pratt"}, "is_accepted": false, "score": 0, "last_activity_date": 1513284507, "last_edit_date": 1513284507, "creation_date": 1513206730, "answer_id": 47803518, "question_id": 47802921, "link": "https://stackoverflow.com/questions/47802921/creating-a-new-column-in-excel-based-upon-an-existing-column/47803518#47803518", "title": "creating a new column in excel based upon an existing column", "body": "<p>Here is a simple formula:</p>\n\n<pre><code>=IF(MID(A2,3,2)=\"77\",\"ABC\",IF(MID(A2,3,2)=\"65\",\"DCE\",IF(MID(A2,3,2)=\"88\",\"ZBA\",IF(MID(A2,3,2)=\"99\",\"XYZ\",\"Error\"))))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1513231267, "creation_date": 1513231267, "answer_id": 47806798, "question_id": 47802921, "link": "https://stackoverflow.com/questions/47802921/creating-a-new-column-in-excel-based-upon-an-existing-column/47806798#47806798", "title": "creating a new column in excel based upon an existing column", "body": "<p>Late in the day, another option is to use LOOKUP construct like below.</p>\n\n<p><code>=LOOKUP(2,SEARCH(MID(A2,3,2),{65,77,88,99},1),{\"DCE\",\"ABC\",\"ZBA\",\"XYZ\"})</code></p>\n"}], "owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 1, "accepted_answer_id": 47803035, "answer_count": 3, "score": 0, "last_activity_date": 1513284507, "creation_date": 1513203404, "last_edit_date": 1531161705, "question_id": 47802921, "link": "https://stackoverflow.com/questions/47802921/creating-a-new-column-in-excel-based-upon-an-existing-column", "title": "creating a new column in excel based upon an existing column", "body": "<p>I have a column in excel with the following values</p>\n\n<pre><code>HostName\n-----\nsa77.com\nca77cded.com\nsa65yacd.com\nca65zededs.com\nsa88y.com\nsa99ujk8.com\n</code></pre>\n\n<p>Now based upon that I want to create a new column <code>TagName</code> such that if first column has <code>77</code> then <code>TagName</code> should be <code>ABC</code> and if first column has <code>65</code> then <code>TagName</code> should be <code>DCE</code> if first column has <code>88</code> then <code>TagName</code> should be <code>ZBA</code> if first column has <code>99</code> then <code>TagName</code> should be <code>XYZ</code> </p>\n\n<p>The hostname can have a different size for every entry. I need to compare 3rd and 4th values of the hostname string</p>\n\n<pre><code>TagName\n-----\nABC\nABC\nDCE\nDCE\nZBA\nXYZ\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer", "automation"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513204358, "post_id": 47802551, "comment_id": 82567597, "body": "Where are you stuck? Did you use Firefox to inspect items? Some elements can change class in run-time."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1513204406, "post_id": 47802551, "comment_id": 82567618, "body": "Your code looks good, but it doesn&#39;t work because the website is full of AngularJS and some validation is done on user action. If you observe the HTML document while you type a value in your input box, you will see a lot of properties updating (not only on the input but also on the form). One of them must be controlling the form from executing directly from client side (to avoid useless calls on server): if the input isn&#39;t valid, the client blocks your execution without even going to server. Your problem is that just setting the value of the box doesn&#39;t make the form valid for that website."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1513204502, "post_id": 47802551, "comment_id": 82567645, "body": "P.s. make your question clearer (I had to run your code to understand your issue). P.p.s. the solution lies on observing the HTML on manual actions and find what is that property of the form making it valid to go to the server (then your code should work)."}, {"owner": {"reputation": 1, "user_id": 9096023, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155943677911944/picture?type=large", "display_name": "Connor R.", "link": "https://stackoverflow.com/users/9096023/connor-r"}, "edited": false, "score": 0, "creation_date": 1513264523, "post_id": 47802551, "comment_id": 82594771, "body": "Thanks Matteo. I was able to find a work around. Do you have any suggestions to help automate this if I come across it again in the future?"}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1513281059, "creation_date": 1513281059, "answer_id": 47821035, "question_id": 47802551, "link": "https://stackoverflow.com/questions/47802551/internet-explorer-automation-specify-object-angularjs-generated-html/47821035#47821035", "title": "Internet Explorer Automation - Specify Object (AngularJS generated html)", "body": "<p>found this info <a href=\"https://stackoverflow.com/questions/33667426/entering-data-using-vba-in-to-a-html5-site\">Entering data using VBA in to a HTML5 site</a></p>\n\n<p>this code fills in the field and clicks on the button</p>\n\n<p>press F5 to continue from <code>stop</code></p>\n\n<pre><code>Option Explicit\n\n' found info here https://stackoverflow.com/questions/33667426/entering-data-using-vba-in-to-a-html5-site\n\nSub BrokerCheckSlim()\n\n    Dim objIE As InternetExplorer                                           ' object variable representing the IE browser\n    Set objIE = New InternetExplorer                                        ' instantiates IE object\n\n    objIE.Visible = True                                                    ' make browser visible\n    objIE.navigate \"https://brokercheck.finra.org/\"\n\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop     ' service other events while web page loads\n\n    objIE.document.getElementsByClassName(\"ng-pristine ng-untouched ng-valid flex-auto ng-empty\").Item(0).Focus\n    objIE.document.getElementsByClassName(\"ng-pristine ng-untouched ng-valid flex-auto ng-empty\").Item(0).innertext = \"smith\"\n\n    With objIE.document.getElementsByClassName(\"md-raised md-primary md-hue-2 md-button md-ink-ripple\").Item(0)  ' using the \"with\" statement to refer to objects\n        .Focus\n        .Click\n    End With\n\n'   objIE.document.getElementById(\"firm-input\").Value = 1\n\n'   Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    Stop                ' press F5 of F8 to continue\n\n    objIE.Quit\n    Set objIE = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1513362563, "creation_date": 1513362563, "answer_id": 47837995, "question_id": 47802551, "link": "https://stackoverflow.com/questions/47802551/internet-explorer-automation-specify-object-angularjs-generated-html/47837995#47837995", "title": "Internet Explorer Automation - Specify Object (AngularJS generated html)", "body": "<p>As compound class names are not always good landmarks to pursue, I tried to make the scraper slightly differently. The below script will let you enter that name in the first search-box and press the click button. Give it a go:</p>\n\n<pre><code>Sub BrokerCheckSlim()\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim post As Object, elem As Object\n\n    With IE\n        .Visible = True\n        .navigate \"https://brokercheck.finra.org/\"\n        Do Until .readyState = READYSTATE_COMPLETE: Loop\n        Set html = .document\n    End With\n\n    For Each post In html.getElementsByTagName(\"input\")\n        If InStr(post.placeholder, \"Name or CRD#\") &gt; 0 Then\n            post.Focus\n            post.innerText = \"martin\": Exit For\n        End If\n    Next post\n\n    For Each elem In html.getElementsByTagName(\"button\")\n        If InStr(elem.Type, \"submit\") &gt; 0 Then elem.Click\n    Next elem\n    IE.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9096023, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155943677911944/picture?type=large", "display_name": "Connor R.", "link": "https://stackoverflow.com/users/9096023/connor-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1513362563, "creation_date": 1513201357, "last_edit_date": 1513281753, "question_id": 47802551, "link": "https://stackoverflow.com/questions/47802551/internet-explorer-automation-specify-object-angularjs-generated-html", "title": "Internet Explorer Automation - Specify Object (AngularJS generated html)", "body": "<p>I am on this site.</p>\n\n<p><a href=\"https://brokercheck.finra.org/\" rel=\"nofollow noreferrer\">https://brokercheck.finra.org/</a></p>\n\n<p>I am trying to use VBA to place a number into the first box (\"Name or CRD#\") and press search. I cannot figure out how go the information in the box.</p>\n\n<p>Here is the HTML code (sorry if there is not enough) which is why I provided the link.</p>\n\n<pre><code>&gt; div layout-gt-xs=\"row\" layout-xs=\"column\" layout-align-xs=\"space-between center\" class=\"layout-xs-column layout-gt-xs-row layout-align-xs-space-between-center\"\n\n\n&gt;input type=\"text\" ng-model=\"searchCtrl.name\" placeholder=\"Name or CRD#\" flex=\"auto\" class=\"ng-pristine ng-valid flex-auto ng-empty ng-touched\" aria-invalid=\"false\" style=\"\"\n</code></pre>\n\n<p>My code so far is this:</p>\n\n<pre><code>Sub BrokerCheckSlim()\n\nDim objIE As InternetExplorer 'special object variable representing the IE browser\nSet objIE = New InternetExplorer 'Creates IE object\nobjIE.Visible = True 'Can you see the browser?\nobjIE.navigate \"https://brokercheck.finra.org/\" 'Open Website\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop 'Keeps CPU from crashing\n\nobjIE.document.getElementsByClassName(\"ng-pristine ng-valid flex-auto ng-empty ng-touched\").Item(0).Value = 1\nobjIE.document.getElementById(\"firm-input\").Value = 1\nobjIE.document.getElementsByClassName(\"md-raised md-primary md-hue-2 md-button md-ink-ripple\").Item(0).Click\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciate.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "path", "libreoffice-calc"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513203048, "post_id": 47802457, "comment_id": 82567126, "body": "Where is the code for <code>ArrayoutofString</code> ?"}, {"owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513203547, "post_id": 47802457, "comment_id": 82567306, "body": "I have added the code for that function to the original post"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513205634, "post_id": 47802457, "comment_id": 82568091, "body": "If you debug then is there content in <code>SepList()</code> ?  What&#39;s the value of <code>i</code> when it errors?"}, {"owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513205931, "post_id": 47802457, "comment_id": 82568180, "body": "After investigating a little further, it seems like it only generates the error during file load.  Once the file has loaded, I can use the function as above with no issues.  I&#39;m wondering if it has something to do with the timing."}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "edited": false, "score": 0, "creation_date": 1513205476, "post_id": 47803181, "comment_id": 82568037, "body": "I had not come across that.  However, that gives me the entire path including the file name.  I just want the path up to the containing directory."}, {"owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "edited": false, "score": 0, "creation_date": 1513208983, "post_id": 47803181, "comment_id": 82569141, "body": "that works perfectly!  Thank you for such a thorough answer.  Not only did I solve this issue, I now understand why it wasn&#39;t working."}], "tags": [], "owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1513208061, "last_edit_date": 1513208061, "creation_date": 1513204774, "answer_id": 47803181, "question_id": 47802457, "link": "https://stackoverflow.com/questions/47802457/getting-an-error-when-getting-the-path-using-macro/47803181#47803181", "title": "Getting an error when getting the path using macro", "body": "<p>There is a better way.</p>\n\n<pre><code>=LEFT(CELL(\"filename\");FIND(\"#$\";CELL(\"filename\"))-1)\n</code></pre>\n\n<p>Source: <a href=\"https://ask.libreoffice.org/en/question/67271/how-to-automatically-display-file-path-in-a-cell/\" rel=\"nofollow noreferrer\">https://ask.libreoffice.org/en/question/67271/how-to-automatically-display-file-path-in-a-cell/</a>\nDocumentation on CELL function: <a href=\"https://help.libreoffice.org/Calc/Information_Functions#CELL\" rel=\"nofollow noreferrer\">https://help.libreoffice.org/Calc/Information_Functions#CELL</a></p>\n\n<p>Alternatively, to do it with a macro, assign the following <code>WritePath</code> subroutine to run on the <code>View created</code> event.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>function GetPath() as string\n    On Error Goto ErrorHandler\n    GlobalScope.BasicLibraries.loadLibrary(\"Tools\")\n    GetPath = Tools.Strings.DirectoryNameoutofPath(ThisComponent.url, \"/\")\n    ErrorHandler:\nend function\n\nSub WritePath\n    oSheet = ThisComponent.getSheets().getByIndex(0)\n    oCell = oSheet.getCellRangeByName(\"A1\")\n    oCell.setString(GetPath())\nEnd Sub\n</code></pre>\n\n<p>For an explanation of the problem and how the macro solution works, see <a href=\"https://stackoverflow.com/a/39254907/5100564\">https://stackoverflow.com/a/39254907/5100564</a>.</p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>The following expression gives the path without the filename.  For it to work, regular expressions must be enabled in formulas under <em>Tools -> Options -> LibreOffice Calc -> Calculate</em>.</p>\n\n<pre><code>=MID(CELL(\"filename\");2;SEARCH(\"/[^/]*$\";CELL(\"filename\"))-1)\n</code></pre>\n\n<p><a href=\"https://wiki.openoffice.org/wiki/Documentation/How_Tos/Regular_Expressions_in_Writer\" rel=\"nofollow noreferrer\">https://wiki.openoffice.org/wiki/Documentation/How_Tos/Regular_Expressions_in_Writer</a></p>\n"}], "owner": {"reputation": 271, "user_id": 2298326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fb87dc79e8d1115bf96e8688c962c52e?s=128&d=identicon&r=PG", "display_name": "Lee Blake", "link": "https://stackoverflow.com/users/2298326/lee-blake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 47803181, "answer_count": 1, "score": 2, "last_activity_date": 1513208061, "creation_date": 1513200866, "last_edit_date": 1513203527, "question_id": 47802457, "link": "https://stackoverflow.com/questions/47802457/getting-an-error-when-getting-the-path-using-macro", "title": "Getting an error when getting the path using macro", "body": "<p>After searching online for a solution to getting the current path of the file into a LibreOffice Calc cell, I came across the following macro code:</p>\n\n<pre><code>function GetPath() as string\n  GlobalScope.BasicLibraries.loadLibrary(\"Tools\")\n  GetPath = Tools.Strings.DirectoryNameoutofPath(ThisComponent.url, \"/\")\nend function\n</code></pre>\n\n<p>This works until I close the file, then re-open it.  When I re-open it, I get the following error message:</p>\n\n<pre><code>Inadmissible value or data type.\nIndex out of defined range.\n</code></pre>\n\n<p>This error is generated on the last line of the following function within the Tools Macro library.</p>\n\n<pre><code>Function FileNameoutofPath(ByVal Path as String, Optional Separator as String) as String\nDim i as Integer\nDim SepList() as String\n    If IsMissing(Separator) Then\n        Path = ConvertFromUrl(Path)\n        Separator = GetPathSeparator()      \n    End If\n    SepList() = ArrayoutofString(Path, Separator,i)\n    FileNameoutofPath = SepList(i)\nEnd Function\n</code></pre>\n\n<p>The code for that function is...</p>\n\n<pre><code>Function ArrayOutOfString(BigString, Separator as String, Optional MaxIndex as Integer)\n    Dim LocList() as String\n    LocList=Split(BigString,Separator)\n\n    If not isMissing(MaxIndex) then maxIndex=ubound(LocList())  \n\n    ArrayOutOfString=LocList\nEnd Function\n</code></pre>\n\n<p>I'm not sure why this would generate an error on file load, but continue to work thereafter.</p>\n\n<p>Any idea?  Thanks.</p>\n"}, {"tags": ["vba", "excel", "subscript", "indexoutofrangeexception"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513199255, "post_id": 47802080, "comment_id": 82565520, "body": "On which line do you get the error?"}, {"owner": {"reputation": 1, "user_id": 9095856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a390976a831f9f619eb6735a9af9ad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ballycasey061", "link": "https://stackoverflow.com/users/9095856/ballycasey061"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513199392, "post_id": 47802080, "comment_id": 82565594, "body": "@ScottCraner I get the error on this line:                                         sInputSheet = Worksheets(&quot;I.Import&quot;).Range(sTable).Cells(cRow, 2)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1513199974, "post_id": 47802080, "comment_id": 82565828, "body": "Do you have a worksheet named &quot;I.Import&quot; in the currently active workbook?  (Does it crash when <code>cRow</code> is 1, or not until <code>cRow</code> is 2?  If it works for 1 but not 2, then the error is probably in <code>ImportDataSpreadsheet</code> which is probably changing the active workbook.)"}, {"owner": {"reputation": 1, "user_id": 9095856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a390976a831f9f619eb6735a9af9ad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ballycasey061", "link": "https://stackoverflow.com/users/9095856/ballycasey061"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513200819, "post_id": 47802080, "comment_id": 82566221, "body": "thank you for pointing out my silly mistake @YowE3K - I had I. Import instead of I.Import (space)"}, {"owner": {"reputation": 1, "user_id": 9095856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a390976a831f9f619eb6735a9af9ad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ballycasey061", "link": "https://stackoverflow.com/users/9095856/ballycasey061"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513203303, "post_id": 47802080, "comment_id": 82567209, "body": "@YowE3K I have encountered another issue that I am hoping you can help with:"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513203682, "post_id": 47802080, "comment_id": 82567365, "body": "If you have a new issue, it would be best to create a new question."}, {"owner": {"reputation": 1, "user_id": 9095856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a390976a831f9f619eb6735a9af9ad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ballycasey061", "link": "https://stackoverflow.com/users/9095856/ballycasey061"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513204500, "post_id": 47802080, "comment_id": 82567644, "body": "I have edited my question @YowE3K because I believe it is the same issue as you mentioned in your previous answer about the |Active Worksheet changing. Also it is not picking up my targetworksheet. I appreciate your help."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1513206622, "creation_date": 1513206622, "answer_id": 47803501, "question_id": 47802080, "link": "https://stackoverflow.com/questions/47802080/subscript-out-of-range-error-vba-error/47803501#47803501", "title": "Subscript out of range error - VBA error", "body": "<p>The problem is caused because, when you <code>Open</code> a new workbook, you are changing what is the <code>ActiveWorkbook</code> and your code is by default using <code>ActiveWorkbook</code> because you aren't qualifying your <code>Worksheets</code> collections to say which workbook they really refer to.</p>\n\n<p>The easiest way to fix this is to just create a reference to which workbook was active when you started the code:</p>\n\n<pre><code>'Define source(s) and target(t) sheets\nsTable = \"rng_SourceData\"\n\nDim wbTable As Workbook\nSet wbTable = ActiveWorkbook\n\n'Shorten some code by using a With block\nWith wbTable.Worksheets(\"I.Import\").Range(sTable)\n    'loop through source table to copy and paste requred data\n    sRow = .Rows.Count\n    For cRow = 1 To sRow\n\n        sFileName = .Cells(cRow, 1)\n        sInputSheet = .Cells(cRow, 2)\n        sRange = .Cells(cRow, 3)\n        tFileName = .Cells(cRow, 4)\n        tRange = .Cells(cRow, 5)\n        tSheet = .Cells(cRow, 6)\n\n        'Include all ranges in the input table\n        ImportDataSpreadsheet sFileName, sInputSheet, sRange, tSheet, tRange\n\n    Next cRow\nEnd With\n</code></pre>\n\n<p>Because the code is now always referring to <code>wbTable</code>, which has been set prior to any other workbooks being opened, the code will refer to the correct sheet.</p>\n\n<hr>\n\n<p>Note:  Theoretically, we don't really need <code>wbTable</code>, we could just use a</p>\n\n<pre><code>With ActiveWorkbook.Worksheets(\"I.Import\").Range(sTable)\n</code></pre>\n\n<p>block, but my personal preference it to set that temporary object instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 9095856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a390976a831f9f619eb6735a9af9ad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ballycasey061", "link": "https://stackoverflow.com/users/9095856/ballycasey061"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7444, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574953245, "creation_date": 1513199064, "last_edit_date": 1513204867, "question_id": 47802080, "link": "https://stackoverflow.com/questions/47802080/subscript-out-of-range-error-vba-error", "title": "Subscript out of range error - VBA error", "body": "<p>I keep getting subscript out of range for the following code, I'm new to VBA so would greatly appreciate your help.</p>\n\n<p>I'm trying to reference a table that contains various source workbooks and copy the data from here to \"target\" workbooks also contained in the sTable range.</p>\n\n<p>Thanks,\nRonan</p>\n\n<pre><code>Sub Import()\n    Dim sTable As String                              ' Source table\n    Dim sTarget As String                             ' Target range for output\n    Dim sHeader As String                             ' Header row from the input data\n    Dim sFileName As String                           ' File name to read from\n    Dim tFileName As String\n    Dim sInputSheet As String                         ' Worksheet to read from\n    Dim sRange As String                              ' Range to read from/copy\n    Dim tSheet As String\n    Dim tRange As String                              ' Range to paste into/Target Range\n    Dim sRow As Integer\n    Dim cRow As Integer\n\n    Application.Calculation = xlManual\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.AskToUpdateLinks = False\n\n    'Define source(s) and target(t) sheets\n    sTable = \"rng_SourceData\"\n    'loop through source table to copy and paste requred data\n    sRow = Range(sTable).Rows.Count\n\n    For cRow = 1 To sRow\n    'loop through source table to copy and paste requred data\n    sRow = Range(sTable).Rows.Count\n    For cRow = 1 To sRow\n\n\n        sFileName = Worksheets(\"I.Import\").Range(sTable).Cells(cRow, 1)\n        sInputSheet = Worksheets(\"I.Import\").Range(sTable).Cells(cRow, 2)\n        sRange = Worksheets(\"I.Import\").Range(sTable).Cells(cRow, 3)\n        tFileName = Worksheets(\"I.Import\").Range(sTable).Cells(cRow, 4)\n        tRange = Worksheets(\"I.Import\").Range(sTable).Cells(cRow, 5)\n        tSheet = Worksheets(\"I.Import\").Range(sTable).Cells(cRow, 6)\n\n        'Include all ranges in the input table\n        Call ImportDataSpreadsheet(sFileName, sInputSheet, sRange, tSheet, tRange)\n\n\n    Next cRow\n\nEnd Sub\n\nSub ImportDataSpreadsheet(sFileName, sInputSheet, sRange, tSheet, tRange)\n    Dim SourceWorkbook As Excel.Workbook\n    Dim TargetWorkbook As Excel.Workbook\n    Dim TargetSheet As Excel.Worksheet\n\n    'Define Source workbook\n    Set SourceWorkbook = Workbooks.Open(Filename:=sFileName, Password:=False)\n    'Select.Workbook.Sheets.Open (sInputSheet)\n    Application.ScreenUpdating = False\n    Application.AskToUpdateLinks = False\n    Application.Calculation = xlCalculationManual\n    Application.DisplayAlerts = False\n\n    'Copy\n    SourceWorkbook.Sheets(sInputSheet).Activate\n    SourceWorkbook.Sheets(sInputSheet).EnableSelection = xlNoRestrictions\n\n    SourceWorkbook.Sheets(sInputSheet).Range(sRange).Copy\n\n    'Define Target workbook\n    Set TargetWorkbook = ThisWorkbook.Worksheets(\"I.Import\").Range(sTable).Cells(cRow, 4)\n    Set TargetSheet = TargetWorkbook.Sheets(tSheet)\n\n    'Paste\n    TargetWorkbook.Sheets(tSheet).Range(tRange).PasteSpecial Paste:=xlPasteValues\n\n    'Close and finish.\n    SourceWorkbook.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 1810094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfa2876308e16c717c0994c3613e738?s=128&d=identicon&r=PG", "display_name": "bitoolean", "link": "https://stackoverflow.com/users/1810094/bitoolean"}, "is_accepted": false, "score": 1, "last_activity_date": 1515006185, "last_edit_date": 1592644375, "creation_date": 1513199678, "answer_id": 47802216, "question_id": 47801681, "link": "https://stackoverflow.com/questions/47801681/is-there-a-way-to-determine-if-a-string-exists-in-a-field-in-a-table-then-get/47802216#47802216", "title": "Is there a way to determine if a string exists in a field (in a table), then get the value in another field for that same record?", "body": "<p>DLookup will give you the result of any expression on a source of data (table/query) for the first record (row of data) that matches an optional criteria, including the value on a different column.</p>\n<blockquote>\n<p>dim foundValue AS Variant</p>\n<p>foundValue = DLookup(&quot;[ColumnName]&quot;, &quot;[tableOrQueryName]&quot;, &quot;[ColumnToCheckAgainst] = 'some string' &quot;)</p>\n</blockquote>\n<p>It returns whatever value it finds in column [ColumnName] (or feel free to use any expression you would use in a SELECT statement) of the first row in table/query [tableOrQueryName] that matches the criteria specified as the third argument (anything you can put in a WHERE clause is allowed here, just remember you cannot use double quotes to quote string values - you escape those with another double-quote inside a string literal, but you don't need the single quotes if you specify numbers for example).</p>\n<p>The criteria argument you can omit (it's optional and it defaults to no condition).</p>\n<p>Set the result to a Variant variable since it may very well be a NULL (also when criteria not met for any record).</p>\n<p>The example above will work similarly to the query &quot;SELECT TOP 1 [ColumnName] FROM [tableOrQueryName] WHERE [ColumnToCheckAgainst] = 'some string';&quot;.</p>\n<p>Documentation for DLookup:\n<a href=\"https://support.office.com/en-us/article/DLookup-Function-8896cb03-e31f-45d1-86db-bed10dca5937\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/DLookup-Function-8896cb03-e31f-45d1-86db-bed10dca5937</a></p>\n<p>Another way would be to use a Recordset object.</p>\n"}], "owner": {"reputation": 29, "user_id": 8941231, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e9f195bc2b51a96672e796157090dd94?s=128&d=identicon&r=PG&f=1", "display_name": "J.Ryan", "link": "https://stackoverflow.com/users/8941231/j-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "closed_date": 1513200335, "answer_count": 1, "score": 0, "last_activity_date": 1594022675, "creation_date": 1513197227, "last_edit_date": 1594022675, "question_id": 47801681, "link": "https://stackoverflow.com/questions/47801681/is-there-a-way-to-determine-if-a-string-exists-in-a-field-in-a-table-then-get", "closed_reason": "Needs more focus", "title": "Is there a way to determine if a string exists in a field (in a table), then get the value in another field for that same record?", "body": "<p>DCount does not work for this, as it only determine if an instance exists.  Any ideas?  I assume this is a very simple task, but am having trouble finding something suitable using google :-(</p>\n"}, {"tags": ["vba", "internet-explorer", "modal-dialog", "late-binding"], "comments": [{"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1513200311, "post_id": 47801674, "comment_id": 82565980, "body": "* late-bind &quot;Object A&quot; to the dialog box&#39;s window via handle* only if the window supports it. Only Richedit windows support it to my knowledge. Does Explorer&#39;s ShellWindows find it. <code>Set objShell = CreateObject(&quot;Shell.Application&quot;)</code> and <code>Set AllWindows = objShell.Windows</code> and <code>For Each window in AllWindows</code> and <code>msgbox  window.locationname</code> and <code>next</code>."}, {"owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515001468, "post_id": 47801674, "comment_id": 83139412, "body": "This was the first method I tried. However I found an example which does locate the dialog popup: <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=52\" rel=\"nofollow noreferrer\">vbaexpress.com/kb/getarticle.php?kb_id=52</a> . But I am still stuck on how I&#39;d late bind using this example"}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515012521, "post_id": 47801674, "comment_id": 83144625, "body": "That code has nothing to do with late binding or even COM. It is Windows API interface to windows on Windows. It also uses an old non recommended way to find windows that only finds the first window (ie <code>FindWindow()</code> rather than <code>EnumWindows</code>). If your buttons are <i>button windows</i> (<code>FindWindowsEx()</code> will find them) then you can send a Click message to them via a Windows message using the <code>SendMessage()</code> API call."}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515012720, "post_id": 47801674, "comment_id": 83144719, "body": "I have some sample code embedded in another program that lists all windows on a system. It gives output like this <code>Order\tLevel\tWindowText\tClassName\tHWnd\tParentHWnd\tProcessID\tP&zwnj;&#8203;arentProcessID\tThrea&zwnj;&#8203;dID\tModuleNameHWin\tE&zwnj;&#8203;XENameProcess </code> and <code>198\t0\tNewest &#39;batch-file or vbscript or cmd&#39; Questions - Stack Overflow - Internet Explorer\tTabThumbnailWindow\t6292800\t6423328\t5432\t6488\t6820\t&#171;&zwnj;&#8203;Not Available Error=126&#187;\tiexplore.exe </code>"}, {"owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1519934930, "post_id": 47801674, "comment_id": 85120427, "body": "Do you have example that uses findwindowsEx()/SendMessage() or one that simply closes the dialog window using findWindowsEx()?  If I can close it, I can inject some javascript which will accomplish what I want without using SendMessage() to click a button"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525546661, "post_id": 47801674, "comment_id": 87402983, "body": "Can&#39;t reproduce to attempt solution but you are aware of selenium basic as a wrapper for vba?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548207176, "post_id": 47801674, "comment_id": 95457369, "body": "Had a similar problem - my solution is here:   <a href=\"https://stackoverflow.com/questions/54318737/automating-the-html-document-in-an-ie-web-dialog-window/54318776#54318776\" title=\"automating the html document in an ie web dialog window\">stackoverflow.com/questions/54318737/&hellip;</a>"}], "owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1513197189, "creation_date": 1513197189, "question_id": 47801674, "link": "https://stackoverflow.com/questions/47801674/late-binding-object-to-existing-instance-via-handle-in-vba", "title": "Late binding object to existing instance via handle in VBA", "body": "<p><strong>This question pertains to VBA Internet Explorer automation</strong></p>\n\n<p>What I have is an Internet Explorer window that loads a dialog box with buttons when the page loads.</p>\n\n<p><strong>Here are the givens:</strong></p>\n\n<ol>\n<li>The dialog box is of the <strong>\"Internet Explorer_TridentDlgFrame\"</strong> class</li>\n<li>It isn't considered an app window like its originating IE window.</li>\n<li>Its \"form\" and button \"ID's are obtainable but not within DOM of the originating IE document</li>\n<li>So, referencing said IDs to interact with them does not work.</li>\n<li>Similarly, injecting JavaScript attached to its buttons does not work</li>\n<li>The dialog box can't be bypassed by closing it. A \"continue\" button must be pressed.</li>\n</ol>\n\n<p><strong>So I figured I'd use another method:</strong> </p>\n\n<p>If I cycle through all windows, I can obtain the dialog box's window handle via its window title.</p>\n\n<p><strong>With that said, is there a way to late-bind \"Object A\" to the dialog box's window via handle?</strong></p>\n\n<p><strong>And if so, is it then possible to late-bind \"Object B\" to \"Object A's\" document/form in order to interact with it?</strong></p>\n\n<p>This would be like accessing an existing instance of an open Excel workbook and late binding an object to it in order to interact with the workbook itself.</p>\n\n<p><strong>Note:</strong> I have used Selenium in the past, and while it may be a better solution to get around this dialog box, translating the rest of my (already) written program into Java would be a nightmare.</p>\n\n<p><strong>Note2:</strong> Using winHttp or other \"headless\" methods isn't an option</p>\n\n<p><strong>Any help is appreciated! Thanks!</strong></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1, "user_id": 9095797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7725477d1af2ede0659e1d1593e6c75?s=128&d=identicon&r=PG&f=1", "display_name": "ttools", "link": "https://stackoverflow.com/users/9095797/ttools"}, "edited": false, "score": 0, "creation_date": 1513212629, "post_id": 47801632, "comment_id": 82570118, "body": "@ttools You could always accept this answer to &quot;Thank him&quot;. This also helps let others know you do not need any more assistance."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1513198144, "last_edit_date": 1513198144, "creation_date": 1513196998, "answer_id": 47801632, "question_id": 47801492, "link": "https://stackoverflow.com/questions/47801492/need-to-be-able-to-click-on-a-upc-code-in-one-excel-workbook-and-have-it-take-me/47801632#47801632", "title": "Need to be able to click on a upc code in one excel workbook and have it take me to the same upc code in a different workbook", "body": "<ol>\n<li><p>Change <code>\u201cSecondWorkbook.xlsx\u201d</code> to <code>\"SecondWorkbook.xlsx\"</code></p>\n\n<p>Double-quotation marks (i.e. <code>\"</code>) are used in VBA to signify the start and end of string literals, but smart-quotes (i.e. <code>\u201c</code> and <code>\u201d</code>) are treated in the same way as any other character and can form part of a variable name, so a statement such as <code>x\u201ds = 5</code> is perfectly valid and sets the variable <code>x\u201ds</code> to 5.</p>\n\n<p>Your <code>\u201cSecondWorkbook.xlsx\u201d</code> was therefore being treated as an attempt to use the <code>xlsx\u201d</code> property of a non-existent <code>\u201cSecondWorkbook</code> object.</p></li>\n<li><p>Change</p>\n\n<pre><code>Workbooks(\"SecondWorkbook.xlsx\").Sheets(1).Found.Select\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Workbooks(\"SecondWorkbook.xlsx\").Activate\nWorkbooks(\"SecondWorkbook.xlsx\").Sheets(1).Activate\nFound.Select\n</code></pre>\n\n<p>because you can't <code>Select</code> a cell on a worksheet that is not active.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 9095797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7725477d1af2ede0659e1d1593e6c75?s=128&d=identicon&r=PG&f=1", "display_name": "ttools", "link": "https://stackoverflow.com/users/9095797/ttools"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513198144, "creation_date": 1513196384, "last_edit_date": 1531164843, "question_id": 47801492, "link": "https://stackoverflow.com/questions/47801492/need-to-be-able-to-click-on-a-upc-code-in-one-excel-workbook-and-have-it-take-me", "title": "Need to be able to click on a upc code in one excel workbook and have it take me to the same upc code in a different workbook", "body": "<p>I want to be able to click on a upc code in one workbook and have it take me to that same upc code in another workbook. This is the code I am using but there is some error in the code if you try to run it through Excel. If anyone knows how to figure this out your help would be extremely appreciated! Thanks!</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Dim Found As Range\n\n    On Error Resume Next\n    Set Found = Workbooks(\"SecondWorkbook.xlsx\").Sheets(1).Cells.Find(What:=Target.Value, _\n        After:=Workbooks(\u201cSecondWorkbook.xlsx\u201d).Sheets(1).Cells(1, 1), _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious, MatchCase:=True)\n    On Error GoTo 0\n\n    If Found Is Nothing Then\n        Cancel = True\n    Else\n        Cancel = False\n        Workbooks(\"SecondWorkbook.xlsx\").Sheets(1).Found.Select\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1513195096, "post_id": 47801148, "comment_id": 82563465, "body": "<i>&quot;.. where the user would authenticate...&quot;</i> - Authenticate, <b>how</b>?  Active Directory?  Against a hard-coded list somewhere?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513196141, "post_id": 47801148, "comment_id": 82564024, "body": "1. Holding Shift when loading workbook disables macros. 2. Macros can be disabled in Excel settings."}, {"owner": {"reputation": 113, "user_id": 479573, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/427cf18a85242ea734d603a0b86622c4?s=128&d=identicon&r=PG", "display_name": "Stiley", "link": "https://stackoverflow.com/users/479573/stiley"}, "edited": false, "score": 0, "creation_date": 1513203177, "post_id": 47801148, "comment_id": 82567170, "body": "Yeah sorry, authenticate means just against a set of 4 or 5 hard coded users"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1513216703, "post_id": 47801148, "comment_id": 82571080, "body": "How secure does this need to be? Are you protecting social security numbers, or just making it convenient? Excel is not known for robust security, but it has some good tools to prevent well intentioned people from accidentally messing things up."}, {"owner": {"reputation": 113, "user_id": 479573, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/427cf18a85242ea734d603a0b86622c4?s=128&d=identicon&r=PG", "display_name": "Stiley", "link": "https://stackoverflow.com/users/479573/stiley"}, "edited": false, "score": 0, "creation_date": 1513254371, "post_id": 47801148, "comment_id": 82587916, "body": "The solution just needs to be convenient, it is not protecting anything as secure as SSNs or any thing like that and will remain internal to our department."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 479573, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/427cf18a85242ea734d603a0b86622c4?s=128&d=identicon&r=PG", "display_name": "Stiley", "link": "https://stackoverflow.com/users/479573/stiley"}, "edited": false, "score": 0, "creation_date": 1513258233, "post_id": 47802448, "comment_id": 82590451, "body": "Thanks, I went with another solution but appreciate the time you took."}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 2, "last_activity_date": 1513200816, "creation_date": 1513200816, "answer_id": 47802448, "question_id": 47801148, "link": "https://stackoverflow.com/questions/47801148/excel-limit-view-of-worksheets-to-certian-users/47802448#47802448", "title": "Excel - Limit view of worksheets to certian users", "body": "<p>You could probably achieve this by using the Auto_Open event</p>\n\n<pre><code>Function Auto_Open()\n    Select Case True\n    Case InStr(Application.UserName, \"Dan Smith\") &gt; 0\n        ActiveWorkbook.Sheets(1).Visible = xlSheetVeryHidden\n    Case InStr(Application.UserName, \"Jon Doe\") &gt; 0\n        ActiveWorkbook.Sheets(1).Visible = True\n    End Select\nEnd Function\n</code></pre>\n\n<p>Of course this would take a lot of work considering you'd have to find out everyone's usernames and then the sheets that you want to hide from them, but that's what I thought of</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 479573, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/427cf18a85242ea734d603a0b86622c4?s=128&d=identicon&r=PG", "display_name": "Stiley", "link": "https://stackoverflow.com/users/479573/stiley"}, "edited": false, "score": 0, "creation_date": 1513258186, "post_id": 47804779, "comment_id": 82590423, "body": "Thanks @K.Davis exactly what I needed.  Very much appreciated and happy to give you something enjoyable to do on a Wednesday evening :-)"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 2, "last_activity_date": 1513217807, "last_edit_date": 1513217807, "creation_date": 1513216481, "answer_id": 47804779, "question_id": 47801148, "link": "https://stackoverflow.com/questions/47801148/excel-limit-view-of-worksheets-to-certian-users/47804779#47804779", "title": "Excel - Limit view of worksheets to certian users", "body": "<p>I actually enjoyed the task of typing this one up. Keep in mind, VBE is not protected in this code so you may want to add some protection, but this should do what you need.</p>\n\n<p>You should also create a generic <code>Login</code> worksheet. This would be the only sheet open before a password is entered. This is essential as you are unable to hide every sheet without throwing an error. (You need to have 1 visible sheet).</p>\n\n<blockquote>\n  <p><strong>WARNING:</strong> This code is <em>mildly</em> tested. You are responsible for any loss of data for using the below code, such as (but not limited to) forgetting a password. You have been warned!!!!</p>\n</blockquote>\n\n<h1>1. Open the Workbook, then make a Call to GetLogin</h1>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n\n    GetLogin 1\n\nEnd Sub\n</code></pre>\n\n<h1>2. The Login Code</h1>\n\n<pre><code>Private Sub GetLogin(ByVal AttemptNumber As Integer)\n\n    Dim Sheet As Worksheet\n\n    With ThisWorkbook.Worksheets(\"Login\")\n        .Visible = xlSheetVisible\n        .Activate\n    End With\n\n    For Each Sheet In ThisWorkbook.Sheets\n        If Not Sheet.Name = \"Login\" Then\n            Sheet.Visible = xlSheetVeryHidden\n        End If\n    Next Sheet\n\n    Dim Password As String\n    Password = Application.InputBox(\"Please enter your password\")\n\n    Select Case Password\n        Case \"Ma$terPas$\"\n            For Each Sheet In ThisWorkbook.Sheets\n                Sheet.Visible = xlSheetVisible\n            Next Sheet\n            ThisWorkbook.Worksheets(1).Activate 'For when you hide login sheet\n        Case \"Oth3Rpa$$\"\n            With ThisWorkbook\n                .Worksheets(1).Visible = xlSheetVisible\n            End With\n            ThisWorkbook.Worksheets(1).Activate 'For when you hide login sheet\n        Case Else\n            If AttemptNumber &lt;= 3 Then\n                If MsgBox(\"You entered an incorrect password\", vbRetryCancel, \"Attempt # \" &amp; AttemptNumber) = vbRetry Then\n                    AttemptNumber = AttemptNumber + 1\n                    GetLogin AttemptNumber\n                Else\n                    ThisWorkbook.Saved = True\n                    ThisWorkbook.Close\n                End If\n            Else\n                ThisWorkbook.Saved = True\n                ThisWorkbook.Close\n            End If\n    End Select\n\n    ThisWorkbook.Worksheets(\"Login\").Visible = xlSheetHidden\n\nEnd Sub\n</code></pre>\n\n<h1>3. Close the Workbook</h1>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    If ThisWorkbook.Saved = False Then\n        If MsgBox(\"Would you like to save?\", vbYesNo) = vbYes Then\n            ThisWorkbook.Save\n        End If\n    End If\n\n    Dim Sheet As Worksheet\n    With ThisWorkbook.Worksheets(\"Login\")\n        .Visible = xlSheetVisible\n        .Activate\n    End With\n\n    For Each Sheet In ThisWorkbook.Sheets\n        If Not Sheet.Name = \"Login\" Then\n            Sheet.Visible = xlSheetVeryHidden\n        End If\n    Next Sheet\n\n    'Prevent from being asked to save the fact you just hid the sheets\n    ThisWorkbook.Saved = True\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Ensure that the <code>Workbook_Open</code> and <code>Workbook_Close</code> are in your Workbook's Module.</p>\n</blockquote>\n"}], "owner": {"reputation": 113, "user_id": 479573, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/427cf18a85242ea734d603a0b86622c4?s=128&d=identicon&r=PG", "display_name": "Stiley", "link": "https://stackoverflow.com/users/479573/stiley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 47804779, "answer_count": 2, "score": 1, "last_activity_date": 1513217807, "creation_date": 1513194899, "last_edit_date": 1531161705, "question_id": 47801148, "link": "https://stackoverflow.com/questions/47801148/excel-limit-view-of-worksheets-to-certian-users", "title": "Excel - Limit view of worksheets to certian users", "body": "<p>I have an excel workbook containing several worksheets.</p>\n\n<p>What I want to do is have a mechanism like a user form or something where the user would authenticate to one of several possible users.  </p>\n\n<p>Based on the username supplied I want to display certain worksheets and hide other sheets, and block the user from accessing worksheets they should not be able to view.</p>\n\n<p>Has anyone done something like this in Excel?</p>\n\n<p>Any thoughts are appreciated\nSean</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1513195260, "post_id": 47801138, "comment_id": 82563572, "body": "With a little bit of research I found this formula that might help you convert epoch time to a readable date <code>=TEXT(DATE(1970,1,1)+A1&#47;86400,&quot;dd&#47;mm&#47;yy hh:mm:ss&quot;)</code> I did read somewhere that timezone does affect this, however don&#39;t quote me on that"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "edited": false, "score": 0, "creation_date": 1513205303, "post_id": 47801901, "comment_id": 82567961, "body": "I tried using your code but it deleted everything on my sheet. I did change the name of the sheet to the name of my project. I tried the code by itself and also before and after the one, I used to delete the columns with the same result. Also, the time on the sheet is on epoch time example 1507525449 and would have to be converted to dd/mm/yy hh:mm:ss . Thank you for your help it is greatly appreciated."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "edited": false, "score": 0, "creation_date": 1513208223, "post_id": 47801901, "comment_id": 82568914, "body": "@user2604232, I&#39;ve edited the code in my post and elaborated on it, I hope this helps."}, {"owner": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "edited": false, "score": 0, "creation_date": 1513269663, "post_id": 47801901, "comment_id": 82598260, "body": "Thank you for your time and patience. I tried this again and I got a &quot;Compile error: Next without For.&quot; As for the time conversion will it be converted to my time zone? -6 central time? Thanks!"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "edited": false, "score": 0, "creation_date": 1513271903, "post_id": 47801901, "comment_id": 82599597, "body": "@user2604232 you must have omitted an End IF, double check your code, I&#39;m pretty sure if you add an End If before Wend, then it should work..."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "edited": false, "score": 0, "creation_date": 1513272606, "post_id": 47801901, "comment_id": 82600016, "body": "No problem at all @user2604232. I missed an <code>End if</code> to close out the <code>If blnEpoch Then</code> which caused that error, which has been fixed in the code above. As far as the epoch conversion, I&#39;m not sure, assuming the epoch time is counted from from 1-1-1970 00:00:00 UTC, then no. If you want to convert that, you&#39;d have to subtract <code>6 &#215; 3,600</code> from the epoch time and hen convert it (I think), but if your country/state observes daylight savings, which UTC/GMT does not, you&#39;d also have to compensate for that."}, {"owner": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "edited": false, "score": 0, "creation_date": 1513276420, "post_id": 47801901, "comment_id": 82602095, "body": "Thank you for all your help and explanations which make me understand and learn a bit of how this works. I ran the code and got a Run-time Error &#39;6&#39;: Overflow in line.Cells(j, i) = DateAdd(&quot;s&quot;, .Cells(j, i), &quot;01/01/1970 00:00:00&quot;). We do observe daylight savings here and where would I subtract the 6 x 3,600 ?"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1513288917, "post_id": 47801901, "comment_id": 82608154, "body": "The overflow error is caused by the epoch time, being converted twice and reformatted and ended up being something that it couldn&#39;t handle. I&#39;ve written an update for that. As for the time conversion to a local time which observes is actually quite difficult. <a href=\"https://www.youtube.com/watch?v=-5wpm-gesOY\" rel=\"nofollow noreferrer\">This video</a> explains it quite well."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1513289933, "post_id": 47801901, "comment_id": 82608608, "body": "That being said, and assuming you&#39;re only in one zone, and don&#39;t ever ask me to incorporate more zones, what state/city are you in?"}, {"owner": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "edited": false, "score": 0, "creation_date": 1513354362, "post_id": 47801901, "comment_id": 82635676, "body": "Wow I need to learn all this stuff what would be a good course or tutorial to start with. It&#39;s really caught my attention. The state would be Texas and the city Eagle Pass. Thanks!"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1513355651, "post_id": 47801901, "comment_id": 82636447, "body": "To be honest, I&#39;m self taught, learned by StackOverflow, Google, and just trying. I&#39;m short on time at the moment so bear with me."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "edited": false, "score": 0, "creation_date": 1513425335, "post_id": 47801901, "comment_id": 82654766, "body": "@user2604232, I&#39;ve updated the code and added a function to do a conversion to your local time. As you may be able to see from this, if you incorporate more zones, you will get exponentially more logic rules and exceptions to those rules as there is no uniformity to timezones. And as an added bonus, Calls that happen around the moment DST starts or ends, may end up as ending before they were answered due to the none linear nature of human readable times and timezones."}], "tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": false, "score": 0, "last_activity_date": 1513468540, "last_edit_date": 1513468540, "creation_date": 1513198208, "answer_id": 47801901, "question_id": 47801138, "link": "https://stackoverflow.com/questions/47801138/i-need-help-using-vba-in-excel-for-a-call-detail-report/47801901#47801901", "title": "I need help using VBA in excel for a Call Detail Report", "body": "<p>Have a look at the refactored code below and stick that in the <code>ThisWokbook</code> module of your VBA project, this sub is triggered by the <code>workbook_open</code> event and should fire every time this particular document is opened.</p>\n\n<p>If you want to automatically have this apply to new files, you would have to create VBA project in a file, which opens new files, processes them and saves them. It may be a little more complicated but if you do some research on it you should be able to do it.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim blnColDeleted As Boolean, blnEpoch As Boolean\n    Dim columnHeading As String, strFormat As String\n    Dim i As Long, j As Long\n    Dim arrTMP As Variant\n    Dim lngTMP As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")                                                      'Change Sheet1 to your actual sheetname\n        For i = .UsedRange.Columns.Count To 1 Step -1                                           'Create a for loop which steps backwards to compensate for deleted columns\n            blnColDeleted = False                                                               'Reset some variables for the next column\n            blnEpoch = False\n            columnHeading = emptyy\n            strFormat = Empty\n            Select Case .Cells(1, i)\n                Case \"dateTimeOrigination\", \"Date Time\"\n                    columnHeading = \"Date Time\"                                                 'Change to what you actually want the columnheading to be, goes for all cases\n                    strFormat = \"dd/mm/yy hh:mm:ss;@\"                                             'Change the string to change the format to suit your needs\n                    blnEpoch = True                                                             'If this column contains epoch timestamps, set to true to convert them\n                Case \"callingPartyNumber\", \"Calling Number\"\n                    columnHeading = \"Calling Number\"\n                    strFormat = Empty                                                           'Change to desired formatting, leave empty if no formatting required\"\n                    blnEpoch = False\n                Case \"originalCalledPartyNumber\", \"Original Calld Party Number\"\n                    columnHeading = \"Original Calld Party Number\"\n                    strFormat = Empty\n                    blnEpoch = False\n                Case \"finalCalledPartyNumber\", \"Final Called Party Number\"\n                    columnHeading = \"Final Called Party Number\"\n                    strFormat = Empty\n                    blnEpoch = False\n                Case \"dateTimeConnect\", \"Date Time Connect\"\n                    columnHeading = \"Date Time Connect\"\n                    strFormat = \"dd/mm/yy hh:mm:ss;@\"\n                    blnEpoch = True\n                Case \"dateTimeDisconnect\", \"Date Time Disconnect\"\n                    columnHeading = \"Date Time Disconnect\"\n                    strFormat = \"dd/mm/yy hh:mm:ss;@\"\n                    blnEpoch = True\n                Case \"lastRedirectDn\", \"Last Redirect Dn\"\n                    columnHeading = \"Last Redirect Dn\"\n                    strFormat = Empty\n                    blnEpoch = False\n                Case \"duration\", \"Duration\"\n                    columnHeading = \"Duration\"\n                    strFormat = \"[m]:ss;@\"                                                       'The square brackets around \"mm\" show elapsed minutes\n                    blnEpoch = False\n                Case Else\n                    blnColDeleted = True\n                    .Columns(i).Delete                                                          'If the column header does not match any of the cases, then it is deleted\n            End Select\n            If Not blnColDeleted Then\n                .Cells(1, i) = columnHeading\n                If blnEpoch And Not .Cells(2, i) &lt; Now() Then\n                    arrTMP = .Range(.Cells(2, i), .Cells(2, i).End(xlDown))                     'Introduced arrays to quickly convert large batches instead of cell by cell. Continous read write operations directly interacting with the sheet will be very resource heavy\n                    For j = LBound(arrTMP, 1) To UBound(arrTMP, 1)\n                        lngTMP = arrTMP(j, 1)\n                        arrTMP(j, 1) = timeCorrected(lngTMP)\n                    Next j\n                    With .Range(.Cells(1, i).Offset(1, 0), .Cells(1, i).Offset(UBound(arrTMP, 1), 0))\n                        .Value = arrTMP\n                        .NumberFormat = strFormat\n                    End With\n                ElseIf Not strFormat = Empty Then\n                    .Range(.Cells(2, i), .Cells(2, i).End(xlDown)).NumberFormat = strFormat\n                End If\n                .Columns(i).AutoFit\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Add the function below to a module so it can be referenced by any procedure. This function returns the epoch time in UTC-6 (CST) and UTC-5 (CST with DST) between 2nd Sunday of March of that year and the 1st Sunday of November of that year in an Excel Date time format (days counted since 0/1/1900, and the time behind the decimal symbol, for example 24/05/2017 12:00:00 = 42879.5). I've edited the code above to incorporate this function. I hope this helps and you can take it from here.</p>\n\n<pre><code>Function timeCorrected(myEpoch As Long) As Double\n    Dim lngYear As Long, lngMonth As Long, lngDay As Long\n    Dim dblTime As Double, dblStartDST As Double, dblEndDST As Double\n    Dim i As Long\n\n    dblTime = DateAdd(\"s\", myEpoch - 21600, \"01/01/1970\") 'Time is converted to CST without DST correction (UTC - 6)\n\n    lngYear = Year(dblTime)\n    lngMonth = Month(dlbtime)\n    lngDay = Day(dblTime)\n\n    'DST starts second Sunday in March\n    For i = DateSerial(lngYear, 3, 8) To DateSerial(lngYear, 3, 14)\n        If Application.WorksheetFunction.Weekday(i, 2) = 7 Then\n            dblStartDST = i + TimeSerial(2, 0, 0)\n            Exit For\n        End If\n    Next\n\n    'DST ends first sunday in november\n    For i = DateSerial(lngYear, 11, 1) To DateSerial(lngYear, 11, 7)\n        If Application.WorksheetFunction.Weekday(i, 2) = 7 Then\n            dblEndDST = i + TimeSerial(2, 0, 0)\n            Exit For\n        End If\n    Next\n\n    If dblTime &gt;= dblStartDST And dblTime &lt; dblEndDST Then\n        timeCorrected = dblTime + TimeSerial(1, 0, 0)\n    Else\n        timeCorrected = dblTime\n    End If\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>As for the deletion of all columns encountered, I've discovered 1 typo in the <code>lastRedirectDN</code>which caused the wrongful deletion of that column.</p>\n\n<p>But more likely what happened is that you've run this macro twice. After the first time running this macro, all column headings will be different which will result in all columns being deleted because all columns will fail the check whether they are to be kept or not.</p>\n\n<p>This can be fixed by adding the new column heading to the case like below but make sure that whatever you set your column heading to, it is identical to what is in the <code>Case</code></p>\n\n<pre><code>Case \"dateTimeOrigination\", \"Date Time\"\n    columnHeading = \"Date Time\"\n    strFormat = \"dd/mm/yy hh:mm:ss\"\nCase \"callingPartyNumber\", \"Calling Number\"\n    columnHeading = \"Calling Number\"\n    strformat = Empty\n</code></pre>\n\n<p>As for the epoch conversion, I completely missed that, I've edited the original code above to allow epoch conversion.</p>\n"}], "owner": {"reputation": 7, "user_id": 2604232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7f44ddd81ec109066ee7246e449c8c3e?s=128&d=identicon&r=PG", "display_name": "user2604232", "link": "https://stackoverflow.com/users/2604232/user2604232"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513468540, "creation_date": 1513194861, "last_edit_date": 1513251463, "question_id": 47801138, "link": "https://stackoverflow.com/questions/47801138/i-need-help-using-vba-in-excel-for-a-call-detail-report", "title": "I need help using VBA in excel for a Call Detail Report", "body": "<p>I dumped some CDR files from our phone system and I need to sort out the data in the CVS file to make an easy read report. Doing it manually takes almost all day long to do it as we get countless calls. I found this code one here which works great to delete all the columns I don't need. However, it's only doing part of what I need to do. </p>\n\n<p>Other things I would like to do to the file are:</p>\n\n<ul>\n<li>Change time from epoch \"xxxxxxxxxx\" to time \"dd/mm/yy hh:mm:ss\"</li>\n<li>Autofit Column Width</li>\n<li>Change the column names from \"dateTimeOrigination\" to \"Date Time\" etc.</li>\n<li>Apply this automatically to any CDR.cvs dump file I open.</li>\n</ul>\n\n<p>I am using Excel 2016.</p>\n\n<pre><code>Sub deleteIrrelevantColumns()\nDim keepColumn As Boolean\nDim currentColumn As Integer\nDim columnHeading As String\n\n\ncurrentColumn = 1\nWhile currentColumn &lt;= ActiveSheet.UsedRange.Columns.Count\ncolumnHeading = ActiveSheet.UsedRange.Cells(1, currentColumn).Value\n\n\n'CHECK WHETHER TO KEEP THE COLUMN\nkeepColumn = False\nIf columnHeading = \"dateTimeOrigination\" Then keepColumn = True\nIf columnHeading = \"callingPartyNumber\" Then keepColumn = True\nIf columnHeading = \"originalCalledPartyNumber\" Then keepColumn = True\nIf columnHeading = \"finalCalledPartyNumber\" Then keepColumn = True\nIf columnHeading = \"dateTimeConnect\" Then keepColumn = True\nIf columnHeading = \"dateTimeDisconnect\" Then keepColumn = True\nIf columnHeading = \"lastRedirectDn\" Then keepColumn = True\nIf columnHeading = \"duration\" Then keepColumn = True\n\n\n\n\nIf keepColumn Then\n'IF YES THEN SKIP TO THE NEXT COLUMN,\ncurrentColumn = currentColumn + 1\nElse\n'IF NO DELETE THE COLUMN\nActiveSheet.Columns(currentColumn).Delete\nEnd If\n\n\n'LASTLY AN ESCAPE IN CASE THE SHEET HAS NO COLUMNS LEFT\nIf (ActiveSheet.UsedRange.Address = \"$A$1\") And \n(ActiveSheet.Range(\"$A$1\").Text = \"\") Then Exit Sub\nWend\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1513193581, "post_id": 47800673, "comment_id": 82562724, "body": "You have shown the code where you put something into a <code>String</code> variable, but perhaps also showing the code where you execute that command in VBA might be useful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513194092, "post_id": 47800673, "comment_id": 82562979, "body": "That&#39;s all I have in VB.  Is that what I&#39;m missing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513194221, "post_id": 47800673, "comment_id": 82563067, "body": "Apparently so.  That was it, thank you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513194276, "post_id": 47800673, "comment_id": 82563091, "body": "For the record, this is what I added...DoCmd.OpenQuery &quot;sp_Submit&quot;"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513194403, "post_id": 47800673, "comment_id": 82563152, "body": "Put that as a self-answer if you think other people might have similar issues in the future.  (But, if you do, it would be useful to edit the question to mention that your code consists <b>only</b> of the statement shown and, I assume, a <code>Sub</code> and <code>End Sub</code>.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1513194586, "post_id": 47800673, "comment_id": 82563244, "body": "And, FWIW, what you should have added was <code>DoCmd.OpenQuery sSQL</code> - there is no point creating a variable to hold the text of the query you want to execute if you don&#39;t then use that variable when doing the query.  If you just use <code>DoCmd.OpenQuery &quot;sp_Submit&quot;</code> then there is no point creating the <code>sSQL</code> variable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513268145, "post_id": 47800673, "comment_id": 82597251, "body": "Thank you. That makes sense.  I never understood that but just did it because that&#39;s how all of our other programs are done."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "edited": false, "score": 0, "creation_date": 1513269141, "post_id": 47804325, "comment_id": 82597939, "body": "Thank you! That helps very much. I appreciate your taking the time to explain it to me.  ~I upvoted and marked your answer as complete."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 0, "last_activity_date": 1513212476, "creation_date": 1513212476, "answer_id": 47804325, "question_id": 47800673, "link": "https://stackoverflow.com/questions/47800673/pass-through-query-wont-run-from-command-line/47804325#47804325", "title": "Pass Through Query Won&#39;t Run From Command Line", "body": "<p>Given what you have to far, then you should be able to edit the saved pass though query with</p>\n\n<pre><code>Sp_Submit 'test'\n</code></pre>\n\n<p>Assuming the 1 paramter is text. If the parameter is to be a number, then </p>\n\n<pre><code>Sp_Submit 123\n</code></pre>\n\n<p>At this point, you have to save that query. Now click on it, does it run correctly?</p>\n\n<p>And in place of clicking on the query, you can certainly do</p>\n\n<pre><code>CurrentDB.execute \"name of saved query goes here\"\n</code></pre>\n\n<p>However, keep in mind that a PT query is raw T-SQL. What executes runs 100% on the server. This means that such query(s) cannot contain references to any form, or anything else. So you have to \u201cpre-process\u201d or create the value you wish to pass and modify the PT query. So your code of creating the SQL you have looks correct, but you then have to take that sql string and \"set\" the PT query.</p>\n\n<p>The most easy way to do this is with code like this:</p>\n\n<pre><code>With CurrentDb.QueryDefs(\"MyPass\")\n   .SQL = \"sp_Submit '\" &amp; Me.cboNumber &amp; \"'\"\n   .Execute\nEnd With\n</code></pre>\n\n<p>Of course if the PT query returns records, then you would go:</p>\n\n<pre><code>Dim rstRecords       As DAO.Recordset\nWith CurrentDb.QueryDefs(\"MyPass\")\n   .SQL = \"sp_Submit '\" &amp; Me.cboNumber &amp; \"'\"\n   .ReturnsRecords = True\n   Set rstRecords = .OpenRecordset\nEnd With\n</code></pre>\n\n<p>And to be fair, you likely should set \u201creturns\u201d records = false in the first example. You can do this in the property sheet of the save query, or in code like this:</p>\n\n<pre><code>With CurrentDb.QueryDefs(\"MyPass\")\n   .SQL = \"sp_Submit '\" &amp; Me.cboNumber &amp; \"'\"\n   .ReturnsRecords = False\n   .Execute\nEnd With\n</code></pre>\n\n<p>Note that you can use the one PT query over and over in your code. So once you ceated that one PT query, then you can use it to pass any new sql you wish, such as:</p>\n\n<pre><code>Dim rstRecords       As DAO.Recordset\nWith CurrentDb.QueryDefs(\"MyPass\")\n   .SQL = \"select * from tblHotels\"\n   .ReturnsRecords = True\n  Set rstRecords = .OpenRecordset\nEnd With\n</code></pre>\n\n<p>So you can \"stuff\" in any sql you want for that one PT query - and use it throughout your application.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6906550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 47804325, "answer_count": 1, "score": 0, "last_activity_date": 1513212476, "creation_date": 1513192891, "last_edit_date": 1513193445, "question_id": 47800673, "link": "https://stackoverflow.com/questions/47800673/pass-through-query-wont-run-from-command-line", "title": "Pass Through Query Won&#39;t Run From Command Line", "body": "<p>I created a pass through query in Access.  </p>\n\n<p>All it says is .\n    sp_Submit ''</p>\n\n<p>If I click on it directly it runs the SSMS stored procedure which just changes some test tables.    </p>\n\n<p>However if I run it in VBA it does not work.  It doesn't error out or anything, it just does not work.  </p>\n\n<p>I have tried</p>\n\n<pre><code>sSQL = \"sp_Submit '\" &amp; Me.cboNumber &amp; \"'\"\n</code></pre>\n\n<p>and </p>\n\n<pre><code> sSQL = \"sp_Submit '\"\n</code></pre>\n\n<p>Please not the stored procedure isn't doing anything much at this point.  I have it testing some stuff. It just deletes everything in one table and inserts it in another.  </p>\n\n<p>What am I doing wrong?  I've used this in the past and it has worked so I'm not sure why it doesn't work this time.   The stored procedure itself is set up to accept one variable but it doesn't actually do anything with it (yet.). </p>\n\n<p>Thank you. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513192605, "post_id": 47800569, "comment_id": 82562239, "body": "There is probably no <code>Worksheets(&quot;GSR&quot;)</code> in <code>ActiveWorkbook</code>, so you probably need to use <code>Workbooks(&quot;Reservation Activity Dashboard (RAD) CP.xlsm&quot;).Worksheets(&quot;GSR&quot;)</code> instead (when calculating <code>.Rows.Count</code>)"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513192741, "post_id": 47800569, "comment_id": 82562309, "body": "I guess this is handy to always write this long-winded string <code>Workbooks(&quot;Reservation Activity Dashboard (RAD) CP.xlsm&quot;)</code>"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513192811, "post_id": 47800569, "comment_id": 82562348, "body": "Usin <code>Selection</code> and <code>GSR</code> worksheet. H-m-m-m... What could go wrong?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513193308, "post_id": 47800569, "comment_id": 82562584, "body": "^^ All the <code>Select</code> statements will crash if &quot;GSR&quot; isn&#39;t the active worksheet but, as far as I can see, they are all redundant anyway and should therefore be deleted.  But you should change <code>Range(&quot;$A$8:$AA$&quot; &amp; LastRow)</code> to be <code>.Range(&quot;$A$8:$AA$&quot; &amp; LastRow)</code>."}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1513200075, "post_id": 47800569, "comment_id": 82565870, "body": "Not everyone coming to ask a question here is an expert, @JohnyL. Your smart-aleck comments, esp re: &quot;Selection&quot; don&#39;t help anyone so thanks for nothing. I used the recorder to arrive at this and modified it as best I could. And my long-winded strings are to help me understand what&#39;s going on as I&#39;m still pretty new to VBA with no actual class on it. When a file works as it should, I then go back and add variables for a smaller packaged code."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1513192801, "creation_date": 1513192801, "answer_id": 47800644, "question_id": 47800569, "link": "https://stackoverflow.com/questions/47800569/runtime-error-9-when-using-with-sheet/47800644#47800644", "title": "Runtime Error 9 when using &quot;With Sheet&quot;", "body": "<p>Write the <code>lastRow</code> call in a <code>With block</code> as well to fully qualify all objects as desired.</p>\n\n<pre><code>Dim LastRow As Long\nWith Workbooks(\"Reservation Activity Dashboard (RAD) CP.xlsm\").Worksheets(\"GSR\")\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1513199592, "post_id": 47800662, "comment_id": 82565677, "body": "Thank you for explaining the top portion as I did modify it some and took out the activesheet parts as the main book wasn&#39;t the active sheet in my code and thought I could just change it to whatever open book I wanted. I applied your changes and got an error 1004 at the .Range(&quot;A8&quot;) line. I went ahead and marked the main workbook to activate at the top of the MakeGSRTable and this got it to work. Thanks for the help."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1513199646, "post_id": 47800662, "comment_id": 82565707, "body": "@Craig As I said in a comment to the question, the <code>Select</code> statements all seem redundant - just delete them."}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1513200966, "post_id": 47800662, "comment_id": 82566273, "body": "You&#39;re too good, Yow! I removed the selection parts, added the &quot;.&quot; before the Range(&quot;$A$8:$AA$&quot; &amp; LastRow) line, removed my newest activate line, and it runs smoothly. Thank you so much!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1513192860, "creation_date": 1513192860, "answer_id": 47800662, "question_id": 47800569, "link": "https://stackoverflow.com/questions/47800569/runtime-error-9-when-using-with-sheet/47800662#47800662", "title": "Runtime Error 9 when using &quot;With Sheet&quot;", "body": "<p>At the moment your line</p>\n\n<pre><code>LastRow = Workbooks(\"Reservation Activity Dashboard (RAD) CP.xlsm\").Worksheets(\"GSR\").Cells(Worksheets(\"GSR\").Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>is equivalent to </p>\n\n<pre><code>LastRow = Workbooks(\"Reservation Activity Dashboard (RAD) CP.xlsm\").Worksheets(\"GSR\").Cells(ActiveWorkbook.Worksheets(\"GSR\").Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>so, if there is no \"GSR\" worksheet in the active workbook, it will give a \"subscript out of range\" error.</p>\n\n<p>The line should actually say</p>\n\n<pre><code>LastRow = Workbooks(\"Reservation Activity Dashboard (RAD) CP.xlsm\").Worksheets(\"GSR\").Cells(Workbooks(\"Reservation Activity Dashboard (RAD) CP.xlsm\").Worksheets(\"GSR\").Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>but that is getting a bit unwieldy, so it would be better if you moved it inside your <code>With</code> block:</p>\n\n<pre><code>With Workbooks(\"Reservation Activity Dashboard (RAD) CP.xlsm\").Worksheets(\"GSR\")\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    '...\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 47800662, "answer_count": 2, "score": 0, "last_activity_date": 1513192860, "creation_date": 1513192497, "last_edit_date": 1531164843, "question_id": 47800569, "link": "https://stackoverflow.com/questions/47800569/runtime-error-9-when-using-with-sheet", "title": "Runtime Error 9 when using &quot;With Sheet&quot;", "body": "<p>I came up with a solution that should circumvent my original issue (found below VBA code so I can keep this short and sweet if extra info is unnecessary) but I get a runtime error9. I tested this code on two basic workbooks and it worked fine. The LastRow line is the line that highlights when debugging. I tried to surround the file name in single 's since the name has spaces but that didn't resolve the error.</p>\n\n<pre><code>Sub MakeGSATable()\n\nDim LastRow As Long\nLastRow = Workbooks(\"Reservation Activity Dashboard (RAD) CP.xlsm\").Worksheets(\"GSR\").Cells(Worksheets(\"GSR\").Rows.Count, \"A\").End(xlUp).Row\n\nWith Workbooks(\"Reservation Activity Dashboard (RAD) CP.xlsm\").Worksheets(\"GSR\")\n.Range(\"A8\").Select\n.Range(Selection, Selection.End(xlToRight)).Select\n.Range(Selection, Selection.End(xlDown)).Select\n.ListObjects.Add(xlSrcRange, Range(\"$A$8:$AA$\" &amp; LastRow), , xlYes).Name = _\n    \"GSATable\"\n.ListObjects(\"GSATable\").TableStyle = \"TableStyleLight20\"\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>As background: my main workbook has several macros and must be opened and kept in full screen and without the formula bar. I added a macro for workbook activate/deactivating so if users open another instance of Excel, it will work normally. One of the macros in my main book would pull up another workbook, fire the macros I need within it but at some point it gets caught up in the activate/deactivate macro, never actually finishing the macros that otherwise work without the activate/deactivate macro. So I decided to try and add this macro as I think it will be a good workaround.</p>\n"}, {"tags": ["vba", "excel", "sorting", "concatenation"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9094321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6e14eb80a042e7e602f51a253689e4?s=128&d=identicon&r=PG&f=1", "display_name": "S. Jacob", "link": "https://stackoverflow.com/users/9094321/s-jacob"}, "edited": false, "score": 0, "creation_date": 1514912450, "post_id": 47804278, "comment_id": 83103027, "body": "It took me some time to get back to this project but this helped greatly thank you! Thanks for providing explanation comments.With your help I was able to do 99% of what I needed though I had to modify it to accommodate different table sizes and I added another script to format the contents output with a carriage return. I do however have two questions. First is it possible to have the output data overwrite and replace the source table instead of making a new sheet? Second how can i join the value in &quot;C&quot; with the value in &quot;B&quot; using text like  &quot;and&quot; before the values of &quot;B&quot; are combined?"}, {"owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "reply_to_user": {"reputation": 1, "user_id": 9094321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6e14eb80a042e7e602f51a253689e4?s=128&d=identicon&r=PG&f=1", "display_name": "S. Jacob", "link": "https://stackoverflow.com/users/9094321/s-jacob"}, "edited": false, "score": 0, "creation_date": 1516476061, "post_id": 47804278, "comment_id": 83707025, "body": "I&#39;ve added another answer below as it&#39;s too long for a comment."}], "tags": [], "owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "is_accepted": false, "score": 0, "last_activity_date": 1513212121, "creation_date": 1513212121, "answer_id": 47804278, "question_id": 47800453, "link": "https://stackoverflow.com/questions/47800453/vba-concatenate-multiple-rows-based-on-x-value-while-identifying-duplicates-an/47804278#47804278", "title": "VBA - Concatenate multiple rows based on x value while identifying duplicates and sorting in cell values", "body": "<p>Below are 2 classes and some updates to your module that should take a you a long way towards solving the problem.  I hope you find it helpful and good luck.</p>\n\n<p>For your project you'll need to add a reference.  This is found in the VB Editor under <strong>Tools-> References</strong>.  When you click on this, the dialog box below is displayed.  You'll need to select the Microsoft Scripting Runtime.</p>\n\n<p>The solution below uses Scripting.Dictionary types to eliminate duplicates.</p>\n\n<p>To add a class to your project, in the VB Editor select item <strong>Insert->Class</strong>.  A new class dialog box appears, copy and past the first class below into this.  Over on the lower left, change the class name from class to clItem</p>\n\n<p><strong>Class clItem</strong></p>\n\n<pre><code>Option Explicit\n\nPublic ItemDate As Date         'Column A\nPublic Contents As String       'Column B\nPublic AddlContents As String   'Column C\nPublic ItemID As String         'Column D\nPublic Dept As String           'Column E\nPublic Keep2Date As Variant     'Column F\nPublic NumBoxes As Long         'Column G\n</code></pre>\n\n<p>Repeat the steps above and paste the code below into the new class.  Change the name from class to clPallet</p>\n\n<p><strong>Class clPallet</strong></p>\n\n<pre><code>Option Explicit\n\nPublic PalletNum As Long    'Column H\nPrivate pvItemDates As Scripting.Dictionary     'Used to hold unique item dates and no duplicates\nPrivate pvItemIds As Scripting.Dictionary       'Used to hold unique item ids and no duplicates\nPrivate pvItemCollection As Collection          'The collection of items on a pallet\nPrivate collectionKey As Long                   'Unique key value for the collection\nPrivate pvKeepForever As Boolean                'Boolean for when the value in column Keep2 Date = Forever and is not a date\n\nPrivate Sub Class_Initialize()\n    Set pvItemCollection = New Collection       'Initilize a new collection\n    Set pvItemDates = New Scripting.Dictionary  'Initilize a dictionary class to store the item dates\n    Set pvItemIds = New Scripting.Dictionary    'Initilize a dictionary class to store the item ids\n    collectionKey = 1                           'Initialize the key\n    pvKeepForever = False                       'Since the Keep2 Date column seems to have dates and text \"Forever\" we have\n                                                'deal with that condition\nEnd Sub\n\nPublic Sub AddItem(ByRef palletItem As clItem)\n    pvItemCollection.Add palletItem, CStr(collectionKey)  'add pallet item object to the collection and convert the collectionKey to a string\n    If UCase(palletItem.Keep2Date) = \"FOREVER\" Then pvKeepForever = True    'found text \"Forever\" in column Keep2 Date\n    If Not pvItemDates.Exists(palletItem.ItemDate) Then pvItemDates.Add palletItem.ItemDate, palletItem.ItemDate\n    If Not pvItemIds.Exists(palletItem.ItemID) Then pvItemIds.Add palletItem.ItemID, palletItem.ItemID\n\n    collectionKey = collectionKey + 1   'update the key to keep a unique value\nEnd Sub\n\nPublic Property Get ItemCollection() As Collection\n    Set ItemCollection = pvItemCollection   'return the collection\nEnd Property\n\n'**********************************************\n'*  The next set of methods flatten the rows of data into a single row\n'**********************************************\n\n'*************************************\n'*  This provides a sum of all boxes on the pallet\nPublic Function GetBoxCount() As Long\n    Dim item As clItem\n    Dim retVal As Long: retVal = 0\n    For Each item In pvItemCollection\n        retVal = retVal + item.NumBoxes\n    Next item\n    GetBoxCount = retVal\nEnd Function\n'***************************************\n'*  This takes the rows of contents and puts them\n'*  into a comma separated string\nPublic Function GetContents() As String\n    Dim item As clItem\n    Dim retVal As String\n    For Each item In pvItemCollection\n        retVal = ConcatStr(item.Contents, retVal)\n    Next item\n\n    GetContents = retVal\nEnd Function\n'************************************************\n'*  This takes the rows of Item Ids and puts them\n'*  into a comma separated string\nPublic Function GetItemIDs() As String\n    Dim Key As Variant\n    Dim retVal As String\n\n    Dim arrList As Object\n    Set arrList = CreateObject(\"System.Collections.ArrayList\")\n    For Each Key In pvItemIds.Keys\n        arrList.Add Key\n    Next Key\n    arrList.Sort\n\n    Dim sortedItem As Variant\n    For Each sortedItem In arrList\n        retVal = ConcatStr(CStr(sortedItem), retVal)\n    Next sortedItem\n\n    GetItemIDs = retVal\nEnd Function\n'************************************************\n'*  This takes the rows of Additional Contents and puts them\n'*  into a comma separated string\nPublic Function GetAddlContents() As String\n    Dim item As clItem\n    Dim retVal As String\n    For Each item In pvItemCollection\n        retVal = ConcatStr(item.AddlContents, retVal)\n    Next item\n\n    GetAddlContents = retVal\nEnd Function\n'************************************************\n'*  This takes the rows of Departments and puts them\n'*  into a comma separated string\nPublic Function GetDepartments() As String\n    Dim item As clItem\n    Dim retVal As String\n    For Each item In pvItemCollection\n        retVal = ConcatStr(item.Dept, retVal)\n    Next item\n\n    GetDepartments = retVal\nEnd Function\n'************************************************\n'*  This gets the last Keep2 Date and returns it\n'*  one per pallet\nPublic Function GetLatestDate() As Variant\n    Dim item As clItem\n    Dim retVal As Variant\n\n    If pvKeepForever Then\n        retVal = \"Forever\"\n    Else\n        retVal = DateValue(\"January 1, 1950\")   'Initilize the retVal with an old date\n        For Each item In pvItemCollection       'Loop thru the item objects looking for the latest date\n            If item.Keep2Date &gt; retVal Then     'if we find one that is further in the future than current\n                retVal = item.Keep2Date         'then set that as the latest date\n            End If\n        Next item\n    End If\n    GetLatestDate = retVal\n\nEnd Function\n'************************************************\n'*  This takes the rows of Item Dates and puts them\n'*  into a comma separated string\nPublic Function GetItemDates() As String\n    Dim retVal As String\n    Dim v As Variant\n    For Each v In pvItemDates.Keys\n        If retVal = \"\" Then\n            retVal = v\n        Else\n            retVal = retVal &amp; \", \" &amp; v\n        End If\n    Next v\n    GetItemDates = retVal\nEnd Function\n'************************************************\n'*  This private function concatenates a value on to an existing string\nPrivate Function ConcatStr(ByRef itemString As String, ByRef currentVal As String) As String\n    Dim retVal As String\n    If itemString = \"\" Then\n        retVal = currentVal\n    ElseIf currentVal = \"\" Then\n        retVal = itemString\n    Else\n        retVal = currentVal &amp; \", \" &amp; itemString\n    End If\n\n    ConcatStr = retVal\nEnd Function\n</code></pre>\n\n<p>For your module, which would be linked to your macro, replace your code with the following:</p>\n\n<p><strong>Update Module</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Const HeadingColA = \"Item Date\"\nPublic Const HeadingColB = \"Contents\"\nPublic Const HeadingColC = \"addtl cont\"\nPublic Const HeadingColD = \"Item ID\"\nPublic Const HeadingColE = \"Dept.\"\nPublic Const HeadingColF = \"Keep2 Date\"\nPublic Const HeadingColG = \"box#\"\nPublic Const HeadingColH = \"pallet\"\n\nPublic Const PalletDataCol = 8\n\nPublic Const TheTableRange = \"A1:H7\"\nPublic Const HeadingRowRange = \"A1:H1\"      'Heading Row\nPublic Const DataTableRange = \"A2:H7\"       'Headings are in row 1\nPublic Const TheSortRange = \"H2:H7\"\nPublic Const DataWorkSheetName = \"SourceData\"\nPublic Const TargetWorkSheetName = \"Transformed\"\n\n\nPublic Sub mergeCategoryValues()\n    'Declare a workbook variable and set it to the active workbook\n    Dim wb As Workbook\n    Set wb = ActiveWorkbook\n    'Declare a worksheet variable and set it to the data source worksheet\n    Dim srcWs As Worksheet\n    Set srcWs = wb.Sheets(DataWorkSheetName)\n\n    'Don't update the screen while this routine is running\n    Application.ScreenUpdating = False\n\n    'Declare a range that is the data range on the source worksheet\n    Dim dataRng As Range\n    Set dataRng = srcWs.Range(DataTableRange)\n    'Make the source worksheet the active sheet\n    srcWs.Activate\n    'Sort the range by the Pallet Column in this case H\n    SortTheRange TheSortRange, TheTableRange, srcWs\n\n    'Declare a variable for the destination worksheet\n    'and create the sheet if it doesn't exist\n    Dim destWs As Worksheet\n    If SheetExists(TargetWorkSheetName, wb) Then\n        Set destWs = wb.Sheets(TargetWorkSheetName)\n        destWs.Cells.Clear\n    Else\n        Set destWs = wb.Sheets.Add\n        destWs.Name = TargetWorkSheetName\n    End If\n\n    'Copy the headings from the source worksheet to the destination worksheet\n    WriteHeadings srcWs, destWs, HeadingRowRange\n\n    'Declare a pallet object of type clPallet (a user defined pallet class named clPallet)\n    Dim pallet As clPallet\n    Set pallet = New clPallet   'Instantiate the object\n    pallet.PalletNum = GetFirstPalletNumber(dataRng(RowIndex:=1, ColumnIndex:=PalletDataCol))\n\n    Dim palletItem As clItem    'Declare a palletItem object of type clItem\n    Dim dataRow As Range, dataCol As Range  'set up enumerators to loop thru rows and columns of data\n    Dim nextRow As Long: nextRow = 2    'counter to keep advancing the output row on the destination sheet\n    For Each dataRow In dataRng.Rows\n        If pallet.PalletNum &lt;&gt; dataRow.Value2(1, PalletDataCol) Then    'do we have new pallet?\n            WriteData destWs, pallet, nextRow       'yes, then write the current pallet to a row on the destination sheet\n            nextRow = nextRow + 1                   'update the output row\n            Set pallet = New clPallet               'get new pallet object\n            pallet.PalletNum = dataRow.Value2(1, PalletDataCol) 'assign the pallet number to the new pallet object\n        End If\n\n        Set palletItem = New clItem     'Instantiate a new pallet item object\n        Call AssignPalletItemValues(palletItem, dataRow, srcWs)\n        'add the palletItem object to the pallet collection contained in the\n        'pallet object\n        pallet.AddItem palletItem\n    Next dataRow\n\n    'one last write since we exited from the loop above when we reached the\n    'last datarow...but we didn't write out the final row of data\n    WriteData destWs, pallet, nextRow\n\n    'Turn screen updating back on\n    Application.ScreenUpdating = True\nEnd Sub\n'********************************************************************************************************\n'*  Private sub copies the headings fromt the source worksheet and writes them to the target worksheet\nPrivate Sub WriteHeadings(ByRef srcWs As Worksheet, ByRef tarWs As Worksheet, ByVal headingRng As String)\n    srcWs.Activate                  'Make the source worksheet the active sheet\n    Range(headingRng).Select        'Select the range based on the value in the parameter headingRng\n    Selection.Copy                  'Copy the selection to the clipboards\n    tarWs.Activate                  'Make the target worksheet the active sheet\n    Range(headingRng).Select        'Select the target range based on the value in the parameter headingRng\n    ActiveSheet.Paste               'Paste the values on the clipboard into the selected range on the target worksheet\n    'Set Column E (Keep 2 Date as a short date format\n    Columns(\"F:F\").Select               'Select column F\n    Application.CutCopyMode = False     'Not copying or cutting\n    Selection.NumberFormat = \"m/d/yyyy\" 'Set the date format\n    Range(\"A1\").Select\nEnd Sub\n'**************************************************************************\n'*  Private function gets the first pallet number from the target sheets column H\nPrivate Function GetFirstPalletNumber(ByRef c As Range) As Long\n    GetFirstPalletNumber = c.Value2\nEnd Function\n'************************************************************************************************\n'*  Private sub writes takes a Pallet class and writes out all the values on one row in the spreadsheet\nPrivate Sub WriteData(ByRef destWs As Worksheet, ByRef pallet As clPallet, ByVal nextRow As Long)\n    Dim palletItem As clItem\n\n    destWs.Range(\"A\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetItemDates        'Item date\n    destWs.Range(\"B\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetContents         'Contents, comma separated\n    destWs.Range(\"C\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetAddlContents     'Additional contents, comma separated\n    destWs.Range(\"D\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetItemIDs          'Item Id's comma separated\n    destWs.Range(\"E\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetDepartments      'Dept.\n    destWs.Range(\"F\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetLatestDate       'Keep 2 date\n    destWs.Range(\"G\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetBoxCount         'Box Count\n    destWs.Range(\"H\" &amp; Trim(CStr(nextRow))).Value2 = pallet.PalletNum           'Pallet Number\n\nEnd Sub\n'***********************************************************************************\n'*  private function checks if sheet exists\n'*      Returns True if sheet is in the workbook\n'*      Returns false if the sheet is not in the workbook\nPrivate Function SheetExists(shtName As String, Optional wb As Workbook) As Boolean\n    Dim sht As Worksheet\n\n     If wb Is Nothing Then Set wb = ThisWorkbook\n     On Error Resume Next\n     Set sht = wb.Sheets(shtName)\n     On Error GoTo 0\n     SheetExists = Not sht Is Nothing\nEnd Function\n'*************************************************************************************\n'*  private sub that adds the data from the source row to a pallet item object\nPrivate Sub AssignPalletItemValues(ByRef palletItem As clItem, ByRef srcRow As Range, ByRef srcWs As Worksheet)\n    Dim dataCol As Range\n    For Each dataCol In srcRow.Columns\n        Select Case srcWs.Cells(1, dataCol.Column).Value2\n            Case HeadingColA\n                palletItem.ItemDate = dataCol.Value2\n            Case HeadingColB\n                palletItem.Contents = dataCol.Value2\n            Case HeadingColC\n                palletItem.AddlContents = dataCol.Value2\n            Case HeadingColD\n                palletItem.ItemID = dataCol.Value2\n            Case HeadingColE\n                palletItem.Dept = dataCol.Value2\n            Case HeadingColF\n                palletItem.Keep2Date = dataCol.Value2\n            Case HeadingColG\n                palletItem.NumBoxes = dataCol.Value2\n        End Select\n    Next dataCol\nEnd Sub\n'***************************************************************************\n'*  private sub sorts the data range given by the parameter tableRange located\n'*  on the worksheet given by scrWs using the sorting criteria given by sortRange\nPrivate Sub SortTheRange(ByRef sortRange As String, ByRef tableRange As String, ByRef srcWs As Worksheet)\n    With srcWs.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=Range(sortRange), SortOn:=xlSortOnValues, _\n                              Order:=xlAscending, DataOption:=xlSortNormal\n        .SetRange Range(tableRange)\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "is_accepted": false, "score": 0, "last_activity_date": 1516476241, "creation_date": 1516476241, "answer_id": 48360205, "question_id": 47800453, "link": "https://stackoverflow.com/questions/47800453/vba-concatenate-multiple-rows-based-on-x-value-while-identifying-duplicates-an/48360205#48360205", "title": "VBA - Concatenate multiple rows based on x value while identifying duplicates and sorting in cell values", "body": "<p>My apologies for a delayed response to your question.  I\u2019ve been buried in other projects.</p>\n\n<p>Yes, you can overwrite the source data with the revised data, but I don\u2019t recommend doing that.  A best programming practice is to never overwrite source data. If something goes wrong you might not be able to get the original source and then it would be impossible to figure out what went wrong.  Many times your end user will ask to see the source data or you\u2019ll need it to prove that your output is correct based on what they gave you.</p>\n\n<p>Question 2 demonstrates the beauty of using a class object.</p>\n\n<p>You could simply add the following property to the <code>clItem</code> class:</p>\n\n<pre><code>Public Property Get ContentAndAddlContent()\n    If AddlContents = \"\" Then\n        ContentAndAddlContent = Contents\n    Else\n        ContentAndAddlContent = Contents &amp; \" and \" &amp; AddlContents\n    End If\nEnd Property\n</code></pre>\n\n<p>Add the following method to the <code>clPallet</code> Class.  I\u2019d add if after the methdol Get AddlContents</p>\n\n<pre><code>'************************************************\n'*  This takes the rows of Additional Contents and ands them with Content\n'*  into a comma separated string\nPublic Function GetAndedContents() As String\n     Dim item As clItem\n     Dim retVal As String\n     For Each item In pvItemCollection\n          retVal = ConcatStr(item.ContentAndAddlContent, retVal)\n     Next item\n\n     GetAndedContents = retVal\n End Function\n</code></pre>\n\n<p>Then update the  <code>Private Sub WriteData(ByRef destWs As Worksheet, ByRef pallet As clPallet, ByVal nextRow As Long)</code> as follows</p>\n\n<pre><code>'*******************************************************************\n'   Orginial Code - commented out\n'destWs.Range(\"B\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetContents         'Contents, comma separated\n'destWs.Range(\"C\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetAddlContents     'Additional contents, comma separated\n'**********************************************************************\n'   New Code for adding\nIf pallet.GetAddlContents = \"\" Then\n    destWs.Range(\"B\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetContents         'Contents, comma separated\nElse\n    destWs.Range(\"B\" &amp; Trim(CStr(nextRow))).Value2 = pallet.GetAndedContents    'Contents anded and comma separated\nEnd If\n</code></pre>\n\n<p>You could get fancy and use a constant at the top of the module that would let you change if you use the and or not.  Something like \u2018Public Const UseAnd = True` or get even fancier and have a sheet containing control parameters.</p>\n"}], "owner": {"reputation": 1, "user_id": 9094321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6e14eb80a042e7e602f51a253689e4?s=128&d=identicon&r=PG&f=1", "display_name": "S. Jacob", "link": "https://stackoverflow.com/users/9094321/s-jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516476241, "creation_date": 1513192011, "question_id": 47800453, "link": "https://stackoverflow.com/questions/47800453/vba-concatenate-multiple-rows-based-on-x-value-while-identifying-duplicates-an", "title": "VBA - Concatenate multiple rows based on x value while identifying duplicates and sorting in cell values", "body": "<p>Let me start by saying I have been digging on forum sites for a few days now before posting this question but nothing has quite worked the way i need it to.</p>\n\n<p>My situation is i have a 8 column table with a variable number of rows that I need combine according to x value in a selective and sorted way in preparation for a mail merge label.</p>\n\n<p><strong>Here's what I need to do</strong></p>\n\n<p><strong>1.</strong> Combine values in columns <strong>A</strong>,<strong>B</strong>,<strong>C</strong>,<strong>D</strong>, and <strong>F</strong> into one row for each unique value in <strong>H</strong></p>\n\n<p><strong>2.</strong> Either skip or remove duplicate values in <strong>A</strong>,<strong>B</strong>,<strong>C</strong>, and <strong>D</strong></p>\n\n<p><strong>3.</strong>\n    Column <strong>F</strong> needs to keep only the latest Date and should only have one value.</p>\n\n<p><strong>4.</strong> Column <strong>A</strong> needs to have each unique entry sorted in order oldest to newest. Column <strong>D</strong> should be sorted smallest to largest.</p>\n\n<p>I have a start but I cant figure out how to qualify what gets combined so there aren't duplicate values or how to sort the order certain column values are combined in. I'm a novice VBA coder so I'm probably not going about this the best way but is it even possible?</p>\n\n<p>My table data is pulled out of a much larger table on another sheet via macro. I also have another macro on this sheet to populate this table with similar data based on another criteria for a different merge so in cell formulas aren't a viable option to concatenate.</p>\n\n<p>Here's roughly what the table looks like:</p>\n\n<pre><code>0 |  A       |     B     |    C     |   D   |   E   |    F     | G  |  H   |\n1 |Item Date | Contents  |addtl cont|Item ID| Dept. |Keep2 Date|box#|pallet|\n2 |12/8/2017 | Item1     |          |CBE-32 | Dept. | Forever  |  6 |  16  |\n3 |12/8/2017 | Item2     |          |CBE-19 | Dept. |Dec 8 2019|  4 |  16  |\n4 |12/8/2017 | Item3     |          |CBE-32 | Dept. | Forever  |  3 |  16  |\n5 |12/8/2017 | Item4     |          |CBE-44 | Dept. |Dec 8 2022|  4 |  17  |\n6 |12/8/2017 | Item5     |          |CBE-107| Dept. |Feb 6 2018|  1 |  17  |\n7 |11/8/2017 | Item6     |  Item7   |CBE-19 | Dept. |Nov 8 2019|  6 |  17  |\n</code></pre>\n\n<p>I managed to adapt a macro to combine my rows together grouped by pallet number in \"H\".</p>\n\n<pre><code>    Sub mergeCategoryValues() \n    Dim lngRow As Long\n\n    With ActiveSheet\n        Dim columnToMatch As Integer: columnToMatch = 8 ' pallet number\n        Dim columnToConcatenate1 As Integer: columnToConcatenate1 = 1 'election date\n        Dim columnToConcatenate2 As Integer: columnToConcatenate2 = 2 'contents\n        Dim columnToConcatenate3 As Integer: columnToConcatenate3 = 3 'additional contents/dates\n        Dim columnToConcatenate4 As Integer: columnToConcatenate4 = 4 'DAS number\n        Dim columnToConcatenate5 As Integer: columnToConcatenate5 = 6 'retention date\n        Dim columnToSum As Integer: columnToSum = 7 'not working! should sum total boxes\n\n        lngRow = .Cells(65536, columnToMatch).End(xlUp).Row\n        .Cells(columnToMatch).CurrentRegion.Sort key1:=.Cells(columnToMatch), Header:=xlYes\n\n        Do\n            If .Cells(lngRow, columnToMatch) = .Cells(lngRow - 1, columnToMatch) Then\n                .Cells(lngRow - 1, columnToConcatenate1) = .Cells(lngRow - 1, columnToConcatenate1) &amp; Chr(10) &amp; .Cells(lngRow, columnToConcatenate1)\n                .Cells(lngRow - 1, columnToConcatenate2) = .Cells(lngRow - 1, columnToConcatenate2) &amp; Chr(10) &amp; .Cells(lngRow, columnToConcatenate2)\n                .Cells(lngRow - 1, columnToConcatenate3) = .Cells(lngRow - 1, columnToConcatenate3) &amp; Chr(10) &amp; .Cells(lngRow, columnToConcatenate3)\n                .Cells(lngRow - 1, columnToConcatenate4) = .Cells(lngRow - 1, columnToConcatenate4) &amp; Chr(10) &amp; .Cells(lngRow, columnToConcatenate4)\n                .Cells(lngRow - 1, columnToConcatenate5) = .Cells(lngRow - 1, columnToConcatenate5) &amp; Chr(10) &amp; .Cells(lngRow, columnToConcatenate5)\n                .Rows(lngRow).Delete\n            End If\n\n            lngRow = lngRow - 1\n        Loop Until lngRow = 1\n    'End With\nEnd Sub\n</code></pre>\n\n<p>What this leaves me with is a table like this:</p>\n\n<pre><code> 0 |  A       |     B     |    C     |   D   |   E   |    F     | G  |  H   |\n 1 |Item Date | Contents  |addtl cont|Item ID| Dept. |Keep2 Date|box#|pallet|\n   |12/8/2017 | Item1     |          |CBE-32 |       | Forever  |  6 |      |\n 2 |12/8/2017 | Item2     |          |CBE-19 | Dept. |Dec 8 2019|    |  16  |\n   |12/8/2017 | Item3     |          |CBE-32 |       | Forever  |    |      |\n   |12/8/2017 | Item4     |          |CBE-44 |       |Dec 8 2022|  4 |      |\n 3 |12/8/2017 | Item5     |          |CBE-107| Dept. |Feb 6 2018|    |  17  |\n   |11/8/2017 | Item6     |  Item7   |CBE-19 |       |Nov 8 2019|    |      |\n</code></pre>\n\n<p>What it <strong>should</strong> look like is this:</p>\n\n<pre><code>0 |  A       |     B     |    C     |   D   |   E   |    F     | G  |  H   |\n1 |Item Date | Contents  |addtl cont|Item ID| Dept. |Keep2 Date|box#|pallet|\n  |          | Item1     |          |CBE-19 |       |          |    |      |\n2 |12/8/2017 | Item2     |          |CBE-32 | Dept. | Forever  | 13 |  16  |\n  |          | Item3     |          |       |       |          |    |      |\n  |11/8/2017 | Item4     |          |CBE-19 |       |          |    |      |\n3 |12/8/2017 | Item5     |          |CBE-44 | Dept. |Dec 8 2022| 11 |  17  |\n  |          | Item6     |  Item7   |CBE-107|       |          |    |      |\n</code></pre>\n\n<p>Right now everything is set to concatenate with a carriage return but I will eventually like to change <strong>A</strong> and <strong>D</strong> to a \"<strong>,</strong>\" separator.\nColumn <strong>G</strong> should return the sum for the number of boxes combined according to the adapted code but that data field is not used in the merge so I'm not to worried about that.</p>\n"}, {"tags": ["excel", "vba", "for-loop", "dropdown"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513194818, "post_id": 47800444, "comment_id": 82563329, "body": "1) E1 to G1 i think you mean. 2) Why is dropdown a collection? Do you actually mean a combobox or a listbox etc? Or is this a data validation list?  3) Should there be three of these? One for each team. Sorry if i have misunderstood."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513195141, "post_id": 47800444, "comment_id": 82563495, "body": "You can loop the three columns populating separate arrays if 1 is present in column with value that is offset appropriate number of columns to left. You can then use these arrays to populate lists. For example, if you are doing data validation you can create the validation list using  .Add Type:=xlValidateList, Formula1:=Join(myArray, &quot;,&quot;) . See here: <a href=\"http://www.vbaexpress.com/forum/showthread.php?26528-Drop-down-validation-using-array\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/&hellip;</a>"}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513202243, "post_id": 47800444, "comment_id": 82566804, "body": "I actually mean GG1 :) The three teams are just an example. There is data up till GG1. You&#39;re right, I mean a combobox. Not sure what you mean by data validation list."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513203256, "post_id": 47800444, "comment_id": 82567191, "body": "Is there a total number of possible teams or can it vary? Likewise, is there a set number of possible ids and are they always present?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513203409, "post_id": 47800444, "comment_id": 82567253, "body": "If using arrays than add an Is in array test before adding items to ensure unique ids stored."}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513241013, "post_id": 47800444, "comment_id": 82579351, "body": "I&#39;ll explore the ListFillRange property. The teams in the Dropdown sheet will typically be the same as the ones in the individual sheets but they can vary. The number of ID&#39;s vary across the five individual sheets and the 1&#39;s don&#39;t follow a specific pattern."}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513249856, "post_id": 47800444, "comment_id": 82585001, "body": "I didn&#39;t answer question 2) from the first comment correctly. The dropdown list I want to apply is a &quot;In-cell dropdown&quot; similar to the one found in the Data Validation settings."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513256550, "post_id": 47800444, "comment_id": 82589378, "body": "Then my second comment holds true. Are there fixed numbers of teams and ids?"}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513260606, "post_id": 47800444, "comment_id": 82592036, "body": "Nope. Number of teams and ID&#39;s vary across individual sheets."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513260665, "post_id": 47800444, "comment_id": 82592080, "body": "I mean... is there a maximum number of teams or ids or does one always have to loop all sheets to collect all possible entries?"}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513260728, "post_id": 47800444, "comment_id": 82592122, "body": "I have to loop across all sheets because the number of teams and ID&#39;s vary. I think I have a solution ready. The looping across sheets causes some problems. Should I create a new post with the revised code?"}], "owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513191971, "creation_date": 1513191971, "question_id": 47800444, "link": "https://stackoverflow.com/questions/47800444/loop-through-sheets-and-add-values-to-dropdown-list-vba", "title": "Loop through sheets and add values to Dropdown list - VBA", "body": "<p><strong>Goal</strong></p>\n\n<p>I would like to loop through five sheets and populate a dropdown list in a sixth sheet based on some requirements.</p>\n\n<p><strong>Problem</strong></p>\n\n<p>I don't know how to populate the dropdown list, make them dynamic and loop through the five sheets.</p>\n\n<p><strong>Description</strong></p>\n\n<p>In the sixth sheet (Dropdown Sheet), column E contains names which I would like to compare to the first row (E1:GG1) in the five sheets. Each column has a bunch of 1's. </p>\n\n<p>If there is a match between a name in column E (Dropdown Sheet) and a name in a row (one of the five sheets) AND there's a '1' in the column for that row, the dropdown list should be populated with the ID in column A. </p>\n\n<p><strong>Desired output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xwJHd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xwJHd.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/IMlY1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IMlY1.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub ValuesInDropdownList()\n\n    Dim TeamSource As Range, PersonSource As Range, r As Range, csString As String\n    Dim PersonCell As Range, TeamCell As Range\n    Dim Dropdown As Collection\n    Dim i As Integer\n    Dim lastRow As Integer\n\n    Set TeamSource = Sheets(\"Dropdown Sheet\").Range(\"E10:E100\")\n    Set PersonSource = Sheets(\"Sheet1\").Range(\"E1:GG1\")\n    Set Dropdown = New Collection\n\n    On Error Resume Next\n\n        For Each PersonCell In PersonSource\n            v = PersonCell.Value\n            Debug.Print (v)\n            With PersonSource\n                lastRow = .Cells(.Rows.Count, PersonCell.Columns.Count).End(xlUp).Row\n            Debug.Print (lastRow)\n            End With\n                If v &lt;&gt; \"\" Then\n                    For Each TeamCell In TeamSource\n                        Debug.Print (TeamCell)\n                        If PersonCell = TeamCell Then\n                        intValueToFind = 1\n                            For i = 1 To lastRow\n                                If PersonCell.Offset(i, 0) = intValueToFind Then\n                                Debug.Print (PersonCell.Offset(i, -4))\n                                    Dropdown.Add v, CStr(v)\n                                End If\n                            Next i\n                        End If\n                    Next TeamCell\n                End If\n        Next PersonCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513192526, "post_id": 47800360, "comment_id": 82562202, "body": "what error message do you get and on which line?"}, {"owner": {"reputation": 49, "user_id": 3047983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b362abe9d7040d0afce9dad1e5b00e79?s=128&d=identicon&r=PG&f=1", "display_name": "user3047983", "link": "https://stackoverflow.com/users/3047983/user3047983"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513192775, "post_id": 47800360, "comment_id": 82562336, "body": "It just gives me a 400 error message. It seems like my problem is with                                                                                                    RangeName = LCase(Left(cell.Value, 7)) . I know It sets the variable because I had it paste the output in a different cell, but for some reason it wont let me pass that variable into the range name"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513193332, "post_id": 47800360, "comment_id": 82562602, "body": "You are trying to refer to <code>cell</code> outside the loop this is why the error."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1513193869, "post_id": 47800360, "comment_id": 82562873, "body": "^^^ cell becomes nothing after the For Each loop"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1513193953, "post_id": 47800360, "comment_id": 82562909, "body": "Why do you repeat the lines outside the loop that are also inside?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513194888, "post_id": 47800360, "comment_id": 82563362, "body": "You&#39;ll run into issues if any cells contains errors, or if any cell&#39;s contents is less than 7 characters. Other problems are to be expected if the <code>ActiveSheet</code> isn&#39;t the expected/intended worksheet, and if the names are already defined. And without <code>Option Explicit</code> specified you&#39;ll quickly run into other problems, harder to diagnose. Always use <code>Option Explicit</code>."}, {"owner": {"reputation": 49, "user_id": 3047983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b362abe9d7040d0afce9dad1e5b00e79?s=128&d=identicon&r=PG&f=1", "display_name": "user3047983", "link": "https://stackoverflow.com/users/3047983/user3047983"}, "edited": false, "score": 0, "creation_date": 1513195843, "post_id": 47800360, "comment_id": 82563887, "body": "I had those in there originally for the last range. I know its kind of a messy way of doing it but it was the best I could think of as I researched lol. Thank you guys!"}, {"owner": {"reputation": 49, "user_id": 3047983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b362abe9d7040d0afce9dad1e5b00e79?s=128&d=identicon&r=PG&f=1", "display_name": "user3047983", "link": "https://stackoverflow.com/users/3047983/user3047983"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513195872, "post_id": 47800360, "comment_id": 82563904, "body": "Thanks for the advice @Mat&#39;sMug . I see how those things could become an issue once you start changing the data/ spreadsheet."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513194977, "post_id": 47801113, "comment_id": 82563404, "body": "<code>If rngStart Then</code> reads like a hack. The implicit <code>Long</code>-to-<code>Boolean</code> conversion might not be obvious to a rookie here."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513195045, "post_id": 47801113, "comment_id": 82563436, "body": "@Mat&#39;sMug are you saying I should <code>rngstart&gt;0</code> or just explain it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513195132, "post_id": 47801113, "comment_id": 82563488, "body": "I&#39;d go with <code>If rngStart &gt; 0 Then</code>, yeah. Otherwise great answer - all that&#39;s missing is an <code>IsError</code> and length check on the cell values, to avoid blowing up when <code>#N&#47;A</code> is encountered, or if <code>KitKat</code> is in there."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513195284, "post_id": 47801113, "comment_id": 82563589, "body": "But the match will not find an error and I am only doing the Left on the cell the match returned.  I do not understand how <code>KitKat</code> would be a problem, this is a true question, as I am not seeing it. @Mat&#39;sMug"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513195421, "post_id": 47801113, "comment_id": 82563662, "body": "Nevermind, VBA is happy with taking the 7 leftmost characters of a 6-character string. C# wouldn&#39;t be ;-)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1513195585, "post_id": 47801113, "comment_id": 82563752, "body": "@Mat&#39;sMug that&#39;s why I specifically used <code>kittes</code> just to make sure.  I almost did the whole <code>IIF(LEN()&lt;7,LEN(),7)</code> before remembering."}, {"owner": {"reputation": 49, "user_id": 3047983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b362abe9d7040d0afce9dad1e5b00e79?s=128&d=identicon&r=PG&f=1", "display_name": "user3047983", "link": "https://stackoverflow.com/users/3047983/user3047983"}, "edited": false, "score": 0, "creation_date": 1513195739, "post_id": 47801113, "comment_id": 82563828, "body": "wow that worked perfectly! Ok so that answer is a lot better written than what I had originally...Definitely gives me a lot to look at and learn. (Still super new to VBA but learning a bit every day) Thank you so much for taking the time to do this. Everyone&#39;s help is greatly appreciated. Thanks again!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513195768, "post_id": 47801113, "comment_id": 82563847, "body": "why does Application.WorksheetFunction.Match(&quot;zzz&quot; .... find the last row? i have seen it used elsewhere and i can guess it is for text and to do with z being the last letter of the alphabet but i am still unsure why? Same as 1e99 for numbers? Sorry if a dumb question."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513195879, "post_id": 47801113, "comment_id": 82563909, "body": "@QHarr stepped into a meeting will come back after and explain"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513198848, "post_id": 47801113, "comment_id": 82565338, "body": "@QHarr MATCH with the missing third argument tries to find where the lookup value is &gt;= and &lt; the next value in the range.  By putting impossibly big values to search for <code>&quot;zzz&quot;</code> for text and <code>1e+99</code> for numbers it goes through the list and never finds anyone that is greater than the search value, so it automatically returns the last value in the list."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513199000, "post_id": 47801113, "comment_id": 82565396, "body": "@ScottCraner Many thanks for explaining. I have used the 1e+99 without ever questioning and since coming onto SO have seen &quot;zzz&quot; being used."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513199191, "post_id": 47801113, "comment_id": 82565497, "body": "@QHarr &quot;zzz&quot; will return the last used Text cell and 1e+99 the last used number cell.  To find the true last if they are mixed one would need to use <code>max(match(&quot;zzz&quot;,...),match(1e+99,...)</code> If it is unkown an could be either or and one needs to wrap each match in iferror: <code>IFERROR(MATCH(&quot;zzz&quot;,...),0)</code> inside the max to deal with if there are only numbers but could have text."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513199295, "post_id": 47801113, "comment_id": 82565539, "body": "@ScottCraner Thank you. That has gone straight into my bag of tricks so to speak."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1513195617, "last_edit_date": 1513195617, "creation_date": 1513194753, "answer_id": 47801113, "question_id": 47800360, "link": "https://stackoverflow.com/questions/47800360/vba-to-set-cell-contents-as-named-range-name/47801113#47801113", "title": "VBA to set cell contents as Named range name", "body": "<p>This assumes that you data is similar to your last question.</p>\n\n<p>It uses Match to find each <code>\"Kit...\"</code> saving a few iterations:</p>\n\n<pre><code>Sub DefineRanges()\nDim rngStart As Long\nDim RangeName As String\nDim col As Long\nDim PreFx As String\n\ncol = 1 'change to the column number you need\nPreFx = \"kat\" 'change to the prefix you are looking for\n\nWith Worksheets(\"Sheet7\") 'change to your sheet\n    On Error Resume Next\n        rngStart = Application.WorksheetFunction.Match(PreFx &amp; \"*\", .Columns(col), 0)\n    On Error GoTo 0\n    If rngStart &gt; 0 Then\n        Do\n            i = 0\n            On Error Resume Next\n                i = Application.WorksheetFunction.Match(PreFx &amp; \"*\", .Range(.Cells(rngStart + 1, col), .Cells(.Rows.Count, col)), 0) + rngStart\n            On Error GoTo 0\n            If i &gt; 0 Then\n                RangeName = LCase(Left(.Cells(rngStart, col).Value, 7))\n                ActiveWorkbook.names.Add name:=RangeName, RefersToLocal:=.Range(.Cells(rngStart, col), .Cells(i - 1, col + 2))\n                rngStart = i\n            Else 'no more \"kit...\" so find the last row with data and use that\n                i = Application.WorksheetFunction.Match(\"zzz\", .Columns(col))\n                RangeName = LCase(Left(.Cells(rngStart, 1).Value, 7))\n                ActiveWorkbook.names.Add name:=RangeName, RefersToLocal:=.Range(.Cells(rngStart, col), .Cells(i - 1, col + 2))\n\n            End If\n        Loop While i &lt; Application.WorksheetFunction.Match(\"zzz\", .Columns(col))\n    End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gCJfa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gCJfa.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 49, "user_id": 3047983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b362abe9d7040d0afce9dad1e5b00e79?s=128&d=identicon&r=PG&f=1", "display_name": "user3047983", "link": "https://stackoverflow.com/users/3047983/user3047983"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1222, "favorite_count": 0, "accepted_answer_id": 47801113, "answer_count": 1, "score": 0, "last_activity_date": 1610230939, "creation_date": 1513191680, "last_edit_date": 1513195583, "question_id": 47800360, "link": "https://stackoverflow.com/questions/47800360/vba-to-set-cell-contents-as-named-range-name", "title": "VBA to set cell contents as Named range name", "body": "<p>I am trying to set the first 7 characters of the first cell in a range to be a named ranges name IF the cell begins with the word \"kit\". </p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Sub DefineRanges()\nDim rngStart As Range\nSet rngStart = Range(\"A1\")\nDim LastRow As Integer\nDim RangeName As String\n\nFor Each cell In Range(\"A2:A7\")\n    If LCase(Left(cell.Value, 3)) = \"kit\" Then\n\n        RangeName = LCase(Left(cell.Value, 7))\n\n        ActiveWorkbook.Names.Add _\n            Name:=RangeName, _\n            RefersToLocal:=Range(rngStart.Address &amp; \":C\" &amp; cell.Row - 1)\n        Set rngStart = Range(\"A\" &amp; cell.Row)\n\n    End If\n    LastRow = cell.Row\nNext\nRangeName = LCase(Left(cell.Value, 7))\n\nActiveWorkbook.Names.Add _\n    Name:=RangeName, _\n    RefersToLocal:=Range(rngStart.Address &amp; \":C\" &amp; LastRow)\nEnd Sub\n</code></pre>\n\n<p>Essentially I want it to look through my overall Range, find any cells that begin with the word \"kit\", create a named range that goes from that cell until the next cell that begins with \"kit\", and assign the first 7 characters of that cell to be the ranges name. So far I am able to get it to create the ranges, but I run into issues when I try to pass the contents of the cell into the range name. Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1513194901, "post_id": 47800342, "comment_id": 82563366, "body": "If you want only exact matches then I think your criteria need to be like &quot;=mmiller2&quot; and not just &quot;mmiller2&quot;.  Edit: to avoid issues with the &quot;=&quot; you will likely need to use a formula such as <code>=&quot;=mmiller2&quot;</code>   <a href=\"https://superuser.com/questions/1155570/advanced-filter-exact-match\" title=\"advanced filter exact match\">superuser.com/questions/1155570/advanced-filter-exact-match</a>"}, {"owner": {"reputation": 31, "user_id": 7787020, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9e59cc5dd201c1d8a6f22312f18afcad?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/7787020/justin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513196919, "post_id": 47800342, "comment_id": 82564415, "body": "I&#39;ve seen that, but is it possible to use if my CriteriaRange is a range of cells?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513202549, "post_id": 47800342, "comment_id": 82566936, "body": "Tested this and it does work.  You just need your values to have a &quot;=&quot;..."}, {"owner": {"reputation": 31, "user_id": 7787020, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9e59cc5dd201c1d8a6f22312f18afcad?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/7787020/justin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513272034, "post_id": 47800342, "comment_id": 82599667, "body": "How did you accomplish this?  I tried changing the value in the field to =mmiller2 and &quot;=mmiller2&quot; and neither seemed to work."}, {"owner": {"reputation": 31, "user_id": 7787020, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9e59cc5dd201c1d8a6f22312f18afcad?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/7787020/justin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513614070, "post_id": 47800342, "comment_id": 82710192, "body": "Got it, for some reason the values were handled differently whether they were added manually or via vba.  Thank you."}], "owner": {"reputation": 31, "user_id": 7787020, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9e59cc5dd201c1d8a6f22312f18afcad?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/7787020/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 919, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513613964, "creation_date": 1513191633, "last_edit_date": 1513613964, "question_id": 47800342, "link": "https://stackoverflow.com/questions/47800342/advanced-filter-exact-values", "title": "Advanced filter exact values", "body": "<p>I'm having trouble advanced filtering a sheet using a list of userIDs grabbed from another sheet.  The code works, but a problem arises when I have 2 userIDs that start with the same characters.  For example, if one of the users in my list is mmiller2, my filter also includes mmiller21.  Is there a simple way to adapt the code below to filter exact values from the UserID list?  Thanks!</p>\n\n<pre><code>'   Filter data by userID\nlastRow = Sheets(\"Users\").Cells(Rows.Count, 1).End(xlUp).Row\nSheets(\"Data\").Columns(\"C:C\").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:= _\nSheets(\"Users\").Range(\"A1:A\" &amp; lastRow), Unique:=False\n</code></pre>\n\n<p><strong>Edit with solution:</strong></p>\n\n<p>I ended up using a \"helper\" column to accomplish this.  Interestingly, during testing when I manually entered values in the helper column in this format: =\"=mmiller\" it worked, but translating that into vba using this did not work:</p>\n\n<pre><code>Sheets(\"Users\").Range(\"A2:A\" &amp; lastRow).FormulaR1C1 = \"=CONCATENATE(\"\"=\"\",CHAR(34),\"\"=\"\",RC[1],CHAR(34))\"\n</code></pre>\n\n<p>When I looked at the output the cell displayed the actual formula of =\"=mmiller\" so I just put the =mmiller in the cell using vba and that worked.</p>\n\n<p>Working code:</p>\n\n<pre><code>'   Add Username helper column for EXACT username filtering\nSheets(\"Users\").Columns(\"A:A\").Insert Shift:=xlToRight\nSheets(\"Users\").Range(\"A1\").FormulaR1C1 = \"UserID\"\nlastRow = Sheets(\"Users\").Cells(Rows.Count, 2).End(xlUp).Row\nSheets(\"Users\").Range(\"A2:A\" &amp; lastRow).FormulaR1C1 = \"=CONCATENATE(\"\"=\"\",RC[1])\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513189986, "post_id": 47799529, "comment_id": 82560922, "body": "<a href=\"https://stackoverflow.com/q/10714251/1188513\">Obligatory link for macro-recorder code</a>"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "edited": false, "score": 0, "creation_date": 1513190011, "post_id": 47799849, "comment_id": 82560934, "body": "Thanks for this; how would I incorporate your code in my existing VBA as the Macro I&#39;m trying to create includes inserting new columns, new column headers and there are 5 different formulas being inserted"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "edited": false, "score": 0, "creation_date": 1513190420, "post_id": 47799849, "comment_id": 82561140, "body": "With the data provided, it is quite hard to tell how to do this exactly. Hence the general explanation. Also because it is mostly a recorded macro it is a bit harder to decipher what actually happens."}], "tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": false, "score": 0, "last_activity_date": 1513190047, "last_edit_date": 1513190047, "creation_date": 1513189671, "answer_id": 47799849, "question_id": 47799529, "link": "https://stackoverflow.com/questions/47799529/paste-method-of-worksheet-class-failed-for-formulas-pasted-from-separate-documen/47799849#47799849", "title": "Paste Method Of Worksheet Class Failed for formulas pasted from separate document", "body": "<p>Yes, you can embed formulae in VBA by using the <code>Range.Formula</code> property explained <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formula-property-excel\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>For example:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1).Formula = \"=SUM(A2:A101)\"\n</code></pre>\n\n<p>The string can be any formula, and can consist of various parts to include VBA variables.</p>\n\n<p>For example:</p>\n\n<pre><code>Sub writeFormula()\n    Dim i As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        For i = 1 To 100\n            .Cells(i, 1).Formula = \"=SUM(\" &amp; .Range(.Cells(i, 2), .Cells(i, 20)).Address &amp; \")\"\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This writes the formula <code>=SUM($B$1:$T$1)</code> in cell A1 and <code>=SUM($B$2:$T$2)</code> in A2 and so on all the way down to <code>=SUM($B$100:$T$100)</code> in cell A100.</p>\n"}], "owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513190047, "creation_date": 1513188205, "question_id": 47799529, "link": "https://stackoverflow.com/questions/47799529/paste-method-of-worksheet-class-failed-for-formulas-pasted-from-separate-documen", "title": "Paste Method Of Worksheet Class Failed for formulas pasted from separate document", "body": "<p>I am new to Macros/VBA; I run regular analysis on a constantly updating spreadsheet and wanted to practice developing macros for a process that is very repetitive. I've gone through to record a Macro and I'm getting the Paste Method error. VBA code is below. I am copying formulas from another document; can I embed the formulas directly in the VBA code to avoid the paste error altogether?</p>\n\n<pre><code>Sub SLA()\n'\n' SLA Macro\n'\n\n'\n    Range(\"Table_Tracker[[#Headers],[Docs]]\").Select\n    Selection.Copy\n    Range(\"Table_Tracker[#All]\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets.Add After:=Sheets(Sheets.Count)\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Columns(\"N:R\").Select\n    Application.CutCopyMode = False\n    Selection.NumberFormat = \"m/d/yyyy\"\n    Columns(\"S:S\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"S1\").Select\n    ActiveCell.FormulaR1C1 = \"1 Day SLA\"\n    Columns(\"T:T\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"T1\").Select\n    ActiveCell.FormulaR1C1 = \"3 Day SLA\"\n    Columns(\"U:U\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    ActiveCell.FormulaR1C1 = \"Prepare EDD\"\n    Columns(\"V:V\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    ActiveCell.FormulaR1C1 = \"Analyze EDD\"\n    Columns(\"W:W\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"W1\").Select\n    ActiveCell.FormulaR1C1 = \"Case Completion\"\n    Range(\"A1\").Select\n    ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$1:$AK$1030\"), , xlYes).Name _\n        = \"Table6\"\n    Range(\"Table6[#All]\").Select\n    ActiveWindow.ScrollColumn = 2\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 4\n    ActiveWindow.ScrollColumn = 5\n    ActiveWindow.ScrollColumn = 6\n    ActiveWindow.ScrollColumn = 7\n    ActiveWindow.ScrollColumn = 8\n    ActiveWindow.ScrollColumn = 9\n    Range(\"S2\").Select\n    ActiveSheet.Paste\n    Range(\"T2\").Select\n    ActiveSheet.Paste\n    Range(\"U2\").Select\n    ActiveSheet.Paste\n    Range(\"V2\").Select\n    ActiveSheet.Paste\n    Range(\"W2\").Select\n    ActiveSheet.Paste\n\nEnd SubSub SLA()\n</code></pre>\n\n<p>The error appears in the line after Range(\"S2\")</p>\n"}, {"tags": ["c#", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7486138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54b3a8f31ab0cfe18c959f36de7b1aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Algorythm44", "link": "https://stackoverflow.com/users/7486138/algorythm44"}, "edited": false, "score": 0, "creation_date": 1513188622, "post_id": 47799209, "comment_id": 82560330, "body": "Well now I feel stupid I thought format rows was for highlighting and such (which I still need to be available) thanks"}, {"owner": {"reputation": 4956, "user_id": 5762332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhBOT.jpg?s=128&g=1", "display_name": "Magnetron", "link": "https://stackoverflow.com/users/5762332/magnetron"}, "reply_to_user": {"reputation": 33, "user_id": 7486138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54b3a8f31ab0cfe18c959f36de7b1aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Algorythm44", "link": "https://stackoverflow.com/users/7486138/algorythm44"}, "edited": false, "score": 0, "creation_date": 1513188830, "post_id": 47799209, "comment_id": 82560420, "body": "@Algorythm44 if I&#39;m not mistaken, highlighting and such are cell level operations (even if you do in an entire row or column), so thats probably in the format cell argument."}], "tags": [], "owner": {"reputation": 4956, "user_id": 5762332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhBOT.jpg?s=128&g=1", "display_name": "Magnetron", "link": "https://stackoverflow.com/users/5762332/magnetron"}, "is_accepted": true, "score": 0, "last_activity_date": 1513186874, "creation_date": 1513186874, "answer_id": 47799209, "question_id": 47798913, "link": "https://stackoverflow.com/questions/47798913/c-excel-hide-and-lock-rows/47799209#47799209", "title": "C# excel hide and lock rows", "body": "<p>In your <code>Protect</code> method, the format rows argument must be set to <code>false</code> and not <code>true</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7486138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54b3a8f31ab0cfe18c959f36de7b1aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Algorythm44", "link": "https://stackoverflow.com/users/7486138/algorythm44"}, "edited": false, "score": 0, "creation_date": 1513605173, "post_id": 47868824, "comment_id": 82704871, "body": "Did you even read the question? I already have the .Protect() method in my example code it just wasn&#39;t working how I expected it to, and it has already been pointed out that I got one of the arguments mixed up. (also in your example it doesn&#39;t even have the arguments which I would assume would default to the wrong values that I need)"}], "tags": [], "owner": {"reputation": 121, "user_id": 6175225, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Tk5wj.png?s=128&g=1", "display_name": "Babulal", "link": "https://stackoverflow.com/users/6175225/babulal"}, "is_accepted": false, "score": 0, "last_activity_date": 1513601156, "creation_date": 1513601156, "answer_id": 47868824, "question_id": 47798913, "link": "https://stackoverflow.com/questions/47798913/c-excel-hide-and-lock-rows/47868824#47868824", "title": "C# excel hide and lock rows", "body": "<p>Here is the code to Protect and Hide an Excel sheet.\nUse the required Namespaces as below</p>\n\n<pre><code>using System;\nusing System.Data;\nusing Microsoft.CSharp;\nusing System.Collections;\nusing Excel=Microsoft.Office.Interop.Excel;\n</code></pre>\n\n<p>Initialize the Excel Application, Filepath is an string variable containing password</p>\n\n<pre><code>string FilePath = @\"C:\\Filename.xlsx\";\nstring Password = \"12345\";\nExcel.Application ExcelApp = new Excel.Application();   // Initialize Excel Application\nExcelApp.DisplayAlerts = false;            \nExcel.Workbook WB = ExcelApp.Workbooks.Open(FilePath);  // Initialize Excel Workbook\n</code></pre>\n\n<p>Then hide the sheet by using the below code, <strong>toHide</strong> in this code is an Arraylist which contains the list of sheets that are required to Hide.</p>\n\n<pre><code> foreach (Excel.Worksheet Worksheet in WB.Worksheets)\n        {\n        if (toHide.Contains(Worksheet.Name))\n            {\n                ((Excel.Worksheet)WB.Worksheets[Worksheet.Name]).Visible = Excel.XlSheetVisibility.xlSheetHidden;\n            }\n        }\n</code></pre>\n\n<p>To protect the sheet, Here is the code; <strong>toProtect</strong> here is an Arraylist that contains the sheetnames that are required to protect. </p>\n\n<pre><code> ExcelApp.Visible = true;\n        foreach (Excel.Worksheet Worksheet in WB.Worksheets)\n        {\n            if (toProtect.Contains(Worksheet.Name))\n            {\n                ((Excel.Worksheet)WB.Worksheets[Worksheet.Name]).Protect(Password);\n            }\n        }\n        //WB.Save();\n        ExcelApp.Visible = false;\n</code></pre>\n\n<p>Please let me know if this helps.</p>\n"}], "owner": {"reputation": 33, "user_id": 7486138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54b3a8f31ab0cfe18c959f36de7b1aa7?s=128&d=identicon&r=PG&f=1", "display_name": "Algorythm44", "link": "https://stackoverflow.com/users/7486138/algorythm44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2286, "favorite_count": 0, "accepted_answer_id": 47799209, "answer_count": 2, "score": 3, "last_activity_date": 1513601156, "creation_date": 1513185754, "last_edit_date": 1513186423, "question_id": 47798913, "link": "https://stackoverflow.com/questions/47798913/c-excel-hide-and-lock-rows", "title": "C# excel hide and lock rows", "body": "<p>Recently I have been converting a project from VBA to C# but I have run across an issue with .Hidden(), .Locked(), and .Protect()</p>\n\n<p>In the VBA implementation if I hide(rows)->lock->protect then I cannot unhide the rows (as intended), but in the C# implementation if I hide(rows)->lock->protect the rows can be unhidden (highlight rows, right click, unhide)</p>\n\n<p>Is there something I am missing, or is there a different way that the C# version needs to be written to produce the same result (rows cannot be unhidden) as the VBA version?</p>\n\n<p>I have simplified the code to these short snippets that reproduce the results.\nBoth versions create a new workbook, modify a cell, hide-lock-protect rows, and save/close the workbook.</p>\n\n<p>C# version:</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>using Excel = Microsoft.Office.Interop.Excel;\n...\n\nprivate void button1_Click(object sender, EventArgs e)\n{\n\n    Excel.Application ex = new Excel.Application();\n    Excel.Workbooks Books = ex.Workbooks;\n\n\n    //create and save the output workbook (so only .save() needs to be called later)\n    Excel.Workbook OutputBook = Books.Add();\n    OutputBook.SaveAs(\"C:\\\\TestingFolder\\\\Outputbook.xlsm\", Excel.XlFileFormat.xlOpenXMLWorkbookMacroEnabled);\n\n    //write secret stuff\n    OutputBook.Sheets[1].Cells[15,15] = \"Stuff\";\n\n    //hide and lock rows around secret stuff\n    OutputBook.Sheets[1].Range[\"10:20\"].EntireRow.Hidden = true;\n    OutputBook.Sheets[1].Range[\"10:20\"].EntireRow.Locked = true;\n\n\n    //protect the sheet with a bad password\n    OutputBook.Sheets[1].Protect(\n                                    \"SomePassword123\",//password\n                                    false,  //drawing objects\n                                    true,   //Contents\n                                    false,  //scenarios\n                                    false,  //user interface\n                                    true,   //format cells\n                                    true,   //format columns\n                                    true,   //format rows\n                                    false,  //insert columns\n                                    false,  //insert rows\n                                    true,   //insert hyperlinks\n                                    false,  //delete columns\n                                    false,  //delete rows\n                                    true,   //allow sorting\n                                    true,   //allow filtering\n                                    true    //allow pivot tables\n                                );\n\n\n    //save and close output workbook\n    OutputBook.Save();\n    OutputBook.Close(false);\n\n\n    //-----general cleanup start-----\n    Books.Close();\n    ex.Quit();\n\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(OutputBook);\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(Books);\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(ex);\n\n    OutputBook = null;\n    Books = null;\n    ex = null;\n\n    GC.Collect();\n    //-----general cleanup end-----\n\n\n    //show message that the task completed\n    MessageBox.Show(\"done\");\n\n}\n</code></pre>\n\n<p>and the VBA version:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n\n    'create and save the output workbook (so only .save() needs to be called later)\n    Dim OutputBook As Workbook\n    Set OutputBook = Workbooks.Add\n    Call OutputBook.SaveAs(\"C:\\TestingFolder\\Outputbook.xlsm\", ThisWorkbook.FileFormat)\n\n    'write secret stuff\n    OutputBook.Sheets(1).Cells(15, 15) = \"Stuff\"\n\n    'hide and lock rows around secret stuff\n    OutputBook.Sheets(1).Range(\"10:20\").EntireRow.Hidden = True\n    OutputBook.Sheets(1).Range(\"10:20\").EntireRow.Locked = True\n\n    'protect the sheet with a bad password\n    OutputBook.Sheets(1).Protect Password:=\"SomePassword123\", _\n                                DrawingObjects:=False, _\n                                Contents:=True, _\n                                Scenarios:=False, _\n                                AllowFormattingCells:=True, _\n                                AllowInsertingHyperlinks:=True, _\n                                AllowSorting:=True, _\n                                AllowFiltering:=True, _\n                                AllowUsingPivotTables:=True\n\n    'save and close output workbook\n    Call OutputBook.Save\n    Call OutputBook.Close\n\n    'show message that the task completed\n    MsgBox \"done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1513185830, "post_id": 47798803, "comment_id": 82558823, "body": "Is this dropdown you mention from Data Validation or a Form listbox or even an ActiveX listbox?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1513185975, "post_id": 47798803, "comment_id": 82558907, "body": "Remove the last line of code. You basically filter than unfilter again with that last line. Also, the first line can be removed as well. it&#39;s erroneous."}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1513186177, "post_id": 47798803, "comment_id": 82559033, "body": "@Xabier Its in Data Validation"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1513186669, "creation_date": 1513186669, "answer_id": 47799150, "question_id": 47798803, "link": "https://stackoverflow.com/questions/47798803/filter-table-using-vba-excel/47799150#47799150", "title": "Filter Table using VBA Excel", "body": "<p>If you put the code below under the Worksheet_Change on the Sheet \"worksheets(\"Dashboard\")\" then the value of the listbox will be used to filter the Field 3 in this case on the Sheet \"Yearly View\":</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$AL$1\" Then\nWorksheets(\"Yearly View\").ListObjects(\"YourTableName\").Range.AutoFilter Field:=3, Criteria1:=Target.Value 'change the name of your table here. and the field value to the column number to be filtered on your table\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4279, "favorite_count": 0, "accepted_answer_id": 47799150, "answer_count": 1, "score": 0, "last_activity_date": 1513196367, "creation_date": 1513185303, "last_edit_date": 1531164843, "question_id": 47798803, "link": "https://stackoverflow.com/questions/47798803/filter-table-using-vba-excel", "title": "Filter Table using VBA Excel", "body": "<p>I have two worksheets. In worksheets(\"Dashboard\") I have a dropdown list based on a table in worksheets(\"yearly View\"). I am trying to filter this table based on the value in the drop down list in worksheets(\"Dashboard\"). </p>\n\n<p>The code I have created is failing. </p>\n\n<p>The drop down list in worksheets(\"Dashboard\") is location in Range(\"AL1\"). The column to be filtered is on worksheets(\"Yearly View\").Range(\"P3\"). </p>\n\n<p>Please see my code below: </p>\n\n<pre><code>Sub Filter_Table()\n     Worksheets(\"Yearly View\").Range(\"P3\").Select\n     Worksheets(\"Yearly View\").Range(\"$P$3:$AR$24\").AutoFilter Field:=1, Criteria1:= _\n     Worksheets(\"Dashboard\").Range(\"AL1\")\n     ActiveSheet.Range(\"$P$3:$AR$24\").AutoFilter Field:=1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1513327385, "post_id": 47818941, "comment_id": 82619572, "body": "Great! This worked perfectly! The pasting of pictures (datatype 2) are now working again, do you maybe know how I can get the regular pasting working again? In 2016 I used, which now doesnt work anymore in Excel 2010..         PPSlide.Shapes.Paste.Select"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1513442508, "post_id": 47818941, "comment_id": 82659826, "body": "Generally you want to avoid selecting anything unless there&#39;s no other way. In this case, you can try PPSlide.Shapes.Paste (possibly adding a few DoEvents) then Set oSh = PPSlide.Shapes(PPSlide.Shapes.Count)  (having first Dimmed oSh as Shape)."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1513272098, "creation_date": 1513272098, "answer_id": 47818941, "question_id": 47798749, "link": "https://stackoverflow.com/questions/47798749/vba-powerpoint-formatting/47818941#47818941", "title": "VBA Powerpoint formatting", "body": "<p>This may or may not be the answer but plugging the suggestion in here will make it a whole lot more legible than including it as a comment:</p>\n\n<p>Instead of this:</p>\n\n<pre><code>PPSlide.Shapes.PasteSpecial DataType:=2\n   pp.ActiveWindow.Selection.ShapeRange.Top = 0\n   pp.ActiveWindow.Selection.ShapeRange.Left = 0\n   pp.ActiveWindow.Selection.ShapeRange.Width = 1000\n</code></pre>\n\n<p>Try this:</p>\n\n<pre><code>With PPSlide.Shapes.PasteSpecial DataType:=2\n  .Top = 0\n  .Left = 0\n  .Width = 1000\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576408241, "creation_date": 1513185137, "last_edit_date": 1576408241, "question_id": 47798749, "link": "https://stackoverflow.com/questions/47798749/vba-powerpoint-formatting", "title": "VBA Powerpoint formatting", "body": "<p>I've written a piece of code to copy data from excel and paste it in a powerpoint presentation. </p>\n\n<p>I constantly get the following error: </p>\n\n<blockquote>\n  <p>Selection.ShapeRange : Invalid Request. Nothing Appropriate is\n  currently selected</p>\n</blockquote>\n\n<p>Which relates to the following part of the code (where I am pasting the Excel data to the powerpoint slide and determine its position).</p>\n\n<pre><code>PPSlide.Shapes.PasteSpecial DataType:=2\n pp.ActiveWindow.Selection.ShapeRange.Top = 0\n pp.ActiveWindow.Selection.ShapeRange.Left = 0\n pp.ActiveWindow.Selection.ShapeRange.Width = 1000\n</code></pre>\n\n<p>The weird thing is that this code used to work a couple of weeks ago (in excel 2016), but since today (I got downgraded to Excel 2010) it suddenly stopped working..</p>\n\n<p>The full code I am using is as follows:</p>\n\n<pre><code> 'Step 1:  Declare variables\n\n       Dim pp As Object\n       Dim PPPres As Object\n       Dim PPSlide As Object\n       Dim xlwksht As Worksheet\n       Dim MyRange As String\n       Dim MyRange2 As String\n       Dim TemplatePath As String\n\n 'Step 2:  Open PowerPoint, add a new presentation and make visible\n\n       Set pp = CreateObject(\"PowerPoint.Application\")\n       Set PPPres = pp.Presentations.Add\n       pp.Visible = True\n\n 'Step 3:  Start the loop through each worksheet\n\n       'Step 3-A: Skip Excel sheets 1 till 8\n       For Each xlwksht In Worksheets\n       If xlwksht.Index &gt;= 9 Then\n\n       'Step 3-B:  Count slides and add new blank slide as next available slide number\n       SlideCount = PPPres.Slides.Count\n       Set PPSlide = PPPres.Slides.Add(SlideCount + 1, 12)\n       PPSlide.Select\n\n 'Step 4:    Copy the Content section from Excel\n\n       MyRange = xlwksht.Range(\"A1\").Value &amp; \":\" &amp; xlwksht.Range(\"A2\").Value\n       xlwksht.Range(MyRange).Copy\n\n 'Step 5:  Paste the Content and adjust its position\n\n       'Step 5-A: Determine the Path of the Template and apply it to the Powerpoint presentation\n\n       PPPres.ApplyTemplate (TemplatePath &amp; \"\\Template.potx\")\n\n       'Step 5-B: Determine the PasteType\n       pastetype = xlwksht.Range(\"C1\").Value  'Where C1 = \"Image\" for all images and tables\n       PasteWidth = xlwksht.Range(\"D1\").Value 'Where D1 = \"Title\" then picture will fill whole screen\n\n       'Step 5-C: Based on the Pastetype paste the content in the presentation\n       If pastetype = \"Image\" Then\n             If PasteWidth = \"Title\" Then\n\n                   'Step 5-C-1  Format only for Title Page\n                    PPSlide.Shapes.PasteSpecial DataType:=2\n                     pp.ActiveWindow.Selection.ShapeRange.Top = 0\n                     pp.ActiveWindow.Selection.ShapeRange.Left = 0\n                     pp.ActiveWindow.Selection.ShapeRange.Width = 1000\n             Else\n\n                   'Step 5-C-2  Format for Images\n                    PPSlide.Shapes.PasteSpecial DataType:=2\n                     pp.ActiveWindow.Selection.ShapeRange.Top = 95\n                     pp.ActiveWindow.Selection.ShapeRange.Left = 20\n                     pp.ActiveWindow.Selection.ShapeRange.Width = 300\n             End If\n       Else\n\n             'Step 5-C-3  Format for Normal tables\n              PPSlide.Shapes.Paste.Select\n              pp.ActiveWindow.Selection.ShapeRange.Top = 95\n              pp.ActiveWindow.Selection.ShapeRange.Left = 20\n       End If\n</code></pre>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1513184796, "post_id": 47798630, "comment_id": 82558137, "body": "Would <code>Application.EnableEvents = False</code> be an answer?"}, {"owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513184905, "post_id": 47798630, "comment_id": 82558195, "body": "Not a bad idea, the question would then be how to turn it back on if events are turned off?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513184933, "post_id": 47798630, "comment_id": 82558215, "body": "<code>Application.EnableEvents = True</code> to turn it on."}, {"owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1513184987, "post_id": 47798630, "comment_id": 82558251, "body": "Well yea lol, but since events are turned off, what can trigger that statement?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1513185097, "post_id": 47798630, "comment_id": 82558311, "body": "I really do not know how your code looks like, but in general you may think of something, depending on your code. <code>Application.DisplayAlerts = False</code> in the event is another good option."}, {"owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1513185397, "post_id": 47798630, "comment_id": 82558531, "body": "Now that is something I could use, Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1513185650, "creation_date": 1513185650, "answer_id": 47798887, "question_id": 47798630, "link": "https://stackoverflow.com/questions/47798630/skip-the-shape-delete-event/47798887#47798887", "title": "Skip the shape delete event", "body": "<p>You may use</p>\n\n<p><code>Application.DisplayAlerts = False</code> </p>\n\n<p>and then </p>\n\n<p><code>Application.DisplayAlerts = True</code></p>\n\n<p>in the shape event.</p>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "is_accepted": false, "score": 0, "last_activity_date": 1513189796, "creation_date": 1513189796, "answer_id": 47799886, "question_id": 47798630, "link": "https://stackoverflow.com/questions/47798630/skip-the-shape-delete-event/47799886#47799886", "title": "Skip the shape delete event", "body": "<p>So I learned that you cannot prevent a deletion of a shape through the BeforeDeleteEvent. If the shape has LockDelete = 1, the BeforeDeleteEvent will not trigger. So the only way to delete an object through a Message Box is through a UI Form that can be triggered by buttons or other control events.</p>\n"}, {"tags": [], "owner": {"reputation": 2368, "user_id": 683606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YugId.jpg?s=128&g=1", "display_name": "JohnGoldsmith", "link": "https://stackoverflow.com/users/683606/johngoldsmith"}, "is_accepted": false, "score": 3, "last_activity_date": 1513240380, "last_edit_date": 1513240380, "creation_date": 1513194474, "answer_id": 47801038, "question_id": 47798630, "link": "https://stackoverflow.com/questions/47798630/skip-the-shape-delete-event/47801038#47801038", "title": "Skip the shape delete event", "body": "<p>The events beginning with QueryCancel allow you to intrupt the flow.  So, for example, adding this to ThisDocument would allow you to not delete a selection based on whether its PrimaryItem was derived from the 'Process' master:</p>\n\n<pre><code>Private Function Document_QueryCancelSelectionDelete(ByVal Selection As IVSelection) As Boolean\n    Dim queryResult As Boolean\n    Dim shp As Shape\n    Set shp = Selection.PrimaryItem\n    If Not shp Is Nothing Then\n        If Not shp.Master Is Nothing Then\n            If shp.Master.NameU = \"Process\" Then\n                Dim res As VbMsgBoxResult\n                res = MsgBox(\"Are you sure you want to delete '\" &amp; shp.NameID &amp; \"'?\", vbYesNo, \"Delete Process shape?\")\n                If Not res = vbYes Then\n                    queryResult = True\n                End If\n            End If\n        End If\n    End If\n\n    'Return True to cancel the event\n    'Return False to let it continue\n    Document_QueryCancelSelectionDelete = queryResult\n\nEnd Function\n</code></pre>\n\n<p>You're always going to be dealing with Selection, rather than Shape delete events as that's all that's surfaced for the cancelable events, but you can easily iterate through your Selection and identify if it's a shape of interest.  Listening can happen at Application, Document (as above) or Page level depending on your needs.</p>\n"}], "owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1593542010, "creation_date": 1513184724, "last_edit_date": 1593542010, "question_id": 47798630, "link": "https://stackoverflow.com/questions/47798630/skip-the-shape-delete-event", "title": "Skip the shape delete event", "body": "<p>The feature I want to implement is when the user decides to delete a shape, I want them to have a warning message with yes or no options. If they select no, I don't want the shape to be deleted.</p>\n<p>The only solution I can come up with is locking deletion of every shape and using the OnBeforeShapeDelete Event. If the user chooses yes, the deletion protection is removed. If the user chooses no, it won't delete, but I'm annoyed having that prottection bubble popping up everytime(can that be turned off?).</p>\n<p>So is there a way in the OnBeforeShape Event where I could skip the shape's delete event? Or any other solutions? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513184795, "post_id": 47798530, "comment_id": 82558136, "body": "I\u2019m a little lost as to how I would edit it the code to reflect that sheet2 is the  activesheet, do I remove the cells portion of the code?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513184865, "post_id": 47798530, "comment_id": 82558167, "body": "@JohnGendi - compare my code and the part of your code here - <a href=\"https://text-compare.com\" rel=\"nofollow noreferrer\">text-compare.com</a>. I have simply added twice <code>sht</code>."}, {"owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513185702, "post_id": 47798530, "comment_id": 82558726, "body": "even with this modification i still don&#39;t get any output"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513185769, "post_id": 47798530, "comment_id": 82558778, "body": "@JohnGendi - so do you get the information you need at the <code>MsgBox()</code>"}, {"owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513186003, "post_id": 47798530, "comment_id": 82558929, "body": "No, no msgbox even appears. Would that mean that I am possibly using inner text incorrectly?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513186068, "post_id": 47798530, "comment_id": 82558959, "body": "It means it does not enter the loop at all. Thus this collection is empty <code>html.getElementsByClassName(&quot;imdbRating&quot;)</code>"}, {"owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513186285, "post_id": 47798530, "comment_id": 82559095, "body": "any idea why, all the classes that are mentioned are done correctly?"}, {"owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513187818, "post_id": 47798530, "comment_id": 82559932, "body": "are you sure this worked for you, i still have no msgbox or anything appearing"}, {"owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513192072, "post_id": 47798530, "comment_id": 82561977, "body": "Yup Thank you so much!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1513187351, "last_edit_date": 1513187351, "creation_date": 1513184409, "answer_id": 47798530, "question_id": 47798453, "link": "https://stackoverflow.com/questions/47798453/unable-to-index-output-results-into-excel/47798530#47798530", "title": "Unable to index output results into excel", "body": "<p>Try to refer the <code>sht</code> in every part of the code. E.g., rewrite this one:</p>\n\n<pre><code>For Each ele In html.getElementsByClassName(\"imdbRating\")\n    With ele.getElementsByClassName(\"ratingValue\")\n        If .Length Then r = r + 1: sht.Cells(r, 1) = .Item(0).innerText\n        MsgBox .Item(0).innerText\n        sht.Range(\"B2\") = .Item(0).innerText\n    End With\n    With ele.getElementsByClassName(\"small\")\n        If .Length Then sht.Cells(r, 2) = .Item(0).innerText\n         sht.Range(\"C2\") = .Item(0).innerText\n    End With\nNext ele\n</code></pre>\n\n<p>thus, adding <code>sht.Cells</code> twice. In you do not refer to the parent sheet of the cell, the value from <code>Range(\"C2\")</code> or <code>Cells(r,2)</code> is taken from the <code>ActiveSheet</code>. Judging that your parent sheet should be <code>Sheet2</code>, then most probably this is not your <code>ActiveSheet</code>.</p>\n\n<p>Just an idea - do not use <code>:</code> in the <code>If</code>, it is hard to follow and it is not always what you (or at least me) expect it would be - <a href=\"https://stackoverflow.com/questions/41983020/vba-how-the-colon-works-in-vba-code-with-condition\">VBA - How the colon `:` works in VBA code with condition</a></p>\n\n<hr>\n\n<p>The code that worked for me is this one:</p>\n\n<pre><code>Sub ImdbData()    \n    Dim IE As New InternetExplorer, html As HTMLDocument, ele As Variant\n    Dim sht     As Worksheet\n    Dim r       As Long        \n    With IE\n        .Visible = True\n        .navigate \"http://www.google.com/\"\n        Do Until .readyState = READYSTATE_COMPLETE: Loop\n        Set html = .document\n    End With\n\n    Set sht = Worksheets(1)\n\n    html.getElementById(\"lst-ib\").value = \"The incredibles \" &amp; \" IMDB\"\n    html.getElementById(\"btnK\").Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n    html.getElementsByClassName(\"rc\")(0).getElementsByTagName(\"a\")(0).Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n    For Each ele In html.getElementsByClassName(\"imdbRating\")\n        With ele.getElementsByClassName(\"ratingValue\")\n            If .Length Then r = r + 1: Cells(r, 1) = .Item(0).innerText\n            MsgBox .Item(0).innerText\n            sht.Range(\"B2\") = .Item(0).innerText\n        End With\n        With ele.getElementsByClassName(\"small\")\n            If .Length Then Cells(r, 2) = .Item(0).innerText\n             sht.Range(\"C2\") = .Item(0).innerText\n        End With\n    Next ele\n    IE.Quit\n\nEnd Sub\n</code></pre>\n\n<p>I have simply added <code>\"The incredibles \"</code> instead of <code>sht.Range(\"A2\")</code>, thus I am sure that it will load a movie and it will find <code>ElementByClassName(\"imdbRating\")</code> in imdb.com.</p>\n\n<p>Furthermore, it is a good practice to mention the libraries you are using for early binding, whenever you are asking in StackOverflow. Thus, you save about 3-4 minutes of search to everyone. In your case, you are using:</p>\n\n<ul>\n<li>Microsoft Internet Controls</li>\n<li>Microsoft HTML Object Library</li>\n</ul>\n\n<p>The standard ones could be skipped:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TQNNm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TQNNm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or simply use late binding. At the end, if you think about internet crawling, it could <a href=\"https://www.google.com/search?q=is+web+crawling+legal\" rel=\"nofollow noreferrer\">be a bit illegal</a> but if this is not your case, probably it is a better idea to do it with Beautiful Soup and Python.</p>\n"}], "owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 47798530, "answer_count": 1, "score": 1, "last_activity_date": 1513187351, "creation_date": 1513184144, "last_edit_date": 1531164843, "question_id": 47798453, "link": "https://stackoverflow.com/questions/47798453/unable-to-index-output-results-into-excel", "title": "Unable to index output results into excel", "body": "<p>I have a list of movies in a sheet that spans from A2:A966 and will run through the list of movies in the A2:A966 and pull the data for the ratings into B2:966 and total reviews into C2:C966.</p>\n\n<p>The output does not display in cells B2 and C2 however there are no errors that arise from running the macro. I've tried all sorts of variations and even tried getting a msgbox to display the results but still nothing.</p>\n\n<pre><code>sub imd_data()\n\n\n Dim IE As New InternetExplorer, html As HTMLDocument, ele As Object\n\n    With IE\n        .Visible = True\n        .navigate \"http://www.google.com/\"\n        Do Until .readyState = READYSTATE_COMPLETE: Loop\n        Set html = .document\n        Set sht = Sheets(\"Sheet2\")           \n\n    End With\n\n    html.getElementById(\"lst-ib\").Value = sht.Range(\"A2\") &amp; \" IMDB\"\n    html.getElementById(\"btnK\").Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n    html.getElementsByClassName(\"rc\")(0).getElementsByTagName(\"a\")(0).Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n    For Each ele In html.getElementsByClassName(\"imdbRating\")\n        With ele.getElementsByClassName(\"ratingValue\")\n            If .Length Then r = r + 1: Cells(r, 1) = .Item(0).innerText\n            MsgBox .Item(0).innerText\n            sht.Range(\"B2\") = .Item(0).innerText\n        End With\n        With ele.getElementsByClassName(\"small\")\n            If .Length Then Cells(r, 2) = .Item(0).innerText\n             sht.Range(\"C2\") = .Item(0).innerText\n        End With\n    Next ele    \n    IE.Quit    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1513183918, "post_id": 47798274, "comment_id": 82557586, "body": "I can see nothing wrong with this code. Maybe you didn&#39;t select the whole range before clicking on the button?"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1513183921, "post_id": 47798274, "comment_id": 82557588, "body": "The code is fine, but it expects you to select the range before clicking the button."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1513183944, "post_id": 47798274, "comment_id": 82557607, "body": "Are you selecting all the relevant cells and not just the first one (B2)"}, {"owner": {"reputation": 11256, "user_id": 1015595, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3SRWR.jpg?s=128&g=1", "display_name": "Big McLargeHuge", "link": "https://stackoverflow.com/users/1015595/big-mclargehuge"}, "edited": false, "score": 0, "creation_date": 1513184512, "post_id": 47798274, "comment_id": 82557969, "body": "I did select the range. I also tried replacing <code>Selection</code> with <code>Range(&quot;B2:B6&quot;)</code> with the same result."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513184652, "post_id": 47798274, "comment_id": 82558050, "body": "Ok, so what happens when you break on the <code>For</code> loop (F9) and then step through (F8) line by line?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513184435, "post_id": 47798450, "comment_id": 82557919, "body": "And this is why you don&#39;t write VBA code against <code>Selection</code> =)"}, {"owner": {"reputation": 11256, "user_id": 1015595, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3SRWR.jpg?s=128&g=1", "display_name": "Big McLargeHuge", "link": "https://stackoverflow.com/users/1015595/big-mclargehuge"}, "edited": false, "score": 1, "creation_date": 1513184515, "post_id": 47798450, "comment_id": 82557970, "body": "I did select the range. I also tried replacing <code>Selection</code> with <code>Range(&quot;B2:B6&quot;)</code> with the same result."}], "tags": [], "owner": {"reputation": 151, "user_id": 3683652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0c04f653a241f23a912e73c5ceb846?s=128&d=identicon&r=PG&f=1", "display_name": "fatboyzfishing", "link": "https://stackoverflow.com/users/3683652/fatboyzfishing"}, "is_accepted": true, "score": 2, "last_activity_date": 1513184127, "creation_date": 1513184127, "answer_id": 47798450, "question_id": 47798274, "link": "https://stackoverflow.com/questions/47798274/foreach-on-error-goto-resume-next-not-working/47798450#47798450", "title": "ForEach On Error GoTo Resume Next not working", "body": "<p>Your range is based off of the selection (highlighted cells), select all 5 cells  (B2:B6) and then click the button. The code seemed to work fine for me when I did this. </p>\n\n<p>Be kind and leave feedback! :)</p>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1513190252, "last_edit_date": 1513190252, "creation_date": 1513189765, "answer_id": 47799876, "question_id": 47798274, "link": "https://stackoverflow.com/questions/47798274/foreach-on-error-goto-resume-next-not-working/47799876#47799876", "title": "ForEach On Error GoTo Resume Next not working", "body": "<p>I know this has been answered but it really bothers me that the <code>On Error GoTo</code> syntax could be considered good practice.  Always avoid that if you can.  Here is the same code, but rewritten to avoid the On Error GoTo statement:</p>\n\n<pre><code>Private Sub SqrtButton_Click()\n    Dim rng As Range, cell As Range\n    Set rng = Selection\n    For Each cell In rng.Cells\n        If IsNumeric(cell.Value) And cell.Value &gt;= 0 Then\n            cell.Value = Sqr(cell.Value)\n        Else\n            MsgBox \"Invalid Value [\" &amp; cell.Value &amp; \"] at cell \" &amp; cell.Address(0, 0)\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11256, "user_id": 1015595, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3SRWR.jpg?s=128&g=1", "display_name": "Big McLargeHuge", "link": "https://stackoverflow.com/users/1015595/big-mclargehuge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 47798450, "answer_count": 2, "score": 0, "last_activity_date": 1513190252, "creation_date": 1513183626, "question_id": 47798274, "link": "https://stackoverflow.com/questions/47798274/foreach-on-error-goto-resume-next-not-working", "title": "ForEach On Error GoTo Resume Next not working", "body": "<p>I'm trying to follow <a href=\"http://www.excel-easy.com/vba/examples/err-object.html\" rel=\"nofollow noreferrer\">this tutorial</a>. I've created a button with the following click handler:</p>\n\n<pre><code>Private Sub SqrtButton_Click()\n    Dim rng As Range, cell As Range\n    Set rng = Selection\n    For Each cell In rng\n        On Error GoTo InvalidValue:\n        cell.Value = Sqr(cell.Value)\n    Next cell\n    Exit Sub\n\nInvalidValue:\n    MsgBox Err.Number &amp; \" \" &amp; Err.Description &amp; \" at cell \" &amp; cell.Address\n    Resume Next\nEnd Sub\n</code></pre>\n\n<p>According to the tutorial, the program should display two error messages for cells B4 and B5 and replace values in the remaining cells. But, when I run the code, only the first cell value is replaced (B2) and no error messages are displayed.</p>\n\n<p>The example is available to <a href=\"http://www.excel-easy.com/vba/examples/excel-files/err-object.xls\" rel=\"nofollow noreferrer\">download</a> and it doesn't work either.</p>\n\n<p>What's wrong with this code?</p>\n"}, {"tags": ["excel", "hyperlink", "vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9094791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/862560438d4feb854d6d4029aeed4935?s=128&d=identicon&r=PG&f=1", "display_name": "I-Dont-Understand", "link": "https://stackoverflow.com/users/9094791/i-dont-understand"}, "edited": false, "score": 0, "creation_date": 1513237802, "post_id": 47798427, "comment_id": 82577758, "body": "Perfect, this works the way I expected it. I did not know this way pf work-around. Thank you very much!"}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": true, "score": 2, "last_activity_date": 1513184076, "creation_date": 1513184076, "answer_id": 47798427, "question_id": 47797921, "link": "https://stackoverflow.com/questions/47797921/vba-fills-whole-table-instead-of-defined-cell/47798427#47798427", "title": "VBA fills whole table instead of defined cell", "body": "<p>It worked as expected for me when using a normal cell.  But when I tried it in a Formatted Table (aka ListObject) then it fill the entire column, because it is a formula and not a value.  If this is the case then try setting </p>\n\n<p><code>Application.AutoCorrect.AutoFillFormulasInLists = False</code> </p>\n\n<p>before you put the Hyperlink in the cell (and then set it back to True)</p>\n"}], "owner": {"reputation": 41, "user_id": 9094791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/862560438d4feb854d6d4029aeed4935?s=128&d=identicon&r=PG&f=1", "display_name": "I-Dont-Understand", "link": "https://stackoverflow.com/users/9094791/i-dont-understand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 47798427, "answer_count": 1, "score": 3, "last_activity_date": 1513266502, "creation_date": 1513182472, "last_edit_date": 1531161705, "question_id": 47797921, "link": "https://stackoverflow.com/questions/47797921/vba-fills-whole-table-instead-of-defined-cell", "title": "VBA fills whole table instead of defined cell", "body": "<p>I ran into a crazy problem that I don't understand and for which I did not yet find a workaround.</p>\n\n<p>First I have an excel macro filling various sheets on a workbook depending on information from other workbooks. I want to include a hyperlink to a website, containing the value in a specified cell in one workbook, while only displaying the value. I try to insert the formula as following</p>\n\n<pre><code>=HYPERLINK(\"https://example.com/value\",\"value\")\n</code></pre>\n\n<p>This hyperlink is only available for a certain cell, so it should only appear where a condition is true.\nNow for the crazy part: If I fill the cell where I want to insert the hyperlink with a normal string or int, it works just fine and VBA only fills the cell I specified. When I insert a Hyperlink, it fills up the whole column on my worksheet, although everything else is kept in the same way.\nPlease find a snippet of the code below:</p>\n\n<pre><code>RequestID = Workbook1.ActiveSheet.Cells(i, 1).Text 'Request number\n\nWorkbook2.Sheets(\"Sheet1\").Cells(y, 4) = RequestID    \n</code></pre>\n\n<p>This only fills cell(y,4) with the correct request number as expected</p>\n\n<pre><code>Workbook2.Sheets(\"Sheet1\").Cells(y, 4) = \"RequestID\"\n</code></pre>\n\n<p>This only fills cell(y,4) with the String \"RequestID\" as expected </p>\n\n<pre><code>  Workbook2.Sheets(\"Sheet1\").Cells(y, 4) = \"=HYPERLINK(\" &amp; Chr(34) &amp;\"https://example.com/\" &amp; RequestID &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; RequestID &amp; Chr(34) &amp; \")\"\n</code></pre>\n\n<p>This fills up my whole table except for the header with the correctly working hyperlink.</p>\n\n<p>I dont really understand why and I can't think of any possible problem. Maybe someone here has a hint for me, or knows a workaround.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1513182870, "post_id": 47797614, "comment_id": 82556811, "body": "I answered the footer question below. Please limit your question to <b>one</b> actual question. That said, to answer the design question, yes, you will need to create your own title sheet with a separate tab (or at the beginning of the printed sheet with relevant page breaks. Also, you can clean up your code quiet a bit by only using the methods that you need to specifically change. The rest of defaults and will process anyway."}], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 8938584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7313bf13b2bedac07b48736a2859457d?s=128&d=identicon&r=PG&f=1", "display_name": "Tefalpan", "link": "https://stackoverflow.com/users/8938584/tefalpan"}, "edited": false, "score": 0, "creation_date": 1513183301, "post_id": 47797997, "comment_id": 82557134, "body": "I used the macro record tool, don&#39;t know if theres another way. So far, the running time didn&#39;t bother me, runs pretty quick in my opinion"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "reply_to_user": {"reputation": 64, "user_id": 8938584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7313bf13b2bedac07b48736a2859457d?s=128&d=identicon&r=PG&f=1", "display_name": "Tefalpan", "link": "https://stackoverflow.com/users/8938584/tefalpan"}, "edited": false, "score": 0, "creation_date": 1513184244, "post_id": 47797997, "comment_id": 82557804, "body": "You would notice...you know that pause that it takes when you select a new printer...it did that for every single setting."}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 0, "last_activity_date": 1513182682, "creation_date": 1513182682, "answer_id": 47797997, "question_id": 47797614, "link": "https://stackoverflow.com/questions/47797614/excel-vba-plot-showing-worksheet-name-page-number-adding-title-page-in-plot/47797997#47797997", "title": "Excel vba plot showing worksheet name + page number/adding title page in plot", "body": "<p>You can really force a page number, since you don't know how many pages there are.  So it's the same as setting it in regular Excel.</p>\n\n<p>Try this <code>Page &amp;[Page] of &amp;[Pages]</code></p>\n\n<p>Regular format taken from <a href=\"https://support.office.com/en-us/article/Add-or-remove-page-numbers-57ebb99e-0cfc-408b-864a-c805b5040ae7\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Add-or-remove-page-numbers-57ebb99e-0cfc-408b-864a-c805b5040ae7</a></p>\n\n<ul>\n<li>Side note, isn't using <code>.PageSetup</code> slow? I can't remember if they fixed it or not? There is a trick with using the print setup from the Excel4 Macros that was much faster.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 64, "user_id": 8938584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7313bf13b2bedac07b48736a2859457d?s=128&d=identicon&r=PG&f=1", "display_name": "Tefalpan", "link": "https://stackoverflow.com/users/8938584/tefalpan"}, "edited": false, "score": 0, "creation_date": 1513183127, "post_id": 47798026, "comment_id": 82557008, "body": "found the rest of the syntax using the macro recording funtion, feeling pretty stupid to not think about this, thanks ;)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1513182778, "creation_date": 1513182778, "answer_id": 47798026, "question_id": 47797614, "link": "https://stackoverflow.com/questions/47797614/excel-vba-plot-showing-worksheet-name-page-number-adding-title-page-in-plot/47798026#47798026", "title": "Excel vba plot showing worksheet name + page number/adding title page in plot", "body": "<p>When you are looking for a syntax, recording a macro while you do the manual steps can be very helpful.</p>\n\n<p>I used Excel's built-in <code>Page 1 of ?</code> custom filter to get the syntax you are after. Manually, I went to Page Layout > Page Setup > Header / Footer > Footer > Page 1 of ?</p>\n\n<pre><code>.RightFooter = ActiveSheet.Name &amp; \" - \" &amp; \"Page &amp;P of &amp;N\"\n</code></pre>\n"}], "owner": {"reputation": 64, "user_id": 8938584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7313bf13b2bedac07b48736a2859457d?s=128&d=identicon&r=PG&f=1", "display_name": "Tefalpan", "link": "https://stackoverflow.com/users/8938584/tefalpan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 47798026, "answer_count": 2, "score": 0, "last_activity_date": 1513182778, "creation_date": 1513181605, "question_id": 47797614, "link": "https://stackoverflow.com/questions/47797614/excel-vba-plot-showing-worksheet-name-page-number-adding-title-page-in-plot", "title": "Excel vba plot showing worksheet name + page number/adding title page in plot", "body": "<p>I made the following script to automatic plot the active worksheet to a certain layout, in the right footer I would like to show the name of the active worksheet followed by the page number, 'edit: found the 'Activesheet.Name' formula, but still don't know how to add the page number (layout of page number: actual page numer/total amount of pages)</p>\n\n<p>Example of a wanted right footer:\nPartA - 1/12</p>\n\n<p>Is it btw also possible to include a front page with just the name of the current worksheet, displayed in a big font in the center? Or is it needed to design the excel worksheet that way that the first page just contains one active cell with the title in the center?</p>\n\n<pre><code>Application.PrintCommunication = False\nApplication.Dialogs(xlDialogPrinterSetup).Show\nWith ActiveSheet.PageSetup\n    ActiveWindow.View = xlPageBreakPreview\nActiveSheet.PageSetup.PrintArea = \"$A:$N\"\n    .PrintTitleRows = \"\"\n    .PrintTitleColumns = \"\"\nEnd With\nApplication.PrintCommunication = True\nActiveSheet.PageSetup.PrintArea = \"\"\nApplication.PrintCommunication = False\nWith ActiveSheet.PageSetup\n    .LeftHeader = \"\"\n    .CenterHeader = \"PROJECT X\"\n    .RightHeader = \"\"\n    .LeftFooter = Sheets(\"instellingen\").Cells(20, 2).Value\n    .CenterFooter = Sheets(\"instellingen\").Cells(22, 2).Value\n    .RightFooter = \"\"\n    .LeftMargin = Application.InchesToPoints(0.7)\n    .RightMargin = Application.InchesToPoints(0.7)\n    .TopMargin = Application.InchesToPoints(0.75)\n    .BottomMargin = Application.InchesToPoints(0.75)\n    .HeaderMargin = Application.InchesToPoints(0.3)\n    .FooterMargin = Application.InchesToPoints(0.3)\n    .PrintHeadings = False\n    .PrintGridlines = False\n    .PrintComments = xlPrintNoComments\n    .PrintQuality = 600\n    .CenterHorizontally = False\n    .CenterVertically = False\n    .Orientation = xlPortrait\n    .Draft = False\n    .PaperSize = xlPaperA4\n    .FirstPageNumber = xlAutomatic\n    .Order = xlDownThenOver\n    .BlackAndWhite = False\n    .Zoom = False\n    .FitToPagesWide = 1\n    .FitToPagesTall = 0\n    .PrintErrors = xlPrintErrorsDisplayed\n    .OddAndEvenPagesHeaderFooter = False\n    .DifferentFirstPageHeaderFooter = False\n    .ScaleWithDocHeaderFooter = True\n    .AlignMarginsHeaderFooter = True\n    .EvenPage.LeftHeader.Text = \"\"\n    .EvenPage.CenterHeader.Text = \"\"\n    .EvenPage.RightHeader.Text = \"\"\n    .EvenPage.LeftFooter.Text = \"\"\n    .EvenPage.CenterFooter.Text = \"\"\n    .EvenPage.RightFooter.Text = \"\"\n    .FirstPage.LeftHeader.Text = \"\"\n    .FirstPage.CenterHeader.Text = \"\"\n    .FirstPage.RightHeader.Text = \"\"\n    .FirstPage.LeftFooter.Text = \"\"\n    .FirstPage.CenterFooter.Text = \"\"\n    .FirstPage.RightFooter.Text = \"\"\nEnd With\nApplication.PrintCommunication = True\nApplication.PrintCommunication = False\nWith ActiveSheet.PageSetup\n    .PrintTitleRows = \"\"\n    .PrintTitleColumns = \"\"\nEnd With\n</code></pre>\n\n<p>Thanks :)</p>\n"}, {"tags": ["vba", "excel", "collections"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1513183069, "post_id": 47797519, "comment_id": 82556967, "body": "<i>make the first for loop work</i> - it surely won&#39;t work at all (nor will it compile) since there is no closing <code>End If</code> for the <code>IF</code> block."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1513183915, "post_id": 47797519, "comment_id": 82557581, "body": "You could use a Dictionary which enables you to check for the existence of an item."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1513193767, "creation_date": 1513193767, "answer_id": 47800874, "question_id": 47797519, "link": "https://stackoverflow.com/questions/47797519/is-it-possible-to-compare-an-object-property-against-objects-in-a-collection/47800874#47800874", "title": "Is it possible to compare an object property against objects in a collection?", "body": "<p>Here's a simplified version of your code to illustrate one possible approach:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\n    Dim sheet As Worksheet\n    Dim arr1, arr2\n\n    arr1 = Array(BASE1, Cap1, A1, A2, CAP0, BASE0, Sheet13)\n\n    Application.ScreenUpdating = False\n\n    If Sheet13.Name = \"Show\" Then '&lt;&lt; can use \"Me.Name\" if code is in Sheet13 module...\n        For Each sheet In ThisWorkbook.Sheets\n           If Not InArray(sheet, arr1) Then sheet.Visible = xlSheetVisible\n        Next sheet\n        Sheet13.Name = \"Collapse\"\n        Sheet3.Activate\n    End If\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>A utility function to check if a sheet is in the array provided. Should go in a regular code module.</p>\n\n<pre><code>'is a sheet in the provided array?\nFunction InArray(sht As Worksheet, arr)\n    Dim s, rv As Boolean\n    For Each s In arr\n        If s.Name = sht.Name Then\n            rv = True\n            Exit For\n        End If\n    Next s\n    InArray = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9094777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kLxva.jpg?s=128&g=1", "display_name": "CamReed", "link": "https://stackoverflow.com/users/9094777/camreed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47800874, "answer_count": 1, "score": 1, "last_activity_date": 1513193767, "creation_date": 1513181306, "last_edit_date": 1513185961, "question_id": 47797519, "link": "https://stackoverflow.com/questions/47797519/is-it-possible-to-compare-an-object-property-against-objects-in-a-collection", "title": "Is it possible to compare an object property against objects in a collection?", "body": "<p>Here is the code I am trying to work with. It is supposed to expand and collapse a number of sheets when the show/hide sheet is clicked. I have a working iteration of this, but the workbook will be over 200 sheets when complete and I would like to have these specified as collections that I can reference instead of pointing to each sheet that should be expanded or collapsed specifically. The second for loop is how I have the code set up in my other iteration and it works, wondering if there is a way to make the first for loop work. Cheers!</p>\n\n<pre><code>Private Sub Worksheet_Activate()\nDim sheet As Worksheet\nDim col1 As New Collection\nDim col2 As New Collection\ncol1.Add (BASE1) And (Cap1) And (A1) And (A2) And (CAP0) And (BASE0) And (Sheet13)\ncol2.Add (BASE0) And (CAP0) And (BASE1) And (Cap1) And (BASE2) And (Cap2) And (Sheet13)\nApplication.ScreenUpdating = False\nIf Sheet13.Name = \"Show\" Then\n    For Each sheet In ThisWorkbook.Sheets\n       If (sheet.Name &lt;&gt; col2) Then\n        sheet.Visible = xlSheetVisible\n       End If\n    Next sheet\n    Sheet13.Name = \"Collapse\"\n    Sheet3.Activate\nElse\n    For Each sheet In ThisWorkbook.Sheets\n        If (sheet.Name &lt;&gt; Sheet1.Name And sheet.Name &lt;&gt; Sheet2.Name And sheet.Name &lt;&gt; Sheet3.Name And sheet.Name &lt;&gt; Sheet13.Name And sheet.Name &lt;&gt; Sheet7.Name) Then\n           sheet.Visible = xlSheetVeryHidden\n        End If\n    Next sheet\n    Sheet13.Name = \"Show\"\n    Sheet3.Activate\nEnd If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Hoping this will help clear up my question. The below code is the current working version of the above code without the use of collections. AS you can see, the sheets to expand and collapse are referenced specifically. What I want to do is If sheet.Name &lt;> (Any sheet in collection1) Then</p>\n\n<pre><code>Private Sub Worksheet_Activate()\nDim sheet As Worksheet\nApplication.ScreenUpdating = False\nIf Sheet8.Name = \"702 BASE - EXPAND\" Then\n    For Each sheet In ThisWorkbook.Sheets\n        If (sheet.Name &lt;&gt; Sheet4.Name And sheet.Name &lt;&gt; Sheet5.Name And sheet.Name &lt;&gt; Sheet6.Name And sheet.Name &lt;&gt; Sheet14.Name And sheet.Name &lt;&gt; Sheet15.Name And sheet.Name &lt;&gt; Sheet16.Name And sheet.Name &lt;&gt; Sheet17.Name And sheet.Name &lt;&gt; Sheet18.Name And sheet.Name &lt;&gt; Sheet19.Name And sheet.Name &lt;&gt; Sheet20.Name And sheet.Name &lt;&gt; Sheet21.Name And sheet.Name &lt;&gt; Sheet22.Name And sheet.Name &lt;&gt; Sheet23.Name And sheet.Name &lt;&gt; Sheet24.Name And sheet.Name &lt;&gt; Sheet25.Name And sheet.Name &lt;&gt; Sheet26.Name) Then\n            sheet.Visible = xlSheetVisible\n        End If\n    Next sheet\n    Sheet8.Name = \"702 BASE - COLLAPSE\"\n    Sheet8.Activate\nElse\n    For Each sheet In ThisWorkbook.Sheets\n        If (sheet.Name &lt;&gt; Sheet4.Name And sheet.Name &lt;&gt; Sheet8.Name And sheet.Name &lt;&gt; Sheet1.Name And sheet.Name &lt;&gt; Sheet2.Name And sheet.Name &lt;&gt; Sheet3.Name And sheet.Name &lt;&gt; Sheet7.Name) Then\n           sheet.Visible = xlSheetVeryHidden\n        End If\n    Next sheet\n    Sheet8.Name = \"702 BASE - EXPAND\"\n    Sheet1.Activate\nEnd If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1513201620, "post_id": 47797772, "comment_id": 82566547, "body": "Ok, that is an answer even if its not the one I wanted :-) I am surprised to hear this, but I will use the collection method."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1513182057, "creation_date": 1513182057, "answer_id": 47797772, "question_id": 47797440, "link": "https://stackoverflow.com/questions/47797440/make-a-range-in-vba-that-spans-sheets/47797772#47797772", "title": "Make a Range in VBA that spans sheets?", "body": "<p>A <code>Range</code> object can only be a set of cells on a single worksheet.  However you can create an <strong>array</strong> of  ranges or a <strong>collection</strong> of ranges that can span more than one worksheet.</p>\n"}], "owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 47797772, "answer_count": 1, "score": 1, "last_activity_date": 1513182057, "creation_date": 1513181086, "last_edit_date": 1531161705, "question_id": 47797440, "link": "https://stackoverflow.com/questions/47797440/make-a-range-in-vba-that-spans-sheets", "title": "Make a Range in VBA that spans sheets?", "body": "<p>I am trying to make a Range that spans several sheets, a 3-D Reference as they call it. <a href=\"https://support.office.com/en-us/article/Create-a-3-D-reference-to-the-same-cell-range-on-multiple-worksheets-40ca91ff-9dcb-4ad1-99d2-787d0bc888b6\" rel=\"nofollow noreferrer\">Here is MS's example</a> of how to do it manually. Well I need to do it in code (no, I can't use a sheet formula). So I did...</p>\n\n<pre><code>Set m1 = Sheets(\"Sheet1\").Cells(1, 1)\nSet m2 = Sheets(\"Sheet2\").Cells(3, 1)\nSet m3 = Union(m1, m2)\n</code></pre>\n\n<p>However, this returns the dreaded '1004' error, as does every other syntax I've tried. Then I tried just doing this manually by shift-selecting multiple sheets and using this...</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    MsgBox \"range address: \" &amp; Target.Address\nEnd Sub\n</code></pre>\n\n<p>And that <em>always</em> returns only the part of the selection on the ActiveSheet.</p>\n\n<p>So, is there any way to make a Range that spans sheets?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1513182103, "post_id": 47797172, "comment_id": 82556278, "body": "Have you tried just adding this line right after your Do While statement? Application.AutomationSecurity = msoAutomationSecurityForceDisable"}, {"owner": {"reputation": 23, "user_id": 9088740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a473f3849032801947e57b27b0d0835e?s=128&d=identicon&r=PG&f=1", "display_name": "gosh", "link": "https://stackoverflow.com/users/9088740/gosh"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1513183358, "post_id": 47797172, "comment_id": 82557181, "body": "Yes.. while it doesn&#39;t crash my file, it does not reduce the data fetching time"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1513185339, "post_id": 47797172, "comment_id": 82558480, "body": "Do the files take a long time to open, normally?   I doubt VBA can speed up that process."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1513263363, "creation_date": 1513263363, "answer_id": 47816294, "question_id": 47797172, "link": "https://stackoverflow.com/questions/47797172/how-can-i-minimize-the-time-to-access-a-xlsm-file/47816294#47816294", "title": "How can I minimize the time to access a xlsm file?", "body": "<p>Your code here: </p>\n\n<pre><code>            Cells.Select\n            Range(\"B3\").Activate\n            Selection.Copy\n            Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, \n            Operation:=xlNone _\n            , SkipBlanks:=False, Transpose:=False\n            Selection.PasteSpecial Paste:=xlPasteValues, \n            Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n            Application.CutCopyMode = False\n            ActiveSheet.Visible = False\n</code></pre>\n\n<p>is unnecessary. Firstly you are selecting all the cells in the activesheet - which is several million. Then you activate one cell to no purpose, then you copy those several million cells, paste them over the top as values, then do it again, and then hide the sheet. I don't know why you want to do this, but you can achieve the same end by doing:</p>\n\n<pre><code>   With Activesheet\n        .usedrange.formula = .usedrange.value\n        .visible = false\n   End With\n</code></pre>\n\n<p>which ought to speed things up</p>\n"}], "owner": {"reputation": 23, "user_id": 9088740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a473f3849032801947e57b27b0d0835e?s=128&d=identicon&r=PG&f=1", "display_name": "gosh", "link": "https://stackoverflow.com/users/9088740/gosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513263363, "creation_date": 1513180245, "last_edit_date": 1513180444, "question_id": 47797172, "link": "https://stackoverflow.com/questions/47797172/how-can-i-minimize-the-time-to-access-a-xlsm-file", "title": "How can I minimize the time to access a xlsm file?", "body": "<p>I have a macro that access some xlsm files to retrieve a spreadsheet and paste it as value. However, the macro is taking a lot of time to open - mainly because it take a lot of time to open each of the xlsm files. Is there any way I can reduce this load time?</p>\n\n<p>This is the code I have:</p>\n\n<pre><code>Option Explicit\n\nSub GetSheets()\nDim Path As String\nDim Filename As String\nDim wbMaster As Workbook\nDim wbActive As Workbook\nDim wsPanel As Worksheet\n\nSet wbMaster = ThisWorkbook\n\nPath = \"C:\\Users\\Admin\\PMO\\Test consolidation\\Independent files\"\nIf Right$(Path, 1) &lt;&gt; \"\\\" Then Path = Path &amp; \"\\\"\nFilename = Dir(Path &amp; \"*.xlsm\")\n\nDim wsname As String\nclean\n\nDo While Filename &lt;&gt; \"\"\n    Set wbActive = Workbooks.Open(Filename:=Path &amp; Filename, ReadOnly:=True)\n    'Workbook_Opn_DisableMacros (Path &amp; Filename)\n\n    With wbActive\n        If Evaluate(\"ISREF('\" &amp; \"Panel\" &amp; \"'!A1)\") Then 'Rory 'https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists\n            Set wsPanel = wbActive.Worksheets(\"Panel\")\n            wsPanel.Copy After:=wbMaster.Worksheets(1)\n\n            If Not IsEmpty(wsPanel.Range(\"U5\")) Then\n                ActiveSheet.Name = wsPanel.Range(\"U5\")\n                Cells.Select\n                Range(\"B3\").Activate\n                Selection.Copy\n                Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, \n                Operation:=xlNone _\n                , SkipBlanks:=False, Transpose:=False\n                Selection.PasteSpecial Paste:=xlPasteValues, \n                Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n                Application.CutCopyMode = False\n                ActiveSheet.Visible = False\n            Else\n                MsgBox \"Missing value to rename worksheet in \" &amp; Filename\n            End If\n        End If\n    End With\n\n    wbActive.Close\n    Filename = Dir()\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Doing a quick search around, I found this code that apparently solves this but has been crashing my file.</p>\n\n<pre><code>Public Sub Workbook_Opn_DisableMacros(FileComplete As String)\n\nDim oldSecurity\noldSecurity = Excel.Application.AutomationSecurity\nExcel.Application.AutomationSecurity = msoAutomationSecurityForceDisable\nExcel.Workbooks.Open (FileComplete), ReadOnly:=True\nExcel.Application.AutomationSecurity = oldSecurity\nEnd Sub\n</code></pre>\n\n<p>Does anyone know how to merge this solution into my code? Any help is deeply appreciated.\nThanks!</p>\n"}, {"tags": ["vba", "excel", "class"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513183735, "post_id": 47797153, "comment_id": 82557445, "body": "What is the type of <code>CASN.Addressxl</code>?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513183827, "post_id": 47797153, "comment_id": 82557503, "body": "@Mat&#39;sMug Omg... How did I miss this... It was <code>Range</code> LOL"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513183862, "post_id": 47797153, "comment_id": 82557537, "body": "Other than that silly mistake, am I doing this properly?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513183891, "post_id": 47797153, "comment_id": 82557565, "body": "Hard to tell, seems like a lot of code is missing. I&#39;d pass the parameters <code>ByVal</code> though. Here that procedure could legally change the value of <code>wk</code>, or <code>Set col = Nothing</code>, and the calling code would be F&#39;d."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513184925, "post_id": 47797153, "comment_id": 82558208, "body": "@Mat&#39;sMug I can confirm it all works, the only thing is that I forgot to do <code>Set compare = New Collection</code>. Is this the only way to add items from one collection to another? Or is there a faster/more efficient approach?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513185187, "post_id": 47797153, "comment_id": 82558373, "body": "Seems fine. Collections are <i>made for this</i>, and you&#39;re iterating them the way they should be (i.e. with a <code>For Each</code> loop)."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1513184044, "creation_date": 1513184044, "answer_id": 47798419, "question_id": 47797153, "link": "https://stackoverflow.com/questions/47797153/add-one-object-from-collection-to-another-collection/47798419#47798419", "title": "Add One Object from Collection to another Collection", "body": "<p>The <code>Debug.Print</code> statement is trying to convert <code>CASN.Addressxl</code> to a <code>String</code>, and failing to do that.</p>\n\n<p>Verify the types involved.</p>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 47798419, "answer_count": 1, "score": 0, "last_activity_date": 1513184044, "creation_date": 1513180176, "last_edit_date": 1531164843, "question_id": 47797153, "link": "https://stackoverflow.com/questions/47797153/add-one-object-from-collection-to-another-collection", "title": "Add One Object from Collection to another Collection", "body": "<p>I've created a class called <code>CASN</code> within this class has a couple variables (which aren't really important here). Basically what I'm trying to do is, create a new collection and add items based on a specific criteria from the original collection.</p>\n\n<p>Once the <code>compare</code> collection is created, then I will compare the two collections against each other and ONLY keep the duplicate values in another new <code>result</code> collection.</p>\n\n<pre><code>Public Function FindDuplicates(col As Collection, wk As String) As Collection\n\n   Dim numOrig As CASN\n   Dim numComp As CASN\n   Dim result As Collection\n   Dim compare As Collection\n\n   For Each numOrig In col\n      If (numOrig.Week &lt;&gt; wk) Then\n         Set numComp = New CASN\n         Debug.Print numOrig.Addressxl   '''' ERROR HERE\n         numComp.Addressxl = numOrig.Addressxl\n         compare.Add numComp\n      End If\n   Next numOrig\n\n'''''''''' OTHER PROCEDURES\n\nEnd Function\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I removed a lot of unnecessary code and trying to isolate the issue to to the above code. It seems as though the collection getting passed through into the function is having issues?</p>\n\n<blockquote>\n  <p>Run-time error '13':</p>\n  \n  <p>Type mismatch</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-access", "if-statement"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1513179506, "post_id": 47796899, "comment_id": 82554570, "body": "You need to close your <code>Do</code> with <code>Loop</code> before using <code>ElseIf</code> and you will probably also need to use <code>rs.MoveNext</code> if you dont want to end up in an infinite loop."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1513179513, "post_id": 47796899, "comment_id": 82554575, "body": "It is the <code>Do Loop</code> before the second <code>ElseIf</code> that is missing <code>Loop</code>."}, {"owner": {"reputation": 591, "user_id": 528166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/af5c49716ea922c52948c647aa815872?s=128&d=identicon&r=PG", "display_name": "Christopher Long", "link": "https://stackoverflow.com/users/528166/christopher-long"}, "edited": false, "score": 0, "creation_date": 1513179687, "post_id": 47796899, "comment_id": 82554712, "body": "Aghhh so simple! thanks guys"}], "answers": [{"comments": [{"owner": {"reputation": 591, "user_id": 528166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/af5c49716ea922c52948c647aa815872?s=128&d=identicon&r=PG", "display_name": "Christopher Long", "link": "https://stackoverflow.com/users/528166/christopher-long"}, "edited": false, "score": 0, "creation_date": 1513179878, "post_id": 47796981, "comment_id": 82554836, "body": "Thank you @braX , this is perfect."}, {"owner": {"reputation": 591, "user_id": 528166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/af5c49716ea922c52948c647aa815872?s=128&d=identicon&r=PG", "display_name": "Christopher Long", "link": "https://stackoverflow.com/users/528166/christopher-long"}, "edited": false, "score": 0, "creation_date": 1513180170, "post_id": 47796981, "comment_id": 82555037, "body": "Actually spoke to soon. Adding rs.movenext in each loop causes a &quot;Run-time error &#39;3021&#39; No Current Record&quot; error. Without the rs.movenext the code appears to work fine. (However I am concerned about this infinite loop you mentioned!)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 591, "user_id": 528166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/af5c49716ea922c52948c647aa815872?s=128&d=identicon&r=PG", "display_name": "Christopher Long", "link": "https://stackoverflow.com/users/528166/christopher-long"}, "edited": false, "score": 0, "creation_date": 1513180220, "post_id": 47796981, "comment_id": 82555073, "body": "I recommend using the code from the other answer. It is much better."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1513179680, "creation_date": 1513179680, "answer_id": 47796981, "question_id": 47796899, "link": "https://stackoverflow.com/questions/47796899/vba-compile-error-else-without-if/47796981#47796981", "title": "VBA Compile error: else without if", "body": "<p>There are several problems with your code. Your loops are not set up correctly, and you are missing <code>rs.MoveNext</code>. Try it like this:</p>\n\n<pre><code>Dim notesSQL As QueryDef\nDim Row As Integer\nDim Column, targetCell As String\nSet notesSQL = Db.QueryDefs(\"Export_Table_Notes_Filter\")\nSet rs = notesSQL.OpenRecordset()\n\nIf Insp_Template_No.Value = \"Hazardous Area Equipment Detailed Inspection (Ex 'I' Ex 'iD' Ex 'nL)\" Then\n    Column = \"b\"\n    Row = 16\n\n    Do Until rs.EOF\n        targetCell = (Column &amp; Row)\n        With wsheet\n        .Range(targetCell).CopyFromRecordset rs\n        End With\n\n        targetCell = (Count + 1)\n        rs.Movenext\n    Loop\nElseIf Insp_Template_No.Value = \"Hazardous Area Equipment Visual Inspection (Ex 'd' and Ex 'e')\" Then\n    Column = \"c\"\n    Row = 15\n\n    Do Until rs.EOF\n        targetCell = (Column &amp; Row)\n        With wsheet\n        .Range(targetCell).CopyFromRecordset rs\n        End With\n\n        targetCell = (Count + 1)\n        rs.Movenext\n    Loop\nElseIf Insp_Template_No.Value = \"Hazardous Area Equipment Close Inspection (Ex 'I' Ex 'iD' Ex 'nL)\" Then\n    Column = \"b\"\n    Row = 15\n\n    Do Until rs.EOF\n        targetCell = (Column &amp; Row)\n        With wsheet\n        .Range(targetCell).CopyFromRecordset rs\n        End With\n\n        targetCell = (Count + 1)\n        rs.Movenext\n    Loop\nElse\n    MsgBox (\"Unrecognised inspection template\")\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1513180085, "post_id": 47797059, "comment_id": 82554986, "body": "A further improvement might be a <code>SELECT ... CASE</code> instead of <code>IF ... ELSEIF</code> when comparing the same variable to multiple values"}, {"owner": {"reputation": 591, "user_id": 528166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/af5c49716ea922c52948c647aa815872?s=128&d=identicon&r=PG", "display_name": "Christopher Long", "link": "https://stackoverflow.com/users/528166/christopher-long"}, "edited": false, "score": 0, "creation_date": 1513180515, "post_id": 47797059, "comment_id": 82555251, "body": "Same issue with @braX &#39;s code, the inclusion of the <code>rs.movenext</code>  is causing  <code>Run-time error &#39;3021&#39; No Current Record</code>. The refactor looks much better however."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1513179915, "creation_date": 1513179915, "answer_id": 47797059, "question_id": 47796899, "link": "https://stackoverflow.com/questions/47796899/vba-compile-error-else-without-if/47797059#47797059", "title": "VBA Compile error: else without if", "body": "<p>The whole thing can be greatly simplified by moving the <code>rs</code> loop outside of the <code>If..Else..Endif</code>.</p>\n\n<pre><code>Dim notesSQL As QueryDef\nDim Row As Integer\nDim Column, targetCell As String\nSet notesSQL = Db.QueryDefs(\"Export_Table_Notes_Filter\")\nSet rs = notesSQL.OpenRecordset()\n\nRow = 0\nIf Insp_Template_No.Value = \"Hazardous Area Equipment Detailed Inspection (Ex 'I' Ex 'iD' Ex 'nL)\" Then\n    Column = \"b\"\n    Row = 16\nElseIf Insp_Template_No.Value = \"Hazardous Area Equipment Visual Inspection (Ex 'd' and Ex 'e')\" Then\n    Column = \"c\"\n    Row = 15\nElseIf Insp_Template_No.Value = \"Hazardous Area Equipment Close Inspection (Ex 'I' Ex 'iD' Ex 'nL)\" Then\n    Column = \"b\"\n    Row = 15\nElse\n    MsgBox (\"Unrecognised inspection template\")\nEnd If\n\nIf Row &gt; 0 Then\n    Do Until rs.EOF\n        targetCell = (Column &amp; Row)\n        With wsheet\n        .Range(targetCell).CopyFromRecordset rs\n        End With\n\n        targetCell = (Count + 1)\n        rs.Movenext\n    Loop\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 591, "user_id": 528166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/af5c49716ea922c52948c647aa815872?s=128&d=identicon&r=PG", "display_name": "Christopher Long", "link": "https://stackoverflow.com/users/528166/christopher-long"}, "edited": false, "score": 0, "creation_date": 1513181486, "post_id": 47797377, "comment_id": 82555886, "body": "This is perfect. I&#39;m new to coding, and haven&#39;t used <code>SELECT... CASE</code> yet. After reading your answer I will be replacing a lot of my &quot;Redundant&quot; loops. Thanks!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1513181571, "last_edit_date": 1513181571, "creation_date": 1513180889, "answer_id": 47797377, "question_id": 47796899, "link": "https://stackoverflow.com/questions/47796899/vba-compile-error-else-without-if/47797377#47797377", "title": "VBA Compile error: else without if", "body": "<p>The entire loop is redundant, since <code>.CopyFromRecordset</code> moves the recordset to <code>.EOF</code>. Remove it. Furthermore, the code can be improved by using a <code>SELECT ... CASE</code></p>\n\n<pre><code>Dim notesSQL As QueryDef\nDim Row As Integer\nDim Column, targetCell As String\nSet notesSQL = Db.QueryDefs(\"Export_Table_Notes_Filter\")\nSet rs = notesSQL.OpenRecordset()\n\nRow = 0\nSelect Case Insp_Template_No.Value \nCase \"Hazardous Area Equipment Detailed Inspection (Ex 'I' Ex 'iD' Ex 'nL)\"\n    Column = \"b\"\n    Row = 16\nCase \"Hazardous Area Equipment Visual Inspection (Ex 'd' and Ex 'e')\" \n    Column = \"c\"\n    Row = 15\nCase \"Hazardous Area Equipment Close Inspection (Ex 'I' Ex 'iD' Ex 'nL)\" \n    Column = \"b\"\n    Row = 15\nCase Else\n    MsgBox (\"Unrecognised inspection template\")\nEnd Select\n\nIf Row &gt; 0 Then\n   targetCell = (Column &amp; Row)\n   wsheet.Range(targetCell).CopyFromRecordset rs\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 591, "user_id": 528166, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/af5c49716ea922c52948c647aa815872?s=128&d=identicon&r=PG", "display_name": "Christopher Long", "link": "https://stackoverflow.com/users/528166/christopher-long"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "closed_date": 1513193571, "accepted_answer_id": 47797377, "answer_count": 3, "score": 0, "last_activity_date": 1513181571, "creation_date": 1513179431, "last_edit_date": 1513179835, "question_id": 47796899, "link": "https://stackoverflow.com/questions/47796899/vba-compile-error-else-without-if", "closed_reason": "Not suitable for this site", "title": "VBA Compile error: else without if", "body": "<p>I'm getting the </p>\n\n<blockquote>\n  <p>Compile error: else without if</p>\n</blockquote>\n\n<p>error on the first <code>ElseIf</code> in the following code block. As far as I'm aware the structure is correct, I have tried removing the white space and indentation with no luck. What am I missing?</p>\n\n<pre><code>Dim notesSQL As QueryDef\nDim Row As Integer\nDim Column, targetCell As String\nSet notesSQL = db.QueryDefs(\"Export_Table_Notes_Filter\")\nSet rs = notesSQL.OpenRecordset()\n\nIf Insp_Template_No.Value = \"Hazardous Area Equipment Detailed Inspection (Ex 'I' Ex 'iD' Ex 'nL)\" Then\n    Column = \"b\"\n    Row = 16\n\n    Do Until rs.EOF\n        targetCell = (Column &amp; Row)\n        With wsheet\n        .Range(targetCell).CopyFromRecordset rs\n        End With\n\n        targetCell = (count + 1)\nElseIf Insp_Template_No.Value = \"Hazardous Area Equipment Visual Inspection (Ex 'd' and Ex 'e')\" Then\n    Column = \"c\"\n    Row = 15\n\n    Do Until rs.EOF\n        targetCell = (Column &amp; Row)\n        With wsheet\n        .Range(targetCell).CopyFromRecordset rs\n        End With\n\n        targetCell = (count + 1)\nElseIf Insp_Template_No.Value = \"Hazardous Area Equipment Close Inspection (Ex 'I' Ex 'iD' Ex 'nL)\" Then\n    Column = \"b\"\n    Row = 15\n\n    Do Until rs.EOF\n        targetCell = (Column &amp; Row)\n        With wsheet\n        .Range(targetCell).CopyFromRecordset rs\n        End With\n\n        targetCell = (count + 1)\nElse\n    MsgBox (\"Unrecognised inspection template\")\nEnd If\n\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "date", "object"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1513178437, "post_id": 47796394, "comment_id": 82553883, "body": "<code>Worskheet</code>...?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1513178615, "post_id": 47796394, "comment_id": 82554015, "body": "Use <code>Now</code> instead of <code>today</code>"}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 7667649, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/831275645/picture?type=large", "display_name": "Mauro", "link": "https://stackoverflow.com/users/7667649/mauro"}, "edited": false, "score": 0, "creation_date": 1513178851, "post_id": 47796461, "comment_id": 82554170, "body": "It worked too, thanks. so, CVDate returns a date object and format a string?"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1513179295, "last_edit_date": 1513179295, "creation_date": 1513178140, "answer_id": 47796461, "question_id": 47796394, "link": "https://stackoverflow.com/questions/47796394/error-storing-a-date-in-an-object-using-workday-function/47796461#47796461", "title": "Error storing a date in an object using workday function", "body": "<p>You need quotes around <code>\"dd/mm/aaa\"</code> (which I think should actually be <code>\"dd/mm/yyyy\"</code>)</p>\n\n<p>You also may want to use this instead since <code>Format</code> returns a string, not a date:</p>\n\n<pre><code>currentday = CVDate(Format(WorksheetFunction.WorkDay(Now(), -1), \"dd/mm/yyyy\"))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 323, "user_id": 7667649, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/831275645/picture?type=large", "display_name": "Mauro", "link": "https://stackoverflow.com/users/7667649/mauro"}, "edited": false, "score": 0, "creation_date": 1513178676, "post_id": 47796500, "comment_id": 82554053, "body": "It worked, thanks, could you tell me why I have to use variant format in this case?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1513180996, "post_id": 47796500, "comment_id": 82555553, "body": "Depending on whether you need the time it may be better to use <code>Date()</code> rather than <code>Now()</code>.  E.g. <code>Now()</code> will return <code>13&#47;12&#47;2017 16:00:33</code> while <code>Date</code> returns <code>13&#47;12&#47;2017</code>  The formatting may differ depending on locale and I&#39;m not sure of the difference between <code>Now</code> and <code>Now()</code> - both return the same and <code>Vartype()</code> says they&#39;re both date variable types."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1513178886, "last_edit_date": 1513178886, "creation_date": 1513178268, "answer_id": 47796500, "question_id": 47796394, "link": "https://stackoverflow.com/questions/47796394/error-storing-a-date-in-an-object-using-workday-function/47796500#47796500", "title": "Error storing a date in an object using workday function", "body": "<p>You seem to be trying to format Today, I would replace that with Now() and it works as expected.</p>\n\n<p>Change your code to the following:</p>\n\n<pre><code>Sub newsub()\nDim currentday As Date\ncurrentday = Format(Now() - 1, \"dd/mm/yyyy\") 'use Now() and format to your liking to get the right date\nMsgBox currentday \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1513179008, "creation_date": 1513179008, "answer_id": 47796764, "question_id": 47796394, "link": "https://stackoverflow.com/questions/47796394/error-storing-a-date-in-an-object-using-workday-function/47796764#47796764", "title": "Error storing a date in an object using workday function", "body": "<blockquote>\n<pre><code>WorskheetFunction.WorkDay\n</code></pre>\n</blockquote>\n\n<p>You have a typo here, VBA runtime doensn't know what to resolve <code>WorkskheetFunction</code> to, and <strong>because Option Explicit isn't specified</strong>, it's creating an undeclared variable on-the-fly, an implicit <code>Variant</code> whose underlying type depends on how and where you're using it.</p>\n\n<p>And because <code>ABC.XYZ(foo, bar)</code> can only grammatically be a member call on some object, VBA runtime expects <code>WorkskheetFunction</code> to be an object, and it isn't - it's never assigned, so its underlying type is <code>Variant/Empty</code>, which isn't an object - hence, an \"Object Required\" error is thrown.</p>\n\n<h3>Always use Option Explicit.</h3>\n\n<p>Then you won't be happily compiling and running code with typos.</p>\n\n<p>You could also leverage IntelliSense to help prevent typos, by qualifying <code>WorksheetFunction</code> with the global <code>Application</code> object:</p>\n\n<pre><code>Application.WorksheetFunction.WorkDay(...)\n</code></pre>\n\n<p>That way you get autocomplete/IntelliSense when you type the <code>.</code> dot. Another difference is that if the worksheet function throws an error, with this early-bound syntax you'll get an actual VBA runtime error, whereas with the late-bound syntax you're using (with which you're not getting parameter tooltips / intellisense) if the function results in an error value it will <em>return</em> an error and make an invalid assignment to a <code>Date</code> variable, throwing a potentially confusing \"Type Mismatch\" error.</p>\n"}], "owner": {"reputation": 323, "user_id": 7667649, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/831275645/picture?type=large", "display_name": "Mauro", "link": "https://stackoverflow.com/users/7667649/mauro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 47796764, "answer_count": 3, "score": 0, "last_activity_date": 1513197993, "creation_date": 1513177978, "last_edit_date": 1531164843, "question_id": 47796394, "link": "https://stackoverflow.com/questions/47796394/error-storing-a-date-in-an-object-using-workday-function", "title": "Error storing a date in an object using workday function", "body": "<p>I have the following simple code:</p>\n\n<pre><code>    Sub newsub()\n\nDim currentday As Date\nDim cd As String\n\ncurrentday = Format(WorskheetFunction.WorkDay(today, -1), dd / mm / aaaa)\ncd = currentday\nMsgBox cd\n\nEnd Sub\n</code></pre>\n\n<p>But I get  </p>\n\n<blockquote>\n  <p>424 ERROR: AN OBJECT IS REQUIRED</p>\n</blockquote>\n\n<p>Anyone could tell me why is this happening?</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 5720226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ULfHZ.jpg?s=128&g=1", "display_name": "Isabella", "link": "https://stackoverflow.com/users/5720226/isabella"}, "edited": false, "score": 0, "creation_date": 1513247394, "post_id": 47797131, "comment_id": 82583380, "body": "Hi, thank you for this but I tried it and it didn&#39;t work. I also updated the question."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 455, "user_id": 5720226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ULfHZ.jpg?s=128&g=1", "display_name": "Isabella", "link": "https://stackoverflow.com/users/5720226/isabella"}, "edited": false, "score": 0, "creation_date": 1513249601, "post_id": 47797131, "comment_id": 82584851, "body": "I have tried and tested the above solution, it does work for me,... you are not able to call a function straight through the hyperlink click, but what you can do is add the hyperlink and have the Worksheet_FollowHyperlink do the unhiding for you before following to do the selection (got to the relevant sheet)... If you need a better walk-through as to how to implement the above solution, I can update my answer with some step by step guide?"}, {"owner": {"reputation": 455, "user_id": 5720226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ULfHZ.jpg?s=128&g=1", "display_name": "Isabella", "link": "https://stackoverflow.com/users/5720226/isabella"}, "edited": false, "score": 0, "creation_date": 1513260856, "post_id": 47797131, "comment_id": 82592208, "body": "Hi Xabier, I may need the step by step guide for this. Hoping for your understanding, I&#39;m really new to this. Thank you so much."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 455, "user_id": 5720226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ULfHZ.jpg?s=128&g=1", "display_name": "Isabella", "link": "https://stackoverflow.com/users/5720226/isabella"}, "edited": false, "score": 0, "creation_date": 1513261756, "post_id": 47797131, "comment_id": 82592800, "body": "@WandaMaximoff I&#39;ve updated my answer and gave you step by step scenario of how I set it up, please have a look and give it a try, I&#39;m sure you&#39;ll get it working... :)"}, {"owner": {"reputation": 455, "user_id": 5720226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ULfHZ.jpg?s=128&g=1", "display_name": "Isabella", "link": "https://stackoverflow.com/users/5720226/isabella"}, "edited": false, "score": 0, "creation_date": 1513263175, "post_id": 47797131, "comment_id": 82593850, "body": "Hi Xabier, I think I&#39;m starting to understand the logic. I&#39;m still trying this out. I will update you if I got it working or if I have further questions. Thank you :)"}, {"owner": {"reputation": 455, "user_id": 5720226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ULfHZ.jpg?s=128&g=1", "display_name": "Isabella", "link": "https://stackoverflow.com/users/5720226/isabella"}, "edited": false, "score": 0, "creation_date": 1513265161, "post_id": 47797131, "comment_id": 82595179, "body": "Hi Xabier, it is now working. Thank you for the detailed explanation. This means a lot to me."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1513261706, "last_edit_date": 1592644375, "creation_date": 1513180114, "answer_id": 47797131, "question_id": 47796339, "link": "https://stackoverflow.com/questions/47796339/insert-hyperlink-in-a-cell-and-open-a-hidden-sheet-excel-vba/47797131#47797131", "title": "Insert hyperlink in a cell and open a hidden sheet [Excel VBA]", "body": "<p>To create the hyperlinks dynamically into Sheet1 you would need to use something like the following:</p>\n<pre><code>Sub foo()\nDim ws As Worksheet\ni = 1\n    For Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; &quot;Sheet1&quot; Then\n        Sheet1.Cells(i, 1).Hyperlinks.Add Anchor:=Sheet1.Cells(i, 1), Address:=&quot;&quot;, SubAddress:=ws.Name &amp; &quot;!A1&quot;, TextToDisplay:=&quot;Go To:&quot;\n        i = i + 1\n    End If\n    Next\nEnd Sub\n</code></pre>\n<p>Then you would need to also change the Worksheet_FollowHyperlink to see if the hyperlink has been clicked and if so unhide the Sheet and show it. Something like the following:</p>\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    If Target.Range.Address = &quot;$A$2&quot; Then\n        Sheet2.Visible = xlSheetVisible\n        Sheet2.Select\n    End If\n    'copy the if statement above for each hyperlink\nEnd Sub\n</code></pre>\n<p><strong>UPDATE:</strong></p>\n<p>So in my testing I have 5 sheets all of them xlSheetVeryHidden apart from the first one that is called &quot;Main&quot;, when I run the macro below the following hyperlinks are created:</p>\n<pre><code>Sub foo()\nDim ws As Worksheet\ni = 1\n    For Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; &quot;Main&quot; Then\n        Sheets(&quot;Main&quot;).Cells(i, 1).Hyperlinks.Add Anchor:=Sheet1.Cells(i, 1), Address:=&quot;&quot;, SubAddress:=ws.Name &amp; &quot;!A1&quot;, TextToDisplay:=&quot;Go To:&quot;\n        i = i + 1\n    End If\n    Next\nEnd Sub\n</code></pre>\n<p>The code above creates the following (ignoring the first sheet &quot;Main&quot;):</p>\n<p><a href=\"https://i.stack.imgur.com/nMhuB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nMhuB.png\" alt=\"enter image description here\" /></a></p>\n<p>Then behind the first Sheet's code I entered this code:</p>\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    If Target.Range.Address = &quot;$A$2&quot; Then\n        Sheet2.Visible = xlSheetVisible\n        Sheet2.Select\n    End If\n    'copy the if statement above for each hyperlink\nEnd Sub\n</code></pre>\n<p>This is where I placed the code:</p>\n<p><a href=\"https://i.stack.imgur.com/CWW6p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CWW6p.png\" alt=\"enter image description here\" /></a></p>\n<p>The issue with this set up, is that even though the hyperlinks can be created dynamically by the macro foo(), to change the visibility you would have to manually add each Target.Range.Address to unhide the relevant sheet, so in my example I've only coded it so that if the user clicks on A2 of Sheet 1, which contains the hyperlink, then Sheet2 would become visible and you would navigate to it...</p>\n"}], "owner": {"reputation": 455, "user_id": 5720226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ULfHZ.jpg?s=128&g=1", "display_name": "Isabella", "link": "https://stackoverflow.com/users/5720226/isabella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3656, "favorite_count": 0, "accepted_answer_id": 47797131, "answer_count": 1, "score": 0, "last_activity_date": 1513261706, "creation_date": 1513177828, "last_edit_date": 1513247363, "question_id": 47796339, "link": "https://stackoverflow.com/questions/47796339/insert-hyperlink-in-a-cell-and-open-a-hidden-sheet-excel-vba", "title": "Insert hyperlink in a cell and open a hidden sheet [Excel VBA]", "body": "<p>I'm new to excel VBA and I am trying to accomplish inserting a hyperlink in a cell using a VBA code. Upon clicking that value, I want to be able to open a hidden sheet. </p>\n\n<p>What I have accomplished so far is this: open a hidden sheet using <strong><em>buttons</em></strong>.</p>\n\n<pre><code>Sub mainModule(ByVal a_Sheets As String)\n\n'Hide all tabs\nFor Each sht In ActiveWorkbook.Sheets\nIf sht.Name &lt;&gt; \"MAIN\" Then sht.Visible = xlSheetVeryHidden\nNext\n\n'View tabs when button is clicked\nFor i = 0 To UBound(Split(a_Sheets, \",\"))\nSheets(Split(a_Sheets, \",\")(i)).Visible = True\nSheets(Split(a_Sheets, \",\")(i)).Activate\nNext\n\nEnd Sub\n\nSub goHere_Click()\n\nCall mainModule(\"BIRTHDAYS\")\n\nEnd Sub\n</code></pre>\n\n<p>What I want to do is when I click \"GO HERE\", it will open the hidden sheet.</p>\n\n<h2>  <a href=\"https://i.stack.imgur.com/xAHfF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xAHfF.png\" alt=\"enter image description here\"></a></h2>\n\n<p>Moreover, I found something that might help me solve this.</p>\n\n<pre><code>Sub sbCreatingHyperLink()\nActiveSheet.Hyperlinks.Add Range(\"A5\"), \"https://www.google.com\"\nEnd Sub\n</code></pre>\n\n<p>Could help me figure out a way wherein instead of \"<a href=\"https://www.google.com\" rel=\"nofollow noreferrer\">https://www.google.com</a>\", it will call a function module instead (<code>Call mainModule(\"BIRTHDAYS\")</code>)? Thank you.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "office365"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1513177297, "post_id": 47796046, "comment_id": 82553076, "body": "You are not cumulatively adding the number of cells of all previous ranges, e.g. <code>Range(&quot;O&quot; &amp; RngB.Count + 1)</code> does not take into account the size of RngA."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1513177476, "post_id": 47796046, "comment_id": 82553208, "body": "Any reason you don&#39;t use the <a href=\"https://support.office.com/en-us/article/CONCATENATE-function-8f8ae884-2ca8-4f7a-b093-75d702bea31d\" rel=\"nofollow noreferrer\"><code>CONCATENATE()</code> function</a> as formula instead of VBA? In column O use <code>=CONCATENATE(I:I, J:J, K:K, L:L)</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1513177741, "post_id": 47796046, "comment_id": 82553391, "body": "@Peh CONCATENATE will  not line each column below the next it will return all four of that row in the one cell."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513177932, "post_id": 47796046, "comment_id": 82553536, "body": "@ScottCraner you can activate line breaks in column O and use <code>=CONCATENATE(I:I, &quot;#&quot;, J:J, &quot;#&quot;, K:K, &quot;#&quot;, L:L)</code> where the <code>#</code> has to be replaced by a line break (Alt+Enter) so this is possible (I just can&#39;t show it here due to formatting issues in comments)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1513178026, "post_id": 47796046, "comment_id": 82553606, "body": "@Peh but that will still put all four of the current row in one cell with line breaks.  not each value in its own cell so it can be sorted properly."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513178229, "post_id": 47796046, "comment_id": 82553745, "body": "@ScottCraner huh? then I obviously misunderstood his goal :( my apologize"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1513178362, "post_id": 47796046, "comment_id": 82553839, "body": "@Peh - the OP wants the first column of x items at the top of column O, then the next column of y items underneath those in column O etc."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513178566, "post_id": 47796046, "comment_id": 82553970, "body": "@SJR ya thanks I got it after I saw your code. Just got on the wrong track early."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9094406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f078690f85bbcda6a3127f78f48818?s=128&d=identicon&r=PG&f=1", "display_name": "JayJay", "link": "https://stackoverflow.com/users/9094406/jayjay"}, "edited": false, "score": 1, "creation_date": 1513178483, "post_id": 47796377, "comment_id": 82553921, "body": "Thanks for the fast solution! It works like a charm :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1513177936, "creation_date": 1513177936, "answer_id": 47796377, "question_id": 47796046, "link": "https://stackoverflow.com/questions/47796046/combine-specific-columns-variable-length-into-one-column-excel-vba/47796377#47796377", "title": "Combine specific columns (variable length) into one column - excel VBA", "body": "<p>See my comment above, but here is an alternative approach using arrays which saves having to set up multiple similarly-named range variables.(Btw am assuming everything is on the Keywords sheet.)</p>\n\n<pre><code>Sub Copy()\n\nDim vRng(1 To 4) As Range, i As Long\n\nWith Sheets(\"Keywords\")\n    For i = LBound(vRng) To UBound(vRng)\n        Set vRng(i) = .Range(.Cells(2, i + 8), .Cells(.Rows.Count, i + 8).End(xlUp))\n    Next i\n    For i = LBound(vRng) To UBound(vRng)\n        .Range(\"O\" &amp; Rows.Count).End(xlUp)(2).Resize(vRng(i).Count).Value = vRng(i).Value\n    Next i\n    .Columns(\"O:O\").Sort Key1:=.Range(\"O1\"), Order1:=xlAscending, Header:=xlYes\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9094406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f078690f85bbcda6a3127f78f48818?s=128&d=identicon&r=PG&f=1", "display_name": "JayJay", "link": "https://stackoverflow.com/users/9094406/jayjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 47796377, "answer_count": 1, "score": 0, "last_activity_date": 1513177936, "creation_date": 1513177009, "last_edit_date": 1513177351, "question_id": 47796046, "link": "https://stackoverflow.com/questions/47796046/combine-specific-columns-variable-length-into-one-column-excel-vba", "title": "Combine specific columns (variable length) into one column - excel VBA", "body": "<p>So the situation is that I would like to copy <strong>4 columns with variable lengths</strong> into one column containing all the data from these 4. The problem is I <strong>loose data</strong> in the process.</p>\n\n<p>As an example it should be 693 rows but I only get 648 rows all in all.\nI'm relatively new to VBA and have come up with these lines of code.</p>\n\n<pre><code>Sub Copy()\n\nDim RngA As Range, RngB As Range, RngC As Range, RngD As Range, Rng As Range\nSet RngA = Range(Range(\"I2\"), Range(\"I\" &amp; Rows.Count).End(xlUp))\nSet RngB = Range(Range(\"J2\"), Range(\"J\" &amp; Rows.Count).End(xlUp))\nSet RngC = Range(Range(\"K2\"), Range(\"K\" &amp; Rows.Count).End(xlUp))\nSet RngD = Range(Range(\"L2\"), Range(\"L\" &amp; Rows.Count).End(xlUp))\n    Range(\"O2\").Resize(RngA.Count).Value = RngA.Value\n    Range(\"O\" &amp; RngA.Count + 1).Resize(RngB.Count).Value = RngB.Value\n    Range(\"O\" &amp; RngB.Count + 1).Resize(RngC.Count).Value = RngC.Value\n    Range(\"O\" &amp; RngC.Count + 1).Resize(RngD.Count).Value = RngD.Value\n\n\nWith Sheets(\"Keywords\")\n    Columns(\"O:O\").Sort Key1:=.Range(\"=O1\"), Order1:=xlAscending, Header:=xlYes\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1513176323, "post_id": 47795655, "comment_id": 82552322, "body": "Note: You should research what <code>Application.EnableEvents = True</code> or <code>False</code> does and how many you need, where and why!"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1513176954, "post_id": 47795655, "comment_id": 82552802, "body": "You call the change event every time there&#39;s a recalculate event, and force the target to be A2. So whenever any cell changes your code runs. I don&#39;t see why you have this code?   Private Sub Worksheet_Calculate()     Worksheet_Change Range(&quot;A2&quot;) End Sub"}, {"owner": {"reputation": 3, "user_id": 9094337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16d84911e2b733a1ce69e2fcf32bf944?s=128&d=identicon&r=PG&f=1", "display_name": "David Shtern", "link": "https://stackoverflow.com/users/9094337/david-shtern"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513177231, "post_id": 47795655, "comment_id": 82553017, "body": "If I remove that code, it doesn&#39;t log anything. I think I have to force it to target A2? What would you suggest I use instead? @HarassedDad"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1513177607, "creation_date": 1513177607, "answer_id": 47796269, "question_id": 47795655, "link": "https://stackoverflow.com/questions/47795655/excel-creates-a-new-rowwith-data-from-the-first-row-when-there-is-a-change-in/47796269#47796269", "title": "Excel creates a new row(with data from the first row) when there is a change in A", "body": "<p>I've tested this and it does what you expect it to (replace your code with the following and remove the worksheet_calculate) Also you should probably change Sheet1 to whatever your Sheet is or even to ActiveSheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = Sheet1.Range(\"A2\").Address Then 'check to see if changes happend on A2\n        Application.EnableEvents = False\n        Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Sheet1.Range(\"A2\").Value 'copy the row from Row 2 to next empty row\n        Sheet1.Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Sheet1.Range(\"B2\").Value\n        Sheet1.Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Sheet1.Range(\"C2\").Value\n        Sheet1.Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Sheet1.Range(\"D2\").Value\n        Sheet1.Range(\"E\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Sheet1.Range(\"E2\").Value\n        Sheet1.Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Sheet1.Range(\"F2\").Value\n        Sheet1.Range(\"G\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Sheet1.Range(\"G2\").Value\n        Sheet1.Range(\"H\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Sheet1.Range(\"H2\").Value\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9094337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16d84911e2b733a1ce69e2fcf32bf944?s=128&d=identicon&r=PG&f=1", "display_name": "David Shtern", "link": "https://stackoverflow.com/users/9094337/david-shtern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 1, "accepted_answer_id": 47796269, "answer_count": 1, "score": 0, "last_activity_date": 1513177607, "creation_date": 1513175996, "last_edit_date": 1513176123, "question_id": 47795655, "link": "https://stackoverflow.com/questions/47795655/excel-creates-a-new-rowwith-data-from-the-first-row-when-there-is-a-change-in", "title": "Excel creates a new row(with data from the first row) when there is a change in A", "body": "<p>Amateur here - sorry if this is simple and I'm not getting it. </p>\n\n<p>So in my workbook I have a timer that updates every 3 mins In A2. In B2, C2, D2, etc. I have fluctuating values from plugins, that have a very fast refresh rate. </p>\n\n<p>I need a macro that will \"log\" the values in B2, C2 etc. as a new row, every time the value in A2 changes(with the time from the timer there also). Here is what I have so far(excluding timer macro, it works great):  </p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Worksheet_Change Range(\"A2\")\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"A2\")) Is Nothing Then\n        Application.EnableEvents = False\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Range(\"A2\").Value\n        Application.EnableEvents = True\n        Application.EnableEvents = False\n        Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Range(\"B2\").Value\n        Application.EnableEvents = True\n        Application.EnableEvents = False\n        Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Range(\"C2\").Value\n        Application.EnableEvents = True\n        Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Range(\"D2\").Value\n        Application.EnableEvents = True\n        Range(\"E\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Range(\"E2\").Value\n        Application.EnableEvents = True\n        Range(\"F\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Range(\"F2\").Value\n        Application.EnableEvents = True\n        Range(\"G\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Range(\"G2\").Value\n        Application.EnableEvents = True\n        Range(\"H\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = Range(\"H2\").Value\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>The problem with this code is that when I use the plug in to put in the values for B2, C2 etc, everything goes wild and it starts creating new rows(if you want to try this for yourself, put <code>=RANDBETWEEN(40,80)</code> as one of the values - it perfectly emulates the problem I face).</p>\n\n<p>Back to my question, how do I make the macro only create a new row when there is a change in A2?</p>\n\n<p>Any help is welcome, thanks you for your time! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513176135, "post_id": 47795596, "comment_id": 82552189, "body": "I would suggest using Text to Columns instead.  The issue is that vba likes the dates in <code>mm&#47;dd&#47;yyyy</code> format and tries to convert it as such.  so if your strings are in <code>dd&#47;mm&#47;yyyy</code> format vba does keeps it as a string."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513176271, "post_id": 47795596, "comment_id": 82552285, "body": "Or you can parse the string and make your own date in vba then assign that value and format.  If you give an example of your data, one that does not convert properly, we might be able to help more."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1513176700, "post_id": 47795596, "comment_id": 82552603, "body": "<code>.Cells(i, &quot;M&quot;).Value2 = Split(.Cells(i, &quot;L&quot;), &quot;,&quot;)(1)</code>"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513180476, "post_id": 47795596, "comment_id": 82555224, "body": "@Scott Craner I updated to show screenshot of excel, you can see that the two highlighted in yellow are unsuccessful, yet sandwiched between them is a successful result. What would also be good is to not copy to the new column anything that is not a date, you can see some comments have been taken."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1513217722, "post_id": 47795596, "comment_id": 82571340, "body": "How do you want to handle a string like <code>31&#47;2&#47;18</code> (in your first line), since that cannot be translated into a valid date?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1513248216, "post_id": 47795596, "comment_id": 82583972, "body": "@RonRosenfeld Ah so maybe this is why some of them are not converting? Would the input need to be 31/02/18?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1513252524, "post_id": 47795596, "comment_id": 82586735, "body": "That is not the issue.  The issue is that there is no such date as <code>31-Feb-2018</code>.  Most date functions will convert it to <code>3-March-2018</code>.  Is that what you want?  Or do you need to flag it as invalid?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1513254032, "post_id": 47795596, "comment_id": 82587684, "body": "@RonRosenfeld yes I guess it would need to be inavlid"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1513254080, "post_id": 47795596, "comment_id": 82587712, "body": "OK, I would do that with Regular Expressions, but I see that you have already marked an answer as correct."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513182757, "post_id": 47797866, "comment_id": 82556734, "body": "This for some reason does not split the dates in Column L to the new column M? Column M showing only as blank"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513183234, "post_id": 47797866, "comment_id": 82557080, "body": "@SDROB Sorry updated my answer, it didn&#39;t work because I was testing with Columns A and B, but it should now work... As long as the value for newLastRow is correct."}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513183589, "post_id": 47797866, "comment_id": 82557331, "body": "I still get the same issue? Column M is blank"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513252818, "post_id": 47797866, "comment_id": 82586908, "body": "The issue I am still having is that the dates are not ordering in the Pivot Table? Is there something else I can do to format so that I can then have the dates sorted as column headers?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513253177, "post_id": 47797866, "comment_id": 82587163, "body": "@SDROB so did my answer work for you? What do you mean the dates are not ordering?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513253993, "post_id": 47797866, "comment_id": 82587658, "body": "yes the solution worked, thanks! Sorry I did mention in initial question, the dates are needed so that they can be sorted as headers in a pivot in the next stage. But they do not sort correctly at all?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513254136, "post_id": 47797866, "comment_id": 82587761, "body": "Do you mean you want them sorted on Column M in ascending order? or... I&#39;m not sure I understand your requirement, can you update your question with a screenshot or something so I can see what&#39;s going on?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513254683, "post_id": 47797866, "comment_id": 82588124, "body": "updated to include headers that as you can see are not sorted chronologically, and when I analyse the dates using the =ISNUMBER function, not many come back as True"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513255051, "post_id": 47797866, "comment_id": 82588340, "body": "Can you share the code that places the dates there?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513263131, "post_id": 47797866, "comment_id": 82593819, "body": "included the code for the pivot in the original question"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513263229, "post_id": 47797866, "comment_id": 82593898, "body": "I can see a couple of issues with your code, can I ask what you are trying to do? get the data in ascending order for a pivot table, and then you would want to create a chart? Because if that&#39;s the case it would be a lot simpler to create the pivot manually and then refresh the source data programmatically?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513263466, "post_id": 47797866, "comment_id": 82594070, "body": "The idea was for the macro to produce the pivot table completely from scratch, and have the dates as column headers. Just these need to be sorted chronologically in ascending order.. Perhaps the second approach would be better in this case?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513263592, "post_id": 47797866, "comment_id": 82594160, "body": "I believe so, I&#39;ve got a similar set-up and it will be a lot fewer lines of code as you won&#39;t have to create and delete, just select whatever range you need to update the source data and voila, the pivot would be updated a lot quicker..."}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1513263707, "post_id": 47797866, "comment_id": 82594250, "body": "are you able to share how I would change this? And would this fix the issue of the column headers changing? These need to be dynamic as dates will change"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1513330462, "post_id": 47797866, "comment_id": 82621293, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/161279/discussion-between-sdrob-and-xabier\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1513185536, "last_edit_date": 1513185536, "creation_date": 1513182308, "answer_id": 47797866, "question_id": 47795596, "link": "https://stackoverflow.com/questions/47795596/excel-vba-code-not-pasting-as-date-values/47797866#47797866", "title": "Excel VBA code not pasting as date values", "body": "<p>I've tried this and it seems to do what you are expecting, it will loop through the cell one character at a time and if it contains anything apart from / or numbers, it will remove them, then it will format the cell as a date:</p>\n\n<pre><code>Sub foo()\nDim StartString As String\nDim DateValue As String\nDim y As Integer\nDim LastRow As Long\nWith Sheets(\"DataSheet\")\nLastRow = .Cells(.Rows.Count, \"L\").End(xlUp).Row 'find the last row on column L\n    .Columns(13).Insert Shift:=xlToRight 'add a new column to the right of column L\n    For i = 1 To LastRow 'loop through rows\n        If InStr(1, .Cells(i, \"L\"), \",\") Then\n            .Cells(i, \"M\").Value = Split(.Cells(i, \"L\"), \",\")(1) 'split after comma\n            StartString = .Cells(i, \"L\").Value\n            DateValue = \"\"\n            For y = 1 To Len(StartString) 'loop to remove unwanted characters\n                Select Case Asc(Mid(StartString, y, 1))\n                    Case 47 To 57\n                        DateValue = DateValue &amp; Mid(StartString, y, 1)\n                End Select\n            Next y\n        .Cells(i, \"M\").Value = DateValue 'return the date\n        .Cells(i, \"M\").NumberFormat = \"dd/mm/yyyy\" 'format it correctly\n        End If\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n\n<p>If your code does insert the column and populates the cells with all the data after the comma, then you can simply include the following to your code and it should then work for you too:</p>\n\n<pre><code>StartString = .Cells(i, \"L\").Value\nDateValue = \"\"\nFor y = 1 To Len(StartString) 'loop to remove unwanted characters\n    Select Case Asc(Mid(StartString, y, 1))\n    Case 47 To 57\n        DateValue = DateValue &amp; Mid(StartString, y, 1)\n    End Select\nNext y\n.Cells(i, \"M\").Value = DateValue 'return the date\n.Cells(i, \"M\").NumberFormat = \"dd/mm/yyyy\" 'format it correctly\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 47797866, "answer_count": 1, "score": 0, "last_activity_date": 1513262321, "creation_date": 1513175825, "last_edit_date": 1513262321, "question_id": 47795596, "link": "https://stackoverflow.com/questions/47795596/excel-vba-code-not-pasting-as-date-values", "title": "Excel VBA code not pasting as date values", "body": "<p>I have the following code creating new column \"M\" and pasting date values from column \"L\" to it after comma delimiter. Issue is not all values are pasted as numerical dates, although they appear as such. Causing me issues further down the line where I am creating a pivot and need to sort column headers by date. Also some dates only have date as yy instead of yyyy</p>\n\n<pre><code>With Sheets(\"DataSheet\")\n\nnewLastRow = pasteRowIndex\n\nIf IsArray(v) Then\n    .Columns(13).Insert Shift:=xlToRight\n     For i = 1 To newLastRow\n       If InStr(1, .Cells(i, \"L\"), \",\") Then\n        .Cells(i, \"M\").Value = Split(.Cells(i, \"L\"), \",\")(1)\n</code></pre>\n\n<p>Not sure if this next line is correct</p>\n\n<pre><code>        Cells(i, \"M\").NumberFormat = \"dd/mm/yyyy\"\n        End If\n    Next i\nEnd If \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NbU5s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NbU5s.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/F2T93.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F2T93.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>  Dim PSheet As Worksheet\n  Dim DSheet As Worksheet\n  Dim PCache As PivotCache\n  Dim PTable As PivotTable\n  Dim PRange As Range\n  Dim LastRow1 As Long\n  Dim LastCol As Long\n\n\n  'Insert a New Blank Worksheet\n  On Error Resume Next\n  Application.DisplayAlerts = False\n  Worksheets(\"PivotTable\").Delete\n  Sheets.Add Before:=ActiveSheet\n  ActiveSheet.Name = \"PivotTable\"\n  Application.DisplayAlerts = True\n  'Switch off error masking\n  On Error GoTo 0\n  Set PSheet = Worksheets(\"PivotTable\")\n  Set DSheet = Worksheets(\"DataSheet\")\n\n  'With DSheet\n\n\n  'Define Data Range\n  LastRow1 = DSheet.Cells(Rows.Count, \"B\").End(xlUp).Row\n  LastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n  Set PRange = DSheet.Cells(1, \"B\").Resize(LastRow, 20)\n\n  'Define Pivot Cache\n  Set PCache = ActiveWorkbook.PivotCaches.Create _\n      (SourceType:=xlDatabase, SourceData:=PRange)\n\n\n  'Insert Blank Pivot Table\n  Set PTable = PCache.CreatePivotTable _\n      (TableDestination:=PSheet.Cells(1, 1), TableName:=\"MilestonePivotTable\")\n\n\n  'Insert Row Fields\n\n  With PTable.PivotFields(\"Contract Identifier\")\n      .Orientation = xlRowField\n      .Position = 1\n  End With\n\n\n  With PTable.PivotFields(\"SOW ID\")\n      .Orientation = xlRowField\n      .Position = 2\n  End With\n\n  With PTable.PivotFields(\"Resource Name\")\n      .Orientation = xlRowField\n      .Position = 3\n  End With\n\n\n  With PTable.PivotFields(\"Deliverable\")\n      .Orientation = xlRowField\n      .Position = 4\n  End With\n\n  'Insert Column Fields\n  With PTable.PivotFields(\"Milestone Date\")\n      .Orientation = xlColumnField\n      .Position = 1\n  End With\n\n  ActiveSheet.PivotTables(\"MilestonePivotTable\").PivotFields(\"Milestone \n  Date\").AutoSort xlAscending, \"Milestone Date\"\n\n  'Insert Data Field\n    With PTable.PivotFields(\"Milestone Date\")\n               .Orientation = xlDataField\n               .NumberFormat = \"0\"\n           End With\n\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "directory", "spreadsheet"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7762933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz1MA77x9Ag/AAAAAAAAAAI/AAAAAAAAAI4/PUJ0ZaB-kRk/photo.jpg?sz=128", "display_name": "Ramon Mueses", "link": "https://stackoverflow.com/users/7762933/ramon-mueses"}, "edited": false, "score": 0, "creation_date": 1513191537, "post_id": 47797223, "comment_id": 82561719, "body": "Thank you DevK... Unfortunately it still doesn&#39;t switch/loop through the sheets. It definitely goes to every workbook in the folder and formats the sheet that was last active before closing/saving the individual workbooks."}, {"owner": {"reputation": 16, "user_id": 8712649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/937f8bc2bf4ef5b7244af80af271db36?s=128&d=identicon&r=PG&f=1", "display_name": "devKarthikeyanR", "link": "https://stackoverflow.com/users/8712649/devkarthikeyanr"}, "reply_to_user": {"reputation": 11, "user_id": 7762933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz1MA77x9Ag/AAAAAAAAAAI/AAAAAAAAAI4/PUJ0ZaB-kRk/photo.jpg?sz=128", "display_name": "Ramon Mueses", "link": "https://stackoverflow.com/users/7762933/ramon-mueses"}, "edited": false, "score": 0, "creation_date": 1513282306, "post_id": 47797223, "comment_id": 82605105, "body": "Added a new line WS.activate. Please try with this code and let me know"}], "tags": [], "owner": {"reputation": 16, "user_id": 8712649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/937f8bc2bf4ef5b7244af80af271db36?s=128&d=identicon&r=PG&f=1", "display_name": "devKarthikeyanR", "link": "https://stackoverflow.com/users/8712649/devkarthikeyanr"}, "is_accepted": false, "score": 0, "last_activity_date": 1513282258, "last_edit_date": 1513282258, "creation_date": 1513180431, "answer_id": 47797223, "question_id": 47795590, "link": "https://stackoverflow.com/questions/47795590/loop-through-worksheets-in-workbooks-in-a-folder/47797223#47797223", "title": "Loop through worksheets in workbooks in a folder", "body": "<p>If you use thisworkbook, this will only loop the sheets in the Macro File(Excel Fiel where Code Written). So You need to pass the workbook <strong>WorkSheetChange00 wb</strong> and loop that workbook (<strong>WorkSheetChange00(wb as Workbook)</strong>). </p>\n\n<pre><code>Sub WorkSheetChange00(wb as Workbook)\n  Dim WS As Worksheet\n  For Each WS In wb.Worksheets\n     WS.activate\n     Format\n  Next WS\nEnd Sub\n\nSub DarFormatoExelsEnFolder()\n Dim wb As Workbook\n Dim myPath As String\n Dim myFile As String\n Dim myExtension As String\n Dim FldrPicker As FileDialog\n\n 'Optimizar Macro\n Application.ScreenUpdating = False\n Application.EnableEvents = False\n Application.Calculation = xlCalculationManual\n\n'Definir carpeta destino\n Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n With FldrPicker\n  .Title = \"Select A Target Folder\"\n  .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\n End With\n\n NextCode:\n myPath = myPath\nIf myPath = \"\" Then GoTo ResetSettings\n\nmyExtension = \"*.xlsx*\"\nmyFile = Dir(myPath &amp; myExtension)\n\nDo While myFile &lt;&gt; \"\"\n'Variable de libro abierto\n  Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n'Confirmaci\u00f3n de libro abierto\n  DoEvents\n\n'Cambios al Workbook\n\nWorkSheetChange00 wb\n\n 'Guardar y cerrar Workbook actual\n  wb.Close SaveChanges:=True\n\n'Confirmaci\u00f3n de libro cerrado\n  DoEvents\n\n'Proximo libro\n  myFile = Dir\n Loop\n\n 'Aviso de fin de ejecuci\u00f3n\n MsgBox \"Operaci\u00f3n Completada\"\n\nResetSettings:\n'Normalizar excel\n Application.EnableEvents = True\n Application.Calculation = xlCalculationAutomatic\n Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7762933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz1MA77x9Ag/AAAAAAAAAAI/AAAAAAAAAI4/PUJ0ZaB-kRk/photo.jpg?sz=128", "display_name": "Ramon Mueses", "link": "https://stackoverflow.com/users/7762933/ramon-mueses"}, "is_accepted": false, "score": 0, "last_activity_date": 1513273217, "creation_date": 1513273217, "answer_id": 47819221, "question_id": 47795590, "link": "https://stackoverflow.com/questions/47795590/loop-through-worksheets-in-workbooks-in-a-folder/47819221#47819221", "title": "Loop through worksheets in workbooks in a folder", "body": "<p><strong><em>Eureka!!!</em></strong>\n1. This VBA will ask for a folder\n2. Loop Through all the files that end in \".xlsx\"\n   2.0 In each sheet of every workbook\n   2.1 Format first line as table headers\n   2.2 Inserts 5 rows (shifts down)\n   2.3 Adds an image from range and 3 labels (from macro origin workbook)\n   2.4 and a 4th label that marks the name of the sheet and last modified date/time.</p>\n\n<p>And last but not least, it prompts \"Task Completed\" (in Spanish)..lol...</p>\n\n<p><em>And if you run again it will skip the files/sheets that all ready have the \"Company Name\" (aka:range.(\"C1\") ) in C1 per sheet...</em></p>\n\n<p><strong><em>Feel free to mod to your liking..</em></strong></p>\n\n<p>In 2 subs...</p>\n\n<p>Here is the working code (paste in standard module):</p>\n\n<pre><code>Sub DarFormatoExelsEnFolder()\n Dim wb As Workbook\n Dim myPath As String\n Dim myFile As String\n Dim myExtension As String\n Dim FldrPicker As FileDialog\n\n'Optimizar Macro\n Application.ScreenUpdating = False\n Application.EnableEvents = False\n Application.Calculation = xlCalculationManual\n\n'Definir carpeta destino\n Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n With FldrPicker\n  .Title = \"Select A Target Folder\"\n  .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\n End With\n\nNextCode:\n myPath = myPath\nIf myPath = \"\" Then GoTo ResetSettings\n\nmyExtension = \"*.xlsx*\"\nmyFile = Dir(myPath &amp; myExtension)\n\nDo While myFile &lt;&gt; \"\"\n'Variable de libro abierto\n  Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n'Confirmaci\u00f3n de libro abierto\n  DoEvents\n\n'Cambios al Workbook\n\nFormat wb\n\n'Guardar y cerrar Workbook actual\n  wb.Close SaveChanges:=True\n\n'Confirmaci\u00f3n de libro cerrado\n  DoEvents\n\n'Proximo libro\n  myFile = Dir\n Loop\n\n'Aviso de fin de ejecuci\u00f3n\n MsgBox \"Operaci\u00f3n Completada\"\n\nResetSettings:\n'Normalizar excel\n Application.EnableEvents = True\n Application.Calculation = xlCalculationAutomatic\n Application.ScreenUpdating = True\n\nEnd Sub\n'_______________________________________________________\n\nSub Format(wb As Workbook)\nDim i As Integer\nDim ws_num As Integer\n\nDim starting_ws As Worksheet\nSet starting_ws = ActiveSheet 'remember which worksheet is active in the beginning\nws_num = ActiveWorkbook.Worksheets.Count\n\nFor i = 1 To ws_num\n    ActiveWorkbook.Worksheets(i).Activate\n\nIf Range(\"C1\") &lt;&gt; \"Company Name\" Then\n\n 'Sheet format start\n\n  Cells.Select\n    Cells.EntireColumn.AutoFit\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Font.Bold = True\n\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 15773696\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    With Selection.Font\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = 0\n    End With\n    Rows(\"1:5\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    With Selection.Font\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n    End With\n    'Pega o Llena informaci\u00f3n y logo predeterminados\n    Workbooks(\"REPORTE.xlsm\").Worksheets(\"BACKEND\").Range(\"F3:F3\").Copy Destination:=Range(\"C1\")\n        Workbooks(\"REPORTE.xlsm\").Worksheets(\"BACKEND\").Range(\"F4:F4\").Copy Destination:=Range(\"C2\")\n            Workbooks(\"REPORTE.xlsm\").Worksheets(\"BACKEND\").Range(\"F5:F5\").Copy Destination:=Range(\"C3\")\n                Workbooks(\"REPORTE.xlsm\").Worksheets(\"BACKEND\").Range(\"LogoBR\").Copy Destination:=Range(\"A1\")\n    Range(\"C4\").Select\n    ActiveCell.FormulaR1C1 = ActiveSheet.Name &amp; \" - Actualizado el: \" &amp; ActiveWorkbook.BuiltinDocumentProperties(\"Last Save Time\")\n    Range(\"C1:C4\").Select\n    Range(\"C4\").Activate\n    Selection.Font.Bold = True\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\nEnd If\n    'Sheet format end\n\nRange(\"A1\").Select\n    With Selection.Font\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = 0\n    End With\n'Numera las hojas\n    ActiveWorkbook.Worksheets(i).Cells(1, 1) = 1\nNext\n'reactiva hoja inicial\nstarting_ws.Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7762933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz1MA77x9Ag/AAAAAAAAAAI/AAAAAAAAAI4/PUJ0ZaB-kRk/photo.jpg?sz=128", "display_name": "Ramon Mueses", "link": "https://stackoverflow.com/users/7762933/ramon-mueses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513282258, "creation_date": 1513175813, "last_edit_date": 1513180353, "question_id": 47795590, "link": "https://stackoverflow.com/questions/47795590/loop-through-worksheets-in-workbooks-in-a-folder", "title": "Loop through worksheets in workbooks in a folder", "body": "<p>This is a good one.\nI can loop through workbooks and change/format on the sheet that the workbook was last saved on, but I cannot change/format/loop through the remaining sheets in the workbooks that possess multiple Sheets, my code wont work.</p>\n\n<p>NOTE: The macro runs from a separate .xlsm.</p>\n\n<p>Here is my current code (3 sub's):</p>\n\n<pre><code>Sub DarFormatoExelsEnFolder()\n'Revisar todos los archivos xlsx en una carpeta y aplicar formato \ndefinido\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n'Optimizar Macro\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Definir carpeta destino\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'Si es cancelado\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Definir extensiones a dar formato\n  myExtension = \"*.xlsx*\"\n\n'Definir ruta y extensi\u00f3n\n  myFile = Dir(myPath &amp; myExtension)\n\n'Revisar todos los archivos en la carpeta\n  Do While myFile &lt;&gt; \"\"\n    'Variable de libro abierto\n      Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    'Confirmaci\u00f3n de libro abierto\n      DoEvents\n\n    'Cambios al Workbook\n\nWorkSheetChange\n\n     'Guardar y cerrar Workbook actual\n  wb.Close SaveChanges:=True\n\n    'Confirmaci\u00f3n de libro cerrado\n      DoEvents\n\n    'Proximo libro\n      myFile = Dir\n  Loop\n\n'Aviso de fin de ejecuci\u00f3n\n  MsgBox \"Operaci\u00f3n Completada\"\n\nResetSettings:\n  'Normalizar excel\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nSub WorkSheetChange()\nDim WS As Worksheet\n\nFor Each WS In ThisWorkbook.Worksheets\n\n    Format\n\nNext WS\n\nEnd Sub\n\nSub Format()\n\n    'Format certain cells\n\nEnd Sub\n</code></pre>\n\n<p>Shout out to give credit to the people from \"The Spread Sheet Guru\", that have gotten me this far...</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1513176028, "post_id": 47795531, "comment_id": 82552133, "body": "Just a view notes: (1) Try to avoid <code>.Select</code> and <code>.Activate</code> these are bad practices (there are many tutorials how to avoid them). (2) Using <code>On Error Resume Next</code> without a proper error handling is also very bad practice. It mutes errors but they still occur, you just can&#39;t see them. (3) Don&#39;t use hard coded row counts like <code>65536</code> use <code>Rows.Count</code> instead. Different Excel versions have different row counts!"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1513176604, "post_id": 47795570, "comment_id": 82552532, "body": "Note: <code>Sheets(J).Range(&quot;A1&quot;)</code> might fail if there is a chart sheet within the workbook, because a chart doesn&#39;t have a <code>Range</code>. Therefore all <code>Sheets</code> should be <code>Worksheets</code> instead. The difference is the <code>Worksheet</code> object only contains worksheets but the <code>Sheets</code> object also contains sheets like charts. These are not equal!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1513176720, "last_edit_date": 1513176720, "creation_date": 1513175762, "answer_id": 47795570, "question_id": 47795531, "link": "https://stackoverflow.com/questions/47795531/applying-an-excel-formula-with-macro/47795570#47795570", "title": "Applying an Excel formula with macro", "body": "<p>You must double up the quotes in VBA</p>\n\n<pre><code>Range(\"F2\").Formula = \"=IF(ISNUMBER(SEARCH(\"\"_\"\",Combined!A2)),LEFT(Combined!A2,(FIND(\"\"_\"\",Combined!A2,1)-1)))\"\n</code></pre>\n\n<p>Also suggest amending your main code to avoid the selecting, and using some worksheet variables to make it easier to refer to relevant sheets.</p>\n\n<pre><code>Sub Combine()\n\nApplication.DisplayAlerts = False\nworkSheets(\"Combined\").Delete\nApplication.DisplayAlerts = True\n\nDim ws1 As Worksheet, ws2 As Worksheet\nDim J As Long\n\nSet ws1 = Sheets(1)\nSet ws2 = Worksheets.Add(before:=ws1)\nws2.Name = \"Combined\"\nws1.Range(\"A1\").EntireRow.Copy Destination:=ws2.Range(\"A1\")\n\nFor J = 3 To 6\n    With workSheets(J).Range(\"A1\").CurrentRegion\n        .Offset(1, 0).Resize(.Rows.Count - 1).Copy Destination:=ws2.Range(\"A\" &amp; Rows.Count).End(xlUp)(2)\n    End With\nNext\nws2.visible = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9094301, "user_type": "registered", "profile_image": "https://graph.facebook.com/1757916920894593/picture?type=large", "display_name": "Viktor Vidolov", "link": "https://stackoverflow.com/users/9094301/viktor-vidolov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513176720, "creation_date": 1513175651, "last_edit_date": 1513175852, "question_id": 47795531, "link": "https://stackoverflow.com/questions/47795531/applying-an-excel-formula-with-macro", "title": "Applying an Excel formula with macro", "body": "<p>Thank you for taking the time to read my query. </p>\n\n<p>I have a problem with applying a formula to one of my Excel sheets. I'm currently using a macro to combine few sheets into one. It's quite rough but it does the job.</p>\n\n<pre><code>Sub Combine()\n    Application.DisplayAlerts = False\n    Sheets(\"Combined\").Delete\n    Application.DisplayAlerts = True\n\n    Dim J As Integer\n\n    On Error Resume Next\n\n    Sheets(1).Select\n    Worksheets.Add\n    Sheets(1).Name = \"Combined\"\n    Sheets(2).Activate\n    Range(\"A1\").EntireRow.Select\n    Selection.Copy Destination:=Sheets(1).Range(\"A1\")\n\n    For J = 3 To 6\n        Sheets(J).Activate\n        Range(\"A1\").Select\n        Selection.CurrentRegion.Select\n        Selection.Offset(1, 0).Resize(Selection.Rows.Count - 1).Select\n        Selection.Copy Destination:=Sheets(1).Range(\"A65536\").End(xlUp)(2)\n        Sheets(\"Combined\").Visible = False\n    Next\nEnd Sub\n</code></pre>\n\n<p>This is giving me a specific page from which I need to draw the info. I will tie it to button for easy access in the future. I'm currently struggling with applying a formula that draws info from the aforementioned 'Combined' sheet. The formula that I'm using is lost upon deleting the sheet in the beginning of the code.</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"_\",Combined!A2)),LEFT(Combined!A2,(FIND(\"_\",Combined!A2,1)-1)))\n</code></pre>\n\n<p>So I tried applying it to a macro. But as you can see there is an underscore in there, that VBA has a very specific interpretation of it. Is there a workaround?</p>\n\n<pre><code>Sub Place_formula()\n'trying to place the formulae once again\nRange(\"F2\").Formula = \n\"=IF(ISNUMBER(SEARCH(\"_\",Combined!A2)),LEFT(Combined!A2,\n(FIND(\"_\",Combined!A2,1)-1)))\"\nEnd Sub \n</code></pre>\n\n<p>If I manage to do this I will easily find a way to replicate it to where it is needed.</p>\n"}, {"tags": ["vba", "excel", "excel-2007", "variant"], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1513177052, "post_id": 47795586, "comment_id": 82552872, "body": "I have added a photo of what I&#39;d like it to look similar too.  With your code, wouldn&#39;t that count it for every one? I am not understanding the logic?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1513194848, "post_id": 47795586, "comment_id": 82563338, "body": "Your question is not precise. with the code i provided u can get the row/index of the array and then do the stuff with the date you want to do."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1513194886, "post_id": 47795586, "comment_id": 82563359, "body": "You would know have to check for the date and then handle it the way you want it. Also why do you even use 2 dimensional arrays?"}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1513175807, "creation_date": 1513175807, "answer_id": 47795586, "question_id": 47794687, "link": "https://stackoverflow.com/questions/47794687/vba-countifs-time-and-date-by-building-using-variants/47795586#47795586", "title": "VBA - Countifs time and date by building using variants", "body": "<p>What you simply can is to check with <code>Application.Match</code> if the string is in the array and it will give back the index, because this function can only handle one dimensional arrays, there is another function that will give back one dimension of the array. After that you can check the offset and do something with it like this: </p>\n\n<pre><code>Dim mindex as Variant\nmindex = Application.Match(rDts(i, 3), Only1D(vDbld, 1), 0)\nIf Not IsError(mindex) Then\n   'do stuff i.e\n   vDbld(mindex, 2) = vDbld(mindex, 2) + 1\nEnd If\n\nFunction Only1D(arr As Variant, d As Long)\nDim size As Long: size = UBound(arr, d)\nDim arr2 As Variant\nReDim arr2(1 To size)\nFor i = 1 To size\n    arr2(i) = arr(i, d)\nNext\nOnly1D = arr2\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513177045, "creation_date": 1513173181, "last_edit_date": 1513177045, "question_id": 47794687, "link": "https://stackoverflow.com/questions/47794687/vba-countifs-time-and-date-by-building-using-variants", "title": "VBA - Countifs time and date by building using variants", "body": "<p>I received help in solving a previous <a href=\"https://stackoverflow.com/questions/47601437/vba-countif-cell-range-displayed-value-is-equal-to-desired-value\">question</a>.  I would like to solve this problem similarly.</p>\n\n<p>So the situation is similar to a <code>Countifs</code> function, in that I would like it to count if a range equals a certain building, as well as if the date and time that is offset equals a certain date.  For example, if the cell in <code>\"C1\" = \"Irving Building\"</code> And if the value in <code>\"K1\" = \"Monday\"</code> Then I would like it to display in <code>\"S1\"</code>.  More specifically if <code>\"C1\" = \"Irving Building\"</code> then I want it to count into whatever day and time that corresponds with it, in <code>Column K</code>.</p>\n\n<pre><code>Private Sub TimeAndDate()\n\nDim n           As Double\nDim rep         As Worksheet\nDim ws          As Worksheet\nDim LastRow     As Double\n\nSet rep = Worksheets(\"Report\")\n\nrep.Columns(\"K:L\").ClearContents\n\nFor n = 1 To ThisWorkbook.Sheets.Count\n\n    Set ws = Worksheets(n)\n\n    If IsNumeric(ws.Name) Then\n        LastRow = rep.Range(\"K1\", rep.Range(\"K1\").End(xlDown)).Rows.Count\n        LastRow = LastRow + 1\n\n        If rep.Range(\"K1\") = \"\" Then\n            ws.Range(\"C2\", ws.Range(\"C2\").End(xlDown)).Copy _\n            Destination:=rep.Range(\"K1\")\n            ws.Range(\"C2\", ws.Range(\"C2\").End(xlDown)).Copy _\n            Destination:=rep.Range(\"L1\")\n        Else:\n            ws.Range(\"C2\", ws.Range(\"C2\").End(xlDown)).Copy _\n            Destination:=rep.Range(\"K\" &amp; LastRow)\n            ws.Range(\"C2\", ws.Range(\"C2\").End(xlDown)).Copy _\n            Destination:=rep.Range(\"L\" &amp; LastRow)\n        End If\n\n    End If\n\nNext n\n\n    Dim rDts As Range\n    Dim vDts As Variant\n    Dim vCnts As Variant\n    Dim vAP As Variant    'for the AM PM count\n    Dim vDbld As Variant  'for the date by building\n    Dim vTbld As Variant  'for thee time by building\n    Dim i As Long, J As Long\n\n'read dates into array -- faster processing\nWith rep\n    vDts = .Range(.Cells(1, 11), .Cells(.Rows.Count, 11).End(xlUp))\nEnd With\n\n'Results array\nReDim vCnts(1 To 7, 1 To 2)\n    vCnts(1, 1) = \"Sunday\"\n    vCnts(2, 1) = \"Monday\"\n    vCnts(3, 1) = \"Tuesday\"\n    vCnts(4, 1) = \"Wednesday\"\n    vCnts(5, 1) = \"Thursday\"\n    vCnts(6, 1) = \"Friday\"\n    vCnts(7, 1) = \"Saturday\"\n\nReDim vAP(1 To 2, 1 To 2)\n    vAP(1, 1) = \"AM\"\n    vAP(2, 1) = \"PM\"\n\nReDim vDbld(1 To 13, 1 To 2)\n    vDbld(1, 1) = \"Irving Building\"\n    vDbld(2, 1) = \"Memorial Building\"\n    vDbld(3, 1) = \"West Tower\"\n    vDbld(4, 1) = \"Witting Surgical Center\"\n    vDbld(5, 1) = \"Madison Irving Surgical Center\"\n    vDbld(6, 1) = \"Marley Education Center\"\n    vDbld(7, 1) = \"410 South Crouse\"\n    vDbld(8, 1) = \"Physicians Office Building\"\n    vDbld(9, 1) = \"Crouse Business Center\"\n    vDbld(10, 1) = \"Commonwealth Place\"\n    vDbld(11, 1) = \"Irving - Memorial Connector\"\n    vDbld(12, 1) = \"Crouse Garage\"\n    vDbld(13, 1) = \"CNY Medical Center\"\n\n'Do the counts\n    For i = 1 To UBound(vDts, 1)\n\n        J = Weekday(vDts(i, 1))\n        vCnts(J, 2) = vCnts(J, 2) + 1\n\n        If Hour(vDts(i, 1)) &lt; 12 Then\n            vAP(1, 2) = vAP(1, 2) + 1\n        Else\n            vAP(2, 2) = vAP(2, 2) + 1\n        End If\n\n\n    Next i\n\n'output the results\nrep.Range(\"E1:E14\").Copy rep.Range(\"Q1\")\nrep.Range(\"N2:N8\").Copy\nrep.Range(\"R1\").PasteSpecial xlPasteAll, xlPasteSpecialOperationNone, _\nFalse, True\nrep.Range(\"N11:N12\").Copy\nrep.Range(\"Y1\").PasteSpecial xlPasteAll, xlPasteSpecialOperationNone, _\nFalse, True\n\nrep.Range(\"N1\") = \"DATE\"\nrep.Range(\"O1\") = \"COUNT\"\nrep.Range(\"N10\") = \"TIME\"\nrep.Range(\"O10\") = \"COUNT\"\nrep.Range(\"N2:O8\").Value = vCnts\nrep.Range(\"N11:O12\").Value = vAP\n</code></pre>\n\n<p>The part that I am needing help on is this part here.  These are the variants that I'd like to use, but like I said, earlier, I am unsue as to how to do this without running a ton of <code>countifs</code> statements.</p>\n\n<pre><code>    Dim vDbld As Variant  'for the date by building\nReDim vDbld(1 To 13, 1 To 2)\n    vDbld(1, 1) = \"Irving Building\"\n    vDbld(2, 1) = \"Memorial Building\"\n    vDbld(3, 1) = \"West Tower\"\n    vDbld(4, 1) = \"Witting Surgical Center\"\n    vDbld(5, 1) = \"Madison Irving Surgical Center\"\n    vDbld(6, 1) = \"Marley Education Center\"\n    vDbld(7, 1) = \"410 South Crouse\"\n    vDbld(8, 1) = \"Physicians Office Building\"\n    vDbld(9, 1) = \"Crouse Business Center\"\n    vDbld(10, 1) = \"Commonwealth Place\"\n    vDbld(11, 1) = \"Irving - Memorial Connector\"\n    vDbld(12, 1) = \"Crouse Garage\"\n    vDbld(13, 1) = \"CNY Medical Center\"\n</code></pre>\n\n<p>I apologize if this is confusing, I am not completely sure how to word it, thanks in advance.</p>\n\n<p>This is an example of what I'd like it to look like:\n<a href=\"https://i.stack.imgur.com/oEasp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oEasp.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "catia"], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": true, "score": 0, "last_activity_date": 1513181065, "last_edit_date": 1513181065, "creation_date": 1513178251, "answer_id": 47796492, "question_id": 47794340, "link": "https://stackoverflow.com/questions/47794340/catia-v5-inform-the-user-a-change-occured/47796492#47796492", "title": "CATIA V5: inform the user a change occured", "body": "<p>If you want to show a message when the design table configuration changes use a Reaction triggered by the configuration parameter.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jix9b.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jix9b.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The rule does not necessarily fire just because you update the Product.</p>\n"}], "owner": {"reputation": 7, "user_id": 8464282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3abd9a9fef5768ad1bb2bf79c570e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Castella", "link": "https://stackoverflow.com/users/8464282/castella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 47796492, "answer_count": 1, "score": 0, "last_activity_date": 1513181065, "creation_date": 1513172186, "last_edit_date": 1513172244, "question_id": 47794340, "link": "https://stackoverflow.com/questions/47794340/catia-v5-inform-the-user-a-change-occured", "title": "CATIA V5: inform the user a change occured", "body": "<p>Good afternoon,</p>\n\n<p>I would like to inform the user if a bushing in an assembly has been altered (there is only a \"desired length\" parameter to choose the bushing length) and the user does not realize when this happens, therefore it is necessary to inform him.\nthe bushing is parametrized and the different lengths are in a design table.</p>\n\n<p>I created a rule in kwa with the following information:</p>\n\n<pre><code>let OC (integer) /*(old configuration row)*/\nlet NC (integer) /*(new configuration row)*/\n\nOC = Relations\\Table1005c\\Configuration /*reads and stores the old configuration row*/\nRelations\\VB Scripts\\Update_Forcado .Run() /*runs VB Script that simply updates the assembly*/\nNC=Relations\\Table1005c\\Configuration /*reads and stores the new configuration row*/\n\nif NC-OC &lt;&gt; 0 /*compares the 2 configuration rows*/\n{\n    Message (\"The Bushing has been altered\")/*Informs the user that the bushing has been altered*/\n}\n</code></pre>\n\n<p>here is the vba:</p>\n\n<pre><code>Dim productDocument1 As Document\nSet productDocument1 = CATIA.ActiveDocument\nDim product1 As Product\nSet product1 = productDocument1.Product\nSet product1 = product1.ReferenceProduct\nproduct1.Update\nEnd Sub\n</code></pre>\n\n<p>this doesn't work, can anyone tell me why?\nalso, can this be done without using vb scripts?</p>\n\n<p>thanks,</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8756272"}, "edited": false, "score": 0, "creation_date": 1513224131, "post_id": 47805001, "comment_id": 82572796, "body": "Does the following piece of code not imports the styles?       ActiveDocument.CopyStylesFromTemplate(&quot;C:\\Users\\rajtilak\\Des&zwnj;&#8203;ktop\\Report.dotx&quot;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8756272"}, "edited": false, "score": 0, "creation_date": 1513224403, "post_id": 47805001, "comment_id": 82572858, "body": "Wait, it worked! The phrase is not getting appended by changing the Normal style instead of all styles like I was doing. Thank you so much!"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 0, "last_activity_date": 1513218554, "creation_date": 1513218554, "answer_id": 47805001, "question_id": 47794288, "link": "https://stackoverflow.com/questions/47794288/article-i-is-getting-added-to-heading-1-style-in-word/47805001#47805001", "title": "&quot;Article I&quot; is getting added to Heading 1 Style in Word", "body": "<p>Your<code>CommandButton1_Click</code> procedure doesn't copy any styles. It just de-links headers and footers from each other (or attempts to do so - I somehow doubt that it would work).</p>\n\n<p>Your second code snippet tries to change the font name for all styles in the ActiveDocument. That is a very tall order because there are used styles and unused styles, default styles and user-defined styles, dozens of them. There are paragraph styles and character styles, as well as those which can be both.</p>\n\n<p>Each style has its own <code>Font</code> object. Each Font object has a <code>Name</code> property but some of the styles are formatted to inherit their <code>Font</code> from other styles. A blanket order like you attempt must create confusion, for example, when your code tries to change the name of a font which is inherited from another font whose name will be changed only later in the loop. Honestly, there is no telling what destruction that code will cause or what the result will be.</p>\n\n<p>When you attempt to change styles it is best to submit them to your surgery one at a time. However, it's quite possible that the following line of code will do much of what you want.</p>\n\n<pre><code>ActiveDocument.Styles(wdStyleNormal).Font.Name = \"Georgia\"\n</code></pre>\n\n<p>This will change the <code>Normal</code> style font, and since most of what you mostly do uses the <code>Normal</code> font the change will be quite far-reaching.</p>\n\n<p>As for copying styles between documents, I suggest that you google for \"Copy styles from another document\". This can be done with a few clicks much more efficiently than any VBA code you might write.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8756272"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "accepted_answer_id": 47805001, "answer_count": 1, "score": 1, "last_activity_date": 1513218554, "creation_date": 1513171995, "question_id": 47794288, "link": "https://stackoverflow.com/questions/47794288/article-i-is-getting-added-to-heading-1-style-in-word", "title": "&quot;Article I&quot; is getting added to Heading 1 Style in Word", "body": "<p>I am trying to copy Styles from a Word template to another Word file. The code I am using is as follow:</p>\n\n<pre><code>Sub CommandButton1_Click()\n\nDim stl As Style\n'On Error GoTo theCopy\nApplication.ScreenUpdating = False\n\nActiveDocument.CopyStylesFromTemplate(\"C:\\Users\\rajtilak\\Desktop\\Report.dotx\")\n\np = ActiveDocument.Sections.Count\n\nFor j = 1 To p\n    'Header\n    If ActiveDocument.Sections(j).Headers(wdHeaderFooterPrimary).LinkToPrevious = True Then\n    ActiveDocument.Sections(j).Headers(wdHeaderFooterPrimary).LinkToPrevious = False\n    End If\n        If ActiveDocument.Sections(j).Headers(wdHeaderFooterFirstPage).LinkToPrevious = True Then\n        ActiveDocument.Sections(j).Headers(wdHeaderFooterFirstPage).LinkToPrevious = False\n    End If\n\n    'Footer\n    If ActiveDocument.Sections(j).Footers(wdHeaderFooterPrimary).LinkToPrevious = True Then\n    ActiveDocument.Sections(j).Footers(wdHeaderFooterPrimary).LinkToPrevious = False\n    End If\n        If ActiveDocument.Sections(j).Footers(wdHeaderFooterFirstPage).LinkToPrevious = True Then\n        ActiveDocument.Sections(j).Footers(wdHeaderFooterFirstPage).LinkToPrevious = False\n    End If\nNext j\n\nApplication.ScreenUpdating = True\nMsgBox \"Styles Successfully Copied\"\n\nEnd Sub\n</code></pre>\n\n<p>This is working fine. However, after copying the Styles, when I am trying to change the default Font for all styles by using the following code, the phrase \"Article I\" is getting appended to the Style:</p>\n\n<pre><code>For Each stl In ActiveDocument.Styles\n    stl.Font.Name = \"Georgia\"\nNext\n</code></pre>\n\n<p>Can anybody please help me understand why this is happening? Any help would be highly appreciated.</p>\n"}, {"tags": ["excel", "vba", "sharepoint"], "comments": [{"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1513178184, "post_id": 47793921, "comment_id": 82553708, "body": "Could you clarify the &quot;I can amend the value, when there&#39;s one already present&quot;? What is the &quot;one&quot;? a property? a property&#39;s value?... Could you provide an example of that?"}, {"owner": {"reputation": 11, "user_id": 6207480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ffAx5.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6207480/simon"}, "reply_to_user": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1513262751, "post_id": 47793921, "comment_id": 82593557, "body": "Oh, sorry, I wasn&#39;t being very clear. If I <i>manually</i> add a value to the particular contenttype property (via the Document Information Panel), then it can be <i>subsequently</i> updated by the script. But if it&#39;s <i>empty</i>, it cannot be populated by the script. Hopefully that helps - and thanks for taking an interest in my problem!"}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1513303061, "post_id": 47793921, "comment_id": 82612046, "body": "I know the &quot;ContentTypePropertie&quot; is read-only so you cannot create/delete/rename it in VBA. The value it holds should be changeable. So, the &quot;ActiveWorkbook.ContentTypeProperties(9).Value(0)&quot; is not the property but the value of the &quot;property(9)&quot;, correct? Does it mean this &quot;property(9)&quot; has (could have) several values, like &quot;property(9)(0), property(9)(1)&quot;, etc.? Do you mean you need to have at least &quot;property(9)(0)&quot; assigned outside of VBA in order to modify it, or to add, say, &quot;property(9)(2)&quot; and assign a value to it? etc."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1513303303, "post_id": 47793921, "comment_id": 82612090, "body": "...There are too many possibilities not clarified by you. I know, this is an awfully confusing situation, given Microsoft&#39;s unwillingness (inability?) to provide minimal meaningful documentation/help lately.  I know some &quot;list-type&quot; properties cannot be addressed by direct calling (those treated internally as a collection of objects). To work with those you need to set a loop of this type &quot;For Each...&#39;object&#39; In Collection  / Next &#39;object&#39;&quot; and deal with those &#39;objects&#39; inside the loop..."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1513303414, "post_id": 47793921, "comment_id": 82612109, "body": "... also, if you look &quot;For i=1 to n&quot;-type and the app does resorting internally as you make changes to the elements then, sometimes, you need to figure out how to deal with that. I hope these comments might give you some useful ideas. I wished I could actually work/test your problem myself, otherwise it&#39;s all a supposition. Good luck."}], "owner": {"reputation": 11, "user_id": 6207480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ffAx5.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6207480/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513170813, "creation_date": 1513170813, "question_id": 47793921, "link": "https://stackoverflow.com/questions/47793921/unable-to-amend-contenttypeproperty-in-excel-vba", "title": "Unable to amend ContentTypeProperty in Excel VBA", "body": "<p>My sharepoint site has a number of mandatory Document Type Properties. I can set all bar one of them using\n<code>ActiveWorkbook.ContentTypeProperties(1).Value = \"Something required\"</code> </p>\n\n<p>However, one of these required properties allows multiple selections from a 'library structure' (or at least that is how it is described)</p>\n\n<p>I've noticed that this property is listed not as the value, but rather as the Value(0)</p>\n\n<p>None of the following seem to work:</p>\n\n<p><code>ActiveWorkbook.ContentTypeProperties(9).Value = \"Library requirement\"</code> \n<code>ActiveWorkbook.ContentTypeProperties(9).Value.Value(0) = \"Library requirement\"</code> \n<code>ActiveWorkbook.ContentTypeProperties(9).Value(0) = \"Library requirement\"</code></p>\n\n<p>I can amend the value, when there's one already present (using the last of the three listed above). But if the property is blank, the script falls over with a Type Mismatch error.</p>\n\n<p>I'm anticipating a number of documents being generated automatically, so anything that will help my colleagues get them sorted properly would be much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1513170632, "post_id": 47793670, "comment_id": 82548578, "body": "You need <code>findfield = v(x,1)</code> as an array from a range will automatically be 2D."}], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1513171204, "creation_date": 1513171204, "answer_id": 47794029, "question_id": 47793670, "link": "https://stackoverflow.com/questions/47793670/excel-re-order-columns-using-a-list/47794029#47794029", "title": "Excel re-order columns using a list", "body": "<p>I would rather use collection instead of array, but if you wish, you can assign values like that:</p>\n\n<pre><code>Dim i As Long\n\nReDim v(0 To 0)\nFor i = 0 To 9\n    ReDim Preserve v(0 To i)\n    v(i) = Range(\"m1\").Offset(i)\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 3018774, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/F5Qna.jpg?s=128&g=1", "display_name": "Mary", "link": "https://stackoverflow.com/users/3018774/mary"}, "edited": false, "score": 1, "creation_date": 1513263975, "post_id": 47794163, "comment_id": 82594427, "body": "Worked like a charm! Thank you alot!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1513171585, "creation_date": 1513171585, "answer_id": 47794163, "question_id": 47793670, "link": "https://stackoverflow.com/questions/47793670/excel-re-order-columns-using-a-list/47794163#47794163", "title": "Excel re-order columns using a list", "body": "<p>You need <code>findfield = v(x,1)</code> as an array from a range will automatically be 2D.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1513173984, "creation_date": 1513173984, "answer_id": 47794955, "question_id": 47793670, "link": "https://stackoverflow.com/questions/47793670/excel-re-order-columns-using-a-list/47794955#47794955", "title": "Excel re-order columns using a list", "body": "<p>When you use the <code>ARRAY()</code> function, you are generating a 0-based array.  If your code works using this function to make <code>v</code>, then replace this single line of code:</p>\n\n<pre><code>v = Array(\"First Name\", \"Middle Name\", \"Last Name\", \"Date of Birth\", \"Phone Number\", \"Address\", \"City\", \"State\", \"Postal (ZIP) Code\", \"Country\")\n</code></pre>\n\n<p>with these 5 lines of code:</p>\n\n<pre><code>Dim v(0 To 9) As String, i As Long\n\n    arr = Range(\"M1:M10\")\n    For i = 0 To 9\n        v(i) = arr(i + 1, 1)\n    Next i\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 3018774, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/F5Qna.jpg?s=128&g=1", "display_name": "Mary", "link": "https://stackoverflow.com/users/3018774/mary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1323, "favorite_count": 1, "accepted_answer_id": 47794163, "answer_count": 3, "score": 4, "last_activity_date": 1513173984, "creation_date": 1513170024, "last_edit_date": 1513172716, "question_id": 47793670, "link": "https://stackoverflow.com/questions/47793670/excel-re-order-columns-using-a-list", "title": "Excel re-order columns using a list", "body": "<p>I want to reorder some columns in excel, using a list of values that are in M1 to M10 and that have the name of the headers and the order in which they should be ordered.</p>\n\n<p>I have this script that works if I use:</p>\n\n<pre><code>v = Array(\"First Name\", \"Middle Name\", \"Last Name\", \"Date of Birth\", \"Phone Number\", \"Address\", \"City\", \"State\", \"Postal (ZIP) Code\", \"Country\")\n</code></pre>\n\n<p>However when I changed to </p>\n\n<pre><code>v = Range(\"m1:m10\").Value\n</code></pre>\n\n<p>It doesnt work, giving the following message:</p>\n\n<blockquote>\n  <p>Subscript out of range.</p>\n</blockquote>\n\n<p>Here is the whole code:</p>\n\n<pre><code>Sub Reorganize_columns()\n' Reorganize Columns Macro\n'\n' Developer: If you want to know, please contact Winko Erades van den Berg\n' E-mail : winko at winko-erades.nl\n' Developed: 11-11-2013\n' Modified: 11-11-2013\n' Version: 1.0\n''v = Array(\"First Name\", \"Middle Name\", \"Last Name\", \"Date of Birth\", \"Phone Number\", \"Address\", \"City\", \"State\", \"Postal (ZIP) Code\", \"Country\")\n' Description: Reorganize columns in Excel based on column header\n\nDim v As Variant, x As Variant, findfield As Variant\nDim oCell As Range\nDim iNum As Long\n\n\nv = Range(\"m1:m10\").Value\nFor x = LBound(v) To UBound(v)\nfindfield = v(x)\niNum = iNum + 1\nSet oCell = ActiveSheet.Rows(1).Find(What:=findfield, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\nIf Not oCell.Column = iNum Then\nColumns(oCell.Column).Cut\nColumns(iNum).Insert Shift:=xlToRight\nEnd If\nNext x\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "getelementsbytagname"], "comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513170620, "post_id": 47793558, "comment_id": 82548571, "body": "The HTML looks like they are using ASP.NET webforms? Is the content dynamic? If so, how do you know there&#39;ll always be a 116th <code>tr</code> element for all given pages? What exactly is in the 116th <code>tr</code> element?"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513171219, "post_id": 47793558, "comment_id": 82548976, "body": "I&#39;m a little new with scraping html and don&#39;t know what webform they are using. I found 116 by trial and error. Do you know of a better way to go about setting this element? Im not sure if its dynamic because I&#39;m been using it with occasional success for the past few days"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513171576, "post_id": 47793558, "comment_id": 82549207, "body": "I just looked and it does appear that they are using ASP.NET"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513171710, "post_id": 47793558, "comment_id": 82549302, "body": "I would not try to use ordinal position because I&#39;m very sure the content is rendered dynamically. The names all smells to me ASP.NET Webforms. Rather, I&#39;d try to see if I can use the <code>class</code>, the header or something more distinctive, do a find for that instead of hard-coding the ordinal position. Would need to know more about the webpage layout to provide guidance."}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513172435, "post_id": 47793558, "comment_id": 82549764, "body": "I&#39;ll put together some more html code and will post it shortly."}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513173444, "post_id": 47793558, "comment_id": 82550410, "body": "I just posted more html code hopefully that will help show the layout better. An example of the values I&#39;m trying to retrieve are &quot;Estimated Calculated Max&quot; and the value &quot;161&quot;."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513179666, "post_id": 47793558, "comment_id": 82554700, "body": "Are you looking for all occurrences of <code>Estimated Calculated Max</code> or are you sure there&#39;ll be only one per the page? What is <code>161</code>? A value you&#39;re trying to get or match to?"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513199971, "post_id": 47793558, "comment_id": 82565826, "body": "There will be just one occurrence of &quot;estimated calculated max&quot; per page. 161 is the max for Hour 1. I&#39;ll need to get the max values for each hour of the day so there will be 24 max values."}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1513256242, "post_id": 47793558, "comment_id": 82589172, "body": "As suggested above, i&#39;ve been attempting to loop to find the relevant tags with no success so far. Any helpful tips?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538479745, "post_id": 47793558, "comment_id": 92148867, "body": "There is only one Estimated Calculated Max Cap shown in the HTML. Could you provide HTML for the 24? perhpas using pastebin?"}], "owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538479317, "creation_date": 1513169675, "last_edit_date": 1538479317, "question_id": 47793558, "link": "https://stackoverflow.com/questions/47793558/occasional-error-when-attempting-to-set-a-variable", "title": "Occasional error when attempting to set a variable", "body": "<p>I'm running into </p>\n\n<blockquote>\n  <p>\"object variable or with block variable not set\"</p>\n</blockquote>\n\n<p>error. </p>\n\n<p>This is occuring when I attempt to set Table = <code>htmldoc.getElementsbytagname(\"tr\")(116).getelementsbytagname(\"td\")</code>. It works sometimes, but other times I get this error. Any ideas on how I can avoid running into this error? I noted in my code where the error occurs and included the html below as well. </p>\n\n<pre><code>Sub gethourlymaxvalues()\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    With IE\n        .Visible = False\n        .navigate \"webaddress\"\n        Do Until .readyState = 4\n            DoEvents\n        Loop\n        .document.all.item(\"Login1_UserName\").Value = \"username\"\n        .document.all.item(\"Login1_Password\").Value = \"pw\"\n        .document.all.item(\"Login1_LoginButton\").Click\n        Do Until .readyState = 4\n            DoEvents\n        Loop\n        .navigate \"webaddress\"\n        Do Until .readyState = 4\n            DoEvents\n        Loop\n\n        Dim htmldoc As Object\n        Dim aTable As Object\n        Dim r\n        Dim c\n\n        Do Until IE.readyState = 4\n            DoEvents\n        Loop\n\n        Set htmldoc = IE.document\n        Error 91&gt;&gt; Set aTable = htmldoc.getElementsByTagName(\"tr\")(116).getElementsByTagName(\"td\") ''Error object variable or with block variable not set''\n        r = 0\n        c = 0\n        For Each TDelement In aTable\n            ThisWorkbook.Sheets(\"Slice\").Range(\"j8\").Offset(r, c).Value = TDelement.innerText\n            r = r + 1\n        Next\n        r = 0\n        Set IE = Nothing\n    End Sub\n</code></pre>\n\n<p>HTML:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>  &lt;/table&gt;\r\n    &lt;/tbody&gt;\r\n    &lt;td&gt;\r\n    &lt;span id=\"ctl00_PageContent_LblCompany\" style=\"font-family: Verdana;\"&gt;Company&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;select name=\"ctl00$PageContent$cboCompanies\" id=\"ctl00_PageContent_cboCompanies\" onchange=\"javascript:setTimeout('__doPostBack(\\'ctl00$PageContent$cboCompanies\\',\\'\\')', 0)\"&gt;\r\n    &lt;option value=\"AA\"&gt;AVA&lt;/option&gt;\r\n    &lt;option value=\"CD\"&gt;CHPD&lt;/option&gt;\r\n    &lt;option value=\"CS1\"&gt;COMS1&lt;/option&gt;\r\n    &lt;/select&gt;&lt;input name=\"ctl00$PageContent$cmdViewReport\" id=\"ctl00_PageContent_cmdViewReport\" type=\"submit\" value=\"View Report\"&gt;&lt;input name=\"ctl00$PageContent$cmdDownload\" id=\"ctl00_PageContent_cmdDownload\" type=\"submit\" value=\"Download Excel\"&gt;&lt;/td&gt;&lt;td&gt;&lt;select name=\"ctl00$PageContent$cboRefresh\" id=\"ctl00_PageContent_cboRefresh\" onchange=\"javascript:setTimeout('__doPostBack(\\'ctl00$PageContent$cboRefresh\\',\\'\\')', 0)\"&gt;\r\n    &lt;option value=\"0\"&gt;Auto Refresh Off&lt;/option&gt;\r\n    &lt;option selected=\"selected\" value=\"900000\"&gt;Auto Refresh: 15 Minutes&lt;/option&gt;\r\n    &lt;option value=\"1800000\"&gt;Auto Refresh: 30 Minutes&lt;/option&gt;\r\n    &lt;/select&gt;&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;/tbody&gt;&lt;/table&gt;\r\n    &lt;table id=\"ctl00_PageContent_Table2\" border=\"0\"&gt;&lt;tbody&gt;\r\n    &lt;/tr&gt;&lt;tr style=\"background-color: palegoldenrod;\"&gt;\r\n    &lt;td&gt;&lt;span id=\"ctl00_PageContent_grdReport_ctl05_Label50\"&gt;Estimated Calculated Max Cap&lt;/span&gt;\r\n    &lt;/td&gt;&lt;td&gt;\r\n    &lt;span id=\"ctl00_PageContent_grdReport_ctl05_Label51\"&gt;161&lt;/span&gt;\r\n    &lt;/td&gt;\r\n    &lt;/tr&gt;&lt;tr style=\"background-color: beige;\"&gt;\r\n    &lt;td&gt;\r\n    &lt;span id=\"ctl00_PageContent_grdReport_ctl06_Label50\"&gt;Estimated Pond Min Capacity Restriction&lt;/span&gt;\r\n    &lt;/td&gt;&lt;td&gt;\r\n    &lt;span id=\"ctl00_PageContent_grdReport_ctl06_Label51\"&gt;159&lt;/span&gt;\r\n    &lt;/td&gt;&lt;td&gt;\r\n    &lt;span id=\"ctl00_PageContent_grdReport_ctl06_Label52\"&gt;159&lt;/span&gt;\r\n    &lt;/td&gt;\r\n    &lt;/tr&gt;&lt;tr style=\"background-color: beige;\"&gt;\r\n    &lt;td&gt;&lt;span id=\"ctl00_PageContent_grdPond_ctl19_Label50\"&gt;Participant Pond Maximum&lt;/span&gt;\r\n    &lt;/td&gt;&lt;td&gt;&lt;span id=\"ctl00_PageContent_grdPond_ctl19_Label51\"&gt;2630&lt;/span&gt;\r\n    &lt;/td&gt;\r\n    &lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;/tbody&gt;\r\n    &lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1513172258, "post_id": 47793500, "comment_id": 82549665, "body": "Try: <code>Set mytable = IE.Document.frames(1).ContentDocument.tables(1)</code>"}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1513178673, "post_id": 47793500, "comment_id": 82554050, "body": "Thanks Marc, unfortunately that didn&#39;t work."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1513179260, "post_id": 47793500, "comment_id": 82554428, "body": "<code>Set mytable = IE.Document.getElementByTagName(&quot;IFRAME&quot;)(0).ContentDocument&zwnj;&#8203;.getElementsByTagNam&zwnj;&#8203;e(&quot;TABLE&quot;)(0)</code>"}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1513180165, "post_id": 47793500, "comment_id": 82555034, "body": "I tried, but still <code>Debug.Print mytable.Length</code> or <code>Debug.Print mytable.getElementsByTagName(&quot;tr&quot;).Length</code> returns nothing."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1513187758, "post_id": 47793500, "comment_id": 82559897, "body": "What happens when you make use of the link connected to <code>iframe</code>, i meant the link within <code>src=---</code>. If you find the table in that link then there is a workaround otherwise it&#39;s hard to provide you with any solution without facing the real web."}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1513334410, "post_id": 47793500, "comment_id": 82623829, "body": "Thanks Shahin, that is actually a great idea: launching this link in another tab and scraping the table there."}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513178629, "creation_date": 1513169496, "last_edit_date": 1513178629, "question_id": 47793500, "link": "https://stackoverflow.com/questions/47793500/ie-automation-scrape-td-in-iframe-through-vba", "title": "IE automation: scrape &lt;td&gt; in &lt;iframe&gt; through VBA", "body": "<p>I am trying to automate IE through VBA to click a button that is embedded in an  \"iframe\" as on screenshot below (image in the last line):</p>\n\n<p><a href=\"https://i.stack.imgur.com/oAiEV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oAiEV.png\" alt=\"enter image description here\"></a></p>\n\n<p>However my code is unsuccesful in referencing the button (the last line doesn't print any value):</p>\n\n<pre><code>Sub intercept()\n\nDim my_title As String\nmy_title = \"Accounting\"\n\nmarker = 0\nSet objShell = CreateObject(\"Shell.Application\")\nIE_count = objShell.Windows.Count\nFor x = 0 To (IE_count - 1)\n    On Error Resume Next    ' sometimes more web pages are counted than are open\n    page_url = objShell.Windows(x).Document.Location\n    page_title = objShell.Windows(x).Document.Title\n\n    If page_title Like my_title &amp; \"*\" Then 'compare to find if the desired web page is already open\n        Set IE = objShell.Windows(x)\n        marker = 1\n        Exit For\n    Else\n    End If\nNext\n\nIf marker = 0 Then\n    MsgBox (\"A matching webpage was NOT found\")\nElse\n    MsgBox (\"A matching webpage was found\")\nEnd If\n\nSet mytable = IE.Document.frames(1).Document.tables(1)\n\nDebug.Print mytable.getElementsByTagName(\"td\").Length\n\nEnd Sub\n</code></pre>\n\n<p>I have also tried: <code>IE.Document.frames(0).Document.tables(0)</code>.</p>\n\n<p>Any help on how to click on this element is appreciated.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 5, "creation_date": 1513169045, "post_id": 47793319, "comment_id": 82547490, "body": "<code>Lebel1.Caption =&quot;Hello&quot;  &amp; Textbox1.Text</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1513170429, "creation_date": 1513170429, "answer_id": 47793799, "question_id": 47793319, "link": "https://stackoverflow.com/questions/47793319/how-can-i-join-a-string-with-a-value-in-vba-powerpoint/47793799#47793799", "title": "How Can I join a String &quot;&quot; with a Value in VBA powerpoint", "body": "<p>I guess you are having a Typo issue. Not sure if your control is <code>Lebel</code> or <code>Label</code>.\nIn this example you can combine a predefined Text and a Control text or Variable. <strong>Don't forget to add an space after your words.</strong></p>\n\n<pre><code>Label1.Caption = \"Hello \" &amp; Textbox1.Text &amp; \".\"\nLabel1.Caption = \"Hello \" &amp; Your variable &amp; \".\"\n</code></pre>\n\n<p>Also you can add a line break and also use a Message Box as follows:</p>\n\n<pre><code>Msgbox = \"Welcome Message.\" &amp; Chr(10) &amp; \"Hello \" &amp; Textbox1.Text &amp; \".\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8734450, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yyuTyXwp6WA/AAAAAAAAAAI/AAAAAAAAAGQ/6TlBeDeDG8k/photo.jpg?sz=128", "display_name": "CooCoo 333", "link": "https://stackoverflow.com/users/8734450/coocoo-333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1513170429, "creation_date": 1513168938, "last_edit_date": 1513169083, "question_id": 47793319, "link": "https://stackoverflow.com/questions/47793319/how-can-i-join-a-string-with-a-value-in-vba-powerpoint", "title": "How Can I join a String &quot;&quot; with a Value in VBA powerpoint", "body": "<p>So I have this textbox and a string I want to set a label to the string and the value combined like this:</p>\n\n<pre><code>Lebel1.Caption = \"Hello\" Textbox1.Text\n</code></pre>\n\n<p>I don't know what the proper code is.</p>\n"}, {"tags": ["excel", "file-format", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513168427, "post_id": 47793050, "comment_id": 82547134, "body": ".xlsm by any chance? It&#39;s the one that you&#39;ve missed"}, {"owner": {"reputation": 42, "user_id": 9093729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p1x-CfExL1M/AAAAAAAAAAI/AAAAAAAAADg/EpiJEdgYOhY/photo.jpg?sz=128", "display_name": "Ramon Hanneman", "link": "https://stackoverflow.com/users/9093729/ramon-hanneman"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513168828, "post_id": 47793050, "comment_id": 82547353, "body": "nope. still get the mismatch error. but thanks for your input!"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1513169361, "post_id": 47793050, "comment_id": 82547706, "body": "Try opening it in Notepad - if you can read anything in it, it might be a simple text or csv file. If not there might be a clue in the first few lines as to type"}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1513169831, "post_id": 47793050, "comment_id": 82548033, "body": "Also, if you can unzip it (by changing extension to <code>.zip</code>) than it&#39;s probably a new XML-based format (like <code>xlsm</code>). If not - than it&#39;s probably an old binary format (like <code>xlm</code>)."}, {"owner": {"reputation": 42, "user_id": 9093729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p1x-CfExL1M/AAAAAAAAAAI/AAAAAAAAADg/EpiJEdgYOhY/photo.jpg?sz=128", "display_name": "Ramon Hanneman", "link": "https://stackoverflow.com/users/9093729/ramon-hanneman"}, "edited": false, "score": 0, "creation_date": 1513170073, "post_id": 47793050, "comment_id": 82548189, "body": "notepad doesnt give any usefull info in the first few lines."}, {"owner": {"reputation": 42, "user_id": 9093729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p1x-CfExL1M/AAAAAAAAAAI/AAAAAAAAADg/EpiJEdgYOhY/photo.jpg?sz=128", "display_name": "Ramon Hanneman", "link": "https://stackoverflow.com/users/9093729/ramon-hanneman"}, "edited": false, "score": 0, "creation_date": 1513170150, "post_id": 47793050, "comment_id": 82548248, "body": "I can unzip it. xlm also not working."}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1513171036, "post_id": 47793050, "comment_id": 82548844, "body": "Ok, if you can unzip it (and if it&#39;s structure something like XML-based office document) and you sure that it&#39;s an Excel file - try to change extension to <code>.xml</code> and open it with Excel."}, {"owner": {"reputation": 42, "user_id": 9093729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p1x-CfExL1M/AAAAAAAAAAI/AAAAAAAAADg/EpiJEdgYOhY/photo.jpg?sz=128", "display_name": "Ramon Hanneman", "link": "https://stackoverflow.com/users/9093729/ramon-hanneman"}, "edited": false, "score": 0, "creation_date": 1513171783, "post_id": 47793050, "comment_id": 82549346, "body": "unfortunately the same error appears :("}], "answers": [{"tags": [], "owner": {"reputation": 42, "user_id": 9093729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p1x-CfExL1M/AAAAAAAAAAI/AAAAAAAAADg/EpiJEdgYOhY/photo.jpg?sz=128", "display_name": "Ramon Hanneman", "link": "https://stackoverflow.com/users/9093729/ramon-hanneman"}, "is_accepted": false, "score": 1, "last_activity_date": 1513176470, "creation_date": 1513176470, "answer_id": 47795849, "question_id": 47793050, "link": "https://stackoverflow.com/questions/47793050/excel-file-retrieve-original-file-extension-or-bypass-fileformat-extension-misma/47795849#47795849", "title": "Excel file retrieve original file extension or bypass fileformat-extension mismatch", "body": "<p>I found out that the issue is not with extension or file format but the problem was caused by AV/bit Defender which saw the file as a zip file started scanning inside and removed a single file inside thus causing excel to no longer recognise it as a valid file.\nI noticed some weird behaviour as soon as I restored quite some files from backup, AV defender started using 95% cpu. after that I went into the logs and noticed defender thinks it is a trojan.</p>\n\n<p>Thanks all for your input!</p>\n"}], "owner": {"reputation": 42, "user_id": 9093729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p1x-CfExL1M/AAAAAAAAAAI/AAAAAAAAADg/EpiJEdgYOhY/photo.jpg?sz=128", "display_name": "Ramon Hanneman", "link": "https://stackoverflow.com/users/9093729/ramon-hanneman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513178235, "creation_date": 1513168115, "last_edit_date": 1531161705, "question_id": 47793050, "link": "https://stackoverflow.com/questions/47793050/excel-file-retrieve-original-file-extension-or-bypass-fileformat-extension-misma", "title": "Excel file retrieve original file extension or bypass fileformat-extension mismatch", "body": "<p>We have a file that gets imported by a macro to extend Excel's macros functionality. This file has an extension .dll. The person who originally made this purposely changed the extension to dll to make it a bit less easy for users to just open it. All was well, but now the latest excel 2016 update gives an error \"file format and extension mismatch\".</p>\n\n<p>which is correct. Now, in my opinion, I have 2 options. </p>\n\n<ol>\n<li><p>change the extension to what it originally was (which I don't know).</p></li>\n<li><p>bypass the extension/file format mismatch (which I don't know how to do and might pose a security risk).</p></li>\n</ol>\n\n<p>I tried the following extensions: <code>xla,xlam,xlsx,xlsb,xlm,xls,xll.</code> but still get the same message.</p>\n\n<p>Does anyone have a clue on how I can find out what the original file extension was?</p>\n\n<p>I am not sure but the file might have been created in <code>excel 2000 or 2007.</code></p>\n"}, {"tags": ["oracle", "vba", "excel", "ms-office", "oraoledb"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513191614, "post_id": 47791736, "comment_id": 82561749, "body": "There is a various number of free (and legal) .NET decompilers available. Don&#39;t feel on the save side!"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513192181, "post_id": 47791736, "comment_id": 82562035, "body": "Folder <code>c:\\windows\\syswow64</code> is the location for 32-bit assemblies. By default a 64-bit application does not read anything from there. Do you have an Oracle Client (include &quot;Oracle Provider for OLE DB&quot; driver) installed on your Windows 8.1?"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513192586, "post_id": 47791736, "comment_id": 82562232, "body": "Are you sure about MS Office 64 bit? That is fairly uncommon."}, {"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513227088, "post_id": 47791736, "comment_id": 82573521, "body": "An office is 64 bit for sure. OLEDB Drivers are also there. Will try to convert the assembly by keeping it in system 32 folder."}, {"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513227594, "post_id": 47791736, "comment_id": 82573659, "body": "Tried the same, but still facing same error."}, {"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513228234, "post_id": 47791736, "comment_id": 82573834, "body": "Even this code i am able to run on another system which has Windows 8.1 and Office 2013 64 Bit. Cant resolve whats the difference between both machines."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513236460, "post_id": 47791736, "comment_id": 82577114, "body": "Analyze with <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer\" rel=\"nofollow noreferrer\">Process Explorer</a>"}, {"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513241184, "post_id": 47791736, "comment_id": 82579452, "body": "Whats to be checked in Process Explorer? I have not used it before. All I am able to see the application processes are listed. Where can I oraoledb process started?"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513241331, "post_id": 47791736, "comment_id": 82579529, "body": "Check which DLL&#39;s the application loads, resp. try to load."}, {"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513313512, "post_id": 47791736, "comment_id": 82614330, "body": "Checked all processes. No Difference at all observed. Still thanks a lot for such a nice tool for process overview tool."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513315797, "post_id": 47791736, "comment_id": 82614914, "body": "Sorry was a mistake, look for Process Monitor at the same page"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "edited": false, "score": 0, "creation_date": 1513227680, "post_id": 47792249, "comment_id": 82573677, "body": "Obfuscation is what I want. This excel utility will be used by others so I don&#39;t want to share my username and password for the database."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1513228908, "post_id": 47792249, "comment_id": 82574035, "body": "Maybe ask your DBA to create another account where you can share the credentials."}, {"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "edited": false, "score": 0, "creation_date": 1513322195, "post_id": 47792249, "comment_id": 82617255, "body": "That&#39;s not an option available. Help to resolve the error if you can."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 0, "last_activity_date": 1513165642, "creation_date": 1513165642, "answer_id": 47792249, "question_id": 47791736, "link": "https://stackoverflow.com/questions/47791736/error-3706-provider-cannot-be-found-it-may-not-be-properly-installed/47792249#47792249", "title": "error 3706 provider cannot be found. it may not be properly installed", "body": "<p>I'm not sure what the DLL buys you beyond simple obfuscation. All you're doing is making it a bit harder to get to but not actually protecting the privacy of it in any meaningful sense. My normal advice for management of connection strings is to simply <strong>don't</strong> save user/password. Instead, require the users to input the username/password at runtime and ensure that you have <code>Persist Security Info=false</code> in your OLEDB connection. That way, once it's opened, the full connection string is now inaccessible and there's no reference to a password. That's much more secure than sticking it in a variable in a DLL and crossing your fingers nobody knows how to read a memory dump or attach a debugger. </p>\n\n<p>That said, that's not germane to your question, not able to the use the provider. First thing I'd do is to rule out whether the DLL is causing a problem that you didn't expect by removing it and using the provider directly. If it likewise fails, then you know the DLL has nothing to do with it and you need to work out with Oracle's provider documentation to get to the bottom of the issue. </p>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "edited": false, "score": 0, "creation_date": 1513334491, "post_id": 47829542, "comment_id": 82623876, "body": "C:\\Users\\Admin\\Oracle is the interesting one."}], "tags": [], "owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "is_accepted": true, "score": 0, "last_activity_date": 1513330923, "creation_date": 1513330923, "answer_id": 47829542, "question_id": 47791736, "link": "https://stackoverflow.com/questions/47791736/error-3706-provider-cannot-be-found-it-may-not-be-properly-installed/47829542#47829542", "title": "error 3706 provider cannot be found. it may not be properly installed", "body": "<p>In the Succesfull machine i was using <strong>Release 12.2.0.1.0 for ODAC 12.2c Release 1</strong> as oracle client.</p>\n\n<p>But saw a latest version of the oracle client as <strong>64-bit ODAC 12.2c Release 1 (12.2.0.1.0) for Windows x64</strong> which was released on <strong>1st June 2017</strong>.</p>\n\n<p>Installed the same. And my error was resolved. When i observed system environment variables i saw few things added into it.\n<strong>E:\\app\\client\\Admin\\product\\12.2.0\\client_1;E:\\app\\client\\Admin\\product\\12.2.0\\client_1\\bin;C:\\Users\\Admin\\Oracle\\;</strong></p>\n\n<p>I dont know actually what they did. But error was resolved.</p>\n\n<p><strong><em>Can anybody throw highlight on this?</em></strong></p>\n"}], "owner": {"reputation": 89, "user_id": 8307640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-Fo6_lATn4hs/AAAAAAAAAAI/AAAAAAAAAAw/yR32iL2IogA/photo.jpg?sz=128", "display_name": "Shekhar Nalawade", "link": "https://stackoverflow.com/users/8307640/shekhar-nalawade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8690, "favorite_count": 1, "accepted_answer_id": 47829542, "answer_count": 2, "score": 0, "last_activity_date": 1513330923, "creation_date": 1513163885, "question_id": 47791736, "link": "https://stackoverflow.com/questions/47791736/error-3706-provider-cannot-be-found-it-may-not-be-properly-installed", "title": "error 3706 provider cannot be found. it may not be properly installed", "body": "<p>All. </p>\n\n<p>I have used a DLL approach explained on <a href=\"https://stackoverflow.com/questions/3217014/how-to-securely-store-connection-string-details-in-vba\">How to securely store Connection String details in VBA</a></p>\n\n<p>This code is running very well on windows 10 64 bit and MS Office 64 bit. But same copy of the files i am not able to use on Wndows 8.1 Pro and MS Office 64 bit.</p>\n\n<p>DLL generated is converted to host machnines environment by using </p>\n\n<pre><code>C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\regasm c:\\windows\\syswow64\\OraConnection.dll /tlb /codebase\n</code></pre>\n\n<p>But still same error i am facing. About environment variables care has been taken.\nMy Connection string is </p>\n\n<pre><code>\"Provider=OraOLEDB.Oracle; Data Source = ;  User ID =; Password=\";\n</code></pre>\n"}, {"tags": ["vba", "excel", "hidden", "window-style"], "comments": [{"owner": {"reputation": 766, "user_id": 8803849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/919f7018350489feffd3d0766f6ebbbb?s=128&d=identicon&r=PG&f=1", "display_name": "itsLex", "link": "https://stackoverflow.com/users/8803849/itslex"}, "edited": false, "score": 0, "creation_date": 1513213581, "post_id": 47791608, "comment_id": 82570378, "body": "Even if you don&#39;t show the pop-up window, it will need to have the focus to be able to close it using <code>SendKeys</code>. That means your user is interrupted in what he or she is doing if for example he or she is typing."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 766, "user_id": 8803849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/919f7018350489feffd3d0766f6ebbbb?s=128&d=identicon&r=PG&f=1", "display_name": "itsLex", "link": "https://stackoverflow.com/users/8803849/itslex"}, "edited": false, "score": 0, "creation_date": 1513241921, "post_id": 47791608, "comment_id": 82579844, "body": "I am using <code>Terminate()</code> to kill the .exe rather than <code>SendKeys</code> as it is too temperamental and keeps turning numlock on and off. See <b>Edit 1</b> on my post above."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1513244934, "post_id": 47791608, "comment_id": 82581689, "body": "I&#39;m not 100% sure, but what about forcing your spreadsheet to always be on top of all other windows? and using something like application.displayalerts = false to stop prompts from appearing (these prompts would not be external to your spreadsheet, but might help)"}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1513245344, "post_id": 47791608, "comment_id": 82581990, "body": "@Xabier I had thought about that, but all users of my code will be on workstations with 2 or 3 monitors, so it wouldn&#39;t really work since excel could be on a different monitor to the .exe. <code>Application.DisplayAlerts = False</code> wasn&#39;t helping, this is just blocking alerts in Excel. I tried changing &#39;Application&#39; to the name of my exe, or the name of the shell call i.e. &#39;x&#39; from my example above. So that <code>x.DisplayAlerts = False</code> but that didn&#39;t help."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "edited": false, "score": 0, "creation_date": 1513329040, "post_id": 47791608, "comment_id": 82620475, "body": "I am currently using a userform, set to be above all other windows, to hide the pop ups, but it&#39;s far from ideal. I&#39;d like the program to be less intrusive and allow people to get on with other work whilst it is running."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1513351766, "post_id": 47791608, "comment_id": 82634055, "body": "@Petrichor was the edit by QHarr fixing a typo from transcription, or did you actually have that typo in your code?"}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513351813, "post_id": 47791608, "comment_id": 82634075, "body": "@QHarr please refrain from changing code that has typos in it unless you are <b>absolutely sure</b> OP made the mistake transcribing the code from the IDE to the question. Typos in code like the one you fixed can be the exact cause of the problem."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "edited": false, "score": 0, "creation_date": 1513351863, "post_id": 47791608, "comment_id": 82634113, "body": "My code is correct, the typo was in my post here only."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 3, "creation_date": 1513351920, "post_id": 47791608, "comment_id": 82634157, "body": "@TylerH Noted though the code would not have compiled with that error which is why i felt it was safe to change a simple Thenn to Then."}, {"owner": {"reputation": 2214, "user_id": 806808, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c0b2b7f56ea26e55834aeed7a16e989?s=128&d=identicon&r=PG", "display_name": "Andrey Belykh", "link": "https://stackoverflow.com/users/806808/andrey-belykh"}, "edited": false, "score": 0, "creation_date": 1513362400, "post_id": 47791608, "comment_id": 82639591, "body": "Why don&#39;t you use <code>Shell</code> with <code>VbAppWinStyle.vbHide</code>? <a href=\"https://msdn.microsoft.com/en-us/VBA/language-reference-vba/articles/shell-function\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/VBA/language-reference-vba/articles&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "reply_to_user": {"reputation": 2214, "user_id": 806808, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c0b2b7f56ea26e55834aeed7a16e989?s=128&d=identicon&r=PG", "display_name": "Andrey Belykh", "link": "https://stackoverflow.com/users/806808/andrey-belykh"}, "edited": false, "score": 0, "creation_date": 1513610969, "post_id": 47791608, "comment_id": 82708472, "body": "@AndreyBelykh That is what I am doing, notice the table on the link provided gives a value of 0 for vbHide... This is why I am using <code>WindowStyle:=0</code> - the zero IS vbHide. It works for the main .exe window, but not any popups."}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1513417410, "creation_date": 1513417410, "answer_id": 47844352, "question_id": 47791608, "link": "https://stackoverflow.com/questions/47791608/how-to-hide-all-windows-when-using-run-in-vba-when-windowstyle-0-is-not-suffic/47844352#47844352", "title": "How to hide all windows when using .Run in VBA, when windowStyle=0 is not sufficient", "body": "<p>How about:</p>\n\n<pre><code>Dim TaskID as Double\nTaskID = Shell(\"program.exe\", vbHide)\n</code></pre>\n\n<p><strong><em>or</em></strong> if the window is not behaving as desired, try <code>vbNormalNoFocus</code> or <code>vbMinimizedNoFocus</code>.</p>\n\n<p>If this isn't suitable for some reason, please share some more about what the .exe ...  Perhaps redirected output could be an option.</p>\n\n<ul>\n<li><p>More from <a href=\"https://msdn.microsoft.com/en-us/VBA/language-reference-vba/articles/shell-function?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">MSDN</a>.</p></li>\n<li><p>Some interesting notes <a href=\"http://www.oreilly.com/openbook/motif/vol6a/Vol6a_html/ch16.html\" rel=\"nofollow noreferrer\">here</a> <sub><sup>(albeit for C#)</sup></sub></p></li>\n<li><p><a href=\"http://www.xtremevbtalk.com/api/138193-redirect-standard-output.html\" rel=\"nofollow noreferrer\">Redirecting standard Shell output</a></p></li>\n</ul>\n\n<p>I assume you are unable to modify \"program.exe\" to use a different type of notification?</p>\n\n<h2>An alternative approach is to <strong>force Excel to stay \"on top\"</strong>:</h2>\n\n<ul>\n<li><p><a href=\"https://www.howtogeek.com/196958/the-3-best-ways-to-make-a-window-always-on-top-on-windows/\" rel=\"nofollow noreferrer\">3 Best Ways to Force a Window to Stay on Top</a></p></li>\n<li><p>A utility called <a href=\"https://www.pcworld.com/article/218511/Windows.html\" rel=\"nofollow noreferrer\">\"Always On Top\"</a></p></li>\n<li><p><a href=\"https://www.extendoffice.com/documents/excel/2030-keep-excel-window-on-top.html\" rel=\"nofollow noreferrer\">How to keep Excel Window Always on Top</a>, such as:</p></li>\n</ul>\n\n<p><code>#If Win64 Then</code></p>\n\n<pre><code>    Public Declare PtrSafe Function SetWindowPos _\n        Lib \"user32\" ( _\n            ByVal hwnd As LongPtr, _\n            ByVal hwndInsertAfter As LongPtr, _\n            ByVal x As Long, ByVal y As Long, _\n            ByVal cx As Long, ByVal cy As Long, _\n            ByVal wFlags As Long) _\n    As Long\n</code></pre>\n\n<p><code>#Else</code></p>\n\n<pre><code>    Public Declare Function SetWindowPos _\n        Lib \"user32\" ( _\n            ByVal hwnd As Long, _\n            ByVal hwndInsertAfter As Long, _\n            ByVal x As Long, ByVal y As Long, _\n            ByVal cx As Long, ByVal cy As Long, _\n            ByVal wFlags As Long) _\n    As Long\n#End If\n\nPublic Const SWP_NOSIZE = &amp;H1\nPublic Const SWP_NOMOVE = &amp;H2\nPublic Const HWND_TOPMOST = -1\nPublic Const HWND_NOTOPMOST = -2\n\nSub ShowXLOnTop(ByVal OnTop As Boolean)\n    Dim xStype As Long\n    #If Win64 Then\n        Dim xHwnd As LongPtr\n    #Else\n        Dim xHwnd As Long\n    #End If\n    If OnTop Then\n        xStype = HWND_TOPMOST\n    Else\n        xStype = HWND_NOTOPMOST\n    End If\n    Call SetWindowPos(Application.hwnd, xStype, 0, 0, 0, 0, SWP_NOSIZE Or SWP_NOMOVE)\nEnd Sub\n\nSub SetXLOnTop()\n    ShowXLOnTop True\nEnd Sub\n\nSub SetXLNormal()\n    ShowXLOnTop False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "edited": false, "score": 0, "creation_date": 1513587715, "post_id": 47858696, "comment_id": 82694885, "body": "Looks like some fantastic information, thank you. I will try to implement later this afternoon and update my post/comments."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 3, "last_activity_date": 1513539149, "creation_date": 1513539149, "answer_id": 47858696, "question_id": 47791608, "link": "https://stackoverflow.com/questions/47791608/how-to-hide-all-windows-when-using-run-in-vba-when-windowstyle-0-is-not-suffic/47858696#47858696", "title": "How to hide all windows when using .Run in VBA, when windowStyle=0 is not sufficient", "body": "<p>The short answer is to hide popups it is required to call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633547(v=vs.85).aspx\" rel=\"nofollow noreferrer\">ShowOwnedPopups(hwnd,0)</a>. The VBA declaration is given here</p>\n\n<pre><code>Declare Function ShowOwnedPopups Lib \"user32\" Alias \"ShowOwnedPopups\" _\n   (ByVal hwnd As Long, ByVal fShow As Long) As Long\n</code></pre>\n\n<p>For a longer answer with some experimental C# code investigating this see this <a href=\"http://exceldevelopmentplatform.blogspot.co.uk/2017/12/winapi-theres-difference-between-child.html\" rel=\"nofollow noreferrer\">blog post</a>.  I have copied first part of blog post into answer here for brevity.</p>\n\n<p>Firstly, a key reading resource is <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632599(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Windows Features</a> which tells that all windows are created with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632680(v=vs.85).aspx\" rel=\"nofollow noreferrer\">CreateWindowEx</a> but popups are create by specifying WS_POPUP and child windows are created by specifying WS_CHILD. So popups and child windows are different.</p>\n\n<p>On the same page in the section <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632599(v=vs.85).aspx#visibility\" rel=\"nofollow noreferrer\">Window Visibility</a> it explains that we can set the visibility of a main window and the change will cascade down to all child windows but there is no mention of this cascade affecting popups.</p>\n\n<p>And here is some final VBA code but which depends upon a simple C# demo program called VisibilityExperiment</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function ShowOwnedPopups Lib _\n    \"user32\" (ByVal hwnd As Long, _\n    ByVal fShow As Long) As Long\n\nPrivate Declare Function EnumWindows _\n    Lib \"user32\" ( _\n        ByVal lpEnumFunc As Long, _\n        ByVal lParam As Long) _\n        As Long\n\nPrivate Declare Function GetWindowThreadProcessId _\n    Lib \"user32\" (ByVal hwnd As Long, lpdwprocessid As Long) As Long\n\n\n\nPrivate mlPid As Long\nPrivate mlHWnd As Variant\n\n\nPrivate Function EnumAllWindows(ByVal hwnd As Long, ByVal lParam As Long) As Long\n\n    Dim plProcID As Long\n    GetWindowThreadProcessId hwnd, plProcID\n    If plProcID = mlPid Then\n        If IsEmpty(mlHWnd) Then\n            mlHWnd = hwnd\n            Debug.Print \"HWnd:&amp;\" &amp; Hex$(mlHWnd) &amp; \"  PID:&amp;\" &amp; Hex$(mlPid) &amp; \"(\" &amp; mlPid &amp; \")\"\n        End If\n    End If\n\n    EnumAllWindows = True\nEnd Function\n\nPrivate Function GetPID(ByVal sExe As String) As Long\n\n    Static oServ As Object\n    If oServ Is Nothing Then Set oServ = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n\n    Dim cProc As Object\n    Set cProc = oServ.ExecQuery(\"Select * from Win32_Process\")\n\n    Dim oProc As Object\n    For Each oProc In cProc\n        If oProc.Name = sExe Then\n            Dim lPid As Long\n            GetPID = oProc.ProcessID\n        End If\n    Next\n\nEnd Function\n\n\nPrivate Sub Test()\n\n    Dim wsh As IWshRuntimeLibrary.WshShell\n    Set wsh = New IWshRuntimeLibrary.WshShell\n\n    Dim lWinStyle As WshWindowStyle\n    lWinStyle = WshNormalFocus\n\n    Dim sExe As String\n    sExe = \"VisibilityExperiment.exe\"\n\n    Dim sExeFullPath As String\n    sExeFullPath = Environ$(\"USERPROFILE\") &amp; \"\\source\\repos\\VisibilityExperiment\\VisibilityExperiment\\bin\\Debug\\\" &amp; sExe\n\n    Dim x As Long\n    x = wsh.Run(sExeFullPath, lWinStyle, False)\n\n    mlPid = GetPID(sExe)\n\n    mlHWnd = Empty\n    Call EnumWindows(AddressOf EnumAllWindows, 0)\n\n\n    Stop\n    Call ShowOwnedPopups(mlHWnd, 0)  '* o to hide, 1 to show\n\nEnd Sub\n</code></pre>\n\n<p>To repeat, to hide popups one must call ShowOwnedPopups(). Sadly, I cannot see around this restriction. Even if we tried to use the Windows API directly to spawn the process there is nothing in the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686331(v=vs.85).aspx\" rel=\"nofollow noreferrer\">STARTUPINFO structure (Windows)</a> which looks like it will help, there is nothing to specify the visibility of popups.</p>\n"}, {"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1513623753, "post_id": 47870823, "comment_id": 82714954, "body": "Jeez! A virtual desktop huh? Wow!  Florent, you are definitely Windows API ninja.  Incidentally, OP is using Windows Scripting Host which has nice features such as being able to read stdout and stderr.  Whilst you are on this thread will you tell us how to replicate that is using CreateProcess?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1513627310, "post_id": 47870823, "comment_id": 82716595, "body": "@S Meaden, to read stdout/stderr, create a pipe with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365152(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>CreatePipe</code></a> and assign it to <code>STARTUPINFO</code>. Then to read it call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365467(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>ReadFile</code></a>. For an example. have a look here: <a href=\"https://stackoverflow.com/questions/7386730/shell-process-standard-output-reading-in-visual-basic-6\" title=\"shell process standard output reading in visual basic 6\">stackoverflow.com/questions/7386730/&hellip;</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1513629847, "post_id": 47870823, "comment_id": 82717641, "body": "Bless you.  I must blog this/that for future reference."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "edited": false, "score": 0, "creation_date": 1513692404, "post_id": 47870823, "comment_id": 82743396, "body": "Lovely stuff, I will try to implement this fix also. I may have issues with privileges on the machines where I am whilst trying to do something like this, but I&#39;ll give it a go. Thank you for the detailed answer."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "edited": false, "score": 0, "creation_date": 1513693721, "post_id": 47870823, "comment_id": 82744236, "body": "@FlorentB. Could you clarify how I adapt the syntax from the line  <code>exitCode = ExecuteHidden(&quot;cmd &#47;C echo abcd &gt; %USERPROFILE%\\Desktop\\output.txt&quot;, timeoutMs:=10000)</code> to launch my .exe with an input argument as I do in my question? Apologies, I&#39;m still a beginner. My .exe and .gpd input file are located in the same path if that&#39;s of any help."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "edited": false, "score": 1, "creation_date": 1513694120, "post_id": 47870823, "comment_id": 82744506, "body": "@Petrichor, &quot;cmd /C&quot; executes a command shell. To run your program, simply call <code>ExecuteHidden(&quot;program.exe &quot;&quot;argument&quot;&quot;&quot;, 10000)</code>. However you&#39;ll have to customize it to handle your popup since this example is simply waiting for the program to exit."}, {"owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "edited": false, "score": 0, "creation_date": 1513694899, "post_id": 47870823, "comment_id": 82745042, "body": "Fantastic, I have made the modifications to handle the pop up and it is working. Thank you. What little I have learnt about command strings comes from here: <a href=\"https://www.myonlinetraininghub.com/vba-shell\" rel=\"nofollow noreferrer\">link</a> - I will do some more reading to understand more clearly. All of the &quot;&quot;&quot; marks can get a little confusing."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1513608891, "last_edit_date": 1513608891, "creation_date": 1513608253, "answer_id": 47870823, "question_id": 47791608, "link": "https://stackoverflow.com/questions/47791608/how-to-hide-all-windows-when-using-run-in-vba-when-windowstyle-0-is-not-suffic/47870823#47870823", "title": "How to hide all windows when using .Run in VBA, when windowStyle=0 is not sufficient", "body": "<p>To run an application completely hidden, launch it in a different <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682573(v=vs.85).aspx\" rel=\"nofollow noreferrer\">desktop</a> with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>CreateProcess</code></a>.</p>\n\n<p>Here's an example executing a simple command line and waiting for the process to exit :</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare PtrSafe Function OpenDesktop Lib \"user32.dll\" Alias \"OpenDesktopW\" (ByVal lpszDesktop As LongPtr, ByVal dwFlags As Long, ByVal fInherit As Byte, ByVal dwDesiredAccess As Long) As LongPtr\nPrivate Declare PtrSafe Function CreateDesktop Lib \"user32.dll\" Alias \"CreateDesktopW\" (ByVal lpszDesktop As LongPtr, ByVal lpszDevice As LongPtr, ByVal pDevmode As LongPtr, ByVal dwFlags As Long, ByVal dwDesiredAccess As Long, ByVal lpsa As LongPtr) As LongPtr\nPrivate Declare PtrSafe Function CloseDesktop Lib \"user32.dll\" (ByVal hDesktop As LongPtr) As Long\nPrivate Declare PtrSafe Function CreateProcess Lib \"kernel32.dll\" Alias \"CreateProcessW\" (ByVal lpApplicationName As LongPtr, ByVal lpCommandLine As LongPtr, ByVal lpProcessAttributes As LongPtr, ByVal lpThreadAttributes As LongPtr, ByVal bInheritHandles As Byte, ByVal dwCreationFlags As Long, ByVal lpEnvironment As LongPtr, ByVal lpCurrentDirectory As LongPtr, ByRef lpStartupInfo As STARTUPINFO, ByRef lpProcessInformation As PROCESS_INFORMATION) As Long\nPrivate Declare PtrSafe Function WaitForSingleObject Lib \"kernel32.dll\" (ByVal hHandle As LongPtr, ByVal dwMilliseconds As Long) As Long\nPrivate Declare PtrSafe Function GetExitCodeProcess Lib \"kernel32.dll\" (ByVal hProcess As LongPtr, ByRef lpExitCode As Long) As Long\nPrivate Declare PtrSafe Function CloseHandle Lib \"kernel32.dll\" (ByVal hObject As LongPtr) As Long\nPrivate Declare PtrSafe Function GetWindowText Lib \"user32.dll\" Alias \"GetWindowTextW\" (ByVal hwnd As LongPtr, ByVal lpString As LongPtr, ByVal nMaxCount As Long) As Long\nPrivate Declare PtrSafe Function EnumDesktopWindows Lib \"user32.dll\" (ByVal hDesktop As LongPtr, ByVal lpfn As LongPtr, ByRef lParam As Any) As Long\nPrivate Declare PtrSafe Function SendMessageW Lib \"user32.dll\" (ByVal hwnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\nPrivate Declare PtrSafe Function GetLastError Lib \"kernel32.dll\" () As Long\n\nPrivate Type STARTUPINFO\n  cb                  As Long\n  lpReserved          As LongPtr\n  lpDesktop           As LongPtr\n  lpTitle             As LongPtr\n  dwX                 As Long\n  dwY                 As Long\n  dwXSize             As Long\n  dwYSize             As Long\n  dwXCountChars       As Long\n  dwYCountChars       As Long\n  dwFillAttribute     As Long\n  dwFlags             As Long\n  wShowWindow         As Integer\n  cbReserved2         As Integer\n  lpReserved2         As LongPtr\n  hStdInput           As LongPtr\n  hStdOutput          As LongPtr\n  hStdError           As LongPtr\nEnd Type\n\nPrivate Type PROCESS_INFORMATION\n  hProcess            As LongPtr\n  hThread             As LongPtr\n  dwProcessID         As Long\n  dwThreadID          As Long\nEnd Type\n\n\nPublic Sub UsageExample()\n  Dim exitCode As Long\n  exitCode = ExecuteHidden(\"cmd /C echo abcd &gt; %USERPROFILE%\\Desktop\\output.txt\", timeoutMs:=10000)\nEnd Sub\n\nPublic Function ExecuteHidden(command As String, timeoutMs As Long) As Long\n  Dim si As STARTUPINFO, pi As PROCESS_INFORMATION, hDesktop As LongPtr, ex As Long\n  Const NORMAL_PRIORITY_CLASS&amp; = &amp;H20&amp;, INFINITE&amp; = &amp;HFFFFFFFF, GENERIC_ALL&amp; = &amp;H10000000\n\n  On Error GoTo Catch\n\n  ' get a virtual desktop '\n  si.lpDesktop = StrPtr(\"hidden-desktop\")\n  hDesktop = OpenDesktop(si.lpDesktop, 0, 0, GENERIC_ALL)\n  If hDesktop Then Else hDesktop = CreateDesktop(si.lpDesktop, 0, 0, 0, GENERIC_ALL, 0)\n  If hDesktop Then Else Err.Raise GetLastError()\n\n  ' run the command '\n  si.cb = LenB(si)\n  If CreateProcess(0, StrPtr(command), 0, 0, 1, NORMAL_PRIORITY_CLASS, 0, 0, si, pi) Then Else Err.Raise GetLastError()\n\n  ' wait for exit '\n  If WaitForSingleObject(pi.hProcess, timeoutMs) Then Err.Raise 1000, , \"Timeout while waiting for the process to exit\"\n  If GetExitCodeProcess(pi.hProcess, ExecuteHidden) &lt;&gt; 0 Then Else Err.Raise GetLastError()\n\n  ' cleanup '\nCatch:\n  If pi.hThread Then CloseHandle pi.hThread\n  If pi.hProcess Then CloseHandle pi.hProcess\n  If hDesktop Then CloseDesktop hDesktop\n  If Err.Number Then Err.Raise Err.Number\nEnd Function\n</code></pre>\n\n<p>And if you need to find a window in the desktop, use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682615(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>EnumDesktopWindows</code></a> instead of <code>EnumWindows</code>:</p>\n\n<pre><code>Private Function FindWindow(ByVal hDesktop As LongPtr, title As String) As LongPtr\n  Dim hwnds As New Collection, hwnd, buffer$\n  buffer = Space$(1024)\n\n  EnumDesktopWindows hDesktop, AddressOf EnumDesktopWindowsProc, hwnds\n\n  For Each hwnd In hwnds\n    If Left$(buffer, GetWindowText(hwnd, StrPtr(buffer), Len(buffer))) Like title Then\n      FindWindow = hwnd\n      Exit Function\n    End If\n  Next\nEnd Function\n\nPrivate Function EnumDesktopWindowsProc(ByVal hwnd As LongPtr, hwnds As Collection) As Long\n  hwnds.Add hwnd\n  EnumDesktopWindowsProc = True\nEnd Function\n</code></pre>\n\n<p>If you need to close a window, simply send <code>WM_CLOSE</code> to the main window or to a popup:</p>\n\n<pre><code>const WM_CLOSE&amp; = &amp;H10&amp;\nSendMessageW hwnd, WM_CLOSE, 0, 0\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 9061106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/R009k.jpg?s=128&g=1", "display_name": "Petrichor", "link": "https://stackoverflow.com/users/9061106/petrichor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1611, "favorite_count": 2, "accepted_answer_id": 47870823, "answer_count": 3, "score": 3, "last_activity_date": 1513608891, "creation_date": 1513163505, "last_edit_date": 1513351590, "question_id": 47791608, "link": "https://stackoverflow.com/questions/47791608/how-to-hide-all-windows-when-using-run-in-vba-when-windowstyle-0-is-not-suffic", "title": "How to hide all windows when using .Run in VBA, when windowStyle=0 is not sufficient", "body": "<p>When launching an .exe using .Run in VBA, a typical call may look like this: </p>\n\n<pre><code>x = wsh.Run(Command:=\"program.exe \"\"argument\"\"\", WindowStyle:=0, waitonreturn:=False)\n</code></pre>\n\n<p>Where <code>windowStyle=0</code> should theoretically cause the program to run invisible to the user. But what if a pop-up window occurs within the .exe that you don't want to the user to see? </p>\n\n<p>The windowStyle input will not suppress the appearance of warning messages or pop up windows declaring things like 'calculation complete' from appearing to the user, this often also pauses the code until the pop up is cleared. Clearing the window (i.e. clicking 'okay') in an automated manner is trivial (see <a href=\"https://stackoverflow.com/questions/47771171/how-to-close-an-error-message-from-an-exe-called-from-a-excel-vba-script/47771463#47771463\">this answer</a>), but preventing it from appearing to the user to begin with is proving difficult to me as a relative beginner. (i.e. when the pop up is triggered by the .exe it is invisible to the user, and then closed automatically by the VBA code)  </p>\n\n<p>Currently I detect the existence of a new pop up window using this function (where sCaption is the name of the pop up window): </p>\n\n<pre><code>Private Function GetHandleFromPartialCaption(ByRef lWnd As Long, ByVal sCaption As String) As Boolean\n\nDim lhWndP As Long\nDim sStr As String\nGetHandleFromPartialCaption = False\nlhWndP = FindWindow(vbNullString, vbNullString) 'PARENT WINDOW\nDo While lhWndP &lt;&gt; 0\n    sStr = String(GetWindowTextLength(lhWndP) + 1, Chr$(0))\n    GetWindowText lhWndP, sStr, Len(sStr)\n    sStr = Left$(sStr, Len(sStr) - 1)\n    If InStr(1, sStr, sCaption) &gt; 0 Then\n        GetHandleFromPartialCaption = True\n        lWnd = lhWndP\n        Exit Do\n    End If\n    lhWndP = GetWindow(lhWndP, GW_HWNDNEXT)\n    Loop\nEnd Function\n</code></pre>\n\n<p>Then close it automatically. But it still briefly flashes up on screen to the user. Ideally I'd like this VBA code to run in the background so the user can get on with other tasks whilst it runs, not being distracted by flashing boxes. </p>\n\n<p><strong>Is there a way to force all windows of program.exe, including pop ups, to be invisible whilst it is running?</strong> </p>\n\n<p>For further information, see my previous question on how to close the pop up window, <a href=\"https://stackoverflow.com/questions/47771171/how-to-close-an-error-message-from-an-exe-called-from-a-excel-vba-script\">here</a>. This thread concerns how to prevent its appearance to a user. </p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>SendKeys is temperamental, so I am using this looping code to kill the .exe when I detect the pop up window, therefore the .exe does not need to be in focus to close the pop up (closing the pop up kills the .exe in my case anyway): </p>\n\n<pre><code>....\nMain Code Body\n....\n    t = Now\n    waittime = Now + TimeValue(\"0:01:30\") 'limit to run a single row of calculations \n    Do While t &lt; waittime\n        If GetHandleFromPartialCaption(lhWndP, \"Popup Window Text\") = True Then\n               Set oServ = GetObject(\"winmgmts:\")\n               Set cProc = oServ.ExecQuery(\"Select * from Win32_Process\")\n                  For Each oProc In cProc\n                      If oProc.Name = \"Program.exe\" Then \n                         errReturnCode = oProc.Terminate() \n                         Marker2 = 1\n                         Exit Do\n                      End If\n                  Next\n        Endif\n    Loop\n....\nMain Code Body Continues\n....\n</code></pre>\n\n<p>where <code>GetHandleFromPartialCaption()</code> is the function above, finding the pop up window based on the sCaption argument. My code loops and searches constantly for the pop up whilst the .exe is running the calculation, and kills the .exe as soon as it appears. But it still flashes up to the user. </p>\n"}, {"tags": ["vba", "internet-explorer", "buttonclick"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1513165267, "post_id": 47791338, "comment_id": 82545266, "body": "I once faced a similar problem. In the end I just ended up checking whether or not I was logged into the site by the return url. If not logged in I prompted an error message telling the user to log in and try again."}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 4754206, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc10916c5690d15b3c4fcf9232b7d90a?s=128&d=identicon&r=PG&f=1", "display_name": "f1rstsurf", "link": "https://stackoverflow.com/users/4754206/f1rstsurf"}, "edited": false, "score": 0, "creation_date": 1513169411, "post_id": 47791665, "comment_id": 82547735, "body": "Hi, i couldn&#39;t gave you the URL cause it&#39;s an internal one, from my company, thank you it Works !"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1513163689, "creation_date": 1513163689, "answer_id": 47791665, "question_id": 47791338, "link": "https://stackoverflow.com/questions/47791338/use-vba-to-click-on-a-button-in-ie/47791665#47791665", "title": "Use VBA to click on a button in IE", "body": "<p>I cannot test it without knowing your URL, but this maywork:</p>\n\n<pre><code>For Each ele In IE.document.getElementsByTagName(\"ul\")\n    For Each ele2 In ele.getElementsByTagName(\"a\")\n        If InStr(ele2.InnerHtml, \"aria-labelledby=\"\"Exporter vers CSV\"\"\") Then ele2.Click\n    Next ele2\nNext ele\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 1, "last_activity_date": 1513165109, "creation_date": 1513165109, "answer_id": 47792091, "question_id": 47791338, "link": "https://stackoverflow.com/questions/47791338/use-vba-to-click-on-a-button-in-ie/47792091#47792091", "title": "Use VBA to click on a button in IE", "body": "<p>Give this a go. When you are upon <code>instr()</code> function then simply the below method should get you there.</p>\n\n<pre><code>For Each ele In IE.document.getElementsByTagName(\"a\")\n    If InStr(ele.getAttribute(\"aria-labelledby\"), \"Exporter vers CSV\") &gt; 0 Then ele.Click: Exit For\nNext ele\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 4754206, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc10916c5690d15b3c4fcf9232b7d90a?s=128&d=identicon&r=PG&f=1", "display_name": "f1rstsurf", "link": "https://stackoverflow.com/users/4754206/f1rstsurf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 47791665, "answer_count": 2, "score": 0, "last_activity_date": 1513165857, "creation_date": 1513162665, "last_edit_date": 1513165857, "question_id": 47791338, "link": "https://stackoverflow.com/questions/47791338/use-vba-to-click-on-a-button-in-ie", "title": "Use VBA to click on a button in IE", "body": "<p>I'm currently looking for a way to click on a button on a web page to automate an export.</p>\n\n<p>I've already succeeded with logging in to the web page and clicking on the login button to redirect the page, but then I could not click on the next button i'm looking for.</p>\n\n<p>My code : </p>\n\n<pre><code>For Each ele In IE.document.getElementsByTagName(\"ul\")\n If ele.document.getElementsByTagName(\"a\").getAttribute(\"aria-labelledby\") = \"Exporter vers CSV\" Then ele.Click\nNext\n</code></pre>\n\n<p>Website source:</p>\n\n<pre><code>&lt;ul class=\"dropdown-menu pull-left\"&gt;\n   &lt;!-- ngRepeat: item in secondaryItems track by item.dataAid --&gt;&lt;li ng-repeat=\"item in secondaryItems track by item.dataAid\" class=\"\"&gt;\n     &lt;a role=\"button\" ng-show=\"item.visible\" aria-labelledby=\"Exporter vers CSV\" data-aid=\"tool-bar-inner-dd-btn-export\" type=\"submit\" ng-disabled=\"!item.enabled\" ng-class=\"{plToolbarItemDisabled:!item.enabled, disabled:!item.enabled}\" class=\"grid-export-item-btn\" ng-click=\"item.callback(item, $event)\" pl-toolbar-button-in-dropdown=\"\" item=\"item\"&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1513162809, "post_id": 47791318, "comment_id": 82543700, "body": "Please show the code you have up to now, especially one opening PDF and copying data to MS Word."}, {"owner": {"reputation": 11, "user_id": 9092855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdc6f932bfc7d2f33e9628ae68bb902?s=128&d=identicon&r=PG&f=1", "display_name": "Slates", "link": "https://stackoverflow.com/users/9092855/slates"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1513163997, "post_id": 47791318, "comment_id": 82544519, "body": "Thanks for your response, I can currently only open a PDF file and copy the content from that file, I am wondering if I can open the PDF file with MS Word by using VBA in Excel. The code I have so far is as follows:"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1513164025, "post_id": 47791318, "comment_id": 82544534, "body": "Edit your question, don&#39;t add you code in comments here.."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1513164502, "post_id": 47791318, "comment_id": 82544825, "body": "Excel also has VBA coding abilities. Look for the developer tab in your ribbon. It might be switched off, in that case just google how to switch it on."}, {"owner": {"reputation": 11, "user_id": 9092855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdc6f932bfc7d2f33e9628ae68bb902?s=128&d=identicon&r=PG&f=1", "display_name": "Slates", "link": "https://stackoverflow.com/users/9092855/slates"}, "edited": false, "score": 0, "creation_date": 1513165640, "post_id": 47791318, "comment_id": 82545471, "body": "I am using developer mode in Excel currently, I would like to open a PDF file with MS Word by using VBA code in excel, sorry for the confusion"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9092855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdc6f932bfc7d2f33e9628ae68bb902?s=128&d=identicon&r=PG&f=1", "display_name": "Slates", "link": "https://stackoverflow.com/users/9092855/slates"}, "edited": false, "score": 0, "creation_date": 1513176632, "post_id": 47794097, "comment_id": 82552552, "body": "Thanks, was a great help to me, I was missing the Word Library, works fine now"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 3, "last_activity_date": 1513171383, "creation_date": 1513171383, "answer_id": 47794097, "question_id": 47791318, "link": "https://stackoverflow.com/questions/47791318/open-a-pdf-with-word-vba-in-excel/47794097#47794097", "title": "open a pdf with word vba in Excel", "body": "<p>This solution requires a reference to the Word library to be set in Excel (Tools,references)</p>\n\n<pre><code>Sub test()\nDim s As String\nDim t As Excel.Range\ns = \"\\\\my path\\my file.pdf\"\nDim wd As New Word.Application\nDim mydoc As Word.Document\nSet mydoc = Word.Documents.Open(Filename:=s, Format:=\"PDF Files\", ConfirmConversions:=False)\nDim wr As Word.Range\nSet wr = mydoc.Paragraphs(1).Range\nwr.WholeStory   \nSet t = Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\nwr.Copy\nt.PasteSpecial xlPasteValues\nmydoc.Close False\nwd.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9092855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdc6f932bfc7d2f33e9628ae68bb902?s=128&d=identicon&r=PG&f=1", "display_name": "Slates", "link": "https://stackoverflow.com/users/9092855/slates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4950, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1594069259, "creation_date": 1513162589, "last_edit_date": 1594069259, "question_id": 47791318, "link": "https://stackoverflow.com/questions/47791318/open-a-pdf-with-word-vba-in-excel", "title": "open a pdf with word vba in Excel", "body": "<p>I am new to <code>vba</code> and I have been trying to open a PDF file with <code>MS word</code> 2016 in order to copy the data and populate cells in <code>Excel</code>, I have been able to open the PDF and copy the data but I have found it tricky to get the data I need and to populate the cells in <code>Excel</code>. I was wondering if this was possible to code in VBA via <code>excel</code>. </p>\n\n<p>thanks  </p>\n"}, {"tags": ["vba", "outlook", "outlook-2016"], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1520430618, "last_edit_date": 1520430618, "creation_date": 1513162893, "answer_id": 47791427, "question_id": 47791242, "link": "https://stackoverflow.com/questions/47791242/outlook-vba-macro-to-search-by-colour-category/47791427#47791427", "title": "Outlook VBA macro to search by colour category", "body": "<p>did you tried:</p>\n\n<pre><code>txtSearch = \"category:=\"\"Red category\"\"\"\n</code></pre>\n\n<p>Complete:</p>\n\n<pre><code>Sub Red()\nDim myOlApp As New Outlook.Application\ntxtSearch = \"category:=\"\"Red category\"\"\"\nmyOlApp.ActiveExplorer.Search txtSearch, olSearchScopeAllFolders\nSet myOlApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13325, "user_id": 2641576, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/K9yqy.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2641576/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 852, "favorite_count": 0, "accepted_answer_id": 47791427, "answer_count": 1, "score": 1, "last_activity_date": 1593041304, "creation_date": 1513162353, "last_edit_date": 1593041304, "question_id": 47791242, "link": "https://stackoverflow.com/questions/47791242/outlook-vba-macro-to-search-by-colour-category", "title": "Outlook VBA macro to search by colour category", "body": "<p>I want to make a VBA macro to search ALL folders including my online archive by colour category <code>RED</code></p>\n\n<p>Don't have a clue where to start with this!</p>\n\n<p>I have a text search one but this obviously doesn't do colours.</p>\n\n<pre><code>Sub SearchMacro()\nDim myOlApp As New Outlook.Application\ntxtSearch = \"category:(Business)\"\nmyOlApp.ActiveExplorer.Search txtSearch, olSearchScopeAllFolders\nSet myOlApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "multidimensional-array", "constants"], "comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1513162741, "post_id": 47791196, "comment_id": 82543643, "body": "which line of your code causes error?"}, {"owner": {"reputation": 441, "user_id": 6314220, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/SLbzv.jpg?s=128&g=1", "display_name": "ThomasRones", "link": "https://stackoverflow.com/users/6314220/thomasrones"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1513163172, "post_id": 47791196, "comment_id": 82543960, "body": "Currently 3 - Const constlr As Integer = lr  but if I remove that line and change all constlr to lr, then it is line 5 -  Dim TableNamesArr(2 To lr, 1 To 4) As String. The lr is the problem, it needs to be an integer or constant, but not a variable holding an integer"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1513163890, "post_id": 47791196, "comment_id": 82544442, "body": "The answer to you main (title) question is <b>No, you can not do this</b> and the proof is in your question and your tests (last few lines). My question is- why do you think you have to have <code>lr</code> set as constant? Think of constant definition- it is something you don&#39;t change but you want to change it. It doesn&#39;t make sens."}, {"owner": {"reputation": 441, "user_id": 6314220, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/SLbzv.jpg?s=128&g=1", "display_name": "ThomasRones", "link": "https://stackoverflow.com/users/6314220/thomasrones"}, "edited": false, "score": 0, "creation_date": 1513164169, "post_id": 47791196, "comment_id": 82544623, "body": "I don&#39;t want to change it, but I don&#39;t know what its value will be; VBA figures this out.  So the question is, how can I retrieve that value from the variable and put it into the constant. This only happens once, the value does not change."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1513165033, "post_id": 47791196, "comment_id": 82545136, "body": "So, once again, you can not do it by code but type it manually as you do. Again, constant is something fixed and should not be set based on variable. Use variable instead."}, {"owner": {"reputation": 441, "user_id": 6314220, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/SLbzv.jpg?s=128&g=1", "display_name": "ThomasRones", "link": "https://stackoverflow.com/users/6314220/thomasrones"}, "edited": false, "score": 2, "creation_date": 1513166021, "post_id": 47791196, "comment_id": 82545691, "body": ":( oh well. Thanks for the help. Turns out my logic was bad anyways. I completed my original idea by just sticking to cell references and avoiding the array altogether"}], "answers": [{"tags": [], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "is_accepted": false, "score": 1, "last_activity_date": 1513172302, "last_edit_date": 1513172302, "creation_date": 1513163073, "answer_id": 47791488, "question_id": 47791196, "link": "https://stackoverflow.com/questions/47791196/is-it-possible-to-declare-a-constant-based-on-a-preexisting-variables-value-in/47791488#47791488", "title": "Is it possible to declare a constant based on a preexisting variable&#39;s value in VBA?", "body": "<p>You can read values from Range without looping, in a simple way:</p>\n\n<pre><code>Dim DirArray As Variant\nDirArray = Range(\"a1:a5\").Value\n</code></pre>\n\n<p>Instead of Range(\"a1:a5\") you may reference your range by selection or other methods <code>Selection.Value</code> or <code>Activesheet.UsedRange.Value</code>.</p>\n\n<p>If your range is in a table you may try this code stolen from <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">here</a>: </p>\n\n<pre><code>Sub MultiColumnTable_To_Array()\n\nDim myTable As ListObject\nDim myArray As Variant\nDim x As Long\n\n'Set path for Table variable\n  Set myTable = ActiveSheet.ListObjects(\"Table1\")\n\n'Create Array List from Table\n  myArray = myTable.DataBodyRange\n\n'Loop through each item in Third Column of Table (displayed in Immediate Window [ctrl + g])\n  For x = LBound(myArray) To UBound(myArray)\n    Debug.Print myArray(x, 3)\n  Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 766, "user_id": 8803849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/919f7018350489feffd3d0766f6ebbbb?s=128&d=identicon&r=PG&f=1", "display_name": "itsLex", "link": "https://stackoverflow.com/users/8803849/itslex"}, "is_accepted": true, "score": 1, "last_activity_date": 1513214089, "creation_date": 1513214089, "answer_id": 47804494, "question_id": 47791196, "link": "https://stackoverflow.com/questions/47791196/is-it-possible-to-declare-a-constant-based-on-a-preexisting-variables-value-in/47804494#47804494", "title": "Is it possible to declare a constant based on a preexisting variable&#39;s value in VBA?", "body": "<p>You can use a variable in Redim, not in Dim. You actually don't need the constant for this.</p>\n\n<pre><code>lr = Tables.Cells(Rows.Count, 1).End(xlUp).Row\nConst constlr As Integer = lr\nDim TableNamesArr() As String\nRedim TableNamesArr(2 To constlr, 1 To 4)\nDim i As Integer, j As Integer\nFor i = 2 To lr\n    For j = 1 To 4\n        TableNamesArr(i, j) = Tables.Cells(i, j).Value\n    Next j\nNext i\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 6314220, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/SLbzv.jpg?s=128&g=1", "display_name": "ThomasRones", "link": "https://stackoverflow.com/users/6314220/thomasrones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 47804494, "answer_count": 2, "score": 1, "last_activity_date": 1513214089, "creation_date": 1513162218, "last_edit_date": 1513163961, "question_id": 47791196, "link": "https://stackoverflow.com/questions/47791196/is-it-possible-to-declare-a-constant-based-on-a-preexisting-variables-value-in", "title": "Is it possible to declare a constant based on a preexisting variable&#39;s value in VBA?", "body": "<p>I need to create a multidimensional array, but I do not know the height of the array.\nI get this value and store it in a variable. Unfortunately I cannot use a variable when declaring the array, I need to use constants. So I thought that I could just declare a constant from the variable, but then I get the same error \"Constant Expression Required\" just on an earlier line.</p>\n\n<pre><code>lr = Tables.Cells(Rows.Count, 1).End(xlUp).Row\n\nConst constlr As Integer = lr\n\nDim TableNamesArr(2 To constlr, 1 To 4) As String\nDim i As Integer, j As Integer\n\nFor i = 2 To lr\n    For j = 1 To 4\n        TableNamesArr(i, j) = Tables.Cells(i, j).Value\n    Next j\nNext i\n</code></pre>\n\n<p>Currently line 3 is the issue - \nConst constlr As Integer = lr </p>\n\n<p>but if I remove that line and change all constlr to lr, then it is line 5 - \n<code>Dim TableNamesArr(2 To lr, 1 To 4) As String</code>. </p>\n\n<p>The lr is the problem, it needs to be an integer or constant, but not a variable holding an integer</p>\n\n<p>The code works fine if I change:</p>\n\n<pre><code>Const constlr As Integer = lr     \n</code></pre>\n\n<p>to</p>\n\n<pre><code>Const constlr As Integer = 102\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "edited": false, "score": 1, "creation_date": 1513161170, "post_id": 47790829, "comment_id": 82542639, "body": "Can you provide more code first ? So we can at leat see the variable declaration and can you tell us what error is displayed exactly ?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1513161330, "post_id": 47790829, "comment_id": 82542732, "body": "<i>&#39;It doesn&#39;t work&#39;</i> is not a problem description. Why not?"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "edited": false, "score": 0, "creation_date": 1513161684, "post_id": 47790859, "comment_id": 82542983, "body": "I&#39;m a moron. Thank you!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1513161228, "creation_date": 1513161228, "answer_id": 47790859, "question_id": 47790829, "link": "https://stackoverflow.com/questions/47790829/calling-countifs-in-vba-with/47790859#47790859", "title": "Calling countifs in vba with &lt;&gt;", "body": "<p>You misspelled your code, it should read as:</p>\n\n<pre><code>answer = WorksheetFunction.countifs(myrange, \"&lt;&gt;x\", myrange, \"&lt;&gt;y\") \n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "closed_date": 1513200122, "accepted_answer_id": 47790859, "answer_count": 1, "score": -1, "last_activity_date": 1513161228, "creation_date": 1513161109, "last_edit_date": 1531164843, "question_id": 47790829, "link": "https://stackoverflow.com/questions/47790829/calling-countifs-in-vba-with", "closed_reason": "Needs more focus", "title": "Calling countifs in vba with &lt;&gt;", "body": "<p>does anyone know why the following line errors?</p>\n\n<pre><code>answer = WorksheetFunction.counitfs(myrange, \"&lt;&gt;x\", myrange, \"&lt;&gt;y\")\n</code></pre>\n\n<p>I am trying to find the number of values in a range that are not equal to x or y. It works in Excel, but not in vba, not too sure why...</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "find"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1513161311, "post_id": 47790663, "comment_id": 82542723, "body": "Just for your interest <code>LookAt</code> <b>has no default</b> to <code>xlPart</code> it just uses the one that was used last before using <code>find</code>. So if you don&#39;t specify <code>LookAt</code> at all you never know what you will get."}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "reply_to_user": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 2, "creation_date": 1513162348, "post_id": 47790663, "comment_id": 82543404, "body": "@PatrickS If you will be using similar VBA code with <code>LookAt:=xlWhole</code> quite a bit, may I suggest adding a dummy find afterwards using <code>LookAt:=xlPart</code>. Otherwise, Excel will save your new setting and next time you try and do a find within Excel it will retrieve only cells containing exactly the search query. You may have a headache wondering why Excel is saying it can&#39;t find <code>Red</code> when there is a cell right in front of you with the value <code>Redgate</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1513163444, "post_id": 47790663, "comment_id": 82544132, "body": "@BrownishMonster That&#39;s a good point. Defaulting to the last used is really annoying."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1513164756, "post_id": 47790663, "comment_id": 82544979, "body": "Did anyone already make a topic on excel uservoice about this. It just should have a default imho"}], "tags": [], "owner": {"reputation": 40, "user_id": 9093261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cefcc88da5007de33536e6f54fb0b2be?s=128&d=identicon&r=PG&f=1", "display_name": "DevLuke", "link": "https://stackoverflow.com/users/9093261/devluke"}, "is_accepted": true, "score": 1, "last_activity_date": 1513161408, "last_edit_date": 1513161408, "creation_date": 1513160657, "answer_id": 47790663, "question_id": 47790423, "link": "https://stackoverflow.com/questions/47790423/excel-vba-find-method-goes-wrong/47790663#47790663", "title": "Excel VBA Find method goes wrong?", "body": "<p>You get twice the same result as by default the <code>LookAt</code> parameter in the <code>Find</code> function is set to <code>xlPart</code>.\nTry setting the <code>LookAt</code> parameter to <code>xlWhole</code> in the <code>Find</code> function as follows:</p>\n\n<pre><code>FindTotalLineVAT = sht.Range(\"1:1\").Find(\"Total Lineamount\", Lookat:=xlWhole).Address(False, False, xlA1)\n\nFindTotalLineXVAT = sht.Range(\"1:1\").Find(\"Total Lineamount excl VAT\", Lookat:=xlWhole).Address(False, False, xlA1)\n</code></pre>\n\n<p>It should now work as expected.</p>\n"}], "owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 47790663, "answer_count": 1, "score": 3, "last_activity_date": 1513161408, "creation_date": 1513160033, "last_edit_date": 1513161040, "question_id": 47790423, "link": "https://stackoverflow.com/questions/47790423/excel-vba-find-method-goes-wrong", "title": "Excel VBA Find method goes wrong?", "body": "<p><strong>My Sheet</strong></p>\n\n<p>I have during some time developped some sheets, which relies on the same macro.\nIt will find the headers, and copy the columns from the selected columns.</p>\n\n<p>The sheet is made to compare two different sets of data, whereas the Find function within VBA is used very often.</p>\n\n<p><strong>My Problem</strong></p>\n\n<p>The problem lies within the <code>Find</code> function, whereas it references the same column, with two different names, which have a slight comparison.</p>\n\n<p>It happens with two columns, which has a comparison in name, to some extent, as shown below:</p>\n\n<pre><code>Sub CopyPasteDataLookingForHeader()\n\n    Dim sht As Worksheet\n    Set sht = Sheets(\"Put in data\")\n\n    'I'm trying to find the column header Total Lineamount within my sheet\n    FindTotalLineVAT = sht.Range(\"1:1\").Find(\"Total Lineamount\").Address(False, False, xlA1)\n    TotalLineVAT = Application.WorksheetFunction.Substitute(FindTotalLineVAT, 1, \"\")\n\n    'FindTotalLineVAT will return Cell \"J1\"\n    'TotalLineVAT will return column \"J\"\n\n    'I'm trying to find the column header Total Lineamount excl VAT within my sheet\n    FindTotalLineXVAT = sht.Range(\"1:1\").Find(\"Total Lineamount excl VAT\").Address(False, False, xlA1)\n    TotalLineXVAT = Application.WorksheetFunction.Substitute(FindTotalLineXVAT, 1, \"\")\n\n    'FindTotalLineXVAT will return Cell \"J1\"\n    'TotalLineXVAT will return column \"J\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>My Goal</strong></p>\n\n<p>I want this formula to return two different results of cell and column.\nThe \"Find\" function should return two different sets of cells, since the names are different to some extent.</p>\n\n<p>Can someone explain why \"Find\" is not searching for the entire name, but only bits of it?</p>\n\n<p>Please do let me know, your answer is very much appreciated :)</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1513159873, "post_id": 47790234, "comment_id": 82541730, "body": "Thank you. Works perfectly"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1513159438, "creation_date": 1513159438, "answer_id": 47790234, "question_id": 47790094, "link": "https://stackoverflow.com/questions/47790094/how-to-avoid-blank-cells-when-using-if-formula-in-excel/47790234#47790234", "title": "How to avoid Blank cells when using IF Formula in Excel", "body": "<p>add one more condition:</p>\n\n<pre><code>=IF(ISBLANK(C2);\"\";IF(AND(A2&lt;=(TODAY()+90);C2&lt;=40%);\"High\";\"Low\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 1, "last_activity_date": 1513159543, "creation_date": 1513159543, "answer_id": 47790264, "question_id": 47790094, "link": "https://stackoverflow.com/questions/47790094/how-to-avoid-blank-cells-when-using-if-formula-in-excel/47790264#47790264", "title": "How to avoid Blank cells when using IF Formula in Excel", "body": "<p>If you are useing a Table inside A Table i would Work With @. and a Second if Condition.</p>\n\n<pre><code>=If([@Complete]=\"\";\"\";IF(AND([@Date]&lt;=(TODAY()+90);@Complete&lt;=40%);\"High\";\"Low\")\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47790234, "answer_count": 2, "score": 0, "last_activity_date": 1513159543, "creation_date": 1513158946, "question_id": 47790094, "link": "https://stackoverflow.com/questions/47790094/how-to-avoid-blank-cells-when-using-if-formula-in-excel", "title": "How to avoid Blank cells when using IF Formula in Excel", "body": "<p><a href=\"https://i.stack.imgur.com/G4Zwe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G4Zwe.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have a Table and in column D i will enter this formula. </p>\n\n<pre><code>=IF(AND(A2&lt;=(TODAY()+90);C2&lt;=40%);\"High\";\"Low\")\n</code></pre>\n\n<p>I will insert inside a Table. So it can be automatically draged down.\nBased on conditions, it will show High or Low and then it will highlight only the entire row for \"High\". But my problem is if there is no values in Column C; then it is still showing as High and Highlighting. If there is no value then it should not show anything. How to change the formula. Help me </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 6701165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95cdabe2492667afeb8ac1e6645ead28?s=128&d=identicon&r=PG&f=1", "display_name": "mowgli", "link": "https://stackoverflow.com/users/6701165/mowgli"}, "is_accepted": false, "score": 0, "last_activity_date": 1513160052, "creation_date": 1513160052, "answer_id": 47790433, "question_id": 47790074, "link": "https://stackoverflow.com/questions/47790074/alternative-to-vba-goalseek/47790433#47790433", "title": "Alternative to VBA GoalSeek", "body": "<p>How about Excel Solver? It can be automated too and allows for significantly more complicated inputs</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/using-the-solver-vba-functions\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/using-the-solver-vba-functions</a></p>\n"}], "owner": {"reputation": 329, "user_id": 7690917, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/b9e7b42a2a7abd3dd2ea0f8896c56fd2?s=128&d=identicon&r=PG&f=1", "display_name": "bub", "link": "https://stackoverflow.com/users/7690917/bub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 795, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513173325, "creation_date": 1513158885, "last_edit_date": 1513173325, "question_id": 47790074, "link": "https://stackoverflow.com/questions/47790074/alternative-to-vba-goalseek", "title": "Alternative to VBA GoalSeek", "body": "<p>Does there exist an alternative to GoalSeek in VBA? My worksheet is filled with functions that do not like GoalSeek called from subroutines, and I'm looking for a alternative for optimization.</p>\n"}, {"tags": ["javascript", "excel", "vba", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1513169199, "post_id": 47793342, "comment_id": 82547593, "body": "If it fails, try to do the same with a <code>space</code> at the end of the class name like <code>.getElementsByClassName(&quot;x-combo-list-item &quot;)</code>."}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "edited": false, "score": 0, "creation_date": 1513173917, "post_id": 47793342, "comment_id": 82550710, "body": "it is iterating successfully but after the 2nd iteration the click event isn\u2019t firing. Should we use something like fireevent?"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1513168997, "creation_date": 1513168997, "answer_id": 47793342, "question_id": 47790001, "link": "https://stackoverflow.com/questions/47790001/clicking-on-child-div-inside-dropdown/47793342#47793342", "title": "Clicking on child DIV inside dropdown", "body": "<p>Have you tried like this? It should work.</p>\n\n<pre><code>Dim post As Object\n\nFor Each post In IE.document.getElementsByClassName(\"x-combo-list-item\")\n    If InStr(post.innerText, \"Add Lead Disposition\") &gt; 0 Then post.Click: Exit For\nNext post\n</code></pre>\n"}], "owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 47793342, "answer_count": 1, "score": 0, "last_activity_date": 1513188279, "creation_date": 1513158703, "last_edit_date": 1513188279, "question_id": 47790001, "link": "https://stackoverflow.com/questions/47790001/clicking-on-child-div-inside-dropdown", "title": "Clicking on child DIV inside dropdown", "body": "<p>I succeeded already to enable a dropdown through Excel VBA in internet explorer, however I can't manage to click the second child <code>DIV</code>. Although I can <code>debug.print</code> the contents of the dropdown, i can't manage to <code>fireevent</code> on  the <code>DIV</code> inside. This is the source code i am dealing with and what i did so far.</p>\n\n<pre><code>&lt;div style=\"border-width: 1px; z-index: 1018; visibility: visible; height: 238px; width: 304px; left: 1566px; top: 144px;\" role=\"presentation\" id=\"x-auto-1048\" class=\"x-combo-list x-ignore x-component x-border \"&gt;&lt;div tabindex=\"0\" hidefocus=\"true\" id=\"x-auto-318\" class=\" x-view x-combo-list-inner x-component  x-unselectable\" style=\"overflow-x: hidden; padding: 0px; border-width: 0px; height: 238px; width: 304px;\" unselectable=\"on\"&gt;   &lt;div class=\"x-combo-list-item x-panel-header \"&gt;&amp;nbsp;Actions&lt;/div&gt;&lt;div class=\"x-combo-list-item \"&gt;Add Lead Disposition&lt;/div&gt;&lt;div class=\"x-combo-list-item  x-view-highlightrow x-combo-selected\"&gt;Add Lead Assignment Priority&lt;/div&gt;&lt;div class=\"x-combo-list-item x-panel-header \"&gt;Audits&lt;/div&gt;&lt;div class=\"x-combo-list-item \"&gt;Account Settings&lt;/div&gt;&lt;div class=\"x-combo-list-item x-panel-header \"&gt;Actions&lt;/div&gt;&lt;div class=\"x-combo-list-item \"&gt;Add Lead Disposition&lt;/div&gt;&lt;div class=\"x-combo-list-item \"&gt;Add Lead Assignment Priority&lt;/div&gt;&lt;div class=\"x-combo-list-item x-panel-header \"&gt;Audits&lt;/div&gt;&lt;div class=\"x-combo-list-item \"&gt;Account Settings&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n</code></pre>\n\n<p>And this what I did until now</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim ie As Object\nDim button As Variant\nDim var As String: var = ActiveCell.Value\n\n\nDim disp As Object\nDim dis As Object\nDim innnerr As Variant\nDim i               As Long: i = 0\nReDim innnerr(1000)\nSet ie = CreateObject(\"internetexplorer.application\")\nie.Visible = True\n With ie\n    .Visible = True\n    .navigate \"http://controlpanel.sukutrade.verio/index.html#account-overview?sukuAccountUsername=\" &amp; var\n    While .readyState = READYSTATE_COMPLETE\nWend\nEnd With\n 'Wait some to time for loading the page\nWhile ie.Busy\n    DoEvents\nWend\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n\nie.document.getElementById(\"x-auto-317-input\").Click\n\n\n\nSet disp = ie.document.getElementById(\"x-auto-1048\").getElementsByTagName(\"div\")\n\n\nFor Each dis In disp\n    innnerr(i) = dis.innerText\n    If dis.innerText = \"Add Lead Disposition\" Then dis.fireevent \"onclick\"\n    i = i + 1: Exit For\nNext dis\n\n\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n\n\nie.Quit\nEnd Sub\n</code></pre>\n\n<p>What I need is to click on the second child which has the innertext \"Add Lead Disposition\". </p>\n\n<p>EDIT: With the answer I got below, the iteration is working fine however the <code>Click</code> event is not firing. I tried <code>.Focus</code> and <code>Onclick</code> with <code>FireEvent</code> without a solution. Any help is appreciated.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 1, "creation_date": 1513166409, "post_id": 47791587, "comment_id": 82545899, "body": "Doesn&#39;t this give the latest date in the past rather than the earliest date in the future?"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1513170454, "post_id": 47791587, "comment_id": 82548455, "body": "You&#39;re going to think I&#39;m awfully nit-picking, but the other part of the question was that OP wanted to match their &#39;primary key&#39; in table 1 with the one in table 2 so would need that to be in before I could upvote the answer."}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "reply_to_user": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1513173632, "post_id": 47791587, "comment_id": 82550541, "body": "@TomSharpe Not at all. I wanted to add it as a comment as it was a partial answer but figured it would be harder to read. It also looked like he knew what he was doing so I wanted to give him a step in the right direction. That said, ForwardEd&#39;s answer looks more appropriate if it works since it isn&#39;t a formula array."}], "tags": [], "owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "is_accepted": false, "score": 0, "last_activity_date": 1513166901, "last_edit_date": 1513166901, "creation_date": 1513163402, "answer_id": 47791587, "question_id": 47789985, "link": "https://stackoverflow.com/questions/47789985/index-and-match-vlookup-formula-to-look-for-nearest-future-date/47791587#47791587", "title": "INDEX and MATCH / VLOOKUP formula to look for nearest future date", "body": "<p>The equation <code>{=MIN(IF(F8:F11&gt;NOW(),F8:F10,402132))}</code>, where <code>F8:F11</code> is the range of Scheduled Dates will give the minimum date after and closest to the current date.</p>\n\n<p>Note: This is an array formula so you will need to press <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>.</p>\n\n<p>Then use VLookup or Index/Match as per usual.</p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 8256713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da5c5595467a75284612cd435cc0c699?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8256713/mark"}, "edited": false, "score": 0, "creation_date": 1513586348, "post_id": 47794349, "comment_id": 82694236, "body": "Wow! This really works. Thanks a lot! This would help me. Thank you!"}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": true, "score": 3, "last_activity_date": 1513172208, "creation_date": 1513172208, "answer_id": 47794349, "question_id": 47789985, "link": "https://stackoverflow.com/questions/47789985/index-and-match-vlookup-formula-to-look-for-nearest-future-date/47794349#47794349", "title": "INDEX and MATCH / VLOOKUP formula to look for nearest future date", "body": "<p>Use the following:</p>\n\n<pre><code>=AGGREGATE(15,6,$D$6:$D$25/((A6=$C$6:$C$25)*(TODAY()&lt;$D$6:$D$25)),1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qj4cP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qj4cP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Adjust your ranges as required.</p>\n\n<p>Aggregate performs array like operations.  As such avoid using full column references like C:C.  Also, Today is a volatile function.  As such it will recalculate anytime something on your spreadsheet changes.  That combined with the fact that its in an array operation means you will want to limit its usage.  If you notice your worksheet bogging down with calculations, either turn automatic calculations off for the sheet, or look at changing TODAY() to a cell reference where a date is entered.</p>\n"}], "owner": {"reputation": 69, "user_id": 8256713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da5c5595467a75284612cd435cc0c699?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8256713/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 1, "accepted_answer_id": 47794349, "answer_count": 2, "score": 0, "last_activity_date": 1513172208, "creation_date": 1513158663, "last_edit_date": 1531161705, "question_id": 47789985, "link": "https://stackoverflow.com/questions/47789985/index-and-match-vlookup-formula-to-look-for-nearest-future-date", "title": "INDEX and MATCH / VLOOKUP formula to look for nearest future date", "body": "<p>I need to have a formula to lookup the Primary Key on the other table and return the value of date. But with a twist, the return value should be the closest future date. Is there a formula for this? Thank you.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9KOVe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9KOVe.jpg\" alt=\"Sample Table Here\"></a></p>\n\n<p>The return value should be the closest future date in today's date instead of the first item that it will lookup.</p>\n\n<p>Hoping for your kind help. Thanks a lot.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 1, "creation_date": 1513158902, "post_id": 47789884, "comment_id": 82541138, "body": "I think this is just a feature of floating point numbers. You must set up some precision, let say to to milliseconds. Just search the web for &quot;comparing floating point numbers&quot;, there is number of articles about it."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1513159532, "post_id": 47789884, "comment_id": 82541531, "body": "Just simple information: <code>0.000000012</code> is 1 millisecond."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1513159703, "post_id": 47789884, "comment_id": 82541641, "body": "Both fields have the same data source, with minute-level information. There shouldn&#39;t be any milliseconds present, let alone a difference of a tiny fraction of a millisecond. But I guess type checking and specifying precision if I&#39;m comparing dates can&#39;t be avoided, then?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1594232640, "post_id": 47789884, "comment_id": 111057642, "body": "@ErikA: Fine to add the <code>[ms-access]</code> tag, and the <code>[vba]</code> tag is OK, but what&#39;s wrong with the <code>[access-vba]</code> tag? It is only <code>[excel-vba]</code> that for some reason has been labeled &quot;deprecated&quot;. I&#39;ve noticed that user braX and a python moderator driven by some divine force are having their time retagging hundreds of (old) questions, but I do count you as one who instantly can spot Access VBA. So I wonder, what&#39;s the benefit from this reduction in search options, please?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1594232991, "post_id": 47789884, "comment_id": 111057816, "body": "@Gustav The decision has been made, see <a href=\"https://meta.stackoverflow.com/a/399177/7296893\">this</a>. Apparently, all vba tags are to be removed, and access-vba is the only one left, solely based on the effort it would take to remove it. I&#39;ve decided that fighting this change is futile, so best to get it over with asap, and I&#39;ve started with my own questions, and the ones that are problematic for systematic retagging due to using an excessive amount of tags."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1594234095, "post_id": 47789884, "comment_id": 111058328, "body": "@ErikA: OK, I see. I&#39;ll take your word for it. I don&#39;t agree in this, indeed not in the total lack of communication from moderators, but my time is not for a lengthy discussion. Thanks for the link."}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1513161617, "post_id": 47790905, "comment_id": 82542930, "body": "Unfortunately, it&#39;s not that simple, since this function is being used to process multiple types of fields, so I guess I need to create a separate function to do the comparison and check the field type first. But thanks for the advice, since I can use DateDiff there."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1513161998, "post_id": 47790905, "comment_id": 82543172, "body": "Or, if you elsewhere compare Double, compare to an interval as suggested. The error is a <i>multifactor</i> below 1 ms."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1513161351, "creation_date": 1513161351, "answer_id": 47790905, "question_id": 47789884, "link": "https://stackoverflow.com/questions/47789884/time-comparison-in-vba-inequal-while-same-time/47790905#47790905", "title": "Time comparison in VBA: inequal while same time", "body": "<p>Use <em>DateDiff</em>. It is exactly for a purpose like this to ignore the floating point errors:</p>\n\n<pre><code>If DateDiff(\"s\", fld.Value, rs2.Fields(fld.NAME).Value) &lt;&gt; 0 Then GoTo ReturnFalse\n</code></pre>\n"}], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 47790905, "answer_count": 1, "score": 2, "last_activity_date": 1594215203, "creation_date": 1513158392, "last_edit_date": 1594215203, "question_id": 47789884, "link": "https://stackoverflow.com/questions/47789884/time-comparison-in-vba-inequal-while-same-time", "title": "Time comparison in VBA: inequal while same time", "body": "<p>I'm moving a database from Microsoft Access to SQL server, and am validating data equality between the remote and the local table. While doing so, I encountered an oddity when comparing a time field.</p>\n\n<p>I'm using the following function:</p>\n\n<pre><code>Public Function CheckAllFieldsEqual(rs1 As DAO.Recordset, rs2 As DAO.Recordset) As Boolean\n    Dim fld As DAO.Field\n    CheckAllFieldsEqual = True\n    For Each fld In rs1.Fields\n        If fld.Value &lt;&gt; rs2.Fields(fld.NAME).Value Then GoTo ReturnFalse\n    Next fld\n    Exit Function\nReturnFalse:\n    Debug.Print \"Fields inequal! \" &amp; fld.NAME &amp; \": \" &amp; fld.Value &amp; \" - \"; rs2.Fields(fld.NAME).Value\n    CheckAllFieldsEqual = False\n    MsgBox \"Inequal!\", vbCritical\n    Stop\nEnd Function\n</code></pre>\n\n<p><code>rs1</code> is the remote recordset, set to a random row. <code>rs2</code> is the local variant, set to a row with the same primary key. They should be identical, since I just created the remote table by moving the local table using <code>DoCmd.TransferDatabase</code></p>\n\n<p><code>Debug.Print fld.Value</code> returns 09:46:00. <code>Debug.Print rs2.Fields(fld.NAME).Value</code> also returns 09:46:00. However, the comparison doesn't pass.</p>\n\n<p>The odd part:</p>\n\n<p><code>Debug.Print CDbl(fld.Value)</code> returns 0.406944444444444</p>\n\n<p><code>Debug.Print CDbl(rs2.Fields(fld.NAME).Value)</code> returns 0.406944444444445</p>\n\n<p>How do I avoid these kinds of errors? Should I add type checking and check equality for time fields with a certain precision, or is there a more simple way to avoid this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9092965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e30aa76ffb4b2fde416b25804c48e7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rae", "link": "https://stackoverflow.com/users/9092965/rae"}, "edited": false, "score": 0, "creation_date": 1513160845, "post_id": 47789758, "comment_id": 82542406, "body": "Thank you, ill try it out now. I did suspect it having to with defining the variables."}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": true, "score": 0, "last_activity_date": 1513157924, "creation_date": 1513157924, "answer_id": 47789758, "question_id": 47789598, "link": "https://stackoverflow.com/questions/47789598/copy-worksheet-to-another-workbook-and-close-the-source-worksheet/47789758#47789758", "title": "Copy worksheet to another workbook and close the source worksheet", "body": "<p>In the Code Below i an Example how you can close the Workbook. Use a variable for the Workbook you are going to Open. After that you can close it without Saving it.</p>\n\n<pre><code>Dim wbLatestFile As Workbook\n\n'Open the latest file and copy Pivot Data Tab\nSet wbLatestFile = Workbooks.Open MyPath &amp; LatestFile\nwbLatestFile .Worksheets(\"Pivot Data\").Copy After:=CopiedData\n\nwbLatestFile.Close SaveChanges:=False\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9092965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e30aa76ffb4b2fde416b25804c48e7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rae", "link": "https://stackoverflow.com/users/9092965/rae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "accepted_answer_id": 47789758, "answer_count": 1, "score": 0, "last_activity_date": 1513157924, "creation_date": 1513157346, "last_edit_date": 1531164843, "question_id": 47789598, "link": "https://stackoverflow.com/questions/47789598/copy-worksheet-to-another-workbook-and-close-the-source-worksheet", "title": "Copy worksheet to another workbook and close the source worksheet", "body": "<p>I've found the below code which works nearly as id like to.\nHowever when i go to copy the <strong>pivot data worksheet</strong> and specifically paste it in the tab called <em>\"Data\"</em> in the <strong>Resource Costing...xls</strong> i cant seem to make it work. \nAlso once its copied how do i close the excel file that it was copied from? Any help, advice is much appreciated.</p>\n\n<pre><code>Sub OpenLatestResourceForecastFile()\n'Declare the variables\nDim MyPath As String\nDim MyFile As String\nDim LatestFile As String\nDim LatestDate As Date\nDim LMD As Date\nDim MyData As Workbook\nSet CopiedData = Workbooks(\"Resource Costing E3.xlsm\").Sheets(4)\nSet wb = ActiveWorkbook\n\n\n'Specify the path to the folder\nMyPath = \"C\\doc etc\"\n\n'Make sure that the path ends in a backslash\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n\n'Get the first Excel file from the folder\nMyFile = Dir(MyPath &amp; \"*.xls\", vbNormal)\n\n'If no files were found, exit the sub\nIf Len(MyFile) = 0 Then\n    MsgBox \"No files were found...\", vbExclamation\n    Exit Sub\nEnd If\n\n'Loop through each Excel file in the folder\nDo While Len(MyFile) &gt; 0\n\n    'Assign the date/time of the current file to a variable\n    LMD = FileDateTime(MyPath &amp; MyFile)\n\n    'If the date/time of the current file is greater than the latest\n    'recorded date, assign its filename and date/time to variables\n    If LMD &gt; LatestDate Then\n        LatestFile = MyFile\n        LatestDate = LMD\n    End If\n\n    'Get the next Excel file from the folder\n    MyFile = Dir\n\nLoop\n\n'Open the latest file and copy Pivot Data Tab\nWorkbooks.Open MyPath &amp; LatestFile\nWorksheets(\"Pivot Data\").Copy After:=CopiedData\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8199875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bc05f77f442bf3fb59d3b01c71e00f7?s=128&d=identicon&r=PG&f=1", "display_name": "suga", "link": "https://stackoverflow.com/users/8199875/suga"}, "edited": false, "score": 0, "creation_date": 1513158842, "post_id": 47789856, "comment_id": 82541097, "body": "how can i use this function for each cell of each row? consider I am having  set of 6 rows and 5 columns. how will i call this function?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 33, "user_id": 8199875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bc05f77f442bf3fb59d3b01c71e00f7?s=128&d=identicon&r=PG&f=1", "display_name": "suga", "link": "https://stackoverflow.com/users/8199875/suga"}, "edited": false, "score": 0, "creation_date": 1513159020, "post_id": 47789856, "comment_id": 82541212, "body": "Loop through each cell and pass the cell value to the function. <code>c.Value =  TrimText(c.Value)</code>"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1513158260, "creation_date": 1513158260, "answer_id": 47789856, "question_id": 47789515, "link": "https://stackoverflow.com/questions/47789515/adding-triple-dot-in-userform-if-text-is-too-long-in-vba-excel/47789856#47789856", "title": "adding triple dot in userform if text is too long in vba excel", "body": "<p>A simple function should do, unless you want to return full words.</p>\n\n<pre><code>Public Function TrimText(Value As String)\n    TrimText = IIf(Len(Value) &gt; 10, Left(Value, 10) &amp; \"...\", Value)\nEnd Function\n</code></pre>\n\n<p>To call it:</p>\n\n<pre><code>TrimText(\"abcdefghijklmnopq\")\n'abcdefghij...\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8199875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bc05f77f442bf3fb59d3b01c71e00f7?s=128&d=identicon&r=PG&f=1", "display_name": "suga", "link": "https://stackoverflow.com/users/8199875/suga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513158260, "creation_date": 1513157071, "question_id": 47789515, "link": "https://stackoverflow.com/questions/47789515/adding-triple-dot-in-userform-if-text-is-too-long-in-vba-excel", "title": "adding triple dot in userform if text is too long in vba excel", "body": "<p>adding triple dot in userform label description if text is too long in vba excel </p>\n\n<p>For example I am having 5 labels in userform as id, name, phone no, address and email id, if the text size of each cell of the student details exceed 10 letters then it need to show 3 dots at the last.\n    name:    abcdefghij...\n    adress:  abc street, def colony...</p>\n\n<p>Help me to create code in vba userform excel</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "edited": false, "score": 0, "creation_date": 1513164848, "post_id": 47789426, "comment_id": 82545042, "body": "Hello and welcome to StackOverflow, could you please clarify what you mean when saying &quot;category is in category&quot; ?"}, {"owner": {"reputation": 119, "user_id": 8279226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5af665ec67061510379d194829483710?s=128&d=identicon&r=PG&f=1", "display_name": "\ubc15\uc601\uc885", "link": "https://stackoverflow.com/users/8279226/%eb%b0%95%ec%98%81%ec%a2%85"}, "reply_to_user": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "edited": false, "score": 1, "creation_date": 1513184038, "post_id": 47789426, "comment_id": 82557658, "body": "outlook&#39;s category can have category under itself. I meant that."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 4, "last_activity_date": 1513184400, "creation_date": 1513184400, "answer_id": 47798526, "question_id": 47789426, "link": "https://stackoverflow.com/questions/47789426/how-can-i-assign-category-of-sent-mail-in-outlook-vba/47798526#47798526", "title": "How can I assign category of sent mail in outlook vba?", "body": "<p>Categories in Outlook is a flat list, a category cannot be a child (or a parent) of another category. That being said, you can assign multiple categories to any item - just separate them with \";\"</p>\n\n<pre><code>.Categories = \"Test;Report;Some Other Category\"\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8279226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5af665ec67061510379d194829483710?s=128&d=identicon&r=PG&f=1", "display_name": "\ubc15\uc601\uc885", "link": "https://stackoverflow.com/users/8279226/%eb%b0%95%ec%98%81%ec%a2%85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4735, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1513184400, "creation_date": 1513156761, "last_edit_date": 1513169078, "question_id": 47789426, "link": "https://stackoverflow.com/questions/47789426/how-can-i-assign-category-of-sent-mail-in-outlook-vba", "title": "How can I assign category of sent mail in outlook vba?", "body": "<p>I followed the below example: </p>\n\n<p><a href=\"https://www.slipstick.com/developer/create-a-new-message-using-vba/\" rel=\"nofollow noreferrer\">https://www.slipstick.com/developer/create-a-new-message-using-vba/</a></p>\n\n<p>I want to categorize mail automatically when I send an email by macro.\nbut, sometimes category is in category.</p>\n\n<p>For example, suppose, \"Report\" Category is under \"Company\" Category.</p>\n\n<p>How can i assign my sent mail to \"Report\" Category in \"Company\" Category?\nHere is my code. it is almost same with the example code.</p>\n\n<pre><code>Public Sub CreateNewMessage()\nDim objMsg As MailItem\n\nSet objMsg = Application.CreateItem(olMailItem)\n\nWith objMsg\n  .To = \"Alias@domain.com\"\n  .CC= \"Alias2@domain.com\"\n  .BCC = \"Alias3@domain.com\"\n  .Subject = \"This is the subject\"\n  .Categories = \"Test\"\n  .VotingOptions = \"Yes;No;Maybe;\"\n  .BodyFormat = olFormatPlain ' send plain text message\n  .Importance = olImportanceHigh\n  .Sensitivity = olConfidential\n  .Attachments.Add (\"path-to-file.docx\")\n\n ' Calculate a date using DateAdd or enter an explicit date\n  .ExpiryTime = DateAdd(\"m\", 6, Now) '6 months from now\n  .DeferredDeliveryTime = #8/1/2012 6:00:00 PM#\n\n  .Display\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 3, "creation_date": 1513154229, "post_id": 47788559, "comment_id": 82538286, "body": "Put values into array, loop through it <code>For i = 1 to UBound(vArray,1) Step 2 : Next i</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513154349, "post_id": 47788559, "comment_id": 82538357, "body": "Can they only appear twice?"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513155687, "post_id": 47788559, "comment_id": 82539171, "body": "@QHarr yes. only twice."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513155735, "post_id": 47788559, "comment_id": 82539196, "body": "Then AntiDrondert&#39;s suggestion is a good idea."}], "answers": [{"comments": [{"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1513172373, "post_id": 47788889, "comment_id": 82549730, "body": "I prefer <code>For x = 1 To MLRow Step 2</code> instead of messing with the counter within the loop, but both ways work."}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": true, "score": 2, "last_activity_date": 1513155020, "creation_date": 1513155020, "answer_id": 47788889, "question_id": 47788559, "link": "https://stackoverflow.com/questions/47788559/excel-vba-how-to-loop-through-a-dataset-and-skip-every-other-row/47788889#47788889", "title": "Excel VBA How to Loop Through a Dataset and Skip Every Other Row?", "body": "<p>I dont know, if this is what you want and the data is exactly as you have shown.</p>\n\n<pre><code>With MainSheet\n     MLRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n     Set emp = .Range(\"A1:A\" &amp; MLRow)\n    .Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n    .Range(\"A1:M\" &amp; MLRow).Sort key1:=Range(\"A2:A\" &amp; MLRow), order1:=xlAscending, Header:=xlNo\nEnd With\n'Loop the cells and skip 1\nFor x = 1 To MLRow\n     'Your Code\nx = x + 1\nNext x\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2723, "favorite_count": 0, "accepted_answer_id": 47788889, "answer_count": 1, "score": 0, "last_activity_date": 1513155020, "creation_date": 1513153774, "question_id": 47788559, "link": "https://stackoverflow.com/questions/47788559/excel-vba-how-to-loop-through-a-dataset-and-skip-every-other-row", "title": "Excel VBA How to Loop Through a Dataset and Skip Every Other Row?", "body": "<p>I have in Excel worksheet in column A a list of employee Numbers. Each number shows up twice in the list with same name but different company. I want to loop each number in the list and compare it to another list to check in which comapny the employee works now.</p>\n\n<p>for example:</p>\n\n<pre><code>112 Rafael ABC\n112 Rafael NBS\n223 Jose ACM\n223 Jose NBS\n345 Dave ACM\n345 Dave NBS\n</code></pre>\n\n<p>I want to check Rafael's Number once and then Jose's and the Dave's. I need help with the loop itself - how to skip a row every time.</p>\n\n<pre><code>Sub RemoveDuplicats()\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlManual\n\nDim MainWB As Workbook\nDim MainSheet As Worksheet\nDim MLRow As Long\nDim WS As Worksheet\nDim emp As Range\n\nSet MainWB = ThisWorkbook\nSet MainSheet = MainWB.Worksheets(\"Main\")\n\n'Here is not relevant code\n.\n.\n.\nWith MainSheet\n     MLRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n     Set emp = .Range(\"A1:A\" &amp; MLRow)\n    .Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n    .Range(\"A1:M\" &amp; MLRow).Sort key1:=Range(\"A2:A\" &amp; MLRow), order1:=xlAscending, Header:=xlNo\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\nApplication.DisplayStatusBar = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 2, "creation_date": 1513153983, "post_id": 47788550, "comment_id": 82538148, "body": "It should be <code>MsgBox &quot;mastnamenew value = &quot; &amp; MastNameNew</code>."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1513154501, "post_id": 47788550, "comment_id": 82538455, "body": "<code>MastNameNew</code> is Boolean variable, not an object, it doesn&#39;t have properties such as <code>.Value</code>."}], "answers": [{"tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1513155943, "creation_date": 1513155943, "answer_id": 47789171, "question_id": 47788550, "link": "https://stackoverflow.com/questions/47788550/displaying-boolean-value-invalid-qualifier/47789171#47789171", "title": "displaying boolean value / invalid qualifier", "body": "<p>To your error : <code>MastNameNew</code> is a Boolean variable with only possible value as <code>\"False (0)\"</code> or <code>\"True (1)\"</code>. So there are no properties available for a <code>Boolean</code>.\nPlease find the below code\nIf you want answer as \"False\" or True Then use below code:</p>\n\n<pre><code>Sub UsingBooleans()\nDim MastNameNew As Boolean\nMsgBox \"mastnamenew value = \" &amp; MastNameNew\nEnd Sub\n</code></pre>\n\n<p>And if you want the answer as \"0\" or \"1\" then use the below code:</p>\n\n<pre><code>Sub UsingBooleans()\nDim MastNameNew As Boolean\nMsgBox \"mastnamenew value = \" &amp; CInt(MastNameNew)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9053670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb57affd5174523d767b8a294b506ab?s=128&d=identicon&r=PG&f=1", "display_name": "Joe90", "link": "https://stackoverflow.com/users/9053670/joe90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "closed_date": 1513163065, "answer_count": 1, "score": 0, "last_activity_date": 1513155943, "creation_date": 1513153707, "last_edit_date": 1531164843, "question_id": 47788550, "link": "https://stackoverflow.com/questions/47788550/displaying-boolean-value-invalid-qualifier", "closed_reason": "Duplicate", "title": "displaying boolean value / invalid qualifier", "body": "<p>Maybe because it's been a long day......<br>\nI don't get it.<br>\nWhy does this code give me an 'invalid qualifier' msg?</p>\n\n<pre><code>Sub UsingBooleans()\nDim MastNameNew As Boolean\nMsgBox \"mastnamenew value = \" &amp; MastNameNew.Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513167633, "post_id": 47788144, "comment_id": 82546643, "body": "Seeing the layout of Admin upload might help so as to have an idea of what copies all the data offset 8 columns to the right from &quot;Admin Upload (Sessions)&quot;  means in reality."}, {"owner": {"reputation": 1, "user_id": 9092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac50e8f352f2985f0faace9c51ffc5?s=128&d=identicon&r=PG&f=1", "display_name": "Gawddofwar", "link": "https://stackoverflow.com/users/9092598/gawddofwar"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513251650, "post_id": 47788144, "comment_id": 82586156, "body": "@Qharr definitely, thank you for replying, I will attach it once I am at work tomorrow."}], "owner": {"reputation": 1, "user_id": 9092598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac50e8f352f2985f0faace9c51ffc5?s=128&d=identicon&r=PG&f=1", "display_name": "Gawddofwar", "link": "https://stackoverflow.com/users/9092598/gawddofwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513327339, "creation_date": 1513152103, "last_edit_date": 1513327339, "question_id": 47788144, "link": "https://stackoverflow.com/questions/47788144/vba-if-column-is-empty-then-offset-searchlist", "title": "VBA if column is Empty then offset (searchlist)", "body": "<p>I have this code which matches data from <code>\"Client Experience\"</code> against <code>\"Admin Upload (Sessions)\"</code>, if looks up the list of names in Column B and match against <code>\"Admin Upload (Sessions)\"</code>. </p>\n\n<p>Once a match is found it copies all the data offset 8 columns to the right from <code>\"Admin Upload (Sessions)\"</code> and paste it into <code>\"Client Experience\"</code> column P onwards with a column spacing of 4 for the next result (if there are more than 1 results).</p>\n\n<p>However the issue is <code>\"Admin Upload (Sessions)\"</code> is a sheet where all admin paste their data and clear it once an upload is done. So every time a new upload is done it will replace all the data in column P in <code>\"Client Experience\"</code> and replace it with the new data.</p>\n\n<p>Could someone please help me with code that searches for the next available column if the current column is filled in <code>\"Client Experience\"</code>.</p>\n\n<p>So as the code runs, for the value in <code>\"B3\"</code> in <code>\"Client Experience\"</code>, it sees that Column P is filled, so it searches for the next column (offset 4) and lands in column T, now that column is filled too, so it searches for the next column again and lands in column X, now column X is empty so it pastes all the data from <code>\"Admin Upload (Sessions)\"</code> in column X &amp; AB (assuming there are 2 return value).</p>\n\n<p>So the code goes to the next rcell which is the value in <code>\"B4\"</code> in <code>\"Client Experience</code>\", it sees that Column P is filled, so it searches the next column and lands in column T, now the column is empty, so it paste all the data.</p>\n\n<p>The code continue running till the end of the range which is <code>\"B202\"</code> following this criteria.</p>\n\n<p>I have entered the code and attached pictures of <code>\"Client experience\"</code> and <code>\"Admin Upload (Sessions)\"</code> for better understanding. </p>\n\n<pre><code>Sub test4()\n\n    Dim searchlist As Range\n    Dim rcell As Range, sValue As String\n    Dim dRange As Range, sCell As Range\n\n    'Values you wish to search data on\n    Set searchlist = Sheets(\"Client Experience\").Range(\"B3:B202\")\n    'Data Range to search\n    Set dRange = Sheets(\"Admin Upload (Sessions)\").Range(\"A3:A102\")\n\n    For Each rcell In searchlist\n\n        lcol = 14\n\n        For Each sCell In dRange\n\n             If InStr(1, sCell.Value, rcell.Value) And Trim(rcell.Value) &lt;&gt; \"\" Then\n\n                 rcell.Offset(0, lcol).Value = sCell.Offset(0, 8).Value\n                 lcol = lcol + 4\n\n             End If\n\n        Next\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Admin Upload (Sessions)</p>\n\n<p><a href=\"https://i.stack.imgur.com/uyR8b.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uyR8b.jpg\" alt=\"&quot;Admin Upload (Sessions)&quot;\"></a></p>\n\n<p>Client Experience</p>\n\n<p><a href=\"https://i.stack.imgur.com/rvVoN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rvVoN.png\" alt=\"Client Experience\"></a></p>\n"}, {"tags": ["excel", "web-scraping", "runtime-error", "vba"], "comments": [{"owner": {"reputation": 153, "user_id": 8862091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82bdb64f1a5b60cb183f101d2aea269?s=128&d=identicon&r=PG&f=1", "display_name": "DaDirnbocher", "link": "https://stackoverflow.com/users/8862091/dadirnbocher"}, "edited": false, "score": 1, "creation_date": 1513160048, "post_id": 47788119, "comment_id": 82541861, "body": "Maybe it is useful to do some error handling. Suppose the loading of the website is ready, which means appIE is no more busy, but the Website isn&#39;t loaded completely (e.g. due some error in the internet connection.)  In this case there could be a valid appIE.document but possibly there is no element with ID &quot;pair_8907&quot; in that moment, therefore .Cells(7).innerHTML could throw an error.  So to be safe all the time you should check every single scraping - is there a valid document after the do while? - has the document an element with the given id? - has this element 8 cells?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8243130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40c9e4eba91be7987f3391c9e9174c02?s=128&d=identicon&r=PG&f=1", "display_name": "RookieNoMore", "link": "https://stackoverflow.com/users/8243130/rookienomore"}, "edited": false, "score": 0, "creation_date": 1513585286, "post_id": 47793575, "comment_id": 82693781, "body": "Thanks for the hints. I tried out Application.Wait, which is a similar function to Sleep and seems to have solved the problem."}], "tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1513594288, "last_edit_date": 1513594288, "creation_date": 1513169733, "answer_id": 47793575, "question_id": 47788119, "link": "https://stackoverflow.com/questions/47788119/runtime-error-91-with-vba-web-scraping-from-time-to-time/47793575#47793575", "title": "Runtime error 91 with VBA web scraping FROM TIME TO TIME", "body": "<p>I think you are not giving enough time for ie to load...\nSo there is this function WaitIE to wait for the page to load, it is set to 5000 ms, if the error continue, you can give more time.</p>\n\n<pre><code>#If VBA7 Then  \n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr) 'For 64 Bit Systems  \n#Else  \n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds as Long) 'For 32 Bit Systems  \n#End If \n\nSub WebScraping()\n\nDim appIE As Object\nDim myValue As String\nDim iLastRow As Integer\nDim allRowOfData\n\nApplication.DisplayAlerts = False\n\nSet appIE = CreateObject(\"internetexplorer.application\")\n\nWith appIE\n    .Navigate \"http://uk.investing.com/rates-bonds/financial-futures\"\n    .Visible = False\nEnd With\n\n   WaitIE appIE, 5000\n\n'Set allRowOfData = appIE.document.getElementById(\"pair_8907\")\n\nWorksheets(\"Web Scraping\").Activate\n\n'myValue = allRowOfData.Cells(7).innerHTML\nmyValue = appIE.document.getElementById(\"pair_8907\").Cells(7).innerHTML\n\niLastRow = ActiveSheet.Range(\"B100000\").End(xlUp).Row\nActiveSheet.Cells(iLastRow, 1).Select\n\nIf iLastRow = 1 Then\n    ActiveCell.Offset(1, 0).Value = \"US 30Y T-Bond\"\n    ActiveCell.Offset(1, 1).Value = myValue\n    ActiveCell.Offset(1, 2).Value = Now()\n    ActiveCell.Offset(1, 2).Select\nElseIf iLastRow &gt; 1 Then\n    ActiveCell.Copy Destination:=Cells(ActiveCell.Row + 1, 1)\n    ActiveCell.Offset(1, 1).Value = myValue\n    ActiveCell.Offset(1, 2).Value = Now()\n    ActiveCell.Offset(1, 2).Select\nEnd If\n\nappIE.Quit\nSet appIE = Nothing\nSet allRowOfData = Nothing\n\nEnd Sub\n\nSub WaitIE(IE As Object, Optional time As Long = 250)\n'Code from: https://stackoverflow.com/questions/33808000/run-time-error-91-object-variable-or-with-block-variable-not-set\nDim i As Long\nDo\n    Sleep time\n    Debug.Print CStr(i) &amp; vbTab &amp; \"Ready: \" &amp; CStr(IE.READYSTATE = 4) &amp; _\n                vbCrLf &amp; vbTab &amp; \"Busy: \" &amp; CStr(IE.Busy)\n    i = i + 1\nLoop Until IE.READYSTATE = 4 Or Not IE.Busy\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8243130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40c9e4eba91be7987f3391c9e9174c02?s=128&d=identicon&r=PG&f=1", "display_name": "RookieNoMore", "link": "https://stackoverflow.com/users/8243130/rookienomore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513594288, "creation_date": 1513151974, "last_edit_date": 1531164843, "question_id": 47788119, "link": "https://stackoverflow.com/questions/47788119/runtime-error-91-with-vba-web-scraping-from-time-to-time", "title": "Runtime error 91 with VBA web scraping FROM TIME TO TIME", "body": "<p>I came across <a href=\"https://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\">this post</a>. I tried out the solution suggested by the accepted answer and came up with the following code. </p>\n\n<pre><code>Sub WebScraping()\n\nDim appIE As Object\nDim myValue As String\nDim iLastRow As Integer\nDim allRowOfData\n\nApplication.DisplayAlerts = False\n\nSet appIE = CreateObject(\"internetexplorer.application\")\n\nWith appIE\n    .Navigate \"http://uk.investing.com/rates-bonds/financial-futures\"\n    .Visible = False\nEnd With\n\nDo While appIE.Busy\n    DoEvents\nLoop\n\n'Set allRowOfData = appIE.document.getElementById(\"pair_8907\")\n\nWorksheets(\"Web Scraping\").Activate\n\n'myValue = allRowOfData.Cells(7).innerHTML\nmyValue = appIE.document.getElementById(\"pair_8907\").Cells(7).innerHTML\n\niLastRow = ActiveSheet.Range(\"B100000\").End(xlUp).Row\nActiveSheet.Cells(iLastRow, 1).Select\n\nIf iLastRow = 1 Then\n    ActiveCell.Offset(1, 0).Value = \"US 30Y T-Bond\"\n    ActiveCell.Offset(1, 1).Value = myValue\n    ActiveCell.Offset(1, 2).Value = Now()\n    ActiveCell.Offset(1, 2).Select\nElseIf iLastRow &gt; 1 Then\n    ActiveCell.Copy Destination:=Cells(ActiveCell.Row + 1, 1)\n    ActiveCell.Offset(1, 1).Value = myValue\n    ActiveCell.Offset(1, 2).Value = Now()\n    ActiveCell.Offset(1, 2).Select\nEnd If\n\nappIE.Quit\nSet appIE = Nothing\nSet allRowOfData = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>My script runs smoothly 9 out of 10 times but sometimes it throws an error:\n<a href=\"https://i.stack.imgur.com/iddey.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iddey.png\" alt=\"error message\"></a></p>\n\n<p>When that happens the VBE debugger shows that the command stops at</p>\n\n<pre><code>myValue = appIE.document.getElementById(\"pair_8907\").Cells(7).innerHTML\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "advanced-filter"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1513151112, "post_id": 47787871, "comment_id": 82536696, "body": "Try the database functions DCOPY() etc"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1513158184, "post_id": 47787871, "comment_id": 82540680, "body": "@SolarMike Just for my interest, can you provide more information about <code>DCOPY()</code> I couldn&#39;t find a database function in the <a href=\"https://support.office.com/en-us/article/Database-functions-reference-ad87e69b-fc20-4d3d-9d52-d7dc023f5c23\" rel=\"nofollow noreferrer\">references</a> named <code>DCOPY()</code>."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1513159265, "post_id": 47787871, "comment_id": 82541363, "body": "Sorry DCOUNT() etc - excel can extract reports using the data as a database ie a restricted version of Access..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1513159997, "post_id": 47787871, "comment_id": 82541817, "body": "@SolarMike To get the result of Sheet3 what the OP wants, he needs to filter Sheet1 by the names of Sheet2. How would you do this with any of these database functions? I see barely a chance to achieve this without using filters, but you might proof me wrong."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1513160581, "post_id": 47787871, "comment_id": 82542230, "body": "I used those functions to extract relevant claims,sorry concerns, from warranty data (the text written by mechanics) searching for specific text terms or references... used macros when it was before vba and it would take over 12 hours to run - but that was when it was excel 3 or 4 and computer processors were 60MegaHertz not gigahertz. It was a suggestion or comment : not going to prove it is possible as I know I did achieve it... and I probably have a backup of the macros somewhere..."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1513160822, "last_edit_date": 1592644375, "creation_date": 1513160431, "answer_id": 47790568, "question_id": 47787871, "link": "https://stackoverflow.com/questions/47787871/lookup-for-values-and-return-all-matching-rows/47790568#47790568", "title": "Lookup for values and return all matching rows", "body": "<h3>What you try is actually filter sheet1 by the names of sheet2</h3>\n<p>Make use of <em><a href=\"https://support.microsoft.com/de-de/help/2720580/using-advanced-filters-in-excel-2010\" rel=\"nofollow noreferrer\">Advanced Filters</a></em> to achieve the result of sheet3.<br />\nBut the restrictions are \u2026</p>\n<ul>\n<li>it has to be done in the same sheet (Excel restricts it)<br />\nso you need to copy the result to sheet3 after filtering it.</li>\n<li>you need to sort it by name before or after</li>\n</ul>\n<p>The following image describes what parameters I used for advanced filter.<br />\n(Sorry for the german screenshot, I think you will figure it out.)</p>\n<p><a href=\"https://i.stack.imgur.com/zeIKZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zeIKZ.png\" alt=\"enter image description here\" /></a></p>\n<p>Note that you don't necessarily copy the result to another location, but can do a reversible filtering just in place of the original data. Which one to use depends on what you are going to do with that data later.</p>\n<p>Also note, that the headlines (like 'Name') of the criteria range have to match the list range. The advanced filter uses them to find the column to filter on.</p>\n"}], "owner": {"reputation": 11, "user_id": 8059614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb66a904a88551fe7faad2d97b364a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Anijan", "link": "https://stackoverflow.com/users/8059614/anijan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513160822, "creation_date": 1513151022, "last_edit_date": 1513160695, "question_id": 47787871, "link": "https://stackoverflow.com/questions/47787871/lookup-for-values-and-return-all-matching-rows", "title": "Lookup for values and return all matching rows", "body": "<p>Is there a way to look up for values(sheet2) in  sheet1 and copy all the matching rows to a new sheet (sheet3)? </p>\n\n<pre><code>Sheet1\nName    Hours   Group\nJoy     12  AA\nAllen   23  AA\nTom 34  AA\nAmy 45  AX\nChris   6   AD\nAllen   7   FG\nTom 8   GH\nJoy     8   JK\nAmy 23  UY\nJack    11  AA\n\n\nSheet 2 (col A):\nJoy\nAllen\nAmy\nChris\n\nSheet 3 (expected o/p)\nJoy     12  AA\nJoy     8   JK\nAllen   23  AA\nAllen   7   FG\nAmy 45  AX\nAmy 23  UY\nChris   6   AD\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1513148363, "post_id": 47787031, "comment_id": 82535486, "body": "Any reason for not using native function?"}, {"owner": {"reputation": 145, "user_id": 8293266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1c85ad790c4239e3b253b8e54613532?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8293266/vincent"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1513148655, "post_id": 47787031, "comment_id": 82535611, "body": "@shrivallabha.redij yes there is, for simplification. the formula will be shorter and i can select the range one time and avoiding ctrl+alt+enter key and errors."}], "answers": [{"tags": [], "owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "is_accepted": false, "score": -1, "last_activity_date": 1513149628, "last_edit_date": 1513149628, "creation_date": 1513149113, "answer_id": 47787424, "question_id": 47787031, "link": "https://stackoverflow.com/questions/47787031/convert-excel-formula-to-vba-using-function/47787424#47787424", "title": "Convert excel formula to VBA using function", "body": "<pre><code>Function ClosestLessThan(searchNumber As Double, rangeOfValues As Range) As Double\n\nDim min As Double\n\nmin = -1\n\n\nFor Each cell In rangeOfValues\n\n   If cell.value &lt; searchNumber And cell.value &gt; min Then\n     min = cell.value\n   End If\n  ' Debug.Print cell.value\n\nNext cell\n\nClosestLessThan = min\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1513149477, "creation_date": 1513149477, "answer_id": 47787510, "question_id": 47787031, "link": "https://stackoverflow.com/questions/47787031/convert-excel-formula-to-vba-using-function/47787510#47787510", "title": "Convert excel formula to VBA using function", "body": "<p>Here's how I'd go about it.</p>\n\n<pre><code>Function ClosestLessThan(dblRefVal As Double, rangeOfValues As Range) As Double\nDim rng As Range\nFor Each rng In rangeOfValues\n    If rng.Value &lt; dblRefVal And rng.Value &gt; ClosestLessThan Then ClosestLessThan = rng.Value\nNext\nEnd Function\n</code></pre>\n\n<p>The reason why your function is not working is because it is trying to compare complete range in one go and then use MAX function.</p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1513149778, "creation_date": 1513149778, "answer_id": 47787573, "question_id": 47787031, "link": "https://stackoverflow.com/questions/47787031/convert-excel-formula-to-vba-using-function/47787573#47787573", "title": "Convert excel formula to VBA using function", "body": "<p>One of your biggest issues is with this line:</p>\n\n<pre><code>If rangeOfValues &lt; searchNumber Then\n</code></pre>\n\n<p>While the default for a <code>Range</code> object is <code>.Value</code>, VBA cannot interpret a <code>.Value</code> for a multi-cell <code>Range</code> object.</p>\n\n<p>Another issue is the way you call it. In <code>=ClosestLessThan(F10,$DB$2:$DI$2)</code> <code>F10</code> is a cell reference (Range object), yet you assign that argument to a <code>double</code> data type.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>Function ClosestLessThan(searchNumber As Range, rangeOfValues As Range) As Double\n\nDim rng As Range\n\nFor each rng in rangeOfValues\n     If rng &lt; searchNumber.Value Then\n         Dim rngSearch as Range\n         If rngSearch is Nothing Then\n            Set rngSearch = rng\n         Else\n            Set rngSearch = Union(rng, rngSearch)\n         End If\n     End If\nNext\n\nClosestLessThan = Application.WorksheetFunction.Max(rngSearch)\n\nEnd Function\n</code></pre>\n\n<p>And call as you do: <code>=ClosestLessThan(F10,$DB$2:$DI$2)</code></p>\n"}], "owner": {"reputation": 145, "user_id": 8293266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1c85ad790c4239e3b253b8e54613532?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8293266/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 47787573, "answer_count": 3, "score": 2, "last_activity_date": 1513149778, "creation_date": 1513147341, "last_edit_date": 1531161705, "question_id": 47787031, "link": "https://stackoverflow.com/questions/47787031/convert-excel-formula-to-vba-using-function", "title": "Convert excel formula to VBA using function", "body": "<p>I have a FormulaArray in excel which is </p>\n\n<pre><code>{=MAX(IF($DB$2:$DI$2&lt;F10,$DB$2:$DI$2))}\n</code></pre>\n\n<p>and it worked perfectly. \"F10\" is equal 55, \"then $DB$2:$DI$2\" is a range of values between 41-102. Then i created a vba function and apply it in excel as a formula</p>\n\n<pre><code>=ClosestLessThan(F10,$DB$2:$DI$2)\n</code></pre>\n\n<p>but the result is #VALUE!\", i cant figure out the right way. Here is what i have tried.</p>\n\n<pre><code>Function ClosestLessThan(searchNumber As Double, rangeOfValues As Range) As Double\n\nDim rng As Range\n\nIf rangeOfValues &lt; searchNumber Then\nSet rng = rangeOfValues\nEnd If\n\nClosestLessThan = Application.WorksheetFunction.Max(rng)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "word-2010"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1513147470, "post_id": 47787016, "comment_id": 82535093, "body": "Could you click on <code>Show paragraph marks</code> in MS Word app and next paste your images again showing the real structure of document (with all hidden marks)? Just for better understanding..."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1513147970, "post_id": 47787016, "comment_id": 82535299, "body": "@TimWilliams - that did it! I&#39;m going kind of crazy because I thought I already changed the <code>-1</code> to <code>-2</code>. Quick (hopefully) follow-up question? Is there a way to use that end-of-cell character in <code>Convert-To-Text</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513148276, "post_id": 47787016, "comment_id": 82535448, "body": "Well I&#39;m glad it worked but you may notice I&#39;d deleted my comment in the meantime, since I was having second thoughts...   Are you sure there wasn&#39;t some other character lurking at the end of your cell text, just before the end of cell marker?  <b>EDIT</b> OK it is two characters it seems: <a href=\"http://www.tech-archive.net/Archive/Word/microsoft.public.word.vba.general/2005-10/msg00121.html\" rel=\"nofollow noreferrer\">tech-archive.net/Archive/Word/microsoft.public.word.vba.gene&zwnj;&#8203;ral/&hellip;</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1513148566, "post_id": 47787016, "comment_id": 82535568, "body": "Thanks again @TimWilliams"}], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 831, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1513191240, "creation_date": 1513147285, "last_edit_date": 1513191240, "question_id": 47787016, "link": "https://stackoverflow.com/questions/47787016/vbtab-chr9-writing-new-line-in-word-vba", "title": "vbTab \\ Chr(9) Writing New Line in Word VBA", "body": "<p>I am attempting to convert Word tables into paragraph text via VBA. I know about <code>Convert to Text</code> option for tables, but this is not working as my Word files are converted PDF files that have images which eventually will get processed through Python script. The tables have no reliable and consistent use of tab, para, or anything else when converted.</p>\n\n<p>My code follows:</p>\n\n<pre><code>Option Explicit\n\nSub ReWriteTableData()\n\n    Dim tb As Table\n\n    For Each tb In ThisDocument.Tables\n\n        tb.Select\n\n        With Selection\n\n            Dim rw As row, cl As Column\n            Dim i As Integer\n\n            .MoveUp Unit:=wdLine, Count:=1\n\n            For Each rw In tb.Rows\n\n                .EndKey Unit:=wdLine\n                .TypeParagraph\n\n                For i = 1 To tb.Columns.Count\n\n                    Dim myText As String, myString As String\n                    myString = rw.Cells(i).Range.Text\n                    myString = Mid(myString, 1, Len(myString) - 1)\n\n                    .TypeText Text:=myString &amp; Chr(9)\n\n                Next\n\n            Next\n\n        End With\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>The place where I am stuck is <code>.TypeText Text:=myString &amp; Chr(9)</code>. </p>\n\n<p>When that prints the text to the line above the table it places the 2nd - nth column on a new line, like this:</p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/YDMOW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YDMOW.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>What I want is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SR8fm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SR8fm.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know pictures are slightly incomplete, but the loop isn't my issue, it's getting them all on one line. Also, I am sure my code is not the most efficient, so am happy to have any refactor to make it faster, easier, better to maintain.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1513147885, "post_id": 47786964, "comment_id": 82535266, "body": "Wouldn t have thought about that thanks!  I have Range.Copy still would give me the same issue though, as I want to copy from the non active Sheet and my 1600 and 300 are actually variable (I cannot just write &quot;A1:CZ1600&quot;)"}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 2, "last_activity_date": 1513147097, "creation_date": 1513147097, "answer_id": 47786964, "question_id": 47786909, "link": "https://stackoverflow.com/questions/47786909/excel-vba-run-time-error-1004-calling-workbooks/47786964#47786964", "title": "Excel VBA: Run-Time error 1004 calling Workbooks", "body": "<p>When you are using <code>Range object</code> reference of that type: <code>Range(LeftTopCell, RightBottomCell)</code> you have to care of what is in fact inside parenthesis.</p>\n\n<p>In your situation you have always <code>Activesheet cells</code> which is not what you want to have. Therefore you have to have full reference to cells in this way:</p>\n\n<pre><code>mainWB.Sheets(1).Range(mainWB.Sheets(1).Cells(1, 1), _\n                       mainWB.Sheets(1).Cells(1600, 300)).Value = \n        Workbooks(WBname).Sheets(1).Range(Workbooks(WBname).Sheets(1).Cells(1, 1), _ \n                                     Workbooks(WBname).Sheets(1).Cells(1600, 300)).Value\n</code></pre>\n\n<p>To make it shorter you could think of using <code>Range.Copy</code> method instead.</p>\n"}], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 47786964, "answer_count": 1, "score": 0, "last_activity_date": 1513147097, "creation_date": 1513146824, "question_id": 47786909, "link": "https://stackoverflow.com/questions/47786909/excel-vba-run-time-error-1004-calling-workbooks", "title": "Excel VBA: Run-Time error 1004 calling Workbooks", "body": "<p>I have found different Run-Time Error 1004 questions, but none of them were totally appropriate. </p>\n\n<p>I get an error 1004 \"Application-defined or object defined error\" when using workbooks (last Row).</p>\n\n<pre><code>Dim mainWB  As Workbook\nDim mainWS  As Worksheet\nSet mainWB = ActiveWorkbook\nDim wb As Workbook\nDim WBname As String\n\nFor Each wb In Workbooks\n            If Left(wb.Name, 4) = \"D_SO\" And Len(wb.Name) &gt; 30 Then\n                WBname = wb.Name\n                Exit For\n            End If\nNext\n\nmainWB.Sheets(1).Range(Cells(1, 1), Cells(1600, 300)).Value = Workbooks(WBname).Sheets(1).Range(Cells(1, 1), Cells(1600, 300)).Value\n</code></pre>\n\n<p>None of my Workbooks objects in the last row seem to be working, eventhough the names are right. Can you find my mistake?</p>\n"}, {"tags": ["vba", "excel", "character-encoding", "character", "special-characters"], "comments": [{"owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1513150372, "post_id": 47786752, "comment_id": 82536354, "body": "I Updated to focus what I needed."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513151549, "post_id": 47786752, "comment_id": 82536934, "body": "Still not clear i&#39;m afraid. I thought perhaps you wanted a button image that has a black fill but then the line and spacing entered the equation. Are you trying to size the button as well? Clearer explanation and, as mentioned above, some code, would help."}, {"owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1513154623, "post_id": 47786752, "comment_id": 82538537, "body": "I need a character. I&#39;m looking for a character. A character and it&#39;s ASCII code to type with &lt;kbd&gt;Alt&lt;/kbd&gt;+(<code>code</code>). The character with the square shape which that fills entire space of the characters so when we type some number of this character, there where no space with them, same as &lt;kbd&gt;Alt&lt;/kbd&gt;+196; Example: 3 number of this character: \u2500\u2500\u2500"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1513156734, "post_id": 47786752, "comment_id": 82539771, "body": "Thank you for updating your post.  I removed my Close flag and posted an answer."}], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1513157805, "post_id": 47789392, "comment_id": 82540439, "body": "Regards. The character that I needed, has similarity and difference with one you advised. I need the character with squared-symbolized which it&#39;s height been same as the <code>Chr(150)</code>&#39;s width too."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1513159830, "post_id": 47789392, "comment_id": 82541708, "body": "<code>String(5,110)</code> will print 5 black squares.  You best bet is to bring up the Symbol Dialog and try to find it i the list.  You might end up having to change the Font."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1513159967, "post_id": 47789392, "comment_id": 82541792, "body": "It looks like you don&#39;t want any breaks just a solid black line.  Sorry, I never seen this."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1513159703, "last_edit_date": 1513159703, "creation_date": 1513156679, "answer_id": 47789392, "question_id": 47786752, "link": "https://stackoverflow.com/questions/47786752/i-need-the-character-square-form-which-entirely-filled-the-charactere-area-and/47789392#47789392", "title": "I need the character (square form) which entirely filled the charactere area and there is no spaces between two of these characters", "body": "<p>The character is called the En Dash and it's code is 150.  The way that I determined this is by using the Symbol Dialog to insert the it into a cell and then in the Immediate Window I used <code>?Asc(ActiveCell.Value)</code> to get its Character Code.  <code>Chr(150)</code> will reproduce the character and the String function can be used to repeat the it (e.g. <code>String(5, 150)</code> returns \u2500\u2500\u2500\u2500\u2500 ).</p>\n\n<p><a href=\"https://i.stack.imgur.com/n7yTk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n7yTk.jpg\" alt=\"Symbol Dialog\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1513177169, "post_id": 47792943, "comment_id": 82552966, "body": "Thank you so much."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 1, "creation_date": 1513179059, "post_id": 47792943, "comment_id": 82554313, "body": "Glad I could help. If you use the charmap tool as proposed by @Thomas-Inzina +) you can group into several <i>Unicode</i> subcategories and get the necessary hexadecimal code for the <code>ChrW</code> function (prefixed with <code>&amp;H</code>)."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1513167781, "creation_date": 1513167781, "answer_id": 47792943, "question_id": 47786752, "link": "https://stackoverflow.com/questions/47786752/i-need-the-character-square-form-which-entirely-filled-the-charactere-area-and/47792943#47792943", "title": "I need the character (square form) which entirely filled the charactere area and there is no spaces between two of these characters", "body": "<p><strong>Three Full block characters</strong></p>\n\n<p><code>ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\") = String(3, ChrW(&amp;H2588))</code></p>\n\n<p><strong>Horizontal Line (3 characters)</strong></p>\n\n<p><code>ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A3\") = String(3, ChrW(&amp;H2500))</code>\n<code>ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A4\") = String(3, ChrW(&amp;H25AC))</code></p>\n"}], "owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 47792943, "answer_count": 2, "score": 1, "last_activity_date": 1513167781, "creation_date": 1513146065, "last_edit_date": 1513150344, "question_id": 47786752, "link": "https://stackoverflow.com/questions/47786752/i-need-the-character-square-form-which-entirely-filled-the-charactere-area-and", "title": "I need the character (square form) which entirely filled the charactere area and there is no spaces between two of these characters", "body": "<blockquote>\n  <p>I need the square-symbolized character have the square shape that fills entire the character's area, (black).</p>\n</blockquote>\n\n<p><strong>Example:</strong> There where the character with (<kbd>Alt</kbd> + 196) ASCII code which is a line that horizontally filled the width of the character's space: </p>\n\n<p>Here is 5 character of <kbd>Alt</kbd> + 196: \u2500\u2500\u2500\u2500\u2500</p>\n\n<p>So there is no space between characters. </p>\n\n<blockquote>\n  <p>I need this form for a squared character that fills the width and height of the characters space.</p>\n</blockquote>\n\n<p>Regards.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1513142147, "post_id": 47785468, "comment_id": 82533002, "body": "Instead of using an input, you could declare <code>A2:A966</code> a range, or even create an array of that range, and loop through the search setting a new cell each time."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1513165676, "post_id": 47785468, "comment_id": 82545489, "body": "Before performing the reverse search, you need to make sure your script has the ability of pulling data from that site @John Gendi. That is what I&#39;ve fixed. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1513148080, "post_id": 47787159, "comment_id": 82535362, "body": "Btw, mind the <code>s</code> of <code>.getElementsByID</code> you used in your script. ID is always used as singular."}, {"owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "edited": false, "score": 0, "creation_date": 1513180726, "post_id": 47787159, "comment_id": 82555360, "body": "This is very helpful, I played around with it but am struggling to be able to get the output to be entered into a specific cell on my excel sheet i&#39;ll post my code as an answer to show you what I&#39;ve modified"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1513168119, "last_edit_date": 1513168119, "creation_date": 1513147952, "answer_id": 47787159, "question_id": 47785468, "link": "https://stackoverflow.com/questions/47785468/i-am-trying-to-create-a-macro-which-pulls-the-rating-and-total-reviews-from-imdb/47787159#47787159", "title": "I am trying to create a macro which pulls the rating and total reviews from IMDB.com into an excel file", "body": "<p>Several ways you can achieve that. Here is one of them. Give it a go:</p>\n\n<pre><code>Sub imd_data()\n\n    Dim IE As New InternetExplorer, html As HTMLDocument, ele As Object\n\n    With IE\n        .Visible = True\n        .navigate \"http://www.imdb.com/\"\n        Do Until .readyState = READYSTATE_COMPLETE: Loop\n        Set html = .document\n    End With\n\n    html.getElementById(\"navbar-query\").Value = \"Blood Diamond\"\n    html.getElementById(\"navbar-submit-button\").Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n    html.getElementsByClassName(\"result_text\")(0).getElementsByTagName(\"a\")(0).Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n    For Each ele In html.getElementsByClassName(\"imdbRating\")\n        With ele.getElementsByClassName(\"ratingValue\")\n            If .Length Then r = r + 1: Cells(r, 1) = .Item(0).innerText\n        End With\n        With ele.getElementsByClassName(\"small\")\n            If .Length Then Cells(r, 2) = .Item(0).innerText\n        End With\n    Next ele\n\n    IE.Quit\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>8.0/10  434,144\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1513181852, "post_id": 47797364, "comment_id": 82556116, "body": "I think you have used this <code>http:&#47;&#47;www.google.com&#47;</code> link unintentionally within your script, right?"}, {"owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1513182408, "post_id": 47797364, "comment_id": 82556489, "body": "No i switched to google for the initial search because IMDB website is very heavy to navigate through"}], "tags": [], "owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "is_accepted": false, "score": 0, "last_activity_date": 1513180840, "creation_date": 1513180840, "answer_id": 47797364, "question_id": 47785468, "link": "https://stackoverflow.com/questions/47785468/i-am-trying-to-create-a-macro-which-pulls-the-rating-and-total-reviews-from-imdb/47797364#47797364", "title": "I am trying to create a macro which pulls the rating and total reviews from IMDB.com into an excel file", "body": "<pre><code>Sub imd_data()\n\n\n Dim IE As New InternetExplorer, html As HTMLDocument, ele As Object\n\n    With IE\n        .Visible = True\n        .navigate \"http://www.google.com/\"\n        Do Until .readyState = READYSTATE_COMPLETE: Loop\n        Set html = .document\n        Set sht = Sheets(\"Sheet2\")\n    End With\n\n    html.getElementById(\"lst-ib\").Value = sht.Range(\"A2\") &amp; \" IMDB\"\n    html.getElementById(\"btnK\").Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n    html.getElementsByClassName(\"rc\")(0).getElementsByTagName(\"a\")(0).Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n    For Each ele In html.getElementsByClassName(\"imdbRating\")\n        With ele.getElementsByClassName(\"ratingValue\")\n            'If .Length Then r = r + 1: Cells(r, 1) = .Item(0).innerText\n            sht.Range(\"B2\") = .Item(0).innerText\n        End With\n        With ele.getElementsByClassName(\"small\")\n            'If .Length Then Cells(r, 2) = .Item(0).innerText\n             sht.Range(\"C2\") = .Item(0).innerText\n        End With\n    Next ele\n\n    IE.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9092005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156033619779697/picture?type=large", "display_name": "John Gendi", "link": "https://stackoverflow.com/users/9092005/john-gendi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 47787159, "answer_count": 2, "score": 2, "last_activity_date": 1513180840, "creation_date": 1513139181, "last_edit_date": 1513150601, "question_id": 47785468, "link": "https://stackoverflow.com/questions/47785468/i-am-trying-to-create-a-macro-which-pulls-the-rating-and-total-reviews-from-imdb", "title": "I am trying to create a macro which pulls the rating and total reviews from IMDB.com into an excel file", "body": "<p>I have a list of movies in a sheet that spans from A2:A966 and I'm trying to get the process to work however my code gets a run time error 91. Right now it asks for a name for a movie in the form of an input box (pulled from as many resources as I could but the tutorial which I found most useful used an input box) but ideally it would just run through the list of movies in the A2:A966 and pull the data for the ratings into B2:966 and total ratings into C2:C966</p>\n\n<pre><code>Sub test()\n    Dim eRow As Long\n    Dim ele As Object\n    Dim RowCount As Integer\n\n    Set sht = Sheets(\"Sheet1\")\n    RowCount = 1\n    sht.Range(\"A\" &amp; RowCount) = \"IMDB Rating\"\n    sht.Range(\"B\" &amp; RowCount) = \"Total Reviews\"\n    eRow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    'strSearch = Range(\"A2\")\n    moviename = InputBox(\"Enter movie name\")\n\n    With objIE\n        .Visible = True\n        .navigate \"http://www.imdb.com/\"\n\n        Do While .Busy Or _\n          .readystate &lt;&gt; 4\n            DoEvents\n        Loop\n\n        Set nam = .document.getElementsByName(\"navbar-query\")\n        nam.Item(0).Value = moviename\n\n        .document.getElementsByID(\"navbar-submit-button\").Click\n        .document.getElementsByID(\"result_text\").Click\n\n        Do While .Busy Or _\n          .readystate &lt;&gt; 4\n            DoEvents\n        Loop\n\n        For Each ele In .document.all\n            Select Case ele.classname\n                Case \"Result\"\n                    RowCount = RowCount + 1\n                Case \"ratingValue\"\n                    sht.Range(\"A\" &amp; RowCount) = ele.innertext\n                Case \"ratingCount\"\n                    sht.Range(\"B\" &amp; RowCount) = ele.innertext\n            End Select\n        Next ele\n    End With\n\n    Set objIE = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 345, "user_id": 2249155, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4jbea.png?s=128&g=1", "display_name": "neophlegm", "link": "https://stackoverflow.com/users/2249155/neophlegm"}, "edited": false, "score": 1, "creation_date": 1513135477, "post_id": 47784901, "comment_id": 82531418, "body": "Just to check, have you tried summarising your data with a pivot table and grouping that way? I&#39;m not sure if this is possible, but thought I&#39;d ask if you&#39;d tried it. Broadly, are you looking for a VB solution? Have you tried anything so far? It&#39;s best to reduce your question to a specific problem rather than generalities."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 345, "user_id": 2249155, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4jbea.png?s=128&g=1", "display_name": "neophlegm", "link": "https://stackoverflow.com/users/2249155/neophlegm"}, "edited": false, "score": 0, "creation_date": 1513135859, "post_id": 47784901, "comment_id": 82531519, "body": "I&#39;ll second @neophlegm. As is, your question is too broad. Try something out and if you face specific issue, clearly state it in your question."}, {"owner": {"reputation": 441, "user_id": 8492815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3471534d4aba8f3c18c2ee90416efe?s=128&d=identicon&r=PG&f=1", "display_name": "Carol", "link": "https://stackoverflow.com/users/8492815/carol"}, "edited": false, "score": 0, "creation_date": 1513138704, "post_id": 47784901, "comment_id": 82532120, "body": "You&#39;re going to need to use VBA probably."}, {"owner": {"reputation": 3, "user_id": 9091661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e0ff4adb444c823556bd617ec23d73?s=128&d=identicon&r=PG&f=1", "display_name": "eric1029", "link": "https://stackoverflow.com/users/9091661/eric1029"}, "edited": false, "score": 0, "creation_date": 1513215289, "post_id": 47784901, "comment_id": 82570760, "body": "Hi guys, thanks heaps for the quick replies. I&#39;ve tried to explain it further in Edit 01 as best I could"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1513144100, "creation_date": 1513144100, "answer_id": 47786363, "question_id": 47784901, "link": "https://stackoverflow.com/questions/47784901/how-to-combine-data-with-a-common-heading-from-one-sheet-into-another/47786363#47786363", "title": "How to combine data with a common heading from one sheet into another?", "body": "<p>So if you don't mind a slightly different output, you can do this with a few edits, and a pivot table.</p>\n\n<p>Remove the \"equipment\" row and the blank rows.  Then copy your table and go to a new area and Paste Special (right click) -> Transpose:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dgtp6.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dgtp6.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Then select that new table, go to Insert --> Pivot Table. Select <a href=\"https://i.stack.imgur.com/zRqV7.jpg\" rel=\"nofollow noreferrer\">these options.</a></p>\n\n<p>And there you go, albeit horizontal:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TRb6y.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TRb6y.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 9091661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e0ff4adb444c823556bd617ec23d73?s=128&d=identicon&r=PG&f=1", "display_name": "eric1029", "link": "https://stackoverflow.com/users/9091661/eric1029"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 47786363, "answer_count": 1, "score": -1, "last_activity_date": 1513215207, "creation_date": 1513134394, "last_edit_date": 1531161705, "question_id": 47784901, "link": "https://stackoverflow.com/questions/47784901/how-to-combine-data-with-a-common-heading-from-one-sheet-into-another", "title": "How to combine data with a common heading from one sheet into another?", "body": "<p>I have an Excel sheet which is a template for doing a count of all equipment on a construction project (example below).</p>\n\n<p><img src=\"https://i.stack.imgur.com/MbKPD.png\" alt=\"example data\"></p>\n\n<p>In this example, there are two drawings which are linked to the same distribution board (eg. drawings 01 and 02) served by DB1. I would like to summarize the data in this table by the name of the distribution board so it only displays the total of each different kind of equipment, disregarding any empty cells, as shown below.</p>\n\n<p><img src=\"https://i.stack.imgur.com/MOdCA.png\" alt=\"example summary data\"></p>\n\n<p>Any help as to how to approach this would be highly appreciated, as I'm thoroughly stumped.</p>\n\n<p>EDIT 01:</p>\n\n<p>To provide more information, the table would actually look more like below, with the equipment being split up into various types, and user selectable from a database.</p>\n\n<p><img src=\"https://i.stack.imgur.com/PTi0u.png\" alt=\"\"></p>\n\n<p>Currently, X amount of rows have been added for each and hidden. I guess the thrust of my question would be:</p>\n\n<ul>\n<li>How do I sum the totals for each unique piece of equipment relative to each distribution board but ALSO neglect 'empty rows'.</li>\n</ul>\n\n<p>I have used this formula to calculate for a DUS360-CR on DB1 in the above image;<br>\n=SUMPRODUCT(($B$4:$E$4=B4)*B6:E6)</p>\n\n<p>This returns the correct value, and is easy enough to replicate for all other rows but has its limitations in the sense that; </p>\n\n<ol>\n<li><p>The formula doesn't have any knowledge to what type of equipment it is, and is simply reading through each row - which will return  many empty values because of the hidden rows.</p></li>\n<li><p>I plan to have the summary of equipment for each DB in a separate sheet. As construction projects can have upwards of 50 levels at times, I would also like multiple copies of the template sheet. With the formula I currently have, the row titles (sensors/load controllers etc.) will have to be exactly the same as the original - meaning that even if only 1 quantity of an item is needed on level 50, that item will have to be selected on the original sheet, and subsequently searched - which is why there are hidden rows.</p></li>\n</ol>\n\n<p>I'm not very familiar with VBA, but am open to trying, if required.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7776358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/648d9313430a1df2b04c2f70ce4b7b81?s=128&d=identicon&r=PG&f=1", "display_name": "Automat", "link": "https://stackoverflow.com/users/7776358/automat"}, "edited": false, "score": 0, "creation_date": 1514908409, "post_id": 47788689, "comment_id": 83100826, "body": "It worked while changing the cell values manually, but automatically it waited for the TimeValue (what I wanted) but ignored the cell changes time, saving with the time I saved the macro changes. Do I have to leave Sheet2 active? I need Sheet1 open 24/7! I&#39;ve tried to understand what the code does but I cannot yet... I am very new to VBA... I really appreciate your help!"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "reply_to_user": {"reputation": 33, "user_id": 7776358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/648d9313430a1df2b04c2f70ce4b7b81?s=128&d=identicon&r=PG&f=1", "display_name": "Automat", "link": "https://stackoverflow.com/users/7776358/automat"}, "edited": false, "score": 0, "creation_date": 1515177051, "post_id": 47788689, "comment_id": 83214944, "body": "@Automat I updated my code. I added public variable to keep last scheduled procedure. That way it is possible to cancel it in <code>Worksheet_Change</code> and prevent from calling it many times. I don&#39;t know if this solves problem you described, but you can give it a try ;)"}], "tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1515177151, "last_edit_date": 1515177151, "creation_date": 1513154319, "answer_id": 47788689, "question_id": 47784868, "link": "https://stackoverflow.com/questions/47784868/vba-saveas-at-same-time-if-cell-changes/47788689#47788689", "title": "Vba SaveAs at same time if cell changes", "body": "<p>According to <a href=\"https://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime\">this</a> post, you can pass arguments to <code>OnTime</code> function. Change your <code>Abre</code> to accept a date, which can be used to save a file and call it with appropriate date from <code>Worksheet_Change</code> and <code>Abre</code> itself. The code below is not tested, but I think you will get the idea. One thing to check is what happens if your <code>Worksheet_Change</code> method get called twice: do you have to cancel previous <code>OnTime</code> before calling a new one?</p>\n\n<pre><code>'Cell change is at Sheet2\nSub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$C$20\" Then\n    Call teste\nEnd If\nIf Target.Address = \"$G$20\" Then\n    Call teste\nEnd If\nDim datestr As String\ndatestr = Format(Now, \"yyyymmdd, hhmm\")\nApplication.OnTime TimeValue(\"00:10:00\"), procedureCalled, , False\nprocedureCalled = \"'Abre \"\"\" &amp; datestr &amp; \"\"\"'\"\nApplication.OnTime TimeValue(\"00:10:00\"), procedureCalled\nEnd Sub\n\n'ThisWorkbook\nPrivate Sub Workbook_Open()\n    Dim datestr As String\n    datestr = Format(Now, \"yyyymmdd, hhmm\")\n    procedureCalled = \"'Abre \"\"\" &amp; datestr &amp; \"\"\"'\"\n    Application.OnTime TimeValue(\"00:10:00\"), procedureCalled\nEnd Sub\n\n'Module1\nPublic procedureCalled As String  '&lt;--variable to keep last scheduled procedure, so you can unshedule it in Worksheet_Change\nSub Abre(savedate As String)\n    Dim datestr As String\n    datestr = Format(Now, \"yyyymmdd, hhmm\")\n    procedureCalled = \"'Abre \"\"\" &amp; datestr &amp; \"\"\"'\"\n    Application.OnTime TimeValue(\"00:10:00\"), procedureCalled\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs \"D:\\Temperature Data\\DailyTemp \" &amp; savedate &amp; \".xlsm\"\nEnd Sub\n\n'Module2\nSub teste()\nMsgBox \"Did not work\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7776358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/648d9313430a1df2b04c2f70ce4b7b81?s=128&d=identicon&r=PG&f=1", "display_name": "Automat", "link": "https://stackoverflow.com/users/7776358/automat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1515177151, "creation_date": 1513134116, "last_edit_date": 1531164843, "question_id": 47784868, "link": "https://stackoverflow.com/questions/47784868/vba-saveas-at-same-time-if-cell-changes", "title": "Vba SaveAs at same time if cell changes", "body": "<p>I am very new to VBA and I really appreciate any help!\nI have a code to saveas every day at 00:10hrs that works great, and I have a code for the cell change, but I don't know how to combine them...\n   It needs to saveas if cell changes, but wait to 00:10hrs, subtract 1 day from the saving date and saveas, since temperature data values belong to previous day. Thank you in advance!</p>\n\n<pre><code>'Cell change is at Sheet2\nSub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$C$20\" Then\n        Call teste \n    End If\nIf Target.Address = \"$G$20\" Then\n        Call teste\n    End If\nEnd Sub\n\n'ThisWorkbook\nPrivate Sub Workbook_Open()\n   Application.OnTime TimeValue(\"00:10:00\"), \"Abre\"\nEnd Sub\n\n'Module1\nSub Abre()\n    Application.OnTime TimeValue(\"00:10:00\"), \"Abre\"\n    Dim datestr As String\n    datestr = Format(Now, \"yyyymmdd, hhmm\")\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs \"D:\\Temperature Data\\DailyTemp \" &amp; datestr &amp; \".xlsm\"\nEnd Sub\n\n'Module2\nSub teste()\nMsgBox \"Did not work\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint", "bullet"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 11839085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34b2bc472a9a6b17616b5d44d92be675?s=128&d=identicon&r=PG&f=1", "display_name": "egerz", "link": "https://stackoverflow.com/users/11839085/egerz"}, "is_accepted": false, "score": 0, "last_activity_date": 1565569425, "last_edit_date": 1565569425, "creation_date": 1565538502, "answer_id": 57451433, "question_id": 47784837, "link": "https://stackoverflow.com/questions/47784837/using-vba-to-set-bullets-and-sub-bullets/57451433#57451433", "title": "Using VBA to set bullets and sub bullets", "body": "<p>This is one the right track, but I'm seeing two major issues. </p>\n\n<p>One is that you don't really have any handling for setting different indent levels -- it just assumes we're setting the indent level to 1. But if you want to set an indent level for 2, 3, 4, etc, then you don't want to have to write a whole new sub. So, it's best to have the sub accept a variable (my_level), and use that to set your indents and indent level, as seen below. Then you just point your three indent buttons to their own caller subs, which pass along the appropriate indent level.</p>\n\n<p>Note that the first line indent is always -20 -- this value only needs to change if you want differing amounts of space between the bullet and the text in each level.  The LeftIndent value is just a multiple of the my_level value.</p>\n\n<p>The other issue I'm seeing is that you're using the Ruler object to set the indents. The problem is that doing it this way this affects the indent of all other text in the shape, including the text that's not selected. TextRange2 contains the .ParagraphFormat.FirstLineIndent and .ParagraphFormat.LeftIndent properties, which will keep your changes localized to the selected text. Some of the properties you're changing aren't available in TextRange2 however, so you need to set two different variables that are based on the selection, one for TextRange and one for TextRange2.</p>\n\n<p>Note that you have to set the .FirstLineIndent and .LeftIndent properties <em>after</em> you set the indent level. If you were to move the oText2 portion before the oText portion in the code below, the indents would not be set properly.</p>\n\n<p>This should point you in the right direction:</p>\n\n<pre><code>Sub CallLevel1()\n    ApplyLBulletsToSelectedCode (1)\nEnd Sub\n\nSub CallLevel2()\n    ApplyLBulletsToSelectedCode (2)\nEnd Sub\n\nSub CallLevel3()\n    ApplyLBulletsToSelectedCode (3)\nEnd Sub\n\n\n\nSub ApplyLBulletsToSelectedCode(my_level As Long)\n\nOn Error Resume Next\nErr.Clear\n\nDim oText As TextRange\nDim oText2 As TextRange2\n\nSet oText = ActiveWindow.Selection.TextRange\nSet oText2 = ActiveWindow.Selection.TextRange2\n\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"No text was selected. Please highlight some text \" _\n    &amp; \"or select a text frame and run the macro again.\", vbExclamation\n    End\nEnd If\n\nWith oText\n    .Paragraphs.IndentLevel = my_level\n\n     With .ParagraphFormat.Bullet\n        .Visible = msoCTrue\n        .RelativeSize = 1\n        .Character = 159\n\n        With .Font\n            .Color.RGB = RGB(0, 0, 0)\n            .Name = \"Wingdings\"\n        End With\n\n    End With\n\n    With .Font\n        .Name = \"Calibri\"\n        .Bold = msoFalse\n        .Color.RGB = RGB(0, 0, 0)\n        .Size = 14\n    End With\nEnd With\n\nWith oText2\n    .ParagraphFormat.Alignment = ppAlignLeft\n    .ParagraphFormat.FirstLineIndent = -20\n    .ParagraphFormat.LeftIndent = 20 * my_level\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8371968, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154840074923963/picture?type=large", "display_name": "Gerald Tao", "link": "https://stackoverflow.com/users/8371968/gerald-tao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2409, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1593682135, "creation_date": 1513133830, "last_edit_date": 1593682135, "question_id": 47784837, "link": "https://stackoverflow.com/questions/47784837/using-vba-to-set-bullets-and-sub-bullets", "title": "Using VBA to set bullets and sub bullets", "body": "<p>I would like to create a macro on powerpoint, when I highlight a portion of the text and run the macro. it will create a level1 round bullet. \nI intend to use this as the base to create level 2 (sub-bullets, nested within level 1), and level 3, but couldn't figure out what's wrong with my code.\nIs there any expert here able to provide me some direction please ?</p>\n\n<p>What I want to achieve is something like this, where eventually I will have 3 button as addin, and level 1 to level 3 bullet style can be switched freely by clicking on the button.</p>\n\n<ul>\n<li>Level 1 text</li>\n<li>Level 2 text\n\n<ul>\n<li>Level 2 text\n\n<ul>\n<li>Level 3 text</li>\n<li>Level 3 text</li>\n</ul></li>\n</ul></li>\n</ul>\n\n\n\n<pre><code>Sub ApplyLBulletsToSelectedCode()\nOn Error Resume Next\nErr.Clear\nDim oText As TextRange\n\nSet oText = ActiveWindow.Selection.TextRange\nIf Err.Number &lt;&gt; 0 Then\nMsgBox \"No text was selected. Please highlight some text \" _\n&amp; \"or select a text frame and run the macro again.\", vbExclamation\nEnd\nEnd If\n\nWith oText\n.ParagraphFormat.Alignment = ppAlignLeft\n.IndentLevel = 1\nWith .Parent.Ruler\n.Levels(1).FirstMargin = 20\n.Levels(1).LeftMargin = 0\nEnd With\nWith .ParagraphFormat.Bullet\n.Visible = msoCTrue\n.RelativeSize = 1\n.Character = 159\nWith .Font\n.Color.RGB = RGB(0, 0, 0)\n.Name = \"Wingdings\"\nEnd With\nEnd With\nWith .Font\n.Name = \"Calibri\"\n.Bold = msoFalse\n.Color.RGB = RGB(0, 0, 0)\n.Size = 14\nEnd With\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513133299, "post_id": 47784486, "comment_id": 82530890, "body": "Use <code>4</code> as the <code>increment</code> in your <code>For x = start To end Step increment</code> statement, and then use <code>x</code> as the row number?"}], "answers": [{"comments": [{"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1513134674, "post_id": 47784841, "comment_id": 82531214, "body": "Hi, <code>.Cells(.Rows.Count, Ct).End(xlUp).Row + 1</code> What does this line do?"}, {"owner": {"reputation": 35, "user_id": 3360708, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c95bb83e203f56777b337dca3da225d7?s=128&d=identicon&r=PG&f=1", "display_name": "user3360708", "link": "https://stackoverflow.com/users/3360708/user3360708"}, "edited": false, "score": 0, "creation_date": 1513135552, "post_id": 47784841, "comment_id": 82531436, "body": "Worked perfectly! Thank you so much, Variatus!! :)"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1513216343, "post_id": 47784841, "comment_id": 82570990, "body": "@ppz <code>Cells(1).Row</code> returns the row number of Cells(1). The formula you ask about returns the row number of the last non-empty cell in column <code>Ct</code> + 1, which would be the number of the first blank row in column <code>Ct</code>."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 35, "user_id": 3360708, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c95bb83e203f56777b337dca3da225d7?s=128&d=identicon&r=PG&f=1", "display_name": "user3360708", "link": "https://stackoverflow.com/users/3360708/user3360708"}, "edited": false, "score": 0, "creation_date": 1513216577, "post_id": 47784841, "comment_id": 82571052, "body": "@user3360708 Please remember to select the answer that worked for you, as beacon to others and reward to me."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1513133892, "creation_date": 1513133892, "answer_id": 47784841, "question_id": 47784486, "link": "https://stackoverflow.com/questions/47784486/excel-vba-loop-with-increment/47784841#47784841", "title": "Excel VBA - Loop with Increment", "body": "<p>This should do the job. Make sure that you make the required customisations before you try it in your workbook.</p>\n\n<pre><code>Sub TransferData()\n\n    Dim WsS As Worksheet, WsT As Worksheet      ' Source &amp; Target\n    Dim Rl As Long                              ' Last row\n    Dim Rs As Long, Cs As Long                  ' Source: Row, Column\n    Dim Rt As Long, Ct As Long                  ' Target: Row, Column\n\n    Set WsS = Worksheets(\"Source\")              ' change name as required\n    Set WsT = Worksheets(\"Source\")              ' I used the same sheet for my test\n\n    With WsT\n        Ct = 4                      ' specify the column to write to (here column D)\n        Rt = .Cells(.Rows.Count, Ct).End(xlUp).Row + 1\n    End With\n\n    Application.ScreenUpdating = False\n    With WsS\n        Cs = 1                      ' specify the column to read from (here column A)\n        Rl = .Cells(.Rows.Count, Cs).End(xlUp).Row\n        For Rs = 2 To Rl Step 4                 ' start from row 2\n            WsT.Cells(Rt, Ct).Value = .Cells(Rs, Cs).Value\n            Rt = Rt + 1\n        Next Rs\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3360708, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c95bb83e203f56777b337dca3da225d7?s=128&d=identicon&r=PG&f=1", "display_name": "user3360708", "link": "https://stackoverflow.com/users/3360708/user3360708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1717, "favorite_count": 0, "accepted_answer_id": 47784841, "answer_count": 1, "score": -1, "last_activity_date": 1513133892, "creation_date": 1513131122, "last_edit_date": 1531164843, "question_id": 47784486, "link": "https://stackoverflow.com/questions/47784486/excel-vba-loop-with-increment", "title": "Excel VBA - Loop with Increment", "body": "<p>How do you reference a cell every four rows from a source sheet and then have it placed in the output sheet? Each cell has different values. Thank you in advance</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1513131061, "post_id": 47784456, "comment_id": 82530402, "body": "More code is needed here. And an exact error message."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513133181, "post_id": 47784456, "comment_id": 82530855, "body": "And are you trying to see if the Excel Application is open, or whether a specific workbook is open in an Excel Application on your computer, or whether a specific workbook (perhaps on a shared drive) is open in an Excel Application on <b>any</b> computer?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1513134339, "post_id": 47784456, "comment_id": 82531154, "body": "Does somewhere in your code close the Workbook and quit the Excel process? You can go by <code>On Error Resume Next</code>, then <code>Set</code> App/Workbook object to see if they are <code>Nothing</code>. Not <b>Nothing</b> means opened already."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513161302, "post_id": 47784456, "comment_id": 82542716, "body": "And do you mean Application or the specific workbook?"}], "owner": {"reputation": 9, "user_id": 7287154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qWvVo.png?s=128&g=1", "display_name": "Vygandas Eidukis", "link": "https://stackoverflow.com/users/7287154/vygandas-eidukis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513189358, "creation_date": 1513130875, "last_edit_date": 1513189358, "question_id": 47784456, "link": "https://stackoverflow.com/questions/47784456/vba-word-can-i-see-if-application-is-already-open", "title": "VBA (Word) - can i see if application is already open", "body": "<p>I've been having experiencing an issue with Word VBA where, if the Application is already open, it would just crash and doesn't do any further steps. I've been surfing the Net trying to figure this out, but no luck. The error appears at the <code>o.Workbooks.Open</code> line:</p>\n\n<pre><code>Dim o as Excel.Application\no.Workbooks.Open (ActiveDocument.Path + \"\\Data.xlsm\")\n</code></pre>\n\n<p>Error message is </p>\n\n<blockquote>\n  <p>c:\\fol\\data.xlsm is already open or doesn't exist</p>\n</blockquote>\n\n<p>It basically saves the data that was entered in Word text boxes. Note: All code afterwards works fine, this is the line where it breaks. I've tried using <code>On Error</code> that it would just stop, but it doesn't seem to work :/ \nAny ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1513126112, "post_id": 47783731, "comment_id": 82529154, "body": "Hey, I had a similar thing with free text issues - I&#39;d look into regular expressions, they&#39;re amazing with free text. <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>"}, {"owner": {"reputation": 93, "user_id": 8817465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cca6567e081d722427dae1fb0bdab4cc?s=128&d=identicon&r=PG&f=1", "display_name": "lolsail", "link": "https://stackoverflow.com/users/8817465/lolsail"}, "reply_to_user": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1513126727, "post_id": 47783731, "comment_id": 82529286, "body": "Thanks, they might be more computationally simpler. I&#39;m still worried that someone, somehow, will find a new and exciting way to mispell things so badly that regex can&#39;t pick it up :\\"}], "tags": [], "owner": {"reputation": 93, "user_id": 8817465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cca6567e081d722427dae1fb0bdab4cc?s=128&d=identicon&r=PG&f=1", "display_name": "lolsail", "link": "https://stackoverflow.com/users/8817465/lolsail"}, "is_accepted": false, "score": 2, "last_activity_date": 1513124799, "creation_date": 1513124799, "answer_id": 47783731, "question_id": 47783269, "link": "https://stackoverflow.com/questions/47783269/dynamically-creating-a-pivot-table-using-fuzzy-matching/47783731#47783731", "title": "Dynamically creating a pivot table using fuzzy matching", "body": "<p>Having the same problem, I use a mix of your two methods.</p>\n\n<p>My data consists of a bunch of logs for rejected x-ray images, and the reject reason is a free text field. My solution was to create a table where the first column contains my desired output categories, and then each subsequent column contains a different variation of it.</p>\n\n<p>For example, a row might have (column one/ouput first entry):</p>\n\n<blockquote>\n  <p>Positioning, POS, Positioning Error, Patient Positioning</p>\n</blockquote>\n\n<p>Note that these are all fairly different from each other. Where the fuzzy matching comes in - it is used to capture all the smaller differences and mispellings <em>around</em> those other columns. When the fuzzy matching section decides a given reason matches a column's entry, it is then replaced with the appropriate desired output reason from column 1 of the table. In my example, a reason of 'Possitioning Err' [sic] would match to column 3 (Positioning Error) and then get converted to Positioning.</p>\n\n<p>Then wash rinse repeat over the rest of your data as needed. This approach  was super useful and fairly flexible in helping standardize my data. It was also computationally more expensive, but you'd only need to run the matching portion once I guess.</p>\n\n<p>As for the actual mechanics of going about doing this - I use 2010, so no inbuilt functionality. I run the fuzzy matching code on a temporary worksheet until best percentage matches are found, and then overwrite the actual source data afterwards.</p>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513183552, "creation_date": 1513121650, "last_edit_date": 1513183552, "question_id": 47783269, "link": "https://stackoverflow.com/questions/47783269/dynamically-creating-a-pivot-table-using-fuzzy-matching", "title": "Dynamically creating a pivot table using fuzzy matching", "body": "<p>So, I'm constantly being given data in new and different formats. I'm on a crusade to get my work to standardize data for easy use, and if I managed to convince the powers that be to standardize data, this problem becomes entirely moot. Until then, I have the following problem:</p>\n\n<p>I get data in a variety of ways. Sometimes my gross sales are called total sales. Sometimes gross sales before discounts, total sales before discounts, Gross_Sales, etc. Discounts, deductions, exempt amounts, etc. form another column. So on and so forth. I'd like to be able to do the following:</p>\n\n<p>1) Figure out what columns I want,<br>\n2) Turn those columns into a pivot table.</p>\n\n<p>For part 1, I have two options, and I'm wondering if there's anymore: The 1st is to use Microsoft's fuzzy-matching add-in to help me match. I'd have a separate tab dedicated to fuzzy matching each column I need. The second is to just generate a long list of all the variants, and to test each one until I find a hit, assign it, and move onto testing the next one. </p>\n\n<p>The second part is turning all of this into a pivot table - the resouces I have so far are <a href=\"https://www.thespreadsheetguru.com/blog/2014/9/27/vba-guide-excel-pivot-tables\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/9/27/vba-guide-excel-pivot-tables</a> and <a href=\"https://stackoverflow.com/questions/12861909/how-to-create-a-pivot-table-in-vba\">How to Create a Pivot Table in VBA</a></p>\n\n<p>Is there a better method? Is there another way?</p>\n\n<p>Edit: Slightly better method - Grab the data columns, place them into a table, and pivot everything off of that table - it removes the need to re-create pivot tables, just need to move the data over.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "edited": false, "score": 0, "creation_date": 1513122679, "post_id": 47782832, "comment_id": 82528231, "body": "try to declare <code>Public SwitchOnEventResponder As Boolean</code> in separate module, not in userform. I use it  this way and its working."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1513122732, "post_id": 47782832, "comment_id": 82528245, "body": "Just out of curiosity, why is the <code>Private Sub Userform_QueryClose</code> in the module and not in the Userform?"}, {"owner": {"reputation": 1, "user_id": 9053670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb57affd5174523d767b8a294b506ab?s=128&d=identicon&r=PG&f=1", "display_name": "Joe90", "link": "https://stackoverflow.com/users/9053670/joe90"}, "reply_to_user": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "edited": false, "score": 0, "creation_date": 1513128494, "post_id": 47782832, "comment_id": 82529682, "body": "@Sphinx - I moved the declaration out of the userform into the module. Now the userform doesn&#39;t recognise the <code>Me.SwitchOnEventResponder = True</code> statement"}, {"owner": {"reputation": 1, "user_id": 9053670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb57affd5174523d767b8a294b506ab?s=128&d=identicon&r=PG&f=1", "display_name": "Joe90", "link": "https://stackoverflow.com/users/9053670/joe90"}, "reply_to_user": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1513128616, "post_id": 47782832, "comment_id": 82529715, "body": "@SilentRevolution - It&#39;s in both. For no good reason. I guess I only need it in the userform code."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1513133386, "creation_date": 1513133386, "answer_id": 47784784, "question_id": 47782832, "link": "https://stackoverflow.com/questions/47782832/vba-code-to-suppress-the-the-control-click-sub-event-handler/47784784#47784784", "title": "VBA code to suppress the the control.Click() Sub / event handler", "body": "<p>In order to understand the problem it will help to change your <code>MsgBox</code> message</p>\n\n<pre><code>MsgBox \"Me.SwitchOnEventResponder = \" &amp; Me.SwitchOnEventResponder &amp; vbCrLf &amp; \"OptionsDLG.SwitchOnEventResponder = \" &amp; OptionsDLG.SwitchOnEventResponder\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/SBEcB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SBEcB.png\" alt=\"enter image description here\"></a></p>\n\n<p><code>Me</code> refers to the current instance of an Object.  Calling <code>Unload Me</code> will remove this instance from the Userforms collection.  When you set a variable or control on a Userform that is not Loaded a new UserForm is auto-instantiated.  The original instance of the Userform <code>Me</code> does not refer to the the new Instance of the UserForm.</p>\n\n<p>Changing <code>Me.SwitchOnEventResponder = False</code> to <code>OptionsDLG.SwitchOnEventResponder = False</code> will solve the problem.</p>\n\n<p>I prefer to create a new instance of the Userform before unloading the current instance.   Using a With statement will ensure that all the variables and controls are fully qualified to the correct instance.</p>\n\n<pre><code>With New OptionsDLG\n    .SwitchOnEventResponder = False\n    .OptionButton1.Value = False\n    .OptionButton2.Value = True\n    .SwitchOnEventResponder = True\n    .Show\nEnd With\n\nUnload Me\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9053670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb57affd5174523d767b8a294b506ab?s=128&d=identicon&r=PG&f=1", "display_name": "Joe90", "link": "https://stackoverflow.com/users/9053670/joe90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 411, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513133386, "creation_date": 1513118856, "last_edit_date": 1525816189, "question_id": 47782832, "link": "https://stackoverflow.com/questions/47782832/vba-code-to-suppress-the-the-control-click-sub-event-handler", "title": "VBA code to suppress the the control.Click() Sub / event handler", "body": "<p>OK. This is driving me nuts. I'm still getting a perpetual loop.\nMy previous question got me so far >>> <a href=\"https://stackoverflow.com/questions/47707808/using-vba-code-to-modify-optionbutton-value-is-activating-the-control-click-su/47764041#47764041\">Using VBA code to modify OptionButton.value is activating the control.Click() Sub</a></p>\n\n<p>I've rewritten some example code to try and nut this out.\nI've set up a Boolean 'handler' as per other suggestions\n(eg: <a href=\"http://www.cpearson.com/Excel/SuppressChangeInForms.htm\" rel=\"nofollow noreferrer\">Suppress events in UserForms</a>).  (I've called it <code>SwitchOnEventResponder</code>)</p>\n\n<p>When it gets to the code that is causing the click event to fire, the handler flips back to True (which allows a value change to activate the _Click() sub) just as the <code>OptionsDLG.OptionButton2.Value = True</code>\nstatement executes. WHY?</p>\n\n<p>Code in the module:</p>\n\n<pre><code>Sub StartDLG()\nCall changeframe(135)\n'code to change the UserForm (to hide the text box)\nCall PopulateText\nOptionsDLG.Show\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = 0 Then Cancel = True\nEnd Sub\n\nSub PopulateText()\n' Populates text box with initial text\nOptionsDLG.TextBox1.Value = \"Enter your msg here\"\nEnd Sub\n\nSub changeframe(FormH As String)\n\nOptionsDLG.Height = FormH\nOptionsDLG.Label1.Visible = False\nOptionsDLG.TextBox1.Visible = False\nEnd Sub\n</code></pre>\n\n<p>UserForm \"OptionsDLG\" code:</p>\n\n<pre><code>Public SwitchOnEventResponder As Boolean\n\nPrivate Sub UserForm_Initialize()\n        Me.SwitchOnEventResponder = True\nEnd Sub\n\nPrivate Sub OptionButton2_Change()\n        MsgBox \"Me.SwitchOnEventResponder = \" &amp; Me.SwitchOnEventResponder\n        If Me.SwitchOnEventResponder = False Then\n            Exit Sub\n        End If\n    End Sub\n\nPrivate Sub OptionButton1_Click()\n\n Unload Me\n Call changeframe(135)\n 'code to change the UserForm\n Call PopulateText\n OptionsDLG.Show\n\nEnd Sub\n\nPrivate Sub OptionButton2_Click()\n If Me.SwitchOnEventResponder = False Then\n            Exit Sub\n End If\n\n Unload Me\n\n Call PopulateText\n\n Me.SwitchOnEventResponder = False\n MsgBox \"Me.SwitchOnEventResponder = \" &amp; Me.SwitchOnEventResponder\n OptionsDLG.OptionButton1.Value = False\n OptionsDLG.OptionButton2.Value = True '&lt;&lt; This is where the loop starts. grrrr\n Me.SwitchOnEventResponder = True\n OptionsDLG.Show\nEnd Sub\n\n' This runs when the Ok button is clicked\nPrivate Sub OK_Click()\n    If OptionButton1.Value = True Then MsgBox \"HAPPY\"\n    If OptionButton2.Value = True Then MsgBox \"HAPPIER\"\nEnd Sub\n\n' This runs when the cancel button is clicked\nPrivate Sub Cancel_Click()\n    ' Show the main dialogue\n    Stop\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n            If CloseMode = 0 Then Cancel = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dynamic", "controls", "userform"], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 3298462, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/lnt6o.jpg?s=128&g=1", "display_name": "Mr. J", "link": "https://stackoverflow.com/users/3298462/mr-j"}, "edited": false, "score": 0, "creation_date": 1513174028, "post_id": 47793837, "comment_id": 82550797, "body": "This still doesn&#39;t work for me if <code>&quot;newcontrol1&quot;</code> was created dynamically. Was it a dynamic control when you tried it? I tried your code with <code>&quot;newcontrol1&quot;</code> as a normal control and it works both your way <b>without</b> <code>.Controls</code> <i>and</i> my initial way <b>with</b> <code>.Controls</code> so I don&#39;t think this makes a difference."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 207, "user_id": 3298462, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/lnt6o.jpg?s=128&g=1", "display_name": "Mr. J", "link": "https://stackoverflow.com/users/3298462/mr-j"}, "edited": false, "score": 0, "creation_date": 1513174303, "post_id": 47793837, "comment_id": 82550986, "body": "I&#39;ve tried and tested it and it worked for me, I created the first frame through the click of a button and the second through another button click..?"}, {"owner": {"reputation": 207, "user_id": 3298462, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/lnt6o.jpg?s=128&g=1", "display_name": "Mr. J", "link": "https://stackoverflow.com/users/3298462/mr-j"}, "edited": false, "score": 1, "creation_date": 1513187315, "post_id": 47793837, "comment_id": 82559661, "body": "Apologies yes creating one and then the other straight after does work, with or without a reference to <code>.Controls</code>. I think my issue is a bit more complicated. It turns out you can only <code>.Add</code> new frames to the most recently created frame. Due to my build order, I was trying to access a frame after I had already added a number of other parent frames. I&#39;ve now since changed my build order so the the child frame immediately follows the parent and this seems to work. It just means that everything needs to be built in order. I&#39;m sure there&#39;s a more efficient way of doing this though."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1513170548, "creation_date": 1513170548, "answer_id": 47793837, "question_id": 47782616, "link": "https://stackoverflow.com/questions/47782616/excel-vba-add-dynamic-frame-to-another-dynamic-frame/47793837#47793837", "title": "Excel VBA Add Dynamic Frame To Another Dynamic Frame", "body": "<p>Changing this line:</p>\n\n<pre><code>Set c = UserForm1.Controls(\"newcontrol1\").Controls.Add(\"Forms.Frame.1\", \"newcontrol2\", True)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Set c = UserForm1.Controls(\"newcontrol1\").Add(\"Forms.Frame.1\", \"newcontrol2\", True)\n</code></pre>\n\n<p>This worked for me. I believe the issue was the fact that you used .Controls twice.</p>\n"}], "owner": {"reputation": 207, "user_id": 3298462, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/lnt6o.jpg?s=128&g=1", "display_name": "Mr. J", "link": "https://stackoverflow.com/users/3298462/mr-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 758, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513170548, "creation_date": 1513117833, "question_id": 47782616, "link": "https://stackoverflow.com/questions/47782616/excel-vba-add-dynamic-frame-to-another-dynamic-frame", "title": "Excel VBA Add Dynamic Frame To Another Dynamic Frame", "body": "<p>How do I add a dynamically created frame to another dynamically created frame?</p>\n\n<p>Adding the parent frame works:</p>\n\n<p><code>Set c = UserForm1.Controls.Add(\"Forms.Frame.1\", \"newcontrol1\", True)</code></p>\n\n<p>Adding the child frame causes an error:</p>\n\n<p><code>Set c = UserForm1.Controls(\"newcontrol1\").Controls.Add(\"Forms.Frame.1\", \"newcontrol2\", True)</code></p>\n\n<p>The child frame is not added directly after the parent, so I need a way of referencing/accessing the parent frame's <code>Controls</code> at a later stage (essentially a working equivalent of the above expression).</p>\n\n<p><code>...UserForm1.Controls(\"newcontrol1\").Controls...</code> would work if <code>\"newcontrol1\"</code> was a normal frame. I know dynamically created controls can't be referenced in the same way that normal controls can be, and that they aren't created with events as standard, however even a dynamically created frame should have a <code>Controls</code> property... right?</p>\n\n<p>I feel as though I've managed to do this before, but I can't find any examples of this online.</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p>Thanks,\nMr. J</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1513177165, "post_id": 47783092, "comment_id": 82552964, "body": "Sorry, I meant to set a reminder on a message already in the Inbox. In either case, your proposal does not address my question, which is whether it is possible using VBA to get Outlook to display the &quot;Add Reminder ...&quot; dialog from the UI as illustrated above. Thanks!"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1513207248, "post_id": 47783092, "comment_id": 82568588, "body": "I added an example that sets up a follow-up for an item in the inbox. I am not sure why you want to display the follow up window at the same time, it does not make sense, the whole purpose of using VBA is avoiding dealing with the UI tools"}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1513267352, "post_id": 47783092, "comment_id": 82596716, "body": "The objective is to interact with the user to set the dates. As I noted, I can build my own form to ask for the dates, but it seemed like it would be easier to use the Outlook dialog, the same way I use the Outlook Categories dialog. [Really, though, I think my question is completely clear. I don&#39;t need help working around this, but thanks for offering. I just wanted to know if there was a way to invoke the Outlook Add Reminder dialog.]"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1513267884, "post_id": 47783092, "comment_id": 82597066, "body": "definitely, there is, I will look some more to see if I can figure it out"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1513275178, "post_id": 47783092, "comment_id": 82601407, "body": "One question: what criteria do you have to pick the mail item from the inbox and then display the reminder dialog box?"}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1513286434, "post_id": 47783092, "comment_id": 82607054, "body": "Let&#39;s say I loop through the mail folder (Inbox or Sent) and display the reminder dialog for every message that has no reminder (ReminderSet=False)."}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 0, "last_activity_date": 1513287824, "last_edit_date": 1513287824, "creation_date": 1513120463, "answer_id": 47783092, "question_id": 47782511, "link": "https://stackoverflow.com/questions/47782511/open-add-reminder-dialog-for-mail-item-in-outlook-using-vba/47783092#47783092", "title": "Open &quot;Add reminder...&quot; dialog for mail item in Outlook using VBA?", "body": "<p>When you click the Add Reminder dialog box button on the ribbon, depending on what window is active it will act and will tie the reminder object (and/or follow up object etc) to a mail item. </p>\n\n<p>If you have no mail item open it will tie it to the mail items that are selected in the inbox (one or more), By default only one item is selected, which is highlighted with a gray or light blue background. You can hold the CTRL key down and select more mail items and then click the Add Reminder to apply the reminder to all of those items.</p>\n\n<p>If a mail item is already open and active then the reminder will be applied only to that mail item. For your case that it seems you want to apply the reminders one by one we will go with the latter method. Find the mail item we want and then open it, and then open the Add Reminder dialog box, and when you hit ok, it will save it and close the active window. This code finds the most recent mail item, but you should be able to change the selection criteria:</p>\n\n<pre><code>Private Sub PopUpReminderDialogBox()\n    Dim iLatest As Long\n    Dim myFolder As Object\n    Dim myNameSpace As Object\n    Dim myItem As Outlook.MailItem\n    Dim olApp As Outlook.Application\n\n    Set olApp = Outlook.Application 'you can initiate a New application too\n    Set myNameSpace = olApp.GetNamespace(\"MAPI\")\n    Set myFolder = myNameSpace.GetDefaultFolder(olFolderInbox)\n\n    iLatest = myFolder.Items.Count\n    Set myItem = myFolder.Items(iLatest)\n\n    myItem.Display 'to make the mailitem currentitem\n    olApp.ActiveInspector.CommandBars.ExecuteMso (\"AddReminder\")\n    myItem.Close olSave\nEnd Sub\n</code></pre>\n\n<p>If you wanted by any chance to open up the reminder dialog box when one or more mail item is highlighted in the inbox, then you need to use</p>\n\n<pre><code>    olApp.ActiveExplorer.CommandBars.ExecuteMso (\"AddReminder\")\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>    olApp.ActiveInspector.CommandBars.ExecuteMso (\"AddReminder\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1513704123, "post_id": 47891285, "comment_id": 82750795, "body": "I don&#39;t think either that there is a straightforward way of activating that dialog box, it is controlled by the OS and not the VBA. Those commands are just implementation of windows functions in VBA. The bad part is that one cannot make an item active using VBA so I thought the best way is to open the item to make it active."}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1513708753, "post_id": 47891285, "comment_id": 82753041, "body": "That makes sense. I wasn&#39;t thinking of them as part of Windows. It also helps me as I&#39;m trying to understand <a href=\"https://gallery.technet.microsoft.com/office/Scroll-as-New-Messages-are-190668a3\" rel=\"nofollow noreferrer\">this TechNet article</a> that gets an Outlook explorer to scroll to the top. It uses a lot of Windows API calls. So maybe there is a way after all...."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1513709070, "post_id": 47891285, "comment_id": 82753189, "body": "All of such solutions are simulating manual entries with the UI and it is not really a good way of doing things in the background. I use such approaches if I have no choice really. One reason is that they act differently from one UI or another, from one OS to another and if the user is still playing with mouse or keyboard, the code does sth wrong"}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1513956942, "post_id": 47891285, "comment_id": 82857394, "body": "@Ibo - I agree that the use of the UI is a poor approach, especially across operating systems. I made a couple of unrelated discoveries and modified my answer above to account for them."}], "tags": [], "owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "is_accepted": false, "score": 0, "last_activity_date": 1513956775, "last_edit_date": 1513956775, "creation_date": 1513701183, "answer_id": 47891285, "question_id": 47782511, "link": "https://stackoverflow.com/questions/47782511/open-add-reminder-dialog-for-mail-item-in-outlook-using-vba/47891285#47891285", "title": "Open &quot;Add reminder...&quot; dialog for mail item in Outlook using VBA?", "body": "<p>Thank you, @ibo. That was very helpful, so I have accepted it as the answer.</p>\n\n<p>Here is a mock-up of a macro that simulates what I wanted to do. The fact that it changes the explorer that is visible in the Outlook UI whenever the code points to a different folder was useful in my case, but in the general case it would be better to have a method that didn't use the UI at all. I just don't think there is one.</p>\n\n<p>&lt;========================== EDITED =========================></p>\n\n<p>I found out by experimentation that changing the folder in the active explorer actually takes a lot of time (from the CPU perspective), so in many cases the explorer is not ready to clear the selection and select the chosen item unless you force the macro to wait. Usually a second or two is enough. I modified the code to allow up to 10 seconds.</p>\n\n<p>I also learned that the EntryID, as the unique identifier of a folder, is a good alternative to using the Is operator, which does not work whenever two objects were not \"Set\" equal to each other.</p>\n\n<pre><code>Public Sub testMSO()\n\n'This test macro selects the last item in the Inbox, but it could be\n' any item in any available folder.\n\nDim loItem As Object\nDim loNewFold As Folder\nDim loOldFold As Folder\nDim loExplorer As Explorer\nDim lbFoldChg As Boolean\nDim liLoops As Integer\nDim ldWait As Date\n\nOn Error Resume Next 'Mimimal error handling, just for demonstration purposes\n\n'Get the Inbox folder.\nSet loNewFold = Session.GetDefaultFolder(olFolderInbox)\n\n'Get the active explorer.\nSet loExplorer = Application.ActiveExplorer\n\n'The current and \"new\" folders always compare as different using the Is operator\n' because Is determines whether two objects were Set equal, so just use the\n' unique EntryID to determine if they are really different.\nIf loExplorer.CurrentFolder.EntryID = loNewFold.EntryID Then\n    lbFoldChg = False\nElse\n    lbFoldChg = True\n\n    'Save the explorer's current folder\n    Set loOldFold = loExplorer.CurrentFolder\n\n    'Assign the Inbox to the active explorer. Note that this is preferable to the\n    ' loNewFold.Display method, which is disconcerting to the user because it opens\n    ' a new explorer (new Outlook window).\n    Set loExplorer.CurrentFolder = loNewFold\n\nEnd If\n\n'Arbitrarily pick the last Inbox item.\nSet loItem = loNewFold.Items(loNewFold.Items.Count)\n\n'Make the chosen item the only selected item.\nIf lbFoldChg Then\n\n    'Selection takes place in the Outlook UI, so if the folder changes, it takes\n    ' quite a while in CPU terms to load the explorer and get it ready to change\n    ' the selection, so wait up to 10 seconds in 1-second increments.\n\n    For liLoops = 1 To 10\n        If loExplorer.IsItemSelectableInView(loItem) Then\n            loExplorer.ClearSelection\n            loExplorer.AddToSelection loItem\n            Exit For\n        Else\n            ldWait = Now + (1 / 86400)  'Add a second to current date/time\n            Do While Now &lt; ldWait\n                DoEvents\n            Loop\n        End If\n    Next liLoops\n\n    If liLoops = 11 Then\n        MsgBox \"Unable to select mail item in folder \" &amp; loItem.Parent.Name, _\n                vbOKOnly + vbExclamation\n        GoTo cleanup\n    End If\n\nElse\n\n    'If the folder has not changed, no need to wait.\n    loExplorer.ClearSelection\n    loExplorer.AddToSelection loItem\n\nEnd If\n\n'Display the Add Reminder dialog if it is available. It might not be available\n' if the item is, for example, an meeting item, or if the chosen folder does\n' not support reminders.\nIf loExplorer.CommandBars.GetEnabledMso(\"AddReminder\") Then\n    loExplorer.CommandBars.ExecuteMso \"AddReminder\"\nEnd If\n\ncleanup:\n\nIf lbFoldChg Then\n    'Point the explorer back to the original folder.\n    Set loExplorer.CurrentFolder = loOldFold\nEnd If\n\n'Clean up\nSet loExplorer = Nothing\nSet loNewFold = Nothing\nSet loOldFold = Nothing\nSet loItem = Nothing\n\nEnd Sub 'testMSO\n</code></pre>\n"}], "owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 47783092, "answer_count": 2, "score": 0, "last_activity_date": 1513956775, "creation_date": 1513117339, "question_id": 47782511, "link": "https://stackoverflow.com/questions/47782511/open-add-reminder-dialog-for-mail-item-in-outlook-using-vba", "title": "Open &quot;Add reminder...&quot; dialog for mail item in Outlook using VBA?", "body": "<p>Using Outlook 2013 32-bit under Win10 64-bit.</p>\n\n<p>In VBA, suppose I have a mailitem object. I know I can set the various task/reminder options individually through my own form if I want to create one. It seems like it would be a lot easier if I could cause Outlook's \"Add reminder ...\" dialog to display for the mail item, but I haven't found any references to it.</p>\n\n<p>This is the dialog as it appears in the Outlook:\n<a href=\"https://i.stack.imgur.com/HhDA6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HhDA6.jpg\" alt=\"Add Reminders dialog\"></a></p>\n\n<p>(As an aside, I can get the Categories dialog to come up using myMailItem.ShowCategoriesDialog, but there doesn't seem to be anything similar for reminders.)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513116642, "post_id": 47782324, "comment_id": 82526028, "body": "the full column has 1048576 cells, you are trying to paste it starting in row 7.  From 7 to bottom of the sheet only has 1048569 cells.  so it cannot be pasted."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 2, "creation_date": 1513116752, "post_id": 47782324, "comment_id": 82526078, "body": "I dont see how this would work on any version, you&#39;re trying to copy a whole column (e.g.. all cells possible in a column) into a cell in that column. Of course there aren&#39;t enough rows. Try Sheets(&quot;Control1&quot;).Columns(Route_Name).Copy Destination:=Sheets(&quot;Data&quot;).Columns(1), or whatever column is appropriate"}, {"owner": {"reputation": 13, "user_id": 9091108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b98110c3df1a932afb7c469a68fb07?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/9091108/jay"}, "edited": false, "score": 0, "creation_date": 1513117082, "post_id": 47782324, "comment_id": 82526212, "body": "Gentleman, I think you are absolutely right. How might I go about fixing that? I just realized prior i had the data pasting into R1C1"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9091108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b98110c3df1a932afb7c469a68fb07?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/9091108/jay"}, "edited": false, "score": 0, "creation_date": 1513118136, "post_id": 47782478, "comment_id": 82526652, "body": "Scott, this works fantastic. Thank you so much for the help and guidance here."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1513118126, "last_edit_date": 1513118126, "creation_date": 1513117199, "answer_id": 47782478, "question_id": 47782324, "link": "https://stackoverflow.com/questions/47782324/worksheetfunction-match-cannot-paste-run/47782478#47782478", "title": "WorksheetFunction.Match Cannot Paste/Run", "body": "<p>Always declare your variables:</p>\n\n<pre><code>Dim Route_Name As Long\nDim Feature_Type As Long\nDim Shape_Length As Long\n</code></pre>\n\n<p>You are not using the With Block you set up.  You need to precede any ranges that use that parent with <code>.</code></p>\n\n<pre><code>.Rows(\"1:1\")\n</code></pre>\n\n<p>Use Intersect to only copy the area that is used:</p>\n\n<pre><code>Intersect(.UsedRange, .Columns(Route_Name)).Copy Destination:=Sheets(\"Data\").Range(\"A7\")\n</code></pre>\n\n<p>So:</p>\n\n<pre><code>Sub RunMacro()\n\nDim Route_Name As Long\nDim Feature_Type As Long\nDim Shape_Length As Long\n\n'Step 1: #Script searches for header matches in Control1 dataset, then will copy in next\n'step to Data list\n\n    With Sheets(\"Control1\")\n\n        Route_Name = WorksheetFunction.Match(\"ROUTE_NAME\", .Rows(\"1:1\"), 0)\n        Feature_Type = WorksheetFunction.Match(\"FEATURE_TYPE\", .Rows(\"1:1\"), 0)\n        Shape_Length = WorksheetFunction.Match(\"SHAPE_LENGTH\", .Rows(\"1:1\"), 0)\n\n\n'Step 2: #Data transfer process\n\n\n        Intersect(.UsedRange, .Columns(Route_Name)).Copy Destination:=Sheets(\"Data\").Range(\"A7\")\n        Intersect(.UsedRange, .Columns(Feature_Type)).Copy Destination:=Sheets(\"Data\").Range(\"B7\")\n        Intersect(.UsedRange, .Columns(Shape_Length)).Copy Destination:=Sheets(\"Data\").Range(\"T7\")\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>One more note:  </p>\n\n<p>This will fail if any of the lookups do not exist in the the first row.  There are many methods of capturing and dealing with this problem.  </p>\n\n<p>I like to use <code>On Error Resume Next</code> with an immediate <code>On Error Goto 0</code> This will then skip the error on those three lines only.  The <code>If</code>s will then only copy if the column was found:</p>\n\n<pre><code>Sub RunMacro()\n\nDim Route_Name As Long\nDim Feature_Type As Long\nDim Shape_Length As Long\n\n'Step 1: #Script searches for header matches in Control1 dataset, then will copy in next\n'step to Data list\n\n    With Sheets(\"Control1\")\n        On Error Resume Next\n            Route_Name = WorksheetFunction.Match(\"ROUTE_NAME\", .Rows(\"1:1\"), 0)\n            Feature_Type = WorksheetFunction.Match(\"FEATURE_TYPE\", .Rows(\"1:1\"), 0)\n            Shape_Length = WorksheetFunction.Match(\"SHAPE_LENGTH\", .Rows(\"1:1\"), 0)\n        On Error GoTo 0\n\n'Step 2: #Data transfer process\n\n        If Route_Name Then _\n            Intersect(.UsedRange, .Columns(Route_Name)).Copy Destination:=Sheets(\"Data\").Range(\"A7\")\n        If Feature_Type Then _\n            Intersect(.UsedRange, .Columns(Feature_Type)).Copy Destination:=Sheets(\"Data\").Range(\"B7\")\n        If Shape_Length Then _\n            Intersect(.UsedRange, .Columns(Shape_Length)).Copy Destination:=Sheets(\"Data\").Range(\"T7\")\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9091108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b98110c3df1a932afb7c469a68fb07?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/9091108/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 47782478, "answer_count": 1, "score": 1, "last_activity_date": 1513128680, "creation_date": 1513116450, "last_edit_date": 1531164843, "question_id": 47782324, "link": "https://stackoverflow.com/questions/47782324/worksheetfunction-match-cannot-paste-run", "title": "WorksheetFunction.Match Cannot Paste/Run", "body": "<p>I recently upgraded my work Microsoft account from Excel 2010 to Excel 2016.</p>\n\n<p>While I still had Excel 2010, I coded a series of Macros to automate a substantially tedious task. Upon moving to Excel 2016, one of my VBA scripts appears to have \"broken\".</p>\n\n<p>Below is the script:</p>\n\n<pre><code>Sub RunMacro()\n\nSheets(\"Control1\").Select\n\n'Step 1: #Script searches for header matches in Control1 dataset, then will copy in next\n'step to Data list\n\n    With Sheets(\"Control1\")\n\n        Route_Name = WorksheetFunction.Match(\"ROUTE_NAME\", Rows(\"1:1\"), 0)\n        Feature_Type = WorksheetFunction.Match(\"FEATURE_TYPE\", Rows(\"1:1\"), 0)\n        Shape_Length = WorksheetFunction.Match(\"SHAPE_LENGTH\", Rows(\"1:1\"), 0)\n\n\n'Step 2: #Data transfer process\n\n        Sheets(\"Control1\").Columns(Route_Name).Copy Destination:=Sheets(\"Data\").Range(\"A7\")\n        Sheets(\"Control1\").Columns(Feature_Type).Copy Destination:=Sheets(\"Data\").Range(\"B7\")\n        Sheets(\"Control1\").Columns(Shape_Length).Copy Destination:=Sheets(\"Data\").Range(\"T7\")\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>When I run the script, I receive a Run-time error '1004', stating: \"You can't paste this here because the Copy area and paste area aren't the same size. Select just one cell in the paste area or an area that's the same size and try pasting again.\"</p>\n\n<p>The difficulty is, this script has no problem running in Excel/VBA 2010. What problems might exist with this script, or alternatively, are there potential macro security settings limiting this from functioning properly?</p>\n\n<p>I appreciate any help.</p>\n"}, {"tags": ["vba", "excel", "indexing"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513116634, "post_id": 47782239, "comment_id": 82526024, "body": "I would probably use a dictionary for this, and if the key already exists e.g. A then add 1 to the associated value."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513117764, "post_id": 47782239, "comment_id": 82526467, "body": "If you end up knowing what the final range is, just set that range formula outside of the loop equal to your original formula."}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1513118979, "post_id": 47782816, "comment_id": 82527016, "body": "@Alex I used late binding, which makes using dictionary in the code problem-free, however, if you wanted to use dictionary and its methods etc a better approach is to use <b>early binding</b> which  means you need to goto Tools/References in the VBE and check <b>Microsoft Scripting Runtime</b>. In that case defining a new dictionary object will be as simple as <code>dim dict=New dictionary</code> for more information on dictionaries visit: <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-dictionary</a>"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 1, "last_activity_date": 1513119090, "last_edit_date": 1513119090, "creation_date": 1513118772, "answer_id": 47782816, "question_id": 47782239, "link": "https://stackoverflow.com/questions/47782239/referencing-a-range-of-cells-in-a-different-worksheet-via-indexing-vba/47782816#47782816", "title": "referencing a range of cells in a different worksheet via indexing vba", "body": "<p>As mentioned in the comments using the dictionary is the best approach. So your code will be as below. I don't know how you want your results to be printed or used, but for this example, the code will create a sheet called \"Results\" and if it existed it will just clear it and write new results:</p>\n\n<pre><code>Option Explicit\nSub CountOccurrences()\n    Dim i As Long\n    Dim j As Long\n    Dim cnt As Long\n    Dim lCol As Integer\n    Dim N As Long\n    Dim key As Variant\n    Dim dict As Object\n    Dim WS As Worksheet\n    Dim WS_Result As Worksheet\n\n    'Set objects and create a sheet to print results\n    Set WS = ThisWorkbook.Worksheets(\"Sheet1\") 'change the name of the sheet to whatever you have\n\n    On Error GoTo Handler\n    Set WS_Result = ThisWorkbook.Worksheets(\"Results\")\n    On Error GoTo 0\n\n    WS_Result.Cells.Clear\n\n    'Count the columns\n    lCol = WS.Cells(1, WS.Columns.Count).End(xlToLeft).Column\n\n    'Loop thru all columns and count occurrences\n    For j = 1 To lCol\n        'Find the last row\n        N = WS.Cells(WS.Rows.Count, lCol).End(xlUp).Row\n\n        'Create a new dictionary\n        Set dict = CreateObject(\"scripting.dictionary\")\n\n        For i = 1 To N\n            key = WS.Cells(i, j).Value\n            If dict.exists(key) = False Then\n                dict.Add key, 1 'key=cell value, item=count of that value\n            Else\n                dict(key) = dict(key) + 1\n            End If\n        Next i\n\n        'Print the results\n        cnt = 0\n        For Each key In dict.keys\n            cnt = cnt + 1\n            WS_Result.Cells(cnt, (j - 1) * 2 + 1).Value = key\n            WS_Result.Cells(cnt, (j - 1) * 2 + 2).Value = dict(key)\n        Next key\n\n        'Destroy the dictionary to startover\n        Set dict = Nothing\n    Next j\n\n    Exit Sub\nHandler:\n    Set WS_Result = ThisWorkbook.Worksheets.Add\n    WS_Result.Name = \"Results\"\n    Resume\nEnd Sub\n</code></pre>\n\n<p><strong>snapshot of the result</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/M9OS5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M9OS5.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513119090, "creation_date": 1513116017, "last_edit_date": 1531164843, "question_id": 47782239, "link": "https://stackoverflow.com/questions/47782239/referencing-a-range-of-cells-in-a-different-worksheet-via-indexing-vba", "title": "referencing a range of cells in a different worksheet via indexing vba", "body": "<p>In excel, I have (table containing many columns of categorical variables):</p>\n\n<pre><code>A   E\nS   E\nD   YU\nR   T\nFD  R\nFD  RT\nD   YU\nS   T\nAS  R\nD   RR\nD   R\n</code></pre>\n\n<p>I want (the frequency of each separate term):</p>\n\n<pre><code>A   1   E   2\nS   2   YU  2\nD   4   T   2\nR   1   R   3\nFD  2   RT  1\nAS  1   RR  1\n</code></pre>\n\n<p>I am computing the frequency of each term. I can compute this individually by hand with:</p>\n\n<pre><code>Sub ff()\n    Range(\"B1:B6\").Select\n    Selection.FormulaArray = \"=COUNTIFS(Sheet1!C[-1],Sheet2!RC[-1]:R[5]C[-1])\"\n    Range(\"D1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>but I want to loop through each column and put the frequency count on another sheet. so far, I have:</p>\n\n<pre><code>Sub Macro1()\n    Sheets(\"Sheet1\").Select\n    lcol = Cells(1, Columns.Count).End(xlToLeft).Column\n    N = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For j = 1 To lcol\n        Range(Cells(1, j), Cells(N, j)).Select\n        Selection.Copy\n        Sheets(\"Sheet2\").Select\n        Cells(1, 2 * j - 1).Select\n        ActiveSheet.Paste\n\n        Columns(2 * j - 1).RemoveDuplicates Columns:=1, Header:=xlNo\n        nr = Cells(Rows.Count, 2 * j - 1).End(xlUp).Row\n        Range(Cells(1, 2 * j), Cells(nr, 2 * j)).Select\n       *Selection.FormulaArray = \"=COUNTIFS(Sheet1!C[\" &amp; j &amp; \"],Sheet2!RC[-1]:R[5]C[-1])\"\n        Sheets(\"Sheet1\").Select\n    Next j\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li>is where I keep getting an error. How can I reference another worksheet range of cells in a formula notation via indexing. I would like to use j to reference the correct column. </li>\n</ul>\n\n<p>I followed advice from <a href=\"https://stackoverflow.com/questions/19428497/refereing-to-a-range-of-cell-in-another-sheet\">Refereing to a range of cell in another sheet</a> but they reference explicit cells. In my case, I will reference explicit cells, but by an index reference (j).</p>\n\n<p>note that</p>\n\n<pre><code>Sheets(2).Range(\"F15:AK46\").Select\n</code></pre>\n\n<p>gave me an error as well</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1513114778, "post_id": 47781855, "comment_id": 82525313, "body": "How doesn&#39;t it work? If you input <code>asd</code> it still takes what&#39;s already in <code>J2</code> and uses that for <code>myValue</code>? If you step through with <code>F8</code>, after the <code>myValue = </code> line, does it correctly set <code>myValue</code>? (Hover the mouse over that variable, or add <code>Debug.Print myValue</code> in there to make sure it&#39;s at least assigning the variable correctly."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1513114824, "post_id": 47781855, "comment_id": 82525338, "body": "What is it doing that you don&#39;t want it to?  It is putting the formula in every cell in J, and then setting the value = to the value in the cells in J, then it&#39;s setting J2 to be the value that was input with the Inputbox."}, {"owner": {"reputation": 63, "user_id": 7958383, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2241a4c84f472dacee442164dc2f15c8?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/7958383/neil"}, "edited": false, "score": 0, "creation_date": 1513115626, "post_id": 47781855, "comment_id": 82525629, "body": "This is my confusion that it doesn&#39;t work.  It works for every other column with no problem. It correctly sets myValue and it returns the, =IF($A2&lt;&gt;&quot;&quot;,&quot;00682300&quot;,&quot;&quot;), on every line instead of just 00682300 or any other value entered. So it is reading the values in Column A correctly it is just not outputting the entered value in Column J. It is obviously reading the input value correctly but for cells J3:J it is just returning the =IF($A2&lt;&gt;&quot;&quot;,&quot;00682300&quot;,&quot;&quot;)"}, {"owner": {"reputation": 63, "user_id": 7958383, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2241a4c84f472dacee442164dc2f15c8?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/7958383/neil"}, "edited": false, "score": 0, "creation_date": 1513116863, "post_id": 47781855, "comment_id": 82526124, "body": "J     J1 - CommandButton     J2 - asd     J3 - =IF($A2&lt;&gt;&quot;&quot;,&quot;asd&quot;,&quot;&quot;)     J4 - =IF($A2&lt;&gt;&quot;&quot;,&quot;asd&quot;,&quot;&quot;)     J5 - =IF($A2&lt;&gt;&quot;&quot;,&quot;asd&quot;,&quot;&quot;)  so on and so on"}, {"owner": {"reputation": 63, "user_id": 7958383, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2241a4c84f472dacee442164dc2f15c8?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/7958383/neil"}, "edited": false, "score": 0, "creation_date": 1513180438, "post_id": 47781855, "comment_id": 82555196, "body": "Ok so I figured it out after beating my head in. It was an error in another line of code that made the Column Text instead on General. Changing that seems to have fixed it and the code works fine"}], "owner": {"reputation": 63, "user_id": 7958383, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2241a4c84f472dacee442164dc2f15c8?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/7958383/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513114569, "creation_date": 1513114143, "last_edit_date": 1513114569, "question_id": 47781855, "link": "https://stackoverflow.com/questions/47781855/excel-vba-input-box-to-autofill-column", "title": "Excel VBA: Input Box to AutoFill Column", "body": "<p>I am using the following on a CommandButton(2). It is 2 of 6 CommandButtons using the same code.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim myValue As String\nDim lastCel As Range\nDim rng As Range\nSet rng = ActiveSheet.Range(\"J1\")\nWith ActiveSheet.OLEObjects(\"CommandButton2\")\n    .Top = rng.Top\n    .Left = rng.Left\n    .Width = rng.Width\n    .Height = rng.RowHeight\n    Set lastCel = Range(\"A\" &amp; Rows.Count).End(xlUp)\n    myValue = InputBox(\"Enter Advice No\", \"Check No\")\n    Range(\"J2:J\" &amp; lastCel.Row).Formula = \"=IF($A2&lt;&gt;\"\"\"\",\" &amp; \"\"\"\" &amp; myValue &amp; \"\"\"\" &amp; \",\"\"\"\")\"\n    Range(\"J2:J\" &amp; lastCel.Row).Value = Range(\"J2:J\" &amp; lastCel.Row).Value\n    Range(\"J2\").Value = myValue\nEnd With  \nEnd Sub\n</code></pre>\n\n<p>The code is tied to a command button which prompts the user for input information and then is supposed to autofill the column with the entered value so long as their is a value in Column A. Unlike the other 5 CommandButtons this one will not work.</p>\n\n<p>When I enter any value it will return the entered value for cell J2.</p>\n\n<p>It then returns, =IF($A2&lt;>\"\",\"00682300\",\"\"), for each cell thereafter.</p>\n\n<p>The most common entry is a number in the listed format. I am not sure why it is working for every other CommandButton except this one.</p>\n"}, {"tags": ["excel", "variables", "range", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1513113069, "post_id": 47781575, "comment_id": 82524565, "body": "<code>acell</code> is never declare nor is it set as a range anywhere in the code."}, {"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513113130, "post_id": 47781575, "comment_id": 82524588, "body": "what should I declare it as? Range?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1513113220, "post_id": 47781575, "comment_id": 82524627, "body": "yes, otherwise <code>.Address</code> will not work.  Also it is not set to a range anywhere in your code.  You have <code>actcell</code> getting a value of a cell but no <code>acell</code>"}, {"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513113288, "post_id": 47781575, "comment_id": 82524652, "body": "Yes I changed the name and forgot to change it everywhere"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513113421, "post_id": 47781575, "comment_id": 82524716, "body": "Right now <code>actcell</code> is a variant that is a value and <code>.Address</code> is not a child.  You need to <code>Set</code> a range.  All variables should be declared.  Put <code>Option Explicit</code> at the top of the module.  It would have caught the typo error."}], "owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513113275, "creation_date": 1513112979, "last_edit_date": 1531161705, "question_id": 47781575, "link": "https://stackoverflow.com/questions/47781575/difficulty-with-copy-and-paste-using-cells-address", "title": "Difficulty with Copy and Paste using cell&#39;s address", "body": "<p>I am trying to copy a group of cells from one worksheet to another. However I need to make sure it goes in the right space by double checking the month. My initial thought is to find the last value, check the date in which it occurs, then if it is the required date, declare a new variable and pass that variables address to the copy and paste code. But the code fails at the copy and paste area, which I think is a result of how I define the variables, but I need a much smarter mind than mine to figure out where I am going wrong. Thoughts?</p>\n\n<pre><code>Sub perfupdate()\n\n    Application.ScreenUpdating = False\n    Dim sh1, sh2 As Worksheet\n    Set sh1= ThisWorkbook.Sheets(\"sheet1\")\n    Set sh2= ThisWorkbook.Sheets(\"sheet2\")\n\n    Dim datecell As Date\n    datecell = sh2.Range(\"a2\").End(xlToRight).Offset(-1, 1).Value\n\n    Dim dc As Range\n    Set dc= sh2.Range(\"A2\").End(xlToRight).Offset(-1, 1)\n    dcadd = dc.Address\n\n    If Month(datecell) = Month(today) And Year(datecell) = Year(today) Then\n        actcell = sh2.Range(dcadd).Offset(0, -1)\n    Else\n        actcell = sh2.Range(dcadd)\n    End If\n\n\n    sh1.Range(\"BB3\", \"BB7\").Copy Destination:=sh2.Range(actcell.Address).Offset(1, 0)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513112694, "post_id": 47781485, "comment_id": 82524395, "body": "<code>Dim arreglito(1) As String</code>  you must declare the size of the array before using it."}, {"owner": {"reputation": 81, "user_id": 9089179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d702e3cc9c80c3345dbf474508d8a80b?s=128&d=identicon&r=PG&f=1", "display_name": "alex ", "link": "https://stackoverflow.com/users/9089179/alex"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513113192, "post_id": 47781485, "comment_id": 82524614, "body": "it worked fine, is it possible to redefine array size?"}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1513113282, "post_id": 47781485, "comment_id": 82524650, "body": "<code>ReDim</code>, also the <code>Array</code> statement may make that unnecessary."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513113305, "post_id": 47781485, "comment_id": 82524660, "body": "Look into Redim and RedimPreserve.  The idea is that the array size must be defined before using.  Or you can use a collection which does not have those constraints."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1513113358, "post_id": 47781485, "comment_id": 82524686, "body": "or just read the range straight into an array and then take the ubound? Assuming that is what OP means by length?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513113694, "post_id": 47781485, "comment_id": 82524836, "body": "^^^ with that the array must be a variant: <code>Dim arreglito() As Variant</code> then you can <code>arreglito = Range(&quot;A1:A2&quot;).Value</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513114275, "post_id": 47781485, "comment_id": 82525094, "body": "@ScottCraner Indeed. And as didn&#39;t want to transfer between arrays added a transpose step of a range variable."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513114795, "post_id": 47781815, "comment_id": 82525322, "body": "This also only works on a single column range.  If the range has more than one column it will not work."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1513114815, "post_id": 47781815, "comment_id": 82525330, "body": "Nag damn it. True."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1513116160, "last_edit_date": 1513116160, "creation_date": 1513114004, "answer_id": 47781815, "question_id": 47781485, "link": "https://stackoverflow.com/questions/47781485/how-to-fill-an-array-with-strings-in-vba-and-get-its-lengh/47781815#47781815", "title": "How to fill an array with strings in VBA and get its lengh?", "body": "<p>Here is a method of adding a single column range from the worksheet to a string array (transpose may have some size restrictions. 2^16 is it?).</p>\n\n<p>Have used a line by <a href=\"http://%20%20&#39;https://stackoverflow.com/questions/6773232/excel-vba-range-to-string-array-in-1-step\" rel=\"nofollow noreferrer\">Flephal</a> to get the range into a string array in one step.</p>\n\n<pre><code>Sub AddToArray()\n\nDim arreglito() As String\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Worksheets(\"MySheet\") 'change as appropriate\n\nDim srcRange As Range\nSet srcRange = ws.Range(\"A1:A3\")\n\narreglito = Split(Join(Application.Transpose(srcRange), \"#\"), \"#\")\n\nMsgBox UBound(arreglito) + 1\n\nEnd Sub\n</code></pre>\n\n<p>For more than one column transfer via a variant array:</p>\n\n<pre><code>Sub AddToArray2()\n\n    Dim arreglito() As String\n    Dim sourceArr()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"MySheet\") 'change as appropriate\n\n    Dim srcRange As Range\n    sourceArr = ws.Range(\"A1:C3\")\n\n    ReDim arreglito(1 To UBound(sourceArr, 1), 1 To UBound(sourceArr, 2))\n\n    Dim x As Long\n    Dim y As Long\n\n    For x = LBound(sourceArr, 1) To UBound(sourceArr, 1)\n        For y = LBound(sourceArr, 2) To UBound(sourceArr, 2)\n            arreglito(x, y) = CStr(sourceArr(x, y))\n        Next y\n    Next x\n\n    MsgBox UBound(arreglito, 1) &amp; \" x \" &amp; UBound(arreglito, 2)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92, "user_id": 4236936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63d2a55135f6e650f1d484bf5da6dfc?s=128&d=identicon&r=PG&f=1", "display_name": "storm_88", "link": "https://stackoverflow.com/users/4236936/storm-88"}, "is_accepted": false, "score": 1, "last_activity_date": 1513114182, "creation_date": 1513114182, "answer_id": 47781869, "question_id": 47781485, "link": "https://stackoverflow.com/questions/47781485/how-to-fill-an-array-with-strings-in-vba-and-get-its-lengh/47781869#47781869", "title": "How to fill an array with strings in VBA and get its lengh?", "body": "<p>you can read entire excel range to array, its much faster than reading data from range cell by cell.</p>\n\n<pre><code>    Sub testRerad()\n\n        Dim arr As Variant 'no brackets needed, I prefer to use variant\n        Dim numOfRows As Long, numOfCols As Long\n        arr = Sheets(1).Cells(1).Resize(10, 1).value 'arr will contain data from range A1:A10\n\n        'or\n        arr = Sheets(1).Range(\"A1\").CurrentRegion.value 'arr will contain data from all continous data startig with A1\n\n        'get dimensions\n        numOfRows = UBound(a)\n        numOfCols = UBound(a, 2)\n\n    End Sub\n</code></pre>\n\n<p>be warned that this will always create multidimensional array (even if only 1 column) with dimensions 1 to y, 1 to x</p>\n"}], "owner": {"reputation": 81, "user_id": 9089179, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d702e3cc9c80c3345dbf474508d8a80b?s=128&d=identicon&r=PG&f=1", "display_name": "alex ", "link": "https://stackoverflow.com/users/9089179/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2524, "favorite_count": 0, "accepted_answer_id": 47781815, "answer_count": 2, "score": 0, "last_activity_date": 1532607606, "creation_date": 1513112601, "last_edit_date": 1532607606, "question_id": 47781485, "link": "https://stackoverflow.com/questions/47781485/how-to-fill-an-array-with-strings-in-vba-and-get-its-lengh", "title": "How to fill an array with strings in VBA and get its lengh?", "body": "<p>How to fill an array with strings in VBA and get its lengh?</p>\n\n<p>For example two cells might contain this info:</p>\n\n<p>A1: \"test 1\"\nA2: \"test 2\"</p>\n\n<pre><code>Dim example As String\nDim arreglito() As String\n\nexample = Range(\"A2\").Value\n\n\narreglito(0) = example\nexample= Range(\"A1\").Value\narreglito(1)= example \nMsgBox arreglito(0)\n</code></pre>\n\n<blockquote>\n  <p>subscript out of range</p>\n</blockquote>\n\n<pre><code>Dim example As String\nDim arreglito() As Variant\n\nexample = Range(\"A2\").Value\n\narreglito(0) = example\nMsgBox arreglito(0)\n</code></pre>\n\n<blockquote>\n  <p>subscript out of range</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 1, "creation_date": 1513112322, "post_id": 47781303, "comment_id": 82524212, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23118877/save-as-pdf-in-landscape\">Save as PDF in Landscape</a>"}, {"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 1, "creation_date": 1513112413, "post_id": 47781303, "comment_id": 82524250, "body": "you control most of the layout via it&#39;s PageSetup"}], "answers": [{"tags": [], "owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "is_accepted": true, "score": 1, "last_activity_date": 1513272974, "last_edit_date": 1513272974, "creation_date": 1513272569, "answer_id": 47819043, "question_id": 47781303, "link": "https://stackoverflow.com/questions/47781303/export-excel-graphs-to-horizontal-pdf-with-vba/47819043#47819043", "title": "Export excel graphs to horizontal PDF with VBA", "body": "<p>I also had similar problems with generating PDFs from charts. The solution is to use <code>ChartObject</code> instead of <code>Shape</code>, and use <code>.CopyImage</code> to get a picture of the chart instead of trying to copy the actual chart. So the code would look more like:</p>\n\n<pre><code>Dim chrt as ChartObject\n:\nFor Each chrt in ws.ChartObjects\n    chrt.CopyPicture\n    wsTemp.Paste\n    Selection.Top = tp\n    Selection.Left = ts\n    ts = ts + Selection.Width + 50\n Next\n</code></pre>\n\n<p>Then you should also set the print area in the worksheet, and the page setup to paginate the document how you want the pdf to appear - use landscape format (if that's what you mean by \"horizontal\"). Have you got more charts than will fit on a page? If so, you will need to check the cumulative width to ensure that the charts do not cross page boundaries.</p>\n"}], "owner": {"reputation": 485, "user_id": 5909014, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2f34660508b40bc4653e766482d49c44?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriela M", "link": "https://stackoverflow.com/users/5909014/gabriela-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 47819043, "answer_count": 1, "score": 0, "last_activity_date": 1513272974, "creation_date": 1513111773, "question_id": 47781303, "link": "https://stackoverflow.com/questions/47781303/export-excel-graphs-to-horizontal-pdf-with-vba", "title": "Export excel graphs to horizontal PDF with VBA", "body": "<p>I have the following VBA code that basically takes the graphs from an excel workbook's sheet and paste them into a PDF document:</p>\n\n<pre><code>Sub Graphics()\n\n    Dim s As Workbook\n    Dim ws As Worksheet, wsTemp As Worksheet\n    Dim chrt As Shape\n    Dim tp As Long\n    Dim File As String\n    Dim NewFileName As String\n    Dim Path As String\n\n    Application.DisplayAlerts = False\n\n    Application.ScreenUpdating = False\n\n    'Here I define where the excel file is:\n    SourcePath = \"\\\\ukfs1\\users\\gabriem\\Documents\\Misproyectos\\BigPromotions\\QAPromo\"\n\n    'Name of excel file that contains the graphs:\n    File = \"graphicator.xlsx\"\n\n    'Open the excel file:\n    Set s = Workbooks.Open(SourcePath &amp; \"\\\" &amp; File)\n\n    'Name of the PDF I will create with the excel graphs:\n    NewFileName = \"\\\\ukfs1\\users\\gabriem\\Documents\\Mis proyectos\\BigPromotions\\QAPromo\\test_pdf.pdf\"\n\n    'Name of the excel sheet I want to export to PDF:\n    Set ws = s.Sheets(\"Negocios\")\n\n    Set wsTemp = s.Sheets.Add\n\n    tp = 2\n    ts = 5\n\n    'Copy-Pasting process:\n    With wsTemp\n        For Each chrt In ws.Shapes\n            chrt.Copy\n            wsTemp.Range(\"A1\").PasteSpecial\n            Selection.Top = tp\n            Selection.Left = ts\n            tp = tp + Selection.Height + 50\n        Next\n    End With\n\n    wsTemp.ExportAsFixedFormat Type:=xlTypePDF, Filename:=NewFileName, Quality:=xlQualityStandard, _\n       IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\n    wsTemp.Delete\n\n LetsContinue:\n    With Application\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n    End With\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume LetsContinue\n\nEnd Sub\n</code></pre>\n\n<p>Although the code works fine, the output it generates is not graphically adequate because many of the graphs were cut (half of them were in another page). So, I I want the generated PDF to be horizontal, but have not been able to find an answer. Is not a problem from the excel but from the new PDF the VBA code creates:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UblkM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UblkM.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/yudGc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yudGc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you very much!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513111515, "post_id": 47781088, "comment_id": 82523825, "body": "How comfortable are you with using regular expressions for this?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1513111575, "post_id": 47781088, "comment_id": 82523851, "body": "One problem is that <code>*.USA.Taco.*</code> also matches <code>*.USA.*</code>, so you need to put the taco first. But IMO life would be simpler with regex."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513111929, "post_id": 47781088, "comment_id": 82524032, "body": "Question: why are you iterating 348 rows if at the end of the day you&#39;re only ever adding 3 addresses? Does any of these instructions mean to concatenate <code>cell.Value</code> into <code>toCC</code> at any point?"}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513112364, "post_id": 47781088, "comment_id": 82524234, "body": "Hi @Mat&#39;sMug. Yes, it does need to concatenate. Essentially it checks one column to see if any of the above strings exist. If they do, it then adds the relevant email to the string toCC. Ideally, it would match each once so that there wouldn&#39;t be duplicates, too.   I have never used regex before."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513113108, "post_id": 47781088, "comment_id": 82524581, "body": "Ok, looks like you took away too much of the code then. Please <a href=\"https://stackoverflow.com/posts/47781088/edit\">edit</a> your question so that <code>cell.Value</code> is getting concatenated into <code>toCC</code>. Is the range located in a <code>ListObject</code> / table? Because if so the code can be made tremendously more expressive and robust."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513113545, "post_id": 47781088, "comment_id": 82524767, "body": "I&#39;ve given you an answer that would fix the matching problem, ignoring the missing concatenation issue."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513113789, "post_id": 47781088, "comment_id": 82524872, "body": "@Mat&#39;sMug, my mistake. It does not concatenate. Rather, each new email address is added in as it loops through the relevant columns. I&#39;ve updated the code above to better highlight this. All of the information being pulled/referenced exists in an exported spreadsheet, so I do not have anything changing or updating in the sheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513113899, "post_id": 47781088, "comment_id": 82524921, "body": "So... just to be clear: you&#39;re ultimately building a list of 348 emails, 3 of which are unique. IOW worst-case all rows match condition 1 and <code>USA@email.com</code> gets 348 copies of the same email? That can&#39;t be right..."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513114039, "post_id": 47781088, "comment_id": 82524975, "body": "In essence, yes. And it did not dawn on me until I started adding more email addresses to the test sheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1513114695, "post_id": 47781088, "comment_id": 82525283, "body": "I&#39;ve edited my answer to leverage a keyed <code>Collection</code> to ensure uniqueness, and illustrate how to use <code>Join</code> to <i>join</i> array elements with a delimiter. Note that doing that removes the superfluous <code>;</code> you have at the beginning of your final <code>toCC</code> string."}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "edited": false, "score": 0, "creation_date": 1513183047, "post_id": 47781687, "comment_id": 82556944, "body": "Morning @Mat&#39;sMug! I can&#39;t seem to get it to work. I&#39;ve tried setting AddUniqueItemToCollection as its own Private procedure, as well as adding it to the my current procedure, both to no avail."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1513114602, "last_edit_date": 1513114602, "creation_date": 1513113480, "answer_id": 47781687, "question_id": 47781088, "link": "https://stackoverflow.com/questions/47781088/differentiate-between-different-strings-and-fill-strings-in-vba/47781687#47781687", "title": "Differentiate between different strings and fill strings in VBA?", "body": "<p>Here's the problem:</p>\n\n<pre><code>If cell.Value Like \"*.USA.*\" Then 'This is the first one\n    '...\n'...\n    '...\nElseIf cell.Value Like \"*.USA.Taco.*\" Then 'This is the second\n    '...\nEnd If\n</code></pre>\n\n<p>if <code>cell.Value</code> matches <code>*.USA.Taco.*</code>, then it <em>also</em> matches <code>*.USA.*</code>, and given how you've ordered the conditions, if anything matches <code>*.USA.*</code> then it doesn't matter what else it matches, because everything else is in an <code>ElseIf</code> block.</p>\n\n<p>Flip them around: verify that <code>cell.Value</code> matches <code>*.USA.Taco.*</code> <em>before</em> you check if it matches <code>*.USA.*</code>:</p>\n\n<pre><code>If cell.Value Like \"*.USA.Taco.*\" Then\n    '...\nElseIf cell.Value Like \"*.USA.*\" Then\n    '...\nElseIf cell.Value Like \"*.Burrito.*\" Then\n    '...\nEnd If\n</code></pre>\n\n<hr>\n\n<p>You'll want to only list each recipient <strong>once</strong> - nobody wants to receive 300 times the same email (assuming their mail server doesn't just block the sender).</p>\n\n<p>Instead of building a string like this, make a keyed collection:</p>\n\n<pre><code>Dim ccRecipients As Collection\nSet ccRecipients = New Collection\n\nIf cell.Value Like ...\n    ccRecipients.Add \"USA@email.com\", Key:=\"USA@email.com\"\nElseIf cell.Value Like ...\n    ccRecipients.Add \"Durr@ito.com\", Key:=\"Durr@ito.com\"\n...\n</code></pre>\n\n<p>This will throw an error when a duplicate address is added to the collection. So make a dedicated procedure to do it safely:</p>\n\n<pre><code>Private Sub AddUniqueItemToCollection(ByVal value As String, ByVal items As Collection)\n    On Error Resume Next\n    items.Add value, key:=value\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>And then invoke it:</p>\n\n<pre><code>Dim ccRecipients As Collection\nSet ccRecipients = New Collection\n\nIf cell.Value Like ...\n    AddUniqueItemToCollection \"USA@email.com\", ccRecipients\nElseIf cell.Value Like ...\n    AddUniqueItemToCollection \"Durr@ito.com\", ccRecipients\n...\n</code></pre>\n\n<p>Then you can iterate the unique items in the collection, to add them to an array:</p>\n\n<pre><code>ReDim ccAddresses(0 To ccRecipients.Count - 1)\n\nDim ccAddress As Variant, ccItem As Long\nFor Each ccAddress In ccRecipients\n    ccAddresses(ccItem) = CStr(ccAddress)\n    ccItem = ccItem + 1\nNext\n</code></pre>\n\n<p>And now you can use <code>Join</code> to build the final list of recipients and separate each one with a semicolon:</p>\n\n<pre><code>Dim sendToCC As String\nsendToCC = Join(ccAddresses, \";\")\n</code></pre>\n\n<p>That way you won't be spamming anyone's inbox!</p>\n"}], "owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 47781687, "answer_count": 1, "score": 2, "last_activity_date": 1513114602, "creation_date": 1513110794, "last_edit_date": 1513113771, "question_id": 47781088, "link": "https://stackoverflow.com/questions/47781088/differentiate-between-different-strings-and-fill-strings-in-vba", "title": "Differentiate between different strings and fill strings in VBA?", "body": "<p>I have two strings that I need to differentiate between. They both have text before and after, and I can't seem to figure out how to make it find each string and parse out its relevant information.</p>\n\n<pre><code>Dim cell As Range\nDim toPrimary As String\nDim toCC As String  \n\nFor Each cell In Range(\"A2:A350\")\n    If cell.Value Like \"*.USA.*\" Then 'This is the first one\n        toCC = toCC &amp; \";\" &amp; \"USA@email.com\"\n    ElseIf cell.Value Like \"*.Burrito.*\" Then\n        toCC = toCC &amp; \";\" &amp; \"Durr@ito.com\"\n    ElseIf cell.Value Like \"*.USA.Taco.*\" Then 'This is the second\n        toCC = toCC &amp; \";\" &amp; \"taco@bell.com\"\n    End If\nNext\n</code></pre>\n\n<p>I am expecting that <em>.USA.</em> and <em>.USA.Taco.</em> will fill the toCC field with different information. If it makes any difference, <em>.USA.</em> only has three characters afterward (i.e., <em>.USA.Pie.</em>), whereas <em>.USA.Taco.</em> has that same string 'Taco' after 'USA.'</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1513110674, "post_id": 47781025, "comment_id": 82523417, "body": "What do you mean by &quot;extract&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513114790, "post_id": 47781232, "comment_id": 82525321, "body": "FWIW, in the OP&#39;s <b>specific case</b> there is no difference between <code>For Each rngCell In rng.Cells</code> and <code>For Each rngCell In rng</code>.  But if <code>rng</code> was set as <code>Set rng = Sheets(&quot;AllAccounts (12-05-2017)&quot;).Range(&quot;D1:D1613&quot;).EntireRow</code> (for instance), there would be a difference - using just <code>In rng</code> would set <code>rngCell</code> to be each row, while using <code>In rng.Cells</code> would set <code>rngCell</code> to be each cell.  It is usually safest to always use the <code>rng.Cells</code> approach so that there is no ambiguity."}, {"owner": {"reputation": 23, "user_id": 9090702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cdd1eb3ba68a2d4e992d65d013de60?s=128&d=identicon&r=PG&f=1", "display_name": "Ameture", "link": "https://stackoverflow.com/users/9090702/ameture"}, "edited": false, "score": 0, "creation_date": 1513116293, "post_id": 47781232, "comment_id": 82525881, "body": "For some reason this code doesn&#39;t work on my MacBook. I get ActiveX error, can you please help?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 23, "user_id": 9090702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cdd1eb3ba68a2d4e992d65d013de60?s=128&d=identicon&r=PG&f=1", "display_name": "Ameture", "link": "https://stackoverflow.com/users/9090702/ameture"}, "edited": false, "score": 0, "creation_date": 1513116609, "post_id": 47781232, "comment_id": 82526012, "body": "@Ameture AFAIK - Microsoft&#39;s Scripting Runtime isn&#39;t available on Macs, so you won&#39;t be able to use a Dictionary.  But I guess that explains the (slightly inappropriate) [macos] tag.  I will edit your tags to say [excel-vba-mac] so that people know you <b>are</b> looking for a Mac solution."}, {"owner": {"reputation": 23, "user_id": 9090702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cdd1eb3ba68a2d4e992d65d013de60?s=128&d=identicon&r=PG&f=1", "display_name": "Ameture", "link": "https://stackoverflow.com/users/9090702/ameture"}, "edited": false, "score": 1, "creation_date": 1513130403, "post_id": 47781232, "comment_id": 82530226, "body": "So I added this line <code>Sheets(&quot;WorkSheet&quot;).Range(&quot;A&quot; &amp; Value2).Value = Sheets(&quot;AllAccounts (12-05-2017)&quot;).Range(&quot;A&quot; &amp; Value2).Value</code> to get the original line and the duplicate line into a different sheet. I added this code right after this line <code>Sheets(&quot;AllAccounts (12-05-2017)&quot;).Cells(Col(rngCell.Value2), &quot;K&quot;).Interior.Color = RGB(180, 230, 180)</code>, but I get an error. Your code is awesome! Thank you!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1513130616, "post_id": 47781232, "comment_id": 82530278, "body": "<a href=\"https://github.com/VBA-tools/VBA-Dictionary\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-Dictionary</a>   Drop-in replacement for Scripting.Dictionary on Mac"}, {"owner": {"reputation": 23, "user_id": 9090702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cdd1eb3ba68a2d4e992d65d013de60?s=128&d=identicon&r=PG&f=1", "display_name": "Ameture", "link": "https://stackoverflow.com/users/9090702/ameture"}, "edited": false, "score": 0, "creation_date": 1513144684, "post_id": 47781232, "comment_id": 82533929, "body": "Thank you very much! but for my learning purpose, how do I manipulate the code so I can set it to check for duplicates from a different column (i.e. &#39;K&#39;) or to copy more row fields than just A - D?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1513151007, "post_id": 47781232, "comment_id": 82536620, "body": "Just change your <code>rng</code> variable. Honestly, there are probably better ways using temp sheets and just sorting your data while reading through it. Then you just check to see if the row below is the same value (duplicate) - it depends on what you need to do. As for different columns, change the <code>Offset</code> and <code>Resize</code>. If you&#39;d like, I can go through and comment each line of code."}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 4, "last_activity_date": 1568822388, "last_edit_date": 1568822388, "creation_date": 1513111461, "answer_id": 47781232, "question_id": 47781025, "link": "https://stackoverflow.com/questions/47781025/identifying-duplicates-in-excel/47781232#47781232", "title": "Identifying Duplicates in Excel", "body": "<p>You don't need to put <code>rng.Cells</code> - the <code>.Cells</code> is implied - just use <code>rng</code></p>\n\n<p>(^ This is semantics - do whatever you want)</p>\n\n<p>Instead of checking <code>rngCell.Text</code> - try <code>rngCell.Value</code>.</p>\n\n<p><code>.Text</code> <a href=\"https://fastexcel.wordpress.com/2011/11/30/text-vs-value-vs-value2-slow-text-and-how-to-avoid-it/\" rel=\"nofollow noreferrer\">is incredibly slow.</a></p>\n\n<p>^ Really, based on this, should probably use <code>.Value2</code> instead of <code>.Value</code> for maximum speeeeeeed!</p>\n\n<p>Of course, if we are that concerned, we would <a href=\"https://fastexcel.wordpress.com/2011/10/26/match-vs-find-vs-variant-array-vba-performance-shootout/\" rel=\"nofollow noreferrer\">use a variant array</a>, but let's keep it simple.</p>\n\n<p>Also, idk why you use <code>xlThemeColorAccentz</code> and <code>ColorIndex</code></p>\n\n<p>This may work, but it doesn't work for me - I would just use <code>RGB</code></p>\n\n<p>You're doing a <code>CountIf</code> on the range which is sort of meh.</p>\n\n<p>As for checking duplicates,\nI would recommend using a <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">dictionary</a> for this purpose.</p>\n\n<pre><code>Dim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n</code></pre>\n\n<p>Your code becomes:</p>\n\n<pre><code>Sub MarkDuplicates()\nDim iWarnColor As Long\nDim rng As Range\nDim rngCell As Variant\nDim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\nSet rng = Sheets(\"AllAccounts (12-05-2017)\").Range(\"D1:D1613\")\n\nrng.Interior.ColorIndex = xlNone 'Optionally clear all coloring\niWarnColor = RGB(230, 180, 180)  'Red\n\nFor Each rngCell In rng\n    If rngCell.Value &lt;&gt; \"\" Then 'Ignore blank cells\n        If Not dict.Exists(rngCell.Value) Then\n            dict.Add rngCell.Value, rngCell.Row 'Store the row if we want\n        Else\n            rngCell.Interior.Color = iWarnColor\n            'Optionally color the original cell:\n            'Sheets(\"AllAccounts (12-05-2017)\").Cells(dict(rngCell.Value), \"D\").Interior.Color = RGB(180, 230, 180)\n        End If\n    End If\nNext rngCell\nEnd Sub\n</code></pre>\n\n<p>Results with optional coloring:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kQ1U4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kQ1U4.png\" alt=\"Results\"></a></p>\n\n<p><strong>Edit (Not Using Dictionary):</strong></p>\n\n<p>So, you're using a mac - oh wellz.</p>\n\n<p>I didn't mention it before, but you can use conditional formatting to solve this.</p>\n\n<p>Anyway, let's just use a collection.</p>\n\n<p>A collection works a lot like a dictionary, but we typically have to loop through it to determine if a particular Key/Value pair exists.</p>\n\n<p>We can cheat this by trying to get a value for a key that doesn't exist and catch the error - I added a function to simplify this process.</p>\n\n<pre><code>Sub MarkDuplicates()\nDim iWarnColor As Long\nDim rng As Range\nDim rngCell As Variant\nDim Col As New Collection\nSet rng = Sheets(\"AllAccounts (12-05-2017)\").Range(\"D1:D1613\")\nrng.Interior.ColorIndex = xlNone\niWarnColor = RGB(230, 180, 180)\nFor Each rngCell In rng\n    If rngCell.Value &lt;&gt; \"\" Then 'Ignore blank cells\n        If Not IsInCollection(Col, rngCell.Value2) Then\n            Col.Add rngCell.Row, Key:=rngCell.Value2\n        Else\n            rngCell.Interior.Color = iWarnColor\n            'Optionally color the original cell\n            Sheets(\"AllAccounts (12-05-2017)\").Cells(Col(rngCell.Value2), \"D\").Interior.Color = RGB(180, 230, 180)\n        End If\n    End If\nNext rngCell\nEnd Sub\nFunction IsInCollection(Col As Collection, Val As Variant) As Boolean\n    On Error Resume Next\n    Debug.Print (Col(Val))\n    IsInCollection = (Err.Number = 0)\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>New Results (The Same):</p>\n\n<p><a href=\"https://i.stack.imgur.com/o6Wc1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o6Wc1.png\" alt=\"Collections\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1513736968, "creation_date": 1513736968, "answer_id": 47897961, "question_id": 47781025, "link": "https://stackoverflow.com/questions/47781025/identifying-duplicates-in-excel/47897961#47897961", "title": "Identifying Duplicates in Excel", "body": "<p>I suppose there are several ways to do this.  Here is one.</p>\n\n<pre><code>Option Explicit\n\nSub FilterAndCopy()\n\nDim wstSource As Worksheet, _\n    wstOutput As Worksheet\nDim rngMyData As Range, _\n    helperRng As Range\n\nSet wstSource = Worksheets(\"Sheet1\")\nSet wstOutput = Worksheets(\"Sheet2\")\n\nApplication.ScreenUpdating = False\n\nWith wstSource\n    Set rngMyData = .Range(\"A1:XF\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row)\nEnd With\nSet helperRng = rngMyData.Offset(, rngMyData.Columns.Count + 1).Resize(, 1)\n\nWith helperRng\n    .FormulaR1C1 = \"=if(countif(C1,RC1)&gt;1,\"\"\"\",1)\"\n    .Value = .Value\n    .SpecialCells(xlCellTypeBlanks).EntireRow.Copy Destination:=wstOutput.Cells(1, 1)\n    .ClearContents\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9090702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cdd1eb3ba68a2d4e992d65d013de60?s=128&d=identicon&r=PG&f=1", "display_name": "Ameture", "link": "https://stackoverflow.com/users/9090702/ameture"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 47781232, "answer_count": 2, "score": 2, "last_activity_date": 1593586484, "creation_date": 1513110550, "last_edit_date": 1593586484, "question_id": 47781025, "link": "https://stackoverflow.com/questions/47781025/identifying-duplicates-in-excel", "title": "Identifying Duplicates in Excel", "body": "<p>I'm trying to identify duplicate cells in a macro. I'm trying to use macros so I can extract the entire row once the duplicate is identified.</p>\n\n<p>I used this code:</p>\n\n<pre><code>Sub MarkDuplicates()\nDim iWarnColor As Integer\nDim rng As Range\nDim rngCell As Variant\n\n\nSet rng = Sheets(\"AllAccounts (12-05-2017)\").Range(\"D1:D1613\") \niWarnColor = xlThemeColorAccentz\n\nFor Each rngCell In rng.Cells\n    vVal = rngCell.Text\n    If (WorksheetFunction.CountIf(rng, vVal) = 1) Then\n        rngCell.Interior.Pattern = xlNone\n    Else\n        rngCell.Interior.ColorIndex = iWarnColor\n    End If\nNext rngCell\nEnd Sub\n</code></pre>\n\n<p>but it only identified empty cells. At the moment I'm trying to only identify duplicate text and I'll extract them later. </p>\n\n<p>Can you please help me do that?</p>\n"}, {"tags": ["excel", "vba", "sumifs"], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 9086188, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/038d12c507d0067c56dc6ea8cd28330f?s=128&d=identicon&r=PG", "display_name": "AmBo", "link": "https://stackoverflow.com/users/9086188/ambo"}, "is_accepted": false, "score": 0, "last_activity_date": 1513115866, "creation_date": 1513115866, "answer_id": 47782216, "question_id": 47781020, "link": "https://stackoverflow.com/questions/47781020/need-help-editing-sumif-macro-to-automatically-update-and-go-to-next-row/47782216#47782216", "title": "Need help editing sumif macro to automatically update and go to next row", "body": "<p>You dont need VBA for this, you could use a data table to update the formula with each new row. How were you expecting to trigger the macro ?</p>\n\n<p>Type the formula manually, recorder is messing with your ranges.</p>\n\n<p>When working on multiple spreadsheet, naming the ranges might come in handy.</p>\n\n<p>Be aware that your values will not update if \"CPI Project Cost Update.xlsx\" is closed as you are using a SUMIFS.</p>\n"}], "owner": {"reputation": 31, "user_id": 8226564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/20d586d4631d139310d72aac42922e5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/8226564/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513115866, "creation_date": 1513110538, "last_edit_date": 1513110622, "question_id": 47781020, "link": "https://stackoverflow.com/questions/47781020/need-help-editing-sumif-macro-to-automatically-update-and-go-to-next-row", "title": "Need help editing sumif macro to automatically update and go to next row", "body": "<p>I have tried recording a macro that will update a sumifs formula based on two criteria, and i would like for it to move onto the next row and past the sumifs with it updating for that row.It may be helpful to note the criteria range and sum range are being pulled from a separate excel file.I cannot seem to get my code to work for more than one row. Here is my code:</p>\n\n<pre><code> Sub Sumifmacro()\n    '\n    ' Sumifmacro Macro\n    '\n    '\n    Range(\"N154\").Select\n    ActiveCell.FormulaR1C1 = _\n    \"=SUMIFS('[CPI Project Cost Update.xlsx]PROJECT COSTING'!C24, '[CPI \n    Project Cost Update.xlsx]PROJECT COSTING'!C1, \"\"February\"\", '[CPI \n    Project Cost Update.xlsx]PROJECT COSTING'!C12, \"\"5395b\"\")\"\n    Range(\"N155\").Select\n    End Sub\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1513111506, "creation_date": 1513111506, "answer_id": 47781237, "question_id": 47780913, "link": "https://stackoverflow.com/questions/47780913/reference-an-unknown-value-to-autopopulate-new-rows/47781237#47781237", "title": "Reference an unknown value to autopopulate new rows", "body": "<p>You should look up the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196611.aspx\" rel=\"nofollow noreferrer\">Workbook_SheetChange</a> event. It will run any code placed within it when a change is made in a worksheet. You can specify within that function to only update a certain range(s) on the right when a change occurs within a certain range on the left.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1513112999, "last_edit_date": 1513112999, "creation_date": 1513112687, "answer_id": 47781501, "question_id": 47780913, "link": "https://stackoverflow.com/questions/47780913/reference-an-unknown-value-to-autopopulate-new-rows/47781501#47781501", "title": "Reference an unknown value to autopopulate new rows", "body": "<p>In the sheet containing the data (here it is sheet called Target - change as appropriate) have the following code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not IsEmpty(Target) And Target.Column = 1 And Target.Row &gt; 1 Then\n\n        Dim wb As Workbook\n        Dim ws As Worksheet\n\n        Set wb = ThisWorkbook\n        Set ws = wb.Worksheets(\"Target\")\n\n        Dim lastSourceRow As Long\n        Dim lastTargetRow As Long\n\n        lastSourceRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n        NextTargetRow = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row + 1\n\n        With ws.Cells(NextTargetRow, \"D\")\n\n            .Resize(3, 1).Value = ws.Cells(lastSourceRow, \"A\")\n            .Offset(, 1) = \"Blue\"\n            .Offset(, 2) = \"45\"\n            .Offset(1, 1) = \"Big\"\n            .Offset(1, 2) = \"20\"\n            .Offset(2, 1) = \"Cold\"\n            .Offset(2, 2) = \"5\"\n\n        End With\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9090741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec8647419da2a7d33c06839bcff9e1a?s=128&d=identicon&r=PG&f=1", "display_name": "S. Will", "link": "https://stackoverflow.com/users/9090741/s-will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513112999, "creation_date": 1513110113, "question_id": 47780913, "link": "https://stackoverflow.com/questions/47780913/reference-an-unknown-value-to-autopopulate-new-rows", "title": "Reference an unknown value to autopopulate new rows", "body": "<p>I am trying to find a solution when a user inserts a new row in a list, that will be referenced to automatically populate multiple rows in a separate list. The part on the right should autopopulate as users add additional rows on the left (e.g. asset numbers). Additionally, the asset attribute and asset value are repeating and the same for each new asset number. Any thoughts? <a href=\"https://i.stack.imgur.com/jTbT4.png\" rel=\"nofollow noreferrer\">Before and after</a></p>\n\n<p>(This is my first question so hopefully I'm doing it right! Thanks for your understanding and patience!)</p>\n"}, {"tags": ["excel", "hyperlink", "vba"], "owner": {"reputation": 11, "user_id": 9090746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc6536af79a90f15fe1c23ba47fd826?s=128&d=identicon&r=PG&f=1", "display_name": "livinthdream", "link": "https://stackoverflow.com/users/9090746/livinthdream"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513110085, "creation_date": 1513110085, "last_edit_date": 1531164843, "question_id": 47780909, "link": "https://stackoverflow.com/questions/47780909/order-of-the-workbook-linksources-method-arrary-in-excel", "title": "Order of the Workbook.LinkSources Method Arrary in Excel", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-linksources-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-linksources-method-excel</a></p>\n\n<p>The link states that the Workbook.Linksources Method returns the name of the link source in array. How is the array organized? Are the link names alphabetical?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1513108437, "post_id": 47780510, "comment_id": 82522287, "body": "Put a breakpoint on the first line, step through it, and see what it does then."}, {"owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1513109137, "post_id": 47780510, "comment_id": 82522673, "body": "That did it! Thanks. Spelling error."}], "owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513108793, "creation_date": 1513108309, "last_edit_date": 1513108793, "question_id": 47780510, "link": "https://stackoverflow.com/questions/47780510/userform-checkboxes-code-error", "title": "Userform Checkboxes Code Error", "body": "<p>Below is the code I am attempting. I thought it was simple enough, but I fear my ignorance is my undoing. The code checks to see if a checkbox is true on sheet \"A\", then unhides Sheet \"C\" and puts a specific value into sheet \"B\". When I click the box, nothing happens.</p>\n\n<pre><code>Sub CheckBox164_Click()\n\n    If CheckBox164.Value = True Then\n\n        Active.Workbook.Unprotect\n\n        Sheets(\"00 00 01\").Visible = -1\n        Worksheets(\"Summary\").Cells(8, 2).Value = \"GENERAL CONDITIONS\"\n\n        Active.Workbook.Protect True, True\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 3047983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b362abe9d7040d0afce9dad1e5b00e79?s=128&d=identicon&r=PG&f=1", "display_name": "user3047983", "link": "https://stackoverflow.com/users/3047983/user3047983"}, "edited": false, "score": 0, "creation_date": 1513165720, "post_id": 47781126, "comment_id": 82545513, "body": "That worked perfectly as I wanted it to! Thank you for making it simple, I can easily follow what you did and understand it better now. I appreciate your help very much."}], "tags": [], "owner": {"reputation": 177, "user_id": 6745484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n4C1w.png?s=128&g=1", "display_name": "RJ Kelly", "link": "https://stackoverflow.com/users/6745484/rj-kelly"}, "is_accepted": true, "score": 3, "last_activity_date": 1513110970, "creation_date": 1513110970, "answer_id": 47781126, "question_id": 47780298, "link": "https://stackoverflow.com/questions/47780298/vba-to-create-dynamic-named-ranges/47781126#47781126", "title": "VBA to Create Dynamic Named Ranges", "body": "<p>This is a quick thrown together script to provide the idea of how to approach this. By no means is it pretty, but does show the steps. This can be a lot more complexly written, ie to work with all cells, not start after the first instance of names (See Range(\"B3\") for start, and Range(\"B4\") for starting the looping of cells)</p>\n\n<pre><code>Sub DefineRanges()\n    Dim rngStart As Range\n    Set rngStart = Range(\"B3\")\n    Dim NamedRangeCount As Integer\n    NamedRangeCount = 0\n    Dim NameRangeName As String\n    Dim LastRow As Integer\n    For Each cell In Range(\"B4:B18\")\n        If LCase(Left(cell.Value, 5)) = \"names\" Then\n            NameRangeName = \"Name_\" &amp; NamedRangeCount\n            ActiveWorkbook.Names.Add Name:=NameRangeName, RefersToLocal:=Range(rngStart.Address &amp; \":D\" &amp; cell.Row - 1)\n            Set rngStart = Range(\"B\" &amp; cell.Row)\n            NamedRangeCount = NamedRangeCount + 1\n        End If\n        LastRow = cell.Row\n    Next\n    NameRangeName = \"Name_\" &amp; NamedRangeCount\n    ActiveWorkbook.Names.Add Name:=NameRangeName, RefersToLocal:=Range(rngStart.Address &amp; \":D\" &amp; LastRow)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3047983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b362abe9d7040d0afce9dad1e5b00e79?s=128&d=identicon&r=PG&f=1", "display_name": "user3047983", "link": "https://stackoverflow.com/users/3047983/user3047983"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5029, "favorite_count": 0, "accepted_answer_id": 47781126, "answer_count": 1, "score": 0, "last_activity_date": 1513110970, "creation_date": 1513107488, "last_edit_date": 1531161705, "question_id": 47780298, "link": "https://stackoverflow.com/questions/47780298/vba-to-create-dynamic-named-ranges", "title": "VBA to Create Dynamic Named Ranges", "body": "<p>I am trying to create named ranges of cells named after the top left cell in each range. This shows what I mean:\n<a href=\"https://i.stack.imgur.com/PTtrt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PTtrt.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here, I want to have 4 named ranges (Names A, Names B, Names C, Names D) so I can reference them. Is there a way to have excel look for any cell in Column B that starts with \"Names\" and have it cut off the range when it hits the next cell that starts with \"Names\"? I apologize if this is not possible, I am still new to excel and not sure if this is doable. Any help is appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1513107159, "post_id": 47780164, "comment_id": 82521584, "body": "Take a look onto <a href=\"https://stackoverflow.com/questions/12527725/how-to-create-a-range-from-2-ranges-in-vba\" title=\"how to create a range from 2 ranges in vba\">stackoverflow.com/questions/12527725/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513107488, "post_id": 47780164, "comment_id": 82521755, "body": "Make sure your pseudo syntax has a worksheet specified. If sh1 is a sheet in wbk3 then wbk3 is a workbook and you can&#39;t  have workbook.range e.g. wbk3.Range(&quot;B2:D8&quot;)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513107501, "post_id": 47780164, "comment_id": 82521759, "body": "So you want to zeroise the contents of wbk1, then loop through the other workbooks (wbk2, wbk3, possibly wbk4, etc) adding the values to whatever is in wbk1.  So is the issue that you don&#39;t know how to zeroise the values?  Or how to loop through the workbooks?  Or how to loop through the rows/columns? Or how to access the value in a cell? Or how to add two numbers? Or how to write a number to a cell?"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513107926, "post_id": 47780164, "comment_id": 82521989, "body": "@QHarr, my bad, I put the wrong characters there.  I meant to denote the worksheet"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513108050, "post_id": 47780164, "comment_id": 82522051, "body": "@YowE3K, I simply need to combine the ranges in worksheets 2 and 3 and add them to 1.  I believe the question is rather clear; I just need some assistance with writing the loop correctly as I have not been able to do so."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513108194, "post_id": 47780164, "comment_id": 82522132, "body": "Well paste into the question the code you already have, and change the question to say that you are unsure how to loop from row 2 to 8 and column 2 to 4 and then that becomes an &quot;answerable&quot; question.  At the moment the question is too broad because it requires an answer to solve about a dozen things."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1513108272, "post_id": 47780164, "comment_id": 82522179, "body": "I would disagree with the question being clear from my perspective. Why not try bullet pointing what should happen in terms of events and check the flow of events seems logical and has the appropriate actions and objects specified."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513113823, "post_id": 47780164, "comment_id": 82524887, "body": "Without seeing your code setting up the objects used in the line that is failing, it will be impossible to work out which object doesn&#39;t exist."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1513185500, "post_id": 47780164, "comment_id": 82558612, "body": "I have included all of the code used here.  I know it is a lot, so hopefully it is clear.  Thank you"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513190538, "post_id": 47780164, "comment_id": 82561200, "body": "Your statement is failing because you haven&#39;t declared or defined <code>snowq</code> and <code>qual</code> in your <code>ReportCombiner</code> procedure.  You have declared (with local scope) and defined <code>snowq</code> as a <code>Workbook</code> in your <code>ServiceNowQualityReport</code> procedure.  And you have declared (with local scope) and defined <code>qual</code> as a <code>Worksheet</code> in your <code>ServiceNowQualityReport</code> procedure and as a <code>Range</code> in your <code>CAQualityReport</code> procedure.  (And, as far as I can tell from your code, I don&#39;t think you have any &quot;qsum&quot; worksheets in any of your workbooks.)"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1513196099, "post_id": 47780164, "comment_id": 82564000, "body": "Okay, I understand what you are saying.  I fixed this by adding <code>Dim snowq As Workbook, CAQual As Workbook</code> (the correct workbook name for the second procedure is CAQual, not qual, which of course was not helping the situation...I also updated the statement with the correct name).  However, I now get a run-time error 91, which states that an object variable is not set.  From what it looks like, everything is set, or so it appears... (The actual sheets where the data is pulled from are both set as qsum; since they are different books, I would assume the names don&#39;t cause an issue)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1513276748, "post_id": 47780164, "comment_id": 82602286, "body": "You seem to still not be understanding the difference between a variable called <code>qsum</code> and a worksheet called &quot;qsum&quot; (referred to as <code>Worksheets(&quot;qsum&quot;)</code>, in a similar way as to how you referred to your worksheet called &quot;Qualitied RITM&#39;s&quot; as <code>Sheets(&quot;Qualitied RITM&#39;s&quot;)</code>).  And I suspect that you aren&#39;t understanding what is meant by &quot;scope&quot; of variables (i.e. a local-scoped variable is only available in the procedure in which it is declared).  You probably need to read up on both topics before any answer we give will make any sense."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1513108549, "creation_date": 1513108549, "answer_id": 47780560, "question_id": 47780164, "link": "https://stackoverflow.com/questions/47780164/excel-vba-copy-data-from-one-worksheet-to-another-via-loop/47780560#47780560", "title": "Excel VBA - Copy data from one worksheet to another via loop", "body": "<p>Based on comments that your only issue is doing the loop, then the following code should achieve what you want.  (Note this code uses your <code>wbk1</code> etc mentioned in the \"pseudo-code\" as if they are references to the relevant sheets.)</p>\n\n<pre><code>Dim r As Long\nDim c As Long\nFor r = 2 To 8\n    For c = 2 To 4\n        wbk1.Cells(r, c).Value = wbk2.Cells(r, c).Value + wbk3.Cells(r, c).Value\n    Next\nNext\n</code></pre>\n\n<p>If you paste your current code (which does everything other than the looping) into the question, then this could be tailored better to your specific situation.</p>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2103, "favorite_count": 0, "accepted_answer_id": 47780560, "answer_count": 1, "score": 0, "last_activity_date": 1513185465, "creation_date": 1513106964, "last_edit_date": 1513185465, "question_id": 47780164, "link": "https://stackoverflow.com/questions/47780164/excel-vba-copy-data-from-one-worksheet-to-another-via-loop", "title": "Excel VBA - Copy data from one worksheet to another via loop", "body": "<p>This is a variant of basically every other thread I have been able to find on the topic.</p>\n\n<p>I have a worksheet (we'll say sh1 in wbk2) with values in columns B2:D8.  I need to loop through the cells and copy the data to B2:D8 in sh1 of wbk1.  The ranges will never change, but the values will.  And, I want to use a loop as opposed to a simple copy and paste.</p>\n\n<p>Next, I have a different worksheet (sh1 in wbk3) with the same range.  I want to loop through and copy the cell values, but this time, instead of pasting to wbk1, I want to increment the value that is already there.  What I want to end up with is a sum of the values in a particular cell in wbk's 2 and 3, pasted into that same cell in wbk1.</p>\n\n<p>Pseudo-code:</p>\n\n<pre><code>rng1 = wbk1.Range(\"B2:D8\")\nrng2 = wbk2.Range(\"B2:D8\")\nrng3 = wbk3.Range(\"B2:D8\")\nFor Each value In rng2\nCopy data to rng1\nNext value\nFor Each value In rng3\nMerge data to rng1\nNext value\n</code></pre>\n\n<p>Any starting tips are appreciated.</p>\n\n<p>Edit:</p>\n\n<p>Using YowE3K's assistance from below, the code now is:</p>\n\n<pre><code>    Dim r As Long\n    Dim c As Long\n    For r = 2 To 8\n        For c = 2 To 4\n            combinedReports.Worksheets(\"combinedQualities\").Cells(r, c).Value = snowq.Worksheets(\"qsum\").Cells(r, c).Value + qual.Worksheets(\"qsum\").Cells(r, c).Value\n        Next\n    Next\n</code></pre>\n\n<p>The correct workbooks and worksheets are now listed.  Before this code, separate code was run to give data in the B2:D8 ranges for each workbook/worksheet.\nThe only issue I am having now is that when the code runs to the line starting with \"combinedReports.Worksheets\"......., I get a 424 object required run-time error.  I checked back to make sure all variables are declared, which they appear to be.  Given this error, does this mean I am still missing a declaration somewhere?  FYI, everything else before this works without issue, so it may be that it is just this line that is typed incorrectly.</p>\n\n<p>EDIT: The entire code is pasted below, which includes the 2 sets of code that are called right before the failing line...</p>\n\n<pre><code>Sub ReportCombiner()\n'\n' ReportCombiner Macro\n'\n'\n'Create new workbook\n    Dim combinedReports As Workbook, combinedCsats As Worksheet, combinedQualities As Worksheet, combinedTickets As Worksheet\n    Set combinedReports = Workbooks.Add\n    Sheets(\"Sheet1\").name = \"Combined CSAT's\"\n    Set combinedCsats = combinedReports.Sheets(\"Combined CSAT's\")\n    Sheets.Add After:=ActiveSheet\n    Sheets(\"Sheet2\").name = \"Combined Qualities\"\n    Set combinedQualities = combinedReports.Sheets(\"Combined Qualities\")\n    Sheets.Add After:=ActiveSheet\n    Sheets(\"Sheet3\").name = \"Combined Tickets\"\n    Set combinedTickets = combinedReports.Sheets(\"Combined Tickets\")\n\n'Change analysts to variables\n    Set Anal = Workbooks.Open(\"D:\\Users\\stefan.bagnato\\Desktop\\Analysts\\Analysts\")\n    Dim var1, var2, var3, var4, var5, var6, var7 As String\n    var1 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A1\")\n    var2 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A2\")\n    var3 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A3\")\n    var4 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A4\")\n    var5 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A5\")\n    var6 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A6\")\n    var7 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A7\")\n    Workbooks(\"Analysts\").Close\n\n'Qualities\n    'Create quality table\n        'Add table headers\n            combinedQualities.Activate\n            Range(\"A2\") = var1\n            Range(\"A3\") = var2\n            Range(\"A4\") = var3\n            Range(\"A5\") = var4\n            Range(\"A6\") = var5\n            Range(\"A7\") = var6\n            Range(\"A8\") = var7\n            Range(\"B1\") = \"Valid Qualities\"\n            Range(\"C1\") = \"Invalid Qualities\"\n            Range(\"D1\") = \"Total Qualities\"\n        'Justify cells\n            Range(\"B2:D8\").HorizontalAlignment = xlCenter\n        'Format cells\n            Range(\"A2:A8,B1:D1\").Font.Bold = True\n            Range(\"B1:D1\").Font.Size = 12\n        'Widen columns\n            Range(\"A:A\").ColumnWidth = 18\n            Range(\"B:D\").ColumnWidth = 16\n    'Run SNOW Quality report\n        Call ServiceNowQualityReport\n    'Run CA Quality report\n        Call CAQualityReport\n    'Add data to combo table\n        Dim r As Long\n        Dim c As Long\n        For r = 2 To 8\n            For c = 2 To 4\n                combinedReports.Worksheets(\"combinedQualities\").Cells(r, c).Value = snowq.Worksheets(\"qsum\").Cells(r, c).Value + qual.Worksheets(\"qsum\").Cells(r, c).Value\n            Next\n        Next\n\nEnd Sub\n\n\n\nSub ServiceNowQualityReport()\n'\n' ServiceNow Quality Report Macro\n'\n'\n'Create new workbook\n    Dim snowq As Workbook, snowqws As Worksheet\n    Set snowq = Workbooks.Add\n    Sheets(\"Sheet1\").name = \"Qualities\"\n    Set snowqws = snowq.Sheets(\"Qualities\")\n\n'Combine reports\n    'Qualitied Incidents\n        Set incq = Workbooks.Open(\"D:\\Users\\stefan.bagnato\\Desktop\\Latest Reports\\snowincqual\")\n        Sheets(\"Page 1\").name = \"Qualitied Incidents\"\n        Set incqws = incq.Sheets(\"Qualitied Incidents\")\n        lastRowIncqws = incqws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        lastRowSnowqws = snowqws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        incqws.Range(\"A2:J\" &amp; lastRowIncqws).Copy snowqws.Range(\"A\" &amp; lastRowSnowqws)\n        Workbooks(\"snowincqual\").Close savechanges:=False\n    'Qualitied RITM's\n        Set ritmq = Workbooks.Open(\"D:\\Users\\stefan.bagnato\\Desktop\\Latest Reports\\snowritmqual\")\n        Sheets(\"Page 1\").name = \"Qualitied RITM's\"\n        Set ritmqws = ritmq.Sheets(\"Qualitied RITM's\")\n        lastRowRitmqws = ritmqws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        lastRowSnowqws = snowqws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n        ritmqws.Range(\"A2:J\" &amp; lastRowRitmqws).Copy snowqws.Range(\"A\" &amp; lastRowSnowqws)\n        Workbooks(\"snowritmqual\").Close savechanges:=False\n        Application.CutCopyMode = False\n\n'Format table\n    'Add headers\n        Range(\"A1\") = \"Ticket Number\"\n        Range(\"B1\") = \"Opened Date\"\n        Range(\"C1\") = \"Created By\"\n        Range(\"D1\") = \"Short Description\"\n        Range(\"E1\") = \"Quality Submitted Date\"\n        Range(\"F1\") = \"Quality By\"\n        Range(\"G1\") = \"Quality Reason\"\n        Range(\"H1\") = \"Quality Comments\"\n        Range(\"I1\") = \"Quality Resolved By\"\n        Range(\"J1\") = \"Quality Resolution Comments\"\n    'Widen columns and rows\n        Columns(\"A:A\").ColumnWidth = 15\n        Columns(\"B:B\").ColumnWidth = 18\n        Range(\"C:C,I:I\").ColumnWidth = 20\n        Columns(\"D:D\").ColumnWidth = 30\n        Columns(\"E:G\").ColumnWidth = 24\n        Range(\"H:H,J:J\").ColumnWidth = 40\n        Rows(\"1:1\").RowHeight = 20\n        lastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n        Range(\"A1:A\" &amp; lastRow).RowHeight = 18\n    'Justify cells\n        Range(\"A1:J\" &amp; lastRow).HorizontalAlignment = xlLeft\n    'Format cells\n        Range(\"B2:B\" &amp; lastRow, \"E2:E\" &amp; lastRow).NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n        Range(\"A1:J1\").Font.Bold = True\n        Range(\"A1:J1\").Font.Size = 12\n    'Wrap text\n        Range(\"A1:J\" &amp; lastRow).WrapText = True\n    'AutoFit columns\n        Range(\"D:D,H:H,J:J\").Rows.AutoFit\n\n'Sort by Quality Submitted Date\n    Worksheets(\"Qualities\").Sort.SortFields.Add Key:=Range(\"E1\"), SortOn:=xlSortOnValues, Order:=xlAscending\n    With Worksheets(\"Qualities\").Sort\n        .SetRange Range(\"A2:J\" &amp; lastRow)\n        .Orientation = xlTopToBottom\n        .Apply\n    End With\n\n'Add new worksheet\n    Sheets.Add\n    Sheets(\"Sheet2\").name = \"Summed Data\"\n\n'Change analysts to variables\n    Set Anal = Workbooks.Open(\"D:\\Users\\stefan.bagnato\\Desktop\\Analysts\\Analysts\")\n    Dim var1, var2, var3, var4, var5, var6, var7 As String\n    var1 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A1\")\n    var2 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A2\")\n    var3 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A3\")\n    var4 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A4\")\n    var5 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A5\")\n    var6 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A6\")\n    var7 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A7\")\n    Workbooks(\"Analysts\").Close\n\n'Format table\n    'Add table headers\n        Range(\"A2\") = var1\n        Range(\"A3\") = var2\n        Range(\"A4\") = var3\n        Range(\"A5\") = var4\n        Range(\"A6\") = var5\n        Range(\"A7\") = var6\n        Range(\"A8\") = var7\n        Range(\"B1\") = \"Valid Qualities\"\n        Range(\"C1\") = \"Invalid Qualities\"\n        Range(\"D1\") = \"Total Qualities\"\n    'Justify cells\n        Range(\"B2:D8\").HorizontalAlignment = xlCenter\n    'Format cells\n        Range(\"A2:A8,B1:D1\").Font.Bold = True\n        Range(\"B1:D1\").Font.Size = 12\n    'Widen columns\n        Range(\"A:A\").ColumnWidth = 18\n        Range(\"B:D\").ColumnWidth = 16\n\n'Fill in data\n    Dim qual As Worksheet, qsum As Worksheet, qRange As Range\n    Set qual = Sheets(\"Qualities\")\n    Set qsum = Sheets(\"Summed Data\")\n    Set qRange = qual.Range(\"J2:J\" &amp; lastRow)\n    'Qualities\n        qsum.Range(\"B2\") = WorksheetFunction.CountIfs(qRange, \"Valid on Kris\" &amp; Search &amp; \"*\")\n        qsum.Range(\"B3\") = WorksheetFunction.CountIfs(qRange, \"Valid on Matt\" &amp; Search &amp; \"*\")\n        qsum.Range(\"B4\") = WorksheetFunction.CountIfs(qRange, \"Valid on Shawn\" &amp; Search &amp; \"*\")\n        qsum.Range(\"B5\") = WorksheetFunction.CountIfs(qRange, \"Valid on Stefan\" &amp; Search &amp; \"*\")\n        qsum.Range(\"B6\") = WorksheetFunction.CountIfs(qRange, \"Valid on Trey\" &amp; Search &amp; \"*\")\n        qsum.Range(\"B7\") = WorksheetFunction.CountIfs(qRange, \"Valid on Tyler\" &amp; Search &amp; \"*\")\n        qsum.Range(\"B8\") = WorksheetFunction.CountIfs(qRange, \"Valid on Whitney\" &amp; Search &amp; \"*\")\n        qsum.Range(\"C2\") = WorksheetFunction.CountIfs(qRange, \"Feedback NA for Kris\" &amp; Search &amp; \"*\")\n        qsum.Range(\"C3\") = WorksheetFunction.CountIfs(qRange, \"Feedback NA for Matt\" &amp; Search &amp; \"*\")\n        qsum.Range(\"C4\") = WorksheetFunction.CountIfs(qRange, \"Feedback NA for Shawn\" &amp; Search &amp; \"*\")\n        qsum.Range(\"C5\") = WorksheetFunction.CountIfs(qRange, \"Feedback NA for Stefan\" &amp; Search &amp; \"*\")\n        qsum.Range(\"C6\") = WorksheetFunction.CountIfs(qRange, \"Feedback NA for Trey\" &amp; Search &amp; \"*\")\n        qsum.Range(\"C7\") = WorksheetFunction.CountIfs(qRange, \"Feedback NA for Tyler\" &amp; Search &amp; \"*\")\n        qsum.Range(\"C8\") = WorksheetFunction.CountIfs(qRange, \"Feedback NA for Whitney\" &amp; Search &amp; \"*\")\n    'Sums\n        Range(\"D2\") = \"=SUM(RC[-2]:RC[-1])\"\n        Range(\"D3\") = \"=SUM(RC[-2]:RC[-1])\"\n        Range(\"D4\") = \"=SUM(RC[-2]:RC[-1])\"\n        Range(\"D5\") = \"=SUM(RC[-2]:RC[-1])\"\n        Range(\"D6\") = \"=SUM(RC[-2]:RC[-1])\"\n        Range(\"D7\") = \"=SUM(RC[-2]:RC[-1])\"\n        Range(\"D8\") = \"=SUM(RC[-2]:RC[-1])\"\n\n    Application.CutCopyMode = False\nEnd Sub\n\n\nSub CAQualityReport()\n'\n' CA Quality Report Macro\n'\n'\n'Initialize workbook\n    Dim CAQual As Workbook\n    Set CAQual = Workbooks.Open(\"D:\\Users\\stefan.bagnato\\Desktop\\Latest Reports\\qual\")\n    Sheets(\"RAW\").name = \"Qualities\"\n\n'Remove the extra column and rows\n    Rows(\"1:3\").Delete Shift:=xlUp\n    Range(\"A:A,E:G,L:Q,U:U,W:W\").Delete Shift:=xlToLeft\n\n'Change analysts to variables\n    Set Anal = Workbooks.Open(\"D:\\Users\\stefan.bagnato\\Desktop\\Analysts\\Analysts\")\n    Workbooks(\"qual.xlsx\").Activate\n    Dim var1, var2, var3, var4, var5, var6, var7 As String\n    var1 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A1\")\n    var2 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A2\")\n    var3 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A3\")\n    var4 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A4\")\n    var5 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A5\")\n    var6 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A6\")\n    var7 = Workbooks(\"Analysts\").Worksheets(\"Analysts\").Range(\"A7\")\n    Workbooks(\"Analysts\").Close\n\n'Remove all analysts not wanted in the table\n    Dim Names As String, r As Range\n    lastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Names = \"Dana IT Service Catalog,Kristopher Snyder,Matthew Williams,Shawn Dwyer,Trey Skandier,Tyler Brown,Stefan Bagnato,Whitney Royal\"\n    ary = Split(Names, \",\")\n    Set r = Range(\"A1:X\" &amp; lastRow)\n    With r\n        .AutoFilter Field:=4, Criteria1:=(ary), Operator:=xlFilterValues\n    End With\n\n'Add a new worksheet\n    Sheets.Add\n    Sheets(\"Sheet1\").name = \"Summed Qualities\"\n\n'Format table\n    'Add table headers on the new sheet\n        Range(\"A2\") = var1\n        Range(\"A3\") = var2\n        Range(\"A4\") = var3\n        Range(\"A5\") = var4\n        Range(\"A6\") = var5\n        Range(\"A7\") = var6\n        Range(\"A8\") = var7\n        Range(\"B1\") = \"Valid Qualities\"\n        Range(\"C1\") = \"Invalid Qualities\"\n        Range(\"D1\") = \"Total Qualities\"\n    'Format the table\n        Range(\"A2:A8,B1:D1\").Font.Bold = True\n        Range(\"A:A\").ColumnWidth = 18\n        Range(\"B:D\").ColumnWidth = 15\n\n'Fill in data\n    Dim q As Worksheet, qsum As Worksheet, qual As Range\n    Set q = Sheets(\"Qualities\")\n    Set qsum = Sheets(\"Summed Qualities\")\n    Set qual = Sheets(\"Qualities\").Range(\"K1:K\" &amp; lastRow)\n\n'Find the values\n    qsum.Range(\"B2\") = WorksheetFunction.CountIfs(qual, \"Valid on Kris\" &amp; Search &amp; \"*\")\n    qsum.Range(\"B3\") = WorksheetFunction.CountIfs(qual, \"Valid on Matt\" &amp; Search &amp; \"*\")\n    qsum.Range(\"B4\") = WorksheetFunction.CountIfs(qual, \"Valid on Shawn\" &amp; Search &amp; \"*\")\n    qsum.Range(\"B5\") = WorksheetFunction.CountIfs(qual, \"Valid on Stefan\" &amp; Search &amp; \"*\")\n    qsum.Range(\"B6\") = WorksheetFunction.CountIfs(qual, \"Valid on Trey\" &amp; Search &amp; \"*\")\n    qsum.Range(\"B7\") = WorksheetFunction.CountIfs(qual, \"Valid on Tyler\" &amp; Search &amp; \"*\")\n    qsum.Range(\"B8\") = WorksheetFunction.CountIfs(qual, \"Valid on Whitney\" &amp; Search &amp; \"*\")\n\n    qsum.Range(\"C2\") = WorksheetFunction.CountIfs(qual, \"Feedback NA for Kris\" &amp; Search &amp; \"*\")\n    qsum.Range(\"C3\") = WorksheetFunction.CountIfs(qual, \"Feedback NA for Matt\" &amp; Search &amp; \"*\")\n    qsum.Range(\"C4\") = WorksheetFunction.CountIfs(qual, \"Feedback NA for Shawn\" &amp; Search &amp; \"*\")\n    qsum.Range(\"C5\") = WorksheetFunction.CountIfs(qual, \"Feedback NA for Stefan\" &amp; Search &amp; \"*\")\n    qsum.Range(\"C6\") = WorksheetFunction.CountIfs(qual, \"Feedback NA for Trey\" &amp; Search &amp; \"*\")\n    qsum.Range(\"C7\") = WorksheetFunction.CountIfs(qual, \"Feedback NA for Tyler\" &amp; Search &amp; \"*\")\n    qsum.Range(\"C8\") = WorksheetFunction.CountIfs(qual, \"Feedback NA for Whitney\" &amp; Search &amp; \"*\")\n\n'Sum values\n    Range(\"D2\") = \"=SUM(RC[-2]:RC[-1])\"\n    Range(\"D3\") = \"=SUM(RC[-2]:RC[-1])\"\n    Range(\"D4\") = \"=SUM(RC[-2]:RC[-1])\"\n    Range(\"D5\") = \"=SUM(RC[-2]:RC[-1])\"\n    Range(\"D6\") = \"=SUM(RC[-2]:RC[-1])\"\n    Range(\"D7\") = \"=SUM(RC[-2]:RC[-1])\"\n    Range(\"D8\") = \"=SUM(RC[-2]:RC[-1])\"\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 8767513, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8pbfFgx9Oco/AAAAAAAAAAI/AAAAAAAAALY/H5FtY0znJKM/photo.jpg?sz=128", "display_name": "Lindy Newman", "link": "https://stackoverflow.com/users/8767513/lindy-newman"}, "is_accepted": false, "score": 0, "last_activity_date": 1513187407, "creation_date": 1513187407, "answer_id": 47799343, "question_id": 47779702, "link": "https://stackoverflow.com/questions/47779702/referring-to-the-caption-of-current-item-in-a-for-next-loop/47799343#47799343", "title": "Referring to the caption of current item in a For Next loop", "body": "<p>@YowE3K was right - ctrl.Caption does exist. Error 1004 was just from some of the hoop-jumping I did in the debugging process. Final, cleaned-up code below:</p>\n\n<pre><code>For Each ctrl In Me.Controls\n    If TypeName(ctrl) = \"CheckBox\" Then\n        If ctrl.Value = True Then\n            ws.Cells(lrow, 7).Value = ws.Cells(lrow, 7) &amp; vbCrLf &amp; \"|\" &amp; ctrl.Caption\n        End If\n    End If\nNext ctrl\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8767513, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8pbfFgx9Oco/AAAAAAAAAAI/AAAAAAAAALY/H5FtY0znJKM/photo.jpg?sz=128", "display_name": "Lindy Newman", "link": "https://stackoverflow.com/users/8767513/lindy-newman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513187407, "creation_date": 1513105002, "last_edit_date": 1513183582, "question_id": 47779702, "link": "https://stackoverflow.com/questions/47779702/referring-to-the-caption-of-current-item-in-a-for-next-loop", "title": "Referring to the caption of current item in a For Next loop", "body": "<p>Self-taught VBA newbie here. I'm working on a userform where the user will be able to select checkboxes, and the captions of those checkboxes need to be compiled into a single cell (see <a href=\"https://i.stack.imgur.com/QIL3H.png\" rel=\"nofollow noreferrer\">here</a>). Previously, I just had an If statement for every check box on the form (all 13 of them), but it's getting pretty unwieldy and I'm trying to clean it up.</p>\n\n<p>So far, I've got a For Next loop that runs through all form controls to look for checkboxes and see if they're checked. <strike>Next I want to refer to the caption of the current <code>ctrl</code> in the loop, but there is no <code>ctrl.Caption</code> property. I tried to get around this by populating the variable <code>currentcb</code> with the current <code>ctrl</code>'s name, but the phrase <code>currentcb.Caption</code> is also returning an Invalid Qualifier error.</strike></p>\n\n<p><strong>UPDATE:</strong> I changed around the code a little - @YowE3K was right that <code>ctrl.Caption</code> is a valid property, but now I get Run Time Error 1004: Application-defined or Object-defined error. The debugger highlights the line that starts with <code>ws.Cells(lrow, 7).Value</code>. Any ideas? New code updated below.</p>\n\n<pre><code>For Each ctrl In Me.Controls\n    If TypeName(ctrl) = \"CheckBox\" Then\n        If ctrl.Value = True Then\n            ws.Cells(lrow, 7).Value = ws.Cells(lrow, 7) &amp; vbCrLf &amp; \"|\" &amp; ctrl.Caption   'error thrown here\n        End If\n    End If\nNext ctrl\n</code></pre>\n\n<p>Is there any workaround for this scenario?</p>\n"}, {"tags": ["c#", ".net", "vb.net", "vba", "excel"], "comments": [{"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 2, "creation_date": 1513104944, "post_id": 47779533, "comment_id": 82520480, "body": "Hopefully not. If this works please report as a breach."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1513105859, "post_id": 47779533, "comment_id": 82520960, "body": "You may try to extract cookies and validation key from IE after successfull login, to continue with XHR, or something like <a href=\"https://stackoverflow.com/q/33236619/2165759\">this</a>. IMO that is bizarre way to do what should work without IE. Just figure out how to get the key via XHR."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1513144980, "post_id": 47779533, "comment_id": 82534056, "body": "It doesn&#39;t seem to come as a response header, cookie, or a string within the body, anything when I first visit the login page, so I assume it carries out a quick javascript function to create a string after clicking login, which is then inserted in to the POST request body with the rest of the stuff needed for login. Thanks for the advice, I guess I&#39;ll have to quickly learn javascript and take a stab at XMLHttpRequests"}], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1513104374, "creation_date": 1513104374, "question_id": 47779533, "link": "https://stackoverflow.com/questions/47779533/transfer-ie-connection-to-a-different-object-vba-net", "title": "Transfer IE connection to a different object VBA / .NET", "body": "<p>I am having difficulty signing in to a company website using POST requests via MSXML2.ServerHTTP60 in VBA or WebRequests in .NET</p>\n\n<p>(there is some validation key sent during log in within the REQUEST string and I can't figure out where it gets this from)</p>\n\n<p>The hacky way I can think to achieve what I want is to automate opening an IE instance, login with element filling and clicking, then pass on the connection to one of the \"background\" methods like MSXML2.ServerHTTP or WebRequests/WebResponses</p>\n\n<p><strong>Is there a way to hand over my programatically declared InternetExplorer connection to a different connection hosting class?</strong></p>\n\n<p>I spotted already <a href=\"https://stackoverflow.com/questions/20508717/vbs-is-it-possible-to-hand-over-ie-object-session-to-msxml2-xmlhttp-object\">THIS</a> question which is asking the same, thing but we're now 4 years in the future so perhaps there's a chance.</p>\n\n<p>basic idea:</p>\n\n<pre><code>objIE.Navigate \"https://sso.crmondemand.com/router/logon.jsp\"\n' login stuff\nMyConn = new MSXML2.ServerHTTP60\nMyConn = objIE.Connection ' I have no idea really\n</code></pre>\n"}]