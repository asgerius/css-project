[{"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1533166697, "post_id": 51643568, "comment_id": 90251517, "body": "Thanks Tim, but no luck with the alternate construction.  I also tried a few variants moving around the single quotes with no success."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1533169174, "post_id": 51643568, "comment_id": 90252001, "body": "Are you using late binding, or have you added a reference to Excel in your access VB project?"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1533211110, "post_id": 51643568, "comment_id": 90269346, "body": "Hi Tim,  Sorry for delay.  Yes, Late Binding in-use.  XLS automation is fully working in all other aspects but this, so far."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1533235986, "post_id": 51643568, "comment_id": 90284294, "body": "If late binding, all <i>xl</i> constants need to be explicitly declared. Please show fuller code block so we can see your process"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1533332144, "post_id": 51643568, "comment_id": 90323899, "body": "@Tim - Declaring those Constants was exactly my issue.  Great point for future reference. - Thanks!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1533240717, "last_edit_date": 1533240717, "creation_date": 1533166027, "answer_id": 51643568, "question_id": 51643420, "link": "https://stackoverflow.com/questions/51643420/reference-an-xls-picklist-from-msaccess-vba/51643568#51643568", "title": "Reference an XLS Picklist from MSAccess VBA", "body": "<p><code>wbk.Sheets('Expense Types')</code> is VBA (sort of) and doesn't belong in the <code>Formula1</code> argument.</p>\n\n<p>Try:</p>\n\n<pre><code>Formula1:=\"='Expense Types'!$B$3:$B$10\"\n</code></pre>\n\n<p><strong>EDIT</strong>\nIf you haven't already declared those constants and you're using late binding then you need to add:</p>\n\n<pre><code>Const xlValidateList = 3\nConst xlValidAlertStop = 1\nConst xlBetween = 1\n</code></pre>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 51643568, "answer_count": 1, "score": 0, "last_activity_date": 1547053376, "creation_date": 1533164932, "last_edit_date": 1547053376, "question_id": 51643420, "link": "https://stackoverflow.com/questions/51643420/reference-an-xls-picklist-from-msaccess-vba", "title": "Reference an XLS Picklist from MSAccess VBA", "body": "<p>I have an MS Access app that exports a table to XLS then applies formatting.</p>\n\n<p>I am trying to create a picklist for a range of cells on worksheet 1 (\"Expenses\"), from a list of values from worksheet 2 (\"Expense Types\") in the same workbook.</p>\n\n<p>I used \"record Macro\" from XLS to get started. The picklist does work from XLS, but fails when trying to implement from MSAccess VBA.</p>\n\n<p>Here is the snippet that is failing (err 1004 - Application-defined or object-defined error)</p>\n\n<pre><code>' Validation\n\nWith wks1.Range(\"G4:G10\").Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=\"= wbk.Sheets('Expense Types')!$B$3:$B$10\"\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n\nwks1.Range(\"A4\").Select\n</code></pre>\n\n<p>Guessing pretty straightforward once I know the required format/syntax to reference the source and destination info for the picklist.</p>\n"}, {"tags": ["vba", "if-statement", "match"], "comments": [{"owner": {"reputation": 1, "user_id": 5401554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d415f4ddb5fb40096a2ced1ea3ae83e5?s=128&d=identicon&r=PG&f=1", "display_name": "bens120x", "link": "https://stackoverflow.com/users/5401554/bens120x"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1533165909, "post_id": 51643397, "comment_id": 90251334, "body": "This helped address the issue! Thank you @Comintern . used the Iferror method and removed the &quot;WorksheetFunctions&quot; portion of calling the Match application."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 10157765, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P7LcAS3ygBQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7odS6EGlpxKbjfIEUmCNATc6_szIA/mo/photo.jpg?sz=128", "display_name": "Blake Turner", "link": "https://stackoverflow.com/users/10157765/blake-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1533167129, "creation_date": 1533167129, "answer_id": 51643691, "question_id": 51643397, "link": "https://stackoverflow.com/questions/51643397/error-1004-if-else-reasonable-to-use/51643691#51643691", "title": "error 1004 ? if else reasonable to use", "body": "<p>The method I've always used for things like this is the find method.</p>\n\n<p>An example of how to start your code would start:</p>\n\n<pre><code>Option Explicit\nPublic Sub CommandButtonAbsorbIntakeData_Click()\nDim lrowintakes As Variant\nDim patient As Variant\nDim myworksheet As Worksheet\nDim myworksheet2 As Worksheet\nDim myworksheet3 As Worksheet\nDim myfirstblankrow As Variant\nDim patientexistence As Variant\nDim KeyRange As Range\n\nWorksheets(\"Hard Data\").Select\n\npatient = Me.TextBoxIntakeName.Value &amp; \" \" &amp; Me.TextBoxIntakeDateOfBirth.Value\n\nSet KeyRange = Worksheets(\"Hard Data\").Range(\"A1:A200\").Find(patient, Range(\"A1\"), xlValues, xlWhole, xlRows, xlNext)\nIf Not KeyRange Is Nothing Then 'If \"patient\" was found then\n</code></pre>\n\n<p>From here you would just need to fill in the rest of your code! I like this method because it gives you an easy visual way to deal with the code if your value isn't found in the sheet. Hope this helped!</p>\n"}], "owner": {"reputation": 1, "user_id": 5401554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d415f4ddb5fb40096a2ced1ea3ae83e5?s=128&d=identicon&r=PG&f=1", "display_name": "bens120x", "link": "https://stackoverflow.com/users/5401554/bens120x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1533168581, "answer_count": 1, "score": -1, "last_activity_date": 1533175455, "creation_date": 1533164753, "question_id": 51643397, "link": "https://stackoverflow.com/questions/51643397/error-1004-if-else-reasonable-to-use", "closed_reason": "Duplicate", "title": "error 1004 ? if else reasonable to use", "body": "<p>After working on this for a few hours and searching the forums, I haven't found a great solution for the following problem just yet.</p>\n\n<p>I have a macro-enabled worksheet running in excel 2016. I have four sheets \"Orders\", \"Intake\", \"Hard Data\", \"Office Visit\".</p>\n\n<p>I have created a userform which has a command button (CommandButtonAbsorbIntakeData). I have pasted the code below in the hopes that someone can spot any issues I have that would produce a error 1004. I understand the error to indicate there is no Match found. I am using an if else statement as a trigger since the match function returns a value. If the value is greater that or equal to 1, a piece of code will run. If it is anything other than that, another code will run.\nMy issue is that when a match IS NOT found, my else code does not run. Is if else not a good option with match? Thanks for any feedback.</p>\n\n<pre><code>    Option Explicit\n    Public Sub CommandButtonAbsorbIntakeData_Click()\n    Dim lrowintakes As Variant\n    Dim patient As Variant\n    Dim myworksheet As Worksheet\n    Dim myworksheet2 As Worksheet\n    Dim myworksheet3 As Worksheet\n    Dim myfirstblankrow As Variant\n    Dim patientexistence As Variant\n\n\n    patient = Me.TextBoxIntakeName.Value &amp; \" \" &amp;  Me.TextBoxIntakeDateOfBirth.Value\n\n    lrowintakes = Application.WorksheetFunction.Match(patient, Sheets(\"Hard Data\").Range(\"A1:A200\"), 0)\n\n           If lrowintakes &gt;= 1 Then\n        Set myworksheet = Worksheets(\"Hard Data\")\n            With myworksheet\n                .Cells(lrowintakes, 1) = Me.TextBoxIntakeName.Value &amp; \" \" &amp; Me.TextBoxIntakeDateOfBirth.Value\n                .Cells(lrowintakes, 2) = Me.TextBoxIntakeName.Value\n                .Cells(lrowintakes, 3) = Me.TextBoxIntakeDateOfBirth.Value\n                .Cells(lrowintakes, 14) = Me.TextBoxIntakeMeds1.Value\n                .Cells(lrowintakes, 15) = Me.TextBoxIntakeMeds2.Value\n                .Cells(lrowintakes, 16) = Me.TextBoxIntakeMeds3.Value\n                .Cells(lrowintakes, 17) = Me.TextBoxIntakeMeds4.Value\n                .Cells(lrowintakes, 18) = Me.TextBoxIntakeMeds5.Value\n                .Cells(lrowintakes, 19) = Me.TextBoxIntakeMeds6.Value\n                .Cells(lrowintakes, 20) = Me.TextBoxIntakeMeds7.Value\n                .Cells(lrowintakes, 21) = Me.TextBoxIntakeMeds8.Value\n                .Cells(lrowintakes, 22) = Me.TextBoxIntakeMeds9.Value\n                .Cells(lrowintakes, 23) = Me.TextBoxIntakeMedicalProblems1.Value\n                .Cells(lrowintakes, 24) = Me.TextBoxIntakeMedicalProblems2.Value\n                .Cells(lrowintakes, 25) = Me.TextBoxIntakeMedicalProblems3.Value\n                .Cells(lrowintakes, 26) = Me.TextBoxIntakeMedicalProblems4.Value\n                .Cells(lrowintakes, 27) = Me.TextBoxIntakeMedicalProblems5.Value\n                .Cells(lrowintakes, 28) = Me.TextBoxIntakeMedicalProblems6.Value\n                .Cells(lrowintakes, 29) = Me.TextBoxIntakeMedicalProblems7.Value\n                .Cells(lrowintakes, 30) = Me.TextBoxIntakeMedicalProblems8.Value\n                .Cells(lrowintakes, 31) = Me.TextBoxIntakeMedicalProblems9.Value\n                .Cells(lrowintakes, 32) = Me.TextBoxIntakeSurgeries1.Value\n                .Cells(lrowintakes, 33) = Me.TextBoxIntakeSurgeries2.Value\n                .Cells(lrowintakes, 34) = Me.TextBoxIntakeSurgeries3.Value\n                .Cells(lrowintakes, 35) = Me.TextBoxIntakeSurgeries4.Value\n                .Cells(lrowintakes, 36) = Me.TextBoxIntakeSurgeries5.Value\n                .Cells(lrowintakes, 37) = Me.TextBoxIntakeSurgeries6.Value\n                .Cells(lrowintakes, 38) = Me.TextBoxIntakeSurgeries7.Value\n                .Cells(lrowintakes, 39) = Me.TextBoxIntakeSurgeries8.Value\n                .Cells(lrowintakes, 40) = Me.TextBoxIntakeSurgeries9.Value\n                .Cells(lrowintakes, 41) = Me.TextBoxIntakeFamilyHistory\n            End With\n\n    Else\n    'add information in next available row in Hard Data Sheet, concatenates name and DOB for datatag column\n        Set myworksheet = Worksheets(\"Hard Data\")\n        With myworksheet\n            myfirstblankrow = .Cells.Find(What:=\"*\", LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n            .Cells(myfirstblankrow, 1) = Me.TextBoxIntakeName.Value &amp; \" \" &amp; Me.TextBoxIntakeDateOfBirth.Value\n            .Cells(myfirstblankrow, 2) = Me.TextBoxIntakeName.Value\n            .Cells(myfirstblankrow, 3) = Me.TextBoxIntakeDateOfBirth.Value\n            .Cells(myfirstblankrow, 14) = Me.TextBoxIntakeMeds1.Value\n            .Cells(myfirstblankrow, 15) = Me.TextBoxIntakeMeds2.Value\n            .Cells(myfirstblankrow, 16) = Me.TextBoxIntakeMeds3.Value\n            .Cells(myfirstblankrow, 17) = Me.TextBoxIntakeMeds4.Value\n            .Cells(myfirstblankrow, 18) = Me.TextBoxIntakeMeds5.Value\n            .Cells(myfirstblankrow, 19) = Me.TextBoxIntakeMeds6.Value\n            .Cells(myfirstblankrow, 20) = Me.TextBoxIntakeMeds7.Value\n            .Cells(myfirstblankrow, 21) = Me.TextBoxIntakeMeds8.Value\n            .Cells(myfirstblankrow, 22) = Me.TextBoxIntakeMeds9.Value\n            .Cells(myfirstblankrow, 23) = Me.TextBoxIntakeMedicalProblems1.Value\n            .Cells(myfirstblankrow, 24) = Me.TextBoxIntakeMedicalProblems2.Value\n            .Cells(myfirstblankrow, 25) = Me.TextBoxIntakeMedicalProblems3.Value\n            .Cells(myfirstblankrow, 26) = Me.TextBoxIntakeMedicalProblems4.Value\n            .Cells(myfirstblankrow, 27) = Me.TextBoxIntakeMedicalProblems5.Value\n            .Cells(myfirstblankrow, 28) = Me.TextBoxIntakeMedicalProblems6.Value\n            .Cells(myfirstblankrow, 29) = Me.TextBoxIntakeMedicalProblems7.Value\n            .Cells(myfirstblankrow, 30) = Me.TextBoxIntakeMedicalProblems8.Value\n            .Cells(myfirstblankrow, 31) = Me.TextBoxIntakeMedicalProblems9.Value\n            .Cells(myfirstblankrow, 32) = Me.TextBoxIntakeSurgeries1.Value\n            .Cells(myfirstblankrow, 33) = Me.TextBoxIntakeSurgeries2.Value\n            .Cells(myfirstblankrow, 34) = Me.TextBoxIntakeSurgeries3.Value\n            .Cells(myfirstblankrow, 35) = Me.TextBoxIntakeSurgeries4.Value\n            .Cells(myfirstblankrow, 36) = Me.TextBoxIntakeSurgeries5.Value\n            .Cells(myfirstblankrow, 37) = Me.TextBoxIntakeSurgeries6.Value\n            .Cells(myfirstblankrow, 38) = Me.TextBoxIntakeSurgeries7.Value\n            .Cells(myfirstblankrow, 39) = Me.TextBoxIntakeSurgeries8.Value\n            .Cells(myfirstblankrow, 40) = Me.TextBoxIntakeSurgeries9.Value\n            .Cells(myfirstblankrow, 41) = Me.TextBoxIntakeFamilyHistory.Value\n        End With\n        'add datatag to OFFICE VISITS\n        Set myworksheet2 = Worksheets(\"Office Visits\")\n            With myworksheet2\n                myfirstblankrow = .Cells.Find(What:=\"*\", LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n                .Cells(myfirstblankrow, 1).Value = Me.TextBoxIntakeName &amp; \" \" &amp; Me.TextBoxIntakeDateOfBirth\n            End With\n        'add datatag to ORDERS\n        Set myworksheet3 = Worksheets(\"Orders\")\n            With myworksheet3\n                myfirstblankrow = .Cells.Find(What:=\"*\", LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n                .Cells(myfirstblankrow, 1).Value = Me.TextBoxIntakeName &amp; \" \" &amp; Me.TextBoxIntakeDateOfBirth\n            End With\n\n    End If\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "quickbooks", "qbfc"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533164370, "post_id": 51643304, "comment_id": 90251006, "body": "I&#39;m not QuickBooks expert, but AFAICT from using their ODBC driver, there is no distinct address identifier (IIR the Address ID is something like &quot;home address&quot; or &quot;work address&quot;). In my experience, this is not uncommon. If you&#39;re mirroring the addresses, one solution is to hash it on your side, then table scan the QB entities and compare them to your stored hashes."}, {"owner": {"reputation": 206, "user_id": 2763160, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/826614366/picture?type=large", "display_name": "Justin Tolchin", "link": "https://stackoverflow.com/users/2763160/justin-tolchin"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533180404, "post_id": 51643304, "comment_id": 90254064, "body": "Thank you. That&#39;s what I was afraid of.  I was just hoping there was a better way."}], "answers": [{"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": true, "score": 1, "last_activity_date": 1533181233, "creation_date": 1533181233, "answer_id": 51645146, "question_id": 51643304, "link": "https://stackoverflow.com/questions/51643304/need-all-customer-addresses-with-unique-ids-from-quickbooks-qbfc13/51645146#51645146", "title": "Need all Customer Addresses (with unique IDs) from QuickBooks QBFC13", "body": "<p>used qb a few years back and reviewed some projects from that period.  mind you, this was extracted by the qb report writer inside the client that most assuredly delivers truncated record.</p>\n\n<p>no predefined globally unique address idrntifier as a single field for a specific address.  the customer/vendor name is unique for thier respective bill-from/to, ship-from/to but a billing address can be the same as a shipping address and other companies can, and do,  use the same addresses. \nthis is actually very common among several types of business.</p>\n\n<p>so bill from 1 is a unique header/name for a vendor but  the address string itself can also appear in bill from 2, bill from 3 through 5 before moving to bill from street, street 2, city, state, zip, country and all these fields roll up to create a long address string simply named bill from.</p>\n\n<p>sadly, all i have are xlsxm and csv.  no longer have access to qb  so i can't go in for a closer look that would actually provide  helpful information</p>\n"}], "owner": {"reputation": 206, "user_id": 2763160, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/826614366/picture?type=large", "display_name": "Justin Tolchin", "link": "https://stackoverflow.com/users/2763160/justin-tolchin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 51645146, "answer_count": 1, "score": 0, "last_activity_date": 1533181233, "creation_date": 1533164019, "question_id": 51643304, "link": "https://stackoverflow.com/questions/51643304/need-all-customer-addresses-with-unique-ids-from-quickbooks-qbfc13", "title": "Need all Customer Addresses (with unique IDs) from QuickBooks QBFC13", "body": "<p>I have an application that connects to QuickBooks via QBFC13, downloads the customers (just name, ID and a few other details) and all the known addresses for those customers.  This all seems to work just fine, except there is no GUID or other unique identifier that I can see that uniquely identifies the address.  So, for example, the customer changes an address in QuickBooks, I need to know which one changed in the application.  Or, I send info to QuickBooks using an Address ID rather than an entire block of Addr1-5.  I thought the address name would be unique, but it isn't and can be blank.  It isn't practical or helpful to key off of the addr fields.\nDoes this GUID even exist?  Am I missing something really simple?  Is there a better way to do this?  The QB docs are atrocious!</p>\n\n<p>The VBA used to grab the customers and their addresses follows (some code snipped for clarity).</p>\n\n<pre><code>    Dim respType As IResponseType\n    Set respType = curResp.Type\n    If (respType.getValue = rtCustomerQueryRs) Then\n        Dim custList As ICustomerRetList\n        Set custList = curResp.Detail\n\n        Dim curCust As ICustomerRet\n        Dim i As Integer\n        Dim insSQL As String\n        For i = 0 To custList.Count - 1\n            insSQL = \"INSERT INTO \" &amp; CustomerTableName _\n                &amp; \"(CustomerID, QBEditSequence, Name, PhoneNumber, EMailAddress) \" _\n                &amp; \"VALUES \" _\n                &amp; \"(\"\n\n            Set curCust = custList.GetAt(i)\n            If (curCust.Sublevel.getValue = 0) Then\n                insSQL = insSQL &amp; \"'\" &amp; curCust.ListID.getValue &amp; \"',\"\n                insSQL = insSQL &amp; \"'\" &amp; curCust.EditSequence.getValue &amp; \"',\"\n                insSQL = insSQL &amp; \"'\" &amp; Replace(curCust.Name.getValue, \"'\", \"''\") &amp; \"',\"\n                If (Not curCust.Phone Is Nothing) Then\n                    insSQL = insSQL &amp; \"'\" &amp; curCust.Phone.getValue &amp; \"',\"\n                Else\n                    insSQL = insSQL &amp; \"'',\"\n                End If\n                If (Not curCust.Email Is Nothing) Then\n                    insSQL = insSQL &amp; \"'\" &amp; curCust.Email.getValue &amp; \"');\"\n                Else\n                    insSQL = insSQL &amp; \"'');\"\n                End If\n                accessDB.Execute insSQL\n\n                ' Add Bill to address\n                If Not curCust.BillAddressBlock Is Nothing Then\n                    If curCust.BillAddressBlock.Addr1 Is Nothing = False Then\n                        rs.AddNew\n                        rs!CustomerID = curCust.ListID.getValue\n                        rs!AddressType = \"B\"\n                        rs!Addr1 = curCust.BillAddressBlock.Addr1.getValue\n                        If curCust.BillAddressBlock.Addr2 Is Nothing = False Then rs!Addr2 = curCust.BillAddressBlock.Addr2.getValue\n                        If curCust.BillAddressBlock.Addr3 Is Nothing = False Then rs!Addr3 = curCust.BillAddressBlock.Addr3.getValue\n                        If curCust.BillAddressBlock.Addr4 Is Nothing = False Then rs!Addr4 = curCust.BillAddressBlock.Addr4.getValue\n                        If curCust.BillAddressBlock.Addr5 Is Nothing = False Then rs!Addr5 = curCust.BillAddressBlock.Addr5.getValue\n                        rs.Update\n                    End If\n                End If\n\n                ' Add Shipping Addresses\n                Dim shpList As IShipToAddressList\n                Set shpList = curCust.ShipToAddressList\n                If Not shpList Is Nothing Then\n                    Dim s As Integer\n                    For s = 0 To shpList.Count - 1\n                        Dim saddr As IShipToAddress\n                        Set saddr = shpList.GetAt(s)\n\n                        rs.AddNew\n                        rs!CustomerID = curCust.ListID.getValue\n                        rs!AddressType = \"S\"\n                        rs!AddressName = saddr.Name.getValue\n                        rs!IsDefault = saddr.DefaultShipTo.getValue\n                        rs!Addr1 = saddr.Addr1.getValue\n                        If saddr.Addr2 Is Nothing = False Then rs!Addr2 = saddr.Addr2.getValue\n                        If saddr.Addr3 Is Nothing = False Then rs!Addr3 = saddr.Addr3.getValue\n                        If saddr.Addr4 Is Nothing = False Then rs!Addr4 = saddr.Addr4.getValue\n                        If saddr.Addr5 Is Nothing = False Then rs!Addr5 = saddr.Addr5.getValue\n                        rs.Update\n\n                    Next s\n                End If\n\n            End If\n\n        Next i\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1533163763, "post_id": 51643245, "comment_id": 90250881, "body": "Worksheet_Change has nothing to with calculation. It is triggered by changes in hard-coded values, not the results from formulas."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533163792, "post_id": 51643245, "comment_id": 90250888, "body": "From <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.change.aspx\" rel=\"nofollow noreferrer\">the documentation</a>, &quot;This event does not occur when cells change during a recalculation&quot;. Take a look at <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.calculate.aspx\" rel=\"nofollow noreferrer\">Worksheet.Calculate</a>."}, {"owner": {"reputation": 153, "user_id": 3497565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa5b0bb48d1ba636ea15b09c093b37de?s=128&d=identicon&r=PG", "display_name": "Laura", "link": "https://stackoverflow.com/users/3497565/laura"}, "edited": false, "score": 0, "creation_date": 1533164083, "post_id": 51643245, "comment_id": 90250943, "body": "Yes, that is clear, but it&#39;s not working nevertheless. So, there must be something that prevents the script from running, ..."}, {"owner": {"reputation": 513, "user_id": 10136122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a3d9c43c39b12b0a6a55f351fc95f7?s=128&d=identicon&r=PG", "display_name": "jcrizk", "link": "https://stackoverflow.com/users/10136122/jcrizk"}, "edited": false, "score": 0, "creation_date": 1533164331, "post_id": 51643245, "comment_id": 90250995, "body": "To make the Worksheet_Change event fire, you need to enter a value in a cell and then press enter or tab.  One more thing, make sure your Worksheet_Change event is in the correct sheet module."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533164478, "post_id": 51643245, "comment_id": 90251035, "body": "So it isn&#39;t firing for <i>user</i> interactions in the cell?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1533166338, "post_id": 51643245, "comment_id": 90251438, "body": "Maybe you turned off events without turning them back on?  That can happen if your code errors out midway.  Paste <code>Application.EnableEvents = True</code> into the Immediate pane and hit enter to make sure event handling is turned on."}, {"owner": {"reputation": 153, "user_id": 3497565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa5b0bb48d1ba636ea15b09c093b37de?s=128&d=identicon&r=PG", "display_name": "Laura", "link": "https://stackoverflow.com/users/3497565/laura"}, "edited": false, "score": 0, "creation_date": 1533168011, "post_id": 51643245, "comment_id": 90251773, "body": "No, it&#39;s not firing.  <code>msgbox Application.EnableEvents</code> returns <code>True</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1533253937, "post_id": 51643245, "comment_id": 90290551, "body": "Is this code in the <i>worksheet</i> code module, or in a regular module?  Right-click the sheet tab &gt;&gt; View Code"}], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 2, "last_activity_date": 1533214665, "last_edit_date": 1533214665, "creation_date": 1533167553, "answer_id": 51643747, "question_id": 51643245, "link": "https://stackoverflow.com/questions/51643245/worksheet-change-with-manual-calculation-application-calculation-xlmanual/51643747#51643747", "title": "Worksheet_Change with manual calculation (Application.Calculation = xlManual)", "body": "<p>I think Tim nailed it.  </p>\n\n<p>At some point in testing the code, the code stopped;  Either from and Run-time Error or manually stepping through line-by-line.  In either case, you probably changed something which forced it to reset and it never had a chance to run the most important line...<code>Application.EnableEvents = True</code>.  </p>\n\n<p>Disabling Events is a persistent state.</p>\n\n<p>It's very wise to make sure that you have error handling working to restore it, if other users are going to be using your code.  Unfortunately, you'll still break it while testing.</p>\n\n<p>I use the following routine (at the top of the main module) to fix it, when this happens:</p>\n\n<pre><code>Public Sub FixIt()\n    Application.EnableEvents = True\n    If Not ActiveWindow Is Nothing Then Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>In fact, I usually call this routine as the first line of any button I have on the Ribbon/Sheet, just to make sure that everything is working like it should be.</p>\n\n<p>In your case, you could omit the <code>Application.Calculation</code> line, or set it equal to <code>xlManual</code></p>\n"}], "owner": {"reputation": 153, "user_id": 3497565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa5b0bb48d1ba636ea15b09c093b37de?s=128&d=identicon&r=PG", "display_name": "Laura", "link": "https://stackoverflow.com/users/3497565/laura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1533214665, "creation_date": 1533163642, "last_edit_date": 1533164016, "question_id": 51643245, "link": "https://stackoverflow.com/questions/51643245/worksheet-change-with-manual-calculation-application-calculation-xlmanual", "title": "Worksheet_Change with manual calculation (Application.Calculation = xlManual)", "body": "<p>I want Excel to calculate the sheet, every time the user enters a value (<a href=\"https://www.extendoffice.com/documents/excel/4423-excel-run-macro-on-cell-change.html\" rel=\"nofollow noreferrer\">source1</a> <a href=\"https://support.microsoft.com/en-us/help/213612/how-to-run-a-macro-when-certain-cells-change-in-excel\" rel=\"nofollow noreferrer\">source2</a>):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Set KeyCells = Worksheet(\"Calc\").Range(\"R1:R100\")\n\n    MsgBox \"Check!\"\n    Application.EnableEvents = False\n    If Not Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n\n       ' Display a message when one of the designated cells has been changed.\n       MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n       'Calculate\n       Sheets(\"Calc\").Calculate\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>The sheet does not get recalculated after entry of value. Even, the message box \"Check!\" never appears. - Why is that?</p>\n\n<hr>\n\n<p>(For info: I can only guess that it has something to do with my setting the calculation to \"manual\":<br>\nI have a sheet in Workbook \"B.xlsm\" with circular references, hence I run a script from Workbook \"A.xlsm\", from where I open Workbook \"B.xlsm\":</p>\n\n<pre><code>Application.Calculation = xlManual\n[...]\nSet wb = Workbooks.Open(strPath)\n</code></pre>\n\n<p>Is there a way to get this method \"Change\" to work with manual calculation?)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1533160501, "post_id": 51642586, "comment_id": 90249974, "body": "so you want to insert 4 cells (shifting the current ones down) from columns B:E in the row of the activecell? (also please keep questions to 1 actual question. you have two here"}, {"owner": {"reputation": 17, "user_id": 10168020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4581ed1ab4ec7be2953f4b090e769290?s=128&d=identicon&r=PG&f=1", "display_name": "Jaan", "link": "https://stackoverflow.com/users/10168020/jaan"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1533161888, "post_id": 51642586, "comment_id": 90250363, "body": "@ScottHoltzman Yes, that is correct. I also removed the second question sorry about that."}, {"owner": {"reputation": 17, "user_id": 10168020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4581ed1ab4ec7be2953f4b090e769290?s=128&d=identicon&r=PG&f=1", "display_name": "Jaan", "link": "https://stackoverflow.com/users/10168020/jaan"}, "edited": false, "score": 0, "creation_date": 1533161909, "post_id": 51642586, "comment_id": 90250368, "body": "@Jeeped I have made the adjustment, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10168020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4581ed1ab4ec7be2953f4b090e769290?s=128&d=identicon&r=PG&f=1", "display_name": "Jaan", "link": "https://stackoverflow.com/users/10168020/jaan"}, "edited": false, "score": 0, "creation_date": 1533217391, "post_id": 51643184, "comment_id": 90273788, "body": "Thank you for the response. I have made that change, but it looks like it didn&#39;t make the proper action that I wanted. I was looking to have this done based on the active cell, so whichever cell I have currently clicked."}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": true, "score": 0, "last_activity_date": 1533218446, "last_edit_date": 1533218446, "creation_date": 1533163228, "answer_id": 51643184, "question_id": 51642586, "link": "https://stackoverflow.com/questions/51642586/vba-excel-insert-a-partial-row-in-active-cell/51643184#51643184", "title": "VBA Excel - Insert a partial row in active cell", "body": "<p>Since you are staring out, you might want to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>Also, the only VBA that is required to insert a few cells is </p>\n\n<pre><code>ActiveSheet.Range(\"B177:E177\").Insert Shift:=xlDown\n</code></pre>\n\n<p>...the rest of the code is just fluff &amp; tinkering and doesn't have to do with the question.  Recording Macros is a great way to quickly get pointed in the right direction and getting exposed to new properties/functions; but once you get what you need, remove the extra fluff (anything that says <code>.Select/Selection/ActiveWindow</code>) which just slows the code down anyway.</p>\n\n<hr>\n\n<p>There is a difference between <code>Activecell</code> and <code>Selection</code>.</p>\n\n<ul>\n<li><strong><em>Selection</em></strong> is a Range variable of all the cells that are selected/highlighted.</li>\n<li><strong><em>ActiveCell</em></strong> is a Range that contains only 1 cell.  The cell that is highlighted white and if you start typing the value will change.  You can change the active cell to the <em>{previous}</em>/next cell in a selection by hitting the <em>{shift+}</em> <strong><em>Tab</em></strong> key.</li>\n</ul>\n\n<p>So to insert the cells that are selected, use:</p>\n\n<pre><code>Selection.Insert Shift:=xlDown\n</code></pre>\n\n<p>for just the active cell, use:</p>\n\n<pre><code>ActiveCell.Insert Shift:=xlDown\n</code></pre>\n\n<p><em>Note: <strong>Selection/ActiveCell</strong> are always based on the <code>ActiveworkBook.Activeworksheet</code>.</em></p>\n"}], "owner": {"reputation": 17, "user_id": 10168020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4581ed1ab4ec7be2953f4b090e769290?s=128&d=identicon&r=PG&f=1", "display_name": "Jaan", "link": "https://stackoverflow.com/users/10168020/jaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 51643184, "answer_count": 1, "score": 0, "last_activity_date": 1533218446, "creation_date": 1533159375, "last_edit_date": 1533161839, "question_id": 51642586, "link": "https://stackoverflow.com/questions/51642586/vba-excel-insert-a-partial-row-in-active-cell", "title": "VBA Excel - Insert a partial row in active cell", "body": "<p>I have been experimenting with VBA code and wanted to figure out how to insert a partial row where there is an active cell (Range from B:E). </p>\n\n<p>A beginner here, will appreciate the input  </p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub Adding()\n'\n' Adding Macro\n'\n' Keyboard Shortcut: Ctrl+g\n'\n    Range(\"B177:E177\").Select\n    Selection.Insert Shift:=xlDown\n    ActiveWindow.SmallScroll Down:=-162\n    Range(\"K9\").Select\n    Selection.AutoFill Destination:=Range(\"K9:K1936\"), Type:=xlFillDefault\n    Range(\"K9:K1936\").Select\n    ActiveWindow.ScrollRow = 1904\n    ActiveWindow.ScrollRow = 1902\n    ActiveWindow.ScrollRow = 1893\n    Range(\"L177\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"Test. \"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "barcode-scanner"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533159645, "post_id": 51642555, "comment_id": 90249699, "body": "1. <code>Range(matchedCell.Address)</code> - no need to use the <code>Address</code>, just use <code>matchedCell</code> directly, since it is a <code>Range</code>. 2. To highlight the whole row, <code>matchedCell.EntireRow.Interior...</code>. 3. <code>matchedCell.Activate</code> to jump to the corresponding cell."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533160038, "post_id": 51642681, "comment_id": 90249817, "body": "Did I miss something - where are you getting the 10 from?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533160975, "post_id": 51642681, "comment_id": 90250098, "body": "I use that in place of <code>EntireRow</code> because I don&#39;t like to highlight beyond the data: OP is free to adjust to suit..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1533159893, "creation_date": 1533159893, "answer_id": 51642681, "question_id": 51642555, "link": "https://stackoverflow.com/questions/51642555/jumping-to-an-excel-cell-after-reading-a-barcode-to-see-if-there-is-a-match/51642681#51642681", "title": "Jumping to an excel cell after reading a barcode to see if there is a match", "body": "<pre><code>Private Sub CommandButton1_Click()\n\n    Dim code As Variant Dim matchedCell As Range\n\n    code = InputBox(\"Please scan a barcode and hit enter if you need to\")\n\n    Set matchedCell = Range(\"C2:C100\").Find(what:=code, LookIn:=xlValues, _\n                      lookat:=xlWhole, MatchCase:=True)\n\n    If Not matchedCell Is Nothing Then\n        With matchedCell\n            Application.Goto .Cells(1)\n            .Resize(1, 10).Interior.ColorIndex = 6\n        End With\n    Else\n        MsgBox \"Barcode Not Found\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10168007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647942a654bb4fc39d0340d99181a89b?s=128&d=identicon&r=PG&f=1", "display_name": "Erika", "link": "https://stackoverflow.com/users/10168007/erika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594211259, "creation_date": 1533159209, "last_edit_date": 1594211259, "question_id": 51642555, "link": "https://stackoverflow.com/questions/51642555/jumping-to-an-excel-cell-after-reading-a-barcode-to-see-if-there-is-a-match", "title": "Jumping to an excel cell after reading a barcode to see if there is a match", "body": "<p>I have an excel sheet with barcodes and details of products. I would like to use a barcode scanner to find items associated with those barcodes in my excel sheet (for inventory purposes) and mark them. I would like excel to jump into the corresponding cell. I have tried creating a macro by reading similar posts and this is as far as I have got:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n Dim code As Variant\n Dim matchedCell As Range\n\n\n    code = InputBox(\"Please scan a barcode and hit enter if you need to\")\n    Set matchedCell = Range(\"C2:C100\").Find(what:=code, LookIn:=xlValues, lookat:=xlWhole, MatchCase:=True)\n    If Not matchedCell Is Nothing Then\n    Range(matchedCell.Address).Interior.ColorIndex = 6\n    Else: MsgBox \"Barcode Not Found\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This only highlights the cell. Ideally, I would like to highlight the whole row. I would also like to jump to the corresponding cell. I have no experience in this and I just pulled a couple of different examples that I found online until I got this to work without error message. How can I modify this to add additional functions?</p>\n\n<p>I also have a problem with entering the barcode into the inputbox. All I can do is get it entered into a cell by scanning it or manually enter the number into the input box - how could I make it enter the scanned code into this inputbox? The cursor is in the right place, but that is ignored. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1533159368, "post_id": 51642534, "comment_id": 90249614, "body": "I gather than H2:J2 is actually B2:D2 but why isn&#39;t the square formula =H2^2?"}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533159531, "post_id": 51642534, "comment_id": 90249668, "body": "It&#39;s just an example it&#39;s not really a square formula and most of the cell references are from another sheet with 3 to 5 cell references that need to be changed with the cells that the user will fill"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1533159988, "post_id": 51642534, "comment_id": 90249804, "body": "fwiw, isn&#39;t <i>x</i> typically the base, not the height? Might be confusing in its current form."}, {"owner": {"reputation": 6953, "user_id": 4541045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfffa01cff641ad93fa459b26d3cdb4?s=128&d=identicon&r=PG&f=1", "display_name": "ti7", "link": "https://stackoverflow.com/users/4541045/ti7"}, "edited": false, "score": 0, "creation_date": 1533160311, "post_id": 51642534, "comment_id": 90249915, "body": "Make the jump to VBA or Python; you&#39;ll be happier for it. Programming in Excel formulas is fun and accessible, but the limitations quickly pile up into something horrible."}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533161092, "post_id": 51642534, "comment_id": 90250123, "body": "jumping into VBA is something that I will have to do eventually but I can&#39;t right now and for sure I can&#39;t start learning VBA to accomplish this goal and expect quick results :)"}], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533160985, "post_id": 51642674, "comment_id": 90250102, "body": "I can&#39;t verify it right now since I have to sleep atm but does your formula means that I will have to enter all my 20 formulas in this arrangement  please keep in mind that not all the cells X,Y and Z etc will be used in all the formulas some will be used others will not and so on."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533161090, "post_id": 51642674, "comment_id": 90250121, "body": "Well, I guess they have to be somewhere. If not in the formula then they would have to evaluated from a text based list."}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533161174, "post_id": 51642674, "comment_id": 90250154, "body": "evaluated as in using the depreciated evaluate function ?? if so I tried to use it and hit the 255 char limit so hard :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533161337, "post_id": 51642674, "comment_id": 90250196, "body": "Then you need to write a &#39;Swiss Army knife&#39; type UDF with a select case that will handle whichever of the 20-odd maths you want to process."}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533161955, "post_id": 51642674, "comment_id": 90250379, "body": ":( not helping man so what you want to tell me is that I hit the basic formulas limit ??"}, {"owner": {"reputation": 420, "user_id": 5800184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a4ff6e9c62c0b0dfac9fddbbe4845f?s=128&d=identicon&r=PG&f=1", "display_name": "Jbowman", "link": "https://stackoverflow.com/users/5800184/jbowman"}, "edited": false, "score": 0, "creation_date": 1533169833, "post_id": 51642674, "comment_id": 90252113, "body": "Using your variable&#39;s x, y, &amp; z, what is the longest formula? (Please show the formula)."}, {"owner": {"reputation": 420, "user_id": 5800184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a4ff6e9c62c0b0dfac9fddbbe4845f?s=128&d=identicon&r=PG&f=1", "display_name": "Jbowman", "link": "https://stackoverflow.com/users/5800184/jbowman"}, "edited": false, "score": 1, "creation_date": 1533194918, "post_id": 51642674, "comment_id": 90259282, "body": "Based on your response, there are multiple different possible entries depending on the formula selected and these entries may not be just x, y, &amp; z.  It appears that a user could have multiple other variables as would be needed for the selected formula in a different part of the sheet entirely.     As to the 255 limit, using named ranges may reduce your formula length and increase readability.   You can use substitute for the replace values/references in formulas - look at indirect()"}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "reply_to_user": {"reputation": 420, "user_id": 5800184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a4ff6e9c62c0b0dfac9fddbbe4845f?s=128&d=identicon&r=PG&f=1", "display_name": "Jbowman", "link": "https://stackoverflow.com/users/5800184/jbowman"}, "edited": false, "score": 0, "creation_date": 1533195099, "post_id": 51642674, "comment_id": 90259392, "body": "@Jbowman I left an example in my post and in this pic (it&#39;s the same formula but in it&#39;s original sheet) I have marked the variables that the user will enter in the calculation sheet i.imgur.com/s8Lf8Sn.png"}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533195254, "post_id": 51642674, "comment_id": 90259481, "body": "yeah I tried to combine indirect with substitute that was my initial plan but couldn&#39;t get it right maybe I was doing something wrong but I tried to use indirect to get the formula from the cell then substitute to replace the cell references"}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533195422, "post_id": 51642674, "comment_id": 90259564, "body": "as for the named ranges I tried to use it but it was bothersome maybe I will resort to it in the end but I can&#39;t be sure that it will overcome the 255 char limit"}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533195683, "post_id": 51642674, "comment_id": 90259700, "body": "yep as I thought named ranges won&#39;t solve this problem as the cell references that need to be changed are inside almost every functions&#39; arguments"}, {"owner": {"reputation": 420, "user_id": 5800184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a4ff6e9c62c0b0dfac9fddbbe4845f?s=128&d=identicon&r=PG&f=1", "display_name": "Jbowman", "link": "https://stackoverflow.com/users/5800184/jbowman"}, "edited": false, "score": 0, "creation_date": 1533220121, "post_id": 51642674, "comment_id": 90275764, "body": "Ok.  your Post &quot;image&quot; looks like your using <code>b2:d2</code> to gather the formula parameters/values, but the image <code>i.imgur.com&#47;s8Lf8Sn.png</code> is gathering the parameters/value from an entirely different part of the sheet (O158:O161), which does not appear to use the values from <code>b2:d2</code>.  How does O158:O167 (?) get populated?"}, {"owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "edited": false, "score": 0, "creation_date": 1533220489, "post_id": 51642674, "comment_id": 90276013, "body": "As I said before the image in the post is just an example the actual sheet has more cells for entering values and what i want to do is replace each constant cell reference from the original sheet with another variable incremental cell reference (as the row number increase) in the new sheet"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1533160557, "last_edit_date": 1533160557, "creation_date": 1533159850, "answer_id": 51642674, "question_id": 51642534, "link": "https://stackoverflow.com/questions/51642534/use-the-same-formula-multiple-times-for-multiple-cells-containing-dropdown-lists/51642674#51642674", "title": "Use the same formula multiple times for multiple cells containing dropdown lists", "body": "<p>Try this in E2 and fill down.</p>\n\n<pre><code>=CHOOSE(MATCH(LOWER(LEFT(A2)), {\"r\",\"s\",\"t\"}, 0), B2*C2, B2^2, B2*C2/2)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/YzLDA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YzLDA.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 36, "user_id": 8509453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad4f3eacb16cc44e07b7d05fa624252?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa", "link": "https://stackoverflow.com/users/8509453/mostafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533248008, "creation_date": 1533159079, "last_edit_date": 1533248008, "question_id": 51642534, "link": "https://stackoverflow.com/questions/51642534/use-the-same-formula-multiple-times-for-multiple-cells-containing-dropdown-lists", "title": "Use the same formula multiple times for multiple cells containing dropdown lists", "body": "<p>My file looks something like this \n<a href=\"https://i.stack.imgur.com/iFCqY.png\" rel=\"nofollow noreferrer\">image</a><br>\nAn IF statement would be too long considering I have 20 different long formulas.<br/><br/>\nUpdate: I later tried to use an IF statement but failed because it depended on substitute function to replace cell references in the equation but substitute returned a string which coudn't be used as a function by IF. <br/><br/>\nUser should be able to increase available rows by simply copy and insert the previous row.<br/>\n<br/>I can use index match to copy a cell's value which contain the right formula according to the dropdown list but when the user select the same item again I can't update the formula with the new values without affecting the previous cell which used the same formula.<br/><br/>I couldn't find a way to copy the same formula several times and replace cell references in it (without human interaction like search and replace) i.e. by using Substitute function which couldn't replace cell references as it looks through the cell's value not it's formula (the cell which contain the main formula).<br/><br/>Here is one of the 20 formulas I have <br/>\n<code>=(Tables!O167*144/(Tables!O158*Tables!O159)/4005)^2*INDEX(Tables!A159:L200;MATCH(INDEX(Tables!A159:A200;MATCH(TRUE;INDEX(Tables!A159:A200&gt;=Tables!O158*Tables!O159/(Tables!O160*Tables!O161);0);));Tables!A159:A200;0)+MATCH(INDEX(Tables!B159:B200;MATCH(INDEX(Tables!A159:A200;MATCH(TRUE;INDEX(Tables!A159:A200&gt;=Tables!O158*Tables!O159/(Tables!O160*Tables!O161);0);));Tables!A159:A200;0)+MATCH(INDEX(Tables!B159:B200;MATCH(TRUE;INDEX(Tables!B159:B200&gt;=Tables!O164/(2*Tables!O158*Tables!O159/(Tables!O158+Tables!O159));0);));Tables!B159:B200;0)-1;);Tables!B159:B200;0)-1;MATCH((INDEX(Tables!C158:L158;MATCH(TRUE;INDEX(Tables!C158:L158&gt;=Tables!O163;0);)));Tables!A158:L158;0))</code><br/><br/>I tried to use FORMULATEXT to convert the formula into a string then use substitute to replace the cell references then use the depreciated Evaluation function but hit the 255 char limit.<br/><br/> I searched a lot on google but to no avail, I don't mind a VBA code but a macro free method would be better, Thanks.<br/><br/></p>\n\n<p>TL;DR: Is there a way to copy a formula stored in a cell and replace some of the cell references then enter it in another cell multiple times with different cell references each time ??</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1533159405, "creation_date": 1533159405, "answer_id": 51642591, "question_id": 51642403, "link": "https://stackoverflow.com/questions/51642403/vba-to-assign-a-cell-as-an-array-formula/51642591#51642591", "title": "VBA to assign a cell as an array formula", "body": "<p>You can replace the file name before adding the formula:</p>\n\n<pre><code>Dim f As String, myFile\n\nf = \"=IF(R1C1=\"\"Total\"\",INDEX('[{file}]Sheet1'!R4C5:R8C5,MATCH(R[-53]C,\" &amp; _ \n    \"'[{file}]Sheet1'!R4C2:R8C2,0)),INDEX('[{file}]Sheet1'!R5,\" &amp; _ \n    \"MATCH(R1C1&amp;\"\"Groups\"\",'[{file}]Sheet1'!R4&amp;'[{file}]Sheet1'!R3,0)))\"\n\nmyFile = 'get your filename here...    \n\nRange(\"B55\").FormulaArray = Replace(f, \"{file}\", theFilename)\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533159909, "creation_date": 1533158366, "question_id": 51642403, "link": "https://stackoverflow.com/questions/51642403/vba-to-assign-a-cell-as-an-array-formula", "title": "VBA to assign a cell as an array formula", "body": "<p>I have a sheet called \"Total\" that I have to duplicate which contains an array formula.  When I create a copy and rename it, the array formula is no longer entered as an array.</p>\n\n<p>when I record a macro its looks like the following.</p>\n\n<pre><code>Range(\"B55\").Select\n    Selection.FormulaArray = _\n        \"=IF(R1C1=\"\"Total\"\",INDEX('[All_File.xlsm]Sheet1'!R4C5:R8C5,MATCH(R[-53]C,'[All_File.xlsm]Sheet1'!R4C2:R8C2,0)),INDEX('[All_File.xlsm]Sheet1'!R5,MATCH(R1C1&amp;\"\"Groups\"\",'[All_File.xlsm]Sheet1'!R4&amp;'[All_File.xlsm]Sheet1'!R3,0)))\"\n</code></pre>\n\n<p>This issue with this is that it is referencing the file in the formula.  The file reference can change so this recorded macro would not work.</p>\n\n<p>Is there a way to select a cell and have it be entered as an array?</p>\n\n<p>For example:</p>\n\n<pre><code> Range(\"B55\").Select\n        Selection.FormulaArray\n</code></pre>\n\n<p>the cell is being selected and entered as an array.  Again my issue with the recorded macro is that it is storing the file name, which will change, so the recorded macro cant be used again.</p>\n"}, {"tags": ["ms-access", "if-statement", "vba", "startup", "public"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1533157502, "creation_date": 1533157502, "answer_id": 51642249, "question_id": 51642129, "link": "https://stackoverflow.com/questions/51642129/docmd-deleteobject-actable-the-record-specified-on-this-form-or-report-doe/51642249#51642249", "title": "DoCmd.DeleteObject acTable - The record ... specified on this form or report does not exist", "body": "<p>The <code>TableExists</code> function is not a standard function in Access. You need to define it yourself.</p>\n\n<p>There are two main ways to define such a function, by trying and error trapping, or by iterating through all tables and checking names.</p>\n\n<p>Way 1 (error trapping):</p>\n\n<pre><code>Public Function TableExists(TableName As String) As Boolean\n    On Error Resume Next\n    TableExists = CurrentDb.TableDefs(TableName).Name = TableName\nEnd Function\n</code></pre>\n\n<p>Way 2 (iterating collection):</p>\n\n<pre><code>Public Function TableExists(TableName As String) As Boolean\n    Dim td As DAO.TableDef\n    For Each td In CurrentDb.TableDefs\n        If td.Name = TableName Then\n            TableExists = True\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>Define either of these functions in a public module, and your last approach should work</p>\n"}, {"tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1533189220, "creation_date": 1533189220, "answer_id": 51646397, "question_id": 51642129, "link": "https://stackoverflow.com/questions/51642129/docmd-deleteobject-actable-the-record-specified-on-this-form-or-report-doe/51646397#51646397", "title": "DoCmd.DeleteObject acTable - The record ... specified on this form or report does not exist", "body": "<p>I will instead modify the query to import the source data into a new table (sales_orders), which will overwrite existing data when the query runs and so I don't have to delete the table and have additional check for <code>TableExists</code> </p>\n\n<p><a href=\"https://i.stack.imgur.com/wsPMz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wsPMz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 214, "user_id": 421968, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/EyDBt.jpg?s=128&g=1", "display_name": "Sam K", "link": "https://stackoverflow.com/users/421968/sam-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 1, "accepted_answer_id": 51642249, "answer_count": 2, "score": 0, "last_activity_date": 1533189220, "creation_date": 1533156967, "last_edit_date": 1533157289, "question_id": 51642129, "link": "https://stackoverflow.com/questions/51642129/docmd-deleteobject-actable-the-record-specified-on-this-form-or-report-doe", "title": "DoCmd.DeleteObject acTable - The record ... specified on this form or report does not exist", "body": "<p>Let me start by saying I am not at all familiar with Access or VBA.  However, I am the IT guy and at some point someone created an MS Access database that does a thing and now I have to support it.</p>\n\n<p>We have a database that upon opening deletes any old data and re-runs the external query that makes this application work.  Occasionally whatever state the program exited out in that table already does not exist.  This causes MS Access to hang on the delete line and I have to run the debugger, comment out the DoCmd.DeleteObject line, re run, and then un-comment the line to let the user continue with their day.</p>\n\n<p>I want to add in some sort of conditional statement, but anything I've been able to google in terms of If...Then statements or 'TableExist' type functions always causes an error to be thrown that I haven't defined the function.  My best guess is I'm nesting this incorrectly or I'm not calling some sort of external function correctly, but as I said my VBA knowledge is extremely limited.  </p>\n\n<p>This code executes on startup:</p>\n\n<pre><code>Public Function Startup() As Integer\n\n    DoCmd.Close acForm, \"soLookup\"\n    DoCmd.DeleteObject acTable, \"sales_order\"\n    DoCmd.RunSavedImportExport \"Import-sales_order\"\n    DoCmd.OpenForm \"soLookup\"\n\nEnd Function\n</code></pre>\n\n<p>Its the </p>\n\n<pre><code>DoCmd.DeleteObject acTable, \"sales_order\"\n</code></pre>\n\n<p>Line that causes things to fail.</p>\n\n<p>I've attempted to restructure this several times based on several examples I had found, but I'll only bother with one below</p>\n\n<pre><code>Public Function Startup() As Integer\n\n    DoCmd.Close acForm, \"soLookup\"\n    If TableExists(\"sales_orders\") Then\n      DoCmd.DeleteObject acTable, \"sales_orders\"\n    Else    \n      'Do nothing\n    End If \n    DoCmd.RunSavedImportExport \"Import-sales_order\"\n    DoCmd.OpenForm \"soLookup\"\n\nEnd Function\n</code></pre>\n\n<p>Nothing I seem to try seems to give me any result other than an error of some sort.  All I want to do is add a conditional statement to this 'Startup' bit that checks if the \"sales_order\" table even if exists, and if it doesn't, then to just move on to the next comment and forget the DoCmd.DeleteObject.  How can I achieve this functionality?!  Thanks!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 7297332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VB8cW.jpg?s=128&g=1", "display_name": "jshort", "link": "https://stackoverflow.com/users/7297332/jshort"}, "is_accepted": true, "score": 0, "last_activity_date": 1533162147, "creation_date": 1533162147, "answer_id": 51643031, "question_id": 51642071, "link": "https://stackoverflow.com/questions/51642071/need-advice-on-my-update-query/51643031#51643031", "title": "Need advice on my Update Query", "body": "<p>I would recommend a Not In statement in your update query:</p>\n\n<pre><code>UPDATE MainDb SET [shipping choice] = \"IndiaPost\"\nWHERE (((pincode) Not In (select pincode from [Delhivery Pincode List])));\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10127942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b312ed84b1a34b09f442a52e2655a3?s=128&d=identicon&r=PG&f=1", "display_name": "Alphin", "link": "https://stackoverflow.com/users/10127942/alphin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 51643031, "answer_count": 1, "score": 0, "last_activity_date": 1594653100, "creation_date": 1533156688, "last_edit_date": 1594653100, "question_id": 51642071, "link": "https://stackoverflow.com/questions/51642071/need-advice-on-my-update-query", "title": "Need advice on my Update Query", "body": "<p>I'm trying create an update query which supposed to change the field value (Default value is \u201cDelhivery\") to \"IndiaPost\" when the corresponding Pin code  is not found in the table \"Pin code Whitelist\".</p>\n\n<p>It always gives me an \u201cUnknown\u201d error while running the query, even though no syntax errors were displayed. I hope these attached pictures will give you enough clarity on this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/y8jCz.jpg\" rel=\"nofollow noreferrer\">Screenshot-Main Database fields</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/vO9Ea.jpg\" rel=\"nofollow noreferrer\">Screenshot-Query Window with error</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oMeKI.jpg\" rel=\"nofollow noreferrer\">Screenshot-Table \" Pincode Whitelist\"</a></p>\n\n<h2>Correction- On the \"Screenshot-Query Window with error]\", criteria is as given bellow:</h2>\n\n<pre><code> DCount(\"*\", \"[Delhivery Pincode List]\", \"[pin]=[MainDb]![Pincode]\")\n</code></pre>\n\n<h2>Sorry for the mistake.</h2>\n\n<p>Expecting your valuable advice to identifying the mistake and fixing it.</p>\n\n<p>Thank you very much in anticipation.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1533157390, "post_id": 51642033, "comment_id": 90248894, "body": "How about to capture the default row height (probably 50) and then for each row height do an autofit. If the autofit height is (significantly?) different from the default height, keep the new height. Otherwise, set it back to the default."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1533158859, "post_id": 51642033, "comment_id": 90249439, "body": "this is possible, but we need more information. how many columns does a row space? if it&#39;s one column how long should the column be? do you want the wrap the text?"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1533159763, "creation_date": 1533159763, "answer_id": 51642659, "question_id": 51642033, "link": "https://stackoverflow.com/questions/51642033/excel-macros-vba-conditionally-resizing-rows-only-if-wrapped-text-does-not-f/51642659#51642659", "title": "Excel Macros / VBA - conditionally resizing rows only if wrapped text does not fit", "body": "<p>As explained by @PeterT in the comments, all you really need to do is try an auto-fit and reject sizes that you don't want.  I typically use this method for columns rather than rows, but the concept is the same.</p>\n\n<pre><code>Dim YourRange As Range\n'Whatever you're using to obtain a reference to it.\n\n'...\n\nDim row As Long\nFor row = 13 To YourRange.Rows.Count\n    YourRange.Rows(row).AutoFit\n    If YourRange.Rows(row).RowHeight &gt; 50 Then\n        YourRange.Rows(row).RowHeight = 50\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10167835, "user_type": "registered", "profile_image": "https://graph.facebook.com/1915311371825594/picture?type=large", "display_name": "Noah Katcher", "link": "https://stackoverflow.com/users/10167835/noah-katcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533159763, "creation_date": 1533156499, "question_id": 51642033, "link": "https://stackoverflow.com/questions/51642033/excel-macros-vba-conditionally-resizing-rows-only-if-wrapped-text-does-not-f", "title": "Excel Macros / VBA - conditionally resizing rows only if wrapped text does not fit", "body": "<p>I'm currently working on a broader macro to replicate a certain range of rows (essentially one printed sheet) any specified number of times.  The cells appear immediately below the prior (i.e. rows 13:27 are replicated in 28:42, 43:57, etc. up to whatever quantity is specified).  All formulas within the range are dynamic and rely on various references so that the content on each new \"page\" is different.  </p>\n\n<p>Sometimes the content on certain \"pages\" exceeds the space of the cell.  I'm looking for a way to check every single row after the starting point (say row 13 until whatever the last row with content is after all of the duplications) and to auto-resize the row <em>only if the row would get larger in the auto-resize</em>.  I need to maintain a minimum height for each row (50 pixels), so that the macro will only auto-resize the row if the height will increase.</p>\n\n<p>Would anyone know a way to do this efficiently?  I'm still fairly new to VBA, so I'm happy to consider any option/alternative or provide any clarification to help figure this out. Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 937, "user_id": 8447562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYRil.png?s=128&g=1", "display_name": "Symon", "link": "https://stackoverflow.com/users/8447562/symon"}, "edited": false, "score": 0, "creation_date": 1533155767, "post_id": 51641787, "comment_id": 90248161, "body": "Is the button running the code as is? Or do you have the button running a macro?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1533156312, "post_id": 51641787, "comment_id": 90248409, "body": "It&#39;s hard to tell which one of these macros are the one causing your issue -"}, {"owner": {"reputation": 1, "user_id": 10167759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96a012a2a00c4e2c035bef0dff2f01d?s=128&d=identicon&r=PG&f=1", "display_name": "Sugahoney", "link": "https://stackoverflow.com/users/10167759/sugahoney"}, "edited": false, "score": 0, "creation_date": 1533160131, "post_id": 51641787, "comment_id": 90249854, "body": "If I run it directly from the module it runs fine but once I assign the module to the button it appears to be running but the end result is blank sheets"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1533160792, "post_id": 51641787, "comment_id": 90250052, "body": "There are 12 SUB-s in the above.  What is the button assigned to???  Which SUB is executing? (you might add MsgBox or Debug.Print or just trace thru.)   There are 7 Sheets in the above  AvlRpt,  SetUp,  CloseoutData, Adults, CloseOuts Adults, Youth&amp;Ladies, CloseOuts Youth &amp; Ladies .   Which sheet(s) are being blanked.   We&#39;re here to help, and would need to be shared some more information."}, {"owner": {"reputation": 1, "user_id": 10167759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96a012a2a00c4e2c035bef0dff2f01d?s=128&d=identicon&r=PG&f=1", "display_name": "Sugahoney", "link": "https://stackoverflow.com/users/10167759/sugahoney"}, "edited": false, "score": 0, "creation_date": 1533162798, "post_id": 51641787, "comment_id": 90250596, "body": "The button is assigned to a completely different sub called RunReport which calls the 12 subs above. I am not sure if I did that correctly or not. The AvlRpt sheet is the data input sheet, the Adults and Youth&amp;Ladies sheets contains the pivot tables that are pulling from the AvlRpt sheet, the CloseOuts Adults and CloseOuts Youth &amp; Ladies sheets are copies of the data in the pivot tables. All sheets are being blanked even the data that is contained in the AvlRpt sheet. Hope that made sense. Please bear with me as I am very new to this."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1533344361, "post_id": 51641787, "comment_id": 90326199, "body": "@Sugahoney Need to share RunReport so we can see what is going on there."}], "owner": {"reputation": 1, "user_id": 10167759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96a012a2a00c4e2c035bef0dff2f01d?s=128&d=identicon&r=PG&f=1", "display_name": "Sugahoney", "link": "https://stackoverflow.com/users/10167759/sugahoney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533189497, "creation_date": 1533155304, "last_edit_date": 1533189497, "question_id": 51641787, "link": "https://stackoverflow.com/questions/51641787/vba-deleting-all-data", "title": "Vba deleting all data", "body": "<p>I am new to vba and have written some code to delete specific data and refresh 2 pivot tables. It works fine when I step through each sub but when I add the module to a button so everything is run with the press of the button all the data is deleted.</p>\n\n<p>Below is the code I have written( might be a bit cumbersome but I am still learning). I Hope someone can help me.</p>\n\n<pre><code>Sub Deleteheader()\n    ActiveWindow.FreezePanes = False\n    Rows(\"1:4\").Select\n    Selection.Delete Shift:=xlUp\nEnd Sub\n\nSub DeleteColumns()\n    Dim wsAvlRpt As Worksheet, wsSetUp As Worksheet\n\n    Set wsAvlRpt = ActiveWorkbook.Worksheets(\"AvlRpt\")\n    Set wsSetUp = ActiveWorkbook.Worksheets(\"SetUp\")\n\n    ColTotal = wsAvlRpt.UsedRange.Column + wsAvlRpt.UsedRange.Columns.Count - 1\n    LastCol = Split(Cells(1, ColTotal).Address, \"$\")(1)\n    For i = 1 To ColTotal\n        ColumnName = wsAvlRpt.Cells(1, i)\n        Values = wsSetUp.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        cntColName = Application.CountIf(wsSetUp.Range(\"A2:A\" &amp; Values), ColumnName)\n        If cntColName = 0 Then\n            wsAvlRpt.Columns(i).EntireColumn.Delete\n            i = i - 1\n            ColTotal = ColTotal - 1\n        End If\n\n        If ColTotal &lt;= i Then\n            Exit For\n        End If\n    Next i\n\n    wsAvlRpt.Columns(7).EntireColumn.Insert\n    wsAvlRpt.Range(\"G1\").Value = \"Item Desc\"\n    Columns(\"G:G\").Select\n    Selection.NumberFormat = \"General\"\nEnd Sub\n\nPublic Sub DeleteStatus()\n    Dim wsAvlRpt As Worksheet\n    Dim lngLastRow As Long\n    Dim rngAvl As Range\n\n    Set wsAvlRpt = ThisWorkbook.Worksheets(\"AvlRpt\")\n    With wsAvlRpt\n        lngLastRow = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\n        Set rngAvl = .Range(\"A2:J\" &amp; lngLastRow)\n    End With\n\n    Application.DisplayAlerts = False\n    With rngAvl\n        .AutoFilter field:=8, _\n                    Criteria1:=\"Ongoing\", _\n                    Operator:=xlOr, _\n                    Criteria2:=\"P.Label\"\n        .Offset(0).Resize(.Rows.Count).SpecialCells(xlCellTypeVisible).Rows.Delete\n    End With\n    Application.DisplayAlerts = True\n\n    With wsAvlRpt\n        .AutoFilterMode = False\n        If .FilterMode = True Then\n            .ShowAllData\n        End If\n    End With\nEnd Sub\n\nSub DeleteZeroInventory()\n    Dim wsAvlRpt As Worksheet, wsSetUp As Worksheet\n    Set wsAvlRpt = ActiveWorkbook.Worksheets(\"AvlRpt\")\n    Set wsSetUp = ActiveWorkbook.Worksheets(\"SetUp\")\n\n    cntZeroInventory = Application.CountIf(wsAvlRpt.Range(\"I:I\"), \"&lt;=0.0\")\n    If cntZeroInventory &gt; 0 Then\n        Total = wsAvlRpt.Cells(Rows.Count, \"A\").End(xlUp).Row\n        wsAvlRpt.Range(\"$A1:J\" &amp; Total).AutoFilter field:=9, Criteria1:=\"&lt;=0.0\", _\n                                                   Operator:=xlFilterValues\n        wsAvlRpt.Range(\"A2:J\" &amp; Total).Select\n        Selection.SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        wsAvlRpt.ShowAllData\n\n        wsAvlRpt.Columns(10).EntireColumn.Insert\n        wsAvlRpt.Range(\"J1\").Value = \"Available Eaches\"\n    End If\nEnd Sub\n\nSub CalcEaches()\n    Dim LastRow As Long\n\n    Sheets(\"AvlRpt\").Activate\n    LastRow = Range(\"I65536\").End(xlUp).Row\n    Range(\"I2:I\" &amp; LastRow).Select\n\n    Selection.Offset(0, 1).Select\n    Selection.FormulaR1C1 = \"= RC[-1] *12\"\n    Selection = Selection.Value\nEnd Sub\n\nSub AddItemDesc()\n    With Sheets(\"AvlRpt\")\n        .Range(\"G2:G\" &amp; .Range(\"C\" &amp; Rows.Count).End(xlUp).Row).Formula = _\n                  \"=IF(ISERROR(VLOOKUP(C2,SetUp!I:J,2,FALSE)),0,VLOOKUP(C2,SetUp!I:J,2,FALSE))\"\n        .Range(\"G2:G\" &amp; .Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value = _\n                  .Range(\"G2:G\" &amp; .Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value\n    End With\nEnd Sub\n\nSub DeleteStyles()\n    Dim wsAvlRpt As Worksheet, wsSetUp As Worksheet\n\n    Set wsAvlRpt = ActiveWorkbook.Worksheets(\"AvlRpt\")\n\n    Dim AvlRpt As Range\n    Set AvlRpt = wsAvlRpt.Range(\"A1\", Range(\"A1\").End(xlDown).End(xlToRight))\n    AvlRpt.AutoFilter field:=3, Criteria1:=Array(\"7A37\", \"8A37\", \"CO07\", \"CO81\"), _\n                      Operator:=xlFilterValues\n    AvlRpt.CurrentRegion.Offset(1, 0).Select\n\n    With Selection\n        .SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        If wsAvlRpt.FilterMode Then\n            wsAvlRpt.ShowAllData\n        End If\n    End With\nEnd Sub\n\nSub ClearContents()\n    Worksheets(\"CloseoutData\").Range(\"A2:J2000\").Clear\nEnd Sub\n\nSub CopyDeleteAvlRpt()\n    Application.DisplayAlerts = False\n\n    Sheets(\"AvlRpt\").Range(\"A2:J2000\").Copy _\n        Destination:=Sheets(\"CloseoutData\").Range(\"A2:J2000\")\n    Sheets(\"AvlRpt\").Delete\n    Application.DisplayAlerts = True\nEnd Sub\n\nSub RefreshPivots()\n    ThisWorkbook.RefreshAll\nEnd Sub\n\nSub PivotCopyAdults()\n    Dim pt As PivotTable, lRow As Long\n    Dim oWS_Copy As Worksheet, oWS_Paste As Worksheet\n\n    Set oWS_Copy = Sheets(\"Adults\")\n    Set oWS_Paste = Sheets.Add\n    ActiveSheet.Name = \"CloseOuts Adults\"\n\n    For Each pt In oWS_Copy.PivotTables\n        pt.TableRange2.Copy\n        lRow = oWS_Paste.Cells(Rows.Count, 1).End(xlUp).Row + 1\n        oWS_Paste.Range(\"A\" &amp; lRow).PasteSpecial Paste:=xlPasteValues\n        oWS_Paste.Range(\"A\" &amp; lRow).PasteSpecial Paste:=xlPasteFormats\n    Next pt\n    oWS_Paste.Cells.Columns.AutoFit\nEnd Sub\n\nSub PivotCopyYouthLadies()\n    Dim pt As PivotTable, lRow As Long\n    Dim oWS_Copy As Worksheet, oWS_Paste As Worksheet\n\n    Set oWS_Copy = Sheets(\"Youth&amp;Ladies\")\n    Set oWS_Paste = Sheets.Add\n    ActiveSheet.Name = \"CloseOuts Youth &amp; Ladies\"\n\n    For Each pt In oWS_Copy.PivotTables\n        pt.TableRange2.Copy\n        lRow = oWS_Paste.Cells(Rows.Count, 1).End(xlUp).Row + 1\n        oWS_Paste.Range(\"A\" &amp; lRow).PasteSpecial Paste:=xlPasteValues\n        oWS_Paste.Range(\"A\" &amp; lRow).PasteSpecial Paste:=xlPasteFormats\n    Next pt\n    oWS_Paste.Cells.Columns.AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1533155107, "post_id": 51641726, "comment_id": 90247864, "body": "That should be <code>xlDown</code> - the letter &quot;l&quot; as in &quot;Lima&quot; and not the number &quot;1&quot;..."}, {"owner": {"reputation": 25, "user_id": 9154021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88670c6bf5211eb08247b04dd7c7e68c?s=128&d=identicon&r=PG&f=1", "display_name": "Javier C", "link": "https://stackoverflow.com/users/9154021/javier-c"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533216999, "post_id": 51641726, "comment_id": 90273509, "body": "My bad, just a typo when I wrote this question. Didn&#39;t work either with the actual l."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9154021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88670c6bf5211eb08247b04dd7c7e68c?s=128&d=identicon&r=PG&f=1", "display_name": "Javier C", "link": "https://stackoverflow.com/users/9154021/javier-c"}, "edited": false, "score": 0, "creation_date": 1533217785, "post_id": 51641843, "comment_id": 90274073, "body": "Thanks @jeeped! Got it with a little tweak to the original code using part of what you said: <code>Sub PrintAll_IDs()     For Each myCell In Worksheets(&quot;2&quot;).Range(&quot;E2:E999&quot;).SpecialCells(xlCellTypeCons&zwnj;&#8203;tants, xlNumbers + xlTextValues)         Worksheets(&quot;1&quot;).Range(&quot;B2&quot;) = myCell.Value         Worksheets(&quot;1&quot;).PrintOut     Next myCell End Sub</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1533155546, "creation_date": 1533155546, "answer_id": 51641843, "question_id": 51641726, "link": "https://stackoverflow.com/questions/51641726/printing-dynamic-value-in-excel-while-changing-content-except-blanks/51641843#51641843", "title": "Printing dynamic value in Excel while changing content - Except blanks", "body": "<p>There are many ways to do this. Here's a couple.</p>\n\n<pre><code>option explicit\n\nSub PrintAll_IDs()\n    dim myCell  as range\n    with Worksheets(2)\n        'range with stored ID's\n        For Each myCell In .Range(.cells(1, \"A\"), .cells(.rows.count, \"A\").end(xlup))\n            ...\n        Next myCell \n    end with\nEnd Sub\n\nSub PrintAll_IDs()\n    dim myCell  as range\n    with Worksheets(2)\n        'range with stored ID's\n        For Each myCell In .Range(\"A:A\").specialcells(xlcelltypeconstants, xlnumbers+xlTextValues)\n            ...\n        Next myCell \n    end with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9154021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88670c6bf5211eb08247b04dd7c7e68c?s=128&d=identicon&r=PG&f=1", "display_name": "Javier C", "link": "https://stackoverflow.com/users/9154021/javier-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51641843, "answer_count": 1, "score": 0, "last_activity_date": 1533155546, "creation_date": 1533155037, "question_id": 51641726, "link": "https://stackoverflow.com/questions/51641726/printing-dynamic-value-in-excel-while-changing-content-except-blanks", "title": "Printing dynamic value in Excel while changing content - Except blanks", "body": "<p>I have an Excel workbook with 2 sheets: On the first one there's a form and, on the second one, a list with multiple bits of data. Using data from the second sheet, <a href=\"https://stackoverflow.com/a/29532967/9154021\">I'm using this fabulous macro</a>, which I found on SO by Branislav Koll\u00e1r to change and print fully completed forms.</p>\n\n<pre><code>Sub PrintAll_IDs()\nFor Each myCell In Worksheets(2).Range(\"A1:A50\") 'range with stored ID's\n    Worksheets(1).Range(\"A1\") = myCell.value ' \"A1\" is the cell with ID that you change manually now\n    Worksheets(1).PrintOut ' I'm not sure how to print using VBA, just showing the workflow\nNext myCell \nEnd Sub\n</code></pre>\n\n<p>The thing is that for it to work you have to manually adjust the printing range (In this case, A1:A50) and I'd like it to be fully automatic, somenthing like: Read first value in column of data table and go on until no more data is found.</p>\n\n<p>I tried adding \"If\" statements to terminate proccess if blank cells are found and also adding \".End(x1Down)\" but nothing seems to work.</p>\n\n<p>Does anyone know a way to do this?</p>\n"}, {"tags": ["excel", "vba", "pivot-table", "userform"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1533154764, "post_id": 51641473, "comment_id": 90247720, "body": "we can help you so much better if you provide your coding attempts and what is not working about them. as written this is very vague and any attempts to help may create more confusion"}, {"owner": {"reputation": 420, "user_id": 5800184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a4ff6e9c62c0b0dfac9fddbbe4845f?s=128&d=identicon&r=PG&f=1", "display_name": "Jbowman", "link": "https://stackoverflow.com/users/5800184/jbowman"}, "edited": false, "score": 0, "creation_date": 1533169091, "post_id": 51641473, "comment_id": 90251982, "body": "Have you considered slicers?"}, {"owner": {"reputation": 11, "user_id": 9942775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27739be5ba20320c536a335b472e8d49?s=128&d=identicon&r=PG&f=1", "display_name": "ajmhouser", "link": "https://stackoverflow.com/users/9942775/ajmhouser"}, "edited": false, "score": 0, "creation_date": 1533215175, "post_id": 51641473, "comment_id": 90272158, "body": "I&#39;m sorry to say that I&#39;ve never used slicers before so I&#39;ll have to read about them to see how to use them. Thank you for the suggestion."}], "owner": {"reputation": 11, "user_id": 9942775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27739be5ba20320c536a335b472e8d49?s=128&d=identicon&r=PG&f=1", "display_name": "ajmhouser", "link": "https://stackoverflow.com/users/9942775/ajmhouser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 490, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557188105, "creation_date": 1533153817, "last_edit_date": 1557188105, "question_id": 51641473, "link": "https://stackoverflow.com/questions/51641473/how-do-i-populate-an-excel-userform-combobox-with-fields-from-a-pivot-table", "title": "How do I populate an Excel userform combobox with fields from a pivot table?", "body": "<p>The users don't want to look at the spreadsheets or pivot table they want a form to choose what they want and print a report.</p>\n\n<p>I have a userform that has 3 combo boxes (Provider, Year, &amp; Quarter). When the user chooses what they need it will filter the data from the pivot table so they can print a report. I haven't managed to populate the userform comboboxes with the pivot table fields. </p>\n\n<p>I have tried putting the fields I want to filter in column section and filter section and couldn't get it to work. From another suggestion I put the sections I want in the filtered sections then renamed the cell they were in on the pivot table and that didn't work either. </p>\n\n<p>The only thing that sort of worked was putting them in filtered area then going to RowSource in Properties and putting the name of the cell, but it didn't show all the list only \"All\". Right now I have in the row section Provider &amp; Name, in the column section I have Year, Quarter &amp; Values. </p>\n\n<p>Pivot table<br>\n<a href=\"https://i.stack.imgur.com/RQ5do.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RQ5do.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I don't know if it isn't working because the userform is accessed from a command button on another userform or if it is the way I have the pivot table set up. I am using Excel 2016.</p>\n\n<p>This is my latest attempt at the code. </p>\n\n<pre><code>Sub FillcboProviderPT()\n\n    Dim ws As Worksheet\n    Dim pt As PivotTable\n    Dim pf As PivotField\n\n    Set ws = ThisWorkbook.Worksheets(\"ComReportPT\")\n    Set pt = ws.PivotTables(\"ptComReport\")\n    Set pf = pt.PivotFields(\"Provider\").LabelRange.Select\n\n    Dim Item As PivotItem\n    Dim index As Integer\n    index = 1\n\n    For Each Item In pf.PivotItems\n        Me.cboProviderPT.AddItem Item.Name\n    Next Item\n\n    Me.cboProviderPT.AddItem \"(All)\"\nEnd Sub\n\nPrivate Sub cboProviderPT_Change()\n    Dim ws As Worksheet\n    Dim pt As PivotTable\n    Dim pf As PivotField\n\n    Set ws = ThisWorkbook.Worksheets(\"ComReportPT\")\n    Set pt = ws.PivotTables(\"ptComReport\")\n    Set pf = pt.PivotFields(\"Provider\").LabelRange.Select\n\n    pf.CurrentPage = Me.cboProviderPT.Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copying"], "comments": [{"owner": {"reputation": 17, "user_id": 10141011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55381e4ef71b066fb84e1a4aa153f4af?s=128&d=identicon&r=PG&f=1", "display_name": "Nav kaur", "link": "https://stackoverflow.com/users/10141011/nav-kaur"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1533153490, "post_id": 51641185, "comment_id": 90247176, "body": "Hello Scott, I have  changed it to 1 question, thanks. It was first time so i apologize."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1533153648, "post_id": 51641185, "comment_id": 90247255, "body": "after both <code>CopyRng6</code> and <code>CopyRng7</code> you have the same line: <code>With DestSh.Cells(Last + 1, &quot;F&quot;)</code>, so of course 7 will overwrite 6 :)"}, {"owner": {"reputation": 17, "user_id": 10141011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55381e4ef71b066fb84e1a4aa153f4af?s=128&d=identicon&r=PG&f=1", "display_name": "Nav kaur", "link": "https://stackoverflow.com/users/10141011/nav-kaur"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1533153734, "post_id": 51641185, "comment_id": 90247298, "body": "I want to copy copyrng7 to go in F as well for the destsh, however once copyrng6 is pasted and underneath copyrng6"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1533153831, "post_id": 51641185, "comment_id": 90247328, "body": "then you have to refresh the <code>last</code> variable to get the new last row"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 17, "user_id": 10141011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55381e4ef71b066fb84e1a4aa153f4af?s=128&d=identicon&r=PG&f=1", "display_name": "Nav kaur", "link": "https://stackoverflow.com/users/10141011/nav-kaur"}, "edited": false, "score": 0, "creation_date": 1533159449, "post_id": 51641499, "comment_id": 90249636, "body": "@Navkaur great. please mark as answered so others get the benefit moving forward."}, {"owner": {"reputation": 17, "user_id": 10141011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55381e4ef71b066fb84e1a4aa153f4af?s=128&d=identicon&r=PG&f=1", "display_name": "Nav kaur", "link": "https://stackoverflow.com/users/10141011/nav-kaur"}, "edited": false, "score": 0, "creation_date": 1533159693, "post_id": 51641499, "comment_id": 90249710, "body": "how to mark the question as answered?by select the tick mark?"}, {"owner": {"reputation": 17, "user_id": 10141011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55381e4ef71b066fb84e1a4aa153f4af?s=128&d=identicon&r=PG&f=1", "display_name": "Nav kaur", "link": "https://stackoverflow.com/users/10141011/nav-kaur"}, "edited": false, "score": 0, "creation_date": 1533161323, "post_id": 51641499, "comment_id": 90250190, "body": "Hello Scott can you please have a look at my other question as well, I will really appreciate it. <a href=\"https://stackoverflow.com/questions/51642488/excel-vba-copying-and-filling-in-cells-as-leading-cells\" title=\"excel vba copying and filling in cells as leading cells\">stackoverflow.com/questions/51642488/&hellip;</a>"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1533153931, "creation_date": 1533153931, "answer_id": 51641499, "question_id": 51641185, "link": "https://stackoverflow.com/questions/51641185/excel-copying-from-multiple-sheets-not-working-vba/51641499#51641499", "title": "Excel copying from multiple sheets not working vba", "body": "<p>refresh the <code>last</code> variable between 6 and 7 copy to refresh the new last row on the sheet after 6 is copied:</p>\n\n<pre><code>    CopyRng6.Copy\n    With DestSh.Cells(Last + 1, \"F\")\n        .PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n        Application.CutCopyMode = False\n    End With\n\n    last = LastRow(DestSh)\n\n     CopyRng7.Copy\n    With DestSh.Cells(Last + 1, \"F\")\n        .PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n        Application.CutCopyMode = False\n    End With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10141011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55381e4ef71b066fb84e1a4aa153f4af?s=128&d=identicon&r=PG&f=1", "display_name": "Nav kaur", "link": "https://stackoverflow.com/users/10141011/nav-kaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 1, "accepted_answer_id": 51641499, "answer_count": 1, "score": 1, "last_activity_date": 1594211250, "creation_date": 1533152655, "last_edit_date": 1594211250, "question_id": 51641185, "link": "https://stackoverflow.com/questions/51641185/excel-copying-from-multiple-sheets-not-working-vba", "title": "Excel copying from multiple sheets not working vba", "body": "<p>I have assembled this code together to copy different ranges from multiple sheets to master sheet. However for copyRng 7, instead of going underneath the copyrng6, it overwrites copyrng6. </p>\n\n<pre><code>Sub CopyRangeFromMultiWorksheets()\nDim sh As Worksheet\nDim DestSh As Worksheet\nDim Last As Long\nDim CopyRng1 As Range\nDim CopyRng2 As Range\nDim CopyRng3 As Range\nDim CopyRng4 As Range\nDim CopyRng5 As Range\nDim CopyRng6 As Range\nDim CopyRng7 As Range\nDim cell As Range\nDim Row As Range\n\n\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n\nApplication.DisplayAlerts = False\n\nSet DestSh = Sheets(\"Main\")\n\n\n'loop through all worksheets and copy the data to the DestSh\nFor Each sh In ActiveWorkbook.Worksheets\n    If sh.Name &lt;&gt; DestSh.Name And sh.Name &lt;&gt; \"Main\" And sh.Name &lt;&gt; \"Master\" Then\n\n        'Find the last row with data on the DestSh\n        Last = LastRow(DestSh)\n\n        'Fill in the range that you want to copy\n        Set CopyRng1 = sh.Range(\"B3\")\n        Set CopyRng2 = sh.Range(\"C3\")\n        Set CopyRng3 = sh.Range(\"D3\")\n        Set CopyRng4 = sh.Range(\"G3\")\n        Set CopyRng5 = sh.Range(\"C5\")\n        Set CopyRng6 = sh.Range(\"A8:j25\")\n        Set CopyRng7 = sh.Range(\"A28:j44\")\n\n        'Test if there enough rows in the DestSh to copy all the data\n        If Last + CopyRng1.Rows.Count &gt; DestSh.Rows.Count Then\n            MsgBox \"There are not enough rows in the Destsh\"\n            GoTo ExitTheSub\n        End If\n\n        'This example copies values/formats, if you only want to copy the\n        'values or want to copy everything look at the example below this macro\n        CopyRng1.Copy\n        With DestSh.Cells(Last + 1, \"A\")\n            .PasteSpecial xlPasteValues\n            Application.CutCopyMode = False\n        End With\n        CopyRng2.Copy\n        With DestSh.Cells(Last + 1, \"B\")\n            .PasteSpecial xlPasteValues\n            Application.CutCopyMode = False\n        End With\n        CopyRng3.Copy\n        With DestSh.Cells(Last + 1, \"C\")\n            .PasteSpecial xlPasteValues\n            Application.CutCopyMode = False\n        End With\n\n         CopyRng4.Copy\n        With DestSh.Cells(Last + 1, \"D\")\n            .PasteSpecial xlPasteValues\n            Application.CutCopyMode = False\n        End With\n         CopyRng5.Copy\n        With DestSh.Cells(Last + 1, \"E\")\n            .PasteSpecial xlPasteValues\n            Application.CutCopyMode = False\n        End With\n\n\n        CopyRng6.Copy\n        With DestSh.Cells(Last + 1, \"F\")\n            .PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            Application.CutCopyMode = False\n        End With\n         CopyRng7.Copy\n        With DestSh.Cells(Last + 1, \"F\")\n            .PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            Application.CutCopyMode = False\n        End With\n\n\n    End If\nNext\n\n ExitTheSub:\n\nApplication.Goto DestSh.Cells(1)\n\n'AutoFit the column width in the DestSh sheet\nDestSh.Columns.AutoFit\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\nOn Error Resume Next\nLastRow = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Row\nOn Error GoTo 0\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2Yq4d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Yq4d.png\" alt=\"Master Sheet\"></a></p>\n\n<p>Thanks in advance. This is my first question I do apologize in advance for any mistake or confusion. I can offer more explanation if asked. Thanks</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1533151054, "post_id": 51640770, "comment_id": 90245951, "body": "<code>Rng.Formula = &quot;=IFERROR(AGGREGATE(15,6,ROW(INDEX(A:A,EOMONTH(TODAY(),-1)+1&zwnj;&#8203;):INDEX(A:A,EOMONTH(&zwnj;&#8203;TODAY(),0)))&#47;(WEEKDA&zwnj;&#8203;Y(ROW(INDEX(A:A,EOMO&zwnj;&#8203;NTH(TODAY(),-1)+1):I&zwnj;&#8203;NDEX(A:A,EOMONTH(TOD&zwnj;&#8203;AY(),0))),1)=6),ROW(&zwnj;&#8203;1:1)),&quot;&quot;-&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1533151214, "post_id": 51640770, "comment_id": 90246056, "body": "The other way would be to loop through dates and then check if it is friday or not"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1533151279, "post_id": 51640770, "comment_id": 90246094, "body": "^^^^ Which is exactly what the formula is doing."}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1533152356, "post_id": 51640770, "comment_id": 90246662, "body": "@SiddharthRout So basically you set the range of cells to populate with the formula text instead of having to write it to the cells manually? Makes sense, thank you for your time :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1533186111, "post_id": 51640770, "comment_id": 90255464, "body": "@Jeeped: Ah! I can see you are going to get one now :D. Awesome! It is a nice mug. I have my daily tea in it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1533186227, "post_id": 51640770, "comment_id": 90255489, "body": "@SiddharthRout, yeah, I&#39;m in the home stretch now."}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1533154915, "post_id": 51640974, "comment_id": 90247778, "body": "This also works as intended, thank you for your time :) Im going to be using @ScottCraner &#39;s vba script as i can personally undestand it a little easier. Thank you"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1533187520, "post_id": 51640974, "comment_id": 90255885, "body": "++ nice lil compact function :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 4, "last_activity_date": 1533152681, "last_edit_date": 1533152681, "creation_date": 1533151738, "answer_id": 51640974, "question_id": 51640770, "link": "https://stackoverflow.com/questions/51640770/excel-formula-vba-date-of-each-friday-of-the-current-month/51640974#51640974", "title": "Excel Formula -&gt; VBA: Date of each Friday of the current month", "body": "<p>Try this quick UDF.</p>\n\n<pre><code>Function listWeekday(dt As Long, ndx As Long, _\n                     Optional wd As Long = 6)\n    listWeekday = 7 - Weekday(DateSerial(Year(dt), Month(dt), 0), wd) + _\n                  DateSerial(Year(dt), Month(dt), 1) + _\n                  (ndx - 1) * 7\n    If Month(dt) &lt;&gt; Month(listWeekday) Then _\n        listWeekday = CVErr(xlErrNA)\n\nEnd Function\n\n'usage for Fridays in current month\n=listWeekday(today(), row(1:1))\n'usage for Sundays in current month\n=listWeekday(today(), row(1:1), 1)\n'usage for Wednesdays in current month\n=listWeekday(today(), row(1:1), 4)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1533152826, "post_id": 51641209, "comment_id": 90246889, "body": "You can use <code>DateSerial(Year(Date), Month(Date) + 1, 0)</code> to get the EOM."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1533153039, "post_id": 51641209, "comment_id": 90246971, "body": "Yeah, apparently day 0 of next month is the last day of this month."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1533153575, "post_id": 51641209, "comment_id": 90247219, "body": "so what do you think of the formula? that is one of mine from another question by this OP."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1533153862, "post_id": 51641209, "comment_id": 90247339, "body": "I used to use something similar with sumproduct. That&#39;s how I learned that today()/7+1 was the weekday according to vbsunday. It&#39;s a perfectly valid method; too bad the op chose to keep the credit for its construction."}, {"owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "edited": false, "score": 0, "creation_date": 1533154755, "post_id": 51641209, "comment_id": 90247716, "body": "Thank you @ScottCraner I really appreciate all youve done for me so far. Youve been a great help in all the questions ive asked regarding my project so far. Im going to use this for the date iteration now as it gives me a lot more flexibility when it comes to changes later on, like defining the day to work this out from. Thanks again :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1533187498, "post_id": 51641209, "comment_id": 90255880, "body": "++ Nice one Scott :)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1533152969, "last_edit_date": 1533152969, "creation_date": 1533152773, "answer_id": 51641209, "question_id": 51640770, "link": "https://stackoverflow.com/questions/51640770/excel-formula-vba-date-of-each-friday-of-the-current-month/51641209#51641209", "title": "Excel Formula -&gt; VBA: Date of each Friday of the current month", "body": "<p>This iterates the dates and puts the Fridays in Q8:Q12</p>\n\n<pre><code>Sub myFri()\n    Dim OArr(1 To 5, 1 To 1) As Variant\n    Dim k As Long\n    k = 1\n    Dim i As Long\n    For i = DateSerial(Year(Date), Month(Date), 1) To DateSerial(Year(Date), Month(Date) + 1, 0)\n        If Weekday(i, vbSunday) = 7 Then\n            OArr(k, 1) = i\n            k = k + 1\n        End If\n    Next i\n\n    If k = 5 Then OArr(k, 1) = \"-\"\n\n    Worksheets(\"Sheet1\").Range(\"Q8:Q12\").Value = OArr\n    Worksheets(\"Sheet1\").Range(\"Q8:Q12\").NumberFormat = \"mm/dd/yyyy\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 541, "user_id": 9837263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m2dRy.png?s=128&g=1", "display_name": "Batteredburrito", "link": "https://stackoverflow.com/users/9837263/batteredburrito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 51641209, "answer_count": 2, "score": 1, "last_activity_date": 1533155551, "creation_date": 1533150914, "last_edit_date": 1533155551, "question_id": 51640770, "link": "https://stackoverflow.com/questions/51640770/excel-formula-vba-date-of-each-friday-of-the-current-month", "title": "Excel Formula -&gt; VBA: Date of each Friday of the current month", "body": "<p>I have the current formula created by @ScottCraner which when pasted into Cell Q8 and Dragged down to Q12, populates the cells with the date of each friday this month:</p>\n\n<p>Code:</p>\n\n<pre><code>=IFERROR(AGGREGATE(15,6,ROW(INDEX(A:A,EOMONTH(TODAY(),-1)+1):INDEX(A:A,EOMONTH(TODAY(),0)))/(WEEKDAY(ROW(INDEX(A:A,EOMONTH(TODAY(),-1)+1):INDEX(A:A,EOMONTH(TODAY(),0))),1)=6),ROW(1:1)),\"-\")\n</code></pre>\n\n<p>Im trying to convert this into VBA as i understand VBA more than formulas. However was wondering if anyone here could possibly help.</p>\n\n<p>It really is appreciated </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1533150307, "post_id": 51640605, "comment_id": 90245592, "body": "Why the use of address  sht2.Range(Cells(1, dCol).Address,      Cells(1, dCol).Address) ?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533150350, "post_id": 51640605, "comment_id": 90245617, "body": "It should also be the same size as the range you are setting it equal to."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1533150429, "post_id": 51640605, "comment_id": 90245666, "body": "sht2.Range(sht2.Cells(1, dCol), sht2.Cells(1, dCol+2))=cRng ?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1533150557, "post_id": 51640605, "comment_id": 90245721, "body": "@QHarr to future-proof i&#39;d do <code>sht2.Range(sht2.Cells(1, dCol), sht2.Cells(1, dCol+cRng.columns.count))=cRng</code> but same answer"}, {"owner": {"reputation": 91, "user_id": 9962802, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jod51", "link": "https://stackoverflow.com/users/9962802/jod51"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533151098, "post_id": 51640605, "comment_id": 90245976, "body": "@Marcucciboy2 This worked for me. Thank you both for the above suggestions!"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1533151313, "post_id": 51640605, "comment_id": 90246119, "body": "@jod51, it&#39;s actually copying and extra cell...look at my comment"}], "answers": [{"comments": [{"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 1, "creation_date": 1533151246, "post_id": 51640676, "comment_id": 90246072, "body": "Forgot the <code>-1</code>... <code>sht2.Range(sht2.Cells(1, dCol), sht2.Cells(1, dCol+cRng.columns.count-1))</code> or better yet just <code>sht2.Cells(1, dCol).Resize(1, 3)</code>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1533152420, "last_edit_date": 1533152420, "creation_date": 1533150542, "answer_id": 51640676, "question_id": 51640605, "link": "https://stackoverflow.com/questions/51640605/auto-copy-cells-to-new-sheet-in-excel-vba/51640676#51640676", "title": "Auto Copy Cells to New Sheet in Excel VBA", "body": "<p>I would suggest lose the .Address as is not required and ensure ranges being set equal to each other are same dimensions e.g</p>\n\n<pre><code>sht2.Range(sht2.Cells(1, dCol), sht2.Cells(1, dCol+2))=cRng\n</code></pre>\n\n<p>Fully qualify the cells references inside the range to avoid errors being raised.</p>\n\n<p>Good point from @marucciboy2 re using the column count to ensure width match.</p>\n\n<pre><code>sht2.Range(sht2.Cells(1, dCol), sht2.Cells(1, dCol+cRng.columns.count-1))=cRng\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 9962802, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jod51", "link": "https://stackoverflow.com/users/9962802/jod51"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 51640676, "answer_count": 1, "score": 0, "last_activity_date": 1533152420, "creation_date": 1533150188, "question_id": 51640605, "link": "https://stackoverflow.com/questions/51640605/auto-copy-cells-to-new-sheet-in-excel-vba", "title": "Auto Copy Cells to New Sheet in Excel VBA", "body": "<p>I am using VBA to copy values from sheet \"FV\" to sheet \"AX\". I am copying three values from sheet \"FV\" which reside in cells J7, K7, and L7. My code correctly copies and pastes values J7 and K7, but for some reason L7 isn't getting copied. I am not extremely familiar with VBA, so I am having trouble figuring out the root of the issue in my code.</p>\n\n<pre><code>Sub CopyData()\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim cRng As Range\n    Dim dCol As Long\n    Set sht1 = ThisWorkbook.Sheets(\"FV\")\n    Set sht2 = ThisWorkbook.Sheets(\"AX\")\n    Set cRng = sht1.Range(\"J7:L7\")\n    dCol = sht2.Cells(1, Columns.Count).End(xlToLeft).Column + 1\n    sht2.Range(Cells(1, dCol).Address, Cells(1, dCol).Address) = cRng.Value\nEnd Sub\n</code></pre>\n\n<p>Thank you for any help!</p>\n"}, {"tags": ["excel", "vba", "autocad"], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1533842037, "post_id": 51768492, "comment_id": 90507230, "body": "With SelectionSets, does Last or Previous work?  So immediately after adding a line I could create a selection set using last?"}, {"owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1533880896, "post_id": 51768492, "comment_id": 90517474, "body": "Yes. but Last is good when You create an entity by SendCommand. When You use ModelSpace.AddLine, You have a reference, so You can Use  Dim ssobjs(0 To 1) As AcadEntity Set ssobjs(0) = lineObj  select.AddItems ssobjs"}], "tags": [], "owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "is_accepted": true, "score": 1, "last_activity_date": 1533821688, "creation_date": 1533821688, "answer_id": 51768492, "question_id": 51640449, "link": "https://stackoverflow.com/questions/51640449/filleting-lines-without-user-selection/51768492#51768492", "title": "Filleting Lines without user selection", "body": "<p>User selection You can eliminate using <code>SelectionSets</code>.</p>\n\n<pre><code>Dim Name As String\nDim selset As AcadSelectionSet\nSet selset = ThisDrawing.SelectionSets.Add(Name)\nselset.Select(acSelectionSetAll , p1, ,p2 , fileterType, filterData )\n</code></pre>\n\n<p>Where:</p>\n\n<ul>\n<li><code>Name</code> has to be unique,</li>\n<li><code>acSelectionSetAll</code> is one of available mode - read more about <code>AcSelectType</code></li>\n<li><code>p1, p2</code> are optional - means points crossing or window - helpfull in declare range of selection</li>\n<li><code>fileterType</code> and <code>filterData</code> are also optional and let You limit selection to select entities by type, color, layer and other properties.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "edited": false, "score": 0, "creation_date": 1533881569, "post_id": 51770933, "comment_id": 90517719, "body": "Some objects like layers, layouts, blocks and so one has names. it&#39;s property the same way as a color for an entity, or a start point for the line, You can easily manipulate this, if an object has such property, but unfortunately, a line has no this property, so You can not use it in the same way.  I&#39;m working on ZWCAD not AutoCAD so there may be some differences, but I suppose not in this case."}, {"owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "edited": false, "score": 1, "creation_date": 1533881649, "post_id": 51770933, "comment_id": 90517751, "body": "If a reference to the object is not what You need, and You need to identify Your entities later, You can add XData to the entity."}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 0, "last_activity_date": 1533828720, "creation_date": 1533828720, "answer_id": 51770933, "question_id": 51640449, "link": "https://stackoverflow.com/questions/51640449/filleting-lines-without-user-selection/51770933#51770933", "title": "Filleting Lines without user selection", "body": "<p>So in my on going research, I stumbled across this AutoDESK article, and some related articles as well.  It sounds like its the property I am looking for but I am not totally sure at the moment.  I am posting the link below as a reference in case others are looking for the same information.  </p>\n\n<p>Set lineObj = DWGFile.ModelSpace.AddLine(StartPoint, EndPoint)(\"Line_Name\")</p>\n\n<p><a href=\"https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-ActiveX/files/GUID-5656E0DF-64F4-4117-BA31-64E6C2C55877-htm.html\" rel=\"nofollow noreferrer\">https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-ActiveX/files/GUID-5656E0DF-64F4-4117-BA31-64E6C2C55877-htm.html</a></p>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 51768492, "answer_count": 2, "score": 1, "last_activity_date": 1594152893, "creation_date": 1533149639, "last_edit_date": 1594152893, "question_id": 51640449, "link": "https://stackoverflow.com/questions/51640449/filleting-lines-without-user-selection", "title": "Filleting Lines without user selection", "body": "<p>In my current code that I am running through excel, I am opening an AutoCAD file and adding a variety of lines.  At the moment I have built a list of coordinates, adding them to an array and then having the following command being executed through a loop:</p>\n\n<pre><code>Set lineObj = DWGFile.ModelSpace.AddLine(StartPoint, EndPoint)\n</code></pre>\n\n<p>Works great and putting the lines where I need them.  However I am not sure of how to track these lines and refer to them later.  </p>\n\n<p>Right now I am looking into filleting and chamfering two lines.  So far the example scripts I have seen have the user select the two things to be filleted/chamfered.  In my case it it might be the first lineObj added (say top line), and the third lineObj added (say right side).  Is there a nice way to do this?</p>\n\n<p>So far I have been manually calculating my chamfer coordinates and simply drawing straight lines between all coordinates. </p>\n"}, {"tags": ["excel", "vba", "3d"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1533588804, "creation_date": 1533588804, "answer_id": 51715476, "question_id": 51640272, "link": "https://stackoverflow.com/questions/51640272/rotating-3d-models-in-excel-using-vba/51715476#51715476", "title": "Rotating 3D models in Excel using VBA", "body": "<p>You didn't give a lot of background for this, but try to download the sample file from the link below and see if it helps you get going in the right direction.</p>\n\n<p><a href=\"http://www.mediafire.com/file/ued1rjexrd2by23/3d_Rotate.xls/file\" rel=\"nofollow noreferrer\">http://www.mediafire.com/file/ued1rjexrd2by23/3d_Rotate.xls/file</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/HUW5t.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HUW5t.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 10167470, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2oSHR4P0o_g/AAAAAAAAAAI/AAAAAAAAAYI/bqrHQJnQEqY/photo.jpg?sz=128", "display_name": "Anthony Lapierre", "link": "https://stackoverflow.com/users/10167470/anthony-lapierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 856, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1533588804, "creation_date": 1533148991, "question_id": 51640272, "link": "https://stackoverflow.com/questions/51640272/rotating-3d-models-in-excel-using-vba", "title": "Rotating 3D models in Excel using VBA", "body": "<p>I'm looking to rotate a 3D model (.STL) that I loaded into excel using vba code. The end goal is to have a button that rotates in X axis by a specific amount of degrees, another in Y axis and another one in Z axis.</p>\n\n<p>So far I've tried </p>\n\n<pre><code>Selection.ShapeRange.Model3D.RotationX = 303.7414166667\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Model3D.ThreeD.RotationY = 10\n</code></pre>\n\n<p>that I got from other websites but neither of those seems to work...</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1533151733, "post_id": 51640054, "comment_id": 90246329, "body": "See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Show what you have tried."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1533155538, "post_id": 51640347, "comment_id": 90248065, "body": "Hey! thanks for the quick response. It&#39;s all working well, except for the code. Can you explain what exactly it&#39;s doing? I think I&#39;m setting it up wrong. The debugger throws errors at: me.MySubFormname.Form.RecordSource = strSql. I wrote it as me.MIForm(my multiple items form).Form.Query1(my Query that I pull the info from) = strSql"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1533156784, "post_id": 51640347, "comment_id": 90248635, "body": "All the code does is create a valid SQL string. Place a debug.print &quot;your sql&quot; in your code to see/view the exact sql your producing. And then cut + paste the sql results into a new query you build (flip to sql view - paste in your sql and see if it works. And in the VBA code editor when you type in &quot;me.&quot;, then VBA should pop up a valid list of controls. Remember, the name of the sub form control is what you use here - not the name of the sub form. Access &quot;usually&quot; names the control the same as the sub form. It is assumed that  your sub form was tested separate and displays data correctly."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1533156972, "post_id": 51640347, "comment_id": 90248705, "body": "see my new edit - the sql string was a bit wrong. Add the debug.print, and thus you can see/view if the sql is correct."}, {"owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1533219254, "post_id": 51640347, "comment_id": 90275155, "body": "My debugger is still throwing errors at that last part. When I comment that part out, I don&#39;t get the SQL string. What am I doing wrong?"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1533426959, "post_id": 51640347, "comment_id": 90342577, "body": "place a debug.print strSQL in your code. When you run the code and it fails, then you can hit ctrl-g to jump to debug window. Look at the sql and then select that sql (copy), and then create  new blank query, flip into sql view mode and past in your sql - does it run? So your sql statement MUST be able to run in the standard query builder - check the syntax of the sql - is it valid and does the sql produced from the debug.print work in the query builder."}, {"owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1533569506, "post_id": 51640347, "comment_id": 90383485, "body": "I just tried that and when I hit ctrl+g I got a box titled &quot;Immediate&quot; at the bottom with &quot; select * from tblCustomer where Customer like &#39;*&#39; &quot; is this the sql?"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1533575184, "post_id": 51640347, "comment_id": 90386406, "body": "Correct - take that sql, and paste it into the query builder (flip to sql view). You can now check + test that the sql is correct and runs. (try the sql - hit the &quot;!&quot; I the query builder. It it works, then your sql is verified to be correct.  Remember, in the VBA coded editor let intel-sense pop up the list of choices. You want to ensure that your code uses the correct subform control (the sub form control does NOT necessary have the same name as the sub-form you dropped into the main form (so check for &quot;child1&quot; etc. The name of the sub form control  should pop up while coding."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 0, "last_activity_date": 1533156943, "last_edit_date": 1533156943, "creation_date": 1533149261, "answer_id": 51640347, "question_id": 51640054, "link": "https://stackoverflow.com/questions/51640054/how-do-i-make-a-search-form-in-access-365/51640347#51640347", "title": "How do I make a search form in Access 365", "body": "<p>The way you approach this is to build the search form and develop and test the search form. Get it working? You can then drop this working form into an existing \u201cnavigation form set\u201d.</p>\n\n<p>There are a gazillion ways to do this \u2013 you are quite much only limited by your imagining. However, a common setup is to create a \u201cmain\u201d form. This main form can have a few text boxes for you to type in your search values. And then you use the wizards to create a \u201cresults\u201d form (a nice form in which you display the results for the user to see + pick the results).</p>\n\n<p>In fact, you really don\u2019t have to use a form + sub form, but I find this often works somewhat better then placing the \u201ccriteria\u201d boxes in the forms heading area.</p>\n\n<p>So create main form \u2013 this form is unbound (not attached to any table in the system). Have fun, lay out the form anyway you want.</p>\n\n<p>Then use the wizards to create a multiple items form. Get that form laid out with nice columns. Now with main form in design mode, simply drag + drop in the \u201cdisplay results\u201d form. </p>\n\n<p>The result is an access form that looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zBsTH.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zBsTH.gif\" alt=\"enter image description here\"></a></p>\n\n<p>In above, note how the user \u201ctyped\u201d in some criteria.</p>\n\n<p>So you place some code in the text box \u201cafter\u201d update event. It can look like this:</p>\n\n<p>dim strSql          as string </p>\n\n<p>strSql = \"select * from tblCustomer where LastName like \" &amp; me.txtLastName \n&amp; \"*\" </p>\n\n<p>me.MySubFormname.Form.RecordSource = strSql</p>\n\n<p>So we \u201cbuild\u201d the sql on the fly, and \u201cstuff\u201d the sql right into the sub form to display the results.</p>\n\n<p>Note also in the above contines items form, we have a \u201cview\u201d or \u201cedit\u201d button when clicked can launch a detail form to the ONE record  you select. In my example I used a \u201cglasses\u201d icon for the button. The code behind that buttion is thus:</p>\n\n<p>Docmd.OpenForm \"frmEditDetails\",,,\"id = \" &amp; me!id</p>\n\n<p>edit: the sql string has to be correct, so in above, it should be:</p>\n\n<pre><code>dim strSql          as string \n\n strSql = \"select * from tblCustomer where LastName like '\" &amp; me.txtLastName &amp; \"*'\" \n debug.print strSql\n me.MySubFormname.Form.RecordSource = strSql\n</code></pre>\n\n<p>So VERY little code is required. The rest is simply whatever your fancy is in terms of how you lay out the UI.</p>\n"}], "owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1718, "favorite_count": 0, "accepted_answer_id": 51640347, "answer_count": 1, "score": 0, "last_activity_date": 1533156943, "creation_date": 1533148178, "question_id": 51640054, "link": "https://stackoverflow.com/questions/51640054/how-do-i-make-a-search-form-in-access-365", "title": "How do I make a search form in Access 365", "body": "<p>I am currently trying to make a search form for my database. I want to place it in a navigation form (so I heard I can't use a split form). I currently have a form with 4 text boxes and one combo box for a total of 5 criteria to search with a separate button for each. Underneath, is a query based on my table. This is what I have done so far</p>\n\n<p>I'm hitting a wall on how to actually perform the search though. I have never used access before this project and have no idea how to use VBA (but I do know other languages). Is it possible to perform the search using macros? If not, how would I make a search sub-procedure?</p>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1533148580, "post_id": 51639958, "comment_id": 90244747, "body": "You&#39;re missing a file extension at the end of your <code>file_name</code>. I think the template extension is <code>.xltx</code>. I can see that you&#39;re trying to use <code>FileFormat</code>, but maybe try adding the extension anyways."}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 1, "creation_date": 1533149484, "post_id": 51639958, "comment_id": 90245174, "body": "Check your path, is it <code>local</code> or <code>roaming</code> that you want?  <code>Appdata\\Local\\Roaming</code> doesn&#39;t exist."}, {"owner": {"reputation": 1073, "user_id": 1324833, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/90a0ee40beee8eb81ff9b1e7ef512aa4?s=128&d=identicon&r=PG", "display_name": "marcp", "link": "https://stackoverflow.com/users/1324833/marcp"}, "reply_to_user": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1533151326, "post_id": 51639958, "comment_id": 90246125, "body": "Good pick @Profex, make that an answer please!"}], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": true, "score": 1, "last_activity_date": 1533151545, "creation_date": 1533151545, "answer_id": 51640923, "question_id": 51639958, "link": "https://stackoverflow.com/questions/51639958/how-to-save-workbook-as-a-template/51640923#51640923", "title": "How to save workbook as a template", "body": "<p>The path is invalid, use the following, which included the <code>Roaming</code> folder:</p>\n\n<pre><code>file_name = Environ(\"appdata\") &amp; \"\\Microsoft\\Templates\\MasterIntakeForm\"\n</code></pre>\n"}], "owner": {"reputation": 1073, "user_id": 1324833, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/90a0ee40beee8eb81ff9b1e7ef512aa4?s=128&d=identicon&r=PG", "display_name": "marcp", "link": "https://stackoverflow.com/users/1324833/marcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 51640923, "answer_count": 1, "score": 0, "last_activity_date": 1533151545, "creation_date": 1533147817, "question_id": 51639958, "link": "https://stackoverflow.com/questions/51639958/how-to-save-workbook-as-a-template", "title": "How to save workbook as a template", "body": "<p>I'm creating a spreadsheet to be used as a data entry form. It has a tab with a bunch of configuration information that the master user can edit. My idea is that after making any changes I would like to save it as a template via a macro so that new workbooks can be created for users simply.</p>\n\n<p>I've found that  </p>\n\n<pre><code>file_name = Environ(\"localappdata\") &amp; \"\\Roaming\\Microsoft\\Templates\\\"\n</code></pre>\n\n<p>will return the correct path for templates however I get an exception whenever I try to save a file to that path.</p>\n\n<pre><code>file_name = Environ(\"localappdata\") &amp; \"\\Roaming\\Microsoft\\Templates\\MasterIntakeForm\"\nActiveWorkbook.SaveAs Filename:=file_name, _\n    FileFormat:=xlOpenXMLTemplateMacroEnabled, _\n    AccessMode:=xlExclusive, _\n    ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CXiDO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CXiDO.png\" alt=\"Excel error dialog\"></a></p>\n\n<p>You can see that the filename has been mangled for some reason. The file doesn't currently exist in that location so the conflict resolution part isn't the problem. Removing everything after the fileformat doesn't change anything.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533153610, "post_id": 51639770, "comment_id": 90247236, "body": "Could you please show pivot table source range headers as well?"}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "edited": false, "score": 0, "creation_date": 1533152648, "post_id": 51640724, "comment_id": 90246807, "body": "I&#39;m getting the same Run Time error when at this line: cPivotFilters.Add Type:=xlAfter, Value1:=CDbl(rFrom)"}, {"owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "edited": false, "score": 0, "creation_date": 1533153263, "post_id": 51640724, "comment_id": 90247078, "body": "In the layout I have above, I don&#39;t think &quot;Date Sold&quot; is considered a PivotFilter, I think it&#39;s considered a page field.  When I execute your code it skips the section &quot;For Each oFilter in cPivotFilters...&quot; even if &quot;Date Sold&quot; is being filtered in the PivotTable.  Am I on to something?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "edited": false, "score": 0, "creation_date": 1533153380, "post_id": 51640724, "comment_id": 90247122, "body": "Seems <code>&quot;DateSold&quot;</code> should be <code>&quot;Date Sold&quot;</code>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "edited": false, "score": 0, "creation_date": 1533157030, "post_id": 51640724, "comment_id": 90248735, "body": "@DustinBurns I missed the layout in the first place, so I made some elaborations - currently the code will not work with <code>Date Sold</code> field located in Page Field area."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "edited": false, "score": 0, "creation_date": 1533245421, "post_id": 51640724, "comment_id": 90288262, "body": "@DustinBurns I updated the answer for field located in Report Filter area."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1533245381, "last_edit_date": 1533245381, "creation_date": 1533150708, "answer_id": 51640724, "question_id": 51639770, "link": "https://stackoverflow.com/questions/51639770/filter-pivot-table-between-dates-using-cell-values/51640724#51640724", "title": "Filter Pivot Table Between Dates Using Cell Values", "body": "<p><code>Date Sold</code> field could be located in Row or Column Labels area, or Report Filter area, as shown on the screenshots:</p>\n\n<p>Row Labels area</p>\n\n<p><a href=\"https://i.stack.imgur.com/EujrA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EujrA.png\" alt=\"Row Labels area\"></a></p>\n\n<p>Report Filter area</p>\n\n<p><a href=\"https://i.stack.imgur.com/rTTKV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rTTKV.png\" alt=\"Report Filter area\"></a></p>\n\n<p>The following code should be pasted in worksheet module, and it consists of two sub-parts, the first for work with field located in Report Filter area, and the second for Row or Column Labels area:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rFrom As Range\n    Dim rUpto As Range\n    Dim lFrom As Long\n    Dim lUpto As Long\n    Dim oPivotField As PivotField\n    Dim oPivotItem As PivotItem\n    Dim sFmt As String\n    Dim bItemVisible As Boolean\n    Dim cPivotFilters As PivotFilters\n    Dim oFilter As PivotFilter\n\n    Set rFrom = ActiveSheet.Range(\"E3\")\n    Set rUpto = ActiveSheet.Range(\"I3\")\n    If Target.Address = rFrom.Address Or Target.Address = rUpto.Address Then\n        Set oPivotField = ActiveSheet.PivotTables(\"ItemsSold\").PivotFields(\"Date Sold\")\n        Select Case oPivotField.Orientation\n            ' Check if field located in Report Filter area\n            Case xlPageField\n                ' Prepare for update\n                Application.EnableEvents = False\n                Application.ScreenUpdating = False\n                On Error Resume Next ' to be sure the initial state is restored\n                ' Remove existing filters for pivot field\n                oPivotField.EnableMultiplePageItems = True\n                oPivotField.ClearAllFilters\n                ' Store current field format\n                sFmt = oPivotField.NumberFormat\n                ' Change format to compare Long type values and avoid date formats regional mess\n                oPivotField.NumberFormat = \"0\"\n                If IsDate(rFrom) Then\n                    lFrom = CLng(rFrom)\n                Else\n                    lFrom = 0\n                End If\n                If IsDate(rUpto) Then\n                    lUpto = CLng(rUpto)\n                Else\n                    lUpto = 2958465\n                End If\n                ' Loop through each page field item and check if at least one item is visible\n                For Each oPivotItem In oPivotField.PivotItems\n                    bItemVisible = oPivotItem.Value &gt;= lFrom And oPivotItem.Value &lt;= lUpto\n                    If bItemVisible Then Exit For\n                Next\n                If bItemVisible Then\n                    ' Loop through each page field item and switch visibility\n                    For Each oPivotItem In oPivotField.PivotItems\n                        oPivotItem.Visible = oPivotItem.Value &gt;= lFrom And oPivotItem.Value &lt;= lUpto\n                    Next\n                Else\n                    MsgBox \"There is no data to show for range you set\", vbInformation\n                End If\n                ' Restore initial state\n                oPivotField.NumberFormat = sFmt\n                Application.EnableEvents = True\n                Application.ScreenUpdating = True\n                On Error GoTo 0\n                ActiveSheet.PivotTables(\"ItemsSold\").RefreshTable\n            ' Check if field located in Row or Column Labels area\n            Case xlColumnField, xlRowField\n                Set cPivotFilters = oPivotField.PivotFilters\n                ' Prepare for update\n                Application.EnableEvents = False\n                Application.ScreenUpdating = False\n                On Error Resume Next ' to be sure the initial state is restored\n                ' Remove existing date filters for pivot field\n                Set cPivotFilters = ActiveSheet.PivotTables(\"ItemsSold\").PivotFields(\"Date Sold\").PivotFilters\n                For Each oFilter In cPivotFilters\n                    If _\n                        oFilter.FilterType = xlDateBetween Or _\n                        oFilter.FilterType = xlBefore Or _\n                        oFilter.FilterType = xlAfter Then _\n                            oFilter.Delete\n                Next\n                ' Add new filter regarding of set range\n                Select Case True\n                    Case IsDate(rFrom) And IsDate(rUpto)\n                        cPivotFilters.Add Type:=xlDateBetween, Value1:=CDbl(rFrom), Value2:=CDbl(rUpto)\n                    Case IsDate(rFrom)\n                        cPivotFilters.Add Type:=xlAfter, Value1:=CDbl(rFrom)\n                    Case IsDate(rUpto)\n                        cPivotFilters.Add Type:=xlBefore, Value1:=CDbl(rUpto)\n                End Select\n                ' Restore initial state\n                Application.EnableEvents = True\n                Application.ScreenUpdating = True\n                On Error GoTo 0\n                ActiveSheet.PivotTables(\"ItemsSold\").RefreshTable\n\n            Case Else\n                MsgBox \"The field should be located in Row or Column Labels area, or Report Filter area\", vbInformation\n            End Select\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1757, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547054248, "creation_date": 1533147127, "last_edit_date": 1547054248, "question_id": 51639770, "link": "https://stackoverflow.com/questions/51639770/filter-pivot-table-between-dates-using-cell-values", "title": "Filter Pivot Table Between Dates Using Cell Values", "body": "<p>I have a pivot table which lists a count of how many inventory items were sold between a date range. The to and from dates are stored in cells so the user may modify them.</p>\n\n<p>I've written code that references these cells and attempts to filter the pivot table on the sheet.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = ActiveSheet.Range(\"E3\").Address Then\n        ActiveSheet.PivotTables(\"ItemsSold\").RefreshTable\n    ElseIf Target.Address = ActiveSheet.Range(\"I3\").Address Then\n        ActiveSheet.PivotTables(\"ItemsSold\").RefreshTable\n    End If\n\n    ActiveSheet.PivotTables(\"ItemsSold\").PivotFields(\"Date Sold \").PivotFilters.Add _\n        Type:=xlDateBetween, _\n        Value1:=CLng(Range(\"E3\").value), _\n        Value2:=CLng(Range(\"I3\").value)\n\nEnd Sub\n</code></pre>\n\n<p>I get  </p>\n\n<blockquote>\n  <p>\"Run Time Error 1004:Application-defined or object-defined error\".</p>\n</blockquote>\n\n<p>Refreshing the table is working properly, but filtering it is not.  </p>\n\n<p>An additional complication:  will this work if one of the dates (say, Date From:) does not exist on the table?  For example, if I want to filter between January 1st and today, but there are no January dates in the data table, will this code still execute properly?</p>\n\n<p><a href=\"https://i.stack.imgur.com/JEMx6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JEMx6.png\" alt=\"Adding this to make sure we&#39;re all clear on the structure of the table\"></a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "edited": false, "score": 0, "creation_date": 1533148583, "post_id": 51639665, "comment_id": 90244750, "body": "I did find that objInMail.Close olDiscard immediately after the .Display will close the message window and I do get the body.  If I comment out the .Display or both statements .Display and .Close, the .Body is empty.  Any help is appreciated."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1533154624, "post_id": 51639665, "comment_id": 90247654, "body": "So what do you want to do once you change the body format?"}, {"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1533211866, "post_id": 51639665, "comment_id": 90269869, "body": "@0m3r, not sure that it makes a different, but what I do is pull some data from the incoming message, create a new message with the pulled data and send the new message."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1533842920, "creation_date": 1533842920, "answer_id": 51774499, "question_id": 51639665, "link": "https://stackoverflow.com/questions/51639665/outlook-2010-email-body-is-empty/51774499#51774499", "title": "Outlook 2010 Email body is empty", "body": "<p>If you do not need to display then:</p>\n\n<pre><code>objInMail.GetInspector\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-getinspector-property-outlook\" rel=\"nofollow noreferrer\">MailItem.GetInspector Property</a> \"... for returning an Inspector object in which to display the item ...\"</p>\n\n<p>I have seen a report that the behaviour has changed. <code>GetInspector</code> may no longer reliably replace <code>.Display</code>.</p>\n"}], "owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 563, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1592947716, "creation_date": 1533146724, "last_edit_date": 1592947716, "question_id": 51639665, "link": "https://stackoverflow.com/questions/51639665/outlook-2010-email-body-is-empty", "title": "Outlook 2010 Email body is empty", "body": "<p>I've having the worst problem with the basic .Body working.  I've read this: <a href=\"https://stackoverflow.com/questions/42348518/vba-outlook-2010-received-mail-body-is-empty\">VBA Outlook 2010 received mail .Body is empty</a> but it is old and the other question referenced in the answer(s) is not found when I click on it. Here's my basic code.</p>\n\n<pre><code>Sub AutoReplyTrap(objInMail As MailItem)\n\nDim objOutMail As Outlook.MailItem\n\nDim vText As Variant\nDim sText As String\nDim strID As String\nDim sSubject As String\nDim vItem As Variant\nDim vFirstName As Variant\nDim i As Long\nDim j As Integer\nDim strSignature As String\nDim strSigString As String\nDim strFirstName As String\nDim strFirstLetter As String\nDim strEMailAddress As String\nDim blnFirstName As Boolean\nDim blnEMail As Boolean\n\n' change the bodyformat to plain text\nobjInMail.BodyFormat = Outlook.OlBodyFormat.olFormatPlain\n\nobjInMail.Display\n\nblnFirstName = False\nblnEMail = False\nj = 0\n\n' believe there is a timing issue that Body may not be fully loaded.\n' so I'm going to pause and loop through 20 times to see if it gets loaded.\nWaitForBody:\nsText = objInMail.Body\nIf sText = \"\" Then\n    If j &lt; 20 Then\n        j = j + 1\n        Sleep 1000\n        GoTo WaitForBody\n    End If\nEnd If\n\nIf sText = \"\" Then\n    MsgBox (\"No body in email!\")\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>As you can see, I thought maybe it was a timing issue, so I built the loop to test if I have the body, and if not, wait a second and try again up to 20 times.</p>\n\n<p>Here's the interesting part...  IF I have the objInMail.Display it works, but if I remove that line it will loop through the 20 attempts and fail.  Although I wouldn't like to, I might could live with the display if I could then \"un-display\" it, but I wonder if the .close actually will close everything with the email and I'll lose the body again.</p>\n\n<p>Obviously, I'd prefer it just to work without the objInMail.Display.</p>\n\n<p>Any suggestions or recommendations?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1533147181, "post_id": 51639567, "comment_id": 90243948, "body": "you did not declare <code>FalsePositives</code> as a worksheet."}, {"owner": {"reputation": 11, "user_id": 10167282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c3963b6b3e9f3f7e56d377b6bee085?s=128&d=identicon&r=PG&f=1", "display_name": "M1tch_8989", "link": "https://stackoverflow.com/users/10167282/m1tch-8989"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1533209940, "post_id": 51639567, "comment_id": 90268589, "body": "When I &#39;Dim FalsePositives As Worksheet&#39; in the beginning I get a run time error 91 object variable or with block variable not set."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10167282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c3963b6b3e9f3f7e56d377b6bee085?s=128&d=identicon&r=PG&f=1", "display_name": "M1tch_8989", "link": "https://stackoverflow.com/users/10167282/m1tch-8989"}, "edited": false, "score": 0, "creation_date": 1533147941, "post_id": 51639597, "comment_id": 90244402, "body": "Thank you that worked perfect. Now if I wanted to filter on more than one criteria I would just add another .Range Row? The criteria would be in the same field as well. So when I cut and paste the new criteria I want it to start on the next blank row in sheet2 so it does not overlap the data that was previously put on there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 10167282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c3963b6b3e9f3f7e56d377b6bee085?s=128&d=identicon&r=PG&f=1", "display_name": "M1tch_8989", "link": "https://stackoverflow.com/users/10167282/m1tch-8989"}, "edited": false, "score": 1, "creation_date": 1533148038, "post_id": 51639597, "comment_id": 90244455, "body": "No, you would add a Criteria2 to the .AutoFilter with xlAnd or xlOr. Record yourself performing this to get the syntax."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1533147423, "last_edit_date": 1533147423, "creation_date": 1533146466, "answer_id": 51639597, "question_id": 51639567, "link": "https://stackoverflow.com/questions/51639567/vba-to-filter-cut-and-paste/51639597#51639597", "title": "VBA to filter cut and paste", "body": "<p>Copy and paste the values then return and delete the originals, skipping the header.</p>\n\n<pre><code>Sub filtertest()\n    Dim LastRow As Long\n\n    Worksheets(\"Sheet1\").Cells.Clear\n\n    With Worksheets(\"Sheet2\")\n\n        'Find the last row\n        LastRow = .Range(\"A1\").CurrentRegion.Rows.Count\n\n        'Filter table\n        .Range(\"A1:K\" &amp; LastRow).AutoFilter Field:=1, Criteria1:=\"51192\"\n\n\n        'Copy/Paste\n        .Range(\"A1:K\" &amp; LastRow).SpecialCells(xlCellTypeVisible).Copy\n        Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\n\n        'remove originals\n        .Range(\"A1:K\" &amp; LastRow).Offset(1, 0).EntireRow.Delete\n\n        'Turn off autofilter\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10167282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c3963b6b3e9f3f7e56d377b6bee085?s=128&d=identicon&r=PG&f=1", "display_name": "M1tch_8989", "link": "https://stackoverflow.com/users/10167282/m1tch-8989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2507, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565005700, "creation_date": 1533146321, "last_edit_date": 1533440858, "question_id": 51639567, "link": "https://stackoverflow.com/questions/51639567/vba-to-filter-cut-and-paste", "title": "VBA to filter cut and paste", "body": "<p>I am new to macros and VBA in general. Just trying to automate some filtering that would save me a ton of time. I have been trying to work on a macro within excel to select data, filter on certain criteria (below i have it on one filter for ease) cut, and then paste to a new sheet. I want it to also delete the empty rows from which I cut from. The code below only copies and does not delete.</p>\n\n<pre><code>Sub filtertest()\nDim LastRow As Long\n\nSheets(\"Sheet1\").Cells.Clear\nSheets(\"Sheet2\").Activate\n\n'Find the last row\nLastRow = Range(\"A1\").CurrentRegion.Rows.Count\n\n'Select Table\nRange(\"A1:K\" &amp; LastRow).Select\n\n'Filter table\nSelection.AutoFilter Field:=1, Criteria1:=\"51192\"\n\n'Copy/Paste\nSelection.Copy\nSheets(\"Sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\n\n'Turn off autofilter\nSelection.Autofilter\n\nEnd Sub\n</code></pre>\n\n<p>I also tried to mesh some other code together for this to combine it all. However I keep getting errors about an object. Not sure if it is because of the \"sub button_click()\" or what as I said I am new to this. Any help is appreciated. Thanks!</p>\n\n<pre><code>Sub Button1_Click()\n\nApplication.ScreenUpdating = False\nColumns(1).AutoFilter 1, \"51192\"\nWith Range(\"a1\", Range(\"i\" &amp; Rows.Count).End(3))\n    .Copy FalsePositives.Cells(Rows.Count, 1).End(3).Offset(1)\n    .EntireRow.Delete\nEnd With\nColumns(1).AutoFilter\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 9130442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f6057e4ae4ff55336a21ae604df13b?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Ratz", "link": "https://stackoverflow.com/users/9130442/luke-ratz"}, "edited": false, "score": 0, "creation_date": 1533145919, "post_id": 51639433, "comment_id": 90243290, "body": "The debugger makes it down till the &quot;Set Rangey&quot; on Line 16 and that&#39;s where it is going wrong!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1533146496, "post_id": 51639433, "comment_id": 90243587, "body": "You can&#39;t do a <code>Union</code> on ranges on different sheets... possible duplicate of <a href=\"https://stackoverflow.com/questions/25801941/vba-how-to-combine-two-ranges-on-different-sheets-into-one-to-loop-through\">How to combine two ranges on different sheets</a>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533150709, "post_id": 51639433, "comment_id": 90245780, "body": "What is your goal here? what would you do with these areas if you could activate them all?"}, {"owner": {"reputation": 1, "user_id": 9130442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f6057e4ae4ff55336a21ae604df13b?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Ratz", "link": "https://stackoverflow.com/users/9130442/luke-ratz"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533153123, "post_id": 51639433, "comment_id": 90247013, "body": "@Marcucciboy2 this worksheet is an annual budget and I am looking to introduce a reset function (update cell contents to zero) that I will assign to a button. The range common to all of the months is filled with decimal values. At the end of the year, I want to give them the ability to re-use the Worksheet, so resetting will help. I also want to introduce a copy/paste function where it updates the cell values to the contents of the current range across all other months."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1533153258, "post_id": 51639433, "comment_id": 90247073, "body": "@LukeRatz - you&#39;ll have to loop through the sheets, you can&#39;t do a <code>Union</code> with ranges on different sheets - and you can&#39;t <code>Select</code> or <code>Activate</code> ranges on multiple sheets either."}, {"owner": {"reputation": 1, "user_id": 9130442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f6057e4ae4ff55336a21ae604df13b?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Ratz", "link": "https://stackoverflow.com/users/9130442/luke-ratz"}, "edited": false, "score": 0, "creation_date": 1533163345, "post_id": 51639433, "comment_id": 90250755, "body": "This is where I am at so far :/  &gt;<code>Sub LaLa()TheRange = &quot;HUGE RANGE&quot; &gt;Dim WS_Count As Integer &gt;Dim I As Integer &gt;Dim sh As Worksheet &gt;WS_Count = ActiveWorkbook.Worksheets.Count &gt;For Each sh In Worksheets &gt;With sh.Range(TheRange) &gt;For I = 3 To 14 &gt;&quot;.Value= 0&quot; OR &quot;.ClearContents&quot; &gt;                .Value = 100 &gt;                Next I &gt;            End With &gt;        &#39;&#39;Random bits of code here where I manipulate selection on each worksheet &gt;        Next         &gt;End Sub</code>"}, {"owner": {"reputation": 1, "user_id": 9130442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f6057e4ae4ff55336a21ae604df13b?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Ratz", "link": "https://stackoverflow.com/users/9130442/luke-ratz"}, "edited": false, "score": 0, "creation_date": 1533163386, "post_id": 51639433, "comment_id": 90250771, "body": "Apparently I need to know the markdown for new line as well ffs."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533295249, "post_id": 51639433, "comment_id": 90305441, "body": "You probably have the markdown right but comments don\u2019t support it. Add that code as an edit to your initial comment instead"}], "answers": [{"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1533842115, "post_id": 51774011, "comment_id": 90507258, "body": "So, you answered your question and marked it as answered? Am I right?"}, {"owner": {"reputation": 1, "user_id": 9130442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f6057e4ae4ff55336a21ae604df13b?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Ratz", "link": "https://stackoverflow.com/users/9130442/luke-ratz"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1534260038, "post_id": 51774011, "comment_id": 90642941, "body": "Yes @JohnyL I was able to come up with the code I needed. Thank you, everyone, for your help!"}], "tags": [], "owner": {"reputation": 1, "user_id": 9130442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f6057e4ae4ff55336a21ae604df13b?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Ratz", "link": "https://stackoverflow.com/users/9130442/luke-ratz"}, "is_accepted": true, "score": 0, "last_activity_date": 1584380497, "last_edit_date": 1584380497, "creation_date": 1533840881, "answer_id": 51774011, "question_id": 51639433, "link": "https://stackoverflow.com/questions/51639433/how-do-i-select-the-same-range-across-multiple-sheets-in-excel-vba/51774011#51774011", "title": "How do I select the same range across multiple sheets in Excel VBA?", "body": "<p>This was what I came up with:</p>\n\n<pre><code>Sub ClearCells()\n    If MsgBox(\"This will clear all of your monthly values! Are you sure?\", vbYesNo) = vbNo Then Exit Sub\n    TheRange = \"C6:D18,C22:D31,C35:D40,C44:D48,C52:D62,C66:D71,C75:D80,H20:I27,H31:I39,H43:I48,H52:I60,H64:I70,H75:I79,H3:H5,H9:H11\"\n    Dim Sh As Worksheet\n    For Each Sh In Sheets(Array(\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"))\n        With Sh.Range(TheRange)\n                '- \".Value= 0\" OR \".ClearContents\"\n                .ClearContents\n    End With\nNext\nMsgBox (\"Sequence Complete!\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9130442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f6057e4ae4ff55336a21ae604df13b?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Ratz", "link": "https://stackoverflow.com/users/9130442/luke-ratz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 0, "accepted_answer_id": 51774011, "answer_count": 1, "score": 0, "last_activity_date": 1593589636, "creation_date": 1533145856, "last_edit_date": 1593589636, "question_id": 51639433, "link": "https://stackoverflow.com/questions/51639433/how-do-i-select-the-same-range-across-multiple-sheets-in-excel-vba", "title": "How do I select the same range across multiple sheets in Excel VBA?", "body": "<p>I am simply trying to select the same range across multiple sheets using the union method. I am getting the \"object required (ERROR 424)\" at line 16 of the code. I don't know what I am doing wrong, and have tried many different approaches!</p>\n\n<pre><code>Sub MultipleRange()\n TheRange = \"C6:D18,C22:D31,C35:D40,C44:D48,C52:D62,C66:D71,C75:D80,H20:I27,H31:I39,H43:I48,H52:I60,H64:I70,H75:I79\"\n Dim r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, r11, r12, Rangey As Range\n Set r1 = Sheets(\"Jan\").Range(TheRange)\n Set r2 = Sheets(\"Feb\").Range(TheRange)\n Set r3 = Sheets(\"Mar\").Range(TheRange)\n Set r4 = Sheets(\"Apr\").Range(TheRange)\n Set r5 = Sheets(\"May\").Range(TheRange)\n Set r6 = Sheets(\"Jun\").Range(TheRange)\n Set r7 = Sheets(\"Jul\").Range(TheRange)\n Set r8 = Sheets(\"Aug\").Range(TheRange)\n Set r9 = Sheets(\"Sep\").Range(TheRange)\n Set r10 = Sheets(\"Oct\").Range(TheRange)\n Set r11 = Sheets(\"Nov\").Range(TheRange)\n Set r12 = Sheets(\"Dec\").Range(TheRange)\n Set Rangey = xl.Application.Union(r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, r11, r12)\n Rangey.Select\n Rangey.Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1533145973, "post_id": 51639350, "comment_id": 90243320, "body": "<code>Range</code> and <code>Cells</code> are not functions available to the Excel formula engine."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1533146085, "post_id": 51639350, "comment_id": 90243370, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/42503316/11683\">How can I insert variable into formula in VBA</a>"}, {"owner": {"reputation": 383, "user_id": 9452116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB6xg.jpg?s=128&g=1", "display_name": "TempleGuard527", "link": "https://stackoverflow.com/users/9452116/templeguard527"}, "edited": false, "score": 0, "creation_date": 1533146585, "post_id": 51639350, "comment_id": 90243641, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/11707888/sum-function-in-vba\">stackoverflow.com/questions/11707888/sum-function-in-vba</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1533147722, "creation_date": 1533147722, "answer_id": 51639937, "question_id": 51639350, "link": "https://stackoverflow.com/questions/51639350/syntax-for-formula-sumrangecells41-10-cells49-10/51639937#51639937", "title": "Syntax for formula =SUM(range(cells(41,10),cells(49,10)))", "body": "<pre><code>with Worksheets(\"Sheet1\")\n   .Range(\"A1\").Formula = \"=SUM(\" &amp; .range(.cells(41,10),.cells(49,10)).Address &amp; \")\"\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10167109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908b90e332487fde1682c8c0f02e751b?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/10167109/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609761426, "creation_date": 1533145543, "last_edit_date": 1609761426, "question_id": 51639350, "link": "https://stackoverflow.com/questions/51639350/syntax-for-formula-sumrangecells41-10-cells49-10", "title": "Syntax for formula =SUM(range(cells(41,10),cells(49,10)))", "body": "<p>The &quot;formula&quot; <code>=SUM(range(cells(41,10), cells(49,10)))</code> returns &quot;#NAME&quot;?</p>\n<p>I need to create the formula with quotation and <code>&amp;</code> and place it in certain cells.<br />\nAlso the values in the <code>Cells()</code> function are variables in the code.<br />\nThe example is a result of one placement of the formula at a particular cell. I've tried a <code>:</code> also to separate the <code>cells()</code>, also tried not using <code>Range()</code>.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533151155, "post_id": 51639314, "comment_id": 90246013, "body": "I&#39;ve never done this task before, but this site might offer a solution <a href=\"https://www.myengineeringworld.net/2014/05/pdf-search-through-vba.html\" rel=\"nofollow noreferrer\">myengineeringworld.net/2014/05/pdf-search-through-vba.html</a>"}, {"owner": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533210606, "post_id": 51639314, "comment_id": 90269004, "body": "I have already tested the code which is given in the link but that code only work on Acrobat professional. The code is giving me error active x component while running the code in reader. Could you please help me on this ?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1533302496, "post_id": 51639314, "comment_id": 90309925, "body": "Sorry but I&#39;ve never attempted to do this before. It seems like something that would be solve-able by googling around"}], "owner": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533145404, "creation_date": 1533145404, "question_id": 51639314, "link": "https://stackoverflow.com/questions/51639314/search-keywords-in-pdf-and-give-page-number", "title": "Search keywords in PDF and give page number", "body": "<p>I am currently using Adobe reader x1 and I create a macro in  excel which search keywords in PDF and give page number where it find the keywords. I have found a macro which search the PDF but that macro only work on OCR. Is it possible to create the macro which also search keywords in PDF using Adobe reader XI.</p>\n"}, {"tags": ["vba", "excel", "email-attachments"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1533144710, "post_id": 51639004, "comment_id": 90242651, "body": "You&#39;ve verified the path and you&#39;ve verified the name, but you haven&#39;t verified the combination of path + filename. Which must be separated by a &quot;\\&quot; character :)"}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1533144908, "post_id": 51639004, "comment_id": 90242747, "body": "What O/S are you running that recognizes triple dots in a file specification?  That had me scratching my head.  <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20160202-00/?p=92953\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/oldnewthing/20160202-00/?p=92953</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 2, "creation_date": 1533144955, "post_id": 51639004, "comment_id": 90242770, "body": "@BillHileman that&#39;s (most likely) just a placeholder for the actual path, redacted due to some privacy concern/etc."}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1533145012, "post_id": 51639004, "comment_id": 90242790, "body": "I tried it with WIndows 10 command prompt, it returns no error and does nothing, i.e. from \\Windows\\User CD ... does nothing. but CD .. does as expected and moves to parent.  There is no grandparent shortcut."}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533145095, "post_id": 51639004, "comment_id": 90242841, "body": "@DavidZemens I thought perhaps too, but it looks like it&#39;s being literally used in the code."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1533145197, "post_id": 51639004, "comment_id": 90242901, "body": "It doesn&#39;t look like that any more than it looks like it&#39;s just a shorthand way of doing &quot;C:\\fake\\path\\to\\your\\file\\directory\\&quot;, IMO."}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1533145229, "post_id": 51639004, "comment_id": 90242917, "body": "Point taken.  Thanks."}, {"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1533145444, "post_id": 51639004, "comment_id": 90243036, "body": "David is correct-- just a fake path."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1533145231, "post_id": 51639025, "comment_id": 90242918, "body": "Ahhh so silly of me, thanks a lot. I have one more question-- your amendment worked perfectly in the case where I know the exact file name. For another attachment I&#39;m adding, the file name has the &quot;Type&quot; in it. So it&#39;s like &quot;Excel file type A - (Please insert your name here).xslx&quot; or &quot;Excel File type B - (Please insert your name here).xslx&quot;.  I&#39;m trying to add the path as such:  .Attachments.Add fileLocationSSH &amp; &quot;\\&quot; &amp; dType &amp; &quot;Excel file type &quot; &amp; dType &amp; &quot;- (Please insert your name here)&quot; &amp; &quot;.xlsx&quot;  And it&#39;s giving me the same error. Is what I&#39;m trying to do even possible? Thanks again!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 1, "creation_date": 1533145508, "post_id": 51639025, "comment_id": 90243072, "body": "@Tester_Y - to see the problem simply write <code>MsgBox fileLocationSSH &amp; &quot;\\&quot; &amp; dType &amp; &quot;Excel file type &quot; &amp; dType &amp; &quot;- (Please insert your name here)&quot; &amp; &quot;.xlsx&quot;</code>. Then examine the path. Or even <code>Debug.Print</code> instead of the <code>MsgBox</code>, so you can copy and paste. <a href=\"https://stackoverflow.com/questions/2916287/where-does-vba-debug-print-log-to\" title=\"where does vba debug print log to\">stackoverflow.com/questions/2916287/&hellip;</a>"}, {"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1533145738, "post_id": 51639025, "comment_id": 90243193, "body": "Using that made me realize that the code is not taking the &amp; dType&amp; in the actual file name. It&#39;s displaying as &quot;Excel file type - (Please insert your name here).xslx&quot;. Is there any way to amend the path based on differing file names? If not, then I will have to manually change all the file names to be the same...hmm."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1533146045, "post_id": 51639025, "comment_id": 90243348, "body": "@Tester_Y - there should be a way to change the path, definitely. Just make sure to write a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and ask a new question, I guess you would get an answer within less than 15 minutes. It is mid-day in the US, people are quite active in SO :)"}, {"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 1, "creation_date": 1533151189, "post_id": 51639025, "comment_id": 90246035, "body": "Thanks, figured it out with your help!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1533144261, "creation_date": 1533144261, "answer_id": 51639025, "question_id": 51639004, "link": "https://stackoverflow.com/questions/51639004/runtime-error-cannot-find-this-file-verify-name-file-path-correct-excel/51639025#51639025", "title": "Runtime Error - Cannot find this file; verify name &amp; file path correct (Excel / VBA)", "body": "<p>You are missing the <code>\\</code> between the <code>fileLocation</code> and the <code>letterName</code>. Thus, either write this:</p>\n\n<pre><code>.Attachments.Add fileLocationLetter &amp; \"\\\" &amp; letterName &amp; \".pdf\"\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>fileLocationLetter = \"C:\\...\\user\\Desktop\\FileLocation\\\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "is_accepted": false, "score": 0, "last_activity_date": 1533151169, "creation_date": 1533151169, "answer_id": 51640828, "question_id": 51639004, "link": "https://stackoverflow.com/questions/51639004/runtime-error-cannot-find-this-file-verify-name-file-path-correct-excel/51640828#51640828", "title": "Runtime Error - Cannot find this file; verify name &amp; file path correct (Excel / VBA)", "body": "<p>With much help from @Vityata, figured it out.</p>\n\n<p>Essentially being able to make two attachments, one is static with known file name, the second attachment's name is dependent on stored cell value. The workaround was to break the path/name of the file as stored strings. Maybe there's an easier way, but this worked for me!</p>\n\n<p>Code used:</p>\n\n<pre><code>Sub mailTest()\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\n\n'' Identify Attachments\nDim olAttachmentLetter As Outlook.Attachments\nDim olAttachmentSSH As Outlook.Attachments\n\n'' Identify Attachment Locations / Paths\nDim fileLocationLetter As String\nDim fileLocationSSH As String\nDim fileLocationSSHi As String\nDim fileLocationSSHii As String\n\n '' Type Variable, referencing cell in worksheet where \"Type\" is stored (in loop below)\n Dim dType As String\n\n '' Creating the loop - Replace 4 with end of rows. Will eventually create code to automatically identify the last cell with stored value\nFor i = 2 To 4\n\n     Set olApp = New Outlook.Application\n     Set olMail = olApp.CreateItem(olMailItem)\n\n\n     Set olAttachmentLetter = olMail.Attachments\n     Set olAttachmentSSH = olMail.Attachments\n\n\n     ''File Location for Letter\n     fileLocationLetter = \"C:\\...\\Directory\"\n\n     ''File Location for Excel sheet - Need 3 fields as file name is dynamic based on loop value\n     fileLocationSSH = \"C:\\...\\Directory\\Excel Files\"\n     fileLocationSSHi = \"Beginning of File name...\"\n     fileLocationSSHii = \" ... End of File name\"\n\n\n     letterName = \"Name of PDF attachment\"\n\n\n     dType = Worksheets(\"Test1\").Cells(i, 2).Value\n\n     ''Body of Email - Each new line represents new value (linking to hidden worksheet in Excel doc)\n     mailBody = \"Hello \" _\n                 &amp; Worksheets(\"Test1\").Cells(i, 4) _\n                 &amp; \",\" _\n                 &amp; Worksheets(\"BODY\").Cells(2, 1).Value _\n                 &amp; Worksheets(\"BODY\").Cells(3, 1).Value _\n                 &amp; Worksheets(\"BODY\").Cells(4, 1).Value &amp; \" \" &amp; dType _\n                 &amp; Worksheets(\"BODY\").Cells(5, 1).Value _\n                 &amp; Worksheets(\"BODY\").Cells(6, 1).Value _\n                 &amp; Worksheets(\"BODY\").Cells(7, 1).Value\n\n\n     With olMail\n         .To = Worksheets(\"Test1\").Cells(i, 5).Value\n         .Subject = Worksheets(\"Test1\").Cells(i, 3).Value \n         .HTMLBody = \"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;style&gt;\"\n         .HTMLBody = .HTMLBody &amp; \"body{font-family: Calibri, \"\"Times New Roman\"\", sans-serif; font-size: 13px}\"\n         .HTMLBody = .HTMLBody &amp; \"&lt;/style&gt;&lt;/head&gt;&lt;body&gt;\"\n         .HTMLBody = .HTMLBody &amp; mailBody &amp; \"&lt;/body&gt;&lt;/html&gt;\"\n\n      '' Adding attachments, referencing file locations and amending file name if needed\n         .Attachments.Add fileLocationLetter &amp; \"\\\" &amp; letterName &amp; \".pdf\"\n         .Attachments.Add fileLocationSSH &amp; \"\\\" &amp; dType &amp; \"\\\" &amp; fileLocationSSHi &amp; dType &amp; fileLocationSSHii &amp; \".xlsx\"\n\n            .Display\n         '' .Send (Once ready to send)\n\n    End With\n\n\n    Set olMail = Nothing\n    Set olApp = Nothing\n\nNext\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1440, "favorite_count": 0, "accepted_answer_id": 51639025, "answer_count": 2, "score": 2, "last_activity_date": 1533151169, "creation_date": 1533144190, "last_edit_date": 1533144738, "question_id": 51639004, "link": "https://stackoverflow.com/questions/51639004/runtime-error-cannot-find-this-file-verify-name-file-path-correct-excel", "title": "Runtime Error - Cannot find this file; verify name &amp; file path correct (Excel / VBA)", "body": "<p>Running into error message in title when attempting to link attachments to email. The attachments are stored in Folder Names respective to the \"type\" of company, which is why I'm attempting to add a for loop to retrieve \"type\" from spreadsheet.</p>\n\n<pre><code>Sub mailTest()\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\nDim olAttachmentLetter As Outlook.Attachments    \nDim fileLocationLetter As String\nDim dType As String\n\nFor i = 2 To 3\n\n    Set olApp = New Outlook.Application\n    Set olMail = olApp.CreateItem(olMailItem)\n    Set olAttachmentLetter = olMail.Attachments\n    fileLocationLetter = \"C:\\...\\user\\Desktop\\FileLocation\"\n    letterName = \"TestLetter1\"\n    dType = Worksheets(\"Test1\").Cells(i, 2).Value\n\n    mailBody = \"Hello \" _\n                &amp; Worksheets(\"Test1\").Cells(i, 4) _\n                &amp; \",\" _\n                &amp; Worksheets(\"BODY\").Cells(2, 1).Value _\n                &amp; Worksheets(\"BODY\").Cells(3, 1).Value _\n                &amp; Worksheets(\"BODY\").Cells(4, 1).Value &amp; \" \" &amp; dType _\n                &amp; Worksheets(\"BODY\").Cells(5, 1).Value &amp; \" TTT\" &amp; dType &amp; \"xx18\" _\n                &amp; Worksheets(\"BODY\").Cells(6, 1).Value _\n                &amp; Worksheets(\"BODY\").Cells(7, 1).Value\n\n     With olMail\n        .To = Worksheets(\"Test1\").Cells(i, 5).Value\n        .Subject = Worksheets(\"Test1\").Cells(i, 3).Value &amp; \" - \"\n        .HTMLBody = \"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;style&gt;\"\n        .HTMLBody = .HTMLBody &amp; \"body{font-family: Calibri, \"\"Times New Roman\"\", sans-serif; font-size: 13px}\"\n        .HTMLBody = .HTMLBody &amp; \"&lt;/style&gt;&lt;/head&gt;&lt;body&gt;\"\n        .HTMLBody = .HTMLBody &amp; mailBody &amp; \"&lt;/body&gt;&lt;/html&gt;\"\n\n        ''Adding attachment\n        .Attachments.Add fileLocationLetter &amp; letterName &amp; \".pdf\"\n        .Display\n        '' .Send (Once ready to send)\n    End With\n    Set olMail = Nothing\n    Set olApp = Nothing\nNext\nEnd Sub\n</code></pre>\n\n<p>What am I doing wrong here? The file is stored in 'C:...\\user\\Desktop\\FileLocation\\TestLetter1.pdf'</p>\n\n<p>Thank you kindly.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1533144718, "post_id": 51638951, "comment_id": 90242659, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pagesetup-fittopageswide-property-excel\" rel=\"nofollow noreferrer\">from here:</a> &quot;If the <code>PageSetup.Zoom</code> property is True , the FitToPagesWide property is ignored.&quot; So maybe try setting <code>.Zoom</code> to false right above the line you&#39;re getting an error on?"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1533193095, "post_id": 51638951, "comment_id": 90258260, "body": "<code>FitToPagesWide</code> is a tricky one. Its value can either be a pozitiv integer or <code>False</code> (=reset). Definitely not 0, negativ or <code>True</code>."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 8716904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f7abf068ff7f953a76fee034d0e78?s=128&d=identicon&r=PG&f=1", "display_name": "CAW", "link": "https://stackoverflow.com/users/8716904/caw"}, "is_accepted": true, "score": 2, "last_activity_date": 1533329058, "creation_date": 1533329058, "answer_id": 51679888, "question_id": 51638951, "link": "https://stackoverflow.com/questions/51638951/unable-to-set-specific-property-of-pagesetup/51679888#51679888", "title": "Unable to set specific property of PageSetup", "body": "<p>Add:</p>\n\n<pre><code> Application.PrintCommunication = False\n</code></pre>\n\n<p>before setting the print parameters, then</p>\n\n<pre><code> Application.PrintCommunication = True\n</code></pre>\n\n<p>after they're finished.   This prevents the error, and the print area is properly set and properly prints when tested - with the area fit to page width of whatever printer you use.  </p>\n"}], "owner": {"reputation": 63, "user_id": 8716904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f7abf068ff7f953a76fee034d0e78?s=128&d=identicon&r=PG&f=1", "display_name": "CAW", "link": "https://stackoverflow.com/users/8716904/caw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1928, "favorite_count": 0, "accepted_answer_id": 51679888, "answer_count": 1, "score": 1, "last_activity_date": 1533329058, "creation_date": 1533144007, "question_id": 51638951, "link": "https://stackoverflow.com/questions/51638951/unable-to-set-specific-property-of-pagesetup", "title": "Unable to set specific property of PageSetup", "body": "<pre><code>With ActiveSheet.PageSetup\n    .PrintArea = Cells(1, 1).Resize(LR, 16).Address\n    .Orientation = xlLandscape\n    .LeftMargin = Application.InchesToPoints(0.2)\n    .RightMargin = Application.InchesToPoints(0.2)\n    .TopMargin = Application.InchesToPoints(0.5)\n    .BottomMargin = Application.InchesToPoints(0.5)\n    .FitToPagesWide = True\n    .FitToPagesTall = False\nEnd With\n</code></pre>\n\n<p>All properties are accepted <strong>except</strong> <code>.FitToPagesWide</code></p>\n\n<p>I get RT1004 - Unable to set property of the PageSetup class ONLY for this parameter.  </p>\n\n<p>All other properties are set correctly and operate as expected when I actually print the sheet.   I have another program that uses the same code block, and it works properly on several computers.</p>\n"}, {"tags": ["vba", "ms-word", "office365", "word-2016"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1534549561, "creation_date": 1534549561, "answer_id": 51904051, "question_id": 51638532, "link": "https://stackoverflow.com/questions/51638532/document-events-disabled-in-macro-word-2016-after-july-2018-update/51904051#51904051", "title": "Document Events disabled in macro (Word 2016) after july 2018 update", "body": "<p>This was the result of a recent Office update. It's supposed to have been fixed since.</p>\n"}], "owner": {"reputation": 1, "user_id": 10166985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4186ec72823b1e553815ec1c9f6eff14?s=128&d=identicon&r=PG&f=1", "display_name": "VD_", "link": "https://stackoverflow.com/users/10166985/vd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593730916, "creation_date": 1533142200, "last_edit_date": 1593730916, "question_id": 51638532, "link": "https://stackoverflow.com/questions/51638532/document-events-disabled-in-macro-word-2016-after-july-2018-update", "title": "Document Events disabled in macro (Word 2016) after july 2018 update", "body": "<p>Since an update of Office 365 Business from version 1806 (build 16.0.10228.20134) to 1807 (build 16.0.10325.20082), our word macro code inside document events procedures (Document_Open(), Document_Close(), ...) don't trigger anymore.</p>\n\n<p>Tested with a simple VBA code :</p>\n\n<pre><code>Private Sub Document_Open()\n    MsgBox \"test\"\nEnd Sub\n</code></pre>\n\n<p>Before the update, the message box was displayed when opening the document.\nAfter the update, the code is not triggered automatically when opening the document (but the procedure works when executed manually).</p>\n\n<p>Do you know where it comes from ?</p>\n"}, {"tags": ["sql", "vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533143333, "post_id": 51638421, "comment_id": 90241991, "body": "I tried your code and it worked fine for me. What do you mean with <code>Returns Nothing</code>?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1533143505, "post_id": 51638421, "comment_id": 90242082, "body": "Your SQL statement is missing a few quotation marks -- <code>&quot;Select ... [sheet$]&quot;</code>"}, {"owner": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "edited": false, "score": 0, "creation_date": 1533143669, "post_id": 51638421, "comment_id": 90242160, "body": "Sorry I do have those in the original stmt. I&#39;ll change that"}, {"owner": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533143750, "post_id": 51638421, "comment_id": 90242192, "body": "@Storax it returns the string &quot;NULL&quot; although I am sure there is sth in that row or sometimes just &quot;&quot;"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533143797, "post_id": 51638421, "comment_id": 90242208, "body": "I could reproduce your problem. Is it possible that one of your date fields is actually text. At least that&#39;s the way I was able to reproduce the issue. In this case ADODB will just ignore the content of the cell in excel."}, {"owner": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "edited": false, "score": 0, "creation_date": 1533143908, "post_id": 51638421, "comment_id": 90242268, "body": "It is a custom in German &quot;benutzerdefiniert&quot; formatted cell"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533143959, "post_id": 51638421, "comment_id": 90242291, "body": "@Storax You mean one of the values in the date field? and the other is indeed a date, which confuses Excel? Otherwise, why doesn&#39;t ADODB interpret it as a text field?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1533144017, "post_id": 51638421, "comment_id": 90242316, "body": "Check if the first character is <code>&#39;</code>."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1533144437, "post_id": 51638421, "comment_id": 90242530, "body": "@Zev Spitz: Yes, on of the values in the date field is text and the other are dates."}], "answers": [{"comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1533144404, "post_id": 51639002, "comment_id": 90242513, "body": "Does this affect all the rows? Or only the row with the text data in it?"}, {"owner": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "edited": false, "score": 0, "creation_date": 1533144537, "post_id": 51639002, "comment_id": 90242577, "body": "For me it says adVarWChar. I formatted all cells to text, but the issue persists. I do have some empty cells in the date column. Could that be the issue? Thanks a lot for helping me!!!"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533144696, "post_id": 51639002, "comment_id": 90242645, "body": "I also formatted all cells to text then I also get the data type adVarWChar but I also get a result"}, {"owner": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "edited": false, "score": 0, "creation_date": 1533144817, "post_id": 51639002, "comment_id": 90242712, "body": "Then the issue is somewhere with my data  :/"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533144911, "post_id": 51639002, "comment_id": 90242749, "body": "Maybe but you could also try to change the import mode"}, {"owner": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "edited": false, "score": 0, "creation_date": 1533144969, "post_id": 51639002, "comment_id": 90242774, "body": "where do I change the import Mode? Or do you mean not using SQL at all?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533145017, "post_id": 51639002, "comment_id": 90242797, "body": "In the connection string"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "edited": false, "score": 0, "creation_date": 1533145722, "post_id": 51639002, "comment_id": 90243187, "body": "@PalimPalim Will formatting as text change the data type? Don&#39;t you have to change the value of the cell by starting it with a <code>&#39;</code> in order for it to actually be text?"}, {"owner": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "edited": false, "score": 1, "creation_date": 1533146478, "post_id": 51639002, "comment_id": 90243571, "body": "Didn&#39;t see your update but ended up with the same solution IMEX=1 solves all my issues, no need to format or anything. Cheers man!"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 2, "last_activity_date": 1533146759, "last_edit_date": 1533146759, "creation_date": 1533144188, "answer_id": 51639002, "question_id": 51638421, "link": "https://stackoverflow.com/questions/51638421/extract-excel-data-via-sql-date-column-not-working/51639002#51639002", "title": "extract excel data via sql; date column not working", "body": "<p>I was able to re-produce the issue, maybe this is of help</p>\n\n<p><a href=\"https://i.stack.imgur.com/DFNzf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DFNzf.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This looks fine but I changed the first cell with a date to text. Debugging the code will give you</p>\n\n<p><a href=\"https://i.stack.imgur.com/SVFL3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SVFL3.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So, ADODB expects a date, Type is adDate and converts text to an empty string.</p>\n\n<blockquote>\n  <p><strong>The following update solved the problem in the end</strong></p>\n</blockquote>\n\n<p><strong>UPDATE</strong> It might help to change the connection string to</p>\n\n<pre><code>objConnection.Open \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; path &amp; \";Extended Properties=\"\"Excel 8.0;HDR=Yes;IMEX=1\"\"\"\n</code></pre>\n\n<p>For further information look <a href=\"https://support.microsoft.com/de-de/help/509360\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2416, "user_id": 6646710, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8DG9m.jpg?s=128&g=1", "display_name": "PalimPalim", "link": "https://stackoverflow.com/users/6646710/palimpalim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 51639002, "answer_count": 1, "score": 0, "last_activity_date": 1533146759, "creation_date": 1533141789, "last_edit_date": 1533143696, "question_id": 51638421, "link": "https://stackoverflow.com/questions/51638421/extract-excel-data-via-sql-date-column-not-working", "title": "extract excel data via sql; date column not working", "body": "<p>I am using the function below to extract data from another workbook. It works for non-Date columns, but does not work for a column which holds dates</p>\n\n<p>Worksheet looks like</p>\n\n<p><a href=\"https://i.stack.imgur.com/k7w8D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k7w8D.png\" alt=\"enter image description here\"></a></p>\n\n<p>Works if is <strong>not a date column</strong>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print GetSheetSQL(workbookPath, \"Select columna from [sheet$]\")(1)(\"columna\")\n</code></pre>\n\n<p>--> Returns \"palim\"</p>\n\n<p>Does not work if a is a <strong>date column</strong>    </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print GetSheetSQL(workbookPath, \"Select columnb from [sheet$]\")(1)(\"columnb\")\n</code></pre>\n\n<p>--> Returns Nothing</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function GetSheetSQL(path As String, sqlStr As String) As Collection\n\n'''''''''''''''''''''''''''''''''''''''\n'Open ADOB Connection and query via sql\n'   Connection string is standard and\n'   taken from:\n'        https://www.connectionstrings.com/microsoft-jet-ole-db-4-0/standard-excel/\n\nDim objConnection As Object\nDim objRecordSet As Object\nSet objConnection = CreateObject(\"ADODB.Connection\")\nSet objRecordSet = CreateObject(\"ADODB.Recordset\")\n\nConst adOpenStatic = 3\nConst adLockOptimistic = 3\nConst adCmdText = &amp;H1\n\nobjConnection.Open \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; path &amp; \";Extended Properties=\"\"Excel 8.0;HDR=Yes\"\"\"\n\nobjRecordSet.Open sqlStr, objConnection, adOpenStatic, adLockOptimistic, adCmdText\n'''''''''''''''''''''''''''''''''''''''\n'Iterate through queried table\n'   table is a collection with a row per row in the table\n'   row is a dictionary with table headings as key, returning the corresponding value\nDim table As Collection\nSet table = New Collection\nDim row As Object\nDim fld\n'iterate through recordset rows\nDo Until objRecordSet.EOF\n    With objRecordSet\n        Set row = CreateObject(\"Scripting.Dictionary\")\n\n        For Each fld In .Fields\n            row.Add fld.Name, fld.Value\n        Next fld\n\n        table.Add row\n\n        .MoveNext\n\n    End With\nLoop\n\nSet GetSheetSQL = table\n\n'Close Connection; reset Error Handling to default\nobjConnection.Close\nOn Error GoTo 0\nExit Function\nErrorCloseConn:\n    objConnection.Close\n    On Error GoTo 0\n    Resume\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "setfocus", "subforms"], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 9688044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eftHgFBDQQI/AAAAAAAAAAI/AAAAAAAAABE/CKk1xgw0q3o/photo.jpg?sz=128", "display_name": "Rafa3lOneiL", "link": "https://stackoverflow.com/users/9688044/rafa3loneil"}, "is_accepted": false, "score": 0, "last_activity_date": 1533586298, "creation_date": 1533586298, "answer_id": 51714953, "question_id": 51638352, "link": "https://stackoverflow.com/questions/51638352/access-vba-set-focus-in-column/51714953#51714953", "title": "Access VBA Set Focus in Column", "body": "<p>Well, I did not have any help here but I managed to resolve after a few attempts and errors, just to code a code in the event of each column of the subformaluario to make it work. Good luck to everyone</p>\n\n<pre><code>Private Sub CNPJ_AF_GotFocus()\n\nMe.Form!SENHA.InputMask = \"Password\"\n\nEnd Sub\n\nPrivate Sub SENHA_GotFocus()\n\nMe.Form!SENHA.InputMask = \"\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9688044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eftHgFBDQQI/AAAAAAAAAAI/AAAAAAAAABE/CKk1xgw0q3o/photo.jpg?sz=128", "display_name": "Rafa3lOneiL", "link": "https://stackoverflow.com/users/9688044/rafa3loneil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535026583, "creation_date": 1533141504, "last_edit_date": 1535026583, "question_id": 51638352, "link": "https://stackoverflow.com/questions/51638352/access-vba-set-focus-in-column", "title": "Access VBA Set Focus in Column", "body": "<p>good afternoon,</p>\n\n<p>I have an access with a subform (<strong>sub_frm_robo2</strong>) that has a specific column (<strong>CD_SENHA</strong>).</p>\n\n<p>In the <strong>Form Load event</strong> I put the code: (<strong><em>Me.sub_frm_robo2.Form! SENHA.InputMask = \"Password\"</em></strong>) </p>\n\n<p>and I am trying to create a condition that at the moment this Column\n(<strong>CD_SENHA</strong>) receives focus (<strong><em>Me.sub_frm_robo2.Form!SENHA.SetFocus</em></strong>), </p>\n\n<p>the data mask be removed (<strong>Me.sub_frm_robo2.Form!SENHA.InputMask = \"\"</strong>) </p>\n\n<p>and when the focus changes to the next column return the data mask to the initial format (<strong>Me.sub_frm_robo2.Form! PASSWORD = \"Password\"</strong>)</p>\n\n<p>Below some images to better exemplify</p>\n\n<p><strong><em>Before Focus</em></strong>\n<a href=\"https://i.stack.imgur.com/gmXOS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gmXOS.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>With Focus</em></strong>\n<a href=\"https://i.stack.imgur.com/qSurT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qSurT.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>After Focus</em></strong>\n<a href=\"https://i.stack.imgur.com/GjV1T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GjV1T.png\" alt=\"enter image description here\"></a></p>\n\n<p>I think the code would look something like this</p>\n\n<pre><code>Do While Me.sub_frm_robo2.SetFocus = True\nIf Me.sub_frm_robo2.Form!SENHA.SetFocus Then\n    Me.sub_frm_robo2.Form!SENHA.InputMask = \"\"\nEnd If\nNext\n</code></pre>\n\n<p>Can you help me?</p>\n"}, {"tags": ["excel", "vba", "podio"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1533144071, "post_id": 51638279, "comment_id": 90242347, "body": "Your question&#39;s answer really lies in the services that the Podio API supports, not the VBA code above. You&#39;d have to research potential formatting options for your POST/GET request so that the Podio server can format your data as CSV coming back to you. If JSON is the only option and you really, really need the data in CSV, you&#39;ll have to write a converter yourself. There is no clear indication of the JSON format or what you need in CSV in your post."}], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 4632218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a8f6856b6003b2074c86bcbfa7b70e?s=128&d=identicon&r=PG", "display_name": "M&#251;h&#225;mm&#224;d Y&#228;s&#229;r K", "link": "https://stackoverflow.com/users/4632218/m%c3%bbh%c3%a1mm%c3%a0d-y%c3%a4s%c3%a5r-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1533185107, "creation_date": 1533185107, "answer_id": 51645666, "question_id": 51638279, "link": "https://stackoverflow.com/questions/51638279/podio-items-to-excel-sheet/51645666#51645666", "title": "Podio items to excel sheet", "body": "<p>You may send the <code>POST</code> request to <code>/item/app/{app_id}/export/{exporter}</code>which creates a batch for exporting the items. \nHere you can export the items as <strong>xls</strong> and <strong>xlsx</strong> formats.</p>\n\n<p>Your <code>myURL</code> must be like,</p>\n\n<pre><code>myURL = \"https://api.podio.com/item/app/XYZ/export/xls\"\n</code></pre>\n\n<p>You will get a batch_id as a result of this request. </p>\n\n<p>Then make a <code>GET</code> call to <code>/batch/{batch_id}</code> to get the <code>status</code> of the batch. You can download the output xls file by making a <code>GET</code> request to <code>/file/{file_id}</code> using the <code>podio_file_id</code> from the batch response.</p>\n\n<p><strong>References</strong></p>\n\n<ul>\n<li><a href=\"https://developers.podio.com/doc/items/export-items-4235696\" rel=\"nofollow noreferrer\">Podio - Export Items</a></li>\n<li><a href=\"https://developers.podio.com/doc/batch/get-batch-6144225\" rel=\"nofollow noreferrer\">Podio - Get Batch</a></li>\n<li><a href=\"https://developers.podio.com/doc/files/get-file-22451\" rel=\"nofollow noreferrer\">Podio - Get File</a></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8220631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067395d36a4b12c18a6ab7940cf6a77b?s=128&d=identicon&r=PG&f=1", "display_name": "Pieczony", "link": "https://stackoverflow.com/users/8220631/pieczony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1594211264, "creation_date": 1533141292, "last_edit_date": 1594211264, "question_id": 51638279, "link": "https://stackoverflow.com/questions/51638279/podio-items-to-excel-sheet", "title": "Podio items to excel sheet", "body": "<p>I need to have a vba macro that downloads data from my Podio app to an excel sheet. Right now I am running a code I found on Podio community website, which I am pasting below:</p>\n\n<pre><code>Dim winHttpReq As Object\nDim access_token As String\n\nFunction ProjectsFromPodio()\n\nDim result As String\nDim postData As String\nDim myURL As String\nDim token_pos As Long\n\n'Initialisierung\nSet winHttpReq = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nmyURL = \"https://api.podio.com/oauth/token\"\n\npostData = \"grant_type=app&amp;app_id=ABC&amp;app_token=DEF&amp;client_id=GHI&amp;client_secret=JKL\"\n\nIf winHttpReq.Open(\"POST\", myURL, False) = S_OK Then\n    'MsgBox (\"Open successfull\")\nEnd If\nwinHttpReq.SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nwinHttpReq.Send (postData)\n\nresult = winHttpReq.responseText\ntoken_pos = InStr(result, \"access_token\")\naccess_token = Mid(result, token_pos + 15)\ntoken_pos = InStr(access_token, Chr(34)) - 1\naccess_token = Mid(access_token, 1, token_pos)\n\nOAuthAppAuthorization = result\n'MsgBox (OAuthAppAuthorization)\n\nSet winHttpReq = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nmyURL = \"https://api.podio.com/item/app/XYZ\"\nwinHttpReq.Open \"GET\", myURL, False\nwinHttpReq.SetRequestHeader \"Authorization\", \"OAuth2 \" &amp; access_token\nwinHttpReq.Send\nresult = winHttpReq.responseText\n'MsgBox (result)\nEnd Function\n</code></pre>\n\n<p>This works nice, data is downloaded and I can use it. My question is how to download this data in CSV format, rather than JSON? Is it possible?</p>\n\n<p>If it is not possible, how can I parse it to a sheet in a smart way? </p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1533141485, "post_id": 51638233, "comment_id": 90241025, "body": "Are you deleting the previous form in the same session? It may be that form is still &quot;there&quot; until something triggers a recompile in the VBProject.  You can always use an incrementing suffix for each new form is it continues to be an issue.  Doing this type of thing can be finicky/unpredictable."}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1533143850, "post_id": 51638233, "comment_id": 90242237, "body": "Unless there&#39;s a command to flush the file buffers without closing the file, there&#39;s going to be a conflict.  Since closing the file and re-opening solves the problem, and since that&#39;s technically the most correct way to do something like this, then write a &quot;re-open&quot; method which does just that and call it whenever needed."}, {"owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1533146238, "post_id": 51638233, "comment_id": 90243451, "body": "@TimWilliams what is a session and how is a recompile triggered?"}, {"owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "reply_to_user": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1533146280, "post_id": 51638233, "comment_id": 90243469, "body": "@BillHileman what would be the best command to use to do that?  or just to flush the file buffers (unless that&#39;s a bad or dangerous idea)"}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1533146508, "post_id": 51638233, "comment_id": 90243592, "body": "As a rule, when I code my accounting application (VB 6) I write one method to open all files and another method to close all files.  That&#39;s all that either of those methods (subs) do.  I call the open during form load and close during form unload, but then if I need to close and re-open, I call the methods back-to-back, close, then open.  It&#39;s really just that simple.  It comes in handy because I might need to do a close and re-open if my client changes fiscal year, for example.  Just modularize your code to make it easier."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1533148508, "post_id": 51638233, "comment_id": 90244704, "body": "Buy &quot;same session&quot; I mean you have not closed and re-opened the workbook, or something else hasn&#39;t happened which would cause the VBProject to be reset (for example, an unhandled error).  Unless the VBProject gets reset the compiled version of the original form may still be present in your project, so adding a new form with the same name may cause a conflict (that part is my best guess...)"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1533214181, "post_id": 51638233, "comment_id": 90271457, "body": "This is a known problem and there is no easy solution. E.g. <a href=\"https://stackoverflow.com/questions/29826168/programmatically-created-form-with-name-conflict\" title=\"programmatically created form with name conflict\">stackoverflow.com/questions/29826168/&hellip;</a>. However there is a workaround: do not delete unneeded forms once you have created them, just hide them, and show them again when needed: <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=228\" rel=\"nofollow noreferrer\">vbaexpress.com/kb/getarticle.php?kb_id=228</a>"}], "owner": {"reputation": 69, "user_id": 8108322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00a7631b97207d87680afb69232a48d?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Zoltak", "link": "https://stackoverflow.com/users/8108322/miles-zoltak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533141081, "creation_date": 1533141081, "question_id": 51638233, "link": "https://stackoverflow.com/questions/51638233/why-am-i-getting-a-path-file-access-error-trying-to-programatically-name-userfor", "title": "Why am I getting a Path/File Access error trying to programatically name userform?", "body": "<p>I am using a userform to create ANOTHER userform based on variable inputs.  When I create the userform I want to give it a name relevant to the information from which the new form is being created.  I understand that I cannot have 2 forms with the same name but what confuses me is that I can't give a form a name that previously belonged to another form that has since been deleted without exporting it.  Even more peculiar, if I close excel and reopen it I can create the userform with the name I want.</p>\n\n<p>So basically what I'm thinking is that there is some sort of temporary location that I need to clear before I try to recreate the \"deleted\" form.</p>\n\n<p>Things to keep in mind:</p>\n\n<ul>\n<li>The error I'm getting is a \"Path/File Access\" error</li>\n<li>The userform can be created if excel is closed and then reopened</li>\n<li>The main userform lives in the Personal.xlsb file and so does the new form that's created, however I would like to eventually start writing the new userform to it's own regular .xlsm workbook (but that is not what this question about)</li>\n</ul>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub MakeForm()\n    'make the vba window invisible, i think this is the actual tryout spec form\n    Application.VBE.MainWindow.Visible = False\n    'add and set InputForm\n\n    Set InputForm = ThisWorkbook.VBProject.VBComponents.Add(3)\n    'set its properties\n    With InputForm\n        .Properties(\"Caption\") = formTitle\n        .Properties(\"Width\") = 390\n        .Properties(\"Height\") = 377\n        .Properties(\"Name\") = formName\n    End With\nEnd Sub\n</code></pre>\n\n<p><code>formTitle</code> and <code>formName</code> are both publicly declared strings that work just fine and have values (exactly the values I intend the to have) when the program goes into break mode after the runtime error occurs.</p>\n\n<p>I hope this is enough information and I'm pretty new to Stack Overflow so I have like no rights and I'm kinda a VBA noob too so my apologies in advance.  Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1533139681, "post_id": 51637755, "comment_id": 90239973, "body": "Comment out the <code>lookup_result</code> line and see if it compiles.  If it does, you&#39;re missing a vlookup function parameter."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533139746, "post_id": 51637755, "comment_id": 90240004, "body": "There seem to be a lot of parameters there. Are there too many?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1533139775, "post_id": 51637755, "comment_id": 90240020, "body": "<code>False</code> is inside the wrong set of parentheses.  Also that whole line is likely to fail, having a bunch of unqualified Range/Cells calls"}], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": 0, "last_activity_date": 1533140048, "creation_date": 1533140048, "answer_id": 51637949, "question_id": 51637755, "link": "https://stackoverflow.com/questions/51637755/argument-not-optional-simple-vba-function/51637949#51637949", "title": "Argument not Optional - Simple VBA function", "body": "<p>Your parenthesis are in incorrect order.</p>\n\n<pre><code>lookup_result = WorksheetFunction.VLookup(Cells(1 + Row, 1), _\n                                          ThisWorkbook.Sheets(Time &amp; \"_Lines\").Range(Cells(2, 1), Cells(lookup_end_row, 1)), _\n                                          1, _\n                                          False)\n</code></pre>\n\n<p>parenthesis opened for Range doesn't close and closed in the end.</p>\n"}, {"tags": [], "owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "is_accepted": false, "score": 1, "last_activity_date": 1533140358, "creation_date": 1533140358, "answer_id": 51638037, "question_id": 51637755, "link": "https://stackoverflow.com/questions/51637755/argument-not-optional-simple-vba-function/51638037#51638037", "title": "Argument not Optional - Simple VBA function", "body": "<p>Utilize your object browser if you're running into issues like this.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/P0pvg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P0pvg.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>You can test your vlookup within a cell in a worksheet to verify validity.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1533140697, "creation_date": 1533140697, "answer_id": 51638121, "question_id": 51637755, "link": "https://stackoverflow.com/questions/51637755/argument-not-optional-simple-vba-function/51638121#51638121", "title": "Argument not Optional - Simple VBA function", "body": "<pre><code>Public Sub SearchAMLinesForIDs_Click()\n\n    Dim sTime As String, shtData As Worksheet, sht As Worksheet\n    Dim lookup_result, rngLookup As Range\n    Dim rw As Long\n\n    sTime = \"AM\"\n    Set shtData = ThisWorkbook.Worksheets(sTime &amp; \"_Lines\")\n    Set sht = ActiveSheet\n\n    Set rngLookup = shtData.Range(shtData.Range(\"A2\"), shtData.Cells(shtData.Rows.Count, 1).End(xlUp))\n\n    For rw = 2 To sht.Range(\"A2\").End(xlDown).row\n\n        'don't use Worksheetfunction, but test the return value for errors...\n        lookup_result = Application.VLookup(sht.Cells(rw, 1), rngLookup, 1, False)\n\n        sht.Cells(rw, 2) = IIf(IsError(lookup_result), \"NoMatch!\", lookup_result)\n\n    Next rw\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 278, "user_id": 1270911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7651d67fd4f31605a07e21d995cf98ea?s=128&d=identicon&r=PG", "display_name": "Joel Biffin", "link": "https://stackoverflow.com/users/1270911/joel-biffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 51638121, "answer_count": 3, "score": 0, "last_activity_date": 1533140697, "creation_date": 1533139394, "last_edit_date": 1533140174, "question_id": 51637755, "link": "https://stackoverflow.com/questions/51637755/argument-not-optional-simple-vba-function", "title": "Argument not Optional - Simple VBA function", "body": "<p>I keep getting the Argument not optional compiler error in vba and can't figure out why. </p>\n\n<p>I can't see any typos, I don't even take any arguments and the subroutine only executes on a button click.</p>\n\n<pre><code>Public Sub SearchAMLinesForIDs_Click()\n    Dim time As String\n    time = \"AM\"\n\n    Dim end_row As Long\n    end_row = Range(\"A2\").End(xlDown).row\n\n\n    Dim lookup_end_row As Long\n    Dim lookup_result As Long\n\n    lookup_end_row = ThisWorkbook.Sheets(time &amp; \"_Lines\").Range(\"A2\").End(xlDown).row\n\n    lookup_table = ThisWorkbook.Sheets(time &amp; \"_Lines\").Range(\"A2:C\" &amp; lookup_end_row)\n\n    Dim row As Long\n\n    For row = 1 To end_row\n        lookup_result = WorksheetFunction.VLookup(Range(\"A\" &amp; row), lookup_table, 1, False)\n\n        Cells(row + 1, 2) = lookup_result\n    Next row\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533140054, "post_id": 51637693, "comment_id": 90240185, "body": "Not an answer to your exact question but shouldn&#39;t you have a backslash &quot;\\&quot; on the end of your <code>sSaveFolder</code> path, or between <code>sSaveFolder</code> and <code>oAttachment.DisplayName</code> in  <code>sSaveFolder &amp; oAttachment.DisplayName</code>?"}, {"owner": {"reputation": 67, "user_id": 7115723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c261e34d18e095d3c608d02c71f8b?s=128&d=identicon&r=PG&f=1", "display_name": "iplayball27", "link": "https://stackoverflow.com/users/7115723/iplayball27"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533140788, "post_id": 51637693, "comment_id": 90240628, "body": "probably, I just changed the path for security reasons when I posted this"}], "answers": [{"comments": [{"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 67, "user_id": 7115723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c261e34d18e095d3c608d02c71f8b?s=128&d=identicon&r=PG&f=1", "display_name": "iplayball27", "link": "https://stackoverflow.com/users/7115723/iplayball27"}, "edited": false, "score": 0, "creation_date": 1533308759, "post_id": 51638058, "comment_id": 90313919, "body": "If you see the &quot;Incoming Data.&quot; message then my code is working. The problem must be in your &quot;SaveAttachmentsToDisk&quot; sub."}, {"owner": {"reputation": 67, "user_id": 7115723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c261e34d18e095d3c608d02c71f8b?s=128&d=identicon&r=PG&f=1", "display_name": "iplayball27", "link": "https://stackoverflow.com/users/7115723/iplayball27"}, "edited": false, "score": 0, "creation_date": 1533323994, "post_id": 51638058, "comment_id": 90320941, "body": "I have no idea what the issue was, but everything is working now. It&#39;s putting the email attachments where it&#39;s supposed to."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": true, "score": 2, "last_activity_date": 1533309072, "last_edit_date": 1533309072, "creation_date": 1533140438, "answer_id": 51638058, "question_id": 51637693, "link": "https://stackoverflow.com/questions/51637693/outlook-2016-select-script-window-in-rules-wizard-is-blank/51638058#51638058", "title": "Outlook 2016 - &quot;select script&quot; window in Rules Wizard is blank", "body": "<p>I think the answer is something obscure like you must declare ByRef like this:</p>\n\n<pre><code>Public Sub SaveAttachmentsToDisk(ByRef MItem As Outlook.MailItem)\n</code></pre>\n\n<p>Let me save you a whole bunch of time. You are going to find that using an Outlook rule to run your script doesn't work out. Instead, you will want to run your code on the actual event of a new mail item coming in. This will change the priority of your code and get you away from all the crazy bugs in Outlook rules. Thank me later.</p>\n\n<p>Put this code in your \"ThisOutlookSession\" Object. It only works from there.</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents inboxItems As Outlook.Items\n\n' Set up the listener on the Inbox\nPrivate Sub Application_Startup()\n    Dim outlookApp As Outlook.Application\n    Dim objectNS As Outlook.NameSpace\n\n    Set outlookApp = Outlook.Application\n    Set objectNS = outlookApp.GetNamespace(\"MAPI\")\n    Set inboxItems = objectNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\n' Send new mail to the attachment processor\nPrivate Sub inboxItems_ItemAdd(ByVal Item As Object)\n    If TypeName(Item) = \"MailItem\" Then\n        Dim EMail As Outlook.MailItem\n        Set EMail = Item\n        Debug.Print \"Incoming Data.\"\n        SaveAttachmentsToDisk EMail\n        Set EMail = Nothing\n    End If\nEnd Sub\n</code></pre>\n\n<p>For your saving the file, try this:</p>\n\n<pre><code>Dim fullPath As String\nfullPath = sSaveFolder &amp; oAttachment.FileName\noAttachment.SaveAsFile fullPath \n</code></pre>\n\n<p>Then put a break on the fullPath line and inspect the actual contents of that string during run-time. This will help you see where the files are actually going.</p>\n"}], "owner": {"reputation": 67, "user_id": 7115723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c261e34d18e095d3c608d02c71f8b?s=128&d=identicon&r=PG&f=1", "display_name": "iplayball27", "link": "https://stackoverflow.com/users/7115723/iplayball27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 0, "accepted_answer_id": 51638058, "answer_count": 1, "score": 3, "last_activity_date": 1533309072, "creation_date": 1533139180, "last_edit_date": 1533139502, "question_id": 51637693, "link": "https://stackoverflow.com/questions/51637693/outlook-2016-select-script-window-in-rules-wizard-is-blank", "title": "Outlook 2016 - &quot;select script&quot; window in Rules Wizard is blank", "body": "<p>I am trying to run the following Macro to save attachments into a folder on my computer:</p>\n\n<pre><code>Public Sub SaveAttachmentsToDisk(MItem As Outlook.MailItem)\n\n    Dim oAttachment As Outlook.Attachment\n    Dim sSaveFolder As String\n    sSaveFolder = \"R:\\ConfigAssettManag\\Performance\\Let's see if this works\"\n\n    For Each oAttachment In MItem.Attachments\n        oAttachment.SaveAsFile sSaveFolder &amp; oAttachment.DisplayName\n        Next\n\nEnd Sub\n</code></pre>\n\n<p>I cannot add the macro to the rule in Outlook for some reason. I read <a href=\"https://social.technet.microsoft.com/Forums/office/en-US/32d4fdb1-a6fe-4d64-9109-4050c1543567/quotrules-and-alertsquot-option-to-quotrun-a-scriptquot?forum=outlook\" rel=\"nofollow noreferrer\">here</a> that I needed to have it return an Outlook.MailItem, and my code already does that, so I do not know why the macro is still not showing up.<a href=\"https://i.stack.imgur.com/ccmlY.png\" rel=\"nofollow noreferrer\">Outlook Rule not showing my Macro</a></p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533138486, "post_id": 51637371, "comment_id": 90239312, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42125623/vba-checking-checkbox-in-ie\">VBA - Checking Checkbox in IE</a>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533138775, "post_id": 51637371, "comment_id": 90239486, "body": "Try <code>IE.document.parentWindow.execScript(&quot;$get(&#39;MainReport_ctl04_&zwnj;&#8203;ctl09&#39;).control.OnSe&zwnj;&#8203;lectAllClick(this);&quot;&zwnj;&#8203;)</code>."}, {"owner": {"reputation": 1, "user_id": 10166637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9830429d94a3a3c041915e9693b85455?s=128&d=identicon&r=PG", "display_name": "Sara", "link": "https://stackoverflow.com/users/10166637/sara"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533139069, "post_id": 51637371, "comment_id": 90239655, "body": "@omegastripes thank u for ur answer. i tried, but it didn&#39;t tick the checkbox..."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533146523, "post_id": 51637371, "comment_id": 90243597, "body": "Could you please provide actual URL and expected file format and contents? That might be <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}], "owner": {"reputation": 1, "user_id": 10166637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9830429d94a3a3c041915e9693b85455?s=128&d=identicon&r=PG", "display_name": "Sara", "link": "https://stackoverflow.com/users/10166637/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594154689, "creation_date": 1533138022, "last_edit_date": 1594154689, "question_id": 51637371, "link": "https://stackoverflow.com/questions/51637371/tick-checkbox-ie-automation-excel-vba", "title": "Tick Checkbox IE Automation Excel VBA", "body": "<p>I'm trying to export a file from website but for that i have to select the elements i want to export from a checkbox.</p>\n\n<p>The HTML code for the checkbox i want to tick is:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input id=\"MainReport_ctl04_ctl09_divDropDown_ctl00\" type=\"checkbox\" name=\"MainReport$ctl04$ctl09$divDropDown$ctl00\" onclick=\"$get('MainReport_ctl04_ctl09').control.OnSelectAllClick(this);\" class=\"\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I've tried:</p>\n\n<pre><code>With IE.document.getElementsByName(\"MainReport$ctl04$ctl09$divDropDown$ctl00\")\n.Item.Click\nend with\n</code></pre>\n\n<p>And</p>\n\n<pre><code>With IE.document.getElementsByName(\"MainReport$ctl04$ctl09$divDropDown$ctl00\")\n.Item(0).Checked = True \nEnd With\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Set obj = IE.document.getElementsByName(\"MainReport$ctl04$ctl09$divDropDown$ctl00\")\nobj.FireEvent (\"onclick\")\n</code></pre>\n\n<p>But nothing seems to work. </p>\n\n<p>Could someone help me please? Thank u in advanced!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533143030, "post_id": 51637360, "comment_id": 90241870, "body": "I can&#39;t repro the problerm using the steps you describe... Try: 1) restart Windows and Word; 2) write the macro in  a new document and save as docm; 3) close the document, close Word; 4) start Word, open the document, insert some shapes and test the macro."}, {"owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "edited": false, "score": 1, "creation_date": 1533145294, "post_id": 51637360, "comment_id": 90242945, "body": "You will get that error if there are any InlineShapes in the document. There only has to be one and that command will error out. You will have to select InlineShapes separately from Shapes with wrapping text. What exactly are you trying to do with the selected shapes?"}, {"owner": {"reputation": 580, "user_id": 7932715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63dd1c43b55b7be9f331c5b0038329d?s=128&d=identicon&r=PG&f=1", "display_name": "nanoguy", "link": "https://stackoverflow.com/users/7932715/nanoguy"}, "reply_to_user": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "edited": false, "score": 0, "creation_date": 1533148742, "post_id": 51637360, "comment_id": 90244821, "body": "@Rich Michaels: I just did some testing and it seems you&#39;re right--the error only occurs if one or more of the images are set to inline wrapping.  Any idea how to select all inline images in the document plus all non-inline ones?  I edited the question to add additional info about what I&#39;m trying to achieve."}], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 7932715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63dd1c43b55b7be9f331c5b0038329d?s=128&d=identicon&r=PG&f=1", "display_name": "nanoguy", "link": "https://stackoverflow.com/users/7932715/nanoguy"}, "edited": false, "score": 0, "creation_date": 1533230582, "post_id": 51640700, "comment_id": 90281810, "body": "This is great, thanks!  Since the question was regarding why I was getting the permission error, you may want to include the bit about it being caused by inline images at the beginning."}], "tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": true, "score": 1, "last_activity_date": 1533244512, "last_edit_date": 1533244512, "creation_date": 1533150651, "answer_id": 51640700, "question_id": 51637360, "link": "https://stackoverflow.com/questions/51637360/permission-denied-on-ms-word-macro/51640700#51640700", "title": "Permission denied on MS Word macro", "body": "<p>You will get that error if there are any InlineShapes in the document. There only has to be one and that command will error out. You will have to select InlineShapes separately from Shapes with wrapping text. See code below.</p>\n\n<p>Concerning your question about tagging. To \"Tag\" the images put a unique phrase like \"Do Not Delete\" in the Alt Text of the images. Then you can use code like the below to remove all images, except those that have been tagged.</p>\n\n<p>For Inline Images this code will potentially leave a blank paragraph in the document and I will leave that to you to figure out how you want the final document to look.</p>\n\n<pre><code>Sub RemoveAllImagesWithExceptions()\nDim doc As Word.Document, iShp As Word.InlineShape\nDim shp As Word.Shape, i As Long, rng As Word.Range\nSet doc = ActiveDocument\nSet rng = doc.Content\nFor i = rng.InlineShapes.Count To 1 Step -1\n    Set iShp = rng.InlineShapes(i)\n    Select Case iShp.Type\n        Case wdInlineShapeLinkedPicture, wdInlineShapePicture\n            If InStr(1, iShp.AlternativeText, \"Do Not Delete\") = 0 Then\n                iShp.Delete\n            End If\n    End Select\nNext\nFor i = rng.ShapeRange.Count To 1 Step -1\n    Set shp = rng.ShapeRange(i)\n    Select Case shp.Type\n        Case msoLinkedPicture, msoPicture\n            If InStr(1, shp.AlternativeText, \"Do Not Delete\") = 0 Then\n                shp.Delete\n            End If\n    End Select\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 7932715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63dd1c43b55b7be9f331c5b0038329d?s=128&d=identicon&r=PG&f=1", "display_name": "nanoguy", "link": "https://stackoverflow.com/users/7932715/nanoguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 51640700, "answer_count": 1, "score": 0, "last_activity_date": 1593822859, "creation_date": 1533137991, "last_edit_date": 1593822859, "question_id": 51637360, "link": "https://stackoverflow.com/questions/51637360/permission-denied-on-ms-word-macro", "title": "Permission denied on MS Word macro", "body": "<p>I have an MS Word document (Office 365 version 1803) with a large number of images.  I need to select all images in the document, but there are far too many to do this by hand.  Looking online, it seems the only way to do this is using a macro, which I have no experience with.  I wrote the following very simple macro:</p>\n\n<pre><code>Sub SelectAllImages()\n    ActiveDocument.Shapes.SelectAll\nEnd Sub\n</code></pre>\n\n<p>When I saved the document, I was forced to change it to a macro-enabled Word document (.docm), which I did.  However, whenever I try to run the macro I get the following error:</p>\n\n<pre><code>Run-time error '70': Permission denied\n</code></pre>\n\n<p>I have Googled this error, but nothing has helped me fix it.  Anyone have any idea what I'm doing wrong?</p>\n\n<p>Edit: As additional data, what I'm trying to do is delete most but not all of the images.  I have a document that is 200+ pages long with an average of about 1 image per page.  I need to publish 2 versions of this document: 1 with all images, the second with all but about 12 of the images removed.  The document is updated regularly, and I don't want to have to keep updating 2 separate versions and ensure they are identical except for the inclusion of the images.  Thus I'd like to be able to maintain only one version, which includes all the images.  Then after each update I'd like to be able to select all the images, manually unselect the 12 I want to keep, and delete the others.</p>\n\n<p>If there is a way to somehow \"tag\" the images I want to keep and have a macro delete all but the tagged ones that would be an even better solution.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1533138402, "post_id": 51637354, "comment_id": 90239258, "body": "You are iterating from 100 to 1... is your range &gt;100 rows in the new workbook?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1533138575, "post_id": 51637354, "comment_id": 90239372, "body": "also, <i>Range(&quot;i1&quot;).Value</i> looks funny, since you have i as your variable... just make that upper case, if you are truly intending to use cells(1,&quot;I&quot;).  might make it a little easier to review as such"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1533138614, "post_id": 51637354, "comment_id": 90239390, "body": "Do you really use the code above. It contains a typo or &quot;Copy&amp;Paste&quot; bug: <code>Rows(i).EntireRow.ClearContents</code>"}, {"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "edited": false, "score": 0, "creation_date": 1533138786, "post_id": 51637354, "comment_id": 90239490, "body": "Yes I have done this (1,&quot;I&quot;) but still not working..... Moreover, I have tested with different VBA code but the same problem persisted."}, {"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "edited": false, "score": 0, "creation_date": 1533138945, "post_id": 51637354, "comment_id": 90239591, "body": "No no, there is no typo error. Otherwise, the code would not execute properly."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1533138962, "post_id": 51637354, "comment_id": 90239599, "body": "There is a typo! Can&#39;t you read? Code will fail as soon as the if condition becomes true"}, {"owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533138993, "post_id": 51637354, "comment_id": 90239614, "body": "@Storax brief the typo you&#39;re suggesting.."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533139061, "post_id": 51637354, "comment_id": 90239651, "body": "There is a typo in the post of the TO!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1533139120, "post_id": 51637354, "comment_id": 90239685, "body": "@DavidZemens <code>ClearContent</code> is missing an &quot;s&quot;"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533139142, "post_id": 51637354, "comment_id": 90239695, "body": "@BigBen: Thanks"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533139236, "post_id": 51637354, "comment_id": 90239747, "body": "The typo would raise a compile error. The macro <i>cannot possibly execute</i> until that is rectified. Since OP suggests the macro <i>is actually executing</i>, this may be a transposition/copy/paste error here on Stack Overflow. I think OP needs to clarify what nature of the problem is."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533139285, "post_id": 51637354, "comment_id": 90239772, "body": "No, the typo does not raise a compile error! It will only error out at run time telling object does not support this mehtod or property."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533139384, "post_id": 51637354, "comment_id": 90239814, "body": "Ah right, 438. In any case, OP still suggests that this <i>partially</i> works. So, I think probably the typo not exist in his actual code, only here on SO. We need OP to clarify."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533139552, "post_id": 51637354, "comment_id": 90239907, "body": "@dibyendu I think you must provide some example data. Are you sure the values are exactly equal (with no leading/trailing spaces, or, dates versus strings that <i>look like dates</i>,e tc.)? You need to step through code using F8 and breakpoint to identify when the condition is not met, but you think it should be met. Then you will able to see why it is a discrepancy."}, {"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533139905, "post_id": 51637354, "comment_id": 90240106, "body": "@David Zemens, the string here is date. And the date is  placed in the column and the cell by VBA macro calendar. So I don&#39;t think there will be formatting errors."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1533140281, "post_id": 51637354, "comment_id": 90240316, "body": "A string isn&#39;t a date and you should not rely on implicit type conversions when comparing dates and strings. Since you haven&#39;t provided example data, and nobody knows what your &quot;vba macro calendar&quot; actually does, it&#39;s not really possible to help you much further until you do so."}, {"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "edited": false, "score": 0, "creation_date": 1533148055, "post_id": 51637354, "comment_id": 90244466, "body": "I have provided example data(picture) by editing my question. Please have a look as it may help to express by problem"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1533148127, "post_id": 51637354, "comment_id": 90244507, "body": "Your screenshot of data is virtually useless for doing proper troubleshooting. It cannot be copy/pasted into a worksheet. One can try an OCR program, or manually enter it. Having to do either of these is discouraging to those who might assist you. To make the data useful edit your question to post it as text, perhaps using this <a href=\"http://www.tablesgenerator.com/markdown_tables\" rel=\"nofollow noreferrer\">Markdown Tables Generator</a>, or possibly upload a workbook (with sensitive information removed) to some public website and post a link in your original question"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "edited": false, "score": 0, "creation_date": 1533139027, "post_id": 51637468, "comment_id": 90239633, "body": "If there is any other ways to do so through VBA coding"}, {"owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "edited": false, "score": 0, "creation_date": 1533139076, "post_id": 51637468, "comment_id": 90239657, "body": "Worked for me. :)"}, {"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "edited": false, "score": 0, "creation_date": 1533139150, "post_id": 51637468, "comment_id": 90239700, "body": "At home I have no computer. Yes you are correct. Tomorrow I&#39;ll try the above code."}, {"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1533140080, "post_id": 51637468, "comment_id": 90240198, "body": "@SJR 12, you are correct. It is working properly in one excel but when I copied it is clearing some of the matched rows but not all matched found."}], "tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": 1, "last_activity_date": 1533139278, "last_edit_date": 1533139278, "creation_date": 1533138372, "answer_id": 51637468, "question_id": 51637354, "link": "https://stackoverflow.com/questions/51637354/vba-working-in-one-macro-excel-properly-but-not-in-other-macro-excel/51637468#51637468", "title": "VBA working in one macro excel properly but not in other macro excel", "body": "<p><code>Rows(i)</code> and <code>Range(\"F\" &amp; i)</code> is defined implicitly which might refer to another sheet or even another workbook.</p>\n\n<p>below is a sample code with use of sheet reference.</p>\n\n<pre><code>Dim i as long\nDim ws as Worksheet\nSet ws = ThisWorkBook.Sheets(\"YourSheetName\")\nFor i = 100 To 1 step -1 \n    If ws.Range(\"F\" &amp; i).Value = ws.Range(\"i1\").Value Then ws.Rows(i).EntireRow.ClearContents\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "edited": false, "score": 1, "creation_date": 1533139460, "post_id": 51637578, "comment_id": 90239870, "body": "But I assume that it was not a typo error. Otherwise, it would not work properly in the macro excel. Moreover, when I copied the VBA code to different excel macro it is clearing some of the matched rows."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "edited": false, "score": 0, "creation_date": 1533140090, "post_id": 51637578, "comment_id": 90240203, "body": "If it is not a typo and your code is running in other workbooks you have to provide sample data."}, {"owner": {"reputation": 2490, "user_id": 7512742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/muuJz.png?s=128&g=1", "display_name": "Adam Vincent", "link": "https://stackoverflow.com/users/7512742/adam-vincent"}, "edited": false, "score": 1, "creation_date": 1533142674, "post_id": 51637578, "comment_id": 90241685, "body": "OP provided incomplete / non working code. There&#39;s no way what he pasted in OP actually worked. +1 for fixing it. No need to explain why it &quot;it works in one workbook and not another&quot; because no working code was presented."}, {"owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "edited": false, "score": 0, "creation_date": 1533147832, "post_id": 51637578, "comment_id": 90244331, "body": "@ Storax, I have added a picture of sample data by updating by question. Please have a look"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1533147976, "post_id": 51637578, "comment_id": 90244431, "body": "You added a picture not sample data"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 3, "last_activity_date": 1533138759, "creation_date": 1533138759, "answer_id": 51637578, "question_id": 51637354, "link": "https://stackoverflow.com/questions/51637354/vba-working-in-one-macro-excel-properly-but-not-in-other-macro-excel/51637578#51637578", "title": "VBA working in one macro excel properly but not in other macro excel", "body": "<p>IMHO you just have to fix your typo and copy the code into a module (not the worksheet or workbook module) and it will work on the active sheet.</p>\n\n<pre><code>Sub test()\nDim i As Long\n    For i = 100 To 1 Step -1\n        If Range(\"F\" &amp; i).Value = Range(\"i1\").Value Then\n            Rows(i).EntireRow.ClearContents\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10148608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380a20cc72670bc06176a16aefcd15b6?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/10148608/dibyendu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1533146291, "creation_date": 1533137968, "last_edit_date": 1533146291, "question_id": 51637354, "link": "https://stackoverflow.com/questions/51637354/vba-working-in-one-macro-excel-properly-but-not-in-other-macro-excel", "title": "VBA working in one macro excel properly but not in other macro excel", "body": "<p>I have written a vba code to find match in dynamic column \"F\" with cell value i cell \"i1\". And when match found in the column \" F\" it will clear the content of the particular row.<br>\nThe VBA is working fine in the excel marco where I have written the VBA code but to my surprise when I copy the same VBA code to a different excel macro having the same content in worksheet and run the VBA code it does not clear all the match content row i.e., it clear some of the match row leaving some of match row uncleared. Where I am doing the mistake?</p>\n\n<pre><code>Sub test()\n\n    Dim i as long\n\n    For i = 100 To 1 step -1\n        If Range(\"F\" &amp; i).Value = Range(\"i1\").Value Then Rows(i).EntireRow.ClearContent\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/tXGuQ.jpg\" alt=\"Picture of the macro excel worksheet\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1533137561, "post_id": 51637134, "comment_id": 90238724, "body": "Does it error at the first <code>Shp.Delete</code> (<code>If Shp.OLEFormat.Object.Object.Caption = Caption Then</code>), or the second one? (<code>If Shp.OLEFormat.Object.Caption = Caption Then </code>)"}, {"owner": {"reputation": 1, "user_id": 10166331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5ebfa06819346af427a14ed4c4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/10166331/neil-humphries"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1533137780, "post_id": 51637134, "comment_id": 90238879, "body": "It errors at the first one. It was originally a single line IF statement. I changed it to a multiline IF in order to isolate the error. The IF condition executes without error."}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533138072, "post_id": 51637134, "comment_id": 90239065, "body": "@NeilHumphries: did it work in Excel 2013 or Excel 2010?"}, {"owner": {"reputation": 1, "user_id": 10166331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5ebfa06819346af427a14ed4c4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/10166331/neil-humphries"}, "edited": false, "score": 0, "creation_date": 1533139098, "post_id": 51637134, "comment_id": 90239670, "body": "I&#39;ve been enhancing the workbook for about 15 years now. It has worked in Windows XP and later versions and in Excel prior to 2010. I still have 2013 at home. I will confirm whether or not the error occurs in 2013 tonight. I know it didn&#39;t occur in 2013 when I was developing the 2015 version of the workbook."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1533139418, "post_id": 51637134, "comment_id": 90239841, "body": "Did you every delete the temp files when ms had those crazy updates that affected the controls? This happened a couple of yrs ago. Just wondering."}, {"owner": {"reputation": 1, "user_id": 10166331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5ebfa06819346af427a14ed4c4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/10166331/neil-humphries"}, "edited": false, "score": 0, "creation_date": 1533139945, "post_id": 51637134, "comment_id": 90240124, "body": "I&#39;m using a 1 year old laptop, so that shouldn&#39;t be an issue."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1533141710, "post_id": 51637134, "comment_id": 90241148, "body": "When looping over a collection in order to delete some of the members, it&#39;s safer to work backwards using <code>For x = .Count to 1 step -1</code>"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1533142673, "post_id": 51637134, "comment_id": 90241684, "body": "Just a note: this will exit your loop on the first msoOLEControlObject it finds.  Put the <code>Exit for</code> within the IF statement to exit when it finds the object it&#39;s looking for."}, {"owner": {"reputation": 1, "user_id": 10166331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5ebfa06819346af427a14ed4c4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/10166331/neil-humphries"}, "edited": false, "score": 0, "creation_date": 1533212959, "post_id": 51637134, "comment_id": 90270631, "body": "In this case, since there is only one button with that caption, it simply exits without wasting time on the rest of the collection. Also in this case, there is only one button at all, but you are right about putting it within the IF statement. It doesn&#39;t address the error that keeps happening."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10166331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5ebfa06819346af427a14ed4c4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/10166331/neil-humphries"}, "edited": false, "score": 0, "creation_date": 1533144354, "post_id": 51638438, "comment_id": 90242493, "body": "While you are correct that it is safer to work from the end rather than the beginning, it didn&#39;t solve the problem. I made the changes and get -2147024809 (80070057) error with the msg text The specified value is out of range on the same Shp.Delete line."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 10166331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5ebfa06819346af427a14ed4c4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/10166331/neil-humphries"}, "edited": false, "score": 0, "creation_date": 1533148610, "post_id": 51638438, "comment_id": 90244769, "body": "...and I missed that Exit For in the middle of the loop, so it wouln&#39;t make any difference in this case."}, {"owner": {"reputation": 1, "user_id": 10166331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5ebfa06819346af427a14ed4c4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/10166331/neil-humphries"}, "edited": false, "score": 0, "creation_date": 1533212653, "post_id": 51638438, "comment_id": 90270416, "body": "In this case, since there is only one button with that caption, it simply exits without wasting time on the rest of the collection. Also in this case, there is only one button at all."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1533141853, "creation_date": 1533141853, "answer_id": 51638438, "question_id": 51637134, "link": "https://stackoverflow.com/questions/51637134/new-run-time-errors-in-older-code-1004-424-2147024809-80070057/51638438#51638438", "title": "New run time errors in older code 1004, 424, -2147024809 (80070057)", "body": "<p>When looping over a collection in order to delete some of the members, it's safer to work backwards:</p>\n\n<pre><code>DeleteShapesByCaption \"Create a new Schedule of Values tab\", wSht\n\nSub DeleteShapesByCaption( _\n    ByVal Caption As String, _\n    Optional ByVal WS As Worksheet = Nothing)\n    Dim Shp As Shape, i as Long\n    If WS Is Nothing Then Set WS = ActiveSheet\n    WS.Unprotect Protect_Password\n\n    For i = WS.Shapes.Count To 1 Step -1\n\n        Set Shp = WS.Shapes(i)\n        'What kind of shape is it?\n        Select Case Shp.Type\n        Case msoOLEControlObject\n            'May be a commandbutton\n            If Shp.OLEFormat.Object.Object.Caption = Caption Then\n                Shp.Delete  'This is where the error occurs\n            End If\n            Exit For\n        Case msoFormControl\n            'May be a button\n            If Shp.OLEFormat.Object.Caption = Caption Then Shp.Delete\n        End Select\n\n    Next i\n\n    wSht.Protect Protect_Password\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10166331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5ebfa06819346af427a14ed4c4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Humphries", "link": "https://stackoverflow.com/users/10166331/neil-humphries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533141853, "creation_date": 1533137300, "last_edit_date": 1533139202, "question_id": 51637134, "link": "https://stackoverflow.com/questions/51637134/new-run-time-errors-in-older-code-1004-424-2147024809-80070057", "title": "New run time errors in older code 1004, 424, -2147024809 (80070057)", "body": "<p>Windows 10, Excel 2016  The code is in a Module.</p>\n\n<p>Three years ago, this code worked. Now it throws errors. The text of the error messages is different from that in the other threads with the same error codes.</p>\n\n<p>The code attempts to locate a button and delete it. There is only one button per worksheet.</p>\n\n<pre><code>DeleteShapesByCaption \"Create a new Schedule of Values tab\", wSht\n\nSub DeleteShapesByCaption( _\n    ByVal Caption As String, _\n    Optional ByVal WS As Worksheet = Nothing)\n    Dim Shp As Shape\n    If WS Is Nothing Then Set WS = ActiveSheet\n    WS.Unprotect Protect_Password\n    For Each Shp In WS.Shapes\n        'What kind of shape is it?\n        Select Case Shp.Type\n        Case msoOLEControlObject\n            'May be a commandbutton\n            If Shp.OLEFormat.Object.Object.Caption = Caption Then\n                Shp.Delete  'This is where the error occurs\n            End If\n            Exit For\n        Case msoFormControl\n            'May be a button\n            If Shp.OLEFormat.Object.Caption = Caption Then Shp.Delete\n        End Select\n    Next\n    wSht.Protect Protect_Password\nEnd Sub\n</code></pre>\n\n<p>The error always occur at Shp.Delete</p>\n\n<blockquote>\n  <p>RTE 404 Object Required</p>\n  \n  <p>RTE -2147024809 (80070057) The specified value is out of range</p>\n</blockquote>\n\n<p>Context:</p>\n\n<p>The workbook has a worksheet which is a template. Once the template is filled in, it is copied for month 1. After the month 1 sheet is completed, the create a new sheet button is clicked to create a new sheet for month 2 and the create a new sheet button is supposed to be removed from the month 1 sheet. Each sheet only has one button.</p>\n\n<p>I have used debug.print to confirm that the activesheet is the previous month's sheet.</p>\n\n<p>This code worked properly in 2015. I have modified cell formulae to reflect changes in legislation, but I don't think those changes are relevant because now even the 2015 workbook produces the errors.</p>\n\n<p>The code executes as expected in creating the month 1 sheet. The only difference is that the create a new sheet button is not deleted from the template page.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 937, "user_id": 8447562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYRil.png?s=128&g=1", "display_name": "Symon", "link": "https://stackoverflow.com/users/8447562/symon"}, "edited": false, "score": 0, "creation_date": 1533137044, "post_id": 51636914, "comment_id": 90238390, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21098265/copy-multiple-rows-from-one-worksheet-to-another-worksheet-using-macro-vba\">Copy multiple rows from one worksheet to another worksheet using macro/vba</a>"}, {"owner": {"reputation": 1, "user_id": 10166453, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ck0tqpKFlSY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qqKCJ7ywZnURzBzUb0lqgDO-xSpg/mo/photo.jpg?sz=128", "display_name": "Zheng Yang Chiew", "link": "https://stackoverflow.com/users/10166453/zheng-yang-chiew"}, "reply_to_user": {"reputation": 937, "user_id": 8447562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYRil.png?s=128&g=1", "display_name": "Symon", "link": "https://stackoverflow.com/users/8447562/symon"}, "edited": false, "score": 0, "creation_date": 1533169529, "post_id": 51636914, "comment_id": 90252066, "body": "Hi Simon, different request as I need to loop through worksheets as well"}, {"owner": {"reputation": 937, "user_id": 8447562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYRil.png?s=128&g=1", "display_name": "Symon", "link": "https://stackoverflow.com/users/8447562/symon"}, "edited": false, "score": 0, "creation_date": 1533171584, "post_id": 51636914, "comment_id": 90252418, "body": "Ah. My apologies then! Hopefully that link will help get you started at least"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10166453, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ck0tqpKFlSY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qqKCJ7ywZnURzBzUb0lqgDO-xSpg/mo/photo.jpg?sz=128", "display_name": "Zheng Yang Chiew", "link": "https://stackoverflow.com/users/10166453/zheng-yang-chiew"}, "edited": false, "score": 0, "creation_date": 1533225411, "post_id": 51644293, "comment_id": 90279322, "body": "Yes sorry the country pages look the same I.e. the columns have all the same headers but the exact location of the rows may not be the same. Meaning I may have 10 rows of data containing June in the first column for country 1 but 9 for country 2. The consolidated data tab is formatted the exact same way as countries but I want the copy paste to be sequential like country 1 Then country 2. Hope this clarifies, thanks!"}], "tags": [], "owner": {"reputation": 1, "user_id": 10168413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ada2eee0466c7b343b3fe5347e388bc?s=128&d=identicon&r=PG", "display_name": "Theodore Rapanu", "link": "https://stackoverflow.com/users/10168413/theodore-rapanu"}, "is_accepted": false, "score": 0, "last_activity_date": 1533173188, "creation_date": 1533173188, "answer_id": 51644293, "question_id": 51636914, "link": "https://stackoverflow.com/questions/51636914/excel-vba-how-to-copy-rows-based-on-a-criteria-from-multiplesheets-into-one-sh/51644293#51644293", "title": "Excel VBA - How to copy rows based on a criteria from multiplesheets into one sheet", "body": "<p>You have to be more specific - do all the country pages look the same? How are you indicating the criteria (i.e. June), and what do you want the consolidated data tab to look like?</p>\n"}], "owner": {"reputation": 1, "user_id": 10166453, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ck0tqpKFlSY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qqKCJ7ywZnURzBzUb0lqgDO-xSpg/mo/photo.jpg?sz=128", "display_name": "Zheng Yang Chiew", "link": "https://stackoverflow.com/users/10166453/zheng-yang-chiew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1533173188, "creation_date": 1533136639, "last_edit_date": 1533136831, "question_id": 51636914, "link": "https://stackoverflow.com/questions/51636914/excel-vba-how-to-copy-rows-based-on-a-criteria-from-multiplesheets-into-one-sh", "title": "Excel VBA - How to copy rows based on a criteria from multiplesheets into one sheet", "body": "<p>I've have a spreadsheet with multiple sheets and a need to copy specific rows based on a criteria (a specific month). So the idea is to be able to loop through the other sheets and copy rows (for example all rows with June in column 1) onto the sheet \"Consolidated Data\" from all the country files without touching  the \"Do not include\" sheet. </p>\n\n<p><img src=\"https://i.stack.imgur.com/wo8bK.jpg\" alt=\"Budgeting Pic\"></p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8716904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f7abf068ff7f953a76fee034d0e78?s=128&d=identicon&r=PG&f=1", "display_name": "CAW", "link": "https://stackoverflow.com/users/8716904/caw"}, "edited": false, "score": 0, "creation_date": 1533139453, "post_id": 51637383, "comment_id": 90239865, "body": "It is recognized as a number (I can write other formulas within the sheet and it will read the values in those cells and calculate correctly).        The original formula reads the correct cell references, as shown by the Excel formula evaluation - it <i>sees</i> the &quot;9&quot; written in the cell; it just doesn&#39;t <i>use</i> it properly.   I think it has something to do with formulas calculating &quot;automatically&quot;(?), but I can&#39;t figure out how my program might have changed that setting."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1533138061, "creation_date": 1533138061, "answer_id": 51637383, "question_id": 51636878, "link": "https://stackoverflow.com/questions/51636878/inserted-formula-with-cell-reference-does-not-recognize-new-input/51637383#51637383", "title": "Inserted formula with cell reference does not recognize new input", "body": "<p>Two things to check:  </p>\n\n<p>1) Value of the cells used is formatted to a number (i've had #Value based on that a couple times) and </p>\n\n<p>2) verify that modifying the code using fixed references provides the appropriate output (\"A16\" for some reason wasn't recognized as a cell reference in one I had show up).  E.g., \"$N\" &amp; i &amp; \"/$AP\" &amp; i</p>\n\n<hr>\n\n<p>If those both look alright, you might try something like:</p>\n\n<pre><code>.Range(.Cells(3,40),.Cells(lr,40)).Formula = \"=$N3/$AP3\" 'ensure no random spaces\n</code></pre>\n\n<p>This should act like a fill-down in which the # 3 is iterated with the same row as the formula.</p>\n"}], "owner": {"reputation": 63, "user_id": 8716904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f7abf068ff7f953a76fee034d0e78?s=128&d=identicon&r=PG&f=1", "display_name": "CAW", "link": "https://stackoverflow.com/users/8716904/caw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594211245, "creation_date": 1533136533, "last_edit_date": 1594211245, "question_id": 51636878, "link": "https://stackoverflow.com/questions/51636878/inserted-formula-with-cell-reference-does-not-recognize-new-input", "title": "Inserted formula with cell reference does not recognize new input", "body": "<p>I swear this just worked yesterday...</p>\n\n<p>I have a program that creates formulas within certain cells that depend on subsequent data entries into other cells:</p>\n\n<pre><code>Cells(i, 40).Formula = \"= (N\" &amp; i &amp; \")/AP\" &amp; i\n</code></pre>\n\n<p>So, AP<em>i</em> can be input and/or changed after the fact, and the formula should give you the result for whatever value is there.  However, I get a #Div/0! error no matter what value is in that cell.  When I evaluate the formula (within Excel) and step through the calculations, it shows this (for one particular cell):</p>\n\n<p>= (N64)/AP64  = (47.35)/AP64  = 47.35/AP64  = <strong>47.35/9</strong>  = #DIV/0!</p>\n\n<p>So, the formula recognizes that there is a value in the cell AP64, but then does not use it to properly calculate the result.</p>\n\n<p>As I said at the top, this worked as I expected yesterday afternoon when I was testing it.  Now that I need other people to start using it, of course, it doesn't.  I changed nothing within the program relative to these lines of code.</p>\n\n<p>I apologize if this is answered elsewhere - I really have no idea how to create a search for this type of problem.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1533136749, "post_id": 51636675, "comment_id": 90238180, "body": "@PeterT&#39;s answer will surely help you and probably solve your issue as a whole. As a side note you can replace the <code>if</code> block with this <code>iRow.EntireRow.Hidden = iRow.Text = &quot;A&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7857362, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1777d3e18012d4b78b9a7e5a2c118b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Vinz B", "link": "https://stackoverflow.com/users/7857362/vinz-b"}, "edited": false, "score": 0, "creation_date": 1533217673, "post_id": 51636805, "comment_id": 90273982, "body": "Thanks a lot mate. It works like a gem now. much appreciate your advice."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 3, "last_activity_date": 1533136306, "creation_date": 1533136306, "answer_id": 51636805, "question_id": 51636675, "link": "https://stackoverflow.com/questions/51636675/hide-and-unhide-toggle-button-running-very-slow/51636805#51636805", "title": "Hide and Unhide Toggle button - running very slow", "body": "<p>Each time you hide a row, Excel then is stopping to update your screen (and potentially perform calculations). So to help really speed things up, disable all the screen updates and application events (including calculations) until you've finished hiding.</p>\n\n<p>So with a Sub like this:</p>\n\n<pre><code>Private Sub SetUpdates(ByVal newState As Boolean)\n    With Application\n        .ScreenUpdating = newState\n        .EnableEvents = newState\n        .DisplayAlerts = newState\n    End With\nEnd Sub\n</code></pre>\n\n<p>You can do something like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    SetUpdates newState:=False\n\n    '--- hide your rows here\n\n    SetUpdates newState:=True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1533137646, "creation_date": 1533137646, "answer_id": 51637248, "question_id": 51636675, "link": "https://stackoverflow.com/questions/51636675/hide-and-unhide-toggle-button-running-very-slow/51637248#51637248", "title": "Hide and Unhide Toggle button - running very slow", "body": "<p>You could use <code>AutoFilter</code>.  </p>\n\n<p>This procedure will hide any row that doesn't contain a value in column A on whichever sheet reference is passed to it.  If the filter is already applied it will remove it.</p>\n\n<pre><code>Public Sub HideA(wrkSht As Worksheet)\n\n    With wrkSht\n        If .FilterMode Then\n            .ShowAllData\n        Else\n            .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)) _\n                .AutoFilter Field:=1, Criteria1:=\"=\", VisibleDropDown:=False\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>On each sheet that contains a button add this code for the button (renaming the procedure as required):  </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    HideA ActiveSheet\nEnd Sub  \n</code></pre>\n\n<p>The one downside to this is that it doesn't include cell <code>A1</code> in the filtering.</p>\n"}], "owner": {"reputation": 33, "user_id": 7857362, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1777d3e18012d4b78b9a7e5a2c118b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Vinz B", "link": "https://stackoverflow.com/users/7857362/vinz-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594211237, "creation_date": 1533135899, "last_edit_date": 1594211237, "question_id": 51636675, "link": "https://stackoverflow.com/questions/51636675/hide-and-unhide-toggle-button-running-very-slow", "title": "Hide and Unhide Toggle button - running very slow", "body": "<p>I have a workbook with 12 sheets and I have placed one Command button in each sheet to hide/unhide rows. For hiding specific rows, I have typed \"A\" in coloumn A, for every row that needs to be hidden. So code works but it runs forever, takes long time and very slow in hidding or unhiding the rows. In some sheets total number of rows to check are 100 and some sheets it is 750. Please advice the reason for slow running or Is there a better way I can make it work faster. Here is the code:-</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nSheet2.Unprotect (\"aaa\")\nDim rng As Range\nDim iRow As Range\nDim hidden_status As Boolean\n\nCommandButton1.Caption = \"Show / Hide Guidelines\"\n\nOn Error Resume Next\n\n   Set rng = Range(\"A1:A750\")\n    For Each iRow In rng.Rows\n        If iRow.Text = \"A\" Then\n           With iRow.EntireRow\n                 hidden_status = .Hidden\n                .Hidden = Not hidden_status\n           End With\n        End If\n    Next iRow\n\nOn Error GoTo 0\nSheet2.Protect (\"aaa\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "spreadsheet", "vlookup", "concat"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1533135993, "post_id": 51636625, "comment_id": 90237687, "body": "look into the tag <a href=\"https://stackoverflow.com/questions/tagged/textjoin\">TextJoin</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10077245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gBEdQm_CBsg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ruHp3QuMhTixkb49QB2lCuSq37iA/mo/photo.jpg?sz=128", "display_name": "Lizzie", "link": "https://stackoverflow.com/users/10077245/lizzie"}, "edited": false, "score": 0, "creation_date": 1533222674, "post_id": 51644009, "comment_id": 90277570, "body": "Thank you for your response I will try this out :D"}, {"owner": {"reputation": 1, "user_id": 10077245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gBEdQm_CBsg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ruHp3QuMhTixkb49QB2lCuSq37iA/mo/photo.jpg?sz=128", "display_name": "Lizzie", "link": "https://stackoverflow.com/users/10077245/lizzie"}, "edited": false, "score": 0, "creation_date": 1533224857, "post_id": 51644009, "comment_id": 90279008, "body": "Hi Theodore - thank you for your help. I am getting a compile error when i run this code (Wrong number of dimensions) for the &#39;If AlreadyUsed (y)&#39; part."}, {"owner": {"reputation": 1, "user_id": 10077245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gBEdQm_CBsg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ruHp3QuMhTixkb49QB2lCuSq37iA/mo/photo.jpg?sz=128", "display_name": "Lizzie", "link": "https://stackoverflow.com/users/10077245/lizzie"}, "edited": false, "score": 0, "creation_date": 1533226113, "post_id": 51644009, "comment_id": 90279673, "body": "Also to make things more of a mission I have been asked to include three image codes for each product - two having a higher price and one a lower price. So each product has three alternative products. I am looking in to your code now and seeing how i can adapt it - however im such a vba beginner so this is not easy (but nothing worth knowing is, right?)"}], "tags": [], "owner": {"reputation": 1, "user_id": 10168413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ada2eee0466c7b343b3fe5347e388bc?s=128&d=identicon&r=PG", "display_name": "Theodore Rapanu", "link": "https://stackoverflow.com/users/10168413/theodore-rapanu"}, "is_accepted": false, "score": 0, "last_activity_date": 1533172107, "last_edit_date": 1533172107, "creation_date": 1533169923, "answer_id": 51644009, "question_id": 51636625, "link": "https://stackoverflow.com/questions/51636625/return-all-values-from-a-column-to-a-single-cell-if-they-are-in-the-same-product/51644009#51644009", "title": "Return all values from a column to a single cell if they are in the same product family in that row and if the price is higher in that row", "body": "<pre><code>Sub AltProducts()\n\nDim ImageCodeArray(4000,1) as Variant  'array to hold all image codes\nDim AlreadyUsed(4000,1) as Variant     'array to keep track of already used image codes\nDim R as Range                         'first cell containing data in product family column\nDim R1 as Range                        'first cell containing data in image code column\nDim R2 as Range                        'first cell containing data (a blank) in alternative products column\n\n\nSet R = ActiveSheet.Range(\"first cell in Product Family column, under header\")\nSet R1 = ActiveSheet.Range(\"first cell in Image Code column, under header\")\nSet R2 = ActiveSheet.Range(\"first cell in Alternative Products column, under header\")\n\n'this piece builds a 2d array with product family and image code for lookup\n\nFor i = 0 to 4000                      \n    ImageCodeArray(i,0) = R.Offset(x,0)\n    ImageCodeArray(i,1) = R1.Offset(x,0)\nNext i\n\nFor x = 0 to 4000\n    For z = 0 to 4000\n\n'begins looping through product family, and looks up the first entry in the array that matches the product family we're looking for\n\n        If ImageCodeArray(z,0) = R.Offset(x,0) Then    \n            For y = 0 to 4000\n\n'Checks to see if we have already included the image code associated with the product family we just found in the alternative items cell. If we have, skip to the next iteration.\n\n                If AlreadyUsed(y) = ImageCodeArray(z,1) Then Goto Skip  \n            Next y\n\n'if the image code has not already been used, this next step adds it into the appropriate cell in the alternative products column\n\n            R2.Offset(x,0) = R2.Offset(x,0) &amp; ImageCodeArray(z,1) &amp; \"&amp;&amp;\"\n\n'add the image code we just added onto the already used list\n\n            AlreadyUsed(z) = ImageCodeArray(z,1)     \n        End If\n    Skip:\n    Next z\nErase AlreadyUsed(4000,1)\n\n'Move down one cell in the product family column, repeat process\n\nNext x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10077245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gBEdQm_CBsg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ruHp3QuMhTixkb49QB2lCuSq37iA/mo/photo.jpg?sz=128", "display_name": "Lizzie", "link": "https://stackoverflow.com/users/10077245/lizzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1533172107, "creation_date": 1533135763, "question_id": 51636625, "link": "https://stackoverflow.com/questions/51636625/return-all-values-from-a-column-to-a-single-cell-if-they-are-in-the-same-product", "title": "Return all values from a column to a single cell if they are in the same product family in that row and if the price is higher in that row", "body": "<p>I'm struggling to find a formula or VBA that will perform this function.</p>\n\n<p>I have the following columns: 'price', 'image code', 'product family' and 'alternative products' columns. </p>\n\n<p>I want to populate the '<strong>alternative products</strong>' column with all <strong>image codes</strong> that are in the same <strong>product family</strong> of the item in that row (not including its own code) and that have a higher <strong>price</strong> than the item in that row. So a few image codes will be returned to one cell with &amp;&amp; between each code for website and sage upload.</p>\n\n<p>I am looking for a formula or code that can be applied to 4000 products. I have looked at combining vlookup and concat but to no avail. Any help would be greatly appreciated as am still learning the art of excel.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1533135985, "post_id": 51636576, "comment_id": 90237676, "body": "Do you mean hide the row? You can&#39;t hide individual cells (depending on what you mean by hidden)."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533135988, "post_id": 51636576, "comment_id": 90237683, "body": "So what is the excat question? Do you want us to write code for the request described in 1 to 6?"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1533136343, "post_id": 51636576, "comment_id": 90237911, "body": "@DSQ123: maybe you could try <code>For Each c In Me.Range(&quot;B3:D1000&quot;)</code> ?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1533144393, "post_id": 51636576, "comment_id": 90242512, "body": "First; you do not need the <code>If ToggleButton2</code> since your sub is based on the <code>Click</code> action. Second; <code>Me</code> refers to the current form not the worksheet. See <a href=\"http://dailydoseofexcel.com/archives/2004/04/20/the-me-keyword/\" rel=\"nofollow noreferrer\">This link</a>"}, {"owner": {"reputation": 11, "user_id": 9995583, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bg9EnFvwWcE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1b-VSwGjdjSSlHDWXL5VwxN4hvkQ/mo/photo.jpg?sz=128", "display_name": "DSQ123", "link": "https://stackoverflow.com/users/9995583/dsq123"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1533144656, "post_id": 51636576, "comment_id": 90242625, "body": "@SJR, yes I mean hide the entire row."}, {"owner": {"reputation": 11, "user_id": 9995583, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bg9EnFvwWcE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1b-VSwGjdjSSlHDWXL5VwxN4hvkQ/mo/photo.jpg?sz=128", "display_name": "DSQ123", "link": "https://stackoverflow.com/users/9995583/dsq123"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533144720, "post_id": 51636576, "comment_id": 90242661, "body": "@Storax I was wondering if you could help me correct it was all, it sort of works, but not entirely."}, {"owner": {"reputation": 11, "user_id": 9995583, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bg9EnFvwWcE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1b-VSwGjdjSSlHDWXL5VwxN4hvkQ/mo/photo.jpg?sz=128", "display_name": "DSQ123", "link": "https://stackoverflow.com/users/9995583/dsq123"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533144786, "post_id": 51636576, "comment_id": 90242690, "body": "@OurManinBananas Does not work, same issue."}, {"owner": {"reputation": 11, "user_id": 9995583, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bg9EnFvwWcE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1b-VSwGjdjSSlHDWXL5VwxN4hvkQ/mo/photo.jpg?sz=128", "display_name": "DSQ123", "link": "https://stackoverflow.com/users/9995583/dsq123"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1533144832, "post_id": 51636576, "comment_id": 90242717, "body": "@GMalc I&#39;ll take a look at that. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9995583, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bg9EnFvwWcE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1b-VSwGjdjSSlHDWXL5VwxN4hvkQ/mo/photo.jpg?sz=128", "display_name": "DSQ123", "link": "https://stackoverflow.com/users/9995583/dsq123"}, "edited": false, "score": 0, "creation_date": 1533145468, "post_id": 51638808, "comment_id": 90243053, "body": "I used your formula and it results in the same problem of missing a few rows.   The link here: <a href=\"https://imgur.com/a/49YmfR8\" rel=\"nofollow noreferrer\">imgur.com/a/49YmfR8</a> Shows the state of my test sheet before running the VBA.  The link here shows the result: <a href=\"https://imgur.com/a/yBKEgTj\" rel=\"nofollow noreferrer\">imgur.com/a/yBKEgTj</a>  Notice the highlighted row (Row 11) is not visible after running the VBA.   What I&#39;ve noticed is that it works if anything is in column &quot;D&quot; but not if something is in columns B and C but NOT in D."}], "tags": [], "owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "is_accepted": false, "score": 0, "last_activity_date": 1533173365, "last_edit_date": 1533173365, "creation_date": 1533143345, "answer_id": 51638808, "question_id": 51636576, "link": "https://stackoverflow.com/questions/51636576/vba-hide-columns-based-on-criteria/51638808#51638808", "title": "VBA Hide Columns Based on Criteria", "body": "<p>As written, <code>Me</code> would refer to <code>ToggleButton2</code>, correct? I would think you would want to refer to the sheet itself, a la:</p>\n\n<p>Edit: Ohh, I see what's happening. As written, if ANY of the cells are wrong, it'll hide. This version will change it so if ANY of the cells AREN'T wrong, it WON'T hide. Hopefully this does the trick. (Also it's a lot faster)</p>\n\n<pre><code>Private Sub ToggleButton2_Click()\nDim ws As Worksheet, x(2) As Long, y(3) As Long, z As Long\n\nSet ws = ActiveWorkbook.ActiveSheet\n\nx(1) = 3: x(2) = 1000\ny(1) = 2: y(2) = 3: y(3) = 4\n\nApplication.ScreenUpdating = False\n\nIf ToggleButton2 Then\n\n    For z = x(1) To x(2)\n\n        If _\n        IsValid(ws.Cells(z, y(1)).Value) Or _\n        IsValid(ws.Cells(z, y(2)).Value) Or _\n        IsValid(ws.Cells(z, y(3)).Value) Then\n            ws.Rows(z).Hidden = False\n        Else\n            ws.Rows(z).Hidden = True\n        End If\n\n    Next z\n\nEnd If\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n'--------\n\nFunction IsValid(val) As Boolean\nIf val = 0 Or val = \"\" Then\n    IsValid = False\nElse\n    IsValid = True\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1533173330, "creation_date": 1533173330, "answer_id": 51644307, "question_id": 51636576, "link": "https://stackoverflow.com/questions/51636576/vba-hide-columns-based-on-criteria/51644307#51644307", "title": "VBA Hide Columns Based on Criteria", "body": "<p>Try this; it loops down the rows and checks all three cells in the row for your criteria, if it meets the criteria it will hide the row.</p>\n\n<pre><code>Dim i As Long\nFor i = 3 To 1000\n\n    If (Range(\"C\" &amp; i) = \"\" Or Range(\"C\" &amp; i) = \"0\") _\n        And (Range(\"D\" &amp; i) = \"\" Or Range(\"D\" &amp; i) = \"0\") _\n        And (Range(\"E\" &amp; i) = \"\" Or Range(\"E\" &amp; i) = \"0\") Then\n        Range(\"A\" &amp; i).EntireRow.Hidden = True\n    End If\n\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1538943226, "last_edit_date": 1538943226, "creation_date": 1538939818, "answer_id": 52691990, "question_id": 51636576, "link": "https://stackoverflow.com/questions/51636576/vba-hide-columns-based-on-criteria/52691990#52691990", "title": "VBA Hide Columns Based on Criteria", "body": "<h2>One Button Only (Toggle)</h2>\n\n<p>In your code, the line <code>For Each c In Me.Range(\"B3:B1000, C3:C1000, D3:D1000\")</code> with the part <strong>B3:1000</strong> indicates that the range to be processed starts with the second column (<strong>B</strong>), but in the picture it looks like the range starts with the third column (<strong>C</strong>). Therefore:</p>\n\n<p>Before using this code carefully read through the <strong>customize</strong> section where you have to change the values to fit your needs.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub ToggleHideShow_Click()\n\nApplication.ScreenUpdating = False\n\n'--Customize BEGIN ---------------------\n    Const ciRowStart As Integer = 3 'First row of data\n    Const ciRowEnd As Integer = 1000 'At least the last row of data.\n    Const ciColStart As Integer = 3 'First column of data\n    Const ciColEnd As Integer = 5 'Last column of data\n'--Customize BEGIN ---------------------\n\n    Dim iRowCounter As Integer\n    Dim iColCounter As Integer\n    Dim oRng As Range\n\n  If ToggleHideShow.Caption = \"Show\" Then\n\n    Set oRng = Range(ciRowStart &amp; \":\" &amp; ciRowEnd)\n    oRng.EntireRow.Hidden = False\n\n    ToggleHideShow.Caption = \"Hide\"\n\n    MsgBox \"All Rows Unhidden.\" 'I would get rid of it.\n\n   Else\n\n    For iRowCounter = ciRowStart To ciRowEnd\n      For iColCounter = ciColStart To ciColEnd\n        Set oRng = Cells(iRowCounter, iColCounter)\n        If oRng.Value = 0 Or oRng.Value = \"\" Then\n          oRng.EntireRow.Hidden = True\n          Exit For 'To immediately go to the next row.\n        End If\n      Next\n    Next\n\n    ToggleHideShow.Caption = \"Show\"\n\n  End If\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The concept of a toggle button is to have <strong>one button only</strong> which will change the  state of something when being clicked on, e.g. on <strong>click</strong> make a font <strong>bold</strong> and on the next <strong>click</strong> make it back <strong>normal</strong> and on the next <strong>click</strong> again <strong>bold</strong>, and on the next <strong>click</strong> again <strong>normal</strong> and so on.</p>\n"}], "owner": {"reputation": 11, "user_id": 9995583, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bg9EnFvwWcE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1b-VSwGjdjSSlHDWXL5VwxN4hvkQ/mo/photo.jpg?sz=128", "display_name": "DSQ123", "link": "https://stackoverflow.com/users/9995583/dsq123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1161, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1538943226, "creation_date": 1533135611, "last_edit_date": 1533135766, "question_id": 51636576, "link": "https://stackoverflow.com/questions/51636576/vba-hide-columns-based-on-criteria", "title": "VBA Hide Columns Based on Criteria", "body": "<p>I'm having a bit of trouble with some VBA code in achieving the desired outcome. </p>\n\n<p><a href=\"https://i.stack.imgur.com/cmQYv.png\" rel=\"nofollow noreferrer\">Example</a></p>\n\n<p>What I am trying to achieve with the example above is to, with the push of a toggle button the following will happen: </p>\n\n<ol>\n<li>All Rows with no data <strong>OR</strong> $0 in the most recent 3 columns (DEC, NOV, and OCT in the example) will be hidden. (Green cells).</li>\n<li>Rows with at least one value in the 3 most recent columns will remain visible (Blue Cells)</li>\n<li>Rows with all cells filled with a value above $0 will be visible (Yellow Cells). </li>\n</ol>\n\n<p>Then, I need another toggle button to unhide everything in the event one of the hidden rows has a new charge. </p>\n\n<p>BACKGROUND: </p>\n\n<p>We own apartment buildings, and when the apartments are vacant, we must pay the utilities. When someone rents the apartment, we will not pay them. We want to track history and trends for when they are vacant, and when they are not vacant, we want them to be hidden to cut down on scrolling. </p>\n\n<p>PROPOSED OPERATION: </p>\n\n<p>In practice, we would like to see the following occur:</p>\n\n<ol>\n<li>Invoices received. </li>\n<li>One of the invoices references a hidden property. </li>\n<li>Manager presses \"Unhide All\" toggle button. </li>\n<li>Manager enters values. </li>\n<li>Manager presses \"Hide Unused\" toggle button. </li>\n<li>All rows with no values in current and previous 2 months (3 months total) will be hidden. </li>\n</ol>\n\n<p>My VBA below does not hide the cells properly. </p>\n\n<pre><code>Private Sub ToggleButton1_Click()\n\nIf ToggleButton1 Then\n    MsgBox \"All Rows Unhidden.\"\n    Rows(\"1:1000\").EntireRow.Hidden = False\nEnd If\n\nEnd Sub\n\nPrivate Sub ToggleButton2_Click()\n\nIf ToggleButton2 Then\n    Dim c As Range\n    Application.ScreenUpdating = False\n    For Each c In Me.Range(\"B3:B1000, C3:C1000, D3:D1000\")\n        If c.Value = 0 Or c.Value = \"\" Then\n            c.EntireRow.Hidden = True\n        Else\n            c.EntireRow.Hidden = False\n    End If\nNext c\nApplication.ScreenUpdating = True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This formula for ToggleButton2 does not work and misses values unless they are in range D3:D1000. </p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 19603, "user_id": 339843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/53a8a18baa2eda6e6758c3e522f77c24?s=128&d=identicon&r=PG", "display_name": "tofutim", "link": "https://stackoverflow.com/users/339843/tofutim"}, "edited": false, "score": 0, "creation_date": 1533136647, "post_id": 51636504, "comment_id": 90238113, "body": "Could it be a security issue?"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533136652, "post_id": 51636504, "comment_id": 90238115, "body": "you may find siome help <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_mac-mso_mac2016/macro-from-excel-for-mac-2011-crashing-in-excel/866066c7-594f-49a0-b4ad-2f0d1bbb2aa3\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533136791, "post_id": 51636504, "comment_id": 90238214, "body": "you may also find some help at Github <a href=\"https://github.com/VBA-tools/VBA-Web/issues/248\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 95060, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 2, "creation_date": 1533143280, "post_id": 51636504, "comment_id": 90241971, "body": "The output is out of order because you separated commands with <code>&amp;</code>, which tells the shell to run all but the last command in the background. If you just want to run them sequentially, separate them with <code>;</code>. If you want to run each command only if the previous one succeeded, separate them with <code>&amp;&amp;</code>."}], "owner": {"reputation": 19603, "user_id": 339843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/53a8a18baa2eda6e6758c3e522f77c24?s=128&d=identicon&r=PG", "display_name": "tofutim", "link": "https://stackoverflow.com/users/339843/tofutim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533136181, "creation_date": 1533135414, "last_edit_date": 1533136181, "question_id": 51636504, "link": "https://stackoverflow.com/questions/51636504/add-usr-local-bin-to-path-calling-popen-from-excel-2016-osx", "title": "Add /usr/local/bin to $PATH calling popen from Excel 2016 (OSX)", "body": "<p>I am using Excel 2016 on a Mac. Inside a VBA script, I have</p>\n\n<pre><code>Private Declare PtrSafe Function popen64 Lib \"libc.dylib\" Alias \"popen\" (ByVal command As String, ByVal mode As String) As LongPtr\nPrivate Declare PtrSafe Function pclose64 Lib \"libc.dylib\" Alias \"pclose\" (ByVal file As LongPtr) As Long\nPrivate Declare PtrSafe Function fread64 Lib \"libc.dylib\" Alias \"fread\" (ByVal outStr As String, ByVal size As LongPtr, ByVal items As LongPtr, ByVal stream As LongPtr) As Long\nPrivate Declare PtrSafe Function feof64 Lib \"libc.dylib\" Alias \"feof\" (ByVal file As LongPtr) As LongPtr\n\n' @internal\nPublic Type ShellResult\n    Output As String\n    ExitCode As Long\nEnd Type\nPublic Function ExecuteInShell(command As String) As ShellResult\n    Dim result As LongPtr\n    Dim chunk As String\n    Dim read As Long\n\n    result = popen64(command, \"r\")\n\n    If result = 0 Then\n        ' TODO Investigate why this could happen and what should be done if it happens\n        Exit Function\n    End If\n\n    Do While feof64(result) = 0\n        chunk = VBA.Space$(50)\n        read = fread64(chunk, 1, Len(chunk) - 1, result)\n        If read &gt; 0 Then\n            chunk = VBA.Left$(chunk, read)\n            ExecuteInShell.Output = ExecuteInShell.Output &amp; chunk\n        End If\n    Loop\ncleanup:\n    ExecuteInShell.ExitCode = pclose64(result)\nEnd Function\nSub Process_Click()\n    Dim result As ShellResult\n    result = ExecuteInShell(\"echo $SHELL &amp; whoami &amp; echo $PATH &amp; pwd\")\n    Debug.Print (result.Output)\n End Sub\n</code></pre>\n\n<p>When I run Process_Click, I see the following:</p>\n\n<pre><code>/bin/bash\n/Users/tim/Library/Containers/com.microsoft.Excel/Data\n/usr/bin:/bin:/usr/sbin:/sbin\ntim\n</code></pre>\n\n<p>Note the the order is odd, as if each is running on a separate thread (that's probably a hint I'm doing something wrong!). I would like to run a program (rscript) which is in /usr/local/bin. However if I run <code>ExecuteInShell(\"/usr/local/bin/rscript\")</code> I get no output. Strangely also, if I <code>ExecuteInShell(\"ls\")</code> I see the right contents, but I get a blank result if I <code>ExecuteInShell(\"ls /usr/local/bin\")</code>. Perhaps there is some escaping issue?</p>\n\n<p>TL;DR. I need to either add <code>/usr/local/bin</code> to my popen $PATH or call my script using <code>/usr/local/bin/rscript</code> but I can't! Any assistance much appreciated.</p>\n"}, {"tags": ["vba", "excel", "parsing", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "edited": false, "score": 0, "creation_date": 1533136589, "post_id": 51636113, "comment_id": 90238069, "body": "Maybe you would be happier skipping the user interface copy-paste method and instead go to the temporary internet files and find the .html document instead.  Tell me if you have already ruled this method out!"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1533136767, "post_id": 51636113, "comment_id": 90238193, "body": "Could you please provide actual URL and expected output? That might be <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}, {"owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533137074, "post_id": 51636113, "comment_id": 90238408, "body": "@omegastripes, unfortunately I can&#39;t, it&#39;s an intranet address. elliotsvensson,  I have not, I&#39;m not sure how to do that."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533137186, "post_id": 51636113, "comment_id": 90238474, "body": "Anyway, you could share HTML content (the relevent part with cleaned up sensitive data), and expected output."}, {"owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "edited": false, "score": 0, "creation_date": 1533137551, "post_id": 51636113, "comment_id": 90238716, "body": "How do I get the HTML content? I navigated to the temp internet folder. I don&#39;t see HTML type in the files"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533138014, "post_id": 51636113, "comment_id": 90239028, "body": "why are you not already in the right window/tab? Have you clicked on something that has led you to a new window/tab?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533138157, "post_id": 51636113, "comment_id": 90239118, "body": "Also check <a href=\"https://stackoverflow.com/a/21490198/2165759\">this answer</a>."}, {"owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533138189, "post_id": 51636113, "comment_id": 90239147, "body": "@Qharr, no I haven&#39;t. This is an already open webpage. I just can&#39;t switch to it and sendkey to &quot;select all&quot; on this particular tab"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533138376, "post_id": 51636113, "comment_id": 90239236, "body": "And you can&#39;t navigate to this tab/webpage using IE because of login issues?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533138515, "post_id": 51636113, "comment_id": 90239333, "body": "IMO better to refuse from <code>SendKeys</code> as most unreliable. Get a reference to the IE with opened workpage <code>Application</code> object, and work directly with DOM."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1533146222, "post_id": 51636113, "comment_id": 90243443, "body": "@sagittarius_88 You can get the HTML content of the webpage by the following steps: in IE navigate to the target webpage, press F12, go to DOM Explorer tab, find root <code>&lt;html&gt;</code> tag, right click on it, choose copy in context menu. Take a look at <a href=\"https://i.stack.imgur.com/AeLgT.png\" rel=\"nofollow noreferrer\">this screenshot</a>. Then you may paste the copied HTML content to a notepad, make some cleanups if necessary, and share."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1533135911, "creation_date": 1533135911, "answer_id": 51636679, "question_id": 51636113, "link": "https://stackoverflow.com/questions/51636113/vba-copy-data-text-from-an-existing-open-internet-explorer-tab/51636679#51636679", "title": "VBA: Copy data/text from an existing open Internet Explorer tab", "body": "<p>He is one way to get the handle of the IE</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim ShellApp As Object, ShellWindows As Object\n    Dim objIE As Object, objWin As Object\n    Dim ieCaption As String\n\n    Set ShellApp = CreateObject(\"Shell.Application\")\n    Set ShellWindows = ShellApp.Windows()\n\n    '~~&gt; Loop through the windows and check if it is IE\n    For Each objWin In ShellWindows\n        If (Not objWin Is Nothing) Then\n            ieCaption = objWin.Name\n            If ieCaption = \"Internet Explorer\" Then\n                Set objIE = objWin\n                Exit For\n            End If\n        End If\n    Next\n\n    Set ShellApp = Nothing\n\n    '~~&gt; If IE is found then wirk with that object\n    If Not objIE Is Nothing Then\n        With objIE\n            Debug.Print .Document.Body.Innerhtml\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2542, "favorite_count": 1, "accepted_answer_id": 51636679, "answer_count": 1, "score": 0, "last_activity_date": 1533137592, "creation_date": 1533134363, "last_edit_date": 1533137592, "question_id": 51636113, "link": "https://stackoverflow.com/questions/51636113/vba-copy-data-text-from-an-existing-open-internet-explorer-tab", "title": "VBA: Copy data/text from an existing open Internet Explorer tab", "body": "<p>I'm trying to write a VBA code which allows me to copy data from an existing open IE tab maybe by sending a <kbd>CTRL+A</kbd> &amp; <kbd>CTRL+C</kbd> with <code>SendKey</code> method and then pasting it to a sheet on Excel.\nI have tried \"Get Data from Web\" but that doesn't work since I need to enter username/password and can't setup a <code>getElementbyId</code> lines.\nSo I found some code, that scans the open tabs of an already active Internet explorer session, but I want to make VBA Switch to the tab that matched and Copy the text from this website.</p>\n\n<pre><code>Sub AAA()\n\n    marker = 0\n    Set objShell = CreateObject(\"Shell.Application\")\n    IE_count = objShell.Windows.Count\n    For x = 0 To (IE_count - 1)\n        On Error Resume Next    ' sometimes more web pages are counted than are open\n        my_url = objShell.Windows(x).Document.Location\n        my_title = objShell.Windows(x).Document.Title\n        If my_url Like \"http://www.cnn.com\" &amp; \"*\" Then 'compare to find if the desired web page is already open\n            Set ie = objShell.Windows(x)\n            marker = 1\n            Exit For\n        Else\n        End If\n    Next\n    If marker = 0 Then\n        MsgBox (\"A matching webpage was NOT found\")\n    Else\n        'Switch to the tab that matched and Copy the text from this website..\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1533135760, "post_id": 51636147, "comment_id": 90237526, "body": "My main issue with null values is that when they are pulled back from the tables by VBA they cause errors. If the column has nothing in it at all it&#39;s fine, but if it has NULL in it it causes errors."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1533140675, "post_id": 51636147, "comment_id": 90240559, "body": "Again there are proper ways to handle nulls for both side of the data traffic."}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1533141029, "post_id": 51636147, "comment_id": 90240775, "body": "can you elaborate on that?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1533144918, "post_id": 51636147, "comment_id": 90242752, "body": "Well the advice might change based on how youre loading the texboxes with the values form the sql tables. Can you share what youre using to do this? ISNULL() function is pretty useful"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1533134791, "last_edit_date": 1533134791, "creation_date": 1533134467, "answer_id": 51636147, "question_id": 51636017, "link": "https://stackoverflow.com/questions/51636017/setting-all-text-boxes-default-value-when-application-loaded/51636147#51636147", "title": "Setting all text boxes default value when application loaded", "body": "<p>Yes, set the value of the textbox. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Dd7AD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dd7AD.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>OR on the load event you can write a whole bunch of statements that say </p>\n\n<pre><code> Me.TextBox1.Value=\"\"\n</code></pre>\n\n<p>I would also like to add setting the textboxes to empty strings, in my opinion, is a bad option. Account for the nulls the proper way. There's many different ways to handle this. I also dont see the issue with inserting null into a column where nulls are allowed. But I also dont know youre structure so whatever. </p>\n"}], "owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533134791, "creation_date": 1533134057, "question_id": 51636017, "link": "https://stackoverflow.com/questions/51636017/setting-all-text-boxes-default-value-when-application-loaded", "title": "Setting all text boxes default value when application loaded", "body": "<p>I have a VBA app built in MS-Word that has a lot of text boxes spread across many userforms that our users can fill out or not fill out. </p>\n\n<p>I'd like to avoid the values being NULL since these values get passed into SQL tables.</p>\n\n<p>Is there a way to globally set the default value of these boxes to \" \" so that they upload a blank instead of NULL?  </p>\n"}, {"tags": ["excel", "vba", "loops", "transpose"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1533134070, "post_id": 51635877, "comment_id": 90236329, "body": "Ca you give an example of existing data and expected output?"}, {"owner": {"reputation": 45, "user_id": 10160569, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160669068480313/picture?type=large", "display_name": "Benjamin Huis", "link": "https://stackoverflow.com/users/10160569/benjamin-huis"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1533196647, "post_id": 51635877, "comment_id": 90260282, "body": "In Excel Workfile CME: copy range J2:J10 to transfer it to workfile RME to be pasted on B2:J2 so it is important to have a transpose function in it.   For the next range I need to copy the range J12:J20 to transfer it to workfile RME to be pasted on B3:J3 and so on, therefore I need to create a loop right? With two different stepsizes for the copy and paste ranges"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10160569, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160669068480313/picture?type=large", "display_name": "Benjamin Huis", "link": "https://stackoverflow.com/users/10160569/benjamin-huis"}, "edited": false, "score": 0, "creation_date": 1533196782, "post_id": 51636256, "comment_id": 90260361, "body": "In Excel Workfile CME: copy range J2:J10 to transfer it to workfile RME to be pasted on B2:J2 so it is important to have a transpose function in it.   For the next range I need to copy the range J12:J20 to transfer it to workfile RME to be pasted on B3:J3 and so on, therefore I need to create a loop right? With two different stepsizes for the copy and paste ranges.  Thanks a lot already!"}], "tags": [], "owner": {"reputation": 1, "user_id": 10166390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u9dykS9qwXg/AAAAAAAAAAI/AAAAAAAAAFg/yOKVDT95Xws/photo.jpg?sz=128", "display_name": "Guilherme de Magalh&#227;es Sales", "link": "https://stackoverflow.com/users/10166390/guilherme-de-magalh%c3%a3es-sales"}, "is_accepted": false, "score": 0, "last_activity_date": 1533134787, "creation_date": 1533134787, "answer_id": 51636256, "question_id": 51635877, "link": "https://stackoverflow.com/questions/51635877/excel-vba-copy-paste-transpose-loop-issue/51636256#51636256", "title": "Excel VBA Copy Paste Transpose loop issue", "body": "<p>I don't know if I got your question right, but the following code transposes a range starting at A1 in CME to a transposed range starting at A1 in RME, regardless of its size.</p>\n\n<pre><code>Sub Transpose()\n\nDim Table As Range\nSet Table = Worksheets(\"CME\").Range(\"A1\", Range(\"A1\").End(xlDown).End(xlToRight))\n\nFor Each Cell In Table\n    RowNo = Cell.Row\n    ColNo = Cell.Column\n    Worksheets(\"RME\").Cells(ColNo, RowNo).Value = Cell.Value\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10160569, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160669068480313/picture?type=large", "display_name": "Benjamin Huis", "link": "https://stackoverflow.com/users/10160569/benjamin-huis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "closed_date": 1533212554, "answer_count": 1, "score": 1, "last_activity_date": 1533134787, "creation_date": 1533133652, "question_id": 51635877, "link": "https://stackoverflow.com/questions/51635877/excel-vba-copy-paste-transpose-loop-issue", "closed_reason": "Duplicate", "title": "Excel VBA Copy Paste Transpose loop issue", "body": "<p>For A model in Excel I would like to copy and paste data from one sheet in a workbook to the other sheet in the workbook and transpose this data with the usage of a for next loop. Data from the workfile CME should be pasted in the workfile of RME. The total lines of data is 2420. However, since the ranges in the two different workbook are different and step sizes are different, I assume that i should use two different variables. When I try to run  this code, it will give me an error. the first to codes are an example how it should be done manually without a loop. Thereafter the loop starts. Already a lot of thanks for the person who can help me with this issue</p>\n\n<p>I came up with the following formula:</p>\n\n<pre><code>Dim i As Long\nDim j As Long\n\nWorksheets(\"CME\").Range(\"J2:J10\").Copy\nWorksheets(\"RME\").Range(\"B2\").PasteSpecial Transpose:=True\n\nWorksheets(\"CME\").Range(\"J12:J20\").Copy\nWorksheets(\"RME\").Range(\"B3\").PasteSpecial Transpose:=True\n\nFor i = 11 To 2420 Step 10\n    Worksheets(\"CME\").Range (Cells(i + 11, 10)), Cells(i + 19, 10).Copy\n\n    For j = 3 To 2420 Step 1\n    Worksheets(\"RME\").Range(Cells(j + 1, 2)).PasteSpecial Transpose:=True\n    Next j\n\nNext i\n\nEnd Sub   \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1533132918, "post_id": 51635537, "comment_id": 90235448, "body": "Have a look at <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a> to extract data by any pattern. Regular Expressions is a mighty tool for such things."}, {"owner": {"reputation": 3, "user_id": 10164080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/npGhW.jpg?s=128&g=1", "display_name": "Gis", "link": "https://stackoverflow.com/users/10164080/gis"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1533133158, "post_id": 51635537, "comment_id": 90235637, "body": "@PEH Thanks, will have a look."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 1, "creation_date": 1533134656, "post_id": 51635537, "comment_id": 90236752, "body": "Why write VBA at all? You are asking to <i>import</i> a file into Excel. You can do that using the commands in the <code>Data</code> tab and use PowerQuery to clean up, transform the data"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 1, "creation_date": 1533134782, "post_id": 51635537, "comment_id": 90236835, "body": "BTW <code>Line Input</code>, <code>Close</code> etc aren&#39;t used in VBA. They are leftovers from VB5 or even earlier. Since the VB6 days people are using <code>FileSystemObject</code> and the other classes in the Scripting Runtime. Check <a href=\"https://stackoverflow.com/questions/3233203/how-do-i-use-filesystemobject-in-vba\">this question</a>. Excel&#39;s own data input functionality though is far more powerful"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10164080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/npGhW.jpg?s=128&g=1", "display_name": "Gis", "link": "https://stackoverflow.com/users/10164080/gis"}, "edited": false, "score": 0, "creation_date": 1533135494, "post_id": 51636080, "comment_id": 90237354, "body": "Hi! That&#39;s awesome! Worked like a charm! Thanks a lot. You&#39;re the best! :)"}, {"owner": {"reputation": 3, "user_id": 10164080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/npGhW.jpg?s=128&g=1", "display_name": "Gis", "link": "https://stackoverflow.com/users/10164080/gis"}, "edited": false, "score": 0, "creation_date": 1533136017, "post_id": 51636080, "comment_id": 90237705, "body": "Yup, just did. Thanks again. :)"}], "tags": [], "owner": {"reputation": 362, "user_id": 8787164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2495ce5899e819402eb40a0bb466a5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinh Can Code", "link": "https://stackoverflow.com/users/8787164/vinh-can-code"}, "is_accepted": true, "score": 1, "last_activity_date": 1533134257, "creation_date": 1533134257, "answer_id": 51636080, "question_id": 51635537, "link": "https://stackoverflow.com/questions/51635537/extract-data-from-text-file-into-excel/51636080#51636080", "title": "Extract Data from Text File into Excel", "body": "<p>I modify the code for you, it can work:</p>\n\n<pre><code>Sub ExtractData()\nDim filename As String, nextrow As Long, MyFolder As String\nDim MyFile As String, text As String, textline As String, filedate As String\nDim filenum As Integer\ndim idx%\n\nMyFolder = \"C:\\directory\\\"\nMyFile = Dir(MyFolder &amp; \"*.txt\")\n\nnextrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\nDo While MyFile &lt;&gt; \"\"\n\n    Open (MyFolder &amp; MyFile) For Input As #1\n\n    'nextrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n    Do Until EOF(1)\n        Line Input #1, textline 'read a line\n\n        idx = InStr(textline, \"DATE-TIME\") ' if has date, set it but not move to the next ROW\n        if idx &gt; 0 then \n            ActiveSheet.Cells(nextrow, \"A\").value = Mid(textline, idx + 16)\n        end if\n\n        idx = InStr(textline, \"CARD NUMBER\")\n        if idx &gt; 0 then\n            ActiveSheet.Cells(nextrow, \"B\").value = Mid(textline, filenum + 16)\n\n            nextrow = nextrow + 1 'now move to next row\n\n        end if\n\n    Loop\n    Close #1\n    MyFile = Dir()\n\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10164080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/npGhW.jpg?s=128&g=1", "display_name": "Gis", "link": "https://stackoverflow.com/users/10164080/gis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7686, "favorite_count": 0, "accepted_answer_id": 51636080, "answer_count": 1, "score": 0, "last_activity_date": 1533135328, "creation_date": 1533132775, "last_edit_date": 1533135328, "question_id": 51635537, "link": "https://stackoverflow.com/questions/51635537/extract-data-from-text-file-into-excel", "title": "Extract Data from Text File into Excel", "body": "<p>I am new to VBA so getting my task done is quite a struggle. Been reading and trying codes from different threads for a few days now to no success. So I am hoping someone could assist me. </p>\n\n<p>I have multiple text files that I need to extract data from. But I only need certain data such as DATE-TIME to be placed in the 1st column and CARD NUMBER in the 2nd column. Got codes from this thread >> <a href=\"https://stackoverflow.com/questions/28851974/extract-a-single-line-of-data-from-numerous-text-files-and-import-into-excel\">Extract a single line of data from numerous text files and import into Excel</a> but my output only shows the first data from the file. Please see the attached files below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SKEYc.png\" rel=\"nofollow noreferrer\">sample text</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OAD3W.png\" rel=\"nofollow noreferrer\">Output</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/VC7p4.png\" rel=\"nofollow noreferrer\">Desired Output</a></p>\n\n<p>Here's what I have:</p>\n\n<pre><code>Sub ExtractData()\nDim filename As String, nextrow As Long, MyFolder As String\nDim MyFile As String, text As String, textline As String, filedate As String\nDim filenum As Integer\n\nMyFolder = \"C:\\directory\\\"\nMyFile = Dir(MyFolder &amp; \"*.txt\")\n\nDo While MyFile &lt;&gt; \"\"\n    Open (MyFolder &amp; MyFile) For Input As #1\n    Do Until EOF(1)\n        Line Input #1, textline\n        text = text &amp; textline\n\n    Loop\n    Close #1\n    MyFile = Dir()\n    Debug.Print text\n    filedate = InStr(text, \"DATE-TIME\")\n    nextrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n    ActiveSheet.Cells(nextrow, \"A\").value = Mid(text, filedate + 16, 17)\n\n    filenum = InStr(text, \"CARD NUMBER\")\n    nextrow = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row + 1\n    ActiveSheet.Cells(nextrow, \"B\").value = Mid(text, filenum + 16, 10)\n    text = \"\"  \nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba"], "comments": [{"owner": {"reputation": 5821, "user_id": 3394255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1munp.jpg?s=128&g=1", "display_name": "Dave.Gugg", "link": "https://stackoverflow.com/users/3394255/dave-gugg"}, "edited": false, "score": 0, "creation_date": 1533133418, "post_id": 51635472, "comment_id": 90235833, "body": "Are you using <code>Option Base 1</code>?  If not, your .Item may be missing the 0 connection and be failing on the Count + 1 connection."}, {"owner": {"reputation": 3, "user_id": 10166263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61118479e7198a89e3842af6a92ca4c3?s=128&d=identicon&r=PG&f=1", "display_name": "r0xxoff", "link": "https://stackoverflow.com/users/10166263/r0xxoff"}, "reply_to_user": {"reputation": 5821, "user_id": 3394255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1munp.jpg?s=128&g=1", "display_name": "Dave.Gugg", "link": "https://stackoverflow.com/users/3394255/dave-gugg"}, "edited": false, "score": 0, "creation_date": 1533133892, "post_id": 51635472, "comment_id": 90236199, "body": "Yeah when I test with option base 1 I get the same error."}, {"owner": {"reputation": 5821, "user_id": 3394255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1munp.jpg?s=128&g=1", "display_name": "Dave.Gugg", "link": "https://stackoverflow.com/users/3394255/dave-gugg"}, "edited": false, "score": 0, "creation_date": 1533134067, "post_id": 51635472, "comment_id": 90236325, "body": "When you get the error and are in debug mode, using the Immediate Window, what is the value of ActiveWorkbook.Connections.Count?"}, {"owner": {"reputation": 3, "user_id": 10166263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61118479e7198a89e3842af6a92ca4c3?s=128&d=identicon&r=PG&f=1", "display_name": "r0xxoff", "link": "https://stackoverflow.com/users/10166263/r0xxoff"}, "reply_to_user": {"reputation": 5821, "user_id": 3394255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1munp.jpg?s=128&g=1", "display_name": "Dave.Gugg", "link": "https://stackoverflow.com/users/3394255/dave-gugg"}, "edited": false, "score": 0, "creation_date": 1533136052, "post_id": 51635472, "comment_id": 90237730, "body": "ActiveWorkbook.Connections.Count is 3"}], "answers": [{"tags": [], "owner": {"reputation": 5821, "user_id": 3394255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1munp.jpg?s=128&g=1", "display_name": "Dave.Gugg", "link": "https://stackoverflow.com/users/3394255/dave-gugg"}, "is_accepted": true, "score": 0, "last_activity_date": 1533138038, "creation_date": 1533138038, "answer_id": 51637379, "question_id": 51635472, "link": "https://stackoverflow.com/questions/51635472/vba-run-time-error-5-when-deleting-sql-connections/51637379#51637379", "title": "VBA run-time error 5 when deleting SQL Connections", "body": "<p>It looks like you may have a data model or pivot table based on a data model (such as PowerPivot).  In that case, try using this code instead:</p>\n\n<pre><code>Dim xConnect As Object\nFor Each xConnect In ActiveWorkbook.Connections\nIf xConnect.Name &lt;&gt; \"ThisWorkbookDataModel\" Then xConnect.Delete\nNext xConnect\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10166263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61118479e7198a89e3842af6a92ca4c3?s=128&d=identicon&r=PG&f=1", "display_name": "r0xxoff", "link": "https://stackoverflow.com/users/10166263/r0xxoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 51637379, "answer_count": 1, "score": 0, "last_activity_date": 1533138038, "creation_date": 1533132606, "last_edit_date": 1533132916, "question_id": 51635472, "link": "https://stackoverflow.com/questions/51635472/vba-run-time-error-5-when-deleting-sql-connections", "title": "VBA run-time error 5 when deleting SQL Connections", "body": "<p>I'm writing a macro that will create a static file based on a file connected to the SQL Server. It should refresh the Excel file, delete all connections to the SQL server, save it out as a new file with the date appended to the end and then close the existing file. </p>\n\n<p>The issue I'm running into is that when I clear the connections I get a run-time error 5 \"Invalid Call or argument\". The odd thing is that it ran perfectly last night and this morning and then this error started popping up seemingly out of nowhere. I don't think I made any changes to the file that would have caused this to happen so I'm pretty baffled.</p>\n\n<p>The debugger highlights the loop clearing connections here:</p>\n\n<pre><code>Do While ActiveWorkbook.Connections.Count &gt; 0\nActiveWorkbook.Connections.Item(ActiveWorkbook.Connections.Count).Delete\nLoop\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub CreateTemplate()\n\nDim FilePath As String\nDim NewName As String\n\nActiveWorkbook.RefreshAll\n\nDo While ActiveWorkbook.Connections.Count &gt; 0\nActiveWorkbook.Connections.Item(ActiveWorkbook.Connections.Count).Delete\nLoop\n\nFilePath = \"C:\\\": NewName = FilePath &amp; \"File\" &amp; Format(Date, \"MM-DD-YYYY\") &amp; \".xlsb\"\n\nActiveWorkbook.SaveAs Filename:=NewName, FileFormat _\n:=xlExcel12, CreateBackup:=False\n\n    MsgBox \"Your new template is saved with today's date appended\"\n\n    ActiveWorkbook.Close False\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "collections"], "comments": [{"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1533135458, "post_id": 51635341, "comment_id": 90237328, "body": "What specifically is the problem with the bad part?"}, {"owner": {"reputation": 25, "user_id": 10135800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0rOTV.jpg?s=128&g=1", "display_name": "brookebot", "link": "https://stackoverflow.com/users/10135800/brookebot"}, "reply_to_user": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1533237605, "post_id": 51635341, "comment_id": 90284958, "body": "It doesn&#39;t name the new collection according to the item in the reference collection (categories)"}], "owner": {"reputation": 25, "user_id": 10135800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0rOTV.jpg?s=128&g=1", "display_name": "brookebot", "link": "https://stackoverflow.com/users/10135800/brookebot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533148290, "creation_date": 1533132167, "last_edit_date": 1533148290, "question_id": 51635341, "link": "https://stackoverflow.com/questions/51635341/categorizing-array-items-using-collections", "title": "Categorizing array items using collections?", "body": "<p>I am trying to categorize items in a couple of arrays based on a list of possible categories. For now, I have managed to associate a category with each item in the two arrays, but now I would like to re-group them such that they are in groups with other items within their category.</p>\n\n<p>I am stuck because I have created a list of unique items that I want to use as the new collection names. In my mind, this would require a For-Loop but I know that creating variables in a loop is always frowned upon. Also, it's not working. Here's the code as it is now:</p>\n\n<pre><code>For i = 1 To UBound(ItemList1)\n    For j = 1 To UBound(MasterList, 2)\n        check = ItemList1(i) Like MasterList(3, j)\n        If check Then\n            ItemList1Categories(i) = MasterList(8, j)\n        End If\n    Next\nNext  'Creates first array of categories\n\n\nFor i = 1 To UBound(ItemList2)\n    For j = 1 To UBound(MasterList, 2)\n        check4 = ItemList2(i) Like MasterList(3, j)\n        If check4 Then\n            ItemList2Categories(i) = MasterList(8, j)\n        End If\n    Next\nNext 'Creates second array of categories\n\nOn Error Resume Next\n  For Each a In ItemList1Categories\n     Categories.Add a, a\n  Next 'Stores unique items from first array of categories to collection\n\nOn Error Resume Next\n  For Each a In ItemList2Categories\n     Categories.Add a, a\n  Next 'Adds unique items from second array of categories to collection\n\n\n\n'This part is bad and I would appreciate some help\nFor i = 1 To Categories.Count\n    Set Categories(i) = New Collection\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1533132245, "post_id": 51635306, "comment_id": 90234990, "body": "There seems to be a worksheet function <code>IsError()</code>. Did you try this?"}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "reply_to_user": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1533132706, "post_id": 51635306, "comment_id": 90235300, "body": "What do you mean by did I try it? I understand that this returns true/false if an error occurs in the cell (which it does and so is true)."}], "answers": [{"tags": [], "owner": {"reputation": 420, "user_id": 5800184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a4ff6e9c62c0b0dfac9fddbbe4845f?s=128&d=identicon&r=PG&f=1", "display_name": "Jbowman", "link": "https://stackoverflow.com/users/5800184/jbowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1533132822, "creation_date": 1533132822, "answer_id": 51635555, "question_id": 51635306, "link": "https://stackoverflow.com/questions/51635306/vba-what-to-dimension-a-variable-when-it-can-take-value-of-a-string-or-number-s/51635555#51635555", "title": "VBA what to dimension a variable when it can take value of a string or number (single/double)", "body": "<p>A #Value is an extemporaneous error that is otherwise unable to be evaluated. IMHO, the first step in the process is to validate the enteries are valid eg (psudocode) if invalid entry then \u201cerr in cell\u201d elseif ... rest of conditions.  </p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 0, "creation_date": 1533133409, "post_id": 51635580, "comment_id": 90235821, "body": "So from what I understand of this, you would use this to determine what is causing the error and then I should remedy this? And should this line on error goto 0 be provided after each elseif statement?"}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 0, "creation_date": 1533133769, "post_id": 51635580, "comment_id": 90236108, "body": "Also can you describe how this might apply in the described situation? I don&#39;t see where the error is since the error should only occur if x and y are in the table range (which will allow the formula to be executed and give error. If x or y are outside the table range it should simply give me a text output and I don&#39;t see how this results in error."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1533134583, "post_id": 51635580, "comment_id": 90236701, "body": "there is also &quot;on error goto errorhandling routine&quot; which probably is the best practice..."}, {"owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "edited": false, "score": 0, "creation_date": 1533135401, "post_id": 51635580, "comment_id": 90237291, "body": "Without looking at your workbook to see how the #Value error got to the cell, and without the rest of the subroutine, it&#39;s hard to know what&#39;s really happening."}], "tags": [], "owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "is_accepted": false, "score": 2, "last_activity_date": 1533132885, "creation_date": 1533132885, "answer_id": 51635580, "question_id": 51635306, "link": "https://stackoverflow.com/questions/51635306/vba-what-to-dimension-a-variable-when-it-can-take-value-of-a-string-or-number-s/51635580#51635580", "title": "VBA what to dimension a variable when it can take value of a string or number (single/double)", "body": "<p>Sometimes the error stops the works even if you have provided an alternate.  For example, VBA can't answer \"which is smaller: 1 or 1 divided by 0?\" because merely attempting to divide 1 by 0 causes a program-stopping error.</p>\n\n<p>Avoiding this is an entire practice called \"error handling\", which you can control with the statements...</p>\n\n<blockquote>\n  <p>on error resume next  'This causes VBA to pretend errors don't happen and move along.  Dangerous!</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>on error goto 0  'This restores the default VBA error protocol: stop the program and offer to debug.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 0, "creation_date": 1533134202, "post_id": 51635820, "comment_id": 90236427, "body": "I can confirm that it works for all values within the table range.  The way I want the errors to display will be different depending on whether it is above or below the xrng or yrng (I want it to be very easy for people to use, minimal thought on their part).  So with this in mind I would have:     X_low and X_high variables one for x&lt;min and one for x&gt;max (and the same for y). From this I would essentially have exactly what I have currently except the statements would be replaced with the boolean variables. I will try this tomorrow, but can you explain why this works?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 1, "creation_date": 1533135626, "post_id": 51635820, "comment_id": 90237443, "body": "What you really mean is: <i>why does this work where yours doesn&#39;t?</i> And to be honest, I can&#39;t really tell you without seeing the actual code you&#39;re using together with a minimal sample x/y range."}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 0, "creation_date": 1533181469, "post_id": 51635820, "comment_id": 90254302, "body": "I will be trying this later today so I will confirm success or not at that point. But to further clarify I was rather asking what does creating the boolean variables vs just putting those lines into the if statement achieve? Does it somehow evaluate it differently?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 0, "creation_date": 1533196360, "post_id": 51635820, "comment_id": 90260112, "body": "Oh, sorry. No, not at all. It merely makes it easier to read."}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 0, "creation_date": 1533205264, "post_id": 51635820, "comment_id": 90265525, "body": "I was about to ask you to review my post and it clicked why it wasn&#39;t working. I had dimensioned biinterp as a double when it needs to be a string to allow a number or text to be output."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 0, "creation_date": 1533226786, "post_id": 51635820, "comment_id": 90279993, "body": "Oh! Well I&#39;m glad you found it. Hopefully my answer in some way helped or at least gave you an idea of making it more readable. Good luck with your project."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1533133506, "creation_date": 1533133506, "answer_id": 51635820, "question_id": 51635306, "link": "https://stackoverflow.com/questions/51635306/vba-what-to-dimension-a-variable-when-it-can-take-value-of-a-string-or-number-s/51635820#51635820", "title": "VBA what to dimension a variable when it can take value of a string or number (single/double)", "body": "<p>Assuming you don't have an error in one of the cells that comprise <code>xrng</code> or <code>yrng</code> (which I'm assuming is the case because you seem to suggest this error only occurs when you're outside the value range), then this should give you a starter:</p>\n\n<pre><code>Function biinterp(x, y, xrng As Range, yrng As Range)\n\nDim x_out As Boolean\nDim y_out As Boolean\n\nx_out = x &lt; WorksheetFunction.Min(xrng) Or x &gt; WorksheetFunction.Max(xrng)\ny_out = y &lt; WorksheetFunction.Min(yrng) Or y &gt; WorksheetFunction.Max(yrng)\n\nIf x_out And y_out Then\n    biinterp = \"Error: y and x outside of table range\"\nElseIf x_out Then\n    biinterp = \"Error: x outside of table range\"\nElseIf y_out Then\n    biinterp = \"Error: y outside of table range\"\nElse\n    biinterp = \"no error - answer is ...\"\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 51635820, "answer_count": 3, "score": -1, "last_activity_date": 1533219709, "creation_date": 1533132067, "last_edit_date": 1533219709, "question_id": 51635306, "link": "https://stackoverflow.com/questions/51635306/vba-what-to-dimension-a-variable-when-it-can-take-value-of-a-string-or-number-s", "title": "VBA what to dimension a variable when it can take value of a string or number (single/double)", "body": "<p>I have created a macro that I use for bilinear interpolation and it works fine, however, I want to generate error outputs i.e. \"Error: y and x outside of table range\" to do this I have done:</p>\n\n<pre><code>Static Function biinterp(x As Double, y As Double, xrng As Range, yrng As Range, zrng As Range) As Double\n\nDim x1 As Double\nDim x2 As Double\nDim y1 As Double\nDim y2 As Double\nDim z11 As Double\nDim z12 As Double\nDim z21 As Double\nDim z22 As Double\n\nIf y &lt; WorksheetFunction.Min(yrng) And x &lt; WorksheetFunction.Min(xrng) Then\n    biinterp = \"Error: y and x outside of table range, use your eyes\"\nElseIf y &gt; WorksheetFunction.Max(yrng) And x &lt; WorksheetFunction.Min(xrng) Then\n    biinterp = \"Error: y and x outside of table range, use your eyes\"\nElseIf y &lt; WorksheetFunction.Min(yrng) And x &gt; WorksheetFunction.Max(xrng) Then\n    biinterp = \"Error: y and x outside of table range, use your eyes\"\nElseIf y &gt; WorksheetFunction.Max(yrng) And x &gt; WorksheetFunction.Max(xrng) Then\n    biinterp = \"Error: y and x outside of table range, use your eyes\"\nElseIf x &lt; WorksheetFunction.Min(xrng) Then\n    biinterp = \"Error: x outside of table range (take a min value for y)\"\nElseIf x &gt; WorksheetFunction.Max(xrng) Then\n    biinterp = \"Error: x outside of table range (take a max value for y)\"\nElseIf y &gt; WorksheetFunction.Max(yrng) Then\n    biinterp = \"Error: y outside of table range (take a max value for x)\"\nElseIf y &lt; WorksheetFunction.Min(yrng) Then\n    biinterp = \"Error: y outside of table range (take a min value for x)\"\nelse \"my function here\"\nend if \nend function\n</code></pre>\n\n<p>If I enter x or y outside the table range I get a #VALUE! error in the cell, but I can't understand why it won't evaluate the else if conditions.</p>\n\n<p>[EDIT] I discovered that since I wished to output a string or double I had to change the dimension for biinterp to string to allow a number or text to be output.</p>\n"}, {"tags": ["vba", "excel", "duplicates", "code-duplication"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1533131861, "post_id": 51635176, "comment_id": 90234674, "body": "Can you please tell in which line you get the error?"}, {"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1533131942, "post_id": 51635176, "comment_id": 90234745, "body": "VBA Editor is not mentioning Line Number. It is giving General Error"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1533132014, "post_id": 51635176, "comment_id": 90234795, "body": "No, it shows the error message and then there is a line marked in yellow. Which line is that? Have a look at <a href=\"https://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow noreferrer\">Excel Easy - Debugging</a> for a tutorial how to debug VBA code."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1533132093, "post_id": 51635176, "comment_id": 90234863, "body": "When you get a run-time error the highlighted command in the VBE is the line giving the error."}, {"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533132205, "post_id": 51635176, "comment_id": 90234951, "body": "It&#39;s in Line 01 and Line 09"}, {"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 2, "creation_date": 1533132241, "post_id": 51635176, "comment_id": 90234984, "body": "This Line. Unable to Fix Error. @MarkFitzgerald &quot;Set wb1 = Workbooks(&quot;listeappli.xlsx&quot;) &#39;Adjust as required&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1533132321, "post_id": 51635176, "comment_id": 90235043, "body": "Is the workbook <code>&quot;listeappli.xlsx&quot;</code> open in Excel already or not?"}, {"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533132454, "post_id": 51635176, "comment_id": 90235125, "body": "It is Opened there"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1533132531, "post_id": 51635176, "comment_id": 90235178, "body": "Did you open that workbook <b>before</b> you start the macro? Or should the macro open that workbook automatically?"}, {"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533132553, "post_id": 51635176, "comment_id": 90235198, "body": "&quot;Can&#39;t execute Code in Break Mode&quot; Error coming on Line 09"}, {"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533132594, "post_id": 51635176, "comment_id": 90235226, "body": "@CLR Can you please Edit the Code."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533132955, "post_id": 51635527, "comment_id": 90235481, "body": "Still same Error &quot;Subscript out of Range&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533132987, "post_id": 51635527, "comment_id": 90235508, "body": "but definitely not in that line."}, {"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533133027, "post_id": 51635527, "comment_id": 90235539, "body": "It&#39;s in Line 01"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 1, "creation_date": 1533133079, "post_id": 51635527, "comment_id": 90235581, "body": "it cannot be in line 01. Please read <a href=\"https://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow noreferrer\">Excel Easy - Debugging</a> and learn how to debug a code properly. Also please always mention on which code you get the error. Line numbers are very inaccurate to talk about."}, {"owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533133428, "post_id": 51635527, "comment_id": 90235840, "body": "I know how to Debug"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "edited": false, "score": 0, "creation_date": 1533189621, "post_id": 51635527, "comment_id": 90256662, "body": "We need to know <i>exactly</i> which code throws that error. We can only help if you provide that information."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1533132753, "creation_date": 1533132753, "answer_id": 51635527, "question_id": 51635176, "link": "https://stackoverflow.com/questions/51635176/comparing-two-workbooks-and-deleting-matched-rows/51635527#51635527", "title": "Comparing Two Workbooks and Deleting Matched Rows", "body": "<p>If your workbook is not open already and you want the macro to open it automatically you must use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbooks-open-method-excel\" rel=\"nofollow noreferrer\">Workbooks.Open Method</a>.</p>\n\n<p>use the following if <code>listeappli.xlsx</code> is in the same path as the actual file</p>\n\n<pre><code>Set wb1 = Workbooks.Open(Filename:=ThisWorkbook.Path &amp; Application.PathSeparator &amp; \"listeappli.xlsx\")\n</code></pre>\n\n<p>or specify the full path for <code>Filename:=</code> like</p>\n\n<pre><code>Set wb1 = Workbooks.Open(Filename:=\"C:\\MyFolder\\listeappli.xlsx\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9975592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlP07.jpg?s=128&g=1", "display_name": "Alisha Ahmad", "link": "https://stackoverflow.com/users/9975592/alisha-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533133730, "creation_date": 1533131777, "last_edit_date": 1533133730, "question_id": 51635176, "link": "https://stackoverflow.com/questions/51635176/comparing-two-workbooks-and-deleting-matched-rows", "title": "Comparing Two Workbooks and Deleting Matched Rows", "body": "<p>I am trying to compare two workbooks but unlikely upon Running the Macro, getting Error </p>\n\n<blockquote>\n  <p>\"Subscript Out of the Range\". </p>\n</blockquote>\n\n<p>Can anyone please help in Removing the Error? Thanks</p>\n\n<pre><code>Sub CompInTwoWorkbooks()\n    Dim wb1 As Workbook, wb2 As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim c As Range, rng As Range\n    Dim lnLastRow1 As Long, lnLastRow2 As Long\n    Dim lnTopRow1 As Long, lnTopRow2 As Long\n    Dim lnCols As Long, i As Long\n\n    Set wb1 = Workbooks(\"listeappli.xlsx\") 'Adjust as required\n    Set wb2 = Workbooks(\"Keyword.xlsx\") 'Adjust as required\n\n    Set ws1 = wb1.Sheets(\"listeappli\") 'Adjust as required\n    Set ws2 = wb2.Sheets(\"Keyword\") 'Adjust as required\n\n    lnTopRow1 = 2 'first row containing data in wb1 'Adjust as required\n    lnTopRow2 = 2 'first row containing data in wb2 'Adjust as required\n\n     'Find last cells containing data:\n    lnLastRow1 = ws1.Range(\"M:M\").Find(\"*\", Range(\"M1\"), LookIn:=xlValues, searchdirection:=xlPrevious).Row\n    lnLastRow2 = ws2.Range(\"A:A\").Find(\"*\", Range(\"A1\"), LookIn:=xlValues, searchdirection:=xlPrevious).Row\n\n    Set rng = ws2.Range(\"A\" &amp; lnTopRow2 &amp; \":A\" &amp; lnLastRow2)\n\n    lnCols = ws1.Columns.Count\n    ws1.Columns(lnCols).Clear 'Using the very right-hand column of the sheet\n\n    For i = lnLastRow1 To lnTopRow1 Step -1\n        For Each c In rng\n            If ws1.Range(\"M\" &amp; i).Value = c.Value Then\n                ws1.Cells(i, lnCols).Value = \"KEEP\" 'Add tag to right-hand column of sheet if match found\n                Exit For\n            End If\n        Next c\n    Next i\n\n     'Delete rows where the right-hand column of the sheet is blank\n    Set rng = ws1.Range(Cells(lnTopRow1, lnCols), Cells(lnLastRow1, lnCols))\n    rng.SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n    ws1.Columns(lnCols).Clear\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1533134913, "post_id": 51636106, "comment_id": 90236921, "body": "Actually, you would test for the name only if the shape has a chart, and you wanted to delete a specific chart."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1533135155, "post_id": 51636106, "comment_id": 90237105, "body": "++ Yup this is one way :)"}], "tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 2, "last_activity_date": 1533134748, "last_edit_date": 1533134748, "creation_date": 1533134351, "answer_id": 51636106, "question_id": 51635075, "link": "https://stackoverflow.com/questions/51635075/delete-existing-chart-in-power-point-slide-and-replace-by-new-chart-using-vba/51636106#51636106", "title": "Delete existing chart in Power Point slide and replace by new chart using VBA", "body": "<p>You can test whether a shape contains a chart by using the HasChart property of the Shape object...</p>\n\n<pre><code>If ActiveSlide.Shapes(i).HasChart Then\n</code></pre>\n\n<p>If you also wanted to test for the name of the chart, after testing whether the shape had a chart...</p>\n\n<pre><code>If ActiveSlide.Shapes(i).Chart.Name = \"Chart Name\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 4895187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76afe47fc3026dee49347e43209c1620?s=128&d=identicon&r=PG&f=1", "display_name": "vds1", "link": "https://stackoverflow.com/users/4895187/vds1"}, "edited": false, "score": 0, "creation_date": 1533216078, "post_id": 51636218, "comment_id": 90272826, "body": "Thanks Sid. I used haschart property and it worked very well. I also liked your trick of setting chart variable and check for nothing. I will save it for future reference."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1533134676, "creation_date": 1533134676, "answer_id": 51636218, "question_id": 51635075, "link": "https://stackoverflow.com/questions/51635075/delete-existing-chart-in-power-point-slide-and-replace-by-new-chart-using-vba/51636218#51636218", "title": "Delete existing chart in Power Point slide and replace by new chart using VBA", "body": "<p>Use the <code>Shapes.Chart</code> Property</p>\n\n<pre><code>Sub Sample()\n    Dim chrt As Chart\n\n    With ActivePresentation\n        For i = 1 To .Slides(1).Shapes.Count\n            On Error Resume Next\n            Set chrt = .Slides(1).Shapes(i).Chart\n            On Error GoTo 0\n\n            If Not chrt Is Nothing Then\n                MsgBox \"Guess what? \" &amp; .Slides(1).Shapes(i).Name &amp; \" is a chart\"\n                Set chrt = Nothing\n            Else\n                MsgBox .Slides(1).Shapes(i).Name &amp; \" is not a chart\"\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4895187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76afe47fc3026dee49347e43209c1620?s=128&d=identicon&r=PG&f=1", "display_name": "vds1", "link": "https://stackoverflow.com/users/4895187/vds1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 0, "accepted_answer_id": 51636106, "answer_count": 2, "score": 1, "last_activity_date": 1533134748, "creation_date": 1533131479, "question_id": 51635075, "link": "https://stackoverflow.com/questions/51635075/delete-existing-chart-in-power-point-slide-and-replace-by-new-chart-using-vba", "title": "Delete existing chart in Power Point slide and replace by new chart using VBA", "body": "<p>I am writing VBA code to copy paste chart from excel to PowerPoint. My code would first delete the existing chart from the PowerPoint slide before copy pasting the chart from excel. </p>\n\n<p>Unfortunately some of charts are named as \u201c<em>Content Placeholder xx</em>\u201d in PowerPoint due to which existing chart in presentation wouldn\u2019t get deleted. Since content placeholder can be table/ ready-made shape /chart, how can I test if content place holder is chart or some other shape?</p>\n\n<p>Any guidance will be appreciated</p>\n\n<pre><code>Sub Powerpoint_Slide_MoveChart()\n\n    '// General declaration\n    Dim ppt             As PowerPoint.Application\n    Dim ActiveSlide     As PowerPoint.Slide\n    Dim Cht             As ChartObject\n    Dim i               As Integer\n\n    '// Set powerpoint application\n    Set ppt = GetObject(, \"PowerPoint.Application\")\n\n    '// Check if more then single powerpoint open\n    If ppt.Presentations.Count &gt; 1 Then\n        MsgBox \"Please close all other powerpoints except the one you would like to puiblish.\"\n        Exit Sub\n    End If\n\n    '// Set active slide as slide 9\n    Set ActiveSlide = ppt.ActivePresentation.Slides(9)\n    ppt.ActiveWindow.View.GotoSlide (9)\n    Set Cht = ActiveSheet.ChartObjects(\"ChartSlide9\")\n\n    '// Delete existing chart\n    For i = 1 To ActiveSlide.Shapes.Count\n        If Left(UCase(ActiveSlide.Shapes(i).Name), 5) = \"CHART\" Then\n            ActiveSlide.Shapes(i).Delete\n            Exit For\n        End If\n    Next i\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1533131636, "post_id": 51635074, "comment_id": 90234509, "body": "Try adding <code>Selection.Wholestory</code> before that line."}, {"owner": {"reputation": 1145, "user_id": 4278282, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/54b37d0f15b0cf40aab8286384ad17a6?s=128&d=identicon&r=PG&f=1", "display_name": "Siyh", "link": "https://stackoverflow.com/users/4278282/siyh"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1533563167, "post_id": 51635074, "comment_id": 90379282, "body": "@dwirony No change unfortunately-thanks for the suggestion though."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1533655678, "last_edit_date": 1533655678, "creation_date": 1533139706, "answer_id": 51637845, "question_id": 51635074, "link": "https://stackoverflow.com/questions/51635074/how-do-i-add-subdocments-to-the-end-of-a-word-document-after-opening-a-form/51637845#51637845", "title": "How do I add subdocments to the end of a Word Document after opening a Form?", "body": "<p>Since the <code>Document_Open</code> event is calling a UserForm first thing, Word does need a chance to access the document. The following worked in my test. </p>\n\n<pre><code>'ThisDocument code:\nOption Explicit\n\nPrivate Sub Document_Open()\n    Dim f As UserForm1\n    Set f = New UserForm1\n    Set f.rng = ThisDocument.Content\n    f.Show\nEnd Sub\n</code></pre>\n\n<p>Note how the user form is declared as an object - a UserForm is actually a <em>class</em> (same as ThisDocument), but VBA lets you handle it without specifically coding as a class. Often, this works, but not always. So the object is declared and a <em>new instance</em> of the UserForm class assigned to it. </p>\n\n<p>A <code>Range</code> is declared in the UserForm class as a class-level, public member. It's set to the body of the document in the Open event.</p>\n\n<p>Then the user form is displayed, code below.</p>\n\n<p>At this point, the Range object is accessible and actual work with it can take place. That said, it appears <code>Subdocuments.AddFromFile</code> relies on a Selection, just as it relies being in the Outline View. This is <em>probably</em> because the functionality dates from the old WordBasic days and was never changed to adhere to VBA principles.</p>\n\n<pre><code>'Code in the UserForm\nOption Explicit\n\nPublic rng As Word.Range\n\nPrivate Sub CommandButton1_Click()\n  Me.rng.Collapse 0\n  'rng.Text = \"Test text\"\n  ThisDocument.ActiveWindow.View = wdOutlineView\n  Me.rng.Select\n  Selection.Range.Subdocuments.AddFromFile (\"C:\\Test\\CCRanges.docx\")\n  Application.ScreenRefresh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1145, "user_id": 4278282, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/54b37d0f15b0cf40aab8286384ad17a6?s=128&d=identicon&r=PG&f=1", "display_name": "Siyh", "link": "https://stackoverflow.com/users/4278282/siyh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 51637845, "answer_count": 1, "score": 1, "last_activity_date": 1533655678, "creation_date": 1533131474, "last_edit_date": 1533629825, "question_id": 51635074, "link": "https://stackoverflow.com/questions/51635074/how-do-i-add-subdocments-to-the-end-of-a-word-document-after-opening-a-form", "title": "How do I add subdocments to the end of a Word Document after opening a Form?", "body": "<p>I'm trying to write a macro that adds subdocuments to the end of a Word document when the Word document is opened. The document in question already has some text in it, so before running the macro I'd like to move the cursor to the end of the document. I can achieve this with the code: <code>Selection.EndKey Unit:=wdStory</code> which works fine when I run the macro <em>after</em> opening the document, but if I run the macro as soon as the document is opened by using the Sub: </p>\n\n<pre><code>Private Sub Document_Open()\n    Selection.EndKey Unit:=wdStory\n    'Add subdocuments based on user input to a form\n    '(See edit below)\nEnd Sub\n</code></pre>\n\n<p>in the ThisDocument object, the subdocuments are added at the start of the document. This may be because the cursor has not yet appeared so <code>Selection</code> doesn't 'exist' yet. </p>\n\n<p>How do I run my macro when the document opens, but add subdocuments to the end of the document?</p>\n\n<p>I've tried writing a space out first to cause the cursor to spawn but no change...</p>\n\n<p>Any suggestions for alternative methods also welcome.</p>\n\n<p>Edit:\nThis code in ThisDocument:</p>\n\n<pre><code>Private Sub Document_Open()\n    CreateWorkbook.Show\nEnd Sub\n</code></pre>\n\n<p>Calls the form CreateWorkbook, with a button click sub:</p>\n\n<pre><code>Private Sub GenerateButton_Click()\n    Dim i As Integer\n    Dim rng As Word.Range\n\n    Set rng = ActiveDocument.Content\n    rng.Collapse wdCollapseEnd\n\n    'ModulesListBox is a user input box that is a list of paths to the subdocuments\n    For i = 0 To ModulesListBox.ListCount - 1\n        docpath = ModulesListBox.List(i)\n        rng.Subdocuments.AddFromFile docpath\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste", "worksheet"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1533131361, "post_id": 51634954, "comment_id": 90234303, "body": "Is the code in the sheet object or a module? If they&#39;re not actually in the sheet, you&#39;ll have to copy it over by dragging the module from your sourcebook to your destination workbook."}, {"owner": {"reputation": 1, "user_id": 9979373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0516d25f045a0c4c3ec3379c3e914?s=128&d=identicon&r=PG&f=1", "display_name": "mdp476", "link": "https://stackoverflow.com/users/9979373/mdp476"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1533132144, "post_id": 51634954, "comment_id": 90234897, "body": "Some of it is in the sheet object but I also have three modules that contain code as well."}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "edited": false, "score": 0, "creation_date": 1533134283, "post_id": 51634954, "comment_id": 90236482, "body": "I would do a template which contains your VBA Code and create an extra workbook containing the macro that could copying the template (filled with data I guess)"}], "answers": [{"tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1549399392, "creation_date": 1549399392, "answer_id": 54542729, "question_id": 51634954, "link": "https://stackoverflow.com/questions/51634954/copy-worksheet-and-its-code-into-another-workbook/54542729#54542729", "title": "Copy Worksheet and its code into another workbook", "body": "<p>I have used something like this in the past.  Your mileage may vary.  It needs to be adjusted to refer to TWO different Workbooks.  It has not been tested with recent MSOffice.  I do not know if it handles code in a sheet object.</p>\n\n<pre><code>Option Explicit\n    Dim sExportLocation As String\n    sExportLocation = \"C:\\myTempExport\\\" 'Do not forget the closing back slash! ie: C:\\Temp\\\n\nPublic Sub DoExportImport\n    ExportTheModules\n    ImportDatabaseObjects\nEnd Sub    \n\nPublic Sub ExportTheModules\n     '===============================================================================\n     ' Name:    DocDatabase Purpose: Documents the database to a series of text files\n     ' Author:  Arvin Meyer       ' Date:    June 02, 1999\n     ' Comment: Uses the undocumented [Application.SaveAsText] syntax\n     '          To reload use the syntax [Application.LoadFromText]\n     '      Modified to set a reference to DAO 8/22/2005\n     '===============================================================================\n    Dim dbs As DAO.Database,  cnt As DAO.Container,  doc As DAO.Document\n\n    Set cnt = dbs.Containers(\"Modules\")\n    For Each doc In cnt.Documents\n        Application.SaveAsText acModule, doc.Name, sExportLocation &amp; \"Mods_\" &amp; doc.Name &amp; \".txt\"\n    Next doc\nEnd Sub\n\nPublic Sub ImportDatabaseObjects()\n    On Error GoTo Err_ImportDatabaseObjects\n    Dim db As Database      'Dim db As DAO.Database\n    Dim td As TableDef, d As Document, c As Container  \n    Set db = CurrentDb()\n\n    Dim sFN As String, sName As String, sList() As Variant\n    sList = Array(\"Module_\", acModule)     ' Array(\"Module_\", acModule, \"Form_\", acForm, \"Query_\", acQuery)\n    sFN = Dir(sExportLocation &amp; sList(0) &amp; \"*.txt\")\n    Do While sFN &lt;&gt; \"\"\n        sName = Replace(sFN, sList(0), \"\")\n        sName = Replace(sName, \".txt\", \"\")\n        Debug.Print sFN, , sName\n        Application.LoadFromText sList(1), sName, sExportLocation &amp; sFN\n        sFN = Dir\n    Loop\n\n    Exit Sub\n\nErr_ImportDatabaseObjects:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Set c = Nothing\n    db.Close\n    Set db = Nothing    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9979373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0516d25f045a0c4c3ec3379c3e914?s=128&d=identicon&r=PG&f=1", "display_name": "mdp476", "link": "https://stackoverflow.com/users/9979373/mdp476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549399392, "creation_date": 1533131178, "last_edit_date": 1549397342, "question_id": 51634954, "link": "https://stackoverflow.com/questions/51634954/copy-worksheet-and-its-code-into-another-workbook", "title": "Copy Worksheet and its code into another workbook", "body": "<p>I want to copy an excel worksheet from one workbook into another with all of its VBA Code. Every time I try to \"Move or Copy Sheet\" the sheet copies, but none of the VBA Modules transfer into the new workbook. Is there a way to do this?</p>\n"}, {"tags": ["arrays", "vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 1352, "user_id": 2735344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d369895803df5664eb8669ae12980ff3?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/2735344/steven"}, "edited": false, "score": 0, "creation_date": 1533131138, "post_id": 51634875, "comment_id": 90234103, "body": "Sounds like you need to use a <code>continue;</code> in your for-loop, try looking up information about how to use it."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 1352, "user_id": 2735344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d369895803df5664eb8669ae12980ff3?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/2735344/steven"}, "edited": false, "score": 2, "creation_date": 1533131199, "post_id": 51634875, "comment_id": 90234158, "body": "@steven there is no <code>continue;</code> in vba."}, {"owner": {"reputation": 1352, "user_id": 2735344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d369895803df5664eb8669ae12980ff3?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/2735344/steven"}, "edited": false, "score": 0, "creation_date": 1533131264, "post_id": 51634875, "comment_id": 90234220, "body": "Yeah, I&#39;ve just noticed it by searching myself, I came accross this post, maybe that&#39;s a decent replacement: <a href=\"https://stackoverflow.com/questions/5895908/continue-for-loop\">stackoverflow.com/questions/5895908/continue-for-loop</a>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1533131423, "post_id": 51634875, "comment_id": 90234363, "body": "You can build a user function to check if the value is a part of the array, try to look at <a href=\"https://stackoverflow.com/questions/38267950/check-if-a-value-is-in-an-array-or-not-with-excel-vba/38268261\" title=\"check if a value is in an array or not with excel vba\">stackoverflow.com/questions/38267950/&hellip;</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1533131567, "post_id": 51634875, "comment_id": 90234456, "body": "Untested but perhaps <code>if isnumeric(application.match(I,Supported,0)) then</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7919746, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f8ca23ddfe2e889ed5f8f6891a4ed61a?s=128&d=identicon&r=PG&f=1", "display_name": "L.P", "link": "https://stackoverflow.com/users/7919746/l-p"}, "edited": false, "score": 0, "creation_date": 1533140971, "post_id": 51635229, "comment_id": 90240734, "body": "That&#39;s an elegant solution, it didn&#39;t cross my mind, thanks a ton !"}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": true, "score": 2, "last_activity_date": 1533131909, "creation_date": 1533131909, "answer_id": 51635229, "question_id": 51634875, "link": "https://stackoverflow.com/questions/51634875/if-statement-to-skip-items-in-for-loop-by-checking-variables-existence-in-an-ar/51635229#51635229", "title": "If statement to skip items in For loop by checking variable&#39;s existence in an Array of numbers", "body": "<p>I would make <code>Supported</code> a Dictionary, so that you don't have to iterate it each time to find out whether a value is in it or not:</p>\n\n<pre><code>Set Supported = CreateObject(\"Scripting.Dictionary\") \nSupported.Add 2, True\nSupported.Add 3, True\nSupported.Add 5, True\n</code></pre>\n\n<p>And then your loop:</p>\n\n<pre><code>For I = LBound(FArray) To UBound(FArray)\n    If Not Supported.Exists(I) Then\n        idsource = FArray(I, 1)\n        ' ... etc ... \n    End If\nNext I\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7919746, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f8ca23ddfe2e889ed5f8f6891a4ed61a?s=128&d=identicon&r=PG&f=1", "display_name": "L.P", "link": "https://stackoverflow.com/users/7919746/l-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 51635229, "answer_count": 1, "score": 0, "last_activity_date": 1533131909, "creation_date": 1533130955, "question_id": 51634875, "link": "https://stackoverflow.com/questions/51634875/if-statement-to-skip-items-in-for-loop-by-checking-variables-existence-in-an-ar", "title": "If statement to skip items in For loop by checking variable&#39;s existence in an Array of numbers", "body": "<p>After a long search, I was not able to find a working answer to my question, so this is my last resort.</p>\n\n<p>I have a For statement looping through an Array. However I want the loop to skip an item at specific points in the Array.</p>\n\n<p>Here is my code so far :</p>\n\n<pre><code>Public Sub test ()\n\nDim FArray(10, 1) As String\nDim Supported() As Variant\n\nSupported = Array(2, 4, 5)\n\n'Functional Text\nFArray(0, 0) = \"B30\"\nFArray(0, 1) = \"B3\"\n'Functional Audio\nFArray(1, 0) = \"B31\"\nFArray(1, 1) = \"B17\"\n'PS Text\nFArray(2, 0) = \"B33\"\nFArray(2, 1) = \"B4\"\n'PS Audio\nFArray(3, 0) = \"B34\"\nFArray(3, 1) = \"B18\"\n'Advanced V2 Text\nFArray(4, 0) = \"B36\"\nFArray(4, 1) = \"B5\"\n'Advanced V2 Audio\nFArray(5, 0) = \"B37\"\nFArray(5, 1) = \"B19\"\n'Cus Text\nFArray(6, 0) = \"B39\"\nFArray(6, 1) = \"B6\"\n'Cus Audio\nFArray(7, 0) = \"B40\"\nFArray(7, 1) = \"B20\"\n'Implicit\nFArray(8, 0) = \"B42\"\nFArray(8, 1) = \"B7\"\n'OOD\nFArray(9, 0) = \"B44\"\nFArray(9, 1) = \"B8\"\n'OOD Audio\nFArray(10, 0) = \"B45\"\nFArray(10, 1) = \"B21\"\n\nFor I = LBound(FArray) To UBound(FArray)\n    If I = LBound(Supported) To Ubound(Supported) Then\n\n    Else\n\n    idsource = FArray(I, 1)\n    OutputCell = FArray(I, 0)\n    'Debug.Print (idsource)\n    'Debug.Print (OutputCell)\n\n    Call DLResults_generic(idsource, OutputCell)\n\n    End If\n\nNext I\n</code></pre>\n\n<p>As you can see, I start a For loop using the variable 'I' and then i'm using a second Array (Supported) to mark the points at which I want the for loop to skip. I could do :</p>\n\n<pre><code>If I = 2 Or I = 4 Or I = 5 Then\n</code></pre>\n\n<p>But I want something that's easier to change, so that I can just go in the Supported Array and put in new values.</p>\n\n<p>I would appreciate it very much if anyone can help me find a way of saying 'If 'I' is in the Supported Array, skip this item in the For loop'</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["vba", "excel", "shapes"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 1, "creation_date": 1533130825, "post_id": 51634779, "comment_id": 90233875, "body": "Could it be <code>For i = 100 to 0 Step -1</code> ? If yes, then this question might actually be a duplicate. See <a href=\"https://stackoverflow.com/q/50684927/8597922\">here</a>"}, {"owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1533131603, "post_id": 51634779, "comment_id": 90234482, "body": "Viktor K, That is a north to follow, however, it is making it appear all of a sudden ignoring the transparency loop, trying to work a way around with your input."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1533132222, "post_id": 51634779, "comment_id": 90234965, "body": "Is it because you put the shape in then adjust its transparency?  Can the object be inserted with a starting transparency of 1?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1533132651, "post_id": 51634779, "comment_id": 90235266, "body": "@VictorK I think you&#39;re right. Your solution or having <code>.Fill.Transparency = 1 - i &#47; 100</code> will achieve what OP likely wants. Both amounts to counting down instead of up."}, {"owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "edited": false, "score": 0, "creation_date": 1533132782, "post_id": 51634779, "comment_id": 90235352, "body": "It makes sense, it worked well now, it&#180;s just a question of adjust the time of delay and that solved! I guess that was answer by both, @Viktor K and Forward Ed. Please click answer so I can properly award you guys"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1533133032, "post_id": 51634779, "comment_id": 90235543, "body": "@roca I am glad it helped! I would say, that since it turned out to be a duplicate you can just close question with the dupe target I posted."}], "owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 1, "closed_date": 1533133348, "answer_count": 0, "score": 0, "last_activity_date": 1533135025, "creation_date": 1533130667, "last_edit_date": 1533135025, "question_id": 51634779, "link": "https://stackoverflow.com/questions/51634779/make-shape-fade-in", "closed_reason": "Duplicate", "title": "Make shape FADE IN", "body": "<p>This is gonna sound really stupid ( I can't believe I was not able to do this!) but I just can't get my head around! I have a nice bit of code that makes objects fade out, but I cannot make them fade in!</p>\n\n<p>Can someone please help?</p>\n\n<p>This is what I have to make it fade out (then it disappears at the end)</p>\n\n<pre><code>With ActiveSheet.Shapes(\"linha1\")\n    For i = 0 To 100\n        .Fill.Transparency = i / 100\n        Delay = 0.001\n        starttime = Timer\n        Do\n            DoEvents\n        Loop While Timer - starttime &lt; Delay\n    Next i\n\nEnd With\nActiveSheet.Shapes(\"linha1\").Visible = False`:\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1533129466, "post_id": 51634307, "comment_id": 90232895, "body": "<code>.End(xlDown)</code> - <code>endxldown</code> is incorrect."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10165959, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WHH6KWQVx7k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN3cFrZlz2keQHsUrCxMRyOIIh1KQ/mo/photo.jpg?sz=128", "display_name": "Napolean", "link": "https://stackoverflow.com/users/10165959/napolean"}, "edited": false, "score": 0, "creation_date": 1533130819, "post_id": 51634462, "comment_id": 90233872, "body": "thank you so much. So is d an object because it does not change whearas c is a variable because its what we&#39;re looping through?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1533131170, "post_id": 51634462, "comment_id": 90234134, "body": "Both <code>c</code> and <code>d</code> are variables referencing objects. <code>c</code> holds a reference to a single cell within the range of <code>d</code>."}, {"owner": {"reputation": 9, "user_id": 10165959, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WHH6KWQVx7k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN3cFrZlz2keQHsUrCxMRyOIIh1KQ/mo/photo.jpg?sz=128", "display_name": "Napolean", "link": "https://stackoverflow.com/users/10165959/napolean"}, "edited": false, "score": 0, "creation_date": 1533131308, "post_id": 51634462, "comment_id": 90234250, "body": "so why does d need a &#39;set&#39; but not c?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1533132558, "post_id": 51634462, "comment_id": 90235199, "body": "I knew you were going to ask that next which is why I nearly didn&#39;t add the first comment.  I honestly don&#39;t know except to say that <code>For Each Set C in D</code> doesn&#39;t sound right."}], "tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": 0, "last_activity_date": 1533129791, "creation_date": 1533129791, "answer_id": 51634462, "question_id": 51634307, "link": "https://stackoverflow.com/questions/51634307/finding-sum-of-squares-of-column-using-for-each/51634462#51634462", "title": "finding sum of squares of column using for each", "body": "<p>There is a syntax error in your code - <code>.endxldown</code> and add <code>Set</code> before assigning range.</p>\n\n<p>Correct it to -\n<code>Set d = Range(ActiveCell, ActiveCell.End(xlDown)</code></p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 10165959, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WHH6KWQVx7k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN3cFrZlz2keQHsUrCxMRyOIIh1KQ/mo/photo.jpg?sz=128", "display_name": "Napolean", "link": "https://stackoverflow.com/users/10165959/napolean"}, "edited": false, "score": 0, "creation_date": 1533131247, "post_id": 51634867, "comment_id": 90234203, "body": "Please can you explain the code there? Specifically Cells(Rows.Count, ActiveCell.Column)"}, {"owner": {"reputation": 9, "user_id": 10165959, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WHH6KWQVx7k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN3cFrZlz2keQHsUrCxMRyOIIh1KQ/mo/photo.jpg?sz=128", "display_name": "Napolean", "link": "https://stackoverflow.com/users/10165959/napolean"}, "edited": false, "score": 1, "creation_date": 1533132635, "post_id": 51634867, "comment_id": 90235256, "body": "I see so rows.count refers to the last row of excel. Thank you."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 9, "user_id": 10165959, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WHH6KWQVx7k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN3cFrZlz2keQHsUrCxMRyOIIh1KQ/mo/photo.jpg?sz=128", "display_name": "Napolean", "link": "https://stackoverflow.com/users/10165959/napolean"}, "edited": false, "score": 0, "creation_date": 1533132857, "post_id": 51634867, "comment_id": 90235404, "body": "Yes.  You can hard code the number if you prefer as long as you&#39;re not going to be using it on an Excel 2003 or less version - it will throw an error with less rows.  You might also want to look into avoiding <code>ActiveCell</code> and <code>Select</code> in VBA by fully qualifying your range references <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using select</a>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1533132321, "last_edit_date": 1533132321, "creation_date": 1533130938, "answer_id": 51634867, "question_id": 51634307, "link": "https://stackoverflow.com/questions/51634307/finding-sum-of-squares-of-column-using-for-each/51634867#51634867", "title": "finding sum of squares of column using for each", "body": "<p>As has been pointed out you've got the syntax of <code>xlDown</code> incorrect.\nYou should also start at the bottom and move up - <code>xlDown</code> may not find the last cell.</p>\n\n<p>E.g. </p>\n\n<ul>\n<li>With a value in cell <code>A1:A3</code> and <code>A1</code> as the <code>ActiveCell</code> it will correctly return <code>A3</code>.  </li>\n<li>Same scenario but with <code>A4</code> left blank and a value in <code>A5</code> still returns <code>A3</code>.</li>\n<li>Same scenario with <code>A1</code> left blank it returns <code>A2</code>.  </li>\n</ul>\n\n<p>This will return a reference from the <code>ActiveCell</code> to the last cell containing a value in that column.<br>\nNote that if the <code>ActiveCell</code> is lower down than the last cell containing data you'll get a reference reflecting that.</p>\n\n<pre><code>Set d = Range(ActiveCell, Cells(Rows.Count, ActiveCell.Column).End(xlUp))  \n</code></pre>\n\n<hr>\n\n<p>A <code>Range</code> can be made up of one or more cell references:  </p>\n\n<ul>\n<li><code>Range(\"A1\")</code> and <code>Range(\"A1,A3,C5\")</code> reference individual cells.  </li>\n<li><code>Range(\"A1:C5\")</code> and <code>Range(\"A1\", \"C5\")</code> reference all cells between the first and last address.   </li>\n</ul>\n\n<p>A <code>Cell</code> is a single cell reference that uses row and columns identifiers. </p>\n\n<ul>\n<li><code>Cells(\"A1\")</code> will return an error as it's a full address.</li>\n<li><code>Cells(1,\"A\")</code> will return <code>A1</code> (row 1, column A)</li>\n<li><code>Cells(1,1)</code> will also return <code>A1</code> (row 1, column 1)</li>\n</ul>\n\n<p>The code above is using two cell addresses to reference all cells between the two.  </p>\n\n<ul>\n<li><code>Range(ActiveCell,....)</code> is the reference to the first cell.  </li>\n<li><code>Cells(Rows.Count, ActiveCell.Column)</code> is the reference to the second cell using row numbers and column numbers.<br>\nIf the <code>ActiveCell</code> is in column B then this is the same as writing <code>Cells(1048573,2)</code>.<br>\nThe <code>End(xlUp)</code> then goes from that cell back up to the first one containing data.</li>\n</ul>\n"}], "owner": {"reputation": 9, "user_id": 10165959, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WHH6KWQVx7k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN3cFrZlz2keQHsUrCxMRyOIIh1KQ/mo/photo.jpg?sz=128", "display_name": "Napolean", "link": "https://stackoverflow.com/users/10165959/napolean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533132321, "creation_date": 1533129358, "last_edit_date": 1533130931, "question_id": 51634307, "link": "https://stackoverflow.com/questions/51634307/finding-sum-of-squares-of-column-using-for-each", "title": "finding sum of squares of column using for each", "body": "<p>I am a newbie. I want to sum the squares of the numbers in the active column. I am getting an error 'object doesn't support this method'. Here is my code</p>\n\n<pre><code>Sub sum_squares()\nDim total As Integer\nDim c As Range\nDim d As Range\n\n'set d equal to column from active cell down to last non-empty'\nd = Range(ActiveCell, ActiveCell.endxldown)\ntotal = 0\nFor Each c In d\n   total = total + c.Value ^ 2\nNext c\n\nEnd Sub\n</code></pre>\n\n<p>Appreciate the help.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533136178, "post_id": 51634294, "comment_id": 90237812, "body": "What is <code>EntryScreen2</code>? You have a <code>With wsCurrent ... End With</code> block but you never reference it."}, {"owner": {"reputation": 1, "user_id": 10165945, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5eEWHyln9RQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pQiiM-0grJQ6nj_rdWD0-GET5zdw/mo/photo.jpg?sz=128", "display_name": "Mary M.", "link": "https://stackoverflow.com/users/10165945/mary-m"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533145044, "post_id": 51634294, "comment_id": 90242812, "body": "@BigBen the EntryScreen2 is the name of the sheet in the VBA properties window. So instead of Sheet2 or Sheet3, it&#39;s labeled as EntryScreen2"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533145168, "post_id": 51634294, "comment_id": 90242882, "body": "So you don&#39;t need the <code>wsCurrent</code> then... Which line exactly throws the error?"}, {"owner": {"reputation": 1, "user_id": 10165945, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5eEWHyln9RQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pQiiM-0grJQ6nj_rdWD0-GET5zdw/mo/photo.jpg?sz=128", "display_name": "Mary M.", "link": "https://stackoverflow.com/users/10165945/mary-m"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533146255, "post_id": 51634294, "comment_id": 90243461, "body": "So I changed the name of the EntryScreen2 to what my actual VBA properties window shows and the code runs (I did a stupid thing and copied the code from another spreadsheet thinking that it would work for mine without any changes). Now to just get the permissions I need in order to save the data on the server it needs to be on. Thanks for your help! @BigBen"}], "owner": {"reputation": 1, "user_id": 10165945, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5eEWHyln9RQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pQiiM-0grJQ6nj_rdWD0-GET5zdw/mo/photo.jpg?sz=128", "display_name": "Mary M.", "link": "https://stackoverflow.com/users/10165945/mary-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533131277, "creation_date": 1533129332, "last_edit_date": 1533131277, "question_id": 51634294, "link": "https://stackoverflow.com/questions/51634294/vba-excel-object-defined-error-in-code-for-exporting-data-to-different-server", "title": "VBA Excel Object Defined Error in code for exporting data to different server", "body": "<p>I am a self-taught VBA Excel user and I am having trouble with some code that I am editing from a previous author for my needs. This code is supposed to look at a certain range of cells in the same column and export them with the respective tag in the next column over. </p>\n\n<p>I keep getting an object defined error on the 29th line of the following code:</p>\n\n<pre><code>Public oServer As PISDK.Server\n\nPublic Sub SaveDataToPI()\n\nDim wsCurrent As Worksheet\nDim rValue As Double\nDim RowIndex As Integer\nDim strPITagName As String\nDim dtCurrent As Date\nDim blnSavedData As Boolean\n'Dim bwLab As Double\n'Dim bwAct As Double\n'Dim bwDif As Double\n'Dim MoistureLab As Double\n'Dim MoistureAct As Double\n'Dim MoistureDif As Double\n\n\nWith Application\n    .Cursor = xlWait\n    .StatusBar = \"Sending Data To PI....\"\n    .ScreenUpdating = True\nEnd With\n\nSet wsCurrent = ActiveSheet\n\nWith wsCurrent\n   'first column of data\n    For RowIndex = 5 To 500\n        If Len(EntryScreen2.Cells(RowIndex, 3).Value) &lt; 1 Then\n            Exit For\n        End If\n    ' Blank out error messages in column 4 if there\n    EntryScreen2.Cells(RowIndex, 4).Value = \"\"\n\n    Next\nEnd With\n\nWith wsCurrent\n   'first column of data\n    For RowIndex = 5 To 500\n        If Len(EntryScreen2.Cells(RowIndex, 3).Value) &lt; 1 Then\n            Exit For\n        End If\n        If Len(EntryScreen2.Cells(RowIndex, 2).Value) &gt; 0 And Len(EntryScreen2.Cells(RowIndex, 3).Value) &gt; 0 Then\n            'Save Data To PI\n            dtCurrent = wsCurrent.Range(wsCurrent.Cells(2, 2), wsCurrent.Cells(2, 2)).Value\n            Call SavePIData(EntryScreen2.Cells(RowIndex, 3).Value, EntryScreen2.Cells(RowIndex, 2).Value, dtCurrent, RowIndex)\n            EntryScreen2.Cells(RowIndex, 2).Value = \"\"\n            blnSavedData = True\n        End If\n\n    Next\nEnd With\n\nIf blnSavedData = True Then MsgBox \"Data Saved to PI, Check Column D for Errors\"\n\nWith Application\n    .Cursor = xlDefault\n    .StatusBar = \"Ready....\"\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n\n\nPublic Function GetServer(szServer As String) As PISDK.Server\n\n'Dim oServer As PISDK.Server\nDim oCon    As Object\n\nSet oServer = Servers(szServer)\n\nOn Error Resume Next\nIf oServer.Connected = False Then\n    oServer.Open\nEnd If\n\nOn Error GoTo 0\n\nIf oServer.Connected = False Then\n    Set oCon = CreateObject(\"PISDKdlg.Connections\")\n\n    On Error Resume Next\n    oCon.Login oServer, , , False\nEnd If\n\nSet GetServer = oServer\nEnd Function\n\nPublic Sub SavePIData(strPITagName As String, dblValue As Double, dtCurrent As Date, RowIndex As Integer)\n\nDim oTag        As PIPoint\n'Dim oServer     As Server\n\nOn Error GoTo Error\n\nSet oServer = GetServer(\"pksfpi\")\n\nSet oTag = oServer.PIPoints(strPITagName)\n\n'Send Data to database\noTag.Data.UpdateValue dblValue, dtCurrent\n\nSet oTag = Nothing\nExit Sub\nError:\nEntryScreen2.Cells(RowIndex, 4).Value = Err.Description\n\nEnd Sub\n\nPublic Sub SaveEditedDataToPI(strPITagName As String, dtCurrent As Date, dblValue As Double)\n\nDim oTag        As PIPoint\n'Dim oServer     As Server\n\nOn Error Resume Next\n'    strPITagName , dtCurrent, rValue\n\nSet oServer = GetServer(\"pksfpi\")\n\nSet oTag = oServer.PIPoints(strPITagName)\n\n\n'Send Data to database\noTag.Data.UpdateValue dblValue, dtCurrent, dmReplaceOnlyDuplicates\n\nSet oTag = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>If you find anything else wrong in my code, feel free to let me know so that I don't run into anymore problems.</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["vba", "excel", "internet-explorer", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3463377, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/58574abeb04c5acd651acd52288ea4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Boswell", "link": "https://stackoverflow.com/users/3463377/boswell"}, "edited": false, "score": 0, "creation_date": 1533201734, "post_id": 51636589, "comment_id": 90263327, "body": "it&#39;s now missing out on roughly two links (out of about ~10) that I have put in excel. The links that do not load change each time. It&#39;s not consistent - its like the computer is lazy and sometimes loads them all sometimes doesn&#39;t..."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 1, "last_activity_date": 1533148492, "last_edit_date": 1533148492, "creation_date": 1533135651, "answer_id": 51636589, "question_id": 51634266, "link": "https://stackoverflow.com/questions/51634266/excel-vba-to-open-hyperlinks-slowly-initially/51636589#51636589", "title": "Excel VBA to open hyperlinks - slowly initially?", "body": "<p>Here's some modified code from Ken Puls to check if IE is open</p>\n\n<pre><code>Public Function IEIsOpen() As Boolean\n\n 'IMPORTANT:  Requires reference to Microsoft Internet Controls!!\n    'Set in Tools --&gt; References --&gt; Microsoft Internet Controls\n\n    Dim shellWins As SHDocVw.ShellWindows\n    Dim explorer As SHDocVw.InternetExplorer\n\n    Set shellWins = New SHDocVw.ShellWindows\n\n    For Each explorer In shellWins\n        If explorer.Name = \"Internet Explorer\" Then\n            IEIsOpen = True\n            Exit For\n        End If\n    Next\n\n    Set shellWins = Nothing\n    Set explorer = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Then you could do something like</p>\n\n<pre><code>For Each xHyperlink In WorkRng.Hyperlinks\n    xHyperlink.Follow\n    Do Until IEIsOpen\n        DoEvents\n    Loop\nNext\n</code></pre>\n\n<p>It'll open the first one, then not open any others until IE is open.</p>\n\n<p><strong>Update</strong></p>\n\n<p>You better put some check in there to prevent an endless loop</p>\n\n<pre><code>Dim dtStart As Date\n\ndtStart = Now\nFor Each xHyperlink In WorkRng.Hyperlinks\n    xHyperlink.Follow\n    Do Until IEIsOpen Or Now - dtStart &gt; TimeSerial(0, 0, 5)\n        DoEvents\n    Loop\nNext xHyperlink\n</code></pre>\n\n<p>Now it will wait for IE or five seconds, whichever comes first.</p>\n"}], "owner": {"reputation": 71, "user_id": 3463377, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/58574abeb04c5acd651acd52288ea4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Boswell", "link": "https://stackoverflow.com/users/3463377/boswell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 51636589, "answer_count": 1, "score": 1, "last_activity_date": 1533148492, "creation_date": 1533129277, "question_id": 51634266, "link": "https://stackoverflow.com/questions/51634266/excel-vba-to-open-hyperlinks-slowly-initially", "title": "Excel VBA to open hyperlinks - slowly initially?", "body": "<p>I have copied some VBA code online that opens a set of links from excel into multiple tabs in Internet explorer. The problem is, especially on slower computers, IE takes a little while to open and so the computer just loads up another IE window so you end up having say 3 links in one IE window, and another 7 in another one, it will also occasionally miss out a link altogether.</p>\n\n<p>I therefore slowed down the code by including a 2 second break between each link that is loaded. This has solved the problem - one IE session, all links load up, this problem now is that the wait seems excessive. What I want is to perhaps load the first 2-3 links with the delay and then the remaining can load up as fast as possible (assuming all links do end up loading, without another IE session loading as well..)</p>\n\n<p>How do I do this? - thank you in advance.</p>\n\n<p>Anyway here's the code: ignore the bit at the start and very end, it's just highlighting various links and hiding some columns...:</p>\n\n<pre><code>Sub Convert2links()\n'\n' Convert2links Macro\n'\n\n'\nColumns(\"G:L\").Select\n    Range(\"G7\").Activate\n    Selection.EntireColumn.Hidden = False\n    Range(\"J8:J28\").Select\n    Selection.Copy\n    Range(\"K8\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"A8\").Select\n    Selection.End(xlDown).Select\n    Selection.End(xlToRight).Select\n    Selection.End(xlToRight).Select\n    ActiveCell.Offset(0, 2).Range(\"A1\").Select\n    Range(Selection, Selection.End(xlUp)).Select\n    Application.CutCopyMode = False\n\nDim Rng As Range\nDim WorkRng As Range\nxTitleId = \"KutoolsforExcel\"\nSet WorkRng = Application.Selection\nFor Each Rng In WorkRng\n    Application.ActiveSheet.Hyperlinks.Add Rng, Rng.Value\nNext\n\n\n    Dim xHyperlink As Hyperlink\n    On Error Resume Next\n    xTitleId = \"KutoolsforExcel\"\n    Set WorkRng = Application.Selection\n    For Each xHyperlink In WorkRng.Hyperlinks\n        xHyperlink.Follow\n        Application.Wait (Now + TimeValue(\"00:00:02\"))\n    Next\n    Columns(\"H:K\").Select\n    Range(\"H7\").Activate\n    Selection.EntireColumn.Hidden = True\n    Range(\"A8\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "excel-formula", "evaluate"], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 10165736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bRim3GUnX_w/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppywRDXmj6Z5qL4bcjB34IxVp2nQ/mo/photo.jpg?sz=128", "display_name": "Kau&#234; Delmonte", "link": "https://stackoverflow.com/users/10165736/kau%c3%aa-delmonte"}, "edited": false, "score": 0, "creation_date": 1533314684, "post_id": 51636272, "comment_id": 90317101, "body": "Thanks for your answer, buddy! I believe that&#39;s not the solution what I was looking for. But I did a workaround using a loop through every critearia and joined all filter results. I guess it was the best pratice to this case, because if I had criterias enough to pass a 255 characters formula, evaluate would return an error."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1533134819, "creation_date": 1533134819, "answer_id": 51636272, "question_id": 51634264, "link": "https://stackoverflow.com/questions/51634264/vba-evaluate-if-with-or-returns-wrong-values/51636272#51636272", "title": "VBA Evaluate &#39;IF&#39; with &#39;OR&#39; returns wrong values", "body": "<p>I don't know what the problem is with OR, but you can re-jig the IF to get the result you want:</p>\n\n<pre><code>myArray = Filter(Application.Transpose(Evaluate(\"IF(D=\"\"D1\"\",S,if(D=\"\"D2\"\",S,false))\")), False, False)\n</code></pre>\n"}], "owner": {"reputation": 40, "user_id": 10165736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bRim3GUnX_w/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppywRDXmj6Z5qL4bcjB34IxVp2nQ/mo/photo.jpg?sz=128", "display_name": "Kau&#234; Delmonte", "link": "https://stackoverflow.com/users/10165736/kau%c3%aa-delmonte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 51636272, "answer_count": 1, "score": 0, "last_activity_date": 1533134819, "creation_date": 1533129273, "last_edit_date": 1533130993, "question_id": 51634264, "link": "https://stackoverflow.com/questions/51634264/vba-evaluate-if-with-or-returns-wrong-values", "title": "VBA Evaluate &#39;IF&#39; with &#39;OR&#39; returns wrong values", "body": "<p>I have these columns:</p>\n\n<p><img src=\"https://i.stack.imgur.com/9M62a.jpg\" alt=\"Columns\"></p>\n\n<p>I'm trying to evaluate them, this way:</p>\n\n<pre><code>dim myArray as variant\n\nmyArray = filter(application.transpose(columnSheet.evaluate(\"IF(OR(D=\"\"D1\"\",D=\"\"D2\"\"),S,false)\")),false,false)\n</code></pre>\n\n<p>Seeing that <strong>\"DISPENSER\"</strong> entire column name equals <strong>\"D\"</strong> and <strong>\"SELLER\"</strong> entire column name equals <strong>\"S\"</strong> and <strong>\"columnSheet\"</strong> is the name of <strong>sheet object</strong> where these columns supposed to be. </p>\n\n<p>Filter application is due to feed \"myArray\" with the true results.</p>\n\n<p>The problem is that <strong>when I use \"OR\"</strong> statement in the function that it's being <strong>evaluating</strong>, <strong>I get \"SELLER\" <em>entire column</em> as result</strong>. And if you try to apply the same function formula directly in sheet its returns the right results.</p>\n\n<p><img src=\"https://i.stack.imgur.com/7tQFs.jpg\" alt=\"Evaluate Function Formula Apply\"></p>\n"}, {"tags": ["html", "vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1533134709, "post_id": 51636048, "comment_id": 90236787, "body": "That worked perfectly!! In terms of modifying the font/size/etc, would I insert it into the squiqly brackets? &quot; { } &quot;? I tried adding &quot;, size: 2.5&quot; at the end of &quot;sans-serif&quot; and it just invalidated the entire code."}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1533134990, "post_id": 51636048, "comment_id": 90236986, "body": "Try <code>body{font-family: Calibri, &quot;&quot;Times New Roman&quot;&quot;, sans-serif; font-size: 25px}</code>.  You could learn more CSS from <a href=\"https://www.w3schools.com/css/css_font.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/css/css_font.asp</a>."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": true, "score": 1, "last_activity_date": 1533134901, "last_edit_date": 1533134901, "creation_date": 1533134162, "answer_id": 51636048, "question_id": 51634237, "link": "https://stackoverflow.com/questions/51634237/vba-excel-email-formatting-issue/51636048#51636048", "title": "VBA Excel Email Formatting Issue", "body": "<p>Try replace</p>\n\n<pre><code>.HTMLBody = mailBody\n</code></pre>\n\n<p>with</p>\n\n<pre><code>.HTMLBody = \"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;style&gt;\"\n.HTMLBody = .HTMLBody &amp; \"body{font-family: Calibri, \"\"Times New Roman\"\", sans-serif}\"\n.HTMLBody = .HTMLBody &amp; \"&lt;/style&gt;&lt;/head&gt;&lt;body&gt;\"    \n.HTMLBody = .HTMLBody &amp; mailBody &amp; \"&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 51636048, "answer_count": 1, "score": 0, "last_activity_date": 1533134901, "creation_date": 1533129195, "question_id": 51634237, "link": "https://stackoverflow.com/questions/51634237/vba-excel-email-formatting-issue", "title": "VBA Excel Email Formatting Issue", "body": "<p>My data is set up like this:</p>\n\n<p>-On Excel, I have a worksheet, \"Test1\", which has a list of people I want to send emails to. Like such;</p>\n\n<pre><code>No.    Version  Company  Name    Email\n 1       R         x     Max     max@abc.com\n 2       E         y     Bill    bill@abc.com\n 3       C         z     Scott   scott@abc.com\n</code></pre>\n\n<p>The emails I want to send differ slightly by type. My current code is as follows:</p>\n\n<pre><code>Sub mailTest()\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\n\nFor i = 2 To 3\n\n   Set olApp = New Outlook.Application\n   Set olMail = olApp.CreateItem(olMailItem)\n\n    mailBody = Worksheets(\"BODY\").Cells(1, 1).Value &amp; Worksheets(\"Test1\").Cells(i, 4) _\n &amp; Worksheets(\"BODY\").Cells(2, 1).Value\n\n\n\n   With olMail\n       .To = Worksheets(\"Test1\").Cells(i, 5).Value\n       .Subject = Worksheets(\"Test1\").Cells(i, 3).Value\n       .HTMLBody = mailBody\n       .Display\n\nEnd With\n\n\n   Set olMail = Nothing\n   Set olApp = Nothing\n\nNext\n\n\n\nEnd Sub\n</code></pre>\n\n<p>The code above displays the emails as the main body is in Cell A2 of sheet \"BODY\". The \"Hello\" is stored in Cell A1, and also displays fine as I have HTML coding in both these cells to set the font to Calibri and the size to 3.</p>\n\n<p>The issue is when I'm pulling the names of people from sheet Test1 in Column 4 using the code;</p>\n\n<pre><code> &amp; Worksheets(\"Test1\").Cells(i, 4)\n</code></pre>\n\n<p>It is displaying with a different font, defaulting to Times New Roman. What I'm left with is everything displaying in Calibri, with just their names being pulled in Times New Roman. </p>\n\n<p>Is there any way to fix this without adding HTML code in each of the name cells? The actual file I'm working on has about 500 names so manually doing it would be a pain...</p>\n\n<p>Thanks everyone.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533129157, "post_id": 51634106, "comment_id": 90232658, "body": "It seems like  you have at least 3 separate questions in here. Can you take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read up on <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, then try re-framing your question to address only one particular problem (it&#39;s OK to ask multiple questions, separately, but generally could avoid combining 3 or 4 separate problems into a single question)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1533129179, "post_id": 51634106, "comment_id": 90232676, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select/Activate</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1533129195, "post_id": 51634106, "comment_id": 90232688, "body": "<a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">How to find the last used cell in a range/column/sheet</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1533129268, "post_id": 51634106, "comment_id": 90232736, "body": "<a href=\"https://msdn.microsoft.com/en-us/VBA/Language-Reference-VBA/articles/fornext-statement\" rel=\"nofollow noreferrer\">For...Next</a> loop documentation"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1533129281, "post_id": 51634106, "comment_id": 90232751, "body": "<a href=\"https://msdn.microsoft.com/en-us/VBA/Language-Reference-VBA/articles/for-eachnext-statement\" rel=\"nofollow noreferrer\">For Each ... Next</a> loop documentation"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533129647, "post_id": 51634106, "comment_id": 90233013, "body": "So, you need to 1) Loop over each Worksheet in the <code>ActiveWorkbook.Worksheets</code> collection, and 2) modify your code in such a way that it finds the appropriate &quot;last row&quot; for any column/etc that you need to operate against. For bonus points: 3) refactor the code to avoid <code>Select</code> and <code>ActiveCell</code> :)"}, {"owner": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1533129722, "post_id": 51634106, "comment_id": 90233064, "body": "Thank you for your helpful comments guys!"}], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 1, "last_activity_date": 1533131978, "creation_date": 1533131978, "answer_id": 51635258, "question_id": 51634106, "link": "https://stackoverflow.com/questions/51634106/excel-vba-loop/51635258#51635258", "title": "Excel VBA Loop?", "body": "<p>I cleaned up your code a bit, and put it into a sub which takes a worksheet as its argument. I then made another sub which loops through all the worksheets of the workbook the code resides in, and makes the changes specified.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n        Call fix_stuff_in_the_sheet(ws)\n    Next ws\nEnd Sub\n\nSub fix_stuff_in_the_sheet(ws As Worksheet)\n\n    ws.Range(\"G1\").FormulaR1C1 = \"PSTRIK\"\n    ws.Range(\"A1\").FormulaR1C1 = \"PRECID\"\n    ws.Range(\"A2\").FormulaR1C1 = \"P\"\n    ws.Range(\"A2\").AutoFill Destination:=Range(\"A2:A26\"), Type:=xlFillDefault\n    ws.Range(\"A2:A26\").FormulaR1C1 = \"PEXCH\"\n\n    ws.Range(\"C2\").FormulaR1C1 = \"7\"\n    ws.Range(\"C2\").AutoFill Destination:=Range(\"C2:C26\"), Type:=xlFillDefault\n    ws.Columns(\"N:O\").Delete Shift:=xlToLeft\n    ws.Columns(\"E:E\").Delete Shift:=xlToLeft\n    ws.Columns(\"J:J\").Delete Shift:=xlToLeft\n\n    ws.Columns(\"D:D\").Delete Shift:=xlToLeft\n    ws.Columns(\"E:E\").Cut\n    ws.Columns(\"G:G\").Insert Shift:=xlToRight\n    ws.Columns(\"I:I\").Cut\n    ws.Columns(\"K:K\").Insert Shift:=xlToRight\n\n    ws.Range(\"I1\").FormulaR1C1 = \"PQTY\"\n    ws.Range(\"G1\").FormulaR1C1 = \"PCTYM\"\n    ws.Range(\"D1\").FormulaR1C1 = \"PFC\"\n    ws.Range(\"B1\").FormulaR1C1 = \"PACCT\"\n    ws.Range(\"J1\").FormulaR1C1 = \"PPRTCP\"\n\n    ws.Range(\"E1\").FormulaR1C1 = \"PSUBTY\"\n    ws.Range(\"H1\").FormulaR1C1 = \"PSBUS\"\n    ws.Range(\"H2\").FormulaR1C1 = \"0\"\n    ws.Range(\"H2\").AutoFill Destination:=Range(\"H2:H23\"), Type:=xlFillDefault\n    ws.Range(\"I240\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    ws.Range(\"I1\").FormulaR1C1 = \"PBS\"\n    ws.Range(\"I2\").FormulaR1C1 = \"1\"\n    ws.Range(\"I2\").AutoFill Destination:=Range(\"I2:I23\"), Type:=xlFillDefault\n\nEnd Sub\n</code></pre>\n\n<p>If you don't want the code to be performed on all the sheets in your workbook, you need to figure out a way for the first function to only be called with the sheets you want as an argument.</p>\n\n<p>There is still some superfluous code in the subs I post here, e.g. you first autofill range A2:A26 with the letter P, but then later overwrites that with PEXCH. I'll leave it to you to weed out this though.</p>\n"}], "owner": {"reputation": 135, "user_id": 7275153, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290380437651399/picture?type=large", "display_name": "Emalee Jimenez", "link": "https://stackoverflow.com/users/7275153/emalee-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 51635258, "answer_count": 1, "score": 0, "last_activity_date": 1533131978, "creation_date": 1533128828, "last_edit_date": 1533129543, "question_id": 51634106, "link": "https://stackoverflow.com/questions/51634106/excel-vba-loop", "title": "Excel VBA Loop?", "body": "<p>I am new to creating VBA macros. I recorded the macro below, but I need this done for 18 other worksheets in the workbook. I do not know how to create a loop. Can it be done from this recorded macro? Sorry for the long code. Again this code is used on 18 other worksheets and am unsure how to create a loop.</p>\n\n<pre><code>Sheets(\"C3 CONW INW OPIS_CMA\").Select\nRange(\"G1\").Select\nActiveCell.FormulaR1C1 = \"PSTRIK\"\nRange(\"A1\").Select\nActiveCell.FormulaR1C1 = \"PRECID\"\nRange(\"A2\").Select\nActiveCell.FormulaR1C1 = \"P\"\nRange(\"A2\").Select\nSelection.AutoFill Destination:=Range(\"A2:A26\"), Type:=xlFillDefault\nRange(\"A2:A26\").Select\nRange(\"C1\").Select\nActiveCell.FormulaR1C1 = \"PEXCH\"\nRange(\"C2\").Select\nActiveCell.FormulaR1C1 = \"7\"\nRange(\"C2\").Select\nSelection.AutoFill Destination:=Range(\"C2:C26\"), Type:=xlFillDefault\nRange(\"C2:C26\").Select\nColumns(\"O:O\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"N:N\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"E:E\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"J:J\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"D:D\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"E:E\").Select\nSelection.Cut\nColumns(\"G:G\").Select\nSelection.Insert Shift:=xlToRight\nColumns(\"I:I\").Select\nSelection.Cut\nColumns(\"K:K\").Select\nSelection.Insert Shift:=xlToRight\nRange(\"I1\").Select\nActiveCell.FormulaR1C1 = \"PQTY\"\nRange(\"G1\").Select\nActiveCell.FormulaR1C1 = \"PCTYM\"\nRange(\"D1\").Select\nActiveCell.FormulaR1C1 = \"PFC\"\nRange(\"B1\").Select\nActiveCell.FormulaR1C1 = \"PACCT\"\n\nRange(\"J1\").Select\nActiveCell.FormulaR1C1 = \"PPRTCP\"\nRange(\"E1\").Select\nActiveCell.FormulaR1C1 = \"PSUBTY\"\nRange(\"H1\").Select\nActiveCell.FormulaR1C1 = \"PSBUS\"\nRange(\"H2\").Select\nActiveCell.FormulaR1C1 = \"0\"\nSelection.AutoFill Destination:=Range(\"H2:H23\"), Type:=xlFillDefault\nRange(\"H2:H23\").Select\nColumns(\"I:I\").Select\nRange(\"I240\").Activate\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"I1\").Select\nActiveCell.FormulaR1C1 = \"PBS\"\nRange(\"I2\").Select\nActiveCell.FormulaR1C1 = \"1\"\nSelection.AutoFill Destination:=Range(\"I2:I23\"), Type:=xlFillDefault\nRange(\"I2:I23\").Select\n</code></pre>\n\n<p>Again sorry for the format of the code.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533139526, "post_id": 51634060, "comment_id": 90239896, "body": "It&#39;s going to depend on how this tools generates the documents. I get the impression that it&#39;s creating a <i>new instance</i> of the Word.Application each time it runs. If that&#39;s the case, then the individual Word instances can&#39;t &quot;see&quot; each other. This is something you won&#39;t experience working as a user since the installation default is to open anything the user double-clicks on in a currently running instance. What happens to these documents after the tool has created them? Are they saved somewhere?"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1533261297, "post_id": 51634060, "comment_id": 90291966, "body": "Are they open in a different instance of MS Word? You could check via task manager... Can you see the other documents in the VBA IDE Project Explorer?"}], "owner": {"reputation": 1, "user_id": 8556271, "user_type": "registered", "profile_image": "https://graph.facebook.com/1425526170830325/picture?type=large", "display_name": "Nick Viado", "link": "https://stackoverflow.com/users/8556271/nick-viado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593822874, "creation_date": 1533128699, "last_edit_date": 1593822874, "question_id": 51634060, "link": "https://stackoverflow.com/questions/51634060/vba-does-not-recognize-the-correct-number-of-ms-word-windows-documents-open", "title": "VBA does not recognize the correct number of MS Word windows/documents open", "body": "<p>Where I am working, we have software that converts an xml file into a word document.  The only issue is that it can only do 1 xml file at a time, producing 1 word document at a time.  I am trying to find a way to join all the word documents into 1.  Here is the code I came up with.</p>\n\n<pre><code>Sub merge()\nDim myDoc As Documents\nDim count As Integer\n\nSet myDoc = Documents\ncount = myDoc.count\n\nIf count &lt;&gt; 1 Then\n   For i = 1 To count - 1\n      myDoc(i).Select\n      Selection.WholeStory\n      Selection.Copy\n      myDoc(count).Range.Select\n      Selection.EndKey Unit:=wdLine\n      Selection.TypeParagraph\n      Selection.Paste\n   Next i\nElse\n    MsgBox (\"No other documents open\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The only issue I am running into is that when the software converts the xml file into a word document, the VBA does not recognize any of the converted documents even though it is open in MS Word.  If I run code like \"application.windows.count or documents.count\" it will not recognize it.  If I open any other document the code will merge everything together.  But the converted documents from the software cannot be merged.  Is there anything I can do to force MS Word to recognize the converted documents?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1533128579, "post_id": 51633741, "comment_id": 90232195, "body": "Is it necessary to use merged cells? Working with unmerged cells is a lot easier... Anyway, what is the exact issue with the code you&#39;ve already written? What doesn&#39;t it do, which you are trying to achieve?"}, {"owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "edited": false, "score": 0, "creation_date": 1533129909, "post_id": 51633741, "comment_id": 90233212, "body": "yeah I&#39;m limited to using merged cells sadly, and I&#39;m new to VBA so I just need my syntax checked and how to write the code for dealing with the block on the end"}, {"owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "edited": false, "score": 0, "creation_date": 1533129978, "post_id": 51633741, "comment_id": 90233276, "body": "I essentially need to know which block is to the right of each block being looped through:"}, {"owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "edited": false, "score": 0, "creation_date": 1533130410, "post_id": 51633741, "comment_id": 90233611, "body": "Like in cells &quot;B2&quot; through &quot;B13&quot; would have 1 through 12 listed down them, and cells &quot;C2&quot; through &quot;C13&quot; would have the output (what&#39;s to the right of each number in cells B2 through B13) it should literally be 1 --&gt; 2, 2 --&gt; 3, etc. unless let&#39;s say block Car_3 has no text then Car_4 would be the output when Car_2 is looked at in the loop"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533145484, "post_id": 51633741, "comment_id": 90243062, "body": "Do you specifically want to use <code>IsText</code> - i.e. if there&#39;s a number in a block, it will be ignored? Or do you just want to check that the length of the block&#39;s value is &gt; 0?"}, {"owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533146943, "post_id": 51633741, "comment_id": 90243832, "body": "I&#39;d like for any value in the block to be looked at, so is <code>IsBlank</code> a better option @BigBen"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533147127, "post_id": 51633741, "comment_id": 90243911, "body": "And what if for example - Car 2 is blank and Car 3 is not - would the output be 1--&gt;3, 2--&gt;3 or would you skip 2?"}, {"owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1533147813, "post_id": 51633741, "comment_id": 90244313, "body": "2 would be skipped @BigBen so it would be 1 --&gt; 3, 2 --&gt;  , 3 --&gt; 4 etc."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1533154691, "creation_date": 1533154691, "answer_id": 51641652, "question_id": 51633741, "link": "https://stackoverflow.com/questions/51633741/how-to-loop-through-merged-cells-and-read-each-one-for-text/51641652#51641652", "title": "How to loop through merged cells and read each one for text", "body": "<p>You can find the next car by using a nested loop. The code below cycles through cars 1 to 11 in the first <code>For</code> loop, checking for the next non-blank car in the nested loop immediately after. Once if finds the next car, it exits the nested loop and writes the index of that car to the relevant row in the range <code>C2:C13</code> - here I am using <code>i</code> and <code>Offset</code>ting from <code>C1</code> to get that row.</p>\n\n<p>I found it easiest to construct a second loop to get the \"Right End\" - just loop from Car 12 backwards and look for the first pair of cars where the last is blank and the second to last is not. Note that if Car 12 is not blank, it is automatically the \"Right End.\"</p>\n\n<pre><code>Sub Code()\n    Dim wb As Workbook: Set wb = ThisWorkbook\n    Dim ws As Worksheet: Set ws = wb.Sheets(\"Sheet3\")\n    Dim i As Integer, j As Integer, k As Integer\n\n    ws.Range(\"C2:C13\").ClearContents\n\n    ' First loop to compare a car to the rest after it\n    For i = 1 To 11\n        For j = i + 1 To 12\n            If Not IsEmpty(ws.Range(\"Car_\" &amp; i)) And Not IsEmpty(ws.Range(\"Car_\" &amp; j)) Then\n                ws.Range(\"C1\").Offset(i).Value = j\n                Exit For\n            End If\n        Next j\n    Next i\n\n    ' Loop backwards to find \"Right End\"\n    For k = 12 To 2 Step -1\n        If Not IsEmpty(ws.Range(\"Car_12\")) Then\n            ws.Range(\"C1\").Offset(12).Value = \"Right End\"\n            Exit For\n        ElseIf IsEmpty(ws.Range(\"Car_\" &amp; k)) And Not IsEmpty(ws.Range(\"Car_\" &amp; k - 1)) Then\n            ws.Range(\"C1\").Offset(k - 1).Value = \"Right End\"\n            Exit For\n        End If\n    Next k\n\nEnd Sub\n</code></pre>\n\n<p><strong>Screenshots</strong> - definitely simplified from your file but demonstrate the concept.</p>\n\n<p><em>Possibility 1</em>\n<a href=\"https://i.stack.imgur.com/VrlJt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VrlJt.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>Possibility 2</em>\n<a href=\"https://i.stack.imgur.com/FFcBl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FFcBl.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 65, "user_id": 9933055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d8ca67c241d9daa900a8ceb1d4fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "JD1997", "link": "https://stackoverflow.com/users/9933055/jd1997"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 51641652, "answer_count": 1, "score": 0, "last_activity_date": 1533154691, "creation_date": 1533127779, "question_id": 51633741, "link": "https://stackoverflow.com/questions/51633741/how-to-loop-through-merged-cells-and-read-each-one-for-text", "title": "How to loop through merged cells and read each one for text", "body": "<p>I have an excel sheet called Sheet3 where I merged cells together into big 11 x 6 squares and I lined them up. There are 12 of these blocks that are all 7 cells apart from each other. I defined the name of each of these blocks, \"Car_1\" through \"Car_12\". I'm trying to write a block of code where I can create an array with my Car_1 through Car_12 blocks and I can go through each one and determine if there's text written in the block to the right of each, If there is then the ID of that block to the right can be printed in a cell elsewhere on the sheet (there are 12 blocks total so the output could range in cells \"C2\" to \"C13\" ) on the contrary, If there was no text written in the block to the right of the one being focused on then no output is given, it would just go to the next block down the line until all the blocks are lopped through. However, whichever block that would be on the end would need a different action taken for it. So when the program would look at that block, it would print \"Right End\" instead of an ID when there is no block with text at any point down the line after it. This what I have so far, but of course it doesn't work:</p>\n\n<pre><code>Sub Code()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim TxtRng As Range\n\nSet wb = ActiveWorkbook\nSet ws = wb.Sheets(\"Sheet3\")\n\nDim Cars(12)\ni = 1\nFor Cars = 1 To 12\nIf Application.WorksheetFunction.IsText(Range(\"Car_(i)\")) Then\n\nSet TxtRng = ws.Range(\"C2\")\nTxtRng.Value = \"Yes\" 'Car(i) ----&gt; ID\nElse\nTxtRng.Value = \"\"    'Blank\n\n        If Application.WorksheetFunction.IsText(Range(\"Car_12\")) Then\n\n        Set TxtRng = ws.Range(\"C13\")\n        TxtRng.Value = \"Right End\"\n\nNext i\n\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>In my code, I only focus on what happens when Car_12 is looked at rather than wherever down the line where a block has no block to its right with text.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1533128101, "post_id": 51633736, "comment_id": 90231848, "body": "what is the actual value of <code>lastcol2</code>?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1533128303, "post_id": 51633736, "comment_id": 90231982, "body": "Can the CriteriaRange be more than one cell? Trying to run your code for myself I get a complaint regarding that, but I don&#39;t have any data in my sheet so I suppose it could be something related to that as well. Apart from that, I&#39;d advice to fully qualify the all ranges you refer to, and use the variable you&#39;ve defined for the worksheet instead of keeping on hardcoding it&#39;s name. I.e. do something like <code>check2.Range(check2.Cells(1, 1), check2.Cells(2, lastcol2))</code>"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1533128386, "post_id": 51633736, "comment_id": 90232059, "body": "Additionally, including the exact error message you get would be helpful in pinpointing the problem."}, {"owner": {"reputation": 89, "user_id": 9408502, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "raspi surya", "link": "https://stackoverflow.com/users/9408502/raspi-surya"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1533168567, "post_id": 51633736, "comment_id": 90251898, "body": "@eirikdaude you are correct. I use your code and it works perfectly"}], "owner": {"reputation": 89, "user_id": 9408502, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "raspi surya", "link": "https://stackoverflow.com/users/9408502/raspi-surya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533128046, "creation_date": 1533127760, "last_edit_date": 1533128046, "question_id": 51633736, "link": "https://stackoverflow.com/questions/51633736/excel-macro-range-using-cells-error", "title": "excel macro range using cells error", "body": "<p>I want to set a range in the code below, first i define the last column, it is success, I got the column \"9\" = column I</p>\n\n<p>and I want to use the <code>lastcol2</code> variable into my range like below code:</p>\n\n<pre><code>Set check2 = Sheets(\"filterx\")\nlastcol2 = check2.Cells(1, check2.Columns.Count).End(xlToLeft).Column\n\nRange(\"A1:AI\" &amp; lastrow1).AdvancedFilter _\n    Action:=xlFilterCopy, _\n    CriteriaRange:=Sheets(\"filterx\").Range(Cells(1, 1), Cells(2, lastcol2)), _\n    CopyToRange:=Range(\"BA1:CI1\"), Unique:=False\n</code></pre>\n\n<p>however, it doesnt work on the code. what is wrong with my code? \n<code>Range(Cells(1, 1), Cells(2, lastcol2))</code> is the wrong part.</p>\n\n<p>If I replace it into <code>Range(\"A1:I2\")</code> it works perfectly. please tell me the reason.</p>\n"}, {"tags": ["vba", "object", "collections"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533128536, "post_id": 51633701, "comment_id": 90232162, "body": "In a word, no. Reference types are reference types, full stop. If you pass them <code>ByVal</code> it only means that you can&#39;t reassign the <i>reference</i>."}, {"owner": {"reputation": 278, "user_id": 1270911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7651d67fd4f31605a07e21d995cf98ea?s=128&d=identicon&r=PG", "display_name": "Joel Biffin", "link": "https://stackoverflow.com/users/1270911/joel-biffin"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1533129109, "post_id": 51633701, "comment_id": 90232615, "body": "@Comintern is there no way that I can take a copy though? Instead of passing the pointer?"}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "edited": false, "score": 1, "creation_date": 1533133726, "post_id": 51633701, "comment_id": 90236077, "body": "To take a copy, you will have to  create a new object based on the members of the old one."}], "owner": {"reputation": 278, "user_id": 1270911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7651d67fd4f31605a07e21d995cf98ea?s=128&d=identicon&r=PG", "display_name": "Joel Biffin", "link": "https://stackoverflow.com/users/1270911/joel-biffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533127638, "creation_date": 1533127638, "question_id": 51633701, "link": "https://stackoverflow.com/questions/51633701/putting-a-copy-of-an-object-into-a-collection", "title": "Putting a Copy of an Object into A Collection", "body": "<p>I have a loop which runs over 100,000 times where I read a text file which gives my information to create Service objects.</p>\n\n<p>For searching later on, I need to put these Service objects into a collection (with defined keys).</p>\n\n<p>The problem I'm facing is that I have a this_service variable (Service object) which I add at the end of the loop to the all_services collection - but since the <code>add</code> method is by reference, I end up having a collection with 100,000 duplicates of the final object I create.</p>\n\n<p>Is there no way that I can add the custom object to the collection ByVal?</p>\n"}, {"tags": ["vba", "sap-gui"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10165842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d169952d25f6395d69597afec761bd?s=128&d=identicon&r=PG", "display_name": "zanniboni", "link": "https://stackoverflow.com/users/10165842/zanniboni"}, "edited": false, "score": 1, "creation_date": 1533133750, "post_id": 51634516, "comment_id": 90236096, "body": "Hey, thanks for your help. I managed to do what i wanted with this code session.FindById(&quot;wnd[1]/usr/txtMESSTXT1&quot;).Text"}, {"owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "reply_to_user": {"reputation": 13, "user_id": 10165842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d169952d25f6395d69597afec761bd?s=128&d=identicon&r=PG", "display_name": "zanniboni", "link": "https://stackoverflow.com/users/10165842/zanniboni"}, "edited": false, "score": 0, "creation_date": 1608897613, "post_id": 51634516, "comment_id": 115708788, "body": "@zanniboni Please do not vote or mark correct an answer which is not useful, as per Stack Overflow rules. Instead, you may thank the person for his help, and edit your question to clarify it, like removing <a href=\"https://stackoverflow.com/questions/tagged/abap\">abap</a> which is irrelevant, and add <a href=\"https://stackoverflow.com/questions/tagged/sap-gui\">sap-gui</a>. Thank you."}], "tags": [], "owner": {"reputation": 80, "user_id": 10164274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MtnPA.jpg?s=128&g=1", "display_name": "letronas", "link": "https://stackoverflow.com/users/10164274/letronas"}, "is_accepted": true, "score": 0, "last_activity_date": 1533129945, "creation_date": 1533129945, "answer_id": 51634516, "question_id": 51633680, "link": "https://stackoverflow.com/questions/51633680/getting-data-out-of-sap-information-box-with-vba/51634516#51634516", "title": "Getting data out of SAP information box with vba", "body": "<p>If you had an access to the messages you can use MESSAGE - INTO (<a href=\"https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abapmessage_into.htm\" rel=\"nofollow noreferrer\">check info about it</a>)</p>\n\n<p>if i got your task incorrect pls write here. Good luck</p>\n"}, {"comments": [{"owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "reply_to_user": {"reputation": 2401, "user_id": 12695027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i74ZG.png?s=128&g=1", "display_name": "Scratte", "link": "https://stackoverflow.com/users/12695027/scratte"}, "edited": false, "score": 1, "creation_date": 1608898018, "post_id": 65447858, "comment_id": 115708859, "body": "@Scratte Done. Thank you."}], "tags": [], "owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "is_accepted": false, "score": 0, "last_activity_date": 1608898006, "last_edit_date": 1608898006, "creation_date": 1608897458, "answer_id": 65447858, "question_id": 51633680, "link": "https://stackoverflow.com/questions/51633680/getting-data-out-of-sap-information-box-with-vba/65447858#65447858", "title": "Getting data out of SAP information box with vba", "body": "<p>I reproduce here the <a href=\"https://stackoverflow.com/questions/51633680/getting-data-out-of-sap-information-box-with-vba/65447858?noredirect=1#comment90236096_51634516\">answer of the OP (@zanniboni)</a>:</p>\n<blockquote>\n<p>&quot;Hey, thanks for your help. I managed to do what I wanted with this code <code>session.FindById(&quot;wnd[1]/usr/txtMESSTXT1&quot;).Text</code>&quot;.</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 10165842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d169952d25f6395d69597afec761bd?s=128&d=identicon&r=PG", "display_name": "zanniboni", "link": "https://stackoverflow.com/users/10165842/zanniboni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "protected_date": 1608897686, "accepted_answer_id": 51634516, "answer_count": 2, "score": 1, "last_activity_date": 1608898006, "creation_date": 1533127593, "last_edit_date": 1608897665, "question_id": 51633680, "link": "https://stackoverflow.com/questions/51633680/getting-data-out-of-sap-information-box-with-vba", "title": "Getting data out of SAP information box with vba", "body": "<p>I'm automating a process with VBA, and I'm using SAP Scripting to do so.</p>\n<p>The process is basically go to VA01, input the Orders Data and save the order.\nBut there is a variant in saving the order that is cracking up my head.\nThe SAP displays a popup message with relevant informations about the order, and I need that information and can't figure out how to get the Text out of the infobox that is displaying when you save the order.</p>\n<p>Infos are: Blocked on price, No limit etc... And when it displays that message, I need to save it on a TXT file (i've already got a code for that), I just need a help in manage how to get that text out of the infobox.</p>\n<p><img src=\"https://i.stack.imgur.com/umiev.png\" alt=\"Information Box\" /></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1533128019, "post_id": 51633664, "comment_id": 90231794, "body": "This answer gives a nice explanation of <code>xlDown</code>: <a href=\"https://stackoverflow.com/a/9405164/9259306\">stackoverflow.com/a/9405164/9259306</a>"}, {"owner": {"reputation": 67, "user_id": 10164769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb7a6fe1378fcffa7382778436fc001?s=128&d=identicon&r=PG&f=1", "display_name": "R. de Rojas", "link": "https://stackoverflow.com/users/10164769/r-de-rojas"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1533128987, "post_id": 51633664, "comment_id": 90232511, "body": "This helped a lot! Thank you too!"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10164769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb7a6fe1378fcffa7382778436fc001?s=128&d=identicon&r=PG&f=1", "display_name": "R. de Rojas", "link": "https://stackoverflow.com/users/10164769/r-de-rojas"}, "edited": false, "score": 0, "creation_date": 1533128899, "post_id": 51633791, "comment_id": 90232442, "body": "Perfect! Works! Thank you"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1533127913, "creation_date": 1533127913, "answer_id": 51633791, "question_id": 51633664, "link": "https://stackoverflow.com/questions/51633664/code-for-looping-through-a-variable-range-fails-when-the-range-is-one/51633791#51633791", "title": "Code for looping through a variable range fails when the range is one", "body": "<p>The issue is that <code>xlDown</code> will move down to the very last row of Excel if there is no data in C4 or below. </p>\n\n<p>Therefore use <code>xlUp</code> starting from the very last row <code>Rows.Count</code> to determine the last used cell. This is more reliable than the <code>xlDown</code> method.</p>\n\n<pre><code>Dim deposits As Range\nSet deposits = Worksheets(\"DATA ENTRY\").Range(\"C3\", Worksheets(\"DATA ENTRY\").Cells(Rows.Count, \"C\").End(xlUp))\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10164769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb7a6fe1378fcffa7382778436fc001?s=128&d=identicon&r=PG&f=1", "display_name": "R. de Rojas", "link": "https://stackoverflow.com/users/10164769/r-de-rojas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 51633791, "answer_count": 1, "score": 2, "last_activity_date": 1533127913, "creation_date": 1533127551, "question_id": 51633664, "link": "https://stackoverflow.com/questions/51633664/code-for-looping-through-a-variable-range-fails-when-the-range-is-one", "title": "Code for looping through a variable range fails when the range is one", "body": "<p>I have a problem with some of my code. I basically wrote a line that would allow me to define a range which is variable in size. This is so that my model creates sheets for each element in the range. This code works prefectly when the range defined is bigger than one, however when im supposed to define a range of one or zero my code tells me there is a large number of elements (like to 100,000) in this range. Anyone know why? This is the code:</p>\n\n<pre><code>Dim deposits As Range\nSet deposits = Worksheets(\"DATA ENTRY\").Range(\"C3\", Worksheets(\"DATA ENTRY\").Range(\"C3\").End(xlDown))\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1533188247, "post_id": 51633531, "comment_id": 90256113, "body": "my solution work? was a bit hard following code"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1533535718, "post_id": 51633531, "comment_id": 90363944, "body": "@learnAsWeGo No"}], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": -1, "last_activity_date": 1533535694, "creation_date": 1533535694, "answer_id": 51701451, "question_id": 51633531, "link": "https://stackoverflow.com/questions/51633531/adding-border-to-series-in-a-bar-chart/51701451#51701451", "title": "Adding border to series in a bar chart", "body": "<p>It appears that the <code>.Format.Line</code> property of a series applies to something else than the border of a bar chart - a guess would be that it is the line connecting the datapoints of e.g. a line or scatter chart.</p>\n\n<p>To actually outline the bars, I replaced the offending code;</p>\n\n<pre><code>With .Format.Line\n    .Visible = msoTrue\n    .Weight = 0.5\n    .ForeColor.RGB = RGB(255, 0, 0)\n    .Transparency = 0\nEnd With\n</code></pre>\n\n<p>with</p>\n\n<pre><code>.Border.LineStyle = xlContinuous\n.Border.Color = 9851952\n.Format.Line.Weight = 0.5\n</code></pre>\n\n<p>Please don't ask me why <code>.Format.Line.Weight</code> still applies to the border, at least I got it working. Big props to the people who'd written <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/99847-weight-of-border-on-a-column-chart-in-vba\" rel=\"nofollow noreferrer\">the thread where I found the answer on Ozgrid forums</a>.</p>\n"}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 51701451, "answer_count": 1, "score": 0, "last_activity_date": 1533562424, "creation_date": 1533127203, "question_id": 51633531, "link": "https://stackoverflow.com/questions/51633531/adding-border-to-series-in-a-bar-chart", "title": "Adding border to series in a bar chart", "body": "<p>I am using a macro to insert a chart into a spreadsheet:</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\n    Dim overskrifter As Range\n    Dim i As Long\n    Dim h\u00f8gde As Long, breidde As Long\n\n    Call fjernkurver\n\n    i = 1\n    h\u00f8gde = 240: breidde = 350\n    Set overskrifter = Oppsummering.Range(\"C5:L5\")\n\n    With Kurver.Shapes.AddChart2(201, xlColumnClustered)\n        .Name = \"Graf_\" &amp; i\n        With .Chart.SeriesCollection.NewSeries\n            .XValues = overskrifter\n            .Values = overskrifter.Offset(i, 0)\n            .Name = Oppsummering.Range(\"B5\").Offset(i, 0)\n            ' \"Olive\"\n            .Points(1).Format.Fill.ForeColor.RGB = RGB(128, 128, 0)\n            ' \"Dark khaki\"\n            .Points(8).Format.Fill.ForeColor.RGB = RGB(189, 183, 107)\n            ' Green (Atlantis)\n            .Points(9).Format.Fill.ForeColor.RGB = RGB(146, 208, 80)\n            With .Format.Line\n                .Visible = msoTrue\n                .Weight = 0.5\n                '.ForeColor.RGB = RGB(0, 0, 205)\n                .ForeColor.RGB = RGB(255, 0, 0)\n                .Transparency = 0\n            End With\n        End With\n        .Height = h\u00f8gde\n        .Width = breidde\n        .Top = 5 + ((i - 1) \\ 3) * (5 + h\u00f8gde)\n        .Left = 5 + ((i - 1) Mod 3) * (5 + breidde)\n        .Chart.HasTitle = True\n        .Chart.ChartGroups(1).GapWidth = 150\n        .Chart.ChartGroups(1).Overlap = 0\n    End With\nEnd Sub\n\nSub fjernkurver()\n    Dim co As ChartObject\n\n    For Each co In Kurver.ChartObjects\n        co.Delete\n    Next co\nEnd Sub\n</code></pre>\n\n<p>For the most part it works fine, but I am having some issues with this part of the code:</p>\n\n<pre><code>        With .Format.Line\n            .Visible = msoTrue\n            .Weight = 0.5\n            '.ForeColor.RGB = RGB(0, 0, 205)\n            .ForeColor.RGB = RGB(255, 0, 0)\n            .Transparency = 0\n        End With\n</code></pre>\n\n<p>It is supposed to add a border around all the bars in the graph, red with RGB(255,0,0), blue with RGB(0,0,255).</p>\n\n<p>However, as far as I can tell, no border is added to any of the bars. Can someone please point out where I am going wrong here?</p>\n\n<p>The chart ends up looking like this:\n<a href=\"https://i.stack.imgur.com/AFMCx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AFMCx.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9897600, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/9897600/jonathan"}, "edited": false, "score": 1, "creation_date": 1533126985, "post_id": 51633063, "comment_id": 90231050, "body": "Thanks so much! The iRow for loop works much more efficiently than the loop I was using."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1533126080, "last_edit_date": 1533126080, "creation_date": 1533125674, "answer_id": 51633063, "question_id": 51632995, "link": "https://stackoverflow.com/questions/51632995/inserting-page-break-with-vba/51633063#51633063", "title": "Inserting Page Break With VBA", "body": "<p>You can add page breaks like this:</p>\n\n<pre><code>Worksheets(\"Sheet1\").HPageBreaks.Add Before:=Worksheets(\"Sheet1\").Rows(25)\nWorksheets(\"Sheet1\").VPageBreaks.Add Before:=Worksheets(\"Sheet1\").Columns(\"J\")\n\nWorksheets(\"Sheet1\").Rows(25).PageBreak = xlPageBreakManual\nWorksheets(\"Sheet1\").Columns(\"J\").PageBreak = xlPageBreakManual\n</code></pre>\n\n<p>And to get every 8\u1d57\u02b0 row after row 10 use a loop like</p>\n\n<pre><code>Dim iRow As Long\nFor iRow = 10 To LastRow Step 8\n    'your page break code here\nNext iRow\n</code></pre>\n\n<p>where <code>LastRow</code> is the last used row eg like</p>\n\n<pre><code>Dim LastRow As Long\nLastRow = Worksheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row 'find last used row in column A\n</code></pre>\n\n<hr>\n\n<p>So something like this would be a possible result:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddPageBreaks()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\") \n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row 'find last used row in column A\n\n    Dim iRow As Long\n    For iRow = 10 To LastRow Step 8\n        ws.HPageBreaks.Add Before:=ws.Rows(iRow)\n        ws.Rows(iRow).PageBreak = xlPageBreakManual\n    Next iRow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9897600, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/9897600/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8540, "favorite_count": 1, "accepted_answer_id": 51633063, "answer_count": 1, "score": 1, "last_activity_date": 1533126080, "creation_date": 1533125472, "question_id": 51632995, "link": "https://stackoverflow.com/questions/51632995/inserting-page-break-with-vba", "title": "Inserting Page Break With VBA", "body": "<p>I'm trying to insert page breaks that will allow every 8 rows of the excel sheet to be printed. The problem that I am having is that when using the \"ActiveWindow.View = xlPageBreakPreview\" method, the first page break occurs after row 10, and then from there on out, occurs every 8 rows. Here is the code that I am currently using:</p>\n\n<pre><code>ActiveSheet.ResetAllPageBreaks\nActiveWindow.View = xlPageBreakPreview\nActiveSheet.VPageBreaks(2).DragOff Direction:=xlToRight, RegionIndex:=1\nActiveSheet.VPageBreaks(1).DragOff Direction:=xlToRight, RegionIndex:=1\n\nWith ActiveSheet.PageSetup\n    .CenterHeader = \"&amp;\"\"Chiller\"\"&amp;75WOC\"\n    .CenterFooter = \"&amp;\"\"Chiller\"\"&amp;75 PLACARD\"\n    .PrintQuality = 600\n    .CenterHorizontally = True\n    .CenterVertically = True\n    .Orientation = xlLandscape\n    .PaperSize = xlPaperLetter\n    .Zoom = 45\n    .LeftMargin = Application.InchesToPoints(0)\n    .RightMargin = Application.InchesToPoints(0)\n    .TopMargin = Application.InchesToPoints(0.75)\n    .BottomMargin = Application.InchesToPoints(0.75)\n    .HeaderMargin = Application.InchesToPoints(0.3)\n    .FooterMargin = Application.InchesToPoints(0.3)\nEnd With\n</code></pre>\n\n<p>I tried adding this loop to manually add the page break, but it bogged the code way down, so I was wondering if there is a simpler solution that I am not aware of.</p>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8161317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/024ea94d9e00aabf3ff91dce2bf38291?s=128&d=identicon&r=PG&f=1", "display_name": "M.I.", "link": "https://stackoverflow.com/users/8161317/m-i"}, "edited": false, "score": 0, "creation_date": 1533127552, "post_id": 51632620, "comment_id": 90231465, "body": "Thank you very very much! This helped and worked perfectly!"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1533125156, "last_edit_date": 1533125156, "creation_date": 1533124372, "answer_id": 51632620, "question_id": 51632112, "link": "https://stackoverflow.com/questions/51632112/formular1c1-application-worksheetfunction-countifs-arguments-not-working/51632620#51632620", "title": ".FormulaR1C1 = Application.WorksheetFunction.CountIfs Arguments not working", "body": "<pre><code>Cells(r, 6).FormulaR1C1 = _\nApplication.WorksheetFunction.CountIfs(Q1, RrC5, OrgRange, RrC1, LocRange, RrC2)\n</code></pre>\n\n<p>This is quite a mess. You're attempting to load a formula with the <strong><em>result</em></strong> of a worksheet function.</p>\n\n<hr>\n\n<p>If you want to load the formula to the cell then I'd do this:</p>\n\n<pre><code>Cells(r, 6).Formula = \"=CountIfs(\" &amp; Q1.Address &amp; \", \" &amp; _\n  Cells(r, 5).Address &amp; \", \" &amp; OrgRange.Address &amp; \", \" &amp; _\n  Cells(r, 1).Address &amp; \", \" &amp; LocRange.Address &amp; \", \" &amp; _\n  Cells(r, 2).Address &amp; \")\"\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>Cells(r, 6).Formula = .Formula = \"=CountIfs(\" &amp; _\n       Q1.Address &amp; \", E\" &amp; r &amp; \", \" &amp; _\n OrgRange.Address &amp; \", A\" &amp; r &amp; \", \" &amp; _\n LocRange.Address &amp; \", B\" &amp; r &amp; \")\"\n</code></pre>\n\n<hr>\n\n<p>However, if you want the formula evaluated and just the result dumped in the cell..</p>\n\n<pre><code>Cells(r, 6).Value = Application.WorksheetFunction.CountIfs(Q1, _\n    Cells(R, 5), OrgRange, Cells(R, 1), LocRange, Cells(R, 2))\n</code></pre>\n\n<hr>\n\n<p>Keep in mind though with all of these options, <code>Cells(..</code> are not fully qualified. </p>\n\n<p>Changing all to <code>.Cells(..</code> would make this much better, wrapping the lot \nin a </p>\n\n<p><code>With WorkSheet(\"DESTINATION_SHEET\") \n ...\n ...\n End With</code> </p>\n\n<p>is highly advisable.</p>\n"}], "owner": {"reputation": 37, "user_id": 8161317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/024ea94d9e00aabf3ff91dce2bf38291?s=128&d=identicon&r=PG&f=1", "display_name": "M.I.", "link": "https://stackoverflow.com/users/8161317/m-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 51632620, "answer_count": 1, "score": 0, "last_activity_date": 1593770139, "creation_date": 1533122864, "last_edit_date": 1593770139, "question_id": 51632112, "link": "https://stackoverflow.com/questions/51632112/formular1c1-application-worksheetfunction-countifs-arguments-not-working", "title": ".FormulaR1C1 = Application.WorksheetFunction.CountIfs Arguments not working", "body": "<p>I'm trying to use a countifs statement by looking in the first 2 columns and comparing them to another table in the same Wokbook. The reference RrC1, RC1 or anything else does not work. I only get &quot;0&quot; as a result. If i type in constants it works. I'm sure that my arguments 2, 4, 6 are the problem. I just can' figure out why!</p>\n<pre><code>Sub DataBase()\n\n'Set my tables\n    Dim Answers As ListObject\n    Dim Table As ListObject\n    Set Answers = Worksheets(&quot;quantitativ&quot;).ListObjects(&quot;DataQuant&quot;)\n    Set Table = Worksheets(&quot;Database&quot;).ListObjects(&quot;Tabelle7&quot;)\n\n'Set my Ranges for filters (Organizational level, Location, Function...)\n    \n    Set OrgRange = Answers.ListColumns(1).Range\n    Set LocRange = Answers.ListColumns(2).Range\n\n'Set Ranges for Answers to Questions (Scale)\nSet Q1 = Answers.ListColumns(5).Range\n\nDim r As Long    'Row variables for For-Loop\n\n    For r = 5 To Table.DataBodyRange.Rows.Count + 4\n      \n        'Q1\n        Cells(r, 6).FormulaR1C1 = _\n            Application.WorksheetFunction.CountIfs(Q1, RrC5, OrgRange, RrC1, LocRange, RrC2)\n    \n    Next r\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "do-while"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533123119, "post_id": 51632077, "comment_id": 90228473, "body": "So, you just need to loop through all the <code>.XLS</code> files in a given folder, is that correct?"}, {"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533123451, "post_id": 51632077, "comment_id": 90228692, "body": "@ashleedawg yep that&#39;s correct. Usually sFil = Dir should suffice by itself but for some reason here I&#39;m required to specify the path.."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "edited": false, "score": 0, "creation_date": 1533124272, "post_id": 51632297, "comment_id": 90229240, "body": "Thanks for your help Ashleedawg. Unfortunately the line fName = Dir  throws the error &#39;Calling invalid procedure&#39;. Any idea why it may do so?"}, {"owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "edited": false, "score": 0, "creation_date": 1533126997, "post_id": 51632297, "comment_id": 90231060, "body": "I am not entirely sure but I think you need a reference to the Microsoft ScriptingRuntime. Here&#39;s a link how to do that: <a href=\"https://www.datanumen.com/blogs/add-object-library-reference-vba/\" rel=\"nofollow noreferrer\">datanumen.com/blogs/add-object-library-reference-vba</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1618477538, "post_id": 51632297, "comment_id": 118614707, "body": "It shouldn&#39;t require a reference but, for reasons unknown to me, I sometimes need brackets after the command, like <code>Dir()</code>.  Currently it works for me either way but I&#39;ll update the answer anyway."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1618477553, "last_edit_date": 1618477553, "creation_date": 1533123457, "answer_id": 51632297, "question_id": 51632077, "link": "https://stackoverflow.com/questions/51632077/loop-does-not-move-to-next-file/51632297#51632297", "title": "Loop does not move to next file", "body": "<p>Here is a basic way to loop through all Excel files within a given folder:</p>\n<pre><code>Sub LoopExcelFiles()\n    Const xlsPath = &quot;x:\\ExcelTests&quot;\n    Dim fName As String\n    fName = Dir(xlsPath &amp; &quot;\\*.xl*&quot;) 'Find the first file\n    \n    Do While fName &lt;&gt; &quot;&quot; 'keep looping until file isn't found\n    \n        'do &quot;whatever you gotta do&quot; with each file here:\n        Debug.Print &quot;Folder:&quot; &amp; xlsPath, &quot;Filename: &quot; &amp; fName\n        \n        fName = Dir() 'Find the next file (same criteria)\n    Loop    \nEnd Sub\n</code></pre>\n<p>Here is <a href=\"https://msdn.microsoft.com/vba/language-reference-vba/articles/dir-function\" rel=\"nofollow noreferrer\">more on <strong>the <code>Dir</code> function</strong></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6360129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e36abb4ef39732d9906de151a11d229?s=128&d=identicon&r=PG&f=1", "display_name": "Korpo", "link": "https://stackoverflow.com/users/6360129/korpo"}, "is_accepted": false, "score": 0, "last_activity_date": 1533128296, "creation_date": 1533128296, "answer_id": 51633911, "question_id": 51632077, "link": "https://stackoverflow.com/questions/51632077/loop-does-not-move-to-next-file/51633911#51633911", "title": "Loop does not move to next file", "body": "<p>Different approach to loop through files I use.</p>\n\n<p>Please note you need to check <a href=\"https://i.stack.imgur.com/Rmfyq.jpg\" rel=\"nofollow noreferrer\">Microsoft Scripting Runtime</a> in Tools>References</p>\n\n<pre><code>Sub find_reports()\n\nDim fname As String\n\n'Create an instance of the FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n'Get the folder\nstrPath = ThisWorkbook.Path\nfname = ThisWorkbook.Name\nSet objFolder = objFSO.GetFolder(strPath)\n\n'If the folder does not contain files, exit the sub\nIf objFolder.Files.Count = 0 Then\n    MsgBox \"No files in Folder\", vbExclamation\n    Exit Sub\nEnd If\n\n'Loop through each file in the folder\nFor Each objFile In objFolder.Files\n\n    Debug.Print \"Folder:\" &amp; strPath, \"Filename: \" &amp; fname\n\nNext objFile\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9827636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GCoxxx", "link": "https://stackoverflow.com/users/9827636/gcoxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1618477553, "creation_date": 1533122693, "question_id": 51632077, "link": "https://stackoverflow.com/questions/51632077/loop-does-not-move-to-next-file", "title": "Loop does not move to next file", "body": "<p>I have an issue with the below code. It seems to work fine but apparently it is not able to move to the next file in the directory given; it gets in fact stuck to the first file, and it reopens it, without being able to move on to the next one. Any help super appreciated!</p>\n\n<pre><code>Sub Cash_Line_Check(strTargetPath)\n\nDim i As Long\nDim sPath As String\nDim sFil As String\nDim FolderPath As String\nDim diaFolder As FileDialog\nDim CurrReturnColumn As Range, TotReturnColumn As Range, VarTotReturnColumn As Range, CashRow As Range\nDim oWbk As Workbook\n\n'Open the file dialog\nSet diaFolder = Application.FileDialog(msoFileDialogFolderPicker)\n    diaFolder.AllowMultiSelect = False\n    diaFolder.InitialFileName = strTargetPath\n    diaFolder.Show\n    FolderPath = diaFolder.SelectedItems(1)\n\n   'Without wanting to use the promp, use the below line:\n   'FolderPath = strTargetFolder\n\n 'Cycle through spreadsheets in selected folder\n\n  sPath = FolderPath &amp; \"\\\" 'location of files\n\n  sFil = Dir(sPath &amp; \"*.xls\") 'change or add formats\n  Do While sFil &lt;&gt; \"\" 'will start LOOP until all files in folder sPath have been looped through\n\n   sFilTop20 = Dir(sPath &amp; \"TOP20\" &amp; \"*.xls\")\n   If (Len(sFilTop20) &gt; 0) Then GoTo loopline\n\n    Set oWbk = Workbooks.Open(sPath &amp; \"\\\" &amp; sFil) 'opens the file\n    i = 1 'Selects the sheet to be analysed'\n\n   'Perform Check and Record those funds adjusted\n    With oWbk.Worksheets(i)\n\n    Set CurrReturnColumn = .UsedRange.Find(\"Currency\", , xlValues, xlWhole, xlByColumns)\n    Set TotReturnColumn = .UsedRange.Find(\"Portfolio\", , xlValues, xlWhole, xlByColumns) 'Looks by columns\n    Set VarTotReturnColumn = .UsedRange.Find(\"Variation\", , xlValues, xlWhole, xlByRows) 'Looks by rows\n    Set CashRow = .UsedRange.Find(\"[Cash]\", , xlValues, xlWhole, xlByRows)\n\n    If .Cells(CashRow.Row, CurrReturnColumn.Column) &gt; 0.1 Or .Cells(CashRow.Row, CurrReturnColumn.Column) &lt; -0.1 Then\n       .Cells(CashRow.Row, CurrReturnColumn.Column).Value = \"-\"\n    End If\n\n    If .Cells(CashRow.Row, TotReturnColumn.Column) &gt; 0.1 Or .Cells(CashRow.Row, CurrReturnColumn.Column) &lt; -0.1 Then\n       .Cells(CashRow.Row, TotReturnColumn.Column).Value = \"-\"\n    End If\n\n    If .Cells(CashRow.Row, VarTotReturnColumn.Column) &gt; 0.1 Or .Cells(CashRow.Row, CurrReturnColumn.Column) &lt; -0.1 Then\n       .Cells(CashRow.Row, VarTotReturnColumn.Column).Value = \"-\"\n    End If\n\n    End With\n\n    oWbk.Close True\n\n  sFil = Dir(sPath)\n\nloopline:\n Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "loops"], "comments": [{"owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "edited": false, "score": 1, "creation_date": 1533124451, "post_id": 51632037, "comment_id": 90229346, "body": "&quot;I would like to prevent making 76 different If/ElseIf statements&quot; &lt;-- IMHO, since declaring <code>100 int variables</code> vs <code>1 int array with 100 elements</code> works the same. I suggest to proceed with the 76 if/else statements where the confidence in there. | I normally use excel <code>with concatenate()</code> to produce the case then combine it as a formula/code using notepad++ / notepad. | I personally said this coz it works great for me.  ( :"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1533124512, "post_id": 51632037, "comment_id": 90229382, "body": "Why not use a 2 x 76 array for <code>SearchString</code> and <code>SearchStringCntr</code> and loop through that for your search? also, where is <code>DataArray</code> populated and where do you use <code>DataRange</code>?"}, {"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1533124801, "post_id": 51632037, "comment_id": 90229547, "body": "@cybernetic.nomad Corrected the code,    DataRange was the old name, replaced it with    DataArray. the array is populated in the 9th line of the code, filling it with data from the sheet. I didn&#39;t think about the 2x76 array solution, I&#39;m gonna go ahead and try that solution. Will update if it works."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533125144, "post_id": 51632037, "comment_id": 90229780, "body": "Are you just trying to count the occurrences of a string within an array?"}, {"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533125417, "post_id": 51632037, "comment_id": 90229951, "body": "@ashleedawg sorta. I need to know how many occurrences of a string exist in an large data file, which has been loaded into an array. Then using that value I need to make a couple of calculations (see the first code box lines 8-13). And this needs to be done for 76 strings in total."}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "edited": false, "score": 0, "creation_date": 1533126766, "post_id": 51633112, "comment_id": 90230889, "body": "Tried it, tweaked it an got it working. Significant speed improvement when comparing to my previous code. All in all precisely what I was looking for :)"}], "tags": [], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "is_accepted": true, "score": 1, "last_activity_date": 1533125824, "creation_date": 1533125824, "answer_id": 51633112, "question_id": 51632037, "link": "https://stackoverflow.com/questions/51632037/increment-different-counters-depending-on-array-index-value/51633112#51633112", "title": "Increment different counters depending on array index value", "body": "<p>Maybe this will help (might need some adjustments).<BR>\nCreate named range \"Strings\" somewhere in your workbook where you'll store all your strings that you're looking for </p>\n\n<pre><code>Option Explicit\n\nSub StringsCompare()\n\n    Dim LastRow1 As Long\n    Dim DataArray() As Variant, StringArray() As Variant\n    Dim Ws2 As Worksheet\n    Dim CompareStringsNo As Long, StringCounter As Long\n    Dim i As Long, j As Long\n    Dim aCell As Range\n    Dim SourceStr As String, SearchStr As String\n\n    Set Ws2 = ThisWorkbook.Sheets(\"Sheet1\")\n    StringCounter = 1\n\n    With Ws2\n        'fill array with your strings to compare\n        CompareStringsNo = .Range(\"Strings\").Rows.Count\n        ReDim StringArray(1 To CompareStringsNo, 1 To 2)\n        For Each aCell In .Range(\"Strings\")\n            StringArray(StringCounter, 1) = aCell.Value\n            StringCounter = StringCounter + 1\n        Next aCell\n\n        'fill data array\n        LastRow1 = .Cells.Find(What:=\"*\", After:=.Range(\"A1\"), LookAt:=xlPart, LookIn:=xlFormulas, _\n            SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row 'Gets the total row amount in the sheet\n        DataArray = .Range(\"A1:E\" &amp; LastRow1)\n    End With\n\n    'search data array\n    For i = LBound(DataArray, 1) To UBound(DataArray, 1)\n        SourceStr = DataArray(i, 5)\n        'search array with your strings\n        For j = LBound(StringArray) To UBound(StringArray)\n            SearchStr = StringArray(j, 1)\n            If InStr(1, SourceStr, SearchStr) &gt; 0 Then\n                'if match is found increase counter in array\n                StringArray(j, 2) = StringArray(j, 2) + 1\n                'you can add exit for here if you want only first match\n            End If\n        Next j\n    Next i\n\n    For i = LBound(StringArray) To UBound(StringArray)\n        Debug.Print StringArray(i, 1) &amp; \" - \" &amp; StringArray(i, 2)\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "edited": false, "score": 0, "creation_date": 1533126963, "post_id": 51633148, "comment_id": 90231036, "body": "Definitely seems like a solid approach. I&#39;m gonna and test it. I&#39;m a bit concerned about the length of the string via the Join command. Some strings can occur up to 30.000 times in the MainDump so I&#39;m curious to see the impact on performance. Have to say it is a elegant and intuitive approach ^^"}, {"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "edited": false, "score": 0, "creation_date": 1533127505, "post_id": 51633148, "comment_id": 90231429, "body": "Just implemented and tested it. I get an error message : &quot;Run-Time error &#39; 5&#39;: Invalid procedure call or argument&quot; on the line: strArr = Join(theArray, &quot; &quot;). Maybe because DataArray is a 2D array instead of a 1D array?"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1533126333, "last_edit_date": 1533126333, "creation_date": 1533125915, "answer_id": 51633148, "question_id": 51632037, "link": "https://stackoverflow.com/questions/51632037/increment-different-counters-depending-on-array-index-value/51633148#51633148", "title": "Increment different counters depending on array index value", "body": "<p>I think the main task is being over-complicated.</p>\n\n<p>To check how many times a string occurs within an array you could use a function like this:</p>\n\n<pre><code>Function OccurWithinArray(theArray As Variant, stringToCount As String) As Long\n    Dim strArr As String\n    strArr = Join(theArray, \" \")\n    OccurWithinArray = (Len(strArr) - Len(Replace(strArr, stringToCount, _\n        vbNullString, , , vbTextCompare))) / Len(stringToCount)\nEnd Function\n</code></pre>\n\n<p>...and a demonstration:</p>\n\n<pre><code>Sub Demo()\n    Dim test(1 To 3) As String\n    test(1) = \"I work at the Dog Pound.\"\n    test(2) = \"I eat dogfish regularly.\"\n    test(3) = \"Steroidogenesis is a thing.\"\n    Debug.Print OccurWithinArray(test, \"dog\")\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>How it works</strong>:</p>\n\n<p><code>Join</code> joins all the elements of the array into one big string.\n<code>Len</code> returns the length of the text.<br>\n<code>Replace</code> temporarily replaces the removes all occurrences of the search term.<br>\n<code>Len</code> returns the \"modified\" length of the text.<br>\nThe difference between the two <code>Len</code>'s, divided by the length of the string being searched for, is the number aof occurrences of the string within the entire array.  </p>\n\n<hr>\n\n<p>This returns <code>3</code> since the search is case-<strong>in</strong>sensitive. </p>\n\n<p>To make the search case-sensitive, remove the word  <code>vbTextCompare</code> (in which case this example would return <code>2</code>.)</p>\n"}], "owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51633112, "answer_count": 2, "score": 0, "last_activity_date": 1533126333, "creation_date": 1533122545, "last_edit_date": 1533124581, "question_id": 51632037, "link": "https://stackoverflow.com/questions/51632037/increment-different-counters-depending-on-array-index-value", "title": "Increment different counters depending on array index value", "body": "<p>I have a vast list of data in a worksheet (called <code>MainDump</code>). I have a procedure set up to assess this list and return certain values using the following setup:</p>\n\n<pre><code>Dim ws1 As Worksheet\nSet ws1 = Worksheets(\"DashBoard\")\nDim ws2 As Worksheet\nSet ws2 = Worksheets(\"MainDump\")\nDim cntr As Long\n\nOn Error GoTo ErrorHandler 'Got A lot of divide by zero errors if searchstring wasn't found\nWith Application.WorksheetFunction            \n    ws1.Range(\"O4\").Value = .CountIf(ws2.Range(\"E:E\"), \"*\" &amp; \"CEOD\" &amp; \"*\")\n    ws1.Range(\"L4\").Value = .CountIfs(ws2.Range(\"E:E\"), \"*\" &amp; \"CEOD\" &amp; \"*\", ws2.Range(\"A:A\"), \"Yes\") / ws1.Range(\"O4\").Value\n    ws1.Range(\"M4\").Value = .CountIfs(ws2.Range(\"E:E\"), \"*\" &amp; \"CEOD\" &amp; \"*\", ws2.Range(\"B:B\"), \"Yes\") / ws1.Range(\"O4\").Value\n    ws1.Range(\"N4\").Value = .CountIfs(ws2.Range(\"E:E\"), \"*\" &amp; \"CEOD\" &amp; \"*\", ws2.Range(\"C:C\"), \"SA Present, WBDA Present\") / ws1.Range(\"O4\").Value\nEnd With\ncntr = cntr + 1        \n'^This proces is then copied and thus repeated a total of 76 times, as I want to check \n'for 76 different values in ws2.Range(\"E:E\"), resulting in a massive code\n\nErrorHandler:\nIf Err.Number = 6 Then\n    If ws1.Range(\"O\" &amp; cntr).Value = 0 Then\n        ws1.Range(\"L\" &amp; cntr).Value = \"div. by zero\"\n        ws1.Range(\"M\" &amp; cntr).Value = \"div. by zero\"\n        ws1.Range(\"N\" &amp; cntr).Value = \"div. by zero\"\n    End If\nEnd If\nResume Next\n</code></pre>\n\n<p>I wrote this when I was a lot less experienced in VBA. Needless to say this code takes a lot of time to complete (<code>Maindump</code> counts about 98000 rows).\nSo I wanted to try do this work via an array. </p>\n\n<p>My approach would be to define a counter for each string I want to check in the array indexes and then looping through the array and increment the corresponding counters when a string is found in the Array. My question is if there is a way to write that loop in the following form:</p>\n\n<pre><code>Dim LastRow1 As long\nDim DataArray() As Variant\nDim SearchString1, SearchString2, .... SearchString76 As String\nDim SearchString1Cntr, SearchString2Cntr, .... SearchString76Cntr As long\n\nWith ws2\n    LastRow1 = .Cells.Find(What:=\"*\", After:=.Range(\"A1\"), LookAt:=xlPart, LookIn:=xlFormulas, _\n        SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row 'Gets the total row amount in the sheet\n    DataArray = .Range(\"A3:E\" &amp; LastRow1) 'puts selected range in Array\nEnd With\n\nFor LastRow1 = Lbound(DataArray, 1) to Ubound(DataArray, 1)\n    'Start a For Each loop to check for all 76 strings\n    If Instr(1, DataArray(LastRow1, 5), SearchString &gt; 0 Then 'SearchString is found so then\n        SearchStringCntr1 = SearchStringcntr1 + 1 \n'Where SearchStrinCntr1 is the counter related to the string checked for in the loop, \n'so it switches when the SearchString changes\n    End If\n   'Next SearchString to check\nNext LastRow1\n</code></pre>\n\n<p>So I want to try and use a flexible If statement in a For Next loop which checks the Array index for each SearchString and then increments the corresponding SearchStringCntr if the SearchString is found in the index, before looping to the next index. Is this possible? I would like to prevent  making 76 different If/ElseIf statements for each SearchString + StringCntr and then use a counter to loop through them every time the code loops through the For LastRow1 / Next LastRow1 loop. Would love to hear your input.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9319464, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214236721452599/picture?type=large", "display_name": "Eduardo Santiago", "link": "https://stackoverflow.com/users/9319464/eduardo-santiago"}, "edited": false, "score": 0, "creation_date": 1533126994, "post_id": 51632960, "comment_id": 90231056, "body": "Hi Amol. I got the following error message: &quot;Object doesn&#39;t support this property or method&quot;. It seems not to work on Excel VBA but works fine when creating macros within MS Word"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 43, "user_id": 9319464, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214236721452599/picture?type=large", "display_name": "Eduardo Santiago", "link": "https://stackoverflow.com/users/9319464/eduardo-santiago"}, "edited": false, "score": 1, "creation_date": 1533128251, "post_id": 51632960, "comment_id": 90231945, "body": "@EduardoSantiago If it works in MS Word, but not Excel; I would look more into what type of binding you&#39;re using (early or late) and make sure that your code is consistent for the binding-method used. (Early binding will only work on other computers with same builds; late binding does not allow cross-use of defined constants, and does not support intellisense.)"}, {"owner": {"reputation": 43, "user_id": 9319464, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214236721452599/picture?type=large", "display_name": "Eduardo Santiago", "link": "https://stackoverflow.com/users/9319464/eduardo-santiago"}, "edited": false, "score": 0, "creation_date": 1533130903, "post_id": 51632960, "comment_id": 90233934, "body": "Hi Mistella, I&#39;m using late binding. Do you have any suggestion?"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "reply_to_user": {"reputation": 43, "user_id": 9319464, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214236721452599/picture?type=large", "display_name": "Eduardo Santiago", "link": "https://stackoverflow.com/users/9319464/eduardo-santiago"}, "edited": false, "score": 0, "creation_date": 1533135229, "post_id": 51632960, "comment_id": 90237149, "body": "@EduardoSantiago: in that case you have to ensure that <code>wDoc</code> refers to an object in MS Word... so it might be <code>With objWordApp.wDoc ...</code>"}], "tags": [], "owner": {"reputation": 21, "user_id": 4461672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c966aaee10c64c88ff92a3b2d4e767a?s=128&d=identicon&r=PG&f=1", "display_name": "Amol Gargote", "link": "https://stackoverflow.com/users/4461672/amol-gargote"}, "is_accepted": false, "score": 2, "last_activity_date": 1533125380, "creation_date": 1533125380, "answer_id": 51632960, "question_id": 51631974, "link": "https://stackoverflow.com/questions/51631974/how-do-delete-an-specific-page-in-a-word-document-using-excel-vba/51632960#51632960", "title": "How do delete an specific page in a word document using Excel VBA?", "body": "<p>Check below code. I have removed quotes from name parameter here (replaced \"20\" with 20)\nYou can use your document reference wDoc instead of Activedocument that I have used.</p>\n\n<pre><code>With ActiveDocument\n    .GoTo What:=wdGoToPage, Which:=wdGoToAbsolute, Name:=20 'Page number\n    .Bookmarks(\"\\Page\").Select\n    With Selection\n      .Delete\n    End With\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 9561828, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MOicCSJuS7c/AAAAAAAAAAI/AAAAAAAABVk/r8u9qCtvbPk/photo.jpg?sz=128", "display_name": "Gajendra Santosh", "link": "https://stackoverflow.com/users/9561828/gajendra-santosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1568364935, "creation_date": 1568364935, "answer_id": 57920356, "question_id": 51631974, "link": "https://stackoverflow.com/questions/51631974/how-do-delete-an-specific-page-in-a-word-document-using-excel-vba/57920356#57920356", "title": "How do delete an specific page in a word document using Excel VBA?", "body": "<pre><code>With wdDoc\n    Lr = .Goto(wdGoToPage, wdGoToLast).Start\n    .Range(Lr - 1, wdDoc.Range.End).Delete\nEnd with\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>wdDoc.Range(wdDoc.Goto(wdGoToPage, wdGoToLast).Start - 1, wdDoc.Range.End).Delete\n</code></pre>\n\n<p>It will find the last Character/Rage and Delete</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13505331, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f6c3cbe05d9a3c989d4b35cf74ef1e5d?s=128&d=identicon&r=PG", "display_name": "user13505331", "link": "https://stackoverflow.com/users/13505331/user13505331"}, "is_accepted": false, "score": 1, "last_activity_date": 1589026845, "creation_date": 1589026845, "answer_id": 61696621, "question_id": 51631974, "link": "https://stackoverflow.com/questions/51631974/how-do-delete-an-specific-page-in-a-word-document-using-excel-vba/61696621#61696621", "title": "How do delete an specific page in a word document using Excel VBA?", "body": "<p>Sometimes you need to keep deleting until the page itself is fully gone.</p>\n\n<pre><code>Sub DeletePage(iPageNumber As Integer)\n'\n' DeletePage Macro\n'\n\nWith ThisDocument\n    .GoTo(What:=wdGoToPage, name:=iPageNumber).Select\n    .Bookmarks(\"\\Page\").Range.Select\nEnd With\n\nSelection.Delete\n\n' keep deleting until page is gone\nDo\n    Selection.MoveLeft Extend:=wdExtend\n    Selection.Delete\n\nLoop Until Selection.Information(wdActiveEndAdjustedPageNumber) &lt; iPageNumber\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 43, "user_id": 9319464, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214236721452599/picture?type=large", "display_name": "Eduardo Santiago", "link": "https://stackoverflow.com/users/9319464/eduardo-santiago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2926, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1589026845, "creation_date": 1533122378, "last_edit_date": 1533135274, "question_id": 51631974, "link": "https://stackoverflow.com/questions/51631974/how-do-delete-an-specific-page-in-a-word-document-using-excel-vba", "title": "How do delete an specific page in a word document using Excel VBA?", "body": "<p>I'm using Excel VBA to create and populate a word document and I'd like to delete a specific page in that document. I tried the following approach for deleting:</p>\n\n<pre><code>With wDoc\n    .GoTo What:=wdGoToPage, Which:=wdGoToAbsolute, Name:=\"20\" 'Page number\n    .Bookmarks(\"\\Page\").Select\n    With Selection\n      .Delete\n    End With\nEnd With\n</code></pre>\n\n<p>This code doesn't return any error message on execution but the word page content isn't deleted as expected. What am I missing?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1533122768, "post_id": 51631888, "comment_id": 90228286, "body": "This is generally not a good coding practice I might add."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1533123151, "post_id": 51631888, "comment_id": 90228492, "body": "IFNA is much better if you&#39;re trapping failed VLOOKUPS for example."}, {"owner": {"reputation": 741, "user_id": 1883429, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8125327f24509bdcc2c97e68b6390650?s=128&d=identicon&r=PG", "display_name": "Dergyll", "link": "https://stackoverflow.com/users/1883429/dergyll"}, "edited": false, "score": 0, "creation_date": 1533123512, "post_id": 51631888, "comment_id": 90228729, "body": "Hi CLR, the VLOOKUPS Im working with returns &quot;0&quot; from blank cells, for example: 1 |   | 3 | getting VLOOKUP looks like:  1 | 0 | 3 |  Thank you for your answer, I think I understand how that particular bit of code works now."}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 3, "last_activity_date": 1533123044, "last_edit_date": 1533123044, "creation_date": 1533122728, "answer_id": 51632085, "question_id": 51631888, "link": "https://stackoverflow.com/questions/51631888/how-to-wrap-ifisblank-around-all-formulas/51632085#51632085", "title": "How to wrap IF(ISBLANK( around all formulas", "body": "<p><strong>ISBLANK</strong> doesn't work the same way as <strong>IF</strong>ERROR. It works in the same as <strong>IS</strong>ERROR. It merely returns a TRUE/FALSE. To make it work in a formula, you'd use this:</p>\n\n<pre><code>Sub Add_ISBLANK()\nDim R As Range\n\nFor Each R In Selection.SpecialCells(xlCellTypeFormulas)\n\n     If Left(R.Formula, 8) &lt;&gt; \"=ISBLANK\" Then\n          R.Formula = \"=IF(ISBLANK(\" &amp; Mid(R.Formula, 2) &amp; \"),\"\"\"\",\" &amp; Mid(R.Formula, 2) &amp; \")\"\n     End If\nNext R\n\nEnd Sub\n</code></pre>\n\n<p>From <code>=FORMULA</code>, it would produce <code>=IF(ISBLANK(FORMULA),\"\",FORMULA)</code></p>\n"}], "owner": {"reputation": 741, "user_id": 1883429, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8125327f24509bdcc2c97e68b6390650?s=128&d=identicon&r=PG", "display_name": "Dergyll", "link": "https://stackoverflow.com/users/1883429/dergyll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 51632085, "answer_count": 1, "score": 1, "last_activity_date": 1549386061, "creation_date": 1533122121, "last_edit_date": 1549386061, "question_id": 51631888, "link": "https://stackoverflow.com/questions/51631888/how-to-wrap-ifisblank-around-all-formulas", "title": "How to wrap IF(ISBLANK( around all formulas", "body": "<p>I found this VBA code on the internet. It wraps \"IFERROR\" around all the formulas.</p>\n\n<pre><code>Sub Add_IFERROR()\nDim R As Range\n\nFor Each R In Selection.SpecialCells(xlCellTypeFormulas)\n    If Left(R.Formula, 8) &lt;&gt; \"=IFERROR\" Then\n        R.Formula = \"=IFERROR(\" &amp; Mid(R.Formula, 2) &amp; \",\"\"\"\")\"\n    End If\nNext R\n\nEnd Sub\n</code></pre>\n\n<p>I attempted to modify it so it wraps an \"IF(ISBLANK(\" but get a compile error.</p>\n\n<p>Looking to display blank (nothing, \"\") if ISBLANK=TRUE, if FALSE then display whatever is in the cell.</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1533122232, "post_id": 51631674, "comment_id": 90227941, "body": "Can&#39;t you just compare <code>date_mov</code> with <code>data_last</code>? <b>If you have to format them</b>.. instead of formatting to short date, why not format to YYYYMMDD? This makes date comparison work."}], "answers": [{"tags": [], "owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "is_accepted": false, "score": 0, "last_activity_date": 1533127435, "last_edit_date": 1533127435, "creation_date": 1533123017, "answer_id": 51632157, "question_id": 51631674, "link": "https://stackoverflow.com/questions/51631674/compare-two-dates-in-dd-mm-yyyy-format/51632157#51632157", "title": "compare two dates in dd/mm/yyyy format", "body": "<blockquote>\n  <p>\"What is the correct way to test them?\"</p>\n</blockquote>\n\n<p>IMHO, there is more than one way.</p>\n\n<p><code>if()</code> with <code>value()</code> will be straightforward.</p>\n\n<p><code>if()</code> with <code>year()</code>,<code>month()</code>,<code>day()</code>, <code>hour()</code>.. is another.</p>\n\n<blockquote>\n  <p>\"Something like converting them into timestamps and then compare (but\n  is there something like the unixtimestamp in excel?)\"</p>\n</blockquote>\n\n<p>The easiest (for me) is using <code>value()</code> function . Then build the desired <code>if()</code> statement on it.</p>\n\n<p>Hope it helps. (:</p>\n\n<hr>\n\n<p>Microsoft Excel for Windows uses the 1900 date system, by default. Which means the first date is January 1, 1900. a <a href=\"https://support.office.com/en-us/article/date-function-e36c0c8c-4104-49da-ab83-82328b832349\" rel=\"nofollow noreferrer\">Date</a> and <a href=\"https://support.office.com/en-us/article/time-function-9a5aff99-8f7d-4611-845e-747d0b8d5457\" rel=\"nofollow noreferrer\">Time</a> function can be used to manipulate the year/date and time/hour/minutes values. The date/time in Excel is stored as a number. Where the decimal part range from 0.0 to 0.99988426 represent 0:00:00 (12:00:00 AM) to 23:59:59 (11:59:59 P.M.), and the integer part range from 0 to 9999 represent year 1900 to year 9999. </p>\n"}, {"tags": [], "owner": {"reputation": 228178, "user_id": 87015, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2f9b099fb455d3ddedb0bfa7430e51a9?s=128&d=identicon&r=PG&f=1", "display_name": "Salman A", "link": "https://stackoverflow.com/users/87015/salman-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1533125459, "creation_date": 1533125459, "answer_id": 51632988, "question_id": 51631674, "link": "https://stackoverflow.com/questions/51631674/compare-two-dates-in-dd-mm-yyyy-format/51632988#51632988", "title": "compare two dates in dd/mm/yyyy format", "body": "<p>You convert the strings to date and compare them:</p>\n\n<pre><code>' dd/mm/yyyy\n' 1234567890\n\nDim Date1: Date1 = DateSerial(Mid(data_mov, 7, 4), Mid(data_mov, 4, 2), Mid(data_mov, 1, 2))\nDim Date2: Date2 = DateSerial(Mid(data_last, 7, 4), Mid(data_last, 4, 2), Mid(data_last, 1, 2))\n\nIf Date1 &lt; Date2 Then\n    ' ...\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 5855, "user_id": 2399035, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MlRmQ.png?s=128&g=1", "display_name": "Lelio Faieta", "link": "https://stackoverflow.com/users/2399035/lelio-faieta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 51632988, "answer_count": 2, "score": 0, "last_activity_date": 1594211102, "creation_date": 1533121417, "last_edit_date": 1594211102, "question_id": 51631674, "link": "https://stackoverflow.com/questions/51631674/compare-two-dates-in-dd-mm-yyyy-format", "title": "compare two dates in dd/mm/yyyy format", "body": "<p>I have a column where I store dates as <code>dd/mm/yyyy</code>. Then I ask user to input in a form a new date (always as dd/mm/yyyy). I want to compare the input date to the last date that is in the excel already.</p>\n\n<pre><code>If Format(data_mov, \"Short Date\") &lt; Format(data_last, \"Short Date\") Then\n</code></pre>\n\n<p>is not the way to go since it will compare two strings and the test will fail since 03/10/2018 looks smaller than 23/09/2018.</p>\n\n<p>What is the correct way to test them? Something like converting them into timestamps and then compare (but is there something like the unixtimestamp in excel?)</p>\n"}, {"tags": ["vba", "ms-access", "ms-word", "office-interop"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1533122720, "post_id": 51631643, "comment_id": 90228259, "body": "It&#39;s best not to use <code>On Error Resume Next</code>... in general, but especially while troubleshooting a problem.  You&#39;re telling VBA is ignore all errors."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1533125960, "post_id": 51631643, "comment_id": 90230320, "body": "You don&#39;t provide enough information. What is <code>Me.</code>? Is it a Form?"}], "answers": [{"tags": [], "owner": {"reputation": 2502, "user_id": 1402935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v2lCw.jpg?s=128&g=1", "display_name": "sjy", "link": "https://stackoverflow.com/users/1402935/sjy"}, "is_accepted": false, "score": 0, "last_activity_date": 1533122746, "creation_date": 1533122746, "answer_id": 51632092, "question_id": 51631643, "link": "https://stackoverflow.com/questions/51631643/how-to-populate-word-fill-word-from-multiple-tables-using-access-vba/51632092#51632092", "title": "How to populate word/fill Word from multiple tables using Access VBA", "body": "<p>The data being inserted into the <code>txtInstitute</code> field in the Word document is <code>Me.Institute_Name</code>. <code>Me</code> refers to the context the VBA code is running in, which your question doesn't identify. However, the fact that you are getting primary keys in your Word document suggests that <code>Institute_Name</code> is the name of a column in the table bound to the current Access context, which contains a foreign key to an <code>Institutes</code> table.</p>\n\n<p>In Access, it might look like the <code>Institute_Field</code> column contains a name, not a primary key. Access calls this a <a href=\"https://support.office.com/en-us/article/create-a-lookup-field-87e84cbd-d60c-4473-8a98-3e391c42f239\" rel=\"nofollow noreferrer\">lookup field</a>. Lookup fields can be easier to understand than the traditional database concept, <a href=\"https://en.wikipedia.org/wiki/Foreign_key\" rel=\"nofollow noreferrer\">foreign keys</a>. But when you're working under the hood of a lookup field, eventually you need to understand the foreign key relationship that Access has been hiding from you.</p>\n\n<p>If the name you want is found in the <code>Name</code> column of the <code>Institutes</code> table, you can probably fix your code by changing that line to:</p>\n\n<pre><code>.FormFields(\"txtInstitute\").Result = DLookup(\"Name\", \"Institutes\", \"ID = \" &amp; Me.Institute_Name)\n</code></pre>\n\n<p>If you need to perform this procedure many times, you should be aware that it is inefficient because of the <a href=\"https://stackoverflow.com/questions/97197/what-is-the-n1-select-query-issue\">N+1 SELECT query issue</a>. The more efficient way to achieve this result is to ensure that <code>Me</code> is bound to a context, like a <a href=\"https://en.wikipedia.org/wiki/Join_(SQL)\" rel=\"nofollow noreferrer\">joined table</a>, which contains the data you want.</p>\n"}], "owner": {"reputation": 9, "user_id": 10165203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8qnc7EI2ywQ/AAAAAAAAAAI/AAAAAAAAAGc/dDIiDynb3k8/photo.jpg?sz=128", "display_name": "Motlatsi Motlhamme", "link": "https://stackoverflow.com/users/10165203/motlatsi-motlhamme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 452, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533122746, "creation_date": 1533121315, "last_edit_date": 1533122622, "question_id": 51631643, "link": "https://stackoverflow.com/questions/51631643/how-to-populate-word-fill-word-from-multiple-tables-using-access-vba", "title": "How to populate word/fill Word from multiple tables using Access VBA", "body": "<p>I'm an Access novice; I customized the code below. The problem is it prints the primary key instead of the name of the field referred to. </p>\n\n<p>For example, in one statement I want Institution Name to be printed in Word but instead it returns the primary key from a particula rinstitute in my table.</p>\n\n<blockquote>\n  <p><code>FormFields(\"txtNQFLevel\").Result = Me.NQFLLEVEL</code> I would like this field from another table but in the same query to return string values referred not its opposite primary key value   </p>\n  \n  <p><code>FormFields(\"txtInstitute\").Result = Me.Institute_Name</code> I would like this field which is from another table but in the same query to return string values referred not its opposite primary key value </p>\n</blockquote>\n\n<pre><code>Function BursaryContractYear2()\n    Dim appWord As Word.Application\n    Dim doc As Word.Document\n    Dim Path As String\n\n    On Error Resume Next\n    Error.Clear\n\n    Path = \"C:\\Users\\Motlatsi Motlhamme\\Desktop\\FillWordAccess.docx \"\n    Set appWord = GetObject(, \"Word.Application\")\n    If Err.Number &lt;&gt; 0 Then\n        Set appWord = New Word.Application\n        appWord.Visible = True\n    End If\n\n    Set doc = appWord.Documents.Open(Path, , True)\n    With doc\n        .FormFields(\"txtFirstName\").Result = Me.FIRST_NAMES\n        .FormFields(\"txtSurname\").Result = Me.SURNAME\n        .FormFields(\"txtNQFLevel\").Result = Me.NQFLLEVEL\n        .FormFields(\"txtInstitute\").Result = Me.Institute_Name\n        appWord.Visible = True\n        appWord.Activate\n    End With\n\n    Set doc = Nothing\n    Set appWord = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533135386, "post_id": 51631294, "comment_id": 90237270, "body": "what error are you getting? And where does the error or unexpected behaviour happen (what line)?"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533135469, "post_id": 51631294, "comment_id": 90237333, "body": "also, no need to <code>Select</code> the workbook, you could just reference it as <code>With Workbooks(&quot;Users\\Homes1\\cs010ea\\My Documents\\Team Performance Factors.xlsx&quot;).Sheets(LeagueName)</code> <b>so long as it is open</b>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533135616, "post_id": 51631294, "comment_id": 90237438, "body": "@ are you <b>sure</b> that this workbook <i>Users\\Homes1\\cs010ea\\My Documents\\Team Performance Factors.xlsx</i> has a worksheet called <b>LeageName</b>? Put a breakpoint on that line in the code (use F9) and run the macro then when it stops you can check the value in the Immediate Window (CTRL+G), with &quot;<code>?LeagueName</code>&quot;"}], "owner": {"reputation": 41, "user_id": 8837485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74b64a7fe2b76fcb7bcf886971503a4c?s=128&d=identicon&r=PG&f=1", "display_name": "elsarcher", "link": "https://stackoverflow.com/users/8837485/elsarcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1533120151, "creation_date": 1533120096, "last_edit_date": 1533120151, "question_id": 51631294, "link": "https://stackoverflow.com/questions/51631294/using-find-functions-loops-and-variable-worksheet-names", "title": "Using Find Functions, Loops and Variable Worksheet Names", "body": "<p>I'm currently writing a bit of code that I am going to use to remove some pesky volatile 'indirect' functions in my xl workbook. </p>\n\n<p>I have managed to write up as much code as I can but unfortunately I'm getting rather confused and need a bit of help to get me on the right track. </p>\n\n<p>In the following list I have made a summary of what I'm trying to achieve with this code; </p>\n\n<ul>\n<li>The current active sheet is the \"Input\" sheet in this workbook. </li>\n<li>Loop through A2:A1000 in the Input \"sheet\" and if the value = \"HT\" then do the following;\n\n<ol>\n<li>Set LeagueName = C(I) </li>\n<li>Set HomeTeam = D(I) </li>\n<li>Activate workbook \"Users\\Homes1\\cs010ea\\My Documents\\Team Performance Factors.xlsx\")</li>\n<li>Find the Sheet with the same name as the variable LeagueName </li>\n<li>Find the last occurring value equal to the HomeTeam variable in the column \"C:C\". Offset this to travel to the corresponding activerow cell in column K and copy that value. </li>\n<li>Return to the \"Input\" sheet in the previous workbook and pastespecial xlpastevalues in AO(I).</li>\n</ol></li>\n</ul>\n\n<p>LOOP </p>\n\n<p>I am aware this seems like a bit of a difficult task. I have done a lot of this code already I believe, however I am stuck on a few bits such as selecting a variable sheet name in another workbook! Here is my code; </p>\n\n<pre><code>    Sub TeamData()\n\n    Dim i As Range\n    Dim inputbook As Workbook\n    Dim C As Range\n    Dim HomeTeamRange As Range\n    Dim HomeTeam As Range\n    Dim HomeTeamValue As Range\n\n    Set inputbook = ThisWorkbook\n    Set TeamPerformance = Workbooks.Open(\"\\\\ad.nfumutual.co.uk\\Users\\Homes1\\cs010ea\\My Documents\\WhoScored Scraping\\Betting File\\Team Performance Factors.xlsx\")\n\n\n    For Each i In Range(\"A2:A1000\")\n    If i.Value2 = \"HT\" Then\n    Set LeagueName = Range(\"C\" &amp; (ActiveCell.Row))\n    Set HomeTeam = Range(\"D\" &amp; (ActiveCell.Row))\n    Workbooks(\"Users\\Homes1\\cs010ea\\My Documents\\Team Performance Factors.xlsx\").Sheets(LeagueName).Select\n\n\n    Set HomeTeamRange = Range(\"C:C\")\n    Set HomeTeamValue = HomeTeamRange.Find(what:=HomeTeam, after:=HomeTeamRange(1), searchdirection:=xlPrevious).Offset(0, 8).Copy\n    ThisWorkbook.Sheets(\"Input\").Range(\"AO\" &amp; (i)).PasteSpecial xlPasteValues\n\n  End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "is_accepted": false, "score": 1, "last_activity_date": 1533119711, "creation_date": 1533119711, "answer_id": 51631175, "question_id": 51631100, "link": "https://stackoverflow.com/questions/51631100/vba-vlookup-returns-values-stored-as-text/51631175#51631175", "title": "vba vlookup returns values stored as text", "body": "<p>Formatting was done wrong!\n<code>Format(Cells(i, j), \"Percent\")</code> doesn't seem right</p>\n\n<p>Replace <code>Cells(i, j) = Format(Cells(i, j), \"Percent\")</code> with <code>Cells(i, j).NumberFormat= \"0.00%\"</code></p>\n\n<p>Also make sure you set the value if the cell by <code>Cells(i, j).Value = wart</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10161142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfa6dd87b9f8c2742117a885f2147ff?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr S", "link": "https://stackoverflow.com/users/10161142/piotr-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533119711, "creation_date": 1533119472, "question_id": 51631100, "link": "https://stackoverflow.com/questions/51631100/vba-vlookup-returns-values-stored-as-text", "title": "vba vlookup returns values stored as text", "body": "<p>What is wrong with this code? When run it returns good values but their formatting is bad - values are stored as text</p>\n\n<pre><code>For i = 2 To nrow\nFor j = 2 To ncol\n    With Worksheets(j - 1)\n        Set rang= .Range(\"A:F\")\n        End With\n\nDim wart As Variant\nwart = Application.VLookup(Cells(i, 1), rang, 6, False)\nCells(i, j) = wart\nIf IsError(Cells(i, j)) Then Cells(i, j) = 0\nCells(i, j) = Format(Cells(i, j), \"Percent\")\n</code></pre>\n\n<p>When data type of     wart    is changed to Double - \"type mismatch\" error appears</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10132419, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NoBd6yhg8QY/AAAAAAAAAAI/AAAAAAAAACM/RvKkVNWRpRQ/photo.jpg?sz=128", "display_name": "Jalala.H13", "link": "https://stackoverflow.com/users/10132419/jalala-h13"}, "edited": false, "score": 0, "creation_date": 1533122256, "post_id": 51630910, "comment_id": 90227951, "body": "Thanks so much! I had been struggling with the If not ... Is Nothing Then but couldn&#39;t get it right!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1533118914, "creation_date": 1533118914, "answer_id": 51630910, "question_id": 51630835, "link": "https://stackoverflow.com/questions/51630835/vba-excel-delete-rows-based-on-values-in-column-and-move-on-if-its-empty/51630910#51630910", "title": "VBA Excel Delete rows based on values in column and move on if it&#39;s empty", "body": "<p>Change,</p>\n\n<pre><code>myRange.Select\n    Selection.Delete shift:=xlUp\n</code></pre>\n\n<p>... to,</p>\n\n<pre><code>If not myRange Is Nothing Then _\n    myRange.Delete shift:=xlUp\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10132419, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NoBd6yhg8QY/AAAAAAAAAAI/AAAAAAAAACM/RvKkVNWRpRQ/photo.jpg?sz=128", "display_name": "Jalala.H13", "link": "https://stackoverflow.com/users/10132419/jalala-h13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 51630910, "answer_count": 1, "score": 0, "last_activity_date": 1533120034, "creation_date": 1533118684, "last_edit_date": 1533120034, "question_id": 51630835, "link": "https://stackoverflow.com/questions/51630835/vba-excel-delete-rows-based-on-values-in-column-and-move-on-if-its-empty", "title": "VBA Excel Delete rows based on values in column and move on if it&#39;s empty", "body": "<p>I am very new with VBA and I am working with a table <code>Tabel1</code> on my worksheet which has a varying range of columns and rows. I need to remove rows based on a value in the column <code>Af</code>. The cells in the column have a value or are empty.\nI thought I had it worked out thanks to many of you on this website, however, if the entire column is empty I get an error in the last section of the code <code>myRange.Select</code>.\nI get where it comes from, there is nothing to select. But I don't know how to skip it without getting more errors. I have searched this website, but can't seem to find anything that works.\nBelow is the code that works fine when there're values in the column.</p>\n\n<pre><code>Dim tbl As ListObject\nDim x As Long\nDim myRange As Range\n\nSet tbl = ActiveSheet.ListObjects(\"Tabel1\")\n    For x = 1 To tbl.Range.Rows.Count\n        If tbl.DataBodyRange(x, Range(\"Tabel1[Af]\").Column) &gt;= 1 Then\n            If myRange Is Nothing Then\n                Set myRange = tbl.ListRows(x).Range\n        Else\n            Set myRange = Union(myRange, tbl.ListRows(x).Range)\n        End If\n    End If\nNext x\nmyRange.Select\n    Selection.Delete shift:=xlUp\n</code></pre>\n\n<p>Can anyone please help me skip past the <code>.select</code> part?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1533119299, "last_edit_date": 1533119299, "creation_date": 1533119104, "answer_id": 51630977, "question_id": 51630708, "link": "https://stackoverflow.com/questions/51630708/insert-row-in-a-specific-position/51630977#51630977", "title": "insert row in a specific position", "body": "<p>If you have a cell reference and you want to insert a row before it is cell.EntireRow.Insert` similar to:</p>\n\n<pre><code>dim cell as range\nset cell = Range(\"A2\")\ncell.EntireRow.Insert\n</code></pre>\n\n<p>...or if you want to insert before Row 3:</p>\n\n<pre><code>Rows(3).EntireRow.Insert\n</code></pre>\n\n<p>...or a insert a number of rows:</p>\n\n<pre><code>Rows(\"3:8\").EntireRow.Insert\n</code></pre>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li>MSDN : <a href=\"https://msdn.microsoft.com/vba/excel-vba/articles/range-entirerow-property-excel\" rel=\"nofollow noreferrer\"><strong><code>Range.EntireRow</code> Property</strong></a>  </li>\n<li>MSDN : <a href=\"https://msdn.microsoft.com/vba/excel-vba/articles/range-insert-method-excel\" rel=\"nofollow noreferrer\"><strong><code>Range.Insert</code> Method</strong></a>  </li>\n</ul>\n"}], "owner": {"reputation": 5855, "user_id": 2399035, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MlRmQ.png?s=128&g=1", "display_name": "Lelio Faieta", "link": "https://stackoverflow.com/users/2399035/lelio-faieta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 51630977, "answer_count": 1, "score": 1, "last_activity_date": 1594211106, "creation_date": 1533118341, "last_edit_date": 1594211106, "question_id": 51630708, "link": "https://stackoverflow.com/questions/51630708/insert-row-in-a-specific-position", "title": "insert row in a specific position", "body": "<p>I have this sub that insert a new row into an excel sheet. \nEach row has a date in column A and I want to keep the date in order (from oldest to newest) inserting. So if the date I want to insert is greater than the last date I just add a new row at the bottom.\nOtherwise I look for the point where to insert a blank row and populate the data.\nI'm stuck on the part where I insert the new row:  </p>\n\n<pre><code>cell.Rows(riga).EntireRow.insert\n</code></pre>\n\n<p>The whole sub is this:</p>\n\n<pre><code>Sub insert_row()\n    lastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    data_last = Range(\"A\" &amp; lastRow).Value\n\n    'prendo i valori\n    data_mov = new_mov.data.Value\n    descr_mov = new_mov.descr.Value\n    importo_mov = new_mov.importo.Value\n\n    'emetto un alert se la data inserita minore di quella della riga precedente (lastRow)\n    If data_mov &lt; data_last Then\n        MsgBox \"movimento nel passato\"\n        Dim rng As Range, cell As Range\n        Set rng = Range(\"C5:C\" &amp; lastRow)\n        For Each cell In rng\n            riga = cell.Row\n            data = Range(\"A\" &amp; riga).Value\n            If data &gt; data_mov Then\n                riga = riga - 1\n                cell.Rows(riga).EntireRow.insert\n                Exit For\n            End If\n            Next cell\n\n    Else\n        'li inserisco nella prima riga vuota sotto\n        nxt_row = lastRow + 1\n        Range(\"A\" &amp; nxt_row).Value = data_mov\n        Range(\"B\" &amp; nxt_row).Value = descr_mov\n        Range(\"C\" &amp; nxt_row).Value = CDbl(importo_mov)\n        Call Saldo_upd\n    End If\n    'evidenzio una cella di quella riga\n\n\n\n    'ricalcolo il saldo\n\nEnd Sub\n</code></pre>\n\n<p>I don't get any error message and nothing happens. Any hint?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533118618, "post_id": 51630640, "comment_id": 90225704, "body": "Probably a circular-reference type thing. Probably in <code>Key=Value</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 0, "last_activity_date": 1533118651, "creation_date": 1533118651, "answer_id": 51630815, "question_id": 51630640, "link": "https://stackoverflow.com/questions/51630640/out-of-stack-space-error-when-setting-custom-object-parameter/51630815#51630815", "title": "Out of Stack Space Error when setting Custom Object Parameter", "body": "<p>In <code>Public Property Let</code> it should be:</p>\n\n<p><code>pKey = Value</code></p>\n\n<p>Right now it calls the setter recursively (indefinitely). </p>\n"}], "owner": {"reputation": 278, "user_id": 1270911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7651d67fd4f31605a07e21d995cf98ea?s=128&d=identicon&r=PG", "display_name": "Joel Biffin", "link": "https://stackoverflow.com/users/1270911/joel-biffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 51630815, "answer_count": 1, "score": 0, "last_activity_date": 1533118651, "creation_date": 1533118119, "question_id": 51630640, "link": "https://stackoverflow.com/questions/51630640/out-of-stack-space-error-when-setting-custom-object-parameter", "title": "Out of Stack Space Error when setting Custom Object Parameter", "body": "<p>I have a custom class module called Service with string parameters.\nI instantiate the class by creating an object <code>this_service</code> like so:</p>\n\n<pre><code>Dim this_service As Service\nSet this_service = New Service\n</code></pre>\n\n<p>Then I try to set a parameter to any string value like so:</p>\n\n<pre><code>this_service.Key = \"HELLO\"\n</code></pre>\n\n<p>When I run the macro I get the 28 Runtime Error, Out of Stack Space.</p>\n\n<p>In my class module Service I have the following parameter definition and method calls:</p>\n\n<pre><code>Private pKey As String\n\nPublic Property Get Key() As String\n    Key = pKey\nEnd Property\n\nPublic Property Let Key(Value As String)\n    Key = Value\nEnd Property\n</code></pre>\n\n<p>I can't see any reason why I'd be getting this runtime error?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1533118139, "post_id": 51630553, "comment_id": 90225416, "body": "Please format your code as code and state what programming language you are using in the tags. I&#39;ve done it for you, this time."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10165033, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155492681895685/picture?type=large", "display_name": "Richman1", "link": "https://stackoverflow.com/users/10165033/richman1"}, "edited": false, "score": 0, "creation_date": 1533122857, "post_id": 51631639, "comment_id": 90228331, "body": "Thankyou very much! Thats perfect :-)"}], "tags": [], "owner": {"reputation": 292, "user_id": 7501821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb7044faa0544b9c43911120ff60600d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Souza", "link": "https://stackoverflow.com/users/7501821/daniel-souza"}, "is_accepted": true, "score": 0, "last_activity_date": 1533121305, "creation_date": 1533121305, "answer_id": 51631639, "question_id": 51630553, "link": "https://stackoverflow.com/questions/51630553/add-specific-criterias-to-an-existing-macro/51631639#51631639", "title": "Add specific criterias to an existing macro", "body": "<p>Use a <code>Select Case</code> instead of <code>If Then</code>:</p>\n\n<pre><code>Sub AUMReport()\n'\n' AUMReport Macro\nDim lRow As Long\nDim iCntr As Long\nlRow = 390\nFor iCntr = lRow To 1 Step -1\n    Select Case Cells(iCntr, 1).Value\n        Case \"my-first-value\", \"my-second-value\", \"my-third-value\", \"my-etc\"\n        Rows(iCntr).Delete\n    End Select\nNext\n\n'\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10165033, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155492681895685/picture?type=large", "display_name": "Richman1", "link": "https://stackoverflow.com/users/10165033/richman1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 51631639, "answer_count": 1, "score": 1, "last_activity_date": 1533123208, "creation_date": 1533117876, "last_edit_date": 1533123208, "question_id": 51630553, "link": "https://stackoverflow.com/questions/51630553/add-specific-criterias-to-an-existing-macro", "title": "Add specific criterias to an existing macro", "body": "<p>I have tried searching on this site but I don't really know what I'm looking for.  I have the below macro which works well(taken from this site), but I want to add more values for it to check and delete. Where \"AGGF\" is what it looks for and removes, I have several other words that I would like it to search for and remove. Can I somehow use 'OR' after AGGF so that I can do this?</p>\n\n<pre><code>Sub AUMReport()\n'\n' AUMReport Macro\n'   Dim lRow As Long\n    Dim iCntr As Long\n    lRow = 390\n    For iCntr = lRow To 1 Step -1\n        If Cells(iCntr, 1).Value = \"AGGF\" Then\n            Rows(iCntr).Delete\n                    End If\n        Next\n\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 3, "creation_date": 1533118309, "post_id": 51630575, "comment_id": 90225514, "body": "That is some serious voodoo."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1533119751, "post_id": 51630575, "comment_id": 90226405, "body": "Good thinking on the SUMIFs too."}, {"owner": {"reputation": 43, "user_id": 10164899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e246a3568aa97495c5d0d14e99a81279?s=128&d=identicon&r=PG&f=1", "display_name": "Zonure", "link": "https://stackoverflow.com/users/10164899/zonure"}, "edited": false, "score": 0, "creation_date": 1533122984, "post_id": 51630575, "comment_id": 90228402, "body": "The sumifs stuff is voodoo. It works like a charm! Care to explain (in plain english) what it actually does?? Because i don&#39;t understand what we&#39;re sum&#39;ing.. Thanks a million though!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1533144310, "post_id": 51630575, "comment_id": 90242466, "body": "You&#39;re &#39;summing&#39; a single number; specifically the single number in the row where column D is I1 and column A matches whatever is in column A."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1533118668, "last_edit_date": 1533118668, "creation_date": 1533117923, "answer_id": 51630575, "question_id": 51630437, "link": "https://stackoverflow.com/questions/51630437/vba-loop-with-index-match-wont-go-to-next-value/51630575#51630575", "title": "VBA: loop with INDEX MATCH won&#39;t go to next value", "body": "<p>Try,</p>\n\n<pre><code>=INDEX(C:C, AGGREGATE(15, 7, ROW($2:$12)/((A$2:A$12=A2)*(D$2:D$12=\"I1\")), 1))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/BmNTb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BmNTb.png\" alt=\"enter image description here\"></a></p>\n\n<p>Assuming that REF is numeric and I1 is unique to each S/N then SUMIFS would do as well and is more versatile and friendly to record deletions/additions.</p>\n\n<pre><code>=sumifs(c:c, a:a, a2, d:d, \"I1\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1533118213, "creation_date": 1533118213, "answer_id": 51630671, "question_id": 51630437, "link": "https://stackoverflow.com/questions/51630437/vba-loop-with-index-match-wont-go-to-next-value/51630671#51630671", "title": "VBA: loop with INDEX MATCH won&#39;t go to next value", "body": "<p>Another formula approach, though no doubt less efficient than Jeeped's as it's an array formula (use Ctrl+Enter+Shift which will make the curly brackets appear).</p>\n\n<pre><code>=INDEX($C$2:$C$12,MATCH(1,IF($A$2:$A$12=$A2,IF($D$2:$D$12=\"I1\",1)),0))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/SVaAJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SVaAJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is a non-array variation, see <a href=\"http://www.xl-central.com/lookup-multiple-criteria.html\" rel=\"nofollow noreferrer\">http://www.xl-central.com/lookup-multiple-criteria.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1533119588, "creation_date": 1533119588, "answer_id": 51631134, "question_id": 51630437, "link": "https://stackoverflow.com/questions/51630437/vba-loop-with-index-match-wont-go-to-next-value/51631134#51631134", "title": "VBA: loop with INDEX MATCH won&#39;t go to next value", "body": "<p>This is a possible VBA solution, going through 2 steps and using replace.</p>\n\n<p>Step 1:</p>\n\n<ul>\n<li>loop through all the cells in <code>Range(\"A1:A13\")</code> and see whether the value of column <code>D</code> is <code>I1</code>. If this is the case, write the value from the Reference column, otherwise write the same value as in the SN. </li>\n<li>This is what you get from the first step:</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/9OaQr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9OaQr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 2:</p>\n\n<ul>\n<li>loop through the same range and whenever the <code>UNIQREF</code> is the same, carry out a replacement.</li>\n<li>The replacement should be only carried out in the <code>UNIQREF</code> column.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/fJfQl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fJfQl.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code for the both steps:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim startCell As Long: startCell = 2\n    Dim endCell As Long: endCell = 13\n\n    Dim cnt As Long, cnt2 As Long\n    Dim myCell As Range\n    Dim lookFor As String: lookFor = \"I1\"\n    Dim wks As Worksheet: Set wks = Worksheets(1)\n\n    For cnt = startCell To endCell\n        Set myCell = wks.Cells(cnt, 1)\n        If myCell.Offset(, 3) = lookFor Then\n            myCell.Offset(, 1) = myCell.Offset(, 2)\n        Else\n            myCell.Offset(, 1) = myCell\n        End If\n    Next cnt\n\n    For cnt = startCell To endCell\n        Set myCell = wks.Cells(cnt, 1)\n        If myCell &lt;&gt; myCell.Offset(, 1) Then\n            wks.Range(wks.Cells(startCell, 2), wks.Cells(endCell, 2)).Replace _\n                What:=myCell, Replacement:=myCell.Offset(, 1), LookAt:=xlPart\n        End If\n    Next cnt\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10164899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e246a3568aa97495c5d0d14e99a81279?s=128&d=identicon&r=PG&f=1", "display_name": "Zonure", "link": "https://stackoverflow.com/users/10164899/zonure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 0, "accepted_answer_id": 51630575, "answer_count": 3, "score": 3, "last_activity_date": 1533119588, "creation_date": 1533117562, "question_id": 51630437, "link": "https://stackoverflow.com/questions/51630437/vba-loop-with-index-match-wont-go-to-next-value", "title": "VBA: loop with INDEX MATCH won&#39;t go to next value", "body": "<p>VBA-newbie here... Any help appreciated :)</p>\n\n<p>I have a table like this one :</p>\n\n<pre><code>S/N     UNIQREF   REF   OPE\nABC123             10    C1\nABC123             20    C2\nABC123             30    I1\nABC123             40    IM1\nDEF456             10    C1\nDEF456             20    I1\nDEF456             30    DR1\nHIJ789             10    C1\nHIJ789             20    DR1\nHIJ789             30    I1\nHIJ789             40    XX1\n</code></pre>\n\n<p>...and I need to fill the UNIQREF column.</p>\n\n<p>The rule is: loop through my S/N (serial number) column, and as long as it stays the same, lookup the value on the left of the \"I1\" OPE (operation), and write it in the UNIQREF in all rows.</p>\n\n<p>For example, we take ABC123, lookup \"I1\" in OPE, see that the value next to it (on the left) is 30, so we write 30 in the UNIQREF column for all ABC123 S/Ns.</p>\n\n<p>Similarly, we would write 20 for all DEF456 S/Ns, and 30 for all HIJ789 S/Ns.</p>\n\n<p>So far, here is my code:</p>\n\n<pre><code>Public Sub routine()\n\nDim gamWAL as Worksheet\nSet gamWAL = ThisWorkbook.Sheets(\"gamWAL\")\n\ni = 3 'because data in my table starts on line 3, line 2 is columns titles and line 1 is comments. Also starts in Column B (my S/N column)...\n\nDo While gamWAL.Cells(i, \"B\").Value &lt;&gt; \"\" 'i want the loop to stop at the when the S/N list is over\n\n    Do While gamWAL.Cells(i, \"B\").Value = gamWAL.Cells(i + 1, \"B\").Value\n\n        gamWAL.Cells(i, \"E\").Value = Application.WorksheetFunction.Index(gamWAL.Range(\"F\" &amp; i &amp; \":G3000\"), Application.WorksheetFunction.Match(\"I1\", gamWAL.Range(\"G\" &amp; i &amp; \":G3000\"), 0), 1)\n\n        i = i + 1\n\n    Loop\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>The issue: it does write \"20\" for all ABC123 S/Ns, except for the last one, and then doesn't go on to the next \"group\" of S/Ns... the macro keeps \"computing\" though (for super long, as the table is currently 900 rows, but is expected to grow to about 4000 rows)..</p>\n\n<p>Any tips on making this work?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "variables", "find"], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1533116067, "creation_date": 1533116067, "answer_id": 51629916, "question_id": 51629809, "link": "https://stackoverflow.com/questions/51629809/not-able-to-use-a-variable-inside-find-command-in-vba/51629916#51629916", "title": "Not able to use a variable inside Find command in VBA", "body": "<p>I can't actually fathom what you're trying to do with the code, or why you'd be doing it, but in order to solve your problem:</p>\n\n<p>You're not wrapping the string of <code>s</code> in quotes. Try:</p>\n\n<pre><code>Range(\"A1\").FormulaR1C1 = \"=FIND(\"\"$\"\",\"\"\" &amp; s &amp; \"\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10164891, "user_type": "registered", "profile_image": "https://graph.facebook.com/620830551351601/picture?type=large", "display_name": "Sourav Bhattacharya", "link": "https://stackoverflow.com/users/10164891/sourav-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533725560, "creation_date": 1533115757, "last_edit_date": 1533115928, "question_id": 51629809, "link": "https://stackoverflow.com/questions/51629809/not-able-to-use-a-variable-inside-find-command-in-vba", "title": "Not able to use a variable inside Find command in VBA", "body": "<p>I have a string s which contains <code>\"subham$\"</code></p>\n\n<p>Now using excel's built in command find i like to know the position of the dollar symbol,there might be other ways but i like to use find in vba code and use a variable inside it </p>\n\n<pre><code>Sub testfind()\n    Dim s As String\n    s = \"subham$\"\n    Sheets(\"Sheet1\").Select\n    Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"=FIND(\"\"$\"\",\" &amp; s &amp; \")\"\nEnd Sub\n</code></pre>\n\n<p>I am getting the error Application defined or object defined error,\nwhat am I doing wrong?</p>\n"}, {"tags": ["html", "vba", "excel", "date"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1533115718, "post_id": 51629629, "comment_id": 90223775, "body": "What is the value of <code>daterow</code>? And it is a good idea to copy and paste the code from your VBEditor to SO. E.g. this should be on one line - <code>Worksheets(&quot;Regional Day Breakdown Sales&quot;).Cells(daterow, &quot;F&quot;).Value =      ActiveSheet.Range(&quot;D4&quot;).Value</code>"}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1533115823, "post_id": 51629629, "comment_id": 90223847, "body": "Dim daterow As Variant   if i swap the &quot;Value&quot;.Range bit for date, this works with today&#39;s date but i wanted to swap that for the date in cell D19 (value tab) so just swapped it, honestly im not good with VBA so normally just find the code and edit it, just had a bit of a problem editing this one :("}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1533115828, "post_id": 51629629, "comment_id": 90223850, "body": "Do you get an error anywhere? What is the error?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1533115880, "post_id": 51629629, "comment_id": 90223886, "body": "Does the above code error? Does it not error but not do what you need? What is it doing? Remember, we can&#39;t see your data/workbook so you need to provide a little more information."}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1533115977, "post_id": 51629629, "comment_id": 90223942, "body": "error message is: type 13 mismatch - i presume because i amended the code incorrectly so this one works but when i swap &quot;date&quot; for new target date it doesn&#39;t play ball!   Code:"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1533116576, "post_id": 51629629, "comment_id": 90224328, "body": "What is in D19? And please don&#39;t code in comments - as you can see it&#39;s not readable."}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1533116906, "post_id": 51629629, "comment_id": 90224572, "body": "d19 is the date in the format 31/07/2018  (but this is based on a formula so will always be equal to the last working day of the prior month) NOT text format so should match that in Column B in my other tab"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1533116996, "post_id": 51629629, "comment_id": 90224633, "body": "So what is the value of daterow when it errors? Step through your code."}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1533121060, "post_id": 51629629, "comment_id": 90227232, "body": "apologies for the confusion probably worded question badly - i solved my problem with solution below, many thanks"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "is_accepted": true, "score": 0, "last_activity_date": 1533120923, "creation_date": 1533120923, "answer_id": 51631523, "question_id": 51629629, "link": "https://stackoverflow.com/questions/51629629/vba-pasting-into-column-if-date-in-cell-x-equal-the-date-in-column-y/51631523#51631523", "title": "VBA pasting into column IF date in cell x equal the date in column y", "body": "<p>was being an idiot just needed to remove the Clng too, thanks for the help</p>\n\n<p>a) </p>\n\n<pre><code>  daterow = Application.Match(Worksheets(\"Value\").Range(\"D17\"), Worksheets(\"Regional \nDay Breakdown Sales\").Columns(\"B\"), 0)\nIf Not IsError(daterow) Then\n    Worksheets(\"Regional Day Breakdown Sales\").Cells(daterow, \"F\").Value = \nActiveSheet.Range(\"D4\").Value\n    Else\n    MsgBox (\"Date not in range\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 51631523, "answer_count": 1, "score": -2, "last_activity_date": 1533120923, "creation_date": 1533115177, "last_edit_date": 1533115611, "question_id": 51629629, "link": "https://stackoverflow.com/questions/51629629/vba-pasting-into-column-if-date-in-cell-x-equal-the-date-in-column-y", "title": "VBA pasting into column IF date in cell x equal the date in column y", "body": "<p>Title says it all really. </p>\n\n<p>I have a date in a tab called \"Value\" with the value of last work day in the previous month. I then want to see if this date in in the column B of another tab, if so i would like to paste certain information (e.g. cell a1 value) into column D where the row equals the date. </p>\n\n<p>example so if the date in cell a1 (tab1) is found in tab2 column b paste the information from tab1 cell b1 into the same row where the date was found. </p>\n\n<p>My Code which i tried so you can see what im doing is: </p>\n\n<pre><code>   'formula to paste information from cell into correct column in correct tab,\n\n    daterow = Application.Match(CLng(Worksheets(\"Value\").Range(\"D19\")), \n    Worksheets(\"Regional Day Breakdown Sales\").Columns(\"B\"), 0)\n    If Not IsError(daterow) Then\n        Worksheets(\"Regional Day Breakdown Sales\").Cells(daterow, \"F\").Value = \n    ActiveSheet.Range(\"D4\").Value\n        Else\n        MsgBox (\"Date not in range\")\n    End If\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1533115808, "post_id": 51629562, "comment_id": 90223837, "body": "@R-de-Rojas: what is the value of  <code>deposits(i)</code> in your immediate window inside the loop? in the VBE, strike CTRL+G, and add <code>?deposits(i)</code> ... on the line <code>If InStr(UCase(oSheet.Name),UCase(deposits(i))) Then</code> put a breakpoint with F9 and re-run your macro to compare the values in the loop"}], "answers": [{"tags": [], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "is_accepted": false, "score": 0, "last_activity_date": 1533115452, "creation_date": 1533115452, "answer_id": 51629713, "question_id": 51629562, "link": "https://stackoverflow.com/questions/51629562/nested-if-loops-that-delete-sheets-in-excel-vba-dont-do-their-assigned-function/51629713#51629713", "title": "Nested If loops that delete sheets in excel vba dont do their assigned function", "body": "<p>How about this? I simplified the code somewhat:</p>\n\n<pre><code>Dim oSheet As Excel.Worksheet\n    For Each oSheet In ActiveWorkbook.Sheets\n        For i = 1 To deposits.Count\n            If InStr(UCase(oSheet.Name), UCase(\"Properties_auto\")) Then\n                If InStr(UCase(oSheet.Name), UCase(deposits(i))) = 0 Then\n                        oSheet.Delete\n                End If\n            End If\n        Next i\n    Next oSheet \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 10164769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb7a6fe1378fcffa7382778436fc001?s=128&d=identicon&r=PG&f=1", "display_name": "R. de Rojas", "link": "https://stackoverflow.com/users/10164769/r-de-rojas"}, "edited": false, "score": 0, "creation_date": 1533119538, "post_id": 51629802, "comment_id": 90226272, "body": "The line If count_heat &gt; ubound(deposits) gives me type mismatch error. For clarification deposits is a range of size 2 currently"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 67, "user_id": 10164769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb7a6fe1378fcffa7382778436fc001?s=128&d=identicon&r=PG&f=1", "display_name": "R. de Rojas", "link": "https://stackoverflow.com/users/10164769/r-de-rojas"}, "edited": false, "score": 0, "creation_date": 1533119695, "post_id": 51629802, "comment_id": 90226370, "body": "I thought it was an array. I&#39;ll make the adjustment."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1533119766, "last_edit_date": 1533119766, "creation_date": 1533115735, "answer_id": 51629802, "question_id": 51629562, "link": "https://stackoverflow.com/questions/51629562/nested-if-loops-that-delete-sheets-in-excel-vba-dont-do-their-assigned-function/51629802#51629802", "title": "Nested If loops that delete sheets in excel vba dont do their assigned function", "body": "<p>You're comparing every element in the deposits array to the worksheet name. Even if one or two match, there must be others that do not and that increments count_heat  above zero.</p>\n\n<p>Change the conditions of the value of count_heat.</p>\n\n<pre><code>If count_heat = deposits.count Then 'there were no matches at all\n    oSheet.Delete\nEnd If\n</code></pre>\n\n<p>You could also save some loops by exiting the For ... Next loop as soon as a match to one of the deposits was found. Note that this must still be used in concert with the If statement adjustment above.</p>\n\n<pre><code>If InStr(UCase(oSheet.Name),UCase(deposits(i))) Then\n    exit for\nElse\n    count_heat = count_heat + 1\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10164769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb7a6fe1378fcffa7382778436fc001?s=128&d=identicon&r=PG&f=1", "display_name": "R. de Rojas", "link": "https://stackoverflow.com/users/10164769/r-de-rojas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 51629802, "answer_count": 2, "score": 1, "last_activity_date": 1533119766, "creation_date": 1533114992, "last_edit_date": 1533115227, "question_id": 51629562, "link": "https://stackoverflow.com/questions/51629562/nested-if-loops-that-delete-sheets-in-excel-vba-dont-do-their-assigned-function", "title": "Nested If loops that delete sheets in excel vba dont do their assigned function", "body": "<p>I have a problem with my code that i do not seem to be able to fix. Essentially what I Am trying to do is to have 2 nested if conditions. One of them checks if the name of the sheet starts with \"properties_auto\" to avoid deleting sheets that have nothing to do with them. The second one checks if the name includes either one of two \"deposits\" that i am using. If the first condition is met but the second one isn't then the sheet is deleted,to avoid having useless sheets. \nThe problem here is that the code seems to delete all of the sheets that include properties_auto in their code. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>Dim oSheet As Excel.Worksheet\nDim count_heat As Integer\ncount_heat = 0\n\nFor Each oSheet In ActiveWorkbook.Sheets\n    count_heat = 0\n    For i = 1 To deposits.count\n        If InStr(UCase(oSheet.Name),UCase(\"Properties_auto\")) Then\n            If InStr(UCase(oSheet.Name),UCase(deposits(i))) Then\n            Else\n                count_heat = count_heat + 1\n            End If\n        Else\n        End If\n    Next i\n    If count_heat &gt; 0 Then\n        oSheet.Delete\n    Else\n    End If\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "edited": false, "score": 0, "creation_date": 1533119639, "post_id": 51629639, "comment_id": 90226333, "body": "Thanx. But this will not solve this examples: One &gt;example&lt; string &gt; One &gt;replaced&lt; string"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "edited": false, "score": 0, "creation_date": 1533119850, "post_id": 51629639, "comment_id": 90226469, "body": "@Rune Why not??"}, {"owner": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "edited": false, "score": 0, "creation_date": 1533121484, "post_id": 51629639, "comment_id": 90227499, "body": "Because of the special charactar in front &quot;&gt;&quot; is not a space"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "edited": false, "score": 0, "creation_date": 1533121838, "post_id": 51629639, "comment_id": 90227690, "body": "@Rune Just add this case like other cases - as I did in updated answer."}, {"owner": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "edited": false, "score": 0, "creation_date": 1533125730, "post_id": 51629639, "comment_id": 90230166, "body": "Sure, but there is serveral special characters to handle. eg: &quot;,./\\&quot;?()&lt;&gt;;:&amp;&quot;. The list has just been to long."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1533121811, "last_edit_date": 1533121811, "creation_date": 1533115224, "answer_id": 51629639, "question_id": 51629535, "link": "https://stackoverflow.com/questions/51629535/excel-vba-string-replacement-reg-exp/51629639#51629639", "title": "Excel VBA - String replacement - reg exp?", "body": "<p>Try this code, there's no need to use regular expressions:</p>\n\n<pre><code>str = Cells(rowNumber, columnNumber).Value\nstr = Replace(str, \" example\", \" replaced\")\nstr = Replace(str, \" Example\", \" Replaced\")\nstr = Replace(str, \"&gt;example\", \"&gt;replaced\")\nstr = Replace(str, \"&gt;Example\", \"&gt;Replaced\")\nCells(rowNumber, columnNumber).Value = str\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "edited": false, "score": 0, "creation_date": 1533122562, "post_id": 51630387, "comment_id": 90228157, "body": "Thanx. This looks promising. I have a list of about 1000 words that shall be runned throug the script, and be replaced individually. Thus i need to maintain the case as a variable input. (If match is <code>Example</code>, replacement need to be <code>Replaced</code>)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "edited": false, "score": 0, "creation_date": 1533122659, "post_id": 51630387, "comment_id": 90228219, "body": "Sorry so example = replaced and Example = Replaced?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "edited": false, "score": 0, "creation_date": 1533126041, "post_id": 51630387, "comment_id": 90230368, "body": "I amended the above. It is based on a single match check but can easily be adapted to loop all matches."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1533124600, "last_edit_date": 1533124600, "creation_date": 1533117387, "answer_id": 51630387, "question_id": 51629535, "link": "https://stackoverflow.com/questions/51629535/excel-vba-string-replacement-reg-exp/51630387#51630387", "title": "Excel VBA - String replacement - reg exp?", "body": "<p>Or use regex pattern</p>\n\n<pre><code>\\b[E|e]xample\\b\n</code></pre>\n\n<p><strong>Regex:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/GJQG3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GJQG3.png\" alt=\"Regex\"></a></p>\n\n<p><a href=\"https://regex101.com/r/leh2lv/1\" rel=\"nofollow noreferrer\"><em>Try it</em></a></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim arr(), i As Long\n    arr = Array(\"One dexamples string\", \"One example string\", \"One &gt;example&lt; string\", \"One Example, string\", \"One Example string\", \"One example string\")\n    For i = LBound(arr) To UBound(arr)\n        Debug.Print ReplaceMatch(arr(i), \"\\b[E|e]xample\\b\")\n    Next i\nEnd Sub\nPublic Function ReplaceMatch(ByVal inputString As String, ByVal pattern As String) As String\n    Dim re As Object\n    Set re = CreateObject(\"VBScript.RegExp\")\n    With re\n        .Global = True\n        .MultiLine = True\n        .pattern = pattern\n\n        If .test(inputString) Then\n            ReplaceMatch = .Replace(inputString, \"replaced\")\n        Else\n            ReplaceMatch = inputString\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>This needs some development re the Case test:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    Dim arr(), i As Long\n    arr = Array(\"One dexamples string\", \"One example string\", \"One &gt;example&lt; string\", \"One Example, string\", \"One Example string\", \"One example string\")\n    For i = LBound(arr) To UBound(arr)\n      Debug.Print ReplaceMatch(arr(i), \"\\b[E|e]xample\\b\")\n    Next i\nEnd Sub\nPublic Function ReplaceMatch(ByVal inputString As String, ByVal pattern As String) As String\n    Dim re As Object\n    Set re = CreateObject(\"VBScript.RegExp\")\n    With re\n        .Global = True\n        .MultiLine = True\n        .pattern = pattern\n\n        If .test(inputString) Then\n            If AscW(Left$(.Execute(inputString)(0), 1)) &lt; 91 Then\n                ReplaceMatch = .Replace(inputString, \"Replaced\")\n            Else\n                ReplaceMatch = .Replace(inputString, \"replaced\")\n            End If\n        Else\n            ReplaceMatch = inputString\n        End If\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1533125163, "last_edit_date": 1533125163, "creation_date": 1533124704, "answer_id": 51632719, "question_id": 51629535, "link": "https://stackoverflow.com/questions/51629535/excel-vba-string-replacement-reg-exp/51632719#51632719", "title": "Excel VBA - String replacement - reg exp?", "body": "<p>If your Upper/Lower case variability involves only the first letter of the word, then the following code will do that.</p>\n\n<p><em>If the case within the word might be mixed, you will need to cycle through letter by letter, and also decide what to do if the length of the replacement is not the same as the length of the found word</em></p>\n\n<p>One potential issue with this code:  </p>\n\n<ul>\n<li><code>\\b</code> is a word boundary token.  </li>\n<li>A word boundary is defined as a position bounded on one side by a word token, and on the other by a non-word token or the beginning/end of the string.</li>\n<li>A word token is anything in the set of <code>[A-Za-z0-9_]</code></li>\n<li>So if you have strings in your source that start or end with the <code>_</code> (underscore), these will not be found.</li>\n<li>If this might be an issue, we would have to change the regex, and also where to look for the \"cased\" character, or just temporarily replace underscores with some other non-word character (and then change it back after).</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n'Set reference to Microsoft VBScript Regular Expressions 5.5\n'   or use late binding\nFunction CSReplace(S As String, sFind As String, sRepl As String) As String\n    Dim RE As RegExp, MC As MatchCollection, M As Match\n    Dim sTemp As String, I As Long\n\nSet RE = New RegExp\nWith RE\n    .Global = True\n    .IgnoreCase = True\n    .Pattern = \"\\b\" &amp; sFind &amp; \"\\b\"\n    If .Test(S) = True Then\n        Set MC = .Execute(S)\n        sTemp = S\n        For I = MC.Count - 1 To 0 Step -1\n            Set M = MC(I)\n            sRepl = LCase(sRepl)\n            If Left(M, 1) = UCase(Left(M, 1)) Then _\n                sRepl = UCase(Left(sRepl, 1)) &amp; Mid(sRepl, 2)\n            sTemp = WorksheetFunction.Replace(sTemp, M.FirstIndex + 1, Len(sFind), sRepl)\n        Next I\n        CSReplace = sTemp\n    Else\n        CSReplace = S\n    End If\nEnd With\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cvxat.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cvxat.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 9177656, "user_type": "registered", "profile_image": "https://graph.facebook.com/829865435/picture?type=large", "display_name": "Rune", "link": "https://stackoverflow.com/users/9177656/rune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 51632719, "answer_count": 3, "score": 0, "last_activity_date": 1558277871, "creation_date": 1533114900, "last_edit_date": 1558277871, "question_id": 51629535, "link": "https://stackoverflow.com/questions/51629535/excel-vba-string-replacement-reg-exp", "title": "Excel VBA - String replacement - reg exp?", "body": "<p>I'm doing some word replacement in Excel VBA. Replacing the word itself, delimited by any special characters (except a-z,A-Z,0-9), and preserving the case.</p>\n\n<p>Examples of correct replacement (replacing <code>example</code> with <code>replaced</code>):</p>\n\n<p><code>One example string</code> > <code>One replaced string</code></p>\n\n<p><code>One Example string</code> > <code>One Replaced string</code></p>\n\n<p><code>One Example, string</code> > <code>One Replaced, string</code></p>\n\n<p><code>One &gt;example&lt; string</code> > <code>One &gt;replaced&lt; string</code> (special character in front and end)</p>\n\n<p><code>One dexamples string</code> > <code>One dexamples string</code> (<code>example</code> NOT replaced)</p>\n\n<p>I have got it working by using serveral lines, as shown below. Any ideas how to do this with regexp or similar methods?</p>\n\n<pre><code>cel.Replace what:=\" \" &amp; Rng.Value &amp; \" \", replacement:=\" \" &amp; Rng.Offset(0, 1).Value &amp; \" \", MatchCase:=True\ncel.Replace what:=\" \" &amp; Rng.Value &amp; \",\", replacement:=\" \" &amp; Rng.Offset(0, 1).Value &amp; \",\", MatchCase:=True\ncel.Replace what:=\"&gt;\" &amp; Rng.Value &amp; \"&lt;\", replacement:=\"&gt;\" &amp; Rng.Offset(0, 1).Value &amp; \"&lt;\", MatchCase:=True\n...\n</code></pre>\n\n<p>EDIT:\nI have a list of about 1000 words that shall be runned throug the script, and be replaced individually. Thus i need to maintain the case as a variable input. (If match is <code>Example</code>, replacement need to be <code>Replaced</code>)</p>\n\n<p>EDIT:\nthere is serveral special characters to handle. eg: \",./\\\"?()&lt;>;:&amp;\". The list has just been to long.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117, "user_id": 7499014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cd9cb72d37fb8ffa70e0bfe7f05c09?s=128&d=identicon&r=PG&f=1", "display_name": "Denyo", "link": "https://stackoverflow.com/users/7499014/denyo"}, "edited": false, "score": 0, "creation_date": 1533114776, "post_id": 51629407, "comment_id": 90223148, "body": "1. at which row_num does the failure occur? 2. does the error changes when you remove &quot;On Error Resume Next&quot; and &quot;On Error Goto 0&quot;?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1533114786, "post_id": 51629407, "comment_id": 90223158, "body": "Write <code>MsgBox main_sheet.Cells(row_num, lngNameCol).Value</code> before the error comes. What is the result?"}, {"owner": {"reputation": 15, "user_id": 10120382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f5328ed777e612646bdfd65978948f?s=128&d=identicon&r=PG&f=1", "display_name": "I.L", "link": "https://stackoverflow.com/users/10120382/i-l"}, "reply_to_user": {"reputation": 117, "user_id": 7499014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cd9cb72d37fb8ffa70e0bfe7f05c09?s=128&d=identicon&r=PG&f=1", "display_name": "Denyo", "link": "https://stackoverflow.com/users/7499014/denyo"}, "edited": false, "score": 0, "creation_date": 1533115727, "post_id": 51629407, "comment_id": 90223784, "body": "@denyo at row 6, there will already be an automation error and the error doesn&#39;t change even after adding the &quot;on error resume next&quot;"}, {"owner": {"reputation": 15, "user_id": 10120382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f5328ed777e612646bdfd65978948f?s=128&d=identicon&r=PG&f=1", "display_name": "I.L", "link": "https://stackoverflow.com/users/10120382/i-l"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1533115948, "post_id": 51629407, "comment_id": 90223921, "body": "@vityata it gives the correct value data in the cell, a string but strangely after i choose to end the code upon the error, the sheet is still deleted accurately"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1533117268, "post_id": 51629407, "comment_id": 90224825, "body": "<code>If Not ws Is Nothing Then</code> is a bit of a useless check - it is not needed, because <code>ws</code> is always not nothing."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10120382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f5328ed777e612646bdfd65978948f?s=128&d=identicon&r=PG&f=1", "display_name": "I.L", "link": "https://stackoverflow.com/users/10120382/i-l"}, "edited": false, "score": 0, "creation_date": 1533117467, "post_id": 51630207, "comment_id": 90224978, "body": "yes, after putting it the other way round, it worked fine! thanks for the tip"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1533116887, "creation_date": 1533116887, "answer_id": 51630207, "question_id": 51629407, "link": "https://stackoverflow.com/questions/51629407/vba-automation-error-2147221080-800401a8/51630207#51630207", "title": "VBA automation error: -2147221080 (800401a8)", "body": "<p>I think the problem lies in the deletion of the worksheet during the loop.</p>\n\n<p>Try your loops the other way around, cycling through each sheet to see if it is the name you're looking for:</p>\n\n<pre><code>For row_num = 5 To lastrow\n    For Each ws In ActiveWorkbook.Worksheets\n        If Not ws Is Nothing Then\n            If ws.Name = main_sheet.Cells(row_num, lngNameCol).Value Then\n                On Error Resume Next\n                Application.DisplayAlerts = False\n                Worksheets(ws.Name).Delete\n                Application.DisplayAlerts = True\n                On Error GoTo 0\n            End If\n        End If\n    Next\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 10120382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f5328ed777e612646bdfd65978948f?s=128&d=identicon&r=PG&f=1", "display_name": "I.L", "link": "https://stackoverflow.com/users/10120382/i-l"}, "edited": false, "score": 0, "creation_date": 1533117640, "post_id": 51630273, "comment_id": 90225097, "body": "thanks for the tip but for mine, i have to loop through the worksheets and a column of data to find a match before i delete, that&#39;s why i didn&#39;t use this instead"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1533117077, "creation_date": 1533117077, "answer_id": 51630273, "question_id": 51629407, "link": "https://stackoverflow.com/questions/51629407/vba-automation-error-2147221080-800401a8/51630273#51630273", "title": "VBA automation error: -2147221080 (800401a8)", "body": "<p>When you delete element from a collection, the whole collection is a bit \"unhappy\". With the worksheets, the best way is to loop from the total count of the worksheets to 1 and check whether your worksheet should be deleted:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim i As Long\n    For i = Worksheets.Count To 1 Step -1\n        If Worksheets(i).Name = \"Something\" And Worksheets.Count &gt; 1 Then\n            Application.DisplayAlerts = False\n            Worksheets(i).Delete\n            Application.DisplayAlerts = True\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Additionally, there is a rule for <code>Worksheets.Count&gt;1</code>, because the last worksheet of the workbook cannot be deleted.</p>\n"}], "owner": {"reputation": 15, "user_id": 10120382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f5328ed777e612646bdfd65978948f?s=128&d=identicon&r=PG&f=1", "display_name": "I.L", "link": "https://stackoverflow.com/users/10120382/i-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4310, "favorite_count": 0, "accepted_answer_id": 51630207, "answer_count": 2, "score": 0, "last_activity_date": 1594031278, "creation_date": 1533114537, "last_edit_date": 1594031278, "question_id": 51629407, "link": "https://stackoverflow.com/questions/51629407/vba-automation-error-2147221080-800401a8", "title": "VBA automation error: -2147221080 (800401a8)", "body": "<p>I have a problem with my code whereby everything works fine except one line that keeps getting the automation error even though the sheet exists. My code is supposed to delete sheets based on a certain name column and despite editing it, the error still occurs. Would appreciate if someone could help me out here, thanks!</p>\n\n<pre><code>Sub DeleteSelectedSheets()\n\nConst lngNameCol = 8 ' names in column (H)\n' lngRow = 5 ' data start in row 5\n\nDim i As Long\nDim lastrow As Long\nDim row_num As Long\n\nDim wsh_to_delete As Worksheet\nDim main_sheet As Worksheet\nDim ws As Worksheet\n\nSet main_sheet = ActiveSheet\n\nlastrow = main_sheet.Range(\"A\" &amp; main_sheet.Rows.Count).End(xlUp).Row\n\nApplication.ScreenUpdating = False\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n    For row_num = 5 To lastrow\n        If Not ws Is Nothing Then\n            If ws.Name = main_sheet.Cells(row_num, lngNameCol).Value Then\n                On Error Resume Next\n                Application.DisplayAlerts = False\n                Worksheets(ws.Name).Delete\n                Application.DisplayAlerts = True\n                On Error GoTo 0\n            End If\n        End If\n    Next\nNext\n\nEnd Sub\n</code></pre>\n\n<p>The automation error occurs here:</p>\n\n<pre><code>If ws.Name = main_sheet.Cells(row_num, lngNameCol).Value Then\n</code></pre>\n\n<p>Although the code deleted the sheets, the error keeps popping out after every row </p>\n"}, {"tags": ["excel", "vba", "ms-access", "guid"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1533115464, "post_id": 51629355, "comment_id": 90223598, "body": "<code>Ref.Guid</code> should get you the GUID of the reference. Can you play with that?"}, {"owner": {"reputation": 531, "user_id": 9729023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f8e3c8e31f1c9ba929d94ec4e3886a4?s=128&d=identicon&r=PG&f=1", "display_name": "Sachiko", "link": "https://stackoverflow.com/users/9729023/sachiko"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1533116177, "post_id": 51629355, "comment_id": 90224052, "body": "Many thanks for your prompt advice, @Foxfire And Burns And Burns. Using Ref.Guid at my place, I can get it of my own Access, 15.0.  Debug.Print &quot;Name: &quot;, ref.Name, ref.Guid Accessibility {1EA4DBF0-3C3B-11CF-810C-00AA00389B71}  Just wondering how to get them for other version. If you have any further advice, would be so grateful. Sincerly"}], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 9729023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f8e3c8e31f1c9ba929d94ec4e3886a4?s=128&d=identicon&r=PG&f=1", "display_name": "Sachiko", "link": "https://stackoverflow.com/users/9729023/sachiko"}, "edited": false, "score": 0, "creation_date": 1533117341, "post_id": 51629939, "comment_id": 90224890, "body": "Wow, I really appreciate your wonderful advice, @Erik von Asmuth !! It&#39;s more better and quick solution, than my plan. I&#39;m sure to revise my current script according to your advice. And check the current libraly, using Ref.Guid  Foxfire And Burns And Burns kindly let me know. (If it already has been refered, skip to add it)."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1533116101, "creation_date": 1533116101, "answer_id": 51629939, "question_id": 51629355, "link": "https://stackoverflow.com/questions/51629355/how-to-get-referenced-automatically-accessibilitysystem32-oleacc-dll-by-vba/51629939#51629939", "title": "How to get referenced automatically &#39;Accessibility(System32\\oleacc.dll)&#39; by VBA", "body": "<p>You don't need the GUID to add the reference if it has a fixed location on disk independent of the version.</p>\n\n<p>Since it's always in a fixed path from your Windows directory, you can use that:</p>\n\n<pre><code>References.AddFromFile Environ(\"WINDIR\") &amp; \"\\System32\\oleacc.dll\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 9729023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f8e3c8e31f1c9ba929d94ec4e3886a4?s=128&d=identicon&r=PG&f=1", "display_name": "Sachiko", "link": "https://stackoverflow.com/users/9729023/sachiko"}, "is_accepted": false, "score": 0, "last_activity_date": 1533179658, "creation_date": 1533179658, "answer_id": 51644972, "question_id": 51629355, "link": "https://stackoverflow.com/questions/51629355/how-to-get-referenced-automatically-accessibilitysystem32-oleacc-dll-by-vba/51644972#51644972", "title": "How to get referenced automatically &#39;Accessibility(System32\\oleacc.dll)&#39; by VBA", "body": "<p>Thanks to all of usuful advice, revised my script.\nNow we can automatically make it compact and repair, when would expand.</p>\n\n<p>Just FYI:</p>\n\n<p>-- Script for Set Accessibility Reference.</p>\n\n<pre><code>Sub Set_AccessibilityReference()\n\nDim Ref As Reference\n\n'To Avoid 32183 Error, Once Remove Accessibility Reference if already referred\nFor Each Ref In References\nIf Ref.Name = \"Accessibility\" Then\nApplication.References.Remove Ref\nEnd If\nNext Ref\n\n'Accessibility Reference Add\nReferences.AddFromFile Environ(\"WINDIR\") &amp; \"\\System32\\oleacc.dll\"\n\nEnd Sub\n</code></pre>\n\n<p>-- Set reference before call procedure for Compact and Repair Database</p>\n\n<pre><code>Sub Chk_Optimization(ByVal ChkSizeByte As Long)\n\nOn Error Resume Next\n\nDim strFileName As String\nDim CurrentSizeByte As Long\n\n'Set Reference\nSet_AccessibilityReference\n\n'Get Current File Size\nstrFileName = Application.CurrentDb.Name\nCurrentSizeByte = FileLen(strFileName)\n\n'File Size Check\nIf CurrentSizeByte &gt; ChkSizeByte Then\n'Call Procedure for Auto Compact And Repair Database\nExec_CompactAndRepairDatabase\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>-- Before extract and export reports, if file exceeds 0.5 GB, then Compact and Repair</p>\n\n<pre><code>Chk_NeedOptimization 536870912\n</code></pre>\n\n<p>Again, I really appreciate Erik von Asmuth and Foxfire And Burns And Burns.</p>\n\n<p>Further advice would be grateful.\nIf anyone notice any issue, please let me know.</p>\n\n<p>Best Regards,</p>\n"}], "owner": {"reputation": 531, "user_id": 9729023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f8e3c8e31f1c9ba929d94ec4e3886a4?s=128&d=identicon&r=PG&f=1", "display_name": "Sachiko", "link": "https://stackoverflow.com/users/9729023/sachiko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533179658, "creation_date": 1533114376, "question_id": 51629355, "link": "https://stackoverflow.com/questions/51629355/how-to-get-referenced-automatically-accessibilitysystem32-oleacc-dll-by-vba", "title": "How to get referenced automatically &#39;Accessibility(System32\\oleacc.dll)&#39; by VBA", "body": "<p>May I ask how to get to know right GUID of 'Accessibility(System32\\oleacc.dll)' for every Access version?</p>\n\n<p>I'd like to get VBA library for 'Accessibility(System32\\oleacc.dll)' automatically, depends on the client Access version, using like script as follows.</p>\n\n<p>&lt; Set Excel library depends on Client Access Version ></p>\n\n<pre><code>Sub Set_RefExcel()\n\nOn Error GoTo Err_Set_RefExcel\n\n Dim Ref As Reference\n Dim AccVer As String\n Dim strExcel As String\n\n 'Once Unset Any Excel Reference\n Call Unset_RefExcel\n\n 'Check Access Vertion\n AccVer = GetAccessVersion 'Get Access Version my Formular\n\n Select Case AccVer\n    Case \"16.0\"\n        strExcel = \"{00020813-0000-0000-C000-000000000046}\"      \n    Case \"15.0\" 'Access2013\n        strExcel = \"{00020813-0000-0000-C000-000000000046}\"\n    Case \"14.0\" 'Access2010\n        strExcel = \"{00020813-0000-0000-C000-000000000046}\"\n    Case Else\n End Select\n\n 'Set Reference\n Set Ref = References.AddFromGuid(strExcel, 1, 3)\n Set Ref = Nothing\n\n Exit Sub\n\nErr_Set_RefExcel:\n If Err.Number = 32813 Then\n Resume Next\n Else\n    MsgBox Err.Number &amp; \" : \" &amp; Err.Description\n    Exit Sub\n End If\n</code></pre>\n\n<p>The reason why I'd like to this is, would like to compact and repair database by VBA, when detect the mdb file getting close to its limit size, 2GB. We need oleacc.dll to use Quick Access ToolBars like following script sample.</p>\n\n<p><a href=\"http://www.ka-net.org/office/of06.html#CompactAndRepairDatabase\" rel=\"nofollow noreferrer\">http://www.ka-net.org/office/of06.html#CompactAndRepairDatabase</a>\n(sorry, it's in all Japanese)</p>\n\n<p>Any advice would be so helpful.</p>\n\n<p>Regards,</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1533111954, "post_id": 51628556, "comment_id": 90221553, "body": "Thanks @Erik von Asmuth - do you mean create a copy and link the users Excel file to the BE copy? Will this be &quot;live&quot; data if I add a record to the original, or would the VBA copy the latest data each time? Or, do you setup a link between the two databases by doing so?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1533112133, "post_id": 51628556, "comment_id": 90221662, "body": "Obviously, you can&#39;t re-encrypt a database without breaking the live connection. Ideally, you would disable access to the original as soon as you&#39;ve made the copy, to force users to use the new copy with the new password. If you still leave the original with the old password around and use VBA to copy changes, you&#39;ve fixed nothing by creating a copy since the data is still available using the old password."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1533112359, "post_id": 51628556, "comment_id": 90221774, "body": "Apologies, I mis-understood the technique - I realise you&#39;re referring to re-pointing the database to change the password, which will work perfectly. Really appreciate the help, thanks!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1533111720, "creation_date": 1533111720, "answer_id": 51628556, "question_id": 51628453, "link": "https://stackoverflow.com/questions/51628453/access-database-cannot-be-opened-exclusively-because-excel-is-reading-from-it-a/51628556#51628556", "title": "Access Database cannot be opened exclusively because Excel is reading from it (as read-only)", "body": "<p>This indeed is a limitation of Access, though it's a usual limitation.</p>\n\n<p>Exclusive access to a database denies people reading it, so it's expected that when people are reading from it, it can't be locked.</p>\n\n<p>You can make a copy from the database without an exclusive lock using the technique I described in <a href=\"https://stackoverflow.com/a/45718616/7296893\">this answer</a>. Then you can adapt the front-ends, which need to be changed anyway to use the new password.</p>\n"}], "owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 51628556, "answer_count": 1, "score": 1, "last_activity_date": 1533111844, "creation_date": 1533111350, "last_edit_date": 1533111844, "question_id": 51628453, "link": "https://stackoverflow.com/questions/51628453/access-database-cannot-be-opened-exclusively-because-excel-is-reading-from-it-a", "title": "Access Database cannot be opened exclusively because Excel is reading from it (as read-only)", "body": "<p>As the above states really; I have a <code>.accdb</code> database that is literally just the BE dataset, that users can link into via Excel, and refresh the data via VBA. </p>\n\n<p>Recently, the BE password was potentially compromised, so we needed to change this. We have over 100 users who daily access the Excel file, which refreshes the data. Even when the day is finished, some users are locked to the file where the link doesn't break, or they stay logged in overnight etc. Unfortunately now, I can't decrypt the BE because it won't allow me to open the database exclusively as it's locked by (whatever machine is linked in first).</p>\n\n<p>Is this a limitation of Access &amp; Excel, that there is no \"live\" link to the database without there being a lock put on it? My string does contain:</p>\n\n<pre><code>Mode=Read;\n</code></pre>\n\n<p>But this unfortunately, still locks the file. I am happy to look into changing the connection process for the database, if there's a more efficient way to do so.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 956, "user_id": 3888657, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d12c5731412a9032b0cf624686dcc843?s=128&d=identicon&r=PG&f=1", "display_name": "TheTanic", "link": "https://stackoverflow.com/users/3888657/thetanic"}, "edited": false, "score": 1, "creation_date": 1533111488, "post_id": 51628419, "comment_id": 90221297, "body": "Could you show, what you already tried?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1533111695, "post_id": 51628419, "comment_id": 90221405, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18464708/comparing-columns-and-highlight-the-matching-data-using-excel-vba\">Comparing Columns and Highlight the Matching Data Using Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1533111798, "creation_date": 1533111798, "answer_id": 51628577, "question_id": 51628419, "link": "https://stackoverflow.com/questions/51628419/match-values-in-excel-and-highlight/51628577#51628577", "title": "Match values in excel and highlight", "body": "<p>I believe the following will do pretty much what you are expecting, it will go from Row 1 to Last on Column N and check whether the sum of two rows is equals 0 and whether they are already highlighted in yellow or not and then it will format the cell as yellow if true:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"N\").End(xlUp).Row\n'get the last row with data on Column N\n\nFor i = 1 To LastRow Step 2 'loop through Column N and calculate Sum every two rows\n    If ws.Cells(i, \"N\").Value + ws.Cells(i + 1, \"N\").Value = 0 And ws.Cells(i, \"N\").Interior.Color &lt;&gt; vbYellow And ws.Cells(i + 1, \"N\").Interior.Color &lt;&gt; vbYellow Then\n        ws.Cells(i, \"N\").Interior.Color = vbYellow\n        ws.Cells(i + 1, \"N\").Interior.Color = vbYellow\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1533120716, "last_edit_date": 1533120716, "creation_date": 1533117807, "answer_id": 51630526, "question_id": 51628419, "link": "https://stackoverflow.com/questions/51628419/match-values-in-excel-and-highlight/51630526#51630526", "title": "Match values in excel and highlight", "body": "<p>If you want it to match any two numbers regardless of their position in the list, but only once per set across a single column - i.e. full reconciliation, you will need something like this:</p>\n\n<pre><code>Sub test()\n    clr = vbYellow\n    Dim ws As Worksheet\n    Set ws = Sheets(\"Sheet1\")\n\n    With ws\n        lastrow = .Cells(.Rows.Count, 14).End(xlUp).Row\n        For i = 1 To lastrow - 1\n            For j = i + 1 To lastrow\n                If .Cells(i, 14).Value = -1 * .Cells(j, 14).Value And .Cells(i, 14).Interior.Color &lt;&gt; clr And .Cells(j, 14).Interior.Color &lt;&gt; clr Then\n                    .Cells(i, 14).Interior.Color = clr\n                    .Cells(j, 14).Interior.Color = clr\n                    Exit For 'include this if the list is long to speed things up\n                End If\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10164517, "user_type": "registered", "profile_image": "https://graph.facebook.com/2405710546113677/picture?type=large", "display_name": "Lorna", "link": "https://stackoverflow.com/users/10164517/lorna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1533415506, "creation_date": 1533111240, "last_edit_date": 1533415506, "question_id": 51628419, "link": "https://stackoverflow.com/questions/51628419/match-values-in-excel-and-highlight", "title": "Match values in excel and highlight", "body": "<p>Updated explanation: </p>\n\n<p>I work with large lists of data containing debits and credits. Some debits and credits need to be matched and highlighted (in order to get them cleared from the list). </p>\n\n<p>I would like a macro to help me with this task i.e. to begin at the start and work down on a line by line basis (I need to be able to manually review the listing to ensure it is correct thus from the necessity to work from start to finish). Taking cell N1 as an example:\n\u2022   If N1 is yellow, do nothing\n\u2022   If N1 has no colour formatting, sum N1 + N2. If N1  N2 = 0, highlight in yellow. \n\u2022   If N1 + N2 does not equal zero, do nothing and move on.\n\u2022   If N2 is yellow, do nothing\n\u2022   If N2 has no colour formatting, sum N2 + N3. If N2 + N3 = 0, highlight in yellow.\n\u2022   And so on. \n\u2022   I would also like this macro to stop when the data set is complete as all empty rows will = zero. Not really sure how that would work?</p>\n\n<p>I have prepared a very simple example (attached) which has three tabs: \n1.  Sample data set\n2.  Data set where I have populated absolute values, sorted from smallest to largest\n3.  The desired end result. As you can see, there are several instances where there is no offsetting item and the macro would need to skip. </p>\n\n<p>Thanks again for your help! <a href=\"https://i.stack.imgur.com/sdzsm.jpg\" rel=\"nofollow noreferrer\">Sample</a></p>\n"}, {"tags": ["excel", "vba", "database", "excel-formula"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1533110749, "post_id": 51628240, "comment_id": 90220874, "body": "Try using Power Query. Minimise your column count, and sort your index columns."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1533110838, "post_id": 51628240, "comment_id": 90220928, "body": "Use another program: we used SAS to process large amounts of data - disadvantage is that the learning curve is steep ... there are both advantages and disadvantages.."}, {"owner": {"reputation": 1, "user_id": 10164469, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156358285636145/picture?type=large", "display_name": "Cillian Kane", "link": "https://stackoverflow.com/users/10164469/cillian-kane"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1533111025, "post_id": 51628240, "comment_id": 90221037, "body": "@Olly Hey thanks for the response, would reducing column count matter if the formula is only referencing those 200k rows?"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1533111096, "post_id": 51628240, "comment_id": 90221075, "body": "@CillianKane If you&#39;re loading tables to Power Query, and you&#39;re only interested in matching values between two lists, then there&#39;s no need to load all the other columns into your query tables."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533111334, "post_id": 51628240, "comment_id": 90221213, "body": "@CillianKane - That&#39;s a pretty vague problem description. Is this <b><i>only</i></b> a dataset or is this a giant workbook full of formulas? If so, is there any chance the formulas aren&#39;t planned as efficiently as they could be?  200k &quot;typical&quot; records shouldn&#39;t be an issue -- how much data/how many fields are in each record? <b><i>How</i></b> are you doing this lookup? Please share your formula/code."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1533111470, "post_id": 51628240, "comment_id": 90221285, "body": "What formula are you actually using to look up? match?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533111760, "post_id": 51628240, "comment_id": 90221441, "body": "You can <a href=\"https://stackoverflow.com/posts/51628240/edit\">edit</a> your question to provide more information. Also, check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (you&#39;ll earn your 1st badge!) and also check out &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;, as well as the tips here about posting a <b><a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b>  Also @CillianKane <i>Welcome to Stack Overflow!</i>  :-)"}, {"owner": {"reputation": 1, "user_id": 10164469, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156358285636145/picture?type=large", "display_name": "Cillian Kane", "link": "https://stackoverflow.com/users/10164469/cillian-kane"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1533112433, "post_id": 51628240, "comment_id": 90221802, "body": "@jamheadart Hi, =countif($A$1:$A$200000,G1)&gt;0 would be an example of what I am currently using."}, {"owner": {"reputation": 1, "user_id": 10164469, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156358285636145/picture?type=large", "display_name": "Cillian Kane", "link": "https://stackoverflow.com/users/10164469/cillian-kane"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533112538, "post_id": 51628240, "comment_id": 90221858, "body": "@ashleedawg  It is literally just lookup references, eg. jkl0254, 150,000 of those vs 5,000,000 of codes just like that."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533113017, "post_id": 51628240, "comment_id": 90222129, "body": "@CillianKane -That&#39;s you&#39;re only formula?  So you&#39;re only returning <code>TRUE</code>/<code>FALSE</code>? And you have exactly 200k rows?"}, {"owner": {"reputation": 1, "user_id": 10164469, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156358285636145/picture?type=large", "display_name": "Cillian Kane", "link": "https://stackoverflow.com/users/10164469/cillian-kane"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533113825, "post_id": 51628240, "comment_id": 90222570, "body": "@ashleedawg My thinking was if I do it for only 200k rows at a time, excel would be able to handle it. I have about 15 columns, each with 200k in it. I was just going to do them one at a time, but it still crashes - or takes a ridiculous amount of time. And yes returning True/False"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1533115616, "post_id": 51628240, "comment_id": 90223696, "body": "For a start, have you tried MATCH? e.g. <code>=MATCH(G1,$A$1:$A$200000,0)</code> - I think it might be faster since it won&#39;t have to count all instances - it&#39;ll return a number instead of <code>true</code> and <code>#N&#47;A</code> instead of <code>false</code>"}, {"owner": {"reputation": 1, "user_id": 10164469, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156358285636145/picture?type=large", "display_name": "Cillian Kane", "link": "https://stackoverflow.com/users/10164469/cillian-kane"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1533117054, "post_id": 51628240, "comment_id": 90224682, "body": "@jamheadart Thanks for the continued help Jamheadart.  The thing is the chance of it being within the 200k are slim so the match formula will still have to check every cell, only when it returns true (which is unlikely) will it save time, I have just tried it and although an improvement its not a viable alternative! But thank you all the same!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533117065, "post_id": 51628240, "comment_id": 90224694, "body": "@CillianKane - what is the end goal?  Do you just need to know if the ID# exists in the data?  If so why are you counting every row (or using a counting function at all instead of a lookup function)?  It would be very helpful if your question included an <b>sample of your data</b> and an example of your <i>end-goal</i>.  Surely you&#39;re not finished once you get a list of <code>TRUE</code>/<code>FALSE</code>? (Seems like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem/66378#66378\">XY Problem</a>.)  There&#39;s a lot of time being wasted by not including all relevant information in this question."}, {"owner": {"reputation": 1, "user_id": 10164469, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156358285636145/picture?type=large", "display_name": "Cillian Kane", "link": "https://stackoverflow.com/users/10164469/cillian-kane"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1533117349, "post_id": 51628240, "comment_id": 90224894, "body": "@ashleedawg Indeed Ashleedawg I just need to know if it exists, basically taken the lookup references from companies on our crm and need to compare them to a GDPR Compliant List. Once I have a list of True/False I will be done - apart from reimporting to our crm and deleting all Falses!"}], "answers": [{"tags": [], "owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "is_accepted": false, "score": 1, "last_activity_date": 1533115085, "creation_date": 1533115085, "answer_id": 51629600, "question_id": 51628240, "link": "https://stackoverflow.com/questions/51628240/excel-cant-cope-with-large-data-set-need-to-lookup/51629600#51629600", "title": "Excel cant cope with large data set - need to lookup", "body": "<p>Since you don't have any code here, I could provide one example from a code I recentrly wrote. Maybe you can get an idea how to handle your problem.</p>\n\n<blockquote>\n<pre><code>        Dim rFoundCell As Range                                               \n        Dim the_string As String\n\n        Set xFoundCell = Sheets(\"Database\").Range(\"B1:B100000\").Find(Userform.Something, \n        LookAt:=xlPart, MatchCase:=False)\n        Sheets(\"ED\").Range(\"B2\") = xFoundCell.Address                                       \n        the_string = Sheets(\"ED\").Range(\"B2\")                                               \n        the_string = Replace(the_string, \"B\", \"\")                                           \n        the_string = Replace(the_string, \"$\", \"\")                                           \n        Sheets(\"ED\").Range(\"B2\") = the_string\n</code></pre>\n</blockquote>\n\n<p>This is a part of my code which is used to get the adress of my cell.\nYou could customize something like this in a loop and lookup all your cells.</p>\n\n<p>Hope this can help you\nBest regards</p>\n"}], "owner": {"reputation": 1, "user_id": 10164469, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156358285636145/picture?type=large", "display_name": "Cillian Kane", "link": "https://stackoverflow.com/users/10164469/cillian-kane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594211127, "creation_date": 1533110524, "last_edit_date": 1594211127, "question_id": 51628240, "link": "https://stackoverflow.com/questions/51628240/excel-cant-cope-with-large-data-set-need-to-lookup", "title": "Excel cant cope with large data set - need to lookup", "body": "<p>So I have a data set of about 150k lookup references. I am trying to see if at any point these appear in my other dataset of around 4 Million. </p>\n\n<p>If so, return true. Anything that returns false will be deleted from our crm.</p>\n\n<p>I am currently just trying lookups of the 150k against 200k at a time but it still keeps crashing...</p>\n\n<p>Does anyone have any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1533107217, "post_id": 51627188, "comment_id": 90218904, "body": "You could use ADODB for it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1533107574, "post_id": 51627188, "comment_id": 90219116, "body": "You could start by changing to <code>myRow = i</code>. Resetting your increment counter to zero when you find a match probably means that runs forver if a single match is found."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1533114576, "post_id": 51627188, "comment_id": 90223024, "body": "Use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">Find</a>.  Find <i>value1</i> in column A and then check the offset from the returned cell references to see if <i>value2</i> and <i>value3</i> are also present.  It&#39;s very fast and plenty of examples on SO."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4183953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbdd9b96da74593a3020aebf18fc752b?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4183953/harry"}, "edited": false, "score": 0, "creation_date": 1533109953, "post_id": 51627588, "comment_id": 90220439, "body": "Thanks, that looks good. Do you have any experience on its performance? is it faster than iterating through the range ?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 25, "user_id": 4183953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbdd9b96da74593a3020aebf18fc752b?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4183953/harry"}, "edited": false, "score": 0, "creation_date": 1533116907, "post_id": 51627588, "comment_id": 90224574, "body": "I do not think you will have any real performance issues with 100, 1000 or maybe 10000 records regardless if you use the solution with ADODB or looping through the range. But, of course, at the end it depends on the number of records? How many we are talking about?"}, {"owner": {"reputation": 25, "user_id": 4183953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbdd9b96da74593a3020aebf18fc752b?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4183953/harry"}, "edited": false, "score": 0, "creation_date": 1533118271, "post_id": 51627588, "comment_id": 90225486, "body": "about 10.000. i used ado already this environment and I experienced that building the connection itself takes a few seconds, if the source is on a network drive which is the case now."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 25, "user_id": 4183953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbdd9b96da74593a3020aebf18fc752b?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4183953/harry"}, "edited": false, "score": 0, "creation_date": 1533119209, "post_id": 51627588, "comment_id": 90226053, "body": "You had a look at my code, did you not? I assume the data is in the same excel sheet as you described in your post, so the codes connects to an already open sheet which does not take seconds. The code which iterates through the data also accesses data from an open worksheet."}, {"owner": {"reputation": 25, "user_id": 4183953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbdd9b96da74593a3020aebf18fc752b?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4183953/harry"}, "edited": false, "score": 0, "creation_date": 1533124864, "post_id": 51627588, "comment_id": 90229590, "body": "That&#39;s correct, the case I was talking about was about an other case with excel, so is not valid for this situation. Thank you for your help."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1533108716, "last_edit_date": 1533108716, "creation_date": 1533108363, "answer_id": 51627588, "question_id": 51627188, "link": "https://stackoverflow.com/questions/51627188/find-a-specific-row-in-a-excel-range-with-vba/51627588#51627588", "title": "Find a specific row in a excel range with vba", "body": "<p>You could use the following approach with ADODB</p>\n\n<pre><code>Option Explicit\n\nSub ReadFromWorksheetADO()\nDim conn As New ADODB.Connection\n\n    ' Assuming there is no header \n    conn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" _\n              &amp; ThisWorkbook.FullName &amp; \";Extended Properties=\"\"Excel 12.0;HDR=NO;\"\";\"\n\n    Dim query As String\n    ' The sheet with the data should have the name Sheet1\n    ' query = \"Select * From [Sheet1$]\"\n    query = \"Select F1,F2,F3 From [Sheet1$]\"\n\n    Dim rs As New ADODB.Recordset\n    rs.Open query, conn\n    rs.Filter = \"F1='value1' AND F2 ='value2' AND F3 ='value'\"\n\n    ' Add a sheet with codename shResult\n    ' only needed for test purposes\n    ' to show the result\n    With shResult\n        .Cells.ClearContents\n        Dim i As Long\n        For i = 0 To rs.Fields.Count - 1\n            .Cells(1, i + 1).Value = rs.Fields(i).Name\n        Next i\n        .Range(\"A2\").CopyFromRecordset rs\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4183953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbdd9b96da74593a3020aebf18fc752b?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4183953/harry"}, "edited": false, "score": 0, "creation_date": 1533110063, "post_id": 51627651, "comment_id": 90220514, "body": "Thanks a lot for the answer, I will try it."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1533109237, "last_edit_date": 1533109237, "creation_date": 1533108543, "answer_id": 51627651, "question_id": 51627188, "link": "https://stackoverflow.com/questions/51627188/find-a-specific-row-in-a-excel-range-with-vba/51627651#51627651", "title": "Find a specific row in a excel range with vba", "body": "<p>Try this (necessary comments in code):</p>\n\n<pre><code>Sub fi()\n    Dim lastRow As Long, foundRange As Range\n    'this will find last row for you, don't need to hard-code it\n    lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    'I used nested ifs, as it will boost the performance\n    'it will stop checking next conditions if preceding condition fail\n    For i = 1 To lastRow\n        If Cells(i, 1) = \"value1\" Then\n        If Cells(i, 3) = \"value2\" Then\n        If Cells(i, 4) = \"value3\" Then\n            'add columns A through J to foundRange\n            If foundRange Is Nothing Then\n                Set foundRange = Range(Cells(i, 1), Cells(i, 10))\n            Else\n                Set foundRange = Union(foundRange, Range(Cells(i, 1), Cells(i, 10)))\n            End If\n        End If\n        End If\n        End If\n    Next i\n    foundRange.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4183953, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbdd9b96da74593a3020aebf18fc752b?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/4183953/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "accepted_answer_id": 51627651, "answer_count": 2, "score": 0, "last_activity_date": 1594154695, "creation_date": 1533106839, "last_edit_date": 1594154695, "question_id": 51627188, "link": "https://stackoverflow.com/questions/51627188/find-a-specific-row-in-a-excel-range-with-vba", "title": "Find a specific row in a excel range with vba", "body": "<p>I need to find rows on a sheet that meet given criteria(s).\nI saw several times that authors perform this by filtering based on the search criteria but I don't like this method, so I am using something like this.</p>\n\n<pre><code>Sub fi()\n    Dim lastRow As Long\n    lastRow = 100\n    Dim myRow As Long\n    For i = 1 To lastRow\n        If Cells(i, 1) = \"value1\" And Cells(i, 3) = \"value2\" And Cells(i, 4) = \"value3\" Then\n            i = myRow\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Does any of you have some good practice to do it on more efficient way? \nThese are a kind of orders with 10 cells by row, but I can find what I need based on three of them. It is s typical sql select statement, but here I cannot use sql.\nthanks</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533106522, "post_id": 51627032, "comment_id": 90218533, "body": "Could you please show exactly what info you are after? Which  Name, Address, Tel and Website? Also, you are using a loop... are there more pages to scrape? Can you show another one as well please?"}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1533106868, "post_id": 51627032, "comment_id": 90218719, "body": "@QHarr1 , hi thanks for quick response. I am after ( Impact Hub Honolulu, 1050 Queen Street #100, Honolulu, United States, +8086643306 and <a href=\"http://www.impacthubhnl.com/?ref=coworker\" rel=\"nofollow noreferrer\">impacthubhnl.com/?ref=coworker</a>) these 4 bits of info. Yes, there are similar more urls and all have same html. <a href=\"https://www.coworker.com/s-f/7254/united-states_south-carolina_north-myrtle-beach_carolina-business-center\" rel=\"nofollow noreferrer\">coworker.com/s-f/7254/&hellip;</a> And i want this loop to continue after getting info from 1st one"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1533109082, "post_id": 51627277, "comment_id": 90220001, "body": "Bro, this is giving me out of Memory Error  here  sResponse = StrConv(.responseBody, vbUnicode)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1533109124, "post_id": 51627277, "comment_id": 90220028, "body": "That shouldn&#39;t be down to the script above. Have you been opening lots of IE instances and not quitting them?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1533111793, "post_id": 51627277, "comment_id": 90221459, "body": "I updated with an Internet Explorer browser based version."}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1533112989, "post_id": 51627277, "comment_id": 90222113, "body": "Don&#39;t know if i am doing something wrong but none are working . Tried both codes. I am using office 365 64 bit with windows 10 64 bit"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1533113835, "post_id": 51627277, "comment_id": 90222585, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/177165/discussion-between-qharr-and-raj\">continue this discussion in chat</a>."}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1533537053, "post_id": 51627277, "comment_id": 90364492, "body": "Yes Bro @QHarr. Thank you very much."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1533537113, "post_id": 51627277, "comment_id": 90364528, "body": "Good. Happy days  :-)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1533443533, "last_edit_date": 1592644375, "creation_date": 1533107179, "answer_id": 51627277, "question_id": 51627032, "link": "https://stackoverflow.com/questions/51627032/parsing-html-with-vba/51627277#51627277", "title": "Parsing HTML with VBA", "body": "<p>Here you go. Without more links to test with this is very fragile. It relies heavily on consistent styling across pages.</p>\n<hr />\n<h2>XHR Looping link list:</h2>\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim wsSheet As Worksheet, Rows As Long, links(), link As Long, wb As Workbook, html As HTMLDocument\n    Set wb = ThisWorkbook: Set wsSheet = wb.Sheets(&quot;Sheet1&quot;)\n    Application.ScreenUpdating = False\n   \n    With wsSheet\n        Rows = .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row\n        If Rows = 1 Then\n            ReDim links(1 To 1, 1 To 1)\n            links(1, 1) = wsSheet.Range(&quot;A1&quot;)\n        Else\n            links = wsSheet.Range(&quot;A1:A&quot; &amp; Rows).Value\n        End If\n        Dim r As Long\n        For link = LBound(links, 1) To UBound(links, 1)\n            r = r + 1\n            Set html = GetHTML(links(link, 1))\n            On Error Resume Next\n            Dim aNodeList As Object: Set aNodeList = html.querySelectorAll(&quot;.col-xs-12.pade_none.muchroom_mail&quot;)\n            .Cells(r, 2) = &quot;Name: &quot; &amp; html.querySelector(&quot;.col-sm-9.col-md-9.col-xs-12.pade_none.kohub_space_headings h2&quot;).innerText\n            .Cells(r, 3) = &quot;Address: &quot; &amp; aNodeList.item(0).innerText\n            .Cells(r, 4) = &quot;Tel: &quot; &amp; aNodeList.item(1).innerText\n            .Cells(r, 5) = &quot;Website: &quot; &amp; html.querySelector(&quot;.website-link-text a[href]&quot;).getAttribute(&quot;href&quot;)\n             On Error GoTo 0\n        Next link\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Function GetHTML(ByVal url As String) As HTMLDocument\n    Dim sResponse As String, html As New HTMLDocument\n    With CreateObject(&quot;MSXML2.XMLHTTP&quot;)\n        .Open &quot;GET&quot;, url, False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n    sResponse = Mid$(sResponse, InStr(1, sResponse, &quot;&lt;!DOCTYPE &quot;))\n   \n    With html\n        .body.innerHTML = sResponse\n    End With\n    Set GetHTML = html\nEnd Function\n</code></pre>\n<hr />\n<p><strong>Output:</strong></p>\n<p><a href=\"https://i.stack.imgur.com/fKPkY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fKPkY.png\" alt=\"output\" /></a></p>\n<hr />\n<p><strong>References (VBE&gt;Tools&gt;References):</strong></p>\n<ol>\n<li>HTML object Library</li>\n</ol>\n<hr />\n<h2>Internet Explorer:</h2>\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim wsSheet As Worksheet, Rows As Long, links(), link As Long, wb As Workbook, html As HTMLDocument, ie As InternetExplorer\n    Set wb = ThisWorkbook: Set wsSheet = wb.Sheets(&quot;Sheet1&quot;)\n    Application.ScreenUpdating = False\n    With wsSheet\n        Rows = .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row\n        If Rows = 1 Then\n            ReDim links(1, 1)\n            links(1, 1) = wsSheet.Range(&quot;A1&quot;)\n        Else\n            links = wsSheet.Range(&quot;A1:A&quot; &amp; Rows).Value\n        End If\n        Dim r As Long\n        \n        Set ie = New InternetExplorer\n        ie.Visible = True\n\n        For link = LBound(links, 1) To UBound(links, 1)\n            ie.navigate links(link, 1)\n            While ie.Busy Or ie.readyState &lt; 4: DoEvents: Wend\n          '  Application.Wait Now + TimeSerial(0, 0, 10)\n            On Error Resume Next\n            r = r + 1: Set html = ie.document\n            .Cells(r, 2) = &quot;Name: &quot; &amp; html.querySelector(&quot;.col-sm-9.col-md-9.col-xs-12.pade_none.kohub_space_headings h2&quot;).innerText\n            .Cells(r, 3) = &quot;Address: &quot; &amp; html.querySelector(&quot;.col-xs-12.pade_none.muchroom_mail&quot;).innerText\n            .Cells(r, 4) = &quot;Tel: &quot; &amp; html.querySelector(&quot;.fa.fa-phone.fa-rotate-270 ~ a&quot;).innerText\n            .Cells(r, 5) = &quot;Website: &quot; &amp; html.querySelector(&quot;.website-link-text a[href]&quot;).getAttribute(&quot;href&quot;)\n            On Error GoTo 0\n        Next link\n        ie.Quit\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n<hr />\n<p><strong>References (VBE&gt;Tools&gt;References):</strong></p>\n<ol>\n<li>HTML object Library</li>\n<li>Microsoft Internet Controls</li>\n</ol>\n<hr />\n"}], "owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 51627277, "answer_count": 1, "score": 3, "last_activity_date": 1533443533, "creation_date": 1533106270, "last_edit_date": 1533111592, "question_id": 51627032, "link": "https://stackoverflow.com/questions/51627032/parsing-html-with-vba", "title": "Parsing HTML with VBA", "body": "<p>I am trying to pull data from some 500 urls of a website. All the pages are same in structure. I am facing a problem with understanding the HTML of this particular site</p>\n\n<pre><code>https://www.coworker.com/s-f/6033/united-states_hawaii_honolulu_impact-hub-honolulu\n</code></pre>\n\n<p>I want to extract Name, Address, Tel and website. My current code:</p>\n\n<pre><code>Sub GetData()\n    Dim wsSheet As Worksheet, Rows As Long, links As Variant, IE As Object, link As Variant\n    Set wb = ThisWorkbook\n    Set wsSheet = wb.Sheets(\"Sheet1\")\n\n    Set IE = New InternetExplorer\n\n    Rows = wsSheet.Cells(wsSheet.Rows.Count, \"A\").End(xlUp).Row\n    links = wsSheet.Range(\"A1:A\" &amp; Rows)\n\n    With IE\n        .Visible = True\n        For Each link In links\n            .navigate (link)\n            While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1533107019, "post_id": 51626744, "comment_id": 90218801, "body": "I have a vba script that takes sheets from 6 master files and outputs them - 40 sets in all... so have a look and see if you can adapt it to your needs - if it helps an up vote would be appreciated : <a href=\"https://stackoverflow.com/a/30605765/4961700\">stackoverflow.com/a/30605765/4961700</a>"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1533109636, "post_id": 51626744, "comment_id": 90220299, "body": "Target file must be open to copy to. So comment <code>ActiveWorkbook.Close</code> above and it should work. You can find  a good example for programming validation here: <a href=\"https://stackoverflow.com/questions/22956604/how-to-add-data-validation-to-a-cell-using-vba\" title=\"how to add data validation to a cell using vba\">stackoverflow.com/questions/22956604/&hellip;</a>"}, {"owner": {"reputation": 1526, "user_id": 1324765, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/49dbfd8834d69e780c017b8dc9e391e0?s=128&d=identicon&r=PG", "display_name": "ZelelB", "link": "https://stackoverflow.com/users/1324765/zelelb"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1533113076, "post_id": 51626744, "comment_id": 90222169, "body": "@AcsErno no, I tried that before, and now again, but that&#39;s not the problem. Still bugging at that line. Maybe I cannot give a path to &quot;Workbooks&quot; as argument or something? PS: as you can see, &quot;vFilter&quot; is just the filename of the splitted file from original. So its a string"}], "owner": {"reputation": 1526, "user_id": 1324765, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/49dbfd8834d69e780c017b8dc9e391e0?s=128&d=identicon&r=PG", "display_name": "ZelelB", "link": "https://stackoverflow.com/users/1324765/zelelb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533105706, "creation_date": 1533105250, "last_edit_date": 1533105706, "question_id": 51626744, "link": "https://stackoverflow.com/questions/51626744/how-to-copy-a-sheet-from-one-workbook-to-another", "title": "How to copy a sheet from one workbook to another?", "body": "<p>I'm new to VBA, and using a macro to split a workbook into many files, based on some criteria, and then split that files again in multiple sheets, based on other criteria. </p>\n\n<p>After splitting the end file into multiple sheets, I want to copy a sheet from the main file, to every destination file, and this copied sheet should be at the end of all other newly created sheets in the new files. </p>\n\n<p>My code is having a problem with the line I am trying to copy that sheet with. If I don't try to copy that sheet at the end of the code, every thing works fine, and I get many destination files splitted into multiple sheets inside. If I try to add the line of code to copy the sheet I need to be copied as it is, I get just one destination file (1st split) and the code bugs at that line. </p>\n\n<p>Here is the whole code to do so: </p>\n\n<pre><code>Sub Split()\n\nDim wswb As String\nDim wssh As String\n\nwswb = ActiveWorkbook.Name\nwssh = ActiveSheet.Name\n\nvColumn = InputBox(\"Please indicate which column you would like to split by\", \"Column selection\")\n\nColumns(vColumn).Copy\nSheets.Add\nActiveSheet.Name = \"_Summary\"\nRange(\"A1\").PasteSpecial\nColumns(\"A\").RemoveDuplicates Columns:=1, Header:=xlYes\n\nvCounter = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To vCounter\n    vFilter = Sheets(\"_Summary\").Cells(i, 1)\n    Sheets(wssh).Activate\n    ActiveSheet.Columns.AutoFilter field:=6, Criteria1:=\"100%\"\n    ActiveSheet.Columns.AutoFilter field:=Columns(vColumn).Column, Criteria1:=vFilter\n    Cells.Copy\n    Workbooks.Add\n    Range(\"A1\").PasteSpecial\n\n    ActiveSheet.Name = \"Master\"\n\n\n    dspColumn = \"D\"\n\n\n    Columns(dspColumn).Copy\n    Sheets.Add\n    ActiveSheet.Name = \"dspSummary\"\n    Range(\"A1\").PasteSpecial\n    Columns(\"A\").RemoveDuplicates Columns:=1, Header:=xlYes\n\n    dspCounter = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Splitcode = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For j = 2 To dspCounter\n        dspFilter = Sheets(\"dspSummary\").Cells(j, 1)\n        Sheets(\"Master\").Activate\n        ActiveSheet.Columns.AutoFilter field:=Columns(dspColumn).Column, Criteria1:=dspFilter\n        Cells.Copy\n        Sheets.Add\n        ActiveSheet.Name = Left(dspFilter, 30)\n\n        Range(\"A1\").PasteSpecial\n    Next j\n    Sheets(\"Master\").Delete\n    Sheets(\"dspSummary\").Delete\n\n    If vFilter &lt;&gt; \"\" Then\n        ActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\Split Results\\\" &amp; vFilter\n    Else\n        ActiveWorkbook.SaveAs ThisWorkbook.Path &amp; \"\\Split Results\\_Empty\"\n    End If\n\n\n    ActiveWorkbook.Close\n    Workbooks(wswb).Activate\n    Sheets(\"Reasons codes\").Copy After:=Workbooks(ThisWorkbook.Path &amp; \"\\Split Results\\\" &amp; vFilter &amp; \".xlsx\").Sheets(Sheets.Count)\nNext i\nSheets(\"_Summary\").Delete\n\nEnd Sub\nSub SplitM()\n\nEnd Sub\n</code></pre>\n\n<p>the line which is bugging is this one: </p>\n\n<pre><code>Sheets(\"Reasons codes\").Copy After:=Workbooks(ThisWorkbook.Path &amp; \"\\Split Results\\\" &amp; vFilter &amp; \".xlsx\").Sheets(Sheets.Count)\n</code></pre>\n\n<p>Without it everything works fine, and no bugging. With that line added, just one file created, and the sheet that I want to copy at the end of the loops doesn't get copied of course, and I get a bug at that line. </p>\n\n<p>What I am actually trying to do before that line, is to get the main Workbook, activate it, and copy a sheet called \"Reasons code\" from it, to every split file I created, at the very end of the sheets (also splitted with a loop from the destination file) created in that destination file. </p>\n\n<p>And by the way, the column \"G\" in the main (original) file, and original sheet I am splitting from, has some data validation, linked to the sheet \"Reasons codes\" I am trying to copy. So if you have a solution also, how to link that column in the new sheets of the new files, after of course copying the \"Reasons codes\" sheet to each destination file, that would be REALLY great! Actually every splitted sheet in the new (splitted / destination) files, has also at column \"G\" the same content as the main sheet in the main file I am copying from. It is just pasting now the text, but when I look at the data validation, I find that it is linked to the main file name, and to that \"Reasons codes\" of the main file, that's why the validation is not working. Every row should be rather linked to a new created \"Reasons codes\" sheet in the same file.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 2721386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c61a2cf3143939a4f6ee77c70a143edc?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2721386/florian"}, "is_accepted": false, "score": 0, "last_activity_date": 1533124609, "last_edit_date": 1533124609, "creation_date": 1533115028, "answer_id": 51629573, "question_id": 51626735, "link": "https://stackoverflow.com/questions/51626735/self-updating-excel-vba-dashboard-cycling-through-graphs/51629573#51629573", "title": "Self updating Excel/VBA dashboard, cycling through graphs", "body": "<p>I found a way, that's a bit smoother but maybe not the greatest.</p>\n\n<ul>\n<li><p>It doesn't allow for a smooth interruption of the loop.</p></li>\n<li><p>it's sometimes a bit slow updating  </p></li>\n</ul>\n\n<hr>\n\n<pre><code>Sub UpdateEverything()\n\n    'sets the start and wait time\n    startTime = Now\n    updateTime = \"00:00:10\"\n    l = 0\n\n    Do While True\n        'update counter\n        l = l + 1\n\n        'refresh\n        Workbooks(\"Dashboard\").RefreshAll\n        Debug.Print \"I was still running at \" &amp; Now &amp; \" and I started at \" &amp; startTime\n        Debug.Print \"loop #\" &amp; l &amp; \" and i #\" &amp; i\n\n        For Each c In Charts\n\n            'show next graph\n            c.Activate\n            'wait a bit\n            Application.Wait Now + TimeValue(updateTime)\n\n        Next\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 2721386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c61a2cf3143939a4f6ee77c70a143edc?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2721386/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533124609, "creation_date": 1533105192, "last_edit_date": 1533124452, "question_id": 51626735, "link": "https://stackoverflow.com/questions/51626735/self-updating-excel-vba-dashboard-cycling-through-graphs", "title": "Self updating Excel/VBA dashboard, cycling through graphs", "body": "<p>I have a little wall mounted PC with office installed and screen which should display a couple of graphs which are cycled through and refreshed in 5 minute intervals.</p>\n\n<p>In the same folder I created a spreadsheet running on a server into which Reuters dumps data every day, and the \"Dashboard\" spreadsheet.</p>\n\n<p>I linked a sheet in the Dashboard to the Data import workbook to synchronise data and ran the following VBA code.</p>\n\n<pre><code>Sub UpdateEverything()\n\n    startTime = Now\n    Workbooks(\"Dashboard\").RefreshAll\n    Application.OnTime Now + TimeValue(\"00:05:00\"), \"UpdateEverything\"\n    Debug.Print \"I'm still running at \" &amp; Now &amp; \" and I started at \" &amp; startTime\n\nEnd Sub\n</code></pre>\n\n<p>Questions:\n- Is there a better method.</p>\n\n<ul>\n<li>How to cycle through the sheets containing the full screen graphs?</li>\n<li>How can I show graphs truly full screen, not just a maximised excel window</li>\n</ul>\n\n<p>Thanks</p>\n"}]