[{"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "edited": false, "score": 0, "creation_date": 1523492411, "post_id": 49786019, "comment_id": 86587731, "body": "I was trying something similar to answer this question and I got the same error."}, {"owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "edited": false, "score": 0, "creation_date": 1523522362, "post_id": 49786019, "comment_id": 86598107, "body": "There&#39;s still an error on the line Set rng2 = rng2.Offset(-1) Says the same, &quot;Requires an Object&quot;"}, {"owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "edited": false, "score": 0, "creation_date": 1523653014, "post_id": 49786019, "comment_id": 86665858, "body": "@cars10m, thank you for your edit, and yes, it solves the problem, but, when it reach to the &quot;Componente&quot; Row, it delete it, and it shouldn&#39;t. But i&#39;m trying to figure it out how to solve it. Thank you so much!"}, {"owner": {"reputation": 16103, "user_id": 2610061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa4474d4e3352d1f9da8f52df42db95?s=128&d=identicon&r=PG", "display_name": "cars10m", "link": "https://stackoverflow.com/users/2610061/cars10m"}, "edited": false, "score": 0, "creation_date": 1523656971, "post_id": 49786019, "comment_id": 86667086, "body": "I just noticed that I checked the wrong column to be empty! You need to check whether <code>row.Range(&quot;a1&quot;)</code> is empty instead of <code>&quot;b1&quot;</code>! Just changed it in the post."}], "tags": [], "owner": {"reputation": 16103, "user_id": 2610061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa4474d4e3352d1f9da8f52df42db95?s=128&d=identicon&r=PG", "display_name": "cars10m", "link": "https://stackoverflow.com/users/2610061/cars10m"}, "is_accepted": true, "score": 0, "last_activity_date": 1523656987, "last_edit_date": 1523656987, "creation_date": 1523491069, "answer_id": 49786019, "question_id": 49785698, "link": "https://stackoverflow.com/questions/49785698/move-a-range-with-offset/49786019#49786019", "title": "Move a Range with offset", "body": "<p>You can't <code>.offset()</code> a range that has been deleted before. Try this instead (not tested, I am answering on a smartphone):</p>\n\n<pre><code>With rng\n    For i = .Rows.Count To 1 Step -1\n        If .Item(i) = \"\" Then\n           set tmp=rng2\n           tmp.Delete Shift:=xlUp\n        End If\n        Set rng2 = rng2.Offset(-1)\n    Next i\nEnd With\n</code></pre>\n\n<p>The <code>rng2.offset(-1)</code> (the second argument, 0, is optional) should not be inside the if-clause.</p>\n\n<p>There is also no need to <code>.select</code> a range before deleting it. In fact, leaving this step out could improve the performance of your script.</p>\n\n<p><strong>Edit</strong>:<br>\nWell, as @Matto quite rightly remarked, my former solution still did not work. So I had another look at it and modified the whole sub as follows:</p>\n\n<pre><code>Sub rowOffset()\n Dim rng As Range, row As Range, i%\n Set rng = [c37:n85]\n For i = rng.Rows.Count To 1 Step -1\n   Set row = rng.Rows.Item(i)\n   If row.Range(\"a1\") = \"\" Then row.Delete shift:=xlUp\n Next i\nEnd Sub\n</code></pre>\n\n<p>I think this is shorter anyway ... and <em>it works</em> (tested).</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "edited": false, "score": 0, "creation_date": 1523522320, "post_id": 49786051, "comment_id": 86598083, "body": "This line contains errors  Set r2 = .Cells(.Rows.Count, 2).End(xlUp).Offset(-2, 0)  Error 1004  &quot;Application-defined or Object-defined error&quot; when selecting the range."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "edited": false, "score": 0, "creation_date": 1523528892, "post_id": 49786051, "comment_id": 86602582, "body": "Did you check the assumptions I stated in the answer?"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1523491321, "creation_date": 1523491321, "answer_id": 49786051, "question_id": 49785698, "link": "https://stackoverflow.com/questions/49785698/move-a-range-with-offset/49786051#49786051", "title": "Move a Range with offset", "body": "<p>The reason your code errors is because after <code>rng2.Delete ...</code> <code>rng2</code> no longer points to a valid range (because you just deleted it).</p>\n\n<p>That said a better approach would be to first identify the range to delete, then delete it in one go.</p>\n\n<p>Something like this (assumes your first data is in column B)</p>\n\n<pre><code>Sub Demo()\n    Dim r1 As Range, r2 As Range\n\n    With ThisWorkbook.ActiveSheet\n        ' Find Total row\n        '  assumes there is no other data below the table in Column B\n        Set r2 = .Cells(.Rows.Count, 2).End(xlUp).Offset(-2, 0)\n        If IsEmpty(r2) Then\n            ' Find the last row of data\n            Set r1 = r2.End(xlUp).Offset(1, 0)\n            .Range(r1, r2).EntireRow.Delete\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1709, "user_id": 7761488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/269b1437ab589a3528f1dae453c3dd77?s=128&d=identicon&r=PG&f=1", "display_name": "iSpain17", "link": "https://stackoverflow.com/users/7761488/ispain17"}, "is_accepted": false, "score": 0, "last_activity_date": 1523530240, "creation_date": 1523530240, "answer_id": 49794642, "question_id": 49785698, "link": "https://stackoverflow.com/questions/49785698/move-a-range-with-offset/49794642#49794642", "title": "Move a Range with offset", "body": "<pre><code>Range(\u201cC35\u201d).End(xlDown).Offset(1,0) \n</code></pre>\n\n<p>will give you the first cell in the first row to delete.</p>\n\n<p>Then</p>\n\n<pre><code>Range(\u201cC35\u201d).End(xlToRight).End(xlDown).End(xlDown).Offset(-2,0)\n</code></pre>\n\n<p>Will give you the bottom right cell in the area that you want to delete.</p>\n\n<p>So, set these two cells into variables (e.g. cell1 and cell2).\nThen:</p>\n\n<pre><code>Range(cell1, cell2).Delete Shift:=xlUp \n</code></pre>\n\n<p>will land you at the result.</p>\n"}], "owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 49786019, "answer_count": 3, "score": -1, "last_activity_date": 1523656987, "creation_date": 1523488417, "last_edit_date": 1523490039, "question_id": 49785698, "link": "https://stackoverflow.com/questions/49785698/move-a-range-with-offset", "title": "Move a Range with offset", "body": "<p>I'm having a trouble by moving a designated row with an offset up.</p>\n\n<p>It throws me the Error 424 that needs an Object.\nI set up the rng2 with the selected range, but when i try to move it up, the error get in.</p>\n\n<p>I basically need that when the area in the 87 row finds an empty cell delete it so the label with the info can go up.</p>\n\n<p>Just </p>\n\n<p><a href=\"https://i.stack.imgur.com/cYVWk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cYVWk.png\" alt=\"this\"></a> </p>\n\n<p>to </p>\n\n<p><a href=\"https://i.stack.imgur.com/0rnA7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0rnA7.png\" alt=\"this\"></a></p>\n\n<p>Thanks for your time!</p>\n\n<pre><code>    Sub RowOffset()\n    Application.ScreenUpdating = False\n\n\n    'Worksheets(\"Mine\").Activate\n\n    Dim rng As Range\n    Dim rng2 As Range\n    Dim i As Long\n\n    Set rng = ThisWorkbook.ActiveSheet.Range(\"C87:C37\")\n    Set rng2 = Range(\"C85:N85\")\n\n\n    With rng\n\n        For i = .Rows.Count To 1 Step -1\n\n            If .Item(i) = \"\" Then\n\n                rng2.Select\n                rng2.Delete Shift:=xlUp\n                Set rng2 = rng2.Offset(-1, 0) 'THIS LINE HAS AN ERROR\n\n            End If\n        Next i\n    End With\n\n        Application.ScreenUpdating = True\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "copy", "row", "vba"], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 29, "user_id": 9633037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a194d3b5d87a208d3ec0cc4c9adcee?s=128&d=identicon&r=PG&f=1", "display_name": "ninja97", "link": "https://stackoverflow.com/users/9633037/ninja97"}, "edited": false, "score": 0, "creation_date": 1524680838, "post_id": 49785432, "comment_id": 87074176, "body": "@ninja97  glad to help!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1523486672, "creation_date": 1523486672, "answer_id": 49785432, "question_id": 49785109, "link": "https://stackoverflow.com/questions/49785109/activecell-entirerow-copy/49785432#49785432", "title": "ActiveCell.EntireRow.Copy", "body": "<p>How about:</p>\n\n<pre><code>Sub ShortRow()\n    Intersect(ActiveCell.EntireRow, Range(\"A:N\")).Copy\nEnd Sub\n</code></pre>\n\n<p>The intersection picks out the <strong>A-N</strong> part of the entire row.</p>\n"}], "owner": {"reputation": 29, "user_id": 9633037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a194d3b5d87a208d3ec0cc4c9adcee?s=128&d=identicon&r=PG&f=1", "display_name": "ninja97", "link": "https://stackoverflow.com/users/9633037/ninja97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1395, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1523486672, "creation_date": 1523484508, "last_edit_date": 1531164843, "question_id": 49785109, "link": "https://stackoverflow.com/questions/49785109/activecell-entirerow-copy", "title": "ActiveCell.EntireRow.Copy", "body": "<p>I am using ActiveCell.EntireRow.Copy to copy rows that have a certain value in the \"E\" column cell, to another sheet.</p>\n\n<p>It works great except for one problem.  I don't really want to copy the entire row, just the cells from A through N on the given row.</p>\n\n<p>Is there something I can simply subsitute \"EntireRow\" to in ActiveCell.EntireRow.Copy  ?</p>\n"}, {"tags": ["excel", "function", "events", "sendmail", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523483727, "post_id": 49784815, "comment_id": 86585413, "body": "Welcome to Stack Overflow!  No offense, but it&#39;s pretty clear that the first thing you need is a beginner&#39;s &quot;introduction to VBA&quot; tutorial.  Respectfully, there are a <i>lot</i> of nonsense in your question.  Here are a couple recommended tutorials: <a href=\"http://www.homeandlearn.org/\" rel=\"nofollow noreferrer\">Excel VBA For Complete Beginners</a> and also <a href=\"http://www.homeandlearn.org/\" rel=\"nofollow noreferrer\">HomeAndLearn.org Learning VBA</a>."}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 1667117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ae8b8fbe740cd72916d8a7e5878f3d?s=128&d=identicon&r=PG", "display_name": "Siraj K", "link": "https://stackoverflow.com/users/1667117/siraj-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1523484648, "creation_date": 1523484648, "answer_id": 49785126, "question_id": 49784815, "link": "https://stackoverflow.com/questions/49784815/vba-function-calling/49785126#49785126", "title": "VBA Function calling", "body": "<p>As noted by ashleedawg, there are other errors but to get you going, I believe it should be </p>\n\n<pre><code>Call ThisWorkbook.sendMail\n</code></pre>\n\n<p>And you would need to pass the parameters that SendMail expects. </p>\n"}], "owner": {"reputation": 1, "user_id": 9626366, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ni4FFg9bc2o/AAAAAAAAAAI/AAAAAAAANfA/B5Q-nVRvMRU/photo.jpg?sz=128", "display_name": "Chelsie", "link": "https://stackoverflow.com/users/9626366/chelsie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1523484648, "creation_date": 1523482604, "last_edit_date": 1531161705, "question_id": 49784815, "link": "https://stackoverflow.com/questions/49784815/vba-function-calling", "title": "VBA Function calling", "body": "<p>I have been working on trying to call a function for a tracker I made in Excel. What I want it to do is email an individual when a cell changes to their name. </p>\n\n<p>I have this code in the <code>ThisWorkbook</code> module:</p>\n\n<pre><code>Private Sub Workbook_Open()\nPublic Sub sendMail(strTo As String, _\n        strSubject As String, _\n        strBodyText As String, _\n        Optional strCC As String = \"\", _\n        Optional oAttachments As Collection = Nothing)\n    'This function creates an email and immediately sends it.\n\n    Dim oMailItem As Outlook.MailItem\n    Dim persField As Variant\n\n    'Create the email\n    Set oMailItem = Outlook.Application.CreateItem(olMailItem)\n\n    'Populate the email properties\n    With oMailItem\n        .Subject = \"There are OI's for your review\"\n        If perField = \"Name1\" Then\n            .To = \"email1@mail.mil\"\n        If perField = \"Name2\" Then\n            .To = \"email2@mail.mil\"\n        If perField = \"Name3\" Then\n            .To = \"email3@mail.mil\"\n        .Body = \"Good day, &lt;CR&gt; Please review the tracker to see which OIs are ready for your review\"\n        'Send it!\n        .Send\n    End With\n\n    'Release the object\n    Set oMailItem = Nothing\nEnd Sub\n</code></pre>\n\n<p>I have always had trouble calling functions and I have this code for the individual sheets:</p>\n\n<pre><code>Public Sub Worksheet_Change(ByVal Target As Range)\n    Target = \"$E2:$E17\"\n    Call SendMail\n    End If\nEnd Sub\n</code></pre>\n\n<p>I keep having issues calling the function and have looked. I know I am missing the connection somewhere in the worksheet, but I am at a loss on how to connect it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1523482701, "post_id": 49784748, "comment_id": 86585030, "body": "If you don&#39;t explicitly give a type for a variable, the default is <code>Variant</code>. Try doing <code>Dim r as Range, rr as Range, ..., mmmm as Range</code> at the start."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1523483376, "creation_date": 1523483376, "answer_id": 49784932, "question_id": 49784748, "link": "https://stackoverflow.com/questions/49784748/referencing-range-of-cells-generates-runtime-error-1004-method-range-of-object/49784932#49784932", "title": "Referencing range of cells generates Runtime error 1004 method &#39;range&#39; of object &#39;_global&#39; failed", "body": "<p>Your ranges simply exceed the 255 character limit.</p>\n\n<pre><code>Option Explicit\n\nSub RefreshCells()\n    Dim r as range, rrr As Range\n    Set rrr = Range(\"D153:D184,D223:D254,D293:D324,D363:D394,D433:D464,D503:D534,D573:D604,D643:D674,D713:D744,D783:D814,D853:D884,D923:D954, D993:D1024,D1063:D1094,D1133:D1164,D1203:D1234,D1273:D1304,D1343:D1374, D1413:D1444,D1483:D1514,D1553:D1584\")\n    Set rrr = Union(rrr, Range(\"D1623:D1654,D1693:D1724,D1763:D1794, D1833:D1864,D1903:D1934,D1973:D2004,D2043:D2074,D2113:D2144,D2183:D2214, D2253:D2284,D2323:D2354,D2393:D2424\"))\n    Set rrr = Union(rrr, Range(\"D2463:D2494,D2533:D2564,D2603:D2634,D2673:D2704,D2743:D2774,D2813:D2844,D2883:D2914,D2953:D2984,D3023:D3054,D3093:D3124,D3163:D3194,D3233:D3264,D3303:D3334,D3373:D3404,D3443:D3474,D3513:D3544,D3583:D3614,D3653:D3684,D3723:D3754\"))\n    Set rrr = Union(rrr, Range(\"D3793:D3824,D3863:D3894,D3933:D3964,D4003:D4034,D4073:D4104,D4143:D4174,D4213:D4244,D4283:D4314,D4353:D4384,D4423:D4454,D4493:D4524,D4563:D4594\"))\n    Set rrr = Union(rrr, Range(\"D4633:D4664,D4703:D4734,D4773:D4804,D4843:D4874,D4913:D4944,D4983:D5014,D5053:D5084,D5123:D5154,D5193:D5224,D5263:D5294,D5333:D5364,D5403:D5434,D5473:D5504,D5543:D5574,D5613:D5644,D5683:D5714,D5753:D5784,D5823:D5854,D5893:D5924\"))\n    Set rrr = Union(rrr, Range(\"D5963:D5994,D6033:D6064,D6103:D6134,D6173:D6204,D6243:D6274,D6313:D6344,D6383:D6414,D6453:D6484,D6523:D6554,D6593:D6624,D6663:D6694,D6733:D6764\"))\n    Set rrr = Union(rrr, Range(\"D6803:D6834,D6873:D6904,D6943:D6974,D7013:D7044,D7083:D7114,D7153:D7184,D7223:D7254,D7293:D7324,D7363:D7394,D7433:D7464,D7503:D7534,D7573:D7604,D7643:D7674,D7713:D7744,D7783:D7814,D7853:D7884,D7923:D7954,D7993:D8024,D8063:D8094\"))\n    Set rrr = Union(rrr, Range(\"D8133:D8164,D8203:D8234,D8273:D8304,D8343:D8374,D8413:D8444,D8483:D8514,D8553:D8584,D8623:D8654,D8693:D8724,D8763:D8794,D8833:D8864,D8903:D8934,D8973:D9003\"))\n\n    For Each r In rrr\n        r.Select\n        Application.SendKeys \"{F2}\"\n        Application.SendKeys \"{ENTER}\"\n        DoEvents\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9622861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6kLOa.png?s=128&g=1", "display_name": "mathwandererw", "link": "https://stackoverflow.com/users/9622861/mathwandererw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 49784932, "answer_count": 1, "score": 0, "last_activity_date": 1526649921, "creation_date": 1523482243, "last_edit_date": 1526649921, "question_id": 49784748, "link": "https://stackoverflow.com/questions/49784748/referencing-range-of-cells-generates-runtime-error-1004-method-range-of-object", "title": "Referencing range of cells generates Runtime error 1004 method &#39;range&#39; of object &#39;_global&#39; failed", "body": "<p>I do calculations on data obtained from a Google Sheet (via Get External Data -> From Web). I have to activate (F2, ENTER) the cells first, else I receive a [DIV/0] error.</p>\n\n<p>I need to do this for multiple range intervals.</p>\n\n<p>This code returns \"Runtime error 1004: Method 'Range' of object '_Global' failed. Clicking 'Debug' highlights the first Range encountered, \"rrr\" in this case.\"</p>\n\n<pre><code>Sub RefreshCells()\nDim r, rr, rrr, rrrr, mmm, mmmm As Range\nSet rrr = Range(\"D153:D184,D223:D254,D293:D324,D363:D394,D433:D464,D503:D534,D573:D604,D643:D674,D713:D744,D783:D814,D853:D884,D923:D954, D993:D1024,D1063:D1094,D1133:D1164,D1203:D1234,D1273:D1304,D1343:D1374, D1413:D1444,D1483:D1514,D1553:D1584,D1623:D1654,D1693:D1724,D1763:D1794, D1833:D1864,D1903:D1934,D1973:D2004,D2043:D2074,D2113:D2144,D2183:D2214, D2253:D2284,D2323:D2354,D2393:D2424\")\nSet mmm = Range(\"D2463:D2494,D2533:D2564,D2603:D2634,D2673:D2704,D2743:D2774,D2813:D2844,D2883:D2914,D2953:D2984,D3023:D3054,D3093:D3124,D3163:D3194,D3233:D3264,D3303:D3334,D3373:D3404,D3443:D3474,D3513:D3544,D3583:D3614,D3653:D3684,D3723:D3754,D3793:D3824,D3863:D3894,D3933:D3964,D4003:D4034,D4073:D4104,D4143:D4174,D4213:D4244,D4283:D4314,D4353:D4384,D4423:D4454,D4493:D4524,D4563:D4594\")\nSet rrrr = Range(\"D4633:D4664,D4703:D4734,D4773:D4804,D4843:D4874,D4913:D4944,D4983:D5014,D5053:D5084,D5123:D5154,D5193:D5224,D5263:D5294,D5333:D5364,D5403:D5434,D5473:D5504,D5543:D5574,D5613:D5644,D5683:D5714,D5753:D5784,D5823:D5854,D5893:D5924,D5963:D5994,D6033:D6064,D6103:D6134,D6173:D6204,D6243:D6274,D6313:D6344,D6383:D6414,D6453:D6484,D6523:D6554,D6593:D6624,D6663:D6694,D6733:D6764\")\nSet mmmm = Range(\"D6803:D6834,D6873:D6904,D6943:D6974,D7013:D7044,D7083:D7114,D7153:D7184,D7223:D7254,D7293:D7324,D7363:D7394,D7433:D7464,D7503:D7534,D7573:D7604,D7643:D7674,D7713:D7744,D7783:D7814,D7853:D7884,D7923:D7954,D7993:D8024,D8063:D8094,D8133:D8164,D8203:D8234,D8273:D8304,D8343:D8374,D8413:D8444,D8483:D8514,D8553:D8584,D8623:D8654,D8693:D8724,D8763:D8794,D8833:D8864,D8903:D8934,D8973:D9003\")\nSet rr = Union(rrr, rrrr, mmm, mmmm)\nFor Each r In rr\n    r.Select\n    Application.SendKeys \"{F2}\"\n    Application.SendKeys \"{ENTER}\"\n    DoEvents\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sum"], "comments": [{"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1523482092, "post_id": 49784485, "comment_id": 86584797, "body": "[Find last row, column or last cell](<a href=\"http://example.com\" rel=\"nofollow noreferrer\">link</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9268639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0ba0f6c6c5ff97ed13770e9dcc2c799?s=128&d=identicon&r=PG&f=1", "display_name": "Eric L", "link": "https://stackoverflow.com/users/9268639/eric-l"}, "edited": false, "score": 0, "creation_date": 1523482073, "post_id": 49784595, "comment_id": 86584789, "body": "Thanks for the response, but i&#39;m not sure what this is supposed to be doing or how to apply this to do the task I&#39;m asking."}, {"owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "edited": false, "score": 0, "creation_date": 1523491083, "post_id": 49784595, "comment_id": 86587427, "body": "UsedRange is unreliable."}], "tags": [], "owner": {"reputation": 50, "user_id": 7728112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8796b3d6f7c15e66c930c84b7030dcd?s=128&d=identicon&r=PG&f=1", "display_name": "user7728112", "link": "https://stackoverflow.com/users/7728112/user7728112"}, "is_accepted": false, "score": -2, "last_activity_date": 1523481350, "creation_date": 1523481350, "answer_id": 49784595, "question_id": 49784485, "link": "https://stackoverflow.com/questions/49784485/vba-add-sum-formula-across-tables-in-multiple-cells/49784595#49784595", "title": "VBA Add sum formula across tables in multiple cells", "body": "<p>Here is what I would use: </p>\n\n<pre><code>Sub checkCols()\n\nur = ActiveSheet.UsedRange.Columns.Count\nurName = Cells(1, ur).Address\nMsgBox (ur)\nMsgBox (urName)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9268639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0ba0f6c6c5ff97ed13770e9dcc2c799?s=128&d=identicon&r=PG&f=1", "display_name": "Eric L", "link": "https://stackoverflow.com/users/9268639/eric-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523481658, "creation_date": 1523480892, "last_edit_date": 1523481658, "question_id": 49784485, "link": "https://stackoverflow.com/questions/49784485/vba-add-sum-formula-across-tables-in-multiple-cells", "title": "VBA Add sum formula across tables in multiple cells", "body": "<p>I have the below macro for taking a master list of data and splitting it into multiple tabs based on a unique name in column A.  This works as intended, but I'm trying to figure a way to find the last row in the new tables and add a sum formula at that row for each column, from columns \"L\" through \"Z\".  If possible I would also like to format it based on specific row in my Template tab.  Any help would be appreciated as I haven't been able to find a way to do this. </p>\n\n<p>Thanks everyone,\nEric</p>\n\n<pre><code>Option Explicit\n\nSub SheetsFromTemplate()\n'Create copies of a template sheet using text on a master sheet in a specific column\n'Sheetname strings are corrected using the UDF below\nDim wsMASTER As Worksheet, wsTEMP As Worksheet, wasVISIBLE As Boolean\nDim shNAMES As Range, Nm As Range, NmSTR As String, NR As Long\n\nWith ThisWorkbook                                               'keep focus in this workbook\n    Set wsTEMP = .Sheets(\"Template\")                            'sheet to be copied\n    wasVISIBLE = (wsTEMP.Visible = xlSheetVisible)              'check if it's hidden or not\n    If Not wasVISIBLE Then wsTEMP.Visible = xlSheetVisible      'make it visible\n\n    Set wsMASTER = .Sheets(\"Master\")                            'sheet with names\n                                                                'range to find names to be checked\n    Set shNAMES = wsMASTER.Range(\"A2:A\" &amp; Rows.Count).SpecialCells(xlFormulas)     'or xlFormulas\n\n    Application.ScreenUpdating = False                          'speed up macro\n    For Each Nm In shNAMES                                      'check one name at a time\n        NmSTR = FixStringForSheetName(CStr(Nm.Text))            'use UDF to create a legal sheetname\n        If Not Evaluate(\"ISREF('\" &amp; NmSTR &amp; \"'!A1)\") Then       'if sheet does not exist...\n            wsTEMP.Copy After:=.Sheets(.Sheets.Count)           '...create it from template\n            ActiveSheet.Name = NmSTR                            '...rename it\n        End If\n        With .Sheets(NmSTR)\n            NR = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1).Row\n            wsMASTER.Range(\"B1:B1\").Copy\n            .Range(\"A\" &amp; NR).PasteSpecial xlPasteValues, Transpose:=True\n            Nm.Resize(, 500).Copy .Range(\"A\" &amp; NR)\n        End With\n    Next Nm\n\n    wsMASTER.Activate                                           'return to the master sheet\n    If Not wasVISIBLE Then wsTEMP.Visible = xlSheetHidden       'hide the template if necessary\n    Application.ScreenUpdating = True                           'update screen one time at the end\nEnd With\n\nMsgBox \"All sheets created\"\nEnd Sub\n\n\nFunction FixStringForSheetName(shSTR As String) As String\n\n'replace each forbidden character with something acceptable\n    shSTR = Replace(shSTR, \":\", \"\")\n    shSTR = Replace(shSTR, \"?\", \"\")\n    shSTR = Replace(shSTR, \"*\", \"\")\n    shSTR = Replace(shSTR, \"/\", \"-\")\n    shSTR = Replace(shSTR, \"\\\", \"-\")\n    shSTR = Replace(shSTR, \"[\", \"(\")\n    shSTR = Replace(shSTR, \"]\", \")\")\n\n'sheet names can only be 31 characters\n    FixStringForSheetName = Trim(Left(shSTR, 31))\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1523480030, "last_edit_date": 1523480030, "creation_date": 1523479727, "answer_id": 49784226, "question_id": 49784137, "link": "https://stackoverflow.com/questions/49784137/writing-to-multiple-cells-using-if-target-address-then/49784226#49784226", "title": "Writing to multiple cells using If Target.Address = &quot; &quot; Then", "body": "<p>Maybe (this is assuming existing logic is correct....not sure why you set old value to 0 if Target = 0 and what value the *1 adds?)</p>\n\n<pre><code>Option Explicit\n\nDim oldvalueJ As Double\nDim oldValueR As Double\n\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\n\n    On Error GoTo fixit\n    Application.EnableEvents = False\n    Select Case Target.Address\n    Case \"$J$5\"\n        If Target = 0 Then oldvalueJ = 0\n        Target = Target + oldvalueJ\n        oldvalueJ = Target\n    Case \"$R$5\"\n        If Target = 0 Then oldValueR = 0\n        Target = Target + oldValueR\n        oldValueR = Target\n    End Select\nfixit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1523481231, "last_edit_date": 1523481231, "creation_date": 1523480632, "answer_id": 49784432, "question_id": 49784137, "link": "https://stackoverflow.com/questions/49784137/writing-to-multiple-cells-using-if-target-address-then/49784432#49784432", "title": "Writing to multiple cells using If Target.Address = &quot; &quot; Then", "body": "<p>use commas to separate ranges, and add a <code>Worksheet_SelectionChange()</code> event to record the last user selected cell</p>\n\n<pre><code>Option Explicit\n\nDim oldvalue As String\n\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\n    If Intersect(Target, Range(\"J5,R5\")) Is Nothing Then Exit Sub\n    If Target.Value = 0 Then Exit Sub\n    On Error GoTo fixit\n    Application.EnableEvents = False\n    Target.Value = Target.Value + oldvalue\nfixit:\n    Application.EnableEvents = True\nEnd Sub\n\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.CountLarge = 1 Then oldvalue = Target.Value\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1523492021, "last_edit_date": 1523492021, "creation_date": 1523491071, "answer_id": 49786020, "question_id": 49784137, "link": "https://stackoverflow.com/questions/49784137/writing-to-multiple-cells-using-if-target-address-then/49786020#49786020", "title": "Writing to multiple cells using If Target.Address = &quot; &quot; Then", "body": "<p>This is a bit more dynamic by allowing you to add unlimited cells; it also validates user input</p>\n\n<hr>\n\n<p><strong>Standard</strong> Module</p>\n\n<hr>\n\n<pre><code>Option Explicit    'Generic Module\n\nPublic Const WS1_MEM_RNG = \"C5,J5,R5\"    'Sheet1 memory cells\n\nPublic prevWs1Vals As Object\n\nPublic Sub SetPreviousWS1Vals()\n    Dim c As Range\n\n    For Each c In Sheet1.Range(WS1_MEM_RNG).Cells\n        If Len(c.Value2) &gt; 0 Then prevWs1Vals(c.Address) = c.Value2\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Sheet1</strong> Module</p>\n\n<hr>\n\n<pre><code>Option Explicit    'Sheet1 Module\n\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\n\n    If Target.CountLarge = 1 Then\n        If Not Intersect(Target, Me.Range(WS1_MEM_RNG)) Is Nothing Then GetPrevious Target\n    End If\n\nEnd Sub\n\nPrivate Sub GetPrevious(ByVal cel As Range)\n\n    Dim adr As String:  adr = cel.Address\n\n    Application.EnableEvents = False\n    If Not IsError(cel.Value) And IsNumeric(cel.Value2) And Not IsNull(cel.Value) Then\n        If IsDate(cel.Value) Then\n            cel.NumberFormat = \"General\"\n            cel.Value2 = prevWs1Vals(adr)\n        Else\n            If cel.Value2 = 0 Then prevWs1Vals(adr) = 0\n            cel.Value2 = cel.Value2 + prevWs1Vals(adr)\n            prevWs1Vals(adr) = cel.Value2\n        End If\n    Else\n        cel.Value2 = prevWs1Vals(adr)\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>ThisWorkbook</strong> Module</p>\n\n<hr>\n\n<pre><code>Option Explicit    'ThisWorkbook Module\n\nPrivate Sub Workbook_Open()\n\n    If prevWs1Vals Is Nothing Then Set prevWs1Vals = CreateObject(\"Scripting.Dictionary\")\n\n    SetPreviousWS1Vals\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>It can also enforce positives only</p>\n"}], "owner": {"reputation": 21, "user_id": 9632764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d7a49ddcd268f28ce1d5b787649e08?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Lowe", "link": "https://stackoverflow.com/users/9632764/mike-lowe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1736, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1523492852, "creation_date": 1523479229, "last_edit_date": 1531164843, "question_id": 49784137, "link": "https://stackoverflow.com/questions/49784137/writing-to-multiple-cells-using-if-target-address-then", "title": "Writing to multiple cells using If Target.Address = &quot; &quot; Then", "body": "<p>I have basic code that allows the values written to this cell to be summed while maintaining the cumulative value.  So if I were to type \"4\" into the cell, and then type \"10\" into the cell, the result would be \"14\" (not just the second value entered of \"10\").  Here is what I have and I must say that it works.</p>\n\n<h1>#</h1>\n\n<pre><code>Option Explicit\n\nDim oldvalue As Double\n\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\n    If Target.Address = \"$J$5\" Then\n        On Error GoTo fixit\n        Application.EnableEvents = False\n        If Target.Value = 0 Then oldvalue = 0\n        Target.Value = 1 * Target.Value + oldvalue\n        oldvalue = Target.Value\nfixit:\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<h1>#</h1>\n\n<p>However, I want to apply this treatment to more than just cell J5.  Say for example, I want the same code logic applied to cell R5 as well.<br>\nThur far I have tried using </p>\n\n<pre><code>OR \n</code></pre>\n\n<p>and I have also tried using </p>\n\n<pre><code>If Not Intersect (Target, Range(\"J5:R5\")) Is Nothing Then\n</code></pre>\n\n<p>But each of these approaches ties the two cells together (so that what I enter into one gets summed into both - each cell is summing values added to the other).  I can't figure it out to save my life, so took to this forum in the hopes of finding someone smarter than me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1523477016, "post_id": 49783567, "comment_id": 86582536, "body": "(In <code>Line1</code> you have some ranges that aren&#39;t linked to a worksheet. You should probably add the sheet before the range, like you do elsewhere.)"}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1523478040, "creation_date": 1523478040, "answer_id": 49783875, "question_id": 49783567, "link": "https://stackoverflow.com/questions/49783567/using-for-each-to-select-a-cell-on-another-sheet/49783875#49783875", "title": "Using &quot;For Each&quot; to select a cell on another sheet", "body": "<p>Your variable <code>Mastercell</code> is a range, with all the properties of a range. So you can extract the row number of the range with</p>\n\n<p><code>myRow = Mastercell.row</code></p>\n\n<p>and then use <code>myRow</code> to address the corresponding row in the other worksheet</p>\n\n<pre><code>            ws2.Range(\"A\" &amp; myRow).EntireRow.Insert\n            ws1.Range(\"A\" &amp; myRow).EntireRow.Copy Destination:=ws2.Range(\"A\" &amp; myRow)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9632619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f063ed4f8504f1227993e11d81cfb1?s=128&d=identicon&r=PG&f=1", "display_name": "L. Hicks", "link": "https://stackoverflow.com/users/9632619/l-hicks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 49783875, "answer_count": 1, "score": 0, "last_activity_date": 1523478040, "creation_date": 1523476842, "question_id": 49783567, "link": "https://stackoverflow.com/questions/49783567/using-for-each-to-select-a-cell-on-another-sheet", "title": "Using &quot;For Each&quot; to select a cell on another sheet", "body": "<p>I am creating a code that compares two different workbooks (a \"master\" and a \"slave\") and I want to copy any rows that were created in wb1 (\"master) into the same spot in wb2 (\"slave\")</p>\n\n<p>To do this I am using the following code as a part:</p>\n\n<pre><code>Sub CopySchedule()\nDim wb1 As Workbook, wb2 As Workbook\nDim ws1 As Worksheet, ws2 As Worksheet\nDim copyFrom As Range\nDim lRow As Long\nDim strSearch As String\nDim LastCell As Range\nDim ws As Integer\nDim MasterCell As Range\nDim GetRange As Range\nDim RowCount As Integer\nDim SlaveCell As Integer\nDim CheckN As Integer\n\n\nSet wb1 = Application.Workbooks(\"Master Sheet.xlsx\")\nSet wb2 = ThisWorkbook\n\n'Application.ScreenUpdating = False\n\nFor ws = 1 To wb1.Worksheets.Count\n\n    Set ws1 = wb1.Worksheets(ws)\n    Set ws2 = wb2.Worksheets(ws)\n\n    With ws1\n\n        RowCount = ws2.Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        Set LastCell = .Cells(1, Columns.Count)\n\n        For Each MasterCell In .Range(\"A4\", LastCell)\n\n            CheckN = 0\n\n            For SlaveCell = 1 To RowCount\n\n                If MasterCell.Value = ws2.Cells(SlaveCell, \"A\").Value Then\n                    CheckN = 1\n                    GoTo Line1\n                End If\n\n            Next SlaveCell\n\n Line1:\n            Set GetRange = Range(MasterCell.Address(0, 0))\n            MsgBox Range(\"GetRange\").Address(0, 0)\n            If CheckN = 1 Then\n            Else\n                ws2.Range(\"GetRange\").EntireRow.Insert\n                ws1.Range(\"GetRange\").EntireRow.Copy Destination:=ws2.Range(\"GetRange\")\n            End If\n\n        Next MasterCell\n\n    End With\n\nNext ws\n</code></pre>\n\n<p>The problem I am having is that once I have found a MasterCell value that is not in wb2, I need to insert a row into wb2 at the same range that the Mastercell is in wb1. I will then copy the row from wb1 to wb2.</p>\n\n<p>The problem I am having is figuring out how to take \"MasterCell\", which is a range value that would look like </p>\n\n<pre><code>wb1.Range(\"whatever cell it's on in the for loop\")\n</code></pre>\n\n<p>and reference the same cell in wb2.</p>\n\n<p>Does anyone have a solution?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1523477312, "post_id": 49783529, "comment_id": 86582694, "body": "Please edit your question instead of adding info in comments."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1523478516, "post_id": 49783529, "comment_id": 86583324, "body": "Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and learn <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Then edit your question and make it a good question before it gets closed. You show no effort of your own and this site is not a free script order service."}, {"owner": {"reputation": 3, "user_id": 8412681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb93710c95d8a3cd37b983a547216e0?s=128&d=identicon&r=PG&f=1", "display_name": "Batman", "link": "https://stackoverflow.com/users/8412681/batman"}, "edited": false, "score": 0, "creation_date": 1523630725, "post_id": 49783529, "comment_id": 86654146, "body": "Sorry for the question appearing as though I showed no effort of research.  I did in fact try multiple things, and researched the question &amp; restated it multiple ways.  However, I could not find anything close to what I was looking for, nor could I come up with anything on my own that was viable solution.  The best way I saw to expand the question was by example, but I should have provided more insight, and will be sure to do so in the future."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8412681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb93710c95d8a3cd37b983a547216e0?s=128&d=identicon&r=PG&f=1", "display_name": "Batman", "link": "https://stackoverflow.com/users/8412681/batman"}, "edited": false, "score": 0, "creation_date": 1523482766, "post_id": 49784014, "comment_id": 86585052, "body": "I edited my initial post, sorry for the extra comment.  Your solution works if I have the results already in the cell.  Sorry for the confusion, but maybe I should have labeled that as expected results.  The results column in sheet 2 is what I need the formula to produce."}, {"owner": {"reputation": 201, "user_id": 3803284, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6fa08937c2523e9ae365b06bfefcc983?s=128&d=identicon&r=PG", "display_name": "Alisson Bezerra", "link": "https://stackoverflow.com/users/3803284/alisson-bezerra"}, "reply_to_user": {"reputation": 3, "user_id": 8412681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb93710c95d8a3cd37b983a547216e0?s=128&d=identicon&r=PG&f=1", "display_name": "Batman", "link": "https://stackoverflow.com/users/8412681/batman"}, "edited": false, "score": 0, "creation_date": 1523538571, "post_id": 49784014, "comment_id": 86609316, "body": "But that&#39;s exactly what it is. My formula is meant to be put in Sheet2, so that it uses data from Sheet1 to produce the result you&#39;re expecting."}, {"owner": {"reputation": 3, "user_id": 8412681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb93710c95d8a3cd37b983a547216e0?s=128&d=identicon&r=PG&f=1", "display_name": "Batman", "link": "https://stackoverflow.com/users/8412681/batman"}, "edited": false, "score": 0, "creation_date": 1523629547, "post_id": 49784014, "comment_id": 86653326, "body": "Sorry, you are correct, I either read or copied something incorrectly.  This works, thank you so much for your time &amp; effort!"}], "tags": [], "owner": {"reputation": 201, "user_id": 3803284, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6fa08937c2523e9ae365b06bfefcc983?s=128&d=identicon&r=PG", "display_name": "Alisson Bezerra", "link": "https://stackoverflow.com/users/3803284/alisson-bezerra"}, "is_accepted": true, "score": 0, "last_activity_date": 1523478616, "creation_date": 1523478616, "answer_id": 49784014, "question_id": 49783529, "link": "https://stackoverflow.com/questions/49783529/excel-return-multiple-values-from-numbered-cell/49784014#49784014", "title": "Excel return multiple values from numbered cell", "body": "<p>I could not do this starting in cell <code>A1</code> in <code>Sheet2</code> because there would be a circular reference, and Excel gave me an error.\nBut if starting on cell <code>A2</code> is ok for you, here it is:</p>\n\n<pre><code>=IF(COUNTIF(Sheet2!$A$1:A1;Sheet1!$A$2)&lt;Sheet1!$B$2;Sheet1!$A$2;IF(COUNTIF(Sheet2!$A$1:A1;Sheet1!$A$3)&lt;Sheet1!$B$3;Sheet1!$A$3;IF(COUNTIF(Sheet2!$A$1:A1;Sheet1!$A$4)&lt;Sheet1!$B$4;Sheet1!$A$4;\"\")))\n</code></pre>\n\n<p>Just put this formula on cell <code>A2</code> of <code>Sheet2</code> and drag down.</p>\n\n<p>I've tested and the result was the one you're excpecting.</p>\n"}], "owner": {"reputation": 3, "user_id": 8412681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb93710c95d8a3cd37b983a547216e0?s=128&d=identicon&r=PG&f=1", "display_name": "Batman", "link": "https://stackoverflow.com/users/8412681/batman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 49784014, "answer_count": 1, "score": -1, "last_activity_date": 1523482053, "creation_date": 1523476685, "last_edit_date": 1531161705, "question_id": 49783529, "link": "https://stackoverflow.com/questions/49783529/excel-return-multiple-values-from-numbered-cell", "title": "Excel return multiple values from numbered cell", "body": "<p>I have the following problem, and would appreciate any help if it is even possible.</p>\n\n<p>Given this Data on Sheet 1  </p>\n\n<pre><code>Employee Role   Number of Employees  \nEmployee A              5  \nEmployee B              4  \nEmployee C              3  \n</code></pre>\n\n<p>I would like the results to be this on Sheet 2.  </p>\n\n<p>Results  </p>\n\n<pre><code>Employee A  \nEmployee A  \nEmployee A  \nEmployee A  \nEmployee A  \nEmployee B  \nEmployee B  \nEmployee B  \nEmployee B  \nEmployee C  \nEmployee C  \nEmployee C  \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523476555, "post_id": 49783454, "comment_id": 86582283, "body": "This has an answer here <a href=\"https://stackoverflow.com/questions/26392482/vba-excel-to-prompt-user-response-to-select-folder-and-return-the-path-as-string?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\" title=\"vba excel to prompt user response to select folder and return the path as string\">stackoverflow.com/questions/26392482/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8922148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dwU2dJxE8Wk/AAAAAAAAAAI/AAAAAAAAALk/CZwp5121dFw/photo.jpg?sz=128", "display_name": "J Doncouse Threedogbowwow", "link": "https://stackoverflow.com/users/8922148/j-doncouse-threedogbowwow"}, "edited": false, "score": 0, "creation_date": 1523624824, "post_id": 49783577, "comment_id": 86649958, "body": "Thank you so much!. I kinda got it working. The only issue I believe I&#39;m running into is that I&#39;m noticing that when the folder is chosen it isn&#39;t adding the final &quot;\\&quot; to the path so none of the files in the folder gets opened. For some strange reason if I select the folder and hit cancel it actually works correctly &quot;granted I have to be inside the folder in the dialog box&quot;"}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 1, "user_id": 8922148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dwU2dJxE8Wk/AAAAAAAAAAI/AAAAAAAAALk/CZwp5121dFw/photo.jpg?sz=128", "display_name": "J Doncouse Threedogbowwow", "link": "https://stackoverflow.com/users/8922148/j-doncouse-threedogbowwow"}, "edited": false, "score": 0, "creation_date": 1523624942, "post_id": 49783577, "comment_id": 86650022, "body": "Well you can add the trailing &quot;\\&quot; by doing <code>path = .SelectedItems(1) &amp; &quot;\\&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 8922148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dwU2dJxE8Wk/AAAAAAAAAAI/AAAAAAAAALk/CZwp5121dFw/photo.jpg?sz=128", "display_name": "J Doncouse Threedogbowwow", "link": "https://stackoverflow.com/users/8922148/j-doncouse-threedogbowwow"}, "edited": false, "score": 0, "creation_date": 1523905425, "post_id": 49783577, "comment_id": 86744354, "body": "Thank you so much. I ended up figuring it out looking up some other issues I was having."}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 1, "user_id": 8922148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dwU2dJxE8Wk/AAAAAAAAAAI/AAAAAAAAALk/CZwp5121dFw/photo.jpg?sz=128", "display_name": "J Doncouse Threedogbowwow", "link": "https://stackoverflow.com/users/8922148/j-doncouse-threedogbowwow"}, "edited": false, "score": 0, "creation_date": 1523907508, "post_id": 49783577, "comment_id": 86745336, "body": "Glad to help. Please consider marking the answer as correct."}], "tags": [], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "is_accepted": false, "score": 0, "last_activity_date": 1523476883, "creation_date": 1523476883, "answer_id": 49783577, "question_id": 49783454, "link": "https://stackoverflow.com/questions/49783454/excel-vba-referencing-the-folderpicker-new-to-vba/49783577#49783577", "title": "Excel VBA referencing the folderpicker *new to VBA*", "body": "<p>This is the way you can do it:</p>\n\n<pre><code>Set Diafolder = Application.FileDialog(msoFileDialogFolderPicker)\nWith Diafolder \n\n    .AllowMultiSelect = False\n    .Title = \"Select a folder...\"\n\n    If .Show = True Then\n        path = .SelectedItems(1)\n    End If\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8922148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dwU2dJxE8Wk/AAAAAAAAAAI/AAAAAAAAALk/CZwp5121dFw/photo.jpg?sz=128", "display_name": "J Doncouse Threedogbowwow", "link": "https://stackoverflow.com/users/8922148/j-doncouse-threedogbowwow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "closed_date": 1523909564, "answer_count": 1, "score": 0, "last_activity_date": 1523476883, "creation_date": 1523476384, "question_id": 49783454, "link": "https://stackoverflow.com/questions/49783454/excel-vba-referencing-the-folderpicker-new-to-vba", "closed_reason": "Duplicate", "title": "Excel VBA referencing the folderpicker *new to VBA*", "body": "<p>I have a code I have pieced together. The goal is to take all the excel files in a folder, open them up and add the sheets together to form a pivot table. I can easily set a path = 'foldername' and it works, however, I was wanting to make it to where I could just browse for the folder instead and have the path reference the chosen path from the msoFileDialogFolderPicker. I know that the path=Diafolder is incorrect and am looking for an answer to this. \nThank you ahead of time.</p>\n\n<pre><code>Dim Diafolder As FileDialog\nDim path As String\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n' Open the file dialog\nSet Diafolder = Application.FileDialog(msoFileDialogFolderPicker)\nDiafolder.AllowMultiSelect = False\nDiafolder.Show\n\nMsgbox Diafolder.SelectedItems(1)\n\nSet Diafolder = Nothing\npath = Diafolder\n\nfileName = Dir(path &amp; \"*.xls\")\n\nDo While fileName &lt;&gt; \"\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1524336076, "post_id": 49783007, "comment_id": 86934473, "body": "Question.. Is there actually a space between the <code>Test</code> and the <code>1</code> , and thus the <code>Test.</code> and the <code>1</code> as well ?"}], "answers": [{"tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": true, "score": 2, "last_activity_date": 1524168174, "creation_date": 1524168174, "answer_id": 49929340, "question_id": 49783007, "link": "https://stackoverflow.com/questions/49783007/excel-initialfilename-not-working-with-period/49929340#49929340", "title": "Excel InitialFileName Not Working With Period", "body": "<p>To get this to work, add the file extension to the InitialFileName parameter like below:</p>\n\n<pre><code>NewFile = Application.GetSaveAsFilename( _\n    InitialFileName:=SaveArea &amp; newfilename &amp; \".xlsm\", _\n    fileFilter:=NewFileType)\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 1, "accepted_answer_id": 49929340, "answer_count": 1, "score": -1, "last_activity_date": 1524337983, "creation_date": 1523474630, "last_edit_date": 1531164843, "question_id": 49783007, "link": "https://stackoverflow.com/questions/49783007/excel-initialfilename-not-working-with-period", "title": "Excel InitialFileName Not Working With Period", "body": "<p>In the document I have a button to do a save as, this function takes a path and creates the filename based off a cell and the date.  This has been working fine until a path came up that has a period in it, it will locate the path correctly but is no longer filling in the filename.</p>\n\n<pre><code>Sub SaveWorkbookAsNewFile()\n    Dim NewFileType As String\n    Dim NewFile As String\n    Dim newfilename As String\n    Dim cellname As String\n    Dim monthnum As String\n    Dim monthtxt As String\n    Dim daynum As String\n    Dim yearnum As String\n    Dim yeartxt As String\n    Dim SaveArea As String\n    Dim q As Long\n\n    If Worksheets.Count &lt;= 6 Then MsgBox \"You must run the report before saving it.\", vbInformation, \"Save Error\": End\n\n    SaveArea = Sheet1.Range(\"K12\")\n    cellname = Sheet1.Range(\"K20\")\n\n    '********************************************************************\n    Dim objFSO As Object, objFolder As Object, objSubFolder As Object\n    Dim varDirectory As Variant\n    Dim flag As Boolean\n    Dim strDirectory As String, goodfolder As String\n    Dim NumMonth As Integer\n\n    NumMonth = 0\n    q = 0\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(SaveArea)\n\n    NumMonth = Month(Date)\n\n    For Each objSubFolder In objFolder.subfolders\n\n        If InStr(1, UCase(objSubFolder.Name), UCase(MonthName(NumMonth, True)), vbTextCompare) &gt; 1 Then goodfolder = objSubFolder.Name: Exit For\n\n    Next objSubFolder\n\n    If Not goodfolder = \"\" Then SaveArea = SaveArea &amp; goodfolder &amp; \"\\\"\n\n\n    '********************************************************************\n\n    monthnum = Month(Date)\n    monthtxt = UCase(MonthName(monthnum, True))\n    daynum = Day(Date)\n    yearnum = Year(Date)\n    yeartxt = Right(yearnum, 2)\n\n    newfilename = cellname &amp; \"-\" &amp; monthtxt &amp; \"-\" &amp; daynum &amp; \"-\" &amp; yeartxt\n\n    Application.ScreenUpdating = False    ' Prevents screen refreshing.\n\n    NewFileType = \"Excel Macro-Enabled Workbook (*.xlsm), *.xlsm,\" &amp; _\n               \"All files (*.*), *.*\"\n\n    NewFile = Application.GetSaveAsFilename( _\n        InitialFileName:=SaveArea &amp; newfilename, _\n        fileFilter:=NewFileType)\n\n    If NewFile &lt;&gt; \"\" And NewFile &lt;&gt; \"False\" Then\n        ActiveWorkbook.SaveAs FileName:=NewFile, _\n            FileFormat:=xlOpenXMLWorkbookMacroEnabled, _\n            CreateBackup:=False, _\n            ConflictResolution:=xlUserResolution\n    End If\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>A working path (SaveArea) is as follows: <code>\\\\TestServer\\Test\\Test\\Standards\\Test\\Test 1\\</code></p>\n\n<p>A broken path (SaveArea) is as follows: <code>\\\\TestServer\\Test\\Test\\Standards\\Test\\Test. 1\\</code></p>\n\n<p>Both bring up the save as dialog, but the path with the period does not populate a filename. Is there a way to make this work when the path includes a period?</p>\n\n<p>Edit: I've found a similar post <a href=\"https://superuser.com/questions/1257977/software-excel-vba-not-populating-default-file-name-in-saveas-dialog-box\">here</a> but it doesn't have a solution to fix the problem.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1523475456, "post_id": 49782889, "comment_id": 86581668, "body": "What does it mean to close a subform?"}, {"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1523476306, "post_id": 49782889, "comment_id": 86582137, "body": "Sorry, I either have it opened as described above where there is a parent and a grandparent. Or I have it opened with a form similar to Subform1 as a main form and Subsubform1 as a subform, in this case there is only one parent and no grandparent."}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1523476604, "creation_date": 1523476604, "answer_id": 49783501, "question_id": 49782889, "link": "https://stackoverflow.com/questions/49782889/how-to-return-the-name-of-a-forms-highest-parent/49783501#49783501", "title": "How to return the name of a form&#39;s highest parent", "body": "<p>If that is your only two scenarios you can do two things. Check if <code>Mainform</code> is open or check the <code>Parent</code> property of <code>Subform1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": true, "score": 1, "last_activity_date": 1523477737, "creation_date": 1523477737, "answer_id": 49783793, "question_id": 49782889, "link": "https://stackoverflow.com/questions/49782889/how-to-return-the-name-of-a-forms-highest-parent/49783793#49783793", "title": "How to return the name of a form&#39;s highest parent", "body": "<p>I recommend using events and not relying on a string of object hierarchies. So <code>subform</code> decides it needs to be closed and raises a <code>CloseRequested</code> event. Then whatever form opened <code>subform</code> can act on that. That action could either be to attempt to close itself (if it succeeds then great, it was the parent) or pass it along the chain.</p>\n\n<p>This example below doesn't use events but will work to close the parent-est form when a button is clicked on the subform.</p>\n\n<pre><code>'command button on your subform\nPrivate Sub Command0_Click()\n    Dim frm As Form\n    Set frm = FindHighestAncestor(Me)\n    DoCmd.Close acForm, frm.Name\nEnd Sub\n\nPublic Function FindHighestAncestor(frm As Form)\n    If IsHighestLevelForm(frm) Then\n        Set FindHighestAncestor = frm\n    Else\n        If TypeOf frm.Parent Is Form Then\n            Set FindHighestAncestor = FindHighestAncestor(frm.Parent)\n        Else\n            Set FindHighestAncestor = frm\n        End If\n    End If\n\nEnd Function\n\nPublic Function IsHighestLevelForm(frm As Form) As Boolean\n    Dim f As Form\n    For Each f In Application.Forms\n        If f.Name = frm.Name Then\n            IsHighestLevelForm = True\n            Exit Function\n        End If\n    Next\n    IsHighestLevelForm = False\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 49783793, "answer_count": 2, "score": 0, "last_activity_date": 1523477737, "creation_date": 1523474135, "last_edit_date": 1523476618, "question_id": 49782889, "link": "https://stackoverflow.com/questions/49782889/how-to-return-the-name-of-a-forms-highest-parent", "title": "How to return the name of a form&#39;s highest parent", "body": "<p>I have subform and sometimes it is opend with a parent form, and sometimes it is opened with a parent and a grandparent forms.</p>\n\n<p>How can I find the name of the highest current parent of the subform?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523474065, "post_id": 49782788, "comment_id": 86580924, "body": "Does <code>Store</code> definitely have a value when you run the code?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1523474376, "post_id": 49782788, "comment_id": 86581073, "body": "Ditto <code>numRows</code>."}, {"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523474386, "post_id": 49782788, "comment_id": 86581076, "body": "Yep, store has a value. I set breakpoints and checked."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523474413, "post_id": 49782788, "comment_id": 86581092, "body": "Do any cells contain an error value?"}, {"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523474459, "post_id": 49782788, "comment_id": 86581123, "body": "I&#39;ve added the line for numRows to the above code, but yes that definitely has a value."}, {"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1523474583, "post_id": 49782788, "comment_id": 86581194, "body": "I take it back. numRows was pulling the number of rows from 250..not from Worksheet as I had intended.=, so it was trying to look up blank cells. It&#39;s fixed now, thank you SJR!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523474789, "post_id": 49782788, "comment_id": 86581312, "body": "OK, always make sure you include sheet references."}], "owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523474426, "creation_date": 1523473793, "last_edit_date": 1531164843, "question_id": 49782788, "link": "https://stackoverflow.com/questions/49782788/error-2042-for-application-vlookup", "title": "Error 2042 for Application.VLookup", "body": "<p>I'm trying to lookup a cell value in another sheet. When I use the following code, the output for <code>debug.print</code> is <code>Error 2042</code>. if I replace <code>Cells(i, store).Value</code> with a static value like \"39875\", it works perfectly.</p>\n\n<pre><code>With Sheets(\"250\")\n    numCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\n\nnumRows = Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\nDim store\nDim agType\nFor i = 1 To numCol\n    If Trim(Cells(1, i).Value) = \"Balancing Seg\" Then store = i\n    If Trim(Cells(1, i).Value) = \"Ag Type\" Then agType = i\nNext\n\nSheets(\"Worksheet\").Activate\nFor i = numRows To 1 Step -1\n    With Worksheets(\"250\")\n        x = Application.VLookup(Cells(i, store).Value, .Range(\"A1:I\" &amp; .Range(\"A1\", .Range(\"A1\").End(xlDown)).Rows.Count), 9, False)\n    End With\n    Debug.Print (x)\nNext\n</code></pre>\n\n<p>Am I doing something wrong with the first argument of the VLookup?</p>\n"}, {"tags": ["matlab", "excel", "com", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 3230708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3ba0a3fe017d7c55f7741bcb315f4824?s=128&d=identicon&r=PG&f=1", "display_name": "user36800", "link": "https://stackoverflow.com/users/3230708/user36800"}, "is_accepted": true, "score": 0, "last_activity_date": 1524117678, "last_edit_date": 1524117678, "creation_date": 1524080419, "answer_id": 49907775, "question_id": 49782719, "link": "https://stackoverflow.com/questions/49782719/cant-access-range-method-of-range-object-com-limitations/49907775#49907775", "title": "Can&#39;t access Range method of Range object; COM limitations?", "body": "<p>Here is a solution I've reached by trial and error, refined with some help with Matlab technical support:</p>\n\n<p>Invoke <code>get</code> as a method, then supply the desired property name.  It works for property <code>Offset</code>.</p>\n\n<pre><code>K&gt;&gt; o = sht.Range('C3:D4')\n    o = Interface.Microsoft_Excel_14.0_Object_Library.Range\nK&gt;&gt; o.get('Offset',2,3).Address\n    ans = $F$5:$G$6\n</code></pre>\n\n<p>It  works for <code>Range</code>, too.</p>\n\n<pre><code>K&gt;&gt; o = sht.Range('C3:E5')\n    o = Interface.Microsoft_Excel_14.0_Object_Library.Range\nK&gt;&gt; o.get('Range','B2:C3').Address\n    ans = $D$4:$E$5\n</code></pre>\n\n<p>The strange thing is that <code>Range</code> is a method according to COM (but a property according to the Excel VBA documentation).  Despite being seen as a method when accessed via COM, it needs to be invoked using <code>get</code> rather than <code>invoke</code>.  The latter yields an error:</p>\n\n<pre><code>K&gt;&gt; o.invoke('Range','B2:C3').Address\n    Error using Interface.Microsoft_Excel_14.0_Object_Library.Range/invoke.\n    Cannot find an exact (case-sensitive) match for 'Range'.\n    The closest match is: range in C:\\Program Files\\MATLAB\\Single_R2015b\\toolbox\\stats\\stats\\range.m\n</code></pre>\n"}], "owner": {"reputation": 1597, "user_id": 3230708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3ba0a3fe017d7c55f7741bcb315f4824?s=128&d=identicon&r=PG&f=1", "display_name": "user36800", "link": "https://stackoverflow.com/users/3230708/user36800"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 49907775, "answer_count": 1, "score": 0, "last_activity_date": 1524117678, "creation_date": 1523473568, "last_edit_date": 1531164843, "question_id": 49782719, "link": "https://stackoverflow.com/questions/49782719/cant-access-range-method-of-range-object-com-limitations", "title": "Can&#39;t access Range method of Range object; COM limitations?", "body": "<p>In the Excel VBA Editor's Immediate Window, I can do the following:</p>\n\n<pre><code>?ActiveSheet.Range(\"C3:D4\").Range(\"C3:D4\").Address\n$E$5:$F$6\n</code></pre>\n\n<p>According to some simple tests, this doesn't seem to respond the same in Matlab.  Here is the code to set up the COM interface for the tests:</p>\n\n<pre><code>excel = actxserver('Excel.Application');\nexcel.Visible=1;\nwbks = excel.Workbooks;\nwbks.Add\nsht = wbks.Item(1).Sheets.Item(1)\n\n%\n%     Run some range tests\n%\n\ntry\n   excel.DisplayAlerts = 0; % Forgo save prompt on Close\nend; try\n   wbk.Close\nend; try\n   excel.Quit % Excel process still present\nend; try\n   delete(excel) % Excel process disappears\nend % try\n</code></pre>\n\n<p>Now, with <code>sht</code> being a Worksheet object, I get the following error instead:</p>\n\n<pre><code>K&gt;&gt; o=sht.Range('C3:D4')\n    o = Interface.Microsoft_Excel_14.0_Object_Library.Range\n\nK&gt;&gt; o.Range('C3:D4').Address\n\n    Cannot find an exact (case-sensitive) match for 'Range'\n    The closest match is: range in C:\\Program Files\\MATLAB\\Single_R2015b\\toolbox\\stats\\stats\\range.m\n    Did you mean: K&gt;&gt; o.range('C3:D4').Address\n</code></pre>\n\n<p>This is the wrong function, since <code>range</code> with an uncapitalized <code>r</code> is the internal Matab function.  Hence, I pressed Ctrl-C to break out (otherwise, it complains about the incompatible argument).</p>\n\n<p>To troubleshoot why <code>Range</code> is not recognized, check whether is is a method or property.  When accessed via COM, <code>Range</code> is a method rather than a property:</p>\n\n<pre><code>K&gt;&gt; methods(o)\n    Methods for class Interface.Microsoft_Excel_14.0_Object_Library.Range:\n        &lt;...snip...&gt;\n        PrintPreview            Table\n        Range                   TextToColumns\n        RemoveDuplicates        UnMerge\n        &lt;...snip...&gt;\n</code></pre>\n\n<p>This further shows that <code>Range</code> is not a property (even though it is in VBA):</p>\n\n<pre><code>K&gt;&gt; get(o)\n         &lt;...snip...&gt;\n     QueryTable: 'Error: Object returned error code: 0x800A03EC'\n         Resize: [1x1 Interface.Microsoft_Excel_14.0_Object_Library.Range]\n            Row: 3\n         &lt;...snip...&gt;\n</code></pre>\n\n<p>Since properties are listed alphabetically, <code>Range</code> would show up after QueryTable if it was recognized as a property.  However, it isn't listed in the above results.</p>\n\n<p>As an alternative diagnostic step, I tried accessing <code>Range</code> using the dot notation (<code>o.Range</code>).  Unfortunately, Matlab seems to got for its own native function <code>range</code>, which has nothing to do with an Excel <code>Range</code>.</p>\n\n<p>So after all that diagnostic work....</p>\n\n<p><strong>THE QUESTION</strong></p>\n\n<p><strong>For a given <code>Range</code> object, how does one access the <code>Range</code> method (as recognized by COM) <em>or</em> the <code>Range</code> property (as it is described in the VBA documentation)?</strong></p>\n\n<p><strong>AFTERNOTE</strong></p>\n\n<p>There seem to be many discrepancies with in accessing Range properties and methods via the COM interface.  In the Immediate Window, one can use the <code>Offset</code> property (it is desribed as a property):</p>\n\n<pre><code>? ActiveSheet.Range(\"C3:D4\").Offset(2,3).Address\n$F$5:$G$6\n</code></pre>\n\n<p>Over COM, not so much, even though <code>get(o)</code> shows <code>Offset</code> to be a valid property that returns a range:</p>\n\n<pre><code>K&gt;&gt; o=sht.Range('C3:D4')\n    o = Interface.Microsoft_Excel_14.0_Object_Library.Range\nK&gt;&gt; o=o.Offset(2,2)\nIndex exceeds matrix dimensions.\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "edited": false, "score": 0, "creation_date": 1523473765, "post_id": 49782535, "comment_id": 86580772, "body": "At a glance the syntax seems fine.  Can you run the SQL statement that is returned?  If not, are you using the same table for both departments?  If it&#39;s not the same table, are you positive all the fields are the same?"}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "reply_to_user": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "edited": false, "score": 0, "creation_date": 1523474289, "post_id": 49782535, "comment_id": 86581033, "body": "it&#39;s not the same table, but I&#39;ve ensured the field names are correct multiple times.  The few starting off, then OEM1-OEM75 in sequence.  The SQL returned from the Immediate window through debug.print won&#39;t run in Access&#39; built in SQL builder, but I&#39;ve gathered that it&#39;s because it won&#39;t process subqueries without them being embedded in the VBA code, unless I read wrong, which is entirely possible."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1523476220, "post_id": 49782535, "comment_id": 86582087, "body": "Please post exact error as it relays useful information. Also, you do not need a subquery: <code>SELECT * FROM [REOEM] WHERE Manufacturer LIKE ...</code> will work. Finally, very wide tables of like data such as OEM1-75 is suboptimal database design forcing complex queries. You could use one OEM field in long format with indicators 1-75 in adjacent column. And then search one column! Always remember columns are expensive but rows are cheap, no restructuring for new OEMs, OEM76-100."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1523474493, "post_id": 49782860, "comment_id": 86581147, "body": "I was using that, but I found that...     strCriteria = &quot;<i>&quot; &amp; Me.MainSearch.Text &amp; &quot;</i>&quot;  results in the same output in the immediate window as concatenating inside the SQL string, and doing it once as opposed to 80 times leaves a lot less margin of error on my end, unless the program is going to see it differently?"}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1523474836, "post_id": 49782860, "comment_id": 86581336, "body": "Trying it anyways."}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1523474969, "post_id": 49782860, "comment_id": 86581407, "body": "Yeah, output is the same."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 1, "creation_date": 1523475086, "post_id": 49782860, "comment_id": 86581469, "body": "It actually should not be. <code>Manufacturer LIKE &#39;strCriteria&#39; OR</code> should output that exact string, not replace <code>strCriteria</code> with the contents of the <code>strCriteria</code> variable, unless you are actually doing a replacement that is not in the example code you posted."}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1523475247, "post_id": 49782860, "comment_id": 86581548, "body": "HOWEVER, changing all that let me catch a mistype I&#39;d missed.  And now I feel like a total idiot.  But it works!  Thanks!"}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1523475339, "post_id": 49782860, "comment_id": 86581603, "body": "Okay, for the purposes of further understanding, is what is printed to the immediate window through the use of debug.print strSQL the actual string that gets processed as SQL code?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1523475486, "post_id": 49782860, "comment_id": 86581676, "body": "It should be but unless you are using some weird add-on or 3rd party editor the results you are getting from the code you posted should not be the ones you are getting."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1523475593, "post_id": 49782860, "comment_id": 86581724, "body": "Two more points... using Trim after adding the <code>*</code> at start/end has no effect. Use it before that. Also if you replace a single quote with two single quotes instead of nothing you will be able to search for test that uses single quotes or apostrophes. Like this: <code>strCriteria = &quot;*&quot; &amp; Replace(Trim(Me.MainSearch.Text), &quot;&#39;&quot;, &quot;&#39;&#39;&quot;) &amp; &quot;*&quot;</code>"}, {"owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "edited": false, "score": 0, "creation_date": 1523475791, "post_id": 49782860, "comment_id": 86581841, "body": "Just standard MS Office Access VBA.  So that&#39;s weird.  Again, thanks for your help.  I&#39;ll work in your suggestions!"}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 1, "last_activity_date": 1523475287, "last_edit_date": 1523475287, "creation_date": 1523474045, "answer_id": 49782860, "question_id": 49782535, "link": "https://stackoverflow.com/questions/49782535/building-a-where-in-select-subquery-in-access-vba-through-concatenation/49782860#49782860", "title": "Building a WHERE IN SELECT Subquery in Access VBA through concatenation", "body": "<p>Are you sure that is what you get? Because as far as I can tell</p>\n\n<pre><code>Manufacturer LIKE 'strCriteria' OR ...\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Manufacturer LIKE '\" &amp; strCriteria &amp; \"' OR...\n</code></pre>\n\n<p>Etc.</p>\n\n<p>Consider this example:</p>\n\n<pre><code>Dim a As String\nDim b As String\na = \"My Text\"\nb = \"My text value is 'a'\"\n</code></pre>\n\n<p>The resulting b is <code>My text value is 'a'</code>. not <code>My text value is 'My Text'</code></p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1523478842, "last_edit_date": 1523478842, "creation_date": 1523478514, "answer_id": 49783987, "question_id": 49782535, "link": "https://stackoverflow.com/questions/49782535/building-a-where-in-select-subquery-in-access-vba-through-concatenation/49783987#49783987", "title": "Building a WHERE IN SELECT Subquery in Access VBA through concatenation", "body": "<p>Consider using parameterization, an industry best practice beyond MS Access but all databases used in application layer code. Doing so you avoid concatenating VBA values to SQL code with need of wrapping quotes or hashtags or other symbols depending on data types. Even too, a clever user can write <a href=\"https://imgs.xkcd.com/comics/exploits_of_a_mom.png\" rel=\"nofollow noreferrer\">malicious code</a> inside the search box to ruin your database. Don't think all users are <em>minimally computer literate</em>!</p>\n\n<p>MS Access SQL dialect allows the <code>PARAMETERS</code> clause. Then in VBA, use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193967.aspx\" rel=\"nofollow noreferrer\">QueryDef.Parameters</a> to bind values to named parameters. And update form with its <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/form-recordset-property-access\" rel=\"nofollow noreferrer\">Recordset</a> property where zero returned rows renders as an empty form.</p>\n\n<p><strong>SQL</strong> query <em>(save as an MS Access stored query)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS strCriteriaParam Text (255);\nSELECT * FROM REOEM\nWHERE Manufacturer LIKE strCriteriaParam OR [Type] LIKE strCriteriaParam \nOR [Make] LIKE strCriteriaParam OR Lester LIKE strCriteriaParam     \nOR OEM1 LIKE strCriteriaParam OR OEM2 LIKE strCriteriaParam OR OEM3 LIKE strCriteriaParam \nOR OEM4 LIKE strCriteriaParam OR OEM5 LIKE strCriteriaParam OR OEM6 LIKE strCriteriaParam \nOR OEM7 LIKE strCriteriaParam OR OEM8 LIKE strCriteriaParam OR OEM9 LIKE strCriteriaParam \nOR OEM10 LIKE strCriteriaParam OR OEM11 LIKE strCriteriaParam OR OEM12 LIKE strCriteriaParam \nOR OEM13 LIKE strCriteriaParam OR OEM14 LIKE strCriteriaParam OR OEM15 LIKE strCriteriaParam \nOR OEM16 LIKE strCriteriaParam OR OEM17 LIKE strCriteriaParam OR OEM18 LIKE strCriteriaParam \nOR OEM19 LIKE strCriteriaParam OR OEM20 LIKE strCriteriaParam OR OEM21 LIKE strCriteriaParam \nOR OEM22 LIKE strCriteriaParam OR OEM23 Like strCriteriaParam OR OEM24 LIKE strCriteriaParam \nOR OEM25 LIKE strCriteriaParam OR OEM26 LIKE strCriteriaParam OR OEM27 LIKE strCriteriaParam \nOR OEM28 LIKE strCriteriaParam OR OEM29 LIKE strCriteriaParam OR OEM30 LIKE strCriteriaParam \nOR OEM31 LIKE strCriteriaParam OR OEM32 LIKE strCriteriaParam OR OEM33 LIKE strCriteriaParam \nOR OEM34 LIKE strCriteriaParam OR OEM35 LIKE strCriteriaParam OR OEM36 LIKE strCriteriaParam \nOR OEM37 LIKE strCriteriaParam OR OEM38 LIKE strCriteriaParam OR OEM39 LIKE strCriteriaParam \nOR OEM40 LIKE strCriteriaParam OR OEM41 LIKE strCriteriaParam OR OEM42 LIKE strCriteriaParam \nOR OEM43 LIKE strCriteriaParam OR OEM44 LIKE strCriteriaParam OR OEM45 LIKE strCriteriaParam \nOR OEM46 LIKE strCriteriaParam OR OEM47 LIKE strCriteriaParam OR OEM48 LIKE strCriteriaParam \nOR OEM49 LIKE strCriteriaParam OR OEM50 LIKE strCriteriaParam OR OEM51 LIKE strCriteriaParam \nOR OEM52 LIKE strCriteriaParam OR OEM53 LIKE strCriteriaParam OR OEM54 LIKE strCriteriaParam \nOR OEM55 LIKE strCriteriaParam OR OEM56 LIKE strCriteriaParam OR OEM57 LIKE strCriteriaParam \nOR OEM58 LIKE strCriteriaParam OR OEM59 LIKE strCriteriaParam OR OEM60 LIKE strCriteriaParam \nOR OEM61 LIKE strCriteriaParam OR OEM62 LIKE strCriteriaParam OR OEM63 LIKE strCriteriaParam \nOR OEM64 LIKE strCriteriaParam OR OEM65 LIKE strCriteriaParam OR OEM66 LIKE strCriteriaParam \nOR OEM67 LIKE strCriteriaParam OR OEM68 LIKE strCriteriaParam OR OEM69 LIKE strCriteriaParam \nOR OEM70 LIKE strCriteriaParam OR OEM71 LIKE strCriteriaParam OR OEM72 LIKE strCriteriaParam \nOR OEM73 LIKE strCriteriaParam OR OEM74 LIKE strCriteriaParam OR OEM75 LIKE strCriteriaParam\n</code></pre>\n\n<p><strong>VBA</strong> <em>(using AfterUpdate event of MainSearch textbox)</em></p>\n\n<pre><code>Private Sub MainSearch_AfterUpdate()    \n    Dim qDef As QueryDef\n    Dim rst As Recordset\n\n    Set qDef = CurrentDb.QueryDefs(\"mySavedQuery\")\n\n    ' BIND PARAMETER TO VBA VALUE\n    qDef!strCriteriaParam = \"*\" &amp; Me.MainSearch.Text &amp; \"*\"\n\n    ' OPEN QUERYDEF'S UNDERLYING RECORDSET\n    Set rst = qDef.OpenRecordset()\n\n    ' UPDATE FORM RECORDSET BY QUERY OUTPUT\n    Set Me.Form.Recordset = rst\n\n    Set rst = Nothing\n    Set qDef = Nothing\nEnd Sub\n</code></pre>\n\n<p><em>Aside - as commented above, if you are able to do so, consider adjusting your table schema and avoid very wide tables for long tables which is arguably more maintainable, scalable, and efficient.</em></p>\n"}], "owner": {"reputation": 21, "user_id": 9625092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d725adf133527897eb2e0d99a7fb9e4?s=128&d=identicon&r=PG&f=1", "display_name": "Underpaid", "link": "https://stackoverflow.com/users/9625092/underpaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "accepted_answer_id": 49782860, "answer_count": 2, "score": 1, "last_activity_date": 1523478842, "creation_date": 1523472816, "last_edit_date": 1523476412, "question_id": 49782535, "link": "https://stackoverflow.com/questions/49782535/building-a-where-in-select-subquery-in-access-vba-through-concatenation", "title": "Building a WHERE IN SELECT Subquery in Access VBA through concatenation", "body": "<p>I'm attempting to build an inventory sorting and tracking system in Access 2016 for people that are minimally computer literate, and I've been asked to narrow it down to one search bar rather than separate filters.  After quite a bit of poking around, I've managed to get one working, when I went to replicate the design for another department, it's giving me a syntax error regarding the SQL statement my code is building.  The format for the one that works is exactly the same, and returns the same error when run through an online validator, but works functionally in practice.</p>\n\n<p>The user enters text into textbox <em>MainSearch</em>, which builds the search string (showing here as <em>1155</em> and so on), and filters the form results on the <code>AfterUpdate</code> event.  Pretty sure I can manage debugging before and after, but I can't, for all the research I'm doing, figure out where my error with the SQL syntax is.  I included the other function that it uses just in case it's relevant to someone that knows more than me.</p>\n\n<pre><code>Function ExecuteSearch(strCriteria As String) As Boolean\nOn Error Goto Err_ExecuteSearch\n\nDim strSQL As String\nDim strSQLWhere As String\nDim lngCount As Long\nDim rst as Recordset\n\nstrCriteria = \"*\" &amp; Me.MainSearch.Text &amp; \"*\"\nTrim (strCriteria)\nstrCriteria = Replace(strCriteria, \"'\", \"\")\n\nstrSQL = \"SELECT * FROM REOEM\"\n\nstrSQLWhere = \"ID IN (SELECT ID FROM REOEM WHERE Manufacturer LIKE 'strCriteria' OR Type LIKE 'strCriteria' OR Make LIKE 'strCriteria' OR Lester LIKE 'strCriteria' \" _\n&amp; \"OR OEM1 LIKE 'strCriteria' OR OEM2 LIKE 'strCriteria' OR OEM3 LIKE 'strCriteria' OR OEM4 LIKE 'strCriteria' OR OEM5 LIKE 'strCriteria' OR OEM6 LIKE 'strCriteria' OR OEM7 LIKE 'strCriteria' OR OEM8 Like 'strCriteria' OR OEM9 Like 'strCriteria' OR OEM10 LIKE 'strCriteria' \" _    \n&amp; \"OR OEM11 LIKE 'strCriteria' OR OEM12 LIKE 'strCriteria' OR OEM13 LIKE 'strCriteria' OR OEM14 LIKE 'strCriteria' OR OEM15 LIKE 'strCriteria' OR OEM16 LIKE 'strCriteria' OR OEM17 LIKE 'strCriteria' OR OEM18 LIKE 'strCriteria' OR OEM19 LIKE 'strCriteria' OR OEM20 LIKE 'strCriteria' \" _\n&amp; \"OR OEM21 LIKE 'strCriteria' OR OEM22 LIKE 'strCriteria' OR OEM23 Like 'strCriteria' OR OEM24 LIKE 'strCriteria' OR OEM25 LIKE 'strCriteria' OR OEM26 LIKE 'strCriteria' OR OEM27 LIKE 'strCriteria' OR OEM28 LIKE 'strCriteria' OR OEM29 LIKE 'strCriteria' OR OEM30 LIKE 'strCriteria' \" _\n&amp; \"OR OEM31 LIKE 'strCriteria' OR OEM32 LIKE 'strCriteria' OR OEM33 LIKE 'strCriteria' OR OEM34 LIKE 'strCriteria' OR OEM35 LIKE 'strCriteria' OR OEM36 LIKE 'strCriteria' OR OEM37 LIKE 'strCriteria' OR OEM38 LIKE 'strCriteria' OR OEM39 LIKE 'strCriteria' OR OEM40 LIKE 'strCriteria' \" _\n&amp; \"OR OEM41 LIKE 'strCriteria' OR OEM42 LIKE 'strCriteria' OR OEM43 LIKE 'strCriteria' OR OEM44 LIKE 'strCriteria' OR OEM45 LIKE 'strCriteria' OR OEM46 LIKE 'strCriteria' OR OEM47 LIKE 'strCriteria' OR OEM48 LIKE 'strCriteria' OR OEM49 LIKE 'strCriteria' OR OEM50 LIKE 'strCriteria' \" _\n&amp; \"OR OEM51 LIKE 'strCriteria' OR OEM52 LIKE 'strCriteria' OR OEM53 LIKE 'strCriteria' OR OEM54 LIKE 'strCriteria' OR OEM55 LIKE 'strCriteria' OR OEM56 LIKE 'strCriteria' OR OEM57 LIKE 'strCriteria' OR OEM58 LIKE 'strCriteria' OR OEM59 LIKE 'strCriteria' OR OEM60 LIKE 'strCriteria' \" _\n&amp; \"OR OEM61 LIKE 'strCriteria' OR OEM62 LIKE 'strCriteria' OR OEM63 LIKE 'strCriteria' OR OEM64 LIKE 'strCriteria' OR OEM65 LIKE 'strCriteria' OR OEM66 LIKE 'strCriteria' OR OEM67 LIKE 'strCriteria' OR OEM68 LIKE 'strCriteria' OR OEM69 LIKE 'strCriteria' OR OEM70 LIKE 'strCriteria \" _\n&amp; \"OR OEM71 LIKE 'strCriteria' OR OEM72 LIKE 'strCriteria' OR OEM73 LIKE 'strCriteria' OR OEM74 LIKE 'strCriteria' OR OEM75 LIKE 'strCriteria' );\"\n\nstrSQL = strSQL &amp; \" WHERE \" &amp; strSQLWhere\n\n'Used for testing SQL String\n'debug.print strSQL\nlngCount = FindRecord(strSQL)\nIf lngCount = 0 Then\n   ExecuteSearch = False\nElse\n   ExecuteSearch = True\n   Set rst = me.RecordsetClone\n   DoCmd.ApplyFilter (strSQL)\nEnd If\n\nExit_ExecuteSearch:\n   Exit Function\n\nErr_ExecuteSearch:\n   MsgBox Err.Description\n   ExecuteSearch = False\n   Resume Exit_ExecuteSearch\nEnd Function\n\n\n\n\nFunction FindRecord(ByVal strSearchString As String) As Long\nOn Error GoTo Err_Findrecord\n\nDim dbSearch as DAO.Database\nDim rsSearch as DAO.Recordset\n\nSet dbSearch = DBEngine.Workspaces(0).Databases(0)\nSet rsSearch = dbSearch.OpenRecordset(strSearchString, dbOpenSnapshot)\n\nWith rsSearch\n   If (.BOF and .EOF) Then\n      FindRecord = 0\n   Else\n      .MoveLast\n      FindRecord = .RecordCount\n   End If\nEnd With\n\nExit_FindRecord:\n   rsSearch.Close\n   dbSearch.Close\n   Exit Function\n\nErr_FindRecord:\n   MsgBox Err.Description\n   Resume Exit_FindRecord\nEnd Function\n</code></pre>\n\n<p>This is what it returns:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM [REOEM] WHERE ID IN (SELECT ID FROM [REOEM] WHERE Manufacturer LIKE '*1155*' OR Type LIKE '*1155*' OR Make LIKE '*1155*' OR Lester LIKE '*1155*' OR OEM1 LIKE '*1155*' OR OEM2 LIKE '*1155*' OR OEM3 LIKE '*1155*' OR OEM4 LIKE '*1155*' OR OEM5 LIKE '*1155*' OR OEM6 LIKE '*1155*' OR OEM7 LIKE '*1155*' Or OEM8 Like '*1155*' Or OEM9 Like '*1155*'OR OEM10 LIKE '*1155*' OR OEM11 LIKE '*1155*' OR OEM12 LIKE '*1155*' OR OEM13 LIKE '*1155*' OR OEM14 LIKE '*1155*' OR OEM15 LIKE '*1155*' OR OEM16 LIKE '*1155*' OR OEM17 LIKE '*1155*' OR OEM18 LIKE '*1155*' OR OEM19 LIKE '*1155*' OR OEM20 LIKE '*1155*' OR OEM21 LIKE '*1155*' OR OEM22 LIKE '*1155*' OR OEM23 Like '*1155*' OR OEM24 LIKE '*1155*' OR OEM25 LIKE '*1155*' OR OEM26 LIKE '*1155*' OR OEM27 LIKE '*1155*' OR OEM28 LIKE '*1155*' OR OEM29 LIKE '*1155*' OR OEM30 LIKE '*1155*' OR OEM31 LIKE '*1155*' OR OEM32 LIKE '*1155*' OR OEM33 LIKE '*1155*' OR OEM34 LIKE '*1155*' OR OEM35 LIKE '*1155*' OR OEM36 LIKE '*1155*' OR OEM37 LIKE '*1155*' OR OEM38 LIKE '*1155*'\nOR OEM39 LIKE '*1155*' OR OEM40 LIKE '*1155*' OR OEM41 LIKE '*1155*' OR OEM42 LIKE '*1155*' OR OEM43 LIKE '*1155*' OR OEM44 LIKE '*1155*' OR OEM45 LIKE '*1155*' OR OEM46 LIKE '*1155*' OR OEM47 LIKE '*1155*' OR OEM48 LIKE '*1155*' OR OEM49 LIKE '*1155*' OR OEM50 LIKE '*1155*' OR OEM51 LIKE '*1155*' OR OEM52 LIKE '*1155*' OR OEM53 LIKE '*1155*' OR OEM54 LIKE '*1155*' OR OEM55 LIKE '*1155*' OR OEM56 LIKE '*1155*' OR OEM57 LIKE '*1155*' OR OEM58 LIKE '*1155*' OR OEM59 LIKE '*1155*' OR OEM60 LIKE '*1155*' OR OEM61 LIKE '*1155*' OR OEM62 LIKE '*1155*' OR OEM63 LIKE '*1155*' OR OEM64 LIKE '*1155*' OR OEM65 LIKE '*1155*' OR OEM66 LIKE '*1155*' OR OEM67 LIKE '*1155*' OR OEM68 LIKE '*1155*' OR OEM69 LIKE '*1155*' OR OEM70 LIKE '*1155*' OR OEM71 LIKE '*1155*' OR OEM72 LIKE '*1155*' OR OEM73 LIKE '*1155*' OR OEM74 LIKE '*1155*' OR OEM75 LIKE '*1155*' ); \n</code></pre>\n\n<p>Any assistance would be greatly appreciated.  Be gentle, I've only been at this about a month.  Most of this code is shamelessly adapted from online sources.</p>\n"}, {"tags": ["excel", "vba", "loops", "charts"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523473383, "post_id": 49782216, "comment_id": 86580600, "body": "I can&#39;t reproduce the issue over here."}], "owner": {"reputation": 37, "user_id": 9598514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b81d6d5201347af010486468eac4be0?s=128&d=identicon&r=PG&f=1", "display_name": "amea6995", "link": "https://stackoverflow.com/users/9598514/amea6995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1523477357, "creation_date": 1523471623, "last_edit_date": 1523477357, "question_id": 49782216, "link": "https://stackoverflow.com/questions/49782216/first-chart-created-in-a-loop-is-different-from-subsequent-charts", "title": "First chart created in a loop is different from subsequent charts", "body": "<p>I have a loop that produces the charts automatically from a set of data. My issue is that the first chart is always different from the subsequent charts.Can anyone help with why my first chart is always different than my subsequent charts? </p>\n\n<p>Here is what the charts look like after i run the code: </p>\n\n<p><a href=\"https://i.stack.imgur.com/6x03K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6x03K.png\" alt=\"Charts\"></a></p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Pyramid()\n\n Sheets(\"Pyramid\").Select\n Range(\"C2\").Select\n ActiveCell.Range(\"B1:J1\").Select\n\n\n    For counter = 2 To 5\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.ApplyChartTemplate ( _\n            \"C:\\Users\\arboari\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\1Pyramid.crtx\")\n        With ActiveChart\n             Do While .SeriesCollection.Count &gt; 0\n                .SeriesCollection(1).Delete\n             Loop\n            .SeriesCollection.NewSeries.Values = Range(\"'Pyramid'!$W$2\" &amp; \":$AN$2\") 'BC males\n            .SeriesCollection.NewSeries.Values = Range(\"'Pyramid'!$W$3\" &amp; \":$AN$3\") 'BC females\n            .SeriesCollection.NewSeries.Values = Range(\"'Pyramid'!$C$\" &amp; counter &amp; \":$K$\" &amp; counter) 'Community males\n            .SeriesCollection.NewSeries.Values = Range(\"'Pyramid'!$M$\" &amp; counter &amp; \":$U$\" &amp; counter) 'Community females\n                .FullSeriesCollection(1).Name = \"='Pyramid'!$V$2\" 'BC males\n                .FullSeriesCollection(2).Name = \"='Pyramid'!$V$3\" 'BC females\n                .FullSeriesCollection(3).Name = \"='Pyramid'!$B$2\" 'Community males\n                .FullSeriesCollection(4).Name = \"='Pyramid'!$L$2\" 'Community females\n        End With\n\n        ActiveChart.Location Where:=xlLocationAsObject, Name:=\"Charts\"\n\n        With ActiveChart\n            .HasTitle = False\n            .Axes(xlCategory).MinimumScale = -15\n            .Axes(xlCategory).MaximumScale = 15\n            .FullSeriesCollection(3).Select\n                With Selection.Format.Fill\n                    .Visible = msoTrue\n                    .Patterned msoPatternLightVertical\n                End With\n                Selection.AxisGroup = 2\n            .FullSeriesCollection(4).Select\n                With Selection.Format.Fill\n                    .Visible = msoTrue\n                    .Patterned msoPatternLightVertical\n                End With\n                Selection.AxisGroup = 2\n            .Parent.Top = 50\n            .Parent.Left = c * 130\n        End With\n        Sheets(\"Charts\").Select\n\n        c = c + 3\n    Next counter\nRange(\"J1\").Select\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1523471013, "post_id": 49781987, "comment_id": 86579377, "body": "please share your code. Also, characters in row 2 any column? Copy to same current row?  You can possibly also just use a helper column, e.g. A1 = A2 and filter on the True result and copy."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1523471037, "post_id": 49781987, "comment_id": 86579392, "body": "Needs sample data and expected results (more than one match in the sample data please).  Additionally please provide any code you&#39;ve tried so far."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523471102, "post_id": 49781987, "comment_id": 86579427, "body": "With vba you can loop comparing with Offset(1,0) to  check against next cell below if in same column, and should terminate at last row - 1 to ensure you don&#39;t compare against the empty cell after the used range."}, {"owner": {"reputation": 1, "user_id": 9591822, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Patsy Clew", "link": "https://stackoverflow.com/users/9591822/patsy-clew"}, "edited": false, "score": 0, "creation_date": 1523502569, "post_id": 49781987, "comment_id": 86589886, "body": "I&#39;ve updated the post to include an image of my spreadsheet and how it needs to work.  I&#39;ve also referenced a specific question and response in Stack Overflow that I was trying to modify for my particular situation but I couldn&#39;t get it to work for me.  Thanks so much for taking the time to try and help me out.  I really appreciate it."}, {"owner": {"reputation": 1, "user_id": 9591822, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Patsy Clew", "link": "https://stackoverflow.com/users/9591822/patsy-clew"}, "edited": false, "score": 0, "creation_date": 1523538191, "post_id": 49781987, "comment_id": 86609012, "body": "Wow!  This is definitely more than I could have generated on my own.  However, when I tried to run it with my test data, I got an error from Visual Basic saying subscript is Out of Range.  Can you explain what this error message means?"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523605799, "post_id": 49789158, "comment_id": 86638198, "body": "Did you try running this? You would need to change ThisWorkbook.Worksheets(&quot;Data&quot;) to the sheet name of the sheet containing your data. Do you want anything explaining?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523904731, "post_id": 49789158, "comment_id": 86744006, "body": "Any feedback on this please?"}, {"owner": {"reputation": 1, "user_id": 9591822, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Patsy Clew", "link": "https://stackoverflow.com/users/9591822/patsy-clew"}, "edited": false, "score": 0, "creation_date": 1523907954, "post_id": 49789158, "comment_id": 86745560, "body": "I can&#39;t get this to work.  Every time I trick to run the macro, the first line is highlighted in yellow.  Here&#39;s what I modified as you instructed.  Did I do this right?ThisWorkbook(&quot;Memberdata.xlsb&quot;).Worksheets(&quot;Sheet1&quot;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9591822, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Patsy Clew", "link": "https://stackoverflow.com/users/9591822/patsy-clew"}, "edited": false, "score": 0, "creation_date": 1523908495, "post_id": 49789158, "comment_id": 86745799, "body": "Nope. Are you working with the same workbook as the code is in?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9591822, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Patsy Clew", "link": "https://stackoverflow.com/users/9591822/patsy-clew"}, "edited": false, "score": 0, "creation_date": 1523908566, "post_id": 49789158, "comment_id": 86745841, "body": "If you intend this to use sheet 1 in the same workbook as the code is in then you simply say Worksheets(&quot;Sheet1&quot;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9591822, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Patsy Clew", "link": "https://stackoverflow.com/users/9591822/patsy-clew"}, "edited": false, "score": 0, "creation_date": 1523908999, "post_id": 49789158, "comment_id": 86746056, "body": "Did that make sense? If not, can you pastebin <a href=\"https://pastebin.com/\" rel=\"nofollow noreferrer\">pastebin.com</a> more of your code?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1523514856, "last_edit_date": 1523514856, "creation_date": 1523513381, "answer_id": 49789158, "question_id": 49781987, "link": "https://stackoverflow.com/questions/49781987/if-statement-comparing-strings-in-different-rows-but-the-same-column/49789158#49789158", "title": "If Statement comparing strings in different rows but the same column", "body": "<p>Something like:</p>\n\n<pre><code> Public Sub ArrangeData()\n    Dim i As Long, unionRng As Range, lastRow As Long, counter As Long\n    Application.ScreenUpdating = False\n\n    With ThisWorkbook.Worksheets(\"Data\")         'change as appropriate\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        .Range(\"A1:G\" &amp; lastRow).Sort Key1:=.Range(\"G2:G\" &amp; lastRow), Order1:=xlAscending, Header:=xlYes ' 'Sort to ensure in order (and blanks will be at end\n\n        For i = 3 To .Range(\"G1\").End(xlDown).Row + 1\n            If .Cells(i, \"G\") = .Cells(i - 1, \"G\") Then\n                counter = counter + 1\n                .Cells(i, \"A\").Resize(1, 6).Copy .Cells(i - counter, .Cells(i - counter, .Columns.Count).End(xlToLeft).Column + 1)\n            Else\n                counter = 0\n            End If\n        Next i\n\n        For i = 3 To .Range(\"G1\").End(xlDown).Row + 1\n            If IsEmpty(.Cells(i, \"H\")) Then\n                If Not unionRng Is Nothing Then\n                    Set unionRng = Union(unionRng, .Cells(i, \"H\"))\n                Else\n                    Set unionRng = .Cells(i, \"H\")\n                End If\n            End If\n        Next i\n        If Not unionRng Is Nothing Then unionRng.EntireRow.Delete\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>Before:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/HOD3N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HOD3N.png\" alt=\"Before\"></a></p>\n\n<p><strong>After:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/VNUQ2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VNUQ2.png\" alt=\"After\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9591822, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Patsy Clew", "link": "https://stackoverflow.com/users/9591822/patsy-clew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1523514856, "creation_date": 1523470787, "last_edit_date": 1523502399, "question_id": 49781987, "link": "https://stackoverflow.com/questions/49781987/if-statement-comparing-strings-in-different-rows-but-the-same-column", "title": "If Statement comparing strings in different rows but the same column", "body": "<p>I'm attempting to combine 2 rows on my excel spreadsheet into 1 row based on a particular condition being true.  </p>\n\n<p>I would like for my vba code to determine whether or not the string of characters in row 2 = the string of characters in row 3.  </p>\n\n<p>If they are equal, I would like to copy all of row 3 to column Q in row and then continue on comparing the string values of rows 3 and 4, 4 and 5, etc to the last used row of the spreadsheet.  </p>\n\n<p>I've attempted to modify code I've found on Stack Overflow but still can't get my macro to run.  Any help with this would be greatly appreciated.</p>\n\n<p>Here's a link to a similar situation I found in Stack Overflow while I was researching how to create my VBA code but I couldn't get the sample code to work for me.  Not sure why.  <a href=\"https://stackoverflow.com/questions/40868115/vba-excel-if-value-next-row-value-then-copy-another-value?rq=1\">vba - excel - if value = next row value then copy another value</a></p>\n\n<p>Here's part of the Excel worksheet I'm working with.  I did have to modify the information on the spreadsheet so that it wouldn't be too wide to paste.</p>\n\n<p><a href=\"https://i.stack.imgur.com/de2bq.png\" rel=\"nofollow noreferrer\">Member Data spreadsheet</a></p>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1523470736, "post_id": 49781919, "comment_id": 86579249, "body": "How is <code>wsDataSchool</code> declared? It sound like you need to be including the worksheet you want the <code>ShowAllData</code> to apply to"}, {"owner": {"reputation": 43, "user_id": 8468973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkU0v.png?s=128&g=1", "display_name": "SteliosM", "link": "https://stackoverflow.com/users/8468973/steliosm"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1523471036, "post_id": 49781919, "comment_id": 86579390, "body": "wsDataSchool is the codename of the worksheet I a referring to."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8468973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkU0v.png?s=128&g=1", "display_name": "SteliosM", "link": "https://stackoverflow.com/users/8468973/steliosm"}, "edited": false, "score": 0, "creation_date": 1523473822, "post_id": 49782602, "comment_id": 86580799, "body": "That could work, thanks. However, would you consider this a bug, since the solution only avoids the error and not really explains it."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 43, "user_id": 8468973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkU0v.png?s=128&g=1", "display_name": "SteliosM", "link": "https://stackoverflow.com/users/8468973/steliosm"}, "edited": false, "score": 0, "creation_date": 1523473948, "post_id": 49782602, "comment_id": 86580867, "body": "The documentation was vague on this. The example given said you should run this in the sheet where the filter is. There is no mention of chart sheets or that it can work across sheets. I will need to look further."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 43, "user_id": 8468973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkU0v.png?s=128&g=1", "display_name": "SteliosM", "link": "https://stackoverflow.com/users/8468973/steliosm"}, "edited": false, "score": 0, "creation_date": 1523474333, "post_id": 49782602, "comment_id": 86581054, "body": "What is interesting is you can run that line from within the code pane of the chart sheet itself which makes you wonder about scope."}, {"owner": {"reputation": 43, "user_id": 8468973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkU0v.png?s=128&g=1", "display_name": "SteliosM", "link": "https://stackoverflow.com/users/8468973/steliosm"}, "edited": false, "score": 0, "creation_date": 1523475531, "post_id": 49782602, "comment_id": 86581696, "body": "It really is weird. I guess I will leave it that way and go with how it is."}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1574049685, "post_id": 49782602, "comment_id": 104078180, "body": "I will use <code>If  Not ActiveChart Is Nothing Then</code> instead of <code>Select Case ActiveSheet.Type</code>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1523473544, "last_edit_date": 1523473544, "creation_date": 1523473096, "answer_id": 49782602, "question_id": 49781919, "link": "https://stackoverflow.com/questions/49781919/vba-showalldata-fails-when-a-chart-sheet-is-active/49782602#49782602", "title": "VBA .ShowAllData fails when a Chart Sheet is active", "body": "<p>Add a test maybe then. This tests if current sheet is a chart sheet and if so then activates the target sheet by codename.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    If wsDataSchool.FilterMode Then\n        Select Case ActiveSheet.Type\n        Case -4167\n            wsDataSchool.ShowAllData\n        Case Else\n            wsDataSchool.Activate\n            wsDataSchool.ShowAllData\n        End Select\n    End If\nEnd Sub\n</code></pre>\n\n<p>Although ugly, if you then need to return to a Chart sheet if in a chart sheet you could as follows:</p>\n\n<pre><code>Public Sub test1()\n    Application.ScreenUpdating = True\n    Dim ws As Chart\n    If wsDataSchool.FilterMode Then\n        Select Case ActiveSheet.Type\n        Case -4167\n            wsDataSchool.ShowAllData\n        Case Else\n            Set ws = ActiveSheet\n            wsDataSchool.Activate\n            wsDataSchool.ShowAllData\n            ws.Activate\n        End Select\n    End If\n    Application.ScreenUpdating = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8468973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkU0v.png?s=128&g=1", "display_name": "SteliosM", "link": "https://stackoverflow.com/users/8468973/steliosm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 49782602, "answer_count": 1, "score": 0, "last_activity_date": 1523473544, "creation_date": 1523470533, "question_id": 49781919, "link": "https://stackoverflow.com/questions/49781919/vba-showalldata-fails-when-a-chart-sheet-is-active", "title": "VBA .ShowAllData fails when a Chart Sheet is active", "body": "<p>I have the code below attached to a button on a userform in Excel. There are other parts of the code that perform advanced filtering and I use the code below to clear the filter before re-applying the filter, to make it run much faster. It works just fine as long as wsDataSchool is the active sheet or some other sheet is active. However, if there is a CHART sheet active before I click the button then I get an error saying ShowAllData failed. This is super weird and I can't find anything about it. Any ideas as to why this is happening or how to fix it?</p>\n\n<pre><code>If wsDataSchool.FilterMode = True Then\n    wsDataSchool.ShowAllData\nEnd If\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 148, "user_id": 3077926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1OUf.png?s=128&g=1", "display_name": "Calaris", "link": "https://stackoverflow.com/users/3077926/calaris"}, "edited": false, "score": 0, "creation_date": 1523512326, "post_id": 49781880, "comment_id": 86592704, "body": "There is nothing wrong with this code. I&#39;ve copied it to a blank database, created a form with a textbox (ProjectEndDate) and a Combo1. I&#39;ve tried all possible combinations (enddate null, &gt;date, &lt;date, combo empty or pre-filled). The combo shows up with a red background when expected. So my guess is, there is something else."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1523535221, "post_id": 49781880, "comment_id": 86606717, "body": "Have you tried using this code in Form_current and combine it with a <code>Painting</code>?"}], "owner": {"reputation": 3, "user_id": 8683960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8965789d588158faf49c2bf3449ff3?s=128&d=identicon&r=PG&f=1", "display_name": "JackRussel", "link": "https://stackoverflow.com/users/8683960/jackrussel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594635759, "creation_date": 1523470339, "last_edit_date": 1594635759, "question_id": 49781880, "link": "https://stackoverflow.com/questions/49781880/how-to-change-the-background-color-of-a-combobox-in-ms-access-using-vba", "title": "How to change the background color of a combobox in ms access using vba", "body": "<p>So I have a ms access form with a bunch of a comboboxes in it. I want to change the background of the combobox to red if it's null and its past the end date of the project. I have attached my code snippet below. so far it's only changing the background color of the list, not the combobox itself. the code snippet is set to run during the form open event.</p>\n\n<pre><code>If Me.Combo1.Visible = True Then\n\n    If IsNull(Me.Combo1) = False Then\n\n        textsum = textsum + 1\n        totalcount = totalcount + 1\n\n    Else\n\n        totalcount = totalcount + 1\n\n        If Me.ProjectEndDate&lt;= Date Then\n\n            Me.Combo1.BackColor = RGB(255, 0, 0)\n\n        End If\n\n    End If\nEnd if\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "edited": false, "score": 0, "creation_date": 1523469725, "post_id": 49781619, "comment_id": 86578733, "body": "It definitely should work (<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-pivottables-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>). There&#39;s an exemple in the provided link, using name reference."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523477066, "post_id": 49781619, "comment_id": 86582561, "body": "Do you have a macro free .xlsx  to share with dummy data that can reproduce the problem? The above appears correct."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1523478138, "post_id": 49783812, "comment_id": 86583120, "body": "Or your actual first sheet was not &quot;Sheet1&quot; in the workbook? Haven&#39;t tested but I would expect you to be able to use Index."}], "tags": [], "owner": {"reputation": 89, "user_id": 4123348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/45d858236b9642efdc42a0b1f230e882?s=128&d=identicon&r=PG&f=1", "display_name": "AGryckiewicz", "link": "https://stackoverflow.com/users/4123348/agryckiewicz"}, "is_accepted": true, "score": 0, "last_activity_date": 1523477801, "creation_date": 1523477801, "answer_id": 49783812, "question_id": 49781619, "link": "https://stackoverflow.com/questions/49781619/vba-referencing-a-pivot-table-by-name-rather-than-index-number/49783812#49783812", "title": "VBA: Referencing a Pivot Table by name rather than index number", "body": "<p>I found the answer to my problem. I was still using an index number to refer to the Worksheet and this was throwing the error. So this doesn't work:</p>\n\n<p><code>With ThisWorkbook.Worksheets(1).PivotTables(\"PivotTable1\").PivotFields(\"InvestorNumber\")\nEnd With</code></p>\n\n<p>While it appears this does work:</p>\n\n<p><code>With ThisWorkbook.Worksheets(\"Sheet1\").PivotTables(\"PivotTable1\").PivotFields(\"InvestorNumber\")\nEnd With</code></p>\n\n<p>If you want to use names rather than index numbers in the object reference, then names have to be used for all members; you can't use a mix of indexes and names apparently.</p>\n"}], "owner": {"reputation": 89, "user_id": 4123348, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/45d858236b9642efdc42a0b1f230e882?s=128&d=identicon&r=PG&f=1", "display_name": "AGryckiewicz", "link": "https://stackoverflow.com/users/4123348/agryckiewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3594, "favorite_count": 0, "accepted_answer_id": 49783812, "answer_count": 1, "score": 2, "last_activity_date": 1523477801, "creation_date": 1523469346, "question_id": 49781619, "link": "https://stackoverflow.com/questions/49781619/vba-referencing-a-pivot-table-by-name-rather-than-index-number", "title": "VBA: Referencing a Pivot Table by name rather than index number", "body": "<p>I have a simple question. What is the syntax for referencing a pivot table in VBA by its <em>name</em> rather than its index number? </p>\n\n<p>For example, I could write this line like this:</p>\n\n<p><code>With ThisWorkbook.Worksheets(\"Sheet1\").PivotTables(1).PivotFields(\"InvestorNumber\")\nEnd With</code></p>\n\n<p>But I need to write it like this:</p>\n\n<p><code>With ThisWorkbook.Worksheets(\"Sheet1\").PivotTables(\"PivotTable1\").PivotFields(\"InvestorNumber\") End With</code></p>\n\n<p>Writing it the second way errors-out with \"subscript not in range\" although \"PivotTable1\" definitely exists on this worksheet and the pivot table's name is definitely \"PivotTable1\"</p>\n\n<p>Any thoughts on what is wrong with the syntax? </p>\n\n<p>MSDN says it can be referenced by name, but doesn't give an example of how you do it.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pivottables-object-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pivottables-object-excel</a></p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "dictionary", "multidimensional-array", "fso"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1523469054, "post_id": 49781339, "comment_id": 86578361, "body": "Have a look here <a href=\"https://stackoverflow.com/questions/11635526/return-csv-file-as-recordset\" title=\"return csv file as recordset\">stackoverflow.com/questions/11635526/&hellip;</a>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1523469060, "post_id": 49781339, "comment_id": 86578368, "body": "My idea would be to read the file only once. Read the line as you do now and add the whole line to a collection in case the conditon is true."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1523469341, "post_id": 49781339, "comment_id": 86578515, "body": "Use vb.net instead of vba. It&#39;s much faster."}, {"owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "edited": false, "score": 1, "creation_date": 1523469458, "post_id": 49781339, "comment_id": 86578579, "body": "Hello braX, i can&#39;t use .NET since i&#39;m on company&#39;s enviroment. Unfortunatelly, excel vba is the only tool i have at hands."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "edited": false, "score": 0, "creation_date": 1523470740, "post_id": 49781798, "comment_id": 86579250, "body": "Already tried it myself and was confused since the debugger only shows 256 entries in the collection, but a little research shows that it seems to be  a debugger limitation, not a collection&#39;s... is that right? Will test again and come back"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "edited": false, "score": 0, "creation_date": 1523471311, "post_id": 49781798, "comment_id": 86579517, "body": "Yes, it seems that the debugger has a limitation. I just read an 800 MB file line by line into a collection and I can only see 256 entries in the debugger. The collection itself does have more than 600000 entries and I can access items with an index greater than 256. You always learn something."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 2, "last_activity_date": 1523469997, "creation_date": 1523469997, "answer_id": 49781798, "question_id": 49781339, "link": "https://stackoverflow.com/questions/49781339/faster-way-to-dump-immense-text-into-array/49781798#49781798", "title": "Faster way to dump immense text into array", "body": "<p>Change the first loop to </p>\n\n<pre><code>Dim colLines As Collection\nSet colLines = New Collection\n    Do While Not myFile.AtEndOfStream\n        textline = myFile.ReadLine\n        arrLine = Split(textline, \";\")\n        If hbDict.exists(arrLine(3)) Then\n            'arrLimit = arrLimit + 1\n            colLines.Add textline\n        End If\n    Loop\n</code></pre>\n\n<p>And the second loop </p>\n\n<pre><code>Dim i As Long\nReDim MyArray(1 To colLines.Count, 1 To 31)\n\nFor i = 1 To colLines.Count\n    textline = colLines(i)\n    arrLine = Split(textline, \";\")\n    If hbDict.exists(arrLine(3)) Then\n        For c = 1 To 31\n            MyArray(L, c) = arrLine(c - 1)\n        Next\n        L = L + 1\n    End If\nNext i\n</code></pre>\n\n<p>In such a way you only need to read the text file once. Because it's so big you won't be able to read the file completely into memory.</p>\n"}], "owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 49781798, "answer_count": 1, "score": 2, "last_activity_date": 1523469997, "creation_date": 1523468281, "last_edit_date": 1523469317, "question_id": 49781339, "link": "https://stackoverflow.com/questions/49781339/faster-way-to-dump-immense-text-into-array", "title": "Faster way to dump immense text into array", "body": "<p>I have a .txt with around 6gb of data. Fields delimited by semicolons.</p>\n\n<p>I need to check one of the fields line by line against a prebuild dictionary and if there is a match copy all the fields of the respective line into a 2 dimmension array.</p>\n\n<p>Currently this is the relevant part of code (declarations and fucntions omited. Not at the scope of this question):</p>\n\n<pre><code>Set hbDict = dict_HB(hb) ''--this returns a dictionary from a function for comparison\n\nSet FSO = CreateObject(\"scripting.filesystemobject\")\nSet myFile = FSO.OpenTextFile(sPath &amp; sFilename, ForReading)\n\n'--This counts how many matches occur between txt and dictionary to redim the array:\nDo While myFile.AtEndOfStream &lt;&gt; True\n    textline = myFile.ReadLine\n    arrLine = Split(textline, \";\")\n    If hbDict.exists(arrLine(3)) Then\n        arrLimit = arrLimit + 1\n    End If\nLoop\n\nRedim MyArray(1 to arrLimit, 1 to 31)\n\n'--Loop again through the file, now actually adding to the redimmed array:\nL = 1\nDo While myFile.AtEndOfStream &lt;&gt; True\n    textline = myFile.ReadLine\n    arrLine = Split(textline, \";\")\n    If hbDict.exists(arrLine(3)) Then\n        For c = 1 to 31\n            MyArray(L,C) = arrLine(c-1)\n        Next\n        L = L + 1\n    End If\nLoop\nmyFile.Close\nset FSO = nothing\n\n'code continues...\n</code></pre>\n\n<p>First loop takes around 19 minutes. second a little more.</p>\n\n<p>Already tried to open for append, but it crashes, maybe because i'm running at 4gb of RAM.\nAny way of loading the entire file at once, seems to crash the machine.\nOpen for input does not read the entire file, so data is lost.\nThe use of a collection in the first loop to avoid relooping the txt would be great if it could handle more than 256 entries...\nAnd off course, dinamically redim array inside the loop is out of question since it is a performance killer.</p>\n\n<p>Is there any way to do it faster than this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 5, "creation_date": 1523468236, "post_id": 49781230, "comment_id": 86577920, "body": "Replace your <code>ActiveSheet</code>s with the name of the actual worksheet (<code>Worksheets(&quot;Sheet1&quot;)</code>) and try to avoid using <code>.Select</code> when you can."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 2, "creation_date": 1523468786, "post_id": 49781230, "comment_id": 86578231, "body": "When it fails while running, but not while stepping, it is often due to race conditions. If you add pauses in strategic places (like a MsgBox) you can find out where it fails. If you&#39;re lucky, a simple DoEvents there will solve it. Otherwise you need a Sleep call"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1523473894, "post_id": 49781230, "comment_id": 86580836, "body": "@PortlandRunner <a href=\"https://en.wikipedia.org/wiki/Race_condition\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Race_condition</a>"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1523485884, "post_id": 49781230, "comment_id": 86586073, "body": "@Sam - Thanks for link, I haven&#39;t heard it called that before but am familiar with the concept.  Cheers"}], "owner": {"reputation": 3, "user_id": 9607710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ace827b1e0c1b8c6e99b95b0eba727?s=128&d=identicon&r=PG&f=1", "display_name": "Tyloid", "link": "https://stackoverflow.com/users/9607710/tyloid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1886, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523467877, "creation_date": 1523467877, "question_id": 49781230, "link": "https://stackoverflow.com/questions/49781230/vba-code-only-works-when-stepping-through", "title": "VBA code only works when stepping through", "body": "<p>Code only works when stepping through. Any ideas? I've looked through other questions but answers seem to be based on code. Thanks!</p>\n\n<p>See code:</p>\n\n<pre><code>Sub CopyPasteFilteredData()\n\n    ActiveSheet.Range(\"$C$1:$BJ$15\").AutoFilter Field:=4, Criteria1:=\"&lt;&gt;\" 'selects all cells in range\n    Range(\"C2\").Select 'first cell of data\n    Range(Selection, Selection.End(xlDown)).Select  'control down\n    Range(Selection, Selection.End(xlToRight)).Select  'control right\n    Selection.Copy    ' copy selection\n    Sheets(\"Results Sheet\").Select    'select results sheet\n    Range(\"A2\").Select\n    Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select     'select next available row\n    ActiveSheet.Paste           'paste data\n    Sheets(\"Stand Alone\").Select             'move back to stand alone sheet\n    ActiveSheet.ShowAllData                  'and unfilter all data\nEnd Sub\n\n\nSub LoopCopyPaste()\n\nDim rng As Range\nDim cell As Range\n\nDim oldfilestring As String    'old file\nDim filestring As String       'new file\n\nSet rng = Range(\"Files\")       'set range based on file names\n\noldfilestring = \"File A.xlsm\"    \n\nFor Each cell In rng\n    filestring = cell.Value\n    ActiveWorkbook.ChangeLink Name:=oldfilestring, NewName:=filestring, Type:=xlExcelLinks    \nCopyPasteFilteredData                    \n    oldfilestring = filestring           \nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>This is looping through a named range \"Files\" - and pasting the data to a Results Sheet. </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "edited": false, "score": 0, "creation_date": 1523470613, "post_id": 49780710, "comment_id": 86579189, "body": "I had an idea, maybe I could use a 2 dimensional array and append only elements that are greater than zero to the array along with their corresponding item name. Item 1 has 5. Does anyone have a better solution than this though?"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "is_accepted": false, "score": 0, "last_activity_date": 1523476283, "creation_date": 1523476283, "answer_id": 49783420, "question_id": 49780710, "link": "https://stackoverflow.com/questions/49780710/using-if-statements-in-the-body-of-email-excel-to-outlook/49783420#49783420", "title": "Using if statements in the body of email Excel to Outlook", "body": "<p>I figured it out, with a combination of if statements underneath the calculation and a strmessage string. I just added the line with the amount if it was above 0.</p>\n\n<pre><code>If item1 &gt; 0 then\n   strmessage = strmessage &amp; \"Item 1 - \" &amp; strmessage &amp; vbnewline\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593004572, "creation_date": 1523465881, "last_edit_date": 1593004572, "question_id": 49780710, "link": "https://stackoverflow.com/questions/49780710/using-if-statements-in-the-body-of-email-excel-to-outlook", "title": "Using if statements in the body of email Excel to Outlook", "body": "<p>I am lost on how to tackle this part of the project I have undertaken for my company. I have created thus far, code that will filter, search for count of times an item is mentioned, and store it into a variable. </p>\n\n<p>I have 20 of these items and I need to send an email out with the amount of times an item was mentioned. </p>\n\n<p>I would rather just send an email that shows only the items that were mentioned and leave the rest out. </p>\n\n<p>Doing this in Excel is the hard part as I am unsure how to code it in the body. Any help on sending me in the right direction would be greatly appreciated. </p>\n\n<p>EX. </p>\n\n<pre><code>Item 1,\nItem 1,\nItem 2,\nItem 3.\n\nVarForItem1 = 2 \n\nVarForItem2 = 1 \n\nVarForItem3 = 1\n\nVarForItem4 = 0\n\nVarForItem5 = 0\n</code></pre>\n\n<p>etc.</p>\n\n<p>I want the email to only show the Vars that have greater than 0.</p>\n"}, {"tags": ["string", "vba", "excel", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 9, "last_activity_date": 1523466102, "creation_date": 1523466102, "answer_id": 49780768, "question_id": 49780635, "link": "https://stackoverflow.com/questions/49780635/using-vba-to-select-non-adjacent-range/49780768#49780768", "title": "Using VBA to select non-adjacent range", "body": "<p>You could use the <a href=\"https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/application-union-method-excel\" rel=\"noreferrer\">Union</a> method, not that you usually need to Select anything...</p>\n\n<pre><code>Union(Range(\"N3:N\" &amp; LastRow), Range(\"P3:R\" &amp; LastRow)).Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523474241, "post_id": 49781836, "comment_id": 86581000, "body": "Good spot, I hadn&#39;t noticed the misplaced comma. You could do <code>Range(&quot;N3:N&quot; &amp; LastRow &amp; &quot;,P3:R&quot; &amp; LastRow).Select</code>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523479062, "post_id": 49781836, "comment_id": 86583569, "body": "@SJR, True. But I left that comma alone just to &quot;mark&quot; its proper place"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 3, "last_activity_date": 1523470472, "last_edit_date": 1523470472, "creation_date": 1523470152, "answer_id": 49781836, "question_id": 49780635, "link": "https://stackoverflow.com/questions/49780635/using-vba-to-select-non-adjacent-range/49781836#49781836", "title": "Using VBA to select non-adjacent range", "body": "<p>you can use</p>\n\n<pre><code>Range(\"N3:N\" &amp; LastRow &amp; \",\" &amp; \"P3:R\" &amp; LastRow).Select\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Intersect(Range(\"N:N, P:R\"), Rows(3).Resize(LastRow - 3)).Select\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8032747, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DnWVQJZJA1w/AAAAAAAAAAI/AAAAAAAARkQ/tjBdt4hIyGg/photo.jpg?sz=128", "display_name": "Dipin Samuel", "link": "https://stackoverflow.com/users/8032747/dipin-samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12586, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1523470472, "creation_date": 1523465678, "last_edit_date": 1531164843, "question_id": 49780635, "link": "https://stackoverflow.com/questions/49780635/using-vba-to-select-non-adjacent-range", "title": "Using VBA to select non-adjacent range", "body": "<p>I know how to select a range till a calculated last row using vba as such:</p>\n\n<pre><code>Range(\"P3:R\" &amp; LastRow).Select\n</code></pre>\n\n<p>Is there a way to select non-adjacent column data? For example I want cells from column N to R <strong>WITHOUT</strong> column O</p>\n\n<p>Tried below, but it ends up selecting O too, I suspect because the <code>\"</code> character should encompass the whole thing, but then how do I keep the variable value for last row?</p>\n\n<pre><code>Range(\"N3:N\" &amp; LastRow , \"P3:R\" &amp; LastRow).Select\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1559, "user_id": 2211491, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/d6pLD.png?s=128&g=1", "display_name": "Fat Monk", "link": "https://stackoverflow.com/users/2211491/fat-monk"}, "edited": false, "score": 0, "creation_date": 1523528805, "post_id": 49784440, "comment_id": 86602527, "body": "Almost perfect... That does a string based filter - using <code>Value1:=1000</code> (i.e. without the quotes) works perfectly. If you could add the numerical less than version to your answer as well I&#39;ll gladly accept. (I did actually try <code>.Add2</code> but thought I was getting exactly the same errors - I must have had other syntax problems when I was trying it - I was getting very confused)"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1559, "user_id": 2211491, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/d6pLD.png?s=128&g=1", "display_name": "Fat Monk", "link": "https://stackoverflow.com/users/2211491/fat-monk"}, "edited": false, "score": 0, "creation_date": 1523529822, "post_id": 49784440, "comment_id": 86603141, "body": "Is this for a Values filter? i.e. you want to filter the aggregated values in the Values area of the PivotTable from the perspective of MyPivotColumnTopField? See my edited answer above to see what my question relates to."}, {"owner": {"reputation": 1559, "user_id": 2211491, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/d6pLD.png?s=128&g=1", "display_name": "Fat Monk", "link": "https://stackoverflow.com/users/2211491/fat-monk"}, "edited": false, "score": 0, "creation_date": 1523530350, "post_id": 49784440, "comment_id": 86603483, "body": "I&#39;m actually just using PivotTables to extract data from a bigger data set so the pivot table is displaying everything in tabular form without any totals or other calculations. Some of the view only require a further subset of that extracted data, though, hence the numeric filter requirement."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1559, "user_id": 2211491, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/d6pLD.png?s=128&g=1", "display_name": "Fat Monk", "link": "https://stackoverflow.com/users/2211491/fat-monk"}, "edited": false, "score": 0, "creation_date": 1523532145, "post_id": 49784440, "comment_id": 86604685, "body": "The code works fine for me as is. See my revised answer."}, {"owner": {"reputation": 1559, "user_id": 2211491, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/d6pLD.png?s=128&g=1", "display_name": "Fat Monk", "link": "https://stackoverflow.com/users/2211491/fat-monk"}, "edited": false, "score": 0, "creation_date": 1523534044, "post_id": 49784440, "comment_id": 86605929, "body": "I&#39;ll post a new example to my original question with screenshots - I am not getting the same results as you...."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1559, "user_id": 2211491, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/d6pLD.png?s=128&g=1", "display_name": "Fat Monk", "link": "https://stackoverflow.com/users/2211491/fat-monk"}, "edited": false, "score": 0, "creation_date": 1523560977, "post_id": 49784440, "comment_id": 86623387, "body": "Ahhh. I get it now. This is a VBA bug. I&#39;ll update my answer shortly."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1523563395, "last_edit_date": 1523563395, "creation_date": 1523480672, "answer_id": 49784440, "question_id": 49780632, "link": "https://stackoverflow.com/questions/49780632/adding-a-less-than-filter-to-a-pivot-table-in-excel-vba/49784440#49784440", "title": "Adding a Less Than filter to a pivot table in Excel VBA", "body": "<p>You're using .Add but you should be using .Add2 as per that link.</p>\n\n<pre><code>pf.PivotFilters.Add2 Type:=xlCaptionIsLessThan, Value1:=1000\n</code></pre>\n\n<p>(I note that link has the correct syntax at the top, but the incorrect syntax at the bottom).</p>\n\n<p>Normally the easiest way to troubleshoot syntax like this is to fire up the Macro recorder, perform your actions manually, then inspect the code. In this case, that's problematic. For instance, if I start with the PivotTable shown below right:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HIYUU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HIYUU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>...and then clear all filters before setting a Label filter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z5RPD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z5RPD.jpg\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/GTjpi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GTjpi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>...then I get the exact result I want:</p>\n\n<p><a href=\"https://i.stack.imgur.com/m5IKY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m5IKY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>...and I get the following code:</p>\n\n<pre><code>Sub Macro6()\n\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Test\").ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Test\").PivotFilters.Add2 _\n        Type:=xlCaptionIsLessThan, Value1:=\"11\"\nEnd Sub\n</code></pre>\n\n<p>But weirdly when I run that code, I get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Cn9Na.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cn9Na.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Despite the fact that the Macro Recorder spits out code with the 11 in a string i.e. \"11\", you <em>don't</em> want to feed in a string. Why the Macro Recorder would tell you otherwise is beyond me.</p>\n"}, {"tags": [], "owner": {"reputation": 1559, "user_id": 2211491, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/d6pLD.png?s=128&g=1", "display_name": "Fat Monk", "link": "https://stackoverflow.com/users/2211491/fat-monk"}, "is_accepted": true, "score": 0, "last_activity_date": 1523548870, "creation_date": 1523548870, "answer_id": 49801141, "question_id": 49780632, "link": "https://stackoverflow.com/questions/49780632/adding-a-less-than-filter-to-a-pivot-table-in-excel-vba/49801141#49801141", "title": "Adding a Less Than filter to a pivot table in Excel VBA", "body": "<p>Based on @jeffreyweir's answer (which did a string based filter for me), here is a working example of using <code>.Add2</code> with both a string based filter and a numerical filter.</p>\n\n<p>This is my example table and pivot table:\n<a href=\"https://i.stack.imgur.com/GWwXq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GWwXq.png\" alt=\"Example Excel Table\"></a></p>\n\n<p>And this is code I have behind each button:</p>\n\n<pre><code>Sub Button1_Click()\nDim pf As PivotField\n\n    Set pf = ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Numbers\")\n    pf.ClearAllFilters\n    pf.PivotFilters.Add2 Type:=xlCaptionIsLessThan, Value1:=\"11\"\nEnd Sub\n\nSub Button2_Click()\nDim pf As PivotField\n\n    Set pf = ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Numbers\")\n    pf.ClearAllFilters\n    pf.PivotFilters.Add2 Type:=xlCaptionIsLessThan, Value1:=11\n\nEnd Sub\n\nSub Button3_Click()\nDim pf As PivotField\n\n    Set pf = ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Numbers\")\n    pf.ClearAllFilters\nEnd Sub\n</code></pre>\n\n<p>Note that:</p>\n\n<ul>\n<li><code>Button1</code> is the <code>Show &lt; \"11\"</code> button which does a string based filter</li>\n<li><code>Button2</code> is the <code>Show &lt; 11</code> button which does a numeric filter</li>\n<li><code>Button3</code> is the <code>Show All</code> button which removes the filter</li>\n</ul>\n\n<p>When I click the <code>Show &lt; \"11\"</code> button (i.e. Button1) I get the following result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MSU8E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MSU8E.png\" alt=\"After clicking Button1\"></a></p>\n\n<p>When I click the <code>Show &lt; 11</code> button (i.e. Button2) I get the following (desired) result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/icZ5W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/icZ5W.png\" alt=\"After clicking Button3\"></a></p>\n"}], "owner": {"reputation": 1559, "user_id": 2211491, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/d6pLD.png?s=128&g=1", "display_name": "Fat Monk", "link": "https://stackoverflow.com/users/2211491/fat-monk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2548, "favorite_count": 0, "accepted_answer_id": 49801141, "answer_count": 2, "score": 0, "last_activity_date": 1523563395, "creation_date": 1523465670, "last_edit_date": 1531161705, "question_id": 49780632, "link": "https://stackoverflow.com/questions/49780632/adding-a-less-than-filter-to-a-pivot-table-in-excel-vba", "title": "Adding a Less Than filter to a pivot table in Excel VBA", "body": "<p>I'm trying to add a filter to a column in a pivot table whenever a worksheet is activated in Excel.</p>\n\n<p>I have the following so far:</p>\n\n<pre><code>   Dim pvt As PivotTable\n   Dim pvtField As PivotField\n\n   Set pvt = ActiveSheet.PivotTables(\"MyPivotTable\")\n   Set pvtField = pvt.PivotFields(\"MyPivotColumnTopField\")\n\n   'First refresh the table\n   pvt.RefreshTable\n\n   'Clear Out Any Previous Filtering\n   pvtField.ClearAllFilters\n\n   'Add the less than filter\n   pvtField.PivotFilters.Add xlValueIsLessThan, Value1:=\"1000\"\n</code></pre>\n\n<p>But I get an <code>Invalid Procedure call or argument</code> error on the line that is trying to add the filter.</p>\n\n<p>I've also tried:</p>\n\n<pre><code>   pvtField.PivotFilters.Add(xlValueIsLessThan, Value1:=\"1000\")\n</code></pre>\n\n<p>but get a syntax error with that.</p>\n\n<p>I'm looking at the documentation at <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pivotfilters-add-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pivotfilters-add-method-excel</a> but cannot figure it out.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1523466659, "creation_date": 1523466659, "answer_id": 49780906, "question_id": 49780389, "link": "https://stackoverflow.com/questions/49780389/searching-only-completed-items-in-inbox/49780906#49780906", "title": "Searching ONLY &quot;completed&quot; items in inbox", "body": "<p>Use <code>Items.Restrict</code> on FlagStatus = 1 (olFlagComplete).</p>\n\n<pre><code>Set myItems = objFolder.Items.Restrict(\"[FlagStatus] = 1\")\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9588185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1654d44c2f395f69e1d52f01e99fd3d3?s=128&d=identicon&r=PG&f=1", "display_name": "A.Richter", "link": "https://stackoverflow.com/users/9588185/a-richter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592896983, "creation_date": 1523464730, "last_edit_date": 1592896983, "question_id": 49780389, "link": "https://stackoverflow.com/questions/49780389/searching-only-completed-items-in-inbox", "title": "Searching ONLY &quot;completed&quot; items in inbox", "body": "<p>Here is my existing code- I need some help counting ONLY items in the inbox that have been marked as \"completed\"  </p>\n\n<pre><code>Sub HowManyEmails()\n\n    Dim objOutlook As Object, objnSpace As Object, objFolder As MAPIFolder\n    Dim EmailCount As Integer\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objnSpace = objOutlook.GetNamespace(\"MAPI\")\n\n        On Error Resume Next\n        Set objFolder = objnSpace.Folders(\"Investment Central\").Folders(\"Inbox\")\n        If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        MsgBox \"No such folder.\"\n        Exit Sub\n        End If\n\n    EmailCount = objFolder.Items.Count\n\n    MsgBox \"Number of emails in the folder: \" &amp; EmailCount, , \"email count\"\n\n    Dim dateStr As String\n    Dim myItems As Outlook.Items\n    Dim dict As Object\n    Dim msg As String\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    Set myItems = objFolder.Items\n    myItems.SetColumns (\"SentOn\")\n    ' Determine date of each message:\n    For Each myItem In myItems\n        dateStr = GetDate(myItem.SentOn)\n        If Not dict.Exists(dateStr) Then\n            dict(dateStr) = 0\n        End If\n        dict(dateStr) = CLng(dict(dateStr)) + 1\n    Next myItem\n\n    ' Output counts per day:\n    msg = \"\"\n    For Each o In dict.Keys\n        msg = msg &amp; o &amp; \": \" &amp; dict(o) &amp; \" items\" &amp; vbCrLf\n    Next\n    MsgBox msg\n\n    Set objFolder = Nothing\n    Set objnSpace = Nothing\n    Set objOutlook = Nothing\nEnd Sub\n\nFunction GetDate(dt As Date) As String\n    GetDate = Year(dt) &amp; \"-\" &amp; Month(dt)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1523465340, "post_id": 49780386, "comment_id": 86576481, "body": "Is this thread related: <a href=\"https://stackoverflow.com/questions/34960873/application-filedialog-support-in-mac-excel-2011\" title=\"application filedialog support in mac excel 2011\">stackoverflow.com/questions/34960873/&hellip;</a> ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1523467709, "post_id": 49780386, "comment_id": 86577680, "body": "@shrivallabha.redij somehow, not exactly."}], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593644883, "creation_date": 1523464728, "last_edit_date": 1593644883, "question_id": 49780386, "link": "https://stackoverflow.com/questions/49780386/filedialog-late-binding-not-working-on-mac-excel-version-15-19", "title": "FileDialog Late Binding not working on MAC Excel Version 15.19", "body": "<p><strong>Introduction</strong>: I have been using the same code (below) for <code>FileDialog</code> with <strong>Late Binding</strong> for PC and also MAC for a long time.</p>\n\n<p><strong>My Problem</strong>: Some new MACs in my company which have newer Office version for MAC, Version 15.1 and above, get the following:</p>\n\n<blockquote>\n  <p>Run-time error 438: Object doesn't support this property or method</p>\n</blockquote>\n\n<p>At the following line:\n<code>Set fDialog = Application.FileDialog(3)</code> </p>\n\n<p>Any ideas what modification needed to be made to make it work with Office Ver 15.1 for MAC?</p>\n\n<p><strong><em>My Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nFunction OpenXLSFileName(strPath As String, MediaName As String) As String\n\nDim xlsFileName As String\nDim fDialog As Object\n\nSet fDialog = Application.FileDialog(3) ' &lt;-- get the error here (msoFileDialogFilePicker = 3)\n\n' FileDialog properties\nWith fDialog\n    .AllowMultiSelect = False\n    .Title = \"Select data records file for media \" &amp; MediaName\n    .InitialFileName = strPath\n\n    ' Add filters\n    .Filters.Clear\n    .Filters.Add \"Excel files\", \"*.xls;*.xlsx;*.csv\"\n\n    If .Show = -1 Then  ' -1 means success\n        OpenXLSFileName = .SelectedItems(1)\n    Else\n        MsgBox \"No Excel file selected !\", vbExclamation, \"Warning\"\n        OpenXLSFileName = \"\"\n    End If\nEnd With\nSet fDialog = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "edited": false, "score": 0, "creation_date": 1523476290, "post_id": 49781069, "comment_id": 86582122, "body": "when I trigger the macro it bombs out with run time error 9 (subscript out of range) at the &#39;copypasta step"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1523467246, "creation_date": 1523467246, "answer_id": 49781069, "question_id": 49780246, "link": "https://stackoverflow.com/questions/49780246/excel-vba-copy-worksheet-to-existing-sheet-in-unopened-workbook/49781069#49781069", "title": "Excel VBA copy worksheet to existing sheet in unopened workbook", "body": "<p>I believe you will have to open the other workbook, paste, and then close:</p>\n\n<pre><code>Sub Button5_Click()\n\n    'a variable to hold our other workbook\n    Dim otherwb as Workbook\n\n    'open other workbook assign it to variable\n    Set otherwb = Application.Workbooks.Open(\"Missing Data Template (concept1).xlsx\")\n\n    'Copypasta\n    Sheets(\"DataSet\").Cells.Copy Destination:=otherwb.Sheets(\"Report\").Range(\"A1\")\n\n    'save and Close other workbook         \n    otherwb.Close(true)   \n\nEnd Sub\n</code></pre>\n\n<p>You'll notice, too, that I've done away with all the <code>.Select</code> and <code>.Active</code> type code. It's really unnecessary to <code>.Select</code> stuff in VBA since Selecting is something a human does. The code just needs to know what to get and where to put it. Touching with <code>.select</code> or <code>.activate</code> is really only used sometimes at the end to set the cursor/selection at a specific point for the human that is running the code (say if you wanted to insure that once this runs, the Sheets(\"Dataset\").Range(\"A1\") cell was selected.</p>\n"}], "owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3718, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523467246, "creation_date": 1523464205, "last_edit_date": 1531164843, "question_id": 49780246, "link": "https://stackoverflow.com/questions/49780246/excel-vba-copy-worksheet-to-existing-sheet-in-unopened-workbook", "title": "Excel VBA copy worksheet to existing sheet in unopened workbook", "body": "<p>VBA novice here.</p>\n\n<p>I recorded the included code to copy a worksheet from the source workbook and paste it into a sheet of another open workbook.  </p>\n\n<p>It works but what I was attempting to do is; \ntrigger macro\ncopy worksheet\nopen destination workbook\npaste data\nclose origin workbook\nend on destination workbook but different worksheet.</p>\n\n<pre><code>Sub Button5_Click()\n'export data to template\nSheets(\"DataSet\").Select 'sheet that I want to copy and paste (resides in macro workbook)\nCells.Select\nSelection.Copy\nWindows(\"Missing Data Template (concept1).xlsx\").Activate 'destination workbook (no macros)\nSheets(\"Report\").Select 'destination worksheet\nCells.Select\nActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for some education!</p>\n"}, {"tags": ["vba", "excel", "ms-word", "mailmerge"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1523543852, "post_id": 49780214, "comment_id": 86613394, "body": "Note that, technically, your question is &quot;too broad&quot; for the site (see the <a href=\"https://stackoverflow.com/help\">help center</a>). You should have included at least the basic code. But the question intrigued me..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "edited": false, "score": 0, "creation_date": 1523557116, "post_id": 49799349, "comment_id": 86621340, "body": "Cindy, thanks for the help, the code runs without error though I&#39;m not experiencing a merge. Any thoughts?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "edited": false, "score": 0, "creation_date": 1523558411, "post_id": 49799349, "comment_id": 86622075, "body": "Step through the code - does it quit anywhere. Is it possible you haven&#39;t opened a document that&#39;s actively linked to a data source? I only addressed the &quot;can I do anything after the merge&quot; aspect - nothing else."}, {"owner": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "edited": false, "score": 0, "creation_date": 1523561212, "post_id": 49799349, "comment_id": 86623506, "body": "Linked the document and attempted again, no error but also several Messages indicating the process is taking too long. Not sure if this works given the size of my merge."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "edited": false, "score": 0, "creation_date": 1523563770, "post_id": 49799349, "comment_id": 86624931, "body": "Well, @Rick test the mail merge without code and see if that works... Then pare down your data and see if that makes any difference. And this is why your question is &quot;too broad&quot; - there are too many unknowns. You need to concentrate on the specific question you asked - not the entire story."}, {"owner": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "edited": false, "score": 0, "creation_date": 1523631457, "post_id": 49799349, "comment_id": 86654644, "body": "Mail Merge works fine without code.Going to re-post on forums and take the process step-by-step. Thanks, Cindy."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1523543765, "creation_date": 1523543765, "answer_id": 49799349, "question_id": 49780214, "link": "https://stackoverflow.com/questions/49780214/excel-workbook-to-create-word-document-and-auto-run-mail-merge-from-excel-workbo/49799349#49799349", "title": "Excel Workbook to Create Word Document and Auto-Run Mail Merge from Excel Workbook", "body": "<p>It looks like you can have the whole thing run with one macro from Excel, without the user having to run a second one, using a For loop until wdApp.Documents.Count increases by 1. I did test the following, but with only a very small data set, so it ran very quickly.</p>\n\n<p>Since the user might have more than just the main merge document open, it's important the code can identify and work with the resulting document. Usually, it will have become the <code>ActiveDocument</code> but relying on that is never certain. So I built in a couple of loops to 1) hold the currently open documents in an array then 2) compare those to the currently active document. If the currently active document is not in the array, then the fields are <em>unlinked</em> (that's the equivalent of Ctrl+Shift+F9).</p>\n\n<p>Of course, if you really wanted to identify the new document from all the documents you'd need to loop each document and loop the array, making the comparison. But I've given you the starting point...</p>\n\n<pre><code>Sub MergeWithWord()\n    Dim wdApp As Object\n    Dim wdDoc As Object\n    Dim nrDocs As Long\n    Dim i As Long, d As Long\n    Dim aDocs() As Variant\n\n    Set wdApp = GetObject(, \"Word.Application\")\n    nrDocs = wdApp.documents.Count\n\n    'Get all opened documents so can compare whether a new one\n    ReDim Preserve aDocs(nrDocs - 1)\n    Set wdDoc = wdApp.activedocument\n    For i = 0 To nrDocs - 1\n        Set aDocs(i) = wdApp.documents(i + 1)\n    Next\n\n    If wdDoc.MailMerge.MainDocumentType &lt;&gt; -1 Then\n        wdDoc.MailMerge.Destination = 0\n        wdDoc.MailMerge.Execute False\n        Do Until wdApp.documents.Count &gt; nrDocs Or i &gt; 1000\n            i = i + 1\n        Loop\n        Set wdDoc = wdApp.activedocument\n        For d = 0 To UBound(aDocs)\n            If wdDoc Is aDocs(d) Then\n                Debug.Print \"Not a new doc\"\n            Else\n                Debug.Print wdDoc.FullName\n                wdDoc.Fields.Unlink\n                Exit For\n            End If\n        Next\n    End If\n\n    Debug.Print nrDocs, i\n    MsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "is_accepted": true, "score": 0, "last_activity_date": 1525293638, "creation_date": 1525293638, "answer_id": 50143241, "question_id": 49780214, "link": "https://stackoverflow.com/questions/49780214/excel-workbook-to-create-word-document-and-auto-run-mail-merge-from-excel-workbo/50143241#50143241", "title": "Excel Workbook to Create Word Document and Auto-Run Mail Merge from Excel Workbook", "body": "<p>May not be the most elegant code but here was what I wound up using to solve my question in case it helps anyone else. </p>\n\n<pre><code>Sub ButtonMerge()\nDim str1 As String\nDim PlanDocTemplate As String\nDim EDrive As String\nDim answer1 As Integer\nDim answer2 As Integer\n\nanswer1 = MsgBox(\"Is this IC Plan Workbook saved in the appropriate Client folder?\", vbYesNo + vbQuestion)\n\nIf answer1 = vbNo Then\n    MsgBox (\"Please save this IC Plan Workbook in the appropriate Client folder then run again.\")\n    Exit Sub\nElse\n    'do nothing\nEnd If\n\nstr1 = \"Q:\\IC\\New Structure\\IC Toolkit\\Templates\\01 Plan Doc Template\\16 Source\\IC Plan Doc Template v1.0.docx\"\nPlanDocTemplate = Application.ActiveWorkbook.Path &amp; \"\\\" &amp; Range(\"A1\").Value &amp; \".docx\"\nEDrive = \"E:\\\" &amp; Range(\"A1\").Value &amp; \".docx\"\n\nIf Len(Dir(Application.ActiveWorkbook.Path &amp; \"\\\" &amp; Range(\"A1\").Value &amp; \".docx\")) = 0 Then\n    Call FileCopy(str1, PlanDocTemplate)\nElse\n    MsgBox (\"The Plan document already exists, please delete or rename the existing Plan Doc in folder \" _\n    &amp; Application.ActiveWorkbook.Path &amp; \"\\ before creating a new one.\")\n    Exit Sub\nEnd If\n\nstrWorkbookName = ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name\nWorksheets(\"Data\").Activate\n\n'Opens New Plan Doc Template\nSet appWD = CreateObject(\"Word.Application\")\nappWD.Visible = True\n\nappWD.Documents.Open Filename:=PlanDocTemplate\n\nActiveDocument.MailMerge.OpenDataSource Name:=strWorkbookName, _\nFormat:=wdMergeInfoFromExcelDDE, _\nConfirmConversions:=True, _\nReadOnly:=False, _\nLinkToSource:=True, _\nAddToRecentFiles:=False, _\nPasswordDocument:=\"\", _\nPasswordTemplate:=\"\", _\nRevert:=False, _\nConnection:=\"Entire Spreadsheet\", _\nSQLStatement:=\"SELECT * FROM `Data$`\", _\nSQLStatement1:=\"\", _\nSubType:=wdMergeSubTypeOther\n\nappWD.Visible = True\n\nappWD.Selection.WholeStory\nappWD.Selection.Fields.Update\nappWD.Selection.Fields.Unlink\nActiveDocument.MailMerge.MainDocumentType = wdNotAMergeDocument\nappWD.ActiveDocument.Save\n\nWorksheets(\"Form\").Activate\nMsgBox \"Successfully Created \" &amp; Range(\"A1\").Value &amp; \" in Location: \" &amp; Application.ActiveWorkbook.Path &amp; \"\\\"\n\nanswer2 = MsgBox(\"Do you want to save a draft in the E:\\ drive as well?\", vbYesNo + vbQuestion, \"E: Drive Copy\")\n\nIf answer2 = vbYes Then\n    If Dir(\"E:\\\") &lt;&gt; \"\" Then\n        ActiveDocument.SaveAs2 Filename:= _\n        \"E:\\\" &amp; Range(\"A1\").Value &amp; \".docx\", _\n        FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", _\n        AddToRecentFiles:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, _\n        EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _\n        :=False, SaveAsAOCELetter:=False, CompatibilityMode:=14\n        MsgBox (\"Successfully Created \" &amp; Range(\"A1\").Value &amp; \" in E:\\ Location.\")\n        Exit Sub\n    Else\n        MsgBox (\"Please open the E:\\ drive and enter your username/password.\" &amp; _\n        vbCrLf &amp; vbCrLf &amp; \"Click Ok when E:\\ drive is opened.\")\n        If Len(Dir(\"E:\\\")) = 0 Then\n            MsgBox (\"Error connecting to E:\\ drive.\" &amp; vbCrLf &amp; vbCrLf &amp; \"Please ensure you're connected and try again.\")\n            Exit Sub\n        Else\n            ActiveDocument.SaveAs2 Filename:= _\n            \"E:\\\" &amp; Range(\"A1\").Value &amp; \".docx\", _\n            FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", _\n            AddToRecentFiles:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, _\n            EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _\n            :=False, SaveAsAOCELetter:=False, CompatibilityMode:=14\n            MsgBox (\"Successfully Created \" &amp; Range(\"A1\").Value &amp; \" in E:\\ Location.\")\n            Exit Sub\n        End If\n    End If\nElse\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8345614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1611566542188013/picture?type=large", "display_name": "Rick", "link": "https://stackoverflow.com/users/8345614/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2002, "favorite_count": 0, "accepted_answer_id": 50143241, "answer_count": 2, "score": 0, "last_activity_date": 1525293638, "creation_date": 1523464103, "last_edit_date": 1523467684, "question_id": 49780214, "link": "https://stackoverflow.com/questions/49780214/excel-workbook-to-create-word-document-and-auto-run-mail-merge-from-excel-workbo", "title": "Excel Workbook to Create Word Document and Auto-Run Mail Merge from Excel Workbook", "body": "<p>I've got a bit of a tricky one here. Attempting to simplify an existing process.</p>\n\n<p>Existing Process:</p>\n\n<p>Word Document (\"Plan Doc Template\") is entirely composed of INCLUDETEXT fields that pull Bookmarked sections from another Word Document (\"Source Plan Doc\" we'll call it) that includes merge-fields in its bookmarked sections which are from an Excel Workbook (\"Mail Merge Workbook\").</p>\n\n<p>The current process involves the user copying a Plan Doc Template and a Mail Merge Workbook and pasting it into any folder they choose. The user then fills out the Mail Merge Workbook, saves and closes, and runs a Mail Merge through the Plan Doc Template Word Doc. This pulls in bookmarked sections from the Source Plan Doc depending on the Mail Merge Workbook fields selected. The user then removes all INCLUDETEXT fields with CTRL + SHIFT + F9 to turn fields of Plan Doc Template into workable text.</p>\n\n<p>(Hopeful) Future Process:</p>\n\n<ol>\n<li>The user copies a Mail Merge Workbook and pastes it into their\ndesired folder. Fills out the Mail Merge Workbook. (Manual Step)</li>\n<li>Runs VBA Code.</li>\n<li>VBA copies the Plan Doc Template and pastes in the Mail Merge Workbook's folder that just ran the VBA code.</li>\n<li>VBA renames the Plan Doc Template Word Doc based on fields within the Mail Merge Workbook.</li>\n<li>VBA runs a Mail Merge within the Plan Doc Template</li>\n<li>VBA highlights entire document and CTRL + SHIFT + F9 to turn Field Codes into workable text.</li>\n</ol>\n\n<p>Is it possible to do all this from an Excel VBA code or would I need a separate code after the Plan Doc has been created to run the mail merge and do the CTRL + SHIFT + F9 steps? </p>\n\n<p>P.S. I use Excel Worksheets via DDE Selection to get the correct formatting from Mail Merge Workbook to Document. Hoping that can be included in the VBA code, as well.</p>\n\n<p>Help would be greatly appreciated on this one, thanks,</p>\n\n<p>Rich</p>\n"}, {"tags": ["matlab", "excel", "com", "vba"], "comments": [{"owner": {"reputation": 11146, "user_id": 3460361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O31Mu.png?s=128&g=1", "display_name": "Hoki", "link": "https://stackoverflow.com/users/3460361/hoki"}, "edited": false, "score": 0, "creation_date": 1523465459, "post_id": 49780026, "comment_id": 86576534, "body": "You are asking an address from <i>Excel</i>, so it replies with an <b>absolute</b> address, hence the <code>$</code> sign. This behavior seems normal to me, it is not a &quot;relative&quot; address/offset. Now if it is bothering you, you can use a simple inline helper function: define <code>cleanAddress=@(s) strrep(str,&#39;$&#39;,&#39;&#39;)</code> at the top of your code, then you can get your cleaned address directly without the <code>$</code> sign. Try <code>cleanAddress(sht.Range(&#39;B2:C3&#39;).Address)</code>"}, {"owner": {"reputation": 1597, "user_id": 3230708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3ba0a3fe017d7c55f7741bcb315f4824?s=128&d=identicon&r=PG&f=1", "display_name": "user36800", "link": "https://stackoverflow.com/users/3230708/user36800"}, "reply_to_user": {"reputation": 11146, "user_id": 3460361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O31Mu.png?s=128&g=1", "display_name": "Hoki", "link": "https://stackoverflow.com/users/3460361/hoki"}, "edited": false, "score": 0, "creation_date": 1523467376, "post_id": 49780026, "comment_id": 86577507, "body": "I realize I can clean up the output and I thank  you for providing that. I was really hoping to find a way to access VBA-compliant syntax and functionality.  For example, the Immediate Window accepts <code>?ActiveCell.ListObject.DataBodyRange.Address(0,0)</code> and returns an address using local referencing.  From Matlab, I can get ListObject.DataBodyRange.Address, but it doesn&#39;t accept arguments to specify local referencing.  Wondering if such limitations are hard coded into the COM interface, or whether there is a way to have the Excel object evaluate actual VBA expressions without these limitations"}], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 3230708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3ba0a3fe017d7c55f7741bcb315f4824?s=128&d=identicon&r=PG&f=1", "display_name": "user36800", "link": "https://stackoverflow.com/users/3230708/user36800"}, "is_accepted": true, "score": 0, "last_activity_date": 1524356441, "creation_date": 1524356441, "answer_id": 49961357, "question_id": 49780026, "link": "https://stackoverflow.com/questions/49780026/matlab-com-interface-to-excel-get-range-address-without-dollar-signs/49961357#49961357", "title": "Matlab COM interface to Excel: Get range address without dollar signs", "body": "<p>This answer is based on the syntax to <a href=\"http://stackoverflow.com/questions/49782719/cant-access-range-method-of-range-object-com-limitations\">the answer to another question</a></p>\n\n<pre><code>% Open COM interface, create new workbook, access worksheet\n\nexcel = actxserver('Excel.Application');\nexcel.Visible=1;\nwbks = excel.Workbooks;\nwbks.Add\nsht = wbks.Item(1).Sheets.Item(1)\n\n% Syntax for range address using absolute reference\nsht.Range('A3.B4').Address\n\n% Syntax for range address using relative reference\nget( sht.Range('A3.B4'), 'Address', 0, 0 )\n\n% Shut down Excel workbook and COM app object\ntry\n   excel.DisplayAlerts = 0; % Forgo save prompt on Close\nend; try\n   wbk.Close\nend; try\n   excel.Quit % Excel process still present\nend; try\n   delete(excel) % Excel process disappears\nend % try\n</code></pre>\n"}], "owner": {"reputation": 1597, "user_id": 3230708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3ba0a3fe017d7c55f7741bcb315f4824?s=128&d=identicon&r=PG&f=1", "display_name": "user36800", "link": "https://stackoverflow.com/users/3230708/user36800"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 49961357, "answer_count": 1, "score": 0, "last_activity_date": 1524375325, "creation_date": 1523463498, "last_edit_date": 1531164843, "question_id": 49780026, "link": "https://stackoverflow.com/questions/49780026/matlab-com-interface-to-excel-get-range-address-without-dollar-signs", "title": "Matlab COM interface to Excel: Get range address without dollar signs", "body": "<p>In VBA, range.address(0,0) or range,address.(false,false) returns an A1 address without dollar signs ('relative referencing' in Excel VBA parlance).</p>\n\n<p>Experimenting with <code>sht</code> as a worksheet object, I get the following:</p>\n\n<pre><code>K&gt;&gt; sht.Range('B2:C3').Address\n    ans = $B$2:$C$3\nK&gt;&gt; sht.Range('B2:C3').Address(false,false)\n    ans = ''\nK&gt;&gt; sht.Range('B2:C3').Address(0,0)\n    Subscript indices must either be real positive integers or logicals.\nK&gt;&gt; get( sht.Range('B2:C3'), 'Address' )\n    ans = $B$2:$C$3\nK&gt;&gt; get( sht.Range('B2:C3'), 'Address(0,0)' )\n    Error using Interface.Microsoft_Excel_14.0_Object_Library.Range/get\nK&gt;&gt; invoke( sht.Range('B2:C3') , 'Address', 0, 0 )\n    Error using Interface.Microsoft_Excel_14.0_Object_Library.Range/invoke\nK&gt;&gt; invoke( sht.Range('B2:C3') , 'Address', false, false )\n    Error using Interface.Microsoft_Excel_14.0_Object_Library.Range/invoke\nK&gt;&gt; methods( sht.Range('B2:C3') ) % Address is not a method\n    Methods for class Interface.Microsoft_Excel_14.0_Object_Library.Range:\n    Activate                ClearHyperlinks         &lt;...snip...&gt;\n    AddComment              ClearNotes              &lt;...snip...&gt;\n    &lt;...snip...&gt;\nK&gt;&gt; get( sht.Range('B2:C3') )\n            Application: [1x1 Interface.Microsoft_Excel_14.0_Object_Library._Application]\n                Creator: 'xlCreatorCode'\n                 Parent: [1x1 Interface.Microsoft_Excel_14.0_Object_Library._Worksheet]\n              AddIndent: 0\n                Address: '$B$2:$C$3'\n           AddressLocal: '$B$2:$C$3'\n                  Areas: [1x1 Interface.Microsoft_Excel_14.0_Object_Library.Areas]\n\n                    &lt;...snip...&gt;\n</code></pre>\n\n<p>It seems that in VBA, the <code>Address</code> property returns an object with an implied <code>operator()</code>, so it can be given arguments (like <code>false</code> or 0) to specify local referencing.  From the <code>get</code> results, however, the COM interface treats the <code>Address</code> property as a simple property with a single literal string value, which is limiting.</p>\n\n<p>To avoid this limitation, I don't suppose there is a way to evaluate a VBA expression (such as what one might type into the Immediate Window of the VBA Editor) from Matlab?  As can be seen above, <code>invoke</code> doesn't do it.</p>\n\n<p>I can work around this at the tactical level by writing expressions to remove the dollar signs from the address, but I want a general way to access evalation of VBA from within Matlab.  Also writing tactical formatting functions makes for noisier, more voluminous code.</p>\n"}, {"tags": ["excel", "vba", "visible"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1523463011, "post_id": 49779720, "comment_id": 86575111, "body": "The limit of 8192 was fixed with Excel 2010 - are you still using an older version? See <a href=\"https://www.rondebruin.nl/win/s4/win003.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s4/win003.htm</a>"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1523464685, "post_id": 49779720, "comment_id": 86576129, "body": "It is 8192 areas (non-contiguous cells) and not cells so there&#39;s less likelihood of getting error for visible cells. Did you test before posting?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9631473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47ba33b2dcbd92ca71ef29b2d2707603?s=128&d=identicon&r=PG&f=1", "display_name": "Dbm", "link": "https://stackoverflow.com/users/9631473/dbm"}, "edited": false, "score": 0, "creation_date": 1523544220, "post_id": 49780367, "comment_id": 86613672, "body": "Thank you got your code K.Davis. For some reason it is not hiding the duplicate cells though.  An example output in row P after the advanced filter is applied is: 2 2 3 4 5 6 6 7 8 12 20 24 24"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 13, "user_id": 9631473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47ba33b2dcbd92ca71ef29b2d2707603?s=128&d=identicon&r=PG&f=1", "display_name": "Dbm", "link": "https://stackoverflow.com/users/9631473/dbm"}, "edited": false, "score": 0, "creation_date": 1523544458, "post_id": 49780367, "comment_id": 86613823, "body": "You will need to change the <code>1</code> in <code>ThisWorkbook.Worksheets(1)</code> to whatever sheet index you are using, or simply use the sheet name <code>....Worksheets(&quot;Data Sheet&quot;)</code> in between quotation marks."}, {"owner": {"reputation": 13, "user_id": 9631473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47ba33b2dcbd92ca71ef29b2d2707603?s=128&d=identicon&r=PG&f=1", "display_name": "Dbm", "link": "https://stackoverflow.com/users/9631473/dbm"}, "edited": false, "score": 0, "creation_date": 1523544839, "post_id": 49780367, "comment_id": 86614098, "body": "I missed that part the first time round. Thanks! it works now."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 13, "user_id": 9631473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47ba33b2dcbd92ca71ef29b2d2707603?s=128&d=identicon&r=PG&f=1", "display_name": "Dbm", "link": "https://stackoverflow.com/users/9631473/dbm"}, "edited": false, "score": 0, "creation_date": 1523544949, "post_id": 49780367, "comment_id": 86614168, "body": "Great! Glad I could help"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1523464667, "creation_date": 1523464667, "answer_id": 49780367, "question_id": 49779720, "link": "https://stackoverflow.com/questions/49779720/hiding-row-if-cell-equals-next-visible-cell/49780367#49780367", "title": "Hiding row if cell equals next visible cell", "body": "<p>I'd be surprised if this couldn't be optimized just a little bit, but it will work for what you are needing.</p>\n\n<p>You can follow the comments within the code itself to kind of get a sense of what it's doing, but in a nutshell, you are using a <code>For...Next</code> statement to loop through your visible cells. For each visible cell, you will search for the <em>next visible cell</em> and then check to see if that matches. If it does, you add that cell to a special range that tracks all the rows to hide at the end of the code, then hide it.</p>\n\n<pre><code>Sub Test()\n\n    Dim ws As Worksheet, lookupRng As Range, rng As Range, lstRow As Long\n    Set ws = ThisWorkbook.Worksheets(1)\n    lstRow = 15258\n    Set lookupRng = ws.Range(\"P7:P\" &amp; lstRow)\n\n    Dim rngToHide As Range, i As Long\n    For Each rng In lookupRng.SpecialCells(xlCellTypeVisible)\n        Application.StatusBar = \"Checking row \" &amp; rng.Row &amp; \" for matches.\"\n        For i = rng.Row + 1 To lstRow                   'Loop through rows after rng\n            If Not ws.Rows(i).Hidden Then               'Check if row is hidden\n                If rng.Value = ws.Cells(i, \"P\") Then    'check if the non-hidden row matches\n                    If rngToHide Is Nothing Then        'Add to special range to hide cells\n                        Set rngToHide = ws.Cells(i, \"P\")\n                    Else\n                        Set rngToHide = Union(rngToHide, ws.Cells(i, \"P\"))\n                    End If\n                End If\n                Exit For                                'Exit the second For statement\n            End If\n        Next i\n    Next rng\n\n    Application.StatusBar = \"Hiding duplicate rows\"\n    If Not rngToHide Is Nothing Then rngToHide.EntireRow.Hidden = True\n    Application.StatusBar = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9631473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47ba33b2dcbd92ca71ef29b2d2707603?s=128&d=identicon&r=PG&f=1", "display_name": "Dbm", "link": "https://stackoverflow.com/users/9631473/dbm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 49780367, "answer_count": 1, "score": 1, "last_activity_date": 1523467724, "creation_date": 1523462540, "last_edit_date": 1523467724, "question_id": 49779720, "link": "https://stackoverflow.com/questions/49779720/hiding-row-if-cell-equals-next-visible-cell", "title": "Hiding row if cell equals next visible cell", "body": "<p>I am trying to write a macro that hides the row if the cell value equals the next visible cell in that column and loops through the whole column. I have read that SpecialCells(xlCellTypeVisible) only works up to 8192 cells and my spreadsheet has 15,000 rows.</p>\n\n<p>I have tried something like this but want to restrict it to only visible cells</p>\n\n<pre><code>Sub Test()\nFor i = 7 To 15258\n    If Range(\"P\" &amp; i).Value = Range(\"P\" &amp; i + 1).Value Then\n        Rows(i).Hidden = True\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>I have tried to search for a solution but haven't been able to find one yet.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "outlook", "vba"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1523466992, "creation_date": 1523466992, "answer_id": 49780998, "question_id": 49779700, "link": "https://stackoverflow.com/questions/49779700/how-to-open-a-msg-file-and-edit-the-receiver-with-excel-vba/49780998#49780998", "title": "How to open a msg file and edit the receiver with Excel VBA?", "body": "<p>Use <code>Application.CreateItemFromTemplate</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "is_accepted": true, "score": 0, "last_activity_date": 1523890286, "last_edit_date": 1523890286, "creation_date": 1523471144, "answer_id": 49782087, "question_id": 49779700, "link": "https://stackoverflow.com/questions/49779700/how-to-open-a-msg-file-and-edit-the-receiver-with-excel-vba/49782087#49782087", "title": "How to open a msg file and edit the receiver with Excel VBA?", "body": "<p>I found the solution</p>\n\n<pre><code>'Send msg\n\nDim path As String\nDim msgFile As String\n\npath = Application.ActiveWorkbook.path + \"\\\"\n\nfile = path &amp; \"test.msg\"\n\nDim OutApp As Outlook.Application\nDim OutMail As Outlook.mailitem\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItemFromTemplate(file)\nOn Error Resume Next\nWith OutMail\n    .To = Application.User\n\n    .Send\nEnd With\nOn Error GoTo 0\nSet OutMail = Nothing\nSet OutApp = Nothing\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1025, "favorite_count": 2, "closed_date": 1523473262, "accepted_answer_id": 49782087, "answer_count": 2, "score": 0, "last_activity_date": 1523892605, "creation_date": 1523462475, "last_edit_date": 1531164843, "question_id": 49779700, "link": "https://stackoverflow.com/questions/49779700/how-to-open-a-msg-file-and-edit-the-receiver-with-excel-vba", "closed_reason": "Needs details or clarity", "title": "How to open a msg file and edit the receiver with Excel VBA?", "body": "<p>How to open an Outlook mailitem saved as a .msg file, to edit and send it with Excel VBA? </p>\n\n<p>I know there is a lot of code missing but I have tried a lot of open methods without success.</p>\n\n<p>I must use the .msg file.</p>\n\n<pre><code>Private Sub CommandButton22_Click()\n\n    'Send msg\n\n    Dim path As String\n    Dim msgFile As String\n\n    path = Application.ActiveWorkbook.path + \"\\\"\n\n    file = path &amp; \"test.msg\"\n\n    'here I want to edit the receiver(To) of the msg File then send it\n    'but I don't know how\n\n    Dim outApp As Object\n    Dim OutMail As Object\n    Set outApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = outApp.CreateItem(0)\n\n    With OutMail\n        .To = \"someone@whatever.com\"\n        .Send\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523463109, "post_id": 49779566, "comment_id": 86575169, "body": "Have you tried anything? Here is my first thought - read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"tags": [], "owner": {"reputation": 626, "user_id": 7350537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8cff16636c6f272e0cdac18767886?s=128&d=identicon&r=PG&f=1", "display_name": "LFB", "link": "https://stackoverflow.com/users/7350537/lfb"}, "is_accepted": false, "score": 1, "last_activity_date": 1523497699, "creation_date": 1523497699, "answer_id": 49786754, "question_id": 49779566, "link": "https://stackoverflow.com/questions/49779566/find-empty-rows/49786754#49786754", "title": "Find empty rows", "body": "<p>You pretty much answered your own question.</p>\n\n<p><code>ActiveCell.MergedArea</code> gives you the merged range and\n<code>ActiveCell.MergedCells</code> returns True if the cell belongs to a merged range. You could work a solution from there.</p>\n\n<p>The cell below a merge range would be:</p>\n\n<pre><code>ActiveCell.MergedArea.Offset(1)\n</code></pre>\n\n<p>I'm assuming you are working by selecting the ranges. For future reference, posting your codes and your previous approaches is helpful to people reading your questions</p>\n"}], "owner": {"reputation": 11, "user_id": 7541995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/088ca7f8afe3413f34e11a2648cc8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Dummy_Student", "link": "https://stackoverflow.com/users/7541995/dummy-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523497699, "creation_date": 1523462112, "last_edit_date": 1531164843, "question_id": 49779566, "link": "https://stackoverflow.com/questions/49779566/find-empty-rows", "title": "Find empty rows", "body": "<p>I'm looking to scan a document, find where there is empty rows so I can add a page break when necessary.</p>\n\n<p>For i = 1 to End of the document\nI look at the value of the cells(i) and get if it is empty. The problem is with merged cells.\nLet's say the range 1 to 5 is merged, and full of text. The code will tell me cells(1) is not empty but cells (2) and further are empty.</p>\n\n<p>I believe the way to solve this would be to get if the cell is merged, get the end of the merge, and get i to be equal to it so it doesn't scan those row.</p>\n\n<p>Any thought on the subject ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1523461834, "post_id": 49779413, "comment_id": 86574319, "body": "This code requires that you have added a reference to the Outlook Object Library, have you done so?"}, {"owner": {"reputation": 9, "user_id": 9631536, "user_type": "registered", "profile_image": "https://graph.facebook.com/1723614131007377/picture?type=large", "display_name": "Leonardo Ven&#226;ncio", "link": "https://stackoverflow.com/users/9631536/leonardo-ven%c3%a2ncio"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1523462305, "post_id": 49779413, "comment_id": 86574636, "body": "How would I do that?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 3, "creation_date": 1523462424, "post_id": 49779413, "comment_id": 86574750, "body": "In the VBA editor click tools, references and make sure <i>Microsoft Outlook XXX Object Library</i> is ticked."}, {"owner": {"reputation": 9, "user_id": 9631536, "user_type": "registered", "profile_image": "https://graph.facebook.com/1723614131007377/picture?type=large", "display_name": "Leonardo Ven&#226;ncio", "link": "https://stackoverflow.com/users/9631536/leonardo-ven%c3%a2ncio"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1523553032, "post_id": 49779413, "comment_id": 86619279, "body": "Great Alex! It&#39;s working fine now. Really appreciate your help!"}], "owner": {"reputation": 9, "user_id": 9631536, "user_type": "registered", "profile_image": "https://graph.facebook.com/1723614131007377/picture?type=large", "display_name": "Leonardo Ven&#226;ncio", "link": "https://stackoverflow.com/users/9631536/leonardo-ven%c3%a2ncio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523461707, "creation_date": 1523461707, "question_id": 49779413, "link": "https://stackoverflow.com/questions/49779413/user-defined-type-not-defined-error-message-vba-code-to-extract-email", "title": "User-defined type not defined error message - VBA code to extract email", "body": "<p>I'm currently working on a VBA code that I've found here. Unfortunately I'm stuck on the famous \"user-defined not defined error message\"</p>\n\n<pre><code>Function ListFolders(MyFolder As Outlook.MAPIFolder, Level As Integer, Output As Range) As Range\n</code></pre>\n\n<p>I'm stuck on the live above by the \"user-defined not defined error message\", I've tried to work on the most commom mistakes, but everything seems to be ok.\nFind below the complete function.</p>\n\n<pre><code>    Dim olFolder As Outlook.MAPIFolder\n\n    Dim olItem As Outlook.MailItem\n\n    Dim lngCol As Long\n\n\n\n    For Each olFolder In MyFolder.Folders\n\n        lngCol = ((Level - 1) * 8) + 1\n\n        Output.Offset(0, lngCol) = olFolder.Name\n\n        Set Output = Output.Offset(1)\nIf olFolder.DefaultItemType = olMailItem Then\n\n            For Each olItem In olFolder.Items\n\n                If olItem.Class = olMail Then\n\n                    With Output\n\n                        .Offset(0, lngCol + 1) = olItem.SenderName ' Sender\n\n                        .Offset(0, lngCol + 2) = olItem.Subject ' Subject\n\n                        .Offset(0, lngCol + 3) = olItem.ReceivedTime ' Received\n\n                        .Offset(0, lngCol + 4) = olItem.ReceivedByName ' Recepient\n\n                        .Offset(0, lngCol + 5) = olItem.UnRead ' Unread?\n\n                        .Offset(0, lngCol + 6) = olItem.ReplyRecipientNames '\n\n                        .Offset(0, lngCol + 7) = olItem.SentOn\n\n\n\n                    End With\n\n                    Set Output = Output.Offset(1)\n\n                End If\n\n            Next\n\n        End If\n\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["macos", "excel", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1523461716, "post_id": 49779322, "comment_id": 86574233, "body": "Office running on macos has no idea what a DLL is, they are Windows specific."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1523461845, "post_id": 49779322, "comment_id": 86574324, "body": "I&#39;m voting to close this question as off-topic because it is not the programming problem. OP needs to learn how to use use his OS"}], "answers": [{"tags": [], "owner": {"reputation": 3353, "user_id": 298209, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/22dcc7ab1b47c2f014361452b5453544?s=128&d=identicon&r=PG&f=1", "display_name": "Milad", "link": "https://stackoverflow.com/users/298209/milad"}, "is_accepted": false, "score": 0, "last_activity_date": 1523461883, "creation_date": 1523461883, "answer_id": 49779479, "question_id": 49779322, "link": "https://stackoverflow.com/questions/49779322/path-of-a-file-in-macintosh/49779479#49779479", "title": "Path of a file in Macintosh", "body": "<ol>\n<li>Right click on the file in Finder</li>\n<li>If you then hold the option button on your keyboard the <code>Copy {filename}</code> option in the context menu turns into <code>Copy {filename} as Pathname</code></li>\n<li>Click on that while still holding the option key and the path of the file is in your clipboard</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 9631354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0097c330046be74c8df2f984d2a7479?s=128&d=identicon&r=PG&f=1", "display_name": "Silvia B.", "link": "https://stackoverflow.com/users/9631354/silvia-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523461883, "creation_date": 1523461449, "last_edit_date": 1531161705, "question_id": 49779322, "link": "https://stackoverflow.com/questions/49779322/path-of-a-file-in-macintosh", "title": "Path of a file in Macintosh", "body": "<p>I'm programming on Excel-Visual Basic with a Mac, I need to charge a dll but I don't know how to specify the total path of the file, and I don't know how to find it.\nFor example: on Windows it works by using \"C:/ ...\" and separating the following documents by /.</p>\n"}, {"tags": ["excel", "vba", "search", "extraction"], "comments": [{"owner": {"reputation": 3, "user_id": 9631427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/9631427/dan"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523487576, "post_id": 49779249, "comment_id": 86586566, "body": "Ah! Apologies, I thought that the site wasn&#39;t letting me upload a screenshot of my excel file, hence the (admittedly rather rubbish) attempt at replicating by - and x&#39;s above."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9631427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/9631427/dan"}, "edited": false, "score": 0, "creation_date": 1523464205, "post_id": 49779611, "comment_id": 86575845, "body": "Mate, thank you so much for responding so fast. I am extremely new to VBA (as in, just today). I follow the majority of the logic however when I try to run this I do not receive the desired output. Clearly I have missed something. Thank you once again"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 3, "user_id": 9631427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/9631427/dan"}, "edited": false, "score": 0, "creation_date": 1523467327, "post_id": 49779611, "comment_id": 86577474, "body": "@Dan What&#39;s showing up in the immediate window? Are you using the same data as the example above? If you have more data you need to modify the amount of rows/columns that it scans over, the numbers above are based on the <i>static</i> example that you gave."}, {"owner": {"reputation": 3, "user_id": 9631427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/9631427/dan"}, "edited": false, "score": 0, "creation_date": 1523487740, "post_id": 49779611, "comment_id": 86586605, "body": "Ah, I can now see what is happening. Thank you very much once again mate, massively appreciated. Again, clearly, I am a total novice with all this. How would you alter the script to make it output to a cell or MsgBox?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 3, "user_id": 9631427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/9631427/dan"}, "edited": false, "score": 0, "creation_date": 1523534911, "post_id": 49779611, "comment_id": 86606516, "body": "@Dan I&#39;ve updated it to print the lines to cells on Sheet2, change as you see fit."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1523534881, "last_edit_date": 1523534881, "creation_date": 1523462262, "answer_id": 49779611, "question_id": 49779249, "link": "https://stackoverflow.com/questions/49779249/obtaining-first-and-last-row-headers-for-multiple-instances-of-consecutive-data/49779611#49779611", "title": "Obtaining first and last row headers for multiple instances of consecutive data in a list- Excel", "body": "<p>Sample data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sLRgO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sLRgO.png\" alt=\"image1\"></a></p>\n\n<p>Macro:</p>\n\n<pre><code>Sub Test()\n\nDim i As Long, j As Long, k As Long\nDim mystring As String\n\nFor j = 2 To 4 'columns\n    For i = 2 To 13 'rows\n        If Cells(i, j).Value = \"x\" Then\n            For k = i + 1 To 13 + 1\n                If Not Cells(k, j).Value = \"x\" Then\n                    If mystring = \"\" Then\n                        mystring = Cells(1, j).Value &amp; \" \" &amp; i - 1 &amp; \" to \" &amp; k - 2\n                        i = k - 1\n                        Exit For\n                    Else\n                        mystring = mystring &amp; \" &amp; \" &amp; Cells(1, j).Value &amp; \" \" &amp; i - 1 &amp; \" to \" &amp; k - 2\n                        i = k - 1\n                        Exit For\n                    End If\n                End If\n            Next k\n        End If\n    Next i\n    Worksheets(\"Sheet2\").Range(\"A\" &amp; j - 1).Value = mystring\n    mystring = \"\"\nNext j\n\nEnd Sub\n</code></pre>\n\n<p>Immediate window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zWopP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zWopP.png\" alt=\"IMW\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9631427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/9631427/dan"}, "edited": false, "score": 0, "creation_date": 1523487793, "post_id": 49784046, "comment_id": 86586619, "body": "Mate, thank you for taking the time to reply to this. Much appreciated."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 3, "user_id": 9631427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/9631427/dan"}, "edited": false, "score": 0, "creation_date": 1523487930, "post_id": 49784046, "comment_id": 86586655, "body": "You are welcome. If my answer solved your question then you may consider marking it as accepted. thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1523478772, "creation_date": 1523478772, "answer_id": 49784046, "question_id": 49779249, "link": "https://stackoverflow.com/questions/49779249/obtaining-first-and-last-row-headers-for-multiple-instances-of-consecutive-data/49784046#49784046", "title": "Obtaining first and last row headers for multiple instances of consecutive data in a list- Excel", "body": "<p>you could use this <code>Function()</code>:</p>\n\n<pre><code>Function ExtractFirstAndLast(colIndex As Long)\n    Dim area As Range\n\n    With Range(Cells(1, colIndex), Cells(Rows.Count, colIndex).End(xlUp))\n        .AutoFilter field:=1, Criteria1:=\"&lt;&gt;\"\n        If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then\n            ExtractFirstAndLast = .Cells(1, 1) &amp; \":\"\n            For Each area In .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Areas\n                ExtractFirstAndLast = ExtractFirstAndLast &amp; \" \" &amp; Cells(area.Rows(1).row, 1) &amp; \" to \" &amp; Cells(area.Rows(area.Rows.Count).row, 1) &amp; \" &amp;\"\n            Next\n            ExtractFirstAndLast = Left(ExtractFirstAndLast, Len(ExtractFirstAndLast) - 2)\n        End If\n        .AutoFilter\n    End With\n    ActiveSheet.AutoFilterMode = False\nEnd Function\n</code></pre>\n\n<p>to be called by your \"main\" Sub as:</p>\n\n<pre><code>Sub main()\n    MsgBox ExtractFirstAndLast(4) ' this would return \"Harry: 7 to 9\"\n    MsgBox ExtractFirstAndLast(2) ' this would return \"Tom: 1 to 3 &amp; 7 to 9\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9631427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/9631427/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 49779611, "answer_count": 2, "score": 0, "last_activity_date": 1523534881, "creation_date": 1523461214, "last_edit_date": 1523463318, "question_id": 49779249, "link": "https://stackoverflow.com/questions/49779249/obtaining-first-and-last-row-headers-for-multiple-instances-of-consecutive-data", "title": "Obtaining first and last row headers for multiple instances of consecutive data in a list- Excel", "body": "<p>I have a year calendar in Excel along the lines of the following:</p>\n\n<p>-- Tom -- Dick -- Harry</p>\n\n<p>1 -- x ----------------- </p>\n\n<p>2 -- x -----------------</p>\n\n<p>3 -- x -----------------</p>\n\n<p>4 --------x-----------</p>\n\n<p>5 --------x-----------</p>\n\n<p>6 --------x-----------</p>\n\n<p>7 x------------------x</p>\n\n<p>8 x------------------x</p>\n\n<p>9 x------------------x</p>\n\n<p>My data consists of blank cells followed by groups of continuous entries.</p>\n\n<p>I would like to extract and show the first and last dates associated with each grouping of entries. So ideally the output of the function would read:</p>\n\n<ol>\n<li>Tom:  1 to 3 &amp; 7 to 9</li>\n<li>Dick:  5 to 8</li>\n<li>Harry:  9 to 12</li>\n</ol>\n\n<p>or something to that effect!</p>\n\n<p>Solutions involving VBA or native excel functions would be very much appreciated.</p>\n\n<p>Thank-you all for your time!</p>\n"}, {"tags": ["database", "vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523460246, "post_id": 49778734, "comment_id": 86573182, "body": "If you just try <code>If Name_pass = &quot;&quot; Then</code> and leave some fields blank, do you get the <code>-</code>?"}, {"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523464898, "post_id": 49778734, "comment_id": 86576241, "body": "@dwirony I have tried but it doesnot affect the result. I am still getting the same error"}], "answers": [{"comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1523464962, "post_id": 49779274, "comment_id": 86576279, "body": "in database there is either a name is present or its blank, and if any value is present than there is always a &#39;,&#39; in between."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1523461266, "creation_date": 1523461266, "answer_id": 49779274, "question_id": 49778734, "link": "https://stackoverflow.com/questions/49778734/calculating-null-or-empty-value-in-access-report-returns-type-error/49779274#49779274", "title": "calculating null or empty value in Access report returns #Type! error", "body": "<p>If not comma is present, <em>UBound</em> of of <code>Name_split</code> is <code>0</code> and <code>Name_split(1)</code> will fail.</p>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1523474997, "post_id": 49782693, "comment_id": 86581420, "body": "I know that i am not handling the string which doesn&#39;t contain &quot;,&quot;, But this is not my problem. I have also tried to debug the code in vba and I have found that if the value of the field is empty than it never call the function. Access skip those values and goes to next value. I have also tried your solution but still no success."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1523473471, "creation_date": 1523473471, "answer_id": 49782693, "question_id": 49778734, "link": "https://stackoverflow.com/questions/49778734/calculating-null-or-empty-value-in-access-report-returns-type-error/49782693#49782693", "title": "calculating null or empty value in Access report returns #Type! error", "body": "<p>As Gustav points out you are only checking for an empty string, but not for one that has no comma. You need something like this:</p>\n\n<pre><code>If Nz(Name_pass) LIKE \"*,*\" Then\n  Dim Name_split() As String    \n  Name_split = split(Name_pass, \",\")    \n  Name_split(0) = Left$(Name_split(0), 1)    \n  name_change = Name_split(1) &amp; \".\" &amp; Name_split(0)    \nElseif Trim(Nz(Name_pass)) = \"\" then\n  name_change = \"-\"\nElse\n  [Deal with names that have content but not comma] \nEnd if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1523475571, "creation_date": 1523475571, "answer_id": 49783221, "question_id": 49778734, "link": "https://stackoverflow.com/questions/49778734/calculating-null-or-empty-value-in-access-report-returns-type-error/49783221#49783221", "title": "calculating null or empty value in Access report returns #Type! error", "body": "<p>Finally I find the answer. </p>\n\n<p>In control source before passing the value to function we have to check the value is Null or not with NZ function. </p>\n\n<p>=name_change(Nz([Name],\"-\"))</p>\n\n<p>Thanks guys for your input.</p>\n"}], "owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 49783221, "answer_count": 3, "score": 0, "last_activity_date": 1523475571, "creation_date": 1523459590, "question_id": 49778734, "link": "https://stackoverflow.com/questions/49778734/calculating-null-or-empty-value-in-access-report-returns-type-error", "title": "calculating null or empty value in Access report returns #Type! error", "body": "<p>i have database which has Column 'Name' of the employee with \"Surname, Name\" like ' Gambel, Peter'.</p>\n\n<p>I want to replace this name in report like ' Peter. G'. I have created a Vba function which converts the Name like as shown above, but if the field value is empty than it always return me  '#Type!'. I have tried a lot but still i am unable to resolve this error.</p>\n\n<pre><code>Public Function name_change(Name_pass As String) As String\n\nIf (IsNull(Name_pass) Or Name_pass = \"\") Then\n\nname_change = \"-\"\n\nElse\n\nDim Name_split() As String\n\nName_split = split(Name_pass, \",\")\n\nName_split(0) = Left$(Name_split(0), 1)\n\nname_change = Name_split(1) &amp; \".\" &amp; Name_split(0)\n\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 5, "creation_date": 1523459020, "post_id": 49778461, "comment_id": 86572252, "body": "How and where are <code>unkItems</code> defined?"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1523459389, "post_id": 49778461, "comment_id": 86572529, "body": "Assuming <code>unkItems</code> is an array have you tried iterating through it and using the <code>.add</code> method of <code>dcValues</code>?"}, {"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "edited": false, "score": 0, "creation_date": 1523459519, "post_id": 49778461, "comment_id": 86572638, "body": "UnkItems is defined as a dictionary in a module. Is it a problem that it&#39;s defined outside of the userform?"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 5, "creation_date": 1523459655, "post_id": 49778461, "comment_id": 86572743, "body": "It depends how it is defined in that module. If it is defined as Dim within the sub then it is limited to that sub, if it is defined as Dim at the top of the module it is limited to that module, and if it is defined as Public at the top of the module it is globally accessible."}, {"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "edited": false, "score": 2, "creation_date": 1523460240, "post_id": 49778461, "comment_id": 86573175, "body": "Wow, that was so simple. It works now. Thank you!"}], "owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523458822, "creation_date": 1523458822, "last_edit_date": 1531164843, "question_id": 49778461, "link": "https://stackoverflow.com/questions/49778461/populate-dictionary-keys-as-listbox-values", "title": "Populate Dictionary Keys as Listbox Values", "body": "<p>I'm trying to use dictionary values in a listbox. Based on answers to other questions on this site, I've been trying to use the following code (with no luck). It seems pretty straightforward, but it throws an error at lines 5 and 6:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim dcValues As Scripting.Dictionary\n    Me.listItems.Clear\n\n    Set dcValues = unkItems 'Throws error\n    Me.listItems.List = dcValues.Keys 'Throws error\n    Me.listItems.AddItem \"Back\"\n\nEnd Sub\n</code></pre>\n\n<p>A background on what I'm doing...I'm looping through a column of a sheet and storing all of the unique values. I wish to display these values in a listbox and, for checked values, send them to a sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523461395, "post_id": 49778413, "comment_id": 86574016, "body": "I&#39;ve read through this question several times and I still cannot tell <i>what</i> your exact issue is. Can you please try to explain once more?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523462646, "post_id": 49778413, "comment_id": 86574880, "body": "@dwirony thank you for your answer , In the Image there is one value <code>P20845 column A with the name of Gaith in front of it  </code> what I want  is when  I&#39;m running my code and found duplicated values it take both the result in front of the first data and the second one like this <code>column B the value P20845 is repeated twice one with name of ghaith and one with the name of sirine  </code> so is there any way to get in column A <code>in front of P20845 something like this Ghiath&#47;sirine </code> <b>see image</b>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1523465934, "post_id": 49780069, "comment_id": 86576772, "body": "@diwrony , thank you Is it possible to modify sheets for example the column A in Sheet1 and the column F in Sheet2 ???"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523467109, "post_id": 49780069, "comment_id": 86577359, "body": "@POLOSTutorials Updated"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1523485365, "post_id": 49780069, "comment_id": 86585921, "body": "I tested your code but something wrong it is copying what is located in sheet1  because previosly  before you update your answer it worked and  what is missing is just changing between sheet <code>ColumnA</code> in sheet1 and <code>ColumnF</code> in sheet 2 if you want can I share my file with you ?"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1523467098, "last_edit_date": 1523467098, "creation_date": 1523463642, "answer_id": 49780069, "question_id": 49778413, "link": "https://stackoverflow.com/questions/49778413/conflicting-data-duplicated-values/49780069#49780069", "title": "Conflicting DATA - Duplicated values", "body": "<p>Maybe something like this instead?</p>\n\n<pre><code>Sub Test()\n\nDim i As Long, myrow As Long, lastrow As Long\nDim sht1 As Worksheet, sht2 As Worksheet\n\nSet sht1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet sht2 = ThisWorkbook.Worksheets(\"Sheet2\")\n\nlastrow = 1\n\nFor i = 1 To 7\n    If Application.WorksheetFunction.CountIf(sht1.Range(\"A:A\"), sht2.Range(\"F\" &amp; i).Value) = 0 Then\n        If i = 1 Then\n            lastrow = 1\n        Else\n            lastrow = sht1.Cells(sht1.Rows.Count, \"A\").End(xlUp).Row + 1\n        End If\n\n        sht1.Range(\"A\" &amp; lastrow).Value = sht2.Range(\"F\" &amp; i).Value\n        sht1.Range(\"B\" &amp; lastrow).Value = sht2.Range(\"G\" &amp; i).Value\n    Else\n        sht1.Range(\"B\" &amp; sht1.Columns(\"A:A\").Find(What:=sht2.Range(\"F\" &amp; i).Value).Row).Value = sht1.Range(\"B\" &amp; sht1.Columns(\"A:A\").Find(What:=sht2.Range(\"F\" &amp; i).Value).Row).Value &amp; \"/\" &amp; sht2.Range(\"G\" &amp; i).Value\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MmkJ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MmkJ8.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1523484280, "post_id": 49781780, "comment_id": 86585568, "body": "thank you for your answer I&#39;m testing your code but I&#39;m facing an issue in running it ,  it keeps looping without stop ... can I share my file with you some how ? tank you so much"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523508475, "post_id": 49781780, "comment_id": 86591370, "body": "So sheet2 in my code would be your left image.  You could replace Intersect(.Columns(&quot;F&quot;), .UsedRange) with .Range(&quot;F1:F7&quot;)   and Sheet1 is your left image and you can replace  Intersect(.Columns(&quot;A&quot;), .UsedRange)  with .Range(&quot;A1:A6.&quot;). I have edited in where you would put these replacements. Let me know."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1523527461, "post_id": 49781780, "comment_id": 86601618, "body": "please last question can I modify this to do <code>foundCell.Offset(, 2)</code> in the column C ???"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523527788, "post_id": 49781780, "comment_id": 86601859, "body": "What are you trying to do?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1523528155, "post_id": 49781780, "comment_id": 86602092, "body": "sorry, I tried to make another column like this <a href=\"https://imgur.com/Crhavyx\" rel=\"nofollow noreferrer\">imgur.com/Crhavyx</a> <code>Feuil1</code> and what I want is to get also those data in <code>Feuil2</code> but in another column :) :-)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523528533, "post_id": 49781780, "comment_id": 86602352, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/168810/discussion-between-qharr-and-polos-tutorials\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1523518769, "last_edit_date": 1523518769, "creation_date": 1523469951, "answer_id": 49781780, "question_id": 49778413, "link": "https://stackoverflow.com/questions/49778413/conflicting-data-duplicated-values/49781780#49781780", "title": "Conflicting DATA - Duplicated values", "body": "<p>Or use a dictionary</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddValues()\n    Application.ScreenUpdating = False\n    Dim wb As Workbook, wsSource As Worksheet, wsTarget As Worksheet, masterDict As Object, arr() As Variant, i As Long, rng As Range\n    Set wb = ThisWorkbook\n    Set wsSource = wb.Worksheets(\"Feuil1\")\n    Set wsTarget = wb.Worksheets(\"Feuil2\")\n    Set masterDict = CreateObject(\"Scripting.Dictionary\")\n\n    With wsSource\n        arr = Intersect(.Columns(\"A:B\"), .UsedRange)\n        For i = 1 To UBound(arr, 1)\n            If Not masterDict.exists(arr(i, 1)) Then masterDict.Add arr(i, 1), GetAllMatches(arr(i, 1), arr(i, 2), wsSource)\n        Next i\n    End With\n\n    With wsTarget\n        For Each rng In Intersect(.Columns(\"A\"), .UsedRange)\n            On Error Resume Next\n            rng.Offset(, 1) = masterDict(rng.Value)\n            On Error GoTo 0\n        Next rng       \n    End With\n    Application.ScreenUpdating = True\nEnd Sub\nPublic Function GetAllMatches(ByVal findString As String, ByVal dupString As String, ByVal searchRng As Worksheet) As String\n\n    Dim foundCell As Range\n    Dim concatenatedString As String\n    concatenatedString = vbNullString\n\n    With Intersect(searchRng.Columns(1), searchRng.UsedRange)\n\n        Set foundCell = .Find(findString)\n        If foundCell Is Nothing Then Exit Function\n        If Not foundCell Is Nothing Then concatenatedString = foundCell.Offset(, 1)\n\n        Dim currMatch As Long\n        currMatch = 0\n\n        For currMatch = 1 To WorksheetFunction.CountIf(.Cells, findString)\n\n            Set foundCell = .Find(What:=findString, After:=foundCell, _\n                                  LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n                                  SearchDirection:=xlNext, MatchCase:=False)\n\n            If Not foundCell Is Nothing And InStr(1, dupString, concatenatedString) = 0 Then\n                concatenatedString = concatenatedString &amp; \"/\" &amp; foundCell.Offset(, 1)\n            Else\n                concatenatedString = foundCell.Offset(, 1)\n            End If\n        Next currMatch\n    End With\n    GetAllMatches = concatenatedString\nEnd Function\n</code></pre>\n\n<p><strong>Output in Feuil2</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/FSD9z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FSD9z.png\" alt=\"Output\"></a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 49781780, "answer_count": 2, "score": 2, "last_activity_date": 1523518769, "creation_date": 1523458659, "last_edit_date": 1523467758, "question_id": 49778413, "link": "https://stackoverflow.com/questions/49778413/conflicting-data-duplicated-values", "title": "Conflicting DATA - Duplicated values", "body": "<p>I created a macro that fills the missing Data with specific Data from another sheet , the codes works perfectly in copying pasting data from excel of the client and prepare the data needed to start the work but the only problem here below </p>\n\n<p>Code:</p>\n\n<pre><code>   With Worksheets(\"Feuil2\") \n   ' reference \"target\" sheet (change \"Target\" to our actual target sheet name)\n     With .Range(\"B1:B\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row) 'reference \n         its column B range from row 1 down to last not empty one\n        If WorksheetFunction.CountBlank(.Cells) &gt; 0 Then \n ' if any blank cell in referenced range. this check to avoid error thrown by subsequent \n    statament\n            .SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=index(GDC!\" &amp; rng.Offset(, 1).Address(, , xlR1C1) &amp; \",match(RC[-1],GDC!\" &amp; rng.Address(, , xlR1C1) &amp; \",0))\" 'fill blank cells with a lookup (well, sort of) formula\n            .Value = .Value 'get rid of formulas and leave values only\n            Cells.Select\n        End If\n    End With\nEnd With\n</code></pre>\n\n<p>This code works perfectly in matching and filling data but when for e.g find a duplicated value it copy only the first value not the second one</p>\n\n<p>See the image below to better understand the main problem :</p>\n\n<p><a href=\"https://i.stack.imgur.com/qgPYw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qgPYw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see in the image The problem that in column A i may have data repeated twice like this value P20845 which in column F it is repeated  one with the name of Ghaith and the other with the name of sirine but as you can see in the column A it is just with the name also of Ghaith and there is no name of sirine\nAnyidea or better solution in solving this and getting all the needed DATA? . </p>\n\n<p>Best Regards</p>\n\n<p>POLOS</p>\n"}, {"tags": ["database", "vba", "function", "sap", "saprfc"], "answers": [{"tags": [], "owner": {"reputation": 13802, "user_id": 7381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69906b2a2405a4d5bad648ea05ae9405?s=128&d=identicon&r=PG", "display_name": "Lanzelot", "link": "https://stackoverflow.com/users/7381/lanzelot"}, "is_accepted": false, "score": 0, "last_activity_date": 1536235562, "creation_date": 1536235562, "answer_id": 52203741, "question_id": 49778250, "link": "https://stackoverflow.com/questions/49778250/rfc-multiple-tables-with-vba-without-losing-connections/52203741#52203741", "title": "RFC Multiple tables with vba without losing connections", "body": "<p>Are you sure the problem is that you lose the connection between the first and the second call? In that case I would expect an error message like \"Connection broken\", when trying to make the seconc call. But according to your descriptin there is no error message. Instead the second call is \"successfull\", but just doesn't return any data, is that right?</p>\n\n<p>Perhaps you need to create a fresh RFC_READ_TABLE object for each call?</p>\n\n<p>We might also see more, if you activate RFC trace (e.g. environment variable RFC_TRACE=2) and take a look at the data that is sent and received during the second call.</p>\n"}], "owner": {"reputation": 27, "user_id": 9560380, "user_type": "registered", "profile_image": "https://graph.facebook.com/1697125550355244/picture?type=large", "display_name": "Vinicius Zaniboni Chagas", "link": "https://stackoverflow.com/users/9560380/vinicius-zaniboni-chagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 611, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536235562, "creation_date": 1523458208, "question_id": 49778250, "link": "https://stackoverflow.com/questions/49778250/rfc-multiple-tables-with-vba-without-losing-connections", "title": "RFC Multiple tables with vba without losing connections", "body": "<p>Hello i'm refactoring a RFC code of SAP Extraction, and i'm getting a problem with some functions.\nI'm only doing this because with have a lot of worksheets that extract a bunch of information from SAP, we need something faster and easier to understand.</p>\n\n<pre><code> Public ctlTableFactory, RFC_READ_TABLE, eQUERY_TAB, tblOptions, tblData, tblFields, funcControl, objConnection, ctlLogon, strExport1, strExport2\nPublic Sub conectasap()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    tempo_inicio = Now()\n\n    Set objFileSystemObject = CreateObject(\"Scripting.FileSystemObject\")\n    Set ctlLogon = CreateObject(\"SAP.LogonControl.1\")\n    Set funcControl = CreateObject(\"SAP.Functions\")\n    Set ctlTableFactory = CreateObject(\"SAP.TableFactory.1\")\n    Set objWindowsScriptShell = CreateObject(\"WScript.Shell\")\n    Set objConnection = ctlLogon.NewConnection\n\n    objConnection.ApplicationServer = \"XXXXXXXXXXXX\"\n    objConnection.SystemNumber = \"XXXX\"\n    objConnection.Client = \"XXX\"\n    objConnection.Language = \"PT\"\n    objConnection.User = \"XXXXXXXXXXXXX\"\n    objConnection.Password = \"Cockpit1314\"\n    booReturn = objConnection.logon(0, True)\n\n    If booReturn &lt;&gt; True Then\n\n        MsgBox \"N\u00e3o foi poss\u00edvel conectar ao SAP. \" + vbCrLf + vbCrLf + \"1. Verifique sua conex\u00e3o \u00e0 internet\" + vbCrLf + \"2. Verifique a conex\u00e3o do SAP\" + vbCrLf + \"3. Verifique se o computador possue o programa SAP\" + vbCrLf + vbCrLf + \"Caso persistir o problema, contacte o suporte.\", vbOKOnly + vbInformation\n        Stop\n    End If\n\n    funcControl.Connection = objConnection\n    Set RFC_READ_TABLE = funcControl.Add(\"RFC_READ_TABLE\")\n    Set strExport1 = RFC_READ_TABLE.exports(\"QUERY_TABLE\")\n    Set strExport2 = RFC_READ_TABLE.exports(\"DELIMITER\")\n    Set tblOptions = RFC_READ_TABLE.Tables(\"OPTIONS\")\n    Set tblData = RFC_READ_TABLE.Tables(\"DATA\")\n    Set tblFields = RFC_READ_TABLE.Tables(\"FIELDS\")\n\n    Extrai_VBAK\n    Extrai_VBAP\n    'Extrai_VBEP RFC_READ_TABLE, strExport1, strExport2, tblOptions, tblData, tblFields\n    'Extrai_MVKE RFC_READ_TABLE, strExport1, strExport2, tblOptions, tblData, tblFields\n\n    objConnection = Nothing\n    tempo_fim = Now() - tempo_inicio\n    MsgBox tempo_fim\n\n    'Call apply_formulas\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>\nWhen i call the function \"Extrai_VBAK\" it works perfectly, but when it goes to the other functions it simply does not download anything from SAP.</p>\n\n<p>FUNCTION CODE:</p>\n\n<pre><code>    Function Extrai_VBAK()\n\n\n\n    CREAT_DATE = Format(Now - 2, \"YYYYMMDD\")\n\n    Sheets(\"VBAK\").Select\n    Range(\"A2:X200000\").ClearContents\n\n'//As fun\u00e7\u00f5es abaixo s\u00e3o as conex\u00f5es que o SAP precisa fazer para extrair as tabelas futuramente.\n    strExport1.Value = \"VBAK\"\n    strExport2.Value = \";\"\n\n'// VBELN = Numero do pedido\n    tblFields.AppendRow\n    tblFields(1, \"FIELDNAME\") = \"VBELN\"\n\n'// AUART = Tipo do pedido\n    tblFields.AppendRow\n    tblFields(2, \"FIELDNAME\") = \"AUART\"\n\n'// AUGRU = Motivo da ordem\n    tblFields.AppendRow\n    tblFields(3, \"FIELDNAME\") = \"AUGRU\"\n\n'// KUNNR = C\u00f3digo do cliente\n    tblFields.AppendRow\n    tblFields(4, \"FIELDNAME\") = \"KUNNR\"\n\n'// ERDAT = Data de cria\u00e7\u00e3o\n    tblFields.AppendRow\n    tblFields(5, \"FIELDNAME\") = \"ERDAT\"\n\n'// ERNAM = Nome da pessoa que criou\n    tblFields.AppendRow\n    tblFields(6, \"FIELDNAME\") = \"ERNAM\"\n\n'// VDATU = Data de entrega\n    tblFields.AppendRow\n    tblFields(7, \"FIELDNAME\") = \"VDATU\"\n\n'// KNUMV = C\u00f3digo da condi\u00e7\u00e3o\n    tblFields.AppendRow\n    tblFields(8, \"FIELDNAME\") = \"KNUMV\"\n\n'// LIFSK = Bloqueio de remessa\n    tblFields.AppendRow\n    tblFields(9, \"FIELDNAME\") = \"LIFSK\"\n\n'// KVGR4 = Grupo do cliente / Distribuidor\n    tblFields.AppendRow\n    tblFields(10, \"FIELDNAME\") = \"KVGR4\"\n\n'// KVGR5 = Grupo do cliente\n    tblFields.AppendRow\n    tblFields(11, \"FIELDNAME\") = \"KVGR5\"\n\n\n'// Filtra para extrair apenas BR10\n    tblOptions.AppendRow\n    tblOptions(1, \"TEXT\") = \"VKORG EQ 'BR10'\"\n\n'// Data de cria\u00e7\u00e3o -2 dias\n    tblOptions.AppendRow\n    tblOptions(2, \"TEXT\") = \"AND VDATU GE '\" &amp; CREAT_DATE &amp; \"' \"\n\n'// Elimina IC5067\n    tblOptions.AppendRow\n    tblOptions(3, \"TEXT\") = \"AND KUNNR NE 'IC5067    ' \"\n\n    If RFC_READ_TABLE.call = True Then\n\n        If tblData.RowCount &gt; 0 Then\n\n            For intRow = 1 To tblData.RowCount\n\n\n                For coluna = 1 To 1\n\n                    Cells(intRow + 1, coluna).Value2 = tblData(intRow, coluna)\n\n                Next\n\n            Next\n\n        Else\n\n\n        End If\n    Else\n        End\n\n    End If\n\n\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\n    Range(\"A2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.TextToColumns Destination:=Range(\"A2\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n    Range(\"A1\").Select\n\n\n\n    L = 2\n    Do Until Cells(L, 1) = Empty\n        Cells(L, 10).Value2 = Trim$(Cells(L, 10).Value2)\n\n        L = L + 1\n    Loop\n    L = L - 1\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9630989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R4pgM1y9IG4/AAAAAAAAAAI/AAAAAAAABmk/NSGwM3z-WOY/photo.jpg?sz=128", "display_name": "Joao Brochado", "link": "https://stackoverflow.com/users/9630989/joao-brochado"}, "edited": false, "score": 0, "creation_date": 1523461518, "post_id": 49778075, "comment_id": 86574110, "body": "It works! Thank you very much, but just a question is there a way to choose where the information gets pasted, for example I want it pasted after row 16 since the data only comes after row 16 and the other lines before are the header with the information regarding the document. Sorry if I&#39;m not being very clear but I thank you again for work"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 9630989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R4pgM1y9IG4/AAAAAAAAAAI/AAAAAAAABmk/NSGwM3z-WOY/photo.jpg?sz=128", "display_name": "Joao Brochado", "link": "https://stackoverflow.com/users/9630989/joao-brochado"}, "edited": false, "score": 0, "creation_date": 1523462920, "post_id": 49778075, "comment_id": 86575067, "body": "OK do you mean you want it pasted in row 17 then, or can the row vary? Have added some code above anyway which may do the trick."}, {"owner": {"reputation": 1, "user_id": 9630989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R4pgM1y9IG4/AAAAAAAAAAI/AAAAAAAABmk/NSGwM3z-WOY/photo.jpg?sz=128", "display_name": "Joao Brochado", "link": "https://stackoverflow.com/users/9630989/joao-brochado"}, "edited": false, "score": 0, "creation_date": 1523463595, "post_id": 49778075, "comment_id": 86575431, "body": "The only thing that will vary is the column because what I want is the information of H18:M3164 from multiple workbooks side by side so it easier to compare and to work, but in addition I want to be able to control where the information starts to get pasted. The place I want it to star being pasted is the H19 of my sum template Autos.xlsx  Is it possible?"}, {"owner": {"reputation": 1, "user_id": 9630989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R4pgM1y9IG4/AAAAAAAAAAI/AAAAAAAABmk/NSGwM3z-WOY/photo.jpg?sz=128", "display_name": "Joao Brochado", "link": "https://stackoverflow.com/users/9630989/joao-brochado"}, "edited": false, "score": 0, "creation_date": 1523465127, "post_id": 49778075, "comment_id": 86576374, "body": "Yes I did, the code pasted the information in the B2:M3147 and I realized I also have a the problem where the information  in the cell isn&#39;t the number but the formula from where it came (=ROUND(D3118*#REF!;2)); I&#39;m sorry if I&#39;m not able to fully explain what I want, I&#39;m not very good with coding"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1523465200, "last_edit_date": 1523465200, "creation_date": 1523457818, "answer_id": 49778075, "question_id": 49777787, "link": "https://stackoverflow.com/questions/49777787/macro-to-copy-columns-from-multiple-workbooks-to-only-one-rearranging-them-side/49778075#49778075", "title": "Macro to copy columns from multiple workbooks to only one rearranging them side by side", "body": "<p>If I understand correctly, you just need to change the paste line. Below assumes you are pasting into row 1.</p>\n\n<pre><code>myWS.Range(\"H18:M3164\").Copy\nsumWS.Cells(1, Columns.Count).End(xlToLeft).Offset(, 1).PasteSpecial\n</code></pre>\n\n<p>or to base it on the last used row in column A</p>\n\n<pre><code>Dim r As Long\n'this line needs to go before the Do loop.\nr =sumWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n'these stay where they are \nmyWS.Range(\"H18:M3164\").Copy\nsumWS.Cells(r, Columns.Count).End(xlToLeft).Offset(, 1).PasteSpecial xlvalues\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9630989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R4pgM1y9IG4/AAAAAAAAAAI/AAAAAAAABmk/NSGwM3z-WOY/photo.jpg?sz=128", "display_name": "Joao Brochado", "link": "https://stackoverflow.com/users/9630989/joao-brochado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523465200, "creation_date": 1523456993, "question_id": 49777787, "link": "https://stackoverflow.com/questions/49777787/macro-to-copy-columns-from-multiple-workbooks-to-only-one-rearranging-them-side", "title": "Macro to copy columns from multiple workbooks to only one rearranging them side by side", "body": "<p>Hi guys I have a small problem I need help with.</p>\n\n<p>I am trying to copy data from multiple Workbook with the sheet called Auto1 into a master Workbook named Autos. From the multiple Workbooks I need the cell range H18:M3164. </p>\n\n<p>Until here I found a macro that could help me, but then I need to rearrange the information side by side (For example the first workbook selected columns would be pasted in the first A:F columns of the \"Autos\" workbook, the second workbook selected columns would be pasted in the G:L columns and so on). </p>\n\n<p>The code I have just copies and pastes it in the end so I'm asking if you could give me a hand.</p>\n\n<p>Here is my code so far.</p>\n\n<pre><code>    Option Explicit\n\n    Sub combine_data()\n    '\n    Dim MyPath As String\n    Dim SumPath As String\n    Dim MyName As String\n    Dim SumName As String\n    Dim MyTemplate As String\n    Dim SumTemplate As String\n    Dim myWS As Worksheet\n    Dim sumWS As Worksheet\n\n    'Define folders and filenames\n    MyPath = \"C:\\Users\\Utilizador\\Desktop\\Teste\\\"\n    SumPath = \"C:\\Users\\Utilizador\\Desktop\\Teste\\Master\\\"\n    MyTemplate = \"*.xls\"  'Set the template.\n    SumTemplate = \"Autos.xlsx\"\n\n    'Open the template file and get the Worksheet to put the data into\n    SumName = Dir(SumPath &amp; SumTemplate)\n    Workbooks.Open SumPath &amp; SumName\n    Set sumWS = ActiveWorkbook.Worksheets(\"Sheet1\")\n\n    'Open each source file, copying the data from each into the template file\n    MyName = Dir(MyPath &amp; MyTemplate)    'Retrieve the first file\n    Do While MyName &lt;&gt; \"\"\n        'Open the source file and get the worksheet with the data we want.\n        Workbooks.Open MyPath &amp; MyName\n        Set myWS = ActiveWorkbook.Worksheets(\"Auto1\")\n        'Copy the data from the source and paste at the end of Summary sheet\n        myWS.Range(\"H18:M3164\").Copy\n        sumWS.Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial \n     Paste:=xlPasteValues\n         'Close the current sourcefile and get the next\n         Workbooks(MyName).Close SaveChanges:=False        'close\n          MyName = Dir                    'Get next file\n     Loop\n     'Now all sourcefiles are copied into the Template file. Close and save it\n     Workbooks(SumName).Close SaveChanges:=True\n     End Sub\n</code></pre>\n"}, {"tags": ["excel", "email", "ms-word", "mailmerge", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1523457999, "post_id": 49777607, "comment_id": 86571433, "body": "What did you try so far? Where is your code? Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 498, "user_id": 4459665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-fC0c6sCXfX0/AAAAAAAAAAI/AAAAAAAAAFg/IGAw-w88-6c/photo.jpg?sz=128", "display_name": "WillacyMe", "link": "https://stackoverflow.com/users/4459665/willacyme"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1523458221, "post_id": 49777607, "comment_id": 86571612, "body": "I&#39;ve got the Excel list in Word&#39;s mail merge. I only know how to put score details into the document using Insert Mail Merge. I don&#39;t know how to automate putting all the headings into the Word document along with the scores."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1523552271, "post_id": 49777607, "comment_id": 86618878, "body": "If, as you say, the column headings could change, then I think only a (at least partial) VBA solution - is going to give you a satisfactory result. That said... Test this: insert a merge field, select it, then press Ctrl+Shift+F9. That should leave ONLY the field name (with the angled brackets). So, theoretically, you could insert each field <i>twice</i>, unlinking the first, then use Find/Replace to remove the brackets. I just gave you some VBA code to loop all the DataFields, these steps could certainly be built into that... As well as testing whether the field is empty before inserting it BTW"}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1523492733, "creation_date": 1523492733, "answer_id": 49786198, "question_id": 49777607, "link": "https://stackoverflow.com/questions/49777607/how-do-i-create-a-mail-merge-template-for-emails-which-include-heading-names-in/49786198#49786198", "title": "How do I create a mail merge template for emails which include heading names in the document?", "body": "<p>You can't merge the headers - simply type them into your mailmerge main document and, if you want to suppress them when empty, employ the mergefield \\b &amp; \\f switches, thus:</p>\n\n<pre><code>{MERGEFIELD Score1 \\b \"Score 1: \" \\f \"\u00b6\n\"}\n</code></pre>\n\n<p><strong>Note:</strong> The field brace pairs (i.e. '{ }') for the above example are created in the document itself, via Ctrl-F9 (Cmd-F9 on a Mac); you can't simply type them or copy &amp; paste them from this message. Nor is it practical to add them via any of the standard Word dialogues. The spaces represented in the field constructions are all required. Instead of the \u00b6 symbol, you should use a real line/paragraph break.</p>\n"}], "owner": {"reputation": 498, "user_id": 4459665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-fC0c6sCXfX0/AAAAAAAAAAI/AAAAAAAAAFg/IGAw-w88-6c/photo.jpg?sz=128", "display_name": "WillacyMe", "link": "https://stackoverflow.com/users/4459665/willacyme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523492733, "creation_date": 1523456557, "last_edit_date": 1531161705, "question_id": 49777607, "link": "https://stackoverflow.com/questions/49777607/how-do-i-create-a-mail-merge-template-for-emails-which-include-heading-names-in", "title": "How do I create a mail merge template for emails which include heading names in the document?", "body": "<p>I'm trying to mail merge data from an excel spreadsheet and want to include the heading titles and know if there is a quick way to include every field with a value in the document.</p>\n\n<p>Example of data from excel</p>\n\n<pre><code>Name  Score1 Score2 Score3 Score4...\nJames   88     50    90      25\nJohn    80           80      98\nAmy     70     85            85\n</code></pre>\n\n<p>The example mail merge in word would look something like this for each person;</p>\n\n<pre><code>Dear James,\n\nScore1  88\nScore2  50\nScore3  90\nScore4  25\n\n\nDear John,\n\nScore1  80\nScore3  80\nScore4  98\n\n\nDear Amy,\n\nScore1  70\nScore2  85\nScore4  85\n</code></pre>\n\n<p>I don't want the heading name i.e. Score2 to appear if there's no data for that field, and this would be a repetitive task where the heading names for score1,2 etc are subject to change and so need an effective way to list them all on the document (should they contain data for that person). I'm hoping this might be done with creating a macro.</p>\n\n<p>Edit:</p>\n\n<p>To further clarify, I can get my document to list the Name and scores like so;</p>\n\n<p>Dear \u00abName\u00bb</p>\n\n<p>\u00abScore1\u00bb</p>\n\n<p>But I need the following...</p>\n\n<p>Dear \u00abName\u00bb</p>\n\n<p>Score1: \u00abScore1\u00bb</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1523456299, "post_id": 49777458, "comment_id": 86570135, "body": "So the first element of <code>Per_Mnd</code> would be added to the first of <code>Per_Mnd2</code>?  The second element added to the second element, etc?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1523456475, "post_id": 49777458, "comment_id": 86570242, "body": "@Vityata  Poster wants an <b>array</b>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 0, "creation_date": 1523456794, "post_id": 49777583, "comment_id": 86570485, "body": "Hi, thanks! but not really what i want... I want (11,12,13)... a 3*1 array"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 0, "creation_date": 1523457301, "post_id": 49777583, "comment_id": 86570915, "body": "Thank you. Is it possible to do without loop? I might have more than 2 arrays... for example, if I have 40 arrays, each 10*1 or 40 matrices, each 10*10, how do I do that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 0, "creation_date": 1523457496, "post_id": 49777583, "comment_id": 86571068, "body": "And I am not doing any multiplcatin... All I need to do is to add up element in the same position in several arrays..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1523457599, "post_id": 49777583, "comment_id": 86571135, "body": "with 10x10 arrays you will need to loop but looping memory arrays are quick."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523457602, "post_id": 49777583, "comment_id": 86571139, "body": "@TingTing - then instead of <code>*</code> you can write <code>+</code>, it will work. Concerning the array sum w/o looping - it is a bit problematic, I guess that there would always be some kind of a hidden loop within. Even in <code>WorksheetFunction.SumProduct</code> there is a built-in loop, that goes around all the elements of the array. But in general, you can always do a function about it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 0, "creation_date": 1523459571, "post_id": 49777583, "comment_id": 86572675, "body": "I also got type mismatch for res(cnt) = el1(cnt) * el2(cnt) ... changed * to +"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523459761, "post_id": 49777583, "comment_id": 86572835, "body": "@TingTing - probably one of the values in the arrays is not a number. It can be text or error, e.g. <code>Div&#47;0</code>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523460005, "post_id": 49777583, "comment_id": 86573011, "body": "@TingTing - if you try exactly with my example, would it work?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 1, "creation_date": 1523460177, "post_id": 49777583, "comment_id": 86573126, "body": "Can&#39;t believe my eyes... I went for some tea and came back and clicked run without changing any code, and it works...!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523460245, "post_id": 49777583, "comment_id": 86573178, "body": "@TingTing - what kind of tea?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 1, "creation_date": 1523462024, "post_id": 49777583, "comment_id": 86574450, "body": "Microsoftea... hahaha"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 0, "creation_date": 1523539692, "post_id": 49777583, "comment_id": 86610196, "body": "@Vityata Hi, today i want to change this to a two-dimentional array... i updated the code and the variable is correctly calculated in the Local windows winder. But when writing to Excle file, I again got NA. Could you help to see why?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 0, "creation_date": 1523539797, "post_id": 49777583, "comment_id": 86610273, "body": "Sub try() Dim Per_Mnd As Variant Dim Per_Mnd2 As Variant  Worksheets(&quot;Res_Lege&quot;).Range(&quot;G2&quot;).Value = &quot;111&quot; Per_Mnd = Application.Transpose(Worksheets(&quot;Res_Lege&quot;).Range(&quot;J6:K26&quot;)&zwnj;&#8203;)  Worksheets(&quot;Res_Lege&quot;).Range(&quot;G2&quot;).Value = &quot;222&quot; Per_Mnd2 = Application.Transpose(Worksheets(&quot;Res_Lege&quot;).Range(&quot;J6:K26&quot;)&zwnj;&#8203;)  ReDim res(1 To UBound(Per_Mnd), 1 To 21)  Dim cnt As Long Dim rnt As Long   For cnt = LBound(Per_Mnd, 1) To UBound(Per_Mnd, 1)     For rnt = LBound(Per_Mnd, 2) To UBound(Per_Mnd, 2)         res(cnt, rnt) = Per_Mnd(cnt, rnt) + Per_Mnd2(cnt, rnt)     Next rnt Next cnt"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "edited": false, "score": 0, "creation_date": 1523539802, "post_id": 49777583, "comment_id": 86610276, "body": "Worksheets(&quot;Res_Kontor&quot;).Range(&quot;J6:K26&quot;).Value = res &#39;Debug.Print oarr(3, 1)  End Sub"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523539828, "post_id": 49777583, "comment_id": 86610303, "body": "@TingTing - it sounds like a great idea for a new question - you have the code, you know what to expect and you have the input."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1523460148, "last_edit_date": 1523460148, "creation_date": 1523456493, "answer_id": 49777583, "question_id": 49777458, "link": "https://stackoverflow.com/questions/49777458/summing-up-two-arrays-or-matrices-element-by-element/49777583#49777583", "title": "Summing up two arrays or matrices element by element", "body": "<p>If you want to sum a matrix, the <code>VBA</code> way is <code>WorksheetFunction.SumProduct</code></p>\n\n<p>Take the example below, returning 60 -> <code>1*10+2*10+3*10</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/oHAlN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oHAlN.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim el1 As Variant\n    Dim el2 As Variant\n    Dim res As Variant\n\n    el1 = Application.Transpose(Range(\"A1:A3\"))\n    el2 = Application.Transpose(Range(\"B1:B3\"))\n    Debug.Print WorksheetFunction.SumProduct(el1, el2)\n\n    ReDim res(1 To UBound(el1))\n    Dim cnt As Long\n\n    For cnt = LBound(el1) To UBound(el1)\n        res(cnt) = el1(cnt) + el2(cnt)\n    Next cnt\n\nEnd Sub\n</code></pre>\n\n<p>The idea of <code>Application.Transpose()</code> is to present the <code>Range()</code> as a one dimensional array. Once we do so, we introduce <code>res(1 to UBound(el1)</code> where we write the product per element. Or you can even do the <code>SumArray</code> as a function, returning the new array:</p>\n\n<pre><code>Public Function SumArray(arr1 As Variant, arr2 As Variant) As Variant\n\n    ReDim res(1 To UBound(arr1))\n    Dim cnt As Long\n\n    For cnt = LBound(arr1) To UBound(arr1)\n        res(cnt) = arr1(cnt) + arr2(cnt)\n    Next cnt\n\n    SumArray = res\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1523461740, "post_id": 49777862, "comment_id": 86574248, "body": "Which line specifically"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1523461701, "last_edit_date": 1523461701, "creation_date": 1523457228, "answer_id": 49777862, "question_id": 49777458, "link": "https://stackoverflow.com/questions/49777458/summing-up-two-arrays-or-matrices-element-by-element/49777862#49777862", "title": "Summing up two arrays or matrices element by element", "body": "<p>You can simply evaluate an INDEX formula to return the array:</p>\n\n<pre><code>Sub Test()\nDim oarr As Variant\nDim Per_Mnd As Variant\nDim Per_Mnd2 As Variant\nPer_Mnd = Worksheets(\"Sheet1\").Range(\"G2:G8\").Value\nPer_Mnd2 = Worksheets(\"Sheet2\").Range(\"G2:G8\").Value\n\nWith Application\n    oarr = .Transpose(.Evaluate(\"INDEX({\" &amp; Join(.Transpose(Per_Mnd), \",\") &amp; \"}+{\" &amp; Join(.Transpose(Per_Mnd2), \",\") &amp; \"},)\"))\nEnd With\n\n\nDebug.Print oarr(3, 1)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Note: this only works with single column arrays of the same size.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8330379"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1523467785, "creation_date": 1523456188, "last_edit_date": 1523467785, "question_id": 49777458, "link": "https://stackoverflow.com/questions/49777458/summing-up-two-arrays-or-matrices-element-by-element", "title": "Summing up two arrays or matrices element by element", "body": "<p>I have two variables defined like this:</p>\n\n<pre><code>Per_Mnd = Worksheets(\"Sheet1\").Range(\"G2:G8\").Value\nPer_Mnd2 = Worksheets(\"Sheet2\").Range(\"G2:G8\").Value\n</code></pre>\n\n<p>Obviously both <code>Per_Mnd</code> and <code>Per_Mnd2</code> have 7 rows and 1 column. Now I want to sum them up element by element, getting another 7\u00d71 array. How do I do it?</p>\n\n<p>And what is they are defined by matrix</p>\n\n<pre><code>Per_Mnd = Worksheets(\"Sheet1\").Range(\"G2:H8\").Value\nPer_Mnd2 = Worksheets(\"Sheet2\").Range(\"G2:H8\").Value\n</code></pre>\n\n<p>How can I quickly sum them up element by element?</p>\n\n<p>thanks!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2013", "ms-access-2016"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1523455065, "post_id": 49776922, "comment_id": 86569241, "body": "Textual values must be single quoted, however this causes SQL Injection problems, use a QueryDef E.g. <a href=\"https://stackoverflow.com/a/38660694/246342\">stackoverflow.com/a/38660694/246342</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1523477620, "post_id": 49777086, "comment_id": 86582850, "body": "I would add some simple injection protection like this:  <code>Replace(nEid1,&quot;&#39;&quot;,&quot;&#39;&#39;&quot;)</code> instead of just <code>nEid1</code>"}, {"owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "edited": false, "score": 0, "creation_date": 1523478742, "post_id": 49777086, "comment_id": 86583433, "body": "Is it necessary to add the injection protection or can i just go ahead with the above answer as it is working fine"}, {"owner": {"reputation": 287, "user_id": 8993352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8yKIc.jpg?s=128&g=1", "display_name": "Matthias Neubert", "link": "https://stackoverflow.com/users/8993352/matthias-neubert"}, "reply_to_user": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "edited": false, "score": 0, "creation_date": 1523515279, "post_id": 49777086, "comment_id": 86594144, "body": "@user9527824 I would say it depends on which data you work with and who works with it. If the data aren&#39;t that sensitive and you trust the people who work witht this data I would say it isn&#39;t that necessary. Else it is recommended. And it is best practise to protect against injection."}], "tags": [], "owner": {"reputation": 287, "user_id": 8993352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8yKIc.jpg?s=128&g=1", "display_name": "Matthias Neubert", "link": "https://stackoverflow.com/users/8993352/matthias-neubert"}, "is_accepted": true, "score": 0, "last_activity_date": 1523455087, "creation_date": 1523455087, "answer_id": 49777086, "question_id": 49776922, "link": "https://stackoverflow.com/questions/49776922/access-vba-insert-into-error/49777086#49777086", "title": "Access VBA Insert INTo Error", "body": "<p>Maybe this will help?:</p>\n\n<pre><code>sSQL = \"INSERT INTO tblComponents ([Machine Subsystem ID], [NewComponents], [MO_TAG], [Components_Detail])\" _\n&amp; \" VALUES (\" &amp; nRid &amp; \", \" &amp; nEid &amp; \", '\" &amp; nEid1 &amp; \"', '\" &amp; nEid2 &amp; \"');\"\n</code></pre>\n\n<p>I added some ' ' where the Strings are in the value brackets.</p>\n\n<p>And: </p>\n\n<p>[Machine Subsystem ID]</p>\n\n<p>Shouldn't this be only one word like Machine_Subsystem_ID?</p>\n"}], "owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49777086, "answer_count": 1, "score": 1, "last_activity_date": 1523455087, "creation_date": 1523454666, "question_id": 49776922, "link": "https://stackoverflow.com/questions/49776922/access-vba-insert-into-error", "title": "Access VBA Insert INTo Error", "body": "<p>I have a listbox named lstAvailable and i am trying to send the values selected from it into a table. But i get an error saying syntax error in Insert Into statement. Machine Subsystem ID,NewComponents are of type integer and MO_TAG and Components_Detail is of text type</p>\n\n<pre><code>      Dim varItem As Variant\n      Dim sSQL As String\n      Dim nRid As Long \n     Dim nEid As Long\n     Dim nEid1 As String\n     Dim nEid2 As String \n   Dim varRow As Variant\n     nRid = listMachineSubSystem.Column(1)\n  For Each varRow In lstAvailable.ItemsSelected\n    nEid = lstAvailable.Column(0, varRow)\n    nEid1 = lstAvailable.Column(2, varRow)\n    nEid2 = lstAvailable.Column(3, varRow)\n    sSQL = \"INSERT INTO tblComponents ([Machine Subsystem ID], [NewComponents], [MO_TAG], [Components_Detail])\" _\n    &amp; \" VALUES (\" &amp; nRid &amp; \", \" &amp; nEid &amp; \", \" &amp; nEid1 &amp; \", \" &amp; nEid2 &amp; \");\"\n    'Debug.Print \"Insert \" &amp; sSQL\n    CurrentDb.Execute sSQL, dbFailOnError\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1523491143, "creation_date": 1523491143, "answer_id": 49786028, "question_id": 49776815, "link": "https://stackoverflow.com/questions/49776815/can-microsoft-outlooks-auto-response-text-be-programmed/49786028#49786028", "title": "can Microsoft Outlook&#39;s Auto-response text be programmed?", "body": "<p>No, there is nothing like that. OOF template is static. </p>\n"}], "owner": {"reputation": 19530, "user_id": 884372, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/93234f6c046fc1554f9fb2c471fb09ec?s=128&d=identicon&r=PG", "display_name": "Carl Witthoft", "link": "https://stackoverflow.com/users/884372/carl-witthoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 49786028, "answer_count": 1, "score": 0, "last_activity_date": 1593004308, "creation_date": 1523454376, "last_edit_date": 1593004308, "question_id": 49776815, "link": "https://stackoverflow.com/questions/49776815/can-microsoft-outlooks-auto-response-text-be-programmed", "title": "can Microsoft Outlook&#39;s Auto-response text be programmed?", "body": "<p>Just wondering if there's a macro or other method to do a task such as inserting the Sender's name into the autoresponse \"out of office\" message.  I have seen some of the other VBA macros that do things like building defined text strings, but not this.<br>\nIn pseudo-code, assuming that Outlook is set up to send Out of Office messages, something to fill the return message with \n<code>Dear $Sender_Name$ , I will return on Feb 30th,...</code></p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 3, "creation_date": 1523453487, "post_id": 49776367, "comment_id": 86568015, "body": "I&#39;ve not tried importing from a CSV, but you could link to it and then use a query to pull any new data into a separate table.  I take it the CSV has some kind of key field?  Date &amp; Time probably."}, {"owner": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "edited": false, "score": 3, "creation_date": 1523453495, "post_id": 49776367, "comment_id": 86568022, "body": "You should link it anyway and then create some queries to update master table from linked one and then execute some scheduled task, which is able to run these queries from command line. Maybe you need to create some executable yourself - I haven&#39;t seen command-line MS Access client, but I have not searched for it either."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1523468629, "post_id": 49776367, "comment_id": 86578142, "body": "^What they wrote. Does the CSV have 1 record per day, or 1 record per minute? If the latter, it would probably be wise to link a shortened file that only has the newest records, not the original one with 500k rows."}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 1, "last_activity_date": 1523477440, "creation_date": 1523477440, "answer_id": 49783725, "question_id": 49776367, "link": "https://stackoverflow.com/questions/49776367/auto-updating-access-database-cant-be-linked/49783725#49783725", "title": "Auto updating access database (can&#39;t be linked)", "body": "<p>As per the comments the first step is to link your CSV to the database. Not as your main table but as a secondary table that will be used to update your main table.</p>\n\n<p>Once you do that you have two problems to solve:</p>\n\n<p><strong>Identify the new records</strong></p>\n\n<p>I assume there is a way to do so by timestamp or ID, so all you have to do is hold on to the last ID or timestamp imported (that will require an additional mini-table to hold the value persistently).</p>\n\n<p><strong>Make it happen every 60 seconds</strong>. To get that update on a regular interval you have two options:</p>\n\n<p>A form's 'OnTimer' event is the easy way but requires very specific conditions. You have to make sure the form that triggers the event is only open once. This is possible even in a multi-user environment with some smart tracking.</p>\n\n<p>If having an Access form open to do the updating is not workable, then you have to work with Windows scheduled tasks. You can set up an Access Macro to run as a Windows scheduled task.</p>\n"}], "owner": {"reputation": 33, "user_id": 9359116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jerram Lindsay", "link": "https://stackoverflow.com/users/9359116/jerram-lindsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 49783725, "answer_count": 1, "score": 1, "last_activity_date": 1523477440, "creation_date": 1523453125, "last_edit_date": 1523467821, "question_id": 49776367, "link": "https://stackoverflow.com/questions/49776367/auto-updating-access-database-cant-be-linked", "title": "Auto updating access database (can&#39;t be linked)", "body": "<p>I've got a CSV file that refreshes every 60 seconds with live data from the internet. I want to automatically update my Access database (on a 60 second or so interval) with the new rows that get downloaded, however I can't simply link the DB to the CSV. </p>\n\n<p>The CSV comes with exactly 365 days of data, so when another day ticks over, a day of data drops off. If i was to link to the CSV my DB would only ever have those 365 days of data, whereas i want to append the existing database with the new data added.</p>\n\n<p>Any help with this would be appreciated.\nThanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1523453257, "post_id": 49776243, "comment_id": 86567842, "body": "I don&#39;t see a declaration for <code>Last</code>? Do you have <code>Option Explicit</code> at the top of the code module?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1523453417, "post_id": 49776243, "comment_id": 86567958, "body": "I don&#39;t see any resizing of columns, here. But do you really mean to be copying a row and pasting it at the bottom of the same table? Should the second line of the For loop be = targetSh not = resizeSh?"}, {"owner": {"reputation": 15, "user_id": 9385221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd67451ab188ada86c7ffa8edea635ff?s=128&d=identicon&r=PG&f=1", "display_name": "shafac14", "link": "https://stackoverflow.com/users/9385221/shafac14"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1523454717, "post_id": 49776243, "comment_id": 86568963, "body": "@CindyMeister Thank you for pointing me in that direction. I just changed iLastRow As Integer to Last As Integer and it works. Why option explcit?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1523455212, "post_id": 49776243, "comment_id": 86569338, "body": "@shafac14 Note that <code>Dim i, Last As Integer</code> only declares <code>Last</code> as <code>Integer</code> but <code>i</code> remains <code>Variant</code> you need to specify a type for <b>every</b> variable. Also Excel has more rows than <code>Integer</code> can handle, so you should always use <code>Long</code> instead of <code>Integer</code> (<a href=\"https://stackoverflow.com/a/26409520/3219613\">there is no benefit in <code>Integer</code> at all in VBA</a>): <code>Dim i As Long, Last As Long</code>. Use <code>Option Explicit</code> to force that every variable is declared. This prevents you from typos and many issues."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1523455730, "post_id": 49776243, "comment_id": 86569702, "body": "Why Option Explicit: That will show an error message if you misspell a variable name or forget to declare one. So you might not have had to ask here, for example :-)"}], "owner": {"reputation": 15, "user_id": 9385221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd67451ab188ada86c7ffa8edea635ff?s=128&d=identicon&r=PG&f=1", "display_name": "shafac14", "link": "https://stackoverflow.com/users/9385221/shafac14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523453186, "creation_date": 1523452819, "last_edit_date": 1523453186, "question_id": 49776243, "link": "https://stackoverflow.com/questions/49776243/calling-sub-multiple-times-with-the-same-argument", "title": "Calling Sub multiple times with the same argument", "body": "<p>I am trying to resize multiple columns in multiple sheets. For some reason only the first one works. Is it due to the fact that I am changing both variables?</p>\n\n<pre><code>    Set targetSh = owb.Sheets(\"INPUT_INSTRUMENT\")\n\n    Set resizeSh = owb.Sheets(\"Info\")\n    tablename = \"Table5\"\n    Call RowsAction(targetSh, resizeSh, tablename)\n\n    Set resizeSh = owb.Sheets(\"Review\")\n    tablename = \"Table17\"\n    Call RowsAction(targetSh, resizeSh, tablename)\n\n\nSub RowsAction(ByRef targetSh As Worksheet, resizeSh As Worksheet, tablename As String)\n    Dim i, iLastRow As Integer, oLastRow As ListRow, srcRow As Range\n\n    Last = targetSh.Range(\"A1\", targetSh.Cells(Rows.count, \"A\").End(xlUp)).count - 2\n\n    For i = 1 To Last\n        Set srcRow = resizeSh.ListObjects(tablename).ListRows(i).Range\n        Set oLastRow = resizeSh.ListObjects(tablename).ListRows.Add\n        srcRow.Copy\n        oLastRow.Range.PasteSpecial\n        Application.CutCopyMode = False\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["date", "ms-access", "vba", "filtering"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1523451630, "post_id": 49775779, "comment_id": 86566569, "body": "Have you tried using <code>#</code> instead of a single quote?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1523451742, "post_id": 49775779, "comment_id": 86566652, "body": "It would also help us help you if you provide the <i>text</i> of the error message, not just the number! And also indicate which <i>line of code</i> is triggering the error."}, {"owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "edited": false, "score": 0, "creation_date": 1523451940, "post_id": 49775779, "comment_id": 86566806, "body": "The <code>filterString</code> results in <code>[HW End of Support] BETWEEN &#39;11.04.2018 And 10.04.2020&#39;</code> it looks like quotes are missing"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523452039, "post_id": 49775779, "comment_id": 86566887, "body": "Can you try like this -&gt; <code>&quot;[HW End of Support] BETWEEN &quot;&quot; &amp; startDate &amp; &quot;&quot; And &quot;&quot; &amp; endDate &amp; &quot;&quot;</code>"}, {"owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523452269, "post_id": 49775779, "comment_id": 86567081, "body": "@Vityata i get a runtime error 3464, missmatch in criteria expression"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523452422, "post_id": 49775779, "comment_id": 86567201, "body": "@RaulGonzales - then something like this - <code>&quot;[HW End of Support] BETWEEN #&quot; &amp; startDate &amp; &quot;# And #&quot; &amp; endDate &amp; &quot;#&quot;</code>"}, {"owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523452903, "post_id": 49775779, "comment_id": 86567549, "body": "@Vityata i dont get an error now and it runs but is filtering by all dates in 2020 when what it should do is filter dates up to 11/04/2020?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523453121, "post_id": 49775779, "comment_id": 86567726, "body": "@RaulGonzales - probably this is Format issue, thus <code>11&#47;04</code> is translated as <code>4.November</code>. Can you put <code>14.November 2020</code> and see whether it is filtered as well?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1523453305, "post_id": 49775779, "comment_id": 86567881, "body": "@RaulGonzales - the easiest way to go around the format without lots of thinking is this one - <code>&quot;[HW End of Support] BETWEEN #&quot; &amp; Format(StartDate,&quot;MM-DD-YYYY&quot;) &amp; &quot;# And #&quot; &amp; Format(EndDate,&quot;MM-DD-YYYY&quot;) &amp; &quot;#&quot;</code>"}, {"owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1523455708, "post_id": 49775779, "comment_id": 86569684, "body": "@Vityata that one worked mate! thaks a lot! if you put it in an answer i will mark it accordingly!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1523455958, "last_edit_date": 1523455958, "creation_date": 1523452111, "answer_id": 49775984, "question_id": 49775779, "link": "https://stackoverflow.com/questions/49775779/vba-error-3075-when-filtering-between-dates/49775984#49775984", "title": "VBA Error 3075 When Filtering Between Dates", "body": "<p>If you put the date between <code>#</code> signs, then VBA considers it as a date.</p>\n\n<p>As far SQL is using American date system with <code>MM-DD-YYYY</code>, you can change the format between the <code>#</code> signs, before parsing:</p>\n\n<pre><code>\"[HW End] BETWEEN #\" &amp; Format(sd,\"MM-DD-YYYY\") &amp; \"# And #\" &amp; Format(ed,\"MM-DD-YYYY\") &amp; \"#\"\n</code></pre>\n"}], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 49775984, "answer_count": 1, "score": 1, "last_activity_date": 1594635780, "creation_date": 1523451409, "last_edit_date": 1594635780, "question_id": 49775779, "link": "https://stackoverflow.com/questions/49775779/vba-error-3075-when-filtering-between-dates", "title": "VBA Error 3075 When Filtering Between Dates", "body": "<p>I know that there are a lot of answered questions regarding this topic but none of them answer the following question:\nI have got this little and simple code:</p>\n\n<pre><code>Private Sub btnHwEOLNext2_Click()\n\nDim filterString As String\nDim startDate As Date\nDim endDate As Date\n\nstartDate = Date\nendDate = Date + 730\n\nfilterString = \"[HW End of Support] BETWEEN '\" &amp; startDate &amp; \" And \" &amp; endDate &amp; \"'\"\n\nMe.Filter = filterString\nDoCmd.SetOrderBy \"[HW End of Support] ASC\"\nMe.FilterOn = True\n\nEnd Sub\n</code></pre>\n\n<p>all i am trying to do is to filter between 2 dates. the <code>startDate</code>date will always be the day you use the form and the <code>endDate</code> will always be 730 days after <code>startDate</code></p>\n\n<p>why do i keep on getting </p>\n\n<blockquote>\n  <p>error 3075</p>\n</blockquote>\n\n<p>? Help please!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523452328, "post_id": 49775516, "comment_id": 86567128, "body": "Could you include some example data and expected output ? Also, I can&#39;t see how you get  &quot;Running_This_Test_In_Some_Kind_Of_Format&quot; from &quot;Test - Testing&quot;..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523452610, "post_id": 49775516, "comment_id": 86567335, "body": "It would be helpful to know, for example, if you are concatenating across columns only within a given row.."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1523452415, "creation_date": 1523452415, "answer_id": 49776103, "question_id": 49775516, "link": "https://stackoverflow.com/questions/49775516/extract-text-numbers-before-a-specific-character/49776103#49776103", "title": "Extract Text/Numbers before a specific character", "body": "<p>Some slight alterations made... probably not the <em>cleanest</em> solution, but a solution nonetheless:</p>\n\n<pre><code>Sub Validate_Input_Click()\nDim temp As String, nextstring As String\nDim i As Long\n\nFor Row = 7 To 250\n    If Application.WorksheetFunction.CountBlank(Range(Cells(Row, 2), Cells(Row, 12))) = 0 Then\n\n    temp = \"\"\n\n    For col = 2 To 12\n      If Cells(Row, col) &lt;&gt; \"\" Then\n\n        If InStr(Cells(Row, col), \"-\") &gt; 0 Then\n            For i = 1 To Len(Cells(Row, col))\n                If Mid(Cells(Row, col), i, 1) = \"-\" Then\n                    nextstring = Left(Cells(Row, col), i - 2)\n                    Exit For\n                End If\n            Next i\n        Else\n            nextstring = Cells(Row, col)\n        End If\n\n        If temp &lt;&gt; \"\" Then temp = temp &amp; \"_\"\n            temp = temp &amp; nextstring\n        End If\n    Next col\n\n    Cells(Row, 1) = temp\n\n    End If\nNext Row\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dvXoO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dvXoO.png\" alt=\"Image1\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 1, "last_activity_date": 1523452970, "creation_date": 1523452970, "answer_id": 49776297, "question_id": 49775516, "link": "https://stackoverflow.com/questions/49775516/extract-text-numbers-before-a-specific-character/49776297#49776297", "title": "Extract Text/Numbers before a specific character", "body": "<p>You can replace</p>\n\n<pre><code>temp = temp &amp; Cells(Row, col)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>pos = InStr(1, Cells(Row, col), \"-\", vbTextCompare) 'find the position of dash\nIf pos Then 'if dash position exists\n    temp = temp &amp; Trim(Left(Cells(Row, col), pos - 1)) 'take left part of that string and trim to get rid of spaces\nElse\n    temp = temp &amp; Cells(Row, col) 'else do it as you did it before\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1523453737, "post_id": 49776416, "comment_id": 86568195, "body": "Yes it is another solution for your problem. However you need to use Trim to get rid of spaces again: <code>Trim(Split(s, &quot; - &quot;)(0))</code>"}, {"owner": {"reputation": 311, "user_id": 7132222, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c276bf6163ccded49895384c2bcbb50?s=128&d=identicon&r=PG&f=1", "display_name": "Maykid", "link": "https://stackoverflow.com/users/7132222/maykid"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1523453983, "post_id": 49776416, "comment_id": 86568377, "body": "Ah, so even with having a space before and after the dash in the split formula, it won&#39;t recognize to delete the spaces?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1523454269, "post_id": 49776416, "comment_id": 86568613, "body": "If your string always and only contains &quot; - &quot;, then there is no need to trim. If you have more spaces, you need to trim. Please ignore my first comment if you are 100% sure you will only use &quot; - &quot;."}], "tags": [], "owner": {"reputation": 311, "user_id": 7132222, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c276bf6163ccded49895384c2bcbb50?s=128&d=identicon&r=PG&f=1", "display_name": "Maykid", "link": "https://stackoverflow.com/users/7132222/maykid"}, "is_accepted": false, "score": 0, "last_activity_date": 1523453257, "creation_date": 1523453257, "answer_id": 49776416, "question_id": 49775516, "link": "https://stackoverflow.com/questions/49775516/extract-text-numbers-before-a-specific-character/49776416#49776416", "title": "Extract Text/Numbers before a specific character", "body": "<p>In messing around with the code I think I found another solution to my own problem. The code looks like:</p>\n\n<pre><code>Sub Validate_Input_Click()\nDim temp As String\nDim s As String\nFor Row = 7 To 250\n If Application.WorksheetFunction.CountBlank(Range(Cells(Row, 2), Cells(Row, 12))) = 0 Then\n    temp = \"\"\n    For col = 2 To 12\n      If Cells(Row, col) &lt;&gt; \"\" Then\n      s = temp\n        If temp &lt;&gt; \"\" Then temp = Split(s, \" - \")(0) &amp; \"_\"\n        temp = temp &amp; Cells(Row, col)\n      End If\n    Next col\n    Cells(Row, 1) = temp\nEnd If\nNext Row\nEnd Sub\n</code></pre>\n\n<p>Would this be a viable solution as well? Or would something else work better like the answer above from @dwirony?</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1523453291, "creation_date": 1523453291, "answer_id": 49776426, "question_id": 49775516, "link": "https://stackoverflow.com/questions/49775516/extract-text-numbers-before-a-specific-character/49776426#49776426", "title": "Extract Text/Numbers before a specific character", "body": "<p>There is no need to check for empty cell again as you are already checking them with CountBlank.</p>\n\n<p>What about this?</p>\n\n<pre><code>Sub Validate_Input_Click()\n Dim temp As String, str As String\n Dim iRow As Long, Col As Long\n For iRow = 7 To 250\n    If Application.WorksheetFunction.CountBlank(Range(Cells(iRow, 2), Cells(iRow, 12))) = 0 Then\n    temp = \"\"\n    For Col = 2 To 12\n        str = Trim(Split(Cells(iRow, Col), \"-\")(0))\n        If temp = \"\" Then\n            temp = str\n        Else\n            temp = temp &amp; \"_\" &amp; str\n        End If\n     Next Col\n    Cells(iRow, 1) = temp\n End If\nNext iRow\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1523454561, "last_edit_date": 1523454561, "creation_date": 1523453802, "answer_id": 49776625, "question_id": 49775516, "link": "https://stackoverflow.com/questions/49775516/extract-text-numbers-before-a-specific-character/49776625#49776625", "title": "Extract Text/Numbers before a specific character", "body": "<p>Or the following. It will be fast as uses array, typed functions, used range and compared with vbNullString.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Concat()\n    Application.ScreenUpdating = False\n    Dim arr(), wb As Workbook, ws As Worksheet, i As Long, j As Long, concatString As String\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet9\") 'Change as required\n\n    With ws\n        arr = Intersect(.Range(\"B:E\"), .UsedRange)\n        For i = LBound(arr, 1) To UBound(arr, 1)\n             concatString = vbNullString\n            For j = LBound(arr, 2) To UBound(arr, 2)\n                If InStr(1, arr(i, j), \"-\") &gt; 0 Then concatString = concatString &amp; Left$(arr(i, j), InStr(1, arr(i, j), \"-\") - 1)\n            Next j\n            .Cells(i, 1) = Join$(Split(Trim$(concatString), Chr$(32)), \"_\")\n        Next i\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>Data:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/rFI5E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rFI5E.png\" alt=\"Data\"></a></p>\n"}], "owner": {"reputation": 311, "user_id": 7132222, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c276bf6163ccded49895384c2bcbb50?s=128&d=identicon&r=PG&f=1", "display_name": "Maykid", "link": "https://stackoverflow.com/users/7132222/maykid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 49776426, "answer_count": 5, "score": 0, "last_activity_date": 1523454561, "creation_date": 1523450653, "last_edit_date": 1523452885, "question_id": 49775516, "link": "https://stackoverflow.com/questions/49775516/extract-text-numbers-before-a-specific-character", "title": "Extract Text/Numbers before a specific character", "body": "<p>So I've been playing around with Excel VBA to see what I can do with it. Currently, I'm stuck on one problem. My code is this: </p>\n\n<pre><code>Sub Validate_Input_Click()\n Dim temp As String\n For Row = 7 To 250\n      If Application.WorksheetFunction.CountBlank(Range(Cells(Row, 2), Cells(Row, 12))) = 0 Then\n    temp = \"\"\n    For col = 2 To 12\n      If Cells(Row, col) &lt;&gt; \"\" Then\n        If temp &lt;&gt; \"\" Then temp = temp &amp; \"_\"\n        temp = temp &amp; Cells(Row, col)\n      End If\n     Next col\n    Cells(Row, 1) = temp\n End If\nNext Row\nEnd Sub\n</code></pre>\n\n<p>This works exactly as I want it to. What I'm trying to do now is, lets say in a few cells of columns B through E have Text with a dash then more text, for example:</p>\n\n<pre><code>Test - Testing\n</code></pre>\n\n<p>What I want to do along with concatenating is, Grab everything to the left of that dash in each individual cell. So it would look something like,</p>\n\n<pre><code>Running_This_Test_In_Some_Kind_Of_Format\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>Running_This_Test - Testing_In_Some_Kind_Of_Format\n</code></pre>\n\n<p>I've tried creating an integer and creating a Left statement but keeps giving me not enough memory errors or using wrong argument, not sure what I'm doing incorrectly. So any help would be much appreciated!</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523452614, "post_id": 49775357, "comment_id": 86567337, "body": "<i>&quot;The code copies the tables to PP but keeps the excel format.&quot;</i> - What do you mean by this? What are you trying to do instead?"}, {"owner": {"reputation": 107, "user_id": 9084432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/524f267cd9c5837391d3d92cce00c18f?s=128&d=identicon&r=PG&f=1", "display_name": "DaZn", "link": "https://stackoverflow.com/users/9084432/dazn"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523452768, "post_id": 49775357, "comment_id": 86567453, "body": "I would like to have them in the PP format that I use. Thats why I want to copy only the data of the selected columns and paste them into an excisting PP-table."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1523453553, "post_id": 49775357, "comment_id": 86568066, "body": "The only way that I can think of being able to retain your PowerPoint&#39;s formatting would be to instead of copying over the entire table from Excel at once, transferring the cell values to the PowerPoint table one cell at a time through a loop (i.e. <code>myPresentation.Slides(2).Shapes(1).Table.Cells(1, 1).TextFrame.TextRange.Text = ThisWorkbook.Worksheets(&quot;Tabelle1&quot;).range(&quot;A1&quot;).Value</code>)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523453665, "post_id": 49775357, "comment_id": 86568135, "body": "I can&#39;t help you here because 1. I can&#39;t see how big your tables (columns by rows) and 2. It looks like you&#39;re trying to pull data from an actual table in Excel, which is more annoying to do (for me, at least), instead of from just a normal range of cells."}, {"owner": {"reputation": 107, "user_id": 9084432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/524f267cd9c5837391d3d92cce00c18f?s=128&d=identicon&r=PG&f=1", "display_name": "DaZn", "link": "https://stackoverflow.com/users/9084432/dazn"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523455695, "post_id": 49775357, "comment_id": 86569679, "body": "Thanks! But I use excel 2013. Your suggestion is not working.I guess I have to use a code like this (PowerPointApp.ActiveWindow.Selection.ShapeRange)"}, {"owner": {"reputation": 107, "user_id": 9084432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/524f267cd9c5837391d3d92cce00c18f?s=128&d=identicon&r=PG&f=1", "display_name": "DaZn", "link": "https://stackoverflow.com/users/9084432/dazn"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1523816909, "post_id": 49775357, "comment_id": 86705623, "body": "@dwirony I could also copy the date just out of an excel sheet, I copyed the data to another sheet and formated it, but then I would like to use the count code to keep it variable."}], "answers": [{"tags": [], "owner": {"reputation": 502, "user_id": 7277322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0VwwD.png?s=128&g=1", "display_name": "Jens.Huehn_at_SlideFab.com", "link": "https://stackoverflow.com/users/7277322/jens-huehn-at-slidefab-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1523941493, "creation_date": 1523941493, "answer_id": 49870272, "question_id": 49775357, "link": "https://stackoverflow.com/questions/49775357/copy-ranges-from-excel-to-existing-powerpoint-table-using-vba/49870272#49870272", "title": "Copy ranges from Excel to existing PowerPoint table using VBA", "body": "<p>When it comes to bringing data from Excel to Powerpoint you need to iterate across all cells as dwirony explained. But instead of working only on Excel ranges, you can address the Excel table column ranges via (e.g.)</p>\n\n<pre><code>activesheet.listobjects(i).listcolumns(j).range\n</code></pre>\n\n<p>A good thing to simplify this task would be to prepare the Powerpoint table data in Excel in such a way that you have a kind of staging area. This could be a range next to your table which contains only the desired columns for Powerpoint (formulas would be simple referencing, e.g. \"=A3\"). Then you could apply a simpler VBA algorithm as it would be just Excel range to Powerpoint table as a whole without thinking of the column mapping instead)</p>\n\n<p>In case you would like to have it more comfortable without coding, you could also try SlideFab ( <a href=\"https://slidefab.com\" rel=\"nofollow noreferrer\">https://slidefab.com</a> ) which can link Excel tables to Powerpoint and updates the data automatically. Disclaimer: It's my software.</p>\n\n<p>Cheers</p>\n\n<p>Jens</p>\n"}], "owner": {"reputation": 107, "user_id": 9084432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/524f267cd9c5837391d3d92cce00c18f?s=128&d=identicon&r=PG&f=1", "display_name": "DaZn", "link": "https://stackoverflow.com/users/9084432/dazn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1239, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523941493, "creation_date": 1523450190, "last_edit_date": 1523452569, "question_id": 49775357, "link": "https://stackoverflow.com/questions/49775357/copy-ranges-from-excel-to-existing-powerpoint-table-using-vba", "title": "Copy ranges from Excel to existing PowerPoint table using VBA", "body": "<p>I want to copy a selection of columns from an excel table to an existing PowerPoint table.</p>\n\n<p>This is the code I used and tried to modify to my needs but it didn't work.\nThe code copies the tables to PP but keeps the excel format.</p>\n\n<pre><code>`Sub PasteMultipleSlides()\n\n'PURPOSE: Copy Excel Ranges and Paste them into the Active PowerPoint presentation slides\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim myPresentation As Object\nDim mySlide As Object\nDim PowerPointApp As Object\nDim shp As Object\nDim MySlideArray As Variant\nDim MyRangeArray As Variant\nDim x As Long\n\n'Create an Instance of PowerPoint\n  On Error Resume Next\n\n    'Is PowerPoint already opened?\n      Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n    'Clear the error between errors\n      Err.Clear\n\n    'If PowerPoint is not already open then Exit\n      If PowerPointApp Is Nothing Then\n        MsgBox \"PowerPoint Presentation is not open, aborting.\"\n        Exit Sub\n      End If\n\n    'Handle if the PowerPoint Application is not found\n      If Err.Number = 429 Then\n        MsgBox \"PowerPoint could not be found, aborting.\"\n        Exit Sub\n      End If\n\n  On Error GoTo 0\n\n'Make PowerPoint Visible and Active\n  PowerPointApp.ActiveWindow.Panes(2).Activate\n\n'Create a New Presentation\n  Set myPresentation = PowerPointApp.ActivePresentation\n\n'List of PPT Slides to Paste to\n  MySlideArray = Array(2, 3)\n\n'List of Excel Ranges to Copy from\n    MyRangeArray = Array(Sheets(\"Tabelle1\").Range(\"Tabelle1[#All]\"), Sheets(\"Tabelle6\").Range(\"Tabelle14[#All]\"))\n\n'Loop through Array data\n  For x = LBound(MySlideArray) To UBound(MySlideArray)\n    'Copy Excel Range\n        MyRangeArray(x).Copy\n\n    'Paste to PowerPoint and position\n      On Error Resume Next\n        Set shp = myPresentation.Slides(MySlideArray(x)).Shapes.PasteSpecial(DataType:=2) 'Excel 2007-2010\n        Set shp = PowerPointApp.ActiveWindow.Selection.ShapeRange 'Excel 2013\n      On Error GoTo 0\n\n    'Center Object\n      With myPresentation.PageSetup\n        shp.Left = (.SlideWidth \\ 2) - (shp.Width \\ 2)\n        shp.Top = (.SlideHeight \\ 2) - (shp.Height \\ 2)\n      End With\n\n  Next x\n\n'Transfer Complete\n  Application.CutCopyMode = False\n  ThisWorkbook.Activate\n  MsgBox \"Complete!\"\n\nEnd Sub\n</code></pre>\n\n<p>These are the columns I would like to copy to a table on slide 2 in PP:</p>\n\n<pre><code>Sheets(\"Tabelle6\")\n    Range(\"Tabelle14[[company ]]\").Select\n    Range(\"Tabelle14[customer number]\").Select\n    Range(\"Tabelle14[order number]\").Select\n    Range(\"Tabelle14[order value]\").Select\n</code></pre>\n\n<p>And these are the columns I would like to copy to a table on slide 3 in PP:</p>\n\n<pre><code>Sheets(\"Tabelle1\")\n    Range(\"Tabelle1[[company ]]\").Select\n    Range(\"Tabelle1[customer number]\").Select\n    Range(\"Tabelle1[order number]\").Select\n    Range(\"Tabelle1[order value]\").Select\n</code></pre>\n\n<p>I hope you can help me!\nThanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1523449573, "post_id": 49774855, "comment_id": 86564996, "body": "The problem lies in the line <code>Set WorkRng = Application.Selection</code>.  You should avoid using <code>Selection</code> and try to define your range better.  What is the <code>Selection</code> when this macro is run?  You can offset by 1, but still include the headers.  Also, the <code>On Error Resume Next</code> isn&#39;t necessary and not resetting it will prevent you from seeing other errors."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1523449809, "post_id": 49774855, "comment_id": 86565160, "body": "@DarrellH the selection is the filtered data from after the first macro is applied. So I filter out the date from the previous day, then the data that is displayed would become my selection. I see many people highly against on error resume next, im not a vba coder so i dont know why it is so. What can I do instead of that?"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1523453029, "post_id": 49774855, "comment_id": 86567655, "body": "I see you have a lot of options now.  The reason against <code>On Error Resume Next</code> is that you cannot debug what you do not know.  There are cases where it is applicable, but you should know why."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1523457275, "post_id": 49774855, "comment_id": 86570888, "body": "@DarrellH Okay, thank you for the advice :)"}], "answers": [{"comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 1, "creation_date": 1523450567, "post_id": 49775354, "comment_id": 86565745, "body": "@EitelDagnin For example I forgot to add ws reference to my range which I edited now. Such mistakes might result in deleting data from incorrect/currently active sheets."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523456912, "post_id": 49775354, "comment_id": 86570594, "body": "Thank you for your reply. I tried your code, unfortunately, the code gets stuck in a loop and I waited about 2-3 minutes before I actually cancelled the macro by force."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523457362, "post_id": 49775354, "comment_id": 86570960, "body": "@EitelDagnin What is your table&#39;s range in &quot;Consolidated&quot; sheet? Are there any other entries after your table?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523457608, "post_id": 49775354, "comment_id": 86571142, "body": "There isn&#39;t a &quot;table&quot; in the sheet. Its just raw data in the cells. I didn&#39;t create a table from the data."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523457868, "post_id": 49775354, "comment_id": 86571328, "body": "@EitelDagnin Ok let me ask you this way: What is your filtered range including headers?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523458122, "post_id": 49775354, "comment_id": 86571536, "body": "So I copy data from 3 sheets into the consolidated sheet, but the data is pasted from row 2 onward as in row one there are column headings. I filter the data (which will vary in length on each import) on column B which in row one has the heading Date. This filters the data by date and then I need to delete what is visible while the filter is applied. I hope that managed to answer your question?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523458462, "post_id": 49775354, "comment_id": 86571830, "body": "@EitelDagnin I think you don&#39;t have any data on Column A. it might be the issue. I change the lastrow due to Column B since you mentioned you filter it. I also found a bug and tweaked the code. It was not deleting the adjacent values so I reversed the loop from bottom to top. Can you try now?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523520296, "post_id": 49775354, "comment_id": 86596958, "body": "Thank you again for your reply, but the code just hangs. I have to force-stop the macro."}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 1, "last_activity_date": 1523458458, "last_edit_date": 1523458458, "creation_date": 1523450175, "answer_id": 49775354, "question_id": 49774855, "link": "https://stackoverflow.com/questions/49774855/vba-delete-visible-rows-after-filter-applied/49775354#49775354", "title": "VBA - Delete Visible Rows After Filter Applied", "body": "<p>Deleting rows of filtered data is something I needed time to time while working with tables in excel, but I could never trust a macro when it comes to deleting important stuff. If you still want to use it, this might work for you:</p>\n\n<pre><code>Sub DeleteVisibleRows()\nDim ws As Worksheet\nDim lastrow As Long, i As Long\n\nSet ws = ThisWorkbook.Worksheets(\"Consolidated\")\nWith ws\n    lastrow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n    For i = lastrow To 2 Step -1 'To 2 Assuming first row contains headers\n        If .Rows(i).Hidden = False Then\n            .Rows(i).Delete\n        End If\n    Next\n.ShowAllData 'remove filtered data\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523453427, "post_id": 49775383, "comment_id": 86567965, "body": "I get a Application-Defined or Object-Defined error @Darren"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523454088, "post_id": 49775383, "comment_id": 86568447, "body": "That&#39;s odd.  I can&#39;t get it to <i>not</i> work.  I tried putting the code behind <code>Sheet1</code> and selected a range in <code>Sheet2</code>, I tried putting the code in <code>Book2</code> and selecting a range in <code>Book1</code>.  Each time it deleted the visible rows in the selection, leaving the header.  So what&#39;s special about your data that could cause.... are your cells locked and the sheet protected anywhere on the rows you&#39;re trying to delete?  That would cause the error - when it can&#39;t delete the cells you&#39;re telling it to."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523457379, "post_id": 49775383, "comment_id": 86570979, "body": "No, cells are not locked and there is no protection on the sheet or the workbook. I honestly do not know what to say here. I copied the code EXACTLY that was in your code block under the &quot;Edit&quot; in your question, and then ran the code and this is the error I get.."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523458234, "post_id": 49775383, "comment_id": 86571622, "body": "You only have one cell selected?  With only a single cell then <code>.Rows.Count</code> will return 1 and <code>?Selection.Resize(Selection.Rows.Count-1).Address</code> will return the error message (resizing the selection to 0 rows)."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523520533, "post_id": 49775383, "comment_id": 86597079, "body": "Thank you @Darren, its not a problem, Davesexcel provided a solution and its working great. Thank you for your help nevertheless :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1523450243, "creation_date": 1523450243, "answer_id": 49775383, "question_id": 49774855, "link": "https://stackoverflow.com/questions/49774855/vba-delete-visible-rows-after-filter-applied/49775383#49775383", "title": "VBA - Delete Visible Rows After Filter Applied", "body": "<p>If you're using <code>SELECTION</code> there's no need to define the worksheet. Everything you need is relevant to your selection - your selection may not be on the <code>Consolidated</code> worksheet, it will always be on the parent object of your selection though.  </p>\n\n<p>The code below assumes you have a filter applied - if it isn't then everything below the heading gets deleted.</p>\n\n<pre><code>Public Sub DeleteVisibleRows()\n\n    Dim WorkRng As Range\n\n    Set WorkRng = Selection\n\n    With WorkRng\n        .Offset(1, 0).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\n\n    WorkRng.Parent.AutoFilterMode = False\n\nEnd Sub  \n</code></pre>\n\n<p><strong>Edit:</strong>  That code's too long, I'll get rid of some of the junk.</p>\n\n<pre><code>Public Sub DeleteVisibleRows()\n\n    With Selection\n        .Offset(1, 0).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        .Parent.AutoFilterMode = False\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 4, "last_activity_date": 1523451274, "creation_date": 1523451274, "answer_id": 49775737, "question_id": 49774855, "link": "https://stackoverflow.com/questions/49774855/vba-delete-visible-rows-after-filter-applied/49775737#49775737", "title": "VBA - Delete Visible Rows After Filter Applied", "body": "<p>SpecialCells will work like the previous answer.</p>\n\n<pre><code>    Sub Button1_Click()\n    Dim sh As Worksheet, rng As Range, LstRw As Long\n\n    Set sh = Sheets(\"Sheet1\")\n    With sh\n        LstRw = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Set rng = .Range(\"A2:A\" &amp; LstRw).SpecialCells(xlCellTypeVisible)\n        rng.EntireRow.Delete\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13915, "favorite_count": 0, "accepted_answer_id": 49775737, "answer_count": 3, "score": 0, "last_activity_date": 1525768683, "creation_date": 1523448860, "last_edit_date": 1525768683, "question_id": 49774855, "link": "https://stackoverflow.com/questions/49774855/vba-delete-visible-rows-after-filter-applied", "title": "VBA - Delete Visible Rows After Filter Applied", "body": "<p>I have the two Macro's which filters a worksheet column by date and then delete's the irrelevant columns.</p>\n\n<p>However, it is very buggy and I need some help to correct that please.</p>\n\n<p>This is what the second Macro is supposed to do:</p>\n\n<p>1) <strong>Simply delete the visible rows after the filter is applied, except the first row (headers)</strong> - Currently, it deletes ALL visible rows including the first row, even though I have the <code>Offset</code> function in my code.</p>\n\n<p>2) <strong>Remove all filters</strong> - This is working fine now</p>\n\n<pre><code>Sub DeleteVisibleRows()\n\nDim ws1 As Worksheet\nDim WorkRng As Range\n\nSet ws1 = ActiveWorkbook.Sheets(\"Consolidated\")\n\nOn Error Resume Next\n\nSet WorkRng = Application.Selection\n\nApplication.ScreenUpdating = False\nWith ws1\n\nWorkRng.Offset(1, 0).Rows.SpecialCells(xlCellTypeVisible).EntireRow.Delete\n\nws1.AutoFilterMode = False\n\nEnd With\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1523450006, "post_id": 49774670, "comment_id": 86565298, "body": "Will you tell us at what line are you getting your error ? or should we guess ?"}, {"owner": {"reputation": 56, "user_id": 9630336, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oyNbm6qZn-c/AAAAAAAAAAI/AAAAAAAAABI/iwW7aJVC3Dc/photo.jpg?sz=128", "display_name": "Pedro Almeida", "link": "https://stackoverflow.com/users/9630336/pedro-almeida"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1523452398, "post_id": 49774670, "comment_id": 86567182, "body": "Sorry about that.  Range(Cells(UserRow, 12), Cells(UserRow, 21))"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1523452981, "creation_date": 1523452981, "answer_id": 49776302, "question_id": 49774670, "link": "https://stackoverflow.com/questions/49774670/excel-vba-parameter-not-valid-1004-error-after-filter-dynamic-chart/49776302#49776302", "title": "(Excel VBA) Parameter Not Valid (1004) Error after filter - Dynamic Chart", "body": "<p>Replace your line:</p>\n\n<pre><code>ChtObj.Chart.SeriesCollection(1).Values = _\n       Range(Cells(UserRow, 12), Cells(UserRow, 21))\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>ChtObj.Chart.SeriesCollection(1).Values = _\n       \"=\" &amp; ws.Range(ws.Cells(UserRow, 12), ws.Cells(UserRow, 21)).Address(0, 0, xlA1, xlExternal)\n</code></pre>\n"}], "owner": {"reputation": 56, "user_id": 9630336, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oyNbm6qZn-c/AAAAAAAAAAI/AAAAAAAAABI/iwW7aJVC3Dc/photo.jpg?sz=128", "display_name": "Pedro Almeida", "link": "https://stackoverflow.com/users/9630336/pedro-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1115, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1523469808, "creation_date": 1523448285, "last_edit_date": 1531164843, "question_id": 49774670, "link": "https://stackoverflow.com/questions/49774670/excel-vba-parameter-not-valid-1004-error-after-filter-dynamic-chart", "title": "(Excel VBA) Parameter Not Valid (1004) Error after filter - Dynamic Chart", "body": "<p>I have an issue with my dynamic chart. Anytime I filter some information \nfrom my table, using slicer or manually, excel sends me an error message.</p>\n\n<p>Parameter Not Valid (1004) Error \non line: ChtObj.Chart.SeriesCollection(1).Values = _Range(Cells(UserRow, 12), Cells(UserRow, 21)) </p>\n\n<pre><code>Sub UpdateChart()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim ChtObj As ChartObject\nDim UserRow As Long\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Dashboard\")\nSet ChtObj = ws.ChartObjects(\"Chart 6\")\n\nUserRow = ActiveCell.Row\nIf UserRow &lt; 27 Or IsEmpty(Cells(UserRow, 7)) Then\n    ChtObj.Visible = False\nElse\n    ChtObj.Chart.SeriesCollection(1).Values = _\n       Range(Cells(UserRow, 12), Cells(UserRow, 21))\n    ChtObj.Chart.ChartTitle.Text = Cells(UserRow, 7).Text\n    ChtObj.Visible = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I call this function in my Dashboard Sheet</p>\n\n<pre><code>Private Sub CheckBox1_Click()\n    If CheckBox1 Then\n        Call UpdateChart\n        ActiveCell.Select\n    End If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    If CheckBox1 Then Call UpdateChart\nEnd Sub\n</code></pre>\n\n<p>Could you help me please?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1523445695, "post_id": 49773765, "comment_id": 86562341, "body": "Without some idea of what the script does we&#39;re just guessing. How do the memory and CPU look in task manager? Has the dataset to be processed been increasing in size? If you press CTRL-Break, what line does it break on"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1523445776, "post_id": 49773765, "comment_id": 86562394, "body": "You can use <code>https:&#47;&#47;codereview.stackexchange.com&#47;</code> for working codes"}, {"owner": {"reputation": 5466, "user_id": 1803692, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/umD6Q.jpg?s=128&g=1", "display_name": "Vogel612", "link": "https://stackoverflow.com/users/1803692/vogel612"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 2, "creation_date": 1523445839, "post_id": 49773765, "comment_id": 86562437, "body": "@Tehscript (and OP) note that code review requires the code to be present in the question :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1523446042, "post_id": 49773765, "comment_id": 86562568, "body": "I&#39;m voting to close this question as off-topic because it currently runs. Questions seeking code optimization maybe candidates for the code review site. Please read the associated guidance on posting there."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 5466, "user_id": 1803692, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/umD6Q.jpg?s=128&g=1", "display_name": "Vogel612", "link": "https://stackoverflow.com/users/1803692/vogel612"}, "edited": false, "score": 0, "creation_date": 1523446043, "post_id": 49773765, "comment_id": 86562569, "body": "@Vogel612 I haven&#39;t mentioned anything about posting/not posting code but I think this is obvious. Thank you for pointing out this anyway."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523446207, "post_id": 49773765, "comment_id": 86562675, "body": "I created a small edit to explain what the codes does.  @QHarr I&#39;m not trying to optimize my code, it works fine, my computer is just getting slower at running it, thats what the problem is about."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523446251, "post_id": 49773765, "comment_id": 86562693, "body": "Then that sounds like maybe a superuser question or another of the SE sites."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1523446369, "post_id": 49773765, "comment_id": 86562767, "body": "@Nick.McDermaid excel ueses around 30% of the CPU and 6% ram. The workbooks are 630 KB, which has remained the same. Its not running in a loop, it just stops the point it has reached."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1523446506, "post_id": 49773765, "comment_id": 86562862, "body": "We still can&#39;t troubleshoot this. In short, excel and VBA do not scale very well. You&#39;d probably find if you did this in a database it would be a lot quicker."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "edited": false, "score": 0, "creation_date": 1523446717, "post_id": 49773765, "comment_id": 86562996, "body": "Yeah, I see that I might have posted this in the wrong place, since this is a more general question about excel. I jsut thought that there might be some obvious thing like clearing the memory etc."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1523446810, "post_id": 49773765, "comment_id": 86563051, "body": "@Nick.McDermaid I know it might have been better to code it in something else, but this is just for my master thesis and VBA is just what I&#39;m best at."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523447634, "post_id": 49773765, "comment_id": 86563641, "body": "@DennisChristiansen What do you mean <code>I&#39;ve tried to restart the computer without luck</code>?  Are you saying it won&#39;t reboot?  If it won&#39;t reboot the standard way, you&#39;ll need to hard-boot. Do you reboot regularly (ie, Daily + after any Excel crash, etc)?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523447788, "post_id": 49773765, "comment_id": 86563740, "body": "@DennisChristiansen Also re: your earlier comment, your computer is not <i>getting slower at running the code</i>, that&#39;s not how it works.  The processor speed does not change; the problem is either too many calculations, or more likely calculations that could be made more efficient."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1523449113, "post_id": 49773765, "comment_id": 86564629, "body": "As everyone else says - could be lots of different things.  First thing that springs to mind for me is you&#39;re not clearing your values/variables down at a specific point in the code.  Maybe it&#39;s opening workbooks in the background and not closing them afterwards, maybe creating an instance of class and not releasing it when finished..."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523449762, "post_id": 49773765, "comment_id": 86565135, "body": "@ashleedawg I see. What I meant with &quot;without luck&quot;, was simply that it didn&#39;t solve the problem."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523449849, "post_id": 49773765, "comment_id": 86565182, "body": "@ashleedawg Okay, I didnt actually knew that. But then why does it now take a longer time to run the code? The computer is nothing else this and its the same code I&#39;ve been running all the time."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1523449928, "post_id": 49773765, "comment_id": 86565239, "body": "@Darren Bartrup-Cook There is only two workbooks open at any time, the workbook with the ALM-Model and then the workbook and creates a copy of the first workbook and runs the code again."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1523450586, "post_id": 49773765, "comment_id": 86565758, "body": "Okay, I didnt actually knew that.  I can&#39;t see the code."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "edited": false, "score": 0, "creation_date": 1523452110, "post_id": 49773765, "comment_id": 86566952, "body": "I know that you can&#39;t se the code, but thank you all for all the suggestions. I&#39;ve had the computer turned off for a while now and it looks like its back 5 min."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1523455828, "post_id": 49773765, "comment_id": 86569782, "body": "Long iterative runs of Excel can cause buildup problems of things (like the string pool?). I would suggest you store the results of each iteration somewhere and run in batches of say 50 iterations that start where the last one left off."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7317181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777370abebf0965ea7a9f50b9853cbb1?s=128&d=identicon&r=PG&f=1", "display_name": "A Gibb", "link": "https://stackoverflow.com/users/7317181/a-gibb"}, "is_accepted": false, "score": 1, "last_activity_date": 1523452070, "last_edit_date": 1523452070, "creation_date": 1523451612, "answer_id": 49775844, "question_id": 49773765, "link": "https://stackoverflow.com/questions/49773765/vba-file-takes-longer-and-longer-time-to-execute/49775844#49775844", "title": "VBA file takes longer and longer time to execute", "body": "<p>You can try adding :</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n</code></pre>\n\n<p>At the start of the script and</p>\n\n<pre><code>Application.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>At the end to see if this improves performance. \nThis stops Excel from refreshing the screen and updating the entire workbook every time a cell is changed. When the calculation method is changed back to automatic Excel will recalculate the workbook, but just once instead of every time your script changes a cell value. </p>\n"}], "owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1523458842, "answer_count": 1, "score": -1, "last_activity_date": 1523452070, "creation_date": 1523445623, "last_edit_date": 1523446111, "question_id": 49773765, "link": "https://stackoverflow.com/questions/49773765/vba-file-takes-longer-and-longer-time-to-execute", "closed_reason": "Not suitable for this site", "title": "VBA file takes longer and longer time to execute", "body": "<p>I have a very large VBA script that runs a lot of calculations. I create a copy of the workbook and run the main script over and over again. This has been working flawlessly but I'm running into a bit of trouble.</p>\n\n<p>It takes around 5 minutes to run the entire code (even when it's running in the background), but now that it has been running for a few hundred iterations it is starting to get extremely slow and the runtime has increased to more than 10 min. </p>\n\n<p>The computer has been running the script non stop for the past few days. I've tried to restart the computer without luck. Does anyone know how to fix this? Do I have to clear the memeory somehow, turn off the computer for a while, delete the folder in AppData or something like that?</p>\n\n<p>EDIT: The VBA script is an Asset/liability model, which is basically a lot of stochastic models where I price different assets and liabilities and see how they evole over time. There are almost 3000 lines of codes, so I cant really uplaode it.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1152, "user_id": 3762757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f118427ae4dcc1f98930bf69c601333?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav Totla", "link": "https://stackoverflow.com/users/3762757/pranav-totla"}, "edited": false, "score": 1, "creation_date": 1523445399, "post_id": 49773566, "comment_id": 86562139, "body": "Please elaborate your problem. Please give sample of when did error came and for what data and for what macro, etc."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1523445739, "creation_date": 1523445739, "answer_id": 49773805, "question_id": 49773566, "link": "https://stackoverflow.com/questions/49773566/excel-vba-run-time-error-91/49773805#49773805", "title": "Excel VBA Run Time Error 91", "body": "<p>Most likely you do not have current workbook in protected view so try testing first</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\nIf Application.ProtectedViewWindows.Count &gt; 0 Then\n    Application.ActiveProtectedViewWindow.Edit\nEnd If\n\nEnd Su\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1523445755, "creation_date": 1523445755, "answer_id": 49773811, "question_id": 49773566, "link": "https://stackoverflow.com/questions/49773566/excel-vba-run-time-error-91/49773811#49773811", "title": "Excel VBA Run Time Error 91", "body": "<p>Most probably the <code>ActiveProtectedViewWindow</code> returns <code>Nothing</code>, thus you cannot <code>Edit</code> it. <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-activeprotectedviewwindow-property-excel\" rel=\"nofollow noreferrer\">MSDN</a>:</p>\n\n<blockquote>\n  <p>Returns a ProtectedViewWindow object that represents the active Protected View window (the window on top). Read-only. Returns Nothing if there are no Protected View windows open. Read-only</p>\n</blockquote>\n\n<p>Check whether it is <code>Not Nothing</code> by using the following:</p>\n\n<pre><code>Sub TestMe()\n    If Not Application.ActiveProtectedViewWindow Is Nothing Then\n        Application.ActiveProtectedViewWindow.Edit \"pwd\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9630121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246dfb4c75e6fb43e7448a92f5aaf254?s=128&d=identicon&r=PG&f=1", "display_name": "Deepali", "link": "https://stackoverflow.com/users/9630121/deepali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1523446059, "creation_date": 1523444995, "last_edit_date": 1523446059, "question_id": 49773566, "link": "https://stackoverflow.com/questions/49773566/excel-vba-run-time-error-91", "title": "Excel VBA Run Time Error 91", "body": "<p>I am a beginner to macros. I got a </p>\n\n<blockquote>\n  <p>run time error 91</p>\n</blockquote>\n\n<p>in line</p>\n\n<pre><code>Application.ActiveProtectedViewWindow.Edit\n</code></pre>\n\n<p>Any suggestions on how to debug it?</p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 2, "creation_date": 1523444731, "post_id": 49773415, "comment_id": 86561671, "body": "Can you post your code?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1523445360, "post_id": 49773415, "comment_id": 86562108, "body": "And include the URL if possible"}, {"owner": {"reputation": 7, "user_id": 7883715, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3p1BWWxPjjY/AAAAAAAAAAI/AAAAAAAAABM/bzsQwoJKouk/photo.jpg?sz=128", "display_name": "user7883715", "link": "https://stackoverflow.com/users/7883715/user7883715"}, "edited": false, "score": 0, "creation_date": 1523446929, "post_id": 49773415, "comment_id": 86563134, "body": "&lt;a href=&quot;<a href=\"https://www.somelink.iata.org/somelink14/acdm/acdm_query.asp?extid=CY730\" rel=\"nofollow noreferrer\">somelink.iata.org/somelink14/acdm/acdm_query.asp?extid&zwnj;&#8203;=CY730</a>&quot; title=&quot;ADM &amp;amp; ACM Query&quot; target=&quot;principal&quot;&gt;-&amp;nbsp;ADM &amp;amp; ACM Query&lt;/a&gt;"}, {"owner": {"reputation": 7, "user_id": 7883715, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3p1BWWxPjjY/AAAAAAAAAAI/AAAAAAAAABM/bzsQwoJKouk/photo.jpg?sz=128", "display_name": "user7883715", "link": "https://stackoverflow.com/users/7883715/user7883715"}, "edited": false, "score": 0, "creation_date": 1523446939, "post_id": 49773415, "comment_id": 86563143, "body": "i dont have the code"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523540143, "post_id": 49774533, "comment_id": 86610559, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1523447901, "creation_date": 1523447901, "answer_id": 49774533, "question_id": 49773415, "link": "https://stackoverflow.com/questions/49773415/open-href-link-in-html-through-vba/49774533#49774533", "title": "Open HREF link in HTML through VBA", "body": "<p>Difficult to tell with what you have provided but you maybe able to loop over  tags and test for presence of part of the href e.g.</p>\n\n<pre><code>Option Explicit\n\n'&lt;a href=\"somelink.iata.org/somelink14/acdm/\u2026; title=\"ADM &amp;amp; ACM Query\" target=\"principal\"&gt;-&amp;nbsp;ADM &amp;amp; ACM Query&lt;/a&gt;\n\nPublic Sub Test()\n   'Tools &gt; references &gt; add Microsoft XML and HTML Object library\n    Dim http As New XMLHTTP60 ' this would be as per your version of Excel\n    Dim html As New HTMLDocument\n\n    With http\n        .Open \"GET\", \"yourURL\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    Dim posts As MSHTML.IHTMLElementCollection\n    Dim post As MSHTML.IHTMLElement\n\n    Set posts = html.getElementsByTagName(\"a\")\n\n    For Each post In posts\n\n        If InStr(1, post.innerText, \"somelink.iata.org/somelink14/acdm\") &gt; 0 Then\n           post.Click\n        End If\n\n    Next post\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7883715, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3p1BWWxPjjY/AAAAAAAAAAI/AAAAAAAAABM/bzsQwoJKouk/photo.jpg?sz=128", "display_name": "user7883715", "link": "https://stackoverflow.com/users/7883715/user7883715"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1523447901, "creation_date": 1523444657, "last_edit_date": 1531164843, "question_id": 49773415, "link": "https://stackoverflow.com/questions/49773415/open-href-link-in-html-through-vba", "title": "Open HREF link in HTML through VBA", "body": "<p>i am trying to automate some scraping through vba. I have a number of login ids and password to which I login individually and download some data. I have managed to login to site, the next part is opening the hyperlink mentioned in the href tag (inner text). Can someone help me to set the code for the same?</p>\n\n<p>Vincent</p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1523444607, "post_id": 49773331, "comment_id": 86561582, "body": "Is &quot;Hidden Sheet&quot; hidden? If yes, your hyperlink doesn&#39;t take you anywhere."}, {"owner": {"reputation": 215, "user_id": 5244615, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ad068c341805464626762aee390d44b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dullspark", "link": "https://stackoverflow.com/users/5244615/dullspark"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1523445913, "post_id": 49773331, "comment_id": 86562487, "body": "It&#39;s currently not, I&#39;m hoping to unhide the sheet then hide it again within the macro"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1523445183, "creation_date": 1523445183, "answer_id": 49773612, "question_id": 49773331, "link": "https://stackoverflow.com/questions/49773331/create-a-hyperlink-that-links-to-another-worksheet/49773612#49773612", "title": "Create a Hyperlink that links to another worksheet", "body": "<p>try</p>\n\n<pre><code>Sheets(\"Summary-Champion Specific\").Hyperlinks.Add Anchor:=Sheets(\"Summary-Champion Specific\").Cells(p1, p), Address:=\"\", SubAddress:=Sheets(\"Hidden Sheet\").Cells(p1, p).Address(External:=True)\n</code></pre>\n\n<p>in any case, should \"Hidden Sheet\" worksheet be hidden, the link wouldn't bring you anywhere</p>\n"}], "owner": {"reputation": 215, "user_id": 5244615, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ad068c341805464626762aee390d44b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dullspark", "link": "https://stackoverflow.com/users/5244615/dullspark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 49773612, "answer_count": 1, "score": 0, "last_activity_date": 1528980709, "creation_date": 1523444409, "last_edit_date": 1528980709, "question_id": 49773331, "link": "https://stackoverflow.com/questions/49773331/create-a-hyperlink-that-links-to-another-worksheet", "title": "Create a Hyperlink that links to another worksheet", "body": "<p>I'm trying to create a hyperlink in a sheet called \"Summary-Champion Specific\" that links to a sheet called \"Hidden Sheet\". I've tried using the following code where P1 and P and iterative numbers however cannot get it to work.</p>\n\n<pre><code> Sheets(\"c\").Hyperlinks.Add Anchor:=Sheets(\"c\").Range(Cells(P1, P), Cells(P1, P)), Address:=\"\", SubAddress:=Sheets(\"Hidden Sheet\").Range(Cells(P1, P), Cells(P1, P)).Address(External:=True)\n</code></pre>\n\n<p>Any Ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523448312, "post_id": 49773055, "comment_id": 86564101, "body": "The single quotes are because you are not specifying RC notation when you use the Address property."}, {"owner": {"reputation": 1, "user_id": 9630013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f92621c5cf424840be4aa2e77090a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/9630013/prabhu"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1525355818, "post_id": 49773055, "comment_id": 87331467, "body": "Many thanks for your response. I managed to resolve the issue per your advise."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9630013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f92621c5cf424840be4aa2e77090a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/9630013/prabhu"}, "edited": false, "score": 0, "creation_date": 1523513716, "post_id": 49773796, "comment_id": 86593324, "body": "Many thanks for your response Prebsus. Tried to add indirect to the formula, still the same issue."}, {"owner": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "reply_to_user": {"reputation": 1, "user_id": 9630013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f92621c5cf424840be4aa2e77090a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/9630013/prabhu"}, "edited": false, "score": 0, "creation_date": 1523545282, "post_id": 49773796, "comment_id": 86614419, "body": "I was able to replicate your issue now - please see my updated answer above"}, {"owner": {"reputation": 1, "user_id": 9630013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f92621c5cf424840be4aa2e77090a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/9630013/prabhu"}, "edited": false, "score": 0, "creation_date": 1523613422, "post_id": 49773796, "comment_id": 86642650, "body": "Many thanks for your response Prebsus. I tried to replace with Activecell.formulaR1C1 still the same issue. I&#39;m trying to filldown the formula till certain amount of rows below. Appreciate your suggestions to resolve the issue."}, {"owner": {"reputation": 1, "user_id": 9630013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f92621c5cf424840be4aa2e77090a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/9630013/prabhu"}, "edited": false, "score": 0, "creation_date": 1523630046, "post_id": 49773796, "comment_id": 86653688, "body": "I found out the issue with my macro, as advised i replaced Activecell.FormulaR1C1 with Activecell.Formula and also replaced the R1C1 reference with the formula with absolute cell reference, then macro executed perfectly. New code below:"}, {"owner": {"reputation": 1, "user_id": 9630013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f92621c5cf424840be4aa2e77090a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/9630013/prabhu"}, "edited": false, "score": 0, "creation_date": 1523630087, "post_id": 49773796, "comment_id": 86653718, "body": "ColumnNumber1 = AssociateIDColumnNo          ColumnNumber2 = LocationDescColumnNo      &#39;Convert To Column Letter     ColumnLetter1 = Split(Cells(1, ColumnNumber1).Address, &quot;$&quot;)(1)     ColumnLetter2 = Split(Cells(1, ColumnNumber2).Address, &quot;$&quot;)(1)   ActiveCell.Formula = _         &quot;=IFERROR(VLOOKUP(&quot; &amp; ColumnLetter1 &amp; &quot;2,&#39;[XYZ.xlsx]ABC Report&#39;!$A$1:$Z$500000,MATCH(&quot;&quot;Location Description&quot;&quot;,&#39;[XYZ.xlsx]ABC&#39;!$A$1:$Z$1,0),),&quot; &amp; ColumnLetter2 &amp; &quot;2)&quot;"}], "tags": [], "owner": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "is_accepted": false, "score": 0, "last_activity_date": 1523545262, "last_edit_date": 1523545262, "creation_date": 1523445718, "answer_id": 49773796, "question_id": 49773055, "link": "https://stackoverflow.com/questions/49773055/vlookup-with-dynamic-lookup-value-using-vba/49773796#49773796", "title": "vlookup with dynamic lookup_value using VBA?", "body": "<p><strong>New Answer:</strong>\nHaving been able to replicate you error, I think I have a solution: Replace your <code>ActiveCell.FormulaR1C1</code> with <code>ActiveCell.Formula</code>. This solved it in my simple re-creation of the problem (using the immediate-window)</p>\n\n<p>This works (sets a reference to cell A1 in cell A2, based on address of Cell A1:\n <code>Cells(2,2).Formula = \"=\"&amp;Cells(1,1).Address(0,0)</code></p>\n\n<p>While this doesn't work (gives same issue with 'A1' in single quotes as you had): <code>Cells(2,2).FormulaR1C1 = \"=\"&amp;Cells(1,1).Address(0,0)</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9630013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f92621c5cf424840be4aa2e77090a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/9630013/prabhu"}, "edited": false, "score": 0, "creation_date": 1525355880, "post_id": 49819512, "comment_id": 87331515, "body": "Many thanks for the response. Per your suggestion, I managed to resolve the issue."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1523630360, "creation_date": 1523630360, "answer_id": 49819512, "question_id": 49773055, "link": "https://stackoverflow.com/questions/49773055/vlookup-with-dynamic-lookup-value-using-vba/49819512#49819512", "title": "vlookup with dynamic lookup_value using VBA?", "body": "<p>I think there may be some confusion between named ranges and range variables in VBA. However, one problem in your formula is an inconsistent application or RC notation so you need</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=IFERROR(VLOOKUP(\" &amp; dynamic_lookup_value.Address(0, 0, xlR1C1) &amp; \",XYZ!C1:C26,MATCH(\"\"Location Description\"\",XYZ!R1C1:R1C26,0),),\" &amp; LocationRef.Address(0, 0, xlR1C1) &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9630013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f92621c5cf424840be4aa2e77090a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/9630013/prabhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 373, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1523630360, "creation_date": 1523443562, "last_edit_date": 1523450696, "question_id": 49773055, "link": "https://stackoverflow.com/questions/49773055/vlookup-with-dynamic-lookup-value-using-vba", "title": "vlookup with dynamic lookup_value using VBA?", "body": "<p>I'm new to using the dynamic lookup value, I tried following the piece of advice from How to perform an excel vlookup with dynamic lookup_value using VBA? to fetch a value dynamically from another workbook. </p>\n\n<p>This below code throws <code>#Name?</code> error. </p>\n\n<p>Request your help to resolve the error.</p>\n\n<p><strong>Code Excerpt</strong>:</p>\n\n<pre><code>Dim ws As Worksheet\nDim dynamic_lookup_value As Range\nDim LocationRef As Range\n\nSet ws = ActiveWorkbook.Worksheets(\"XYZ\")\n\nSet dynamic_lookup_value = ws.Cells(2, 1)\n\nActiveWorkbook.Names.Add Name:=\"dynamic_lookup_value\", RefersTo:=Worksheets(\"XYZ\").Cells(2, 1)\n\nSet LocationRef = ws.Cells(2, ActiveColumn)\n\nActiveCell.FormulaR1C1 = _\n    \"=IFERROR(VLOOKUP(\" &amp; dynamic_lookup_value.Address(0, 0) &amp; \",'[ABC.xlsx]XYZ'!C1:C26,MATCH(\"\"Location Description\"\",'[ABC.xlsx]XYZ'!R1C1:R1C26,0),),\" &amp; LocationRef.Address(0, 0) &amp; \")\"\n</code></pre>\n\n<p>After execution, the formula appears as </p>\n\n<pre><code>=IFERROR(VLOOKUP('A2','[HC report.xlsx]HC Report'!$A:$Z,MATCH(\"Location Description\",'[HC report.xlsx]HC Report'!$A$1:$Z$1,0),),'G2')\n</code></pre>\n\n<p>Please note lookup value appears 'A2'(with single codes). Tried to declare the <code>dynamic_lookup_value</code> using the following piece of code but in vain.</p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=\"dynamic_lookup_value\", RefersTo:=Worksheets(\"XYZ\").Cells(2, 1)\n</code></pre>\n\n<p>If I manually remove the Singe code before and after the A2 and G2, then the formula works fine. </p>\n\n<p>Request the experts advise to resolve this issue.</p>\n\n<p>Many thanks,\nPrabhu</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1523447037, "last_edit_date": 1523447037, "creation_date": 1523444047, "answer_id": 49773205, "question_id": 49772965, "link": "https://stackoverflow.com/questions/49772965/loop-comparing-cells-with-array-values-vba/49773205#49773205", "title": "Loop comparing cells with array values vba", "body": "<p>Maybe this? Your loop runs to FinalRow but you subsequently change the values in column A so presumably is not up to date. You can use Match to avoid the inner loop.</p>\n\n<pre><code>Sub sheets()\n\nDim MyArray As Variant\nDim element As Variant\nDim wb As Workbook\nSet wb = ThisWorkbook\nDim ws As Worksheet\nSet ws = wb.Worksheets(1)\nDim ws2 As Worksheet\nSet ws2 = wb.Worksheets(\"Sheet2\")\nDim i As Long\nDim r As Range\nDim v As Variant\n\nWith ws\n    .Range(\"A2\", .Range(\"A2\").End(xlDown)).RemoveDuplicates Columns:=Array(1)\n    MyArray = .Range(\"A2\", .Range(\"A2\").End(xlDown))\nEnd With\n\nws2.Range(\"A2\", ws2.Range(\"A2\").End(xlDown)).Copy Destination:=ws.Cells(2, 1)\n\nFor Each element In MyArray\n    wb.sheets.Add(After:=wb.sheets(wb.sheets.Count)).Name = element\nNext element\n\nFor Each r In ws.Range(\"A2\", ws.Range(\"A2\").End(xlDown))\n    v = Application.Match(r, MyArray, 0)\n    If IsNumeric(v) Then\n        r.Copy Destination:=wb.Worksheets(CStr(MyArray(v,1))).Cells(r.Row, 1)\n    End If\nNext r\n\nws.Activate\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "edited": false, "score": 0, "creation_date": 1523451950, "post_id": 49774143, "comment_id": 86566818, "body": "Thanks. I don&#39;t have experience with dictionaries but your comments are really helpful for me to understand how they work."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "edited": false, "score": 0, "creation_date": 1523464433, "post_id": 49774143, "comment_id": 86575994, "body": "Let me know what will be your final choice"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1523446683, "creation_date": 1523446683, "answer_id": 49774143, "question_id": 49772965, "link": "https://stackoverflow.com/questions/49772965/loop-comparing-cells-with-array-values-vba/49774143#49774143", "title": "Loop comparing cells with array values vba", "body": "<p>I'd use <code>Dictionary</code> object</p>\n\n<pre><code>Sub sheetss()\n    Dim cell As Range\n    Dim dict1 As Object, dict2 As Object\n\n    With ThisWorkbook ' reference wanted workbook\n        Set dict1 = CreateObject(\"Scripting.Dictionary\")\n        With .Worksheets(1) ' reference referenced workbook relevant worksheet\n            For Each cell In .Range(\"A2\", .Range(\"A2\").End(xlDown)) ' loop through referenced worksheet column A cells from row 2 down to last not empty one\n                dict1(cell.Value) = 1 'store unique values from looped cells into dictionary keys\n            Next\n        End With\n\n        Set dict2 = CreateObject(\"Scripting.Dictionary\")\n        With .Worksheets(\"Sheet2\") ' reference referenced workbook relevant worksheet\n            For Each cell In .Range(\"A2\", .Range(\"A2\").End(xlDown)) ' loop through referenced worksheet column A cells from row 2 down to last not empty one\n                dict2(cell.Value) = dict1.exists(cell.Value) 'store unique values from looped cells into dictionary keys and its presence in first worksheet column A cells into corresponding item\n            Next\n        End With\n\n        Dim key As Variant\n        For Each key In dict2.keys ' loop through 2nd worksheet column A unique values\n            If dict2(key) Then ' if it was in 1st worksheet column A cells also\n                .sheets.Add(After:=ThisWorkbook.sheets(ThisWorkbook.sheets.Count)).Name = key ' create corresponding worksheet\n                .sheets(key).Cells(Rows.Count, 1).End(xlUp).Offset(1).Value = key ' copy its value into cell B1 of newly created worksheet\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "edited": false, "score": 1, "creation_date": 1523451784, "post_id": 49774339, "comment_id": 86566683, "body": "Thank you. I have to analyze this code as I don&#39;t have experience with dictionaries but I will definitely use it in the future"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1523447276, "creation_date": 1523447276, "answer_id": 49774339, "question_id": 49772965, "link": "https://stackoverflow.com/questions/49772965/loop-comparing-cells-with-array-values-vba/49774339#49774339", "title": "Loop comparing cells with array values vba", "body": "<p>Also with a dictionary</p>\n\n<pre><code>Option Explicit\n\nPublic Sub WriteToSheets()\n    Application.ScreenUpdating = False\n    Dim MyArray As Variant, wb As Workbook, ws As Worksheet, ws2 As Worksheet, i As Long, dict As Object, rng As Range\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(1)\n    Set ws2 = wb.Worksheets(\"Sheet2\")\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    With ws\n        MyArray = Intersect(.Columns(1), .UsedRange)\n        For i = LBound(MyArray, 1) To UBound(MyArray, 1)\n            If Not dict.exists(MyArray(i, 1)) Then\n                dict.Add MyArray(i, 1), 1\n                On Error Resume Next 'in case already exists\n                wb.sheets.Add(After:=wb.sheets(wb.sheets.Count)).Name = MyArray(i, 1)\n                On Error GoTo 0\n            End If\n        Next i\n    End With\n    With ws2\n        For Each rng In Intersect(.Columns(1), .UsedRange)\n            If dict.exists(rng.Value) Then\n                rng.Copy wb.Worksheets(rng.Value).Range(\"A\" &amp; GetNextRow(wb.Worksheets(rng.Value), 1))\n            End If\n        Next rng\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Function GetNextRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n    With ws\n        GetNextRow = IIf(.Cells(.Rows.Count, columnNumber).End(xlUp).Row = 1, 1, .Cells(.Rows.Count, columnNumber).End(xlUp).Row + 1)\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 9184620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0112a7523403cb7fa67d8daf2898d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/9184620/tomek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 0, "accepted_answer_id": 49773205, "answer_count": 3, "score": 2, "last_activity_date": 1523447276, "creation_date": 1523443300, "last_edit_date": 1531164843, "question_id": 49772965, "link": "https://stackoverflow.com/questions/49772965/loop-comparing-cells-with-array-values-vba", "title": "Loop comparing cells with array values vba", "body": "<p>I am trying to write a loop comparing all the values from the column A with all the values from MyArray. If cell value is the same as some value from the array, I would like to copy that cell to another corresponding sheet (All sheets are named as elements in the array). </p>\n\n<pre><code>Sub sheets()\n\n    Dim MyArray As Variant\n    Dim element As Variant\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n    Dim ws As Worksheet\n    Set ws = wb.Worksheets(1)\n    Dim ws2 As Worksheet\n    Set ws2 = wb.Worksheets(\"Sheet2\")\n    Dim i As Integer\n\n    FinalRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\nWith ws\n\n'Part that creates my Array without duplicates\n\n\n.Range(\"A2\", .Range(\"A2\").End(xlDown)).RemoveDuplicates Columns:=Array(1)\nMyArray = .Range(\"A2\", .Range(\"A2\").End(xlDown))\n\nEnd With\n\n'I copy column A from another sheet in order to restore values erased with .removeduplicates\n'I've tried to remove duplicates from the Array itself but I kept getting errors so I've decided to go with this workaround\nws2.Range(\"A2\", ws2.Range(\"A2\").End(xlDown)).Copy Destination:=ws.Cells(2, 1)\n\n\nFor Each element In MyArray\n    ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = element\nNext element\n\n' Below part works well but only for the number of rows equal to number of elements in the array ~15\n\nFor i = 2 To FinalRow\n    For Each element In MyArray\n\n        If element = ws.Cells(i, 1).Value Then\n\n        ws.Cells(i, 1).Copy Destination:=wb.Worksheets(element).Cells(i, 1)\n\n        End If\n\n  Next element\n\nNext i\n\nws.Activate\n\nEnd Sub\n</code></pre>\n\n<p>Everything seems to work fine but only for the number of rows equal to number of elements in the array.\nI think that there is something wrong with the logic in the loop but I can't see what.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523443574, "post_id": 49772962, "comment_id": 86560881, "body": "I&#39;m getting an error &#39;13&quot; type mismatch for part  If Target.Address = Sheets(1).Cells(Target.Row, 5).Address _        And Target.Value &lt;&gt; &quot;&quot; _        And Target.Value &lt;&gt; Sheets(1).Cells(Target.Row, 6).Value Then"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523443714, "post_id": 49772962, "comment_id": 86561015, "body": "Write <code>MsgBox Target.Value</code> before this line. What is on the MsgBox? Is it an error?"}, {"owner": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523444605, "post_id": 49772962, "comment_id": 86561581, "body": "Yes it&#39;s an error msg. showing that value of 5 is not equal to 6"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523444671, "post_id": 49772962, "comment_id": 86561623, "body": "@ADRSAL - then try to capture the error and to avoid the if condition. See the update."}, {"owner": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523445136, "post_id": 49772962, "comment_id": 86561930, "body": "I&#39;m not really understanding what you&#39;re trying to do. but I tried your code and it&#39;s still giving me the same error"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523445218, "post_id": 49772962, "comment_id": 86562002, "body": "@ADRSAL - what is the value of <code>Target</code> when you enter the <code>Macro2</code> sub? I have added a <code>IsError</code> check, in case that it is a <code>!Div&#47;0</code> error or similar."}, {"owner": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523446756, "post_id": 49772962, "comment_id": 86563017, "body": "ahh that&#39;s why. the value of F is #N/A before a value is inputted in column D. and it&#39;s giving the error before I input anything in D."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523446997, "post_id": 49772962, "comment_id": 86563185, "body": "@ADRSAL - exactly. Errors cannot be compared and there is a need to  &quot;capture&quot; them."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "edited": false, "score": 0, "creation_date": 1523450671, "post_id": 49772962, "comment_id": 86565815, "body": "@ADRSAL - <a href=\"https://stackoverflow.com/help/someone-answers\">consider marking the answer as accepted.</a> You can also mark an answer as accepted on this question - <a href=\"https://stackoverflow.com/questions/49532778/msgbox-for-a-range-of-cells\" title=\"msgbox for a range of cells\">stackoverflow.com/questions/49532778/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1523446956, "last_edit_date": 1523446956, "creation_date": 1523443294, "answer_id": 49772962, "question_id": 49772898, "link": "https://stackoverflow.com/questions/49772898/calling-a-macro-from-another/49772962#49772962", "title": "Calling a macro from another", "body": "<p>If the second one is the problem, then pass the <code>Target</code> to it:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.EnableEvents = False                    '&lt;--- Consider removing this line\n    If Target.Address = Cells(Target.Row, 5).Address _\n       And Target.Value &lt;&gt; \"\" _\n       And Cells(Target.Row, 4).Value = \"\" Then\n\n        MsgBox \"Input value in column D\"\n        Cells(Target.Row, 4).Select\n        Target.Clear    \n    End If    \n\n    Macro2 Target        \n    Application.EnableEvents = True                      '&lt;--- Consider removing this line\nEnd Sub\n\nSub Macro2(Target As Range)\n\n    If IsError(Target) Then\n        MsgBox Target.Address &amp; \"is an error!\"\n    ElseIf IsError(Sheets(1).Cells(Target.Row, 6)) Then\n        MsgBox Sheets(1).Cells(Target.Row, 6).Address &amp; \" is an error!\"\n    ElseIf Target.Address = Sheets(1).Cells(Target.Row, 5).Address _\n           And Target.Value &lt;&gt; \"\" _\n           And Target.Value &lt;&gt; Sheets(1).Cells(Target.Row, 6).Value Then\n        MsgBox \"E and F don't match\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>However, it could be that <code>Target.Clear</code> is making a loop within the <code>Worksheet_Change</code>, because it changes the worksheet once again. Depending on whether this is ok or not ok, you may consider writing <code>Application.EnableEvents = False</code> and <code>Application.EnableEvents = True</code> at the start or at the end of the <code>Sub</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 9455311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0f6ab0adbaadfb31b50d871c3042a7?s=128&d=identicon&r=PG&f=1", "display_name": "ADRSAL", "link": "https://stackoverflow.com/users/9455311/adrsal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 49772962, "answer_count": 1, "score": 1, "last_activity_date": 1523446956, "creation_date": 1523443098, "last_edit_date": 1523445592, "question_id": 49772898, "link": "https://stackoverflow.com/questions/49772898/calling-a-macro-from-another", "title": "Calling a macro from another", "body": "<p>I running a macro that pops up a message if the user inputs a value in column E having column D empty. therefore the user has to input value in D and then in E. once the user inputs a value in D, by Vlookup formula the sheet will display a number in column F. \nThe second macro should then check if value of column F is not equal to value input in column E, if not equal popup a message.\nFirst part is working but not the second. any idea please. thanks</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = Cells(Target.Row, 5).Address And Target.Value &lt;&gt; \"\" And Cells(Target.Row, 4).Value = \"\" Then\n\n       MsgBox \"Input value in column D\"\n       Cells(Target.Row, 4).Select\n       Target.Clear        \n    End If        \nCall Macro2\n\nEnd Sub\n\nSub Macro2()\n\n   If Target.Address = Sheets(1).Cells(Target.Row, 5).Address And Target.Value &lt;&gt; \"\" And Target.Value &lt;&gt; Sheets(1).Cells(Target.Row, 6).Value Then\n    MsgBox \"E and F don't match\"\n\n   End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1523442330, "post_id": 49772596, "comment_id": 86560071, "body": "what&#39;s the value of <code>iRow</code> at error. <code>Cells(0, 4).EntireRow.Delete</code> will throw 1004."}, {"owner": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1523443456, "post_id": 49772596, "comment_id": 86560784, "body": "5511 which is the first line the IF statement is true for. There are c122k rows in total"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "edited": false, "score": 0, "creation_date": 1523443522, "post_id": 49772828, "comment_id": 86560837, "body": "But the code ran fine previously. Plus, even though there are c122k rows in total, there are probably only about 100 that need deleting. I have let this run for about 10 minutes without it responding."}, {"owner": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "edited": false, "score": 0, "creation_date": 1523443547, "post_id": 49772828, "comment_id": 86560852, "body": "I will try your suggestion though where do I need to paste your code?"}, {"owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "reply_to_user": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "edited": false, "score": 0, "creation_date": 1523443911, "post_id": 49772828, "comment_id": 86561133, "body": "in main loop. statusbar is that text in bottom left corner. DoEvents refreshes Whole Excel."}, {"owner": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "edited": false, "score": 0, "creation_date": 1523444817, "post_id": 49772828, "comment_id": 86561733, "body": "Yes you are correct, the code is running but it is painfully slow!!!It runs fine until it hits the first row to be deleted and then it never really recovers, just runs slow for the rest of the run time. I will take your advice and just mark each row to be deleted and then sort and delete them at the end. Thx bro."}, {"owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "reply_to_user": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "edited": false, "score": 0, "creation_date": 1523445482, "post_id": 49772828, "comment_id": 86562191, "body": "probably there is some bug in deleting rows/columns, but it is hard to isolate it. good luck."}], "tags": [], "owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "is_accepted": true, "score": 1, "last_activity_date": 1523442927, "creation_date": 1523442927, "answer_id": 49772828, "question_id": 49772596, "link": "https://stackoverflow.com/questions/49772596/inconsistent-runtime-error-1004-delete-method-of-range-class-failed/49772828#49772828", "title": "Inconsistent Runtime error &#39;1004&#39; - Delete method of range class failed", "body": "<p>Unresponsive doesn't mean that Excel crashed. Deleting rows one by one is just painfully slow.</p>\n\n<p>You can use</p>\n\n<pre><code>application.statusbar=cstr(iRow)\nDoEvents\n</code></pre>\n\n<p>to see your progress and keep Excel responsive.</p>\n\n<p>If it will work to slow, I recommend you to set some value in rows to delete, sort by that value and then delete them all together.</p>\n"}], "owner": {"reputation": 111, "user_id": 3691092, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fea2ade524eb145b286f97f1e0057171?s=128&d=identicon&r=PG&f=1", "display_name": "Braide", "link": "https://stackoverflow.com/users/3691092/braide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 0, "accepted_answer_id": 49772828, "answer_count": 1, "score": 1, "last_activity_date": 1523442927, "creation_date": 1523442200, "last_edit_date": 1531164843, "question_id": 49772596, "link": "https://stackoverflow.com/questions/49772596/inconsistent-runtime-error-1004-delete-method-of-range-class-failed", "title": "Inconsistent Runtime error &#39;1004&#39; - Delete method of range class failed", "body": "<p>I have written some VBA in excel to iterate a relatively large set of data in order to perform some basic formatting and tidying up. The code previously worked and still works when I use a break point and step through it. However, when i don't step through it and just let the code run by itself, the spreadsheet becomes unresponsive. Once I've pressed escape a few times I get the runtime 1004 error (see title) and the relevant line is hightlighted. </p>\n\n<p>I'd like to reiterate that when i set a break point on the offending line and step through it, it works fine and the row is deleted as appropriate. Also when I test the syntax in a much smaller data set it works perfectly so this is not syntax related.</p>\n\n<p>Any help will be greatly appreciated because I'm stumped. Here is the code:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nDim index As Integer, lapsedSchemes As New Collection, lapseDates As New \nCollection\nDim iRow As Long\nDim iCol As Integer\n\nSheet1.Columns(5).NumberFormat = \"dd-mmm-yy\"                   \nSheet1.Columns(14).NumberFormat = \"dd-mmm-yy\"                   \n\niRow = 2\n\nDo While Sheet3.Cells(iRow, 1).Value &lt;&gt; \"\"                      \n\n    lapsedSchemes.Add Sheet3.Cells(iRow, 1).Value\n    lapseDates.Add Sheet3.Cells(iRow, 2).Value\n    iRow = iRow + 1\n\nLoop\n\niRow = 2\n\nDo While Cells(iRow, 7).Value &lt;&gt; \"\"                            \n\n    index = 1\n\n    If Cells(iRow, 9).Value = \"\" Then                           \n        If Cells(iRow, 7).Value = Cells(iRow, 8).Value Then\n           Cells(iRow, 9).Value = \"Policy Holder\"\n        Else\n           Cells(iRow, 9).Value = \"Dependant\"\n        End If\n    End If\n\n    For Each scheme In lapsedSchemes                                                    \n\n        If Cells(iRow, 4).Value = scheme And Cells(iRow, 5) = lapseDates(index) Then  \n            Cells(iRow, 4).EntireRow.Delete                                            \n            iRow = iRow - 1\n            Exit For\n        End If\n\n        index = index + 1\n\n    Next scheme\n\n    iRow = iRow + 1\n\nLoop\n\nappendLegacyData (iRow)\nRange(\"A1:AZ10000\").Sort Key1:=Range(\"A1\"), Order1:=xlAscending, Key2:=Range(\"D1\"), Order2:=xlAscending, Key3:=Range(\"E1\"), Order3:=xlAscending, Header:=xlYes\n\nEnd Sub\n</code></pre>\n\n<p>The offending line is:</p>\n\n<pre><code>Cells(iRow, 4).EntireRow.Delete \n</code></pre>\n\n<p>The sheet becomes unresponsive and only when I press escape a few times does the runtime error show.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523442794, "post_id": 49772400, "comment_id": 86560372, "body": "This looks like 4 separate questions, or at least more than one? I would keep each post to a single question. In your first one, &#39;LastRow` is defined in terms of column A - perhaps that is the issue. Why are not just applying a format?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523447920, "post_id": 49772400, "comment_id": 86563831, "body": "@SJR my apologies, I have updated the post and removed the second part of the question. I will try not do so again in the future. :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523448131, "post_id": 49772400, "comment_id": 86563977, "body": "@SJR with regards to your second question, some of the fields in column B are mm-dd-yyyy and some are yyyy-mm-dd, but I want them all to be dd-mm-yyyy."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1523448195, "post_id": 49772400, "comment_id": 86564022, "body": "OK, thanks. Please see @Zac&#39;s answer, though that may need some revision in light of this information."}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523448357, "post_id": 49774301, "comment_id": 86564127, "body": "Thank you for this code and your comments, I appreciate it. The code is working except there is one issue, I mentioned in a reply to SJR above, some of the fields in column B are mm-dd-yyyy and some are yyyy-mm-dd, but I want them all to be dd-mm-yyyy. After your filter is applied, there are still fields in the yyyy-mm-dd format showing."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523449821, "post_id": 49774301, "comment_id": 86565166, "body": "Hmmm, bizarre, it works for me. Can you provide a sample of your sheet in your question?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523449911, "post_id": 49774301, "comment_id": 86565223, "body": "I see that there are some fields that show as general number only as well. This is also why I needed to apply the date format. I will upload a sample shortly."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523450447, "post_id": 49774301, "comment_id": 86565625, "body": "I dont know what to say @Zac, I just tried it now again and it worked 100%. So I suppose this has been solved! Thank you for your help :)"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523450698, "post_id": 49774301, "comment_id": 86565839, "body": "No problems, glad it helped"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523453251, "post_id": 49774301, "comment_id": 86567838, "body": "I tried the macro on a different sheet and the cells that have yyyy-mm-dd are not changed to dd-mm-yyyy"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523454640, "post_id": 49774301, "comment_id": 86568910, "body": "Did you remember to change the name of the sheet in the sub?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523456288, "post_id": 49774301, "comment_id": 86570129, "body": "Yes @Zac, I did. There&#39;s two dates I can immediately see that do not change in my data - 2016-10-11 (line 42) and 2017-05-26 (line 94). What happens is that the filter &quot;hides&quot; these lines."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523456868, "post_id": 49774301, "comment_id": 86570552, "body": "Format is changed before filter is applied.. confused. As per before, if you can provide a sample of your sheet, I can then test with your data"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523457028, "post_id": 49774301, "comment_id": 86570684, "body": "I know this is going to sound rather dumb, but I cant seem to figure out how to upload an attachment to my question.. I have the sample book ready for you but I cant find the upload button..."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523457236, "post_id": 49774301, "comment_id": 86570860, "body": "That&#39;s definitely not dumb because I don&#39;t know the answer to that either as I haven&#39;t asked a question here in soo long (well I did ask a question the other day but never had to upload files). Might be worth asking SJR maybe? :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523457751, "post_id": 49774301, "comment_id": 86571243, "body": "So a quick Google search revealed that you cannot directly upload a file. You need to upload it to a cloud service and then provide the link to the file.. Ill do that quickly."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1523521109, "post_id": 49774301, "comment_id": 86597400, "body": "Apologies im only replying now. I managed to get the code working by combining your code and the code from my actual post. I used the For Each loop from my code inside your with block and removed your first line of code inside the with block and it does the trick :)"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": true, "score": 2, "last_activity_date": 1523447168, "creation_date": 1523447168, "answer_id": 49774301, "question_id": 49772400, "link": "https://stackoverflow.com/questions/49772400/vba-assigning-date-format-to-column-and-apply-date-filter/49774301#49774301", "title": "VBA - Assigning Date Format to Column and Apply Date Filter", "body": "<p>As @SJR suggested, you have too many questions in one post so I will only look at the first macro. To get a resolution for your second macro, please start a new thread<br></p>\n\n<p>Below code should achieve your requirements for first macro with some comments to help you understand the code</p>\n\n<pre><code>Sub DateFilter()\n\n    Dim oWS As Worksheet: Set oWS = ThisWorkbook.Worksheets(\"Sheet\")\n\n    ' On Error Resume Next      VERY very bad idea as this will hide all issues in the code!\n\n    With oWS\n\n        ' Set the range format to specified date format. This will automatically update\n        ' the values in the cells to a date.. no need to copy and paste them\n        .Range(\"B2:B\" &amp; .Cells(.Rows.count, 2).End(xlUp).Row).NumberFormat = \"dd-mm-yyyy\"\n\n        ' Set the autofilter to display all dates other than yesterdays\n        .Range(\"B:B\").AutoFilter Field:=1, Criteria1:=\"&lt;\" &amp; CLng(DateAdd(\"d\", -1, Date)), Operator:=xlOr, Criteria2:=\"&gt;\" &amp; CLng(DateAdd(\"d\", -1, Date))\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 49774301, "answer_count": 1, "score": 0, "last_activity_date": 1523448475, "creation_date": 1523441696, "last_edit_date": 1523448475, "question_id": 49772400, "link": "https://stackoverflow.com/questions/49772400/vba-assigning-date-format-to-column-and-apply-date-filter", "title": "VBA - Assigning Date Format to Column and Apply Date Filter", "body": "<p>I have the two Macro's which filters a worksheet column by date and then delete's the irrelevant columns. </p>\n\n<p>However, it is very buggy and I need some help to correct that please.</p>\n\n<p>This is what is supposed to happen with the first Macro:</p>\n\n<p>1) <strong>Format column B from row 2 down to the last row in date format dd-mm-yyyy</strong> - Currently this does not happen, and at some point it was applying the format to the ENTIRE column B, including the empty cells after the data</p>\n\n<p>2) <strong>Apply the filter on column B (date) to display all records except the day prior to the current day</strong> - It's half correct, because it's not including the current day in the filter. When I run the \"delete\" Macro, the cells that are displayed are the current day and the previous day, I should only see the previous day.</p>\n\n<pre><code>Sub DateFilter()\n\nDim ws1 As Worksheet\nDim c As Range\nDim LastRow As Long\nDim Current_Date As Date\n\nOn Error Resume Next\n\nSet ws1 = ActiveWorkbook.Sheets(\"Sheet\")\n\nLastRow = ws1.Cells(Rows.Count, 1).End(xlUp).Row\n\nWith ws1\n\n    For Each c In ActiveSheet.Range(\"B2:B\" &amp; LastRow).Cells\n\n        Current_Date = CDate(c)\n        c.Value = Current_Date\n\n    Next c\n\nEnd With\n\nx = CLng(Date)\nws1.UsedRange.AutoFilter Field:=2, Criteria1:=\"&lt;\" &amp; x, Operator:=xlAnd, Criteria2:=\"&lt;\" &amp; x - 1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1523440797, "post_id": 49771989, "comment_id": 86559042, "body": "<a href=\"https://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s1/outlook/bmail2.htm</a>"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1523442028, "post_id": 49771989, "comment_id": 86559868, "body": "@cyboashu Thanks for your input! However, I have already read that webpage. As i mentioned in my post, I would really like to achieve this without having to create or delete files. Is this simply just impossible? :)"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1523442142, "post_id": 49771989, "comment_id": 86559945, "body": "not impossible but too cumbersome. You will need to loop through your range&#39;s rows and then inside each row loop through cells and then create your own HTML for table."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1523443462, "post_id": 49771989, "comment_id": 86560789, "body": "<code>ThisWorkbook.Path</code> returns the name of the folder containing the workbook containing the macro being executed.  Using that folder will always work no matter how often they move the workbook or change the file structure."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1523443980, "post_id": 49771989, "comment_id": 86561174, "body": "<code>&quot;Hello World&quot;</code> is not Html although most browsers would display it correctly.  <code>&lt;html&gt;&lt;body&gt;Hello World&lt;&#47;body&gt;&lt;&#47;html&gt;</code> is a minimal Html string.  Do you need to learn Html and Css as well?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1523444008, "post_id": 49771989, "comment_id": 86561196, "body": "Have a look at this question: VBA Excel to Outlook font formatting. The OP for that question was happy with Ron de Bruin&#39;s solution. My answer introduces an approach closer to what you are requesting."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1523449054, "post_id": 49771989, "comment_id": 86564578, "body": "IF you want to send your table by e-mail, why don&#39;t you use the object <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-mailenvelope-property-excel\" rel=\"nofollow noreferrer\">ActiveSheet.MailEnvelope</a> and properties such as <code>ActiveSheet.MailEnvelope.Introduction, ActiveSheet.MailEnvelope.Item.To, ActiveSheet.MailEnvelope.Item.Subject...</code> and so on? It&#39;s much easier indeed."}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1523515695, "post_id": 49771989, "comment_id": 86594394, "body": "@TonyDallimore Thank you for the help. Using <code>ThisWorkbook.Path</code> is clever. For this task i don&#39;t need to learn HTML, but at some point i should learn it. I saw your answer on the thread you referred to and it could indeed work. However @FoxfireAndBurnsAndBurns you&#39;re completely right. The following code solved my problem satisfyingly:  <code>Sub Envelope()     Range(&quot;table&quot;).Select      ActiveWorkbook.EnvelopeVisible = True  With ActiveSheet.MailEnvelope       .Introduction = &quot;&quot;       .Item.To = &quot;&quot;       .Item.Subject = &quot;&quot;       .Item.Send End With     End Sub</code>"}], "answers": [{"comments": [{"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "edited": false, "score": 0, "creation_date": 1523514567, "post_id": 49786721, "comment_id": 86593786, "body": "Interesting approach. I couldn&#39;t find an easy way to paste the picture into the email body without creating at temporary file. Is it impossible?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "edited": false, "score": 0, "creation_date": 1523518740, "post_id": 49786721, "comment_id": 86596086, "body": "@JoeBerg look at this link <a href=\"https://stackoverflow.com/a/48897439/4539709\">stackoverflow.com/a/48897439/4539709</a>"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "edited": false, "score": 1, "creation_date": 1523537654, "post_id": 49786721, "comment_id": 86608599, "body": "This worked perfectly - thank you! To recap for others: This creates a picture of the desired range in Excel and then pastes it into the body of the email in Outlook."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1523497396, "creation_date": 1523497396, "answer_id": 49786721, "question_id": 49771989, "link": "https://stackoverflow.com/questions/49771989/sending-dynamic-excel-table-in-outlook-email/49786721#49786721", "title": "Sending dynamic Excel table in Outlook email", "body": "<p><em>To Copy From Column A2: to Column D/or Column 4 last used range, Example would be</em></p>\n\n<blockquote>\n<pre><code>With ThisWorkbook.Worksheets(\"Sheet1\")    \n    Dim rng As Range\n    Set rng = .Range(\"$A$2:\" &amp; .Cells( _\n                       .Rows.Count, 4) _\n                       .End(xlUp).Address)\n    Debug.Print rng.Address ' Print on immediate Window\n    rng.CopyPicture Appearance:=xlScreen, Format:=xlPicture\nEnd With\n</code></pre>\n  \n  <hr>\n  \n  <p><strong><em><a href=\"https://stackoverflow.com/a/48897439/4539709\">See Copy Excel range as Picture to Outlook</a></em></strong></p>\n</blockquote>\n"}], "owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2212, "favorite_count": 0, "accepted_answer_id": 49786721, "answer_count": 1, "score": 1, "last_activity_date": 1593004476, "creation_date": 1523440543, "last_edit_date": 1593004476, "question_id": 49771989, "link": "https://stackoverflow.com/questions/49771989/sending-dynamic-excel-table-in-outlook-email", "title": "Sending dynamic Excel table in Outlook email", "body": "<p>I'm trying to, in Excel 2016, send an email in Outlook 2016 with a table in the email body.<br>\nI've researched Stack Overflow as well as other websites. I find the HTML part confusing.</p>\n\n<p>Below is the code I've written, to send an email. The code works, but I need to replace the <code>.HTMLBody = \"Hello World\"</code> with a table.</p>\n\n<pre><code>Sub Send_mail()\n\nDim outlookApp As Outlook.Application\nDim outlookMail As Outlook.MailItem\n\nSet outlookApp = New Outlook.Application\nSet outlookMail = outlookApp.CreateItem(olMailItem)\n\nWith outlookMail\n    .To = \"recipient@mail.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"TEST123\"\n    .BodyFormat = olFormatHTML\n    .HTMLBody = \"Hello World\"\n    .Send\nEnd With\n\nSet outlookMail = Nothing\nSet outlookApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The table to insert in the body of the email consists of columns A, B, C and D.<br>\nThe data always begin on row 2 but the row containing the last data needs to be dynamic.<br>\nThe table will always be fairly small - max 20 rows ish.</p>\n\n<p>I imagine the following might do the trick?<br>\nLocating the last populated row then looping to go through each row between 2 and the last populated row and convert it into HTML format and storing that as a string.  Then concatenate those strings into one final string to put in the body of the email.</p>\n\n<p>I've looked at Ron de Bruin's guides, but I would like to achieve this without having to create a temporary file or use non-Microsoft tools. The macro will have several users from a professional company, and needs to be bulletproof. I fear that saving temporary files and deleting them could result in horrible mistakes if the company's shared-folder structure is changed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 1, "creation_date": 1523439257, "post_id": 49771353, "comment_id": 86557902, "body": "See if you can replicate the error with only that line of code, and then remove elements from the line until you isolate where the error is (e.g. which side of the <code>and</code>, then which method on that side etc)"}, {"owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1523439765, "post_id": 49771353, "comment_id": 86558271, "body": "I tried Gare2, Gare3, App1 and App3 and all four give the right result. The problem seems to be when a &quot;Non&quot; is linked to App, which isn&#39;t a problem for &quot;Gare&quot;. I&#39;m guessing it is because it is trying to look for &quot;App&quot; in the &quot;Gare&quot; sheet, leading to a runtime error. Is there any other way of fixing it other that writing to &quot;if&quot; statements ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1523440045, "post_id": 49771353, "comment_id": 86558460, "body": "Just a note, but I suggest: Instead of <code>Sheets(&quot;Distancier&quot;).Range(&quot;A1:AAA20000&quot;).Cells(1, j)</code> use <code>Sheets(&quot;Distancier&quot;).Cells(1, j)</code> \u2022 And what is the exact error message?"}, {"owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "edited": false, "score": 0, "creation_date": 1523440450, "post_id": 49771353, "comment_id": 86558761, "body": "I&#39;ll change that, will make the code easier to read thanks ! The error is : Error 1004 &quot;Application-defined or Object-defined error&quot;"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1523440582, "post_id": 49771353, "comment_id": 86558862, "body": "@Doule so if the extra lines of the code are irrelevant to the problem, remove them from the question i.e. the M of <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> (but do test the the reduce code still produces the error). Also if you want to make it easier to read, store <code>Sheets(&quot;Distancier&quot;)</code> in a variable."}, {"owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "edited": false, "score": 0, "creation_date": 1523440859, "post_id": 49771353, "comment_id": 86559084, "body": "Removed the first two. This still gives the error. Since it is going to look for &quot;app&quot; in a sheet where there is no mention of &quot;app&quot;, vlookup returns #N/A which produces the runtime error. Should I just seperate the two conditions i have in my if statement or is there an elegant way around #N/A ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1523446480, "post_id": 49771353, "comment_id": 86562843, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18063214/how-to-error-handle-1004-error-with-worksheetfunction-vlookup\">How to error handle 1004 Error with WorksheetFunction.VLookup?</a>"}, {"owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "edited": false, "score": 0, "creation_date": 1523448238, "post_id": 49771353, "comment_id": 86564053, "body": "I thought about adding an errorhandler but &quot;resume next&quot; would mean that is still enter the If statement. I guess the easiest way here might just be to split the if statement into two seperate if&#39;s."}], "owner": {"reputation": 57, "user_id": 4497888, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b4f300f8e6adb46a4903fecafdeeed91?s=128&d=identicon&r=PG&f=1", "display_name": "Doule", "link": "https://stackoverflow.com/users/4497888/doule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523440662, "creation_date": 1523438786, "last_edit_date": 1531164843, "question_id": 49771353, "link": "https://stackoverflow.com/questions/49771353/vba-elseif-statement-leading-to-a-runtime-error", "title": "VBA Elseif statement leading to a runtime error", "body": "<p>When I try to run my code, I get a runtime error (1004) when running line 7 (2d Elseif)</p>\n\n<pre><code>If InStr(1, Sheets(\"Distancier\").Range(\"A1:AAA20000\").Cells(i, 1), \"Car\", vbTextCompare) &gt; 0 Then 'si le lieu est une source alors on cherche ses coordonn\u00e9es dans l'onglet source\n    startv = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:AAA20000\").Cells(i, 1).Text, Sheets(\"Sources\").Range(\"A2:AAA2000\"), 5, True)\n\n        If (InStr(1, Sheets(\"Distancier\").Range(\"A1:AAA20000\").Cells(1, j), \"Gare\", vbTextCompare) &gt; 0 And WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:AAA20000\").Cells(1, j).Text, Sheets(\"Embranchements ferroviaires\").Range(\"A2:AAA2000\"), 6, True) = \"Oui\") Then\n                    endv = WorksheetFunction.VLookup(Sheets(\"Distancier\").Range(\"A1:AAA20000\").Cells(1, j).Text, Sheets(\"Embranchements ferroviaires\").Range(\"A2:AAA2000\"), 5, True)\n\n        Else:\n                    startv = vbNullString\n                    endv = vbNullString\n\n        End If\nEnd If\n</code></pre>\n\n<p>The text value that gives me a runtime error is \"App2\", which is linked to a \"Non\" in its sheet (as opposed to the \"Oui\" that is one of the conditions I am testing). I don't understand why it doesn't work since none of the conidtions are met, it should just move on to Else:.</p>\n\n<p>Any clues ?</p>\n\n<p>Thanks,\nDoule</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1523439477, "post_id": 49771205, "comment_id": 86558069, "body": "<code>ctrl.Parent.Name</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1523442538, "last_edit_date": 1523442538, "creation_date": 1523439568, "answer_id": 49771644, "question_id": 49771205, "link": "https://stackoverflow.com/questions/49771205/find-the-frame-name-that-a-userform-control-resides-in/49771644#49771644", "title": "Find the frame name that a Userform.control resides in", "body": "<p>In general, the <code>ctrl.Parent.Name</code> works quite ok on a <code>UserForm</code>, however if the controls are on a worksheet like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WspY2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WspY2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or like ActiveX elements:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0Ub6X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0Ub6X.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then the <code>Parent</code> of the shape refers to the worksheet name and you have to solve the <strong><em>coordinate system</em></strong> problem:</p>\n\n<pre><code>Sub TestMe()\n    Dim shp As Shape\n    For Each shp In ActiveSheet.Shapes\n       Debug.Print shp.Name\n       Debug.Print shp.Parent.Name\n    Next shp\nEnd Sub\n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>Frame\nSheet1\nButton 4\nSheet1\n</code></pre>\n\n<hr>\n\n<p>In programming schools, there are plenty of problems such as \"<strong><em>Define whether two squares in the coordinate system overlap each other</em></strong>\" </p>\n\n<p>Every checkbox and every frame has the following 4 properties:</p>\n\n<ul>\n<li>Top</li>\n<li>Left</li>\n<li>Width</li>\n<li>Heigth</li>\n</ul>\n\n<p>Knowing these, you could generate the Bottom and the Right positions:</p>\n\n<ul>\n<li>Bottom = Top + Height</li>\n<li>Right = Left + Width </li>\n</ul>\n\n<p>Once knowing these, they overlap if the following condition is <code>TRUE</code>:</p>\n\n<pre><code>if (Frame.Left &lt; Checkbox.Right &amp;&amp; Frame.Right &gt; Checkbox.Left &amp;&amp;\n     Frame.Top &gt; Checkbox.Bottom &amp;&amp; Frame.Bottom &lt; Checkbox.Top ) \n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/306316/determine-if-two-rectangles-overlap-each-other\">Determine if two rectangles overlap each other?</a></p>\n"}, {"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 2, "last_activity_date": 1523439850, "creation_date": 1523439850, "answer_id": 49771731, "question_id": 49771205, "link": "https://stackoverflow.com/questions/49771205/find-the-frame-name-that-a-userform-control-resides-in/49771731#49771731", "title": "Find the frame name that a Userform.control resides in", "body": "<p>Just use the Parent name.\n<code>ctrl.Parent.Name</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/O2Evf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O2Evf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1902, "favorite_count": 0, "accepted_answer_id": 49771731, "answer_count": 2, "score": 1, "last_activity_date": 1523442538, "creation_date": 1523438344, "question_id": 49771205, "link": "https://stackoverflow.com/questions/49771205/find-the-frame-name-that-a-userform-control-resides-in", "title": "Find the frame name that a Userform.control resides in", "body": "<p>I have a Excel VBA Userform with two frames (Frame1 and Frame2) that I populate with a lot of Checkboxes depending on the amount of data when the form loads:</p>\n\n<p>The interested code is:</p>\n\n<pre><code>Private Sub enterNewTextbox(number As Long, nameAdd As String, side As String)\n    Dim boxTop As Long\n    Dim a As Long\n    Dim nameCB As String\n    Dim checkBox As Control\n    boxTop = 10 + (number * 18) - 18\n    nameCB = side &amp; number &amp; \"CB\"\n    If side = \"Left\" Then\n        Set checkBox = Frame1.Controls.Add(\"Forms.CheckBox.1\", nameCB)\n    Else\n        Set checkBox = Frame2.Controls.Add(\"Forms.CheckBox.1\", nameCB)\n    End If\n    With checkBox\n        .Value = False\n        .Top = boxTop\n        .Left = 12\n        .Width = 190\n        .Name = nameCB\n        .Caption = nameAdd\n    End With\nEnd Sub\n</code></pre>\n\n<p>Now I would like to loop through all the controls again and get all the controls that was added to the left frame - something like this:</p>\n\n<pre><code>For Each ctrl In Me.Controls\nIf TypeName(ctrl) = \"Checkbox\" Then\n   If **{find the name of the frame that the Checkbox is in}** = \"Frame1\" Then\n       'Be awesome here\n   End If\nEnd If\n</code></pre>\n\n<p>But when I look in the Properties of the control I don't find any field to query that shows me what frame it is in.</p>\n"}, {"tags": ["sql", "sql-server", "excel", "pivot", "vba"], "comments": [{"owner": {"reputation": 16954, "user_id": 307138, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6bc245ebc908699a0cd9fbdc2e598ba3?s=128&d=identicon&r=PG", "display_name": "Ocaso Protal", "link": "https://stackoverflow.com/users/307138/ocaso-protal"}, "edited": false, "score": 0, "creation_date": 1523437352, "post_id": 49770800, "comment_id": 86556540, "body": "What error do you get? Might be because of <a href=\"https://stackoverflow.com/questions/8370114/referring-to-a-column-alias-in-a-where-clause\" title=\"referring to a column alias in a where clause\">stackoverflow.com/questions/8370114/&hellip;</a>?"}, {"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1523437515, "post_id": 49770800, "comment_id": 86556657, "body": "I&#39;d recommend trying to parametrise your SQL as well. I don&#39;t know where the value of <code>CodeFC</code> is coming from, but you could be opening yourself up for injection."}, {"owner": {"reputation": 362, "user_id": 6848370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f95c007c9aae09f758853b380f48666?s=128&d=identicon&r=PG&f=1", "display_name": "Proger_Cbsk", "link": "https://stackoverflow.com/users/6848370/proger-cbsk"}, "reply_to_user": {"reputation": 16954, "user_id": 307138, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6bc245ebc908699a0cd9fbdc2e598ba3?s=128&d=identicon&r=PG", "display_name": "Ocaso Protal", "link": "https://stackoverflow.com/users/307138/ocaso-protal"}, "edited": false, "score": 0, "creation_date": 1523445554, "post_id": 49770800, "comment_id": 86562243, "body": "@Ocaso The error is in the <code>JOIN</code> part of the statement, I use a wrong syntax for the wanted values <code>(1,2,3 ...</code> . in mysql i&#39;d use a temporary table or somewhat to do the <code>RIGHT JOIN</code> but i dont know how to do it in the ADO &quot;mssql&quot; language. Maybe if i put also the values in the <code>ON</code> clause it could work..."}], "owner": {"reputation": 362, "user_id": 6848370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f95c007c9aae09f758853b380f48666?s=128&d=identicon&r=PG&f=1", "display_name": "Proger_Cbsk", "link": "https://stackoverflow.com/users/6848370/proger-cbsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1523470332, "creation_date": 1523437131, "last_edit_date": 1531161705, "question_id": 49770800, "link": "https://stackoverflow.com/questions/49770800/force-rows-in-sql-query-with-manual-values", "title": "Force rows in sql query with manual values", "body": "<p>For a report of sales, i'm using mssql TRANSFORM / PIVOT operation through VBA - ADO</p>\n\n<p>I need all monthes and years printed, even if there is no sales at all. First i've this query :</p>\n\n<pre><code>SQLq = \"TRANSFORM SUM([Feuil$].[PRICE]) SELECT [Feuil$].[MONTH] \" &amp; _\n\" FROM [Feuil$]\" &amp; _\n\" WHERE [Feuil$].[CODEFC] = '\" &amp; CodeFC &amp; \"'\" &amp; _\n\" GROUP BY [Feuil$].[MONTH]\" &amp; _\n\" PIVOT [Feuil$].[YEAR] \" &amp; _\n\" IN(2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025)\"\n</code></pre>\n\n<p><strong>This one works</strong> fine, having all years as column, even those with no sales, <strong>but</strong> if I have monthes without sales, i'll end up with missing rows</p>\n\n<p>I tried to force the list of monthes using a <code>JOIN</code> statement but Office report a syntax error :</p>\n\n<pre><code>SQLq = \"TRANSFORM SUM([Feuil$].[PRICE]) SELECT [Feuil$].[MONTH] \" &amp; _\n\" FROM [Feuil$]\" &amp; _\n\" RIGHT JOIN (1,2,3,4,5,6,7,8,9,10,11,12) AS [allmonthes] \" &amp; _\n\" ON ([Feuil$].[MONTH] = [allmonthes])\" &amp; _\n\" WHERE [Feuil$].[CODEFC] = '\" &amp; CodeFC &amp; \"'\" &amp; _\n\" GROUP BY [Feuil$].[MONTH]\" &amp; _\n\" PIVOT [Feuil$].[YEAR] \" &amp; _\n\" IN(2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025)\"\n</code></pre>\n\n<p><strong>This one doesn't work</strong>, reporting an error on <code>JOIN</code></p>\n\n<p>I tried <code>vALUES</code> before the monthes list and other ideas not to avail... How should I change the SQL ? Is there a better idea in order to have all 12 monthes as rows even those without grouped values ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "edited": false, "score": 3, "creation_date": 1523438990, "post_id": 49770791, "comment_id": 86557711, "body": "Show us your &quot;slow&quot; code, please."}, {"owner": {"reputation": 1, "user_id": 9623570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedc508f02770bbff79bf9c30fdbc678?s=128&d=identicon&r=PG&f=1", "display_name": "Duna", "link": "https://stackoverflow.com/users/9623570/duna"}, "reply_to_user": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "edited": false, "score": 0, "creation_date": 1523439635, "post_id": 49770791, "comment_id": 86558182, "body": "If or1 = or2 then or1x = true or2x= true else end if.  and so on and so on."}, {"owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "edited": false, "score": 0, "creation_date": 1523439958, "post_id": 49770791, "comment_id": 86558398, "body": "so where do you use array?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1523440065, "post_id": 49770791, "comment_id": 86558473, "body": "Post your full code properly formatted in your question, not in a comment."}], "answers": [{"tags": [], "owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "is_accepted": false, "score": 0, "last_activity_date": 1523441072, "creation_date": 1523441072, "answer_id": 49772180, "question_id": 49770791, "link": "https://stackoverflow.com/questions/49770791/remove-duplicates-from-list-of-variables-vba/49772180#49772180", "title": "remove duplicates from list of variables VBA", "body": "<p>the most simple and general (not the fastest) way is using dictionary to count elements</p>\n\n<pre><code>set dict=createobject(\"Scripting.Dictionary\")\nfor i=1 to 100\n  dict(Or(i))=dict(Or(i))+1\nnext\nfor i=1 to 100\n  Orx(i)=(dict(Or(i))&gt;1)\nnext\n</code></pre>\n\n<p>(I've assumed, that Or and Orx are arrays.)</p>\n"}], "owner": {"reputation": 1, "user_id": 9623570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedc508f02770bbff79bf9c30fdbc678?s=128&d=identicon&r=PG&f=1", "display_name": "Duna", "link": "https://stackoverflow.com/users/9623570/duna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1523478281, "creation_date": 1523437118, "last_edit_date": 1531164843, "question_id": 49770791, "link": "https://stackoverflow.com/questions/49770791/remove-duplicates-from-list-of-variables-vba", "title": "remove duplicates from list of variables VBA", "body": "<p>I have a list of variables, (longs) </p>\n\n<p>These have the name Or1 to Or100. \nAll these are set by picking a random cell from range in a Excel Spreadsheet. </p>\n\n<p>I also have a boolean for each OR set as Or1x to or100x. This boolean shall be true if there is duplicate values. If Or1 is the same as or67 both or1x and or67x is true. As of now the only way I've figured out how to do this is by an array of if statements. The problem is that this is so long, and slow. Is there any other smart solution here? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523440324, "post_id": 49770767, "comment_id": 86558670, "body": "You are trying to loop opening the same website twice in different tabs of IE? Opening the second only on successful completion of the first?"}, {"owner": {"reputation": 1088, "user_id": 7030758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589a78a91708ead9927e762a7d4f8105?s=128&d=identicon&r=PG&f=1", "display_name": "FloLie", "link": "https://stackoverflow.com/users/7030758/flolie"}, "edited": false, "score": 0, "creation_date": 1523441075, "post_id": 49770767, "comment_id": 86559245, "body": "This should help <a href=\"https://stackoverflow.com/questions/19933313/vba-internet-explorer-wait-for-web-page-to-load?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\" title=\"vba internet explorer wait for web page to load\">stackoverflow.com/questions/19933313/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 9413719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Louie Gonzales", "link": "https://stackoverflow.com/users/9413719/john-louie-gonzales"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523441514, "post_id": 49770767, "comment_id": 86559547, "body": "@QHarr not acctually loop, more like condition. I want my code that if I run it on the first time it will open a browser and go to the website, and when i run it for the second time it will use the same IE app to open the same website in a new tab... I&#39;m kinda starting to get this using the &quot;Shell.application&quot; but for some reasons my &quot;Do While is looping infinite&quot;. I cant debug it"}, {"owner": {"reputation": 23, "user_id": 9413719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Louie Gonzales", "link": "https://stackoverflow.com/users/9413719/john-louie-gonzales"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523442817, "post_id": 49770767, "comment_id": 86560390, "body": "@QHarr the code that I&#39;m trying to make is like this in the link <a href=\"https://www.mrexcel.com/forum/excel-questions/553580-vba-macro-already-open-ie-window.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> #4. But for some reasons the .readystate or .busy is doing an infinite loop"}], "answers": [{"tags": [], "owner": {"reputation": 382, "user_id": 6697723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dc05443c714c0d271e7791db5c08829b?s=128&d=identicon&r=PG&f=1", "display_name": "teddy2", "link": "https://stackoverflow.com/users/6697723/teddy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1523441856, "creation_date": 1523441856, "answer_id": 49772465, "question_id": 49770767, "link": "https://stackoverflow.com/questions/49770767/vba-open-a-website-on-new-tab-on-ie-and-wait-for-it-to-load/49772465#49772465", "title": "VBA: open a website on new tab on IE and wait for it to load", "body": "<p>This is how you can open multiple tabs in IE object programatically </p>\n\n<pre><code>Sub Test()\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .Navigate \"https://amazon.com\" '1st tab\n        .Navigate \"https://flipkart.com\", CLng(2048) '2nd\n        .Navigate \"https://snapdeal.com\", CLng(2048) '3rd\n        .Visible = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1336, "user_id": 12078469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agNqa.jpg?s=128&g=1", "display_name": "Kim Tang", "link": "https://stackoverflow.com/users/12078469/kim-tang"}, "edited": false, "score": 0, "creation_date": 1602766440, "post_id": 64355834, "comment_id": 113828071, "body": "While this code may answer the question, it would be better to include some context, explaining how it works and when to use it. Code-only answers are not useful in the long run. <a href=\"https://meta.stackoverflow.com/questions/300837/what-comment-should-i-add-to-code-only-answers\">Reference</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 14449891, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a5c099f7327b23dce7eb0cfa69e75329?s=128&d=identicon&r=PG", "display_name": "user14449891", "link": "https://stackoverflow.com/users/14449891/user14449891"}, "is_accepted": false, "score": 0, "last_activity_date": 1602686685, "creation_date": 1602686685, "answer_id": 64355834, "question_id": 49770767, "link": "https://stackoverflow.com/questions/49770767/vba-open-a-website-on-new-tab-on-ie-and-wait-for-it-to-load/64355834#64355834", "title": "VBA: open a website on new tab on IE and wait for it to load", "body": "<p>This also works</p>\n<pre><code>Sub Test()\nDim IE As Object\n\nSet IE = Nothing\nSet IE = CreateObject(&quot;InternetExplorer.Application&quot;)\nSet cell = Cells(1, 1)\n\nFor i = 1 To 5\nIE.navigate &quot;https://www.google.com/search?q=&quot; &amp; Cells(i, 1) &amp; &quot;&amp;rlz=1C1CHBF_enUS828US828&amp;oq=62654962004&amp;aqs=chrome..69i57j69i59.95j0j4&amp;sourceid=chrome&amp;ie=UTF-8&quot;, CLng(2048)\nIE.Visible = True\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9413719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Louie Gonzales", "link": "https://stackoverflow.com/users/9413719/john-louie-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4532, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1602686685, "creation_date": 1523437052, "last_edit_date": 1531164843, "question_id": 49770767, "link": "https://stackoverflow.com/questions/49770767/vba-open-a-website-on-new-tab-on-ie-and-wait-for-it-to-load", "title": "VBA: open a website on new tab on IE and wait for it to load", "body": "<p>i recently learn to open websites on IE throught VBA excel. Now I'm trying to add code the will check if an active IE is open and if it does, it will open a new tab to navigate the website and do the same thing over again. Unfortunately, I haven't have any luck in doing it. Hoping someone could help me out. Thanks in advanced</p>\n\n<p>this is my code:\n></p>\n\n<pre><code>Sub OpenIE()\nDim IE As Object\nDim site As String\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nsite = \"https://www.automateexcel.com/excel/\"\n\nIE.Visible = True\nIE.navigate site\n\nApplication.StatusBar = site &amp; \" \" &amp; \"is loading\"\n\nDo While IE.readyState = 4: DoEvents: Loop\nDo Until IE.readyState = 4: DoEvents: Loop\n\nApplication.StatusBar = site &amp; \" \" &amp; \"is loaded\"\n\nSet IE = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1523436834, "post_id": 49770634, "comment_id": 86556137, "body": "First of all, you have not searched properly because there is around 50.000 examples doing this just googling for <i>Convert from yy/mm/dd to dd/mm/yyyy</i>. Second, do it manually in Excel while you use the macro recorder, and check the code you have generated. That&#39;s the way to go."}, {"owner": {"reputation": 1858, "user_id": 1945220, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/nbZTM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/1945220/unknown"}, "edited": false, "score": 3, "creation_date": 1523436834, "post_id": 49770634, "comment_id": 86556138, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18668817/how-to-change-mm-dd-yyyy-to-dd-mm-yyyy-using-vba\">How to change mm/dd/yyyy to dd/mm/yyyy using VBA</a>"}, {"owner": {"reputation": 1, "user_id": 9629442, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214504539239208/picture?type=large", "display_name": "Frederik", "link": "https://stackoverflow.com/users/9629442/frederik"}, "edited": false, "score": 0, "creation_date": 1523437104, "post_id": 49770634, "comment_id": 86556352, "body": "Thanks a lot. I will try to use the macro recorder."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 1, "creation_date": 1523437115, "post_id": 49770634, "comment_id": 86556366, "body": "Use <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">Format()</a> function in vba to convert date."}], "owner": {"reputation": 1, "user_id": 9629442, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214504539239208/picture?type=large", "display_name": "Frederik", "link": "https://stackoverflow.com/users/9629442/frederik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523436672, "creation_date": 1523436672, "last_edit_date": 1531161705, "question_id": 49770634, "link": "https://stackoverflow.com/questions/49770634/how-do-i-convert-from-yy-mm-dd-to-dd-mm-yyyy-in-vba-excel", "title": "How do I Convert from yy/mm/dd to dd/mm/yyyy in vba excel?", "body": "<p>First of all, I am not a shark at Excel or VBA. \nI have 18.000 objects in my excel and all of them is in the date format yy/mm/dd. \nMy assignment says, that I have to make a sub/function in Excel, VBA, to convert all of the 18.000 objects into the date format dd/mm/yyyy. \nI have been searching on the internet, but I have not found any answers to this problem. \nSo I would like to hear, if some of you has some guidance or answers for me. :)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1523439669, "last_edit_date": 1523439669, "creation_date": 1523437832, "answer_id": 49771026, "question_id": 49770564, "link": "https://stackoverflow.com/questions/49770564/excel-open-workbook-in-a-new-application-does-not-run-the-workbook-open-event/49771026#49771026", "title": "Excel: Open Workbook in a new application does not run the Workbook_Open event", "body": "<p>Use this</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub OpenXLFileInNewInstance()\n\n    Dim xlApp As Excel.Application, wb As Workbook\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n\n    xlApp.Visible = True\n\n    Set wb = xlApp.Workbooks.Open(\"D:\\Tmp\\xTemplate.xlsm\")\n\n    'wb.Close False\n    'xlApp.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 465, "user_id": 2389488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzxvt.jpg?s=128&g=1", "display_name": "Jortx", "link": "https://stackoverflow.com/users/2389488/jortx"}, "is_accepted": false, "score": 0, "last_activity_date": 1549444925, "last_edit_date": 1549444925, "creation_date": 1523443011, "answer_id": 49772865, "question_id": 49770564, "link": "https://stackoverflow.com/questions/49770564/excel-open-workbook-in-a-new-application-does-not-run-the-workbook-open-event/49772865#49772865", "title": "Excel: Open Workbook in a new application does not run the Workbook_Open event", "body": "<p>Thanks to Paul's answer, I could do some more testing and discovered that the point is to write FIRST the line <strong>myApp.Visible = True</strong> before the line <strong>myApp.Workbooks.Open sFileB</strong>.</p>\n\n<p>So this is the definitive working code:</p>\n\n<pre><code>Set myApp = CreateObject(\"Excel.Application\")\nmyApp.Visible = True\nmyApp.Workbooks.Open sFileB\n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 2389488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzxvt.jpg?s=128&g=1", "display_name": "Jortx", "link": "https://stackoverflow.com/users/2389488/jortx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 49771026, "answer_count": 2, "score": 0, "last_activity_date": 1549444925, "creation_date": 1523436432, "last_edit_date": 1549397575, "question_id": 49770564, "link": "https://stackoverflow.com/questions/49770564/excel-open-workbook-in-a-new-application-does-not-run-the-workbook-open-event", "title": "Excel: Open Workbook in a new application does not run the Workbook_Open event", "body": "<p>From the code of Excel A , I want to open Excel B.</p>\n\n<p>Using this code, the new Excel is open in a new Excel Application, so you have 2 independent Excel windows, BUT! The Workbook_Open code of the sFileB is not executed:</p>\n\n<pre><code>Dim myApp As New Excel.Application\nmyApp.Workbooks.Open sFileB\nmyApp.Visible = True\n</code></pre>\n\n<p>If I open the new Excel inside the same application then I have only 1 Excel windows with the 2 files open, but opening the file in this way the Workbook_Open event is executed correctly:</p>\n\n<pre><code>Workbooks.Open sFileB\n</code></pre>\n\n<p>I want to open the new excel sFileB in a new application and, of course, I want to execute the Workbook_Open code of sFileB.\nDo you know the reason of why in the first case the Workbook_Open is not executed? Any solution to force the execution of the event? Maybe I'm doing something wrong... Thanks for your help!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2134680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/133cc74f8a383b2f60d3f654a893341a?s=128&d=identicon&r=PG", "display_name": "Nyfiken", "link": "https://stackoverflow.com/users/2134680/nyfiken"}, "edited": false, "score": 0, "creation_date": 1523437811, "post_id": 49770513, "comment_id": 86556888, "body": "Same error unfortunately. I have loaded my combobox with 4 columns and in cell A1 I want to write data that exists in both columns 0 and 1. I have understood that the first column is 0? I use LinkedCell in object properties to save my BoundColumn  3 in cell A2."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 33, "user_id": 2134680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/133cc74f8a383b2f60d3f654a893341a?s=128&d=identicon&r=PG", "display_name": "Nyfiken", "link": "https://stackoverflow.com/users/2134680/nyfiken"}, "edited": false, "score": 0, "creation_date": 1523438229, "post_id": 49770513, "comment_id": 86557173, "body": "Oh, of course you need to use the <code>ComboBox1_Click()</code> instead of the <code>ComboBox1_DropButtonClick()</code>. And there is no <code>column(0)</code> it starts with <code>column(1)</code> what you meant to be column <code>0</code> is actually the value <code>ComboBox1.Value</code>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1523438127, "last_edit_date": 1523438127, "creation_date": 1523436304, "answer_id": 49770513, "question_id": 49770362, "link": "https://stackoverflow.com/questions/49770362/columns-in-excel-vba-invalid-matrix-index-for-property/49770513#49770513", "title": "Columns in Excel VBA - Invalid matrix index for property", "body": "<p>Well I think column counting starts with <code>1</code> not <code>0</code>.</p>\n\n<p>So you get the value of the combobox with <code>Me.ComboBox1.Value</code> and the column (right next to the value) with <code>Me.ComboBox1.Column(1)</code>.</p>\n\n<pre><code>Private Sub ComboBox1_Click()\n    Sheet1.Range(\"A1\").Value = Me.ComboBox1.Value &amp; \" \" &amp; Me.ComboBox1.Column(1)\nEnd Sub\n</code></pre>\n\n<p>See here for a tutorial on <a href=\"http://%20http://www.excel-easy.com/vba/examples/multicolumn-combo-box.html\" rel=\"nofollow noreferrer\">Multicolumn Combo Box</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 2134680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/133cc74f8a383b2f60d3f654a893341a?s=128&d=identicon&r=PG", "display_name": "Nyfiken", "link": "https://stackoverflow.com/users/2134680/nyfiken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 49770513, "answer_count": 1, "score": 0, "last_activity_date": 1523438127, "creation_date": 1523435855, "last_edit_date": 1523436336, "question_id": 49770362, "link": "https://stackoverflow.com/questions/49770362/columns-in-excel-vba-invalid-matrix-index-for-property", "title": "Columns in Excel VBA - Invalid matrix index for property", "body": "<p>I'm getting an error when I try to write two columns to cell A1.\nWhat is wrong and how do I solve it?</p>\n\n<pre><code>Private Sub ComboBox1_DropButtonClick()\n\nSheet1.Range(\"A1\").Value = Me.ComboBox1.Column(0) &amp; \" \" &amp; \n\nMe.ComboBox1.Column(1)\n\nEnd Sub\n</code></pre>\n\n<p>Error message</p>\n\n<blockquote>\n  <p>The Column property can not be retrieved. Invalid matrix index for property.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1523436072, "post_id": 49770336, "comment_id": 86555646, "body": "I think you want this <code>row_SOI1 = rFind.Row</code>"}, {"owner": {"reputation": 23, "user_id": 3120346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b13c702cb1264eb67fbd996ee901860?s=128&d=identicon&r=PG&f=1", "display_name": "Goggles998", "link": "https://stackoverflow.com/users/3120346/goggles998"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1523436515, "post_id": 49770336, "comment_id": 86555948, "body": "You are right! Thank you! Good ol\u2019 VBA syntax..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1523436570, "post_id": 49770336, "comment_id": 86555976, "body": "Note: Don&#39;t use <code>Integer</code> for row counting. Excel has more rows than <code>Integer</code> can handle. Always use <code>Long</code> instead of <code>Integer</code> there is <a href=\"https://stackoverflow.com/a/26409520/3219613\">no benefit in using <code>Integer</code> in VBA at all</a>."}], "owner": {"reputation": 23, "user_id": 3120346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b13c702cb1264eb67fbd996ee901860?s=128&d=identicon&r=PG&f=1", "display_name": "Goggles998", "link": "https://stackoverflow.com/users/3120346/goggles998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523435804, "creation_date": 1523435804, "last_edit_date": 1531164843, "question_id": 49770336, "link": "https://stackoverflow.com/questions/49770336/vba-compile-error-wrong-number-of-arguments-or-invalid-property-assignment", "title": "VBA: Compile error, Wrong number of arguments or invalid property assignment - .find", "body": "<p>So I am trying to find the row number of a cell which contains the value \u201cSOI 1\u201d. The message box returns the correct number, but when I try to assign that number to a variable for later use I get the compile error:</p>\n\n<p>\u201cWrong number of arguments or invalid property assignment\u201d</p>\n\n<p>I\u2019m fairly new to VBA, so any help you guys can provide would be amazing!</p>\n\n<pre><code>Public Sub Testing()\n\nDim rFind As Range\nDim row_SOI1 As Integer\n\ntest = \"SOI 1\"\n\nWith Range(\"A1:A100\")\nSet rFind = .Find(What:=\"SOI 1\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\nIf Not rFind Is Nothing Then\n    MsgBox rFind.Row\n    If test = \"SOI 1\" Then:\n        rFind.Row = row_SOI1\n    End If\nEnd If\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007", "ms-access-2013"], "comments": [{"owner": {"reputation": 148, "user_id": 3077926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1OUf.png?s=128&g=1", "display_name": "Calaris", "link": "https://stackoverflow.com/users/3077926/calaris"}, "edited": false, "score": 0, "creation_date": 1523440795, "post_id": 49770239, "comment_id": 86559038, "body": "What is the rowsource for lstAssigned? Because that is what will be refreshed when you perform a requery. Furthermore, you should perform the requery&#39;s only at the end, not after every insert."}, {"owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "reply_to_user": {"reputation": 148, "user_id": 3077926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1OUf.png?s=128&g=1", "display_name": "Calaris", "link": "https://stackoverflow.com/users/3077926/calaris"}, "edited": false, "score": 0, "creation_date": 1523453419, "post_id": 49770239, "comment_id": 86567960, "body": "yeah i had not added the row source, I have one more probrlem that is , i want to add two more column data from the listbox to the table , but both are text values and when i add it to the above it gives an eror"}], "owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523672817, "creation_date": 1523435489, "last_edit_date": 1523672817, "question_id": 49770239, "link": "https://stackoverflow.com/questions/49770239/access-vba-moving-from-one-listbox-to-another", "title": "Access VBA Moving from one listbox to another", "body": "<p>I have a listbox named lstAvailable and i am moving the item selcted from this to another listbox named lstAssigned and also the value that gets sent here is stored in the table tblComponents. The values are storing in the table but i am not able to see the moved item in the listbox lstAssigned. Can someone help me?</p>\n\n<p>The Code is </p>\n\n<pre><code>nRid = listMachineSubSystem.Column(1)\nFor Each varRow In lstAvailable.ItemsSelected\nnEid = lstAvailable.Column(0, varRow)\n    sSQL = \"INSERT INTO tblComponents ([Machine Subsystem ID], [NewComponents])\" _\n    &amp; \" VALUES (\" &amp; nRid &amp; \", \" &amp; nEid &amp; \");\"\n\n    CurrentDb.Execute sSQL, dbFailOnError\n    Next varRow\n    lstAvailable.Requery\n    lstAssigned.Requery\n    For Each varItem In lstAvailable.ItemsSelected\n        lstAvailable.Selected(varItem) = False\n    Next\n    For Each varItem In lstAssigned.ItemsSelected\n        lstAssigned.Selected(varItem) = False\n    Next\n End Sub\n</code></pre>\n"}, {"tags": ["javascript", "html", "vba", "excel"], "comments": [{"owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "edited": false, "score": 0, "creation_date": 1523441938, "post_id": 49770116, "comment_id": 86559810, "body": "It would be better if you share the website url"}, {"owner": {"reputation": 1, "user_id": 9601122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Laure Jacquon", "link": "https://stackoverflow.com/users/9601122/laure-jacquon"}, "reply_to_user": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "edited": false, "score": 0, "creation_date": 1523509675, "post_id": 49770116, "comment_id": 86591725, "body": "I know but its an internal URL, I tried to find similar cases on different website but there is no problem when Im trying to run this macro on them... Could it help if I put more of the HTML code ?"}, {"owner": {"reputation": 1, "user_id": 9601122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Laure Jacquon", "link": "https://stackoverflow.com/users/9601122/laure-jacquon"}, "reply_to_user": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "edited": false, "score": 0, "creation_date": 1524118796, "post_id": 49770116, "comment_id": 86843427, "body": "Anyone would have an idea ? I am really stuck here, been looking around all web to find a solution without success..."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9601122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Laure Jacquon", "link": "https://stackoverflow.com/users/9601122/laure-jacquon"}, "is_accepted": false, "score": 0, "last_activity_date": 1524124904, "creation_date": 1524124904, "answer_id": 49915774, "question_id": 49770116, "link": "https://stackoverflow.com/questions/49770116/impossible-to-trigger-a-javascript-anchor-with-vba/49915774#49915774", "title": "Impossible to trigger a javascript anchor with VBA", "body": "<p>So I tried to change my code to input the text instead of selecting it :</p>\n\n<pre><code>'Select the reason\n    For Each obj In objIE.Document.getElementsByTagName(\"input\")\n    If obj.id = \"s2id_autogen3\" Then\n    obj.Focus\n    obj.innerText = \"Closed\"\n    obj.FireEvent (\"onclick\")\n    Exit For\n    End If\n    Next\n</code></pre>\n\n<p>The text gets selected but still no luck with validating it. <a href=\"https://i.stack.imgur.com/EKubG.png\" rel=\"nofollow noreferrer\">see here </a></p>\n"}], "owner": {"reputation": 1, "user_id": 9601122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Laure Jacquon", "link": "https://stackoverflow.com/users/9601122/laure-jacquon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524124904, "creation_date": 1523435126, "last_edit_date": 1531164843, "question_id": 49770116, "link": "https://stackoverflow.com/questions/49770116/impossible-to-trigger-a-javascript-anchor-with-vba", "title": "Impossible to trigger a javascript anchor with VBA", "body": "<p>I am a newbie with VBA but with help from different websites and this one for which I am really grateful, I managed to put together a macro that will connect to a certain website and fill a menu with a value \"Closed\" then click on OK. </p>\n\n<p>The problem is the value appears in the menu but it is as if it was not recognized as such. When OK is clicked it says that no value has been entered. </p>\n\n<p>I figure there is something to do with the javascript:void(0)link inside but couldn't manage to find what exactly.</p>\n\n<p>I figured my problem was related to this thread left unanswered: <a href=\"https://stackoverflow.com/questions/41263872/use-vba-to-trigger-html-anchor-href-javascriptvoid0\">Use vba to trigger html anchor href=&quot;javascript:void(0)&quot;</a></p>\n\n<p>Here is the HTML code : </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"modal ui-dialog-content ui-widget-content\" id=\"pausingModal\" scrolltop=\"0\" scrollleft=\"0\" style=\"width: auto; min-height: 0px; height: auto;\"&gt;&lt;label&gt;Please specify the reason&lt;/label&gt;&lt;div class=\"row\"&gt;&lt;div class=\"select2-container select2 reason select2-container-active select2-dropdown-open\" id=\"s2id_autogen2\" style=\"width: 100%\"&gt;&lt;a href=\"javascript:void(0)\" class=\"select2-choice select2-default\" tabindex=\"-1\"&gt;   &lt;span class=\"select2-chosen\" id=\"select2-chosen-3\"&gt;Select a reason&lt;/span&gt;&lt;abbr class=\"select2-search-choice-close\"&gt;&lt;/abbr&gt;   &lt;span class=\"select2-arrow\" role=\"presentation\"&gt;&lt;b role=\"presentation\"&gt;&lt;/b&gt;&lt;/span&gt;&lt;/a&gt;&lt;label for=\"s2id_autogen3\" class=\"select2-offscreen\"&gt;&lt;/label&gt;&lt;input class=\"select2-focusser select2-offscreen\" type=\"text\" aria-haspopup=\"true\" role=\"button\" aria-labelledby=\"select2-chosen-3\" id=\"s2id_autogen3\" disabled=\"\"&gt;&lt;/div&gt;&lt;select class=\"select2 reason select2-offscreen\" style=\"width: 100%\" tabindex=\"-1\" title=\"\"&gt;&lt;option&gt;&lt;/option&gt;&lt;optgroup label=\"Related\"&gt;&lt;option data-pause-type=\"hard_pause\" data-show-text-area=\"false\" value=\"1\"&gt;Closed&lt;/option&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here is the VBA code :</p>\n\n<pre><code>'Select the reason    For Each obj In objIE.Document.getElementsByTagName(\"span\")\nIf obj.id = \"select2-chosen-3\" Then\nobj.Focus\nobj.innerText = \"Closed\"\nExit For\nEnd If\nNext\n\n ' Wait\nDo While objIE.Busy = True\nDoEvents\nLoop\nDo While objIE.readyState &lt;&gt; 4\nDoEvents\nLoop\nSleep \u5f85\u3061\u6642\u9593\n</code></pre>\n\n<p>Up until here the value appears in the drop-down box. But it is as if the website doesn't recognize it as selected. I tried the following code to \"trigger\" the value without luck:</p>\n\n<pre><code>  'Trigger the value\nFor Each obj In objIE.Document.getElementsByTagName(\"a\")\nIf obj.className = \"select2-choice select2-default\" Then\nobj.Click\nExit For\nEnd If\nNext\n</code></pre>\n\n<p>Could someone point me in the right direction ?</p>\n"}, {"tags": ["excel", "vba", "copy", "copy-paste", "paste"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1523434925, "post_id": 49769926, "comment_id": 86554908, "body": "Hard to tell without your data. Have you debugged your code to see where it doesn&#39;t&#39; behave as expected?"}, {"owner": {"reputation": 21, "user_id": 9618121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db167ad6bf74f3e645930587d7783985?s=128&d=identicon&r=PG&f=1", "display_name": "nw201827", "link": "https://stackoverflow.com/users/9618121/nw201827"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1523435156, "post_id": 49769926, "comment_id": 86555055, "body": "I&#39;m getting an error in &quot;Set sourceWS&quot; and &quot;Set targetWS&quot; lines - not sure why since these lines work fine when I search for other column headings and the docs are open. Also getting an error in the &quot;With sourceWS&quot; section. Again with the exception of the heading name to search for, this exact code works fine with other heading names."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1523435337, "post_id": 49769926, "comment_id": 86555156, "body": "What is the actual error you are getting when setting sourceWS and targetWS? Also, try changing your copy statement to: <b><code>.Range(.Cells(3, found1.Column), .Cells(lastRow, found1.Column)).Copy found2.Offset(1, 0)</code></b> (all in the same line of code)"}, {"owner": {"reputation": 21, "user_id": 9618121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db167ad6bf74f3e645930587d7783985?s=128&d=identicon&r=PG&f=1", "display_name": "nw201827", "link": "https://stackoverflow.com/users/9618121/nw201827"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1523435964, "post_id": 49769926, "comment_id": 86555566, "body": "Hi @Zac I&#39;ve tried making this change but still nothing happening. The error message is &quot;identifier under cursor is not recognised&quot;"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1523436257, "post_id": 49769926, "comment_id": 86555770, "body": "Have you stepped through your code? If so then, does it even get to the copy statement considering that you are getting an error when attempting to set the source and target? I suspect that you have set <b>&quot;On Error Resume Next`</b> somewhere and that&#39;s why it keeps going. At the start of your sub, reset that with: <b>&quot;On Error Goto 0&quot;</b>"}, {"owner": {"reputation": 21, "user_id": 9618121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db167ad6bf74f3e645930587d7783985?s=128&d=identicon&r=PG&f=1", "display_name": "nw201827", "link": "https://stackoverflow.com/users/9618121/nw201827"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1523437074, "post_id": 49769926, "comment_id": 86556326, "body": "@Zac I didn&#39;t have an error line in the original code but have added in the one you suggested. I can still step through the full code and the copy part highlights as an error but no message for this part"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1523438347, "post_id": 49769926, "comment_id": 86557261, "body": "So even though you are getting an error when setting your worksheets, you are able to continue? Are workbook1 and workbook2 already open when you run the above code because you are not opening them?"}, {"owner": {"reputation": 21, "user_id": 9618121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db167ad6bf74f3e645930587d7783985?s=128&d=identicon&r=PG&f=1", "display_name": "nw201827", "link": "https://stackoverflow.com/users/9618121/nw201827"}, "edited": false, "score": 0, "creation_date": 1523438551, "post_id": 49769926, "comment_id": 86557405, "body": "Yeah, I don&#39;t really understand why! Both workbook 1 and 2 are open before the macro is run"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1523443987, "post_id": 49769926, "comment_id": 86561183, "body": "Had a quick search and it seem that some people with same error resolved the issue by simply restarting there PC. Can you try that?"}], "owner": {"reputation": 21, "user_id": 9618121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db167ad6bf74f3e645930587d7783985?s=128&d=identicon&r=PG&f=1", "display_name": "nw201827", "link": "https://stackoverflow.com/users/9618121/nw201827"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523434561, "creation_date": 1523434561, "question_id": 49769926, "link": "https://stackoverflow.com/questions/49769926/problems-with-copying-data", "title": "Problems with copying data", "body": "<p>I'm having a problem with a code to copy and paste based on column headings (code included at the bottom of this post).</p>\n\n<p>The macro should search for a column heading and then copy the data under that heading and paste the data in a new location (under a different heading in a new workbook). The code works in most cases because I have used it to copy data from certain columns (e.g. A, B, C all in the same worksheet), and the code works fine. I think the paste destination is also fine because I can run the macro to copy data from these columns (e.g. A, B, C) and paste into my destination. However, for some reason when I try and copy data from column F, and paste in a new worksheet, nothing happens. I don't even get an error message. Because I can copy from other columns, and paste into the target column, my thoughts are that the error is with the copy part of the marco. </p>\n\n<p>I've checked the obvious like does the column headings in my code match exactly with the column headings in the document, etc. Is there something wrong with my code, or is it possible there's something in the source worksheet that is preventing certain data from being copied?</p>\n\n<pre><code>Sub ProjectCopy()\nDim sourceWS As Worksheet, targetWS As Worksheet\nDim lastCol As Long, lastRow As Long, srcRow As Range\nDim found1 As Range, found2 As Range\n\nSet sourceWS = Workbooks(\"Workbook1.xlsx\").Worksheets(\"Sheet1\") 'Needs to be open\nSet targetWS = Workbooks(\"Workbook2.xlsm\").Worksheets(\"Sheet1\") 'Needs to be open\n\nWith sourceWS\n    lastCol = .Cells(1, Columns.count).End(xlToLeft).Column\n    Set srcRow = .Range(\"A1\", .Cells(1, lastCol))\n    Set found1 = srcRow.Find(What:=\"Project\", LookAt:=xlWhole, MatchCase:=False)\n\n    If Not found1 Is Nothing Then\n        lastCol = targetWS.Cells(1, Columns.count).End(xlToLeft).Column\n        Set srcRow = targetWS.Range(\"A1\", targetWS.Cells(1, lastCol))\n        Set found2 = srcRow.Find(What:=\"Activity\", LookAt:=xlWhole, MatchCase:=False)\n\n        If Not found2 Is Nothing Then\n            lastRow = .Cells(Rows.count, found1.Column).End(xlUp).Row\n            .Range(.Cells(3, found1.Column), .Cells(lastRow, found1.Column)).Copy\n            found2.Offset(1, 0).PasteSpecial xlPasteAll\n        End If\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1523436783, "post_id": 49769628, "comment_id": 86556108, "body": "Are you sure that you have the error in the line you say? It would make sense to throw an error in pfiPivFldItem.Visible = (CDate(pfiPivFldItem.Value) = CLng(dtmDate)) since PivotItem.Visible is a boolean... Feels like a typo and that you really want to set the Value, not the Visible property."}, {"owner": {"reputation": 25, "user_id": 9395487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9246478dcd1e02ed695f09ac211475?s=128&d=identicon&r=PG&f=1", "display_name": "Pret", "link": "https://stackoverflow.com/users/9395487/pret"}, "reply_to_user": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1523439528, "post_id": 49769628, "comment_id": 86558111, "body": "Hi a-burge, Thanks for your reply! When I try to execute the code, pfiPivFldItem.Visible = False is the line that is being highlighted. Can you please tell me what you would suggest to change in pfiPivFldItem.Visible = (CDate(pfiPivFldItem.Value) = CLng(dtmDate)) ? I&#39;m not sure of the solution :/"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 1, "creation_date": 1523443328, "post_id": 49769628, "comment_id": 86560702, "body": "@a-burge pfiPivFldItem.Visible is read/write, and will happily accept the evaluated answer of (CDate(pfiPivFldItem.Value) = CLng(dtmDate))"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1523443605, "post_id": 49769628, "comment_id": 86560911, "body": "@Pret It may well be that (CDate(pfiPivFldItem.Value) will never equal CLng(dtmDate)) due to the issue/bug I outlined at <a href=\"http://dailydoseofexcel.com/archives/2013/11/09/a-date-with-pivotitems/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2013/11/09/a-date-with-pivotit&zwnj;&#8203;ems</a>  . Suggest you step through the code and check what happens when the item you <i>think</i> should be visible is reached in that loop."}, {"owner": {"reputation": 25, "user_id": 9395487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9246478dcd1e02ed695f09ac211475?s=128&d=identicon&r=PG&f=1", "display_name": "Pret", "link": "https://stackoverflow.com/users/9395487/pret"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1523445400, "post_id": 49769628, "comment_id": 86562140, "body": "@jeffreyweir - Thank you so much for your detailed response! I&#39;ll step through the code like you suggested and will get back with the update."}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 1, "last_activity_date": 1523443543, "last_edit_date": 1523443543, "creation_date": 1523441913, "answer_id": 49772485, "question_id": 49769628, "link": "https://stackoverflow.com/questions/49769628/autofilter-last-used-date-in-a-pivot-table/49772485#49772485", "title": "Autofilter last used date in a pivot table", "body": "<p>This is a common error I see when folk are trying to iterate over PivotItems and change visibility. It happens because you must leave one item visible at all times. The workaround is to set the first item to visible, do the loop, and then check whether the first item should be visible or not. Of course, this won't help you if the thing you're looking for isn't in the PivotTable, which might be the case here. It may well be that (CDate(pfiPivFldItem.Value) will never equal CLng(dtmDate)) due to the issue/bug I outlined at <a href=\"http://dailydoseofexcel.com/archives/2013/11/09/a-date-with-pivotitems/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2013/11/09/a-date-with-pivotitems/</a>  </p>\n\n<p>There's some other things you want to do when filtering PivotTables, such as switch the PivotTable .ManualUpdate property to TRUE while you loop the PivotTable, or otherwise the PT will try to update after each and every change. </p>\n\n<p>Suggest you check out my answer at <a href=\"https://stackoverflow.com/questions/48463674/filter-pivot-table-1004-error/48489988#48489988\">Filter pivot table 1004 error</a> as the code comments show how and why to do some of this stuff. Also suggest you check out my blogpost at <a href=\"http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/</a> that takes an indepth look at bottlenecks and workarounds when iterating over PivotItems.</p>\n\n<p>Note that the quickest way to filter a field on one item is to make it a PageField, and set the .PageField value to the PivotItem concerned. That's near instantaneous, and makes a massive difference if you have thousands of items in the PivotField that you're iterating over.</p>\n"}], "owner": {"reputation": 25, "user_id": 9395487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9246478dcd1e02ed695f09ac211475?s=128&d=identicon&r=PG&f=1", "display_name": "Pret", "link": "https://stackoverflow.com/users/9395487/pret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523443543, "creation_date": 1523433630, "last_edit_date": 1523434007, "question_id": 49769628, "link": "https://stackoverflow.com/questions/49769628/autofilter-last-used-date-in-a-pivot-table", "title": "Autofilter last used date in a pivot table", "body": "<p>I'm trying to auto-filter my pivot table based on the most recent date in my data and I came across the following code. However, when I try to execute it, I get a </p>\n\n<blockquote>\n  <p>run-time error (1004 - Unable to set the Visible property of the PivotItem class) </p>\n</blockquote>\n\n<p>on the line:  <code>pfiPivFldItem.Visible = False</code> Can someone help me with this?</p>\n\n<pre><code>Dim pfiPivFldItem As PivotItem\nDim dtmDate As Date\n\nWith Worksheets(\"Sheet2\").PivotTables(\"Campaigns\")\n    .PivotCache.Refresh\n    .ClearAllFilters\n\n    With .RowRange\n        dtmDate = Evaluate(\"MAX(IF(ISNUMBER(\" &amp; .Address(0, 0) &amp; \"),\" &amp; .Address(0, 0) &amp; \",))\")\n    End With\n\n    For Each pfiPivFldItem In .PivotFields(\"Date\").PivotItems\n        If pfiPivFldItem.Value = \"(blank)\" Then\n            pfiPivFldItem.Visible = False\n        Else\n            pfiPivFldItem.Visible = (CDate(pfiPivFldItem.Value) = CLng(dtmDate))\n        End If\n    Next pfiPivFldItem\n</code></pre>\n"}, {"tags": ["vba", "matlab", "code-conversion"], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 7150999, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154751607539577/picture?type=large", "display_name": "Can Demir", "link": "https://stackoverflow.com/users/7150999/can-demir"}, "is_accepted": true, "score": 0, "last_activity_date": 1523432183, "last_edit_date": 1523432183, "creation_date": 1523431861, "answer_id": 49769054, "question_id": 49769053, "link": "https://stackoverflow.com/questions/49769053/excel-vba-to-matlab-conversion-to-create-a-diagram-with-one-y-axis-and-two-x-axe/49769054#49769054", "title": "Excel VBA to MATLAB conversion to create a diagram with one Y axis and two X axes", "body": "<p>I found a solution to my own question. Regarding matlab code is as follows:</p>\n\n<pre><code>%% Excel Diagramm Versuch2\nclc; clear all; close all;\nexcel = actxserver('excel.application');\nexcel.Visible = 1;\nwkbk = excel.Workbooks.Open('Z:\\...file directory...\\V1.xlsx');\nwkbk.ActiveSheet;\nwkbk.ActiveSheet.Shapes.AddChart.Select;\nwkbk.ActiveChart.ChartType = 'XlXYScatterSmoothNoMarkers';\n% qwer makro Anfang\nwkbk.Sheet.Item('Tabelle2').Select;\nwkbk.Sheet.Item('Tabelle1').Select;\nwkbk.ActiveChart;\n% Set the x-axis\nAxes = invoke(excel.ActiveChart,'Axes',1); \nset(Axes,'HasTitle',1); \nset(Axes.AxisTitle,'Caption','Revolution[1/min]')\n% Set the y-axis\nAxes = invoke(excel.ActiveChart,'Axes',2); \nset(Axes,'HasTitle',1); \nset(Axes.AxisTitle,'Caption','Film Thickness[\u00b5m]')\n% Give the Chart a title \nexcel.ActiveChart.HasTitle = 1; \nexcel.ActiveChart.ChartTitle.Characters.Text = 'Film Thickness-Revolution';\ninvoke(excel.ActiveChart.SeriesCollection,'NewSeries');\nwkbk.ActiveChart.SeriesCollection(1).Name = 'Min Film Thickness mean';\nwkbk.ActiveChart.SeriesCollection(1).XValues = 'Tabelle1!$A$5:$A$10';\nwkbk.ActiveChart.SeriesCollection(1).Values = 'Tabelle1!$B$5:$B$10';\ninvoke(excel.ActiveChart.SeriesCollection,'NewSeries');\nwkbk.ActiveChart.SeriesCollection(2).Name = 'Sommerfeld Number';\nwkbk.ActiveChart.SeriesCollection(2).XValues = 'Tabelle2!$A$5:$A$10';\nwkbk.ActiveChart.SeriesCollection(2).Values = 'Tabelle2!$B$5:$B$10';\nwkbk.ActiveChart.SeriesCollection(2).AxisGroup = 2;\npause(20)\nwkbk.Close;\nexcel.Quit; \nclose excel\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7150999, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154751607539577/picture?type=large", "display_name": "Can Demir", "link": "https://stackoverflow.com/users/7150999/can-demir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 49769054, "answer_count": 1, "score": 0, "last_activity_date": 1523432183, "creation_date": 1523431861, "question_id": 49769053, "link": "https://stackoverflow.com/questions/49769053/excel-vba-to-matlab-conversion-to-create-a-diagram-with-one-y-axis-and-two-x-axe", "title": "Excel VBA to MATLAB conversion to create a diagram with one Y axis and two X axes", "body": "<p>I'd like to convert a diagram-creating-Excel-VBA Code to a Matlab script, so that I can manipulate an Excel file without dealing with excel, and by the Matlab script.Thanks in advance.\nVBA code is as follows:<br>\n<strong><code>\n    Sub qwer()\n    '\n    ' qwer Makro\n    ' This macro creates a diagram with an X axis and two Y axes\n        Sheets(\"Loadcase1\").Select\n        Range(\"D39:E39\").Select\n        Selection.Copy\n        Sheets(\"Overview\").Select\n        Range(\"B60\").Select\n        ActiveSheet.Paste\n        Range(\"H15\").Select\n        ActiveSheet.Shapes.AddChart.Select\n        ActiveChart.ChartType = xlXYScatterSmooth\n        Application.CutCopyMode = False\n        ActiveChart.SeriesCollection.NewSeries\n        ActiveChart.SeriesCollection(1).Name = \"=\"\"Min Film Thickness mean\"\"\"\n        ActiveChart.SeriesCollection(1).XValues = \"=Overview!$C$29:$H$29\"\n        ActiveChart.SeriesCollection(1).Values = \"=Overview!$C$40:$H$40\"\n        ActiveChart.SeriesCollection.NewSeries\n        ActiveChart.SeriesCollection(2).Name = \"=\"\"Sommerfeld Number\"\"\"\n        ActiveChart.SeriesCollection(2).XValues = \"=Overview!$C$29:$H$29\"\n        ActiveChart.SeriesCollection(2).Values = \"=Overview!$C$43:$H$43\"\n        ActiveChart.SeriesCollection.NewSeries\n        ActiveChart.SeriesCollection(3).Name = \"=\"\"Min Film Thickness Min\"\"\"\n        ActiveChart.SeriesCollection(3).XValues = \"=Overview!$C$29:$H$29\"\n        ActiveChart.SeriesCollection(3).Values = \"=Overview!$B$60:$B$65\"\n        ActiveChart.SeriesCollection.NewSeries\n        ActiveChart.SeriesCollection(4).Name = \"=\"\"Min Film Thickness Max\"\"\"\n        ActiveChart.SeriesCollection(4).XValues = \"=Overview!$C$29:$H$29\"\n        ActiveChart.SeriesCollection(4).Values = \"=Overview!$C$60:$C$65\"\n        ActiveChart.SeriesCollection(2).Select\n        ActiveChart.SeriesCollection(2).AxisGroup = 2\n    End Sub\n</code></strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 0, "creation_date": 1523431999, "post_id": 49769037, "comment_id": 86553204, "body": "I take it that the loop is executed 9 times only. If you change: Do While I &lt; UBound(xFilesToOpen) to Do While I &lt;= UBound(xFilesToOpen) ?"}, {"owner": {"reputation": 23, "user_id": 6443781, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YB6CB1WJABA/AAAAAAAAAAI/AAAAAAAAEdI/vTwUfAKOxmU/photo.jpg?sz=128", "display_name": "Jayakumar krishnamoorthy", "link": "https://stackoverflow.com/users/6443781/jayakumar-krishnamoorthy"}, "reply_to_user": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 0, "creation_date": 1523432537, "post_id": 49769037, "comment_id": 86553531, "body": "It shows error Subscript out of Range after changing, still fetching one line less than exact count"}, {"owner": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 0, "creation_date": 1523433009, "post_id": 49769037, "comment_id": 86553808, "body": "Replace UBound(xFilesToOpen) by 10. If that works insert a line before do While that says : dim loop = UBound(xFilesToOpen)+1"}, {"owner": {"reputation": 23, "user_id": 6443781, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YB6CB1WJABA/AAAAAAAAAAI/AAAAAAAAEdI/vTwUfAKOxmU/photo.jpg?sz=128", "display_name": "Jayakumar krishnamoorthy", "link": "https://stackoverflow.com/users/6443781/jayakumar-krishnamoorthy"}, "reply_to_user": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 0, "creation_date": 1523439204, "post_id": 49769037, "comment_id": 86557859, "body": "Entering 10 as value still shows out of range, I have enabled <code>dim loop = UBound(xFilesToOpen)+1     Do While I &lt;= 10</code> it still shows error"}], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "is_accepted": false, "score": 0, "last_activity_date": 1523432097, "creation_date": 1523432097, "answer_id": 49769127, "question_id": 49769037, "link": "https://stackoverflow.com/questions/49769037/excel-vba-fetching-data-is-one-less-than-the-actual/49769127#49769127", "title": "Excel VBA: Fetching Data is one less than the actual", "body": "<p>change</p>\n\n<pre><code>Do While I &lt; UBound(xFilesToOpen)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Do While I &lt;= UBound(xFilesToOpen)\n</code></pre>\n\n<p>currently, you are not performing the last loop of the step :)</p>\n"}], "owner": {"reputation": 23, "user_id": 6443781, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YB6CB1WJABA/AAAAAAAAAAI/AAAAAAAAEdI/vTwUfAKOxmU/photo.jpg?sz=128", "display_name": "Jayakumar krishnamoorthy", "link": "https://stackoverflow.com/users/6443781/jayakumar-krishnamoorthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523432097, "creation_date": 1523431804, "question_id": 49769037, "link": "https://stackoverflow.com/questions/49769037/excel-vba-fetching-data-is-one-less-than-the-actual", "title": "Excel VBA: Fetching Data is one less than the actual", "body": "<p>I'm customizing the below code for my requirement and the code works fine and only problem it not writing the last row. If I import 10 text files, it copy the values from 9 sheets and paste in Theta sheet, last sheet data is left out. I'm unable to figure out where the it is missing. Need help on the same</p>\n\n<pre><code>`Sub CombineFiles()\nDim xFilesToOpen As Variant\nDim I As Integer\nDim xWb As Workbook\nDim xTempWb As Workbook\nDim xDelimiter As String\nDim xScreen As Boolean\nDim StartTime As Double\nDim MinutesElapsed As String\n\nStartTime = Timer\n\nApplication.DisplayAlerts = False\n\n' Extracting PDF to Text using command line\nApplication.Run \"convert.xlsm!PDFExtract\"\n\nOn Error GoTo ErrHandler\nxScreen = Application.ScreenUpdating\nApplication.ScreenUpdating = False\n\n'Opening a Theta sheet where I want to paste the data\nWorkbooks.Open Filename:=\"C:\\Backup\\PO\\Theta.xlsb\"\n\nSheets(\"Rough\").Select\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\nRange(\"A1\").Select\n\n'Importing Text Files into Excel\nxDelimiter = \"|\"\nxFilesToOpen = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\", , \"PO Extraction\", , True)\nIf TypeName(xFilesToOpen) = \"Boolean\" Then\n    MsgBox \"No files were selected\", , \"PO Extraction\"\n    GoTo ExitHandler\nEnd If\nI = 1\nSet xTempWb = Workbooks.Open(xFilesToOpen(I))\nxTempWb.Sheets(1).Copy\nSet xWb = Application.ActiveWorkbook\nxTempWb.Close False\nxWb.Worksheets(I).Columns(\"A:A\").TextToColumns _\n  Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n  TextQualifier:=xlDoubleQuote, _\n  ConsecutiveDelimiter:=False, _\n  Tab:=False, Semicolon:=False, _\n  Comma:=False, Space:=False, _\n  Other:=True, OtherChar:=\"|\"\nDo While I &lt; UBound(xFilesToOpen)\n    I = I + 1\n    Set xTempWb = Workbooks.Open(xFilesToOpen(I))\n    With xWb\n        xTempWb.Sheets(1).Move after:=.Sheets(.Sheets.Count)\n        .Worksheets(I).Columns(\"A:A\").TextToColumns _\n          Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n          TextQualifier:=xlDoubleQuote, _\n          ConsecutiveDelimiter:=False, _\n          Tab:=False, Semicolon:=False, _\n          Comma:=False, Space:=False, _\n          Other:=True, OtherChar:=xDelimiter\n    End With\n\n    'Replace unwanted lines into blanks\n    Application.Run \"Convert.xlsm!ReplaceText\"\n\n    'Removing Blank Rows after replace\n    Range(\"A1:A10000\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n\n    'Copying a concatenate formula from a cell to a imported worksheet\n    Windows(\"convert.xlsm\").Activate\n    Sheets(\"Sheet2\").Select\n    Range(\"B1\").Select\n    Selection.Copy\n\n\n    Windows(\"Book1\").Activate\n    Range(\"B1\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    'Copying data from Book1, active imported text file sheet to Theta sheet\n    Windows(\"Theta.xlsb\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n    'Pasted data have lot of unwanted space and chacters, replacing them delimiter\n    Application.Run \"Convert.xlsm!SelectionReplace\"\n    ActiveCell.Offset(1, 0).Select\n    ActiveWorkbook.Save\n\nLoop\n\nMinutesElapsed = Format((Timer - StartTime) / 86400, \"hh:mm:ss\")\n'MsgBox (\"Finished\")\nMsgBox \"This code ran successfully in \" &amp; MinutesElapsed &amp; \" minutes\", vbInformation\nExitHandler:\nApplication.ScreenUpdating = xScreen\nSet xWb = Nothing\nSet xTempWb = Nothing\nExit Sub\nErrHandler:\nMsgBox Err.Description, , \"PO Extraction\"\nResume ExitHandler\nEnd Sub`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1875, "user_id": 193567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f442d51bf628329da464d5ecfdcf528?s=128&d=identicon&r=PG", "display_name": "Dylan Brams", "link": "https://stackoverflow.com/users/193567/dylan-brams"}, "edited": false, "score": 0, "creation_date": 1523432130, "post_id": 49768905, "comment_id": 86553290, "body": "<a href=\"https://stackoverflow.com/questions/25037467/find-the-first-empty-cell-in-the-same-column-row\" title=\"find the first empty cell in the same column row\">stackoverflow.com/questions/25037467/&hellip;</a> will help you."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1523432711, "post_id": 49768905, "comment_id": 86553631, "body": "Welcome to Stack Overflow. If you ask questions here please always include what you already have tried. Therefore <a href=\"https://stackoverflow.com/posts/49768905/edit\">edit</a> your question and add the code you already have. Even if it is not working people here will kindly help you to fix/improve it. But it is very unlikely that they do all the work for you if you if you did nothing or didn&#39;t try at all."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1523432719, "post_id": 49768905, "comment_id": 86553636, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20663491/delete-all-data-rows-from-an-excel-table-apart-from-the-first\">Delete all data rows from an Excel table (apart from the first)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 1, "last_activity_date": 1523437017, "last_edit_date": 1523437017, "creation_date": 1523435756, "answer_id": 49770320, "question_id": 49768905, "link": "https://stackoverflow.com/questions/49768905/vba-coding-to-identify-and-clear-data-in-a-specific-table/49770320#49770320", "title": "VBA coding to identify and clear data in a specific table", "body": "<p>Tables are called ListObjects in VBA. A ListObject has a property called a .DataBodyRange that contains everything under the header. That has a .Clear method. </p>\n\n<p>I generally use this syntax to clear the body of a ListObject:</p>\n\n<pre><code>Range(\"Table1\").ListObject.DataBodyRange.Clear\n</code></pre>\n\n<p>The <code>Range(\"Table1\")</code> bit allows me to find the ListObject even if I don't know what sheet it's on. This works because Tables are <em>also</em> Named Ranges that you can address by name. So you just say \"Go to the Named Range called Table1, and get me the ListObject that lives there\".  Otherwise you would need to know in advance what sheet the ListObject is on, and use the following:</p>\n\n<pre><code>Worksheets(\"SomeSheet\").Listobjects(\"Table1\").DataBodyRange.Clear\n</code></pre>\n\n<p>...which works just fine until one day you move the Table to a different sheet, and forget to update your code.</p>\n\n<p>Note that a table is not guaranteed to actually have a .DataBodyRange, because someone may have deleted all the rows under the header. For instance, take this Table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/p3BlM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p3BlM.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>How many rows does it have in the DataBodyRange?</p>\n\n<pre><code>? Range(\"Table1\").ListObject.DataBodyRange.Rows.Count\n 3\n</code></pre>\n\n<p>Okay, now I'm going to delete those rows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/eUeCr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eUeCr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>...leaving this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5wIMV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5wIMV.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>How many rows in that DataBodyRange now?</p>\n\n<pre><code>? Range(\"Table1\").ListObject.DataBodyRange.Rows.Count\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OSNGC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OSNGC.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Whoops...you can't reference a .DataBodyRange if it don't exist. </p>\n\n<p>So to be safe, stick an <code>On Error Resume Next</code> before you try to reference a .DataBodyRange, and an <code>On Error Goto 0</code> afterwards. Or something fancier.  </p>\n"}, {"comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1523440395, "post_id": 49770532, "comment_id": 86558716, "body": "I didn&#39;t place it, but looking at your code I&#39;d suggest it&#39;s not as simple or robust as it could be. The use of .CurrentRegion could be problematic if other data the OP doesn&#39;t want cleared happens to be immediately ajoining the table, and Tables aka ListObjects have built in properties and methods that are much cleaner."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1523514085, "post_id": 49770532, "comment_id": 86593545, "body": "Additionally to the concerns jeffreyweir mentioned: Since table/ListObject names are actually named ranges listed in the NameManager that automatically resizes with the table it seems to be very redundant defining another name for data. You could just use the name of the table which is much more safe and no redundancy. See <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">The VBA Guide To ListObject Excel Tables</a> for a nice guide on that topic. Only the fact that you could do it like you did doesn&#39;t mean that this automatically a good answer/idea."}], "tags": [], "owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "is_accepted": false, "score": -1, "last_activity_date": 1523436358, "creation_date": 1523436358, "answer_id": 49770532, "question_id": 49768905, "link": "https://stackoverflow.com/questions/49768905/vba-coding-to-identify-and-clear-data-in-a-specific-table/49770532#49770532", "title": "VBA coding to identify and clear data in a specific table", "body": "<p>First, create a named range. If required, you can make this dynamic. In this example the named range is Name \"Data\".</p>\n\n<p>Then Trigger the Sub \"Test\" from the following VBA code.</p>\n\n<pre><code>Option Explicit\n\nSub ClearRange(ByVal rngCell As Range)\n\n    Dim rngRange As Range\n\n    Set rngRange = rngCell.CurrentRegion\n\n    rngRange.Range(rngRange.Parent.Cells(2, 1), rngRange.Parent.Cells(rngRange.Rows.Count, rngRange.Columns.Count)).ClearContents\n\nEnd Sub\n\nSub test()\n\n    Dim rngCell As Range\n\n    Set rngCell = ActiveSheet.Range(\"Data\").Cells(1, 1)\n\n    ClearRange rngCell\n\nEnd Sub\n</code></pre>\n\n<p>This should clear the range except for the first row (headers).</p>\n\n<p>Important: The header row and the first column of your range must be filled completely (no empty cells) for the above to work smoothly.</p>\n"}], "owner": {"reputation": 21, "user_id": 6645246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153947226859032/picture?type=large", "display_name": "Richard ", "link": "https://stackoverflow.com/users/6645246/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1523437017, "creation_date": 1523431398, "last_edit_date": 1531161705, "question_id": 49768905, "link": "https://stackoverflow.com/questions/49768905/vba-coding-to-identify-and-clear-data-in-a-specific-table", "title": "VBA coding to identify and clear data in a specific table", "body": "<p>I am new to using VBA and would like to add coding to a button that will identify the size of a table called \"QA_Activity\" and clear all but the header row on clicking the button. I was hoping that this would be quite simple but am struggling as to how to identify a table that could be a different size each month. Many thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1523432884, "post_id": 49768593, "comment_id": 86553736, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/30380490/find-and-findnext-for-excel-vba\">Find and FindNext for Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1523461256, "last_edit_date": 1523461256, "creation_date": 1523436997, "answer_id": 49770747, "question_id": 49768593, "link": "https://stackoverflow.com/questions/49768593/looping-findnext-inside-another-loop-find/49770747#49770747", "title": "Looping findnext inside another loop &amp; find", "body": "<p>This generates the required output. </p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetMatches()\n\n    Dim wb As Workbook, wsSource As Worksheet, wsSearch As Worksheet, masterDict As Object, arr() As Variant, i As Long\n    Set wb = ThisWorkbook\n    Set wsSource = wb.Worksheets(\"BBB\")\n    Set wsSearch = wb.Worksheets(\"AAA\")\n    Set masterDict = CreateObject(\"Scripting.Dictionary\")\n\n    With wsSource\n        arr = Intersect(.Columns(1), .UsedRange)\n        For i = 1 To UBound(arr, 1)\n            If Not masterDict.exists(arr(i, 1)) Then masterDict.Add arr(i, 1), GetAllMatches(arr(i, 1), wsSearch)\n        Next i\n    End With\n\n    Dim key As Variant\n    For Each key In masterDict.keys\n        Debug.Print masterDict(key)\n    Next key\nEnd Sub\n\nPublic Function GetAllMatches(ByVal findString As String, ByVal searchRng As Worksheet) As String\n\n    Dim foundCell As Range\n    Dim concatenatedString As String\n    concatenatedString = vbNullString\n    With Intersect(searchRng.Columns(1), searchRng.UsedRange)\n\n        Set foundCell = .Find(findString)\n        concatenatedString = foundCell\n\n        Dim currMatch As Long\n        currMatch = 0\n\n        For currMatch = 1 To WorksheetFunction.CountIf(.Cells, \"*\" &amp; findString &amp; \"*\") - 1\n\n            Set foundCell = .Find(What:=findString, After:=foundCell, _\n                                  LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _\n                                  SearchDirection:=xlNext, MatchCase:=False)\n\n            If Not foundCell Is Nothing Then\n                concatenatedString = concatenatedString &amp; \",\" &amp; foundCell\n            Else\n                concatenatedString = foundCell\n            End If\n        Next currMatch\n    End With    \n    GetAllMatches = concatenatedString    \nEnd Function\n</code></pre>\n\n<p><strong>TestData:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Aptrq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Aptrq.png\" alt=\"TestData\"></a></p>\n\n<p>AAA:                               </p>\n\n<pre><code>| Absinthe    |\n| Antibiotics |\n| Random      |\n| Antisocial  |\n| Antipodean  |\n| Motorcycle  |\n| Random      |\n| Random      |\n| Motorbike   |\n| Random      |\n| Motown      |\n</code></pre>\n\n<p>BBB:</p>\n\n<pre><code>| Ab   |\n| Moto |\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/NZ9xA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NZ9xA.png\" alt=\"Output\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1523452711, "creation_date": 1523452711, "answer_id": 49776203, "question_id": 49768593, "link": "https://stackoverflow.com/questions/49768593/looping-findnext-inside-another-loop-find/49776203#49776203", "title": "Looping findnext inside another loop &amp; find", "body": "<p>The code below will loop through all values in sheet B and output it's findings.\nI've re-used QHarr's values for my example</p>\n\n<pre><code>Option Explicit\nPublic Sub findValue()\n    Dim firstAddress As String\n    Dim c As Range, rng As Range, v As Range\n    Dim tmp As Variant\n    Dim j As Long\n\n    With ThisWorkbook\n        With .Sheets(\"AAA\")\n            Set rng = .Range(.Cells(1, 1), .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, 1))\n        End With\n\n        With .Sheets(\"BBB\")\n            For Each v In .Range(.Cells(1, 1), .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, 1))\n                ReDim tmp(1 To rng.Rows.Count)\n                j = LBound(tmp)\n\n                Set c = rng.Find(what:=v, LookIn:=xlValues, lookat:=xlPart, MatchCase:=False)\n                If Not c Is Nothing Then\n                    firstAddress = c.Address\n                    Do\n                        tmp(j) = c.Value2\n                        j = j + 1\n                        Set c = rng.FindNext(c)\n                    Loop While c.Address &lt;&gt; firstAddress And Not c Is Nothing\n                    If j &gt; 0 Then\n                        ReDim Preserve tmp(LBound(tmp) To j - 1)\n                        Debug.Print v &amp; \": \" &amp; Join(tmp, \",\")\n                        v.Offset(0, 1).Value2 = Join(tmp, \",\")\n                    End If\n                End If\n            Next v\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sheet(\"AAA\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/1pXOW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1pXOW.png\" alt=\"Sheet(&quot;AAA&quot;)\"></a></p>\n\n<pre><code>Sheet(\"BBB\") before running code\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xCT8z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xCT8z.png\" alt=\"Sheet(&quot;BBB&quot;) Before Running code\"></a></p>\n\n<pre><code>Sheet(\"BBB\") After code run\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MBQgY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MBQgY.png\" alt=\"Sheet(&quot;BBB&quot;) After code run\"></a></p>\n\n<pre><code>Immediate Window after code run\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vNoPv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vNoPv.png\" alt=\"Immediate window after code run\"></a></p>\n"}], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 49770747, "answer_count": 2, "score": 0, "last_activity_date": 1523461256, "creation_date": 1523430372, "last_edit_date": 1523456243, "question_id": 49768593, "link": "https://stackoverflow.com/questions/49768593/looping-findnext-inside-another-loop-find", "title": "Looping findnext inside another loop &amp; find", "body": "<p>I have used a loop to find the closest name to a supplier from Sheet 1 out of Sheet 2. </p>\n\n<pre><code>Dim LastRow As Long\nLastRow = Sheets(\"BBB\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nDim i As Integer\nFor i = 2 To LastRow\nDim ra As Range\nDim a, k As Integer\na = Len(Sheets(\"BBB\").Range(\"A\" &amp; i))   \n\nDo\nSet ra = Sheets(\"AAA\").Cells.Find(What:=Left(Range(\"A\" &amp; i), a), LookIn:=xlValues, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n\n\na = a - 1\n\nLoop Until Not ra Is Nothing Or a = 3\n\nIf ra Is Nothing Then\nSheets(\"BBB\").Range(\"C\" &amp; i).Value = a\nElse\nSheets(\"BBB\").Range(\"B\" &amp; i).Value = ra.Value\n</code></pre>\n\n<p>It works great but now I am thinking that It is possible that some occurences are twice in the sheet \"AAA\"</p>\n\n<p>Example: \nSupplier in Sheet BBB: \"SICK\"\nIf Sheet AAA has 2 suppliers: \"SICK\" and \"NOSICKHERE LTD\"\nMy code will only find one of the two supplier but will not return both. </p>\n\n<p>How can I use findnext to find all occurences? \nAnyone see a better solution? </p>\n\n<p>I tried to use the following at the bottom of my code before the \"next i\", but I fail to use the findnext</p>\n\n<pre><code>Dim firstCellAddress As String\nfirstCellAddress = ra.Address\n\nk = 1\nDo\n\n    Set ra = Sheets(\"AAA\").Cells.FindNext()\n    Sheets(\"BBB\").Cells(i, 2 + k).Value = ra.Value\n\n    k = k + 1\n\nLoop While firstCellAddress &lt;&gt; ra.Address\n</code></pre>\n\n<p>Please tell me if my question is too hard to understand</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523430584, "post_id": 49768249, "comment_id": 86552409, "body": "max startdate? , max enddate? Where is it looking for dates? Column E currently holds start date so are you overwriting this? In which case you might introduce a circular reference. Column E also likely feeds into the gantt formatting."}, {"owner": {"reputation": 1, "user_id": 9623261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "npn", "link": "https://stackoverflow.com/users/9623261/npn"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523436217, "post_id": 49768249, "comment_id": 86555750, "body": "Hi QHarr. Thanks for your reply. You are correct, that it may cause some circular references. I am sure that I can fix this with some extra columns. However, I do not think that circular references is the issue here."}, {"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1523437018, "post_id": 49768249, "comment_id": 86556280, "body": "Use the step through mechanism to find exactly where your error is. It is difficult to know what to look for otherwise. Then debug from there."}], "owner": {"reputation": 1, "user_id": 9623261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "npn", "link": "https://stackoverflow.com/users/9623261/npn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1523429143, "creation_date": 1523429143, "question_id": 49768249, "link": "https://stackoverflow.com/questions/49768249/vba-code-like-maxif", "title": "VBA code like maxif", "body": "<p>I have a VBA challenge, I have spent quite some time trying to solve. I am using the project management template sheet that is to be found on this link:\n<a href=\"https://www.vertex42.com/ExcelTemplates/excel-gantt-chart.html\" rel=\"nofollow noreferrer\">https://www.vertex42.com/ExcelTemplates/excel-gantt-chart.html</a></p>\n\n<p>In this I would like to make a function, that finds the minimum and max date of the levels below automatically. </p>\n\n<p>E.g. in row 8 where the WBS is 1, I would like a function in column E that finds the max date of all the rows that start with 1 (e.g. 1.1, 1.2, 1.3)</p>\n\n<p>I have tried this:</p>\n\n<pre><code>Function maxIfs(maxRange As Range, criteriaRange As Range, criterion As \\Variant) As Variant\n\nmaxIfs = Empty\n For i = 1 To maxRange.Cells.count\n  If Left(criteriaRange.Cells(i).text, findN(criteriaRange.Cells(i).value)) = Criteria.value Then\n    If maxIfs = Empty Then\n        maxIfs = maxRange.Cells(i).value\n    Else\n        maxIfs = Application.WorksheetFunction.Max(maxIfs, maxRange.Cells(i).value)\n    End If\n End If\nNext\nEnd Function\n\nFunction findN(text As Variant) As Integer\n'Gives the position of the nth delimiter\n\nDim found As Integer\nDim place As Integer\n\nfound = 0\nplace = 0\n\nFor i = 1 To Len(text) + 1 ' Add 1 as we start at 1 not zero\n    place = found 'this will be 0 the first time round\n    found = InStr(found + 1, text, \".\")\nNext i\n\nfindN = place\nEnd Function\n</code></pre>\n\n<p>I think the issue with the code is, that the WBS column is a function, and therefore there is some issues with the if statement. However, I am not sure if this is true, or how to solve this. Do you have any suggestions? </p>\n"}, {"tags": ["vba", "ms-access", "variables", "eval"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1523427486, "creation_date": 1523427486, "answer_id": 49767799, "question_id": 49767588, "link": "https://stackoverflow.com/questions/49767588/access-vba-eval-variable/49767799#49767799", "title": "Access vba eval variable", "body": "<p>You can't use Eval to set a variable <em>within</em> the expression. If you write it like this:</p>\n\n<pre><code>Path = Calcu.Eval(\"E:\\tables\")\n</code></pre>\n\n<p>you'll get the answer in the Path variable. Obviously, this is the same as</p>\n\n<pre><code>Path = \"E:\\tables\"\n</code></pre>\n\n<p>but that is a different topic. If you want the variable name to be dynamic as well, then you are probably doing something wrong. If you <em>really</em> want it, the you need to have a look at VBIDE.VBProject, but don't go there until you have a fairly good understanding of VBA.</p>\n"}], "owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 49767799, "answer_count": 1, "score": -1, "last_activity_date": 1593955490, "creation_date": 1523426521, "last_edit_date": 1593955490, "question_id": 49767588, "link": "https://stackoverflow.com/questions/49767588/access-vba-eval-variable", "title": "Access vba eval variable", "body": "<p>I created a string Path=\"E:\\\" to assign a value to a variable with Eval. But it returned a run-time error 2766: This object cannot contain 'automatic' object 'Path'.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ilTbn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ilTbn.png\" alt=\"Eval variable\"></a></p>\n\n<p>Is there a way that I can work on variables with string? I have strings of variables and strings of values. This would save me lot of time.</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "excel", "datetime"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7505921, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZtaYJSx72H8/AAAAAAAAAAI/AAAAAAAAAB8/VZ6103CwDGg/photo.jpg?sz=128", "display_name": "Matan Retzer", "link": "https://stackoverflow.com/users/7505921/matan-retzer"}, "edited": false, "score": 0, "creation_date": 1523427958, "post_id": 49767659, "comment_id": 86551039, "body": "EXACTLY what I needed. Thanks a lot."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1523426872, "creation_date": 1523426872, "answer_id": 49767659, "question_id": 49767499, "link": "https://stackoverflow.com/questions/49767499/convert-date-type-sun-apr-01-000000-utc-2018-in-excel-vba-as-a-custom-functi/49767659#49767659", "title": "Convert date type (Sun Apr 01 00:00:00 UTC 2018) in excel VBA as a custom function", "body": "<pre><code>Function MyDate(val As Variant)\n    MyDate = DateValue(Mid(val, 8, 3) &amp; \"-\" &amp; Mid(val, 4, 4) &amp; \"-\" &amp; Right(val, 4))\nEnd Function\n</code></pre>\n\n<p>so you can type in any cell <code>=MyDate(A2)</code> (or whatever, cell reference you need)</p>\n"}], "owner": {"reputation": 65, "user_id": 7505921, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZtaYJSx72H8/AAAAAAAAAAI/AAAAAAAAAB8/VZ6103CwDGg/photo.jpg?sz=128", "display_name": "Matan Retzer", "link": "https://stackoverflow.com/users/7505921/matan-retzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 49767659, "answer_count": 1, "score": 1, "last_activity_date": 1523427189, "creation_date": 1523426162, "last_edit_date": 1523427189, "question_id": 49767499, "link": "https://stackoverflow.com/questions/49767499/convert-date-type-sun-apr-01-000000-utc-2018-in-excel-vba-as-a-custom-functi", "title": "Convert date type (Sun Apr 01 00:00:00 UTC 2018) in excel VBA as a custom function", "body": "<p>I need to create a custom function based on the formula:\n<code>=DATEVALUE(CONCATENATE(MID(A2,8,3),MID(A2,4,4),RIGHT(A2,4)))</code></p>\n\n<p>where A2= <code>Sun Apr 01 00:00:00 UTC 2018</code></p>\n\n<p>And the result should be: <code>43191</code></p>\n\n<p>I also need that this function will be available anywhere in excel</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1523434308, "last_edit_date": 1523434308, "creation_date": 1523433872, "answer_id": 49769687, "question_id": 49767153, "link": "https://stackoverflow.com/questions/49767153/what-is-the-different-between-xlfileformat-enumeration-code-4143-and-56/49769687#49769687", "title": "What is the different between `XlFileFormat` enumeration code -4143 and 56?", "body": "<p>Well the <code>xlExcel8 = 56</code> for <em>Excel 97-2003 Workbook</em> only exists in Excel 2007 or later, where <code>xlWorkbookNormal = -4143</code> for <em>Workbook normal</em> exists also in prior versions.</p>\n\n<p>So e.g. in Excel 95 <code>xlWorkbookNormal</code> would produce an <em>Excel 95 Workbook</em> but in Excel 97 it produces a <em>Excel 97 Workbook</em>. While <code>xlExcel8</code> always produces a <em>Excel 97-2003 Workbook</em>. In newer versions both produce a <em>Excel 97-2003 Workbook</em></p>\n\n<p>If you want a specific format always use the specific enumeration eg <code>xlExcel8</code> to ensure it. But to make your code compatible to versions below 2007 you should use <code>xlWorkbookNormal</code> then.</p>\n\n<p>So you see it depends on your actual Excel version which workbook <code>xlWorkbookNormal</code> produces.</p>\n"}], "owner": {"reputation": 97, "user_id": 8913302, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I6XC6h9opjk/AAAAAAAAAAI/AAAAAAAAAgY/nvAE8IwG7as/photo.jpg?sz=128", "display_name": "johan indra Permana", "link": "https://stackoverflow.com/users/8913302/johan-indra-permana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 49769687, "answer_count": 1, "score": 2, "last_activity_date": 1523434308, "creation_date": 1523424521, "question_id": 49767153, "link": "https://stackoverflow.com/questions/49767153/what-is-the-different-between-xlfileformat-enumeration-code-4143-and-56", "title": "What is the different between `XlFileFormat` enumeration code -4143 and 56?", "body": "<p>what i see from this <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlfileformat-enumeration-excel\" rel=\"nofollow noreferrer\">xlfileformat-enumeration-excel</a> there are different 'xls' code enumeration.\nfrom the list shown, there is code -4143 (Workbook normal) and 56 (Excel 97-2003 Workbook). both produce the same format 'xls'.\nthe question is what is the difference and which code is the best ?</p>\n"}, {"tags": ["excel", "search", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1523425939, "post_id": 49766981, "comment_id": 86550103, "body": "It&#39;s not clear from your one line of code what you&#39;re trying to do here.  Your code will error though if &quot;apples&quot; is not found."}, {"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1523426076, "post_id": 49766981, "comment_id": 86550168, "body": "I have thought about the question. The simplist way i can say what i want to do is: count up column E and if &quot; apples&quot; appears do this.... In terms of if apples is not found thats ok. Im testing in an environment ahere it will always show up"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1523494646, "post_id": 49767541, "comment_id": 86588163, "body": "Yes! This is so close. But i only want you find the first instance of the type of fruit. Example: i have headings of apples, bananas and oranges. Right now everything is being called an apple because its the 1st heading of the list"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1523494879, "post_id": 49767541, "comment_id": 86588210, "body": "Ok but we have no idea what you&#39;re really trying to do here.  <i>If you want specific help</i> it would be a good idea to (1) show the rest of your code and (2) show an example before/after set of data"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1523426326, "creation_date": 1523426326, "answer_id": 49767541, "question_id": 49766981, "link": "https://stackoverflow.com/questions/49766981/if-statement-for-if-the-most-previous-specific-word-is-found/49767541#49767541", "title": "If Statement for if the most previous specific word is found", "body": "<p>If you just want to know if \"apples\" was found or not in a range:</p>\n\n<pre><code>Dim f As Range\n\nSet f = Fruit.Range(\"E1:E\" &amp; i).Find(what:=\"apples\", _\n                          searchorder:=xlByRows, _\n                          searchdirection:=xlPrevious)\nIf Not f Is Nothing Then\n    'do stuff\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1523426823, "creation_date": 1523426823, "answer_id": 49767651, "question_id": 49766981, "link": "https://stackoverflow.com/questions/49766981/if-statement-for-if-the-most-previous-specific-word-is-found/49767651#49767651", "title": "If Statement for if the most previous specific word is found", "body": "<p>I don't understand exactly what you are trying to do, but I think this will let you solve your problem (necessary comments in code):</p>\n\n<pre><code>Sub MyMacro()\n    Dim i As Long, j As Long, lastCol As Long, lastRow As Long\n    'determine last row in E column\n    lastRow = Cells(Rows.Count, 5).End(xlUp).Row\n    'loop thorugh E column\n    For i = 1 To lastRow\n        'perform case-insensitive search\n        If InStr(1, LCase(Cells(i, 5).Value), \"apple\") &gt; 0 Then\n            'determine last column in a row\n            lastCol = Cells(i, Columns.Count).End(xlToLeft).Column\n            'loop through row\n            For j = 6 To lastCol\n                'do something with values in a row\n            Next\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1523426823, "creation_date": 1523423744, "last_edit_date": 1531161705, "question_id": 49766981, "link": "https://stackoverflow.com/questions/49766981/if-statement-for-if-the-most-previous-specific-word-is-found", "title": "If Statement for if the most previous specific word is found", "body": "<p>I have converted data from a text file to excel in a way that each word has its own cell. The data is a list and the heading of each of the repsective list data is found in column E.</p>\n\n<p>The amount of data is random in the fact that there may be 10 data points under the 1st heading but then 30 under the next.</p>\n\n<p>My end goal is to have a excel sheet that has the data under neat headings. I have most of it all put together but what ai am trying to do is use a loop to count down all the rows and  if \"apples\" is found to be the most previous fruit type in column E then past the respective data on a different sheet. The issue I am having is the counting up to the preivous word i believe. Here is the code i am using for that part.</p>\n\n<pre><code>If Fruit.Range(E1, \"E\" &amp; i).Find(what:=\"apples\", _\n                          searchorder:=xlByRows, _\n                          searchdirection:=xlPrevious).Row Then\n</code></pre>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1523420910, "post_id": 49765764, "comment_id": 86548393, "body": "You could get the old value before the change and compare it with the new value -- see <a href=\"https://stackoverflow.com/questions/4668410/how-do-i-get-the-old-value-of-a-changed-cell-in-excel-vba\">here</a>."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1523420939, "post_id": 49765764, "comment_id": 86548398, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4668410/how-do-i-get-the-old-value-of-a-changed-cell-in-excel-vba\">How do I get the old value of a changed cell in Excel VBA?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1523416683, "creation_date": 1523416683, "answer_id": 49765944, "question_id": 49765764, "link": "https://stackoverflow.com/questions/49765764/worksheet-change-i-do-not-want-it-to-activate-when-value-in-cell-does-not-chang/49765944#49765944", "title": "Worksheet_change: i do not want it to activate when value in cell does not change", "body": "<p>You either have to:</p>\n\n<ol>\n<li>Educate users to push Escape rather than Enter if they have gone\ninto Edit mode but have changed their mind; or</li>\n<li>Make a copy of the range, check the value against the copy and if\nthey've made changes, update the copy with the new value and change\nthe original cell color.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1523421306, "creation_date": 1523421306, "answer_id": 49766563, "question_id": 49765764, "link": "https://stackoverflow.com/questions/49765764/worksheet-change-i-do-not-want-it-to-activate-when-value-in-cell-does-not-chang/49766563#49766563", "title": "Worksheet_change: i do not want it to activate when value in cell does not change", "body": "<p>Please give this a try...</p>\n\n<pre><code>Dim oVal\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Target.CountLarge &gt; 1 Then Exit Sub\nIf Not Intersect(Target, Range(\"A1:Z200\")) Is Nothing Then\n    If Target &lt;&gt; oVal Then\n        Range(Target.Address).Interior.ColorIndex = 43\n        oVal = Target\n    End If\nEnd If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.CountLarge &gt; 1 Then Exit Sub\nIf Not Intersect(Target, Range(\"A1:Z200\")) Is Nothing Then\n    oVal = Target.Value\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 639, "user_id": 8282103, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71ad01e7729a22c4ab2c96ff8c9f022f?s=128&d=identicon&r=PG&f=1", "display_name": "Gen Tan", "link": "https://stackoverflow.com/users/8282103/gen-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1523421306, "creation_date": 1523415348, "question_id": 49765764, "link": "https://stackoverflow.com/questions/49765764/worksheet-change-i-do-not-want-it-to-activate-when-value-in-cell-does-not-chang", "title": "Worksheet_change: i do not want it to activate when value in cell does not change", "body": "<p>Currently, I am using worksheet_change to automatically change cell colours when a user makes any changes to a cell's value. However, my <code>else</code> clause runs when a user enters and leaves a cell without changing the cell's value (User probably double clicked a cell, then clicked on a different cell instead of pressing escape.) . How can I amend my code so that the <code>Else</code> clause only runs if the user has made changes to the cell's value? </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Target, Range(\"A1:Z200\")) Is Nothing Or Target.Cells.Count &gt; 1 Then\n\nExit Sub\n\nElse\n\nRange(Target.Address).Interior.ColorIndex = 43\n\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "count"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523520005, "post_id": 49765540, "comment_id": 86596805, "body": "Please share some data and expected outcome."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "edited": false, "score": 0, "creation_date": 1523505213, "post_id": 49766041, "comment_id": 86590441, "body": "for trail purpose , made a sheet with 5 is Range(&quot;A1:A10&quot;)   trying to get message return 10  with below code:"}, {"owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "edited": false, "score": 0, "creation_date": 1523505267, "post_id": 49766041, "comment_id": 86590449, "body": "Sub Find_the_value() Dim i As Integer i = 0  For Each Cl In ActiveSheet.Range(&quot;A1:A10&quot;)    If Cl.Value = 5 Then   i = i + 1   Exit For  End If Next Cl  MsgBox i End Sub"}, {"owner": {"reputation": 103, "user_id": 4256814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x90Zq.png?s=128&g=1", "display_name": "LiceRewis", "link": "https://stackoverflow.com/users/4256814/licerewis"}, "reply_to_user": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "edited": false, "score": 0, "creation_date": 1523507521, "post_id": 49766041, "comment_id": 86591078, "body": "Added your code to the answer. It works, but is too hard to read in the comment. Also added Cl as a declared variable."}, {"owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "edited": false, "score": 0, "creation_date": 1523511975, "post_id": 49766041, "comment_id": 86592571, "body": "thank you for your response .    it is not working,   message box return &quot;1&quot;  to me , i expect it return 10"}, {"owner": {"reputation": 103, "user_id": 4256814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x90Zq.png?s=128&g=1", "display_name": "LiceRewis", "link": "https://stackoverflow.com/users/4256814/licerewis"}, "reply_to_user": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "edited": false, "score": 0, "creation_date": 1523518057, "post_id": 49766041, "comment_id": 86595705, "body": "Fixed it - the &quot;Exit For&quot; should not have been in the If statement. That meant the routine was ending on the first loop. This should work now."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1523520033, "post_id": 49766041, "comment_id": 86596823, "body": "Use Long rather than Integer."}], "tags": [], "owner": {"reputation": 103, "user_id": 4256814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x90Zq.png?s=128&g=1", "display_name": "LiceRewis", "link": "https://stackoverflow.com/users/4256814/licerewis"}, "is_accepted": false, "score": 0, "last_activity_date": 1523518001, "last_edit_date": 1523518001, "creation_date": 1523417306, "answer_id": 49766041, "question_id": 49765540, "link": "https://stackoverflow.com/questions/49765540/vba-any-way-to-count-number-of-success-match-of-vlookup-index-match/49766041#49766041", "title": "VBA any way to count number of success match of vlookup/ index match", "body": "<p>Have you got the existing code? It should be relatively straightforward to declare an integer and increment it each time the match is found.</p>\n\n<p>EDIT:</p>\n\n<pre><code>Sub Find_the_value()\n\n    Dim i As Integer\n    Dim Cl As Range\n\n    i = 0\n\n    For Each Cl In ActiveSheet.Range(\"A1:A10\")\n\n        If Cl.Value = 5 Then\n\n            i = i + 1\n\n        End If\n\n    Next Cl\n\n    MsgBox i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1523520144, "creation_date": 1523413620, "last_edit_date": 1523520144, "question_id": 49765540, "link": "https://stackoverflow.com/questions/49765540/vba-any-way-to-count-number-of-success-match-of-vlookup-index-match", "title": "VBA any way to count number of success match of vlookup/ index match", "body": "<p>using index match to copy data from table 2 to table1 if name (exist in table 1 and 2) is matched.</p>\n\n<p>any way I could count how many matched is made after a run of the sub?</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Find_the_value() \n\n    Dim i As Integer \n    i = 0 \n\n    For Each Cl In ActiveSheet.Range(\"A1:A10\") \n        If Cl.Value = 5 Then \n            i = i + 1 \n            Exit For \n        End If \n    Next Cl \n    MsgBox i \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "ms-access", "variables"], "comments": [{"owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523413202, "post_id": 49765412, "comment_id": 86546520, "body": "to loop through the table"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523413302, "post_id": 49765412, "comment_id": 86546534, "body": "That&#39;s not how variables are declared, or assigned values.  I&#39;d suggest you start with a tutorial about using variables <a href=\"https://powerspreadsheets.com/declare-variables-vba-excel/\" rel=\"nofollow noreferrer\">like this one</a> - then there&#39;s a good chance you&#39;ll be able to solve this issue yourself."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523413506, "post_id": 49765412, "comment_id": 86546574, "body": "After that, look for examples of how to loop through a table.  For starters there are a number of examples <a href=\"https://stackoverflow.com/q/5864160/8112776\">on this question</a> (which was the first result in a Google search for <a href=\"https://www.google.ca/search?q=access+loop+through+a+table\" rel=\"nofollow noreferrer\">&quot;loop through an Access table&quot;</a>.  <b>Please,</b> you need to <b>at least attempt to solve a problem yourself with a bit of research</b> before posting a question."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523413533, "post_id": 49765412, "comment_id": 86546582, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5864160/code-to-loop-through-all-records-in-ms-access\">Code to loop through all records in MS Access</a>  I&#39;d suggest you <b>delete this question</b> (otherwise it will be closed anyway but just creates work for more people) and after you have researched, tried a few things, if you&#39;re still having issues then ask a new question but first <b>read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and well as &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;  and also <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>.</b>"}, {"owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523413858, "post_id": 49765412, "comment_id": 86546666, "body": "dude, I know how to loop through a table with ADO or DAO recordset.  And I know how to delcare a variable and assgin it with a value. My question is how to assign values to variables when boths of them are in a table. Obviously you have to loop through a table to do so. But I dont know how and if anyone did it before. Otherwise I will have to type Dim variable1 as string , and variable1=&quot;value1&quot;.....many times/."}, {"owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523414239, "post_id": 49765412, "comment_id": 86546766, "body": "AND PLEASE UNDERSTAND MY QUESTION CAREFULLY!!"}, {"owner": {"reputation": 560, "user_id": 9513937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvf4N.jpg?s=128&g=1", "display_name": "sunsetsurf", "link": "https://stackoverflow.com/users/9513937/sunsetsurf"}, "edited": false, "score": 0, "creation_date": 1523415983, "post_id": 49765412, "comment_id": 86547181, "body": "Are you wanting to add a calculated field to a table so as if one of the fields the calculation is based on changes the field updates; or insert data into a field in an automated way such as a query as in field myDSN for all records (or where record field = x) are set to &quot;B&quot;?"}], "owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593955496, "creation_date": 1523412696, "last_edit_date": 1593955496, "question_id": 49765412, "link": "https://stackoverflow.com/questions/49765412/access-vba-loop-through-a-table-to-assign-values-to-variables", "title": "Access vba loop through a table to assign values to variables", "body": "<p>I have a table as below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bDRQ4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bDRQ4.png\" alt=\"Table with variables and values\"></a></p>\n\n<p>I would like to assign values to variables by looping through the table,</p>\n\n<pre><code>myDSN=\"B\"\nPassword=\"D\". \n</code></pre>\n\n<p>I can loop through the table wiht DAO recordset. I tried <code>daRs!AAA =\"\"\"&amp; daRs!AAB&amp;\"\"\"</code> and it obviously did not work becuase VBA thinks that I was trying to update the table. Any idea how to loop through this table to assign values to variables, both of which are in a table?</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 11, "user_id": 9627889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba2c1f147ab6a2a77af3be129dbbc4?s=128&d=identicon&r=PG&f=1", "display_name": "Pachino", "link": "https://stackoverflow.com/users/9627889/pachino"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523413803, "post_id": 49765332, "comment_id": 86546653, "body": "Sorry I think it&#39;s more clear now. I have several PowerPoint presentation, I have the list of the path of each one in an excel workbook."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1523499463, "post_id": 49765332, "comment_id": 86589173, "body": "Yes, you could do this with VBA, and if you run into trouble doing it, people here will try to help you fix problems with your code. They will not write your code for you."}], "owner": {"reputation": 11, "user_id": 9627889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ba2c1f147ab6a2a77af3be129dbbc4?s=128&d=identicon&r=PG&f=1", "display_name": "Pachino", "link": "https://stackoverflow.com/users/9627889/pachino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1523413713, "creation_date": 1523411884, "last_edit_date": 1523413713, "question_id": 49765332, "link": "https://stackoverflow.com/questions/49765332/open-and-modify-a-powerpoint-presentation-from-a-list-in-excel-the-path-of-each", "title": "Open and modify a powerpoint presentation from a list in excel (the path of each ppt is in a list)", "body": "<p>I have several powerpoint presentations listed in column A, a title and a text in column B and C and the path of a picture in column D.\nCan I use VBA to open each file from column A and update the second slide with title and text of column B and C and then insert picture of column D to the third slide?</p>\n\n<p><a href=\"https://i.stack.imgur.com/eT74T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eT74Tm.png\" alt=\"Example\"></a></p>\n"}, {"tags": ["vba", "excel", "listbox", "listbox-control"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523411944, "post_id": 49765217, "comment_id": 86546206, "body": "Please add the relevant code to your question, indicating the line where you&#39;re getting the error.  Note that a compile error is not the same as a runtime error.  The code hasn&#39;t started to run yet since it can&#39;t compile properly.  It&#39;s unlikely that it runs <i>sometimes</i> when there are no changes made to the workbook in between the attempts."}, {"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523412229, "post_id": 49765217, "comment_id": 86546266, "body": "Your right, I do not think the code is running, due to not compiling.  I have tried saving the workbook with different selections, sometimes it opens without a hitch.  I cannot pinpoint why sometimes it cannot compile.  Sorry for the silly question, how can I enter code now that I have posted the question.  It is quite a lot of code and the always highlights the same line, even thought listbox2 is referenced several times"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523412804, "post_id": 49765217, "comment_id": 86546416, "body": "<b>Do not</b> post &quot;a lot of code&quot;.  You can <a href=\"https://stackoverflow.com/posts/49765217/edit\">edit</a> your question (with the <a href=\"https://stackoverflow.com/posts/49765217/edit\">edit</a> link) to add only the relevant code. (See &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;.)   Perhaps your first step should be to add the line <code>Option Explicit</code> to the very top of the module (and every module, always) and then try compiling the code to see if that sheds some light on which variables/objects you have not properly declared.  Note that it will probably produce several errors that you need to fix one at a time; this is a good thing."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523412808, "post_id": 49765217, "comment_id": 86546418, "body": "...One way or another, you are not referring to <code>listbox2</code> properly, maybe an undeclared variable or object?  (Also, the compiler will only stop on the first error in the module regardless of how many times you have used it...  It &quot;doesn&#39;t know&quot; about the other errors yet because it hasn&#39;t made it past your first mistake yet.)"}, {"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523413961, "post_id": 49765217, "comment_id": 86546696, "body": "I did not know what option explicit was until now, just googled and it is great advice.  I have not managed to fix the initial error though"}, {"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523421709, "post_id": 49765217, "comment_id": 86548662, "body": "The option explicit errors that popped up after I added, have now all gone, however this listbox issue is only an issue when the book is opened, and not every time. Driving me crazy. The code above that is throwing the error is not the first mention of ListBox2"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523421778, "post_id": 49765217, "comment_id": 86548679, "body": "so, do you have a listbox called <code>Listbox2</code> ?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523422254, "post_id": 49765217, "comment_id": 86548805, "body": "The problem has got to be either: you don&#39;t have a worksheet called <code>Sheet3</code>, or you don&#39;t have an ActiveX listbox called <code>ListBox2</code>."}, {"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523422326, "post_id": 49765217, "comment_id": 86548826, "body": "I do yes, I have not called it anything, other than its default name that is ListBox2.  Thanks so much for assisting me here"}, {"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523422414, "post_id": 49765217, "comment_id": 86548862, "body": "Sheet3 is also called graphs.  I tried With Graphs.ListBox2 and With Sheets(&quot;Graphs&quot;).ListBox2"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523422454, "post_id": 49765217, "comment_id": 86548879, "body": "How do you know it&#39;s an ActiveX listbox, and how do you know it&#39;s called Listbox2.  (Sounds like silly questions but its part of troubleshooting)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523422490, "post_id": 49765217, "comment_id": 86548892, "body": "What do you mean Sheet3 is also called Graphs?    A Worksheet has one name. All objects have only one name.  If the worksheet that Listbox2 is on, is called Graphs, then you need to change that in your code. <code>With Graphs.ListBox2</code>.  Also get rid of the <code>Dim ... As ListObject</code> line you added."}, {"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523422949, "post_id": 49765217, "comment_id": 86549020, "body": "I added the box from the active x section.  When I click on Design Mode, in the name box in the top left, it is called ListBox2.  Not silly at all, anything to troubleshoot.  I have renamed sheet3 to &#39;Graphs&#39;.  I also have Dim Graphs as Worksheet and Set Graphs = Sheets(&quot;Graphs&quot;)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523423487, "post_id": 49765217, "comment_id": 86549168, "body": "See the answer below.  It&#39;s <i>got</i> to be one of those things.  However I would <i>not</i> recommend randomly adding variab\\les like <code>Graphs</code>.  Please remove anything you&#39;ve done like that <b>or</b> for Sheet3 <b>or</b> for Listbox2 etc etc"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523423875, "post_id": 49765217, "comment_id": 86549273, "body": "See the answer below.  It&#39;s <i>got</i> to be one of those things.  However I would <i>not</i> recommend randomly adding variables like <code>Graphs</code>.  Please remove anything you&#39;ve done like that <b>or</b> for <code>Sheet3</code> <b>or</b> for Listbox2 etc etc.  <code>Sheet3</code> and <code>Listbox2</code> should <b>not</b> be declared anywhere."}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 0, "last_activity_date": 1523424861, "last_edit_date": 1523424861, "creation_date": 1523422829, "answer_id": 49766813, "question_id": 49765217, "link": "https://stackoverflow.com/questions/49765217/listbox-error-on-open/49766813#49766813", "title": "Listbox error on open", "body": "<h2>Either:</h2>\n\n<ul>\n<li><p>You don't have a listbox called <code>Listbox2</code>, <em>or,</em></p></li>\n<li><p><code>Listbox2</code> is not on a worksheet called <code>Sheet3</code></p></li>\n</ul>\n\n<p>Double check that you're referencing the objects by the correct names.</p>\n\n<p><strong>To confirm the name of the listbox:</strong></p>\n\n<ul>\n<li><p>click <code>Developer</code> > <code>Design Mode</code> > <code>Right click</code> the listbox > <code>Properties</code></p></li>\n<li><p>If it's an ActiveX listbox it will have a property list <em>just</em> like the one below:</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/D7i8C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D7i8C.png\" alt=\"img\"></a></p>\n\n<ul>\n<li>Click the name in the <code>(Name)</code> field in the properties dialog.  Make sure there are no extra <strong>spaces</strong> at the beginning or end of the name.</li>\n</ul>\n\n<p><strong>To confirm the name of the worksheet:</strong></p>\n\n<p>Double-click the tab at the bottom of the worksheet.  Make sure there are no extra <strong>spaces</strong> at the beginning or end of the name.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0bH8N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0bH8N.png\" alt=\"img\"></a></p>\n\n<hr>\n\n<p>If you <em>still</em> can't see the problem:</p>\n\n<ul>\n<li><p>Rename <code>Listbox2</code> to <code>Listbox222</code> in the ActiveX properties dialog.</p></li>\n<li><p>Double click the tab for <code>Sheet3</code> and type <code>Sheet333</code>.</p></li>\n<li><p>Change the reference that was causing the error to <code>Sheet333.Listbox222</code></p></li>\n</ul>\n\n<hr>\n\n<h2>More Information</h2>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/a/49263001/8112776\"><strong>Overview of working with Form Controls &amp; Active controls programmatically</strong></a> (with VBA)</li>\n</ul>\n"}], "owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 49766813, "answer_count": 1, "score": 1, "last_activity_date": 1523424861, "creation_date": 1523411141, "last_edit_date": 1531164843, "question_id": 49765217, "link": "https://stackoverflow.com/questions/49765217/listbox-error-on-open", "title": "Listbox error on open", "body": "<p>Hello Stackoverflow community</p>\n\n<p>I require help with a ListBox error.</p>\n\n<p>I have two ListBoxes in a worksheet (single select) &amp; not in a userform</p>\n\n<p>ListBox1 - contains primary items </p>\n\n<p>ListBox2 - contains sub items associated with the primary items</p>\n\n<p>When a primary item is selected -</p>\n\n<ul>\n<li><p>If no sub items exist, ListBox2.Visible = False</p></li>\n<li><p>If sub items exist, ListBox2.Visible = True and .ListIndex = -1 (ready for sub item selection)</p></li>\n</ul>\n\n<p>Code runs perfectly when using the workbook</p>\n\n<p>Issue\nWhen workbook is opened, the macro linked to ListBox1 will run automatically and and error will pop up, highlighting in blue '.ListBox2'</p>\n\n<p>Error = 'Compile Error: Method or Data Member not found'</p>\n\n<p>The Error does not happen all the time, and does not matter if the workbook is saved with ListBox2 visible or not, or a sub item selected or not.</p>\n\n<p>I have tried using on open workbook events, but the error comes before these events.</p>\n\n<p>Please help</p>\n\n<p>Added code where error occurs</p>\n\n<pre><code>Dim ListBox2 As ListObject 'Added this in to see if it fixes error but it has not\n\n    With Sheet3.ListBox2\n        .Height = 208.5\n        .Width = 126.75\n        .Top = 312.75\n        .Left = 31.5\n        .Visible = False\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1523410524, "creation_date": 1523410524, "answer_id": 49765129, "question_id": 49764858, "link": "https://stackoverflow.com/questions/49764858/vba-copy-row-from-sheet1-to-sheet2-based-on-keyword/49765129#49765129", "title": "VBA copy row from sheet1 to sheet2 based on keyword", "body": "<p>If you copy and paste whole rows, they will always start in column A. If you want the result to start in column B, you need a different approach, for example</p>\n\n<pre><code>Sheets(\"Results\").Range(\"B\" &amp; countRows2 &amp; \":Z\" &amp; countRows2).Value = Sheets(\"Data\").Range(\"A\" &amp; j &amp; \":Y\" &amp; j).Value\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9627796, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Clint Audiffred", "link": "https://stackoverflow.com/users/9627796/clint-audiffred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 49765129, "answer_count": 1, "score": 2, "last_activity_date": 1523410524, "creation_date": 1523408268, "last_edit_date": 1523409538, "question_id": 49764858, "link": "https://stackoverflow.com/questions/49764858/vba-copy-row-from-sheet1-to-sheet2-based-on-keyword", "title": "VBA copy row from sheet1 to sheet2 based on keyword", "body": "<p>My code does what I want, but it copies it to column A in sheet 2. I would like it to put the data in starting at Column B if possible.</p>\n\n<pre><code>Sub EFP()\nDim keyword As String: keyword = Sheets(\"Results\").Range(\"B3\").Value\nDim countRows1 As Long, countRows2 As Long\ncountRows1 = 3 'the first row of my dataset in the Data tab\nendRows1 = 500 'the last row of my dataset in the Data tab\ncountRows2 = 6 'the first row where I want to start writing the found rows\nFor j = countRows1 To endRows1\n    If Sheets(\"Data\").Range(\"B\" &amp; j).Value = keyword Then\n        Sheets(\"Results\").Rows(countRows2).Value = Sheets(\"Data\").Rows(j).Value\n        countRows2 = countRows2 + 1\n    End If\nNext j\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["ms-access", "error-handling", "vba"], "comments": [{"owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1523428973, "post_id": 49764782, "comment_id": 86551530, "body": "It kind of depends on why the error is happening. Initially, I would recommend changing the msgbox in the error handler to: MsgBox Err.Description,, &quot;cmdEmail_Click: &quot; &amp; err.Number . This will give you the error number in the title bar of the message box when there is an error. Then you can use that error number to either a) research and fix, or b) do an select case err.number code block, and have custom error handling for just that one error."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9133536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deac16de4ff906edd8a69bbb89b8b89f?s=128&d=identicon&r=PG&f=1", "display_name": "mupton", "link": "https://stackoverflow.com/users/9133536/mupton"}, "edited": false, "score": 0, "creation_date": 1523507830, "post_id": 49771822, "comment_id": 86591170, "body": "almost there, it works fist time, but if i cancel a future email, it freezes again.  almost there i think"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1523440072, "creation_date": 1523440072, "answer_id": 49771822, "question_id": 49764782, "link": "https://stackoverflow.com/questions/49764782/email-cancelled-error-handler/49771822#49771822", "title": "Email cancelled Error handler", "body": "<p>You need to make sure that the clean-up code (closing the hidden report) still runs, even after an error. </p>\n\n<p>In cases like this I prefer to use \"inline\" error handling, like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'opens report (hidden) based on Current Form view\nDoCmd.OpenReport \"EngDetailRpt\", acViewPreview, \"\", \"[TAG_NAME]='\" &amp; Me!TAG_NAME &amp; \"'\", acHidden\n\n' inline error handling\nOn Error Resume Next\nDoCmd.SendObject acSendReport, \"EngDetailRpt\", acFormatPDF\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox Err.Description, vbExclamation, \"Runtime-Error \" &amp; Err.Number &amp; \" on SendObject\"\nEnd If\nOn Error GoTo cmdEmail_Click_Err\n\nDoCmd.Close acReport, \"EngDetailRpt\", acSaveNo\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9133536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deac16de4ff906edd8a69bbb89b8b89f?s=128&d=identicon&r=PG&f=1", "display_name": "mupton", "link": "https://stackoverflow.com/users/9133536/mupton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523440072, "creation_date": 1523407524, "last_edit_date": 1523429840, "question_id": 49764782, "link": "https://stackoverflow.com/questions/49764782/email-cancelled-error-handler", "title": "Email cancelled Error handler", "body": "<p>i have a button the email a FILTERED REPORT named EngdetailRpt and it works great if the email is actually sent.\nHowever if for some reason the email is cancelled from outlook, i get an error and the next time i try to send a filtered report it sends the same filter as last time or locks up the database completely.\ncan anyone suggest handler code that will prevent these error.</p>\n\n<p>below is my current code, </p>\n\n<pre><code>Private Sub cmdEmail_Click()\nOn Error GoTo cmdEmail_Click_Err\n\n    'opens report (hidden) based on Current Form view\n    DoCmd.OpenReport \"EngDetailRpt\", acViewPreview, \"\", \"[TAG_NAME]='\" &amp; Me!TAG_NAME &amp; \"'\", acHidden\n    DoCmd.SendObject acSendReport, \"EngDetailRpt\", acFormatPDF\n    DoCmd.Close acReport, \"EngDetailRpt\", acSaveNo\n\ncmdEmail_Click_Exit:\n    Exit Sub\n\ncmdEmail_Click_Err:\n    MsgBox Error$\n    DoCmd.Close acForm, \"EngDetailsFrm\", acSavePrompt\n    Resume cmdEmail_Click_Exit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1523407511, "post_id": 49764743, "comment_id": 86545073, "body": "What you want to do is kind of hard to follow.  You want the values in C1:P1 to be in H1:U2500, is that right?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1523407647, "post_id": 49764743, "comment_id": 86545111, "body": "That error has more than a number. It has a text description that is right  on the screen in front of you, which means there is zero reason for you to fail to put it in your question so we have it as well. You&#39;re asking us for free help to solve your problem, and it&#39;s in your best interest to make it as easy as possible to do so by providing the details that are <i>right on your screen</i>."}, {"owner": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523408914, "post_id": 49764743, "comment_id": 86545418, "body": "The values for Sheet 1, C1 to P1 have to be copied and pasted into the column H in Sheet 2, each Value gets pasted 13 times, AND there are a total of 165 values to be copied over into sheet 2(column H).  The Run time error is Select method of range class failed. Sorry, for not mentioning it earlier."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1523409206, "post_id": 49764743, "comment_id": 86545499, "body": "<code>Select - Copy - Paste</code> is almost never needed. If all you want to do is to transfer values -- you can use the <code>.Value</code> property of the corresponding ranges. See <a href=\"https://stackoverflow.com/a/10717999/4996248\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1523409446, "post_id": 49764743, "comment_id": 86545567, "body": "There&#39;s an <a href=\"https://stackoverflow.com/posts/49764743/edit\">edit</a> link right below the tags. Please use it to add details to the question itself, rather than burying them in comment clutter. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523409725, "post_id": 49764990, "comment_id": 86545629, "body": "Hi Dean, I just tried this and got the Run-time error message : &#39;1004&#39; - PasteSpecial method of Range class Failed."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "reply_to_user": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523410207, "post_id": 49764990, "comment_id": 86545759, "body": "I think that your problem is because your are specifying <code>Sheets(&quot;Sheet2&quot;).Range(&quot;H2:H2500&quot; &amp; i)</code>. The ` &amp; i` is creating a huge range which exceeds the size of the sheet. As you are only pasting 13 values, you can just make the target range <code>Sheets(&quot;Sheet2&quot;).Range(&quot;H2:H14&quot;)</code>"}], "tags": [], "owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "is_accepted": false, "score": 0, "last_activity_date": 1523410818, "last_edit_date": 1523410818, "creation_date": 1523409452, "answer_id": 49764990, "question_id": 49764743, "link": "https://stackoverflow.com/questions/49764743/paste-13-values-2500-times-using-a-loop/49764990#49764990", "title": "Paste 13 values 2500 times using a Loop", "body": "<p><code>Sheets(\"Sheet1\").Range(\"C1:P1\").Select</code> won't work unless <code>Sheet1</code> is currently active, and likewise <code>Sheets(\"Sheet2\").Range(\"H2:H2500\" &amp; i).Offset(13 * i, 0).Select</code> will fail unless <code>Sheet2</code> is active.</p>\n\n<p>However you don't need to activate each sheet to copy/paste, and you can simplify your code to </p>\n\n<pre><code>Sub Run()\n'\n' Run Macro\n'\n\n    Dim i As Long\n\n    For i = 1 To 2500\n        Sheets(\"Sheet1\").Range(\"C1:P1\").Copy\n        Sheets(\"Sheet2\").Range(\"H2:H2500\" &amp; i).Offset(13 * i, 0).PasteSpecial Paste:=x1PasteFormulas, Operation:=x1None, Skipblanks:= _\n        False, Transpose:=True\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>BTW, <code>C1:P1</code> is actually 14 cells wide, so your offset should be 14 not 13, as you will be overwriting the last cell each time.</p>\n\n<p>Also, <code>Sheets(\"Sheet2\").Range(\"H2:H2500\" &amp; i)</code> appears to have a typo, as the <code>&amp; i</code> will cause the target Range to get bigger each time, and as you are pasting a static range, there is no need for this. You could get away with just using <code>Sheets(\"Sheet2\").Range(\"H2:H14\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523410067, "post_id": 49765051, "comment_id": 86545727, "body": "OMG that works!! thanks heaps! I&#39;ve been trying to fix this for last one week!!"}, {"owner": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523493785, "post_id": 49765051, "comment_id": 86587981, "body": "Hi Paul, I had a question, if I were to copy B2:B165 from sheet one and paste it in sheet2 in column D starting at D2 - something like B2:B4 are 1.) xxx, 2.) yyy, 3.) zzz and I wanted them pasted as - xxx 14 times down the column in Sheet2 (D column) followed by yyy 14 times followed by zzz.. where will the code change? I tried a few tweaks and nothing seemed to work."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523494342, "post_id": 49765051, "comment_id": 86588093, "body": "So you want to copy <code>Sheet1.B2 to Sheet2.D2:D14</code>, then <code>Sheet1.B3 to Sheet2.D15:D28</code>, then <code>Sheet1.B4 to Sheet2.D29:D42</code>, and so on?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523494669, "post_id": 49765051, "comment_id": 86588171, "body": "Well, you need different logic (can&#39;t just modify the code above), but open a new question (and provide 2 screen captures showing the first 3 values on Sheet1, and how they will look at the end on Sheet2, and your short attempt at modifying the code)"}, {"owner": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523495010, "post_id": 49765051, "comment_id": 86588229, "body": "Well I can&#39;t ask another question because someone here flagged me or something..not sure how it works. But thanks anyway for your help. :)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523495168, "post_id": 49765051, "comment_id": 86588262, "body": "The system doesn&#39;t allow you to ask another question?"}, {"owner": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523495266, "post_id": 49765051, "comment_id": 86588281, "body": "Yeah, apparently my question was not well received by the community or something.. so I can&#39;t ask another question for another couple of days"}, {"owner": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1523495791, "post_id": 49765051, "comment_id": 86588398, "body": "Done! Thanks heaps!!"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1523435173, "last_edit_date": 1523435173, "creation_date": 1523409898, "answer_id": 49765051, "question_id": 49764743, "link": "https://stackoverflow.com/questions/49764743/paste-13-values-2500-times-using-a-loop/49765051#49765051", "title": "Paste 13 values 2500 times using a Loop", "body": "<p>You are copying too many times: <code>...Range(\"H2:H2500\" &amp; i).Offset(13 * i, 0)...</code></p>\n\n<p>And as mentioned, remove the <code>.Select Selection</code> statements</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub CopyCPRow()\n    Dim ws1 As Worksheet:   Set ws1 = Sheet1\n    Dim ws2 As Worksheet:   Set ws2 = Sheet2\n    Dim r As Long, hdr As Range, lr As Long: lr = 2500\n\n    Set hdr = ws1.Range(\"C1:P1\"): hdr.Copy\n    With ws2\n        Application.ScreenUpdating = False\n        For r = 2 To lr Step hdr.Columns.Count\n            .Range(\"H\" &amp; r).PasteSpecial Paste:=xlPasteFormulas, _\n                                         Skipblanks:=False, Transpose:=True\n        Next\n        .Rows(lr + 1 &amp; \":\" &amp; r).Delete:     .Activate\n        Application.ScreenUpdating = True:  .Cells(lr + 1, \"H\").Select\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1523426515, "last_edit_date": 1523426515, "creation_date": 1523425938, "answer_id": 49767452, "question_id": 49764743, "link": "https://stackoverflow.com/questions/49764743/paste-13-values-2500-times-using-a-loop/49767452#49767452", "title": "Paste 13 values 2500 times using a Loop", "body": "<p>you don't need loop:</p>\n\n<pre><code>Public Sub CopyCPRow()\n    Worksheets(\"Sheet1\").Range(\"C1:P1\").Copy\n\n    Worksheets(\"Sheet2\").Range(\"H2:H35001\").PasteSpecial Paste:=xlPasteFormulas, _\n                                                                  Skipblanks:=False, _\n                                                                  Transpose:=True\nEnd Sub\n</code></pre>\n\n<p>or, if you don't want to leave the math to Excel:</p>\n\n<pre><code>Public Sub CopyCPRow()\n    Dim nCopy As Long\n\n    nCopy = 2500\n    With Worksheets(\"Sheet1\").Range(\"C1:P1\")\n        .Copy\n        Worksheets(\"Sheet2\").Range(\"H2\").Resize(.Columns.Count * nCopy).PasteSpecial Paste:=xlPasteFormulas, _\n                                                                                      Skipblanks:=False, _\n                                                                                      Transpose:=True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5221378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6kpcKV5KrE/AAAAAAAAAAI/AAAAAAAAAbc/_TcTF805QD4/photo.jpg?sz=128", "display_name": "Devyani Chaturvedi", "link": "https://stackoverflow.com/users/5221378/devyani-chaturvedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 49765051, "answer_count": 3, "score": -1, "last_activity_date": 1523435173, "creation_date": 1523407195, "last_edit_date": 1523409892, "question_id": 49764743, "link": "https://stackoverflow.com/questions/49764743/paste-13-values-2500-times-using-a-loop", "title": "Paste 13 values 2500 times using a Loop", "body": "<p>I am new to VBA scripting - and have been trying to - copy values from sheet 1 \"C1:P1\" and pasting them in another sheet, say Sheet 2, in the column H (beginning from H2 to H2500). Basically the code needs to copy the values, transpose them and paste them.</p>\n\n<pre><code>Sub Run()\n'\n' Run Macro\n'\n\n    Dim i As Long\n\n    For i = 1 To 2500\n        Sheets(\"Sheet1\").Range(\"C1:P1\").Select\n        Selection.Copy\n        Sheets(\"Sheet2\").Range(\"H2:H2500\" &amp; i).Offset(13 * i, 0).Select\n        Selection.PasteSpecial Paste:=x1PasteFormulas, Operation:=x1None, Skipblanks:= _\n            False, Transpose:=True\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>The values for Sheet 1 from C1 to P1 have to be copied and pasted into the column H in Sheet 2, each Value gets pasted 13 times, AND there are a total of 165 values to be copied over into sheet 2(column H).\nThe Run time error '1004' is 'Select method of range class failed', any help would be appreciated!! :)</p>\n"}, {"tags": ["vba", "excel", "directory", "rename"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1523406574, "post_id": 49764588, "comment_id": 86544841, "body": "I suspect if any files in that directory are open the rename will fail"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523407357, "post_id": 49764692, "comment_id": 86545029, "body": "so the file doesn&#39;t seem open at least in my windows interface. However i have another macro that feeds a listbox with the files in the folder that uses objfso. Maybe i should change my question to how to determine if the file is open in a folder, either by the user or any other user(if it is in a shared drive)."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523408239, "post_id": 49764692, "comment_id": 86545249, "body": "@RaphaelYaghdjian - Try the procedures I added above (both are needed to check a folder).  Let me know how it works out; I&#39;m curious what the issue is."}, {"owner": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523410007, "post_id": 49764692, "comment_id": 86545717, "body": "so i tried your code, it works in my immediate window when i try with the same folder string. If i manually open the file in the folder it tells me true when i run it. However when when i&#39;m executing the Name x As y it returns False and still gives me the error."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523410150, "post_id": 49764692, "comment_id": 86545747, "body": "@RaphaelYaghdjian - What kind of file is it?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523410455, "post_id": 49764692, "comment_id": 86545812, "body": "@RaphaelYaghdjian - Just before your <code>Name x As y</code>, add 2 lines: <code>If isFolderOpen(x) Or isFolderOpen(y) Then Stop</code> and see what happens.  If this still doesn&#39;t indicate that a file is open, Reboot your computer ad try again.  Also just to confirm, all the folders/files in question are unshared and stored locally (not on a share or network drive), correct?"}, {"owner": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523410649, "post_id": 49764692, "comment_id": 86545865, "body": "So usually a Word File, or a PDF file... it does not happen with exe file or some others. I tested manually. So the problem does not seem to be with my code itself as in my additional information above i explain that it gives me error sometimes when running in immediate window. I don&#39;t know if it is because im on Windows 10 but it gives me problems when i copy a Microsoft Office file to the folder and a Word instance opens in task manager even though the file itself is not open."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523410837, "post_id": 49764692, "comment_id": 86545912, "body": "Are you saying just a regular, Windows copy &amp; paste <code>CTRL+C</code> <code>CTRL+V</code> of a <b>closed</b> MS Word file from one folder to another, starts an instance of Word in the Task Manager?  Have you tried rebooting?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523411205, "post_id": 49764692, "comment_id": 86546011, "body": "...also, just to confirm, when you say a Word instance opens in the task manager, are you referring to the an instance called &quot;<b><i><code>filename.docx</code></i> <code>- Microsoft Word</code></b>&quot; on the <code>Applications</code> tab, or an instance called &quot;<b><code>WINWORD32.EXE</code></b>&quot; on the <code>Processes</code> tab?"}, {"owner": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523412659, "post_id": 49764692, "comment_id": 86546374, "body": "Yes to 1st question. And the instance is just called &quot;Microsoft Word&quot; in processes, differently from my Excel one that shows my Excel file open in a drop-down. Sorry i know it seems quite complicated and probably already out of the scope of my question. It seems some problem with when i copy a file it opens a word instance, more of a windows thing. As i just went to the folder of a recently copied word file trying to rename it and it does not allow me. Not sure if this happen to everyone or not. I will try a reboot and see."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523413029, "post_id": 49764692, "comment_id": 86546470, "body": "<b>Yes, reboot please.</b>  I&#39;m not saying that will solve the problem for sure but it&#39;s the simplest troubleshooting step there is and it does fix a lot of issues.  That should have been the <b>first</b> thing you tried, any time there&#39;s a file-lock type error (or any unexplained error, for that matter) -- or <code>43</code> minutes ago, when I suggested that the <b>first</b> time, or <code>37</code> minutes ago when I asked about it the <b>second</b> time."}, {"owner": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "edited": false, "score": 0, "creation_date": 1523413337, "post_id": 49764692, "comment_id": 86546541, "body": "Yeah thanks for your help. I just saw the second time you asked it, i commented something as you were adding that first comment suggesting to reboot. I rebooted it didn&#39;t work anyway. It is likely to be a problem with my windows. I will leave the question here anyway and have your answer as the definitive one as it would most likely solve my problem if it wasn&#39;t for some windows 10 problem i am having. Thanks for that, anyway your piece of code will help me improve my code for when someone else has something open in the folder. Sorry for the trouble."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1523408206, "last_edit_date": 1523408206, "creation_date": 1523406688, "answer_id": 49764692, "question_id": 49764588, "link": "https://stackoverflow.com/questions/49764588/how-to-rename-folder-containing-files-with-vba-using-statement-name-as/49764692#49764692", "title": "How to rename folder containing files with VBA using statement Name As", "body": "<p>I'd bet that the reason you're getting the error is because you have one or more files that are located in the folder currently <strong>open</strong>.</p>\n\n<p>If all files are closed, the <code>Name..As</code> command functions properly to rename a folder, without error, <em>regardless</em> of whether there are files in the folder.</p>\n\n<p>The only other (non-obvious) condition that will cause an error in this situation is trying to rename a folder \"to\" a new drive.</p>\n\n<hr>\n\n<p>This function returns <code>TRUE</code> if the specified file is open:</p>\n\n<pre><code>Function IsFileOpen(fileName As String) As Boolean\n'returns TRUE if file [fileName] is locked/open\n    Dim filenum As Long\n    On Error Resume Next\n    filenum = FreeFile()\n    Open fileName For Input Lock Read As #filenum 'try to open (lock) file\n    Close filenum\n    If Err = 0 Then Exit Function\n    If Err &lt;&gt; 70 Then 'not \"permission denied\"\n        MsgBox \"Error \" &amp; Err &amp; \": \" &amp; Err.Description\n    Else\n        IsFileOpen = True\n    End If\nEnd Function\n</code></pre>\n\n<p>This function returns <code>TRUE</code> if the any files within the specified folder are open.  Open files are listed in the Immediate Window.  (This function also requires function <code>IsFileOpen</code> from above.)</p>\n\n<pre><code>Function isFolderOpen(folderName As String) As Boolean\n'returns TRUE if any files within folder [folderName] are locked/open\n'names of open files are listed in the Immediate Window (CTRL+G to view)\n    Dim dirStr As String\n    If Right(folderName, 1) &lt;&gt; \"\\\" Then folderName = folderName &amp; \"\\\"\n    dirStr = Dir(folderName &amp; \"*.*\", vbHidden)\n    Do While dirStr &lt;&gt; \"\"\n        If IsFileOpen(folderName &amp; dirStr) Then\n            isFolderOpen = True\n            Debug.Print \"File Open: \" &amp; folderName &amp; dirStr\n        End If\n        dirStr = Dir\n    Loop\nEnd Function\n</code></pre>\n\n<hr>\n\n<h2>More Information</h2>\n\n<ul>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/name-statement\" rel=\"nofollow noreferrer\"><strong>Name Statement</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/open-statement\" rel=\"nofollow noreferrer\"><strong>Open Statement</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dir-function\" rel=\"nofollow noreferrer\"><strong>Dir Function</strong></a></p></li>\n</ul>\n"}], "owner": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3693, "favorite_count": 0, "accepted_answer_id": 49764692, "answer_count": 1, "score": 1, "last_activity_date": 1523413520, "creation_date": 1523405865, "last_edit_date": 1523413520, "question_id": 49764588, "link": "https://stackoverflow.com/questions/49764588/how-to-rename-folder-containing-files-with-vba-using-statement-name-as", "title": "How to rename folder containing files with VBA using statement Name As", "body": "<p>Good Day,</p>\n\n<p>I have a VBA Project where it automatically creates folder for some specific data categories based on their given names and ids (folder name would be ID_CategoryName). Therefore when i change or update the name of the category, i also want to update the folder name to represent the new name.</p>\n\n<p>I am using the statement syntax <strong>Name</strong> to rename the folder as below:</p>\n\n<pre><code>Dim Fld1 as String\nDim Fld2 as String\n\nFld1 = \"C:\\Users\\rapha\\Desktop\\1_Category1\"\nFld2 = \"C:\\Users\\rapha\\Desktop\\1_Category2\"\n\nIf Dir(Fld1, vbDirectory) &lt;&gt; \"\" And Fld1 &lt;&gt; Fld2 Then\n   Name Fld1 As Fld2\nEnd if\n</code></pre>\n\n<hr>\n\n<p><strong>The problem:</strong> It works for empty folders and renames them, however folders containing files returns me Error 75 Path/File Access error</p>\n\n<hr>\n\n<p><strong>Solution:</strong> I discovered that the problem itself is with renaming folders in my windows after i copy Microsoft Office Files (an instance of the Word opens in Task Manager). However i have chosen @Ashleedawg solution as it would resolve my problem or someone else's for the <strong>Name As</strong> statement, and it also helps me further in checking if someone else is using the folder/files or not (for shared drives).</p>\n\n<hr>\n\n<p><strong>Additional Information:</strong></p>\n\n<p><strong>1-</strong> Not sure if question is duplicate, however all questions i found regarding folder renaming in VBA (here in stackoverflow) use a different method (FileSystemObject). If someone knowledgeable could tell me the difference in using <strong>Name As</strong> or <strong>FileSystemObject</strong></p>\n\n<p><strong>2-</strong> I tested the following line in the immediate window:</p>\n\n<pre><code>Msgbox Dir(\"C:\\Users\\rapha\\Desktop\\Category1\", vbDirectory)\n</code></pre>\n\n<p>It returns me \"1_Category1\", proving the existence of the directory</p>\n\n<p><strong>3-</strong> Is there a more efficient method for renaming folders/files? </p>\n\n<p><strong>4-</strong> I did some manual testing with syntax Name on immediate window. I've been putting a file in a folder by just dragging or using Ctrl + C, and some files gives me error, others don't. Example, i put a PDF or Word file with 300kb and whenever i run <strong>Name</strong> ThatFolder <strong>As</strong> ThatFolder2 it gives me error.</p>\n\n<p><strong>5-</strong> When i open Task Manager it says that there is a instance of Microsoft Word Open, even though it doesn't show in my Windows Interface. When i end the process  i am able to rename the folder. So it seems like when i copy a file it kind of opens the instance of that application and that stays open.</p>\n\n<p><strong>6-</strong> There is no open files in the folder, however i have another code that runs just before it that uses the objects in the folder. On a listbox_click event that is usually selected when you are changing the name of the folder.</p>\n\n<pre><code>Sub DirectorylistActivate(FPath As String, SH As Worksheet, INPUTFRM As UserForm, FILELSTNAME As String)\n\n    Dim objFSO As Object, objFolder As Object, objFile As Object\n    Dim z As Integer\n    Dim rnglastrow As Range\n    Dim rng As Range\n    Dim fName As String   \n\n        'Create an instance of the FileSystemObject\n        Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n        'Get the folder object\n        Set objFolder = objFSO.GetFolder(FPath)\n        z = 1\n\n        SH.UsedRange.Clear\n\n        'loops through each file in the directory\n        For Each objFile In objFolder.Files\n\n             Set rng = SH.Range(SH.Cells(z + 1, 1), SH.Cells(z + 1, 1))\n\n            'create hyperlink in range\n             SH.Hyperlinks.Add Anchor:=rng, Address:= _\n             objFile.Path, _\n             TextToDisplay:=objFile.name\n             z = z + 1\n\n        Next objFile\n\n        'check if directory is empty\n        fName = Dir(FPath &amp; \"\\\", vbNormal)\n\n        Set rnglastrow = DirectoryList.Range(\"A2:A\" &amp; lrow(SH, \"A\"))\n        rnglastrow.name = \"Datafiles\"\n\n        'if directory empty clear rowsource\n        If fName = \"\" Then\n            INPUTFRM.Controls(FILELSTNAME).RowSource = \"\"\n        Else\n            INPUTFRM.Controls(FILELSTNAME).RowSource = \"DataFiles\"\n        End If\n\n        Set objFile = Nothing\n        Set objFSO = Nothing\n        Set objFolder = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ribbon", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1523407215, "post_id": 49764574, "comment_id": 86544994, "body": "<a href=\"https://www.nhaustralia.com.au/blog/customise-ribbon-excel-workbook/\" rel=\"nofollow noreferrer\">How about this first result from Google</a>"}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1523460040, "post_id": 49764574, "comment_id": 86573031, "body": "I promise you, I tried Google first. That&#39;s what I was referring to when I said &quot;everything I&#39;ve read&quot;. Must have used bad search terms."}], "answers": [{"tags": [], "owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1523461264, "creation_date": 1523461264, "answer_id": 49779272, "question_id": 49764574, "link": "https://stackoverflow.com/questions/49764574/can-you-customize-the-ribbon-for-a-specific-workbook/49779272#49779272", "title": "Can you customize the ribbon for a specific workbook?", "body": "<p>This site makes a CustomUI Editor which, it is said, lets you customize the Ribbon the way I wanted:</p>\n\n<p><a href=\"http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2009/08/07/7293.aspx\" rel=\"nofollow noreferrer\">http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2009/08/07/7293.aspx</a></p>\n\n<p>I haven't been able to test it yet, but I did read where it says \"Office 2010\" it really applies to \"Office 2010-2016\".</p>\n"}], "owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1384, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1568651523, "creation_date": 1523405739, "last_edit_date": 1531161705, "question_id": 49764574, "link": "https://stackoverflow.com/questions/49764574/can-you-customize-the-ribbon-for-a-specific-workbook", "title": "Can you customize the ribbon for a specific workbook?", "body": "<p>I'm creating an Excel 365 workbook with macros. </p>\n\n<p>I'd like the user to be able to run them by pressing buttons, but the ActiveX buttons I put on the worksheet tend to move around. Besides which, the sheet has a large table, and the user will scroll around a lot. I'd rather he didn't have to scroll way to the top each time he wanted to press the buttons.</p>\n\n<p>I'd like to be able to add buttons on the Ribbon or the Quick Access Toolbar. However, everything I've read says this will customize <em>my</em> Ribbon or Quick Access Toolbar, not the guy who uses the workbook I send him.</p>\n\n<p>Is it possible to tie a custom Ribbon or QAT button to the workbook itself?</p>\n"}, {"tags": ["vba", "if-statement", "outlook", "outlook-2013"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9468893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3090f7fe39a3ed430d1be92d49daf8?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty25", "link": "https://stackoverflow.com/users/9468893/lefty25"}, "edited": false, "score": 0, "creation_date": 1523481409, "post_id": 49764877, "comment_id": 86584547, "body": "Thank you @0m3r. The code actually works. But when I run the code now I get this error:  &quot;Run-time error &#39;-2147221223 (80040119)&#39;: The Items were copied instead of moved because the original items cannot be deleted. Unknown error&quot;  Error happening here in the code:      next     Move the email to specific folder     objMail.Move objTargetFolder     End If  If I remove the second objMail.Move objTargetFolder I get a &quot;for without next error&quot;. How can I alter the code to not need a for each, next statement? How do i get this to run with no error?"}, {"owner": {"reputation": 13, "user_id": 9468893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3090f7fe39a3ed430d1be92d49daf8?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty25", "link": "https://stackoverflow.com/users/9468893/lefty25"}, "edited": false, "score": 1, "creation_date": 1523560765, "post_id": 49764877, "comment_id": 86623276, "body": "Ha! It works. I just have to specify the attachment name in all lowercase. @0m3r"}, {"owner": {"reputation": 13, "user_id": 9468893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3090f7fe39a3ed430d1be92d49daf8?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty25", "link": "https://stackoverflow.com/users/9468893/lefty25"}, "edited": false, "score": 0, "creation_date": 1555617790, "post_id": 49764877, "comment_id": 98182471, "body": "Im trying to use this macro but its not working in Office 365. Is there anything that needs to be changed?"}, {"owner": {"reputation": 13, "user_id": 9468893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3090f7fe39a3ed430d1be92d49daf8?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty25", "link": "https://stackoverflow.com/users/9468893/lefty25"}, "edited": false, "score": 0, "creation_date": 1555620649, "post_id": 49764877, "comment_id": 98183507, "body": "No unfortunately. It just doesn&#39;t sort."}, {"owner": {"reputation": 13, "user_id": 9468893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3090f7fe39a3ed430d1be92d49daf8?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty25", "link": "https://stackoverflow.com/users/9468893/lefty25"}, "edited": false, "score": 0, "creation_date": 1555630055, "post_id": 49764877, "comment_id": 98186003, "body": "New question posted: OutLook Macro If Else Statement Office 365.  Thank you!"}, {"owner": {"reputation": 13, "user_id": 9468893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3090f7fe39a3ed430d1be92d49daf8?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty25", "link": "https://stackoverflow.com/users/9468893/lefty25"}, "edited": false, "score": 0, "creation_date": 1555790914, "post_id": 49764877, "comment_id": 98226742, "body": "have you seen the new posting?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 13, "user_id": 9468893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3090f7fe39a3ed430d1be92d49daf8?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty25", "link": "https://stackoverflow.com/users/9468893/lefty25"}, "edited": false, "score": 0, "creation_date": 1555792034, "post_id": 49764877, "comment_id": 98227002, "body": "Now I have, I will be home soon and test it on my office 365"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1523491400, "last_edit_date": 1523491400, "creation_date": 1523408481, "answer_id": 49764877, "question_id": 49764482, "link": "https://stackoverflow.com/questions/49764482/outlook-macro-if-else-statement/49764877#49764877", "title": "Outlook Macro If Else Statement", "body": "<p><em>You don't need to set the Inbox, Items are already in Inbox- all your doing is checking the newly add items to inbox has attachment name then move it</em></p>\n\n<p><em>So your if statement should look like this</em></p>\n\n<pre><code>    'Check if the incoming email contains one or more attachments\"\n    If objAttachments.Count &gt; 0 Then\n        For Each objAttachment In objAttachments\n           strAttachmentName = objAttachment.DisplayName\n\n           Set objInboxFolder = Application.Session.GetDefaultFolder(olFolderInbox)\n\n            If InStr(LCase(strAttachmentName), \"attachment name\") &gt; 0 Then\n                Set objTargetFolder = objInboxFolder.Folders(\"Target Folder\")\n                objMail.Move objTargetFolder\n            End If\n        Next\n    End If\n</code></pre>\n\n<hr>\n\n<p><em>Full Code should look like this</em></p>\n\n<pre><code>Option Explicit\nPublic WithEvents objMails As Outlook.Items\nPrivate Sub Application_Startup()\n    Set objMails = Outlook.Application.Session.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub objMails_ItemAdd(ByVal Item As Object)\n    Dim objMail As Outlook.MailItem\n    Dim objAttachments As Outlook.Attachments\n    Dim objAttachment As Outlook.Attachment\n    Dim strAttachmentName As String\n    Dim objInboxFolder As Outlook.Folder\n    Dim objTargetFolder As Outlook.Folder\n\n    Debug.Print \"Items Add\"\n\n    '\"Ensure the incoming item is an email\"\n    If TypeOf Item Is MailItem Then\n        Set objMail = Item\n        Set objAttachments = objMail.Attachments\n\n        '   \"Check if the incoming email contains one or more attachments\"\n        If objAttachments.Count &gt; 0 Then\n            For Each objAttachment In objAttachments\n                strAttachmentName = objAttachment.DisplayName\n                Debug.Print strAttachmentName\n\n                Set objInboxFolder = Application.Session.GetDefaultFolder(olFolderInbox)\n\n                If InStr(LCase(strAttachmentName), \"attachment name\") &gt; 0 Then\n                    Set objTargetFolder = objInboxFolder.Folders(\"Target Folder\")\n                    objMail.Move objTargetFolder\n                    Debug.Print objAttachment.DisplayName\n                End If\n            Next\n        End If\n    End If\n\n    Set objMail = Nothing\n    Set objAttachments = Nothing\n    Set objAttachment = Nothing\n    Set objInboxFolder = Nothing\n    Set objTargetFolder = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9468893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3090f7fe39a3ed430d1be92d49daf8?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty25", "link": "https://stackoverflow.com/users/9468893/lefty25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 49764877, "answer_count": 1, "score": 1, "last_activity_date": 1592984422, "creation_date": 1523405003, "last_edit_date": 1592984422, "question_id": 49764482, "link": "https://stackoverflow.com/questions/49764482/outlook-macro-if-else-statement", "title": "Outlook Macro If Else Statement", "body": "<p>My code sorts emails based on attachment name. I need help with the else statement. </p>\n\n<p>I want the emails that do not meet the parameters to move to the main inbox.</p>\n\n<p>Right now any thing that does not meet parameters just moves to another folder. </p>\n\n<p>What is the correct syntax?</p>\n\n<pre><code>Public WithEvents objMails As Outlook.Items\n\nPrivate Sub Application_Startup()\nSet objMails = Outlook.Application.Session.GetDefaultFolder (olFolderInbox).Items\n\nEnd Sub\n\nPrivate Sub objMails_ItemAdd(ByVal Item As Object)\n\nDim objMail As Outlook.MailItem\nDim objAttachments As Outlook.Attachments\nDim objAttachment As Outlook.Attachment\nDim strAttachmentName As String\nDim objInboxFolder As Outlook.Folder\nDim objTargetFolder As Outlook.Folder\n\n\"Ensure the incoming item is an email\"\nIf TypeOf Item Is MailItem Then\n   Set objMail = Item\n   Set objAttachments = objMail.Attachments\n\n   \"Check if the incoming email contains one or more attachments\"\n\n   If objAttachments.Count &gt; 0 Then\n      For Each objAttachment In objAttachments\n          strAttachmentName = objAttachment.DisplayName\n          Set objInboxFolder = Application.Session.GetDefaultFolder(olFolderInbox)\n\n          \"Check the names of all the attachments\"\n          \"Specify the target folders\"\n\n          If InStr(LCase(strAttachmentName), \"some attachment name\") &gt; 0 Then\n             Set objTargetFolder = objInboxFolder.Folders(\"Target Folder\")\n             Else: Set objTargetFolder = objInboxFolder.Folders(\"Target Folder 2\")\n     End If\n     Next\n     Move the email to specific folder\n      objMail.Move objTargetFolder\n   End If\nEnd If\n\nSet objMail = Nothing\nSet objAttachments = Nothing\nSet objAttachment = Nothing\nSet objInboxFolder = Nothing\nSet objTargetFolder = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9607710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ace827b1e0c1b8c6e99b95b0eba727?s=128&d=identicon&r=PG&f=1", "display_name": "Tyloid", "link": "https://stackoverflow.com/users/9607710/tyloid"}, "edited": false, "score": 0, "creation_date": 1523405870, "post_id": 49763939, "comment_id": 86544696, "body": "Thanks. Worked perfectly."}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "reply_to_user": {"reputation": 3, "user_id": 9607710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ace827b1e0c1b8c6e99b95b0eba727?s=128&d=identicon&r=PG&f=1", "display_name": "Tyloid", "link": "https://stackoverflow.com/users/9607710/tyloid"}, "edited": false, "score": 0, "creation_date": 1523418074, "post_id": 49763939, "comment_id": 86547679, "body": "If you found my answer helpfull, please mark it as the answer to your question by clicking on the checkmark!"}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": true, "score": 0, "last_activity_date": 1523400672, "creation_date": 1523400672, "answer_id": 49763939, "question_id": 49763865, "link": "https://stackoverflow.com/questions/49763865/vba-change-file-connection-based-on-named-range/49763939#49763939", "title": "VBA: change file connection based on named range", "body": "<p>If <code>rng</code> corresponds to your list of files then you can set the first cell in the list as your <code>oldfilestring</code> string</p>\n\n<pre><code>Sub Test()\n\nDim rng As Range\nDim cell As Range\n\nDim oldfilestring As String\nDim filestring As String\n\nSet rng = Range(\"Files\")\n\noldfilestring = rng.Cells(1, 1).value\n\nFor Each cell In rng\n    filestring = cell.Value\n    ActiveWorkbook.ChangeLink Name:=oldfilestring, NewName:=filestring, Type:=xlExcelLinks\n\nCopyPasteFilteredData\n    oldfilestring = filestring\nNext cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9607710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ace827b1e0c1b8c6e99b95b0eba727?s=128&d=identicon&r=PG&f=1", "display_name": "Tyloid", "link": "https://stackoverflow.com/users/9607710/tyloid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 49763939, "answer_count": 1, "score": 0, "last_activity_date": 1523400672, "creation_date": 1523400036, "question_id": 49763865, "link": "https://stackoverflow.com/questions/49763865/vba-change-file-connection-based-on-named-range", "title": "VBA: change file connection based on named range", "body": "<hr>\n\n<p>First here is the code:</p>\n\n<pre><code>Sub Test()\n\nDim rng As Range\nDim cell As Range\n\nDim oldfilestring As String\nDim filestring As String\n\nSet rng = Range(\"Files\")\n\noldfilestring = \"File A\"\n\nFor Each cell In rng\n    filestring = cell.Value\n    ActiveWorkbook.ChangeLink Name:=oldfilestring, NewName:=filestring, Type:=xlExcelLinks\n\nCopyPasteFilteredData\n    oldfilestring = filestring\nNext cell\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li>Where my range is a set list of files that I imported into column A:A</li>\n</ul>\n\n<p>Where I am having trouble is on line \"oldfilestring = 'File A', sometimes the first file is not \"File A\" - how do I edit this to made it the first file in the list?</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1523399891, "post_id": 49763828, "comment_id": 86543274, "body": "Are you saying you want to populate a new column to the right of the last data in <code>Worksheets(&quot;Report&quot;)</code>?  Because, I don&#39;t see how you can populate Column E <b>and</b> not overwrite the data already there..."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1523402285, "post_id": 49763828, "comment_id": 86543892, "body": "even in you could overwrite, what would you want done in that case?  Your question is not very clear."}, {"owner": {"reputation": 79, "user_id": 909312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/09927d2c1df37312f8b77563dbdfa62a?s=128&d=identicon&r=PG", "display_name": "melai", "link": "https://stackoverflow.com/users/909312/melai"}, "edited": false, "score": 0, "creation_date": 1523411017, "post_id": 49763828, "comment_id": 86545964, "body": "In my code, I just dont want to overwrite my previous result. I just need it to append to the last row without data"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 909312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/09927d2c1df37312f8b77563dbdfa62a?s=128&d=identicon&r=PG", "display_name": "melai", "link": "https://stackoverflow.com/users/909312/melai"}, "edited": false, "score": 0, "creation_date": 1523408471, "post_id": 49764434, "comment_id": 86545298, "body": "This code is fast. Though it overwrites the last row of the first result"}, {"owner": {"reputation": 79, "user_id": 909312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/09927d2c1df37312f8b77563dbdfa62a?s=128&d=identicon&r=PG", "display_name": "melai", "link": "https://stackoverflow.com/users/909312/melai"}, "edited": false, "score": 0, "creation_date": 1523411717, "post_id": 49764434, "comment_id": 86546149, "body": "Finally found a solution. Though not sure if it is the most efficient one."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1523418581, "last_edit_date": 1523418581, "creation_date": 1523404601, "answer_id": 49764434, "question_id": 49763828, "link": "https://stackoverflow.com/questions/49763828/copy-range-into-specific-row-cell-and-avoid-overwriting-the-data/49764434#49764434", "title": "Copy Range into Specific Row/Cell and avoid overwriting the data", "body": "<p>Untested:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim shtSrc As Worksheet '&lt;&lt; source sheet\n    Dim RowGCnt As Long\n    Dim LastRow As Long\n    Dim cDest As Range   '&lt;&lt; copy destination\n\n    Set shtSrc = Worksheets(\"SHEET1\")\n\n    'paste the first result to the first open row\n    With Worksheets(\"REPORT\")\n        Set cDest = .Cells(.Rows.Count, \"E\").End(xlUp).Offset(1, 0) '&lt;&lt;EDIT\n        If cDest.Row &lt; 9 Then Set cDest = .Range(\"E9\")\n    End With\n\n    LastRow = shtSrc.Range(\"A\" &amp; shtSrc.Rows.Count).End(xlUp).Row\n\n    For RowGCnt = 11 To LastRow\n        If shtSrc.Range(\"C\" &amp; RowGCnt).Value = \"No\" Then\n            cDest.Value = shtSrc.Range(\"B\" &amp; RowGCnt).Value\n            Set cDest = cDest.Offset(1, 0)\n        End If\n    Next RowGCnt\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 909312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/09927d2c1df37312f8b77563dbdfa62a?s=128&d=identicon&r=PG", "display_name": "melai", "link": "https://stackoverflow.com/users/909312/melai"}, "is_accepted": false, "score": 0, "last_activity_date": 1523411894, "creation_date": 1523411894, "answer_id": 49765333, "question_id": 49763828, "link": "https://stackoverflow.com/questions/49763828/copy-range-into-specific-row-cell-and-avoid-overwriting-the-data/49765333#49765333", "title": "Copy Range into Specific Row/Cell and avoid overwriting the data", "body": "<p>Using Tim Williams code. I got a workaround</p>\n\n<p>Private Sub CommandButton1_Click()</p>\n\n<pre><code>Dim shtSrc As Worksheet '&lt;&lt; source sheet\nDim RowGCnt As Long\nDim LastRow As Long\nDim cDest As Range   '&lt;&lt; copy destination\nDim vLastRow As Integer\n\nSet shtSrc = Worksheets(\"SHEET1\")\n\n'paste the first result to the first open row\nWith Worksheets(\"REPORT\")\n    Set cDest = .Cells(.Rows.Count, \"E\").End(xlUp)\n    If cDest.Row &lt; 9 Then\n        Set cDest = .Range(\"E9\")\n    Else\n        vLastRow = .Cells(.Rows.Count, 5).End(xlUp).Row\n        Set cDest = .Cells(vLastRow + 1, 5)\n    End If\nEnd With\n\nLastRow = shtSrc.Range(\"A\" &amp; shtSrc.Rows.Count).End(xlUp).Row\n\nFor RowGCnt = 11 To LastRow\n    If shtSrc.Range(\"C\" &amp; RowGCnt).Value = \"No\" Then\n        cDest.Value = shtSrc.Range(\"B\" &amp; RowGCnt).Value\n        Set cDest = cDest.Offset(1, 0)\n    End If\nNext RowGCnt\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 79, "user_id": 909312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/09927d2c1df37312f8b77563dbdfa62a?s=128&d=identicon&r=PG", "display_name": "melai", "link": "https://stackoverflow.com/users/909312/melai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 49764434, "answer_count": 2, "score": -1, "last_activity_date": 1523418581, "creation_date": 1523399782, "last_edit_date": 1523402200, "question_id": 49763828, "link": "https://stackoverflow.com/questions/49763828/copy-range-into-specific-row-cell-and-avoid-overwriting-the-data", "title": "Copy Range into Specific Row/Cell and avoid overwriting the data", "body": "<p>Fairly new to VBA Excel. I want to copy and paste a specific cell[B11 and so on) into a specific cell [E9 and so on] on my target sheet when conditions are met (when C column is equal to No). So far I was able to copy and paste the data on my target sheet. Having trouble when I run the command again. I don't want to overwrite my previous data. How can this be done? `</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim RowGCnt As Long, CShtRow As Long\n    Dim LastRow As Long\n    Dim CellG As Range\n\n    'paste the first result to the 9th row\n    CShtRow = 9\n    LastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For RowGCnt = 11 To LastRow\n        If Range(\"C\" &amp; RowGCnt).Value = \"No\" Then\n            MsgBox (CShtRow)\n            'Review Criteria\n            Worksheets(\"SHEET1\").Range(\"B\" &amp; RowGCnt).Copy\n            Worksheets(\"REPORT\").Range(\"E\" &amp; CShtRow).PasteSpecial xlPasteValues\n            CShtRow = CShtRow + 1\n        End If\n    Next RowGCnt\n\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "nested", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1523429117, "creation_date": 1523429117, "answer_id": 49768243, "question_id": 49763416, "link": "https://stackoverflow.com/questions/49763416/nested-looping-and-combinations/49768243#49768243", "title": "Nested looping and combinations", "body": "<p>Well you need 2 nested loops for this. The first to loop through column A (first names) and for every row in column A loop through column B (middle names) and combine them:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CombineNames()\n    Dim wsNames As Worksheet\n    Set wsNames = Worksheets(\"Sheet1\") 'define which worksheet to use\n\n    Dim lRow As Long\n    lRow = wsNames.Cells(wsNames.Cells.Rows.Count, \"A\").End(xlUp).Row 'find last used row\n\n    Dim iRow As Long\n    For iRow = 2 To lRow 'loop throug column A\n        Dim jRow As Long\n        For jRow = 2 To lRow 'for every row in column A loop through column B\n            Debug.Print wsNames.Cells(iRow, \"A\").Value &amp; \" \" &amp; wsNames.Cells(jRow, \"B\").Value\n              'change this line to your desired output\n        Next jRow\n    Next iRow\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong><br>\nThis assumes that column A and B have the same amount of rows. If that's not the case you will need to determine the last row for each column separately:</p>\n\n<pre><code>Dim lRowA As Long\nlRowA = wsNames.Cells(wsNames.Cells.Rows.Count, \"A\").End(xlUp).Row 'find last used row in column A\nDim lRowB As Long\nlRowB = wsNames.Cells(wsNames.Cells.Rows.Count, \"B\").End(xlUp).Row 'find last used row in column B\n</code></pre>\n\n<p>and adjust the loops to <code>For iRow = 2 To lRowA</code> and <code>For jRow = 2 To lRowB</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 9627401, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213591157832935/picture?type=large", "display_name": "Adam Mautz", "link": "https://stackoverflow.com/users/9627401/adam-mautz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1145, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523429117, "creation_date": 1523397301, "last_edit_date": 1531164843, "question_id": 49763416, "link": "https://stackoverflow.com/questions/49763416/nested-looping-and-combinations", "title": "Nested looping and combinations", "body": "<p>I have this question:</p>\n\n<p>Create a Sub with any combination of nested loops. This nested loop should take the baby girl names input (below) and print out every possible combination. These input names will need to appear in your workbook somewhere. Print out the combinations in the workbook itself.</p>\n\n<p>Input<br>\n<a href=\"https://i.stack.imgur.com/JNohx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JNohx.png\" alt=\"names\"></a></p>\n\n<p>I have been able to get Penelope paired with all the middle names, but I can't figure out how to pair the rest of the first names. I don't know how to offset the active cell to the second first name and so on. this is what I have so far:</p>\n\n<pre><code>Sub part2()\n    Dim combination As String\n    Dim fName As String\n    Dim mName As String\n\n    Range(\"A1\").Activate\n    fName = ActiveCell.Value\n\n    Do Until IsEmpty(ActiveCell)\n        mName = ActiveCell.Offset(0, 1).Value\n        combination = fName &amp; \" \" &amp; mName\n        ActiveCell.Offset(0, 3) = combination\n        ActiveCell.Offset(1, 0).Activate\n    Loop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8190267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b502151c512865ff8a688ee75812de?s=128&d=identicon&r=PG&f=1", "display_name": "PowerToYou", "link": "https://stackoverflow.com/users/8190267/powertoyou"}, "edited": false, "score": 0, "creation_date": 1523460762, "post_id": 49764178, "comment_id": 86573571, "body": "Thank you for the tip. I can now merge and align the data in same columns. However, I am still struggling with combining data from two different columns into one."}, {"owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "reply_to_user": {"reputation": 23, "user_id": 8190267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b502151c512865ff8a688ee75812de?s=128&d=identicon&r=PG&f=1", "display_name": "PowerToYou", "link": "https://stackoverflow.com/users/8190267/powertoyou"}, "edited": false, "score": 0, "creation_date": 1523563363, "post_id": 49764178, "comment_id": 86624702, "body": "That is just basic excel vba. For more information on how to use excel and VBA, I sugest you look through the documentation and find some helpful video&#39;s on youtube."}], "tags": [], "owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "is_accepted": false, "score": 0, "last_activity_date": 1523402497, "creation_date": 1523402497, "answer_id": 49764178, "question_id": 49763415, "link": "https://stackoverflow.com/questions/49763415/merge-center-align-different-rows-and-extract-data-from-various-columns/49764178#49764178", "title": "Merge-Center align different rows and extract data from various columns", "body": "<p>Since you are new to VBA I suggest you use the macro recorder on 1 group of rows you want to change into the desired view. It records every step you are doing when manually creating the desired result. Then study that and create your final macro based on the recorded macro. That is the best way and fastest way in my honest opinion to get into VBA quickly.</p>\n"}], "owner": {"reputation": 23, "user_id": 8190267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b502151c512865ff8a688ee75812de?s=128&d=identicon&r=PG&f=1", "display_name": "PowerToYou", "link": "https://stackoverflow.com/users/8190267/powertoyou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526543985, "creation_date": 1523397294, "last_edit_date": 1526543985, "question_id": 49763415, "link": "https://stackoverflow.com/questions/49763415/merge-center-align-different-rows-and-extract-data-from-various-columns", "title": "Merge-Center align different rows and extract data from various columns", "body": "<p>I have excel tables that look like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ACQ4C.png\" alt=\"enter image description here\"></p>\n\n<p>I want to develop a macro that would help me achieve an output that would look something like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3IaNh.png\" alt=\"enter image description here\"></p>\n\n<p>I am new to VBA and have tried changing column names using some code snippets available online. It worked, and this is what I used:</p>\n\n<pre><code>Sub namefixer()\n    s = Array(\"Response\", \"Factor\", \"Scaled Estimate\")\n    Range(\"A1:C1\") = s\nEnd Sub\n</code></pre>\n\n<p>However, I have no idea how I can pull data from other columns and display them as I like in a new excel sheet. Any help will be highly appreciated.</p>\n"}, {"tags": ["vba", "excel", "delete-row", "similarity"], "comments": [{"owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "edited": false, "score": 0, "creation_date": 1523402901, "post_id": 49763211, "comment_id": 86544030, "body": "Have you got any experience with vba? For if you know how to manually get the results and use the macro recorder to record every step you make, then you\u2019re more than half way there."}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1523430387, "creation_date": 1523430387, "answer_id": 49768598, "question_id": 49763211, "link": "https://stackoverflow.com/questions/49763211/if-data-in-column-a-is-similar-in-two-excel-files-save-similar-data-and-delete/49768598#49768598", "title": "If data in column A is similar in two excel files, save similar data and delete all other data in the 2nd file", "body": "<p>you may try this:</p>\n\n<pre><code>Sub mysub()\n    Dim parentWb As Workbook, secondWb As Workbook\n\n    Set parentWb = Workbooks.Open(\"parentWbPath\\parentWbName.xlsx\") ' adjust 'parent' workbook path and name to suit your needs\n    Set secondWb = Workbooks.Open(\"secondWbPath\\secondWbName.xlsx\")' adjust 'secondWB' workbook path and name to suit your needs\n\n    Dim filters As Variant\n    With parentWb.Worksheets(1) 'assuming 'parent' workbook data are in its 1st worksheet\n        filters = Application.Transpose(.Range(\"A2\", .Cells(.Rows.Count, 1).End(xlUp)).Value)\n    End With\n\n    Dim iRow As Long        \n    With secondWb.Worksheets(1) 'assuming 'secodnWb' workbook data to be processed are in its 1st worksheet\n        With .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp))\n            .AutoFilter Field:=1, Criteria1:=filters, Operator:=xlFilterValues\n            For iRow = .Rows(.Rows.Count).Row To 2 Step -1\n                .Rows(iRow).Hidden = Not .Rows(iRow).Hidden\n            Next\n            .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": false, "score": 0, "last_activity_date": 1523461407, "creation_date": 1523461407, "answer_id": 49779312, "question_id": 49763211, "link": "https://stackoverflow.com/questions/49763211/if-data-in-column-a-is-similar-in-two-excel-files-save-similar-data-and-delete/49779312#49779312", "title": "If data in column A is similar in two excel files, save similar data and delete all other data in the 2nd file", "body": "<p>You can use <strong>Power Query</strong>. It is an add-in for Excel 2010+ (by default in 2016 known as Get &amp; Transform) that you can download an activate easily. There you can connect directly your sources of data and you will have a lot of tools to transform your data.</p>\n\n<p>In your case, you can transform the first table as a <code>List</code> and use it as a filter for your data.</p>\n\n<p>In the <strong>Query Editor</strong> > <strong>Home</strong> > <strong>Advance Editor</strong> you can paste this code (unofficialy known as M code)</p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Main\"]}[Content], //Main Table\n    Source2 = Excel.CurrentWorkbook(){[Name=\"Filter\"]}[Content], //Filter Table\n    Filter = Source2[Point], //Covert Filter table in a List\n    #\"Filtered Rows\" = Table.SelectRows(Source, each List.Contains(Filter, [Point])) //Use the list as a filter\nin\n    #\"Filtered Rows\"\n</code></pre>\n\n<p>or follow this steps:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pFbMa.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pFbMa.gif\" alt=\"\"></a></p>\n\n<p>Even you can unpivot your data for future analysis:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3T5Cv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3T5Cv.png\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 57, "user_id": 8156262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/544acf99a4ab2e49eb8d4eec9a845b0b?s=128&d=identicon&r=PG&f=1", "display_name": "t.breeze", "link": "https://stackoverflow.com/users/8156262/t-breeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1523461407, "creation_date": 1523396197, "question_id": 49763211, "link": "https://stackoverflow.com/questions/49763211/if-data-in-column-a-is-similar-in-two-excel-files-save-similar-data-and-delete", "title": "If data in column A is similar in two excel files, save similar data and delete all other data in the 2nd file", "body": "<p>I have a parent excel file with a forever changing range of point locations manually inputted into column A. For this example let's say 11.</p>\n\n<pre><code>Point\n    P1\n    P13\n    P20\n    P5\n    P17\n    P8\n    P10\n    P11\n    P3\n    P7\n    P4\n</code></pre>\n\n<p>I have a 2nd excel file with another forever changing range of point locations and columns for each location. This file includes the points from the 1st file with other data in the (x) number of columns.</p>\n\n<pre><code>   Point Data1 Data2 Data3 Data4 Data5\n   P1       a      b     c     d     e\n   P2       a      b     c     d     e\n   P3       a      b     c     d     e\n   P4       a      b     c     d     e\n   P5       a      b     c     d     e\n   P6       a      b     c     d     e\n   P7       a      b     c     d     e\n   P8       a      b     c     d     e\n   P9       a      b     c     d     e\n   P10      a      b     c     d     e\n   P11      a      b     c     d     e\n   P12      a      b     c     d     e\n   P13      a      b     c     d     e\n   P14      a      b     c     d     e\n   P15      a      b     c     d     e\n   P16      a      b     c     d     e\n   P17      a      b     c     d     e\n   P18      a      b     c     d     e\n   P19      a      b     c     d     e\n   P20      a      b     c     d     e\n</code></pre>\n\n<p>I would like a push button on the first file to clear the second file of all points that do not exist in the first file while keeping title in the 1st row. Output would look like:</p>\n\n<pre><code>Point Data1 Data2 Data3 Data4 Data5\nP1       a      b     c     d     e\nP3       a      b     c     d     e\nP4       a      b     c     d     e\nP5       a      b     c     d     e\nP7       a      b     c     d     e\nP8       a      b     c     d     e\nP10      a      b     c     d     e\nP11      a      b     c     d     e\nP13      a      b     c     d     e\nP17      a      b     c     d     e\nP20      a      b     c     d     e\n</code></pre>\n\n<p>The files will be in the same directory but I would like the user to be able to select the 2nd file to perform the search and delete.</p>\n\n<p>It may be more simple to extract each point and corresponding row and save to a new sheet rather than delete all other points and data. That would be suitable as well. I know how to do this manually with VLOOKUP but I would like to automate it in VBA for other users.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1523394901, "post_id": 49762782, "comment_id": 86541470, "body": "How about some code first to get and set the computer name, then use it as part of the path..."}], "answers": [{"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1523404777, "post_id": 49762955, "comment_id": 86544457, "body": "and <code>Environ$(&quot;UserProfile&quot;)</code> is short for <code>&quot;C:\\Users\\&quot; &amp; Environ(&quot;UserName&quot;)</code>"}, {"owner": {"reputation": 59, "user_id": 9627219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ea1641688a15c3c343f03c76a5f763?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianLatte", "link": "https://stackoverflow.com/users/9627219/norwegianlatte"}, "edited": false, "score": 0, "creation_date": 1523466585, "post_id": 49762955, "comment_id": 86577088, "body": "@bigben one more question, I have folders for every month ,201803, 201804,201805.... so on. I manually update the path on Visual Basic every month. is there a way to automate this as well??"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1523468435, "post_id": 49762955, "comment_id": 86578026, "body": "See the edit above - you can determine the year/month from today&#39;s date, or yesterday if needed - I assume you&#39;d work from today&#39;s."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1523468318, "last_edit_date": 1523468318, "creation_date": 1523394915, "answer_id": 49762955, "question_id": 49762782, "link": "https://stackoverflow.com/questions/49762782/vba-save-as-pdf-into-a-shared-folder-with-different-computer/49762955#49762955", "title": "vba save as pdf into a shared folder with different computer", "body": "<p>Try adding the following lines to the beginning of your code:</p>\n\n<pre><code>Dim username As String\nusername = Environ$(\"username\")\n</code></pre>\n\n<p>And then your path should be:</p>\n\n<pre><code>\"C:\\Users\\\" &amp; username &amp; \"\\Dropbox\\...\n</code></pre>\n\n<p>To make the year/month dynamic (assuming based on today's date), your link can be:</p>\n\n<pre><code>...LIST\\\" &amp; Format(Now(), \"yyyymm\") &amp; \"\\PACKING LIST...\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9627219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ea1641688a15c3c343f03c76a5f763?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianLatte", "link": "https://stackoverflow.com/users/9627219/norwegianlatte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523468318, "creation_date": 1523394035, "last_edit_date": 1523404439, "question_id": 49762782, "link": "https://stackoverflow.com/questions/49762782/vba-save-as-pdf-into-a-shared-folder-with-different-computer", "title": "vba save as pdf into a shared folder with different computer", "body": "<p>Hi I wrote a code where it saves the excel sheet as PDF file into a our company's sharefolder (dropbox). I realized when my coworker tried to use that Macro, it doesn't work because of the path the file is saved.</p>\n\n<p>in the code, where it says \"MyComputerName\" is what my computer name and i am guessing it's because my co workers computer name is different so it can't find the path on her computer.</p>\n\n<p>Is there a way to solve this? so we both can use this macro and save it into the shared folder ?</p>\n\n<p>Help!!!</p>\n\n<pre><code>Sub SaveAsPDF()\n\n' FormatName\nActiveSheet.Name = \"#\" &amp; ActiveSheet.Range(\"F6\").Value &amp; \" \" &amp; ActiveSheet.Range(\"F4\").Value\n\n' saveAsPDF Macro   \nActiveSheet.ExportAsFixedFormat Type:=xltypepdf, Filename:= _\n  \"C:\\Users\\MyComputerName\\Dropbox\\Team Folder\\PACKING LIST\\201804\\\" &amp; \"PACKING LIST_\" &amp; ActiveSheet.Name _\n    , quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=True\nEnd Sub\n</code></pre>\n"}]