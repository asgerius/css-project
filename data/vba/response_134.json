[{"tags": ["vba", "global-variables"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501719562, "post_id": 45472745, "comment_id": 77906728, "body": "I have a feeling that your <code>&amp; &quot;uofForm.Tag = theName&quot; &amp; </code> is just a convoluted way of achieving <code>&amp; &quot;uofForm.Tag = &quot;&quot;&quot; &amp; myCB.OLEFormat.Object.Name &amp; &quot;&quot;&quot;&quot; &amp; </code>.  (My guess as to why your variable isn&#39;t staying set is that some changes to code reset variables, so your code addition is probably the cause.  You could try moving the <code>theName = myCB.OLEFormat.Object.Name</code> line after you update the code and see what happens.)"}], "answers": [{"comments": [{"owner": {"reputation": 898, "user_id": 528828, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/829634b120fc10e456c8b33c13351a97?s=128&d=identicon&r=PG", "display_name": "Mike Owens", "link": "https://stackoverflow.com/users/528828/mike-owens"}, "edited": false, "score": 0, "creation_date": 1501728162, "post_id": 45473594, "comment_id": 77908557, "body": "Then how can you store data if you are adding the procedure at runtime?"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1501725481, "creation_date": 1501725481, "answer_id": 45473594, "question_id": 45472745, "link": "https://stackoverflow.com/questions/45472745/public-variable-returns-empty-string/45473594#45473594", "title": "Public variable returns empty string", "body": "<p>You're dynamically adding a sub routine to the <em>same</em> module at run-time. That will trigger a reset of the project - Ending program execution, and clearing all variables.</p>\n\n<p>If you try manually adding a procedure to a running module (in debug mode), you'll get this warning:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DUPSb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DUPSb.png\" alt=\"enter image description here\"></a></p>\n\n<p>But you don't get that warning when adding the code programmatically.</p>\n\n<p>In any case, you're adding the procedure to the <code>ThisWorkbook</code> module, when you probably want to add it to the module of the sheet upon which the control is hosted.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2259748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4e222033311ead41a35d91be7e22c70?s=128&d=identicon&r=PG", "display_name": "joaogcs", "link": "https://stackoverflow.com/users/2259748/joaogcs"}, "is_accepted": false, "score": 0, "last_activity_date": 1551735864, "creation_date": 1551735864, "answer_id": 54992007, "question_id": 45472745, "link": "https://stackoverflow.com/questions/45472745/public-variable-returns-empty-string/54992007#54992007", "title": "Public variable returns empty string", "body": "<p>I had the same issue, try declare your variable as Global instead of Public like this</p>\n\n<pre><code>Global theName As String\n</code></pre>\n"}], "owner": {"reputation": 898, "user_id": 528828, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/829634b120fc10e456c8b33c13351a97?s=128&d=identicon&r=PG", "display_name": "Mike Owens", "link": "https://stackoverflow.com/users/528828/mike-owens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1551735864, "creation_date": 1501718099, "last_edit_date": 1501718462, "question_id": 45472745, "link": "https://stackoverflow.com/questions/45472745/public-variable-returns-empty-string", "title": "Public variable returns empty string", "body": "<p>I am creating a document using VBA at work (because that is the only thing I can use at work). My variable is returning an empty string after it is set. I am trying to pass data to a a user form from a method hat is dynamically generated at runtime.</p>\n\n<p>I set the variable like so at the top of the ThisDocument module</p>\n\n<pre><code>Public theName As String\n</code></pre>\n\n<p>Then I run this when a checkbox is checked</p>\n\n<pre><code>With tblNew\n    '.Cell(Row:=rowCount, Column:=2).Merge MergeTo:=.Cell(Row:=rowCount, Column:=3)\n    .Rows(rowCount).SetHeight RowHeight:=InchesToPoints(0.35), HeightRule:=wdRowHeightExactly\n    .Cell(Row:=rowCount, Column:=1).SetWidth ColumnWidth:=InchesToPoints(0.75), RulerStyle:=wdAdjustNone\n    .Cell(Row:=rowCount, Column:=2).SetWidth ColumnWidth:=InchesToPoints(2.08), RulerStyle:=wdAdjustNone\n    .Cell(Row:=rowCount, Column:=3).SetWidth ColumnWidth:=InchesToPoints(1), RulerStyle:=wdAdjustNone\n    .Cell(Row:=rowCount, Column:=4).SetWidth ColumnWidth:=InchesToPoints(2), RulerStyle:=wdAdjustNone\n    .Cell(Row:=rowCount, Column:=5).SetWidth ColumnWidth:=InchesToPoints(1.85), RulerStyle:=wdAdjustNone\n    .Cell(rowCount, 1).Range.InsertAfter \"Name:\"\n    .Cell(rowCount, 3).Range.InsertAfter \"Type:\"\n    .Cell(rowCount, 2).Range.InlineShapes.AddOLEControl ClassType:=\"Forms.TextBox.1\"\n  Set myCB = .Cell(rowCount, 4).Range.InlineShapes.AddOLEControl(ClassType:=\"Forms.TextBox.1\")\n        Dim uofCode As String\n        Dim doc As Word.Document\n\n        Set doc = ActiveDocument\n\n        theName = myCB.OLEFormat.Object.Name\n        MsgBox theName \u2018this message works fine\n            uofCode = \"Private Sub \" &amp; myCB.OLEFormat.Object.Name &amp; \"_GotFocus()\" &amp; vbCrLf &amp; _\n             vbCr &amp; \"Load uofForm\" &amp; vbCr &amp; \"uofForm.Tag = theName\" &amp; vbCr &amp; \"uofForm.Show\" &amp; vbCr &amp; vbCrLf &amp; _\n            \"End Sub\"\n            doc.VBProject.VBComponents(\"ThisDocument\").CodeModule.AddFromString uofCode\n\n             End With\n</code></pre>\n\n<p>I set the variable <code>theName</code> with this line <code>theName = myCB.OLEFormat.Object.Name</code> and make sure it's set for testing with a MsgBox <code>MsgBox theName</code> This message works fine. Now the problem is when it generates the function the variable is empty. Any ideas why the variable <code>theName</code> is not staying set?</p>\n"}, {"tags": ["sql-server", "vba", "excel", "sql-server-2008"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1501717261, "post_id": 45472383, "comment_id": 77906161, "body": "Try checking the Connection object&#39;s <code>Errors</code> collection.  <a href=\"https://support.microsoft.com/en-us/help/167957/info-extracting-error-information-from-ado-in-vb\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/167957/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501717602, "post_id": 45472383, "comment_id": 77906227, "body": "@TimWilliams is this gonna work?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501719070, "post_id": 45472383, "comment_id": 77906595, "body": "That&#39;s for you to test..."}, {"owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "edited": false, "score": 0, "creation_date": 1501722605, "post_id": 45472383, "comment_id": 77907343, "body": "@user8406687, you may need to add <code>SET NOCOUNT ON;</code> to the proc."}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 0, "creation_date": 1501734959, "post_id": 45472383, "comment_id": 77910199, "body": "<a href=\"http://sqlblog.com/blogs/aaron_bertrand/archive/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length.aspx\" rel=\"nofollow noreferrer\">Bad habits to kick : declaring VARCHAR without (length)</a> - you should <b>always</b> provide a length for any <code>varchar</code> variables and parameters that you use\t- otherwise, it&#39;ll default to a length of <b>1 character</b> ....."}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501747891, "post_id": 45472383, "comment_id": 77917260, "body": "@TimWilliams i tried but not working"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "reply_to_user": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "edited": false, "score": 0, "creation_date": 1501775913, "post_id": 45472383, "comment_id": 77939534, "body": "@DanGuzman  thank you sir, set no count works in this case."}, {"owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "edited": false, "score": 0, "creation_date": 1501780468, "post_id": 45472383, "comment_id": 77942568, "body": "@user8406687, I added that as an answer."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501781431, "post_id": 45472383, "comment_id": 77943222, "body": "Might be useful for general info: <a href=\"http://www.sommarskog.se/error-handling-I.html#ADO\" rel=\"nofollow noreferrer\">sommarskog.se/error-handling-I.html#ADO</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "reply_to_user": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501783396, "post_id": 45480719, "comment_id": 77944428, "body": "I have some very complex ones and use the same technique throughout. All that matters is that each procedure either returns @@ROWCOUNT or the negative of the errorid. Some procedures have multiple statements with multiple records affected. In such cases I sum @@ROWCOUNT each time and return the sum."}], "tags": [], "owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "is_accepted": false, "score": 2, "last_activity_date": 1501753910, "creation_date": 1501753910, "answer_id": 45480719, "question_id": 45472383, "link": "https://stackoverflow.com/questions/45472383/i-want-to-know-the-sql-server-procedure-error-output-to-be-print-or-know-from-vb/45480719#45480719", "title": "I want to know the SQL Server procedure error output to be print or know from vba so that i can check my procedure has completely executed or not", "body": "<p>I apologise from the start that this reply is going to be quite long and detailed, but I have seen a few similar questions recently, and it seems to be something that has not received a full answer.  One reason for this, is that AFAIK there is not an easy solution.  This is essentially because SQL Server does not use the same Exception throwing as .Net or Office.  So as you have no doubt observed, even when you know that an error has occurred, no exception is raised in your VBA code that you can trap.</p>\n\n<p>So how do we go about it?  My solution is relatively complex, but once set up, it will work for any stored procedure you need to call.</p>\n\n<p>Firstly within SQL Server create an errors table.  I use this:</p>\n\n<pre><code>CREATE TABLE Errors\n(\n    ErrorNumber int NOT NULL,\n    ErrorMessage nvarchar(4000) NOT NULL,\n    ErrorSeverity int NOT NULL,\n    ErrorState int NOT NULL,\n    ErrorLine int NOT NULL,\n    ErrorProcedure nvarchar(128) NOT NULL,\n    Msg varchar(200) NULL,\n    ErrorID int NOT NULL,\n CONSTRAINT PK_Errors PRIMARY KEY CLUSTERED \n(\n    ErrorID ASC\n)\n)\n</code></pre>\n\n<p>Next create a procedure which all other procedures can call when encountering an error.  Mine is:</p>\n\n<pre><code>CREATE PROCEDURE uspErrorReporter\n\n@msg    varchar(200)\n\nAS\ndeclare @id int;\n\nSET @id = (SELECT (ISNULL(MAX(ErrorID),0)) + 1 FROM Errors)\n\n\nINSERT INTO Errors\n    SELECT\n        ERROR_NUMBER() AS ErrorNumber,\n        ERROR_MESSAGE() AS ErrorMessage,\n        ERROR_SEVERITY() AS ErrorSeverity,\n        ERROR_STATE() AS ErrorState,\n        ERROR_LINE() AS ErrorLine,        \n        ERROR_PROCEDURE() AS ErrorProcedure,\n        @msg, \n        @id;\n\nSELECT -@id\n</code></pre>\n\n<p>Notice here that I am returning the negative id.  This is because my stored procedures usually return the number of rows affected (through SELECT @@ROWCOUNT), which should be positive, so I want an error code to be negative.</p>\n\n<p>Next we create a stored procedure to return any error details that do happen.  Something like this:</p>\n\n<pre><code>CREATE PROCEDURE uspErrorDetailsGet\n\n@id int\n\nAS\n    SELECT\n        ErrorNumber,\n        ErrorMessage,\n        ErrorSeverity,\n        ErrorState,\n        ErrorLine,        \n        ErrorProcedure,\n        Msg \n    FROM Errors WHERE ErrorID = -@id;\n</code></pre>\n\n<p>Finally (within SQL Server) we now alter our stored procedures to invoke this error trapping mechanism.  I cite a simple one of mine below for illustrative purposes:</p>\n\n<pre><code>CREATE procedure uspDealerInsert\n@dealer varchar(15)\n\nas\n\nbegin try\n\n    set nocount on\n\n    INSERT INTO Dealers VALUES(@dealer)\n    SELECT @@ROWCOUNT \n\n    set nocount off\n\nend try\n\nbegin catch\n    declare @msg nvarchar(200)\n    SET @msg = ('Error during insertion of dealer...')\n\n    EXECUTE uspErrorReporter @msg\nend catch\n</code></pre>\n\n<p>If you want to test my example you will need to create a Dealers table.  This is as simple as it gets:</p>\n\n<pre><code>CREATE TABLE Dealers(\n    Dealer varchar(15) NOT NULL,\n    CONSTRAINT PK_Dealers PRIMARY KEY CLUSTERED \n    (\n    Dealer ASC\n    )\n)\n</code></pre>\n\n<p>Now we are ready for some VBA:</p>\n\n<pre><code>Sub Button1_Click()\n\nDim conn As ADODB.Connection\nDim cmd As ADODB.Command\nDim connStr As String\nDim param As ADODB.Parameter\nDim result As ADODB.Recordset\nDim retCode As Integer\n\n    connStr = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=dbName;Data Source=serverName\"\n\n    Set conn = New ADODB.Connection\n    conn.ConnectionString = connStr\n    conn.Open\n\n    Set cmd = New ADODB.Command\n    Set param = cmd.CreateParameter\n    param.Name = \"@dealer\"\n    param.Type = adVarChar\n    param.Value = \"Chris\"\n    param.Size = 15\n    cmd.Parameters.Append param\n\n    With cmd\n        .ActiveConnection = conn\n        .CommandType = adCmdStoredProc\n        .CommandText = \"uspDealerInsert\"\n        Set result = .Execute\n    End With\n\n    If Not result.EOF Then\n        retCode = result.Fields(0).Value\n        If retCode &lt; 0 Then\n            Dim msgcmd As ADODB.Command\n            Dim msgparam As ADODB.Parameter\n            Set msgcmd = New ADODB.Command\n            Set msgparam = msgcmd.CreateParameter\n            msgparam.Name = \"@id\"\n            msgparam.Type = adInteger\n            msgparam.Value = retCode\n            msgcmd.Parameters.Append msgparam\n\n            Dim msgresult As ADODB.Recordset\n            With msgcmd\n                .ActiveConnection = conn\n                .CommandType = adCmdStoredProc\n                .CommandText = \"uspErrorDetailsGet\"\n                Set msgresult = .Execute\n                If Not msgresult.EOF Then\n                    MsgBox msgresult.Fields(1).Value\n                End If\n            End With\n            Set msgcmd = Nothing\n            Set msgresult = Nothing\n        End If\n\n    End If\n\n    conn.Close\n    Set result = Nothing\n    Set cmd = Nothing\n    Set conn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Now for some explanation.  The ADODB.Command Execute returns a RecordSet.  It is within this RecordSet therefore that our own return codes are to be found.  Usually in my procedures I am returning a single value being rows affected, so the recordset has only one row and one field.  That is why we know that the rows affected should appear as Fields(0).Value.  But now we have the benefit of our previous work on SQL Server.  If the number thus returned is negative, we know that it is the (negative) id of an entry in the errors table.  So we call the stored procedure to load a recordset with the full entries for this error.  In my example I have only sent the ErrorMessage (Fields(1)) to the MsgBox for display purposes (as I usually find this is sufficient to identify the problem), but you can readily change this by adding the other fields as well.</p>\n\n<p>Obviously in a complex workbook with many calls to the database, you would want to put the error display code in a separate sub-routine so that you can call it in multiple places.</p>\n\n<p>If you play along with my example, first time you run the code it should execute fine.  On the second attempt though, you will get a Primary Key violation message.</p>\n\n<p>Obviously you will need to change the connection string and make sure your tables and stored procedures have appropriate permissions.</p>\n"}, {"tags": [], "owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1501780434, "creation_date": 1501780434, "answer_id": 45490693, "question_id": 45472383, "link": "https://stackoverflow.com/questions/45472383/i-want-to-know-the-sql-server-procedure-error-output-to-be-print-or-know-from-vb/45490693#45490693", "title": "I want to know the SQL Server procedure error output to be print or know from vba so that i can check my procedure has completely executed or not", "body": "<p>Add <code>SET NOCOUNT ON;</code> as the first statement in the stored procedure. This will suppress <code>DONE_IN_PROC</code> messages (row counts) returned by SQL Server, which ADO classic (not ADO.NET) returns as empty result sets with no columns to the application. </p>\n\n<p>If <code>DONE_IN_PROC</code> are returned due to <code>SET NOCOUNT OFF</code> (the default), the app code needs invoke the <code>NextRecordset</code> method on the <code>RecordSet</code> object returned by <code>Connection.Execute</code> before subsequent statements in the processed. It's generally easier to just specify <code>SET NOCOUNT ON;</code> unless multiple record sets need to be processed.</p>\n"}], "owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1501780434, "creation_date": 1501715433, "last_edit_date": 1531164843, "question_id": 45472383, "link": "https://stackoverflow.com/questions/45472383/i-want-to-know-the-sql-server-procedure-error-output-to-be-print-or-know-from-vb", "title": "I want to know the SQL Server procedure error output to be print or know from vba so that i can check my procedure has completely executed or not", "body": "<p><a href=\"https://i.stack.imgur.com/k8im8.png\" rel=\"nofollow noreferrer\">My SQL Server test procedure</a></p>\n\n<p>My VBA code test goes like this</p>\n\n<pre><code>Public mycon As New ADODB.Connection\nConst st As String = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Data Source=WEL-COME-PC\\SQLEXPRESS;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=WEL-COME-PC;Use Encryption for Data=False;Tag with column collation when possible=False;Initial Catalog=testdb\"\n\nSub conopen()\n\nIf mycon.State = 0 Then\n    mycon.Open st\nEnd If\n\nEnd Sub\n\nSub conclose()\n\nIf mycon.State = 1 Then\n\nmycon.Close\nEnd If\nEnd Sub\n\nSub proceduretotest()\n\nquery = \"exec usp_datepractice '7/30/2017','7/29/2017','576.test'\"\n\nCall conopen\nMsgBox \"connected to sql server\"\n\nmycon.Execute query\n\nCall conclose\n\n\nEnd Sub\n</code></pre>\n\n<p>This is my test SQL Server procedure:</p>\n\n<pre><code>create table datepractice\n(\n     TodaysDate Date,\n     yesterdays date,\n)\n\ncreate procedure usp_datepractice\n     (@datetodays date, \n      @dateyesterday date,\n      @datetest varchar\n     )\nas\nbegin\n    insert into datepractice (TodaysDate, yesterdays) \n    values (@datetodays, @dateyesterday)\n\n    insert into datepractice (TodaysDate, yesterdays) \n    values (@datetodays, @dateyesterday)\n\n    insert into datepractice (TodaysDate, yesterdays) \n    values (@datetest, '09/09/2017')\n\n    update datepractice \n    set yesterdays = '7/26/2017' \n    where yesterdays = '7/29/2017'\nend\n\nexec usp_datepractice '7/30/2017','7/29/2017','576.test'\n</code></pre>\n\n<p>I have deliberately put the <code>'576.test'</code> in the SQL Server stored procedure to throw an error, now, when I execute the procedure through VBA, the procedure runs partially, and after affecting some rows, it throws an error that I deliberately put in. </p>\n\n<p>Now I want to print or know the error in VBA because it does not show in VBA and procedure continues running.</p>\n\n<p>I want to know the SQL Server procedure error output </p>\n\n<blockquote>\n  <p>Msg 241, Level 16, State 1, Procedure usp_datepractice, Line 7<br>\n  Conversion failed when converting date and/or time from character string</p>\n</blockquote>\n\n<p>to be printed or reported from VBA so that I can check my procedure has completely executed or not.</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501712339, "post_id": 45471880, "comment_id": 77904821, "body": "<code>Range(&quot;MiscDataRange&quot;).ClearContents</code> does not reference any particular sheet. it will use any sheet that is active at the moment the code executes."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501712373, "post_id": 45471880, "comment_id": 77904833, "body": "what happens if you execute <code>Range(&quot;MiscDataRange&quot;).ClearContents</code> or <code>Range(&quot;MiscDataRange&quot;).Select</code> ?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501712486, "post_id": 45471880, "comment_id": 77904865, "body": "unhide all the worksheets"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1501713696, "post_id": 45471880, "comment_id": 77905274, "body": "You can find exactly where Named ranges are from Immediate Window, e.g. <code>Range(&quot;MiscDataRange&quot;).Address(External:=True)</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501713824, "post_id": 45471880, "comment_id": 77905311, "body": "You can also find out where Named Ranges refer to by going to <code>Formulas &#47; Name Manager</code> on the Excel menu."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1501712335, "creation_date": 1501712335, "answer_id": 45471917, "question_id": 45471880, "link": "https://stackoverflow.com/questions/45471880/find-worksheet-name-mapping-in-excel/45471917#45471917", "title": "Find worksheet name mapping in Excel", "body": "<p>If I understand your question, you're looking to find where those named ranges are.</p>\n\n<p>You can use a sub like this:</p>\n\n<pre><code>Sub t()\nDebug.Print \"Sheet: \" &amp; Range(\"testNamedRange\").Parent.Name\nDebug.Print \"Full Location: \" &amp; Range(\"testnamedrange\").Name\nDebug.Print \"File path: \" &amp; Range(\"testnamedrange\").Worksheet.Parent.Path\nEnd Sub\n</code></pre>\n\n<p>Does that help?</p>\n"}, {"comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1501715872, "post_id": 45472376, "comment_id": 77905841, "body": "Nice one! <b><code>F3</code></b> then <b>Paste List</b> is something i didn&#39;t know! I wrote macro to extract same details when I had to troubleshoot a template with macro that has over 1000 named ranges (many are duplicates). Only drawback is not showing <b>Table</b> names and their range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1501716266, "post_id": 45472376, "comment_id": 77905938, "body": "Thanks! Your <code>Range(&quot;MiscDataRange&quot;).Address(External:=True)</code> comment was spot on."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1501717499, "post_id": 45472376, "comment_id": 77906209, "body": "I see the Formulas name manager (mine has a lot of #REFs in it!), and have made the sub and run it.  But I&#39;m not quite sure what you&#39;re clicking on that shows the results of the sub.  If it&#39;s the same as the name manager, then I guess I don&#39;t need that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1501717677, "post_id": 45472376, "comment_id": 77906245, "body": "<code>F3</code> will bring up the paste name box."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1501717697, "post_id": 45472376, "comment_id": 77906251, "body": "Interestingly, the formula name manager brings up 9 names, I have 11 sheets, and there are no names that match a sheet name.  It does tell me that my MiscDataRange is range on MiscInt.  I&#39;m guessing it only lists names that are in addition to straightforward sheet names?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1501717789, "post_id": 45472376, "comment_id": 77906271, "body": "The Names Manager has a FIlter button that will allow you to change it&#39;s scope"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 4, "last_activity_date": 1501715975, "last_edit_date": 1501715975, "creation_date": 1501715369, "answer_id": 45472376, "question_id": 45471880, "link": "https://stackoverflow.com/questions/45471880/find-worksheet-name-mapping-in-excel/45472376#45472376", "title": "Find worksheet name mapping in Excel", "body": "<p>You can open the Names manager by going to the Formula Tab and clicking <strong>Names Manager</strong> or pressing <kbd>ctrl</kbd>+<kbd>F3</kbd> or you can paste a list of Names and what the names reference by pressing <kbd>F3</kbd>.  It may be necessary to unhide the names first.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XYnr6.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XYnr6.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub ShowAllNames()\n    Dim n As Name\n    For Each n In ThisWorkbook.Names\n        n.Visible = True\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 2, "accepted_answer_id": 45472376, "answer_count": 2, "score": 0, "last_activity_date": 1501715975, "creation_date": 1501712072, "last_edit_date": 1501713702, "question_id": 45471880, "link": "https://stackoverflow.com/questions/45471880/find-worksheet-name-mapping-in-excel", "title": "Find worksheet name mapping in Excel", "body": "<p>I have inherited an Excel workbook with several worksheets, all with named tabs.  I have some VBA code that runs depending on buttons and inputs.  When I compare the VBAProject and the list of Excel Objects, the sheet's names match the tabs.  All good so far.</p>\n\n<p>However, within the VBA code and on the spreadsheets itself, it refers to other worksheets.  They are still part of the workbook, and I think that the code was created, and then tabs were renamed.  But I don't know how Excel keeps the connection, or, more importantly, how I am supposed to figure out the connections.</p>\n\n<p>So, for instance, I have a VLOOKUP that refers to MiscDataRange </p>\n\n<pre><code>=IF((VLOOKUP(E4,MiscDataRange,4,0))=\"Y\"...\n</code></pre>\n\n<p>I don't know what MiscDataRange is, but within the VBA code I find one reference.  Right after specifying worksheet \"Misc Interrupt\", which is NOT any of the named tabs.</p>\n\n<pre><code>    Worksheets(\"Misc Interrupt\").Range(\"H2:H47\") = \"N\" 'Reset to N at noon.\n\n    UpdateData\n\n    Range(\"MiscDataRange\").ClearContents\n</code></pre>\n\n<p>I do have a sheet called MiscInt, and it appears to be the sheet that \"Misc Interrupt\" is using and MiscDataRange is referencing.</p>\n\n<p>My problem is there is a hole in my knowledge - I can guess that MiscInt and Misc Interrupt are the same worksheet, that the VLookup is referring to data on the MiscInt sheet.  But I am reduced to guessing.  I cannot find anything in the file that maps those two as the same.  Where would I look to find that?</p>\n\n<p>This question seems related, except he simply has a VLookup, and isn't looking at the VBA code: <a href=\"https://stackoverflow.com/questions/21333516/non-existent-excel-worksheet-but-formulas-and-defined-names-still-work\">Non-existent Excel Worksheet, but Formulas and Defined names still work?</a>.  In addition, from the VBA code, I can see hidden and visible worksheets.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1501712177, "post_id": 45471748, "comment_id": 77904757, "body": "Declare some <code>App</code> variable within IE <code>window</code> object via <code>.execScript</code> method, assign it the reference to the Excel <code>Application</code> object, then call Excel macro with <code>App.Run &quot;MacroName&quot;</code> within IE button onclick event handler code. <a href=\"https://stackoverflow.com/a/38134477/2165759\">This example</a> may help."}], "answers": [{"tags": [], "owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "is_accepted": true, "score": 2, "last_activity_date": 1501713270, "creation_date": 1501713270, "answer_id": 45472073, "question_id": 45471748, "link": "https://stackoverflow.com/questions/45471748/handle-htmlelement-events-in-vba/45472073#45472073", "title": "Handle HTMLElement events in VBA", "body": "<p>You could add reference to MSHTML, then make your class module this way:</p>\n\n<pre><code>Public WithEvents ie As SHDocVw.InternetExplorer\n\nPrivate WithEvents button As MSHTML.HTMLButtonElement\n\nPublic Sub LoadButton()\n    Set button = ie.document.getElementsByTagName(\"button\").Item(0)\nEnd Sub\n\nPrivate Function button_onclick() As Boolean\n    'do what you want here\nEnd Function\n\nPrivate Sub ie_onQuit()\n    Debug.Print \"onQuit was fired\"\nEnd Sub\n</code></pre>\n\n<p>And then, in the other module, add this statement after setting <code>CIEobj.ie</code> property:</p>\n\n<pre><code>CIEobj.LoadButton\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8408068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096c39154072b7f89749d33d02b85a50?s=128&d=identicon&r=PG&f=1", "display_name": "F. Schmidt", "link": "https://stackoverflow.com/users/8408068/f-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 45472073, "answer_count": 1, "score": 0, "last_activity_date": 1501713270, "creation_date": 1501711381, "question_id": 45471748, "link": "https://stackoverflow.com/questions/45471748/handle-htmlelement-events-in-vba", "title": "Handle HTMLElement events in VBA", "body": "<p>I use <code>SHDocVw.InternetExplorer</code> to show in powerpoint a local html file to the user. The file contains a form with a submit button and I would like to run my vba function when the button is clicked. I did the following to handle the onQuit-event of the InternetExplorer.</p>\n\n<p>Class module \"CIE\"</p>\n\n<pre><code>Public WithEvents ie As SHDocVw.InternetExplorer\n\nPrivate Sub ie_onQuit()\n    Debug.Print \"onQuit was fired\"\nEnd Sub\n</code></pre>\n\n<p>Module code</p>\n\n<pre><code>Option Explicit\n\nPublic curCIE As CIE\n\nSub open_ie()\n    Dim CIEobj As CIE\n    Set CIEobj = New CIE\n\n    Dim ie As SHDocVw.InternetExplorer\n    Set ie = New SHDocVw.InternetExplorer\n\n    ie.Visible = True\n    ie.Navigate \"C:\\search.html\"\n\n    Do While ie.Busy Or ie.readyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n    Set CIEobj.ie = ie\n    Set curCIE = CIEobj\nEnd Sub\n</code></pre>\n\n<p>I actually want to handle the onclick event of </p>\n\n<pre><code>curCIE.ie.Document.getElementsByTagName(\"button\").Item(0)\n</code></pre>\n\n<p>but I do not know how to proceed.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501790196, "post_id": 45471698, "comment_id": 77948402, "body": "there is a problem with trying to export page numbers, because page numbers are dependent on the printed page size, margins etc. you may need to somehow specify a &quot;dummy&quot; printer that has a preset page and margin sizes."}, {"owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501790572, "post_id": 45471698, "comment_id": 77948667, "body": "I noticed this on another macro and it was using the default settings on whichever computer it was being run on. When we changed the default settings then the margins and page sizes came out properly. But the export function seems to be working better for our purposes at the moment. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "edited": false, "score": 0, "creation_date": 1501766450, "post_id": 45472346, "comment_id": 77931460, "body": "Thank you for the code above, I pasted it and tried it out, but had an extra page is being generated and my active fields in the document are not found in the exported document. I&#39;m going to try using integers first with my first approach but will play with this one too. I&#39;m new to this so it&#39;s all foreign to me. I appreciate your support!"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1501716132, "last_edit_date": 1501716132, "creation_date": 1501715190, "answer_id": 45472346, "question_id": 45471698, "link": "https://stackoverflow.com/questions/45471698/word-vba-macro-to-export-sections-as-pdf/45472346#45472346", "title": "Word VBA Macro to Export Sections as PDF", "body": "<p>this is how to export a range  ... arrived at this by recording a macro, which ended up starting with <code>Selection.ExportAsFixedFormat</code> .... <code>Selection</code> is a range object .....</p>\n\n<pre><code>ActiveDocument.Range(800, 1000).ExportAsFixedFormat _\n    OutputFileName:=strName &amp; \"PLAN.pdf\", _\n    ExportFormat:=wdExportFormatPDF, _\n    OpenAfterExport:=True, _\n    OptimizeFor:=wdExportOptimizeForPrint, _\n    ExportCurrentPage:=False, _\n    Item:=wdExportDocumentContent, _\n    IncludeDocProps:=False, _\n    KeepIRM:=True, _\n    CreateBookmarks:=wdExportCreateNoBookmarks, _\n    DocStructureTags:=True, _\n    BitmapMissingFonts:=True, _\n    UseISO19005_1:=False\n</code></pre>\n\n<p>change first line to export 2nd section</p>\n\n<pre><code>    ActiveDocument.Sections(2).Range().ExportAsFixedFormat _\n</code></pre>\n\n<p>you can do this to see what will be exported  ... use for debugging, to see which range you are referrencing</p>\n\n<pre><code>ActiveDocument.Sections(2).Range().Select   ' you can instead paste this line into the \"Immediate Window\", and then look at your document\nStop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "edited": false, "score": 0, "creation_date": 1501766330, "post_id": 45472436, "comment_id": 77931349, "body": "Thank you for your feedback. I tried wdExportSelection but have been running into more problems. I&#39;m going to investigate how I can assign the page numbers from sections as integers like you mentioned because that might work in the end. I get an extra page when I export the ExportSelection and my fields are blank in the exported document. (I have fields updating in the document) Thanks!"}, {"owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "edited": false, "score": 0, "creation_date": 1501773100, "post_id": 45472436, "comment_id": 77937462, "body": "So I&#39;ve been experimenting with entering the page numbers are integers and have figured out how to get the end of the section as an integer. I haven&#39;t been able to get the first value of the section range as an integer. I&#39;m guessing it&#39;s pretty easy, would you know what that command might be? Below is what I added and intValue1 works for identifying the last page of the section. But I can&#39;t get inValue2 to identify the first page of the section."}, {"owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "edited": false, "score": 0, "creation_date": 1501773169, "post_id": 45472436, "comment_id": 77937516, "body": "&lt;pre&gt;Dim intValueR As Range Dim intValue1 As Integer Dim intValue2 As Integer Set intValueR = ActiveDocument.Sections(3).Range intValue1 = CStr(intValueR.Information(wdActiveEndPageNumber)) intValue2 = ?? &lt;code&gt;"}, {"owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "edited": false, "score": 0, "creation_date": 1501776171, "post_id": 45472436, "comment_id": 77939712, "body": "I added the code from the above post as an edit to my original post. The formatting makes it unreadable in my response."}], "tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1501715833, "creation_date": 1501715833, "answer_id": 45472436, "question_id": 45471698, "link": "https://stackoverflow.com/questions/45471698/word-vba-macro-to-export-sections-as-pdf/45472436#45472436", "title": "Word VBA Macro to Export Sections as PDF", "body": "<p>I would suggest that you first select the section you want to export and then use <code>wdExportSelection</code> instead of <code>wdExportFromTo</code>. To select the section, see <a href=\"https://word.tips.net/T000523_Selecting_an_Entire_Section.html\" rel=\"nofollow noreferrer\">this page</a> where <code>Selection.Range.Sections.First.Range.Select</code> is used, or experiment with the macro recorder. But, if you do want to use <code>wdExportFromTo</code> then the answer to your question about \"entering those strings as page numbers\" is that, yes, you have the right idea, but you would need to use integers rather than strings. </p>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501778210, "post_id": 45489938, "comment_id": 77941207, "body": "NB: <code>Cstr</code> is unnecessary and potentially wrong overhead. It&#39;s casting an integer/long value to a string, which is then implicitly converted back to an integer (e.g., <code>intValue1 As Integer</code>, etc). Remove <code>Cstr</code> for sure."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501806565, "post_id": 45489938, "comment_id": 77954338, "body": "@PrestonAVH, wrap section2page conversion in a function  <code>function sec2page(sec as integer) as integer</code>  <code>sec2page = ActiveDocument.Sections(sec).Range.Information(wdActiveEndPa&zwnj;&#8203;geNumber)</code> <code>end function</code>"}, {"owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "edited": false, "score": 0, "creation_date": 1502130329, "post_id": 45489938, "comment_id": 78066708, "body": "@jsotoloa, wow thank you. That cleans up the code a lot and removes the use of defining a range. I really appreciate the help, this is going to save me a lot of time at work"}], "tags": [], "owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "is_accepted": false, "score": 1, "last_activity_date": 1501777957, "creation_date": 1501777957, "answer_id": 45489938, "question_id": 45471698, "link": "https://stackoverflow.com/questions/45471698/word-vba-macro-to-export-sections-as-pdf/45489938#45489938", "title": "Word VBA Macro to Export Sections as PDF", "body": "<p>Alright so I found a solution, it's really ugly but it works. Since I didn't know how to set the first part of the section range as an integer but I did know how to set the last part of the section range as an integer. I simply set the first part as the last part of the previous section's range plus 1. </p>\n\n<p>The result is this bit of code:</p>\n\n<pre><code>Dim intValueR As Range\nDim intValueR2 As Range\nDim intValue1 As Integer\nDim intValue2 As Integer\nSet intValueR = ActiveDocument.Sections(3).Range\nSet intValueR2 = ActiveDocument.Sections(2).Range\nintValue1 = CStr(intValueR.Information(wdActiveEndPageNumber))\nintValue2 = CStr(intValueR2.Information(wdActiveEndPageNumber)) + 1\n</code></pre>\n\n<p>If someone has a cleaner way of doing this, that would be fantastic. But if someone needs something like this, it's working for me.</p>\n\n<p>Shout out to @TonyM and @jsotola!</p>\n"}], "owner": {"reputation": 11, "user_id": 8408087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bd2656d2a4b240794c44ee85791f09?s=128&d=identicon&r=PG&f=1", "display_name": "PrestonAVH", "link": "https://stackoverflow.com/users/8408087/prestonavh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4116, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1521440392, "creation_date": 1501711112, "last_edit_date": 1506005972, "question_id": 45471698, "link": "https://stackoverflow.com/questions/45471698/word-vba-macro-to-export-sections-as-pdf", "title": "Word VBA Macro to Export Sections as PDF", "body": "<p><strong>Background</strong>: I currently have a document that is broken up into separate sections by section breaks in Word. I have a macro to <strong>print</strong> pdf's of the sections to a users chosen directory and a macro to <strong>export</strong> static pages as pdf's. I've entered the page numbers in the <strong>export</strong> macro for the time being because the save function works a lot faster than the print as pdf function. But I would like to have the macro export sections as pdfs with page numbers that can change.</p>\n\n<p><strong>Note</strong>: Section pages can change depending on the work I am doing on my master file, so using static page numbers in my macro is only temporary solution. Resolving this is really important for me. </p>\n\n<p>What I Have So Far (This is the <strong>export</strong> macro):</p>\n\n<pre><code>Sub PLANv()\n'\n' PLANv Macro\n'\n'\nDim strName As String\n\nstrName = InputBox(Prompt:=\"Save To:\", Title:=\"Save file to:\", _\nDefault:=\"C:\\Users\\PRESTONAVH\\Desktop\\Task Order Files\\\")\n\nIf strName = vbNullString Then\n    Exit Sub\nElse\n\nEnd If\n\nActiveDocument.ExportAsFixedFormat OutputFileName:= _\n    strName &amp; \"PLAN.pdf\", _\n    ExportFormat:=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _\n    wdExportOptimizeForPrint, Range:=wdExportFromTo, From:=3, To:=4, Item:= _\n    wdExportDocumentContent, IncludeDocProps:=False, KeepIRM:=True, _\n    CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n    BitmapMissingFonts:=True, UseISO19005_1:=False\nEnd Sub\n</code></pre>\n\n<p><strong>What I Would Like to Have</strong>:</p>\n\n<p>It seems that my macro that exports as a PDF does not allow me to put the sections in the range field, I've tried and it always gives me an error message. I currently have the static page range in there (3-4).  I was thinking that maybe there there is some code I could enter before that, that would return the starting page number and ending page number of the section I'm exporting. Then I could assign a string to whatever is returned and then in the range function enter those strings as the page numbers? </p>\n\n<p>I'm really not good at this stuff but have been going through lots of forums and trying to piece together what other people have suggested with no luck. There is probably a much easier solution, but as long as it works that would really be great. I've been trying to figure this out for some time now, but I've gone through too many forums and am a VBA super beginner.</p>\n\n<p>If anyone would be able to help me out I would really appreciate it.</p>\n\n<p>Thank You</p>\n\n<p>Update:\nI tried the export section code as recommended but my fields were erased in the exported documents and a blank page added. So I'm trying to use the section range to set the first and last integers of the export range. I can get intValue1 which gives me the last page of the section range. But I don't know how to get intValue2 for the first page of the section range. Below is what I added in between my save prompt and the export code.</p>\n\n<pre><code>Dim intValueR As Range\nDim intValue1 As Integer\nDim intValue2 As Integer\nSet intValueR = ActiveDocument.Sections(3).Range\nintValue1 = CStr(intValueR.Information(wdActiveEndPageNumber))\nintValue2 = ??\n</code></pre>\n\n<p><strong>(SOLVED)</strong>\nHi everyone, thanks for helping me out, I have the final code that is working well for me now. Here's the code:</p>\n\n<pre><code>Dim strName As String\n\nstrName = InputBox(Prompt:=\"Save To:\", Title:=\"Save file to:\", _\nDefault:=\"C:\\Users\\PRESTONAVH\\Desktop\\Task Order Files\\\")\n\nIf strName = vbNullString Then\nExit Sub\nElse\n\nEnd If\n\nDim intValue1 As Integer\nDim intValue2 As Integer\nintValue1 = \nActiveDocument.Sections(1).Range.Information(wdActiveEndPageNumber) + 1\nintValue2 = \nActiveDocument.Sections(2).Range.Information(wdActiveEndPageNumber)\n\nActiveDocument.ExportAsFixedFormat OutputFileName:= _\n    strName &amp; \"PLAN.pdf\", _\n    ExportFormat:=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _\n    wdExportOptimizeForPrint, Range:=wdExportFromTo, From:=intValue1, \nTo:=intValue2, Item:= _\n    wdExportDocumentContent, IncludeDocProps:=False, KeepIRM:=True, _\n    CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n    BitmapMissingFonts:=True, UseISO19005_1:=False\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1501710941, "post_id": 45471600, "comment_id": 77904326, "body": "<code>SaveCopyAs</code> should do that"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501717281, "post_id": 45471600, "comment_id": 77906169, "body": "also make sure that your code does not reference the workbook by name"}], "owner": {"reputation": 402, "user_id": 6807003, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5f1f23a80ed5f34e1e7c29d2aaabc674?s=128&d=identicon&r=PG&f=1", "display_name": "lostinOracle", "link": "https://stackoverflow.com/users/6807003/lostinoracle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501710694, "creation_date": 1501710694, "question_id": 45471600, "link": "https://stackoverflow.com/questions/45471600/how-to-generate-new-workbooks-with-vba-button-intact", "title": "How to generate new workbooks with vba button intact", "body": "<p>I have a worksheet that has a macro (as a button) that generates a separate worksheet w/ some analysis on it. Is it possible to generate a new workbook with the old workbook's VBA intact and with the new workbook's button referring to the new workbook's VBA? </p>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "edited": false, "score": 0, "creation_date": 1501711022, "post_id": 45471365, "comment_id": 77904361, "body": "Are both buttons promptly available, or <code>id=exportTable</code> will be script-created after clicking <code>id=exportTransactions</code>? The latter being the case, you&#39;d have to put a wait similar to the &quot;webpage loading&quot; wait, and check whether all elements you need are fully loaded and rendered in the page."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1501713790, "post_id": 45471365, "comment_id": 77905299, "body": "@Nick Thalken what error do you get? What does wrong when you run the code. &quot;I cannot seem to get to work&quot; is not helpful for us to help you."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501717980, "post_id": 45471365, "comment_id": 77906327, "body": "quick way to test if your code will work at all: insert &quot;stop&quot; after the first &quot;click&quot; line. run the code. when it stops, wait a few seconds, then press F8 to single-step, or press F5 to continue without pause (also check the IE instance that gets created)"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1501771960, "post_id": 45471365, "comment_id": 77936553, "body": "Do you even manage to reach that second button ? Ensure it is not embedded in a frame, iframe or form. In that case, you should first select that form/frame/iframe and use the GetElementById from there."}, {"owner": {"reputation": 21, "user_id": 8408054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b675268e8a48c7f16563f934835fd74d?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Thalken", "link": "https://stackoverflow.com/users/8408054/nick-thalken"}, "edited": false, "score": 0, "creation_date": 1501775726, "post_id": 45471365, "comment_id": 77939394, "body": "With my code now the button simply isn&#39;t being clicked. It does nothing. No error"}, {"owner": {"reputation": 21, "user_id": 8408054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b675268e8a48c7f16563f934835fd74d?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Thalken", "link": "https://stackoverflow.com/users/8408054/nick-thalken"}, "edited": false, "score": 0, "creation_date": 1501776305, "post_id": 45471365, "comment_id": 77939826, "body": "I got it to work using a wait command. Thank you VBobCat and jsotola"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1501839217, "post_id": 45471365, "comment_id": 77967046, "body": "Normally button have a &quot;onclick&quot; or &quot;href&quot; attribute. You could try the &quot;FireEvent&quot; too but few chances it works. If you can provide the url of the website in question I can give it a look."}], "owner": {"reputation": 21, "user_id": 8408054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b675268e8a48c7f16563f934835fd74d?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Thalken", "link": "https://stackoverflow.com/users/8408054/nick-thalken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1501709786, "creation_date": 1501709611, "last_edit_date": 1501709786, "question_id": 45471365, "link": "https://stackoverflow.com/questions/45471365/vba-click-button-in-website-html-button-issues", "title": "VBA - click button in website (HTML button issues)", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;button type=\"button\" class=\"button_primary\" id=\"exportTable\"&gt;&lt;span&gt;Export&lt;/span&gt;&lt;/button&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Hello I am trying to export data into a csv file from my bank website. The website has a button to export the data for me and I am simply trying to click the button. The first button click that I have clicks on the export icon on the page and opens up the option to export but there is then another export button that I cannot seem to get to work. I included the html code and my VBA code. Any  thought of the second segment with Id \"exportTable\"?</p>\n\n<pre><code>Dim ie As Object\n\nDim html As HTMLDocument\n\nDim htmlel As IHTMLElement\n\nDim htmlin As HTMLInputElement\n\nDim htmlbut As HTMLButtonElement\n\nie.navigate \"website\"\n\nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n\nApplication.StatusBar = \"Loading Webpage ...\"\n\nDoEvents\n\nLoop\n\nSet htmlbut = ie.document.getElementById(\"exportTransactions\")\n\nhtmlbut.Click\n\nSet htmlbut = ie.document.getElementById(\"exportTable\")\n\nhtmlbut.Click\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "adodb", "sqloledb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501709237, "post_id": 45471184, "comment_id": 77903654, "body": "Maybe there is some issue with your implementation, but without any code I&#39;m not sure how we&#39;d know what it might be?"}], "answers": [{"tags": [], "owner": {"reputation": 433, "user_id": 3341533, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5915f62fe3a2e631c1af82e4d257a5b2?s=128&d=identicon&r=PG&f=1", "display_name": "BioData41", "link": "https://stackoverflow.com/users/3341533/biodata41"}, "is_accepted": false, "score": 0, "last_activity_date": 1501711466, "creation_date": 1501711466, "answer_id": 45471764, "question_id": 45471184, "link": "https://stackoverflow.com/questions/45471184/vba-runtime-error-for-primary-key-violation-when-calling-ado-recordset-movefirst/45471764#45471764", "title": "VBA runtime error for primary key violation when calling ADO RecordSet.MoveFirst method", "body": "<p>I eventually ended up looking into the effect of the cursor that I was using.  I had not really looked into this much and was just using the default server-provided cursor.  Changing the CursorLocation property of the connection to adUseClient allowed me to call the MoveFirst method without any problems.</p>\n\n<p>Here's a small amount of code just to show how I'm getting the RecordSet now with specifying the cursor location as the only change to what I was doing:</p>\n\n<pre><code>Dim conn As ADODB.Connection\nDim adoRS As ADODB.RecordSet\nSet conn = New ADODB.Connection\n\nOn Error GoTo Catch\n**conn.CursorLocation = adUseClient**  //added this line\nconn.Open (ConnectionString)\n\nSet adoRS = conn.Execute(SQLStatement)\n//RecordSet inherits the cursor type from the connection\n//Calling adoRS.MoveFirst multiple times now does not generate an error. \n</code></pre>\n\n<p>But, I never did figure out why the server-provided cursor had the behavior that threw the exception or a way to work around it with the server-provided cursor.  </p>\n"}], "owner": {"reputation": 433, "user_id": 3341533, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5915f62fe3a2e631c1af82e4d257a5b2?s=128&d=identicon&r=PG&f=1", "display_name": "BioData41", "link": "https://stackoverflow.com/users/3341533/biodata41"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501711466, "creation_date": 1501708768, "question_id": 45471184, "link": "https://stackoverflow.com/questions/45471184/vba-runtime-error-for-primary-key-violation-when-calling-ado-recordset-movefirst", "title": "VBA runtime error for primary key violation when calling ADO RecordSet.MoveFirst method", "body": "<p>I'm using SQLOLEDB provider through ADODB to work with a SQLServer 2012R2 database using VBA running in Excel. </p>\n\n<p>I have no problems navigating through a RecordSet generated from a SELECT statement generated through a RecordSet.Open method. </p>\n\n<p>I recently started having a RecordSet returned from INSERT statements through the use of an OUTPUT clause to return the ID for a newly inserted Record. \nI then call the Connection.Execute method with the SQL statement and obtain a RecordSet from this with the new ID value.  </p>\n\n<p>If the table in which the new record was inserted has Primary Key(s) defined, then trying to call RecordSet.MoveFirst on this returned RecordSet results in the Primary Key Violation exception being thrown as a VBA Runtime error. If there are no Keys defined on the table, then I do not get the error.</p>\n\n<p>I'm getting the error in a generic function that I wrote which iterates through the record set to pull out data into an application-specific object.<br>\nI'm using the RecordSet.MoveFirst method prior to looping through the RecordSet to make sure that I'm at the beginning of the RecordSet, just in case the RecordSet had been touched by another method that changed the cursor position. </p>\n\n<p>I also call the MoveFirst method in another function that gets the number of Records in the RecordSet, since I couldn't find any other way with the default cursor to find out how many records there are. The exception is raised in either of these two methods, whenever MoveFirst is called.</p>\n\n<p>I noticed that the RecordSet returned from the OUTPUT Clause has the .Source property set to the full INSERT statement that was originally issued.  </p>\n\n<p>The property RecordSet.LockType is adLockReadOnly and .EditMode is adEditNone.</p>\n\n<p>One thing that I don't understand here is why MoveFirst would result in this behavior, where it seems to be trying to repeat the INSERT statement just because I'm moving the cursor.  I don't think it's actually doing that, because when I try this on a table with no keys defined I do not get an extra duplicate record being inserted. </p>\n\n<p>Advice?  Perhaps there is a better way to manage cursor positioning and iterating through the RecordSet?  </p>\n\n<p>I suppose I could try placing an \"On Error Resume Next\" statement before calling MoveFirst, but that doesn't seem like a good solution, even if it would work.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1501724486, "post_id": 45470968, "comment_id": 77907740, "body": "After run your  code MergeCells, run  mycode."}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1501727463, "post_id": 45472011, "comment_id": 77908405, "body": "Thanks for the code, Dy Lee. I did a small test run on the code you provide thus far and it appears to do what I want it to do! I did commented-out the second to last line <code>WS.UsedRange.Borders.LineStyle = xlContinuous</code> because I did not need the border lines to be drawn. I need to test it out more depth on my full report over the next few days, to see what it does overall. But thus far, very good!  Thank you!.  If you have a moment, could you please document your code so that I can understand better what it is doing, and when it is doing it? I want to modify it a bit to center merge the txt."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1501727819, "post_id": 45472011, "comment_id": 77908483, "body": "Colums (1).horizontalalignment=xlcenter"}, {"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1501728153, "post_id": 45472011, "comment_id": 77908552, "body": "Thanks for <code>Colums (1).horizontalalignment=xlcenter</code> tip.  I hope to have more time to test out and study your code further tomorrow.  Thus far, it looks and works great!  Thanks!"}, {"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1503002997, "post_id": 45472011, "comment_id": 78446857, "body": "The code above has been tested and works perfectly in my case.  Thank you, Dy Lee!"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1501712897, "creation_date": 1501712897, "answer_id": 45472011, "question_id": 45470968, "link": "https://stackoverflow.com/questions/45470968/vertical-merge-identical-cells-between-page-breaks/45472011#45472011", "title": "Vertical merge identical cells between page breaks", "body": "<p>After merge cells, execute this code.</p>\n\n<pre><code>Sub ResetHPage()\n    Dim WS As Worksheet\n    Dim rng As Range, rngST As Range, rngEnd As Range\n    Dim vHrow()\n    Dim C As Integer, n As Long, k As Long, i As Long\n    Dim mergeValue\n\n    ActiveWindow.View = xlPageBreakPreview\n\n\n    Set WS = ActiveSheet\n    C = WS.Cells.SpecialCells(xlCellTypeLastCell).Column\n\n    n = WS.HPageBreaks.Count\n\n    For i = 1 To n\n        k = k + 1\n        ReDim Preserve vHrow(1 To k)\n        vHrow(k) = WS.HPageBreaks(k).Location.Row\n    Next i\n    For i = 1 To n\n        For Each rng In Range(\"a\" &amp; vHrow(i), Cells(vHrow(i), C))\n            If rng.MergeCells Then\n                With rng.MergeArea\n                    If rng.Address = .Range(\"a1\").Address Then\n                    Else\n                        mergeValue = .Range(\"a1\")\n\n                        Set rngST = .Range(\"a1\")\n                        Set rngEnd = rng.MergeArea(.Rows.Count)\n\n                        .UnMerge\n                        rng = mergeValue\n                        Range(rngST, rng.Offset(-1, 0)).Merge\n                        Range(rng, rngEnd).Merge\n                    End If\n                End With\n            End If\n        Next rng\n    Next i\n\n    WS.UsedRange.Borders.LineStyle = xlContinuous\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 45472011, "answer_count": 1, "score": 1, "last_activity_date": 1501712897, "creation_date": 1501707900, "last_edit_date": 1531164843, "question_id": 45470968, "link": "https://stackoverflow.com/questions/45470968/vertical-merge-identical-cells-between-page-breaks", "title": "Vertical merge identical cells between page breaks", "body": "<p>I would like to vertically merge cells in Excel in column A between already set page breaks (i.e. prevent merging over page breaks).  I have code that tells the row where page breaks are located, and code to merge cells in Range column A, if two or more adjacent cells are identical (code shown below), now I am trying to figure out how to combine the two code snippets (code shown below) to only merge identical cells on full pages and not across the already set page breaks.  Can anyone come up with a solution?  Many thanks in advance.</p>\n\n<p><strong>Code to find row number of existing page breaks:</strong></p>\n\n<pre><code>Sub PageBreakAddresses() 'this finds row of pagebreak\n    Dim pb As HPageBreak\n\n    For Each pb In Sheet1.HPageBreaks\n        MsgBox pb.Location.row - 1\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Code to merge identical cells in column A:</strong></p>\n\n<pre><code>Sub MergeCells()  ' this merges identical cells in column A\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Dim rngMerge As Range, cell As Range\n    Dim i As Long\n    i = Cells(Rows.Count, \"A\").End(xlUp).row\n    Set rngMerge = Range(\"A1:A\" &amp; i)\n\nMergeAgain:\n    For Each cell In rngMerge\n        If cell.Value = cell.Offset(1, 0).Value And IsEmpty(cell) = False Then\n            Range(cell, cell.Offset(1, 0)).Merge\n            GoTo MergeAgain\n        End If\n    Next\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501708798, "post_id": 45470884, "comment_id": 77903403, "body": "Unrelated to your problem, but why do you use <code>ActiveSheet.Activate</code>?  By definition, the <code>ActiveSheet</code> is the one that is active, so that seems to be a pointless piece of code."}, {"owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501708932, "post_id": 45470884, "comment_id": 77903485, "body": "I have no idea I guess i wanted to be implicit in describing which sheet I was using"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501709102, "post_id": 45470884, "comment_id": 77903580, "body": "If you want to be explicit in defining which sheet you are using, you should start your code with something like <code>Dim ws As Worksheet: Set ws = ActiveSheet</code> and then use <code>MsgBox ws.Cells(1, 1).Value</code>.  If you don&#39;t, the user could change the active sheet between when you set the active sheet to be the active sheet and when the <code>MsgBox</code> is displayed."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501710147, "post_id": 45470884, "comment_id": 77904005, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31489843/error-for-using-cells-for-string-in-vba\">Error for using cells() for string in vba?</a>"}, {"owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501767017, "post_id": 45470884, "comment_id": 77931993, "body": "I meant *explicit. I will start using this thanks so much :)"}], "answers": [{"tags": [], "owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "is_accepted": false, "score": 1, "last_activity_date": 1501707502, "creation_date": 1501707502, "answer_id": 45470885, "question_id": 45470884, "link": "https://stackoverflow.com/questions/45470884/excel-vba-output-a-specific-cells-value/45470885#45470885", "title": "Excel VBA output a specific cells value", "body": "<p>Cells are indexed at 1 as the initial value when referencing the entire sheet (as opposed to <code>ActiveCell.Offset</code>, those are indexed at 0)</p>\n\n<p><code>A1= Cells(1,1)</code></p>\n\n<p>so its</p>\n\n<pre><code>Sub TestBox()\nActiveSheet.Activate\nMsgBox (Cells(1, 1).Value)\nEnd Sub\n</code></pre>\n\n<p>to output the current sheet's A1 value</p>\n"}, {"comments": [{"owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 0, "creation_date": 1501708596, "post_id": 45470986, "comment_id": 77903300, "body": "What is so bad with &quot;ActiveSheet.Activate&quot; anyhow?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 1, "creation_date": 1501709031, "post_id": 45470986, "comment_id": 77903544, "body": "<b>1)</b> <code>ActiveSheet.Activate</code> is redundant, since <code>ActiveSheet</code> already refers to the activated sheet. <b>2)</b> At any given point in the code the <code>ActiveSheet</code> may not be what you expect it to be. In this simple code you have in your question it won&#39;t throw an error or mess up your code, but it&#39;s good practice to avoid it unless absolutely needed (it&#39;s rare that it is, but at times it is). @Kagerjay"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "edited": false, "score": 0, "creation_date": 1501709341, "post_id": 45470986, "comment_id": 77903707, "body": "@Kagerjay ^^ and (unless I am completely confused - which is not unusual - and hopefully Scott will correct me if I am wrong) <code>Activate</code> (and <code>Select</code>) is quite slow in processing terms."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501709604, "post_id": 45470986, "comment_id": 77903803, "body": "@YowE3K -- when used over and over yes. When used once or twice when needed, not so much."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1501707953, "creation_date": 1501707953, "answer_id": 45470986, "question_id": 45470884, "link": "https://stackoverflow.com/questions/45470884/excel-vba-output-a-specific-cells-value/45470986#45470986", "title": "Excel VBA output a specific cells value", "body": "<p>A more reliable answer is to use something like this:</p>\n\n<pre><code>Sub TestBox()\n\nDim sVal as String\nsVal = ThisWorkbook.Worksheets(\"Sheet1\").Cells(1,1).Value\n'sVal = ActiveSheet.Cells(1,1).Value \n'above can be used as well, but its not 100% reliable.\n\nMsgbox sVal\n\nEnd Sub\n</code></pre>\n\n<p>Notice how i explicitly declared my objects and I avoided Activate.</p>\n"}], "owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4435, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501707953, "creation_date": 1501707502, "question_id": 45470884, "link": "https://stackoverflow.com/questions/45470884/excel-vba-output-a-specific-cells-value", "title": "Excel VBA output a specific cells value", "body": "<p>I can't seem to get something so simple to work in excel VBA</p>\n\n<p>I have data on cell A1</p>\n\n<pre><code>Sub TestBox()\nActiveSheet.Activate\nMsgBox (Cells(0, 0).Value)\nEnd Sub\n</code></pre>\n\n<p>I want to output said data using basically a msgBox</p>\n\n<blockquote>\n  <p>Run-time error:'1004' Application -defined or object-defined error</p>\n</blockquote>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8407962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56df210018028332607162b31fe5890c?s=128&d=identicon&r=PG&f=1", "display_name": "LittleNorm", "link": "https://stackoverflow.com/users/8407962/littlenorm"}, "edited": false, "score": 0, "creation_date": 1501708538, "post_id": 45470940, "comment_id": 77903269, "body": "thanks GSerg..  I did a &quot;? userform22.textbox19.parent.name&quot; and it gave me &quot;Frame1&quot; which is what I want to know."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 29, "user_id": 8407962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56df210018028332607162b31fe5890c?s=128&d=identicon&r=PG&f=1", "display_name": "LittleNorm", "link": "https://stackoverflow.com/users/8407962/littlenorm"}, "edited": false, "score": 0, "creation_date": 1501708708, "post_id": 45470940, "comment_id": 77903347, "body": "@LittleNorm That is a wrong approach. You should not rely on controls names. If you want to keep it simple and only support frames (and only one nesting level deep), you can check if <code>TypeOf textbox19.parent Is Frame</code>."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 0, "last_activity_date": 1501707720, "creation_date": 1501707720, "answer_id": 45470940, "question_id": 45470829, "link": "https://stackoverflow.com/questions/45470829/difference-between-a-control-in-a-frame-and-a-control-not-in-a-frame/45470940#45470940", "title": "Difference between a control in a frame and a control not in a frame", "body": "<p>It's not necessarily a frame, it can be any control that allows nested controls.</p>\n\n<p>There are several ways to deal with it:</p>\n\n<ul>\n<li>Recursively add all <code>.Parent.Left</code> until the last <code>.Parent</code> is the form.</li>\n<li>Translate to HTML using nested blocks too, so that you don't need to add anything.</li>\n</ul>\n"}], "owner": {"reputation": 29, "user_id": 8407962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56df210018028332607162b31fe5890c?s=128&d=identicon&r=PG&f=1", "display_name": "LittleNorm", "link": "https://stackoverflow.com/users/8407962/littlenorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501707720, "creation_date": 1501707292, "question_id": 45470829, "link": "https://stackoverflow.com/questions/45470829/difference-between-a-control-in-a-frame-and-a-control-not-in-a-frame", "title": "Difference between a control in a frame and a control not in a frame", "body": "<p>I am writing a Excel VBA program that examines VBA forms and converts them to HTML forms.  Most of it works, but I need to know how to tell if a VBA control is within a frame or not.  Because when I use absolute positioning in HTML, if (for example) the left attribute of a control in a frame needs the left attribute of the frame added to it.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3495975, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000278760370/picture?type=large", "display_name": "joell", "link": "https://stackoverflow.com/users/3495975/joell"}, "edited": false, "score": 0, "creation_date": 1501717277, "post_id": 45470658, "comment_id": 77906168, "body": "Awesome! Worked as expected"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 71, "user_id": 3495975, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000278760370/picture?type=large", "display_name": "joell", "link": "https://stackoverflow.com/users/3495975/joell"}, "edited": false, "score": 0, "creation_date": 1501766938, "post_id": 45470658, "comment_id": 77931911, "body": "@joell - great. consider marking as answered so others know moving forward."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1501706588, "creation_date": 1501706588, "answer_id": 45470658, "question_id": 45470542, "link": "https://stackoverflow.com/questions/45470542/vba-pass-string-as-range-type-mismatch-error/45470658#45470658", "title": "VBA pass string as range, type mismatch error", "body": "<p>You cannot set a <code>Range</code> object to a String variable. Hence the <strong>type</strong> mismatch. </p>\n\n<p>Do this:</p>\n\n<p><code>Set rng = Range(\"named_range\") 'since it's a workbook level name anyway</code></p>\n"}], "owner": {"reputation": 71, "user_id": 3495975, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000278760370/picture?type=large", "display_name": "joell", "link": "https://stackoverflow.com/users/3495975/joell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501706588, "creation_date": 1501706181, "last_edit_date": 1531164843, "question_id": 45470542, "link": "https://stackoverflow.com/questions/45470542/vba-pass-string-as-range-type-mismatch-error", "title": "VBA pass string as range, type mismatch error", "body": "<p>I am trying to populate a dynamic named range into a msgBox, but getting error of type mismatch on line <code>Set xRg = xTxt</code>.</p>\n\n<p>Below is the code:</p>\n\n<pre><code>Sub showOfferRange()\nDim xRg As Range\nDim xTxt As String\nDim xCell As Range\nDim xStr As String\nDim xRow As Long\nDim xCol As Long\n\nOn Error Resume Next\n xTxt = ThisWorkbook.Names(\"named_range\")\nSet xRg = xTxt\n\nIf xRg Is Nothing Then Exit Sub\n    On Error Resume Next\n    For xRow = 1 To xRg.Rows.Count\n        For xCol = 1 To xRg.Columns.Count\n            xStr = xStr &amp; xRg.Cells(xRow, xCol).Value &amp; vbTab\n        Next\n    xStr = xStr &amp; vbCrLf\n    Next\n\nMsgBox xStr\n\nEnd Sub\n</code></pre>\n\n<p>Much appreciated.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1501705984, "post_id": 45470382, "comment_id": 77901965, "body": "If you show the code that you are having problems with, we may be able to give you help.  Without the code, I think all we can give will be downvotes."}, {"owner": {"reputation": 1, "user_id": 8407839, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-90J_6627qLI/AAAAAAAAAAI/AAAAAAAAD-o/rAPuXVMAyPw/photo.jpg?sz=128", "display_name": "Steven Nouel", "link": "https://stackoverflow.com/users/8407839/steven-nouel"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501772907, "post_id": 45470382, "comment_id": 77937312, "body": "I tried but it didn&#39;t allow me to because i&#39;m too new to overstack and for your information - I don&#39;t mind the down votes, i need help - not reputation. Thanks for the downvotes."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501788921, "post_id": 45470382, "comment_id": 77947631, "body": "All users, even those with only 1 rep, can post questions.  Code is just text, and can be pasted into questions just as other text can be.  So there is no reason why you can&#39;t post your code.  (Users with only 1 rep can&#39;t post <b>inline images</b> [although they can, AFAIK, post images which show as a link until a higher rep user inlines them] but <b>images</b> of code are not desired.)  And, FYI, I haven&#39;t downvoted you, I was trying to help you avoid downvotes. (I did VTC, but that&#39;s because the question is way to broad to have a useful answer.)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8407839, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-90J_6627qLI/AAAAAAAAAAI/AAAAAAAAD-o/rAPuXVMAyPw/photo.jpg?sz=128", "display_name": "Steven Nouel", "link": "https://stackoverflow.com/users/8407839/steven-nouel"}, "edited": false, "score": 0, "creation_date": 1501768263, "post_id": 45473014, "comment_id": 77933164, "body": "Jsotola thank you for taking the time to help me, this is useful but I was more looking to export the files automatically because when copying to inmediate window it disrupts the formats on how its pasted there."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 1, "user_id": 8407839, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-90J_6627qLI/AAAAAAAAAAI/AAAAAAAAD-o/rAPuXVMAyPw/photo.jpg?sz=128", "display_name": "Steven Nouel", "link": "https://stackoverflow.com/users/8407839/steven-nouel"}, "edited": false, "score": 0, "creation_date": 1501782617, "post_id": 45473014, "comment_id": 77943968, "body": "@StevenNouel, the code that i posted was meant as a starting point. you said that you would like to extract the table data from the emails. so you need to start by finding out the format of the email body, and go from there. if it is HTML, then parse it as a web page. if it is RichText, then use another technique. etc...."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1501720999, "last_edit_date": 1501720999, "creation_date": 1501720624, "answer_id": 45473014, "question_id": 45470382, "link": "https://stackoverflow.com/questions/45470382/how-to-copy-outlook-mail-message-into-excel-using-macros/45473014#45473014", "title": "How to copy Outlook mail message into excel using Macros", "body": "<p>here is some code to get you started, it processes all selected messages, so select just one message of interest</p>\n\n<p>it prints the message body type and body text into the \"immediate window\" </p>\n\n<pre><code>Public Sub exploreEmailMessage()\n\n    Dim currentItem As Object     ' drag \"currentItem\" onto \"Watches\" window, or use: right-click ... Add Watch\n\n    For Each currentItem In Application.ActiveExplorer.Selection    ' check Watches window after this line is executed\n        Stop\n        If currentItem.Class = olMail Then\n\n            Debug.Print \"************************************\"\n            Debug.Print currentItem.ReceivedTime\n            Debug.Print \"************************************\"\n            Debug.Print Array(\"Unspecified\", \"Plain\", \"HTML\", \"RichText\")(currentItem.BodyFormat)\n            Debug.Print \"************************************\"\n            Debug.Print currentItem.Body\n            Debug.Print \"************************************\"\n            Debug.Print currentItem.HTMLBody\n            Debug.Print \"************************************\"   ' copy text in \"immediate window\" and paste into text editor for analysis\n\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 1, "last_activity_date": 1501769308, "last_edit_date": 1501769308, "creation_date": 1501729875, "answer_id": 45474148, "question_id": 45470382, "link": "https://stackoverflow.com/questions/45470382/how-to-copy-outlook-mail-message-into-excel-using-macros/45474148#45474148", "title": "How to copy Outlook mail message into excel using Macros", "body": "<p>I think this should pretty much do what you want.</p>\n\n<pre><code>Sub Extract()\n On Error Resume Next\n Set myOlApp = Outlook.Application\n Set mynamespace = myOlApp.GetNamespace(\"mapi\")\n Set myfolder = myOlApp.ActiveExplorer.CurrentFolder\n\nSet xlobj = CreateObject(\"excel.application.14\")\n xlobj.Visible = True\n xlobj.Workbooks.Add\n xlobj.Worksheets(\"Sheet1\").Name = \"Statusmail\"\n\n'Set the header\n xlobj.Range(\"a\" &amp; 1).Value = \"Absender\"\n xlobj.Range(\"a\" &amp; 1).Font.Bold = \"True\"\n xlobj.Range(\"b\" &amp; 1).Value = \"Date\"\n xlobj.Range(\"b\" &amp; 1).Font.Bold = \"True\"\n xlobj.Range(\"c\" &amp; 1).Value = \"Task\"\n xlobj.Range(\"c\" &amp; 1).Font.Bold = True\n xlobj.Range(\"d\" &amp; 1).Value = \"Planed-date\"\n xlobj.Range(\"d\" &amp; 1).Font.Bold = True\n xlobj.Range(\"e\" &amp; 1).Value = \"deadline\"\n xlobj.Range(\"e\" &amp; 1).Font.Bold = True\n xlobj.Range(\"f\" &amp; 1).Value = \"finished\"\n xlobj.Range(\"f\" &amp; 1).Font.Bold = True\n xlobj.Range(\"g\" &amp; 1).Value = \"time effort\"\n xlobj.Range(\"g\" &amp; 1).Font.Bold = True\n xlobj.Range(\"h\" &amp; 1).Value = \"description\"\n xlobj.Range(\"h\" &amp; 1).Font.Bold = True\n\nFor i = 1 To myfolder.Items.Count\n  Set myitem = myfolder.Items(i)\n  msgtext = myitem.Body\n\n  xlobj.Range(\"a\" &amp; i + 1).Value = myitem.To\n  xlobj.Range(\"b\" &amp; i + 1).Value = myitem.ReceivedTime\n  xlobj.Range(\"c\" &amp; i + 1).Value = msgtext\n\n\n Next\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8407839, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-90J_6627qLI/AAAAAAAAAAI/AAAAAAAAD-o/rAPuXVMAyPw/photo.jpg?sz=128", "display_name": "Steven Nouel", "link": "https://stackoverflow.com/users/8407839/steven-nouel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 45474148, "answer_count": 2, "score": -5, "last_activity_date": 1501769308, "creation_date": 1501705589, "last_edit_date": 1501706260, "question_id": 45470382, "link": "https://stackoverflow.com/questions/45470382/how-to-copy-outlook-mail-message-into-excel-using-macros", "title": "How to copy Outlook mail message into excel using Macros", "body": "<p>I've searched all google and I've tried some suggestions from stack overflow to achieve results but they seem to not work towards my specific goal. Wondering if anyone here can help me.</p>\n\n<p>I work in a call center where I receive emails with agents productivity data on an hourly basis and it's beginning to be a lot of manual work. How can I get a macro to copy the email body and paste it to an excel sheet automatically? or I can run it daily.</p>\n\n<p>This is an example of how the data looks</p>\n\n<p>Hourly Productivity</p>\n\n<p><a href=\"https://i.stack.imgur.com/FW4Nr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FW4Nr.png\" alt=\"enter image description here\"></a></p>\n\n<p>The specific data I need to copy:</p>\n\n<pre><code>Agent Login | Agent Name | Average Talk Time | Total Talk Time | Calls Answered | Total ACW\n</code></pre>\n\n<p>I would also love to be able to include the date and hours of the productivity if possible? on the picture you will be able to see the time for it. (8:00 AM - 9:00 AM)</p>\n\n<p>I would really appreciate any help in this.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 6, "creation_date": 1501704916, "post_id": 45470125, "comment_id": 77901362, "body": "Store the macros in your Personal Macro Workbook and use ActiveWorkbook/ActiveSheet in your code."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1501714685, "post_id": 45470125, "comment_id": 77905548, "body": "Perhaps overkill, but you can also look into making an add-in out of your macros: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg597509(v=office.14).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 8407817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d145f1b0de67c56cb528929c0bbb0932?s=128&d=identicon&r=PG&f=1", "display_name": "D Buckley", "link": "https://stackoverflow.com/users/8407817/d-buckley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1501727667, "answer_count": 0, "score": 0, "last_activity_date": 1501704796, "creation_date": 1501704796, "last_edit_date": 1531164843, "question_id": 45470125, "link": "https://stackoverflow.com/questions/45470125/creating-a-macro-that-can-run-on-any-excel-sheet-that-i-open", "closed_reason": "Duplicate", "title": "Creating a Macro That Can Run on Any Excel Sheet That I Open", "body": "<p>I have to export data from software to excel frequently to generate reports. I'd like to write a few macros to make this process more efficient. How can I make these macros available to run on any spreadsheet that's open?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501704098, "post_id": 45469872, "comment_id": 77900947, "body": "It&#39;s not going to loop because j &quot;loops&quot; from 2 to 2. What do you mean by &quot;nothing happens&quot;?"}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501704186, "post_id": 45469872, "comment_id": 77900990, "body": "it doesn&#39;t perform the calculation"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1501704297, "post_id": 45469872, "comment_id": 77901047, "body": "And what steps have you taken yourself to find out what is going on?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1501704349, "post_id": 45469872, "comment_id": 77901076, "body": "<code>Counter</code> is unnecessary. You&#39;re initializing it to <code>2</code>, the same as the start value of your <code>j</code> loop, then incrementing it by 1 each time through your loop, just like what it happening to <code>j</code> automatically. Use <code>j</code> instead of <code>counter</code>. Won&#39;t fix the problem, but will make your code a little easier to read."}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501704416, "post_id": 45469872, "comment_id": 77901108, "body": "i look at column &quot;AF&quot; to see if the values are assigned based on the calculation. But nothing is there, the calculation doesn&#39;t happen."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 1, "creation_date": 1501704604, "post_id": 45469872, "comment_id": 77901205, "body": "You should debug the code line by line to see if the code in the loop is executing.  Instead of just looking at the &quot;AF&quot; column to see if there is output.  That will let you know where the problem is located."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1501704620, "post_id": 45469872, "comment_id": 77901215, "body": "It&#39;s bad practise to alter the loop variable in a <code>For ...To</code> loop - that is already automatic: you don&#39;t need that <code>j=j+1</code>"}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501704699, "post_id": 45469872, "comment_id": 77901255, "body": "I am new to VBA coding and i cant tell what I am doing wrong."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501705157, "post_id": 45469872, "comment_id": 77901495, "body": "I can&#39;t see anything in that code that would disable the calculation. Perhaps you mean the result is not what you expect?"}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501705295, "post_id": 45469872, "comment_id": 77901573, "body": "the result does not show. its blank"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1501705364, "post_id": 45469872, "comment_id": 77901606, "body": "Is there any code after this block?"}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501705468, "post_id": 45469872, "comment_id": 77901656, "body": "the code is in between Sub CalculateIncome() and End Sub"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501705739, "post_id": 45469872, "comment_id": 77901817, "body": "<code>i look at column &quot;AF&quot; to see if the values are assigned based on the calculation. But nothing is there, the calculation doesn&#39;t happen.</code> The code is only changing cell AF2 - are you 100% sure that cell is blank both before and after the calculation?  And do cells V2, Y2 and AB2 all contain numeric values?"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1501705771, "post_id": 45469872, "comment_id": 77901842, "body": "It looks like you may have forgotten to put the subs in the question."}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501705889, "post_id": 45469872, "comment_id": 77901909, "body": "Yes, they all contain numeric values. The calculation works when i use the excel function V2+Y2+AB2"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501706425, "post_id": 45469872, "comment_id": 77902208, "body": "Include a <code>MsgBox &quot;In loop&quot;</code> as the line after <code>For j = 2 To i</code>.  Then set cell <code>owssvr!AF2</code> to some random value (i.e. just bash your fingers on the keyboard).  The run the macro. Does the <code>MsgBox</code> get displayed?  Does cell <code>owssvr!AF2</code> change back to being blank, or does it remain as it was?"}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501706713, "post_id": 45469872, "comment_id": 77902363, "body": "I get a message box with the words &quot;In Loop&quot;, but owssvr!AF2 is still blank"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501706763, "post_id": 45469872, "comment_id": 77902391, "body": "<code>is still blank</code> - do you mean that it changed from being the random info you put into it back to being blank?   You don&#39;t have any <code>Worksheet_Change</code> event on this sheet do you?"}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501706972, "post_id": 45469872, "comment_id": 77902495, "body": "oh no, it had the random info i put in."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501707065, "post_id": 45469872, "comment_id": 77902551, "body": "OK, change the <code>MsgBox &quot;In loop&quot;</code> to be <code>MsgBox &quot;|&quot; &amp; Worksheets(&quot;owssvr&quot;).Range(&quot;af&quot; &amp; j).value &amp; &quot;|&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501711205, "post_id": 45471534, "comment_id": 77904429, "body": "Much as I prefer your version of the code, it doesn&#39;t really explain why the OP&#39;s code is not updating cell AF2, so I suspect that whatever is causing their code to not update that cell will also cause your code to not update it.  (But, who knows, maybe if they just use your code their problem will go away - I am always suspicious of code which doesn&#39;t look as if it has been copied from the VBE, such as the OP&#39;s <code>.value</code> [with a lower-case <code>v</code>] and <code>j= j+ 1</code> [with missing spaces].)"}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501711358, "post_id": 45471534, "comment_id": 77904485, "body": "@YowE3K, OP&#39;s could should update only line 2, because the for...loop is set to loop from 2 to i... which is 2. It will be a single loop. I suspect when OP says &quot;nothing happens&quot;, it&#39;s because he doesn&#39;t get the intended full iteration."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501711445, "post_id": 45471534, "comment_id": 77904511, "body": "No, if you read the comments, even cell AF2 isn&#39;t updating - even though it is getting into the loop.  So I am really confused as to what is causing the issue.  (P.S.  My concern about the lower-case <code>v</code> in <code>value</code> seems to be unfounded - that was changed by someone editing the question.)"}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501711727, "post_id": 45471534, "comment_id": 77904607, "body": "@YowE3K, you are right. Sorry. But then he says that the test you suggested worked - &quot;oh no, it had the random info i put in&quot; - which makes me, erm, regain my suspicion. Anyway, if that code doesn&#39;t throw an exception, then there&#39;s nothing preventing it to work. But then, again, it ocurred to me now that if V2, Y2 and AB2 are empty/blank strings, the result would be exactly that described by OP. I can speculate no further without having the very workbook in hands."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501712057, "post_id": 45471534, "comment_id": 77904711, "body": "The fact that the random info was still in the cell means that the OP&#39;s <code>Worksheets(&quot;owssvr&quot;).Range(&quot;af&quot; &amp; j).value = ...</code> didn&#39;t work, despite the <code>MsgBox</code> being displayed.  And I thought about the <code>&quot;&quot; + &quot;&quot; + &quot;&quot;</code> scenario, but the OP confirmed that the values were numbers.  I am stumped (but guessing that there is either a <code>Change</code> event setting the value back to the previous value, or that the OP is looking at the wrong sheet).  Unfortunately, it appears the OP has gone away for awhile, so I may have to wait for some time to satisfy my curiosity as to what <b>is</b> the problem. :("}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501712253, "post_id": 45471534, "comment_id": 77904782, "body": "@YowE3K, yes, you are right, and I misread those comments again. Shame on me... Let&#39;s wait then."}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501716496, "post_id": 45471534, "comment_id": 77905993, "body": "Ok. so I tried the code with a sample data similar to the actual worksheet. The code works and calculate the three columns(A,B,C) that I tested with and the value is in the column D. However, the calculation doesn&#39;t paste the values starting from D2. it starts from D22 and then skips more rows and continues on D210. and on the rows in Columns A,B,C that has no values inside, the total is calculated as 0. I uploaded a snapshot of how it looked after running the code."}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501717703, "post_id": 45471534, "comment_id": 77906252, "body": "I will go the easy way route and use &quot;=v2+y2+AB2&quot; in cell AF2. and use VBA code to auto fill the formula down to the last row."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 1, "creation_date": 1501719025, "post_id": 45471534, "comment_id": 77906583, "body": "@Richmond In your test code, did it happen to update cells D22, D23 ... D29, before jumping to D210?  That could be explained by using <code>&quot;D2&quot; &amp; j</code> instead of <code>&quot;D&quot; &amp; j</code>."}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501720357, "post_id": 45471534, "comment_id": 77906893, "body": "Yes, it did update D22, D23 ... D31 and jumped to D210"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 1, "creation_date": 1501723091, "post_id": 45471534, "comment_id": 77907448, "body": "@Richmond If it updated D31 then my thought of <code>&quot;D2&quot; &amp; j</code> won&#39;t be the reason for the jump."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 1, "creation_date": 1501729455, "post_id": 45471534, "comment_id": 77908817, "body": "@Richmond I was just reviewing some suggested edits and came across one where you were trying to edit VBobCat&#39;s answer by including a screenshot (that should be in your question, not in this answer).  I notice in the screenshot that D31 was <b>not</b> updated - that it was only updating cells D22, D23 ... D29, before jumping to D210 - so I will go back to believing that you used <code>&quot;D2&quot; &amp; j</code> instead of <code>&quot;D&quot; &amp; j</code>."}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 1, "creation_date": 1501761006, "post_id": 45471534, "comment_id": 77927055, "body": "@Richmond, could you share your workbook with us? You could strip out all the sensitive information. I think it will be of great help in this case."}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501769067, "post_id": 45471534, "comment_id": 77933920, "body": "@VBobCat and YowE3K I really appreciate the help you guys put into this. I was able to make it work with the comment suggestions and the codes suggested. I have one more task to do which i don&#39;t know how to approach it. I have a list of names in Column A, and on the same sheet i have a button that generate a PDF report for each name i select in column A. I want to automate the process of selecting names one by one from column A and clicking on the button to generate the PDF. So i am looking for a VBA code that will loop through the names in column A and perform the Click button."}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 2, "creation_date": 1501771146, "post_id": 45471534, "comment_id": 77935828, "body": "@Richmond, as for your PDF automation, the algorithm would be much like this, but instead of setting a cell&#39;s value, you&#39;d perform the operations involved with pdf generation, like <a href=\"https://support.microsoft.com/en-us/help/291308/how-to-select-cells-ranges-by-using-visual-basic-procedures-in-excel\" rel=\"nofollow noreferrer\">selecting the desired cell</a> and programatically calling the same sub that handles your button&#39;s click event. Should you have difficulties, however, you ought to post a new question with all details and code involved."}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1501774150, "post_id": 45471534, "comment_id": 77938249, "body": "Consider also accepting my answer and upvoting the comments made by @YowE3K"}], "tags": [], "owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "is_accepted": true, "score": 1, "last_activity_date": 1501710409, "creation_date": 1501710409, "answer_id": 45471534, "question_id": 45469872, "link": "https://stackoverflow.com/questions/45469872/i-am-trying-to-performcalculation-with-multiple-columns-and-assigning-the-value/45471534#45471534", "title": "I am trying to performcalculation with multiple columns and assigning the value to a column", "body": "<p>You'd need to do this:</p>\n\n<pre><code>Sub calculateIncome()\n    Dim startLine As Integer\n    Dim endLine As Integer\n    Dim currentLine As Integer\n    Dim ws As Worksheet\n    startLine = 2 ' you must preset\n    endLine = 126 ' you must preset\n    Set ws = Worksheets(\"owssvr\")\n    For currentLine = startLine To endLine\n        ws.Range(\"af\" &amp; currentLine).Value = _\n            ws.Range(\"v\" &amp; currentLine).Value + _\n            ws.Range(\"y\" &amp; currentLine).Value + _\n            ws.Range(\"ab\" &amp; currentLine).Value\n    Next\nEnd Sub\n</code></pre>\n\n<p>But, erm, why not type <code>=V2+Y2+AB2</code> in cell <code>AF2</code> and then copy the formula all the way down your list?</p>\n"}], "owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 45471534, "answer_count": 1, "score": 0, "last_activity_date": 1501717080, "creation_date": 1501703793, "last_edit_date": 1531164843, "question_id": 45469872, "link": "https://stackoverflow.com/questions/45469872/i-am-trying-to-performcalculation-with-multiple-columns-and-assigning-the-value", "title": "I am trying to performcalculation with multiple columns and assigning the value to a column", "body": "<p>I am trying to assign a column a value based on calculation from other columns. I want it to loop through all the rows and perform the same calculation. but nothing happens.</p>\n\n<pre><code>Sub calculateIncome()\n  Dim i As Integer\n  i = 2\n\n  Dim counter As Integer\n  counter = 2\n\n  Dim j As Integer\n  For j = 2 To i\n    Worksheets(\"owssvr\").Range(\"af\" &amp; j).Value = _\n      Worksheets(\"owssvr\").Range(\"v\" &amp; j).Value + Worksheets(\"owssvr\").Range(\"y\" &amp; _\n      j).Value + Worksheets(\"owssvr\").Range(\"ab\" &amp; j).Value\n    j= j + 1\n  Next j\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501702952, "post_id": 45469598, "comment_id": 77900235, "body": "This syntax is wrong <code>str = ThisWorkbook.Sheets(9).Range(&quot;A1:Cells(i, 1)&quot;)</code>. What should it be doing?"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501703776, "post_id": 45469598, "comment_id": 77900741, "body": "I was hoping it would take the items from code above and put it in the cell because the item comes from a listbox"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501703859, "post_id": 45469598, "comment_id": 77900784, "body": "Should I just do <code>.Cells(i,1)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501703955, "post_id": 45469598, "comment_id": 77900857, "body": "Yes it looks as if this will do it <code>str = ThisWorkbook.Sheets(9).Cells(i, 1)</code> but this assigns the contents of a cell to a variable, it doesn&#39;t put anything into a cell."}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501704195, "post_id": 45469598, "comment_id": 77900995, "body": "Is there a way to put it in?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1501704245, "post_id": 45469598, "comment_id": 77901021, "body": "You just need to swap the two sides of that line so that <code>str</code> is on the right hand side."}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501704691, "post_id": 45469598, "comment_id": 77901250, "body": "It works, but it doesn&#39;t put it individually, but that might the be the bigger code"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501705186, "post_id": 45469598, "comment_id": 77901517, "body": "What do you mean by &quot;put it individually&quot;?"}, {"owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501705712, "post_id": 45469598, "comment_id": 77901797, "body": "All the items are in one cell. Also the <code>quantity</code> write over eache other and leaves the last one"}], "owner": {"reputation": 53, "user_id": 8248671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/643b043dd1939e36dd75cf4d208c4d0a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxAttack102", "link": "https://stackoverflow.com/users/8248671/maxattack102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501707341, "creation_date": 1501702795, "question_id": 45469598, "link": "https://stackoverflow.com/questions/45469598/sending-selected-items-to-a-cell", "title": "Sending Selected Items to a Cell", "body": "<p>I am trying to get the items that I have and initiate all the separate items into its own respective cell. </p>\n\n<pre><code>With Me.selecteditems\n    For i = 1 To .ListCount - 1\n        If .Selected(i) Then\n            found = True\n            On Error Resume Next\n            str = ThisWorkbook.Sheets(9).Range(\"A1:Cells(i, 1)\")\n            quantity = ThisWorkbook.Sheets(9).Range(\"A1:Cells(i, 2)\")\n            On Error GoTo 0\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p>This part of the below code, is supposed to put the items that come from the longer part of the code and put in the item, <code>str</code>, and the amount, <code>quantity</code>. I tried different ways and just recently I tried repeating how it was before, it doesn't come out that well. Also without the error it throws me:</p>\n\n<blockquote>\n  <p>Application-defined or Object-defined Error</p>\n</blockquote>\n\n<p>The Whole Code:</p>\n\n<pre><code>Dim i As Long, j As Long, ii As Long\nDim found As Boolean\nDim str As String\nDim message, title, defaultval As String\nDim quantity As String\n\n\nWith Me.selecteditems\n    For i = 0 To .ListCount - 1\n        If .Selected(i) Then\n            found = True\n            For ii = 0 To .ColumnCount - 1\n                If str = \"\" Then\n                    str = .List(i, ii) &amp; vbTab\n                Else\n                    If ii &lt; .ColumnCount - 1 Then\n                        str = str &amp; .List(i, ii) &amp; vbTab\n                    Else\n                        str = str &amp; .List(i, ii)\n                    End If\n                End If\n            Next ii\n            message = \"How much\" &amp; vbCrLf &amp; str &amp; \"?\"\n            title = \"Amount\"\n            defaultval = \"1\"\n            quantity = InputBox(message, title, defaultval)\n            str = str &amp; \"  x  \" &amp; quantity &amp; vbNewLine\n        End If\n    Next i\nEnd With\n\nWith Me.selecteditems\n    For i = 1 To .ListCount - 1\n        If .Selected(i) Then\n            found = True\n            On Error Resume Next\n            str = ThisWorkbook.Sheets(9).Range(\"A1:Cells(i, 1)\")\n            quantity = ThisWorkbook.Sheets(9).Range(\"A1:Cells(i, 2)\")\n            On Error GoTo 0\n        End If\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1501704918, "post_id": 45469588, "comment_id": 77901363, "body": "@pnuts LOL - I love the &quot;If someone has directed you here to read this warning, go back and delete your question.&quot; portion of the [seo] tag description."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1501704992, "post_id": 45469588, "comment_id": 77901409, "body": "This tag is a dumpster fire."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1501779439, "post_id": 45474169, "comment_id": 77941991, "body": "You are awesome, this works like a dream. Thank you for your help :D"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1501781105, "post_id": 45474169, "comment_id": 77943005, "body": "If you define your question well, it&#39;s easy to define an answer well."}, {"owner": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1501791287, "post_id": 45474169, "comment_id": 77949093, "body": "After playing around with it, I tried running a large list of 200 or so keyword searches through the module and I ran into a strange error that happens after running through 50 to 70 (it varies) keywords. The Debug highlights &quot;Cells(i, 2).Value = var1.innerText&quot; as the error and a dialog box that says &quot;Run time error &#39;91&#39;: Object variable or With block variable not set&quot;. It seems strange that it would run just fine until a certain amount of queries. I understand that Google stops queries if an IP is spamming in short time, but I have no way of finding out if that is the problem. Any ideas?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1501792290, "post_id": 45474169, "comment_id": 77949643, "body": "I just tried 150 randome word searches and I couldn&#39;t even get one to work.  I&#39;m in the office now.  I&#39;m guessing the firm&#39;s firewallblocs all these things  Normally it&#39;s not a good idea to use &#39;On Error Resume Next&#39; but in this case it&#39;s probably ok.  Put that line near the top of your script and re-run the porcess.  Maybe Google can&#39;t find what you&#39;re looking for, and it returns nothing, which causes the error.  That&#39;s just a guess.  I can&#39;t tell for sure."}, {"owner": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1501799189, "post_id": 45474169, "comment_id": 77952500, "body": "&quot;On Error Resume Next&quot; didn&#39;t do much of anything besides stop the error box from popping up. After the first error it wouldn&#39;t even run the module again without an error. I left my prior network IP and tried it again on a separate network IP and it allowed about 45 queries before the error occurred again. This leads me to believe that Google is sensing a security issue and blocking the IP after so many queries. Again no way to test it for sure but that&#39;s my guess. Let me know if you run into a similar issue on a network other than the one you tried it on without luck. Thanks again."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1501808190, "post_id": 45474169, "comment_id": 77954670, "body": "Ok, I am home now, and out of curiosity I just tested it to see what&#39;s going on.  I ran through 400 items in 4 minutes, with no issues whatsoever.  Then, I tested 1,200 items, just for fun.  It ran to completion in 23 minutes.  I don&#39;t know what&#39;s going on over on your end.  I&#39;m not a professional developer, by any means.  I just dabble in this stuff when I&#39;m not working, or playing chess."}, {"owner": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1501866433, "post_id": 45474169, "comment_id": 77985400, "body": "Thanks for trying it out! It&#39;s curious that it works so well on yours, but also good news. Makes me wonder, do you know if you have multiple proxies set up? Just been doing some research to see what issues might be. I&#39;m no developer either. I just need something like this for work day to day and having it Excel is great for workflow."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1501892006, "post_id": 45474169, "comment_id": 77995290, "body": "I added an image of my Mozilla proxy settings to my OP.  Does that help you?  I&#39;m getting about to the limit of my knowledge in this specific area."}, {"owner": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1502125698, "post_id": 45474169, "comment_id": 78064194, "body": "Ah gotcha. I am not sure what that would do but thank you. Sorry to go off track so much. To bring it back to VBA, would there be a way to make it so that each query is run on a timed interval? For example, the the script runs the query on the first word in the list and spits out a result but then waits a specified amount of seconds before running the next keyword in the list. The reason for this is that overloading servers with quick, back-to-back queries is suspicious and Google likes to block these types of scrapers. Do you know if its possible to do this?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "edited": false, "score": 0, "creation_date": 1502129579, "post_id": 45474169, "comment_id": 78066296, "body": "I was going to recommend that a couple days ago, but I got sidetracked with something, and then I forgot.  You could try this, to wait 5 seconds between loops:   Application.Wait (Now + TimeValue(&quot;0:00:05&quot;)) I&#39;m not sure if that would solve the problem, but you can try and see.  Obviously that will add 5  seconds to your completion time, times the number of loops you run.  If the objective is to get it to finish, and if speed isn&#39;t a concern, try that.  Fire it off, then go get some food, or whatever, and see if it&#39;s done when you get back to your machine."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 0, "last_activity_date": 1501892034, "last_edit_date": 1501892034, "creation_date": 1501730050, "answer_id": 45474169, "question_id": 45469588, "link": "https://stackoverflow.com/questions/45469588/automated-google-query-with-excel-vba-can-anyone-get-this-to-work/45474169#45474169", "title": "Automated Google query with excel vba: Can anyone get this to work?", "body": "<p>Put the following in A2:A4</p>\n\n<pre><code>girafe\nrhino\nstarbucks\n</code></pre>\n\n<p>Run the script below.</p>\n\n<pre><code>Sub Gethits()\n    Dim url As String, lastRow As Long\n    Dim XMLHTTP As Object, html As Object, objResultDiv As Object, objH3 As Object, link As Object\n    Dim start_time As Date\n    Dim end_time As Date\n    Dim var As String\n    Dim var1 As Object\n\n    lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Dim cookie As String\n    Dim result_cookie As String\n\n    start_time = Time\n    Debug.Print \"start_time:\" &amp; start_time\n\n    For i = 2 To lastRow\n\n        url = \"https://www.google.com/search?q=\" &amp; Cells(i, 1) &amp; \"&amp;rnd=\" &amp; WorksheetFunction.RandBetween(1, 10000)\n\n        Set XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n        XMLHTTP.Open \"GET\", url, False\n        XMLHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\n        XMLHTTP.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/25.0\"\n        XMLHTTP.send\n\n        Set html = CreateObject(\"htmlfile\")\n        html.body.innerHTML = XMLHTTP.ResponseText\n        Set objResultDiv = html.getelementbyid(\"rso\")\n        Set var1 = html.getelementbyid(\"resultStats\")\n        Cells(i, 2).Value = var1.innerText\n\n        DoEvents\n    Next\n\n    end_time = Time\n    Debug.Print \"end_time:\" &amp; end_time\n\n    Debug.Print \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\n    MsgBox \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\nEnd Sub\n</code></pre>\n\n<p>Mozilla:\n<a href=\"https://i.stack.imgur.com/kVq2A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kVq2A.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 8407646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed102ecb8a1c15bda44ce4b7967e12a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Conner", "link": "https://stackoverflow.com/users/8407646/matthew-conner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 45474169, "answer_count": 1, "score": -1, "last_activity_date": 1501892034, "creation_date": 1501702762, "last_edit_date": 1531164843, "question_id": 45469588, "link": "https://stackoverflow.com/questions/45469588/automated-google-query-with-excel-vba-can-anyone-get-this-to-work", "title": "Automated Google query with excel vba: Can anyone get this to work?", "body": "<p>new to the community and looking for a way to perform google searches automated with excel vba and  then parse for the \"About 49,600 results (0.78 seconds)\" information just below the header. I recently found this tutorial that seems to (or claims to) accomplish just that. --> <a href=\"http://yodalearning.com/tutorials/perform-google-search-internet-explorer-using-excel-vba-excel-vba/\" rel=\"nofollow noreferrer\">http://yodalearning.com/tutorials/perform-google-search-internet-explorer-using-excel-vba-excel-vba/</a></p>\n\n<p>Can anyone get this to work?</p>\n\n<p>when I try to run the module it open Google but then does nothing with the load circle going for an eternity. If anyone has ideas on how to get this to work any help would be greatly appreciated!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501704780, "post_id": 45469585, "comment_id": 77901296, "body": "So what&#39;s the problem?"}, {"owner": {"reputation": 81, "user_id": 8285660, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/1836150466401525/picture?type=large", "display_name": "Philip", "link": "https://stackoverflow.com/users/8285660/philip"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501707608, "post_id": 45469585, "comment_id": 77902819, "body": "I want the arrow formated bullet points but the code only gives me the circular default"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501708875, "post_id": 45469585, "comment_id": 77903458, "body": "If you don&#39;t want the default bullet format then I think you need to use: <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.listformat.applylisttemplate(v=office.14).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}], "owner": {"reputation": 81, "user_id": 8285660, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/1836150466401525/picture?type=large", "display_name": "Philip", "link": "https://stackoverflow.com/users/8285660/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501702992, "creation_date": 1501702750, "last_edit_date": 1501702992, "question_id": 45469585, "link": "https://stackoverflow.com/questions/45469585/vba-to-word-arrow-bullet", "title": "VBA to word arrow bullet", "body": "<p>I'm trying to format the bullets to get the arrow formatted bullet point. I'm just using this short piece to format. </p>\n\n<pre><code>.range.ListFormat.ApplyBulletDefault\n</code></pre>\n\n<p>This is what is desired. \n<a href=\"https://i.stack.imgur.com/TMAj6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TMAj6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1501706422, "post_id": 45469555, "comment_id": 77902205, "body": "Does it have to start at a random time? You can make this way more efficient if you start at the first timeslot every day (05:00 AM), and then just append tasks behind the first task of that day. If you want, you can also insert gaps between tasks"}, {"owner": {"reputation": 95, "user_id": 5407920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068860bfc8445065b5f46ffdcbcabf3a?s=128&d=identicon&r=PG&f=1", "display_name": "beechfuzz", "link": "https://stackoverflow.com/users/5407920/beechfuzz"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1501769090, "post_id": 45469555, "comment_id": 77933946, "body": "Yep, unfortunately it has to be a random time -- that&#39;s the nature of our work.  Unfortunately, I also can&#39;t go into specifics of <i>why</i> they have to be random times."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5407920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068860bfc8445065b5f46ffdcbcabf3a?s=128&d=identicon&r=PG&f=1", "display_name": "beechfuzz", "link": "https://stackoverflow.com/users/5407920/beechfuzz"}, "edited": false, "score": 0, "creation_date": 1501777163, "post_id": 45489464, "comment_id": 77940438, "body": "Thank you!  I will give this a look through when I have time and reply back with any feedback and questions.  Thank you again for your time and effort -- it is really appreciated!"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 95, "user_id": 5407920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068860bfc8445065b5f46ffdcbcabf3a?s=128&d=identicon&r=PG&f=1", "display_name": "beechfuzz", "link": "https://stackoverflow.com/users/5407920/beechfuzz"}, "edited": false, "score": 0, "creation_date": 1501778747, "post_id": 45489464, "comment_id": 77941531, "body": "Oh, and note that you could make it more efficient by just skipping the filtering altogether, and just assuming the sort put everything in the right order, doing a <code>.FindFirst</code> to start at the first record for the start date, and going from there."}, {"owner": {"reputation": 95, "user_id": 5407920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068860bfc8445065b5f46ffdcbcabf3a?s=128&d=identicon&r=PG&f=1", "display_name": "beechfuzz", "link": "https://stackoverflow.com/users/5407920/beechfuzz"}, "edited": false, "score": 0, "creation_date": 1501865929, "post_id": 45489464, "comment_id": 77985119, "body": "I think I might not have been clear enough, my apologies.  When I said, &quot;no more than 2 tasks can overlap at any given point on any day&quot; what I meant was there can&#39;t be any point in any day where more than 2 scheduled tasks overlap each other.      Take for example my original post, if Task1 was randomly scheduled on 1 Jan for 06:32-08:32 and then later we created a Task2 that was randomly scheduled on 1 Jan for 07:45-09:45.  Those two taskings will overlap each other between 07:45-08:32.  Later, I need to schedule Task3 which will also have to run on 1 Jan; 07:45-08:32 will be unavailable."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 95, "user_id": 5407920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068860bfc8445065b5f46ffdcbcabf3a?s=128&d=identicon&r=PG&f=1", "display_name": "beechfuzz", "link": "https://stackoverflow.com/users/5407920/beechfuzz"}, "edited": false, "score": 0, "creation_date": 1501930619, "post_id": 45489464, "comment_id": 78002574, "body": "Ah, didn&#39;t get that. Is the length of all tasks 2 hours, or is it variable?"}, {"owner": {"reputation": 95, "user_id": 5407920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068860bfc8445065b5f46ffdcbcabf3a?s=128&d=identicon&r=PG&f=1", "display_name": "beechfuzz", "link": "https://stackoverflow.com/users/5407920/beechfuzz"}, "edited": false, "score": 0, "creation_date": 1502024371, "post_id": 45489464, "comment_id": 78024471, "body": "All tasks are always two hours."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 95, "user_id": 5407920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068860bfc8445065b5f46ffdcbcabf3a?s=128&d=identicon&r=PG&f=1", "display_name": "beechfuzz", "link": "https://stackoverflow.com/users/5407920/beechfuzz"}, "edited": false, "score": 0, "creation_date": 1502028155, "post_id": 45489464, "comment_id": 78025503, "body": "Edited it to allow 2 tasks to overlap, but not 3 at the same time."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1502028096, "last_edit_date": 1502028096, "creation_date": 1501776504, "answer_id": 45489464, "question_id": 45469555, "link": "https://stackoverflow.com/questions/45469555/quickest-most-efficient-way-to-get-available-times-for-scheduler-database/45489464#45489464", "title": "Quickest/Most efficient way to get available times for Scheduler Database", "body": "<p>Had some time to spare, so I coded my approach to the problem.\nSince you're not giving me much to work with as to specifics, you will have to fill in a lot of blanks, such as variable names and WHERE criteria.</p>\n\n<p>First, 2 helper functions for picking random numbers and dates:</p>\n\n<pre><code>Public Function RandomRange(Lower As Double, Upper As Double, Optional IncludeDecimals As Boolean = True) As Double\n    'Returns a random number between Lower and Upper, either with or without decimals\n    RandomRange = Lower + (Rnd() * (Upper - Lower + IIf(IncludeDecimals, 0, 1)))\n    If IncludeDecimals = True Then Exit Function\n    RandomRange = Int(RandomRange)\nEnd Function\n\nPublic Function RandomTime(Lower As Date, Upper As Date) As Date\n    'Returns a random time between Lower and Upper\n    Dim randomTimeDbl As Double\n    randomTimeDbl = CDbl(Lower) + (Rnd() * CDbl(Upper - Lower))\n    RandomTime = CDate(randomTimeDbl)\nEnd Function\n</code></pre>\n\n<p>Then, the actual logic to schedule tasks for an interval of days:</p>\n\n<pre><code>Public Function ScheduleTasksBetweenDays(StartDate As Date, EndDate As Date, TaskIdentifier As Variant)\n    'Open the scheduled tasks table\n    Dim rsSchdTasks As Recordset\n    Set rsSchdTasks = CurrentDb.OpenRecordset(\"SELECT * FROM tblSchdTasks SORT BY Date ASC, Start_Time ASC\")\n\n    'Second recordset for tasks only on a specific date\n    Dim rsFiltered As Recordset\n\n    'Create a collection to save valid start and end dates\n    Dim startEndDates As Collection\n    'And create a collection for overlapping times\n    Dim overlappingTimes As Collection\n\n    'Create two arrays to save start-end date pairs\n    Dim startEndDatePair(2) As Date\n    Dim previousTaskStartEndTime(2) As Date\n    'Create an int to hold random values\n    Dim randomInt As Integer\n\n    'Make an iterator for a while loop, and one for the for loop\n    Dim dateIterator As Date\n    Dim i As Integer\n    dateIterator = StartDate\n    'Iterate through all the dates\n    While dateIterator &lt; EndDate\n\n        'Set rsFiltered to all records of that date\n        rsSchdTasks.Filter = \"Date = #\" &amp; Format(dateIterator, \"yyyy\\/mm\\/dd\") &amp; \"#\"\n        'Open the filtered recordset\n        Set rsFiltered = rsSchdTasks.OpenRecordset()\n\n        'Use the already instantiated recordset instead of a DCount, if the task is already set, next iteration\n        rsFiltered.FindFirst \"TaskIdentifier = \" &amp; TaskIdentifier\n        If Not rsFiltered.NoMatch Then GoTo NextDate\n        'Start at the first already set taks, iterate through them\n        rsFiltered.MoveFirst\n        'Clean up the overlappingTimes collection\n        Set overlappingTimes = New Collection\n        'Initialize the first task as the previous one\n        If Not rsFiltered.EOF Then\n            previousTaskStartEndTime(1) = rsFiltered.Fields(\"Start_Time\")\n            previousTaskStartEndTime(2) = rsFiltered.Fields(\"End_Time\")\n            rsFiltered.MoveNext\n        End If\n        Do While Not rsFiltered.EOF\n            'If the start time of the next task is less than the end time\n            If previousTaskStartEndTime(2) &gt; rsFiltered.Fields(\"Start_Time\") Then\n                'The overlapping segment is from end of previous to start of new\n                startEndDatePair(1) = rsFiltered.Fields(\"Start_Time\")\n                startEndDatePair(2) = previousTaskStartEndTime(2)\n                'Add those that interval to the collection of invalid intervals\n                overlappingTimes.Add startEndDatePair\n            End If\n            previousTaskStartEndTime(1) = rsFiltered.Fields(\"Start_Time\")\n            previousTaskStartEndTime(2) = rsFiltered.Fields(\"End_Time\")\n            rsFiltered.MoveNext\n        Loop\n        'Now, we have a collection of all times that can't overlap with the task\n\n        'Lets set the next collection of possible start times\n\n        'First possible start time is 5 AM\n        startEndDatePair(1) = #5:00:00 AM#\n        'Open up a blank collection of possible valid intervals\n        Set startEndDates = New Collection\n\n        'Next step seems familliar, loop through the invalid times to calculate the valid ones\n        For i = 1 To overlappingTimes.Count\n            'If the start of the next task is more than 2 hours away than the possible start time, we can plan it before this task\n            If startEndDatePair(1) + #2:00:00 AM# &lt; overlappingTimes(i)(1) Then\n                'Set the maximum start time to 2 hours before the next task\n                startEndDatePair(2) = overlappingTimes(i)(1) - #2:00:00 AM#\n                'Add it to the collection of possible times\n                startEndDates.Add startEndDatePair\n            End If\n            'Set the next possible valid interval to be behind this task\n            startEndDatePair(1) = overlappingTimes(i)(2)\n        Next i\n        'All unchanged since last edit here\n\n        'Check if we can put our task behind the last one, if so, last possible start time is 10 PM\n        If startEndDatePair(1) &lt; #10:00:00 PM# Then\n                'Set it's maximum end time\n                startEndDatePair(2) = #10:00:00 PM#\n                startEndDates.Add startEndDatePair\n        End If\n\n        'Now, we have an array with all possible intervals where our task can start at\n        If startEndDates.Count = 0 Then\n            'Apparently, this day is already full and we can't plan the task. Do something adequate for that scenario\n            GoTo NextDate\n        End If\n\n        'pick a random interval from our intervals array\n        randomInt = RandomRange(1, startEndDates.Count, False)\n\n        'Assign our array to that interval\n        startEndDatePair(1) = startEndDates(randomInt)(1)\n        startEndDatePair(2) = startEndDates(randomInt)(1)\n        'update the schdTasks table\n        rsSchdTasks.Edit\n        rsSchdTasks.AddNew\n        rsSchdTasks.Fields(\"Date\") = dateIterator\n        'Pick a random start time within our interval\n        rsSchdTasks.Fields(\"Start_Time\") = RandomTime(startEndDatePair(1), startEndDatePair(2))\n        'End = 2 hours later\n        rsSchdTasks.Fields(\"End_Time\") = rsSchdTasks.Fields(\"Start_Time\") + #2:00:00 AM#\n        rsSchdTasks.Fields(\"TaskIdentifier\") = TaskIdentifier\n        rsSchdTasks.Update\nNextDate:\n        dateIterator = dateIterator + 1\n    Loop\nEnd Function\n</code></pre>\n\n<p>As you may note, the improvements include:</p>\n\n<ul>\n<li>You only open up tblSchdTasks once. Per day you filter the open table and put that into a new recordset</li>\n<li>You no longer use DCount, but instead check the already opened table</li>\n<li>Instead of just picking random times and checking if they are valid, you make a collection of all possible start and end intervals, then pick one of those intervals, then pick a timepoint within that interval</li>\n<li>There is no longer any need for the (imho weird) tblWindows</li>\n<li>You now include seconds in your start and end dates</li>\n<li>You no longer need qryAvailWin, which was searching a giant table and probably taking up a lot of your time</li>\n<li>You've gone from opening 113 recordsets and executing 56 DCounts (which are just as heavy as recordsets) to opening 1 recordset, and filtering and searching it 56 times</li>\n</ul>\n\n<p>And a possible disadvantage:</p>\n\n<ul>\n<li>If the intervals are really unequal in size (one is long, another is short) they both have an equal chance to be picked for the tasks. This isn't too hard to fix, but well, I've put in enough effort I think</li>\n</ul>\n"}], "owner": {"reputation": 95, "user_id": 5407920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/068860bfc8445065b5f46ffdcbcabf3a?s=128&d=identicon&r=PG&f=1", "display_name": "beechfuzz", "link": "https://stackoverflow.com/users/5407920/beechfuzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502028096, "creation_date": 1501702599, "question_id": 45469555, "link": "https://stackoverflow.com/questions/45469555/quickest-most-efficient-way-to-get-available-times-for-scheduler-database", "title": "Quickest/Most efficient way to get available times for Scheduler Database", "body": "<p>I'm creating a database that I want to use to schedule tasks for random 2-hour windows each day within a given date and time range.  For instance, Task1 may run from 1 Jan to 12 Jan anytime between the hours of 5am and 5pm.  Therefore, the database will schedule the task for a random 2-hour window (to start no earlier than 5am and stop no later than 5pm) on each of those days.  It may throw out something like this for Task1:</p>\n\n<pre><code>   Date      Start_Time      Stop_Time\n  01 Jan        06:32          08:32\n  02 Jan        14:24          16:24\n  03 Jan        08:05          10:05\n  04 Jan        12:17          14:17\n  05 Jan        11:23          13:23\n  06 Jan        12:53          14:53\n  07 Jan        09:11          11:11\n  08 Jan        05:27          05:27\n  09 Jan        12:46          14:46\n</code></pre>\n\n<p>In addition to the conditions for each Task (must be scheduled each day within a date range and within the given time range), no more than 2 tasks can overlap at any given point on any day, and no task can run into the next day (therefore they cannot start after 10pm).  </p>\n\n<p>So far, my database does this, albeit slowly, so I'm wanting to know if the method I'm using is the most efficient.</p>\n\n<p>For tables, I have one (tblWindows) which basically just consists of a column called WindowStart populated with each minute of the day, starting at 00:00 and ending at 23:59.  Literally, 1440 records -- one record for each minute of the day.</p>\n\n<p>I have another table (tblTaskConfigs) where I have the configs for each task to be scheduled against.  This is where I specify the start/stop dates and start/stop times for each Task to be scheduled.</p>\n\n<p>Finally, my tblSchdTasks table keeps track of when tasks are scheduled.</p>\n\n<p>Regarding the operation, it goes something like this:</p>\n\n<pre><code>Open tblTaskConfigs recordset.  For each TaskConfig record:\n   1) Save the following into variables:\n      - StartDate\n      - StopDate\n      - StartTime\n      - StopTime\n   2) For each date the task is to be scheduled on:\n      A) Using DCount on tblSchdTasks, check if that task has already been scheduled for that date: \n         - Yes: Skip to the next date\n         - No: \n            I) Open a query recordset (qryAvailWin) that contains available windows for that date that fall within the TaskConfig's start/stop times (times from tblWindows in which there are no more than 1 task that overlaps those times).\n            II) Choose a random record from qryAvailWin to determine the start time of the Task to be scheduled.\n            III) Open a tblSchdTasks recordset and create a new record for the task and it's randomly-selected time for that day.\n</code></pre>\n\n<p>So, I'm opening up the tblTaskConfigs recordset, and looping through each record.  For each of those records, for each day the Task is to be scheduled for, I'm opening up 2 more recordsets (qryAvailWin &amp; tblSchdTasks) to check available times and to actually schedule the task.</p>\n\n<p>For 1 task that lasts 56 days, this operation takes about 108-113 seconds.  I suspect it's because it's opening and closing a total of 113 recordsets (1 + (56 x 2)).  Additionally, qryAvailWin has three parameters (CurrDate, StartTime, and StopTime) that I need to set before each time it's opened so that it only shows available windows that are relevant to that date and that TaskConfig.</p>\n\n<p>Can you think of a more efficient way of doing something like this?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1501703413, "post_id": 45469443, "comment_id": 77900520, "body": "Thanks Scott and thanks Erik.  I tried both solutions, and with each one I keep getting this message: Microsoft is waiting for another application to complete an OLE action  The message pops up after about 4-5 minutes.  The following line of code throws things off:  .DoCmd.RunMacro   Any thoughts?  I tried a couple other ideas before posting my question.  The result is always the same."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1501705650, "post_id": 45469443, "comment_id": 77901758, "body": "You&#39;re probably having a problem with the macro requiring user interaction. Did you open the macro with Set warnings to false? If you replace your macro with a simple <code>Set Warnings False, Run SQL CREATE TABLE A</code>, does it work?"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1501702141, "creation_date": 1501702141, "answer_id": 45469443, "question_id": 45469243, "link": "https://stackoverflow.com/questions/45469243/trying-to-run-access-macro-from/45469443#45469443", "title": "Trying to Run Access Macro from", "body": "<p>The database engine only does database things (anything with tables and queries). If you want more than that, you will have to use the Access application through VBA:</p>\n\n<pre><code>Sub RunAccessMacro()\n    Dim strDatabasePath As String\n    Dim PathToDB As String\n    Dim accApp As Access.Application\n    Set accApp = New Access.Application\n\n\n\n    PathOfDatabase = ThisWorkbook.Worksheets(\"Updates\").Range(\"PathToAccess\")\n    accApp.OpenCurrentDatabase PathOfDatabase\n    accApp.DoCmd.RunMacro \"Macro_Run_Key\"\n    accApp.Quit\n    Set accApp = Nothing\n\n\n    MsgBox \"Done!  All processes complete!!\"\n\nEnd Sub\n</code></pre>\n\n<p>Also, you will need to add a reference to the Microsoft Access Object Library, or you can adapt this code to use late bindings.</p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1501702207, "creation_date": 1501702207, "answer_id": 45469455, "question_id": 45469243, "link": "https://stackoverflow.com/questions/45469243/trying-to-run-access-macro-from/45469455#45469455", "title": "Trying to Run Access Macro from", "body": "<p>Setting a reference to the Access Object Library is useless <em>unless you actually use it</em> :) Seriously, the code written above uses <code>DAO</code> which is a different animal than calling <code>Access</code> directly through the Object Libary. DAO is strictly a database engine (like ADO) and does not know about macros and modules and such as defined in Office Apps.</p>\n\n<p>Here is the code to use when using early binding:</p>\n\n<pre><code>Sub RunAccessMacro()\n\n    Dim PathOfDatabase As String\n    PathOfDatabase = ThisWorkbook.Worksheets(\"Updates\").Range(\"PathToAccess\")\n\n    Dim accApp As Access.Application\n    Set accApp = New Access.Application\n\n    With accApp\n\n        .OpenCurrentDatabase PathOfDatabase\n        .DoCmd.RunMacro \"Macro_Run_Key\"\n        .Quit\n\n    End With\n\n    MsgBox \"Done!  All processes complete!!\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1501757840, "post_id": 45480423, "comment_id": 77924793, "body": "Note that triggering it that way leads to undesirable behaviour, such as Access actually showing up and not exiting after finishing the macro, not being able to detect errors and more. While you may call it &quot;going around the houses&quot;, it&#39;s actually often more work down the line."}], "tags": [], "owner": {"reputation": 195, "user_id": 7779562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a15c7becb72fdd9c81c817aa4b693ff?s=128&d=identicon&r=PG&f=1", "display_name": "AdzzzUK", "link": "https://stackoverflow.com/users/7779562/adzzzuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1501753165, "creation_date": 1501753165, "answer_id": 45480423, "question_id": 45469243, "link": "https://stackoverflow.com/questions/45469243/trying-to-run-access-macro-from/45480423#45480423", "title": "Trying to Run Access Macro from", "body": "<p>If the macro is an Access Macro, you can actually trigger the macro with a single command rather than having to go around the houses.  The /X command line switch will help - check this link: <a href=\"https://stackoverflow.com/questions/4001516/how-can-i-schedule-a-macro-to-run-automatically-in-access-2007\">How can I schedule a Macro to run automatically in Access 2007</a></p>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2166, "favorite_count": 0, "accepted_answer_id": 45469443, "answer_count": 3, "score": 0, "last_activity_date": 1594654292, "creation_date": 1501701399, "last_edit_date": 1594654292, "question_id": 45469243, "link": "https://stackoverflow.com/questions/45469243/trying-to-run-access-macro-from", "title": "Trying to Run Access Macro from", "body": "<p>I am trying to run an Access Macro from Excel.  I set a reference to Microsoft Office 14.0 Access database engine Object Library.  Now, I'm trying to run a small script like this.</p>\n\n<pre><code>Sub RunAccessMacro()\n    Dim strDatabasePath As String\n    Dim PathToDB As String\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n\n    PathOfDatabase = ThisWorkbook.Worksheets(\"Updates\").Range(\"PathToAccess\")\n\n    Set db = DAO.DBEngine.OpenDatabase(PathOfDatabase)\n    Set qry = db.Execute(\"Macro_Run_Key\")\n\n    qry.Close\n    db.Close\n\n    MsgBox \"Done!  All processes complete!!\"\n\nEnd Sub\n</code></pre>\n\n<p>The problem is, the db.Execute won't execute the Macro.  I don't even see anything like RunMacro, or whatever it's called.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pPmIK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pPmIK.png\" alt=\"enter image description here\"></a></p>\n\n<p>There must be a way to do this, right.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18343, "user_id": 337315, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/vNdBR.jpg?s=128&g=1", "display_name": "CodeLikeBeaker", "link": "https://stackoverflow.com/users/337315/codelikebeaker"}, "edited": false, "score": 0, "creation_date": 1501701445, "post_id": 45469240, "comment_id": 77899381, "body": "What&#39;s your error?"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1501702823, "creation_date": 1501702823, "answer_id": 45469607, "question_id": 45469240, "link": "https://stackoverflow.com/questions/45469240/how-to-create-a-pivot-table-in-excel-vba/45469607#45469607", "title": "How to create a pivot table in excel VBA?", "body": "<p>Replace the last line with</p>\n\n<pre><code>Set PT = PTCache.CreatePivotTable(TableDestination:=WSD2.Range(\"A1\"), TableName:=\"Pivotab\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1505229105, "post_id": 45475842, "comment_id": 79322550, "body": "Sorry for the late response. But this worked perfectly"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1501739425, "creation_date": 1501739425, "answer_id": 45475842, "question_id": 45469240, "link": "https://stackoverflow.com/questions/45469240/how-to-create-a-pivot-table-in-excel-vba/45475842#45475842", "title": "How to create a pivot table in excel VBA?", "body": "<p>Replace your current <code>PivtoCache</code> line:</p>\n\n<pre><code>Set PTCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange)\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>Set PTCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange.Address(False, False, xlA1, xlExternal))\n</code></pre>\n\n<p><strong>Also</strong>, you are getting the error in the last line, because you are setting the location of the Pivot-Table <code>WSD2.Range(A1)</code> , the string inside the brackets need to have <code>\"</code>. So also modify it to <code>WSD2.Range(\"A1\")</code></p>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 45475842, "answer_count": 2, "score": 0, "last_activity_date": 1501739425, "creation_date": 1501701388, "question_id": 45469240, "link": "https://stackoverflow.com/questions/45469240/how-to-create-a-pivot-table-in-excel-vba", "title": "How to create a pivot table in excel VBA?", "body": "<p>I am trying to create a pivot table but I am getting an error with my last line of code.</p>\n\n<pre><code>Dim WSD As Worksheet\nDim WSD2 As Worksheet\nDim PTCache As PivotCache\nDim PT As PivotTable\nDim PRange As Range\nDim FinalRow As Long\nDim FinalCol As Long\nSet WSD = Worksheets(\"SKU Sum\")\nSet WSD2 = Worksheets(\"Finelines\")\n\n' Select the data for pivot table\n\nFinalRow = WSD.Cells(Rows.Count, 1).End(xlUp).Row\nFinalCol = WSD.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = WSD.Cells(1, 1).Resize(FinalRow, FinalCol)\nSet PTCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange)\n\nSet PT = WSD.PivotTables.Add(PivotCache:=PTCache, TableDestination:=WSD2.Range(A1), TableName:=\"Pivotab\")\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>G</p>\n"}, {"tags": ["vba", "excel", "merge"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1501702221, "post_id": 45469053, "comment_id": 77899805, "body": "If which two cells contain identical text? The cell above and/or below? Or would it always be above? Can you post some sample data and sample of expected output?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1501702641, "post_id": 45469053, "comment_id": 77900056, "body": "As @BruceWayne stated, a before and after picture would most definitely help here"}, {"owner": {"reputation": 13, "user_id": 7638367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d23a9f451d409b2737d7d1fdbade869?s=128&d=identicon&r=PG&f=1", "display_name": "JuliaXu", "link": "https://stackoverflow.com/users/7638367/juliaxu"}, "edited": false, "score": 0, "creation_date": 1501703944, "post_id": 45469053, "comment_id": 77900846, "body": "Stackoverflow doesn&#39;t allow me to embed images yet, but I have attached before and after pictures in my original post. As you can see the position of the cell will vary depending on the start and end times of the events."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7638367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d23a9f451d409b2737d7d1fdbade869?s=128&d=identicon&r=PG&f=1", "display_name": "JuliaXu", "link": "https://stackoverflow.com/users/7638367/juliaxu"}, "edited": false, "score": 1, "creation_date": 1501714868, "post_id": 45470823, "comment_id": 77905593, "body": "one small change I made:     lastRow = tableRng.Rows(tableRng.Rows.Count).Row     lastColumn= tableRng.Columns(tableRng.Columns.Count).Column     For k = tableRng.Columns(1).Column To lastColumn  not sure why this made a difference, but it covered the last column that wasn&#39;t updating before."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1501707265, "creation_date": 1501707265, "answer_id": 45470823, "question_id": 45469053, "link": "https://stackoverflow.com/questions/45469053/vba-merge-non-adjacent-cells-containing-same-text-in-excel/45470823#45470823", "title": "VBA merge non-adjacent cells containing same text in Excel", "body": "<p>Okay - this may be overkill, and you may need to tweak, but this was fun to work on.</p>\n\n<pre><code>Sub combine_Same()\nApplication.DisplayAlerts = False\n\nDim tableRng As Range\nDim i As Long, k As Long, lastRow As Long\nDim curText As Range, prevText As Range\n\nDim tableRanges As Variant\n\ntableRanges = Split(\"b3:e20,C31:V51,C54:V74,C77:V97,C100:V120\", \",\")\n\nDim rng     As Long\n\nFor rng = LBound(tableRanges) To UBound(tableRanges)\n    Debug.Print \"Working with: \" &amp; tableRanges(rng)\n    Set tableRng = Range(tableRanges(rng))\n'    tableRng.Select\n    lastRow = tableRng.Rows(tableRng.Rows.Count).Row\n    For k = tableRng.Columns(1).Column To tableRng.Columns.Count\n        For i = lastRow To tableRng.Rows(1).Row Step -1\n            Set curText = Cells(i, k)\n            Set prevText = curText.End(xlUp)\n            If curText.Value = prevText.Value And Not IsEmpty(curText) Then\n                'curText.Select\n                Range(curText, prevText).Merge\n                curText.VerticalAlignment = xlCenter\n            ElseIf curText.Value = curText.Offset(-1, 0).Value And Not IsEmpty(curText) Then\n                'curText.Select\n                Range(curText, curText.Offset(-1, 0)).Merge\n                curText.VerticalAlignment = xlCenter\n            End If\n        Next i\n    Next k\nNext rng\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7638367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d23a9f451d409b2737d7d1fdbade869?s=128&d=identicon&r=PG&f=1", "display_name": "JuliaXu", "link": "https://stackoverflow.com/users/7638367/juliaxu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 45470823, "answer_count": 1, "score": 0, "last_activity_date": 1501707265, "creation_date": 1501700717, "last_edit_date": 1501703823, "question_id": 45469053, "link": "https://stackoverflow.com/questions/45469053/vba-merge-non-adjacent-cells-containing-same-text-in-excel", "title": "VBA merge non-adjacent cells containing same text in Excel", "body": "<p>I am building a calendar in Excel that automatically maps event information from a table to a dynamic calendar view. Each row represents a time from 8AM - 6PM, and each column represents a day of the week from Sunday - Saturday. I was able to map information for each unique event to two separate cells in each column, one for start time and one for end time. I am looking for help with building a macro to merge the cells containing the same information into one so the calendar is cohesive. E.g. Event A starts at 9AM and ends at 11AM. There is currently one cell populated at 9AM and one at 11AM, but the cell for 10AM is blank and I'd like to merge the two populated cells from the 9AM cell to 11AM cell. As the populated cells will not always be adjacent, the offset function doesn't seem to work in this case.</p>\n\n<p>Here is the pseudo code I'm trying to accomplish:</p>\n\n<ol>\n<li>For each column in a specified region</li>\n<li>loop through each row</li>\n<li>if two cells contain identical text</li>\n<li>merge those two cells</li>\n</ol>\n\n<p>Here is the little bit of code I've managed to come up with so far. You can tell there are many gaps and probably syntax errors:</p>\n\n<pre><code>Sub MergeCells\nDim cells As String\ncells = ActiveSheet.Range(\"C8:V28,C31:V51,C54:V74,C77:V97,C100:V120\")\n    If ActiveSheet.Range(cells).??? Then\n       ActiveSheet.Range(cells).Merge\n    End If \nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p><a href=\"https://i.stack.imgur.com/T79sN.jpg\" rel=\"nofollow noreferrer\">Before picture</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/U41Rx.jpg\" rel=\"nofollow noreferrer\">After picture</a></p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 0, "creation_date": 1501706366, "post_id": 45469779, "comment_id": 77902164, "body": "Thanks a lot Thomas! Sorry if this is a stupid question, but how to I change the <code>btn</code> to a class level variable? I set the code exactly as you have it in the GIF, but it&#39;s still not working, so I think I&#39;m missing that piece."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 0, "creation_date": 1501707262, "post_id": 45469779, "comment_id": 77902660, "body": "Class variable are declared outside of any sub routines preferably top of the module.  Make sure that you don&#39;t have a variable with the same name declared in your sub routine."}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 0, "creation_date": 1501708871, "post_id": 45469779, "comment_id": 77903456, "body": "Ok, awesome. I got it working. That&#39;s a good step in the right direction. Thank you so much for the help Thomas!"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1501722892, "post_id": 45469779, "comment_id": 77907398, "body": "i usually use witevents as public inside class module. Not sure how tou would set btn if it is as private."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1501723255, "post_id": 45469779, "comment_id": 77907469, "body": "You can make the btn&#39;s scope public if you like. But Userforms are class modules.  You can have the btn variable at the top of the userform&#39;s class module.  The btn will available to all methods inside of the userform."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1501723441, "post_id": 45469779, "comment_id": 77907509, "body": "nicely done. One question, if you had several buttons, it would be better creating a class-module, right? I never thought of this way for usin a withevents. Thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1501723767, "post_id": 45469779, "comment_id": 77907573, "body": "If you wanted to use the same code for several different controls than you would create a class that would manage the code.  You would then use a class level collection or array to hold one instance of the class for each control.  In this way, you&#39;ll be able to keep the references alive as long as the userform is active."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1501703400, "creation_date": 1501703400, "answer_id": 45469779, "question_id": 45469026, "link": "https://stackoverflow.com/questions/45469026/how-to-use-a-dynamic-button-in-userform-vba/45469779#45469779", "title": "How to use a dynamic button in Userform VBA", "body": "<p>Changing your <code>btn</code> variable to a class level variable and using <code>WithEvents</code> will allow you to access the dynamic buttons events.</p>\n\n<pre><code>Private WithEvents btn As CommandButton\n\nPrivate Sub btn_Click()\n    Dim ctrl As Control\n    For Each ctrl In Me.Controls\n        If TypeName(ctrl) = \"OptionButton\" Then\n            If ctrl.Object.Value Then\n                MsgBox ctrl.Object.Caption\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dd2II.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dd2II.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1920, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501703400, "creation_date": 1501700576, "question_id": 45469026, "link": "https://stackoverflow.com/questions/45469026/how-to-use-a-dynamic-button-in-userform-vba", "title": "How to use a dynamic button in Userform VBA", "body": "<p>I could really use some help on this. I've read through about 60+ websites and it's either not clicking (pun intended), or it's incorrect for my application. Here's the rundown:</p>\n\n<p>Goal: Use a \"Submit\" button that was dynamically created in a Userform to copy the Caption from an OptionButton to a dynamic cell on the worksheet, and then clear/close the Userform.</p>\n\n<p>Background: The userform is called from a change in a column in the worksheet.\nHere's a snippet of the code used to call the userform: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nDim lastRow As Long\n\n    With Worksheets(\"Test\")\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n    With Target\n        If .Count &gt; 1 Then Exit Sub\n        If Not Intersect(Range(\"B1:B\" &amp; lastRow), .Cells) Is Nothing Then\n            Application.EnableEvents = False\n            If IsEmpty(.Value) Then\n                .Offset(0, 1).ClearContents\n            Else\n                With .Offset(0, 1)\n                    .NumberFormat = \"mmm dd yyyy hh:mm:ss\"\n                    .Value = Now\n                    UserForm1.Show\n                End With\n            End If\n            Application.EnableEvents = True\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>After the Userform is shown, it initializes. It pulls from a list on the spreadsheet to populate how many option buttons there are, their captions, and the dimensions of each item on the Userform. The code for that is this:</p>\n\n<pre><code>Sub UserForm_Initialize()\n\nDim HLastRow As Integer\nDim NoOfExplanations As Integer\nDim TopPixels As Integer\nDim UserFormHeight As Integer\nDim UserFormWidth As Integer\nDim Opt As Variant\nDim i As Integer\nDim ExplanationRow As Integer\nDim lbl As MSForms.Label\nDim LabelCap As String\nDim btn As CommandButton\nDim OtherInput As MSForms.TextBox\nDim Margins As Integer\n\n    With Worksheets(\"Test\")\n        HLastRow = .Cells(.Rows.Count, \"H\").End(xlUp).Row\n    End With\n\nNoOfExplanations = Application.WorksheetFunction.CountA(Worksheets(\"Test\").Range(\"H2:H\" &amp; HLastRow))\nMargins = 20\n\nLabelCap = \"You have chosen a non sequential row for your team/subteam. Please select an explanation below before you are able to proceed\"\nUserFormWidth = Len(LabelCap) * 2\nTopPixels = (18 * 2)\nUserFormHeight = TopPixels + 80 + (20 * NoOfExplanations)\n\n    With UserForm1\n        .Width = UserFormWidth + 40\n        .Height = UserFormHeight\n    End With\n\n    Set lbl = UserForm1.Controls.Add(\"Forms.Label.1\")\n    With lbl\n        .Top = 10\n        .Left = 20\n        .Height = 20\n        .Width = UserFormWidth - 20\n        .Caption = LabelCap\n    End With\n\nExplanationRow = 2\nFor i = 1 To NoOfExplanations\n\n    Set Opt = UserForm1.Controls.Add(\"Forms.OptionButton.1\", \"OptionButton\" &amp; i, True)\n\n    Opt.Caption = Worksheets(\"Test\").Cells(ExplanationRow, 8).Value\n\n    If Worksheets(\"Test\").Cells(ExplanationRow, 8).Value = \"Other\" Then\n        Set OtherInput = UserForm1.Controls.Add(\"Forms.TextBox.1\")\n        With OtherInput\n            .Top = TopPixels\n            .Width = UserFormWidth - (Len(Worksheets(\"Test\").Cells(ExplanationRow, 8).Value) * 11)\n            .Left = UserFormWidth - (UserFormWidth - (Len(Worksheets(\"Test\").Cells(ExplanationRow, 8).Value) * 11))\n            .Height = 18\n        End With\n    End If\n\n    If Len(Worksheets(\"Test\").Cells(ExplanationRow, 8).Value) &gt; 45 Then\n        Opt.Width = UserFormWidth - 10\n        Opt.Height = 36\n        Opt.Left = 18\n\n        Opt.Top = TopPixels\n        TopPixels = TopPixels + 38\n    End If\n\n    If Len(Worksheets(\"Test\").Cells(ExplanationRow, 8).Value) &lt;= 45 Then\n        Opt.Width = UserFormWidth - 10\n        Opt.Height = 18\n        Opt.Left = 18\n\n        Opt.Top = TopPixels\n        TopPixels = TopPixels + 20\n    End If\n    ExplanationRow = ExplanationRow + 1\nNext i\n\n    Set btn = UserForm1.Controls.Add(\"Forms.CommandButton.1\")\n    With btn\n        .Top = TopPixels\n        .Width = 40\n        .Left = ((UserFormWidth + 40) / 2) - 20\n        .Height = 20\n        .Caption = \"Submit\"\n        .Name = btn\n    End With\nEnd Sub\n</code></pre>\n\n<p>Question: So, how do I get the btn created here in the Userform to both copy the selected OptionButton caption to the dynamic cell, and then clear/close the Userform?</p>\n\n<p>I know it's a stretch, but I'm trying to fill in the cell that is two columns over from the \"Target\" cell that triggers the Userform to open. The code fills in the current date/time in the .Offset(0, 1) in the Worksheet_Change snipped, but is there a way to place the OptionButton caption in the cell at .Offset(0, 2)?</p>\n\n<p>I'm still pretty new to VBA and this one thing is really sticking a thorn in me.</p>\n\n<p>I'll be incredibly grateful for any help on this.</p>\n\n<p>Thanks!\nJoe</p>\n"}, {"tags": ["vba", "excel", "checkbox", "togglebutton"], "comments": [{"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1503054576, "post_id": 45468963, "comment_id": 78467496, "body": "RE your mod flag: First of all, the receipt of an answer is not necessarily evidence that your question is clear or acceptable for our format. The answerer may have just guessed correctly. This question looks problematic to me, even in its current format, for at least two reasons: (1) it doesn&#39;t include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that orients us to &quot;what you have now&quot;, (2) it is almost certainly &quot;too broad&quot;, since a good answer would have to explain the fundamentals of VBA programming to you, which is really more than we expect answers to do on Stack Overflow."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1503054736, "post_id": 45468963, "comment_id": 78467600, "body": "As far as why your edit after the question was placed &quot;on hold&quot; didn&#39;t lead to a re-opening... It actually did <a href=\"https://stackoverflow.com/review/reopen/16920148\">put the question in the re-open queue</a>, where community members reviewed your edits and determined that they were not sufficient to motivate re-opening the question. As a moderator, I&#39;m reluctant to override trusted community members, especially in light of my reservation the question is too broad. Normally, you could narrow it down a bit more, but that&#39;s going to be hard after getting an answer. This is why we try to close early."}, {"owner": {"reputation": 13, "user_id": 8407430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c5c3c2300851db3b47a792469d493c?s=128&d=identicon&r=PG&f=1", "display_name": "L.J.", "link": "https://stackoverflow.com/users/8407430/l-j"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1503062476, "post_id": 45468963, "comment_id": 78472855, "body": "Fair enough, I admit it is a pretty basic question and phrased in lay terms..."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8407430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c5c3c2300851db3b47a792469d493c?s=128&d=identicon&r=PG&f=1", "display_name": "L.J.", "link": "https://stackoverflow.com/users/8407430/l-j"}, "edited": false, "score": 0, "creation_date": 1501701980, "post_id": 45469093, "comment_id": 77899651, "body": "Thanks for that - in the process of trying it out. One thing though - the code is in Module 1, where at the beginning the whole Workbook is being unlocked, sheet by sheet, a couple of preparatory actions taken, and only then I want to bring in the UserForm with checkboxes and the CommandButton. Are you saying I should enter the whole code into the Private Sub of the Button? I was hoping to call the Userform on clicking a button on the sheet, select the options (check boxes), then have the CommandButrton activate the rest of the code, taking the values of the boxes into account."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 13, "user_id": 8407430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c5c3c2300851db3b47a792469d493c?s=128&d=identicon&r=PG&f=1", "display_name": "L.J.", "link": "https://stackoverflow.com/users/8407430/l-j"}, "edited": false, "score": 0, "creation_date": 1501703081, "post_id": 45469093, "comment_id": 77900324, "body": "Well you can keep a Private Sub in Module1 and call it within the Userform. Code will run or can be called regardless of it being Private or Sheets locked."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 13, "user_id": 8407430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c5c3c2300851db3b47a792469d493c?s=128&d=identicon&r=PG&f=1", "display_name": "L.J.", "link": "https://stackoverflow.com/users/8407430/l-j"}, "edited": false, "score": 0, "creation_date": 1501703284, "post_id": 45469093, "comment_id": 77900439, "body": "Also you can even name Subs the same name as long as they are in different Modules then call them with Module Name. Module1.subber and Module2.subber"}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 13, "user_id": 8407430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c5c3c2300851db3b47a792469d493c?s=128&d=identicon&r=PG&f=1", "display_name": "L.J.", "link": "https://stackoverflow.com/users/8407430/l-j"}, "edited": false, "score": 0, "creation_date": 1501703502, "post_id": 45469093, "comment_id": 77900565, "body": "added to the answer to show how calling is done"}], "tags": [], "owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "is_accepted": true, "score": 0, "last_activity_date": 1501703488, "last_edit_date": 1501703488, "creation_date": 1501700871, "answer_id": 45469093, "question_id": 45468963, "link": "https://stackoverflow.com/questions/45468963/excel-vba-multiple-checkboxes-to-activate-parts-of-code/45469093#45469093", "title": "Excel VBA Multiple Checkboxes to activate parts of code", "body": "<p>So in VBA there are event listeners. This can be seen in the upper part of the editor below the toolbars. Drop down to the left is the object. Drop down to the right is the event.</p>\n\n<p>A quick way is to view the userform and double click the object. This will create a <code>Private Sub</code> for that object based on the action. So the code below is a userform with three Option Buttons. Same logic with yours just insert the code you need.</p>\n\n<pre><code>Private Sub OptionButton1_Click()\nMsgBox \"1\"\nEnd Sub\n\nPrivate Sub OptionButton2_Click()\nMsgBox \"2\"\nEnd Sub\n\nPrivate Sub OptionButton3_Click()\nMsgBox \"3\"\nEnd Sub\n</code></pre>\n\n<p>Also you can check if the OptionButton is selected by checking its <code>.Value</code> property. And after checking run some code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nIf UserForm1.OptionButton1.Value = True Then\n    'Execute Code\nElseIf UserForm1.OptionButton2.Value = True Then\n    'Execute Code\nElse\n    'Execute Code\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Code in Module1</p>\n\n<pre><code>Private Sub select_column_a()\n    Range(\"A:A\").Select\nEnd Sub\n</code></pre>\n\n<p>Call inside another sub</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Module1.select_column_a\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501711578, "post_id": 45471751, "comment_id": 77904557, "body": "The reason there is no conflict in Private Sub CommandButton1_Click() is because Module and Userform1 are in a different scope. You don&#39;t need to add Userform1.CommandButton because the Command Button is within the scope of the userform1. Just for added information."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501711598, "post_id": 45471751, "comment_id": 77904560, "body": "Glad it helped!"}], "tags": [], "owner": {"reputation": 13, "user_id": 8407430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c5c3c2300851db3b47a792469d493c?s=128&d=identicon&r=PG&f=1", "display_name": "L.J.", "link": "https://stackoverflow.com/users/8407430/l-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1501751271, "last_edit_date": 1501751271, "creation_date": 1501711397, "answer_id": 45471751, "question_id": 45468963, "link": "https://stackoverflow.com/questions/45468963/excel-vba-multiple-checkboxes-to-activate-parts-of-code/45471751#45471751", "title": "Excel VBA Multiple Checkboxes to activate parts of code", "body": "<p>@fscr Thank you again - works like a charm, with some additions, which is why I'm posting here for the benefit of other beginners like me. </p>\n\n<p>In a CommandButton I inserted in the Sheet the sub is simply:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nUserForm1.Show\nEnd Sub\n</code></pre>\n\n<p>This shows my UserForm1 with all the checkboxes and one CommandButton saying \"Go\"</p>\n\n<p>The Go Button (also CommandButton1 - no conflict there) has this inside:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\ncode\nEnd Sub\n</code></pre>\n\n<p>where code is the name of my code (yes, I did...) stored in Module1 - it executes it smoothly without any separate calling function. Question here, might there be issues with backward compatibility? I'm working in Excel 2016 and learned that for instance ISFORMULA is new here and threw off issues on older machines.</p>\n\n<p>Then the whole code kicks in with </p>\n\n<pre><code>Sub code()\nUserForm1.Hide\n</code></pre>\n\n<p>followed by various actions, until it gets to my checkboxes, as suggested above (with ammendments):</p>\n\n<pre><code>Application.Cursor = xlWait\nApplication.DisplayStatusBar = True\nApplication.StatusBar = \"Calculating Sensitivities...\"\nApplication.EnableCancelKey = xlDisabled\n\nIf UserForm1.CheckBox1.Value = True Then\n\nRange(\"A6:G15\").Select\nSelection.Table ColumnInput:=Range(\"AD3\") \nApplication.Calculate\nRange(\"B7:G15\").Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nElseIf UserForm1.CheckBox2.Value = True Then\n\nRange(\"AD17:AM26\").Select\nSelection.Table ColumnInput:=Range(\"AD2\")\nApplication.Calculate\nRange(\"AE18:AM26\").Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>etc.</p>\n\n<p>The code executes the remaining options as checked, then comes End If and the rest of the code (cleaning up, locking the Sheets etc.) until </p>\n\n<pre><code>Application.ScreenUpdating = True\nApplication.EnableCancelKey = xlEnabled\nEnd Sub\n</code></pre>\n\n<p>all without any errors. Thank you again!</p>\n"}], "owner": {"reputation": 13, "user_id": 8407430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c5c3c2300851db3b47a792469d493c?s=128&d=identicon&r=PG&f=1", "display_name": "L.J.", "link": "https://stackoverflow.com/users/8407430/l-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1764, "favorite_count": 0, "closed_date": 1501727719, "accepted_answer_id": 45469093, "answer_count": 2, "score": 0, "last_activity_date": 1501751271, "creation_date": 1501700315, "last_edit_date": 1531164843, "question_id": 45468963, "link": "https://stackoverflow.com/questions/45468963/excel-vba-multiple-checkboxes-to-activate-parts-of-code", "closed_reason": "Needs details or clarity", "title": "Excel VBA Multiple Checkboxes to activate parts of code", "body": "<p>The VBA code I am working on is currently updating six different Data Tables on one Worksheet in one go - it removes password protection, calculates the first Data Table, hardcodes the values and moves on to the next one, then locks it all again and says thank you. </p>\n\n<p>The aim is to have a macro that would 'separate' the six parts of the code dealing with individual Data Tables in such a way that it only updates those Data Tables which have been selected by user, whilst retaining a single code (not individual subs for each option) and having the whole process activated by a single CommandButton.</p>\n\n<p>To achieve this, apart from writing the actual code, I have created a UserForm and inserted six CheckBoxes and a single CommandButton, but got stuck at how to handle this further. How do I activate/disable parts of the code based on the boxes checked?</p>\n"}, {"tags": ["excel", "excel-tables", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": true, "score": 3, "last_activity_date": 1560899348, "last_edit_date": 1560899348, "creation_date": 1501700231, "answer_id": 45468932, "question_id": 45468931, "link": "https://stackoverflow.com/questions/45468931/whats-the-quickest-way-to-delete-all-blank-rows-of-an-excel-table/45468932#45468932", "title": "What&#39;s the quickest way to delete all blank rows of an Excel table?", "body": "<p>Here's a procedure I use to delete blank table rows.  I sometimes work with large (for Excel) data sets and this method is faster.  It loads table rows into an array, checks the array for blank rows, and performs one <code>range.delete</code> operation at the end.</p>\n\n<p>You use the procedure like this:</p>\n\n<pre><code>Sub Test()\n    DeleteBlankTableRows ActiveSheet.ListObjects(1)\nEnd Sub\n</code></pre>\n\n<p>ActiveSheet.ListObjects(1) is (usually) the first table table on the active worksheet.</p>\n\n<p>Here's the actual procedure:</p>\n\n<pre><code>Sub DeleteBlankTableRows(ByVal tbl As ListObject)\n    Dim rng As Range\n    Set rng = tbl.DataBodyRange ' Get table data rows range.\n    Dim DirArray As Variant\n    DirArray = rng.Value2       ' Save table values to array.\n\n    ' LOOP THROUGH ARRAY OF TABLE VALUES\n    Dim rowTMP As Long\n    Dim colTMP As Long\n    Dim combinedTMP As String\n    Dim rangeToDelete As Range\n\n    '  Loop through rows.\n    For rowTMP = LBound(DirArray) To UBound(DirArray)\n        combinedTMP = vbNullString  ' Clear temp variable.\n\n        ' Loop through each cell in the row and get all values combined.\n        For colTMP = 1 To tbl.DataBodyRange.Columns.Count\n            combinedTMP = combinedTMP &amp; DirArray(rowTMP, colTMP)\n        Next colTMP\n\n        ' Check if row is blank.\n        If combinedTMP = vbNullString Then\n            ' Row is blank.  Add this blank row to the range-to-delete.\n            If rangeToDelete Is Nothing Then\n                Set rangeToDelete = tbl.ListRows(rowTMP).Range\n            Else\n                Set rangeToDelete = Union(rangeToDelete, tbl.ListRows(rowTMP).Range)\n            End If\n        End If\n    Next rowTMP\n\n    ' DELETE BLANK TABLE ROWS (if any)\n    If Not rangeToDelete Is Nothing Then rangeToDelete.Delete\nEnd Sub\n</code></pre>\n\n<p>This has some advantages over other methods:</p>\n\n<ol>\n<li><strong>SPEED</strong>:  In a test of a table with 200,000 rows and 8 columns, this method took 19 seconds.  That's just over half the 34 seconds the <code>SpecialCells(xlCellTypeBlanks)</code> method needed for an identical table.</li>\n<li><strong>IDENTIFIES FULLY BLANK TABLE ROWS</strong>:  Unlike some other methods (like <a href=\"https://stackoverflow.com/a/41274588/5640342/\" title=\"this one\">this one</a> - although it is useful in some situations) this method looks for blanks in every cell of a row instead of just one.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1501704476, "post_id": 45469823, "comment_id": 77901146, "body": "Thanks for posting this.  I ran this first as is and it completed in 4 minutes 13 seconds.  With screen updating and calculations set to manual it was cut down to 1 minute 17 seconds - faster but still far slower than the 19 seconds achieved with the method I posted as an answer....seems like there should be a faster way."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1501704029, "last_edit_date": 1501704029, "creation_date": 1501703601, "answer_id": 45469823, "question_id": 45468931, "link": "https://stackoverflow.com/questions/45468931/whats-the-quickest-way-to-delete-all-blank-rows-of-an-excel-table/45469823#45469823", "title": "What&#39;s the quickest way to delete all blank rows of an Excel table?", "body": "<p>This should work. Not sure if it's faster, but it's another way to do it:</p>\n\n<pre><code>Sub delete_blank_table_rows()\nDim Rng As Range, tempRng As Range\nSet Rng = Range(\"Table1\")    ' Change as necessary\nSet Rng = Range(Cells(Rng.Rows(1).Row, Rng.Columns(1).Column), Cells(Rng.Rows(Rng.Rows.Count).Row, Rng.Columns(Rng.Columns.Count).Column))\n\nDim i       As Long\nFor i = Rng.Rows.Count To 1 Step -1\n    Cells(Rng.Rows(i).Row, Rng.Columns(1).Column).Select\n    Set tempRng = Range(Cells(Rng.Rows(i).Row, Rng.Columns(1).Column), Cells(Rng.Rows(i).Row, Rng.Columns(Rng.Columns.Count).Column))\n\n    If WorksheetFunction.CountA(tempRng) = 0 Then\n        tempRng.Delete shift:=xlUp\n    End If\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>Edit: And of course to speed it up you should turn off Screen Updating, Calculation while it runs.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1519743911, "creation_date": 1519743911, "answer_id": 49011816, "question_id": 45468931, "link": "https://stackoverflow.com/questions/45468931/whats-the-quickest-way-to-delete-all-blank-rows-of-an-excel-table/49011816#49011816", "title": "What&#39;s the quickest way to delete all blank rows of an Excel table?", "body": "<p>I think this may be faster (you can modify lastrow and lastcol to meet your table dimensions):</p>\n\n<pre><code>Sub delete_rows_blank2()\n\nt = 1\nlastrow = ActiveSheet.UsedRange.Rows.Count\nlastcol = ActiveSheet.UsedRange.Columns.Count\n\nDo Until t = lastrow\n\nFor j = 1 To lastcol\n\n    If Cells(t, j) = \"\" Then\n\n        j = j + 1\n\n            If j = lastcol Then\n            Rows(t).Delete\n            t = t + 1\n            End If\n\n    Else\n\n        t = t + 1\n\n    End If\n\nNext\n\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2812, "favorite_count": 1, "accepted_answer_id": 45468932, "answer_count": 3, "score": 1, "last_activity_date": 1560899348, "creation_date": 1501700231, "last_edit_date": 1531161705, "question_id": 45468931, "link": "https://stackoverflow.com/questions/45468931/whats-the-quickest-way-to-delete-all-blank-rows-of-an-excel-table", "title": "What&#39;s the quickest way to delete all blank rows of an Excel table?", "body": "<p>I see several posts about deleting blank rows in a range and others about deleting table rows based on a single blank column, but nothing about deleting entirely blank table rows.</p>\n\n<p>What's the quickest way to do this?</p>\n\n<p>I posted my solution below to help others but I'm interested to see if anyone has a faster method.</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1501710902, "post_id": 45468824, "comment_id": 77904312, "body": "Can you show the rest of your code? E.g. what does this do?: If (ISSArray(iRowISS, 3) &lt;&gt; FCSTArray(iRowFCST, 2)) Then"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1501711009, "post_id": 45468824, "comment_id": 77904353, "body": "What error do you get and are you sure <code>nextCell</code> has an integer value greater than 0?"}, {"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1501762280, "post_id": 45468824, "comment_id": 77928044, "body": "@Absinthe I edited to have all the code"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1501832342, "post_id": 45468824, "comment_id": 77962529, "body": "@PortlandRunner - What happens when you step through the code line by line (e.g. <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/DebuggingVBA.aspx</a>)? Are you getting past your If statements?"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1502008518, "post_id": 45468824, "comment_id": 78020400, "body": "@PortlandRunner Oops, sorry!"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1502008535, "post_id": 45468824, "comment_id": 78020408, "body": "@user90823745 What happens when you step through the code line by line (e.g. cpearson.com/excel/DebuggingVBA.aspx)? Are you getting past your If statements?"}], "owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501762250, "creation_date": 1501699907, "last_edit_date": 1501762250, "question_id": 45468824, "link": "https://stackoverflow.com/questions/45468824/printing-from-ppt-vba-to-an-excel-spreadsheet", "title": "Printing from ppt VBA to an Excel spreadsheet", "body": "<p>I'm trying to convert excel VBA to ppt VBA. The original excel VBA (in \"Comparison.xlsm\") compared values from other excel workbooks and printed mismatching ones in Comparison.xlsm's Sheet1. </p>\n\n<p>I know my code below (which is my ppt VBA version) is seeing the correct workbooks because when I use MsgBox to print values, I get the correct ones. However, my issue is when I try to print the incorrect values into Comparison.xlsm's Sheet1 at:</p>\n\n<pre><code>mainWB.Worksheets(\"Sheet1\").Range(\"A\" &amp; nextCell).Value = ID_ISS\nmainWB.Sheets(\"Sheet1\").Range(\"B\" &amp; nextCell).Value = \"Symbol\"\nmainWB.Sheets(\"Sheet1\").Range(\"B\" &amp; nextCell).Value = \"(FCST)\"\n</code></pre>\n\n<p>I just don't see it print in the excel spreadsheet. Here's the relevant code:</p>\n\n<p>EDIT: I changed it to add all my code -</p>\n\n<pre><code>Dim strIDRangeISS As String\nDim strIDRangeFCST As String\nDim iRow As Integer\nDim iCol As Integer\nDim ID_ISS As Long\nDim ID_FCST As Long\nDim nextCell As Integer\nDim iRowISS As Integer\nDim iRowFCST As Integer\n\nDim wbkFCST As Excel.Workbook\nDim wbkISS As Excel.Workbook\nDim mainWB As Excel.Workbook  \nDim varSheetFCST As Excel.Worksheet\nDim varSheetISS As Excel.Worksheet\nDim mainWS As Excel.Worksheet\n\nnextCell = 1\n\nSet wbkFCST = Workbooks.Open(\"C:\\Users\\...\\Documents\\FCST.xlsx\")\nSet varSheetFCST = wbkFCST.Worksheets(\"Details\")\n\nSet wbkISS = Workbooks.Open(FileName:=\"C:\\Users\\...\\Documents\\ISS.xlsm\")\nSet varSheetISS = wbkISS.Worksheets(\"ISS\")\n\nSet mainWB = Workbooks.Open(FileName:=\"C:\\Users\\...\\Documents\\Comparison.xlsm\")\nSet mainWS = mainWB.Worksheets(\"Sheet1\")\n\nstrIDRangeISS = \"A2:D50\" \nstrIDRangeFCST = \"B2:I50\"\n\n'varSheetISS = varSheetISS.Range(strIDRangeISS)\n'varSheetFCST = varSheetFCST.Range(strIDRangeFCST)\nDim ISSArray As Variant: ISSArray = varSheetISS.Range(strIDRangeISS)\nDim FCSTArray As Variant: FCSTArray = varSheetFCST.Range(strIDRangeFCST)\n\nFor iRowISS = LBound(ISSArray, 1) To UBound(ISSArray, 1)    'Goes down ISS' ID column\n    ID_ISS = ISSArray(iRowISS, 1)\n    MsgBox (\"ID_ISS is \" &amp; ID_ISS)      \n\n    For iRowFCST = LBound(FCSTArray, 1) To UBound(FCSTArray, 1)    'Goes down FCST ID column\n        ID_FCST = FCSTArray(iRowFCST, 1)\n        MsgBox (\"ID_FCST is \" &amp; ID_FCST)       \n\n        'Compares ISS ID to FCST ID till finds matching\n        If (ID_ISS = ID_FCST) Then\n            'If corr symbols aren't same, record ID in Comparison's spreadsheet and go onto next ISS ID\n            If (ISSArray(iRowISS, 3) &lt;&gt; FCSTArray(iRowFCST, 2)) Or (ISSArray(iRowISS, 4) &lt;&gt; FCSTArray(iRowFCST, 8)) Then\n                mainWB.Worksheets(\"Sheet1\").Range(\"A\" &amp; nextCell).Value = ID_ISS\n\n                'Symbol mismatch\n                If (ISSArray(iRowISS, 3) &lt;&gt; FCSTArray(iRowFCST, 2)) Then\n                    mainWB.Sheets(\"Sheet1\").Range(\"B\" &amp; nextCell).Value = \"Symbol\"\n                End If\n\n                '(FCST) mismatch\n                If (ISSArray(iRowISS, 4) &lt;&gt; FCSTArray(iRowFCST, 8)) Then\n                    mainWB.Sheets(\"Sheet1\").Range(\"B\" &amp; nextCell).Value = \"(FCST)\"\n                End If\n\n                nextCell = nextCell + 1\n            End If\n            Exit For    'If corr symbols are same, go onto next ISS ID\n        End If\n\n        'Reached end of FCST ID's and no match -&gt; record ISS ID\n        If iRowFCST = 49 Then\n            Workbooks(\"Comparison.xlsm\").Sheets(\"Sheet1\").Range(\"A\" &amp; nextCell).Value = ID_ISS\n            Workbooks(\"Comparison.xlsm\").Sheets(\"Sheet1\").Range(\"B\" &amp; nextCell).Value = \"No corressponding Issue ID\"\n            nextCell = nextCell + 1\n            Exit For\n        End If\n\n    Next iRowFCST\nNext iRowISS\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1501699512, "post_id": 45468576, "comment_id": 77898297, "body": "Just make sure you add <code>cancel=true</code> so that someone will not go into an in-cell edit on the double-click."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1501700007, "creation_date": 1501700007, "answer_id": 45468859, "question_id": 45468576, "link": "https://stackoverflow.com/questions/45468576/vba-change-cell-to-become-double-click/45468859#45468859", "title": "VBA change cell to become double-click", "body": "<p>Start here:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Dim MySheet As String\n        On Error GoTo Done:\n        If Target.Column = 6 And Target.Cells.Count = 1 Then\n            Cancel = True\n            MySheet = WorksheetFunction.VLookup(Target.Offset(0, -2).Value, Sheets(\"ref_list\").Range(\"$C$1:$D$17\"), 2, 0)\n            Sheets(MySheet).Visible = True\n            Sheets(MySheet).Activate\n        End If\n\nDone:\n    Sheets(\"acct_codes\").Visible = 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 45468859, "answer_count": 1, "score": 0, "last_activity_date": 1501700147, "creation_date": 1501699075, "last_edit_date": 1501700147, "question_id": 45468576, "link": "https://stackoverflow.com/questions/45468576/vba-change-cell-to-become-double-click", "title": "VBA change cell to become double-click", "body": "<p>In a sheet I have in my workbook, there are cells in in the F column that turn red and when they're clicked once, it will pull up a sheet of values. I would like to change that to become, once cells in the F column are double-clicked, <strong>then</strong> will it pull up a sheet of values. This sheet is called \"JE\" and here is the code I have for it:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim MySheet As String\n    On Error GoTo Done:\n    If Target.Column = 6 And Target.Cells.Count = 1 Then\n        MySheet = WorksheetFunction.VLookup(Target.Offset(0, -2).Value, Sheets(\"ref_list\").Range(\"$C$1:$D$17\"), 2, 0)\n        Sheets(MySheet).Visible = True\n        Sheets(MySheet).Activate\n    End If\n\nDone:\nSheets(\"acct_codes\").Visible = 0\n\n\nEnd Sub\n</code></pre>\n\n<p>I believe I should make this sub to a \"before double click\" but I'm unsure if I can keep the code as is. Not totally sure how to complete this. </p>\n"}, {"tags": ["python", "excel", "pandas", "xlwings", "vba"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 8072061, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d6975c97c0f39b67966db8f83a1302ef?s=128&d=identicon&r=PG&f=1", "display_name": "jenkelblankel", "link": "https://stackoverflow.com/users/8072061/jenkelblankel"}, "edited": false, "score": 0, "creation_date": 1501782727, "post_id": 45490753, "comment_id": 77944032, "body": "testproj being name of project and world being name of python file. I&#39;ll give it a shot!"}, {"owner": {"reputation": 422, "user_id": 5050683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f05c2a273129f9e3e9e4c87b26f87a13?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Fitzhugh", "link": "https://stackoverflow.com/users/5050683/richard-fitzhugh"}, "reply_to_user": {"reputation": 145, "user_id": 8072061, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d6975c97c0f39b67966db8f83a1302ef?s=128&d=identicon&r=PG&f=1", "display_name": "jenkelblankel", "link": "https://stackoverflow.com/users/8072061/jenkelblankel"}, "edited": false, "score": 0, "creation_date": 1501782878, "post_id": 45490753, "comment_id": 77944131, "body": "testproj is the name of the Python file and world is the name of the function you want to execute from the file. The RunPython function will actually execute Python code, so the import statement there is working exactly as it would in a normal python file. Good luck!"}], "tags": [], "owner": {"reputation": 422, "user_id": 5050683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f05c2a273129f9e3e9e4c87b26f87a13?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Fitzhugh", "link": "https://stackoverflow.com/users/5050683/richard-fitzhugh"}, "is_accepted": true, "score": 2, "last_activity_date": 1501780569, "creation_date": 1501780569, "answer_id": 45490753, "question_id": 45468427, "link": "https://stackoverflow.com/questions/45468427/writing-a-vba-macro-to-call-a-python-script-using-xlwings/45490753#45490753", "title": "Writing a VBA macro to call a python script using xlwings", "body": "<p>If your Python script writes to the workbook directly, this is not difficult. First, you don't need to return anything from either the VBA macro or the Python if what you write to the workbook is sufficient for you.</p>\n\n<p>You don't need a UDF. All you need is the following (which I've basically copied from the xlwings official docs <a href=\"http://docs.xlwings.org/en/stable/vba.html\" rel=\"nofollow noreferrer\">here</a>):</p>\n\n<p>1) Make sure your excel book can talk to the file you have your script in (best done using the command <code>xlwings quickstart &lt;project_name&gt;</code> on the command line, then copying your script to the resulting Python file.</p>\n\n<p>2) Make sure you can call everything you need from a single function like <code>__main__()</code> (or be prepared to run execfile or something similar)</p>\n\n<p>3) Go to your excel book and make a command button, then assign it the macro SampleCall which xlwings has kindly provided for you</p>\n\n<p>4) Now open the VBA editor. You should see the SampleCall macro immediately:</p>\n\n<pre><code>Sub SampleCall()\n    RunPython (\"import testproj;testproj.world()\")\nEnd Sub\n</code></pre>\n\n<p>Just edit the names of <code>testproj</code> and <code>world</code> appropriately.</p>\n\n<p>You can now click your CommandButton to execute your script!</p>\n"}], "owner": {"reputation": 145, "user_id": 8072061, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d6975c97c0f39b67966db8f83a1302ef?s=128&d=identicon&r=PG&f=1", "display_name": "jenkelblankel", "link": "https://stackoverflow.com/users/8072061/jenkelblankel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "accepted_answer_id": 45490753, "answer_count": 1, "score": 1, "last_activity_date": 1501780569, "creation_date": 1501698524, "last_edit_date": 1531161705, "question_id": 45468427, "link": "https://stackoverflow.com/questions/45468427/writing-a-vba-macro-to-call-a-python-script-using-xlwings", "title": "Writing a VBA macro to call a python script using xlwings", "body": "<p>I want to write a VBA macro in Excel to call a python script. The python script will execute some commands then return a pandas dataframe. I have code that writes to the excel spreadsheet and that is inside the python script. </p>\n\n<p>I have installed xlwings and read through the VBA macro tutorial but am still confused. Should I use a User Defined Function? Do I need to \"return anything\" in the script? </p>\n"}, {"tags": ["string", "vba", "split"], "comments": [{"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501753368, "post_id": 45468255, "comment_id": 77921472, "body": "Hi can you rephrase n+1 or n. From what I understand theres a string with &#39;|&#39;. Your goal is to count occurences of &#39;|&#39; and also to get the strings separated from &#39;|&#39; is that correct?"}, {"owner": {"reputation": 245, "user_id": 2425113, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/45e99652c5740e8c2dbd75a9f8c11840?s=128&d=identicon&r=PG", "display_name": "Marie. P.", "link": "https://stackoverflow.com/users/2425113/marie-p"}, "reply_to_user": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501775059, "post_id": 45468255, "comment_id": 77938928, "body": "Yes, indeed. But I do not understand in what way you want me to rephrase <code>n</code> and <code>n+1</code>."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501775451, "post_id": 45468255, "comment_id": 77939204, "body": "Sorry not very good with notation, so I was confused. If your aim is to get the number of occurences of &quot;|&quot; then the answer below by braZ will give the right answer. vSplit will will store an array of the split words. Ubound will return the highest index number of the array. &quot;Test1|Test2&quot; will split into Array(Test1,Test2) with index [0,1] highest index will be 1 which is also the occurence of &quot;|&quot;. Ubound + 1 will return the number of strings, since highest index which is 1 +1 will equal 2, the index of arrays start at 0."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 2, "last_activity_date": 1501699124, "last_edit_date": 1501699124, "creation_date": 1501698141, "answer_id": 45468310, "question_id": 45468255, "link": "https://stackoverflow.com/questions/45468255/using-split-function-in-vba-to-find-how-often-a-text-contains-a-certain-symbol/45468310#45468310", "title": "Using `split` function in VBA to find how often a text contains a certain symbol", "body": "<p>Store the split in an array</p>\n\n<pre><code>Dim vSplit as Variant\nvSplit=Split(\"testone|testtwo\", \"|\")\n</code></pre>\n\n<p>then to get a count of how many items:</p>\n\n<p><code>nCount = UBound(vSplit) + 1</code></p>\n\n<p>If you want a count of how many \"|\" are in the string...</p>\n\n<p><code>nCount = UBound(vSplit)</code></p>\n"}], "owner": {"reputation": 245, "user_id": 2425113, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/45e99652c5740e8c2dbd75a9f8c11840?s=128&d=identicon&r=PG", "display_name": "Marie. P.", "link": "https://stackoverflow.com/users/2425113/marie-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501699124, "creation_date": 1501697906, "question_id": 45468255, "link": "https://stackoverflow.com/questions/45468255/using-split-function-in-vba-to-find-how-often-a-text-contains-a-certain-symbol", "title": "Using `split` function in VBA to find how often a text contains a certain symbol", "body": "<p>For a MWE, and to replicate my problem, in a blank workbook put the text</p>\n\n<pre><code>testone|testtwo\n</code></pre>\n\n<p>into the first cell, A1.</p>\n\n<p>Then, the VBA code shall be:</p>\n\n<pre><code>Sub test()\n\nMsgBox \"testone|testtwo\"\nMsgBox Cells(1, 1).Text\nMsgBox Split(\"testone|testtwo\", \"|\")\nMsgBox Split(Cells(1, 1).Text, \"|\")\nMsgbox Split(Cells(1, 1).Text, \"|\").Length\n\nEnd Sub\n</code></pre>\n\n<p>Now, already the second one gives me an error, type mismatch.</p>\n\n<p>What I need this for is that I am faced a potentially long string in which <code>n+1</code> substrings, of different lengths, are separated by <code>n</code> occurences of the symbol <code>|</code>. I need to extract each substring, i.e. those <code>n-1</code> within two instances of the symbol, and the two at the beginning. I believe, but am not certain, that the use of the <code>split</code>-function is best. In a next step, want to use the <code>Length</code> of the result to count the number of occurences of <code>|</code> (as in the last line), but that does not work either.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1501697337, "post_id": 45467818, "comment_id": 77896973, "body": "qualify all objects to their parents. No where in the code do you specify which <code>workbook</code> you want to work with. Also <code>Cells(i,4)</code> should be qualified to a worksheet (and the worksheet to a workbook)."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501709613, "post_id": 45467818, "comment_id": 77903807, "body": "When working with different sheets and specially workbooks its best practice and also required that you be explicit with your objects. Try fixing them first. Examples are Workbooks(&quot;B&quot;).WorkSheets(&quot;B&quot;).Range(&quot;A7&quot;) or Workbooks(&quot;A&quot;).WorkSheets(&quot;A&quot;)"}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1501786295, "post_id": 45467818, "comment_id": 77945983, "body": "@ScottHoltzman  Made changes, please take a look"}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "reply_to_user": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501786358, "post_id": 45467818, "comment_id": 77946037, "body": "@fcsr Thanks for the input, made the changes"}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501786421, "post_id": 45467818, "comment_id": 77946071, "body": "are you still getting an error?"}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501838854, "post_id": 45467818, "comment_id": 77966743, "body": "on the line with the error, edit the second arguement <code>And Cells(i, 5) = y) Then</code> , also add the Application.Workbooks(&quot;Main.csv&quot;).Worksheets(&quot;Main&quot;). Complete the object and try again"}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "reply_to_user": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1501854293, "post_id": 45467818, "comment_id": 77977677, "body": "@fcsr I edited it but still getting the error If Application.Workbooks(&quot;Main.csv&quot;).Worksheets(&quot;Main&quot;).Range(C&zwnj;&#8203;ells(i, 4) = x) And Application.Workbooks(&quot;Main.csv&quot;).Worksheets(&quot;Main&quot;).Range(C&zwnj;&#8203;ells(i, 5) = y) Then"}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1501711227, "creation_date": 1501711227, "answer_id": 45471724, "question_id": 45467818, "link": "https://stackoverflow.com/questions/45467818/data-extraction-based-on-given-criteria-using-vba/45471724#45471724", "title": "Data extraction based on given criteria using VBA", "body": "<p>I don't believe there's a method in the Range class called .ClearData. Did you mean <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-clearcontents-method-excel\" rel=\"nofollow noreferrer\">ClearContents</a>? This will clear all values from the specified cells.</p>\n\n<pre><code>Sub fetchdata()\n    Dim x As Integer 'Coordinates that need to be fetched\n    Dim y As Integer\n    Dim finalrow As Integer\n    Dim i As Integer\n\n    ActiveSheet.Range(\"D2:D10000\").ClearContents\n    x = Sheets(\"Sheet2\").Range(\"A2\").Value\n    y = Sheets(\"Sheet2\").Range(\"B2\").Value\n    finalrow = Sheets(\"Book1\").Range(\"D10000\").End(xlUp).Row\n\n    For i = 7 To finalrow\n        If Cells(i, 4) = x And Cells(i, 5) = y Then\n            Sheets(\"Book1\").Range(Cells(i, 1), Cells(i, 221)).Copy\n            Sheets(\"Sheet2\").Range(\"D10000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n        End If\n    Next i\n End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502205408, "post_id": 45523548, "comment_id": 78103681, "body": "It ran without errors but there wasn&#39;t any change reflected on the files. They seem to be the same."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502205522, "post_id": 45523548, "comment_id": 78103764, "body": "Application.Workbooks(&quot;Main.csv&quot;).Worksheets(&quot;Main&quot;).Range(&quot;&zwnj;&#8203;F7&quot;) this line is not dynamic, the code will paste on this cell everytime"}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502206815, "post_id": 45523548, "comment_id": 78104694, "body": "I only tried to answer your existing question about the error, and I didnt really go through the entire logic of the code"}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502212486, "post_id": 45523548, "comment_id": 78108141, "body": "youve made it more complicated than it originally was, you should think about the naming conventions of the files you will use, if main will be one file and there will be multiple site files. there are ways in vba to loop through file using wildcards, so all file with site will get processed. but will you have multiple main and site files in different folders? how will you associate main files to site files etc. I can help you but you need to be even more specific, as hard that it may sound"}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502298700, "post_id": 45523548, "comment_id": 78153097, "body": "I&#39;m sorry about the complication but such is the task that I&#39;m trying to accomplish. So, there is one &quot;Site&quot; file and multiple &quot;main&quot; files."}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502299254, "post_id": 45523548, "comment_id": 78153401, "body": "Also, the name &#39;main&#39; is just a sample; the files are usually named as part numbers (alphanumerics eg.1531-1700829PXQW). So &quot;site&quot; is a fixed name and a single file (mostly just acting as a reference) and &#39;main&#39; is the file which will be changed. But the name &#39;main&#39; is just an example, there are lots of files like &#39;main&#39;(similar content) but their file name is a part number."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502359115, "post_id": 45523548, "comment_id": 78179254, "body": "please try new code, this is just a trial or proof of concept, this is a very basic and repetitive code, this can be much elegant and simple but for testing this will do. try it by opening main and site, then paste this macro in a new workbook module"}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502465422, "post_id": 45523548, "comment_id": 78237058, "body": "Works like an absolute charm. Thanks! Is there a way to automate this process for every file (like &quot;main&quot;) in a directory?"}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502465648, "post_id": 45523548, "comment_id": 78237200, "body": "there is actually, but i wanted you to try it out first on one file. I&#39;ll update my answer with the loop"}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1502979636, "post_id": 45523548, "comment_id": 78433051, "body": "The code is working but I&#39;m not able to get the auto save and close function working. I Tweaked the code a bit in this line : Set main_sh = main.ActiveSheet &#39;name of sheet ex Main sheet in Main workbook"}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1503002789, "post_id": 45523548, "comment_id": 78446744, "body": "There is no error. But as the code runs, each &lt;main&gt; file is opened and the save dialog box is displayed. So I have to manually select save for each file. I know that the ActiveWorkbook.Save and ActiveWorkbook.Close functions are supposed to prevent this from happening but for some reason they don&#39;t seem to take effect.   But the code in general works perfect."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1503013925, "post_id": 45523548, "comment_id": 78450481, "body": "Are the main files ready only? Or are they a different file format than excel format? Like csv is a different format"}], "tags": [], "owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "is_accepted": true, "score": 0, "last_activity_date": 1502472164, "last_edit_date": 1502472164, "creation_date": 1501946734, "answer_id": 45523548, "question_id": 45467818, "link": "https://stackoverflow.com/questions/45467818/data-extraction-based-on-given-criteria-using-vba/45523548#45523548", "title": "Data extraction based on given criteria using VBA", "body": "<p>Hi your errors are in these lines:</p>\n\n<p><code>.Range(Cells(i, 4)       I removed Range()</code></p>\n\n<p><code>= y)       I removed \")\"</code></p>\n\n<p><code>Range(Cells(i - 5, 3))     I removed Range()</code></p>\n\n<p>Below code should work</p>\n\n<pre><code>Option Explicit\n\nSub fetchdata()\n\nDim x As Integer\nDim y As Integer\nDim finalrow As Long\nDim i As Integer\n\nDim LastRow As Long\n\nx = Application.Workbooks(\"Site.csv\").Worksheets(\"Site\").Range(\"A2\").Value 'Stores the x-coordinate of the Site file which contains the list of required coordinates\n\ny = Application.Workbooks(\"Site.csv\").Worksheets(\"Site\").Range(\"B2\").Value\n\nfinalrow = Application.Workbooks(\"Main.csv\").Worksheets(\"Main\").Range(\"D70000\").End(xlUp).Row 'Stores the row detail of the last row in the Main file\n\nFor i = 7 To finalrow\n    If Application.Workbooks(\"Main.csv\").Worksheets(\"Main\").Cells(i, 4) = x And Cells(i, 5) = y Then 'ERROR IDENTIFIED HERE\n        Application.Workbooks(\"Site.csv\").Worksheets(\"Site\").Cells(i - 5, 3).Copy\n        Application.Workbooks(\"Main.csv\").Worksheets(\"Main\").Range(\"F7\").PasteSpecial xlPasteFormulasAndNumberFormats 'Here I basically want to replace the existing site number with that in my reference file (site.csv)\n\n    Else\n        Application.Workbooks(\"Main.csv\").Worksheets(\"Main\").Rows(i).EntireRow.Delete 'Delete Everything else\nEnd If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><strong>New code as of 08/12 with directory loop:</strong></p>\n\n<pre><code>Sub fetchdata()\n\nDim x As Integer\nDim y As Integer\nDim finalrow As Long\nDim i As Integer\nDim site As Workbook\nDim main As Workbook\nDim site_sh As Worksheet\nDim main_sh As Worksheet\nDim LastRow As Long\nDim finalrow_main, finalrow_site, i_site, i_main, site_val_x, site_val_y, main_val_x, main_val_y As Variant\nDim criteria As String\nDim delete_row As Boolean\nDim MyObj As Object, MySource As Object, file As Variant\nDim file_path, list_file, final_message As String\n\n\nfile_path = \"C:\\Users\\u6042371\\Documents\" 'Set directory for \"Main\" file types here\n\nIf Right(file_path, 1) &lt;&gt; \"\\\" Then file_path = file_path &amp; \"\\\"\n\nlist_file = \"\" 'this will store a file list for later\n\ncriteria = \"main*.xls\" 'this will search for all files beginning with main ending with .xls, you can use * as a wildcard, just change main\n\nfile = Dir(file_path &amp; criteria)\n\nWhile (file &lt;&gt; \"\")\n\n    Workbooks.Open Filename:=file_path &amp; file\n\n    Set main = Workbooks(file) 'will auto open\n    Set site = Workbooks(\"Site.xlsx\") 'manual open this workbook\n    Set main_sh = main.Worksheets(\"Main\") 'name of sheet ex Main sheet in Main workbook\n    Set site_sh = site.Worksheets(\"Site\") 'name of sheet ex Site sheet in Site workbook\n\n    finalrow_main = main_sh.Range(\"D70000\").End(xlUp).Row 'gets last row of Main Sheet\n    finalrow_site = site_sh.Range(\"A70000\").End(xlUp).Row 'gets last row of Site Sheet\n    delete_row = False 'flag if to delete row at the end of for loop\n\n    For i_main = finalrow_main To 7 Step -1 'to loop through all Main x, y, this looks through end to start of data, delete technique\n        main_val_x = main_sh.Cells(i_main, 4).Value 'set x value of current row of Main sheet\n        main_val_y = main_sh.Cells(i_main, 5) 'set y value of current row of Main sheet\n\n\n        For i_site = 2 To finalrow_site 'to loop through all Site x,y starts at the beginning of site\n            site_val_x = site_sh.Cells(i_site, 1) 'set x value of current row of Site sheet\n            site_val_y = site_sh.Cells(i_site, 2) 'set y value of current row of Site sheet\n\n\n            If site_val_x = main_val_x And site_val_y = main_val_y Then 'compares x,y from Site to x,y from Main\n                main_sh.Cells(i_main, 6) = site_sh.Cells(i_site, 3)\n\n                delete_row = False 'Set delete to false because there has been a match\n                Exit For 'Exits loop to check next site row\n            Else\n                delete_row = True 'if there are no matches this will become True\n\n            End If\n\n        Next i_site\n\n        If delete_row = True Then 'if delete = True then delete\n            main_sh.Rows(i_main).Delete\n        End If\n\n\n\n    Next i_main\n\n    Workbooks(file).Save\n    Workbooks(file).Close\n    list_file = list_file + file + Chr(13)\n\n    file = Dir\n\n\nWend\n\nfinal_message = \"The following files have been processed:\" + Chr(13) + list_file\nMsgBox final_message\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 0, "accepted_answer_id": 45523548, "answer_count": 2, "score": 1, "last_activity_date": 1502472164, "creation_date": 1501696378, "last_edit_date": 1531164843, "question_id": 45467818, "link": "https://stackoverflow.com/questions/45467818/data-extraction-based-on-given-criteria-using-vba", "title": "Data extraction based on given criteria using VBA", "body": "<p>EDIT: Thanks for the help before, I have made the changes in the code and edited my question (including some references like A &amp; B) so that it's easier to understand now. </p>\n\n<p>I have a multiple files in a folder with a lot of columns, lets call one these files \"main.csv\". There are 2 columns in \"main\" which contain X and Y coordinates. On another file called \"site.csv\", I have a list of the <em>required</em> X and Y coordinates and their <strong>Site#</strong>\nI made a VBA to:</p>\n\n<p>1)Keep in the \"main\" file, only the rows which match the X and Y coordinates in \"B\" AND also update a column called 'Site' in the main file with that in the \"site.csv\" file (screenshot attached)</p>\n\n<p>2) Delete all the rest</p>\n\n<p><strong><em>And if possible</em></strong>  (Because I dont know how to code for this)\n-> Make this VBA loop thru all the files (like\"main.csv\") in the folder as there are a LOT of them. The reference file is the same -\"site.csv\"</p>\n\n<p>Screenshots:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pXeNH.jpg\" rel=\"nofollow noreferrer\">Main.csv file </a></p>\n\n<p><a href=\"https://i.stack.imgur.com/fUfqh.jpg\" rel=\"nofollow noreferrer\">Site.csv file - Reference file</a></p>\n\n<p>So far I'm getting the following error:</p>\n\n<p>Run-time error '1004': Application-defined or object-defined error (Location as VBA comment)</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Option Explicit\n\nSub fetchdata()\n\nDim x As Integer\nDim y As Integer\nDim finalrow As Long\nDim i As Integer\n\nDim LastRow As Long\n\nx = Application.Workbooks(\"Site.csv\").Worksheets(\"Site\").Range(\"A2\").Value 'Stores the x-coordinate of the Site file which contains the list of required coordinates\n\ny = Application.Workbooks(\"Site.csv\").Worksheets(\"Site\").Range(\"B2\").Value\n\nfinalrow = Application.Workbooks(\"Main.csv\").Worksheets(\"Main\").Range(\"D70000\").End(xlUp).Row 'Stores the row detail of the last row in the Main file\n\nFor i = 7 To finalrow\n    If Application.Workbooks(\"Main.csv\").Worksheets(\"Main\").Range(Cells(i, 4) = x And Cells(i, 5) = y) Then 'ERROR IDENTIFIED HERE\n        Application.Workbooks(\"Site.csv\").Worksheets(\"Site\").Range(Cells(i - 5, 3)).Copy\n        Application.Workbooks(\"Main.csv\").Worksheets(\"Main\").Range(\"F7\").PasteSpecial xlPasteFormulasAndNumberFormats 'Here I basically want to replace the existing site number with that in my reference file (site.csv)\n\n    Else\n        Application.Workbooks(\"Main.csv\").Worksheets(\"Main\").Rows(i).EntireRow.Delete 'Delete Everything else\nEnd If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "button"], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501697372, "post_id": 45468078, "comment_id": 77896997, "body": "Should my buttons be a certian name?"}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501697402, "post_id": 45468078, "comment_id": 77897019, "body": "I have two users forms and I only want the buttons on the second one to take effect."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501697483, "post_id": 45468078, "comment_id": 77897068, "body": "you only need to give your buttons a certain name IF you want to subset them somehow.  The current code will add <i>all</i> command buttons on the form to a single event."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501697514, "post_id": 45468078, "comment_id": 77897097, "body": "also, the collection is limited to the scope of the form.  So you should be good."}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501697527, "post_id": 45468078, "comment_id": 77897104, "body": "Great I will try!"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501697550, "post_id": 45468078, "comment_id": 77897118, "body": "great! let me know how it turns out and we&#39;ll go from there :)"}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501697706, "post_id": 45468078, "comment_id": 77897208, "body": "how would I switch from userform1 to userform2 with the click of a button?"}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501697897, "post_id": 45468078, "comment_id": 77897323, "body": "When running your code I get <code>compile error: user-defined type not defined</code>. What should I do. I put the class in a class module and your code in my userform2 @sous2817"}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501698333, "post_id": 45468078, "comment_id": 77897589, "body": "And know it is vba"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501698824, "post_id": 45468078, "comment_id": 77897891, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/150858/discussion-between-sous2817-and-brendan\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1501724171, "post_id": 45468078, "comment_id": 77907666, "body": "the class module must be manually renamed ButtonClass, or it wont&#180;t work. Go left it the property window of the class in vbe, and change the name property."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1501724360, "post_id": 45468078, "comment_id": 77907704, "body": "I&#39;m not quite sure I follow.  The code I posted works just fine, but if changing to to upper case works for you, that&#39;s all that matters."}], "tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": true, "score": 3, "last_activity_date": 1501726614, "last_edit_date": 1501726614, "creation_date": 1501697280, "answer_id": 45468078, "question_id": 45467809, "link": "https://stackoverflow.com/questions/45467809/200-buttons-all-changing-one-textbox-vba-excel/45468078#45468078", "title": "200 Buttons All Changing One TextBox - VBA Excel", "body": "<p>Here is how I'd approach it.  First add a class module and call it <code>buttonClass</code>:</p>\n\n<pre><code>Option Explicit\n\n    Public WithEvents aCommandButton As msforms.CommandButton\n\n    Private Sub aCommandButton_Click()\n         MsgBox aCommandButton.Name &amp; \" was clicked\"\n    End Sub\n</code></pre>\n\n<p>Then in your userform initiation event, use code similar to:</p>\n\n<pre><code>Dim myButtons() As buttonClass\n\nPrivate Sub UserForm_Initialize()\n    Dim ctl As Object, pointer As Long\n        ReDim myButtons(1 To Me.Controls.Count)\n\n            For Each ctl In Me.Controls\n                If TypeName(ctl) = \"CommandButton\" Then\n                    pointer = pointer + 1\n                    Set myButtons(pointer) = New buttonClass\n                    Set myButtons(pointer).aCommandButton = ctl\n                End If\n            Next ctl\n\n        ReDim Preserve myButtons(1 To pointer)\n\nEnd Sub\n</code></pre>\n\n<p>This will wire up all of your command buttons to display their name on click.  You can tweak the logic in the buttonClass to be fancier.  Or you can tweak the logic in the initialize event to include on certain buttons (expanding on the \"If\" part). </p>\n\n<p>Hope that helps!</p>\n"}, {"tags": [], "owner": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "is_accepted": false, "score": 0, "last_activity_date": 1501697285, "creation_date": 1501697285, "answer_id": 45468079, "question_id": 45467809, "link": "https://stackoverflow.com/questions/45467809/200-buttons-all-changing-one-textbox-vba-excel/45468079#45468079", "title": "200 Buttons All Changing One TextBox - VBA Excel", "body": "<p>If i was going to do this (and I'm not sure I would), I would create and populate each button through a loop, which also set up a link to one event handler which could determine what to do.</p>\n\n<p>If each button is created manually and already exist, then I think you need to update them manually.</p>\n\n<p>Another possibility, is to catch another higher-level event such as mouse click and then, from the information provided by that event, work out which button was pressed.</p>\n"}], "owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 45468078, "answer_count": 2, "score": 3, "last_activity_date": 1501726614, "creation_date": 1501696346, "last_edit_date": 1501696799, "question_id": 45467809, "link": "https://stackoverflow.com/questions/45467809/200-buttons-all-changing-one-textbox-vba-excel", "title": "200 Buttons All Changing One TextBox - VBA Excel", "body": "<p>I have a VBA Excel application with about 200ish buttons. I want them all to change one textbox called \"Name\" with the caption of the button pressed. I did blur some stuff from the image as these boxes are all real peoples name. How can I do this without having to create 200+ functions?</p>\n\n<p>An example is let's say I have 3 buttons. The three values are <code>foo1</code>, <code>foo2</code>, and <code>foo3</code>. When I click any of the buttons, let's say I click <code>foo2</code>, I want the TextBox to update the value to <code>foo2</code>. I know how to do this but how do I do it without having to manually write a function for all 3 buttons. The textbox value will always be the button value. Now imagine it is 200+ buttons.</p>\n\n<p>Thanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/HxQXa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HxQXa.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "userform"], "answers": [{"tags": [], "owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "is_accepted": true, "score": 0, "last_activity_date": 1501698028, "creation_date": 1501698028, "answer_id": 45468291, "question_id": 45467686, "link": "https://stackoverflow.com/questions/45467686/having-challenges-to-code-command-button-on-ms-excel-vba/45468291#45468291", "title": "Having challenges to code command button on MS Excel VBA", "body": "<p>So here is my code</p>\n\n<p><strong>Userform1 Layout</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xuXNc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xuXNc.png\" alt=\"enter image description here\"></a></p>\n\n<p>notes: there's a PasswordChar property in Textbox1, set it to * so that people won't see the password being typed.</p>\n\n<p><strong>Code for your Command Button on the module:</strong></p>\n\n<p>This will show the userform for password verification.</p>\n\n<pre><code>Sub Button1_Click()\n\nUserForm1.Show\n\nEnd Sub\n</code></pre>\n\n<p><strong>Code for Userform1</strong></p>\n\n<p>This is where you assign your password to the Password Variable.</p>\n\n<p>Command Button1, this will check if Password in textbox1 is same as password stored. if its the same it unprotects the sheet with additional message and if not the same then it will msgbox \"incorrect password\"</p>\n\n<p>Command Button2 will be your cancel button, this will hide the userform1</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nPassword = \"yourpassword\"\n\nIf UserForm1.TextBox1.Value = Password Then\n    Worksheets(\"Sheet2\").Unprotect (Password)\n    'this is for unprotecting sheets\n    'or you can also use it to show Userform2\n    MsgBox \"Sheet now unprotected or Userform2 now shows\"\n    UserForm1.Hide\n    Userform2.Show\n\nElse\n    MsgBox \"Incorrect Password\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>For CommandButton 2</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nUserForm1.Hide\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8407185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c09030e354e9b7078d93501d70c043?s=128&d=identicon&r=PG&f=1", "display_name": "EvansID", "link": "https://stackoverflow.com/users/8407185/evansid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 45468291, "answer_count": 1, "score": 0, "last_activity_date": 1501707650, "creation_date": 1501695901, "last_edit_date": 1501707650, "question_id": 45467686, "link": "https://stackoverflow.com/questions/45467686/having-challenges-to-code-command-button-on-ms-excel-vba", "title": "Having challenges to code command button on MS Excel VBA", "body": "<p>I am new to VBA.</p>\n\n<p>I have a worksheet that is protected/locked with a password.</p>\n\n<p>I have a CommandButton that, when clicked loads a UserForm that is used to enter records into the worksheet.</p>\n\n<p>I want it in such a way that when the CommandButton is clicked, it will prompt the user to enter the unprotect password (used to protect/lock the worksheet), before the UserForm loads.</p>\n\n<p>If the user enters the correct unprotect password, then the UserForm loads. If the user enters the incorrect unprotect password, a MsgBox displays and the UserForm will not load.</p>\n\n<p>The problem is when the CommandButton is clicked, the user will be prompted to enter the unprotect password (Excel's Built-In Unprotect dialog), if the user clicks the \"Cancel\" button, the UserForm still loads. This is not what i want. What i want is: If the \"Cancel\" button is clicked, the MsgBox displays, and the UserForm does NOT load. </p>\n\n<p>Below is my code for the CommandButton:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    On Error Resume Next\n    ActiveSheet.Unprotect\n    If Err &lt;&gt; 0 Then\n    MsgBox:\n        MsgBox \"Incorrect Password. Unlock Failed!\"\n    Else\n        UserForm3.Show\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1501696133, "post_id": 45467683, "comment_id": 77896215, "body": "For completeness, you might want to update your example to show how to retrieve a field value."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1501696152, "post_id": 45467683, "comment_id": 77896231, "body": "I was stuck staring at my code so long I guess it turned to latin. I was using <code>rst.next</code> instead of <code>rst.MoveNext</code>. I will try this. Thank you!"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1501696550, "last_edit_date": 1501696550, "creation_date": 1501695894, "answer_id": 45467683, "question_id": 45467652, "link": "https://stackoverflow.com/questions/45467652/looping-through-a-recordset-to-retrieve-values/45467683#45467683", "title": "Looping through a recordset to retrieve values", "body": "<p>Here is how I do it.</p>\n\n<pre><code>Dim sValue As String\nDo until rst.EOF\n  sValue=rst!FieldName\n\n  ' do other stuff\n\n  rst.MoveNext\nLoop\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594650956, "creation_date": 1501695779, "last_edit_date": 1594650956, "question_id": 45467652, "link": "https://stackoverflow.com/questions/45467652/looping-through-a-recordset-to-retrieve-values", "title": "Looping through a recordset to retrieve values", "body": "<pre><code>returnAddress = \"SELECT Address_ID FROM Address_Bridge WHERE Customer_ID = \n76541 AND Company_ID = 23540\"\n\nset db = currentDB\nset rst = db.openRecordSet(returnAddress)\n</code></pre>\n\n<p>This is my recordset. It returns all address IDs for a specific combination of Customer and Company. I anticipate there being anywhere from 1 to 7 Address IDs being returned by this recordset. I need to use each of them as values in an Append query. I'm just not sure how to access them.</p>\n\n<pre><code>For Each Address_ID in rst\n    perform update query\nnext\n</code></pre>\n\n<p>That's my assumption of how to do it, but I've tried several variations and all have returned errors. If anyone could assist me with the specific syntax for this, it would really be appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1501695342, "post_id": 45467498, "comment_id": 77895721, "body": "<code>Tag.Text = Tag.Text &amp; &quot;1&quot;</code>?"}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1501695411, "post_id": 45467498, "comment_id": 77895772, "body": "Nope. Tried that @BruceWayne"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501695419, "post_id": 45467498, "comment_id": 77895776, "body": "You probably should call your textbox something else like <code>txtTag</code>. You may be confusing the compiler because <code>Tag</code> could be a reserved word."}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501695474, "post_id": 45467498, "comment_id": 77895815, "body": "That was it @braX, post an answer below and  I will accept it! I changed it to Asset as it is an asset tag and it works!"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1501695553, "creation_date": 1501695553, "answer_id": 45467583, "question_id": 45467498, "link": "https://stackoverflow.com/questions/45467498/tag-named-tag-gives-invalid-qualifier-error-vba-excel/45467583#45467583", "title": "Tag Named &quot;Tag&quot; Gives Invalid Qualifier Error - VBA Excel", "body": "<p>You probably should call your textbox something else like <code>txtTag</code>. You may be confusing the compiler because <code>Tag</code> is a reserved word.</p>\n"}], "owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 45467583, "answer_count": 1, "score": 0, "last_activity_date": 1505236506, "creation_date": 1501695294, "last_edit_date": 1505236506, "question_id": 45467498, "link": "https://stackoverflow.com/questions/45467498/tag-named-tag-gives-invalid-qualifier-error-vba-excel", "title": "Tag Named &quot;Tag&quot; Gives Invalid Qualifier Error - VBA Excel", "body": "<p>In VBA Excel, I am trying to change the text of TextBox <code>Tag</code> and replace it with the same text but add a number to the end.</p>\n\n<p>Can someone please point me in the right direction? \n<strong>This is my code:</strong></p>\n\n<pre><code>Private Sub One1_Click()\n    Tag.Text = Tag.Text &amp; \"1\"\nEnd Sub\n</code></pre>\n\n<p>The current <code>Tag.Text</code> is \"iLD\". I want to change it to <code>iLD1</code> when I click on button <code>One1</code>.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "bigdata", "vba"], "comments": [{"owner": {"reputation": 2713, "user_id": 6611487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/m9imL.jpg?s=128&g=1", "display_name": "boop_the_snoot", "link": "https://stackoverflow.com/users/6611487/boop-the-snoot"}, "edited": false, "score": 1, "creation_date": 1501695091, "post_id": 45467272, "comment_id": 77895600, "body": "Have you tried anything by yourself yet?? If not, simply googling your problem or asking a question here won&#39;t help!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1501855569, "post_id": 45467272, "comment_id": 77978762, "body": "I&#39;d suggest filtering  your data to each individual, copying that data to a second sheet, removing the duplicates and then getting the sample.  So try searching &quot;excel vba filter&quot;, &quot;excel vba removeduplicates&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "is_accepted": false, "score": 0, "last_activity_date": 1502201208, "last_edit_date": 1502201208, "creation_date": 1501855692, "answer_id": 45508949, "question_id": 45467272, "link": "https://stackoverflow.com/questions/45467272/sample-extraction-from-excel-dump/45508949#45508949", "title": "Sample extraction from Excel dump", "body": "<p>Here is what you need to do:</p>\n\n<ul>\n<li><p>first, <strong>find a way to read the dump file</strong>. Read the 50 first lines and load them to a new file. If you do not manage to do this and get error, open a new question and show us your code</p></li>\n<li><p>second, <strong>evaluation function</strong>: <strike>calculate the ratio per person, store it somewhere, a simple tab might be handy for a start but slow, and create a function to which you'll give a person name, and will return true/false depending on the person's name with probability (same as above, write something and come back to us with factual issue)</strike>  you can use a random value between 0 and 1, and if it is above threshold <code>[desired sample size]/[number of lines]</code>, then add to sample file: no need for an evaluation function, the more occurrences of the user you have in the original file you have, the more you have in the result sample.</p></li>\n<li><p>then your good, you <strong>read every line, call above function</strong> on person's name you find on the file, and if function return's true, you add the line to sample file.</p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8405566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588d7bbbe351e200770129f894781098?s=128&d=identicon&r=PG&f=1", "display_name": "Vinayak Telkar", "link": "https://stackoverflow.com/users/8405566/vinayak-telkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505454319, "creation_date": 1501694496, "last_edit_date": 1531164843, "question_id": 45467272, "link": "https://stackoverflow.com/questions/45467272/sample-extraction-from-excel-dump", "title": "Sample extraction from Excel dump", "body": "<p>I want to extract data from a dump excel file as sampling. Dump file has around 20,000,00 lines which includes duplicates entries as well and I want 500 unique samples out of dump file. Data should be extracted proportionately as per each line processed. (e.g. if person A has processed 1500 lines, sampling data extracted for person A should be proportionate to his processed lines and sampling data size i.e 500).</p>\n\n<p>Can anyone help me with automation VBA coding for this, I searched a lot on google to find a solution could not get any details. Also manual extraction of data takes around 4 to 5 hours.</p>\n"}, {"tags": ["excel", "copy-paste", "worksheet-function", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501695093, "post_id": 45467239, "comment_id": 77895601, "body": "Don&#39;t select the worksheet just to copy from it. Instead of four lines, just: <code>wb.Worksheets(&quot;Outcomes &amp; Factors Rankings&quot;).Range(&quot;A3&quot;, Range(&quot;A3&quot;).End(xlDown).Offset(0, 6)).Copy Destination:= ThisWorkbook.Worksheets(&quot;OutcomeFactorRankings&quot;).Select Range(&quot;A1&quot;).End(xlDown).Offset(1, 0)</code>"}, {"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501695335, "post_id": 45467239, "comment_id": 77895720, "body": "now error is: &quot;unable to get the select worksheet property.&quot; Never experienced this before."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501695426, "post_id": 45467239, "comment_id": 77895783, "body": "Apologies. I left an errant SELECT in there: <code>wb.Worksheets(&quot;Outcomes &amp; Factors Rankings&quot;).Range(&quot;A3&quot;, Range(&quot;A3&quot;).End(xlDown).Offset(0, 6)).Copy Destination:= ThisWorkbook.Worksheets(&quot;OutcomeFactorRankings&quot;).Range(&quot;A1&quot;)&zwnj;&#8203;.End(xlDown).Offset(&zwnj;&#8203;1, 0)</code>"}, {"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501695541, "post_id": 45467239, "comment_id": 77895859, "body": "now it is Application defined or Object defined error. Thank you so much by the way"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1501695737, "post_id": 45467239, "comment_id": 77895964, "body": "That makes sense. So that <code>Range(&quot;A3&quot;).End(xlDown)...</code> bit needs to be qualified to which workbook/worksheet that range should exist in. So the statement grows: <code>wb.Worksheets(&quot;Outcomes &amp; Factors Rankings&quot;).Range(&quot;A3&quot;, wb.Worksheets(&quot;Outcomes &amp; Factors Rankings&quot;).Range(&quot;A3&quot;).End(xlDown).Offset(0, 6)).Copy Destination:= ThisWorkbook.Worksheets(&quot;OutcomeFactorRankings&quot;).Range(&quot;A1&quot;)&zwnj;&#8203;\u200c\u200b.End(xlDown).Offse&zwnj;&#8203;t(\u200c\u200b1, 0)</code>  That&#39;s pretty long, but it should do the trick. You can also split this into two lines of code like the 1 answer below (which suffers from the same problem as my previous comment)."}, {"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501696597, "post_id": 45467239, "comment_id": 77896504, "body": "any idea how I would get to the next file in the folder now?"}], "answers": [{"comments": [{"owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "edited": false, "score": 0, "creation_date": 1501695646, "post_id": 45467535, "comment_id": 77895903, "body": "Will indent next time. But I get an error, Application defined or Object defined error. On the wb.WorkSheets()....Copy line"}], "tags": [], "owner": {"reputation": 650, "user_id": 7857786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbefe9a0dc20a7f973a96b4ee74045f?s=128&d=identicon&r=PG&f=1", "display_name": "maaajo", "link": "https://stackoverflow.com/users/7857786/maaajo"}, "is_accepted": true, "score": 1, "last_activity_date": 1501695403, "creation_date": 1501695403, "answer_id": 45467535, "question_id": 45467239, "link": "https://stackoverflow.com/questions/45467239/copy-and-paste-across-folders-in-a-loop-with-vba/45467535#45467535", "title": "Copy and Paste across Folders in a loop with VBA", "body": "<p>Try to indent your code, you don't need all those selects in your code, simplify, something like that should solve your problem:</p>\n\n<pre><code>folderPath = \"insert folder path here\"\n    Filename = Dir(folderPath)\n\n    Do While Filename &lt;&gt; \"\"\n        Set wb = Workbooks.Open(folderPath &amp; Filename)\n        wb.Worksheets(\"Outcomes &amp; Factors Rankings\").Range(\"A3\", Range(\"A3\").End(xlDown).Offset(0, 6)).Copy\n        ThisWorkbook.Worksheets(\"OutcomeFactorRankings\").Range(\"A1\").End(xlDown).Offset(1, 0).Paste\n        wb.Close\n    Loop\n</code></pre>\n"}], "owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 45467535, "answer_count": 1, "score": 0, "last_activity_date": 1501695403, "creation_date": 1501694392, "last_edit_date": 1531164843, "question_id": 45467239, "link": "https://stackoverflow.com/questions/45467239/copy-and-paste-across-folders-in-a-loop-with-vba", "title": "Copy and Paste across Folders in a loop with VBA", "body": "<p>I am trying to write a loop that copies and pastes a range of data from one workbook to another. I get stuck with the error <code>'Select Sheet method not proper'</code> or whatever the error message is. This is what I have so far:</p>\n\n<pre><code>folderpath=\"insert folder path here\"\nFilename = Dir(folderPath)\nDo While Filename &lt;&gt; \"\"\n\nSet wb = Workbooks.Open(folderPath &amp; Filename)\n\nwb.Worksheets(\"Outcomes &amp; Factors Rankings\").Select\nRange(\"A3\", Range(\"A3\").End(xlDown).Offset(0, 6)).Copy\nThisWorkbook.Worksheets(\"OutcomeFactorRankings\").Select\nRange(\"A1\").End(xlDown).Offset(1, 0).Select.Paste\n\nwb.Close\n\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1501694732, "post_id": 45467179, "comment_id": 77895424, "body": "Latest patch to Office 2016 added Auto Save to Excel for stuff stored on One Drive btw."}, {"owner": {"reputation": 441, "user_id": 3317564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28372b38f98eb9d94c7cc713737d688?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Wijninckx", "link": "https://stackoverflow.com/users/3317564/jan-wijninckx"}, "edited": false, "score": 0, "creation_date": 1559814407, "post_id": 45467179, "comment_id": 99540268, "body": "In addition, recently they added the history and now there is a stream of BeforeSave events"}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": true, "score": 1, "last_activity_date": 1501711551, "creation_date": 1501711551, "answer_id": 45471783, "question_id": 45467179, "link": "https://stackoverflow.com/questions/45467179/autosave-all-excel-files-every-x-minutes/45471783#45471783", "title": "Autosave ALL Excel Files Every X Minutes", "body": "<p>Just loop through the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224505(v=office.11).aspx\" rel=\"nofollow noreferrer\">workbooks</a> collection:</p>\n\n<pre><code>Application.DisplayAlerts = False\nFor w = 1 to Workbooks.Count\n     Workbooks(w).Save\nNext w\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8185191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1805b84ba982b94e4dff55c3726ded7e?s=128&d=identicon&r=PG&f=1", "display_name": "R Quade", "link": "https://stackoverflow.com/users/8185191/r-quade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1034, "favorite_count": 0, "accepted_answer_id": 45471783, "answer_count": 1, "score": 1, "last_activity_date": 1501711551, "creation_date": 1501694207, "question_id": 45467179, "link": "https://stackoverflow.com/questions/45467179/autosave-all-excel-files-every-x-minutes", "title": "Autosave ALL Excel Files Every X Minutes", "body": "<p>I know there is a way to save one file every x minutes by defining it in the file's modules or Worksheets. Here is a code I found:</p>\n\n<pre><code>Sub SaveThis()\nApplication.DisplayAlerts = False\nActiveWorkbook.Save\nApplication.DisplayAlerts = True\n\nApplication.OnTime Now + TimeValue(\"00:05:00\"), \"SaveThis\"\nEnd Sub\n</code></pre>\n\n<p>Question: Is it possible to have this run on any active file? I was trying to use Personal Macro Workbook, but I cannot figure out how to have it automatically run on the open file. </p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1501694454, "post_id": 45467162, "comment_id": 77895279, "body": "If any suggestions, how can i delete the empty rows in a table?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1501695042, "post_id": 45467162, "comment_id": 77895567, "body": "See <a href=\"https://stackoverflow.com/questions/9379673/excel-vba-delete-empty-rows\" title=\"excel vba delete empty rows\">stackoverflow.com/questions/9379673/excel-vba-delete-empty-r&zwnj;&#8203;ows</a>"}], "answers": [{"tags": [], "owner": {"reputation": 650, "user_id": 7857786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbefe9a0dc20a7f973a96b4ee74045f?s=128&d=identicon&r=PG&f=1", "display_name": "maaajo", "link": "https://stackoverflow.com/users/7857786/maaajo"}, "is_accepted": true, "score": 2, "last_activity_date": 1501696018, "creation_date": 1501696018, "answer_id": 45467718, "question_id": 45467162, "link": "https://stackoverflow.com/questions/45467162/excel-delete-entire-rows-dialogue-box/45467718#45467718", "title": "excel --&quot;delete entire rows&quot; dialogue box", "body": "<p>I'm not sure if i understood you correctly, but try this piece of code. You can achieve your request I think by adding <code>Application.DisplayAlerts</code> to your code:</p>\n\n<pre><code>Application.DisplayAlerts = False\n\nLastRow = Worksheets(\"KYC Feedback Page 2\").Range(\"A65536\").End(xlUp).Row\nLastColumn = Replace(Cells(1, \nActiveSheet.Range(\"XFD1\").End(xlToLeft).Column).Address(False, False), \"1\", \n\"\")\nOn Error Resume Next\nWith Worksheets(\"KYC Feedback Page 2\").Range(\"A1:\" &amp; LastColumn &amp; LastRow)\n.AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\", Operator:=xlFilterValues\n.Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.delete\nEnd With\nOn Error Resume Next\nSheet1.AutoFilterMode = False\n\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 45467718, "answer_count": 1, "score": 1, "last_activity_date": 1501696018, "creation_date": 1501694164, "last_edit_date": 1531164843, "question_id": 45467162, "link": "https://stackoverflow.com/questions/45467162/excel-delete-entire-rows-dialogue-box", "title": "excel --&quot;delete entire rows&quot; dialogue box", "body": "<p>I have a big excel sheet that i retrieve information from into a new sheet that has a table. The problem is i cant know the number of rows the table will take because the data is dynamic. I also have to print the table afterwards but it copies the blank rows from the raw data. and so what i have done is, i created this code below to filter the table and hide all the empty rows. and it does exactly what i want-hiding the empty rows. But everytime the data in the table needs to be refreshed(copy and pasted) excel asks me with a dialogue box asking if i want to delete entire sheet row. if i click yes, it does refresh the data but if i click no it continues to add the new data under what was originally in the table.--this is not what i want.</p>\n\n<pre><code> LastRow = Worksheets(\"KYC Feedback Page 2\").Range(\"A65536\").End(xlUp).Row\nLastColumn = Replace(Cells(1, \nActiveSheet.Range(\"XFD1\").End(xlToLeft).Column).Address(False, False), \"1\", \n\"\")\nOn Error Resume Next\nWith Worksheets(\"KYC Feedback Page 2\").Range(\"A1:\" &amp; LastColumn &amp; LastRow)\n.AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\", Operator:=xlFilterValues\n.Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.delete\nEnd With\nOn Error Resume Next\nSheet1.AutoFilterMode = False\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "edited": false, "score": 0, "creation_date": 1501693846, "post_id": 45467017, "comment_id": 77894911, "body": "Try changing <code>For Each cc In ActiveDocument...</code> to <code>For Each cc In wdApp.ActiveDocument...</code>"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1501693908, "post_id": 45467017, "comment_id": 77894948, "body": "You never actually open strDocName, do so capturing the document then you can access documentVar.ContentControl<b>s</b>."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1501695379, "post_id": 45467017, "comment_id": 77895751, "body": "I think you need to set the name in the second argument to get the current instance: <code>GetObject(,&quot;Word.Application&quot;)</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501695767, "post_id": 45467017, "comment_id": 77895985, "body": "<code>ActiveDocument</code> is not an object in Excel VBA - you need to scope that to the Word Application:  <code>wdApp.ActiveDocument</code>"}, {"owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "reply_to_user": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "edited": false, "score": 0, "creation_date": 1501695819, "post_id": 45467017, "comment_id": 77896024, "body": "I think I am creating a new document based on the dotm file. I never saved the new file but I should still be able to access the controls on the new document. Right? @VBobCat can you write that as an answer. I think I tried using ActiveDocument but I may not have expanded it enough. I&#39;d appreciate it. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1501698140, "post_id": 45468053, "comment_id": 77897477, "body": "Same error. It thinks Word.ContentControl is a custom type"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1501703157, "post_id": 45468053, "comment_id": 77900370, "body": "@softwareisfun <code>Word.ContentControl</code> <b>is</b> a custom type.  Do you have the <code>Microsoft Word vv.v Object Library</code> reference ticked so that it can refer to that custom type?  If not, declare your object <code>As Object</code>."}, {"owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1501704196, "post_id": 45468053, "comment_id": 77900996, "body": "How do I reference it? Are you asking me to declare my content control (cc) as Object?"}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1501708606, "post_id": 45468053, "comment_id": 77903303, "body": "@softwareisfun, in your VBA window, click menu Tools &gt; References and you can see all COM references registered in your system. Most of them are not ment to be accessed from VBA, but those from MS Office programs are interoperable. When you mark that of Microsoft Word, you&#39;ll have access to the object model of MS-Word. Just remember you are still in Excel&#39;s namespace, so you must fully qualify your word &quot;foreign&quot; objects."}, {"owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "reply_to_user": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1501708918, "post_id": 45468053, "comment_id": 77903480, "body": "@softwareisfun, if you want to make edits to update the code you are using, they should be made to your question, not to my answer ;-)"}], "tags": [], "owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "is_accepted": false, "score": -1, "last_activity_date": 1501708810, "last_edit_date": 1501708810, "creation_date": 1501697210, "answer_id": 45468053, "question_id": 45467017, "link": "https://stackoverflow.com/questions/45467017/how-do-i-get-contentcontrol-to-work-in-excel-vba/45468053#45468053", "title": "how do I get ContentControl to work in Excel VBA", "body": "<p>Ok, I believe this could work:</p>\n\n<pre><code>Sub FnWriteToWordDoc()\n    '\n    'Opens desired template to fill in data form range of cells\n\n    Dim wApp As Word.Application 'declare empty variable\n    Dim wDoc As Word.Document  'declare empty variable\n    On Error Resume Next\n        Set wApp = GetObject(, \"Word.Application\") ' get instance\n        If wApp Is Nothing Then 'getting existing instance failed\n            Set wApp = CreateObject(\"Word.Application\") 'create new instance\n        End If\n    On Error GoTo 0\n    wApp.DisplayAlerts = False\n    'Opens template to create document\n    Set wDoc = wApp.Documents.Add(Template:=\"M:\\file.dotm\") 'get instance of document\n\n    'Below Tells to keep values in memory\n    Dim currentDay As String\n    Dim currentMonth As String\n    Dim currentYear As String\n    currentDay = Format(Now(), \"dd\")\n    currentMonth = Format(Now(), \"mmm\")\n    currentYear = Format(Now(), \"yyyy\")\n    strDocName = \"C:\\Document\\sample.docx\"\n\n    ' you must declare your variable with class' name, not instanced object's name\n    Dim cc As Word.ContentControl\n\n    For Each cc In wDoc.SelectContentControlsByTag(\"monthName\")\n        cc.Title = currentMonth\n    Next\n\n    wDoc.SaveAs2 strDocName\n    wDoc.Close False\n\n    If wApp.Documents.Count = 0 Then wApp.Quit False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "is_accepted": false, "score": 0, "last_activity_date": 1501762790, "creation_date": 1501762790, "answer_id": 45484017, "question_id": 45467017, "link": "https://stackoverflow.com/questions/45467017/how-do-i-get-contentcontrol-to-work-in-excel-vba/45484017#45484017", "title": "how do I get ContentControl to work in Excel VBA", "body": "<pre><code>Sub FnWriteToWordDoc()\n    '\n    'Opens desired template to fill in data form range of cells\n\n    Dim wApp As Object\n    Set wApp = CreateObject(\"Word.Application\")\n    Dim wDoc As Object\n    Set wDoc = CreateObject(\"Word.Document\")\n    On Error Resume Next\n    Set wApp = GetObject(, \"Word.Application\")\n    If wApp Is Nothing Then\n        Set wApp = CreateObject(\"Word.Application\")\n    End If\n    On Error GoTo 0\n    wApp.DisplayAlerts = False\n    'Opens template to create document\n    Set wDoc = wApp.Documents.Add(Template:=\"M:\\file.dotm\")\n\n    'Below Tells to keep values in memory\n    Dim currentDay As String\n    Dim currentMonth As String\n    Dim currentYear As String\n    currentDay = Format(Now(), \"dd\")\n    currentMonth = Format(Now(), \"mmm\")\n    currentYear = Format(Now(), \"yyyy\")\n    strDocName = \"C:\\Document\\sample.docx\"\n\n    ' you must declare your variable with class' name, not instanced object's name\n    Dim cc As Object        \n\n    For Each cc In wDoc.SelectContentControlsByTag(\"monthName\")\n        cc.Range.Text = currentMonth\n    Next\n</code></pre>\n\n<p>The code above is functional code and is able to write into the ContentControls. Thanks to VBobCat for his inspiration</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13251387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349438f36bc9705058de8d872b1f4747?s=128&d=identicon&r=PG", "display_name": "Ibo Y", "link": "https://stackoverflow.com/users/13251387/ibo-y"}, "is_accepted": false, "score": 1, "last_activity_date": 1586279322, "creation_date": 1586279322, "answer_id": 61085505, "question_id": 45467017, "link": "https://stackoverflow.com/questions/45467017/how-do-i-get-contentcontrol-to-work-in-excel-vba/61085505#61085505", "title": "how do I get ContentControl to work in Excel VBA", "body": "<p>There is error here</p>\n\n<blockquote>\n<pre><code>Dim cc As wdApp.ContentControl\n</code></pre>\n  \n  <p>because you need to enable the Microsoft Word 12 Library. Go to Tools>References and find Microsoft Word library and put a check mark next to it</p>\n</blockquote>\n"}], "owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1586279322, "creation_date": 1501693672, "last_edit_date": 1501703279, "question_id": 45467017, "link": "https://stackoverflow.com/questions/45467017/how-do-i-get-contentcontrol-to-work-in-excel-vba", "title": "how do I get ContentControl to work in Excel VBA", "body": "<pre><code>Sub FnWriteToWordDoc()\n'\n'Opens desired template to fill in data form range of cells\n'Dim wApp As Word.Application\nSet wApp = CreateObject(\"Word.Application\")\n    wApp.DisplayAlerts = False\n'Opens template to create document\nDocuments.Add Template:=\"M:\\file.dotm\"\n\n'Below Tells to keep values in memory\nDim currentDay As String\nDim currentMonth As String\nDim currentYear As String\ncurrentDay = Format(Now(), \"dd\")\ncurrentMonth = Format(Now(), \"mmm\")\ncurrentYear = Format(Now(), \"yyyy\")\nSet wdApp = GetObject(\"Word.Application\")\n     If Err.Number = 429 Then\n        Err.Clear\n        Set wdApp = CreateObject(\"Word.Application\")\n     End If\nstrDocName = \"C:\\Document\\sample.docx\"\nDim cc As wdApp.ContentControl ' Error Here\n\nFor Each cc In ActiveDocument.SelectContentControlsByTag(\"monthName\")\n    cc.Title = currentMonth\nNext\n</code></pre>\n\n<p>I get an error saying </p>\n\n<pre><code>Compile error:\nUser-defined type not defined\n</code></pre>\n\n<p>The Function is located within \"Sheet1\" under the Folder called \"Microsoft Excel Objects\". I had the same code in the \"Modules1\" and moved.</p>\n\n<p>I am trying to get Excel to insert into my Word document content controls.</p>\n"}, {"tags": ["vba", "excel", "loops", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501705142, "post_id": 45467237, "comment_id": 77901483, "body": "@YowE3K I noticed, yes that&#39;d be important to point out! Thanks again-"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1501705008, "last_edit_date": 1501705008, "creation_date": 1501694387, "answer_id": 45467237, "question_id": 45466998, "link": "https://stackoverflow.com/questions/45466998/vba-using-vlookup-to-set-dynamic-values-in-loop/45467237#45467237", "title": "VBA: Using VLookUp to Set Dynamic Values in loop?", "body": "<p>Try getting rid of the <code>=</code> in the formula and also use consistent cell notation (i.e. don't mix A1 notation with R1C1 notation):   </p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=(((\" &amp; signal_array(Element, 1) &amp; \")-\nR[-88]C)/R[-90]C)*1000*(VLOOKUP(\" &amp; ActiveWorkbook.Name &amp; \",'[Calibration \nCurves.xlsm]Sample Weights'!R2C1:R10C2,2,FALSE))\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7982743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd9d6be25e5f70dc7afa2fe8049e0d5?s=128&d=identicon&r=PG&f=1", "display_name": "Katie M", "link": "https://stackoverflow.com/users/7982743/katie-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501705008, "creation_date": 1501693601, "last_edit_date": 1501704283, "question_id": 45466998, "link": "https://stackoverflow.com/questions/45466998/vba-using-vlookup-to-set-dynamic-values-in-loop", "title": "VBA: Using VLookUp to Set Dynamic Values in loop?", "body": "<p>New VBA user here... </p>\n\n<p>I have set up a Macro that runs for each file in a folder, as a loop. </p>\n\n<p>In one part of the macro, there is an equation that contains a value that differs for each file. </p>\n\n<p>Here is the equation (the value that changes for each file is 0.2483, everything else stays the same): </p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=(((\" &amp; signal_array(Element, 1) &amp; \")-\nR[-83]C)/R[-85]C)*1000*0.2483\"\n</code></pre>\n\n<p>I have set up a table that lists each file name and its corresponding value in another workbook. I have attempted to use vLookUp within the equation to find the value based on the file name - the file of which is active.</p>\n\n<p>Here's what I have so far, for which I get a \"Run-Time Error: 1004\" on:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=(((\" &amp; signal_array(Element, 1) &amp; \")-\nR[-88]C)/R[-90]C)*1000*(=VLOOKUP(\" &amp; ActiveWorkbook.Name &amp; \",'[Calibration \nCurves.xlsm]Sample Weights'!A2:B10,2,FALSE))\"\n</code></pre>\n\n<p>Suggestions on how to make this work?</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2007"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1501693282, "post_id": 45466833, "comment_id": 77894532, "body": "Don&#39;t.  Just copy the reference table.  Put it in it&#39;s own sheet, along with anything else you need and just copy the whole sheet into your new workbooks."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1501693287, "post_id": 45466833, "comment_id": 77894541, "body": "It doesnt have to be in each sheet, you can reference one sheet from another. Put all of your lookup data in one sheet and then refer to it from other sheets."}, {"owner": {"reputation": 60, "user_id": 5172089, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/08a467af104c64ba6be688bbb5cc0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "NShiva", "link": "https://stackoverflow.com/users/5172089/nshiva"}, "edited": false, "score": 0, "creation_date": 1501693700, "post_id": 45466833, "comment_id": 77894827, "body": "I dont want to copy these columns  whenever I required. I just want these data into formula, so that I will just apply formula every time."}], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 5172089, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/08a467af104c64ba6be688bbb5cc0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "NShiva", "link": "https://stackoverflow.com/users/5172089/nshiva"}, "edited": false, "score": 0, "creation_date": 1501695830, "post_id": 45466974, "comment_id": 77896032, "body": "In this case I need to have reference table in each document right?"}, {"owner": {"reputation": 159, "user_id": 8383881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6030f2e2b8e9f0630d67c0f5fec186f3?s=128&d=identicon&r=PG&f=1", "display_name": "xgg", "link": "https://stackoverflow.com/users/8383881/xgg"}, "reply_to_user": {"reputation": 60, "user_id": 5172089, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/08a467af104c64ba6be688bbb5cc0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "NShiva", "link": "https://stackoverflow.com/users/5172089/nshiva"}, "edited": false, "score": 0, "creation_date": 1501697192, "post_id": 45466974, "comment_id": 77896890, "body": "I thought all this in in the same workbook &quot;document&quot;. ie: Index(A:A,match(&quot;input name&quot;,B:B,0))"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 60, "user_id": 5172089, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/08a467af104c64ba6be688bbb5cc0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "NShiva", "link": "https://stackoverflow.com/users/5172089/nshiva"}, "edited": false, "score": 2, "creation_date": 1501742460, "post_id": 45466974, "comment_id": 77913658, "body": "@ShivaN - Use something like, <code>=INDEX({&quot;Fruit&quot;,&quot;Vegetable&quot;,&quot;Xyz&quot;},MATCH(A1,{&quot;Apple&quot;,&quot;Brinja&zwnj;&#8203;l&quot;,&quot;Abc&quot;},0))</code>"}], "tags": [], "owner": {"reputation": 159, "user_id": 8383881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6030f2e2b8e9f0630d67c0f5fec186f3?s=128&d=identicon&r=PG&f=1", "display_name": "xgg", "link": "https://stackoverflow.com/users/8383881/xgg"}, "is_accepted": false, "score": 2, "last_activity_date": 1501693541, "creation_date": 1501693541, "answer_id": 45466974, "question_id": 45466833, "link": "https://stackoverflow.com/questions/45466833/how-to-use-more-than-200-nested-if-conditions-in-excel/45466974#45466974", "title": "How to use more than 200 nested if conditions in excel?", "body": "<p>use INDEX and MATCH functions. INDEX on \"category\" by matching \"name\"</p>\n"}, {"comments": [{"owner": {"reputation": 60, "user_id": 5172089, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/08a467af104c64ba6be688bbb5cc0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "NShiva", "link": "https://stackoverflow.com/users/5172089/nshiva"}, "edited": false, "score": 0, "creation_date": 1501861788, "post_id": 45468225, "comment_id": 77982897, "body": "As I mentioned in the Question, I have 200 rows in the reference sheet."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1501698117, "last_edit_date": 1501698117, "creation_date": 1501697800, "answer_id": 45468225, "question_id": 45466833, "link": "https://stackoverflow.com/questions/45466833/how-to-use-more-than-200-nested-if-conditions-in-excel/45468225#45468225", "title": "How to use more than 200 nested if conditions in excel?", "body": "<p>You certainly don't need so many IF statements (though I note your Q Title), for example:</p>\n\n<pre><code>=CHOOSE(MATCH(D13,{\"Apple\",\"Brinjal\",\"Abc\"},0),\"Fruit\",\"Vegetable\",\"XYZ\")\n</code></pre>\n\n<p>which should not grow at quite the rate your version would - but with 200 'pairs' would be getting close to the limit for <a href=\"https://www.techonthenet.com/excel/formulas/choose.php\" rel=\"nofollow noreferrer\">CHOOSE</a>. </p>\n\n<p>(<code>D13</code> as example in spreadsheet.)</p>\n"}], "owner": {"reputation": 60, "user_id": 5172089, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/08a467af104c64ba6be688bbb5cc0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "NShiva", "link": "https://stackoverflow.com/users/5172089/nshiva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1501698117, "creation_date": 1501693103, "question_id": 45466833, "link": "https://stackoverflow.com/questions/45466833/how-to-use-more-than-200-nested-if-conditions-in-excel", "title": "How to use more than 200 nested if conditions in excel?", "body": "<p>I have the following data in excel sheet A.</p>\n\n<pre><code>Category    Name\nFruit       Apple\nVegetable   Brinjal\nXYZ         Abc\n</code></pre>\n\n<p>I want to create a formula which takes a value for name column, outputs the  corresponding category column.</p>\n\n<p>If I use VLookUp, I have to copy this reference table in each and every excel sheet wherever I need to have this operation.</p>\n\n<p>Hence I am looking for something similar to</p>\n\n<pre><code>IF(input=\"Apple\",\"Fruit\",IF(input=\"Brinjal\",\"Vegetable\",IF(input=\"Abc\",XYZ,\"\")))\n</code></pre>\n\n<p>But There is limit on nested ifs in excel and no of cases that we can have in a switch case are also limited.</p>\n\n<p>I have around 200 rows of this table.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 763, "user_id": 8251318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff7844182651142d95d26253f7aada4c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8251318/matthew"}, "edited": false, "score": 0, "creation_date": 1501693288, "post_id": 45466727, "comment_id": 77894544, "body": "Thank you, I had no idea I kept deleting the previous element in the array"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1501692777, "creation_date": 1501692777, "answer_id": 45466727, "question_id": 45466569, "link": "https://stackoverflow.com/questions/45466569/are-my-arrays-incompatible/45466727#45466727", "title": "Are my arrays incompatible?", "body": "<p>You are looping through <code>repNames()</code> and setting this new array via split (over and over again for each repName element...)</p>\n\n<pre><code> For Each rep In repNames()    \n    repHolder() = Split(rep, \",\")    \n Next rep\n</code></pre>\n\n<p>Every iteration of this loop resets <code>repHolder()</code> to a split of the <code>rep</code> element dropping whatever values were just set in that array in the previous iteration. So once it's done only the last element of <code>RepNames()</code> has been split into the <code>repHolder()</code> array. </p>\n\n<p>For instance, if <code>RepNames()</code> looks like:</p>\n\n<pre><code>Element 0: \"james,linda,mahesh,bob\"\nElement 1: \"rajesh,sam,barb,carrie\"\nElement 2: \"\"\n</code></pre>\n\n<p>Then after all this iterating your <code>repHolder</code> array is going to be empty because there is nothing in the final element.</p>\n\n<p>Stick a breakpoint (F9) on you <code>For Each rangeCell In repComboRange</code> line and look at your Locals pane in VBE. Check out the values that are stored in your <code>repHolder()</code> array at that point in time. I suspect there will be nothing in there.</p>\n\n<p>The other oddball here is that you are looping 1 through 17. <code>repHolder()</code> will be a 0-based array so that should be 0 through 16. But... even that is nonsense since this really only makes sense as a For Each loop (or to use the <code>uBound(repHolder)</code> to determine how many times to loop:</p>\n\n<pre><code>For Each counter In strHolder()\n    Stop\n    For each repHolderElem in repHolder\n        If repHolderElem = counter Then\n        ....\n    Next repHolderElem\n</code></pre>\n"}], "owner": {"reputation": 763, "user_id": 8251318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff7844182651142d95d26253f7aada4c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/8251318/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 45466727, "answer_count": 1, "score": 0, "last_activity_date": 1501692777, "creation_date": 1501692302, "last_edit_date": 1531164843, "question_id": 45466569, "link": "https://stackoverflow.com/questions/45466569/are-my-arrays-incompatible", "title": "Are my arrays incompatible?", "body": "<p>I am trying to loop through an array that contains split strings, done via this line:<br>\n<code>repHolder() = Split(rep, \",\")</code></p>\n\n<p>That's all fine and good, however, when I try to loop through this <code>repHolder()</code> array via a <code>for</code> loop, I am met each time with a <code>subscript out of range</code> error.</p>\n\n<p>This makes no sense to me. When I step through the array it fails on the first element every time; this line:</p>\n\n<p><code>If repHolder(j) = counter Then</code></p>\n\n<p>I tried setting <code>j</code> to 0 and 1, both of which failed on the first sequence of the loop. This suggests to me because the array doesn't have a defined size; that I cannot loop through it this way, but that still makes little sense to me as it is still filled with elements.</p>\n\n<p>Here is the entire code block of what I am trying to do:</p>\n\n<pre><code>Dim repHolder() As String\nDim strHolder() As String\nDim counter As Variant\nDim j As Integer\n\n\nFor Each rep In repNames()\n\n    repHolder() = Split(rep, \",\")\n\nNext rep\n\n\n\nFor Each rangeCell In repComboRange\nk = 1\n\nDo\n\nIf rangeCell.Value = repCombos(k) Then  'At this point, if rangecell = repcombos(k)\n\nRange(rangeCell, rangeCell.End(xlToRight)).Copy\nstrHolder() = Split(rangeCell.Value, \"/\")\n\n    For Each counter In strHolder()\n        Stop\n        For j = 1 To 17\n\n            If repHolder(j) = counter Then\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1501691727, "post_id": 45466191, "comment_id": 77893560, "body": "&quot;Take those values and compare them with sheet2 ColumnO.&quot; - Do you mean anywhere in that column? Or same row, in that column?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 1, "creation_date": 1501691802, "post_id": 45466191, "comment_id": 77893606, "body": "It looks like you&#39;ve only tried #1 so far. If you try #2-5 first and tell us where you get stuck I think you&#39;ll get more answers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1501692656, "post_id": 45466191, "comment_id": 77894128, "body": "define : <i>&#39;... when common with ...&#39;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7264379, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fbdd6962ebce7eb577b456bd61058a21?s=128&d=identicon&r=PG&f=1", "display_name": "Nid Du", "link": "https://stackoverflow.com/users/7264379/nid-du"}, "edited": false, "score": 0, "creation_date": 1501695811, "post_id": 45467203, "comment_id": 77896018, "body": "thank you very much for your help. This code is working for small amount of data. but for big amount data, it&#39;s not working. here is the sample worksheet, would you look into it?  <a href=\"https://a.uguu.se/tkGV68TzIGwR_testtt111.xlsx\" rel=\"nofollow noreferrer\">a.uguu.se/tkGV68TzIGwR_testtt111.xlsx</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 45, "user_id": 7264379, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fbdd6962ebce7eb577b456bd61058a21?s=128&d=identicon&r=PG&f=1", "display_name": "Nid Du", "link": "https://stackoverflow.com/users/7264379/nid-du"}, "edited": false, "score": 0, "creation_date": 1501696382, "post_id": 45467203, "comment_id": 77896368, "body": "The values in Sheet2!O:O are text-that-look-like-numbers while the values in Sheet1!B:B are true numbers. Either use TextToColumns to convert O:O to true numbers, change the values in B:B to text or change the formulas to compensate."}, {"owner": {"reputation": 45, "user_id": 7264379, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fbdd6962ebce7eb577b456bd61058a21?s=128&d=identicon&r=PG&f=1", "display_name": "Nid Du", "link": "https://stackoverflow.com/users/7264379/nid-du"}, "edited": false, "score": 0, "creation_date": 1501697192, "post_id": 45467203, "comment_id": 77896889, "body": "There are alot of empty cells in between numbers in sheet2 columnO, may be thats why. any idea how i can ignore empty cells in sheet2 columnO."}, {"owner": {"reputation": 45, "user_id": 7264379, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fbdd6962ebce7eb577b456bd61058a21?s=128&d=identicon&r=PG&f=1", "display_name": "Nid Du", "link": "https://stackoverflow.com/users/7264379/nid-du"}, "edited": false, "score": 0, "creation_date": 1501700799, "post_id": 45467203, "comment_id": 77899037, "body": "thank you very much brother. it&#39;s working, quick question, if sheet1 = Worksheets(&quot;Comp Data&quot;) and sheet2 = Worksheets(&quot;from calndr&quot;) , how do i refer them to here?    With .FormatConditions.Add(Type:=xlExpression, _               Formula1:=&quot;=ISNA(MATCH(&quot; &amp; addr1 &amp; &quot;, Sheet1!$B:$B, 0))&quot;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 45, "user_id": 7264379, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fbdd6962ebce7eb577b456bd61058a21?s=128&d=identicon&r=PG&f=1", "display_name": "Nid Du", "link": "https://stackoverflow.com/users/7264379/nid-du"}, "edited": false, "score": 0, "creation_date": 1501701848, "post_id": 45467203, "comment_id": 77899579, "body": "You do not need to add the worksheet name to a cell address within a CFR for that worksheet but other worksheets like <code>Sheet1!$B:$B</code> should be <code>&#39;Comp Data&#39;!$B:$B</code>."}, {"owner": {"reputation": 45, "user_id": 7264379, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fbdd6962ebce7eb577b456bd61058a21?s=128&d=identicon&r=PG&f=1", "display_name": "Nid Du", "link": "https://stackoverflow.com/users/7264379/nid-du"}, "edited": false, "score": 0, "creation_date": 1501780038, "post_id": 45467203, "comment_id": 77942325, "body": "And all the empty cells also highlighting red how do i avoid it?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1501694268, "creation_date": 1501694268, "answer_id": 45467203, "question_id": 45466191, "link": "https://stackoverflow.com/questions/45466191/vba-how-to-select-values-when-cell-beside-it-is-empty-and-compare-those-values-w/45467203#45467203", "title": "VBA How to select values when cell beside it is empty and compare those values with another column in another sheet and highlight", "body": "<p>It seems like some conditional formatting rules should take care of everything you require. Here they are in VBA.</p>\n\n<pre><code>Option Explicit\n\nSub CFRs()\n    Dim addr1 As String, addr2 As String\n    With Worksheets(\"sheet1\")\n        With .Range(.Cells(1, \"B\"), .Cells(.Rows.Count, \"B\").End(xlUp))\n            addr1 = .Cells(1).Address(False, True)\n            addr2 = .Cells(1).Offset(0, 1).Address(False, True)\n            .FormatConditions.Delete\n            With .FormatConditions.Add(Type:=xlExpression, _\n              Formula1:=\"=AND(\" &amp; addr2 &amp; \"=TEXT(,), ISNUMBER(MATCH(\" &amp; addr1 &amp; \", Sheet2!$O:$O, 0)))\")\n                .Interior.ColorIndex = 10\n            End With\n            With .FormatConditions.Add(Type:=xlExpression, _\n              Formula1:=\"=NOT(LEN(\" &amp; addr2 &amp; \"))\")\n                .Interior.ColorIndex = 6\n            End With\n        End With\n    End With\n    With Worksheets(\"sheet2\")\n        With .Range(.Cells(1, \"O\"), .Cells(.Rows.Count, \"O\").End(xlUp))\n            addr1 = .Cells(1).Address(False, True)\n            .FormatConditions.Delete\n            With .FormatConditions.Add(Type:=xlExpression, _\n              Formula1:=\"=ISNA(MATCH(\" &amp; addr1 &amp; \", Sheet1!$B:$B, 0))\")\n                .Interior.ColorIndex = 3\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7264379, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fbdd6962ebce7eb577b456bd61058a21?s=128&d=identicon&r=PG&f=1", "display_name": "Nid Du", "link": "https://stackoverflow.com/users/7264379/nid-du"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501695844, "creation_date": 1501691113, "last_edit_date": 1501695844, "question_id": 45466191, "link": "https://stackoverflow.com/questions/45466191/vba-how-to-select-values-when-cell-beside-it-is-empty-and-compare-those-values-w", "title": "VBA How to select values when cell beside it is empty and compare those values with another column in another sheet and highlight", "body": "<p>I am just learning vba in excel. I am stuck with a problem here.</p>\n\n<p>What i am trying accomplish here is </p>\n\n<ol>\n<li>Select values in Sheet1 ColumnB when Sheet1 ColumnC is empty.</li>\n<li>Take those values and compare them with sheet2 ColumnO.</li>\n<li>Sheet1 ColumnB values is green in sheet1 when common with sheet2 ColumnO values.</li>\n<li>Sheet1 ColumnB values is yellow in sheet1 when it is not common with sheet2 ColumnO values.</li>\n<li>sheet2 ColumnO values is red in sheet2 when its not in sheet1.</li>\n</ol>\n\n<p>here is the sample file</p>\n\n<p><a href=\"https://a.uguu.se/tkGV68TzIGwR_testtt111.xlsx\" rel=\"nofollow noreferrer\">https://a.uguu.se/tkGV68TzIGwR_testtt111.xlsx</a></p>\n\n<p>This is what i got so far. I can select the values in ColumnB when columnC is empty and copy them in to another column. </p>\n\n<pre><code>Sub compareWR()\nDim emptyI As Long          \nDim emptyJ As Long          \nlastrow = ws1.Cells(Rows.Count, \"B\").End(xlUp).Row\nemptyJ = 2\nFor emptyI = 2 To lastrow\nIf Cells(emptyI, \"C\").Value = \"\" Then\nCells(emptyJ, \"AA\").Value = Cells(emptyI, \"B\").Value\n        emptyJ = emptyJ + 1\nEnd If\nNext emptyI\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501691419, "post_id": 45466178, "comment_id": 77893363, "body": "I don&#39;t quite understand your problem but I think you need to change this line as you want to base it on the values in A rather than B <code>lRow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501691491, "post_id": 45466178, "comment_id": 77893412, "body": "Another problem is that the first instance of your formula will refer to B1 but the blank may not be in row 1."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501691723, "post_id": 45466178, "comment_id": 77893558, "body": "Hello, @SJR  I am sorry if my requirements were not stated clearly enough I can provide screenshots of what I am attempting to achieve.  Your modification to the code was not what i was looking for. When I ran it the code update column A even though column B was empty."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501691903, "post_id": 45466178, "comment_id": 77893673, "body": "I can&#39;t replicate your problem. If col B is all blank and there are blanks in A it will put the formula in those blanks in A (which will return an empty string because B is blank). I don&#39;t see how it can put values in A unless what appear to be blanks in B are not actually blank."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501692033, "post_id": 45466178, "comment_id": 77893759, "body": "Perhaps you could share with me the code you are testing? I am not getting the same results as you."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501692747, "post_id": 45466178, "comment_id": 77894183, "body": "I&#39;m using the code above, plus the change I suggested in first comment. Perhaps you can post a screenshot of your sheet?"}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501692924, "post_id": 45466178, "comment_id": 77894298, "body": "I found the answer!   <code>Sub Update_Column_Based_On_Column_Value_1() On Error Resume Next     Dim ws As Worksheet     Dim lRow As Long      Set ws = ThisWorkbook.Sheets(&quot;Sheet1&quot;)      If WorksheetFunction.CountA(ws.Range(&quot;B:B&quot;)) = 1 Then      Else              With ws             lRow = .Range(&quot;B&quot; &amp; .Rows.Count).End(xlUp).Row             .Range(&quot;A1:A&quot; &amp; lRow).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = &quot;=If(LEN(RC2),&quot;&quot;Answer&quot;&quot;, TEXT(,))&quot;             .Range(&quot;A1:A&quot; &amp; lRow).Value = .Range(&quot;A1:A&quot; &amp; lRow).Value         End With     End If End Sub</code>"}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1501704928, "post_id": 45466178, "comment_id": 77901372, "body": "@UserX:  Welcome to Stack Overflow! You should post that as an &quot;answer&quot; and then &quot;accept&quot; that answer so others don&#39;t read through your post thinking it&#39;s still unanswered.  It&#39;s a common courtesy for others on the forum."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "reply_to_user": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1501765431, "post_id": 45466178, "comment_id": 77930632, "body": "@abraxascarab Thanks for pointing that out to me! I posted that code as a separate comment and I will accept that answer when I am allowed to. For some reason StackOverflow wants me to wait one day before I can accept that comment as the answer."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501765649, "post_id": 45474502, "comment_id": 77930817, "body": "Thank you for the contribution but I found a solution that works for me. I tested multiple scenarios and it works every time. Please check it out and leave feedback if you would like!"}, {"owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "reply_to_user": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501811327, "post_id": 45474502, "comment_id": 77955322, "body": "sry mate it didnt. pl see <a href=\"https://i.stack.imgur.com/QhjuJ.png\" rel=\"nofollow noreferrer\">screenshot</a>. only data before macro run was in cell <code>G7</code>. after the macro run, whole range <code>A1:G7</code> except cell <code>G7</code> was populated with zeros. but anyway, it&#39;s your choice as long as you are aware of the associated risk"}], "tags": [], "owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "is_accepted": false, "score": 0, "last_activity_date": 1501739001, "last_edit_date": 1501739001, "creation_date": 1501732508, "answer_id": 45474502, "question_id": 45466178, "link": "https://stackoverflow.com/questions/45466178/excel-vba-update-column-a-with-a-value-if-column-b-contains-any-value-if-colu/45474502#45474502", "title": "Excel VBA - Update column A with a value if column B contains any value. If column B contains no values then do not run the macro", "body": "<p>The use of <code>If WorksheetFunction.CountA(ws.Range(\"B:B\")) = 1</code> in the comment section to avoid the problem is a good attempt but there can be exceptions as discussed below. Test it several times using various scenarios (especially using blank range) to see if you are getting the desired result every single time.</p>\n\n<p><code>.SpecialCells</code> attempts to simplify the codes, however sometime <a href=\"https://support.microsoft.com/en-ca/help/832293/the-specialcells-xlcelltypeblanks-vba-function-does-not-work-as-expect\" rel=\"nofollow noreferrer\">the <code>.SpecialCells(xlCellTypeBlanks)</code> VBA function does not work as expected in Excel</a>.</p>\n\n<p>Also, the statement <code>On Error Resume Next</code> shouldn't be used as far as practicable. But if you must, be sure to insert the <code>On Error GoTo 0</code> statement ASAP as you don't want to mask other errors.</p>\n\n<p>Instead of <code>.SpecialCells</code>, you may use <code>For Each</code> loop to avoid this problem. So let's see how it looks:</p>\n\n<pre><code>Sub Update_Column_Based_On_Column_Value1()\n    Dim ws As Worksheet, lRow As Long, r As Range\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    With ws\n        lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n        For Each r In .Range(\"A1:A\" &amp; lRow)\n            If IsEmpty(r) Then\n                r.Formula = \"=If(B\" &amp; r.Row &amp; \"&lt;&gt;\"\"\"\",\"\"PREDETERMINED VALUE\"\",\"\"\"\")\"\n                r = r.Value\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "is_accepted": false, "score": 0, "last_activity_date": 1501765287, "creation_date": 1501765287, "answer_id": 45485005, "question_id": 45466178, "link": "https://stackoverflow.com/questions/45466178/excel-vba-update-column-a-with-a-value-if-column-b-contains-any-value-if-colu/45485005#45485005", "title": "Excel VBA - Update column A with a value if column B contains any value. If column B contains no values then do not run the macro", "body": "<p>Here is the answer everyone!</p>\n\n<pre><code>Sub Update_Column_Based_On_Column_Value_1()\n    On Error Resume Next\n        Dim ws As Worksheet\n        Dim lRow As Long\n\n        Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n        If WorksheetFunction.CountA(ws.Range(\"B:B\")) = 1 Then\n\n        Else\n\n            With ws\n                lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n                .Range(\"A1:A\" &amp; lRow).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=If(LEN(RC2),\"\"NEW TEXT HERE\"\", TEXT(,))\"\n                .Range(\"A1:A\" &amp; lRow).Value = .Range(\"A1:A\" &amp; lRow).Value\n            End With\n        End If\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2523, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527696443, "creation_date": 1501691070, "last_edit_date": 1501704309, "question_id": 45466178, "link": "https://stackoverflow.com/questions/45466178/excel-vba-update-column-a-with-a-value-if-column-b-contains-any-value-if-colu", "title": "Excel VBA - Update column A with a value if column B contains any value. If column B contains no values then do not run the macro", "body": "<p>In my scenario I have four columns, columns A-D. If column B contains any value whatsoever then the matching row in column A must be updated to contain a predetermined value. The same macro is applied for columns C and D. I have code right now that achieves that result:</p>\n\n<pre><code>Sub Update_Column_Based_On_Column_Value1()\nOn Error Resume Next\n    Dim ws As Worksheet\n    Dim lRow As Long\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With ws\n        lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n\n        .Range(\"A1:A\" &amp; lRow).SpecialCells(xlCellTypeBlanks).Formula = \"=If(B1&lt;&gt;\"\"\"\",\"\"PREDETERMINED VALUE\"\",\"\"\"\")\"\n        .Range(\"A1:A\" &amp; lRow).Value = .Range(\"A1:A\" &amp; lRow).Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>When column B contains a value the macro will write \"PREDETERMINED VALUE\" in the corresponding cell in column A.</p>\n\n<p>An issue occurs when a column does not contain any values at all. What happens is the macro will write my new value to nearly all of the blank cells in the entire data-set.</p>\n\n<p>Thank you in advance for your time! I apologize if my question is noobish, I am still very new to VBA.</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1501692933, "post_id": 45466114, "comment_id": 77894302, "body": "This code suffers from no &#39;Option Explicit&#39; Header."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501696322, "post_id": 45466114, "comment_id": 77896332, "body": "That really works fine in Excel?  Pretty sure it does not...   If you want to run that in PPT you will first need to create an Excel Application object"}, {"owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "edited": false, "score": 0, "creation_date": 1501697606, "post_id": 45466114, "comment_id": 77897146, "body": "Sorry the excel vba version is different, the code I posted there is what I modified so far for ppt"}], "answers": [{"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 1, "last_activity_date": 1501693084, "creation_date": 1501693084, "answer_id": 45466823, "question_id": 45466114, "link": "https://stackoverflow.com/questions/45466114/convert-array-in-excel-vba-to-powerpoint-vba/45466823#45466823", "title": "Convert array in Excel VBA to Powerpoint VBA", "body": "<p>Had to post as answer:</p>\n\n<p>This code suffers from no <strong>'Option Explicit'</strong> Header.</p>\n\n<p>The variable <code>varSheetISS</code> is being passed around recklessly.</p>\n\n<p>It start life life as a worksheet, then is cast to a range(where the intention was to get the Range's Value).</p>\n\n<p>A lot of this can be avoided by using Option Explicit.</p>\n\n<p><code>Dim issArray As Variant: issArray = varSheetISS.Range(strIDRangeISS).Value2</code></p>\n"}], "owner": {"reputation": 115, "user_id": 8061014, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b02c807003fcda1654d5fbc862d8a21e?s=128&d=identicon&r=PG&f=1", "display_name": "user90823745", "link": "https://stackoverflow.com/users/8061014/user90823745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 45466823, "answer_count": 1, "score": 0, "last_activity_date": 1501698758, "creation_date": 1501690844, "last_edit_date": 1501698758, "question_id": 45466114, "link": "https://stackoverflow.com/questions/45466114/convert-array-in-excel-vba-to-powerpoint-vba", "title": "Convert array in Excel VBA to Powerpoint VBA", "body": "<p>I had code in Excel VBA that I want to convert to run in Powerpoint VBA as well. here is what I have so far in ppt VBA:</p>\n\n<pre><code>Dim wbkISS As Excel.Workbook\nDim varSheetISS As Excel.Worksheet\n\nSet wbkISS = Workbooks.Open(FileName:=\"C:\\Users\\...\\Documents\\ISS.xlsm\")\nSet varSheetISS = wbkISS.Worksheets(\"For ISS\")\n\nstrIDRangeISS = \"A2:D50\"\n\nvarSheetISS = varSheetISS.Range(strIDRangeISS)\n\nFor iRowISS = LBound(varSheetISS, 1) To UBound(varSheetISS, 1)\n    ...\n    For iRowFCST = LBound(varSheetFCST, 1) To UBound(varSheetFCST, 1)\n        ...\n</code></pre>\n\n<p>But at \"LBound(varsheetISS\" it gives me the Compile error: Expected Array. My code works fine in Excel so I'm thinking I have the wrong syntax for ppt? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1501690752, "post_id": 45466031, "comment_id": 77892997, "body": "When you are iterating through rows and deleting rows...you want to go from the bottom up....not top down."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 2, "last_activity_date": 1501690719, "creation_date": 1501690719, "answer_id": 45466067, "question_id": 45466031, "link": "https://stackoverflow.com/questions/45466031/vba-a-shorter-if-or-statement/45466067#45466067", "title": "VBA - A shorter If/Or Statement", "body": "<pre><code>  Select Case CRC\n    Case \"Admin Cancellation\", \"Building sold / Management Co changed\", _\n         \"Contract Renewal delayed\", \"System decommissioned\", \"Building demolished\", _\n         \"cancelled due to credit hold/risk\"\n      ' do something\n  End Select\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1501691399, "last_edit_date": 1501691399, "creation_date": 1501691161, "answer_id": 45466208, "question_id": 45466031, "link": "https://stackoverflow.com/questions/45466031/vba-a-shorter-if-or-statement/45466208#45466208", "title": "VBA - A shorter If/Or Statement", "body": "<p>Try a Select... Case statement.</p>\n\n<pre><code>Dim rws As Long, rcnt As Long, crc As String\n\nWith Worksheets(\"Raw\")\n    rcnt = .Cells(.Rows.Count, \"I\").End(xlUp).Row\n    For rws = rcnt To 2 Step -1\n        Select Case LCase(.Cells(rws, \"I\").Value2)\n            Case \"admin cancellation\", \"building sold / management co changed\", _\n                 \"contract renewal delayed\", \"system decommissioned\", _\n                 \"building demolished\", \"cancelled due to credit hold/risk\"\n                 .Rows(rws).EntireRow.Delete\n        End Select\n    Next rws\nEnd With\n</code></pre>\n\n<p>You should always loop from bottom to top when deleting rows or you risk skipping over one when you delete and iterate to the next row. It is 'bad practice' to reuse reserved words as variable names. It is also considered 'bad practice' to change the value of the iteration var in a For .... Next loop.</p>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 45466208, "answer_count": 2, "score": 1, "last_activity_date": 1501691399, "creation_date": 1501690592, "question_id": 45466031, "link": "https://stackoverflow.com/questions/45466031/vba-a-shorter-if-or-statement", "title": "VBA - A shorter If/Or Statement", "body": "<p>I have been looking for a shorter way to to use this If/Or statement, but to no avail.  </p>\n\n<pre><code>Sheets(\"Raw\").Select\nDim rowCount As Integer, rows As Integer\nrows = 0\nDim CRC As String\n\nrowCount = Range(\"I2\", Range(\"I2\").End(xlDown)).rows.Count\nFor rows = 1 To rowCount\n    Range(\"I1\").Offset(rows, 0).Select\n    CRC = ActiveCell.Value\n    If CRC = \"Admin Cancellation\" _\n    Or CRC = \"Building sold / Management Co changed\" _\n    Or CRC = \"Contract Renewal delayed\" _\n    Or CRC = \"System decommissioned\" _\n    Or CRC = \"Building demolished\" _\n    Or CRC = \"cancelled due to credit hold/risk\" Then\n        ActiveCell.rows.EntireRow.Select\n        Selection.Delete Shift:=xlUp\n        rows = rows - 1\n        rowCount = rowCount - 1\n    End If\nNext rows\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 1, "creation_date": 1501689575, "post_id": 45465597, "comment_id": 77892226, "body": "Can you post the code of the stored procedure?"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501690257, "post_id": 45465597, "comment_id": 77892679, "body": "I haave create a connection between sql server and excel  and i and i am executing procedure from vba but what i want to know is that is there any mean so that i get to know thay my sql procedure has run properly through vba."}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "reply_to_user": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 0, "creation_date": 1501690275, "post_id": 45465597, "comment_id": 77892690, "body": "@JonathanWillcock"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1501690276, "post_id": 45465597, "comment_id": 77892691, "body": "Do you send back the number of rows affected from your procedure?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1501690309, "post_id": 45465597, "comment_id": 77892717, "body": "You would use ON ERROR in your VBA code just like any other time you need to handle errors."}, {"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 0, "creation_date": 1501690340, "post_id": 45465597, "comment_id": 77892732, "body": "The best way is if the stored proc ends with SELECT @@ROWCOUNT"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501690348, "post_id": 45465597, "comment_id": 77892737, "body": "Surely i will post a code in couple of hours"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501690435, "post_id": 45465597, "comment_id": 77892787, "body": "On error is not working in this case as if i get data type conversion error i am not able to detect that"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501690541, "post_id": 45465597, "comment_id": 77892859, "body": "Stored procedure not ending with row count and multiple rows are affecting"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1501690689, "post_id": 45465597, "comment_id": 77892956, "body": "You are saying the when the procedure raises an exception you can&#39;t handle it? And if you don&#39;t return the rowcount you have no way of knowing how many rows affected."}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1501701628, "post_id": 45465597, "comment_id": 77899467, "body": "@SeanLange  there are multiple procedure running in a procedure and i am executing procedure from vba and if the error occurs (like data type error in one of the row) in the mid of procedure the procedure executes and i dont know the error in vba, i want to print or display exception in vba msgbox. Or its not posaible with onerror and rowcount because the procedure has run."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1501701886, "post_id": 45465597, "comment_id": 77899599, "body": "What do you mean it isn&#39;t possible??? If the stored procedure raises an error it will bubble up to your application. You would catch this just like any other error in VBA and display the error message."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1501701924, "post_id": 45465597, "comment_id": 77899626, "body": "The rowcount is challenging here. What are you expecting this to return? Each procedure can have multiple statement each of which would affect a number of rows. If you are wanting to count of all rows affected you are going to have to put in a lot of code here to pull that off."}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501702066, "post_id": 45465597, "comment_id": 77899698, "body": "There are multiple procedure running in procedure i get the output as 1200 rows affected, 1500 rows affected, 2000 rows affected   and error like type conversion error"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501702088, "post_id": 45465597, "comment_id": 77899713, "body": "And the procedure cannot run further"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501702167, "post_id": 45465597, "comment_id": 77899759, "body": "I am making a connection through vba and in it i am importing data through ssis package and then running a procedure"}, {"owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "edited": false, "score": 0, "creation_date": 1501702193, "post_id": 45465597, "comment_id": 77899780, "body": "Running procedure in sql server"}], "owner": {"reputation": 1, "user_id": 8406687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ad76ed487160828315b33d68b6c678?s=128&d=identicon&r=PG", "display_name": "user8406687", "link": "https://stackoverflow.com/users/8406687/user8406687"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501702514, "creation_date": 1501689295, "last_edit_date": 1531164843, "question_id": 45465597, "link": "https://stackoverflow.com/questions/45465597/sql-server-and-visual-basic-important-connection", "title": "SQL Server and visual basic important connection", "body": "<p>I have connected vba to SQL Server with an ADODB connection, I am running a procedure with it what I want is the message from SQL Server like \"5 rows affected\", \"10 rows affected\" or in case of error \"conversion failed\" with msg number is vba msgbox. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501689651, "post_id": 45465526, "comment_id": 77892277, "body": "Your last <code>&amp; rowCount</code> is inside the double quotes. Currently: <code>&#39;XX&#39;!$E$4:$E$ &amp; rowCount),2,0)&quot;</code>. Should be: <code>&#39;XX&#39;!$E$4:$E$&quot; &amp; rowCount &amp; &quot;),2,0)&quot;</code>"}, {"owner": {"reputation": 33, "user_id": 6383975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e0f05d5ec6278efa6d0e6dbe3409b?s=128&d=identicon&r=PG&f=1", "display_name": "Isayah", "link": "https://stackoverflow.com/users/6383975/isayah"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501690966, "post_id": 45465526, "comment_id": 77893121, "body": "Oh right, thanks. I missed that part. but still got the same error."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501691700, "post_id": 45465526, "comment_id": 77893543, "body": "What is this extra <code>&amp;</code> doing in here: <code>$A&quot; &amp; i &amp; &quot;&amp;&quot; </code> the one between double quotes."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501691937, "post_id": 45465526, "comment_id": 77893694, "body": "I would put that whole formula into the immediate window and see what&#39;s wrong with it. <code>debug.print &quot;=VLOOKUP($A&quot; &amp; i &amp; &quot;&amp;&quot; &amp; UserForm1.TextBox1.Value &amp; &quot;,CHOOSE({1,2},&#39;XX&#39;!$B$4:$B$&quot; &amp; rowCount &amp; &quot;&amp;&#39;XX&#39;!$H$4:$H$&quot; &amp; rowCount &amp; &quot;,&#39;XX&#39;!$E$4:$E$ &amp; rowCount),2,0)&quot;</code> right before you set it. Something is wrong with whatever formula this is producing and causing VBA to error out."}, {"owner": {"reputation": 33, "user_id": 6383975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e0f05d5ec6278efa6d0e6dbe3409b?s=128&d=identicon&r=PG&f=1", "display_name": "Isayah", "link": "https://stackoverflow.com/users/6383975/isayah"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501692027, "post_id": 45465526, "comment_id": 77893755, "body": "It would be something like this  &quot;=VLOOKUP($A3 &amp; &quot;&quot;201708&quot;&quot;,CHOOSE({1,2},&#39;XX&#39;!$B$4:$B$7669 &amp;&#39;XX&#39;!$H$4:$H$7669,&#39;XX&#39;!$E$4:$E$7669),2,0)&quot;"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501692214, "post_id": 45465526, "comment_id": 77893876, "body": "Does the userform1.textbox1.value have the double quotes around it or is it just passing in a string free of quotes? I think, again, an output of the actual result of the string concatenation would make the issue visible."}, {"owner": {"reputation": 33, "user_id": 6383975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e0f05d5ec6278efa6d0e6dbe3409b?s=128&d=identicon&r=PG&f=1", "display_name": "Isayah", "link": "https://stackoverflow.com/users/6383975/isayah"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1501692838, "post_id": 45465526, "comment_id": 77894240, "body": "Oh I see, it was a mistake on my part. Fixed."}], "owner": {"reputation": 33, "user_id": 6383975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e0f05d5ec6278efa6d0e6dbe3409b?s=128&d=identicon&r=PG&f=1", "display_name": "Isayah", "link": "https://stackoverflow.com/users/6383975/isayah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 479, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501689104, "creation_date": 1501689104, "last_edit_date": 1531164843, "question_id": 45465526, "link": "https://stackoverflow.com/questions/45465526/vba-error-unable-to-set-the-formulaarray-property-of-the-range-class", "title": "VBA Error: unable to set the formulaarray property of the range class", "body": "<p>I recently tried using this array formula through VBA but kept getting this error. How can I resolve this issue?</p>\n\n<p>This is the line I have problem with.</p>\n\n<pre><code>YY.Cells(i, \"C\").FormulaArray = \"=VLOOKUP($A\" &amp; i &amp; \"&amp;\" &amp; UserForm1.TextBox1.Value &amp; \",CHOOSE({1,2},'XX'!$B$4:$B$\" &amp; rowCount &amp; \"&amp;'XX'!$H$4:$H$\" &amp; rowCount &amp; \",'XX'!$E$4:$E$ &amp; rowCount),2,0)\"\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "ado"], "comments": [{"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 0, "creation_date": 1501690246, "post_id": 45465469, "comment_id": 77892673, "body": "Can you step through in debugger and tell us on which line and with which Param.Name it throws error?"}, {"owner": {"reputation": 23, "user_id": 2574217, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b85d8f42f5584a8888d57c9f5867ef95?s=128&d=identicon&r=PG", "display_name": "Mike D", "link": "https://stackoverflow.com/users/2574217/mike-d"}, "reply_to_user": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 0, "creation_date": 1501691292, "post_id": 45465469, "comment_id": 77893295, "body": "Hi Jonathan, my apologies, I wasn&#39;t very clear in my post. No errors get thrown for any of the parameters. It&#39;s when cmd.Execute is reached for the second time that the error is thrown. For some reason, the first time cmd.Execute is executed it works."}, {"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 0, "creation_date": 1501692016, "post_id": 45465469, "comment_id": 77893750, "body": "Can you show us the first two lines of data that you are inserting?  It definitely sounds like a data error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501693525, "post_id": 45465469, "comment_id": 77894702, "body": "If you swap the first and second rows of data does it still fail on the second row?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1501761089, "post_id": 45465469, "comment_id": 77927124, "body": "Where is <i>dy</i> object defined? Please post full code even sample data for reproducibility."}], "owner": {"reputation": 23, "user_id": 2574217, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b85d8f42f5584a8888d57c9f5867ef95?s=128&d=identicon&r=PG", "display_name": "Mike D", "link": "https://stackoverflow.com/users/2574217/mike-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501703562, "creation_date": 1501688935, "last_edit_date": 1501703562, "question_id": 45465469, "link": "https://stackoverflow.com/questions/45465469/reusing-ado-command-object-second-execute-fails", "title": "Reusing ADO Command Object - Second Execute Fails", "body": "<p>I'm attempting to reuse an ADO Command object to run the same query on multiple records from an excel sheet. As it stands, the code works when I delete the parameters and re-add them, but if I add the parameters outside of the loop one time and then attempt to change the values, I get a \"Data type mismatch in criteria expression\" error on the cmd.Execute line. Strangely, the first time cmd.Execute is executed, there is no error. It is on the second attempt to run cmd.Execute that the error is thrown. I'm not sure why I'm getting this when I change nothing else except the constant deletion and addition of the parameters. Here is a snippet of the code in the form that fails, with the parameter addition outside of the loop:</p>\n\n<pre><code>    cmd.CommandText = \"INSERT INTO tblSALES VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\"\ncmd.ActiveConnection = conn\n\ntrxLevel = conn.BeginTrans\n\nWith cmd.Parameters\n    .Append cmd.CreateParameter(\"Customer\", adWChar, adParamInput, 10)\n    .Append cmd.CreateParameter(\"Item Code\", adWChar, adParamInput, 8)  \n    .Append cmd.CreateParameter(\"Start Date\", adDate, adParamInput, 10)\n    .Append cmd.CreateParameter(\"End Date\", adDate, adParamInput, 10)\n\n    .Append cmd.CreateParameter(\"Customer Sell-to\", adWChar, adParamInput, 10)\n    .Append cmd.CreateParameter(\"Invoice Id\", adInteger, adParamInput)\n    .Append cmd.CreateParameter(\"Invoice Date\", adDate, adParamInput, 10)\n    .Append cmd.CreateParameter(\"Order Date\", adDate, adParamInput, 10)\n    .Append cmd.CreateParameter(\"Order Number\", adWChar, adParamInput, 10)\n    .Append cmd.CreateParameter(\"PO Number\", adWChar, adParamInput, 100)\n    .Append cmd.CreateParameter(\"Trx Src Type\", adWChar, adParamInput, 20)\n    .Append cmd.CreateParameter(\"Order Type\", adWChar, adParamInput, 10)\n    .Append cmd.CreateParameter(\"Invoice Dtl Id\", adInteger, adParamInput, 10)\n    .Append cmd.CreateParameter(\"Ship To\", adWChar, adParamInput, 6)\n    .Append cmd.CreateParameter(\"Is Crossdock\", adBoolean, adParamInput, 10)\n    .Append cmd.CreateParameter(\"Division\", adWChar, adParamInput, 2)\n    .Append cmd.CreateParameter(\"Dept\", adWChar, adParamInput, 3)\n    .Append cmd.CreateParameter(\"Sales Rep\", adWChar, adParamInput, 5)\n    .Append cmd.CreateParameter(\"PL2\", adWChar, adParamInput, 2)\n    .Append cmd.CreateParameter(\"PL3\", adWChar, adParamInput, 3)\n    .Append cmd.CreateParameter(\"PL4\", adWChar, adParamInput, 4)\n    .Append cmd.CreateParameter(\"MDSE Grp\", adWChar, adParamInput, 5)\n    .Append cmd.CreateParameter(\"COA Prod Cd\", adWChar, adParamInput, 2)\n    .Append cmd.CreateParameter(\"Set Mdse Code\", adWChar, adParamInput, 8)\n    .Append cmd.CreateParameter(\"Line Sub Pos\", adInteger, adParamInput)\n    .Append cmd.CreateParameter(\"Price\", adCurrency, adParamInput)\n    .Append cmd.CreateParameter(\"Discount Price\", adCurrency, adParamInput)\n    .Append cmd.CreateParameter(\"Qty\", adInteger, adParamInput)\n    .Append cmd.CreateParameter(\"Amt\", adCurrency, adParamInput)\nEnd With\n\ncmd.Parameters(\"Start Date\").Value = Trim(StartDate(1))\ncmd.Parameters(\"End Date\").Value = Trim(EndDate(1))\n\nFor x = 2 To lrow\n    If sht.Rows(x).EntireRow.Hidden = True Then\n        GoTo nextIter\n    End If\n    If sht.Cells(x, 1).Value = \"TOTAL\" Then\n        GoTo nextIter\n    End If\n\n    For Each param In cmd.Parameters\n        If Not param.Name = \"Start Date\" And Not param.Name = \"End Date\" Then\n            If param.Name = \"Is Crossdock\" Then\n                param.Value = IIf(sht.Cells(x, dy.Item(param.Name)).Value = \"Yes\", True, False)\n            ElseIf param.Name = \"Division\" Then\n                arr = Split(sht.Cells(x, dy.Item(param.Name)).Value, \"-\")\n                param.Value = Trim(arr(0))\n            ElseIf param.Name = \"Set Mdse Code\" Or param.Name = \"Item Code\" Then\n                If IsEmpty(sht.Cells(x, dy.Item(param.Name)).Value) Or sht.Cells(x, dy.Item(param.Name)).Value = \"\" Then\n                    param.Value = \"(blank)\"\n                Else\n                    param.Value = Left(sht.Cells(x, dy.Item(param.Name)).Value, Len(sht.Cells(x, dy.Item(param.Name)).Value) - 2)\n                End If\n            ElseIf param.Name = \"Order Type\" And (IsEmpty(sht.Cells(x, orderType.Column).Value) Or sht.Cells(x, orderType.Column).Value = \"\") Then\n                param.Value = \"(blank)\"\n            Else\n                param.Value = sht.Cells(x, dy.Item(param.Name)).Value\n            End If\n        End If\n    Next param\n    cmd.Execute\nNextIter:\nNext x\n</code></pre>\n"}, {"tags": ["sql", "vba", "connection", "ado", "adodb"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1501688559, "post_id": 45465280, "comment_id": 77891494, "body": "Download the file then open it as you currently are, file paths and URLs are not universally interchangeable."}, {"owner": {"reputation": 1, "user_id": 8406575, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210479707133860/picture?type=large", "display_name": "Aaron Leighfield", "link": "https://stackoverflow.com/users/8406575/aaron-leighfield"}, "edited": false, "score": 0, "creation_date": 1501688814, "post_id": 45465280, "comment_id": 77891663, "body": "I&#39;m using this within an Excel document to run a SQL query and return information. Can anyone propose how I might do this given what I&#39;m trying to achieve?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1501689196, "post_id": 45465280, "comment_id": 77891951, "body": "<a href=\"https://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer\">How do i download a file using VBA</a>?"}, {"owner": {"reputation": 1, "user_id": 8406575, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210479707133860/picture?type=large", "display_name": "Aaron Leighfield", "link": "https://stackoverflow.com/users/8406575/aaron-leighfield"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1501689407, "post_id": 45465280, "comment_id": 77892105, "body": "Thanks Alex - but the file is 70MB and growing, expecting all users to download is a bit of a tall order :o/"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1501689781, "post_id": 45465280, "comment_id": 77892368, "body": "Well even if OLEDB did support HTTP URLs it would <i>still</i> have to internally download the file in order to read it.  A basic file at a URL is not the same thing as a file on a file system that can be randomly accessed. This sounds like a job for a remote database server."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501690485, "post_id": 45465280, "comment_id": 77892823, "body": "If you&#39;re working on a company network then consider downloading the file to a central location that other people can access it from.  There&#39;s no other way to do this (i.e it must be downloaded first).  You can set up a scheduled task to update the file on a regular basis."}], "owner": {"reputation": 1, "user_id": 8406575, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210479707133860/picture?type=large", "display_name": "Aaron Leighfield", "link": "https://stackoverflow.com/users/8406575/aaron-leighfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501688854, "creation_date": 1501688395, "last_edit_date": 1501688854, "question_id": 45465280, "link": "https://stackoverflow.com/questions/45465280/ado-connection-and-recordset-with-http-data-source", "title": "ADO Connection and Recordset with HTTP data source", "body": "<p>I have the below Macro reading from a Database table stored as a txt file on the local C drive and returning an SQL query.</p>\n\n<pre><code>Public Function getData(fileName As String) As ADODB.Recordset\n\nDim cN As ADODB.Connection\nDim RS As ADODB.Recordset\nSet cN = New ADODB.Connection\nSet RS = New ADODB.Recordset\ncN.Open (\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\Cloud\\;Persist \nSecurity Info=False;Extended Properties=\"\"text; HDR=Yes; FMT=Delimited; \nIMEX=1;\"\"\")\nRS.ActiveConnection = cN\nRS.Source = \"select top 10 * from \" &amp; fileName\nSet getData = RS\n\nEnd Function\n</code></pre>\n\n<p>I can then call the function and return data using the below, so far so good...</p>\n\n<pre><code>Sub Cloud()\n\nDim a As ADODB.Recordset\nSet a = getData(\"file.txt\")\na.Open\nMsgBox (a.GetString())\na.Close\n\nEnd Sub\n</code></pre>\n\n<p>BUT now I would like to move 'file.txt' from C:\\Cloud\\ to a HTTP location, ie <a href=\"http://it.wont.work/\" rel=\"nofollow noreferrer\">http://it.wont.work/</a></p>\n\n<p>How would I amend the above for this to work? I've searched and tested but nothing seems to work... I either get internet login failed or ISAM not found.</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "sap-gui"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1501689283, "post_id": 45465172, "comment_id": 77892000, "body": "Maybe something like this: <a href=\"https://stackoverflow.com/questions/37065764/how-to-check-until-file-exist\" title=\"how to check until file exist\">stackoverflow.com/questions/37065764/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1501747133, "post_id": 45465172, "comment_id": 77916730, "body": "Thanks for your input Ryan. Unfortunately this doesn&#39;t work either, because the file does exist, but just isn&#39;t open yet.   Therefore I tried checking if the file is open already and then executing the loop using <a href=\"https://stackoverflow.com/questions/9373082/detect-whether-excel-workbook-is-already-open\" title=\"detect whether excel workbook is already open\">stackoverflow.com/questions/9373082/&hellip;</a> . The code above is updated to reflect this.  Unfortunately, this keeps the code looping because the workbook still won&#39;t open."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1501769646, "post_id": 45465172, "comment_id": 77934440, "body": "You can always iterate the workbooks collection looking for the file of interest. You can check the .FullName property to see if this matches the file of interest."}, {"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1501771005, "post_id": 45465172, "comment_id": 77935690, "body": "Unfortunately this doesn&#39;t seem to work, also not with .fullname. The problem is that excel is stuck in a state where it is still downloading the export from SAP. I snapped a picture of it in the link below  <a href=\"https://postimg.org/image/70mqchddl/\" rel=\"nofollow noreferrer\">postimg.org/image/70mqchddl</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1501772904, "post_id": 45465172, "comment_id": 77937310, "body": "Perhaps do a loop checking the filesize until it stops increasing?"}], "answers": [{"comments": [{"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1501756680, "post_id": 45480681, "comment_id": 77923913, "body": "Hi Thomas, what is the parameter by wshell.run?"}, {"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501761384, "post_id": 45480681, "comment_id": 77927373, "body": "Hello again. I deleted my comment since I found out that I indeed used a wrong parameter. Sorry for that.  However, the export workbook still only opens after I completed all my code, now after Exportinvest_1().."}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501763457, "post_id": 45480681, "comment_id": 77928969, "body": "This is already worth a lot. If everything is running properly, excel.exe will only appear once in Windows Task Manager. You could also experiment with xclapp.visible = true in myTest.vbs or with the order of the commands in ExportInvest_1: workbooks(...).activate and then msgbox &quot;file open&quot;."}, {"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501768912, "post_id": 45480681, "comment_id": 77933775, "body": "Well, since the workbook with exported data from sap won&#39;t open untill all code including ExportInvest_1 is executed, I cannot copy any data to myTest.xlsm. Therefore it will always result in a subscript out of range error."}, {"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501771462, "post_id": 45480681, "comment_id": 77936124, "body": "I suspect this is related to the following:  The problem is that excel is stuck in a state where it is still downloading the export from SAP. I snapped a picture of it in the link below postimg.org/image/70mqchddl"}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 0, "last_activity_date": 1501754742, "last_edit_date": 1501754742, "creation_date": 1501753805, "answer_id": 45480681, "question_id": 45465172, "link": "https://stackoverflow.com/questions/45465172/export-sap-to-excel-completely-via-vba/45480681#45480681", "title": "Export SAP to excel completely via VBA", "body": "<p>I would solve it as follows:</p>\n\n<p>ExportInvest: (in myTest.xlsm)</p>\n\n<pre><code>. . .\nsession.findById(\"wnd[1]/usr/ctxtDY_PATH\").Text = \"S:\\FL_DMA\\SAP Scripts\\test\\backup\"\nsession.findById(\"wnd[1]/usr/ctxtDY_FILENAME\").Text = FileName\nsession.findById(\"wnd[1]/tbar[0]/btn[0]\").press\n\n'new commands\nSet wshell = CreateObject(\"Wscript.Shell\")\nwshell.Run \"c:\\tmp\\myTest.vbs\" &amp; \" \" &amp; \"myTest.xlsm\"\nEnd Sub\n</code></pre>\n\n<p>myTest.vbs:</p>\n\n<pre><code>set xclapp = getObject(,\"Excel.Application\")\nxclapp.Run wscript.arguments(0) &amp; \"!ExportInvest_1\"\n</code></pre>\n\n<p>ExportInvest_1: (in myTest.xlsm)</p>\n\n<pre><code>Sub ExportInvets_1()\n    Dim Today as String\n    Today = Format$(DateTime.Now, \"yyyymmdd__hh-MM-ss\")\n\n    MsgBox \"file open\", vbOKOnly, \"\"\n    Workbooks(\"Invest_\" &amp; Today).Activate\n    Worksheets(1).Range(\"A2:K100\").Select\n    Selection.Copy ThisWorkbook.Worksheets(\"Input\").Range(\"A2:K100\")\nEnd Sub\n</code></pre>\n\n<p>Regards,\nScriptMan</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501833541, "post_id": 45499658, "comment_id": 77963194, "body": "Hi ScriptMan,  Thank you very much! The only issue that remained was that the variable &#39;Today&#39; is different in ExportInvest_1, since it is executed at a different time. I solved this by finding the newest file in the map where I download the export file, using <a href=\"http://spreadsheetpage.com/index.php/tip/identifying_the_newest_file_in_a_directory/\" rel=\"nofollow noreferrer\">spreadsheetpage.com/index.php/tip/&hellip;</a>"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501835073, "post_id": 45499658, "comment_id": 77964127, "body": "Hi Thomas, another possibility would be to define FileName as public. Please see my changes above."}, {"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501839336, "post_id": 45499658, "comment_id": 77967134, "body": "Thanks. In the meantime I have ran into another problem however. What if the the filename (in your case MyTest.xlsm) of the workbook changes each day. How would I adapt myTest.vbs to reflect that?   Sorry if I am bugging you ,but I have virtually no professional experience with this :)"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501840598, "post_id": 45499658, "comment_id": 77968114, "body": "ExportInvest: wshell.Run &quot;c:\\tmp\\myTest.vbs&quot; &amp; &quot; &quot; &amp; ActiveWorkBook.Name &amp; &quot; &quot; &amp; FileName ;)"}, {"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501841823, "post_id": 45499658, "comment_id": 77968990, "body": "Yes, I&#39;ve tried that but I get the error: Cannot run the Macro. This while the String: &#39;999INVEST2017-08-04.xlsm!thisworkbook.ExportInvest_1&#39; is correct. Any idea what might cause this?"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501846550, "post_id": 45499658, "comment_id": 77972187, "body": "a workaround: ExportInvest_1 in a modul and then  &#39;999INVEST2017-08-04.xlsm!ExportInvest_1&#39;"}, {"owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501849728, "post_id": 45499658, "comment_id": 77974415, "body": "Hi Scriptman, apparently the &quot;-&quot; in the dates  of the string caused an issue. When I save the workbook to 999INVEST20170804.xlsm I don&#39;t encounter any issues. But now, my very last problem:  The MyTest.VBS is located on a shared disc that can be accessed by other users. When they want to execute my code however excel crashes as soon as it reaches wshell.run. Any thoughts what might cause this?  Also, I will be forever in your debt if you can answer this for me as well :)"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "edited": false, "score": 0, "creation_date": 1501936389, "post_id": 45499658, "comment_id": 78004103, "body": "Hopefully it is not because the path at wshell.run contains a space. In this case, the call should look as follows: wshell.Run &quot;&quot;&quot;path with spaces.myTest.vbs&quot;&quot;&quot; &amp; ..."}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": true, "score": 0, "last_activity_date": 1501835296, "last_edit_date": 1501835296, "creation_date": 1501828233, "answer_id": 45499658, "question_id": 45465172, "link": "https://stackoverflow.com/questions/45465172/export-sap-to-excel-completely-via-vba/45499658#45499658", "title": "Export SAP to excel completely via VBA", "body": "<p>Sorry, I used only a small amount of data for my tests. Therefore, an extension must now be incorporated into the proposed construction. </p>\n\n<p>for example:</p>\n\n<p>ExportInvest: (in myTest.xlsm)</p>\n\n<pre><code>. . .\n'Dim FileName As String\n. . .\nsession.findById(\"wnd[1]/usr/ctxtDY_PATH\").Text = \"S:\\FL_DMA\\SAP Scripts\\test\\backup\"\nsession.findById(\"wnd[1]/usr/ctxtDY_FILENAME\").Text = FileName\nsession.findById(\"wnd[1]/tbar[0]/btn[0]\").press\n\nSet wshell = CreateObject(\"Wscript.Shell\")\n'-----------------------------------------new\nwshell.Run \"c:\\tmp\\myTest.vbs\" &amp; \" \" &amp; \"myTest.xlsm\" &amp; \" \" &amp; FileName\n'-----------------------------------------new\nEnd Sub\n</code></pre>\n\n<p>myTest.vbs:</p>\n\n<pre><code>set xclapp = getObject(,\"Excel.Application\")\n\n'-----------------------------------------new\non error resume next\ndo \n err.clear\n Set xclwbk = xclApp.Workbooks.Item(wscript.arguments(1))\n If Err.Number = 0 Then exit do\n wscript.sleep 2000\nloop\non error goto 0\n'-----------------------------------------new\n\nxclapp.Run wscript.arguments(0) &amp; \"!ExportInvest_1\"\n</code></pre>\n\n<p>ExportInvest_1: (in myTest.xlsm)</p>\n\n<pre><code>Public FileName as String\n\nSub ExportInvets_1()\n 'Dim Today as String\n 'Today = Format$(DateTime.Now, \"yyyymmdd__hh-MM-ss\")\n\n MsgBox \"file open\", vbOKOnly, \"\"\n Workbooks(FileName).Activate\n Worksheets(1).Range(\"A2:K100\").Select\n Selection.Copy ThisWorkbook.Worksheets(\"Input\").Range(\"A2:K100\")\nEnd Sub\n</code></pre>\n\n<p>Regards, ScriptMan</p>\n"}], "owner": {"reputation": 3, "user_id": 8406271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8609ecd73826c7bfe0af4587d364d5bd?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Ossenblok", "link": "https://stackoverflow.com/users/8406271/thomas-ossenblok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12578, "favorite_count": 0, "accepted_answer_id": 45499658, "answer_count": 2, "score": 0, "last_activity_date": 1602929113, "creation_date": 1501688112, "last_edit_date": 1602929113, "question_id": 45465172, "link": "https://stackoverflow.com/questions/45465172/export-sap-to-excel-completely-via-vba", "title": "Export SAP to excel completely via VBA", "body": "<p>I hope you can assist me with the code below. I am trying to export a report from SAP using a recorded SAP GUI Script via VBA on a daily basis. Subsequently I want to copy the data to another workbook and do some reformatting/calculations with it. However, the excel export file will only open after I have fully completed my macro.</p>\n<p>Using for instance ShellAndWait <a href=\"http://www.cpearson.com/excel/ShellAndWait.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/ShellAndWait.aspx</a> assumes that it is an outside application, but I would like to find a solution in which I can keep everything in 1 file.</p>\n<p>Thanks in advance for your assistance!</p>\n<p>Edit: Solved! Thanks to Scriptman.</p>\n<p>ExportInvest</p>\n<pre><code>Public Sub ExportInvest()\n\nDim Today As String\nDim FileName As String\nDim Ret\n\nToday = Format$(DateTime.Now, &quot;yyyymmdd__hh-MM-ss&quot;)\nFileName = &quot;Invest_&quot; &amp; Today &amp; &quot;.xml&quot;\n\nSet SapGuiAuto = GetObject(&quot;SAPGUI&quot;)  'Get the SAP GUI Scripting object\nSet SAPApp = SapGuiAuto.GetScriptingEngine 'Get the currently running SAP GUI\nSet SAPCon = SAPApp.Children(0) 'Get the first system that is currently connected\nSet session = SAPCon.Children(0) 'Get the first session (window) on that connection\n\nsession.findById(&quot;wnd[0]/tbar[0]/okcd&quot;).Text = &quot;/nzx03&quot;\nsession.findById(&quot;wnd[0]&quot;).sendVKey 0\nsession.findById(&quot;wnd[0]/tbar[1]/btn[17]&quot;).press\nsession.findById(&quot;wnd[1]/usr/txtENAME-LOW&quot;).Text = &quot;TXO4074&quot;\nsession.findById(&quot;wnd[1]/usr/txtENAME-LOW&quot;).SetFocus\nsession.findById(&quot;wnd[1]/tbar[0]/btn[8]&quot;).press\nsession.findById(&quot;wnd[0]/tbar[1]/btn[8]&quot;).press\nsession.findById(&quot;wnd[0]/mbar/menu[0]/menu[1]/menu[1]&quot;).Select\nsession.findById(&quot;wnd[1]/usr/ctxtDY_PATH&quot;).Text = &quot;S:\\FL_DMA\\SAP Scripts\\test\\backup&quot;\nsession.findById(&quot;wnd[1]/usr/ctxtDY_FILENAME&quot;).Text = FileName\nsession.findById(&quot;wnd[1]/tbar[0]/btn[0]&quot;).press\n\nSet wshell = CreateObject(&quot;Wscript.Shell&quot;)\nwshell.Run &quot;C:\\Users\\txo4074\\Documents\\Projects\\SAPscriptINVEST\\myTest.vbs&quot; &amp; &quot; &quot; &amp; &quot;999Invest.xlsm&quot; &amp; &quot; &quot; &amp; FileName\n\nEnd Sub\n</code></pre>\n<p>MyTest.vbs</p>\n<pre><code>set xclapp = getObject(,&quot;Excel.Application&quot;)\n\non error resume next\ndo \n    err.clear\n    Set xclwbk = xclApp.Workbooks.Item(wscript.arguments(1))\n    If Err.Number = 0 Then exit do\n    wscript.sleep 2000\nloop\non error goto 0\n\nxclapp.Run wscript.arguments(0) &amp; &quot;!ThisWorkbook.ExportInvest_1&quot;\n</code></pre>\n<p>ExportInvest_1</p>\n<pre><code>Sub ExportInvest_1()\n\n\nFileName = NewestFile(&quot;S:\\FL_DMA\\SAP Scripts\\test\\backup&quot;, &quot;****&quot;)\n   \nWorkbooks(Left(FileName, 25)).Worksheets(1).Activate\nRange(&quot;A2:K100&quot;).Select\nSelection.Copy ThisWorkbook.Worksheets(&quot;Input&quot;).Range(&quot;A2:K100&quot;)\nWorkbooks(Left(FileName, 25)).Close\nThisWorkbook.Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1501802182, "post_id": 45464507, "comment_id": 77953327, "body": "I figured it out, just had to adjust my"}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1501802188, "post_id": 45464507, "comment_id": 77953328, "body": ".ScrollHeight = .InsideHeight * 2.75"}], "owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501751905, "creation_date": 1501686357, "last_edit_date": 1501751905, "question_id": 45464507, "link": "https://stackoverflow.com/questions/45464507/cannot-get-my-image-and-frame-height-to-match-up", "title": "Cannot get my image and frame height to match up", "body": "<p>I have an image within a frame with a scrollbar on the frame.  I am having trouble getting the image and frame the same height.  It works perfectly, but I have this huge space at the bottom of my frame under the image.  Not sure how to fix this?</p>\n\n<p>Hope this is enough info: userform =RejectSamples (H 606, W 708); Frame = Frame1 (H 540, W 684); Image = Image2 (H 800, W 612)</p>\n\n<pre><code> Private Sub UserForm_Activate()\n'Name of the frame\n With Me.Frame1\n'This will create a vertical scrollbar\n.ScrollBars = fmScrollBarsVertical\n\n'Change the values of 2 as Per your requirements\n.ScrollHeight = .InsideHeight * 2\n.ScrollWidth = .InsideWidth * 5\n End With\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501686607, "post_id": 45464439, "comment_id": 77889947, "body": "Create a copy of the worksheet, which will preserve the code in its module. For firing the Change event handler, you need to provide more detail like under what circumstance should it trigger?"}, {"owner": {"reputation": 13, "user_id": 8222230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a2e0ca2370062e28b516d9602e70473?s=128&d=identicon&r=PG&f=1", "display_name": "Midas", "link": "https://stackoverflow.com/users/8222230/midas"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501686767, "post_id": 45464439, "comment_id": 77890086, "body": "@David Zemens  It is an worksheet change event.  It looks for when a column in the worksheet changes and then fires the code.  Is there a way to copy the code to a different sheet vs having to always keep the same sheet?  The sheet I am wanting to move it too will have different information on it."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501686826, "post_id": 45464439, "comment_id": 77890136, "body": "<a href=\"https://stackoverflow.com/questions/24701517/copy-vba-code-from-one-worksheet-to-another-using-vba-code\" title=\"copy vba code from one worksheet to another using vba code\">stackoverflow.com/questions/24701517/&hellip;</a> this shows you how to copy code from one sheet to another. It&#39;s still not clear when you want to fire the Change event if there is not actually a Change event that occurs."}, {"owner": {"reputation": 13, "user_id": 8222230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a2e0ca2370062e28b516d9602e70473?s=128&d=identicon&r=PG&f=1", "display_name": "Midas", "link": "https://stackoverflow.com/users/8222230/midas"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501689484, "post_id": 45464439, "comment_id": 77892158, "body": "because I want for it to be a change event after the first time.  I just want for it to have worked once beforehand.   Is there a way to cut instead of copy?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1501689585, "post_id": 45464439, "comment_id": 77892234, "body": "After <i>what</i> &quot;first time&quot;? How do you want the &quot;first time&quot; to happen? You can use the VBE Extensibility library also to remove code from modules. There is no direct &quot;cut&quot; method, but you can remove modules or lines within modules. I would suggest making a go at it, and asking a new question if you have specific implementation problems or errors."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8222230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a2e0ca2370062e28b516d9602e70473?s=128&d=identicon&r=PG&f=1", "display_name": "Midas", "link": "https://stackoverflow.com/users/8222230/midas"}, "edited": false, "score": 0, "creation_date": 1501686515, "post_id": 45464532, "comment_id": 77889881, "body": "Is there a way to just copy the backend code to a different worksheet?  The sheet I add in everyday is not blank.  It always has new information on it.  It would be nice to be able to just add the back end code."}, {"owner": {"reputation": 665, "user_id": 6173619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18713c0445782b002464a446e13224e6?s=128&d=identicon&r=PG&f=1", "display_name": "helpME1986", "link": "https://stackoverflow.com/users/6173619/helpme1986"}, "reply_to_user": {"reputation": 13, "user_id": 8222230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a2e0ca2370062e28b516d9602e70473?s=128&d=identicon&r=PG&f=1", "display_name": "Midas", "link": "https://stackoverflow.com/users/8222230/midas"}, "edited": false, "score": 1, "creation_date": 1501686651, "post_id": 45464532, "comment_id": 77889986, "body": "<a href=\"https://stackoverflow.com/questions/18497527/copy-vba-code-from-a-sheet-in-one-workbook-to-another\" title=\"copy vba code from a sheet in one workbook to another\">stackoverflow.com/questions/18497527/&hellip;</a>"}], "tags": [], "owner": {"reputation": 665, "user_id": 6173619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18713c0445782b002464a446e13224e6?s=128&d=identicon&r=PG&f=1", "display_name": "helpME1986", "link": "https://stackoverflow.com/users/6173619/helpme1986"}, "is_accepted": false, "score": 1, "last_activity_date": 1501686403, "creation_date": 1501686403, "answer_id": 45464532, "question_id": 45464439, "link": "https://stackoverflow.com/questions/45464439/how-do-you-cut-not-copy-event-subs-to-a-different-worksheet-using-vba-programa/45464532#45464532", "title": "How do you cut (not copy) event subs to a different worksheet using VBA programatically?", "body": "<p>You could create a template worksheet withn your VBA code consisting your Worksheet_Change functions. Make it hidden. Then every day you may save it as a new one and delete the old one.</p>\n"}], "owner": {"reputation": 13, "user_id": 8222230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a2e0ca2370062e28b516d9602e70473?s=128&d=identicon&r=PG&f=1", "display_name": "Midas", "link": "https://stackoverflow.com/users/8222230/midas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1501686762, "answer_count": 1, "score": 0, "last_activity_date": 1501688058, "creation_date": 1501686158, "last_edit_date": 1501688058, "question_id": 45464439, "link": "https://stackoverflow.com/questions/45464439/how-do-you-cut-not-copy-event-subs-to-a-different-worksheet-using-vba-programa", "closed_reason": "Duplicate", "title": "How do you cut (not copy) event subs to a different worksheet using VBA programatically?", "body": "<p><br/> I have a workbook that will be making a new sheet daily and deleting an old one.  I would like to cut the \"Worksheet_Change\" sub and move it to the new sheet?  How can I move this code programmatically so that it is not a manual process.  Also is there a way to programmatically make the \"Worksheet_Change\" function activate once with VBA vs. having to click in a cell?</p>\n\n<p>Thanks in Advance,<br/>\nMidas</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1501686607, "post_id": 45464284, "comment_id": 77889948, "body": "Well, I&#39;m not sure how to compress it, but I do know you can compress visual space by putting them all of them same line - ActiveSheet.Range(&quot;$A$1:$AK$50000&quot;).AutoFilter Field:=3, Criteria1:=&quot;&gt;2.5&quot;, for example"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1501687439, "creation_date": 1501687439, "answer_id": 45464917, "question_id": 45464284, "link": "https://stackoverflow.com/questions/45464284/autofilter-for-multiple-fields-in-vba/45464917#45464917", "title": "Autofilter for multiple fields in VBA", "body": "<p>This is a bit cleaner:</p>\n\n<pre><code>With Range(\"A1\").CurrentRegion\n    .AutoFilter 5, \"1\"\n    .AutoFilter 6, \"&gt;0\"\nEnd With\n</code></pre>\n\n<p>You can add back in the identifier if you like. <code>VisibleDropDown = True</code> by default so you it's not needed.</p>\n\n<p>Otherwise, you cannot AutoFilter multiple fields in the same line.</p>\n"}], "owner": {"reputation": 45, "user_id": 5014540, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c3ba4c817422fa2b243b8da667a29e62?s=128&d=identicon&r=PG&f=1", "display_name": "Rossy", "link": "https://stackoverflow.com/users/5014540/rossy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2529, "favorite_count": 0, "accepted_answer_id": 45464917, "answer_count": 1, "score": 0, "last_activity_date": 1501687439, "creation_date": 1501685731, "last_edit_date": 1531164843, "question_id": 45464284, "link": "https://stackoverflow.com/questions/45464284/autofilter-for-multiple-fields-in-vba", "title": "Autofilter for multiple fields in VBA", "body": "<p>I'm trying to apply an autofilter to a set of data that filters by two columns.  Is there a more efficient way than what I've written below that processes both fields in one statement rather than having to write another block that's effectively the same and making the code quite lengthy?</p>\n\n<pre><code>Range(\"A1\").CurrentRegion.AutoFilter _\nField:=5, _\nCriteria1:=\"1\", _\nVisibleDropDown:=True\n\nRange(\"A1\").CurrentRegion.AutoFilter _\nField:=6, _\nCriteria1:=\"&gt;0\", _\nVisibleDropDown:=True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 665, "user_id": 6173619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18713c0445782b002464a446e13224e6?s=128&d=identicon&r=PG&f=1", "display_name": "helpME1986", "link": "https://stackoverflow.com/users/6173619/helpme1986"}, "edited": false, "score": 0, "creation_date": 1501687246, "post_id": 45464200, "comment_id": 77890476, "body": "are both files opened under the same instation of excel?"}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "reply_to_user": {"reputation": 665, "user_id": 6173619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18713c0445782b002464a446e13224e6?s=128&d=identicon&r=PG&f=1", "display_name": "helpME1986", "link": "https://stackoverflow.com/users/6173619/helpme1986"}, "edited": false, "score": 0, "creation_date": 1501687371, "post_id": 45464200, "comment_id": 77890587, "body": "Yes they are opened in the same instance of excel."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1501688727, "post_id": 45464200, "comment_id": 77891612, "body": "An easy workaround: use separate instances of Excel"}, {"owner": {"reputation": 665, "user_id": 6173619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18713c0445782b002464a446e13224e6?s=128&d=identicon&r=PG&f=1", "display_name": "helpME1986", "link": "https://stackoverflow.com/users/6173619/helpme1986"}, "edited": false, "score": 0, "creation_date": 1501689227, "post_id": 45464200, "comment_id": 77891968, "body": "Maybe you can try Application.Run with specifing from which workbook you want to run macro"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501690695, "post_id": 45464200, "comment_id": 77892961, "body": "You need to show the code where you set/access the global variable."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1501711892, "post_id": 45464200, "comment_id": 77904660, "body": "Use a different hotkey for the two different workbooks! Macros have a scope."}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1501756503, "post_id": 45464200, "comment_id": 77923770, "body": "@Absinthe: The excel with macro will be given to customers. I cannot give 2 excel files. The same excel file with macro will be used by customer to open many CSV files. But they are unable to copy and paste between the CSV&#39;s once they open it in excel."}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "reply_to_user": {"reputation": 665, "user_id": 6173619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18713c0445782b002464a446e13224e6?s=128&d=identicon&r=PG&f=1", "display_name": "helpME1986", "link": "https://stackoverflow.com/users/6173619/helpme1986"}, "edited": false, "score": 0, "creation_date": 1501756666, "post_id": 45464200, "comment_id": 77923903, "body": "@helpME1986: The macro is called by a hot key Ctrl + M, and the same excel (copies of this excel in different folder)(with the macro) is used to open different CSV files. Please suggest."}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1501756786, "post_id": 45464200, "comment_id": 77923985, "body": "@Vegard: I used the approach of opening the excle in separate instance by &#39;Excel options&#39; &gt; &#39;advanced&#39; tab &gt; &#39;general&#39; &gt; check &quot;Ignore other applications that use &#39;Dyanamic Data Exchange (DDE)&#39;&quot;. But this is giving error &quot;There was a problem sending the command to the program.&quot; when I double click to open the excel containg the macro."}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1501756989, "post_id": 45464200, "comment_id": 77924143, "body": "@TimWilliams: I have added the code. Thanks."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1502337456, "post_id": 45464200, "comment_id": 78167541, "body": "It may be easier to debug if you include <code>Thisworkbook.Name</code> in your <b>Open File Dialog</b>"}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1502692874, "post_id": 45464200, "comment_id": 78294772, "body": "Awwww No bounty :&#39;("}], "answers": [{"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 3, "last_activity_date": 1502098021, "creation_date": 1502098021, "answer_id": 45543564, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45543564#45543564", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>If I understand it properly, user has <code>DEF.xls</code> as a top-level workbook, hence equal to <code>ActiveWorkbook</code>. Then my idea is to add new sheet to this workbook with very unique name, like \"zZzVBAdatazZz\" and make it very hidden (set <code>Sheets(\"zZzVBAdatazZz\").Visible = xlVeryHidden</code>), so user can't unhide it with menu commands. When the macro is run you can store the path to <code>DEF123.CSV</code> in this sheet, let's say in cell <code>A1</code> (<code>ActiveWorkbook.Sheets(\"zZzVBAdatazZz\").Range(A1) = .SelectedItems(1)</code>). In your <code>Private Sub Workbook_BeforeClose(Cancel As Boolean)</code> check if there is a value in <code>Sheets(\"zZzVBAdatazZz\").Range(A1)</code>. If so, take it and store in variable (it can be local now), delete value in <code>A1</code> and pass the path to <code>saveUnicodeCSV</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502541473, "post_id": 45543984, "comment_id": 78259099, "body": "Oh you beauty! Wonderfully compact."}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 0, "creation_date": 1502692985, "post_id": 45543984, "comment_id": 78294820, "body": "@fcsr: Thanks for the answer."}], "tags": [], "owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "is_accepted": true, "score": 5, "last_activity_date": 1502360026, "last_edit_date": 1502360026, "creation_date": 1502099249, "answer_id": 45543984, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45543984#45543984", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>The problem I think is that when you bind the same macro names to a Shortcut Key, the first book that is opened will be assigned to that shortcut key.</p>\n\n<p>A work around would be to make another macro to call the right macro based on the workbook name. This might require you to replace some of the Workbooks and Worksheets to ActiveWorkbook or ActiveWorksheet. But please try it out first.</p>\n\n<p>This is just example code I tried out but please edit it to your needs. I tried it by making two files a.xlsm and b.xlsm. difference is a.xlsm has msgbox \"a\" in first line and b.xlsm has msbox \"b\" in the first line. You check by opening a.xlsm first then b.xls. Then assign the same shortcut key. You will see that when you run Ctrl+M in b.xlsm that the macro that will be run will be in a.xlsm with msgbox \"A\" but then it will call the correct macro in b.xlsm.</p>\n\n<p><strong>Short Answer</strong></p>\n\n<p>This code makes use of <code>Application.Run</code> which runs the macro from a specific workbook. create a helper macro that will check filename then append macro name.</p>\n\n<p>So when you ctrl+m, regardless which workbook run_code is run from, it will go back to activeworkbook and run the macro, in this case plaster, from that workbook. Also it will populate the Public Variable with the activeworkbook value.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s9/win001.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s9/win001.htm</a> some samples of application.run</p>\n\n<p><strong>By far the easiest solution for you just add Caller Macro</strong></p>\n\n<p>Caller Macro:</p>\n\n<pre><code>Sub call_changeTheCode() ' add to all workbooks, that have changeTheCode macro then assign to Ctrl + m\n\nApplication.Run ActiveWorkbook.Name &amp; \"!changeTheCode\"\n\nEnd Sub\n</code></pre>\n\n<p><br>\n<br>\n<br>\nProof of concept, not your actual code, use above Caller Macro:</p>\n\n<pre><code>Public varvar As String\nSub run_code() 'assignt to shortcut key CTRL+M both macros in a.xlsm and b.xlsm\nMsgBox \"a\" ' to test create another workbook and change this to b\nfile_path = ActiveWorkbook.Path 'just to check path\nfile_name = ActiveWorkbook.Name 'gets the file name\nMsgBox file_path 'msgbox the file_path\nMsgBox file_name 'msgbox the file_name\nMsgBox file_name &amp; \"!plaster\" 'msgbox the file name plus macro name, in your instance it would be \"ABC.xlsm'!macro_name\" please note the format\nApplication.Run file_name &amp; \"!plaster\"\n\nEnd Sub\n\nSub plaster() 'this is the test macro that will show correct macro in workbook is called\nvarvar = ActiveWorkbook.Name\nMsgBox \"hi this is workbook \" &amp; varvar\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 2, "last_activity_date": 1502105181, "last_edit_date": 1502105181, "creation_date": 1502104219, "answer_id": 45545505, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45545505#45545505", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>Interesting problem, I believe the heart of the problem is that a workbook's global object is not really global across the whole application space.  Hereafter I write global as \"global\" to highlight this misnoma.</p>\n\n<p>I believe your macro will always run from one place, so how to scope a \"global\" variable for each workbook and yet still reach it from another workbook's code base.</p>\n\n<p>My solution would be to use the <code>ThisWorkbook</code> module as the place to house the \"global\" variable.  So in the <code>ThisWorkbook</code> module place the following code </p>\n\n<pre><code>Option Explicit\n\nPublic NJMRGlobalVar As Variant\n</code></pre>\n\n<p>then in the module of your macro code you will need a function to test if a given workbook supports/exports this new \"global\" variable.  So something like this ( given along with unit test)</p>\n\n<pre><code>Private Function WorkbookHasNJMRGlobalVar(ByVal wb As Excel.Workbook) As Boolean\n    If wb Is Nothing Then\n        WorkbookHasNJMRGlobalVar = False\n    Else\n        Dim vTest As Variant\n        vTest = CVErr(xlErrName)\n        'Requires VBA IDE-&gt;Tools-&gt;Options-&gt;General-&gt;Error Trapping-&gt;Break on Unhandled Errors\n        On Error Resume Next\n        vTest = CallByName(wb, \"NJMRGlobalVar\", VbGet)\n\n        Dim lSaveError As Long\n        lSaveError = Err.Number\n        On Error GoTo 0\n        WorkbookHasNJMRGlobalVar = (lSaveError = 0)\n    End If\n\nEnd Function\n\nPrivate Sub TestWorkbookHasNJMRGlobalVar()\n\n    Debug.Assert WorkbookHasNJMRGlobalVar(ThisWorkbook) = True\n\n    Dim wbUnsuitable As Excel.Workbook\n    Set wbUnsuitable = Workbooks.Item(\"VBA Fileshare.xlsm\") '*&lt;---- different for you!\n\n    Debug.Assert WorkbookHasNJMRGlobalVar(wbUnsuitable) = False\n\nEnd Sub\n</code></pre>\n\n<p>Final step is to rewrite your code not in terms of ThisWorkbook but either ActiveWorkbook or acquiring the target workbook with Application.Workbooks.Item(\"foo.xlsm\").  So here is some code (which works on ActiveWorkbook).</p>\n\n<pre><code>Sub CodePageChange()\n    Dim SheetName As Worksheet\n    Dim fd As Office.FileDialog\n    Dim sheetName1 As String\n    Dim tabSheetName As String\n\n    If Not WorkbookHasNJMRGlobalVar(ActiveWorkbook) Then\n        MsgBox \"Currently Active Workbook not a suitable candidate for that macro.\"\n    Else\n\n        Dim wbGlobalVarEnabled As Excel.Workbook\n        Set wbGlobalVarEnabled = ActiveWorkbook\n\n        Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n        With fd\n            '....\n            '....\n            '....\n            If .Show = True Then\n                wbGlobalVarEnabled.NJMRGlobalVar = .SelectedItems(1)\n            Else\n                MsgBox \"Please start over.  You must select a csv file.\"\n                Exit Sub\n            End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>So now you have a \"global\" variable per workbook which is freely accessible from one code simply by acquiring a reference to an Excel.Workbook.  This works because Excel.Workbook does not forbid extensibility in the interface meaning extra methods and properties can be added (but not all workbooks will support them hence you a function to detect, e.g <code>WorkbookHasNJMRGlobalVar</code> above).</p>\n\n<p>Please post feedback if not enough and I will amend, I have 99/100 on VBA questions I would like to earn my bronze VBA badge :)</p>\n\n<p>EDIT: reading your profile you have C/C++ skills so I can go further in low-level explanation as to how this works.  In the type library for Excel the \"nonextensible\" IDL keyword decorates most interfaces forbidding extra methods and properties but this is missing from <code>interface _Workbook</code> so you can.  Here is a screenshot from OleView.exe</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZSHyF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZSHyF.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1502116251, "creation_date": 1502116251, "answer_id": 45549419, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45549419#45549419", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>A unique shortcut can only be assigned to a single procedure in a workbook.\nSetting the same shortcut a second time overrides the previous assignment.</p>\n\n<p>To handle the same shortcut in different workbooks, either assign the shortcut when the workbook is activated :</p>\n\n<pre><code>' ThisWorkbook '\n\nPrivate Sub Workbook_Activate()\n  Application.OnKey \"^m\", \"CodePageChange\"\nEnd Sub\n\n' Module '\n\nPublic Sub CodePageChange()\n  MsgBox ThisWorkbook.Name\nEnd Sub\n</code></pre>\n\n<p>Or handle the callback in the workbook which receives it and then call the procedure on the targeted workbook:</p>\n\n<pre><code>' ThisWorkbook '\n\nPrivate Sub Workbook_Open()\n  Application.OnKey \"^m\", \"OnHotkeyCtrlM\"\nEnd Sub\n\n' Module '\n\nPublic Sub OnHotkeyCtrlM()\n  Application.Run \"'\" &amp; ActiveWorkbook.Name &amp; \"'!CodePageChange\"\nEnd Sub\n\nPublic Sub CodePageChange()\n   MsgBox ThisWorkbook.Name\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502197669, "post_id": 45558629, "comment_id": 78097613, "body": "cool! at least cool if you want persistence across saves/sessions, mind you one could just write to a cell on a sheet for persistence."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502209196, "post_id": 45558629, "comment_id": 78106188, "body": "@SMeaden, you could delete the property in the beforeClose sub if you do not want it there from one session to next.  it is just a value that is attached to the workbook itself and is unique to each workbook"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 1, "last_activity_date": 1502161492, "creation_date": 1502161492, "answer_id": 45558629, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45558629#45558629", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>use custom property as a global variable</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Debug.Print ActiveWorkbook.CustomDocumentProperties(\"xyz\")\n\nEnd Sub\n\n\nSub changeTheCode()\n\n    On Error Resume Next\n    ActiveWorkbook.CustomDocumentProperties(\"xyz\").Delete\n    ActiveWorkbook.CustomDocumentProperties.Add Name:=\"xyz\", LinkToContent:=False, Type:=msoPropertyTypeString, Value:=ActiveWorkbook.Name\n    Debug.Print ActiveWorkbook.CustomDocumentProperties(\"xyz\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 1, "last_activity_date": 1502205074, "creation_date": 1502205074, "answer_id": 45572032, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45572032#45572032", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>I agree with S Meaden, you cannot have a Global variable across several workbooks without specifying the workbook where the \"global\" variable is stored.</p>\n\n<p>Another approach:\nIn the Excel file with the macro where the setting of the \"global\" variable is done:\nReplace the setting with </p>\n\n<pre><code>Shell (\"Cmd.Exe /C SetX txtFileNameAndPath thePath\")\n</code></pre>\n\n<p>Replace thePath with the actual path or value.\nAfter this macro is run you can run your Excel files and retrieve the true global value through</p>\n\n<pre><code>txtFileNameAndPath = Environ(\"txtFileNameAndPath\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502350481, "post_id": 45600009, "comment_id": 78173248, "body": "very similar to mine below <a href=\"https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45545505#45545505\" title=\"global variable is empty if 2 similar xls files with same macro are opened\">stackoverflow.com/questions/45464200/&hellip;</a>"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502353415, "post_id": 45600009, "comment_id": 78175063, "body": "@SMeaden I haven&#39;t read all the other answers, so I apologize if I stole your idea."}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 1, "last_activity_date": 1502343227, "last_edit_date": 1502343227, "creation_date": 1502310176, "answer_id": 45600009, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45600009#45600009", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>Put the global variable into the <code>ThisWorkbook</code> class module.</p>\n\n<pre><code>Public txtFileNameAndPath As String\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Debug.Print Me.Name &amp; \":\" &amp; txtFileNameAndPath\nEnd Sub \n</code></pre>\n\n<p>Then in the procedure <code>CodePageChange</code> loop through all the workbooks and check using <code>ActiveWorkbook.Name</code> which global variable should be used. HTH</p>\n\n<pre><code>If .Show = True Then\n  Dim w As Workbook\n  On Error Resume Next\n  For Each w In Workbooks\n    If ActiveWorkbook.Name = w.Name Then\n        w.txtFileNameAndPath = .SelectedItems(1)\n        Exit For\n    End If\n  Next w\n  On Error GoTo 0\nElse\n    MsgBox \"Please start over.  You must select a csv file.\"\n    Exit Sub\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1502692822, "creation_date": 1502692822, "answer_id": 45668751, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened/45668751#45668751", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>User-friendly workaround: Ditch the keyboard short-cut and add either a CommandButton to a worksheet or Custom Ribbon Tab to the workbook to call the procedure. They're guaranteed to call the procedure from their own workbook and easier for users.</p>\n"}], "owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 45543984, "answer_count": 8, "score": 7, "last_activity_date": 1502692822, "creation_date": 1501685555, "last_edit_date": 1502504035, "question_id": 45464200, "link": "https://stackoverflow.com/questions/45464200/global-variable-is-empty-if-2-similar-xls-files-with-same-macro-are-opened", "title": "Global variable is empty if 2 similar xls files with same macro are opened", "body": "<p>There is macro in Excel which was already written and there was bug reported on this and I have to fix this. Initial investigations are below...\nThere is <code>ABC.xls</code> file which has the <code>macro</code>. </p>\n\n<p>Now, the macro has a <code>sub</code> named <code>changeTheCode</code> which is getting called when I press <code>Ctrl + M</code>. </p>\n\n<p>This sub will open a <code>Open File Dialog</code> where the user can choose a CSV file. The path of the CSV file I am storing in a global variable declare outside of all the function...</p>\n\n<pre><code>Public txtFileNameAndPath As String\n</code></pre>\n\n<p>This global variable will be used to save the changes into the CSV file when the user closes the excel.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Call saveUnicodeCSV\n    Call deleteXLS\nEnd Sub\n</code></pre>\n\n<p>I use this <code>ABC.xls</code> file for opening a <code>ABC123.CSV</code> file.</p>\n\n<p>I use this <code>DEF.xls</code> (a copy of ABC.xls) file to open <code>DEF123.CSV</code> file. But when I open the <code>DEF123.CSV</code> using <code>Ctrl + M</code>, the sub <code>changeTheCode</code> of the <code>ABC.xls</code> is getting called and the global variable <code>txtFileNameAndPath</code> of <code>DEF.xls</code> is empty and when I close the Excel, things are not getting saved because of this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/s8wiv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s8wiv.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Code where the global variable is getting set.</p>\n\n<pre><code>Public txtFileNameAndPath As String\nSub CodePageChange()\n    Dim SheetName As Worksheet\n    Dim fd As Office.FileDialog\n    Dim sheetName1 As String\n    Dim tabSheetName As String\n\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    With fd\n        '....\n        '....\n        '....\n        If .Show = True Then\n          txtFileNameAndPath = .SelectedItems(1)\n        Else\n            MsgBox \"Please start over.  You must select a csv file.\"\n            Exit Sub\n        End If\n    End With\n</code></pre>\n\n<p>Inputs on how to handle this will help me a lot.</p>\n\n<p><strong>Note:</strong> The Excel containing macro will be given to customer. Hence I cannot ask customer to do some registry tweaks to open the Excel in separate instance.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501686999, "post_id": 45464695, "comment_id": 77890278, "body": "this way gives me another error -   Run time Error 1004 \u201cApplication-defined or Object-defined error\u201d at moment of &quot;Set wb ... &quot;"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501687323, "post_id": 45464695, "comment_id": 77890547, "body": "Add this before it - <code>Debug.Print ThisWorkbook.Path &amp; &quot;\\resourcetracker.xls&quot;</code> then look at your debug window. Does that file exist in that location?"}, {"owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501688216, "post_id": 45464695, "comment_id": 77891222, "body": "It&#39;s funny; I have these 2 file in one folder ~ &quot;C:\\Users\\User1\\Documents\\Excel files\\&quot; and my idea with ThisWorkbook.Path was just to save time if files would be moved; after I replaced it with full address everything works; and ThisWorkbook.Path returns exactly this part &quot;C:\\Users\\User1\\Documents\\Excel files&quot;"}, {"owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501688713, "post_id": 45464695, "comment_id": 77891606, "body": "also can I add If statement to it to make it check if this workbook is already opened, or it&#39;s a important part of the logic in excel to open it first ?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "edited": false, "score": 0, "creation_date": 1501689768, "post_id": 45464695, "comment_id": 77892359, "body": "Because I used <code>Add</code> instead of <code>Open</code> it doesnt matter if it&#39;s already open or not."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1501686800, "creation_date": 1501686800, "answer_id": 45464695, "question_id": 45464168, "link": "https://stackoverflow.com/questions/45464168/invalid-procedure-call-or-argument-vba-when-populating-combobox/45464695#45464695", "title": "invalid procedure call or argument vba when populating ComboBox", "body": "<p><code>GetObject</code> is not the right way to open another <code>WorkBook</code></p>\n\n<p>Try this instead</p>\n\n<pre><code>Public Sub Worksheet_Activate()\n    Dim wb As Workbook\n    ThisWorkbook.Sheets(\"Master\").ComboBox23.List = Sheets(\"Modification\").Range(\"C2:C55\").Value\n    Set wb = Workbooks.Add(ThisWorkbook.Path &amp; \"\\resourcetracker.xls\")\n    ThisWorkbook.Sheets(\"Master\").ComboBox24.List = wb.Sheets(\"Resources\").Range(\"A2:A22\").Value\n    wb.Close False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 6800914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a91900e2356612b7c8e1402d2f9b8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Zaguzin", "link": "https://stackoverflow.com/users/6800914/vladimir-zaguzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 45464695, "answer_count": 1, "score": 0, "last_activity_date": 1501686800, "creation_date": 1501685477, "question_id": 45464168, "link": "https://stackoverflow.com/questions/45464168/invalid-procedure-call-or-argument-vba-when-populating-combobox", "title": "invalid procedure call or argument vba when populating ComboBox", "body": "<p>I have 2 excel files and in main excel file I have 2 comboBox elements, one of them should be populate from another worksheet and 2nd from another workbook and when I'm trying to populate this combobox by using data from another workbook like this </p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    ThisWorkbook.Sheets(\"Master\").ComboBox23.List = Sheets(\"Modification\").Range(\"C2:C55\").Value\n    ThisWorkbook.Sheets(\"Master\").ComboBox24.List = GetObject(ThisWorkbook.Path &amp; \"\\resourcetracker.xls\").Sheets(\"Resources\").Range(\"A2:A22\").Value \nEnd Sub\n</code></pre>\n\n<p>I can get data from another worksheet in main excel file, but line where i'm opening another workbook gives me an error </p>\n\n<blockquote>\n  <p>Invalid procedure call or argument (Run-time Error 5)</p>\n</blockquote>\n\n<p>Can someone help with to understand what i'm doing wrong?\nThanks </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1501685209, "creation_date": 1501685209, "answer_id": 45464070, "question_id": 45464025, "link": "https://stackoverflow.com/questions/45464025/excel-vba-activate-the-cell-after-the-last-one-in-a-column/45464070#45464070", "title": "Excel VBA: activate the cell after the last one in a column", "body": "<p>Use:</p>\n\n<pre><code>ActiveSheet.Cells(ActiveSheet.Rows.Count,1).End(xlup).Offset(1).Activate\n</code></pre>\n\n<hr>\n\n<p>NOTE:  One should avoid <code>.Activate</code> and <code>.Select</code>  These slow down code, but should directly use the reference.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">HERE</a> for more information.</p>\n"}], "owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501685209, "creation_date": 1501685088, "question_id": 45464025, "link": "https://stackoverflow.com/questions/45464025/excel-vba-activate-the-cell-after-the-last-one-in-a-column", "title": "Excel VBA: activate the cell after the last one in a column", "body": "<p>Silly question: how do I go to the cell right after the last non-blank cell in column ? I can't figure it out for the life of me.</p>\n\n<p>I've tried something akin to: <code>Range(\"A2\", Range(\"A2\").End(xlDown) + 1).Activate</code> (A1 is blank) and <code>Range(\"A2\", Range(\"A2\").End(xlDown + 1)).Activate</code> , but it errors out.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "edited": false, "score": 0, "creation_date": 1502220932, "post_id": 45529042, "comment_id": 78112744, "body": "It works but sometimes the column C &quot;number&quot; doesn&#39;t get written properly next to its &quot;name&quot; and its been added alone as new line at the end. is it possible to point out where are the COLUMN variables i need to change in the event I need to add more columns and still use this function? thank you"}, {"owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "reply_to_user": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "edited": false, "score": 0, "creation_date": 1502236379, "post_id": 45529042, "comment_id": 78118812, "body": "try now? i hv simplified col C to <code>Sheets(2).Cells(i + 1, 3) = colToRw(r)</code> &amp; col D to <code>Sheets(2).Cells(i + 1, 4) = colToRw(r)</code>.  other columns are: col A = <code>Sheets(2).Cells(i + 1, 1) = d(k)</code>, col B = <code>Sheets(2).Cells(i + 1, 2) = k</code>, &amp; col E = <code>If j = 0 Then Sheets(2).Cells(i + 1, 5) = cmnt</code>"}, {"owner": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "edited": false, "score": 0, "creation_date": 1502309130, "post_id": 45529042, "comment_id": 78158881, "body": "thank you. It works. I am now just having issues to update column C to column H,  when I change it it throws an error in the r.Sort r.Columns(1) &quot;Sort Method of Range class failed&quot;. the column H has numbers just as column C shown in the example table. should I change any other value to make it work using column H instead of C? it populates only &quot;,,,,,,&quot; r seems to be blank. I&#39;ve marked your answer as the solution. thank you."}, {"owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "reply_to_user": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "edited": false, "score": 0, "creation_date": 1502331353, "post_id": 45529042, "comment_id": 78166085, "body": "u are welcome. as u need other additional columns to be processed in the same way, i have added a 2nd version where u may mention the column#. e.g. <code>Sheets(2).Cells(i + 1, 3) = uniqNsort(k, rng, 1, d.Count)</code> for column C and <code>Sheets(2).Cells(i + 1, 4) = uniqNsort(k, rng, 2, d.Count)</code> for column D, &amp; so on. note we only need to change in 2 places"}, {"owner": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "edited": false, "score": 0, "creation_date": 1502389756, "post_id": 45529042, "comment_id": 78201603, "body": "where are those two places?"}, {"owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "reply_to_user": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "edited": false, "score": 0, "creation_date": 1502394409, "post_id": 45529042, "comment_id": 78204171, "body": "2 places in the example i mentioned in the last comment, i.e. &quot;<code>Sheets(2).Cells(i + 1, 3) = uniqNsort(k, rng, 1, d.Count)</code> for column C and <code>Sheets(2).Cells(i + 1, 4) = uniqNsort(k, rng, 2, d.Count)</code> for column D, &amp; so on&quot;. as u can see the only 2 values changed - (1) 3 changed to 4 in <code>Cells(i + 1, 3)</code> because of col D, (2) 1 changed to 2 in <code>uniqNsort(k, rng, 1, d.Count)</code>  because col C is offset 1 to the right &amp; col D is offset 2 to the right of the main range of col B"}], "tags": [], "owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "is_accepted": true, "score": 1, "last_activity_date": 1502331740, "last_edit_date": 1502331740, "creation_date": 1501999159, "answer_id": 45529042, "question_id": 45463951, "link": "https://stackoverflow.com/questions/45463951/excel-vba-create-report-with-grouped-values/45529042#45529042", "title": "Excel VBA create report with grouped values", "body": "<p>The approach to use dictionary is a step in the right direction though it needs 1 more of that dictionary object to use it in the sub loops. It gets a bit complex and interesting due to additional columns and the requirements of unique and sorted data as indicated under the expected summary portion in the question.</p>\n\n<p>The below updated code assumes that the macro is triggered from the sheet containing this data and generates the output in Sheet(2):</p>\n\n<pre><code>Sub strSplit()\n    Dim r As Range, lastRow As Long, k As Variant, k1 As Variant, d As Object, d1 As Object, i As Long, j As Long, cmnt As String\n    Set d = CreateObject(\"Scripting.Dictionary\")\n    Set d1 = CreateObject(\"Scripting.Dictionary\")\n    lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    For Each r In Range(\"B2:B\" &amp; lastRow)\n        If Not IsEmpty(r) Then d(r.Value) = r.Offset(0, -1).Value\n    Next\n    For Each k In d.Keys\n        i = i + 1\n        Sheets(2).Cells(i + 1, 1) = d(k)\n        Sheets(2).Cells(i + 1, 2) = k\n\n        'get list of unique numbers for each ID + comment\n        For Each r In Range(\"B2:B\" &amp; lastRow)\n            If k = r.Value Then\n                d1(r.Offset(0, 1).Value) = r.Value\n                cmnt = r.Offset(0, 3).Value\n            End If\n        Next\n        j = 0\n        For Each k1 In d1.Keys\n            If j = 0 Then Sheets(2).Cells(i + 1, 5) = cmnt\n            Sheets(2).Cells(j + d.Count + 2, 3) = k1\n            j = j + 1\n        Next\n        Set r = Sheets(2).Range(\"C\" &amp; d.Count + 2 &amp; \":C\" &amp; j + 1 + d.Count)\n        r.Sort r.Columns(1)\n        Sheets(2).Cells(i + 1, 3) = colToRw(r)\n        r.ClearContents\n        d1.RemoveAll\n\n        'get list of unique classes for each ID\n        For Each r In Range(\"B2:B\" &amp; lastRow)\n            If k = r.Value Then d1(r.Offset(0, 2).Value) = r.Value\n        Next\n        j = 0\n        For Each k1 In d1.Keys\n            Sheets(2).Cells(j + d.Count + 2, 4) = k1\n            j = j + 1\n        Next\n        Set r = Sheets(2).Range(\"D\" &amp; d.Count + 2 &amp; \":D\" &amp; j + 1 + d.Count)\n        r.Sort r.Columns(1)\n        Sheets(2).Cells(i + 1, 4) = colToRw(r)\n        r.ClearContents\n        d1.RemoveAll\n    Next\n    Sheets(2).Select\nEnd Sub\nFunction colToRw(r As Range) As String\n    Dim r1 As Range, is1st As Boolean\n    is1st = True\n    For Each r1 In r\n        If Not is1st Then\n            colToRw = colToRw &amp; \", \"\n        Else: is1st = False\n        End If\n        colToRw = colToRw &amp; r1.Value\n    Next\nEnd Function\n</code></pre>\n\n<p><strong>2<sup>nd</sup> version:</strong></p>\n\n<p>Based on subsequent discussion, here's a modified and leaner version with a more functional approach. Under this approach, the column that needs to be searched for an ordered and unique list, can be set in the functional call.</p>\n\n<pre><code>Sub strSplit()\n    Dim r As Range, lastRow As Long, rng As Range, k As Variant, d As Object, i As Long\n    Set d = CreateObject(\"Scripting.Dictionary\")\n    lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    Set rng = Range(\"B2:B\" &amp; lastRow)\n    For Each r In rng\n        If Not IsEmpty(r) Then d(r.Value) = r.Offset(0, -1).Value\n    Next\n    For Each k In d.Keys\n        i = i + 1\n        Sheets(2).Cells(i + 1, 1) = d(k) 'column 1\n        Sheets(2).Cells(i + 1, 2) = k 'column 2\n        For Each r In rng\n            If k = r.Value Then\n                Sheets(2).Cells(i + 1, 5) = r.Offset(0, 3).Value 'column 5\n                Exit For\n            End If\n        Next\n        Sheets(2).Cells(i + 1, 3) = uniqNsort(k, rng, 1, d.Count) 'column 3\n        Sheets(2).Cells(i + 1, 4) = uniqNsort(k, rng, 2, d.Count) 'column 4\n    Next\n    Sheets(2).Select\nEnd Sub\nFunction uniqNsort(k, rng As Range, rngOffsetCol As Long, rwNo As Long) As String 'get ordered list of unique items\n    Dim k1, r As Range, i As Long, d As Object\n    Set d = CreateObject(\"Scripting.Dictionary\")\n    For Each r In rng\n        If k = r.Value Then\n            d(r.Offset(0, rngOffsetCol).Value) = r.Value\n        End If\n    Next\n    For Each k1 In d.Keys\n        Sheets(2).Cells(i + rwNo + 2, 1) = k1\n        i = i + 1\n    Next\n    Set r = Sheets(2).Range(\"A\" &amp; rwNo + 2 &amp; \":A\" &amp; rwNo + i + 1)\n    r.Sort r.Columns(1)\n    uniqNsort = colToRw(r)\n    r.ClearContents\nEnd Function\nFunction colToRw(r As Range) As String\n    Dim r1 As Range, is1st As Boolean\n    is1st = True\n    For Each r1 In r\n        If Not is1st Then\n            colToRw = colToRw &amp; \", \"\n        Else: is1st = False\n        End If\n        colToRw = colToRw &amp; r1.Value\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1992, "favorite_count": 0, "accepted_answer_id": 45529042, "answer_count": 1, "score": 2, "last_activity_date": 1502344329, "creation_date": 1501684904, "last_edit_date": 1531161705, "question_id": 45463951, "link": "https://stackoverflow.com/questions/45463951/excel-vba-create-report-with-grouped-values", "title": "Excel VBA create report with grouped values", "body": "<p>I'm trying to create a report in Excel using VBA to process some data and create a tabular report that summarizes the values by group.  Although I can generate the table manually, I can't get the code to fully create this report.</p>\n\n<p>Input data:</p>\n\n<pre><code>ID | name   | number | class | comment\n---|--------|--------|-------|----------       \n 1 | john   |      4 | A1    | sports\n---|--------|--------|-------|----------      \n 1 | john   |      3 | A2    | sports\n---|--------|--------|-------|----------      \n 1 | john   |      5 | A3    | sports\n---|--------|--------|-------|----------      \n 2 | charly |      1 | B3    | tech\n---|--------|--------|-------|----------     \n 2 | charly |      2 | B2    | tech\n---|--------|--------|-------|----------  \n 2 | charly |      1 | B2    | tech\n---|--------|--------|-------|----------   \n 3 | frank  |      7 | C3    | language\n---|--------|--------|-------|----------     \n 3 | frank  |      2 | C5    | language\n---|--------|--------|-------|----------  \n 3 | frank  |      9 | C4    | language\n</code></pre>\n\n<p>Expected summary in a new worksheet:</p>\n\n<pre><code>ID | name   | number  | class      | comment\n---|--------|---------|------------|----------\n 1 | john   | \u201d3,4,5\u201d | \u201dA1,A2,A3\u201d | sports\n---|--------|---------|------------|----------\n 2 | charly | \u201d1,2\u201d   | \u201dB2,B3\u201d    | tech\n---|--------|---------|------------|----------\n 3 | frank  | \u201d2,7,9\u201d | \u201dC3,C4,C5\u201d | language\n</code></pre>\n\n<p>Here is the code I currently have:</p>\n\n<pre><code>Function Uniques(r As Range)\n\nDim d As Object, c As Range, tmp\n     Set d = CreateObject(\"scripting.dictionary\")\n     For Each c In rCells\n        tmp = Trim(c.Value)\n        If Len(tmp) &gt; 0 Then\n             If Not d.Exists(tmp) And tmp &lt;&gt; \u201cHEADER\u201d Then d.Add tmp, 1\n        End If\n     Next c\n     Uniques = d.keysEnd Function\n     With .Range(\"A1:N\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row)\n           .AutoFilter Field:=1\n           Set a = .Columns(\u201cA\u201d).Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n           Set b = .Columns(\u201cB\u201d).Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n           'getting the unique items\n            d = Uniques(Range(\"D:D\").SpecialCells(xlCellTypeVisible))\n           .AutoFilter\n     End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1501685045, "post_id": 45463809, "comment_id": 77888718, "body": "You are assigning the values to <code>mystr</code> variable twice."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501688648, "post_id": 45463809, "comment_id": 77891563, "body": "i think that the url is a test string, and will not be used in production code. the two assignments are backward though."}], "owner": {"reputation": 1, "user_id": 8406146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb209b3f292d3c902dccdf636ee348e3?s=128&d=identicon&r=PG&f=1", "display_name": "seveera", "link": "https://stackoverflow.com/users/8406146/seveera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501686292, "creation_date": 1501684551, "last_edit_date": 1501686292, "question_id": 45463809, "link": "https://stackoverflow.com/questions/45463809/pasting-scraped-data-from-web-to-new-worksheet-and-name-the-worksheet-based-on-v", "title": "pasting scraped data from web to new worksheet and name the worksheet based on values in a column", "body": "<p>I'm a novice in VBA, was looking to export tables from HTML &amp; I have been successful in that.</p>\n\n<p>My code will create a new worksheet to paste the tables from each URL. Currently the new worksheet is named in a sequence of 1,2,3... I want help to rewrite this part of the code.</p>\n\n<p>I have two columns and multiple rows, 1st column is for the URL from where the data needs to be copied and the 2nd column contains worksheet name.</p>\n\n<p>Example:</p>\n\n<p>Column 1 :\nURL;<a href=\"http://www.cricbuzz.com/cricket-series/2489/england-tour-of-india-2016-17/matches\" rel=\"nofollow noreferrer\">http://www.cricbuzz.com/cricket-series/2489/england-tour-of-india-2016-17/matches</a>   </p>\n\n<p>Column 2:\nEng-India</p>\n\n<p>When the data is copied from column 1, I would like the code to name the new worksheet based on the values in column 2</p>\n\n<p>Currently I use the below code:</p>\n\n<pre><code>Sub adds()\n For x = 1 To 2\n\n Worksheets(\"MATCH\").Select\n Worksheets(\"MATCH\").Activate\n mystr = \"URL;http://www.cricbuzz.com/cricket-series/2489/england-tour-of-india-2016-17/matches\"\n mystr = Cells(x, 1)\n Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = x\n With ActiveSheet.QueryTables.Add(Connection:=mystr, Destination:=Range(\"$A$1\"))\n 'CommandType = 0\n .Name = \"01000_1\"\n .FieldNames = True\n .RowNumbers = False\n .FillAdjacentFormulas = False\n .PreserveFormatting = True\n .RefreshOnFileOpen = False\n .BackgroundQuery = True\n .RefreshStyle = xlInsertDeleteCells\n .SavePassword = False\n .SaveData = True\n .AdjustColumnWidth = True\n .RefreshPeriod = 0\n .WebSelectionType = xlSpecifiedTables\n .WebFormatting = xlWebFormattingNone\n .WebTables = \"1,2,3,4,5,6,7,8,9,10\" \n .WebPreFormattedTextToColumns = True\n .WebConsecutiveDelimitersAsOne = True\n .WebSingleBlockTextImport = False\n .WebDisableDateRecognition = False\n .WebDisableRedirections = False\n .Refresh BackgroundQuery:=False\n End With\n Next x\n End Sub\n</code></pre>\n"}, {"tags": ["asp.net-mvc", "excel", "post", "vba"], "comments": [{"owner": {"reputation": 8791, "user_id": 7247920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bAqar.jpg?s=128&g=1", "display_name": "ggradnig", "link": "https://stackoverflow.com/users/7247920/ggradnig"}, "edited": false, "score": 0, "creation_date": 1501683709, "post_id": 45463484, "comment_id": 77887584, "body": "Can you show the Route for your Controller ?"}, {"owner": {"reputation": 45, "user_id": 5584869, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c7b80191458eaf75a4b9be9e5262f665?s=128&d=identicon&r=PG&f=1", "display_name": "Macukadam", "link": "https://stackoverflow.com/users/5584869/macukadam"}, "reply_to_user": {"reputation": 8791, "user_id": 7247920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bAqar.jpg?s=128&g=1", "display_name": "ggradnig", "link": "https://stackoverflow.com/users/7247920/ggradnig"}, "edited": false, "score": 0, "creation_date": 1501683984, "post_id": 45463484, "comment_id": 77887805, "body": "app.UseMvc(routes =&gt;                 {                     routes.MapRoute(                         name: &quot;default&quot;,                         template: &quot;{controller=Home}/{action=Index}/{id?}&quot;);                  });"}, {"owner": {"reputation": 844, "user_id": 3394380, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b5c00710c3e7e88a2065166d372fec1?s=128&d=identicon&r=PG&f=1", "display_name": "yW0K5o", "link": "https://stackoverflow.com/users/3394380/yw0k5o"}, "edited": false, "score": 0, "creation_date": 1501697483, "post_id": 45463484, "comment_id": 77897069, "body": "Have you tried to change the signature of your controller method from <code>[HttpPost] public IActionResult Updtdb(string longStr) { &#47;&#47;some code here! }</code> to <code>[HttpPost] public ActionResult Updtdb(ModelX model) { &#47;&#47;some code here! }</code> where <code>class ModelX{ public string x{get;set;}}</code>"}, {"owner": {"reputation": 45, "user_id": 5584869, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c7b80191458eaf75a4b9be9e5262f665?s=128&d=identicon&r=PG&f=1", "display_name": "Macukadam", "link": "https://stackoverflow.com/users/5584869/macukadam"}, "reply_to_user": {"reputation": 844, "user_id": 3394380, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b5c00710c3e7e88a2065166d372fec1?s=128&d=identicon&r=PG&f=1", "display_name": "yW0K5o", "link": "https://stackoverflow.com/users/3394380/yw0k5o"}, "edited": false, "score": 0, "creation_date": 1501828558, "post_id": 45463484, "comment_id": 77960231, "body": "@alex I tried as you said but stil no results."}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 5584869, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c7b80191458eaf75a4b9be9e5262f665?s=128&d=identicon&r=PG&f=1", "display_name": "Macukadam", "link": "https://stackoverflow.com/users/5584869/macukadam"}, "is_accepted": false, "score": 0, "last_activity_date": 1502086579, "creation_date": 1502086579, "answer_id": 45540468, "question_id": 45463484, "link": "https://stackoverflow.com/questions/45463484/is-there-any-way-to-send-data-to-asp-net-mvc-controller-httppost-action-method-f/45540468#45540468", "title": "Is there any way to send data to asp.net mvc controller httppost action method from Excel using VBA", "body": "<p>I have found the solotion finally. My project is using asp.net authentication. DashBoardController is only avilable for authenticated users. I have added a data annotation to my action controller. Now everything works fine. </p>\n\n<blockquote>\n  <p>[AllowAnonymous]</p>\n</blockquote>\n\n<pre><code>[HttpPost]\n[AllowAnonymous]\npublic ActionResult Updtdb(string x)\n{\n    return Content(\"a\");\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5584869, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c7b80191458eaf75a4b9be9e5262f665?s=128&d=identicon&r=PG&f=1", "display_name": "Macukadam", "link": "https://stackoverflow.com/users/5584869/macukadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502086579, "creation_date": 1501683641, "last_edit_date": 1531164843, "question_id": 45463484, "link": "https://stackoverflow.com/questions/45463484/is-there-any-way-to-send-data-to-asp-net-mvc-controller-httppost-action-method-f", "title": "Is there any way to send data to asp.net mvc controller httppost action method from Excel using VBA", "body": "<p>My controller is:</p>\n\n<pre><code>[HttpPost]\npublic IActionResult Updtdb(string longStr)\n{\n//some code here!\n}\n</code></pre>\n\n<p>I am trying to send data to my website from excel. \nHere is what i have tried so far.</p>\n\n<pre><code>Sub XMLPost()\nDim xmlhttp, longStr As String\n\n    With ActiveSheet\n        longStr = \"x=\" &amp; generateData\n    End With\n\n    Set xmlhttp = CreateObject(\"microsoft.xmlhttp\")\n\n    With xmlhttp\n        .Open \"POST\", \" http://localhost:54188/DashBoard/Updtdb\", False\n        .setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n        .send longStr\n    End With\nEnd Sub\n\nFunction generateData()\n    Dim longString As String, range As range\n\n    Set range = Sayfa8.range(\"SummaryTable\")\n\n    For Each cell In range.Cells\n        longString = longString + CStr(cell.Value) + \";\"\n    Next cell\n\n    generateData = longString\nEnd Function\n</code></pre>\n\n<p>When i run Sub XML Post() it works but does not invoke the action method. I am not sure how to achieve it or is it even achievable. Any help?</p>\n"}, {"tags": ["vba", "excel", "authentication", "internet-explorer", "dom"], "comments": [{"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1501683297, "post_id": 45463275, "comment_id": 77887303, "body": "That page has frames and the URL you provided is the top frame. The real URL for the login part is: <a href=\"https://www.fois.indianrail.gov.in/ecustomer/JSP/LoginNew.jsp\" rel=\"nofollow noreferrer\">fois.indianrail.gov.in/ecustomer/JSP/LoginNew.jsp</a>"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1501684281, "post_id": 45463275, "comment_id": 77888074, "body": "Assuming Logan is correct, you will want to navigate to the document of the frame, and then get the element by ID. You should be able to get the frame by either the name, class, or ID."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501685895, "post_id": 45463275, "comment_id": 77889408, "body": "Try using the same code in VBS using .getElementsByName(&quot;txtUserId&quot;).value"}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1501684791, "creation_date": 1501684791, "answer_id": 45463910, "question_id": 45463275, "link": "https://stackoverflow.com/questions/45463275/not-able-to-login-to-a-webpage-using-excel-error-424-object-required/45463910#45463910", "title": "Not able to login to a webpage using excel, error 424 object required", "body": "<p>Take a look at the below example:</p>\n\n\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim oIE As Object\n\n    Set oIE = CreateObject(\"InternetExplorer.application\")\n    With oIE\n        .Visible = True\n        .Navigate (\"https://www.fois.indianrail.gov.in/ecustomer/JSP/QryInsight.jsp\")\n        Do While .ReadyState &lt; 4 Or .Busy\n            DoEvents\n        Loop\n        With .Document\n            Do While .ReadyState &lt;&gt; \"complete\"\n                DoEvents\n            Loop\n            With .parentWindow.frames(\"frmCUMain\").document\n                .getElementsByName(\"txtUserId\")(0).Value = \"ABCDE\"\n                .getElementsByName(\"txtPassword\")(0).Value = \"ABCDE\"\n                .getElementsByName(\"cmdLogin\")(0).Click\n            End With\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8406051, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214404850743592/picture?type=large", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8406051/deepak-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532362035, "creation_date": 1501683038, "last_edit_date": 1532362035, "question_id": 45463275, "link": "https://stackoverflow.com/questions/45463275/not-able-to-login-to-a-webpage-using-excel-error-424-object-required", "title": "Not able to login to a webpage using excel, error 424 object required", "body": "<p>I am trying to login to this webpage, <a href=\"https://www.fois.indianrail.gov.in/ecustomer/JSP/QryInsight.jsp\" rel=\"nofollow noreferrer\">https://www.fois.indianrail.gov.in/ecustomer/JSP/QryInsight.jsp</a>\nusing VBA. Debugging shows me that the VBA throws an error 424 object required when username line is active (apparently it is not able to fill the username data).</p>\n\n<p>Here's the code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n\n    Set ie = CreateObject(\"InternetExplorer.application\")\n    ie.Visible = True\n    ie.Navigate (\"https://www.fois.indianrail.gov.in/ecustomer/JSP/QryInsight.jsp\")\n    With ie.document\n        .getElementById(\"txtUserId\").Value = \"ABCDE\"\n        .getElementById(\"txtPassword\").Value = \"ABCDE\"\n        .getElementById(\"submit\").Click\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone help me with debugging the problem while logging in to the given webpage?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1501682584, "post_id": 45463062, "comment_id": 77886718, "body": "LEFT(A2,2) - use a comma, not a semicolon"}, {"owner": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "edited": false, "score": 1, "creation_date": 1501682592, "post_id": 45463062, "comment_id": 77886726, "body": "Those semicolons (;) should be commas (,)"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1501684578, "post_id": 45463105, "comment_id": 77888324, "body": "This is not vb.Net, this is <code>VBA</code>. Escape symbols are different."}], "tags": [], "owner": {"reputation": 285, "user_id": 5501520, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/MStfr.jpg?s=128&g=1", "display_name": "blackspacer", "link": "https://stackoverflow.com/users/5501520/blackspacer"}, "is_accepted": false, "score": 0, "last_activity_date": 1501682587, "creation_date": 1501682587, "answer_id": 45463105, "question_id": 45463062, "link": "https://stackoverflow.com/questions/45463062/apply-formula-in-vba/45463105#45463105", "title": "Apply formula in VBA?", "body": "<p>Instead of double double-quotes. try skipping the double quotes with .</p>\n\n<p>For example: instead of \"\"Q\"\" try \\\"Q\\\"</p>\n"}, {"comments": [{"owner": {"reputation": 454, "user_id": 6320022, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/10205374177708738/picture?type=large", "display_name": "Daniel Via&#241;o", "link": "https://stackoverflow.com/users/6320022/daniel-via%c3%b1o"}, "edited": false, "score": 1, "creation_date": 1501682862, "post_id": 45463125, "comment_id": 77886961, "body": "This solved the problem, I will accept is as soon as possible. Thank you."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1501682627, "creation_date": 1501682627, "answer_id": 45463125, "question_id": 45463062, "link": "https://stackoverflow.com/questions/45463062/apply-formula-in-vba/45463125#45463125", "title": "Apply formula in VBA?", "body": "<p>VBA uses the comma separator, irrespective of your local settings</p>\n\n<pre><code>Range(\"R2:R\" &amp; lastRow).Formula = \"=IF(LEFT(A2,2)=\"\"Q)\"\",\"\"YES\"\",\"\"NO\"\")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 454, "user_id": 6320022, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/10205374177708738/picture?type=large", "display_name": "Daniel Via&#241;o", "link": "https://stackoverflow.com/users/6320022/daniel-via%c3%b1o"}, "edited": false, "score": 0, "creation_date": 1501682966, "post_id": 45463184, "comment_id": 77887040, "body": "I tried that but it used R1C1 format and I am not familiar with it."}], "tags": [], "owner": {"reputation": 21, "user_id": 4687938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645f558dd20ee4944fd132e45cf34bc2?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/4687938/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1501682766, "creation_date": 1501682766, "answer_id": 45463184, "question_id": 45463062, "link": "https://stackoverflow.com/questions/45463062/apply-formula-in-vba/45463184#45463184", "title": "Apply formula in VBA?", "body": "<p>You could always try the record macro option:\n 1. Start recording\n 2. Paste the formula into a cell\n 3. Stop recording\n 4. Look at the recorded macro and how it formats the formula</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1501683307, "creation_date": 1501683307, "answer_id": 45463372, "question_id": 45463062, "link": "https://stackoverflow.com/questions/45463062/apply-formula-in-vba/45463372#45463372", "title": "Apply formula in VBA?", "body": "<p>In general, try the following:</p>\n\n<ul>\n<li><p>Make a workable formula in Excel</p></li>\n<li><p>Then select the cell with the workable formula</p></li>\n<li><p>Run <strong>the code</strong></p></li>\n<li><p>In the immediate window something useful should be printed.</p></li>\n</ul>\n\n<hr>\n\n<p><strong>The code</strong>:</p>\n\n<pre><code>Public Sub PrintMeUsefulFormula()\n    Dim strFormula  As String\n    Dim strParenth  As String\n\n    strParenth = \"\"\"\"\n\n    strFormula = Selection.Formula\n    strFormula = Replace(strFormula, \"\"\"\", \"\"\"\"\"\")\n\n    strFormula = strParenth &amp; strFormula &amp; strParenth\n    Debug.Print strFormula\nEnd Sub\n</code></pre>\n\n<p>Source: <a href=\"https://stackoverflow.com/questions/45441679/error-with-if-or-in-vba/45441770#45441770\">Error with IF/OR in VBA</a></p>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1501683433, "creation_date": 1501683433, "answer_id": 45463420, "question_id": 45463062, "link": "https://stackoverflow.com/questions/45463062/apply-formula-in-vba/45463420#45463420", "title": "Apply formula in VBA?", "body": "<p>The <code>Range.Formula</code> is expecting a EN-US syntax.</p>\n\n<p>Use <code>Range.FormulaLocal</code> to insert a formula based on your regional settings:</p>\n\n<pre><code>Range(\"R2\").FormulaLocal = \"=IF(LEFT(A2;2)=\"\"Q)\"\";\"\"YES\"\";\"\"NO\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 454, "user_id": 6320022, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/10205374177708738/picture?type=large", "display_name": "Daniel Via&#241;o", "link": "https://stackoverflow.com/users/6320022/daniel-via%c3%b1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5675, "favorite_count": 1, "accepted_answer_id": 45463125, "answer_count": 5, "score": 1, "last_activity_date": 1501683433, "creation_date": 1501682474, "question_id": 45463062, "link": "https://stackoverflow.com/questions/45463062/apply-formula-in-vba", "title": "Apply formula in VBA?", "body": "<p>I am trying to apply a formula that writes YES or NO in a cell checking if another cell starts with Q) text.</p>\n\n<p>Writing it manually in Excel is working.</p>\n\n<pre><code>=IF(LEFT(A2;2)=\"Q)\";\"YES\";\"NO\")\n</code></pre>\n\n<p>But when I try to do it automatically inside a macro</p>\n\n<pre><code>Range(\"R2\").Formula = \"=IF(LEFT(A2;2)=\"\"Q)\"\";\"\"YES\"\";\"\"NO\"\")\"\n</code></pre>\n\n<blockquote>\n  <p>Run-time error '1004': Application-defined or object-defined error</p>\n</blockquote>\n\n<p>Also, I will want to do it for the whole column, something like this</p>\n\n<pre><code>Range(\"R2:R\" &amp; lastRow).Formula = \"=IF(LEFT(A2;2)=\"\"Q)\"\";\"\"YES\"\";\"\"NO\"\")\"\n</code></pre>\n\n<p>But for that I have to solve the first problem before.</p>\n\n<p>What am I doing wrong? </p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 582, "user_id": 6088173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/45e88c81571b76fe88275bf0ab1a3777?s=128&d=identicon&r=PG&f=1", "display_name": "paulinhax", "link": "https://stackoverflow.com/users/6088173/paulinhax"}, "edited": false, "score": 0, "creation_date": 1501681901, "post_id": 45462776, "comment_id": 77886166, "body": "are copying and pasting in the same sheet? and these ranges <code>Range(a,18)</code> and <code>Range(b,3)</code> are always the same?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501682110, "post_id": 45462776, "comment_id": 77886344, "body": "try changing this <code>Macro.Application.Range</code> to this <code>ActiveSheet.Range</code>"}, {"owner": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 0, "creation_date": 1501682116, "post_id": 45462776, "comment_id": 77886350, "body": "Yes, I am copying and pasting in the same sheet. I will always be copying from columns R:X and pasting in columns C:I"}, {"owner": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501682181, "post_id": 45462776, "comment_id": 77886403, "body": "@braX when I make that change I get a new error message, Run-time error &#39;1004&#39;:  Method &#39;Range&#39; of object &#39;_Global&#39; failed"}, {"owner": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 0, "creation_date": 1501682229, "post_id": 45462776, "comment_id": 77886453, "body": "<a href=\"https://i.stack.imgur.com/km8Ke.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/km8Ke.png</a> Here is a link to the screenshots. I want the top photo to look like the bottom photo."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501682354, "post_id": 45462776, "comment_id": 77886545, "body": "you define <code>rng</code> but you arent using it anywhere?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 0, "creation_date": 1501682819, "post_id": 45463010, "comment_id": 77886924, "body": "For some reason, that just seemed to remove column t of my data."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 0, "creation_date": 1501683069, "post_id": 45463010, "comment_id": 77887128, "body": "@Emma - try to code again. Take a look at the immediate window every time the code stops."}, {"owner": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 0, "creation_date": 1501683982, "post_id": 45463010, "comment_id": 77887800, "body": "Every round, it prints out: copying from =&gt;$T$2 copying to =&gt;$AI$5"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 0, "creation_date": 1501684046, "post_id": 45463010, "comment_id": 77887851, "body": "Ok. Then try to adjust it a bit to what you want, by changing <code>a</code>, <code>b</code>, <code>3</code> and <code>18</code>, @Emma"}, {"owner": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 0, "creation_date": 1501685698, "post_id": 45463010, "comment_id": 77889245, "body": "After I changed the range from A1:X1000, the first column transferred successfully. Many thanks :D"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 0, "creation_date": 1501685835, "post_id": 45463010, "comment_id": 77889362, "body": "@Emma  - congrats for managing to fix it! :) Feel free to mark the answer as selected, by clicking on the green check next to it :)"}, {"owner": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "edited": false, "score": 1, "creation_date": 1501687753, "post_id": 45463010, "comment_id": 77890861, "body": "Thank you so much! (I&#39;m new!)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1501683045, "last_edit_date": 1501683045, "creation_date": 1501682335, "answer_id": 45463010, "question_id": 45462776, "link": "https://stackoverflow.com/questions/45462776/for-loop-in-vba-code/45463010#45463010", "title": "For loop in VBA Code", "body": "<p>Try like this and make sure your values are on the activesheet.</p>\n\n<pre><code>Sub MoveData()\n\n    Dim rng As Range\n\n    Set rng = ActiveSheet.Range(\"R1:X1000\")\n\n    With rng\n        For i = 1 To 200\n            a = 5 * i\n            b = i + 1\n\n            Debug.Print \"copying from =&gt;\" &amp; .Cells(b, 3).Address\n            Debug.Print \"copyting to =&gt;\" &amp; .Cells(a, 18).Address\n\n            Stop 'and take a look at the immediate window\n            ' what is there?\n\n            .Cells(b, 3) = .Cells(a, 18)\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8405849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e979f9519e1b979ebf54e4e85cf4d493?s=128&d=identicon&r=PG&f=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/8405849/emma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 45463010, "answer_count": 1, "score": 1, "last_activity_date": 1518801078, "creation_date": 1501681716, "last_edit_date": 1531164843, "question_id": 45462776, "link": "https://stackoverflow.com/questions/45462776/for-loop-in-vba-code", "title": "For loop in VBA Code", "body": "<p>NOTE: I was able to upload a link to a picture in the comments.</p>\n\n<p>I am using a for loop in an excel macro in an attempt to compile data. </p>\n\n<p>I have the following VBA code:</p>\n\n<pre><code>Sub MoveData()\n'\n' MoveData Macro\n'\n\n'\nDim rng As Range\nSet rng = Macro.Application.Range(\"R1:X1000\")\nWith rng\n\n\n    For i = 1 To 200\n        a = 5 * i\n        b = i + 1\n\n        Range(a, 18).Select\n        Selection.Copy\n        Range(b, 3).Select\n        ActiveSheet.Paste\n\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I get the following error message:\nRun-time error '424':</p>\n\n<p>Object required</p>\n\n<p>Any clarification would be much appreciated! I've been stumped on this for quite a while!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501681535, "post_id": 45462501, "comment_id": 77885828, "body": "Slightly confusing: your description refers to <code>F2</code>, but your code is using <code>L2</code>"}, {"owner": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501682673, "post_id": 45462501, "comment_id": 77886799, "body": "that&#39;s just for example sorry"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 0, "creation_date": 1501682471, "post_id": 45462752, "comment_id": 77886626, "body": "Hi, thanks for the response. Yes. I can use this but I can use this additionally. But anyways I need to program for cell L2. Because B2 is input. L2 is output. and if output L2 exceeds 100, then msgbox should pop up and cell L2 returns to old value. Is that possible to do it via VBA?"}], "tags": [], "owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "is_accepted": false, "score": 1, "last_activity_date": 1501681671, "creation_date": 1501681671, "answer_id": 45462752, "question_id": 45462501, "link": "https://stackoverflow.com/questions/45462501/vba-code-to-popup-msgbox-and-return-to-the-previous-value/45462752#45462752", "title": "VBA code to popup msgbox and return to the previous value", "body": "<p>I'm not sure if I get your question, but it seems you could use data validation in cell B2 to prevent users from inputting values higher than 100. Click on cell B2, go to the \"Data\" tab, and click on \"Data Validation\". Modify the conditions like the image below, and on the \"Error Alert\" tab, put in the message you want them to see when they try to enter a value higher than 100.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GLgIk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GLgIk.png\" alt=\"data validation picture\"></a> <a href=\"https://i.stack.imgur.com/GJ6jr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GJ6jr.png\" alt=\"error alert msg picture\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 0, "creation_date": 1501683134, "post_id": 45463101, "comment_id": 77887178, "body": "Hi,   I have one doubt on your code. in your code, you added Public B2Value as integer and Private sub...   when I treid this the code goes to next line"}, {"owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "reply_to_user": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 0, "creation_date": 1501683331, "post_id": 45463101, "comment_id": 77887321, "body": "The <code>Public B2Value As Integer</code> is simply a global variable to store the value of B2 before you make a change to it. Make a backup of your workbook and then test the code if you have doubts; it worked fine for me. (I also changed <code>F2</code> to <code>L2</code>)"}, {"owner": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 0, "creation_date": 1501683407, "post_id": 45463101, "comment_id": 77887372, "body": "Error at &quot;B2 value as Integer&quot;"}, {"owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "reply_to_user": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 0, "creation_date": 1501683490, "post_id": 45463101, "comment_id": 77887434, "body": "Can you please add the code you made into your post? The word <code>G1</code> is not in the code I wrote..."}, {"owner": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 0, "creation_date": 1501683745, "post_id": 45463101, "comment_id": 77887610, "body": "yes I just changed the cells based on my worksheet. Here is my code.      Public G1Value As Integer      Private Sub Worksheet_Change(ByVal Target As Range)     If Target = Range(&quot;G1&quot;) Then         If Range(&quot;L2&quot;) &gt; 100 Then             MsgBox &quot;Error. Invalid value for G1&quot;             Range(&quot;G1&quot;) = G1Value         Else: End If     Else: End If    End Sub  Private Sub Worksheet_SelectionChange(ByVal Target As Range)     If Target = Range(&quot;G1&quot;) Then         G1Value = Range(&quot;G1&quot;)     Else: End If End Sub"}, {"owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "reply_to_user": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 0, "creation_date": 1501684509, "post_id": 45463101, "comment_id": 77888261, "body": "That&#39;s pretty weird for you to get an error on the first line. Is there any additional code on the worksheet besides the code I gave you?"}, {"owner": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 1, "creation_date": 1501769291, "post_id": 45463101, "comment_id": 77934113, "body": "Hi Takanuva,  Sorry if I troubled you yesterday.  Today I actually got your code to work. I had some codes already in Worksheet_change event and Worksheet_selectionchange event. So It couldn&#39;t run properly when mixed up. Today I just added them in to exiting code properly and its works like a charm. Thanks a lot for the support."}, {"owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "reply_to_user": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "edited": false, "score": 0, "creation_date": 1501780758, "post_id": 45463101, "comment_id": 77942770, "body": "Great, happy to hear it!"}], "tags": [], "owner": {"reputation": 749, "user_id": 6854489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5cb66e283a222e78f3fe5f45e1eb0406?s=128&d=identicon&r=PG&f=1", "display_name": "takanuva15", "link": "https://stackoverflow.com/users/6854489/takanuva15"}, "is_accepted": true, "score": 1, "last_activity_date": 1501684557, "last_edit_date": 1501684557, "creation_date": 1501682574, "answer_id": 45463101, "question_id": 45462501, "link": "https://stackoverflow.com/questions/45462501/vba-code-to-popup-msgbox-and-return-to-the-previous-value/45463101#45463101", "title": "VBA code to popup msgbox and return to the previous value", "body": "<p>Hold up, I think I have a better understanding of your question now. When a user puts something in B2, if that change causes cell F2 to go higher than 100, then you want to output an error message and return cell B2 to the value that it was. Here's how you can do that easily:</p>\n\n<p>Go to the view code of the worksheet you are on by right-clicking the worksheet tab name:</p>\n\n<p><a href=\"https://i.stack.imgur.com/D1FOI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D1FOI.png\" alt=\"view code of worksheet\"></a></p>\n\n<p>Then add in this code (if a duplicate method exists, then comment out the old code or replace it if it's unimportant).</p>\n\n<pre><code>Public B2Value As Integer\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target = Range(\"B2\") Then\n        If Range(\"L2\") &gt; 100 Then\n            MsgBox \"Error. Invalid value for B2\"\n            Range(\"B2\") = B2Value\n        Else: End If\n    Else: End If\nEnd Sub\n\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target = Range(\"B2\") Then\n        B2Value = Range(\"B2\")\n    Else: End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8263195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9674ab45ce7c40a82f37dfa237e9101f?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath kumar", "link": "https://stackoverflow.com/users/8263195/sarath-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 45463101, "answer_count": 2, "score": 0, "last_activity_date": 1501684557, "creation_date": 1501681063, "last_edit_date": 1531164843, "question_id": 45462501, "link": "https://stackoverflow.com/questions/45462501/vba-code-to-popup-msgbox-and-return-to-the-previous-value", "title": "VBA code to popup msgbox and return to the previous value", "body": "<p>I need a VBA code that pops up error/warning message when the cell value is exceeds more than 100. </p>\n\n<p>For example, if value entered in B2, F2 cells updates automatically. Higher the B2 value will lead F2 value cross 100 and sheet becomes error. </p>\n\n<p>So, I need to give message here to uses, when F2 goes beyond 100 and B2 should return to last value. </p>\n\n<p>My current code is very basic. Please help me to get thru this.</p>\n\n<pre><code>If Sheets(\"200L_50\u00b0C\").Range(\"L2\").Value &lt; 100 Then\nMsgBox \"No further pressure drop at higher operating temperatures\",   vbOKOnly, \"High temperature\"\n</code></pre>\n\n<p>Update, this is the code I put in my worksheet. I get error on the first line:</p>\n\n<pre><code>Public G1Value As Integer\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Target = Range(\"G1\") Then\n    If Range(\"L2\") &gt; 100 Then\n        MsgBox \"Error. Invalid value for G1\"\n        Range(\"G1\") = G1Value\n    Else: End If\nElse: End If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target = Range(\"G1\") Then\n    G1Value = Range(\"G1\")\nElse: End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1501689238, "post_id": 45462458, "comment_id": 77891972, "body": "Why am I using excel and vba you may ask ? I&#39;ve written a handy utility that acts a bit like the spy++ in vs. It lists all the processes and child processes on a sheet that way I can click on a handle then click on close or move etc and test my code out on lot&#39;s of different applications without changing the code at all.  This is how I know close move etc works fine for applications running directly in windows but doesn&#39;t for one running through citrix. Interesting thing for me is I can move the main citrix window jut not any of the spawned process..."}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1501689985, "post_id": 45462458, "comment_id": 77892495, "body": "Ah, I see the confusion about vb.net I&#39;ve tagged the question  vb.net.  Though my test isn&#39;t in vb.net my final solution will be so I&#39;d be glad to receive Vb.net or VB6 advice. How can I add a VB6 flag to my question ? Thanks"}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "reply_to_user": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1502020380, "post_id": 45462458, "comment_id": 78023431, "body": "Would anyone have any comments about the following. If I put the move code in to the client app so that as it booted it moved it self to a certain screen position ? Would this work ? How could I send it info to tell it where to go though is it possible to add things to a command line statement ? I have put this question on the Citrix forum but I think I&#39;m the only member on that one , and I haven&#39;t been any help to myself ;-)"}, {"owner": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1502021018, "post_id": 45462458, "comment_id": 78023608, "body": "Don&#39;t put unrelated tags in the question, that just confuses people and usually attracts downvotes. If this is VBA it should only be tagged as such. VB.NET is far from related to VBA and VB6."}, {"owner": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1502021481, "post_id": 45462458, "comment_id": 78023711, "body": "And FYI not all windows can be moved by <code>SetWindowPos()</code>. I&#39;m not saying this is the case for the Citrix app, but an application can choose to ignore external movement messages."}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "reply_to_user": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1502028856, "post_id": 45462458, "comment_id": 78025736, "body": "Thanks for the comment Vincent. I did consider the tag thing and really any hint at a solution in VBA, VB6 or VB.net would all be greatly recieved. I had the choice of doing three threads exactly the same but with different tags or hope folk wouldn&#39;t be too harsh and accept any or all of the tags are very much relevant."}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "reply_to_user": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1502028864, "post_id": 45462458, "comment_id": 78025740, "body": "The bit about not all windows can be moved by SetWindowPos() is probably what I&#39;m up against. The client is excel so I know excel can be moved and resized when running on the users pc but not when running on the server via Citrix so I&#39;m guessing Citrix filters out the commands.. I have also posted on the Citrix site hoping someone there would be able to give me a definitive yea or nay..."}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1501842746, "post_id": 45493965, "comment_id": 77969593, "body": "Do you know if this is available in a VBA environment ? I&#39;ve had a good search about but can&#39;t see it at the moment. I guess another question would be , do you know what it does  ? Thanks for the reply...."}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "reply_to_user": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1501853564, "post_id": 45493965, "comment_id": 77977119, "body": "In my accounting application, I have one particular user who uses Citrix.  I do not know what it specifically does, but I figured that since I knew of that one client, I&#39;d check the box, since it merely said something to the affect of making the app citrix-compliant.  It did not affect my entire user base so I left it set.  I doubt it&#39;s available to VBA, I only saw it specifically in VB 6.0."}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1501864768, "post_id": 45493965, "comment_id": 77984480, "body": "Thanks, Bill, I can&#39;t seem to find out much about it but it looks like it maybe a thing to include in the compiled app to make it behave better as a client side app. But I haven&#39;t had any problems running other vb.net or VBA stuff client side so not sure what it does. I&#39;ll keep looking."}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "reply_to_user": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1501876419, "post_id": 45493965, "comment_id": 77990412, "body": "I&#39;ve pored through my application just now and in the MSDN help that came with it and I must have mis-remembered the citrix checkbox - it&#39;s not where I remember it being, nor can I find it anywhere else.  Sorry, but good luck in your search for a solution."}], "tags": [], "owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "is_accepted": false, "score": 0, "last_activity_date": 1501792047, "creation_date": 1501792047, "answer_id": 45493965, "question_id": 45462458, "link": "https://stackoverflow.com/questions/45462458/winmove-not-working-with-citrix-app/45493965#45493965", "title": "Winmove() not working with citrix app", "body": "<p>I am not at my home machine, so I cannot confirm this, but I am fairly certain that VB 6 has a tab on the compile dialog (last one perhaps) that has a citrix-related option checkbox.  If it's not there, it might be in the project properties.</p>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "is_accepted": false, "score": 0, "last_activity_date": 1502701568, "creation_date": 1502701568, "answer_id": 45671000, "question_id": 45462458, "link": "https://stackoverflow.com/questions/45462458/winmove-not-working-with-citrix-app/45671000#45671000", "title": "Winmove() not working with citrix app", "body": "<p>Just in case this helps someone else. I've contacted the Citrix people and they basically don't know the answer. I at least wanted to know if it was possible. Anyway as far as I can ascertain, the move command doesn't seem to be possible across the Citrix divide. The solution I've come up with is to leave the actual move part of the code in the remotely run app. That is build code in to the apps run through Citrix to look at an ini file on the local machine and receive instructions from it. \nThis now works great but will only work for apps that either have ability to run a container language or can be wrapped up somehow..</p>\n"}], "owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502701568, "creation_date": 1501680959, "last_edit_date": 1531164843, "question_id": 45462458, "link": "https://stackoverflow.com/questions/45462458/winmove-not-working-with-citrix-app", "title": "Winmove() not working with citrix app", "body": "<p>I'm back for more help please.\nI'm still on the same project as my question a few weeks ago but stuck on another bit.</p>\n\n<p>I have a multiscreen (win 7) set up and am trying to write an application that will start a number of applications and move/resize them in to the correct positions.  I'm doing this as a console app in vb.net.\nFollowing the help I received with my last question I can now start up , move , resize, close all the apps I need bar a couple. \nUnfortunately I need to run two applications through Citrix. \nOne is an Excel sheet.\nI can find the windows handle for these windows and select them and or close them but MoveWin() or SetWindowPos() doesn't seem to do anything though the title bar of the window I want to move turns blue so I know it is selecting it..\nAny assistance would be greatly appreciated.\nA section of the code is pasted below. I'm testing this in excel at the moment and I'll port it across to my console app once working...\nThanks...</p>\n\n<pre><code>Public Declare Function SetWindowPos Lib \"user32.dll\" (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long\n\nPublic Const SWP_FRAMECHANGED = &amp;H20 'Fully redraw the window in its new position.\n\nSub MoveWin()\n    Dim retval As Long\n    Dim hwnd As Long\n    Dim RetWhnd As Long\n\n    hwnd = '123456' \n\n   retval = SetWindowPos(hwnd, RetWhnd, 0, 0, 600, 400, SWP_FRAMECHANGED) ' Application.hwnd\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8285860"}, "edited": false, "score": 0, "creation_date": 1501682629, "post_id": 45462454, "comment_id": 77886760, "body": "Look up this <a href=\"https://stackoverflow.com/questions/15301158/issue-with-vba-creating-a-pivot-table-is-this-an-excel-version-issue\">Stackoverflow: Issue with vba creating a pivot table, is this an excel version issue</a>"}, {"owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "edited": false, "score": 0, "creation_date": 1501686674, "post_id": 45462454, "comment_id": 77890008, "body": "@Jerry No, this is not an Excel version issue. I had already tried before with changing the version and also tried not using the field at all as Graham suggested."}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501687297, "post_id": 45462454, "comment_id": 77890522, "body": "Which statement gives the error now that you&#39;ve split it out?"}, {"owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "reply_to_user": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501688155, "post_id": 45462454, "comment_id": 77891178, "body": "@Graham It&#39;s on the line &quot;Set pivotRange&quot;. I declared the variable, my doubt is on the &quot;Query1&quot; and &quot;Sheet4&quot; on the next line. Before the &quot;.range&quot;, is it supposed to be a variable that contains the sheet or I can write the sheet name? Query1 and Sheet4 are the sheet name, I suspect it might be an error due to that,"}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501688329, "post_id": 45462454, "comment_id": 77891311, "body": "Where is the variable Query1 defined?  That&#39;s probably the issue there."}, {"owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "reply_to_user": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501691912, "post_id": 45462454, "comment_id": 77893678, "body": "@Graham Almost there, defined all the sheets (also noticed that it called for a sheet that does not exist). Now it gives &quot;Run-time error &#39;1004&#39;: The PivotTable field name is not valid.&quot; on the line with the CreatePivotTable."}, {"owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "reply_to_user": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501693674, "post_id": 45462454, "comment_id": 77894812, "body": "@Graham Managed to make it work, thank you for the help!"}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501695394, "post_id": 45462454, "comment_id": 77895758, "body": "Please make sure you provide the answer to the community too :)"}, {"owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "reply_to_user": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501696260, "post_id": 45462454, "comment_id": 77896295, "body": "@Graham Already done, thanks again :-)"}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501701104, "post_id": 45462454, "comment_id": 77899210, "body": "Sorry for not being clear, you should post this as the Answer instead of editing the question - that way people who are searching for this can see that it&#39;s not an unanswered question."}, {"owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "reply_to_user": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1501751198, "post_id": 45462454, "comment_id": 77919723, "body": "@Graham Yes I know, it is already posted below as answer :P"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "edited": false, "score": 0, "creation_date": 1501686432, "post_id": 45463151, "comment_id": 77889820, "body": "Thank you for the reply. I tried removing the version as you said, did not resolve the problem. For the split, I&#39;m getting a Run-time error &#39;424&#39; Object required, putting the code at the bottom of the question."}], "tags": [], "owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "is_accepted": false, "score": 0, "last_activity_date": 1501682681, "creation_date": 1501682681, "answer_id": 45463151, "question_id": 45462454, "link": "https://stackoverflow.com/questions/45462454/excel-vba-function-gives-error-invalid-procedure-call-or-argument/45463151#45463151", "title": "Excel VBA Function gives error &quot;Invalid procedure call or argument&quot;", "body": "<p>Take a look at the current documentation for PivotCaches.create <a href=\"https://msdn.microsoft.com/en-us/library/office/microsoft.office.interop.excel.pivotcaches.create.aspx\" rel=\"nofollow noreferrer\">here</a> and you'll see that the method signature looks like this for both versions:</p>\n\n<pre><code>PivotCache Create(\n    XlPivotTableSourceType SourceType,\n    Object SourceData,\n    Object Version\n)\n</code></pre>\n\n<p>You are setting the PivotTableVersion to 10 explicitly, but the default for both Excel 2010 and 2013 is 12:</p>\n\n<blockquote>\n  <p>When not supplied, the version of the PivotTable will be\n  xlPivotTableVersion12.</p>\n</blockquote>\n\n<p>That's almost certainly causing you issues as you move between Excel versions so remove that last argument and let it go to the default for the current version of Excel:</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Query1!R1C1:R5000C10\").CreatePivotTable _\n    TableDestination:=\"Sheet4!R3C1\", TableName:=\"Tabella_pivot1\"\n</code></pre>\n\n<p>Also try splitting up that call into multiple statements like what you see in the accepted Answer in this question, it will make it easier to read and also help you understand where it's going wrong:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/42094245/vba-type-mismatch-with-pivotcaches\">VBA: Type Mismatch with PivotCaches</a></p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "is_accepted": false, "score": 1, "last_activity_date": 1501694157, "creation_date": 1501694157, "answer_id": 45467159, "question_id": 45462454, "link": "https://stackoverflow.com/questions/45462454/excel-vba-function-gives-error-invalid-procedure-call-or-argument/45467159#45467159", "title": "Excel VBA Function gives error &quot;Invalid procedure call or argument&quot;", "body": "<p>First of all, many thanks to @Graham who was able to help me fix part of the problem. To fix this problem, first I split the part of the code giving error as such.</p>\n\n<pre><code>Dim pCache As PivotCache\nDim pTable As PivotTable\nDim pivotRange As Range\nDim tableRange As Range\nDim Data_sht2 As Worksheet\nSet Data_sht2 = ThisWorkbook.Worksheets(\"Sheet2\")\n\nSet pivotRange = Data_sht.Range(Data_sht.Cells(1, 1), Data_sht.Cells(5000, 10))\nSet tableRange = Data_sht2.Cells(3, 1)\n\nSet pCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, _\n         SourceData:=pivotRange)\nSet pTable = pCache.CreatePivotTable(TableDestination:=tableRange, _\n         TableName:=\"Tabella_pivot1\")\n</code></pre>\n\n<p>Make sure that when you are converting the previous part to this, you know that R5000C10 means \"Row 5000 Column 10\" (I did not know and this created me some problems).</p>\n\n<p>Then I changed all instances in the original code where \"Sheet4\" was called and substituted with \"Sheet2\". Be careful with this, I noticed that if I ran the code from Excel, the newly generated sheet was called \"Sheet1\", if run by HPQC it was called \"Sheet2\". Make sure you use the debugger and see how the new sheet is called.</p>\n\n<p>Also be careful that for \"Set pivotRange\" and \"Set tableRange\", you cannot give it the sheet name itself, assign the sheet to a variable and then use that.</p>\n\n<p>With all these things combined, the code now works. The postprocessing still doesn't look exactly as I expected but I suspect this is due to changes in ExcelVBA from Excel 2007 to Excel2013 (the pivot table shows the information needed but formatted slightly differently). I hope this will help others in my same situation.</p>\n"}], "owner": {"reputation": 21, "user_id": 8404876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd4c05a9a2a8dfdc97a5beb76382920?s=128&d=identicon&r=PG&f=1", "display_name": "Ou Yan Zhou", "link": "https://stackoverflow.com/users/8404876/ou-yan-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3580, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1501694157, "creation_date": 1501680954, "last_edit_date": 1501692307, "question_id": 45462454, "link": "https://stackoverflow.com/questions/45462454/excel-vba-function-gives-error-invalid-procedure-call-or-argument", "title": "Excel VBA Function gives error &quot;Invalid procedure call or argument&quot;", "body": "<p>My colleague uses the function below to extract data from an Excel file generated by HP Quality Center. For some reason it works for him in Excel 2007 but not for me in Excel 2013.</p>\n\n<p>I get the error <strong>Invalid procedure call or argument</strong> </p>\n\n<p>I have tried a number of fixes like replacing ' and \", emptying the Tabledestination field, changing the pivot table version and many other things. I am not proficient with VBA at all so I don't know where else to put my hands beside where the debugger tells me to.</p>\n\n<p>This is where the debugger gives the error:</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Query1!R1C1:R5000C10\", Version:=xlPivotTableVersion10).CreatePivotTable _\n    TableDestination:=\"Sheet4!R3C1\", TableName:=\"Tabella_pivot1\", _\n    DefaultVersion:=xlPivotTableVersion10\n</code></pre>\n\n<p>The full code is below:</p>\n\n<pre><code>Sub QC_PostProcessing()\nDim MainWorksheet As Worksheet\n' Make sure your worksheet name matches!\nSet MainWorksheet = ActiveWorkbook.Worksheets(\"Query1\")\nDim DataRange As Range\nSet DataRange = MainWorksheet.UsedRange\n' Now that you have the data in DataRange you can process it.\n\n' Table Title\n    Range(\"A1:J1\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorLight2\n        .TintAndShade = 0.399975585192419\n        .PatternTintAndShade = 0\n    End With\n    With Selection.Font\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = 0\n    End With\n    Selection.Font.Bold = True\n\n' Autofit\n    Columns(\"A:J\").EntireColumn.AutoFit\n\n' Table grid\n    Range(\"A1:J1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n\n' Pivot\n    Dim Data_sht As Worksheet\n    Dim StartPoint As Range\n    Dim DataRange2 As Range\n    Dim NewRange As String\n    Set Data_sht = ThisWorkbook.Worksheets(\"Query1\")\n    Set StartPoint = Data_sht.Range(\"A1\")\n    Set DataRange2 = Data_sht.Range(StartPoint, StartPoint.SpecialCells(xlLastCell))\n    NewRange = Data_sht.Name &amp; \"!\" &amp; _\n    DataRange2.Address(ReferenceStyle:=xlR1C1)\n    'Query1!R1C1:R5000C10\"\n\n    Selection.Copy\n    Application.CutCopyMode = False\n    Sheets.Add\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Query1!R1C1:R5000C10\", Version:=xlPivotTableVersion10).CreatePivotTable _          ' variabile\n        TableDestination:=\"Sheet4!R3C1\", TableName:=\"Tabella_pivot1\", _\n        DefaultVersion:=xlPivotTableVersion10\n    Sheets(\"Sheet4\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"Tabella_pivot1\").PivotFields(\"Priority\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"Tabella_pivot1\").PivotFields( _\n        \"Subject\")\n        .Orientation = xlRowField\n        .Position = 2\n    End With\n    ActiveSheet.PivotTables(\"Tabella_pivot1\").AddDataField ActiveSheet.PivotTables( _\n        \"Tabella_pivot1\").PivotFields(\"Status\"), \"Count of Status\", xlCount\n    With ActiveSheet.PivotTables(\"Tabella_pivot1\").PivotFields(\"Status\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n\n' Graph\n    Range(\"K3\").Select\n    ActiveSheet.PivotTables(\"Tabella_pivot1\").PivotSelect \"\", xlDataAndLabel, True\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlColumnClustered\n    ActiveChart.SetSourceData Source:=Range(\"Sheet4!$A$3:$E$22\")\n    ActiveSheet.Shapes(\"Chart 1\").IncrementLeft 200\n    ActiveSheet.Shapes(\"Chart 1\").IncrementTop -230.00\n    ActiveSheet.Shapes(\"Chart 1\").ScaleWidth 1.3270833333, msoFalse, _\n        msoScaleFromTopLeft\n    ActiveSheet.Shapes(\"Chart 1\").ScaleHeight 1.3767362934, msoFalse, _\n        msoScaleFromTopLeft\n\n' Rename sheets\n    Sheets(\"Sheet4\").Select\n    Sheets(\"Sheet4\").Name = \"Stats\"\n    Sheets(\"Query1\").Select\n    Sheets(\"Query1\").Name = \"Report\"\n    Sheets(\"Stats\").Select\n    Sheets(\"Stats\").Move After:=Sheets(2)\n    Range(\"A1\").Select\n    Sheets(\"Report\").Select\n    Range(\"A2\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for the help.</p>\n\n<p><strong>Edit</strong>: tried splitting the function as Graham suggested, got a Run-time error '424' Object required. Here is how I did the split.</p>\n\n<p><strong>Edit2</strong>: update the underneath code to the last version, it now gives the following error \"Run-time error '1004': The PivotTable field name is not valid. To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.\" on the line with the CreatePivotTable.</p>\n\n<pre><code>Dim pCache As PivotCache\nDim pTable As PivotTable\nDim pivotRange As Range\nDim tableRange As Range\nDim Data_sht2 As Worksheet\nSet Data_sht2 = ThisWorkbook.Worksheets(\"Sheet1\")\n\nSet pivotRange = Data_sht.Range(Data_sht.Cells(1, 1), Data_sht.Cells(5000, 18))\nSet tableRange = Data_sht2.Range(Data_sht2.Cells(3, 18), Data_sht2.Cells(1, 3))\n\nSet pCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, _\n         SourceData:=pivotRange)\nSet pTable = pCache.CreatePivotTable(TableDestination:=tableRange, _\n         TableName:=\"Tabella_pivot1\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 1, "creation_date": 1501680893, "post_id": 45462372, "comment_id": 77885259, "body": "Also remove the End if for the inner if&#39;s"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1501680945, "last_edit_date": 1501680945, "creation_date": 1501680797, "answer_id": 45462372, "question_id": 45462305, "link": "https://stackoverflow.com/questions/45462305/if-statements-inside-for-loop/45462372#45462372", "title": "If statements inside for loop", "body": "<p>Change those <code>Else</code>s to <code>ElseIf</code>s:</p>\n\n<pre><code>If TLD = Listtld Then\n    If Product = \"auto renewal\" Then\n        If Period = \"1 year\" Then\n            Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(2 + startnumber, 2)\n        ElseIf Period = \"2 years\" Then\n            Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(3 + startnumber, 2)\n        ElseIf Period = \"3 years\" Then\n            Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(4 + startnumber, 2)\n        ElseIf Period = \"4 years\" Then\n            Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(5 + startnumber, 2)\n        ElseIf Period = \"5 years\" Then\n            Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(6 + startnumber, 2)\n        End If\n    End If\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1501680951, "creation_date": 1501680951, "answer_id": 45462451, "question_id": 45462305, "link": "https://stackoverflow.com/questions/45462305/if-statements-inside-for-loop/45462451#45462451", "title": "If statements inside for loop", "body": "<p>Definitely switch to <code>Select Case</code>, instead of mulitple <code>If</code>s:</p>\n\n<pre><code>Select Case Period\n    Case \"1 year\"\n        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(2 + startnumber, 2)\n\n    Case \"2 years\"\n        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(3 + startnumber, 2)\n\n    Case \"3 years\"\n        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(4 + startnumber, 2)\n\n    Case \"4 years\"\n        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(5 + startnumber, 2)\n\n    Case \"5 years\"\n        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(6 + startnumber, 2)\n\nEnd Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1501680991, "creation_date": 1501680991, "answer_id": 45462469, "question_id": 45462305, "link": "https://stackoverflow.com/questions/45462305/if-statements-inside-for-loop/45462469#45462469", "title": "If statements inside for loop", "body": "<p>Here it is fixed up:</p>\n\n<pre><code>Sub add_prices()\n  Dim startnumber As Long\n  Dim endnumber As Long\n  Dim TLD As String\n  Dim Listtld As String\n  Dim Product As String\n  Dim Period As String\n\n  endnumber = Sheets(\"Pricelist\").Application.WorksheetFunction.CountF(Range(\"F2:F40000\")) - 1\n\n  For startnumber = 0 To endnumber\n\n  TLD = Cells(3 + startnumber, 2)\n  Listtld = Sheets(\"pricelist\").Cells(2 + startnumber, 7)\n  Product = Sheets(\"pricelist\").Cells(2 + startnumber, 8)\n  Period = Sheets(\"pricelist\").Cells(2 + startnumber, 9)\n\n  If TLD = Listtld Then\n      If Product = \"auto renewal\" Then\n          If Period = \"1 year\" Then\n              Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(2 + startnumber, 2)\n          ElseIf Period = \"2 years\" Then\n              Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(3 + startnumber, 2)\n          ElseIf Period = \"3 years\" Then\n              Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(4 + startnumber, 2)\n          ElseIf Period = \"4 years\" Then\n              Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(5 + startnumber, 2)\n          ElseIf Period = \"5 years\" Then\n              Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(6 + startnumber, 2)\n          End If\n      End If\n  End If\n  Next startnumber\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1501681509, "creation_date": 1501681509, "answer_id": 45462674, "question_id": 45462305, "link": "https://stackoverflow.com/questions/45462305/if-statements-inside-for-loop/45462674#45462674", "title": "If statements inside for loop", "body": "<p>I hesitate to add another solution, but you could shorten your code</p>\n\n<pre><code>Sub add_prices()\n\nDim startnumber As Long\nDim endnumber As Long\nDim TLD As String\nDim Listtld As String\n\nendnumber = Sheets(\"Pricelist\").Application.WorksheetFunction.CountF(Range(\"F2:F40000\")) - 1\n\nFor startnumber = 0 To endnumber\n    TLD = Cells(3 + startnumber, 2)\n    Listtld = Sheets(\"pricelist\").Cells(2 + startnumber, 7)\n    Product = Sheets(\"pricelist\").Cells(2 + startnumber, 8)\n    Period = Sheets(\"pricelist\").Cells(2 + startnumber, 9)\n\n    If TLD = Listtld Then\n        If Product = \"auto renewal\" Then\n            Select Case Period\n                Case \"1 year\", \"2 years\", \"3 years\", \"4 years\", \"5 years\"\n                    Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(1 + startnumber + CLng(Left(Period, 1)), 2)\n                Case Else\n                    'perhaps nothing to do here\n            End Select\n        End If\n    End If\nNext startnumber\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8405637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0daeeca96bb2ac648db35ad5d37c1314?s=128&d=identicon&r=PG&f=1", "display_name": "Clausthk", "link": "https://stackoverflow.com/users/8405637/clausthk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1501681509, "creation_date": 1501680641, "last_edit_date": 1501680972, "question_id": 45462305, "link": "https://stackoverflow.com/questions/45462305/if-statements-inside-for-loop", "title": "If statements inside for loop", "body": "<p>I'm very new to VBA and what I'm trying to do here might be completely bonkers but please be gentle with me :-)</p>\n\n<p>So a bit of background. I have a list of items(TLD's) and a pricelist. With the code below, I am trying to pull the price from the pricelist for each item if the name of the item, the product and the period is correct(i hope this makes some sense).</p>\n\n<p>When i run it i get \"Compile error: Else without If\"</p>\n\n<pre><code>Sub add_prices()\n\n    Dim startnumber As Long\n    Dim endnumber As Long\n    Dim TLD As String\n    Dim Listtld As String\n\n    endnumber = Sheets(\"Pricelist\").Application.WorksheetFunction.CountF(Range(\"F2:F40000\")) - 1\n\n    For startnumber = 0 To endnumber\n\n        TLD = Cells(3 + startnumber, 2)\n        Listtld = Sheets(\"pricelist\").Cells(2 + startnumber, 7)\n        Product = Sheets(\"pricelist\").Cells(2 + startnumber, 8)\n        Period = Sheets(\"pricelist\").Cells(2 + startnumber, 9)\n\n        If TLD = Listtld Then\n            If Product = \"auto renewal\" Then\n                If Period = \"1 year\" Then\n                    Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(2 + startnumber, 2)\n                Else\n                    If Period = \"2 years\" Then\n                        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(3 + startnumber, 2)\n                    End If\n                Else\n                    If Period = \"3 years\" Then\n                        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(4 + startnumber, 2)\n                    End If\n                Else\n                    If Period = \"4 years\" Then\n                        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(5 + startnumber, 2)\n                    End If\n                Else\n                    If Period = \"5 years\" Then\n                        Cells(3 + startnumber, 3).Value = Sheets(\"pricelist\").Cells(6 + startnumber, 2)\n                    End If\n                End If\n            End If\n        End If\n    Next startnumber\nEnd Sub\n</code></pre>\n\n<p>Any suggestions would be much appreciated</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2832966, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100000277646046/picture?type=large", "display_name": "mbass438", "link": "https://stackoverflow.com/users/2832966/mbass438"}, "edited": false, "score": 0, "creation_date": 1501687593, "post_id": 45462802, "comment_id": 77890734, "body": "I appreciate the effort to propose another solution to my problem.  Each time I run the code, it causes my excel to stop responding.  I assumed that it was simply because of the large amount of processes being completed; however, after 30 minutes, it still did not respond."}, {"owner": {"reputation": 3, "user_id": 2832966, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100000277646046/picture?type=large", "display_name": "mbass438", "link": "https://stackoverflow.com/users/2832966/mbass438"}, "edited": false, "score": 0, "creation_date": 1501689704, "post_id": 45462802, "comment_id": 77892313, "body": "@garys-student EDIT#1 definitely processed much faster.  It effectively deleted all of the columns in the spreadsheet that did not have anything stored in any of the cells (Blank); however, I need this VBA script to to delete all of the columns that have no value in the cell (refer to Screenshot of spreadsheet): Col Q, and its helper Col R, are being used, but Col U (helper V) is not being used as a result of the users entry, yet they still have formulas in each of the cells (1:5000) to pull data if the user enters appropriate values.  How do I delete unused cells with formulas, too?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1501688172, "last_edit_date": 1501688172, "creation_date": 1501681795, "answer_id": 45462802, "question_id": 45462190, "link": "https://stackoverflow.com/questions/45462190/remove-blank-empty-columns-excel-vba/45462802#45462802", "title": "Remove Blank (Empty) Columns Excel VBA", "body": "<p>Because the worksheet function <code>COUNTBLANK()</code> will count both empty cells as well as cells containing formulas returning <em>NULL</em>, we can use:</p>\n\n<pre><code>Sub KolumnKleaner()\n    Dim N As Long, wf As WorksheetFunction, M As Long\n    Dim i As Long, j As Long\n\n    N = Columns.Count\n    M = Rows.Count\n    Set wf = Application.WorksheetFunction\n\n    For i = N To 1 Step -1\n        If wf.CountBlank(Columns(i)) &lt;&gt; M Then Exit For\n    Next i\n\n    For j = i To 1 Step -1\n        If wf.CountBlank(Columns(j)) = M Then\n            Cells(1, j).EntireColumn.Delete\n        End If\n    Next j\nEnd Sub\n</code></pre>\n\n<p>will remove all \"empty\" columns.</p>\n\n<p><em>Might be a little slow.</em></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>This version may be faster:</p>\n\n<pre><code>Sub KolumnKleaner2()\n    Dim N As Long, wf As WorksheetFunction, M As Long\n    Dim i As Long, j As Long\n\n    N = Columns.Count\n    M = Rows.Count\n    Set wf = Application.WorksheetFunction\n    Application.ScreenUpdating = False\n\n    For i = N To 1 Step -1\n        If wf.CountBlank(Columns(i)) &lt;&gt; M Then Exit For\n    Next i\n\n    For j = i To 1 Step -1\n        If wf.CountBlank(Columns(j)) = M Then\n            Cells(1, j).EntireColumn.Delete\n        End If\n    Next j\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2832966, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100000277646046/picture?type=large", "display_name": "mbass438", "link": "https://stackoverflow.com/users/2832966/mbass438"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2232, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529047750, "creation_date": 1501680348, "last_edit_date": 1529047750, "question_id": 45462190, "link": "https://stackoverflow.com/questions/45462190/remove-blank-empty-columns-excel-vba", "title": "Remove Blank (Empty) Columns Excel VBA", "body": "<p>I humbly ask for help modifying this code.  I have created an access database which is the information repository for approximately 30 versions of an excel spreadsheet to use for retrieving the most up-to-date information for the workbook.  After the workbook has updated the information in the helper sheets, and the user enters the appropriate fields, there are MANY unused columns and rows that need to be removed.  Each of the helper sheets dynamically pull data using formulas; therefore, the cells are not truly Empty.  I found this code which works amazingly well for removing empty cells, but I cannot figure out how to modify it so that it removes the columns which store formulas that are not being used.</p>\n\n<pre><code>Sub RemoveBlankRowsColumns()\n    Dim rng As Range\n    Dim rngDelete As Range\n    Dim RowCount As Long, ColCount As Long\n    Dim EmptyTest As Boolean, StopAtData As Boolean\n    Dim RowDeleteCount As Long, ColDeleteCount As Long\n    Dim x As Long\n    Dim UserAnswer As Variant\n\n'Analyze the UsedRange\n    Set rng = ActiveSheet.UsedRange\n    rng.Select\n\n    RowCount = rng.Rows.Count\n    ColCount = rng.Columns.Count\n    DeleteCount = 0\n\n'Determine which cells to delete\n    UserAnswer = MsgBox(\"Do you want to delete only the empty rows &amp; columns \" &amp; _\n    \"outside of your data?\" &amp; vbNewLine &amp; vbNewLine &amp; \"Current Used Range is \" &amp; rng.Address, vbYesNoCancel)\n\n    If UserAnswer = vbCancel Then\n        Exit Sub\n    ElseIf UserAnswer = vbYes Then\n        StopAtData = True\n    End If\n\n'Optimize Code\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n'Loop Through Rows &amp; Accumulate Rows to Delete\n    For x = RowCount To 1 Step -1\n'Is Row Not Empty?\n        If Application.WorksheetFunction.CountBlank(rng.Rows(x)) &lt;&gt; 0 Then\n            If StopAtData = True Then Exit For\n        Else\n            If rngDelete Is Nothing Then Set rngDelete = rng.Rows(x)\n            Set rngDelete = Union(rngDelete, rng.Rows(x))\n            RowDeleteCount = RowDeleteCount + 1\n        End If\n    Next x\n\n'Delete Rows (if necessary)\n    If Not rngDelete Is Nothing Then\n        rngDelete.EntireRow.Delete Shift:=xlUp\n        Set rngDelete = Nothing\n    End If\n\n'Loop Through Columns &amp; Accumulate Columns to Delete\n    For x = ColCount To 1 Step -1\n'Is Column Not Empty?\n        If Application.WorksheetFunction.CountBlank(rng.Columns(x)) &lt;&gt; 0 Then\n            If StopAtData = True Then Exit For\n        Else\n            If rngDelete Is Nothing Then Set rngDelete = rng.Columns(x)\n            Set rngDelete = Union(rngDelete, rng.Columns(x))\n            ColDeleteCount = ColDeleteCount + 1\n        End If\n    Next x\n\n'Delete Columns (if necessary)\n    If Not rngDelete Is Nothing Then\n        rngDelete.Select\n        rngDelete.EntireColumn.Delete\n    End If\n\n'Refresh UsedRange (if necessary)\n    If RowDeleteCount + ColDeleteCount &gt; 0 Then\n        ActiveSheet.UsedRange\n    Else\n        MsgBox \"No blank rows or columns were found!\", vbInformation, \"No Blanks Found\"\n    End If\n\nExitMacro:\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    rng.Cells(1, 1).Select\nEnd Sub\n</code></pre>\n\n<h3>Screenshot of spreadsheet</h3>\n\n<p><img src=\"https://i.stack.imgur.com/R0TaE.png\" alt=\"Screenshot of spreadsheet\"></p>\n\n<p>In the Screenshot of spreadsheet, cells A1-T221 are active and are being used in the workbook; however, </p>\n\n<ul>\n<li>Rows 222:5000 have formulas that are not being used in this workbook.</li>\n<li>Columns T1:EP5000 have formulas that are not being used in this workbook.</li>\n</ul>\n\n<p>Again- Thank you in advance for your help with finding a solution to this modification need.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1501681632, "post_id": 45462099, "comment_id": 77885929, "body": "<a href=\"https://stackoverflow.com/questions/19323343/get-a-worksheet-name-using-excel-vba\" title=\"get a worksheet name using excel vba\">stackoverflow.com/questions/19323343/&hellip;</a>"}, {"owner": {"reputation": 309, "user_id": 7019174, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/62cda081881581d37e4e2ab7b13289e3?s=128&d=identicon&r=PG&f=1", "display_name": "flowers1234", "link": "https://stackoverflow.com/users/7019174/flowers1234"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1501681891, "post_id": 45462099, "comment_id": 77886160, "body": "thx for your answer @Vityata. But I think my question was not clear enough :/. I tried the link from you but it does not work. I have a tab name this tab name has the same name as a cell in on other worksheet. And when I change the tab name I automatically want to change the name in the cell.."}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 7019174, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/62cda081881581d37e4e2ab7b13289e3?s=128&d=identicon&r=PG&f=1", "display_name": "flowers1234", "link": "https://stackoverflow.com/users/7019174/flowers1234"}, "edited": false, "score": 0, "creation_date": 1501682459, "post_id": 45462875, "comment_id": 77886615, "body": "so I have to link this formular to the cell where the same content is right? @vityata"}, {"owner": {"reputation": 309, "user_id": 7019174, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/62cda081881581d37e4e2ab7b13289e3?s=128&d=identicon&r=PG&f=1", "display_name": "flowers1234", "link": "https://stackoverflow.com/users/7019174/flowers1234"}, "edited": false, "score": 0, "creation_date": 1501682702, "post_id": 45462875, "comment_id": 77886822, "body": "I&#39;m so sorry I don&#39;t understand the Formular :-( and I really don&#39;t know where to include this."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 309, "user_id": 7019174, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/62cda081881581d37e4e2ab7b13289e3?s=128&d=identicon&r=PG&f=1", "display_name": "flowers1234", "link": "https://stackoverflow.com/users/7019174/flowers1234"}, "edited": false, "score": 0, "creation_date": 1501682732, "post_id": 45462875, "comment_id": 77886853, "body": "@flowers1234 - just put it somewhere in the excel sheet. It would return the name of the worksheet."}, {"owner": {"reputation": 309, "user_id": 7019174, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/62cda081881581d37e4e2ab7b13289e3?s=128&d=identicon&r=PG&f=1", "display_name": "flowers1234", "link": "https://stackoverflow.com/users/7019174/flowers1234"}, "edited": false, "score": 0, "creation_date": 1501827783, "post_id": 45462875, "comment_id": 77959836, "body": "&quot;filename&quot; is the name of the tab name right? Sorry for these stupid questions but it&#39;s not working :/"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 309, "user_id": 7019174, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/62cda081881581d37e4e2ab7b13289e3?s=128&d=identicon&r=PG&f=1", "display_name": "flowers1234", "link": "https://stackoverflow.com/users/7019174/flowers1234"}, "edited": false, "score": 0, "creation_date": 1501833479, "post_id": 45462875, "comment_id": 77963155, "body": "@flowers1234 - No. See the edit. There is a nice article there."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1501833460, "last_edit_date": 1525816189, "creation_date": 1501682009, "answer_id": 45462875, "question_id": 45462099, "link": "https://stackoverflow.com/questions/45462099/link-tab-name-of-a-worksheet-to-a-cell-in-excel/45462875#45462875", "title": "link tab name of a worksheet to a cell in excel", "body": "<p>Write the following formula:</p>\n\n<pre><code>=MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))\n</code></pre>\n\n<p>When you change the name of the worksheet, it will change.\nAbout the CELL worksheet function, read more here:\n<a href=\"http://www.cpearson.com/excel/CellWorksheetFunctions.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/CellWorksheetFunctions.aspx</a></p>\n\n<p>You actually have to write <code>=CELL(\"filename\")</code> to get the name of the tab plus the path of the worksheet. And \"filename\" should be written. </p>\n"}], "owner": {"reputation": 309, "user_id": 7019174, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/62cda081881581d37e4e2ab7b13289e3?s=128&d=identicon&r=PG&f=1", "display_name": "flowers1234", "link": "https://stackoverflow.com/users/7019174/flowers1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2224, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501833460, "creation_date": 1501680106, "last_edit_date": 1501744694, "question_id": 45462099, "link": "https://stackoverflow.com/questions/45462099/link-tab-name-of-a-worksheet-to-a-cell-in-excel", "title": "link tab name of a worksheet to a cell in excel", "body": "<p>how can I link the tab name of an excel sheet to a cell? Do I have to write a macro with VBA? or can I use a function therefore?</p>\n\n<p><em>Why I need this is: When I change the name of the tab I want to take it on for a cell in another worksheet.</em> </p>\n\n<p>thx all.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1501680362, "post_id": 45461990, "comment_id": 77884854, "body": "Take a look at pivot tables. You can build the view that you want and It can group together that data for you. Other than that, you&#39;d either have a complete mess of Formula all over the place or the answer would be VBA."}, {"owner": {"reputation": 13, "user_id": 8405754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83a2b7ed81486b2082eedf559ecb389?s=128&d=identicon&r=PG&f=1", "display_name": "sverker1", "link": "https://stackoverflow.com/users/8405754/sverker1"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1501680567, "post_id": 45461990, "comment_id": 77885007, "body": "Pivot table wouldn&#39;t work in my situation. Let&#39;s say I wanted to try the &quot;complete mess formula&quot; haha, where would I start?"}], "answers": [{"tags": [], "owner": {"reputation": 934, "user_id": 2946006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79ab52aa469c475f27ae6b16d5b87b8?s=128&d=identicon&r=PG&f=1", "display_name": "DMM", "link": "https://stackoverflow.com/users/2946006/dmm"}, "is_accepted": false, "score": 0, "last_activity_date": 1501681398, "creation_date": 1501681398, "answer_id": 45462632, "question_id": 45461990, "link": "https://stackoverflow.com/questions/45461990/excel-issue-combining-the-content-of-one-column-when-the-customer-is-the-same/45462632#45462632", "title": "Excel Issue (combining the content of one column when the customer is the same)", "body": "<p>Sort your data by Customer and then by Type using the facilities on the Data tab of the ribbon. You can then add a column to your sorted data. If the first row of sorted data is in, say cells <code>A2:C2</code> then insert the following formula into <code>D2</code></p>\n\n<p><code>=IF(AND(A2=A1,B2=B1),D1&amp;\" &amp; \"&amp;C2,C2)</code></p>\n\n<p>Copy formula in <code>D2</code> into remaining cells of column corresponding to your data. Your \"cumulative\" text will be in column D.</p>\n\n<p>If you want to preserve the original row order of your data, first add an index column with 1,2,3,4,... effectively giving each row of your data a row number. Include this column in the sort, add the formulae as described above, then convert cells from formulae to values by using Copy/Paste Special Values. Finally sort the data on the index column to get back to original row ordering.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8405754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83a2b7ed81486b2082eedf559ecb389?s=128&d=identicon&r=PG&f=1", "display_name": "sverker1", "link": "https://stackoverflow.com/users/8405754/sverker1"}, "edited": false, "score": 0, "creation_date": 1501753098, "post_id": 45466405, "comment_id": 77921242, "body": "Wow! This is amazing! Working perfectly. Thank you very much for engaging and helping me solve this."}, {"owner": {"reputation": 934, "user_id": 2946006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79ab52aa469c475f27ae6b16d5b87b8?s=128&d=identicon&r=PG&f=1", "display_name": "DMM", "link": "https://stackoverflow.com/users/2946006/dmm"}, "reply_to_user": {"reputation": 13, "user_id": 8405754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83a2b7ed81486b2082eedf559ecb389?s=128&d=identicon&r=PG&f=1", "display_name": "sverker1", "link": "https://stackoverflow.com/users/8405754/sverker1"}, "edited": false, "score": 0, "creation_date": 1501755169, "post_id": 45466405, "comment_id": 77922813, "body": "Please tick the solution for correct answer. The &quot;clever&quot; bit of this is obviously column E. This uses two features: a mix of absolute and relative addressing in defining the ranges in the formulae; an array function. If you are not familiar with these features they are well worth spending some effort to lean. Absolute/relative addressing is very basic stuff, but array formulae are more advanced."}], "tags": [], "owner": {"reputation": 934, "user_id": 2946006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79ab52aa469c475f27ae6b16d5b87b8?s=128&d=identicon&r=PG&f=1", "display_name": "DMM", "link": "https://stackoverflow.com/users/2946006/dmm"}, "is_accepted": false, "score": 0, "last_activity_date": 1501691767, "creation_date": 1501691767, "answer_id": 45466405, "question_id": 45461990, "link": "https://stackoverflow.com/questions/45461990/excel-issue-combining-the-content-of-one-column-when-the-customer-is-the-same/45466405#45466405", "title": "Excel Issue (combining the content of one column when the customer is the same)", "body": "<p>OK, assuming that there are no further unstated constraints being imposed, here's a solution which requires a couple of helper columns.</p>\n\n<p><a href=\"https://i.stack.imgur.com/llPzm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/llPzm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Column D is simply an index and column E is the index number of the preceding row which matches the current row for Name and Product or 0 if there is no preceding matching row. The first row of the data list cannot have a preceding row, so columns E and F for this row are simply assigned as 0 and the Product value, respectively. Rows 2 onwards of the data list contain formulae in columns E and F which once entered for the second row of data, can simply be copied downwards as new data is added to the list.</p>\n\n<p>Note that the formula in E3 is an array formula and is committed from the formula bar by pressing the Ctrl, Shift and Enter keys simutaneously.</p>\n"}], "owner": {"reputation": 13, "user_id": 8405754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83a2b7ed81486b2082eedf559ecb389?s=128&d=identicon&r=PG&f=1", "display_name": "sverker1", "link": "https://stackoverflow.com/users/8405754/sverker1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501691767, "creation_date": 1501679811, "last_edit_date": 1531161705, "question_id": 45461990, "link": "https://stackoverflow.com/questions/45461990/excel-issue-combining-the-content-of-one-column-when-the-customer-is-the-same", "title": "Excel Issue (combining the content of one column when the customer is the same)", "body": "<p>I have an issue which I suspect may be fairly easy to solve but I can't seem to find any previous questions about it.</p>\n\n<pre><code>Customer          Type              Product\nPeter             Proactive         Car\nSven              Reactive          Wheels\nSven              Proactive         Wheels\nPeter             Proactive         Wheels\n</code></pre>\n\n<p>What I would like is that when a customer appears twice, and when the type is the same. Like with \"Peter\", then the products would add together. The ideal result would look like: (notice that Sven's products does <strong>not</strong> combine because the type is different).</p>\n\n<pre><code>Customer          Type              Product\nPeter             Proactive         Car\nSven              Reactive          Wheels\nSven              Proactive         Wheels\nPeter             Proactive         Wheels &amp; Car\n</code></pre>\n\n<p>Ideally I would like to do this without using VBA, does anyone have any solution for this?</p>\n\n<p>Thank you so much in advance.</p>\n"}, {"tags": ["windows", "excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1501680129, "post_id": 45461947, "comment_id": 77884645, "body": "Check the <code>thausands separator</code> and the <code>decimal separator</code> of both versions. It is in the Regional Options, in the Control Panel."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1501680195, "post_id": 45461947, "comment_id": 77884704, "body": "I will take a look and get back to you."}], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1501680499, "post_id": 45462152, "comment_id": 77884961, "body": "I&#39;ll have a look later today. This is actually on a client&#39;s computer and already have an email out to him. I will certainly let you know either way."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1501689872, "post_id": 45462152, "comment_id": 77892419, "body": "Going the Control Panel route, the settings you mention appear identical. Will running this code possibly give a different answer anyway?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1501690174, "post_id": 45462152, "comment_id": 77892628, "body": "I&#39;m sorry. I get the same results in each."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1501696433, "post_id": 45462152, "comment_id": 77896398, "body": "@MattCremeens - are you copying just the code and putting it in an Excel file or you are copying the Excel file with the code as well?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1501696631, "post_id": 45462152, "comment_id": 77896522, "body": "The entire workbook, code and all, is on both machines. At the moment, it is appearing that taking all variable declarations out, removing <code>Option Explicit</code> and replacing <code>CInt</code> with <code>Val</code> might be working, but I have no real idea as to why."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1501696759, "post_id": 45462152, "comment_id": 77896601, "body": "You just copy the excel workbook between the machines and it works on <code>A</code> but it does not work on <code>B</code>?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1501680634, "last_edit_date": 1501680634, "creation_date": 1501680261, "answer_id": 45462152, "question_id": 45461947, "link": "https://stackoverflow.com/questions/45461947/vba-in-excel-works-fine-in-windows-2007-machine-but-not-windows-10/45462152#45462152", "title": "VBA in Excel works fine in Windows 2007 machine, but not Windows 10", "body": "<p>Run this code in both versions:</p>\n\n<pre><code>Public Sub TestMe()\n    Debug.Print \"Decimal -&gt; \"; Application.DecimalSeparator\n    Debug.Print \"Thausand -&gt; \"; Application.ThousandsSeparator\nEnd Sub\n</code></pre>\n\n<p>If the result is different, you know what to do. You may read more about this trick here:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/aa215774(v=office.11).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/aa215774(v=office.11).aspx</a></p>\n"}], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501680634, "creation_date": 1501679741, "last_edit_date": 1531161705, "question_id": 45461947, "link": "https://stackoverflow.com/questions/45461947/vba-in-excel-works-fine-in-windows-2007-machine-but-not-windows-10", "title": "VBA in Excel works fine in Windows 2007 machine, but not Windows 10", "body": "<p>I have this bit of VBA</p>\n\n<pre><code>Sub populateChartData()\nDim i As Integer\nDim j As Integer\nDim finalRowSheet2 As Integer\nDim k As Integer\nDim n As Integer\nDim Sheet2 As Worksheet\nDim price As Double\nDim cnt As Integer\n\nWith Worksheets(\"Data\")\nSet Sheet2 = Worksheets(\"Sheet2\")\nfinalRowSheet2 = Sheet2.UsedRange.Rows.Count\nFor i = 2 To 5\n    For j = 2 To 5\n        price = 0\n        cnt = 0\n        For k = 2 To finalRowSheet2\n            Sheet2.Cells(i, 5) = \"'\" &amp; Sheet2.Cells(i, 5)\n            If .Cells(i, 1) = CInt(Right(Sheet2.Cells(k, 5), 4)) And _\n               .Cells(1, j) = Sheet2.Cells(k, 4) Then\n                   price = price + Sheet2.Cells(k, 3) 'Col 7 if weighting is used\n                   cnt = cnt + 1\n            End If\n        Next k\n        If cnt = 0 Then\n            .Cells(i, j) = 0\n        Else\n            .Cells(i, j) = price / cnt\n        End If\n    Next j\n\nNext i\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Here is a sample of the data</p>\n\n<pre><code>address1    3.19 mi $1,250  studio  5/1/2017\naddress2    3.38 mi $950    studio  7/1/2017\naddress3    3.48 mi $725    studio  3/1/2017\naddress4    3.51 mi $850    studio  7/1/2017\n</code></pre>\n\n<p>It works as intended on a Windows 2007 machine. But when used on a Windows 10 machine it produces a <code>Type Mismatch</code> Error on this line</p>\n\n<pre><code>If .Cells(i, 1) = CInt(Right(Sheet2.Cells(k, 5), 4)) And _\n           .Cells(1, j) = Sheet2.Cells(k, 4) Then\n</code></pre>\n\n<p>I have tried going into <code>Control Panel &gt;&gt; Clock, Language and Region &gt;&gt; Region and Language</code> to set the language to English, but it was already set to English. I had read that this could be the problem. I have also tried to experiment with changing the types of the variables, but so far the error continues to be thrown on the Windows 10 machine. I would like this code to work on both Windows operating system without this error.</p>\n"}, {"tags": ["excel", "vba", "min", "named-ranges"], "comments": [{"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1501678683, "post_id": 45461517, "comment_id": 77883405, "body": "&quot;I cannot get the WorksheetFunction.Min&quot; why? What have you tried?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8405634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc661785d15494c12745f7f908b9600?s=128&d=identicon&r=PG&f=1", "display_name": "Timm", "link": "https://stackoverflow.com/users/8405634/timm"}, "edited": false, "score": 0, "creation_date": 1501681343, "post_id": 45461828, "comment_id": 77885666, "body": "Hi Jeeped, Your code works but I am not sure how. Could you explain what is going on in the loop? Thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 21, "user_id": 8405634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc661785d15494c12745f7f908b9600?s=128&d=identicon&r=PG&f=1", "display_name": "Timm", "link": "https://stackoverflow.com/users/8405634/timm"}, "edited": false, "score": 0, "creation_date": 1501681405, "post_id": 45461828, "comment_id": 77885710, "body": "@Timm - jeeped&#39;s answer is above."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1501679796, "last_edit_date": 1501679796, "creation_date": 1501679443, "answer_id": 45461828, "question_id": 45461517, "link": "https://stackoverflow.com/questions/45461517/using-vba-in-excel-to-determinine-minimum-value-from-array-of-named-ranges/45461828#45461828", "title": "using vba in excel to determinine minimum value from array of named ranges", "body": "<p>The correct syntax is like this:</p>\n\n<pre><code>Worksheetfunction.min([named])\n</code></pre>\n\n<p>or </p>\n\n<pre><code>WorksheetFunction.min(activesheet.range(\"named\"))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>WorksheetFunction.min(tabelle1.Range(\"named\"))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Worksheetfunction.Min(worksheets(\"Tabelle1\").range(\"named\"))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Worksheetfunction.Min(tabelle1.[named])\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Worksheetfunction.Min(worksheets(\"Tabelle1\").[named])\n</code></pre>\n\n<p>Feel free to pick anything :) That's in case that the WorkSheet is with caption and code name <code>Tabelle1</code> and the named range is named <code>named</code>. </p>\n\n<hr>\n\n<p>In you case, you are not putting <code>fullrange</code> in parenthesis or in <code>[</code>. Any of these two options should work.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8405634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc661785d15494c12745f7f908b9600?s=128&d=identicon&r=PG&f=1", "display_name": "Timm", "link": "https://stackoverflow.com/users/8405634/timm"}, "edited": false, "score": 0, "creation_date": 1501683491, "post_id": 45461871, "comment_id": 77887435, "body": "I think I got Jeeped&#39;s code. Within the loop the application.min is adding a new argument to be used for each named range, so if there are 5 named ranges, it runs application.min with 5 arguments. is that correct?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21, "user_id": 8405634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc661785d15494c12745f7f908b9600?s=128&d=identicon&r=PG&f=1", "display_name": "Timm", "link": "https://stackoverflow.com/users/8405634/timm"}, "edited": false, "score": 0, "creation_date": 1501683599, "post_id": 45461871, "comment_id": 77887507, "body": "Yes, given your example this would find the minimum values from named ranges HR_B3, HR_B4, HR_B5 and HR_B6."}, {"owner": {"reputation": 21, "user_id": 8405634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc661785d15494c12745f7f908b9600?s=128&d=identicon&r=PG&f=1", "display_name": "Timm", "link": "https://stackoverflow.com/users/8405634/timm"}, "edited": false, "score": 0, "creation_date": 1501684385, "post_id": 45461871, "comment_id": 77888152, "body": "I believe I understand now. There are only ever two arguments in the application.min, the first is fixed and the second increases with each loop by adding an extra named range to the overall area the application.min is looking at. Thanks"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1501679575, "creation_date": 1501679575, "answer_id": 45461871, "question_id": 45461517, "link": "https://stackoverflow.com/questions/45461517/using-vba-in-excel-to-determinine-minimum-value-from-array-of-named-ranges/45461871#45461871", "title": "using vba in excel to determinine minimum value from array of named ranges", "body": "<p>Try it as,</p>\n\n<pre><code>Option Explicit\n\nPublic Function HR_Min_Range(minval As Integer, maxval As Integer) As Variant\n\n   Dim i As Long\n\n\n    HR_Min_Range = Worksheets(\"HR_Depths\").Range(\"HR_B\" &amp; minval).Cells(1)\n\n    For i = minval To maxval\n        HR_Min_Range = Application.Min(HR_Min_Range, Worksheets(\"HR_Depths\").Range(\"HR_B\" &amp; i))\n    Next i\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8405634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc661785d15494c12745f7f908b9600?s=128&d=identicon&r=PG&f=1", "display_name": "Timm", "link": "https://stackoverflow.com/users/8405634/timm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2496, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501684161, "creation_date": 1501678583, "last_edit_date": 1501679256, "question_id": 45461517, "link": "https://stackoverflow.com/questions/45461517/using-vba-in-excel-to-determinine-minimum-value-from-array-of-named-ranges", "title": "using vba in excel to determinine minimum value from array of named ranges", "body": "<p>I have a spread sheet with multiple dynamic named ranges such as HR_B1, to HR_B10 etc.</p>\n\n<p>I am trying to create a function that will find the minimum value from whichever ranges are inserted into the function, i.e. the user function will input two values into the function say 3 and 6 and it will find the minimum value over ranges HR_B3 to HR_B6.</p>\n\n<p>I have created a array and for loop that stores the names of the named ranges in the array.</p>\n\n<p>However I cannot get the WorksheetFunction.Min code to read the contents of the array as named ranges and output the min value.</p>\n\n<p>My code is:</p>\n\n<pre><code>Public Function HR_Min_Range(minval As Integer, maxval As Integer) As Variant\n\nDim fullrange() As Variant\nDim total_birds As Integer\nDim i As Long\n\ntotal_birds = (maxval - minval)\n\nReDim fullrange(total_birds)\n\nFor i = 0 To total_birds\n\nfullrange(i) = \"HR_B\" &amp; (i + minval)\nNext i\n\nHR_Min_Range = WorksheetFunction.Min(Sheets(\"HR_Depths\").Range(fullrange))\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1501678373, "post_id": 45461142, "comment_id": 77883131, "body": "At which line are you getting the error? If it&#39;s the line starting with <code>Set rs</code>, your query probably needs parameters you aren&#39;t providing, and you will need to either adjust your query or provide the required parameter."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501678385, "post_id": 45461142, "comment_id": 77883144, "body": "Is your rs!Address and rs!PostalCode is received in excel?"}, {"owner": {"reputation": 39, "user_id": 8188776, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/633497c929ae55ad3cbdbdd3086488ff?s=128&d=identicon&r=PG&f=1", "display_name": "user681413", "link": "https://stackoverflow.com/users/8188776/user681413"}, "edited": false, "score": 0, "creation_date": 1501680551, "post_id": 45461142, "comment_id": 77884995, "body": "you are correct it is at the SET rs"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8188776, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/633497c929ae55ad3cbdbdd3086488ff?s=128&d=identicon&r=PG&f=1", "display_name": "user681413", "link": "https://stackoverflow.com/users/8188776/user681413"}, "edited": false, "score": 0, "creation_date": 1501681508, "post_id": 45462369, "comment_id": 77885803, "body": "It looks like the problem is the query has parameters from form controls, though the form is open it fails on openrecordset"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1501680787, "creation_date": 1501680787, "answer_id": 45462369, "question_id": 45461142, "link": "https://stackoverflow.com/questions/45461142/error-3061-to-few-parameters-on-button-to-open-weblink-with-google-maps-waypo/45462369#45462369", "title": "Error &#39;3061&#39; to few parameters. On button to open weblink with google maps waypoints", "body": "<p>Open the query <code>export_query</code> directly in Access, it will request missing data and you will be able to determine where is the problem. Usually parameter request appears when query contains wrong column names. </p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 8188776, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/633497c929ae55ad3cbdbdd3086488ff?s=128&d=identicon&r=PG&f=1", "display_name": "user681413", "link": "https://stackoverflow.com/users/8188776/user681413"}, "is_accepted": false, "score": 0, "last_activity_date": 1501738302, "last_edit_date": 1501738302, "creation_date": 1501682763, "answer_id": 45463183, "question_id": 45461142, "link": "https://stackoverflow.com/questions/45461142/error-3061-to-few-parameters-on-button-to-open-weblink-with-google-maps-waypo/45463183#45463183", "title": "Error &#39;3061&#39; to few parameters. On button to open weblink with google maps waypoints", "body": "<p>Managed to solve it thanks to this thread \n<a href=\"https://stackoverflow.com/questions/30378074/vba-openrecordset-produces-error-3061\">VBA OpenRecordset Produces Error 3061</a></p>\n\n<p>Added this into it code </p>\n\n<pre><code>Dim prm As DAO.Parameter \nDim qdf As DAO.QueryDef \n\nexport_query = \"Select export_query.address, export_query.postcode from export_query\" \nSet qdf = CurrentDb.CreateQueryDef(vbNullString, export_query) \nFor Each prm In qdf.Parameters \n    prm.Value = Eval(prm.Name) \nNext \nSet rs = qdf.OpenRecordset\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8188776, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/633497c929ae55ad3cbdbdd3086488ff?s=128&d=identicon&r=PG&f=1", "display_name": "user681413", "link": "https://stackoverflow.com/users/8188776/user681413"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501738302, "creation_date": 1501677525, "question_id": 45461142, "link": "https://stackoverflow.com/questions/45461142/error-3061-to-few-parameters-on-button-to-open-weblink-with-google-maps-waypo", "title": "Error &#39;3061&#39; to few parameters. On button to open weblink with google maps waypoints", "body": "<p>Im building a button to open googlemaps with waypoints marked of all the points in my subform.  On click however I keep getting \nRun-time error '3061':<br>\nToo few parameters. Expected 1</p>\n\n<p>code below </p>\n\n<pre><code>    Private Sub Route_Plan_Click()\nDim strHyperlink As String\nDim rs As DAO.Recordset\nSet rs = CurrentDb.OpenRecordset(\"export_query\")\n    strHyperlink = \"https://www.google.com/maps/dir/?api=1&amp;origin=','start point address&gt;,+'&lt;start postcode&gt;'\"\n If Not (rs.EOF And rs.BOF) Then\n    rs.MoveFirst\n    Do Until rs.EOF = True\n    strHyperlink = strHyperlink &amp; \"&amp;waypoints=\" &amp; i &amp; \"='\" &amp; rs!Address &amp; \"',+'\" &amp; rs!Postcode &amp; \"'\"\n        rs.MoveNext\n    Loop\n End If\nApplication.FollowHyperlink (strHyperlink)\nMsgBox \"Finished looping through records.\"\nrs.Close\nSet rs = Nothing\nEnd Sub\n</code></pre>\n\n<p>the form sets a query record source  which I am looping through to create the string for the weblink but am at a loss on why I am getting this error if anyone has any advice or suggestions it would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1501678347, "post_id": 45461112, "comment_id": 77883111, "body": "It would be better to create code that doesnt rely on error handlers to function. Do a check for the condition causing the error instead and skip over the code that you know is going to cause an error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1501680582, "post_id": 45461112, "comment_id": 77885029, "body": "Your code is doing too many things. One handler per procedure. You can&#39;t handle a new error while handling an error, you need to <i>handle the first error</i> first. <code>On Error</code> is useless inside an error handler, <i>you&#39;re already in an error state</i>, what do you expect to happen? FWIW this will soon be a <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> inspection."}, {"owner": {"reputation": 37, "user_id": 8269690, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5366cb45a5f8b462416d8c61f174aaf0?s=128&d=identicon&r=PG&f=1", "display_name": "FilipB", "link": "https://stackoverflow.com/users/8269690/filipb"}, "edited": false, "score": 0, "creation_date": 1501688768, "post_id": 45461112, "comment_id": 77891635, "body": "braX, I tried assigning concerned cells to a range and then setting if not rangename is nothing, but it still evaluated to an error message. Mat&#39;s Mug, I am not an expert in this, though I suspected that I need to quit error handling before starting anew, but I thought that On Error GoTo 0 would reset error handling - and it turns out it should&#39;ve been On Error GoTo -1, as pointed out in the accepted answer to my question. Anyways I did not reset error handling where I should have, which is the solution to my problem. Thank you all"}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 2, "creation_date": 1501679152, "post_id": 45461488, "comment_id": 77883800, "body": "To further clarify on Darren&#39;s answer, an error handler is active until the code is explicitly told otherwise. Standard error handling uses an <code>On Error GoTo SomeLineLabel : Error Handling Code After Label : Resume or Resume Next</code>. The final statement is what, in essence, clears the error."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1501679373, "post_id": 45461488, "comment_id": 77883981, "body": "What @Brandon said.  Was trying to get that across with <i>clear error, jump back to line that caused it.</i>.  Needed to be more explicit that <i>clear error</i> was important in each case."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 7, "last_activity_date": 1501678508, "last_edit_date": 1525816189, "creation_date": 1501678508, "answer_id": 45461488, "question_id": 45461112, "link": "https://stackoverflow.com/questions/45461112/vba-change-error-handling-method-during-code-execution/45461488#45461488", "title": "VBA Change error handling method during code execution", "body": "<p>You're not clearing your errors when they occur, just trying to jump over them and the code is wondering what's going on with the error.  </p>\n\n<p>As Chip Pearson says on his site:  </p>\n\n<blockquote>\n  <p>When the first error is raised, execution transfers to the line\n  following Err1:. The error hander is still active when the second\n  error occurs, and therefore the second error is not trapped by the On\n  Error statement</p>\n</blockquote>\n\n<p>and continues with </p>\n\n<blockquote>\n  <p>The Resume statement instructs VBA to resume execution at a specified\n  point in the code.  You can use  Resume only in an error handling\n  block; any other use will cause an error. Moreover, Resume is the only\n  way, aside from exiting the procedure, to get out of an error handling\n  block. Do not use the Goto statement to direct code execution out of\n  an error handling block.  Doing so will cause strange problems with\n  the error handlers.\n  <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/errorhandling.htm</a></p>\n</blockquote>\n\n<p>The ideal way is to avoid the error in the first place - check the workbook exists before opening it, check the sheet exists in the workbook before trying to reference it and if an error occurs jump out of the main body of the routine, deal with the error and then jump back in again.</p>\n\n<p>As an example:  </p>\n\n<pre><code>Sub Test()\n\n    On Error GoTo ERR_HANDLE\n\n    '.... code ....\n\nFAST_EXIT:\n    'Code to tidy up, clear references etc before finishing.\n\nExit Sub\n\nERR_HANDLE:\n    Select Case Err.Number\n        Case 1004\n            'Code to resolve error\n            '.\n            '.\n            'Resume - clear error, jump back to line that caused it.\n            'Resume Next - clear error, jump to line after the one that caused error.\n            'Resume FAST_EXIT - clear error and go to line label.\n\n        Case 92 'Do something else to resolve error.\n\n        Case Else\n    End Select\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1501679347, "post_id": 45461513, "comment_id": 77883961, "body": "@DarrenBartrup-Cook <code>Err.Clear</code>clears error, but doesn&#39;t clear error trap flag! Make a try."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1501679762, "post_id": 45461513, "comment_id": 77884303, "body": "It doesn&#39;t?  I&#39;ll have to look at that.  I&#39;d still recommend jumping out of the main procedure to deal with any errors and using <code>RESUME</code>."}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1501679823, "post_id": 45461513, "comment_id": 77884360, "body": "@DarrenBartrup-Cook Try."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1501680824, "post_id": 45461513, "comment_id": 77885211, "body": "Fair enough - tried.  Is it ok if I update your answer with the code that demonstrates it?"}], "tags": [], "owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "is_accepted": true, "score": 2, "last_activity_date": 1501683314, "last_edit_date": 1501683314, "creation_date": 1501678572, "answer_id": 45461513, "question_id": 45461112, "link": "https://stackoverflow.com/questions/45461112/vba-change-error-handling-method-during-code-execution/45461513#45461513", "title": "VBA Change error handling method during code execution", "body": "<p>Inside error handling routines, it seems as though defining new error handling routines won't work, unless you clear the previously set error routine (<a href=\"https://excelmacromastery.com/vba-error-handling/\" rel=\"nofollow noreferrer\">https://excelmacromastery.com/vba-error-handling/</a>):</p>\n\n<pre><code>'...\nEErrorOne:\nOn Error GoTo -1 'Clears error trap flag\nOn Error GoTo EErrorTwo 'Reset error handling\n'...\n</code></pre>\n\n<hr>\n\n<p><strong>Edit after accepted:</strong><br>\nAs was discussed in the comments, <code>On Error GoTo -1</code> clears the error trap flag, while <code>Err.Clear</code> only clears the error.<br>\nThe code below illustrates this by creating two errors and trying to trap them.  </p>\n\n<p><code>On Error Goto -1</code> allows the second error to be trapped by the <code>On Error GoTo NextLabel</code> line and the code jumps to the label when the error occurs.<br>\n<code>Err.Clear</code> keeps the first error live, so when the second error occurs the error message is displayed rather than the code jumping to the label.  </p>\n\n<pre><code>Sub ClearErr()\n\n    Dim x As Long\n    Dim y As Worksheet\n\n    'Jump to label when \"Division by 0\" occurs.\n    On Error GoTo ErrorLabel\n\n    x = 1 / 0\n    Debug.Print x\n\nErrorLabel:\n\n    'On Error GoTo -1 'Next error is trapped.\n    Err.Clear   'Untrapped error on y=Worksheets(1)\n\n    'Jump to label when \"Object Variable not set\" occurs.\n    On Error GoTo NextLabel\n\n    y = Worksheets(1)\n    Debug.Print y.Name\n\nNextLabel:\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8269690, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5366cb45a5f8b462416d8c61f174aaf0?s=128&d=identicon&r=PG&f=1", "display_name": "FilipB", "link": "https://stackoverflow.com/users/8269690/filipb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1253, "favorite_count": 0, "accepted_answer_id": 45461513, "answer_count": 2, "score": 0, "last_activity_date": 1501683314, "creation_date": 1501677410, "last_edit_date": 1501677546, "question_id": 45461112, "link": "https://stackoverflow.com/questions/45461112/vba-change-error-handling-method-during-code-execution", "title": "VBA Change error handling method during code execution", "body": "<p>I have a macro, and part of the code is concerned with:\n1) detecting if a column contains empty cells - if so filling them with some value\n2) detecting if a column contains cells containing errors (such as N/A) and if so filling them with some value</p>\n\n<p>Now if there are no error/empty cells in the column, the line that finds them gives a \"Run-time error 1004 no cells were found\".</p>\n\n<p>I use error handling to skip this with GoTo.</p>\n\n<p>Below is the code - the first error handling GoTo works perfectly, while the second gives the expected error, although there is Error handling GoTo set, that does not seem to work. Code with comments:</p>\n\n<pre><code>On Error GoTo EErrorOne\n\n\n'depending on file I get, below line will generate error and code successfully skips to ErrorOne label\n\nWorkbooks(nazwawb).Sheets(szitnr).Columns(ktorepole).SpecialCells (xlCellTypeBlanks)\n\n' code to be skipped\n\n    Workbooks(nazwawb).Sheets(szitnr).Columns(ktorepole).Select\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n    Selection.Value = \"Some Value\"\n\n' end of code to be skipped\n\nEErrorOne:\n\n' successfully skipped error line by now. Below line should set a new Error handling procedure.\n\nOn Error GoTo EErrorTwo\n\n\n\nWorkbooks(nazwawb).Sheets(szitnr).Columns(ktorepole).Select\n\n' Below line generates an error but does not skip to EErrorTwo label as detailed in the current Error handling procedure\n\nSelection.SpecialCells(xlCellTypeFormulas, 16).Select   \n\n' code to be skipped\n\n\nSelection.SpecialCells(xlCellTypeFormulas, 16).Select\n    Selection.Value = \"Some Value\"\n\n' end of code to be skipped\n\n\nEErrorTwo:\n\n\n\n' Below line should reset error handling procedure to normal for subsequent handling of other errors:\nOn Error GoTo 0\n</code></pre>\n\n<p>It seems that error handling procedure (GoTo specific label) is ignored, and instead, an error message is shown as if the error handling was reset to GoTo 0. How do I skip the second error?</p>\n"}, {"tags": ["vba", "filter", "outlook"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501676672, "post_id": 45460683, "comment_id": 77881703, "body": "Can you try the other formating like &quot;DD/MM/YYYY&quot;"}, {"owner": {"reputation": 5, "user_id": 7085382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--giQSbXEtts/AAAAAAAAAAI/AAAAAAAAACQ/9DTj0wyq7hA/photo.jpg?sz=128", "display_name": "Rhys Williams", "link": "https://stackoverflow.com/users/7085382/rhys-williams"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501676919, "post_id": 45460683, "comment_id": 77881891, "body": "I need the time to be considered if I change it from &quot;ddddd hh:nn&quot; to &quot;dd/mm/yyyy&quot; will it remove the time stamp"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501677125, "post_id": 45460683, "comment_id": 77882081, "body": "Yes, it will remove the timestamp from it. It will be much more efficient if you use the same formatting for all the date to avoid any mismatch error"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501677227, "post_id": 45460683, "comment_id": 77882187, "body": "For more date format,  you can do Trial and error in excel cell using Custom formating and try different combinations and you can use the same formating style in your vba code. Hope this helps you"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7085382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--giQSbXEtts/AAAAAAAAAAI/AAAAAAAAACQ/9DTj0wyq7hA/photo.jpg?sz=128", "display_name": "Rhys Williams", "link": "https://stackoverflow.com/users/7085382/rhys-williams"}, "edited": false, "score": 0, "creation_date": 1501681763, "post_id": 45462194, "comment_id": 77886047, "body": "Does it need to be &amp; &gt; &quot;  &#39; &amp; &quot;"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 5, "user_id": 7085382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--giQSbXEtts/AAAAAAAAAAI/AAAAAAAAACQ/9DTj0wyq7hA/photo.jpg?sz=128", "display_name": "Rhys Williams", "link": "https://stackoverflow.com/users/7085382/rhys-williams"}, "edited": false, "score": 0, "creation_date": 1501683124, "post_id": 45462194, "comment_id": 77887169, "body": "Most likely &amp; &quot; &gt; &#39;&quot; &amp; datevalue &amp; &quot;&#39; &quot;"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1501680358, "creation_date": 1501680358, "answer_id": 45462194, "question_id": 45460683, "link": "https://stackoverflow.com/questions/45460683/applying-filter-to-outlook-folder-vba/45462194#45462194", "title": "Applying Filter to outlook folder VBA", "body": "<p><code>&gt; ' &amp;</code> is a part of the filter string.</p>\n"}], "owner": {"reputation": 5, "user_id": 7085382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--giQSbXEtts/AAAAAAAAAAI/AAAAAAAAACQ/9DTj0wyq7hA/photo.jpg?sz=128", "display_name": "Rhys Williams", "link": "https://stackoverflow.com/users/7085382/rhys-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 45462194, "answer_count": 1, "score": 0, "last_activity_date": 1501680358, "creation_date": 1501676283, "last_edit_date": 1501678899, "question_id": 45460683, "link": "https://stackoverflow.com/questions/45460683/applying-filter-to-outlook-folder-vba", "title": "Applying Filter to outlook folder VBA", "body": "<p>I am struggling with a piece of my code.</p>\n\n<p>I am filtering a folder in outlook to restrict the subject and the received time.</p>\n\n<p>The filter works perfectly if I am only interested in a day greater than another day. \nI.e -</p>\n\n<pre><code>datevalue = Format(Sheet1.Range(\"c\" &amp; reloop).Value - 1, \"DDDDD HH:NN\")\n</code></pre>\n\n<p>Local view 30/07/2017 - value on spreadsheet is 30/07/2017 00:00:00</p>\n\n<p>When I try to filter greater than day and time it breaks down and returns all items in folder.</p>\n\n<p>I am setting the datevalue below</p>\n\n<pre><code>datevalue = Format(Sheet1.Range(\"L\" &amp; reloop).Value, \"DDDDD HH:NN\")\n</code></pre>\n\n<p>This in the locals window looks like 31/07/2017 07:00:00. value on spreadsheet is 31/07/2017 07:00:00</p>\n\n<p>The full code I am using is as below for the filter</p>\n\n<pre><code>    strFilter = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:subject\" &amp; Chr(34) &amp; \" = '\" &amp; FilterValue &amp; \"' And \" &amp; Chr(34) &amp; _\n        \"urn:schemas:httpmail:datereceived\" &amp; Chr(34) &amp; \" &gt; ' &amp; \" &amp; datevalue &amp; \" &amp; '\"\n</code></pre>\n\n<p>Is this simply a formatting issue when declaring the datevalue?</p>\n"}, {"tags": ["vba", "excel", "named-ranges"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501677710, "post_id": 45460660, "comment_id": 77882554, "body": "Can you define the range value as [link](File_ref = &quot;A1:A10&quot;). Also remove the double qoutes from the RangeStart and RangeLenght"}, {"owner": {"reputation": 15, "user_id": 4680747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-mSypH1NQSfM/AAAAAAAAAAI/AAAAAAAAADU/OrY_bITGeFI/photo.jpg?sz=128", "display_name": "Joe Noble", "link": "https://stackoverflow.com/users/4680747/joe-noble"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501679201, "post_id": 45460660, "comment_id": 77883844, "body": "Hi, I didn&#39;t see this comment just now. Doesn&#39;t this miss the point of using a named range? If the named range moves in the table, then your code will need to be updated. If the code refers to the named range (rather than defining a new range which happens to have the same name) then the code will withstand changes to the table."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4680747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-mSypH1NQSfM/AAAAAAAAAAI/AAAAAAAAADU/OrY_bITGeFI/photo.jpg?sz=128", "display_name": "Joe Noble", "link": "https://stackoverflow.com/users/4680747/joe-noble"}, "edited": false, "score": 0, "creation_date": 1501679068, "post_id": 45461310, "comment_id": 77883729, "body": "Thanks, but as I understand it you are declaring a new range in VBA called File_ref, whereas I want the code to refer to the existing named range File_ref. I can get it to work if I don&#39;t refer to the existing named range, what I&#39;m struggling to do is to translate the code so that it works with my named ranges."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "reply_to_user": {"reputation": 15, "user_id": 4680747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-mSypH1NQSfM/AAAAAAAAAAI/AAAAAAAAADU/OrY_bITGeFI/photo.jpg?sz=128", "display_name": "Joe Noble", "link": "https://stackoverflow.com/users/4680747/joe-noble"}, "edited": false, "score": 0, "creation_date": 1501679547, "post_id": 45461310, "comment_id": 77884124, "body": "Use this then File_ref = &quot;A1:A&quot; &amp; entrysheet.Range(&quot;A&quot; &amp; entrysheet.Rows.Count).End(xlUp).Row  Hope this helps"}, {"owner": {"reputation": 15, "user_id": 4680747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-mSypH1NQSfM/AAAAAAAAAAI/AAAAAAAAADU/OrY_bITGeFI/photo.jpg?sz=128", "display_name": "Joe Noble", "link": "https://stackoverflow.com/users/4680747/joe-noble"}, "edited": false, "score": 0, "creation_date": 1501681345, "post_id": 45461310, "comment_id": 77885668, "body": "Thanks, I think we&#39;re misunderstanding each other. Maybe I haven&#39;t asked the question very well. All I really want to know is whether this is phrased correctly: If IsEmpty(entrysheet.Range(File_ref).Cells(i)) Then. This is the bit that is causing me problems."}, {"owner": {"reputation": 15, "user_id": 4680747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-mSypH1NQSfM/AAAAAAAAAAI/AAAAAAAAADU/OrY_bITGeFI/photo.jpg?sz=128", "display_name": "Joe Noble", "link": "https://stackoverflow.com/users/4680747/joe-noble"}, "edited": false, "score": 0, "creation_date": 1501936498, "post_id": 45461310, "comment_id": 78004129, "body": "I figured out what the problem was, I had misunderstood the range that I was asking the code to evaluate and it was missing all of the sample entries that I had entered to test it."}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1501678038, "creation_date": 1501678038, "answer_id": 45461310, "question_id": 45460660, "link": "https://stackoverflow.com/questions/45460660/how-to-refer-to-specific-cell-when-looping-through-named-range-excel-vba/45461310#45461310", "title": "How to refer to specific cell when looping through named range excel vba", "body": "<p>Can you try the below code </p>\n\n<pre><code>Sub test()\nSet mybook = Excel.ActiveWorkbook\nSet entrysheet = mybook.Sheets(\"Entry\")\n\nFile_ref = \"A1:A10\"  ''Added new\nAlready_Input = \"B1:B10\" ''Added new\nDim RangeStart As Integer\nRangeStart = Range(File_ref).Cells(1).Row\n\nDim RangeLength As Integer\nRangeLength = Range(File_ref).Count\n\nDim i As Long\nDim j As Long\nDim m As Long\n\nj = 0\nm = 0\n\nFor i = RangeStart To RangeLength + RangeStart\n\n        If IsEmpty(entrysheet.Range(File_ref).Cells(i)) Then\n\n        j = j + 1\n\n        ElseIf entrysheet.Range(Already_Input).Cells(i) = \"yes\" Then\n\n        m = m + 1\n\n        End If\n\n Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 4680747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-mSypH1NQSfM/AAAAAAAAAAI/AAAAAAAAADU/OrY_bITGeFI/photo.jpg?sz=128", "display_name": "Joe Noble", "link": "https://stackoverflow.com/users/4680747/joe-noble"}, "is_accepted": false, "score": 0, "last_activity_date": 1501936517, "creation_date": 1501936517, "answer_id": 45521971, "question_id": 45460660, "link": "https://stackoverflow.com/questions/45460660/how-to-refer-to-specific-cell-when-looping-through-named-range-excel-vba/45521971#45521971", "title": "How to refer to specific cell when looping through named range excel vba", "body": "<p>I figured out what the problem was, I had misunderstood the range that I was asking the code to evaluate and it was missing all of the sample entries that I had entered to test it. </p>\n"}], "owner": {"reputation": 15, "user_id": 4680747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-mSypH1NQSfM/AAAAAAAAAAI/AAAAAAAAADU/OrY_bITGeFI/photo.jpg?sz=128", "display_name": "Joe Noble", "link": "https://stackoverflow.com/users/4680747/joe-noble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501936517, "creation_date": 1501676198, "last_edit_date": 1501747380, "question_id": 45460660, "link": "https://stackoverflow.com/questions/45460660/how-to-refer-to-specific-cell-when-looping-through-named-range-excel-vba", "title": "How to refer to specific cell when looping through named range excel vba", "body": "<p>I have some code that has been working fine, but I have recently completely rewritten the spreadsheet to use named ranges. </p>\n\n<p>I'm now struggling to rewrite the code to refer to named ranges instead of absolute references. (i think this is the terminology!?)</p>\n\n<p>The File_ref range occupies cells A13:A104\nThe Already_Input? range occupies cells B13:B104</p>\n\n<p>I'm using Excel 2013 on Windows</p>\n\n<p>The code that works </p>\n\n<pre><code>Sub test()\nSet mybook = Excel.ActiveWorkbook\nSet entrysheet = mybook.Sheets(\"Entry\")\n\nDim RangeStart As Integer\nRangeStart = Range(\"File_ref\").Cells(1).Row\n\nDim RangeLength As Integer\nRangeLength = Range(\"File_Ref\").Count\n\nDim i As Long\nDim j As Long\nDim m As Long\n\nj = 0\nm = 0\n\nFor i = RangeStart To RangeLength + RangeStart\n\n        If IsEmpty(entrysheet.Range(\"A\" &amp; i)) Then 'it's this bit I cannot get to refer to named range\n\n        j = j + 1\n\n        ElseIf entrysheet.Range(\"B\" &amp; i) = \"yes\" Then\n\n        m = m + 1\n\n        End If\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>The code i have tried, but which doesn't work: </p>\n\n<pre><code>Sub test()\nSet mybook = Excel.ActiveWorkbook\nSet entrysheet = mybook.Sheets(\"Entry\")\n\nDim RangeStart As Integer\nRangeStart = Range(\"File_ref\").Cells(1).Row\n\nDim RangeLength As Integer\nRangeLength = Range(\"File_Ref\").Count\n\nDim i As Long\nDim j As Long\nDim m As Long\n\nj = 0\nm = 0\n\nFor i = RangeStart To RangeLength + RangeStart\n\n        If IsEmpty(entrysheet.Range(\"File_ref\").Cells(i)) Then\n\n        j = j + 1\n\n        ElseIf entrysheet.Range(\"Already_Input?\").Cells(i) = \"yes\" Then\n\n        m = m + 1\n\n        End If\n\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1501675713, "post_id": 45460377, "comment_id": 77880928, "body": "The Range <code>emailRng</code> is not defined in your code."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501676353, "post_id": 45460377, "comment_id": 77881450, "body": "Next macro? you mean to say it should skip the row or the macro should stop?"}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501676596, "post_id": 45460377, "comment_id": 77881644, "body": "So the range I would need to add is (B2:B) and then swap that in for emailRng?"}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1501676632, "post_id": 45460377, "comment_id": 77881674, "body": "I mean it should stop the macro if the range is empty @nishit dey"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1501676916, "post_id": 45460377, "comment_id": 77881889, "body": "Use <code>Set emailRng = .Range(&quot;B2:B&quot; &amp; lRow)</code> within your <code>With</code> block."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501677037, "post_id": 45460377, "comment_id": 77881989, "body": "So it will look like this: <code>lRow = .Range(&quot;B&quot; &amp; .Rows.Count).End(xlUp).Row &#39;The column in &quot;&quot; must change to match the target column Set testRng = Worksheets(&quot;Data&quot;).Range(&quot;B2:B&quot;) If WorksheetFunction.CountBlank(testRng) = testRng.Cells.Count Then Exit Sub</code>"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501679036, "post_id": 45461571, "comment_id": 77883699, "body": "Hey @fcsr,  Where exactly would this fit into the rest of the code I have above? Thank you for the assistance, your post was very clear."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501679129, "post_id": 45461571, "comment_id": 77883782, "body": "sorry wait, i have to edit this, if range is blank then it will throw an error. You could use <code>on error goto</code> but I want to find a more elegant approach."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501692884, "post_id": 45461571, "comment_id": 77894268, "body": "Sorry about the delayed response but the answer provided by Jerry actually solved another problem I had. But your solution totally solved the one that this question was made for! Did you make your edit? It appears that you did as what you provided above worked on a blank range. Exactly how I needed it to!"}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "reply_to_user": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501695348, "post_id": 45461571, "comment_id": 77895727, "body": "Yup edited it, took a different route as my original answer was troublesome. Happy to help."}], "tags": [], "owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "is_accepted": true, "score": 0, "last_activity_date": 1501680083, "last_edit_date": 1501680083, "creation_date": 1501678763, "answer_id": 45461571, "question_id": 45460377, "link": "https://stackoverflow.com/questions/45460377/do-not-run-paste-macro-if-all-cells-in-a-column-are-empty/45461571#45461571", "title": "Do not run paste macro if all cells in a column are empty", "body": "<p>Try this:</p>\n\n<pre><code>Sub Update_Column_Based_On_Column_Value_1()\nOn Error Resume Next\n    Dim ws As Worksheet\n    Dim lRow As Long\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    ' This will count all non-blanks in Column B, I put equal to 1\n    ' because I am assuming B1 is a header with a title so it will at minimum be 1\n    If WorksheetFunction.CountA(ws.Range(\"B:B\")) = 1 Then\n        ' if count is equal to 1 then this part will run\n        ' so enter name of the sub() or write new code in here\n    Else\n        ' if not less than or equal, meaning greater than 1\n        ' then the following code below will run\n        With ws\n            lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n            .Range(\"A1:A\" &amp; lRow).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=If(LEN(RC2),\"\"NEW VALUE GOES HERE\"\", TEXT(,))\"\n            .Range(\"A1:A\" &amp; lRow).Value = .Range(\"A1:A\" &amp; lRow).Value\n        End With\n    End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501680257, "post_id": 45461694, "comment_id": 77884759, "body": "What can I say Jerry this works perfectly! I even needed to run this on multiple columns after Column B and this code doesn&#39;t overwrite any of that Column A data when I do that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8285860"}, "reply_to_user": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1501681140, "post_id": 45461694, "comment_id": 77885483, "body": "Thanks, i glad it helped."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8285860"}, "is_accepted": false, "score": 0, "last_activity_date": 1501679077, "creation_date": 1501679077, "answer_id": 45461694, "question_id": 45460377, "link": "https://stackoverflow.com/questions/45460377/do-not-run-paste-macro-if-all-cells-in-a-column-are-empty/45461694#45461694", "title": "Do not run paste macro if all cells in a column are empty", "body": "<p>This code will do what you want</p>\n\n<pre><code>Sub test()\nDim i As Long\nDim lRow As Long\n\nlRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    For i = 2 To lRow\n        If Cells(i, \"B\").Value &lt;&gt; vbNullString Then\n            Cells(i, \"A\").Value = Cells(i, \"B\").Value\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 45461571, "answer_count": 2, "score": 1, "last_activity_date": 1501682864, "creation_date": 1501675473, "last_edit_date": 1501682864, "question_id": 45460377, "link": "https://stackoverflow.com/questions/45460377/do-not-run-paste-macro-if-all-cells-in-a-column-are-empty", "title": "Do not run paste macro if all cells in a column are empty", "body": "<p>I have a macro that looks for records in Column B and if there is a value in a cell within that column then the macro will add a value to Column A in the same row. My problem occurs when Column B has NO values in it whatsoever. The macro just continues running endlessly in those instances. What I am looking for is a way to say: </p>\n\n<ul>\n<li>If Column B contains NO value then skip to the next macro.</li>\n</ul>\n\n<p>I know this involves an IF statement of some kind I just can not figure out how to add that logic into my existing code.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub Update_Column_Based_On_Column_Value_1()\nOn Error Resume Next\n    Dim ws As Worksheet\n    Dim lRow As Long\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With ws\n        lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n        .Range(\"A1:A\" &amp; lRow).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=If(LEN(RC2),\"\"NEW VALUE GOES HERE\"\", TEXT(,))\"\n        .Range(\"A1:A\" &amp; lRow).Value = .Range(\"A1:A\" &amp; lRow).Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>My search for the answer yielded this string of code from another <a href=\"https://stackoverflow.com/questions/34880797/stop-macro-if-column-is-blank-excel-vba\">StackOverflow question</a>:</p>\n\n<pre><code>If WorksheetFunction.CountBlank(emailRng) = emailRng.Cells.Count Then Exit Sub  'No data\n</code></pre>\n\n<p>When I added that to my code it simply ended the sub if there were ANY blank cells in a column.</p>\n\n<p>Thanks in advance for the assistance! I do apologize if my question is overly noobish.</p>\n"}, {"tags": ["mysql", "vba"], "comments": [{"owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "edited": false, "score": 0, "creation_date": 1501674799, "post_id": 45460143, "comment_id": 77880223, "body": "<code>c:\\Windows\\SysWOW64\\odbcad32.exe.</code> Check if ODBC datasource is defined in 32-bit mode. If not then define it and check your code again."}, {"owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "reply_to_user": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "edited": false, "score": 0, "creation_date": 1501700340, "post_id": 45460143, "comment_id": 77898785, "body": "They are defined as &quot;32/64 bits&quot; in user dsn tab. Still get the error. The connection is &quot;successful&quot; when defining the datasources and testing it. Is there some other way to Check if ODBC datasource is defined in 32-bit mode?"}], "owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501674749, "creation_date": 1501674749, "question_id": 45460143, "link": "https://stackoverflow.com/questions/45460143/trying-to-connect-in-vba-ado-to-localhost-mysql", "title": "Trying to connect in VBA, ADO to localhost MySQL", "body": "<p>I'm using</p>\n\n<pre><code>Sub fff()\nDim cn As ADODB.Connection\nSet cn = New ADODB.Connection\nDim RS As ADODB.Recordset\nConnectionString = \"{MySQL ODBC 5.3 Unicode Driver};Server=localhost;Database=test;User=root;\"\n\ncn.Open ConnectionString\ncn.Close\nSet cn = Nothing\nMsgBox \"connected\"\n</code></pre>\n\n<p>I'm running Office 32b on Win 64b\nI've installed MySql drivers as shown here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/s7CKB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s7CKB.png\" alt=\"enter image description here\"></a></p>\n\n<p>I get the error</p>\n\n<p><a href=\"https://i.stack.imgur.com/A4eFj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A4eFj.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "insert-update", "vba"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 3726620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d832c3d33994a7987728a72eaea77d6?s=128&d=identicon&r=PG&f=1", "display_name": "kaku", "link": "https://stackoverflow.com/users/3726620/kaku"}, "edited": false, "score": 0, "creation_date": 1501692787, "post_id": 45460320, "comment_id": 77894208, "body": "this doesn&#39;t seem to work. if I put, RC[16], ref. to column Z, it actually causes to pass an unrelated number (=content of the cell where column Z crosses that row) to the outer index function as the row number, actually a fake row number for non-existing item. so we won&#39;t keep the original value. of course original value still exists in column Z."}, {"owner": {"reputation": 103, "user_id": 3726620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d832c3d33994a7987728a72eaea77d6?s=128&d=identicon&r=PG&f=1", "display_name": "kaku", "link": "https://stackoverflow.com/users/3726620/kaku"}, "edited": false, "score": 0, "creation_date": 1501705513, "post_id": 45460320, "comment_id": 77901683, "body": "fantastic! it&#39;s working... but I should dig into it, your formula is not so obvious to me. I&#39;ll try to make a simplified sample of my work to share"}], "tags": [], "owner": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "is_accepted": true, "score": 0, "last_activity_date": 1501696936, "last_edit_date": 1501696936, "creation_date": 1501675293, "answer_id": 45460320, "question_id": 45460124, "link": "https://stackoverflow.com/questions/45460124/update-values-of-a-column-using-index-match-excel-vba/45460320#45460320", "title": "Update values of a column using Index &amp; Match (Excel/VBA)", "body": "<p>The easiest way to solve this is to copy and paste Column J into a new column (say Z). Then, put this formula into Column J</p>\n\n<pre><code>=if(ISERROR(INDEX([myWB.xls]Sheet1!C1:C2,IF(INDEX([myWB.xls]Sheet1!C1,MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1))=R[-11]C[-12],MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1),NA()),2)),RC[16],INDEX([myWB.xls]Sheet1!C1:C2,IF(INDEX([myWB.xls]Sheet1!C1,MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1))=R[-11]C[-12],MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1),NA()),2))\n</code></pre>\n\n<p>I check to see whether the formula returns a valid value, if it does not, then I put in the value from Column Z (I have assumed that RC[16] is a valid reference for this, from your earlier comment), otherwise I put in the value as calculated.</p>\n\n<p>Without seeing your spreadsheet, it is difficult to see exactly what you are trying to do. It might be possible to shorten this function.</p>\n"}], "owner": {"reputation": 103, "user_id": 3726620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d832c3d33994a7987728a72eaea77d6?s=128&d=identicon&r=PG&f=1", "display_name": "kaku", "link": "https://stackoverflow.com/users/3726620/kaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1603, "favorite_count": 0, "accepted_answer_id": 45460320, "answer_count": 1, "score": 0, "last_activity_date": 1501716980, "creation_date": 1501674690, "last_edit_date": 1531161705, "question_id": 45460124, "link": "https://stackoverflow.com/questions/45460124/update-values-of-a-column-using-index-match-excel-vba", "title": "Update values of a column using Index &amp; Match (Excel/VBA)", "body": "<p>Bellow is part of my codes and my coding is almost done, but now I found a big problem that it's necessary to be corrected.</p>\n\n<p>I use this code on a sheet with over 10000 rows and my purpose is to update a column using Index &amp; Match functions. What it's doing is that it replaces all cells of range in column J with corresponding values from another sheet. The big problem is that I don't want cells that have no matching item be replaced with #N/A and they keep their old values.</p>\n\n<p>What should I do? </p>\n\n<pre><code>Dim SourceRange As Range\nDim fillRange As Range\n\n'bellow formula in A1 notation:\n'=INDEX('[myWB.xls]Sheet1'!$A:$B;\n'IF(INDEX('[myWB.xls]Sheet1'!$A:$A;MATCH(C4;'[myWB.xls]Sheet1'!$A:$A))=C4;\n'    MATCH(C4;'[myWB.xls]Sheet1'!$A:$A);\n'    NA());\n'    2)\n\nActiveCell.FormulaR1C1 = _\n\"=INDEX([myWB.xls]Sheet1!C1:C2,IF(INDEX([myWB.xls]Sheet1!C1,MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1))=R[-11]C[-12],MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1),NA()),2)\"\n\n' autofill formula in column\nSet SourceRange = Cells(2, 10)\nSet fillRange = Range(Cells(2, 10), Cells(10000, 10))\n\nWith SourceRange\n   .AutoFill Destination:=fillRange, Type:=xlCopy\nEnd With\n\n'replace formula with its value\nWith Range(Cells(2, 10), Cells(10000, 10))\n   .Value = .Value\nEnd With\n</code></pre>\n\n<hr>\n\n<h2>Update</h2>\n\n<p>This is my current code with some improvements. Thanks to Rob Anthony for his help.</p>\n\n<pre><code>Dim calc As XlCalculation\nDim f as String\n\nWith Workbooks(FinalWB.xls).Worksheets(1)  'Worksheet to be updated\n    calc = Application.Calculation\n    Application.Calculation = xlCalculationAutomatic  'Ensure automatic calculation is ON\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    'Copy Column J to Column Z\n    Range(.Cells(2, 26), .Cells(10000, 26)).Value = _  ' Col Z =\n    Range(.Cells(2, 10), .Cells(10000, 10)).Value      ' Col J\n\n    f = \"=if(ISERROR(INDEX([myWB.xls]Sheet1!C1:C2,IF(INDEX([myWB.xls]Sheet1!C1,MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1))=R[-11]C[-12],MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1),NA()),2)),RC[16],INDEX([myWB.xls]Sheet1!C1:C2,IF(INDEX([myWB.xls]Sheet1!C1,MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1))=R[-11]C[-12],MATCH(R[-11]C[-12],[myWB.xls]Sheet1!C1),NA()),2))\"\n\n    With Range(.Cells(2, 10), .Cells(10000, 10))\n       .FormulaR1C1 = f    'fill formula without Autofill\n       .Value = .Value     'replace formula with its value\n    End With\n\n    'Delete Column Z\n    .Columns(26).EntireColumn.Delete\nEnd With\n\nApplication.Calculation = calc\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\n'This is above formula. now seems so easy to understand :)\n'    f = \n'    \"=IF(                                   'if calculations result an error...\n'        ISERROR(\n'               INDEX([myWB.xls]Sheet1!C1:C2,\n'                    IF(\n'                      INDEX([myWB.xls]Sheet1!C1,\n'                           MATCH(R[-11]C[-12],\n'                                [myWB.xls]Sheet1!C1)\n'                           )=R[-11]C[-12],\n'                      MATCH(R[-11]C[-12],\n'                           [myWB.xls]Sheet1!C1),\n'                      NA()\n'                      ),\n'                    2\n'                    )\n'               ),\n'        RC[16],                             'use previousely copied value of the cell...\n'        INDEX([myWB.xls]Sheet1!C1:C2,       'else use that calculations \n'             IF(\n'               INDEX([myWB.xls]Sheet1!C1,\n'                    MATCH(R[-11]C[-12],\n'                         [myWB.xls]Sheet1!C1)\n'                    )=R[-11]C[-12],\n'               MATCH(R[-11]C[-12],\n'                    [myWB.xls]Sheet1!C1),\n'               NA()\n'               ),\n'             2\n'             )\n'        )\n'    \"\n</code></pre>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1501674479, "post_id": 45459929, "comment_id": 77880000, "body": "What is the expected output? Add code for <code>wrapper</code> and <code>excel</code> variables init."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1501676561, "post_id": 45459929, "comment_id": 77881611, "body": "Is it VBScript or VBA?"}, {"owner": {"reputation": 21, "user_id": 5181080, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KkVel4OP2MA/AAAAAAAAAAI/AAAAAAAAI6Q/BEVUwSNoV3I/photo.jpg?sz=128", "display_name": "Devendra Vastrakar", "link": "https://stackoverflow.com/users/5181080/devendra-vastrakar"}, "edited": false, "score": 0, "creation_date": 1501678248, "post_id": 45459929, "comment_id": 77883016, "body": "it&#39;s in VBScript"}], "owner": {"reputation": 21, "user_id": 5181080, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KkVel4OP2MA/AAAAAAAAAAI/AAAAAAAAI6Q/BEVUwSNoV3I/photo.jpg?sz=128", "display_name": "Devendra Vastrakar", "link": "https://stackoverflow.com/users/5181080/devendra-vastrakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501674374, "creation_date": 1501674137, "last_edit_date": 1531164843, "question_id": 45459929, "link": "https://stackoverflow.com/questions/45459929/get-stacktrace-as-string-in-vbscript", "title": "get stacktrace as string in vbscript", "body": "<p>I have to capture stacktrace at the time of error and actual exception. Currently with the below code it's throwing error every time in <code>Call Err.Raise</code> line it show be throw like for line <code>wrapper.getVariable(\"IRR\").value</code> or <code>wrapper.getVariable(\"GT_Price\").value</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>On Error Resume Next      \nwrapper.getVariable(\"IRR\").value = excel.range(\"'Cases'!$H$753\")     \nwrapper.getVariable(\"GT_Price\").value = excel.range(\"'Cases'!$H$763\")     \n\nIf Err.Number &lt;&gt; 0 Then\n    Dim errorMessage, objHTTP, URL, json\n    errorMessage =\"Error while executing EVMLite. Error number \" &amp; Err.Number &amp; \". \" &amp; Err.Description &amp; \" \" &amp; Err.Source\n    Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")    \n    URL = \"http://10.93.24.223:9005/vpp/logerror\"\n    objHTTP.Open \"POST\", URL, False\n    objHTTP.SetRequestHeader \"Content-Type\", \"application/json\"\n    json = \"{\"\"jobId\"\": \"\"\"&amp; jobId &amp;\"\"\", \"\"uniqueId\"\": \"\"\"&amp; uniqueId &amp;\"\"\", \"\"errorCode\"\": \"\"\"&amp; errorCode &amp;\"\"\", \"\"errorMessage\"\": \"\"\"&amp; errorMessage &amp;\"\"\"}\"\n    objHTTP.send (json)\n    On Error Goto 0\n    Call Err.Raise(vbObjectError + 10, \"EVM Failed to execute\", errorMessage)\n    'MsgBox objHTTP.ResponseText\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "sorting", "blank-line"], "comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1501674731, "post_id": 45459782, "comment_id": 77880187, "body": "You are working with one column or you sort whole table based on specific column?"}, {"owner": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "reply_to_user": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1501675130, "post_id": 45459782, "comment_id": 77880476, "body": "I sort a whole tabel based by this 2 collumns, first Descending by column A then as second source i took colummn P where I want if it is possible to keep only the P-s with some text up, so when I Remowe the duplicats only the one with text in P wont be deleted"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1501675258, "post_id": 45459782, "comment_id": 77880558, "body": "And blanks are located only in one column, right? And you want to only move them to bottom?"}, {"owner": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "reply_to_user": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1501675353, "post_id": 45459782, "comment_id": 77880643, "body": "Yes,  there are blanks in some other Columns but I only want to sort this Column so the blanks are at the bottom in the second sorting."}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "edited": false, "score": 0, "creation_date": 1501674222, "post_id": 45459911, "comment_id": 77879834, "body": "I dont want to delet them i want them on the bottom in the second key, because i also need some of the blanks"}], "tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": -1, "last_activity_date": 1501674070, "creation_date": 1501674070, "answer_id": 45459911, "question_id": 45459782, "link": "https://stackoverflow.com/questions/45459782/vba-sorting-blank-cells-to-bottom/45459911#45459911", "title": "VBA Sorting Blank Cells to Bottom", "body": "<p>this deals with deleting the blank cells. Change the sheet name and column parameters as required:</p>\n\n<pre><code>Dim i As Long\nDim n As Long\n\nn = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\nWith Sheets(\"Sheet1\")\n    For i = 1 To n\n        If .Cells(i, 1).Value = \"\" Then\n            .Cells(i, 1).EntireRow.Delete\n        End If\n    Next i\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "edited": false, "score": 0, "creation_date": 1501676259, "post_id": 45460570, "comment_id": 77881364, "body": "I could also make a much easier solution like I add another Column that have values 1 and 0 for non empty and empty, but isnt there any option that just keeps the blanks in bottom by the second sorting I mean common there must be some comand in VBA is not that big deal or is it?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "edited": false, "score": 0, "creation_date": 1501676406, "post_id": 45460570, "comment_id": 77881498, "body": "I don&#39;t think so, it&#39;s how sorting works, keeps blanks first (no value is before any value). You could order it descending instead of ascending (this would keep blanks at the bottom, but I think that&#39;s not what you need). You need some workaround like one I posted."}, {"owner": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "edited": false, "score": 0, "creation_date": 1501676960, "post_id": 45460570, "comment_id": 77881930, "body": "That dont do it, however i sort it it keeps the blanks up Ascending or Descending like the sorting dont works"}, {"owner": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "edited": false, "score": 0, "creation_date": 1501677233, "post_id": 45460570, "comment_id": 77882194, "body": "I just tried it wit athin a &quot;zzz&quot; value and I think the second sorting just dont work for some reasson but i dont know why"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "edited": false, "score": 0, "creation_date": 1501740175, "post_id": 45460570, "comment_id": 77912354, "body": "It works perfectly... How should it work according to you? Becuase, this sorting works like that: first, it sorts accordingly to column in <code>key1</code>, if in this sorting, there are ties, the <code>key2</code> column would resolve them. For example, these are 4 rows: (2,1), (1,1), (1,0), (2, 0). After sorting it ascending, first column would become: 1, 1, 2, 2 (we have 2 ties). Then, second sorting will sort these rows in this order: (1, 0), (1, 1), (2, 0), (2, 1)."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1501676530, "last_edit_date": 1501676530, "creation_date": 1501675946, "answer_id": 45460570, "question_id": 45459782, "link": "https://stackoverflow.com/questions/45459782/vba-sorting-blank-cells-to-bottom/45460570#45460570", "title": "VBA Sorting Blank Cells to Bottom", "body": "<p>Here's how I'd do it: check if we have blank in specified column, if so, move entire row to the bottom and delete it (so entire table moves up one row). Repeat until there's non-empty cell at the top in specified column.</p>\n\n<pre><code>Sub MoveBlanksToBottom()\n'you have to specify size of your table here\nDim rows, columns, columnsWithBlanks As Long\nrows = 10\ncolumns = 4\ncolumnWithBlanks = 1\n'we will loop until the first row in specified column will be non empty\nDo While IsEmpty(Cells(1, columnWithBlanks))\n    'copy entire row to the bottom\n    For i = 1 To columns\n        Cells(rows + 1, i).Value = Cells(1, i).Value\n    Next\n    'delete the row\n    Cells(1, 1).EntireRow.Delete\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>You should use this <code>Sub</code> after you sorted your table.</p>\n\n<p>You can pass size of a table as parameters to make it more flexible:</p>\n\n<pre><code>Sub MoveBlanksToBottom()\n'you have to specify size of your table here\nDim rows, columns, columnsWithBlanks As Long\nrows = 10\ncolumns = 4\ncolumnWithBlanks = 1\n</code></pre>\n\n<p>should be replaced by</p>\n\n<pre><code>Sub MoveBlanksToBottom(rows As Long, columns As Long, columnsWithBlanks As Long)\n</code></pre>\n\n<p>Then you can call it like this: <code>Call MoveBlanksToBottom(10, 4, 1)</code>.</p>\n"}], "owner": {"reputation": 203, "user_id": 4874506, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86446152b5aa8d08c806fd630a838624?s=128&d=identicon&r=PG&f=1", "display_name": "Vedad", "link": "https://stackoverflow.com/users/4874506/vedad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5030, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501676530, "creation_date": 1501673725, "last_edit_date": 1501674405, "question_id": 45459782, "link": "https://stackoverflow.com/questions/45459782/vba-sorting-blank-cells-to-bottom", "title": "VBA Sorting Blank Cells to Bottom", "body": "<p>I want to remowe some duplicate Value from an excel Column, but before that I need to sort it right so it dont Remowe any contatn i want to have. The problem i got are the blank cells, i want them to be remowed but they keep staying at any sorting on the top. Here is my sorting code, any Idea?</p>\n\n<pre><code>ABC.Range(\"A1\", \"AF\" &amp; lngLastRow).Sort key1:=ABC.Range(\"A1:A\" &amp; lngLastRow), _\n   order1:=xlDescending, key2:=ABC.Range(\"P1:P\" &amp; lngLastRow), _\n   order2:=xlDescending, MatchCase:=False, Orientation:=xlTopToBottom, Header:=xlNo\n</code></pre>\n\n<p>I need a Solution where I can sort them (Blanks) to the bottom with the second key. I DON'T need a solution where i delete them because some of the duplicates have only blank values in this column and I still need to keep them if they dont have any alternativ.</p>\n"}, {"tags": ["excel", "vba", "import"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1501675912, "last_edit_date": 1501675912, "creation_date": 1501675498, "answer_id": 45460392, "question_id": 45459766, "link": "https://stackoverflow.com/questions/45459766/import-data-from-a-workbook-in-the-same-folder-depending-on-a-changing-name/45460392#45460392", "title": "Import data from a workbook in the same folder depending on a changing name", "body": "<p>In general, just for the previous week, you need something like this:</p>\n\n<pre><code>\"AIMS_Report_w\" &amp; Format((WorksheetFunction.WeekNum(Now) - 1), \"00\")\n</code></pre>\n\n<p>or even </p>\n\n<pre><code>\"AIMS_Report_w\" &amp; WorksheetFunction.WeekNum(Now) - 1\n</code></pre>\n\n<p>if you do not need it formatted.</p>\n\n<hr>\n\n<p>Otherwise, if you want to provide the name of the previous current report and to get the previous one from it, something like this would be useful:</p>\n\n<pre><code>Option Explicit\n\nPublic Function GeneratePreviousWeek(strCurrentWeek As String) As String\n\n    Dim lngPrevious     As Long\n    Dim strResult       As String\n\n    lngPrevious = Right(strCurrentWeek, 2)\n    lngPrevious = lngPrevious - 1\n\n    strResult = Left(strCurrentWeek, Len(strCurrentWeek) - 2)\n\n    GeneratePreviousWeek = strResult + Format(lngPrevious, \"00\")\n\nEnd Function\n\nSub TestMe()\n\n    Debug.Print GeneratePreviousWeek(\"AIMS_Report_w05\")\n    Debug.Print GeneratePreviousWeek(\"AIMS_Report_w15\")\n\nEnd Sub\n</code></pre>\n\n<p>This is what you get in the immediate window:</p>\n\n<pre><code>AIMS_Report_w04\nAIMS_Report_w14\n</code></pre>\n\n<p>The <code>GeneratePreviousWeek</code>function takes the last two chars of the name of the report returns a string with <code>-1</code>. The following should be used:</p>\n\n<ul>\n<li>the format is always with a leading 0. E.g., <code>01</code>, <code>02</code></li>\n<li>if you ask for previous of <code>01</code> it returns <code>00</code>. Otherwise, you should be careful, sometimes there can be <code>53</code> weeks in the year, thus you need to provide the year as well.</li>\n<li>You may try to throw an error for values above <code>53</code></li>\n</ul>\n"}], "owner": {"reputation": 215, "user_id": 5244615, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ad068c341805464626762aee390d44b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dullspark", "link": "https://stackoverflow.com/users/5244615/dullspark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1257, "favorite_count": 0, "accepted_answer_id": 45460392, "answer_count": 1, "score": 1, "last_activity_date": 1563871729, "creation_date": 1501673691, "last_edit_date": 1563871729, "question_id": 45459766, "link": "https://stackoverflow.com/questions/45459766/import-data-from-a-workbook-in-the-same-folder-depending-on-a-changing-name", "title": "Import data from a workbook in the same folder depending on a changing name", "body": "<p>Each week there will be a workbook created where \"w\" is the week number.</p>\n\n<p>When the current workbook is for week \"31\" I want data to be taken from the closed workbook from week \"30\".</p>\n\n<p>I have this.</p>\n\n<pre><code>Sub Import_Data()\n\n  Dim rng As Range\n  Dim WB2 As Workbook\n  Dim FName As String\n\n  FName = Application.ActiveWorkbook.Path + \"w\"\n  Set WB2 = Workbooks.Open(Filename:=FName)\n\n  ThisWorkbook.ChampSpecific.Range(\"L3:O6\").Value = WB2.Worksheets(1).Range(\"M3:P6\").Value\n\n  WB2.Close\n\nEnd Sub\n</code></pre>\n\n<p>The macro will be run from a button in the week \"31\" workbook.</p>\n\n<p>I imagine the code will work but I don't know what the syntax would be for the line <code>FName = Application.ActiveWorkbook.Path + \"w\"</code> to pick up the week number before the current one.</p>\n"}, {"tags": ["vba", "command-line", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 1844728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3492dcebca5d1588dbb91237668695c?s=128&d=identicon&r=PG", "display_name": "John Gannaway", "link": "https://stackoverflow.com/users/1844728/john-gannaway"}, "edited": false, "score": 0, "creation_date": 1501771465, "post_id": 45461974, "comment_id": 77936129, "body": "I tried this and almost broke my outlook, was I doing something wrong? the code I wrote, took the command line arguments then showed a message box containing them. Will this break if there aren&#39;t any?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501826350, "post_id": 45461974, "comment_id": 77959211, "body": "tried it in Word ... caused crash ... i read somewhere that win 64bit API is different ... found some code ... posted below ... works in win7 64"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1501679789, "creation_date": 1501679789, "answer_id": 45461974, "question_id": 45459494, "link": "https://stackoverflow.com/questions/45459494/is-it-possible-to-pass-arguments-to-the-application-startup-sub-in-outlook/45461974#45461974", "title": "Is it possible to pass arguments to the Application_Startup sub in outlook?", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683156(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetCommandLine</a> function which retrieves the command-line string for the current process. To access the function just paste this API declaration at the top of your macro module:</p>\n\n<pre><code>Declare Function GetCommandLineA Lib \"Kernel32\" () As String\n</code></pre>\n\n<p>And then in the VBA sub you can use the following code:</p>\n\n<pre><code>Dim cmdLineArgs As String\n\n'Get the commande line string\ncmdLineArgs = GetCommandLineA\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1501826140, "creation_date": 1501826140, "answer_id": 45499183, "question_id": 45459494, "link": "https://stackoverflow.com/questions/45459494/is-it-possible-to-pass-arguments-to-the-application-startup-sub-in-outlook/45499183#45499183", "title": "Is it possible to pass arguments to the Application_Startup sub in outlook?", "body": "<p>found this : <a href=\"https://social.msdn.microsoft.com/Forums/en-US/0017d844-3e4a-4115-bc51-cf02ca23db0c/vba-to-fetch-excel-command-line-64-bit?forum=exceldev\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/0017d844-3e4a-4115-bc51-cf02ca23db0c/vba-to-fetch-excel-command-line-64-bit?forum=exceldev</a></p>\n\n<p>posted by : <a href=\"https://social.msdn.microsoft.com/profile/andreas%20killer/?ws=usercard-mini\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/profile/andreas%20killer/?ws=usercard-mini</a></p>\n\n<pre><code>'Note: Declaration is overloaded with LONG!\n#If Win64 Then\nPrivate Declare PtrSafe Function GetCommandLineL Lib \"kernel32\" Alias \"GetCommandLineA\" () As LongPtr\nPrivate Declare PtrSafe Function lstrcpyL Lib \"kernel32\" Alias \"lstrcpyA\" (ByVal lpString1 As String, ByVal lpString2 As LongPtr) As Long\nPrivate Declare PtrSafe Function lstrlenL Lib \"kernel32\" Alias \"lstrlenA\" (ByVal lpString As LongPtr) As Long\n#Else\nPrivate Declare Function GetCommandLineL Lib \"kernel32\" Alias \"GetCommandLineA\" () As Long\nPrivate Declare Function lstrcpyL Lib \"kernel32\" Alias \"lstrcpyA\" (ByVal lpString1 As String, ByVal lpString2 As Long) As Long\nPrivate Declare Function lstrlenL Lib \"kernel32\" Alias \"lstrlenA\" (ByVal lpString As Long) As Long\n#End If\n'\n\nFunction GetCommandLine() As String\n\n    #If Win64 Then\n    Dim lngPtr As LongPtr\n    #Else\n    Dim lngPtr As Long\n    #End If\n\n    Dim strReturn As String\n    Dim StringLength As Long\n\n    lngPtr = GetCommandLineL                        ' Get the pointer to the commandline string\n    StringLength = lstrlenL(lngPtr)                 ' get the length of the string (not including the terminating null character):\n    strReturn = String$(StringLength + 1, 0)        ' initialize our string so it has enough characters including the null character:\n    lstrcpyL strReturn, lngPtr                      ' copy the string we have a pointer to into our new string:\n    GetCommandLine = Left$(strReturn, StringLength) ' now strip off the null character at the end:\n\nEnd Function\n\nSub getCmdLine()\n\n    Debug.Print GetCommandLine()\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 1844728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3492dcebca5d1588dbb91237668695c?s=128&d=identicon&r=PG", "display_name": "John Gannaway", "link": "https://stackoverflow.com/users/1844728/john-gannaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501826140, "creation_date": 1501673005, "question_id": 45459494, "link": "https://stackoverflow.com/questions/45459494/is-it-possible-to-pass-arguments-to-the-application-startup-sub-in-outlook", "title": "Is it possible to pass arguments to the Application_Startup sub in outlook?", "body": "<p>I have a macro in outlook which I want to run on startup sometimes... Odd request I know. I know about the Application_Startup Sub but I am wondering if it is possible to pass command-line arguments to it?</p>\n\n<p>EDIT: our real requirement is to sometimes run a macro on startup based on a command-line argument. I have tried VBS and Application.Run and also the command-line switch /autorun which has been deprecated as of outlook 2003.</p>\n"}, {"tags": ["arrays", "vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501672006, "post_id": 45458986, "comment_id": 77878262, "body": "<code>i = Evaluate(&quot;ROW(A1:A5)&gt;3&quot;)</code>"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501672317, "post_id": 45458986, "comment_id": 77878488, "body": "@SJR, bizarre that that works, but <code>i = Evaluate(&quot;LEN(A1:A5)&gt;2&quot;)</code> does not. I would expect that to return an array but it only returns a single boolean, is there some ambiguity I&#39;m overlooking?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1501672709, "post_id": 45458986, "comment_id": 77878783, "body": "Bizarre indeed. I&#39;m not sure why, but some functions need to be &quot;forced&quot; to work in the correct way, e.g. this works <code>i = Evaluate(&quot;IF(ROW(A1:A5),LEN(A1:A5)&gt;2)&quot;)</code>"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501673109, "post_id": 45458986, "comment_id": 77879073, "body": "@SJR Hmm, that seems buggy, maybe it&#39;s a conflict with VBA builtins because I notice <code>Evaluate(ISERROR(A1:A5))</code> also doesn&#39;t work as expected."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501673332, "post_id": 45458986, "comment_id": 77879205, "body": "What are you actually trying to achieve?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1501673726, "post_id": 45458986, "comment_id": 77879503, "body": "Some not-array-functions are putting itself in array context when their parameters are arrays. Those functions can easily be used in array context in <code>SUMPRODUCT</code>. But some functions need to be forced into array context using [Ctrl]+[Shift]+[Enter]. Those functions can <b>not</b> easily be used in array context in <code>SUMPRODUCT</code>. Unfortunately there are not lists of which functions are the one or the other as far as I know."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501673849, "post_id": 45458986, "comment_id": 77879584, "body": "@SJR As I say, I&#39;m trying to find the <i>lowest character count</i> method for evaluating worksheet functions to return an array. I was aware that the <code>Evaluate</code> method <i>could</i> return an array, so I wanted to know under what circumstances/ with what syntax. The question is specifically about how to use that method to return an array, as I couldn&#39;t easily find anything else on the subject. Of course a work-around (looping over the range) would be an acceptable answer, but I don&#39;t think it can be showed that that will be lower character count until the details of <i>this</i> method are fully established."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1501674880, "post_id": 45458986, "comment_id": 77880284, "body": "Yes but to what end? I&#39;m not sure it is possible to &quot;fully establish&quot; the details of this method, e.g. see @AxelRichter&#39;s response."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1501684158, "post_id": 45462120, "comment_id": 77887948, "body": "Its fun that depending on the input, it gives one or two dimensional array. E.g. <code>A1:A5</code> is with 2 dimensions, <code>A1:G1</code> is with one."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1501737043, "post_id": 45462120, "comment_id": 77910975, "body": "<code>A1:A5</code> is a column vector while <code>A1:G1</code> is a row vector. So the surprise about different array results should be not so big."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 3, "last_activity_date": 1501680173, "creation_date": 1501680173, "answer_id": 45462120, "question_id": 45458986, "link": "https://stackoverflow.com/questions/45458986/how-to-evaluate-array-formulae-with-the-evaluate-method/45462120#45462120", "title": "How to evaluate array formulae with the Evaluate method", "body": "<p>To return an array, you need to use a function that supports an array as a result.</p>\n\n<p>The function usually used with VBA to evaluate an expression to an array is <a href=\"https://support.office.com/en-us/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd\" rel=\"nofollow noreferrer\">INDEX</a> since it doesn't alter the values :</p>\n\n<pre><code>Dim data()\ndata = Evaluate(\"INDEX(LEN(A1:A5)&gt;3,)\")\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1041, "favorite_count": 2, "accepted_answer_id": 45462120, "answer_count": 1, "score": 8, "last_activity_date": 1501680173, "creation_date": 1501671601, "last_edit_date": 1501672609, "question_id": 45458986, "link": "https://stackoverflow.com/questions/45458986/how-to-evaluate-array-formulae-with-the-evaluate-method", "title": "How to evaluate array formulae with the Evaluate method", "body": "<p>In VBA, the <code>Evaluate()</code> and <code>[]</code> methods can both be used to return arrays:</p>\n\n<pre><code>Dim i As Variant\ni = Evaluate(\"{1,2;3,4}\")\ni = [{1,2;3,4}]\n</code></pre>\n\n<p>both lines set <code>i</code> to be a 2D array containing the numbers 1-4. An added functionality is that <code>Evaluate(...)(1,2)</code> returns the R1C2 indexed element of the array (i.e. 2 - <code>[...](1,2)</code> meanwhile errors)</p>\n\n<p>I'm wondering whether there's any syntax for evaluating an array-returning worksheet function in the same way, e.g.</p>\n\n<pre><code>i = Evaluate(\"LEN(A1:A5)&gt;3\") 'or similar like [{LEN(A1:A5)&gt;3}]\n</code></pre>\n\n<p>which should return the 1D array like <code>{False,False,False,True,True}</code> if I have text longer than 3 characters in <code>A4</code> &amp; <code>A5</code>, but it doesn't.</p>\n\n<p>If not, is there another 1-liner way of evaluating an array-formula to return the full array? I'm looking for whatever approach gives the smallest character-count.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2682, "user_id": 2662901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c91dbe3c7fdf96369fe85bf22f9fc29?s=128&d=identicon&r=PG", "display_name": "feetwet", "link": "https://stackoverflow.com/users/2662901/feetwet"}, "edited": false, "score": 0, "creation_date": 1610041879, "post_id": 45458979, "comment_id": 116014041, "body": "<a href=\"https://stackoverflow.com/q/27005522/2662901\">Related</a> and <a href=\"https://stackoverflow.com/q/1674467/2662901\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501731623, "post_id": 45467552, "comment_id": 77909245, "body": "I tried using above code. Still it&#39;s showing error."}, {"owner": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501733292, "post_id": 45467552, "comment_id": 77909650, "body": "from the workbook_BeforeClose() line-  Application.OnTime EarliestTime:=starttime, Procedure:=&quot;startapp&quot;, Schedule:=False"}, {"owner": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501733928, "post_id": 45467552, "comment_id": 77909855, "body": "Now the error is : application-defined or object-defined error"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501735049, "post_id": 45467552, "comment_id": 77910229, "body": "When it errors, go to the Immediate pane and type <code>? starttime</code> and press enter - what is printed?"}, {"owner": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501735737, "post_id": 45467552, "comment_id": 77910469, "body": "Nothing has been printed"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501735998, "post_id": 45467552, "comment_id": 77910555, "body": "See my edit above: if there is no OnTime to cancel, or if it has already triggered, you will get an error when you try to cancel it, so you can ignore the error."}, {"owner": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501736216, "post_id": 45467552, "comment_id": 77910637, "body": "although you used-On error resume next, it opens the workbook again."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501736332, "post_id": 45467552, "comment_id": 77910693, "body": "Seems like something is clearing your global variables: maybe an unhandled error in some other code?"}, {"owner": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501737378, "post_id": 45467552, "comment_id": 77911119, "body": "No. I think we have defined value for starttime and rtime in private function so another functions are not taking it. is it?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "edited": false, "score": 0, "creation_date": 1501737823, "post_id": 45467552, "comment_id": 77911286, "body": "Those variables are declared at the top of the ThisWorkbook module: that&#39;s where the event procedures that access them are located, so there&#39;s no problem there."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1501735937, "last_edit_date": 1501735937, "creation_date": 1501695455, "answer_id": 45467552, "question_id": 45458979, "link": "https://stackoverflow.com/questions/45458979/excel-workbook-gets-opened-repeatedly-after-closing/45467552#45467552", "title": "Excel workbook gets opened repeatedly after closing", "body": "<p>When cancelling an <code>OnTime</code>, you need to use the exact same argument values you used when creating it (except for the third argument). </p>\n\n<p>That means you can't pass a different time when you cancel it.</p>\n\n<pre><code>Dim starttime '&lt;&lt;&lt; store the time values for later use...\nDim rtime\n\nPrivate Sub Workbook_Open()\n\n    starttime = Now + TimeValue(\"00:02:00\")\n\n    Application.OnTime EarliestTime:=starttime, Procedure:=\"startapp\", schedule:=True\n\n    rtime = TimeValue(\"14:30:00\")\n\n    Application.OnTime EarliestTime:=rtime, Procedure:=\"sendreminder\",  Schedule:=True   \n\n    Application.OnTime EarliestTime:=rtime, Procedure:=\"sendreminder_out\",Schedule:=True  \n\n    Application.OnTime EarliestTime:=rtime, Procedure:=\"SendReminderFromProxy\",Schedule:=True  \n\n\nEnd Sub\n\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    MsgBox \"Dear\" &amp; \" \" &amp; Environ(\"USERNAME\") &amp; \", \" &amp; \"Please do not forget to save before closing.\"\n\n    'use the global variable here\n    On Error Resume Next '&lt;&lt; prevent error if no schedule is set\n                         '   or if already triggered\n    Application.OnTime EarliestTime:=starttime, Procedure:=\"startapp\", Schedule:=False\n    Application.OnTime EarliestTime:=rtime, Procedure:=\"sendreminder\", Schedule:=False       \n    Application.OnTime EarliestTime:=rtime, Procedure:=\"sendreminder_out\", Schedule:=False\n    Application.OnTime EarliestTime:=rtime, Procedure:=\"SendReminderFromProxy\", Schedule:=False\n    On Error Goto 0\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6920412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb1c962e853f8aa825852e90b9ffd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja", "link": "https://stackoverflow.com/users/6920412/pooja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501735937, "creation_date": 1501671572, "last_edit_date": 1501671671, "question_id": 45458979, "link": "https://stackoverflow.com/questions/45458979/excel-workbook-gets-opened-repeatedly-after-closing", "title": "Excel workbook gets opened repeatedly after closing", "body": "<p>I have used the method Application.ontime() for scheduling some macros.After closing the workbook, it gets opened again and again. to overcome this problem, I set another event on workbook- BeforeClosed. Now it is showing runtime error 1004:Method 'OnTime' of 'Object'_Application failed.I am not getting why this happening even after reffering the help context from web. Below code is given.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nstarttime = Now + TimeValue(\"00:02:00\")\n\nApplication.OnTime EarliestTime:=starttime, Procedure:=\"startapp\", schedule:=True\n\nrtime = TimeValue(\"14:30:00\")\n\nApplication.OnTime EarliestTime:=rtime, Procedure:=\"sendreminder\",  Schedule:=True   \n\nApplication.OnTime EarliestTime:=rtime, Procedure:=\"sendreminder_out\",Schedule:=True  \n\nApplication.OnTime EarliestTime:=rtime, Procedure:=\"SendReminderFromProxy\",Schedule:=True  \n\n\nEnd Sub\n\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n\nMsgBox \"Dear\" &amp; \" \" &amp; Environ(\"USERNAME\") &amp; \", \" &amp; \"Please do not forget to save before closing.\"\n\nstarttime = Now + TimeValue(\"00:02:00\")\n\nApplication.OnTime EarliestTime:=starttime, Procedure:=\"startapp\", Schedule:=False\n\nrtime = TimeValue(\"14:30:00\")\n\nApplication.OnTime EarliestTime:=rtime, Procedure:=\"sendreminder\", Schedule:=False       \n\nApplication.OnTime EarliestTime:=rtime, Procedure:=\"sendreminder_out\", Schedule:=False\n\nApplication.OnTime EarliestTime:=rtime, Procedure:=\"SendReminderFromProxy\", Schedule:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1501671978, "post_id": 45458954, "comment_id": 77878236, "body": "I&#39;m intrigued that <code>End Sub</code> doesn&#39;t feature at any point, perhaps that will lead to some issues - could you change the last <code>Exit</code> to an <code>End</code>?"}, {"owner": {"reputation": 1, "user_id": 8404957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab433204ca962c8079162de3639e57e?s=128&d=identicon&r=PG&f=1", "display_name": "Henrik GJ", "link": "https://stackoverflow.com/users/8404957/henrik-gj"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1501672930, "post_id": 45458954, "comment_id": 77878948, "body": "Sorry I did not get it all written down. There is an end sub in the macro. I&#39;ve edited the text:) Thanks for pointing it out."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1501673179, "post_id": 45458954, "comment_id": 77879114, "body": "Do you have a list of those invalid characters? If yes, update your question with them. If not, get that list."}, {"owner": {"reputation": 1, "user_id": 8404957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab433204ca962c8079162de3639e57e?s=128&d=identicon&r=PG&f=1", "display_name": "Henrik GJ", "link": "https://stackoverflow.com/users/8404957/henrik-gj"}, "edited": false, "score": 0, "creation_date": 1501673856, "post_id": 45458954, "comment_id": 77879589, "body": "Updated text with invalid characters."}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1501688999, "creation_date": 1501688999, "answer_id": 45465488, "question_id": 45458954, "link": "https://stackoverflow.com/questions/45458954/replace-invalid-characters-when-saving-excel-as-pdf/45465488#45465488", "title": "Replace invalid characters when saving excel as PDF", "body": "<p>The following Function will replace pre-selected characters with an alternative:</p>\n\n<pre><code>Function clean_filename(fname As String, replace_with As String)\n    Dim inv_chars As String\n    Dim cpos As Long\n    invchars = \"!\"\"#\u00a4%&amp;/()=?`^*&gt;;:@\u00a3${[]}|~\\,.'\u00a8\u00b4+-\"\n    For cpos = 1 To Len(invchars)\n        fname = Replace(fname, Mid(invchars, cpos, 1), replace_with)\n    Next\n    clean_filename = fname\nEnd Function\n</code></pre>\n\n<p>You could use this by adding <code>v = clean_filename(v,\"_\")</code> once you've captured v (as a string).</p>\n\n<p>However, you've included <code>.</code> and <code>/</code> in your invalid character list, and both are important to filenames so you may want to consider removing them and/or dealing with those in a different way.</p>\n"}], "owner": {"reputation": 1, "user_id": 8404957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab433204ca962c8079162de3639e57e?s=128&d=identicon&r=PG&f=1", "display_name": "Henrik GJ", "link": "https://stackoverflow.com/users/8404957/henrik-gj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1656, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501688999, "creation_date": 1501671481, "last_edit_date": 1501682823, "question_id": 45458954, "link": "https://stackoverflow.com/questions/45458954/replace-invalid-characters-when-saving-excel-as-pdf", "title": "Replace invalid characters when saving excel as PDF", "body": "<p>sorry for the inconvenience. I've tried to google (I always said \"google is my friend\"), but everything I try only give me an error in VBA.</p>\n\n<p>I would like to add a function, which replace invalid characters (!\"#\u00a4%&amp;/()=?`^*>;:@\u00a3${[]}|~\\,.'\u00a8\u00b4+-) in filename with \"_\".</p>\n\n<p>This is my current (and working) macro:</p>\n\n<pre><code>Sub Save_to_PDF()\n    Dim v As Variant\n    Dim name, datedd As String\n\n    ThisWorkbook.Sheets(Array(\"sheet1\")).Select\n\n    datedd = Date\n    strFilename = Worksheets(\"sheet1\").Range(\"B2\")\n    v = Application.GetSaveAsFilename(strFilename &amp; \" document \" &amp; datedd &amp; \" .pdf\", \"PDF Files (*.pdf), *.pdf\")\n\n    On Error GoTo openfile\n\n    If FileExists(v) Then\n        Kill v\n    End If\n\n    If VarType(v) = vbString Then\n        ThisWorkbook.Sheets(\"sheet1\").Activate\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, filename:=v, _\n          Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n          IgnorePrintAreas:=False, From:=1, To:=1, OpenAfterPublish:=True\n    End If\n    Exit Sub\n\nopenfile:\n    MsgBox \"You have one file open allready whith that name. Please try again\", vbInformation, \"Please close file\"\n    Exit Sub\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 5598, "user_id": 6256482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbb61d1374b0c24127b13bccc2f7e586?s=128&d=identicon&r=PG&f=1", "display_name": "KenHBS", "link": "https://stackoverflow.com/users/6256482/kenhbs"}, "edited": false, "score": 0, "creation_date": 1501672280, "post_id": 45458572, "comment_id": 77878458, "body": "You mean you want to copy the value of <code>D1</code> to <code>E1:S1</code>?"}, {"owner": {"reputation": 6718, "user_id": 3484146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N411E.jpg?s=128&g=1", "display_name": "ifloop", "link": "https://stackoverflow.com/users/3484146/ifloop"}, "reply_to_user": {"reputation": 5598, "user_id": 6256482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbb61d1374b0c24127b13bccc2f7e586?s=128&d=identicon&r=PG&f=1", "display_name": "KenHBS", "link": "https://stackoverflow.com/users/6256482/kenhbs"}, "edited": false, "score": 0, "creation_date": 1501747318, "post_id": 45458572, "comment_id": 77916873, "body": "@KenS. I think OP speaks about the named ranges."}], "answers": [{"tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 0, "last_activity_date": 1501671645, "creation_date": 1501671645, "answer_id": 45458997, "question_id": 45458572, "link": "https://stackoverflow.com/questions/45458572/need-to-get-cell-value-and-declare-it-to-the-row-range-automatically/45458997#45458997", "title": "Need to get cell value and declare it to the row range automatically", "body": "<p>This is how it should be done for first 5 rows:</p>\n\n<pre><code>For i = 1 To 5\n    ThisWorkbook.Names.Add Name:=yourWorksheet.Cells(i, 4).Value, RefersTo:=yourWorksheet.Range(yourWorksheet.Cells(i, 5), yourWorksheet.Cells(i, 19))\nNext\n</code></pre>\n\n<p>remember that the names must be unique</p>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1501672134, "creation_date": 1501672134, "answer_id": 45459195, "question_id": 45458572, "link": "https://stackoverflow.com/questions/45458572/need-to-get-cell-value-and-declare-it-to-the-row-range-automatically/45459195#45459195", "title": "Need to get cell value and declare it to the row range automatically", "body": "<p>Try following code</p>\n\n<pre><code>Sub AddNamedRange()\n    Dim cel As Range\n    Dim ws As Worksheet\n    Dim lastRow As Long\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet4\")  'change Sheet4 to your sheet name\n    With ws\n        lastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row    'last row with data in Column D\n        For Each cel In .Range(\"D1:D\" &amp; lastRow)     'loop through all cell in Column D\n            ThisWorkbook.Names.Add cel, ws.Range(cel.Offset(, 1), cel.Offset(, 15)) 'adding named range\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8404904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7733708a0e2d3751339b936612b04bd?s=128&d=identicon&r=PG&f=1", "display_name": "Arunlevies ", "link": "https://stackoverflow.com/users/8404904/arunlevies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501773617, "creation_date": 1501670455, "last_edit_date": 1531164843, "question_id": 45458572, "link": "https://stackoverflow.com/questions/45458572/need-to-get-cell-value-and-declare-it-to-the-row-range-automatically", "title": "Need to get cell value and declare it to the row range automatically", "body": "<p>Name manager using <code>vba</code> ...\nI need to get the cell value from the column one by one and have to declare that name to that row range next to that column </p>\n\n<p>Example </p>\n\n<p>In column <strong><code>D</code></strong> I have the name list </p>\n\n<p>I have to get that D1 value and declare that value to the row range <code>( E1:S1 )</code></p>\n\n<p>Next </p>\n\n<p>have to <code>D2 ---&gt; E2:S2</code></p>\n"}, {"tags": ["vba", "excel", "cmd"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1501670889, "post_id": 45458356, "comment_id": 77877491, "body": "What is the difference in your results?"}, {"owner": {"reputation": 8474, "user_id": 8290634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23c338d78a579b717f1cb6e9f16fb1b?s=128&d=identicon&r=PG&f=1", "display_name": "mao", "link": "https://stackoverflow.com/users/8290634/mao"}, "edited": false, "score": 1, "creation_date": 1501671366, "post_id": 45458356, "comment_id": 77877804, "body": "The environment variables may be different depending on how you invoke the script.  Verify the script gets invoked by the same user-account.  Add debugging to show the value of PATH and other environment variables then compare the result with each invocation method."}, {"owner": {"reputation": 1976, "user_id": 1622475, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/94a2da046a4b68cdaaa274f822e7804e?s=128&d=identicon&r=PG", "display_name": "Toni Kanoni", "link": "https://stackoverflow.com/users/1622475/toni-kanoni"}, "edited": false, "score": 0, "creation_date": 1501672531, "post_id": 45458356, "comment_id": 77878641, "body": "Guys, thank you, I just found the error myself:"}, {"owner": {"reputation": 1976, "user_id": 1622475, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/94a2da046a4b68cdaaa274f822e7804e?s=128&d=identicon&r=PG", "display_name": "Toni Kanoni", "link": "https://stackoverflow.com/users/1622475/toni-kanoni"}, "edited": false, "score": 0, "creation_date": 1501672559, "post_id": 45458356, "comment_id": 77878661, "body": "There was a %root% used inside the script, this was the error"}], "answers": [{"tags": [], "owner": {"reputation": 1976, "user_id": 1622475, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/94a2da046a4b68cdaaa274f822e7804e?s=128&d=identicon&r=PG", "display_name": "Toni Kanoni", "link": "https://stackoverflow.com/users/1622475/toni-kanoni"}, "is_accepted": false, "score": 0, "last_activity_date": 1501672620, "creation_date": 1501672620, "answer_id": 45459357, "question_id": 45458356, "link": "https://stackoverflow.com/questions/45458356/cmd-file-executed-from-vba-leads-to-different-results/45459357#45459357", "title": "CMD file executed from VBA leads to different results", "body": "<p>thank you, I just found the error myself:\nThere was a %root% used inside the script, this was the error. Changed it to absolute path, now it works</p>\n"}], "owner": {"reputation": 1976, "user_id": 1622475, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/94a2da046a4b68cdaaa274f822e7804e?s=128&d=identicon&r=PG", "display_name": "Toni Kanoni", "link": "https://stackoverflow.com/users/1622475/toni-kanoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501672677, "creation_date": 1501669948, "last_edit_date": 1531164843, "question_id": 45458356, "link": "https://stackoverflow.com/questions/45458356/cmd-file-executed-from-vba-leads-to-different-results", "title": "CMD file executed from VBA leads to different results", "body": "<p><strong>PROBLEM IS SOLVED ALREADY</strong></p>\n\n<p>this should be fairly simple, but I can't figure out what's wrong.</p>\n\n<p>I have a cmd file in V:\\something\\XYZ.cmd, which takes 1 parameter.\nWhen I execute it manually, e.g. Windows-Explorer and double-click the cmd, I get my result.</p>\n\n<p>Now I have a XLSM file on my Desktop and a macro should invoke this cmd instead.\nProblem is, when executed that way, I get some \"file-not-found errors\" in the cmd itself. </p>\n\n<p>So how could I simulate the manual execution of the cmd.\nThere must be some path related problem...</p>\n\n<p>This is how I execute from VBA:</p>\n\n<pre><code>Call Shell(\"cmd.exe /c \" &amp; \"V:\\something\\XYZ.cmd\" &amp; \" \" &amp; someParameter, vbNormalFocus)\n</code></pre>\n\n<p>I tried to put a </p>\n\n<pre><code>ChDir \"V:\\something\\\"\n</code></pre>\n\n<p>right before the call, but that doesn't change anything...</p>\n\n<p>Where's the problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 4, "creation_date": 1501669830, "post_id": 45458160, "comment_id": 77876724, "body": "Please post code only as text formatted as code block (at least 4 spaces indented). Code in images is hard for other users to copy and fix."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1501672378, "post_id": 45458160, "comment_id": 77878529, "body": "@Peh - hard is a bit of an understatement!  Takes ages to write the OCR code needed to read the image.  I don&#39;t think I know any coders that will take the 15 minutes needed to type the code in when they can spend weeks writing the OCR code instead. :)"}, {"owner": {"reputation": 1, "user_id": 8404428, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lVzToxOcqnQ/AAAAAAAAAAI/AAAAAAAAEWE/PRdbS8-NM3Q/photo.jpg?sz=128", "display_name": "el gordo", "link": "https://stackoverflow.com/users/8404428/el-gordo"}, "edited": false, "score": 0, "creation_date": 1501673082, "post_id": 45458160, "comment_id": 77879055, "body": "I added the code, do you see it now?"}, {"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 0, "creation_date": 1501675976, "post_id": 45458160, "comment_id": 77881135, "body": "could you try it without the &quot;with&quot;? so address the Pivot two times"}, {"owner": {"reputation": 1, "user_id": 8404428, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lVzToxOcqnQ/AAAAAAAAAAI/AAAAAAAAEWE/PRdbS8-NM3Q/photo.jpg?sz=128", "display_name": "el gordo", "link": "https://stackoverflow.com/users/8404428/el-gordo"}, "reply_to_user": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 0, "creation_date": 1501677047, "post_id": 45458160, "comment_id": 77882005, "body": "@RealCheeseLord which &quot;with&quot; should I remove?"}, {"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 0, "creation_date": 1501680414, "post_id": 45458160, "comment_id": 77884895, "body": "<code>With ActiveSheet.PivotTables(&quot;PivotTable2&quot;).PivotFields(&quot;Count of Date&quot;)     .Orientation = xlRowField     .Position = 1 End With</code>"}, {"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 0, "creation_date": 1501680479, "post_id": 45458160, "comment_id": 77884944, "body": "To <code>ActiveSheet.PivotTables(&quot;PivotTable2&quot;).PivotFields(&quot;Count of Date&quot;).Orientation = xlRowField     ActiveSheet.PivotTables(&quot;PivotTable2&quot;).PivotFields(&quot;Count of Date&quot;).Position = 1 </code>"}, {"owner": {"reputation": 1, "user_id": 8404428, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lVzToxOcqnQ/AAAAAAAAAAI/AAAAAAAAEWE/PRdbS8-NM3Q/photo.jpg?sz=128", "display_name": "el gordo", "link": "https://stackoverflow.com/users/8404428/el-gordo"}, "edited": false, "score": 0, "creation_date": 1501689305, "post_id": 45458160, "comment_id": 77892027, "body": "I got an error message: &quot;Run-time error &#39;1004&#39;: Unable to get the PivotTables property of the Worksheet class"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501743369, "post_id": 45458160, "comment_id": 77914216, "body": "please stop providing partial information ... which line gives you the error 1004 ?"}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1501745639, "creation_date": 1501745639, "answer_id": 45477705, "question_id": 45458160, "link": "https://stackoverflow.com/questions/45458160/excel-debugging-vba-run-time-error-424-object-required/45477705#45477705", "title": "Excel debugging VBA &quot;Run-time error &#39;424&#39;: Object required&quot;", "body": "<p>here is a rewrite of your code</p>\n\n<p>i think that you would have an easier time debugging, if you formatted your code in a more legible way.</p>\n\n<pre><code>Sub pivTest()\n\n    Columns(\"A:A\").TextToColumns _\n        Destination:=Range(\"A1\"), _\n        DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, _\n        ConsecutiveDelimiter:=False, _\n        Tab:=True, _\n        Semicolon:=False, _\n        Comma:=True, _\n        Space:=False, _\n        Other:=False, _\n        FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), _\n                         Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1), _\n                         Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), _\n                         Array(13, 1), Array(14, 1), Array(15, 1))\n\n'   Cells.Select  ' do not use\n\n    Sheets.Add    ' what is the name of this sheet ?\n\n    ActiveWorkbook.PivotCaches.Create( _\n            SourceType:=xlDatabase, _\n            SourceData:=\"data!R1C1:R1048576C15\", _\n            Version:=xlPivotTableVersion14).CreatePivotTable _\n                                                    TableDestination:=\"Sheet2!R3C1\", _\n                                                    TableName:=\"PivotTable2\", _\n                                                    DefaultVersion:=xlPivotTableVersion14\n'   Sheets(\"Sheet1\").Select   ' do not use\n\n'   Cells(3, 1).Select        ' do not use\n\n    Dim pt As PivotTable\n    Set pt = Sheets(\"Sheet1\").PivotTables(\"PivotTable2\")\n\n    pt.AddDataField pt.PivotFields(\"Date\"), \"Count of Date\", xlCount\n    pt.AddDataField pt.PivotFields(\"Store Listing Visitors\"), \"Count of Store Listing Visitors\", xlCount\n    pt.AddDataField pt.PivotFields(\"Installers\"), \"Count of Installers\", xlCount\n\n    pt.PivotFields(\"Count of Date\").Orientation = xlRowField\n    pt.PivotFields(\"Date\").Position = 1           ' it is not \"Count of Date\" anymore, because previous line moved it out of the \"Sum Values\"\n\n    ExecuteExcel4Macro \"PIVOT.FIELD.PROPERTIES(\"\"PivotTable2\"\",\"\"Count of Store Listing Visitors\"\",,,2)\"\n    ExecuteExcel4Macro \"PIVOT.FIELD.PROPERTIES(\"\"PivotTable2\"\",\"\"Count of Installers\"\",,,2)\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8404428, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lVzToxOcqnQ/AAAAAAAAAAI/AAAAAAAAEWE/PRdbS8-NM3Q/photo.jpg?sz=128", "display_name": "el gordo", "link": "https://stackoverflow.com/users/8404428/el-gordo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 776, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501745639, "creation_date": 1501669467, "last_edit_date": 1501674033, "question_id": 45458160, "link": "https://stackoverflow.com/questions/45458160/excel-debugging-vba-run-time-error-424-object-required", "title": "Excel debugging VBA &quot;Run-time error &#39;424&#39;: Object required&quot;", "body": "<p>Using Macros to create a pivot table with the click of a button. I download new reports every day so it's a different Excel worksheet and sheet name each time.</p>\n\n<p>I've managed to get around the fact that it's a different workbook name by simply renaming the relevant tab \"data\" each time. I've gotten it to create the pivot table I want, except it's giving me \"Count\" instead of \"Sum\" like I need. The error I get is </p>\n\n<blockquote>\n  <p>Run-time error '424':<br>\n  Object required</p>\n</blockquote>\n\n<p>The highlighted line is <code>.Position = 1</code> near the end and I'm not sure what's broken here.</p>\n\n<pre><code>   Columns(\"A:A\").Select\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n    Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1 _\n    ), Array(14, 1), Array(15, 1))\nCells.Select\nSheets.Add\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"data!R1C1:R1048576C15\", Version:=xlPivotTableVersion14).CreatePivotTable _\n    TableDestination:=\"Sheet1!R3C1\", TableName:=\"PivotTable2\", DefaultVersion _\n    :=xlPivotTableVersion14\nSheets(\"Sheet1\").Select\nCells(3, 1).Select\nActiveSheet.PivotTables(\"PivotTable2\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable2\").PivotFields(\"Date\"), \"Count of Date\", xlCount\nActiveSheet.PivotTables(\"PivotTable2\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable2\").PivotFields(\"Store Listing Visitors\"), _\n    \"Count of Store Listing Visitors\", xlCount\nActiveSheet.PivotTables(\"PivotTable2\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable2\").PivotFields(\"Installers\"), \"Count of Installers\", xlCount\nWith ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Count of Date\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nExecuteExcel4Macro _\n    \"PIVOT.FIELD.PROPERTIES(\"\"PivotTable2\"\",\"\"Count of Store Listing Visitors\"\",,,2)\"\nExecuteExcel4Macro _\n    \"PIVOT.FIELD.PROPERTIES(\"\"PivotTable2\"\",\"\"Count of Installers\"\",,,2)\"\n</code></pre>\n\n<p>I appreciate your help in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1501669409, "post_id": 45457667, "comment_id": 77876398, "body": "What&#39;s your question? Perhaps something like this: How can I get the code for this without doing it myself?"}, {"owner": {"reputation": 1, "user_id": 8356656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab9af8de6c13cebbbf239fa4cb3eb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/8356656/anthony-cox"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1501669844, "post_id": 45457667, "comment_id": 77876732, "body": "I forgot to do so, technically yes, I need a code that would be able to do that, with a single click of a button"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1501672325, "post_id": 45457667, "comment_id": 77878493, "body": "What have you tried? This site is (supposedly) not for spoonfeeding."}, {"owner": {"reputation": 1, "user_id": 8356656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab9af8de6c13cebbbf239fa4cb3eb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/8356656/anthony-cox"}, "edited": false, "score": 0, "creation_date": 1501672455, "post_id": 45457667, "comment_id": 77878584, "body": "SJR - I&#39;ve tried this <a href=\"https://excel.tips.net/T005598_Searching_Through_Many_Workbooks.html\" rel=\"nofollow noreferrer\">excel.tips.net/T005598_Searching_Through_Many_Workbooks.html</a>"}, {"owner": {"reputation": 1, "user_id": 8356656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab9af8de6c13cebbbf239fa4cb3eb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/8356656/anthony-cox"}, "edited": false, "score": 0, "creation_date": 1501672522, "post_id": 45457667, "comment_id": 77878635, "body": "But its not what I want, and I don&#39;t know how to adjust to my needs. Just a noob"}], "owner": {"reputation": 1, "user_id": 8356656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab9af8de6c13cebbbf239fa4cb3eb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Cox", "link": "https://stackoverflow.com/users/8356656/anthony-cox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1501669768, "creation_date": 1501668098, "last_edit_date": 1531164843, "question_id": 45457667, "link": "https://stackoverflow.com/questions/45457667/how-to-search-through-multiple-workbooks-for-a-specific-word-and-get-a-few-cell", "title": "how to search through multiple workbooks for a specific word and get a few cell values", "body": "<p>I need a code to do the following;</p>\n\n<p>Im using a workbook, which is my main workbook that I work from, call it main.xlsx\nNow in this workbook in;</p>\n\n<p>sheet1, cell A6 = Item 1</p>\n\n<p>Sheet1, cell D6 = Item Weight</p>\n\n<p>Sheet1, cell I6 = Item Price</p>\n\n<p>And in the same workbook;</p>\n\n<p>Sheet3, cell A1 = Workbook Name</p>\n\n<p>Sheet3, cell B1 = Item Name</p>\n\n<p>Sheet3, cell C1 = Item Weight</p>\n\n<p>Sheet3, cell D1 = Item Amount</p>\n\n<p>Sheet3, cell G2 = (the cell where I type in my search value, e.g Item 1)</p>\n\n<p>Sheet3, button =  Button 2</p>\n\n<p>Now, with my main workbook, in sheet 1, I create and save multiple receipts to a folder, which would be for e.g copy1.xlsx, copy2.xlsx, ect. \nAll the cell values will be constant in sheet 1. </p>\n\n<p>In my main.xlsx workbook, sheet3 I want to be able to search through all those workbook copy's for a specific item, and display its name, weight and the price.</p>\n\n<p>So if I type in Item 3 into cell G2 and click the button, the cell value in A2 to D2 will be populated accordingly. </p>\n\n<p>So </p>\n\n<p>Sheet3, cell A2 = Copy1.xlsx</p>\n\n<p>Sheet3, cell B2 = Item 3</p>\n\n<p>Sheet3, cell C2 = 5</p>\n\n<p>Sheet3, cell D2 = 30</p>\n\n<p>I apologize in advance for any complications.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1501667523, "creation_date": 1501667523, "answer_id": 45457426, "question_id": 45457273, "link": "https://stackoverflow.com/questions/45457273/how-to-auto-apply-the-file-path-from-a-cell-in-vba/45457426#45457426", "title": "How to auto apply the file path from a cell in VBA?", "body": "<pre><code>Apply Saved Chart Template\nActiveChart.ApplyChartTemplate (Worksheets(\"Name\").Range(\"A1\"))\n</code></pre>\n\n<p>Something like this should work, I suppose.</p>\n"}, {"tags": [], "owner": {"reputation": 195, "user_id": 7876875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a7YCW.png?s=128&g=1", "display_name": "hung34k", "link": "https://stackoverflow.com/users/7876875/hung34k"}, "is_accepted": true, "score": 0, "last_activity_date": 1501667568, "creation_date": 1501667568, "answer_id": 45457437, "question_id": 45457273, "link": "https://stackoverflow.com/questions/45457273/how-to-auto-apply-the-file-path-from-a-cell-in-vba/45457437#45457437", "title": "How to auto apply the file path from a cell in VBA?", "body": "<p>You can set value of cell A1 to argument, then using this parameter for code</p>\n\n<pre><code>Dim sPath As String\nsPath = Cells(1, 1).Value\nActiveChart.ApplyChartTemplate (sPath)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8404628, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154880365763435/picture?type=large", "display_name": "Bosco Cho", "link": "https://stackoverflow.com/users/8404628/bosco-cho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 45457437, "answer_count": 2, "score": 0, "last_activity_date": 1501668018, "creation_date": 1501667137, "last_edit_date": 1501668018, "question_id": 45457273, "link": "https://stackoverflow.com/questions/45457273/how-to-auto-apply-the-file-path-from-a-cell-in-vba", "title": "How to auto apply the file path from a cell in VBA?", "body": "<p>Now I am using this code for running a Excel Chart Template on bar charts:</p>\n\n<pre><code>Apply Saved Chart Template\nActiveChart.ApplyChartTemplate ( _\n        \"C:\\Users\\Bosco\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\Bar Chart.crtx\" _\n        )\n</code></pre>\n\n<p>Since this link will be decided dynamically, if I save <code>C:\\Users\\Bosco\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\Bar Chart.crtx</code> into cell A1, how can I auto apply the path of A1 in VBA so that once I change the path in A1, the VBA will automatically follow? thanks!</p>\n"}, {"tags": ["vba", "combobox", "autocomplete", "ms-word", "string-matching"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1501669125, "post_id": 45457064, "comment_id": 77876197, "body": "What&#39;s the difference between <code>MatchEntry = fmMatchEntryComplete</code> and the action you wish to create with your macro?"}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1501671594, "post_id": 45457064, "comment_id": 77877959, "body": "<code>fmMatchEntryComplete</code> does not display a dropdown of matching characters but select the matching string directly and in the written order in the list. The code above actually is doing kind of the same and that&#39;s why I&#39;m asking for help."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1501675447, "post_id": 45457064, "comment_id": 77880716, "body": "Sorry. Did you answer my question? If you only want to see what you typed you should set <code>frmMatchEntryNone</code>."}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1501675601, "post_id": 45457064, "comment_id": 77880833, "body": "Yes I hope so. Maybe I didn&#39;t get your point well ? @Variatus"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1501675659, "post_id": 45457064, "comment_id": 77880882, "body": "I&#39;m asking what the code is supposed to do that none of the three choices for the <code>MatchEntry</code> property can do."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501746880, "post_id": 45457064, "comment_id": 77916557, "body": "the only thing that is excel related in the original post, is the code Button3_click. it fills the data into the combobox. (that could be put into the form init code ... the form code itself should work in Word. it does not interact with Excel at all"}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501759160, "post_id": 45457064, "comment_id": 77925711, "body": "Thank you @jsotola I&#39;ve tried it but It isn&#39;t working. But I get the logic from there and still trying to make it work."}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501761523, "post_id": 45457064, "comment_id": 77927484, "body": "I have figured it out. It works. thank you @jsotola In fact the form code itself do the work but it has to be adapted."}], "answers": [{"tags": [], "owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "is_accepted": true, "score": 0, "last_activity_date": 1501773274, "creation_date": 1501773274, "answer_id": 45488292, "question_id": 45457064, "link": "https://stackoverflow.com/questions/45457064/adding-auto-complete-like-feature-to-combobox-in-ms-word-using-vba/45488292#45488292", "title": "Adding Auto-Complete like feature to ComboBox in MS Word using VBA", "body": "<p>Following @jsotola comment, I've found after trials that the kind of answer provided here <a href=\"https://stackoverflow.com/questions/37572688/auto-complete-with-only-text-and-not-numbers-combobox-excel-vba\">Auto-Complete with only text and not numbers ComboBox Excel VBA</a> by @Ralph is useful to answer my question. You have to only focus on the <code>txtSearchTerm_Change()</code> method and adapt it to your program requirements. </p>\n\n<p>Don't forget the <code>Option Compare Text</code> at the beginning to disbale case sensitivity on the search.</p>\n\n<p>I hope it helps.</p>\n"}], "owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "accepted_answer_id": 45488292, "answer_count": 1, "score": 0, "last_activity_date": 1501773274, "creation_date": 1501666600, "last_edit_date": 1501667473, "question_id": 45457064, "link": "https://stackoverflow.com/questions/45457064/adding-auto-complete-like-feature-to-combobox-in-ms-word-using-vba", "title": "Adding Auto-Complete like feature to ComboBox in MS Word using VBA", "body": "<p>I have populated a ComboBox with a list of strings and since that list is pretty long, I'm struggling to add an Auto-Complete feature like to the ComboBox who will display matching strings as the user types in characters.</p>\n\n<p>An idea of what I want can be found here <a href=\"https://stackoverflow.com/questions/37572688/auto-complete-with-only-text-and-not-numbers-combobox-excel-vba\">Auto-Complete with only text and not numbers ComboBox Excel VBA</a> but it's done using VBA Excel.</p>\n\n<p>Here is the code I got so far </p>\n\n<pre><code>Private Sub ComboBox1_Click()\n    Dim i As Long\n    Static found As Boolean\n\n    If found Then\n        found = False\n        Exit Sub\n    End If\n\n    With FormDialog.ComboBox1\n        .DropDown\n        '.MatchEntry = fmMatchEntryFirstLetter\n        If .Text = \"\" Then Exit Sub\n        For i = 0 To .ListCount\n            If InStr(.List(i), .Text) &gt; 0 Then\n                found = True\n                If found Then\n                    ' the suggestion code will go here I think\n                End If\n                Exit For '&lt;--| exit loop\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>If anyone can help me with this, I will be thankful.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501666344, "post_id": 45456882, "comment_id": 77874206, "body": "Does your code work when column A contains <code>&quot;AR&quot;</code>?  If so, I would suggest that you need to change <code>row</code> to <code>setRow</code>.  (And <b>please</b> use <code>Option Explicit</code>!  That would have highlighted the typo, and saved a question.)"}, {"owner": {"reputation": 91, "user_id": 6541079, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7066ce4fabed4d29c6feb2137ecd6634?s=128&d=identicon&r=PG&f=1", "display_name": "Hibari", "link": "https://stackoverflow.com/users/6541079/hibari"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501666530, "post_id": 45456882, "comment_id": 77874331, "body": "@YowE3K yeah, it works but when going to the inner case, I checked if the country is <code>&quot;Australia&quot;</code>, the <code>setRow</code> does not store a value of 7 at all."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1501666541, "post_id": 45456882, "comment_id": 77874344, "body": "Your <code>Select Case</code> statement shouldn&#39;t be <code>Case ws2.Range(&quot;A&quot; &amp; index) = &quot;AR&quot;</code> - use <code>Case &quot;AR&quot;</code> and <code>Case countryRow = &quot;Australia&quot;</code> should be just <code>Case &quot;Australia&quot;</code>  Currently your Select Case is trying to see if countryrow is the same text as &quot;Australia=Australia&quot;."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501666706, "post_id": 45456882, "comment_id": 77874466, "body": "You aren&#39;t setting <code>setRow</code> for Australia except for &quot;AR&quot;, you are setting <code>row</code>.  As I said, change <code>row</code> to <code>setRow</code>.  And include <code>Option Explicit</code> as the first line of your code module to prevent typos like this."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501666793, "post_id": 45456882, "comment_id": 77874521, "body": "Ohh - no - you also have a problem with <code>countryRow = &quot;Australia&quot;</code> - that should just be <code>&quot;Australia&quot;</code>.  Sorry, missed that one before."}, {"owner": {"reputation": 91, "user_id": 6541079, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7066ce4fabed4d29c6feb2137ecd6634?s=128&d=identicon&r=PG&f=1", "display_name": "Hibari", "link": "https://stackoverflow.com/users/6541079/hibari"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501666967, "post_id": 45456882, "comment_id": 77874647, "body": "@YowE3K <code>Option Explicit</code> is invalid inside a procedure. Yeah, I changed that already. Same error :("}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1501667448, "post_id": 45456882, "comment_id": 77875017, "body": "<code>Option Explicit</code> should be put as the first line of the <b>code module</b>, i.e. before any <code>Function</code> or <code>Sub</code> or <code>Dim</code> or <code>Private</code> or <code>Public</code> or <code>Const</code> etc"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 6541079, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7066ce4fabed4d29c6feb2137ecd6634?s=128&d=identicon&r=PG&f=1", "display_name": "Hibari", "link": "https://stackoverflow.com/users/6541079/hibari"}, "edited": false, "score": 0, "creation_date": 1501666628, "post_id": 45457025, "comment_id": 77874414, "body": "it throws a compile error. <code>Statements and labels invalid between Select Case and first case</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 91, "user_id": 6541079, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7066ce4fabed4d29c6feb2137ecd6634?s=128&d=identicon&r=PG&f=1", "display_name": "Hibari", "link": "https://stackoverflow.com/users/6541079/hibari"}, "edited": false, "score": 0, "creation_date": 1501667190, "post_id": 45457025, "comment_id": 77874800, "body": "@Hibari - I have changed it."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1501666610, "last_edit_date": 1501666610, "creation_date": 1501666527, "answer_id": 45457025, "question_id": 45456882, "link": "https://stackoverflow.com/questions/45456882/method-range-of-object-worksheet-failed/45457025#45457025", "title": "Method &#39;Range&#39; of object&#39;_Worksheet&#39; failed", "body": "<p>Put the following to your code:</p>\n\n<pre><code>Debug.Print ws2.Range(\"A\" &amp; index)\nSelect Case ws2.Range(\"A\" &amp; index)\nStop\nCase ws2.Range(\"A\" &amp; index) = \"AR\"\n</code></pre>\n\n<p>Once you stop, take a look at the immediate window to see the value of <code>ws2.Range(\"A\" &amp; index)</code> based on it <code>setRow</code> is assigned.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 6541079, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7066ce4fabed4d29c6feb2137ecd6634?s=128&d=identicon&r=PG&f=1", "display_name": "Hibari", "link": "https://stackoverflow.com/users/6541079/hibari"}, "edited": false, "score": 0, "creation_date": 1501667254, "post_id": 45457224, "comment_id": 77874862, "body": "a newbie mistake :( Thanks!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1501667004, "creation_date": 1501667004, "answer_id": 45457224, "question_id": 45456882, "link": "https://stackoverflow.com/questions/45456882/method-range-of-object-worksheet-failed/45457224#45457224", "title": "Method &#39;Range&#39; of object&#39;_Worksheet&#39; failed", "body": "<p>Your <code>Select Case</code> statement syntax is wrong, and you also can't type <code>setRow</code>.</p>\n\n<p>An example of what one of your <code>Select Case</code> statements should look like would be (including the correction of <code>row</code> to <code>setRow</code>):</p>\n\n<pre><code>Select Case countryRow\n    Case \"Australia\"\n        setRow = 11\n    Case \"New Zealand\"\n        setRow = 12\n    Case \"Philippines\"\n        setRow = 13\n    Case \"Malaysia\"\n        setRow = 14\n    Case \"Singapore\"\n        setRow = 15\n    Case \"Thailand\"\n        setRow = 16\n    Case \"Vietnam\"\n        setRow = 17\n    Case \"Indonesia\"\n        setRow = 18\n    Case \"India\"\n        setRow = 19\n    Case \"Korea\"\n        setRow = 20\n    Case \"Taiwan\"\n        setRow = 21\n    Case Else\n        Exit Sub\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6541079, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7066ce4fabed4d29c6feb2137ecd6634?s=128&d=identicon&r=PG&f=1", "display_name": "Hibari", "link": "https://stackoverflow.com/users/6541079/hibari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 45457224, "answer_count": 2, "score": 0, "last_activity_date": 1501667689, "creation_date": 1501666199, "last_edit_date": 1501667689, "question_id": 45456882, "link": "https://stackoverflow.com/questions/45456882/method-range-of-object-worksheet-failed", "title": "Method &#39;Range&#39; of object&#39;_Worksheet&#39; failed", "body": "<p><strong>Problem:</strong></p>\n\n<p>Variable not storing correctly. After running the code, I used the debugger to figure out what was wrong. The variable <code>setRow</code> is not storing any values. Thus, throwing an error.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Public Sub initData(index As Integer)\n' ws = COE Monthly Report\n' ws2 = FormattedRaw\nDim ws As Worksheet\nSet ws = ThisWorkbook.Sheets(\"COE Monthly Report\")\nDim ws2 As Worksheet\nSet ws2 = ThisWorkbook.Sheets(\"FormattedRaw\")\nDim setRow As Integer\nDim countryRow As String\ncountryRow = ws2.Range(\"E\" &amp; index)\nSelect Case ws2.Range(\"A\" &amp; index)\nCase ws2.Range(\"A\" &amp; index) = \"AR\"\n    Select Case countryRow\n        Case countryRow = \"Australia\"\n            setRow = 7\n        Case countryRow = \"New Zealand\"\n            setRow = 8\n        Case countryRow = \"Singapore\"\n            setRow = 9\n        Case Else\n            Exit Sub\n    End Select\nCase ws2.Range(\"A\" &amp; index) = \"HW\"\n    Select Case countryRow\n        Case countryRow = \"Australia\"\n            row = 11\n        Case countryRow = \"New Zealand\"\n            row = 12\n        Case countryRow = \"Philippines\"\n            row = 13\n        Case countryRow = \"Malaysia\"\n            row = 14\n        Case countryRow = \"Singapore\"\n            row = 15\n        Case countryRow = \"Thailand\"\n            row = 16\n        Case countryRow = \"Vietnam\"\n            row = 17\n        Case countryRow = \"Indonesia\"\n            row = 18\n        Case countryRow = \"India\"\n            row = 19\n        Case countryRow = \"Korea\"\n            row = 20\n        Case countryRow = \"Taiwan\"\n            row = 21\n        Case Else\n            Exit Sub\n    End Select\nCase ws2.Range(\"A\" &amp; index) = \"PBS\"\n    Select Case countryRow\n        Case countryRow = \"Australia\"\n            row = 23\n        Case countryRow = \"New Zealand\"\n            row = 24\n        Case countryRow = \"Philippines\"\n            row = 25\n        Case countryRow = \"Malaysia\"\n            row = 26\n        Case countryRow = \"Singapore\"\n            row = 27\n        Case countryRow = \"Thailand\"\n            row = 28\n        Case countryRow = \"Vietnam\"\n            row = 29\n        Case countryRow = \"Indonesia\"\n            row = 30\n        Case countryRow = \"Korea\"\n            row = 31\n        Case countryRow = \"Taiwan\"\n            row = 32\n        Case Else\n            Exit Sub\n    End Select\nCase ws2.Range(\"A\" &amp; index) = \"SWG\"\n    Select Case countryRow\n        Case countryRow = \"Australia\"\n            row = 34\n        Case countryRow = \"New Zealand\"\n            row = 35\n        Case countryRow = \"Philippines\"\n            row = 36\n        Case countryRow = \"Malaysia\"\n            row = 37\n        Case countryRow = \"Singapore\"\n            row = 38\n        Case countryRow = \"Thailand\"\n            row = 39\n        Case countryRow = \"Vietnam\"\n            row = 40\n        Case countryRow = \"Indonesia\"\n            row = 41\n        Case countryRow = \"Indonesia\"\n            row = 42\n        Case countryRow = \"Korea\"\n            row = 43\n        Case countryRow = \"Taiwan\"\n            row = 44\n        Case Else\n            Exit Sub\n    End Select\nCase ws2.Range(\"A\" &amp; index) = \"TSS\"\n    Select Case countryRow\n        Case countryRow = \"Singapore\"\n            row = 46\n        Case countryRow = \"Malaysia\"\n            row = 47\n        Case countryRow = \"Vietnam\"\n            row = 48\n        Case countryRow = \"Philippines\"\n            row = 49\n        Case countryRow = \"Indonesia\"\n            row = 50\n        Case countryRow = \"Thailand\"\n            row = 51\n        Case Else\n            Exit Sub\n    End Select\nEnd Select\n' ~~ If control point type is 'KCFR'\nIf ws2.Range(\"L\" &amp; index) = \"KCFR\" Then\n    ' ~~ Populate Tested Samples KCFR in COE Monthly Updated\n    ws.Range(\"D\" &amp; setRow) = ws.Range(\"D\" &amp; setRow) + 1\n    If ws2.Range(\"AG\" &amp; setRow) &lt;&gt; \"0\" Then\n        ' ~~ Populate Defects in KCFR in COE Monthly Updated\n        ws.Range(\"E\" &amp; setRow) = ws.Range(\"E\" &amp; setRow) + 1\n    End If\n' ~~ If control point type is 'KCO'\nElseIf ws2.Range(\"L\" &amp; index) = \"KCO\" Then\n    ' ~~ Populate Tested Samples KCO in COE Monthly Updated\n    ws.Range(\"G\" &amp; setRow) = ws.Range(\"G\" &amp; setRow) + 1\n    If ws2.Range(\"AG\" &amp; setRow) &lt;&gt; \"0\" Then\n        ' ~~ Populate Defects in KCO in COE Monthly Updated\n        ws.Range(\"H\" &amp; setRow) = ws.Range(\"H\" &amp; setRow) + 1\n    End If\nElse\n    Exit Sub\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Note:</p>\n\n<p>I only used the first <code>CASE</code> statement for testing. So you can see variables declared as <code>row</code> but it's just the same as <code>setRow</code>.</p>\n\n<p>Any ideas why?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1501670738, "post_id": 45457718, "comment_id": 77877384, "body": "Thank you for the answer. The macro copies correct columns now but data from column N is copied to column K, not to column N (as I wanted). I followed the same method in next line but it didn&#39;t work  <code>Range(&quot;B2&quot; &amp; &quot;,&quot; &amp; &quot;N2&quot;</code>."}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "reply_to_user": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1501671147, "post_id": 45457718, "comment_id": 77877665, "body": "if you want to preserve blank area between your selections, you must copy each range separately, do you have any data in your target K,L,M columns? If not, the simplest way would be copying whole range (from B to N) and then clearing from K to M"}, {"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1501683066, "post_id": 45457718, "comment_id": 77887123, "body": "columns K,L aqnd M contain formulas that change every month and I don&#39;t want to &quot;touch&quot; these columns. I will copy each range seperately then. Thank you for your help."}], "tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 0, "last_activity_date": 1501668223, "creation_date": 1501668223, "answer_id": 45457718, "question_id": 45456488, "link": "https://stackoverflow.com/questions/45456488/copy-and-paste-multiple-ranges-using-autofilter-in-excel/45457718#45457718", "title": "copy and paste multiple ranges using autofilter in Excel", "body": "<p>This will construct multiarea range:</p>\n\n<pre><code>Range(\"B9:J\" &amp; Lastrow &amp; \",\" &amp; \"N9:N\" &amp; Lastrow)\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501668223, "creation_date": 1501665224, "question_id": 45456488, "link": "https://stackoverflow.com/questions/45456488/copy-and-paste-multiple-ranges-using-autofilter-in-excel", "title": "copy and paste multiple ranges using autofilter in Excel", "body": "<p>I am working on macro that will copy the data from report to multiple worksheets. The macro works fine but I am struggling with one little thing. I would like to copy not only B9:J range but also N8:N however when I put <code>(\"B9:J\" &amp; \"N9:N\" &amp; Lastrow)</code> the macro copies everything from column B to N but I would like to skip columns K, L, M. I tried to put <code>Range(\"B2\", \"N2\")</code> and <code>Range(\"B2\" &amp; \"N2\")</code> in <code>Copy tgt.Range(\"B2\").End(xlDown).Offset(1)</code> but it doesn't work.</p>\n\n<pre><code>Sub report_template()\n\nConst fromFile = \"c:\\Users\\\" &amp; Environ(\"username\") &amp; \"\\Desktop\\Report.xls\"\nDim srcBook As Workbook\nSet srcBook = Application.Workbooks.Open(fromFile, _\nUpdateLinks:=False)\nApplication.ScreenUpdating = False\nsrcBook.Sheets(\"Report Page\").Copy After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\nActiveSheet.Name = \"report\"\nsrcBook.Close False\n\nDim src As Worksheet\nDim tgt As Worksheet\nDim filterRange As Range\nDim filterRange2 As Range\nDim filterRange3 As Range\nDim filterRange4 As Range\nDim copyRange As Range\nDim Lastrow As Long\nDim tgt2 As Worksheet\nSet src = ThisWorkbook.Sheets(\"report\")\nSet tgt = ThisWorkbook.Sheets(\"1\")\nSet tgt2 = ThisWorkbook.Sheets(\"2\")\nSet tgt3 = ThisWorkbook.Sheets(\"3\")\nSet tgt4 = ThisWorkbook.Sheets(\"4\")\n\nsrc.AutoFilterMode = False\nLastrow = src.Range(\"B\" &amp; src.rows.Count).End(xlUp).Row\nSet filterRange = src.Range(\"A8:J\" &amp; Lastrow)\nSet copyRange = src.Range(\"B9:J\" &amp; Lastrow)\nfilterRange.AutoFilter Field:=1, Criteria1:=\"EN &gt; 1\"\ncopyRange.SpecialCells(xlCellTypeVisible).Copy tgt.Range(\"B2\").End(xlDown).Offset(1)\nSet filterRange2 = src.Range(\"A8:J\" &amp; Lastrow)\nfilterRange2.AutoFilter Field:=1, Criteria1:=\"EN &gt; 2\"\ncopyRange.SpecialCells(xlCellTypeVisible).Copy tgt2.Range(\"B2\").End(xlDown).Offset(1)\nSet filterRange3 = src.Range(\"A8:J\" &amp; Lastrow)\nfilterRange3.AutoFilter Field:=1, Criteria1:=\"EN &gt; 3\"\ncopyRange.SpecialCells(xlCellTypeVisible).Copy tgt3.Range(\"B2\").End(xlDown).Offset(1)\nSet filterRange4 = src.Range(\"A8:J\" &amp; Lastrow)\nfilterRange4.AutoFilter Field:=1, Criteria1:=\"EN &gt; 4\"\ncopyRange.SpecialCells(xlCellTypeVisible).Copy tgt4.Range(\"B2\").End(xlDown).Offset(1)\nApplication.DisplayAlerts = False\nWorksheets(\"report\").Delete\nApplication.DisplayAlerts = True\n\n\nApplication.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "vba", "excel", "cmd"], "comments": [{"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 1, "creation_date": 1501668430, "post_id": 45456448, "comment_id": 77875721, "body": "is your VBA code run from the same file which python script tries to open?"}, {"owner": {"reputation": 129, "user_id": 7620393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D652B.jpg?s=128&g=1", "display_name": "Ashish Baboo", "link": "https://stackoverflow.com/users/7620393/ashish-baboo"}, "reply_to_user": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1501669789, "post_id": 45456448, "comment_id": 77876696, "body": "@avb i did not get you . But, NO . My code is in outlook VBA. SO it is not in excel file, script is trying to open."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 7620393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D652B.jpg?s=128&g=1", "display_name": "Ashish Baboo", "link": "https://stackoverflow.com/users/7620393/ashish-baboo"}, "edited": false, "score": 0, "creation_date": 1501673030, "post_id": 45459060, "comment_id": 77879026, "body": "this is the correct answer. This resolved my issue. Thanks !"}], "tags": [], "owner": {"reputation": 13367, "user_id": 2084384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h5lY8.jpg?s=128&g=1", "display_name": "BoarGules", "link": "https://stackoverflow.com/users/2084384/boargules"}, "is_accepted": true, "score": 1, "last_activity_date": 1501671799, "creation_date": 1501671799, "answer_id": 45459060, "question_id": 45456448, "link": "https://stackoverflow.com/questions/45456448/ioerror-errno-2-no-such-file-or-directory-while-accessing-an-excel-file/45459060#45459060", "title": "IOError: [Errno 2] No such file or directory while accessing an Excel file", "body": "<p>This line:</p>\n\n<pre><code>wb = load_workbook('1.xlsx')\n</code></pre>\n\n<p>relies on the program knowing where to look for the file. If you are firing up Python from VBA then the working directory will almost certainly be different. So your Python program needs to know the full filepath. You can either hard-code it in the program, or you can pass it in to the program from the command line. </p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 3937579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51dde8f8829ef0cc9724e7825778fbb3?s=128&d=identicon&r=PG&f=1", "display_name": "Haohan Li", "link": "https://stackoverflow.com/users/3937579/haohan-li"}, "is_accepted": false, "score": 1, "last_activity_date": 1550869670, "last_edit_date": 1550869670, "creation_date": 1550869280, "answer_id": 54835120, "question_id": 45456448, "link": "https://stackoverflow.com/questions/45456448/ioerror-errno-2-no-such-file-or-directory-while-accessing-an-excel-file/54835120#54835120", "title": "IOError: [Errno 2] No such file or directory while accessing an Excel file", "body": "<p>use absolute path instead of relative path will do the trick!</p>\n"}], "owner": {"reputation": 129, "user_id": 7620393, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D652B.jpg?s=128&g=1", "display_name": "Ashish Baboo", "link": "https://stackoverflow.com/users/7620393/ashish-baboo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 0, "accepted_answer_id": 45459060, "answer_count": 2, "score": 0, "last_activity_date": 1550869670, "creation_date": 1501665132, "question_id": 45456448, "link": "https://stackoverflow.com/questions/45456448/ioerror-errno-2-no-such-file-or-directory-while-accessing-an-excel-file", "title": "IOError: [Errno 2] No such file or directory while accessing an Excel file", "body": "<p>I am working on a VBA code which calls a python script saved at desktop. This is my piece of VBA code.</p>\n\n<pre><code>Shell \"cmd /k C:\\Python27\\python.exe C:\\Users\\ashish.baboo\\Desktop\\UKT-SL-Ashish\\Cleaning-Tools\\Old-Geocode.py\"\nwaitTill = Now() + TimeValue(\"00:00:40\")\nWhile Now() &lt; waitTill\nDoEvents\n</code></pre>\n\n<p>This Python script loads addresses in an excel file placed at desktop. When i run python script directly, It executes perfectly. But when i am running VBA code, Python script opens but gives me an error that excel file is not available. Here is my code of Python script:</p>\n\n<pre><code> import xlrd\nimport geocoder\nimport openpyxl\nfrom openpyxl import load_workbook\nlocation = \"C:\\\\Users\\\\ashish.baboo\\\\Desktop\\\\UKT-SL-Ashish\\\\Cleaning-Tools\\\\1.xlsx\"\nworkbook = xlrd.open_workbook(location)\nsheet = workbook.sheet_by_index(1)\n\n\nRows = sheet.nrows\nCols = sheet.ncols\ndata = [[sheet.cell_value(r,c) for c in range(Cols)] for r in range(Rows)]\n\nwb = load_workbook('1.xlsx')\nws1 = wb.get_sheet_by_name(\"Locations\")\n\n\nfor i in range(1,Rows):\n    add = ws1.cell(row = i+1, column = 19).value\n    cadd = geocoder.google(add  , language = \"en\" , key = \"AIzaSyBsiH6LubuA9dn1s97UsUcesQRw71isBuo\")\n    print(i , cadd.latlng , cadd.quality ,cadd.country)\n    S_no = ws1.cell(row = i+1, column = 1) \n    O_Housenumber = ws1.cell(row = i+1, column = 3)\n    O_Street = ws1.cell(row = i+1, column = 4)\n    O_City = ws1.cell(row = i+1, column = 5)\n    O_County = ws1.cell(row = i+1, column = 6)\n    O_State = ws1.cell(row = i+1, column = 7)\n    O_Postal = ws1.cell(row = i+1, column = 8)\n    O_Country = ws1.cell(row = i+1, column = 9)\n    Latitude = ws1.cell(row = i+1, column = 10)\n    Longitude = ws1.cell(row = i+1, column = 11)\n    Accuracy = ws1.cell(row = i+1, column = 12)\n    S_no.value = i\n    O_Housenumber.value = cadd.housenumber\n    O_Street.value = cadd.street\n    O_City.value = cadd.city\n    O_County.value = cadd.county\n    O_State.value = cadd.state_long\n    O_Postal.value = cadd.postal\n    O_Country.value = cadd.country_long\n    Latitude.value = cadd.lat\n    Longitude.value = cadd.lng\n    Accuracy.value = cadd.quality\n\n    wb.save('1.xlsx')\n</code></pre>\n\n<p>I already tried many solutions but was not successful. Kindly suggest how to resolve it ?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501668034, "post_id": 45457237, "comment_id": 77875413, "body": "Thanks a lot but I would prefer to sort it by using a vba macro. As you can imagine this question doesn&#39;t include the big picture."}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501669772, "post_id": 45457237, "comment_id": 77876680, "body": "Hi Maddy thanks but I have inserted your code and while I am clicking the checkboxes there is no change to cell D2 as I would like. Do you have any insight regarding that?"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501670122, "post_id": 45457237, "comment_id": 77876937, "body": "Also when I run the code a window pops up saying object required. Any clue?"}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "reply_to_user": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501671353, "post_id": 45457237, "comment_id": 77877795, "body": "are you using <b>ActiveX Controls</b> check boxs?"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501677040, "post_id": 45457237, "comment_id": 77881995, "body": "Yes I using them"}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1501668466, "last_edit_date": 1501668466, "creation_date": 1501667042, "answer_id": 45457237, "question_id": 45456430, "link": "https://stackoverflow.com/questions/45456430/assign-a-value-to-a-cell-by-using-4-multiple-choice-checkboxes/45457237#45457237", "title": "Assign a value to a cell by using 4 multiple choice checkboxes", "body": "<p>you can do this way. based on linked cells get the 1 if true or Zero if false. and then sum all values.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rgjrR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rgjrR.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/DfS1H.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DfS1H.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>for VBA solution</p>\n\n<pre><code>    Private Sub CheckBox1_Click()\n    Dim str As Integer\n    str = 0\n    If CheckBox1.Value = True Then str = str + 1\n    If CheckBox2.Value = True Then str = str + 1\n    If CheckBox3.Value = True Then str = str + 1\n    If CheckBox4.Value = True Then str = str + 1\n    Range(\"D2\").Value = str\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501677167, "post_id": 45458516, "comment_id": 77882127, "body": "I have problem Tizzu with type mismatch"}, {"owner": {"reputation": 107, "user_id": 8368180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc6b04f685c3b61f2437beb35da20190?s=128&d=identicon&r=PG&f=1", "display_name": "TSH", "link": "https://stackoverflow.com/users/8368180/tsh"}, "reply_to_user": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 1, "creation_date": 1501677501, "post_id": 45458516, "comment_id": 77882402, "body": "you using ActiveX checkboxes i guess which makes it alot harder  <a href=\"https://stackoverflow.com/questions/38282148/add-identical-code-to-multiple-combo-boxes\" title=\"add identical code to multiple combo boxes\">stackoverflow.com/questions/38282148/&hellip;</a> If you dont care about format use FormControll Checkboxes"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501677691, "post_id": 45458516, "comment_id": 77882540, "body": "What would you suggest instead?"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501678069, "post_id": 45458516, "comment_id": 77882875, "body": "I checked again and I am using form control Checkboxes and it keeps giving type mismatch error. Any clue?"}, {"owner": {"reputation": 107, "user_id": 8368180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc6b04f685c3b61f2437beb35da20190?s=128&d=identicon&r=PG&f=1", "display_name": "TSH", "link": "https://stackoverflow.com/users/8368180/tsh"}, "reply_to_user": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 1, "creation_date": 1501678143, "post_id": 45458516, "comment_id": 77882939, "body": "either using form control checkboxes or going though Inzina&#39;s tutorial (SO post linked above)"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501678479, "post_id": 45458516, "comment_id": 77883228, "body": "yes I have changed it in Sheet1. Temporarily is the name of my sheet"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501678810, "post_id": 45458516, "comment_id": 77883510, "body": "I mean this little guide located under \u201cForm Controls\u201d on the Developer Tab &gt; Insert menu: checkbox. Is it not correct?"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501679381, "post_id": 45458516, "comment_id": 77883987, "body": "Public count As Integer  Public Sub btn_Click() Dim CheckBox1 As String  If (count = Null) Then     count = 0 End If  cbName = Application.Caller  If (Sheets(&quot;Sheet1&quot;).Shapes(CheckBox1).ControlFormat.Value = xlOn And count &lt; 4) Then     count = count + 1 ElseIf (count &gt; 0) Then     count = count - 1 End If     Range(&quot;A1&quot;).Value = count End Sub"}, {"owner": {"reputation": 107, "user_id": 8368180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc6b04f685c3b61f2437beb35da20190?s=128&d=identicon&r=PG&f=1", "display_name": "TSH", "link": "https://stackoverflow.com/users/8368180/tsh"}, "reply_to_user": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501679973, "post_id": 45458516, "comment_id": 77884496, "body": "You renamed my string variable for the checkbox&#39;s name <a href=\"http://imgur.com/a/xRRJb\" rel=\"nofollow noreferrer\">imgur.com/a/xRRJb</a> (line 7 my upload isnt working ...) but you didnt rename it where the variable gets initialized so CheckBox1 is a empty String"}, {"owner": {"reputation": 107, "user_id": 8368180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc6b04f685c3b61f2437beb35da20190?s=128&d=identicon&r=PG&f=1", "display_name": "TSH", "link": "https://stackoverflow.com/users/8368180/tsh"}, "reply_to_user": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501680666, "post_id": 45458516, "comment_id": 77885097, "body": "Public count As Integer Public Sub btn_Click() Dim CheckBox1 As String If (count = Null) Then count = 0 End If     CheckBox1 = Application.Caller If (Sheets(&quot;Sheet1&quot;).Shapes(CheckBox1).ControlFormat.Value = xlOn And count &lt; 4) Then     count = count + 1 ElseIf (count &gt; 0) Then     count = count - 1 End If     Range(&quot;A1&quot;).Value = count End Sub"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501681230, "post_id": 45458516, "comment_id": 77885562, "body": "CheckBox1 = Application.Caller Type mismatch 13"}, {"owner": {"reputation": 107, "user_id": 8368180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc6b04f685c3b61f2437beb35da20190?s=128&d=identicon&r=PG&f=1", "display_name": "TSH", "link": "https://stackoverflow.com/users/8368180/tsh"}, "reply_to_user": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501681903, "post_id": 45458516, "comment_id": 77886167, "body": "Just tried it in excel 2016 and 2010 works fine in both for me Im sorry cant help there then"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1501682132, "post_id": 45458516, "comment_id": 77886363, "body": "No worries, you have done your best. Thanks a lot for your help. I will mark the answer anyway. Thanks again"}], "tags": [], "owner": {"reputation": 107, "user_id": 8368180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc6b04f685c3b61f2437beb35da20190?s=128&d=identicon&r=PG&f=1", "display_name": "TSH", "link": "https://stackoverflow.com/users/8368180/tsh"}, "is_accepted": false, "score": 1, "last_activity_date": 1501679072, "last_edit_date": 1501679072, "creation_date": 1501670341, "answer_id": 45458516, "question_id": 45456430, "link": "https://stackoverflow.com/questions/45456430/assign-a-value-to-a-cell-by-using-4-multiple-choice-checkboxes/45458516#45458516", "title": "Assign a value to a cell by using 4 multiple choice checkboxes", "body": "<p>Just set the macro foreach checkbox before clicking it.</p>\n\n<pre><code>Public count As Integer\n\nPublic Sub btn_Click()\nDim cbName As String\n\nIf (count = Null) Then\n    count = 0\nEnd If\n\ncbName = Application.Caller\n\nIf (Sheets(\"Tabelle1\").Shapes(cbName).ControlFormat.Value = xlOn And count &lt; 4) Then\n    count = count + 1\nElseIf (count &gt; 0) Then\n    count = count - 1\nEnd If\n    Range(\"A1\").Value = count\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TPaPA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TPaPA.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/uqzUI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uqzUI.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1501836345, "creation_date": 1501836345, "answer_id": 45502178, "question_id": 45456430, "link": "https://stackoverflow.com/questions/45456430/assign-a-value-to-a-cell-by-using-4-multiple-choice-checkboxes/45502178#45502178", "title": "Assign a value to a cell by using 4 multiple choice checkboxes", "body": "<p>This is the answer to my problem:                                                                               </p>\n\n<p>Option Explicit</p>\n\n<pre><code>   Sub CheckBox1_Click()\n\n\nDim count As Integer\nIf (count = Null) Then\ncount = 0\nEnd If\n\ncount = 0\nIf ActiveSheet.Shapes(\"Check Box 1\").ControlFormat = xlOn Then count = count + 1\nIf ActiveSheet.Shapes(\"Check Box 2\").ControlFormat = xlOn Then count = count + 1\nIf ActiveSheet.Shapes(\"Check Box 3\").ControlFormat = xlOn Then count = count + 1\nIf ActiveSheet.Shapes(\"Check Box 4\").ControlFormat = xlOn Then count = count + 1\nRange(\"A1\").Value = count\n</code></pre>\n\n<p>End Sub      </p>\n"}], "owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 45502178, "answer_count": 3, "score": 0, "last_activity_date": 1501836345, "creation_date": 1501665086, "question_id": 45456430, "link": "https://stackoverflow.com/questions/45456430/assign-a-value-to-a-cell-by-using-4-multiple-choice-checkboxes", "title": "Assign a value to a cell by using 4 multiple choice checkboxes", "body": "<p>I would like please to assign a value to a cell by using 4 multiple choice check boxes which their value is 1 per each box if their condition is true. I would like to sum up their value in the linked cell so that cell value can vary. If for instance:  </p>\n\n<ol>\n<li>all checkboxes condition is true the value in the linked cell is 4</li>\n<li>A few of them are true the value in the linked cell can vary from 1-3</li>\n<li><p>All of them are false the value in the linked cell is 0 </p>\n\n<pre><code>     If CheckBox1.Value = True Then Range(\"D2\").Value = 1\n\n\n     If CheckBox1.Value = False Then Range(\"D2\").Value = 0 etc. \n</code></pre></li>\n</ol>\n\n<p>I wish to solve this problem by using a vba macro. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1501667415, "post_id": 45456428, "comment_id": 77874982, "body": "Will your referenced cells always be in the same row? If so, it might be quicker to write a custom function which takes address of changed cell and checks the formulas in current row"}, {"owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502178198, "post_id": 45456428, "comment_id": 78083458, "body": "No, the referenced cells could be the full height of the spreadsheet. However I only really care about a single row. I just need a better way than calling <code>Target.Dependents</code>"}], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "edited": false, "score": 0, "creation_date": 1502178202, "post_id": 45457918, "comment_id": 78083459, "body": "Going through all rCells or Shapes doesn&#39;t appear to cause slowness. If I limited the sub to the single line <code>Set rUpdated = Range(Target.Dependents.Address)</code>  that is where I get all the slowness. I tested your code and it ran with similar lag."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "edited": false, "score": 0, "creation_date": 1502178848, "post_id": 45457918, "comment_id": 78083891, "body": "When its this line, you should test it in a clean <code>Workbook</code> with only a few reference and see if the performance is stil bad. Is there anything else running in the back?"}, {"owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "edited": false, "score": 0, "creation_date": 1502195871, "post_id": 45457918, "comment_id": 78096307, "body": "Tested in a clean workbook with only the cell formulas copied across. Only VBA code is this single line in the worksheet_change macro. Admittedly there could be a lot of dependents as there are a lot of references to other cells in the formulas, but I can&#39;t change this as it would break the functionality and purpose of the sheet. For example one formula references 8 cells, and there can be up to 16 cells in total updated on a single cell update. No performance issue with no VBA."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1501668738, "creation_date": 1501668738, "answer_id": 45457918, "question_id": 45456428, "link": "https://stackoverflow.com/questions/45456428/worksheet-change-setting-target-range-is-slow/45457918#45457918", "title": "Worksheet_Change setting target range is slow", "body": "<p>So if i understood it correctly you want to make a button visible if the cell in the row as been changed. The only things i can think of to slow it down are, that is has to check many <code>rCell</code> or <code>Shapes</code>. I dont know what the structure of your document is. So my Idea would be: instead of going through all shapes  every time, i would name them in a pattern that you can identify them with the row they are in so you use the name to address them (i.e <code>Row2</code> for the Button in Row <code>2</code>).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rUpdated As Range\n    Dim shp As Shape\n    Dim rCell As Range\n    Dim obj As OLEObject\n\n    Set rUpdated = Range(Target.Dependents.Address)\n    If Not rUpdated Is Nothing Then\n        For Each rCell In rUpdated\n            If rCell.Column = 1 Then\n                On Error Resume Next\n                Set obj = ActiveSheet.OLEObjects(\"Row\" &amp; rCell.Row)\n                If Err.Number = 0 Then\n                    obj.Visible = (rCell.Value &lt;&gt; \"\")\n                End If\n            End If\n        Next rCell\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "is_accepted": true, "score": 0, "last_activity_date": 1504173907, "last_edit_date": 1504173907, "creation_date": 1504003953, "answer_id": 45937238, "question_id": 45456428, "link": "https://stackoverflow.com/questions/45456428/worksheet-change-setting-target-range-is-slow/45937238#45937238", "title": "Worksheet_Change setting target range is slow", "body": "<p>I replaced that config with the following single line (and companion line):</p>\n\n<pre><code>On Error Resume Next\nActiveSheet.Shapes(\"buttonRow\" &amp; Target.Row).Visible = (ActiveSheet.Cells(Target.Row, 1).Value &lt;&gt; \"\")\n</code></pre>\n\n<p>However to get this to work I first needed to rename all my shapes. I used this function to do that:</p>\n\n<pre><code>Function renamebuttons()\n    For Each shp In ActiveSheet.Shapes\n        shp.name = \"buttonRow\" &amp; shp.TopLeftCell.Row\n    Next shp\nEnd Function\n</code></pre>\n\n<p>I ran that function once and deleted it. Once done my shapes can now be referred to by name and I no longer incur the delay of cycling through every shape and every target dependent. The delay experienced in the worksheet is now minimal.</p>\n"}], "owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 1, "accepted_answer_id": 45937238, "answer_count": 2, "score": 1, "last_activity_date": 1504173907, "creation_date": 1501665081, "last_edit_date": 1501665957, "question_id": 45456428, "link": "https://stackoverflow.com/questions/45456428/worksheet-change-setting-target-range-is-slow", "title": "Worksheet_Change setting target range is slow", "body": "<p>I have an excel macro used to manage button visibility in Excel in the \"Worksheet_Change\" function based from another SO question <a href=\"https://stackoverflow.com/questions/39610631/excel-vba-change-button-visibility-based-on-update-to-adjacent-cell/39612582\">here</a>.</p>\n\n<p>The problem is the although the macro works it makes updating the Excel sheet rather laggy. I have managed to pin down the slowness to a single line:</p>\n\n<pre><code>Set rUpdated = Range(Target.Dependents.Address)\n</code></pre>\n\n<p>This sets the range of cells updated to a variable to be iterated through later in the script. If I call a script with just this line I found this is where all the delay is. It seems a rather simple line, but is there a better way to do it?</p>\n\n<p>Full disclosure:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rUpdated As Range\n    Dim shp As Shape\n    Dim rCell As Range\n    Set rUpdated = Range(Target.Dependents.Address)\n    If Not rUpdated Is Nothing Then\n        For Each rCell In rUpdated\n            If rCell.Column = 1 Then\n                'Look at each shape in the sheet and cross-reference with rCell.\n                For Each shp In Target.Parent.Shapes\n                    If shp.TopLeftCell.Row = rCell.Row Then\n                        shp.Visible = (rCell.Value &lt;&gt; \"\")\n                        Exit For 'Exit the loop - the correct button has been found.\n                    End If\n                Next shp\n            End If\n        Next rCell\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 0, "creation_date": 1501665173, "post_id": 45456388, "comment_id": 77873323, "body": "What do you mean &quot;follow the target cell&quot;? do you want the target to always be G20?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7653979, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38ac03716ffebf7c9db418e89e634c59?s=128&d=identicon&r=PG&f=1", "display_name": "N323100", "link": "https://stackoverflow.com/users/7653979/n323100"}, "edited": false, "score": 1, "creation_date": 1501666390, "post_id": 45456444, "comment_id": 77874242, "body": "Thank you! Great Help :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 43, "user_id": 7653979, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38ac03716ffebf7c9db418e89e634c59?s=128&d=identicon&r=PG&f=1", "display_name": "N323100", "link": "https://stackoverflow.com/users/7653979/n323100"}, "edited": false, "score": 0, "creation_date": 1501666558, "post_id": 45456444, "comment_id": 77874357, "body": "@N323100 - you are welcome, glad that I could help :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1501665128, "creation_date": 1501665128, "answer_id": 45456444, "question_id": 45456388, "link": "https://stackoverflow.com/questions/45456388/i-want-my-formula-to-follow-the-target-cell/45456444#45456444", "title": "I want my formula to follow the target cell", "body": "<p>Try surrounding the G20 with 2 dollar signs. Like this:</p>\n\n<p><code>=LEFT($G$20,3)&amp;TEXT(COUNTIF($G$20:$G$20,LEFT($G$20,1)&amp;\"*\"),\"000\")</code></p>\n\n<p>Read a bit more about the dollar signs here:</p>\n\n<p><a href=\"https://blogs.office.com/en-us/2011/08/17/making-sense-of-dollar-signs-in-excel/\" rel=\"nofollow noreferrer\">https://blogs.office.com/en-us/2011/08/17/making-sense-of-dollar-signs-in-excel/</a>\nin general they are really useful.</p>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 1, "last_activity_date": 1501665135, "creation_date": 1501665135, "answer_id": 45456449, "question_id": 45456388, "link": "https://stackoverflow.com/questions/45456388/i-want-my-formula-to-follow-the-target-cell/45456449#45456449", "title": "I want my formula to follow the target cell", "body": "<p>If you always want formula to refer to <code>Cell G20</code> even after inserting rows above, use <code>INDIRECT</code> function as</p>\n\n<pre><code>=LEFT(INDIRECT(\"G20\"),3)&amp;TEXT(COUNTIF(INDIRECT(\"G20:G20\"),LEFT(INDIRECT(\"G20\"),1)&amp;\"*\"),\"000\")\n</code></pre>\n\n<p><strong><em>NOTE :</em></strong> <code>INDIRECT</code> is a volatile function. See <a href=\"http://www.decisionmodels.com/calcsecretsi.htm\" rel=\"nofollow noreferrer\">this</a> for details.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7653979, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38ac03716ffebf7c9db418e89e634c59?s=128&d=identicon&r=PG&f=1", "display_name": "N323100", "link": "https://stackoverflow.com/users/7653979/n323100"}, "edited": false, "score": 0, "creation_date": 1501667092, "post_id": 45456467, "comment_id": 77874732, "body": "Is it possible to use also the INDRECT code using VBA Code?"}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1501665162, "creation_date": 1501665162, "answer_id": 45456467, "question_id": 45456388, "link": "https://stackoverflow.com/questions/45456388/i-want-my-formula-to-follow-the-target-cell/45456467#45456467", "title": "I want my formula to follow the target cell", "body": "<p>try this</p>\n\n<pre><code>=LEFT($G$20,3)&amp;TEXT(COUNTIF($G$20:$G$20,LEFT($G$20,1)&amp;\"*\"),\"000\")\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7653979, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38ac03716ffebf7c9db418e89e634c59?s=128&d=identicon&r=PG&f=1", "display_name": "N323100", "link": "https://stackoverflow.com/users/7653979/n323100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 45456444, "answer_count": 3, "score": 3, "last_activity_date": 1518796264, "creation_date": 1501664963, "last_edit_date": 1518796264, "question_id": 45456388, "link": "https://stackoverflow.com/questions/45456388/i-want-my-formula-to-follow-the-target-cell", "title": "I want my formula to follow the target cell", "body": "<p>Good Day,</p>\n\n<p>I want this code to follow the target cell (G20) even if I inserted a multiple rows before row 20 </p>\n\n<pre><code>=LEFT(G20,3)&amp;TEXT(COUNTIF(G20:G20,LEFT(G20,1)&amp;\"*\"),\"000\")\n</code></pre>\n\n<p>Thank you,</p>\n\n<p>Is it also possible to set INDRECT code for Cell D20?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim x As String, rcell As Range, y As String, z As Long\n\nx = \"RFP\" &amp; Format(Now, \"mmddyyhhmmss\")\ny = Left(x, 10)\nz = Right(x, 2)\n\nFor Each rcell In Range(\"D20:D\" &amp; Range(\"D\" &amp; Rows.Count).End(3).Row)\nIf Cells(rcell.Row, 1) = \"\" Then Cells(rcell.Row, 1) = y &amp; z\nz = z + 1\nNext rcell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "pdf"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1501664474, "post_id": 45455725, "comment_id": 77872824, "body": "Inside the recordset loop - open report filtered to single ID, output the report, close report, move to next record, open report filtered to single ID, output report, close report, move ..."}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1501664514, "post_id": 45455725, "comment_id": 77872855, "body": "you can execute query for every id. like <code>SELECT distinct ID FROM Report_Query Where ID = &#39;ID1&#39; ORDER BY _ID</code>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501747601, "post_id": 45455725, "comment_id": 77917072, "body": "you have the outer loop, which iterates all the IDs. before the <code>DoCmd.OutputTo ...</code> line, put another query. something like <code>select data that i want from report_query where ID = rst.ID</code>  .... also get rid of <code>With rst ... End With</code> and use <code>Do Until rst.EOF</code> and <code>rst.MoveNext</code>"}, {"owner": {"reputation": 1, "user_id": 8404200, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cmt7cJ-_fns/AAAAAAAAAAI/AAAAAAAAAIs/n-PSmGeRkfQ/photo.jpg?sz=128", "display_name": "Abraham Mikhael Dolok", "link": "https://stackoverflow.com/users/8404200/abraham-mikhael-dolok"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1501754347, "post_id": 45455725, "comment_id": 77922220, "body": "@MaddyNikam how if there are 1000 ID?"}], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1501764479, "creation_date": 1501764479, "answer_id": 45484665, "question_id": 45455725, "link": "https://stackoverflow.com/questions/45455725/separate-print-to-pdf-by-id-with-vba/45484665#45484665", "title": "separate print to PDF by ID with VBA", "body": "<p>Try this way.</p>\n\n<p>1)extract all distinct IDs</p>\n\n<p>2)convert recordset to array</p>\n\n<p>3)Loop through array for each ID</p>\n\n<p>4)save to PDF</p>\n\n<p><strong>Not tested</strong></p>\n\n<pre><code>    Private Sub PDF_Click()\n    Dim rst As DAO.Recordset\n    Dim OutputFile As String\n    Dim FileSavePath As String\n    Dim vArray As Variant\n    Set rst = CurrentDb.OpenRecordset(\"SELECT distinct ID FROM Report_Query ORDER BY ID\")\n    With rst\n        .MoveLast\n        .MoveFirst\n        vArray = .GetRows(.RecordCount)\n    End With\n    For Each ID In vArray\n       FileSavePath = \"C:\\Test\\\" &amp; Format(ID, \"000000\") &amp; \".pdf\"\n    ' execute Query here\n    '(\"select * from Report_Query where ID = \" &amp; ID )\n    'save recordset in PDF format here\n    Next ID\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8404200, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cmt7cJ-_fns/AAAAAAAAAAI/AAAAAAAAAIs/n-PSmGeRkfQ/photo.jpg?sz=128", "display_name": "Abraham Mikhael Dolok", "link": "https://stackoverflow.com/users/8404200/abraham-mikhael-dolok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501764479, "creation_date": 1501663191, "last_edit_date": 1501663877, "question_id": 45455725, "link": "https://stackoverflow.com/questions/45455725/separate-print-to-pdf-by-id-with-vba", "title": "separate print to PDF by ID with VBA", "body": "<p>I want to print my Access 2010 report for each ID.</p>\n\n<p>Lets say my report structure is like this:</p>\n\n<pre><code>ID1,    Name1,    phone1,   address1,\n\nID1,    Name2,    phone2,   address2,\n\nID2,    Name,    phone,   address,\n\nID3,    Name1,    phone1,   address1,\n\nID3,    Name2,    phone2,   address2,\n</code></pre>\n\n<p>What I want is for each ID to be written to a separate .pdf file like this:</p>\n\n<p>ID1.pdf contains:</p>\n\n<pre><code>ID1,    Name1,    phone1,   address1,\n\nID1,    Name2,    phone2,   address2,\n</code></pre>\n\n<p>ID2.pdf contains:</p>\n\n<pre><code>ID2,    Name,    phone,   address,\n</code></pre>\n\n<p>ID3.pdf contains:</p>\n\n<pre><code>ID3,    Name1,    phone1,   address1,\n\nID3,    Name2,    phone2,   address2,\n</code></pre>\n\n<p>I created the following code:</p>\n\n<pre><code>Private Sub PrintPDF_Click()\n\nDim rst As DAO.Recordset\nDim OutputFile As String\nDim FileSavePath As String\n\nFileSavePath = \"C:\\Test\\\"\nSet rst = CurrentDb.OpenRecordset(\"SELECT distinct ID FROM Report_Query ORDER BY _ID\")\nWith rst\nDo Until .EOF\n\nDoCmd.OutputTo acOutputReport, Bericht1, acFormatPDF, FileSavePath &amp; ![ID] &amp; \".pdf\", True\n\n.MoveNext\n\nLoop\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Naming has worked well, but it prints all records.  I have ID1.pdf, ID2.pdf, and ID3.pdf but each file contains all the records.</p>\n\n<p>How can I produce one file per ID?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1501663623, "post_id": 45455675, "comment_id": 77872190, "body": "Can you give a minmal complete working example? <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1501665414, "post_id": 45455675, "comment_id": 77873485, "body": "Don&#39;t call a sub like a function. The parameters for a sub must not be enclosed in parentheses. Try: <code>.OnAction = &quot;&#39;addTechColumn &quot;&quot;&quot; &amp; TechGroupName &amp; &quot;&quot;&quot;&#39;&quot;</code>. Note the whole string to call the sub is enclosed in single quotes."}, {"owner": {"reputation": 15, "user_id": 8103066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4888eea1f44a898bb57684de14da007e?s=128&d=identicon&r=PG&f=1", "display_name": "Shitalb ", "link": "https://stackoverflow.com/users/8103066/shitalb"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1501665828, "post_id": 45455675, "comment_id": 77873779, "body": "@Axel Richter it worked for me. Thanks alot."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501747893, "post_id": 45455675, "comment_id": 77917262, "body": "drop the use of <code>With menutext   .... End With</code>. it clutters up code ... use <code>menutext.Caption ...</code>  and    <code>menutext.OnAction ....</code>   .... use <code>With</code> if it simplifies a lot of lines, not just a couple."}, {"owner": {"reputation": 15, "user_id": 8103066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4888eea1f44a898bb57684de14da007e?s=128&d=identicon&r=PG&f=1", "display_name": "Shitalb ", "link": "https://stackoverflow.com/users/8103066/shitalb"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501828558, "post_id": 45455675, "comment_id": 77960232, "body": "@jsotola Thanks for suggestion.I&#39;ll try it."}], "owner": {"reputation": 15, "user_id": 8103066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4888eea1f44a898bb57684de14da007e?s=128&d=identicon&r=PG&f=1", "display_name": "Shitalb ", "link": "https://stackoverflow.com/users/8103066/shitalb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501707696, "creation_date": 1501663005, "last_edit_date": 1501707696, "question_id": 45455675, "link": "https://stackoverflow.com/questions/45455675/onaction-with-parameters-get-executes-two-times-in-vba-excel", "title": ".OnAction with Parameters get executes two times in VBA Excel", "body": "<pre><code>Set menutext = contextmenu.Controls.add(Type:=msoControlPopup, before:=1)\nWith menutext\n    '.name = \"AddTechnologyColumn\"\n    .Caption = \"Add Technology\"\n    .OnAction = \"=addTechColumn(\"\"\" &amp; TechGroupName &amp; \"\"\")\"\nEnd With\n</code></pre>\n\n<p>'Module</p>\n\n<pre><code>Public Sub addTechColumn(TechGroupName As String)\n    MsgBox TechGroupName\nEnd Sub\n</code></pre>\n\n<p>But  addTechColumn() executes 2 times.</p>\n"}]